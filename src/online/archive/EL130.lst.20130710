* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37******************************************************************
    38
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page   3
* EL130.cbl
    40 ENVIRONMENT DIVISION.
    41 DATA DIVISION.
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44 77  FILLER  PIC X(32)  VALUE '********************************'.
    45 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    46 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    47
    48*    COPY ELCSCTM.
    49******************************************************************
    50*                                                                *
    51*                                                                *
    52*                            ELCSCTM                             *
    53*                            VMOD=2.001                          *
    54*                                                                *
    55*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    56*                                                                *
    57******************************************************************
    58 01  SECURITY-MESSAGE.
    59     12  FILLER                          PIC X(30)
    60            VALUE '** LOGIC SECURITY VIOLATION -'.
    61     12  SM-READ                         PIC X(6).
    62     12  FILLER                          PIC X(5)
    63            VALUE ' PGM='.
    64     12  SM-PGM                          PIC X(6).
    65     12  FILLER                          PIC X(5)
    66            VALUE ' OPR='.
    67     12  SM-PROCESSOR-ID                 PIC X(4).
    68     12  FILLER                          PIC X(6)
    69            VALUE ' TERM='.
    70     12  SM-TERMID                       PIC X(4).
    71     12  FILLER                          PIC XX   VALUE SPACE.
    72     12  SM-JUL-DATE                     PIC 9(5).
    73     12  FILLER                          PIC X    VALUE SPACE.
    74     12  SM-TIME                         PIC 99.99.
    75
    76
    77*    COPY ELCSCRTY.
    78******************************************************************
    79*                                                                *
    80*                                                                *
    81*                            ELCSCRTY                            *
    82*                            VMOD=2.001                          *
    83*                                                                *
    84*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    85*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    86*        SAVED IN PI-SECURITY-ADDRESS.                           *
    87*                                                                *
    88******************************************************************
    89 01  SECURITY-CONTROL.
    90     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    91     12  FILLER                       PIC XX    VALUE 'SC'.
    92     12  SC-CREDIT-CODES.
    93         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    94             20  SC-CREDIT-DISPLAY    PIC X.
    95             20  SC-CREDIT-UPDATE     PIC X.
    96     12  SC-CLAIMS-CODES.
    97         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page   4
* EL130.cbl
    98             20  SC-CLAIMS-DISPLAY    PIC X.
    99             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page   5
* EL130.cbl
   101 01  WS-DATE-AREA.
   102     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   103     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   104     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   105
   106 01  WS-CRI-SSN-WORK-AREA.
   107     05  WS-CRI-SOC-SEC-NO.
   108         10  WS-SS-REPT-CD       PIC X(5).
   109         10  WS-SS-LAST-NAME     PIC X(5).
   110         10  WS-SS-INITIAL       PIC X.
   111
   112     05  WS-CRI-REPORT-CODE.
   113         10  FILLER              PIC X(5).
   114         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   115
   116     05  WS-CRI-LAST-NAME.
   117         10  WS-CRI-NAME-MOVE    PIC X(5).
   118         10  FILLER              PIC X(10).
   119
   120 01  STANDARD-AREAS.
   121     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   122     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   123     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   124     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   125     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   126     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   127     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   128     12  PGM-NAME            PIC X(8).
   129     12  TIME-IN             PIC S9(7).
   130     12  TIME-OUT-R  REDEFINES TIME-IN.
   131         16  FILLER          PIC X.
   132         16  TIME-OUT        PIC 99V99.
   133         16  FILLER          PIC X(2).
   134     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   135     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   136     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   137     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   138     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   139     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   140     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   141     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   142     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   143     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   144     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   145     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   146     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   147     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   148     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   149     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   150     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   151     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   152     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   153     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   154     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   155     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
   156     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   157     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   158     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page   6
* EL130.cbl
   159     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   160     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   161     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   162     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   163     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   164     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   165     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   166     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   167     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   168     12  FILE-ID             PIC X(8).
   169     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   170     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   171     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   172     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   173     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   174     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   175     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   176     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   177     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +550.
   178
   179 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   180     12  M                   PIC S9(7)V99           VALUE ZEROS.
   181     12  L                   PIC S9(7)V99           VALUE ZEROS.
   182     12  N                   PIC S9(3)              VALUE ZEROS.
   183     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   184     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   185     12  I                   PIC S99V9(5)           VALUE ZEROS.
   186     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   187     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   188     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   189     12  R                   PIC S9(3)              VALUE ZEROS.
   190     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   191     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   192     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   193     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   194     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   195     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   196     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   197     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   198     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   199
   200 01  TERM-CALC-WORK-AREA.
   201     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   202     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   203     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   204     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   205     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   206     12  V-EXPONENTS.
   207        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   208     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   209
   210 01  MISC-WORK-AREAS.
   211     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   212     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   213     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
   214     12  QID.
   215         16  QID-TERM        PIC X(4).
   216         16  FILLER          PIC X(4)    VALUE '130A'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page   7
* EL130.cbl
   217     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   218     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   219     12  WS-GROUP-NO.
   220         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   221         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   222
   223     12  WS-RESPONSE         PIC S9(8)   COMP.
   224         88  WS-RESP-NORMAL              VALUE +00.
   225         88  WS-RESP-ERROR               VALUE +01.
   226         88  WS-RESP-NOTFND              VALUE +13.
   227
   228***************************************************************
   229*                                                             *
   230*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   231*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   232*    CHANGES WITH IN MAP EL130A.                              *
   233*                                                             *
   234***************************************************************
   235
   236     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   237     12  WS-SAVE-CLAIM-MASTER.
   238         16  FILLER                    PIC XX.
   239         16  WS-SAVE-CLAIM-KEY.
   240             20  WS-SAVE-COMPANY-CD    PIC X.
   241             20  WS-SAVE-CARRIER       PIC X.
   242             20  WS-SAVE-CLAIM-NO      PIC X(7).
   243             20  WS-SAVE-CERT-NO       PIC X(11).
   244         16  FILLER                    PIC X(328).
   245     12  SAVE-CURRENT-DATE         PIC XX.
   246     12  SAVE-CONTROL              PIC X(39).
   247     12  SAVE-ERACCT-KEY           PIC X(26).
   248     12  SAVE-COUNTER              PIC S9(8)   COMP.
   249     12  SAVE-METHOD               PIC X.
   250     12  SAVE-COMPANY-ID           PIC XXX.
   251     12  SAVE-COMPANY-CD           PIC X.
   252     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   253     12  SAVE-CREDIT-USER          PIC X.
   254     12  SAVE-CLAIM-USER           PIC X.
   255     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   256     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   257     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   258     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   259     12  SAVE-AH-OVERRIDE-L1       PIC X.
   260     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   261     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   262     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   263     12  FILLER                    PIC X.
   264*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   265     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   266     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   267     12  SAVE-EL127-TO-EL130-CNTRL.
   268         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
   269         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   270         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   271             20  SAVE-EL127-CARRIER  PIC X.
   272             20  SAVE-EL127-GROUPING PIC X(6).
   273             20  SAVE-EL127-STATE    PIC X(2).
   274             20  SAVE-EL127-ACCOUNT  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page   8
* EL130.cbl
   275             20  SAVE-EL127-CERT-NO  PIC X(11).
   276             20  SAVE-EL127-EFF-DT   PIC XX.
   277     12  SAVE-EL659-TO-EL130-CNTRL.
   278         16  SAVE-EL659-CARRIER    PIC X.
   279         16  SAVE-EL659-GROUPING   PIC X(6).
   280         16  SAVE-EL659-STATE      PIC XX.
   281         16  SAVE-EL659-ACCOUNT    PIC X(10).
   282     12  DIVIDE-QUOT               PIC 999.
   283     12  DIVIDE-REM                PIC 999.
   284     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   285     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   286     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   287     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   288     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   289     12  WS-RESERVE-CONTROLS       PIC X(9).
   290     12  WS-EXPENSE-CONTROLS       PIC X(7).
   291     12  WS-REIN-TABLE.
   292         16  WS-REIN-1             PIC X            VALUE SPACE.
   293         16  WS-REIN-2             PIC X            VALUE SPACE.
   294         16  WS-REIN-3             PIC X            VALUE SPACE.
   295     12  WS-BENE-CALC-METHOD       PIC X.
   296     12  WS-EARNINGS-CALC          PIC X.
   297     12  WS-LF-EARNINGS-CALC       PIC X.
   298         88 TEX-REG                VALUE '4'.
   299         88 NET-PAY                VALUE '5'.
   300     12  WS-AH-EARNINGS-CALC       PIC X.
   301     12  WS-SPECIAL-CALC-CD        PIC X(01).
   302     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   303     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   304     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   305     12  WS-CLAIM-NUMBER.
   306         16  WS-CN-PREFIX.
   307             20  WS-CN-PRF-A PIC X.
   308             20  WS-CN-PRF-B PIC X.
   309         16  WS-CN-NUMBER    PIC 9(5).
   310     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   311     12  WS-CLAIM-SEQU.
   312         16  FILLER          PIC X    VALUE '('.
   313         16  WS-CURRENT-SEQU PIC Z9.
   314         16  FILLER          PIC X(4) VALUE ' OF '.
   315         16  WS-OF-SEQU      PIC Z9.
   316         16  FILLER          PIC X    VALUE ')'.
   317     12  DATE-WORK.
   318       14  FILLER                PIC XX.
   319       14  DATE-MM               PIC XX.
   320       14  DATE-DD               PIC XX.
   321       14  DATE-YY               PIC XX.
   322     12  CURR-DATE REDEFINES DATE-WORK.
   323         16  CURR-MM.
   324           18  CURR-M1           PIC 9.
   325           18  CURR-M2           PIC 9.
   326         16  FILLER              PIC X(5).
   327         16  CURR-YEAR           PIC 9.
   328     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   329     12  SUB                     PIC 99.
   330     12  MY-DATE.
   331         16  MY-MM               PIC XX.
   332         16  FILLER              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page   9
* EL130.cbl
   333         16  MY-YY               PIC XX.
   334
   335     12  WS-EDIT-BEN-CODE        PIC XX.
   336         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   337                                          '90' THRU '99'.
   338
   339     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   340     12  WS-BEN-HOLD             PIC XX.
   341     12  WS-BEN-ALPHA-HOLD.
   342         15  WS-BEN-ALPHA-2      PIC XX.
   343         15  WS-BEN-ALPHA-1      PIC X.
   344     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   345     12  WS-REC-TYPE             PIC X.
   346     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   347     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   348     12  ARCH-NUMBER             PIC S9(8)   COMP.
   349     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   350         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   351         88  REIN-REC-FOUND                  VALUE 'Y'.
   352
   353     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   354     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   355
   356
   357 01  CSO-WORK-FIELDS.
   358     12  WS-BLANK            PIC X       VALUE ' '.
   359
   360     12  WS-MA-CONTROL-PRIMARY.
   361         16  WS-MA-COMPANY-CD        PIC  X.
   362         16  WS-MA-CARRIER           PIC  X.
   363         16  WS-MA-GROUPING          PIC  X(6).
   364         16  WS-MA-STATE             PIC  XX.
   365         16  WS-MA-ACCOUNT           PIC  X(10).
   366         16  WS-MA-CERT-EFF-DT       PIC  XX.
   367         16  WS-MA-CERT-NO.
   368             20  WS-MA-CERT-PRIME    PIC  X(10).
   369             20  WS-MA-CERT-SFX      PIC  X.
   370
   371     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   372     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   373     12  WS-SOC-SEC-NUMBER.
   374         16  WS-SOC-SEC-NO       PIC 9(9).
   375         16  WS-SOC-SEC-BLANK    PIC X(2).
   376     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   377         16  WS-SSN-1-3          PIC 9(3).
   378         16  WS-SSN-DASH1        PIC X(1).
   379         16  WS-SSN-4-5          PIC 9(2).
   380         16  WS-SSN-DASH2        PIC X(1).
   381         16  WS-SSN-6-9          PIC 9(4).
   382
   383     12  WS-DIAG-VIN-MSG.
   384         16  FILLER          PIC X(11)
   385             VALUE 'VIN NUMBER '.
   386         16  WS-DIAG-VIN     PIC X(17).
   387
   388     12  WS-VERIFY-NOTE      PIC X(34)
   389         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   390
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  10
* EL130.cbl
   391     12  WS-CAUSAL-NOTE      PIC X(40)
   392         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   393
   394 01  MAP-DATE-AREAS.
   395     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   396     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   397     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   398     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   399     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   400     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   401     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   402     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   403     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   404     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   405     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   406     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   407     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   408     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   409     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   410     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   411     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   412     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   413     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   414         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   415     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   416     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   417     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   418     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   419
   420 01  ACCESS-KEYS.
   421     12  ELACTQ-KEY.
   422         16  ELACTQ-COMPANY-CD       PIC X.
   423         16  ELACTQ-CARRIER          PIC X.
   424         16  ELACTQ-CLAIM-NO         PIC X(7).
   425         16  ELACTQ-CERT-NO          PIC X(11).
   426     12  ELMSTR-KEY.
   427         16  MSTR-COMP-CD            PIC X.
   428         16  MSTR-CARRIER            PIC X.
   429         16  MSTR-CLAIM-NO           PIC X(7).
   430         16  MSTR-CERT-NO.
   431             20  MSTR-CERT-NO-PRIME  PIC X(10).
   432             20  MSTR-CERT-NO-SUFX   PIC X.
   433     12  SAVE-ELMSTR-KEY.
   434         16  SAVE-COMP-CD            PIC X.
   435         16  SAVE-CARRIER            PIC X.
   436         16  SAVE-CLAIM-NO           PIC X(7).
   437         16  SAVE-CERT-NO.
   438             20  SAVE-CERT-NO-PRIME  PIC X(10).
   439             20  SAVE-CERT-NO-SUFX   PIC X.
   440     12  ELMSTR5-KEY.
   441         16  MSTR5-COMP-CD           PIC X.
   442         16  MSTR5-CERT-NO.
   443             20  MSTR5-CERT-NO-PRIME PIC X(10).
   444             20  MSTR5-CERT-NO-SUFX  PIC X.
   445     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   446         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   447         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   448         88  CLAIM-RECORD-FOUND            VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  11
* EL130.cbl
   449     12  ELCNTL-KEY.
   450         16  CNTL-COMP-ID    PIC X(3).
   451         16  CNTL-REC-TYPE   PIC X.
   452         16  CNTL-ACCESS.
   453             20  FILLER      PIC XX.
   454             20  CNTL-BENEFIT.
   455                 24  FILLER  PIC X.
   456                 24  CNTL-CARRIER PIC X.
   457         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   458     12  ELCERT-KEY.
   459         16  CERT-COMP-CD    PIC X.
   460         16  CERT-CARRIER    PIC X.
   461         16  CERT-GROUPING   PIC X(6).
   462         16  CERT-STATE      PIC X(2).
   463         16  CERT-ACCOUNT.
   464             20  CERT-ACCOUNT-PREFIX PIC X(4).
   465             20  CERT-ACCOUNT-PRIME  PIC X(6).
   466         16  CERT-EFF-DT     PIC XX.
   467         16  CERT-CERT-NO.
   468             20  CERT-CERT-NO-PRIME  PIC X(10).
   469             20  CERT-CERT-NO-SUFX   PIC X.
   470     12  ELCERT-KEY-5.
   471         16  CERT-COMP-CD-5      PIC X.
   472         16  CERT-CERT-5.
   473             20  CERT-CERT-5-PRIME   PIC X(10).
   474             20  CERT-CERT-5-SUFX    PIC X.
   475     12  ERACCT-KEY.
   476         16  ACCT-COMP-CD    PIC X.
   477         16  ACCT-CARRIER    PIC X.
   478         16  ACCT-GROUPING   PIC X(6).
   479         16  ACCT-STATE      PIC X(2).
   480         16  ACCT-ACCOUNT    PIC X(10).
   481         16  ACCT-EXP-DT     PIC XX.
   482     12  ELTRLR-KEY.
   483         16  TRLR-COMP-CD    PIC X.
   484         16  TRLR-CARRIER    PIC X.
   485         16  TRLR-CLAIM-NO   PIC X(7).
   486         16  TRLR-CERT-NO.
   487             20  TRLR-CERT-NO-PRIME  PIC X(10).
   488             20  TRLR-CERT-NO-SUFX   PIC X.
   489         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   490         16  TRLR-TYPE       PIC X.
   491     12  ELBENE-KEY.
   492         16  BENE-COMP-CD    PIC X.
   493         16  BENE-RCD-TYPE   PIC X.
   494         16  BENE-CODE       PIC X(10).
   495     12  ERREIN-KEY.
   496         16  REIN-COMP-CD        PIC X(01).
   497         16  REIN-TYPE           PIC X(01).
   498         16  REIN-TABLE-CO.
   499             20  REIN-CODE-1     PIC X(01).
   500             20  REIN-CODE-2     PIC X(01).
   501             20  REIN-CODE-3     PIC X(01).
   502         16  FILLER              PIC X(03).
   503     12  ELCRTT-KEY.
   504         16  CTRLR-COMP-CD       PIC X.
   505         16  CTRLR-CARRIER       PIC X.
   506         16  CTRLR-GROUPING      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  12
* EL130.cbl
   507         16  CTRLR-STATE         PIC X(2).
   508         16  CTRLR-ACCOUNT       PIC X(10).
   509         16  CTRLR-EFF-DT        PIC XX.
   510         16  CTRLR-CERT-NO       PIC X(11).
   511         16  CTRLR-REC-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  13
* EL130.cbl
   513 01  ERROR-MESSAGES.
   514     12  ER-0000                 PIC X(4)  VALUE '0000'.
   515     12  ER-0004                 PIC X(4)  VALUE '0004'.
   516     12  ER-0019                 PIC X(4)  VALUE '0019'.
   517     12  ER-0023                 PIC X(4)  VALUE '0023'.
   518     12  ER-0029                 PIC X(4)  VALUE '0029'.
   519     12  ER-0033                 PIC X(4)  VALUE '0033'.
   520     12  ER-0068                 PIC X(4)  VALUE '0068'.
   521     12  ER-0070                 PIC X(4)  VALUE '0070'.
   522     12  ER-0194                 PIC X(4)  VALUE '0194'.
   523     12  ER-0202                 PIC X(4)  VALUE '0202'.
   524     12  ER-0203                 PIC X(4)  VALUE '0203'.
   525     12  ER-0204                 PIC X(4)  VALUE '0204'.
   526     12  ER-0205                 PIC X(4)  VALUE '0205'.
   527     12  ER-0206                 PIC X(4)  VALUE '0206'.
   528     12  ER-0207                 PIC X(4)  VALUE '0207'.
   529     12  ER-0213                 PIC X(4)  VALUE '0213'.
   530     12  ER-0214                 PIC X(4)  VALUE '0214'.
   531     12  ER-0217                 PIC X(4)  VALUE '0217'.
   532     12  ER-0219                 PIC X(4)  VALUE '0219'.
   533     12  ER-0220                 PIC X(4)  VALUE '0220'.
   534     12  ER-0221                 PIC X(4)  VALUE '0221'.
   535     12  ER-0222                 PIC X(4)  VALUE '0222'.
   536     12  ER-0223                 PIC X(4)  VALUE '0223'.
   537     12  ER-0224                 PIC X(4)  VALUE '0224'.
   538     12  ER-0225                 PIC X(4)  VALUE '0225'.
   539     12  ER-0226                 PIC X(4)  VALUE '0226'.
   540     12  ER-0227                 PIC X(4)  VALUE '0227'.
   541     12  ER-0229                 PIC X(4)  VALUE '0229'.
   542     12  ER-0230                 PIC X(4)  VALUE '0230'.
   543     12  ER-0231                 PIC X(4)  VALUE '0231'.
   544     12  ER-0232                 PIC X(4)  VALUE '0232'.
   545     12  ER-0233                 PIC X(4)  VALUE '0233'.
   546     12  ER-0234                 PIC X(4)  VALUE '0234'.
   547     12  ER-0235                 PIC X(4)  VALUE '0235'.
   548     12  ER-0236                 PIC X(4)  VALUE '0236'.
   549     12  ER-0237                 PIC X(4)  VALUE '0237'.
   550     12  ER-0238                 PIC X(4)  VALUE '0238'.
   551     12  ER-0239                 PIC X(4)  VALUE '0239'.
   552     12  ER-0240                 PIC X(4)  VALUE '0240'.
   553     12  ER-0241                 PIC X(4)  VALUE '0241'.
   554     12  ER-0243                 PIC X(4)  VALUE '0243'.
   555     12  ER-0244                 PIC X(4)  VALUE '0244'.
   556     12  ER-0245                 PIC X(4)  VALUE '0245'.
   557     12  ER-0246                 PIC X(4)  VALUE '0246'.
   558     12  ER-0247                 PIC X(4)  VALUE '0247'.
   559     12  ER-0248                 PIC X(4)  VALUE '0248'.
   560     12  ER-0250                 PIC X(4)  VALUE '0250'.
   561     12  ER-0251                 PIC X(4)  VALUE '0251'.
   562     12  ER-0252                 PIC X(4)  VALUE '0252'.
   563     12  ER-0253                 PIC X(4)  VALUE '0253'.
   564     12  ER-0254                 PIC X(4)  VALUE '0254'.
   565     12  ER-0257                 PIC X(4)  VALUE '0257'.
   566     12  ER-0258                 PIC X(4)  VALUE '0258'.
   567     12  ER-0260                 PIC X(4)  VALUE '0260'.
   568     12  ER-0261                 PIC X(4)  VALUE '0261'.
   569     12  ER-0263                 PIC X(4)  VALUE '0263'.
   570     12  ER-0264                 PIC X(4)  VALUE '0264'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  14
* EL130.cbl
   571     12  ER-0265                 PIC X(4)  VALUE '0265'.
   572     12  ER-0266                 PIC X(4)  VALUE '0266'.
   573     12  ER-0267                 PIC X(4)  VALUE '0267'.
   574     12  ER-0334                 PIC X(4)  VALUE '0334'.
   575     12  ER-0337                 PIC X(4)  VALUE '0337'.
   576     12  ER-0412                 PIC X(4)  VALUE '0412'.
   577     12  ER-0413                 PIC X(4)  VALUE '0413'.
   578     12  ER-0428                 PIC X(4)  VALUE '0428'.
   579     12  ER-0429                 PIC X(4)  VALUE '0429'.
   580     12  ER-0430                 PIC X(4)  VALUE '0430'.
   581     12  ER-0433                 PIC X(4)  VALUE '0433'.
   582     12  ER-0434                 PIC X(4)  VALUE '0434'.
   583     12  ER-0458                 PIC X(4)  VALUE '0458'.
   584     12  ER-0489                 PIC X(4)  VALUE '0489'.
   585     12  ER-0509                 PIC X(4)  VALUE '0509'.
   586     12  ER-0510                 PIC X(4)  VALUE '0510'.
   587     12  ER-0511                 PIC X(4)  VALUE '0511'.
   588     12  ER-0512                 PIC X(4)  VALUE '0512'.
   589     12  ER-0516                 PIC X(4)  VALUE '0516'.
   590     12  ER-0517                 PIC X(4)  VALUE '0517'.
   591     12  ER-0518                 PIC X(4)  VALUE '0518'.
   592     12  ER-0519                 PIC X(4)  VALUE '0519'.
   593     12  ER-0520                 PIC X(4)  VALUE '0520'.
   594     12  ER-0521                 PIC X(4)  VALUE '0521'.
   595     12  ER-0522                 PIC X(4)  VALUE '0522'.
   596     12  ER-0523                 PIC X(4)  VALUE '0523'.
   597     12  ER-0544                 PIC X(4)  VALUE '0544'.
   598     12  ER-0546                 PIC X(4)  VALUE '0546'.
   599     12  ER-0558                 PIC X(4)  VALUE '0558'.
   600     12  ER-0560                 PIC X(4)  VALUE '0560'.
   601     12  ER-0562                 PIC X(4)  VALUE '0562'.
   602     12  ER-0565                 PIC X(4)  VALUE '0565'.
   603     12  ER-0569                 PIC X(4)  VALUE '0569'.
   604     12  ER-0693                 PIC X(4)  VALUE '0693'.
   605     12  ER-0715                 PIC X(4)  VALUE '0715'.
   606     12  ER-0840                 PIC X(4)  VALUE '0840'.
   607     12  ER-0841                 PIC X(4)  VALUE '0841'.
   608     12  ER-0842                 PIC X(4)  VALUE '0842'.
   609     12  ER-0843                 PIC X(4)  VALUE '0843'.
   610     12  ER-0878                 PIC X(4)  VALUE '0878'.
   611     12  ER-0887                 PIC X(4)  VALUE '0887'.
   612     12  ER-2280                 PIC X(4)  VALUE '2280'.
   613     12  ER-2370                 PIC X(4)  VALUE '2370'.
   614     12  ER-2371                 PIC X(4)  VALUE '2371'.
   615     12  ER-2378                 PIC X(4)  VALUE '2378'.
   616     12  ER-2380                 PIC X(4)  VALUE '2380'.
   617     12  ER-2566                 PIC X(4)  VALUE '2566'.
   618     12  ER-2848                 PIC X(4)  VALUE '2848'.
   619     12  ER-3548                 PIC X(4)  VALUE '3548'.
   620     12  ER-7008                 PIC X(4)  VALUE '7008'.
   621     12  ER-7319                 PIC X(4)  VALUE '7319'.
   622     12  ER-7321                 PIC X(4)  VALUE '7321'.
   623     12  ER-7352                 PIC X(4)  VALUE '7352'.
   624     12  ER-7353                 PIC X(4)  VALUE '7353'.
   625     12  ER-7575                 PIC X(4)  VALUE '7575'.
   626     12  ER-7577                 PIC X(4)  VALUE '7577'.
   627     12  ER-7634                 PIC X(4)  VALUE '7634'.
   628     12  ER-7635                 PIC X(4)  VALUE '7635'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  15
* EL130.cbl
   629     12  ER-7636                 PIC X(4)  VALUE '7636'.
   630     12  ER-7637                 PIC X(4)  VALUE '7637'.
   631     12  ER-7638                 PIC X(4)  VALUE '7638'.
   632     12  ER-7639                 PIC X(4)  VALUE '7639'.
   633     12  ER-7640                 PIC X(4)  VALUE '7640'.
   634     12  ER-7641                 PIC X(4)  VALUE '7641'.
   635     12  ER-7642                 PIC X(4)  VALUE '7642'.
   636     12  ER-7643                 PIC X(4)  VALUE '7643'.
   637     12  ER-7646                 PIC X(4)  VALUE '7646'.
   638     12  ER-7647                 PIC X(4)  VALUE '7647'.
   639     12  ER-7648                 PIC X(4)  VALUE '7648'.
   640     12  ER-7649                 PIC X(4)  VALUE '7649'.
   641     12  ER-7651                 PIC X(4)  VALUE '7651'.
   642     12  ER-7670                 PIC X(4)  VALUE '7670'.
   643     12  ER-7671                 PIC X(4)  VALUE '7671'.
   644     12  ER-7686                 PIC X(4)  VALUE '7686'.
   645     12  ER-7688                 PIC X(4)  VALUE '7688'.
   646     12  ER-7689                 PIC X(4)  VALUE '7689'.
   647     12  ER-7691                 PIC X(4)  VALUE '7691'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  16
* EL130.cbl
   649*    COPY ELCLNKLT.
   650******************************************************************
   651*                                                                *
   652*                                                                *
   653*                           ELCLNKLT                             *
   654*                            VMOD=2.003                          *
   655*                                                                *
   656*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   657*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   658*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   659*                                                                *
   660*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   661*   COMPLETING THE REQUIRED FIELDS.                              *
   662*                                                                *
   663*   THE CALLING PROGRAM SHOULD CHECK:                            *
   664*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   665*                              9999 INDICATES AN UNKNOWN ABEND   *
   666*                                   WAS DETECTED.                *
   667*                              ALL OTHER VALUES ARE NORMAL ERROR *
   668*                              CODES FOUND IN THE ERROR FILE.    *
   669******************************************************************
   670 01  W-1523-LINKDATA.
   671     12  W-1523-COMMON-PI-DATA.
   672         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   673         16  FILLER              PIC  X(67).
   674         16  W-1523-COMPANY-CD   PIC  X(01).
   675         16  FILLER              PIC  X(10).
   676         16  W-1523-CONTROL-IN-PROGRESS.
   677             20  W-1523-CARRIER  PIC  X(01).
   678             20  W-1523-GROUPING PIC  X(06).
   679             20  W-1523-STATE    PIC  X(02).
   680             20  W-1523-ACCOUNT  PIC  X(10).
   681             20  W-1523-CLAIM-CERT-GRP.
   682                 24  W-1523-CLAIM-NO
   683                                 PIC  X(07).
   684                 24  W-1523-CERT-NO.
   685                     28  W-1523-CERT-PRIME
   686                                 PIC  X(10).
   687                     28  W-1523-CERT-SFX
   688                                 PIC  X(01).
   689                 24  W-1523-CERT-EFF-DT
   690                                 PIC  X(02).
   691         16  FILLER              PIC X(265).
   692
   693     12  W-1523-WORK-AREA.
   694         16  W-1523-FORM-NUMBER  PIC  X(04).
   695         16  W-1523-NUMBER-COPIES
   696                                 PIC  9(01).
   697         16  W-1523-ADDR-TYPE    PIC  X(02).
   698         16  W-1523-FOLLOW-UP-DATE
   699                                 PIC  X(02).
   700         16  W-1523-RESEND-DATE  PIC  X(02).
   701         16  W-1523-ERROR-CODE   PIC  9(04).
   702             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   703             88  W-1523-FATAL-ERROR
   704                                    VALUES  0006 0013 0042
   705                                            0154 0168 0169
   706                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  17
* EL130.cbl
   707                                            0179 0186 0281
   708                                            0332 2055 3697
   709                                            3698 3699 3770
   710                                            3771 3772 7675
   711                                            9106 9808 9883
   712                                            9887.
   713             88  W-1523-STOP-ERRORS
   714                                    VALUES  0013 0042 0154
   715                                            0168 0169 0172
   716                                            0281 0332 2055
   717                                            3698 3699 7675
   718                                            9106 9808 9883
   719                                            9999.
   720         16  W-1523-REASON       PIC  X(70).
   721         16  W-1523-ARCHIVE-NUMBER
   722                                 PIC  9(08).
   723     12  W-1523-POINTER-AREA.
   724         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   725         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   726         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   727         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   728         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  18
* EL130.cbl
   730*    COPY ELCINTF.
   731******************************************************************
   732*                                                                *
   733*                                                                *
   734*                            ELCINTF.                            *
   735*                            VMOD=2.017                          *
   736*                                                                *
   737*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   738*                                                                *
   739*       LENGTH = 1024                                            *
   740*                                                                *
   741******************************************************************
   742*                   C H A N G E   L O G
   743*
   744* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   745*-----------------------------------------------------------------
   746*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   747* EFFECTIVE    NUMBER
   748*-----------------------------------------------------------------
   749* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   750******************************************************************
   751 01  PROGRAM-INTERFACE-BLOCK.
   752     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   753     12  PI-CALLING-PROGRAM              PIC X(8).
   754     12  PI-SAVED-PROGRAM-1              PIC X(8).
   755     12  PI-SAVED-PROGRAM-2              PIC X(8).
   756     12  PI-SAVED-PROGRAM-3              PIC X(8).
   757     12  PI-SAVED-PROGRAM-4              PIC X(8).
   758     12  PI-SAVED-PROGRAM-5              PIC X(8).
   759     12  PI-SAVED-PROGRAM-6              PIC X(8).
   760     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   761     12  PI-COMPANY-ID                   PIC XXX.
   762     12  PI-COMPANY-CD                   PIC X.
   763
   764     12  PI-COMPANY-PASSWORD             PIC X(8).
   765
   766     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   767
   768     12  PI-CONTROL-IN-PROGRESS.
   769         16  PI-CARRIER                  PIC X.
   770         16  PI-GROUPING                 PIC X(6).
   771         16  PI-STATE                    PIC XX.
   772         16  PI-ACCOUNT                  PIC X(10).
   773         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   774                                         PIC X(10).
   775         16  PI-CLAIM-CERT-GRP.
   776             20  PI-CLAIM-NO             PIC X(7).
   777             20  PI-CERT-NO.
   778                 25  PI-CERT-PRIME       PIC X(10).
   779                 25  PI-CERT-SFX         PIC X.
   780             20  PI-CERT-EFF-DT          PIC XX.
   781         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   782             20  PI-PLAN-CODE            PIC X(2).
   783             20  PI-REVISION-NUMBER      PIC X(3).
   784             20  PI-PLAN-EFF-DT          PIC X(2).
   785             20  PI-PLAN-EXP-DT          PIC X(2).
   786             20  FILLER                  PIC X(11).
   787         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  19
* EL130.cbl
   788             20  PI-OE-REFERENCE-1.
   789                 25  PI-OE-REF-1-PRIME   PIC X(18).
   790                 25  PI-OE-REF-1-SUFF    PIC XX.
   791
   792     12  PI-SESSION-IN-PROGRESS          PIC X.
   793         88  CLAIM-SESSION                   VALUE '1'.
   794         88  CREDIT-SESSION                  VALUE '2'.
   795         88  WARRANTY-SESSION                VALUE '3'.
   796         88  MORTGAGE-SESSION                VALUE '4'.
   797         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   798
   799
   800*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   801
   802     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   803     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   804
   805     12  PI-CREDIT-USER                  PIC X.
   806         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   807         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   808
   809     12  PI-CLAIM-USER                   PIC X.
   810         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   811         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   812
   813     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   814         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   815         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   816         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   817         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   818         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   819
   820     12  PI-PROCESSOR-ID                 PIC X(4).
   821
   822     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   823
   824     12  PI-MEMBER-CAPTION               PIC X(10).
   825
   826     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   827         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   828
   829     12  PI-LIFE-OVERRIDE-L1             PIC X.
   830     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   831     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   832     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   833
   834     12  PI-AH-OVERRIDE-L1               PIC X.
   835     12  PI-AH-OVERRIDE-L2               PIC XX.
   836     12  PI-AH-OVERRIDE-L6               PIC X(6).
   837     12  PI-AH-OVERRIDE-L12              PIC X(12).
   838
   839     12  PI-NEW-SYSTEM                   PIC X(2).
   840
   841     12  PI-PRIMARY-CERT-NO              PIC X(11).
   842     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   843         88  PI-USES-PAID-TO                 VALUE '1'.
   844     12  PI-CRDTCRD-SYSTEM.
   845         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  20
* EL130.cbl
   846             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   847             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   848         16  PI-CC-MONTH-END-DT          PIC XX.
   849     12  PI-PROCESSOR-PRINTER            PIC X(4).
   850
   851     12  PI-OE-REFERENCE-2.
   852         16  PI-OE-REF-2-PRIME           PIC X(10).
   853         16  PI-OE-REF-2-SUFF            PIC X.
   854
   855     12  PI-REM-TRM-CALC-OPTION          PIC X.
   856
   857     12  PI-LANGUAGE-TYPE                PIC X.
   858             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   859             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   860             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   861
   862     12  PI-POLICY-LINKAGE-IND           PIC X.
   863         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   864         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   865                                                   LOW-VALUES.
   866
   867     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   868     12  PI-CLAIM-PW-SESSION             PIC X(1).
   869         88  PI-CLAIM-CREDIT                 VALUE '1'.
   870         88  PI-CLAIM-CONVEN                 VALUE '2'.
   871
   872     12  PI-PROCESSOR-CSR-IND            PIC X.
   873         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   874         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   875
   876     12  FILLER                          PIC X(3).
   877
   878     12  PI-SYSTEM-LEVEL                 PIC X(145).
   879
   880     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   881         PI-SYSTEM-LEVEL.
   882
   883         16  PI-ENTRY-CODES.
   884             20  PI-ENTRY-CD-1           PIC X.
   885             20  PI-ENTRY-CD-2           PIC X.
   886
   887         16  PI-RETURN-CODES.
   888             20  PI-RETURN-CD-1          PIC X.
   889             20  PI-RETURN-CD-2          PIC X.
   890
   891         16  PI-UPDATE-STATUS-SAVE.
   892             20  PI-UPDATE-BY            PIC X(4).
   893             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   894
   895         16  PI-LOWER-CASE-LETTERS       PIC X.
   896             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   897
   898*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   899*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   900*            88  CARRIER-CLM-CNTL            VALUE '2'.
   901
   902         16  PI-CERT-ACCESS-CONTROL      PIC X.
   903             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  21
* EL130.cbl
   904             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   905             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   906             88  ACCNT-CNTL                  VALUE '3'.
   907             88  CARR-ACCNT-CNTL             VALUE '4'.
   908
   909         16  PI-PROCESSOR-CAP-LIST.
   910             20  PI-SYSTEM-CONTROLS.
   911                24 PI-SYSTEM-DISPLAY     PIC X.
   912                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   913                24 PI-SYSTEM-MODIFY      PIC X.
   914                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   915             20  FILLER                  PIC XX.
   916             20  PI-DISPLAY-CAP          PIC X.
   917                 88  DISPLAY-CAP             VALUE 'Y'.
   918             20  PI-MODIFY-CAP           PIC X.
   919                 88  MODIFY-CAP              VALUE 'Y'.
   920             20  PI-MSG-AT-LOGON-CAP     PIC X.
   921                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   922             20  PI-FORCE-CAP            PIC X.
   923                 88  FORCE-CAP               VALUE 'Y'.
   924
   925         16  PI-PROGRAM-CONTROLS.
   926             20  PI-PGM-PRINT-OPT        PIC X.
   927             20  PI-PGM-FORMAT-OPT       PIC X.
   928             20  PI-PGM-PROCESS-OPT      PIC X.
   929             20  PI-PGM-TOTALS-OPT       PIC X.
   930
   931         16  PI-HELP-INTERFACE.
   932             20  PI-LAST-ERROR-NO        PIC X(4).
   933             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   934
   935         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   936             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   937
   938         16  PI-CR-CONTROL-IN-PROGRESS.
   939             20  PI-CR-CARRIER           PIC X.
   940             20  PI-CR-GROUPING          PIC X(6).
   941             20  PI-CR-STATE             PIC XX.
   942             20  PI-CR-ACCOUNT           PIC X(10).
   943             20  PI-CR-FIN-RESP          PIC X(10).
   944             20  PI-CR-TYPE              PIC X.
   945
   946         16  PI-CR-BATCH-NUMBER          PIC X(6).
   947
   948         16  PI-CR-MONTH-END-DT          PIC XX.
   949
   950         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   951             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   952             88  PI-ZERO-CARRIER             VALUE '1'.
   953             88  PI-ZERO-GROUPING            VALUE '2'.
   954             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   955
   956         16  PI-CARRIER-SECURITY         PIC X.
   957             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   958
   959         16  PI-ACCOUNT-SECURITY         PIC X(10).
   960             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   961             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  22
* EL130.cbl
   962
   963         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   964             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   965                                         INDEXED BY PI-ACCESS-NDX
   966                                         PIC X.
   967
   968         16  PI-GA-BILLING-CONTROL       PIC X.
   969             88  PI-GA-BILLING               VALUE '1'.
   970
   971         16  PI-MAIL-PROCESSING          PIC X.
   972             88  PI-MAIL-YES                 VALUE 'Y'.
   973
   974         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   975
   976         16  PI-AR-SYSTEM.
   977             20  PI-AR-PROCESSING-CNTL   PIC X.
   978                 88  PI-AR-PROCESSING        VALUE 'Y'.
   979             20  PI-AR-SUMMARY-CODE      PIC X(6).
   980             20  PI-AR-MONTH-END-DT      PIC XX.
   981
   982         16  PI-MP-SYSTEM.
   983             20  PI-MORTGAGE-USER            PIC X.
   984                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   985                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   986             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   987                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   988                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   989                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   990                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   991                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   992             20  PI-MP-MONTH-END-DT          PIC XX.
   993             20  PI-MP-REFERENCE-NO.
   994                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   995                 24  PI-MP-REFERENCE-SFX     PIC XX.
   996
   997         16  PI-LABEL-CONTROL            PIC X(01).
   998             88  PI-CREATE-LABELS                    VALUE 'Y'.
   999             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1000
  1001         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1002             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1003
  1004         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1005             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1006             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1007
  1008         16  FILLER                      PIC X(14).
  1009
  1010     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1011******************************************************************
  1012     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1013         16  PI-MSTR-DT               PIC XX.
  1014         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1015         16  PI-TRLR-DT               PIC XX.
  1016         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1017         16  PI-LAST-CLAIM            PIC X(7).
  1018         16  PI-LAST-CARR             PIC X.
  1019         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  23
* EL130.cbl
  1020             20  PI-LAST-CERT-PRIME   PIC X(10).
  1021             20  PI-LAST-CERT-SUFX    PIC X.
  1022         16  PI-LAST-CLAIM-TYPE       PIC X.
  1023         16  PI-CURSOR                PIC S9(4)   COMP.
  1024         16  PI-SAVE-CERT.
  1025             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1026             20  PI-SAVE-CERT-SUFX    PIC X.
  1027         16  PI-SAVE-EFFDT            PIC X(2).
  1028         16  PI-SAVE-ACCOUNT          PIC X(10).
  1029         16  PI-INCURR-SW             PIC X.
  1030         16  PI-PRT-OPT               PIC X.
  1031         16  PI-ALT-PRT               PIC X(4).
  1032         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1033             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1034         16  FILLER                   PIC X(272).
  1035         16  PI-EL127-TO-EL130-CNTRL.
  1036             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1037             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1038             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1039                 24  PI-EL127-CARRIER        PIC X.
  1040                 24  PI-EL127-GROUPING       PIC X(6).
  1041                 24  PI-EL127-STATE          PIC X(2).
  1042                 24  PI-EL127-ACCOUNT        PIC X(10).
  1043                 24  PI-EL127-CERT-NO.
  1044                     28  PI-EL127-CERT-PRIME PIC X(10).
  1045                     28  PI-EL127-CERT-SUFX  PIC X.
  1046                 24  PI-EL127-EFF-DT         PIC XX.
  1047*        16  FILLER                          PIC X(50).
  1048         16  FILLER                          PIC X(31).
  1049         16  PI-EL659-TO-EL130-CNTRL.
  1050             20  PI-EL659-CARRIER            PIC X.
  1051             20  PI-EL659-GROUPING           PIC X(6).
  1052             20  PI-EL659-STATE              PIC XX.
  1053             20  PI-EL659-ACCOUNT            PIC X(10).
  1054
  1055         16  FILLER                          PIC X(19).
  1056
  1057         16  PI-SAVE-INCUR-DT                PIC X(02).
  1058         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1059*         16  FILLER                          PIC X(65).
  1060         16  PI-ST-VFY-2ND-BENE              PIC X.
  1061         16  PI-ST-CAUSAL-STATE              PIC X.
  1062         16  FILLER                          PIC X(63).
  1063
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  24
* EL130.cbl
  1065*    COPY EL130S.
  1066 01  EL130AI.
  1067     05  FILLER            PIC  X(0012).
  1068*    -------------------------------
  1069     05  RUNDTEL PIC S9(0004) COMP.
  1070     05  RUNDTEF PIC  X(0001).
  1071     05  FILLER REDEFINES RUNDTEF.
  1072         10  RUNDTEA PIC  X(0001).
  1073     05  RUNDTEI PIC  X(0008).
  1074*    -------------------------------
  1075     05  RUNTIMEL PIC S9(0004) COMP.
  1076     05  RUNTIMEF PIC  X(0001).
  1077     05  FILLER REDEFINES RUNTIMEF.
  1078         10  RUNTIMEA PIC  X(0001).
  1079     05  RUNTIMEI PIC  X(0005).
  1080*    -------------------------------
  1081     05  COMPL PIC S9(0004) COMP.
  1082     05  COMPF PIC  X(0001).
  1083     05  FILLER REDEFINES COMPF.
  1084         10  COMPA PIC  X(0001).
  1085     05  COMPI PIC  X(0003).
  1086*    -------------------------------
  1087     05  SEQUL PIC S9(0004) COMP.
  1088     05  SEQUF PIC  X(0001).
  1089     05  FILLER REDEFINES SEQUF.
  1090         10  SEQUA PIC  X(0001).
  1091     05  SEQUI PIC  X(0010).
  1092*    -------------------------------
  1093     05  MAINTL PIC S9(0004) COMP.
  1094     05  MAINTF PIC  X(0001).
  1095     05  FILLER REDEFINES MAINTF.
  1096         10  MAINTA PIC  X(0001).
  1097     05  MAINTI PIC  X(0001).
  1098*    -------------------------------
  1099     05  CLMNOL PIC S9(0004) COMP.
  1100     05  CLMNOF PIC  X(0001).
  1101     05  FILLER REDEFINES CLMNOF.
  1102         10  CLMNOA PIC  X(0001).
  1103     05  CLMNOI PIC  X(0007).
  1104*    -------------------------------
  1105     05  CLMCARRL PIC S9(0004) COMP.
  1106     05  CLMCARRF PIC  X(0001).
  1107     05  FILLER REDEFINES CLMCARRF.
  1108         10  CLMCARRA PIC  X(0001).
  1109     05  CLMCARRI PIC  X(0001).
  1110*    -------------------------------
  1111     05  CLMTYPEL PIC S9(0004) COMP.
  1112     05  CLMTYPEF PIC  X(0001).
  1113     05  FILLER REDEFINES CLMTYPEF.
  1114         10  CLMTYPEA PIC  X(0001).
  1115     05  CLMTYPEI PIC  X(0001).
  1116*    -------------------------------
  1117     05  CERTNOL PIC S9(0004) COMP.
  1118     05  CERTNOF PIC  X(0001).
  1119     05  FILLER REDEFINES CERTNOF.
  1120         10  CERTNOA PIC  X(0001).
  1121     05  CERTNOI PIC  X(0010).
  1122*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  25
* EL130.cbl
  1123     05  SUFXL PIC S9(0004) COMP.
  1124     05  SUFXF PIC  X(0001).
  1125     05  FILLER REDEFINES SUFXF.
  1126         10  SUFXA PIC  X(0001).
  1127     05  SUFXI PIC  X(0001).
  1128*    -------------------------------
  1129     05  PCERTNOL PIC S9(0004) COMP.
  1130     05  PCERTNOF PIC  X(0001).
  1131     05  FILLER REDEFINES PCERTNOF.
  1132         10  PCERTNOA PIC  X(0001).
  1133     05  PCERTNOI PIC  X(0010).
  1134*    -------------------------------
  1135     05  PSUFXL PIC S9(0004) COMP.
  1136     05  PSUFXF PIC  X(0001).
  1137     05  FILLER REDEFINES PSUFXF.
  1138         10  PSUFXA PIC  X(0001).
  1139     05  PSUFXI PIC  X(0001).
  1140*    -------------------------------
  1141     05  INCURL PIC S9(0004) COMP.
  1142     05  INCURF PIC  X(0001).
  1143     05  FILLER REDEFINES INCURF.
  1144         10  INCURA PIC  X(0001).
  1145     05  INCURI PIC  X(0008).
  1146*    -------------------------------
  1147     05  REPORTL PIC S9(0004) COMP.
  1148     05  REPORTF PIC  X(0001).
  1149     05  FILLER REDEFINES REPORTF.
  1150         10  REPORTA PIC  X(0001).
  1151     05  REPORTI PIC  X(0008).
  1152*    -------------------------------
  1153     05  CAUSEL PIC S9(0004) COMP.
  1154     05  CAUSEF PIC  X(0001).
  1155     05  FILLER REDEFINES CAUSEF.
  1156         10  CAUSEA PIC  X(0001).
  1157     05  CAUSEI PIC  X(0006).
  1158*    -------------------------------
  1159     05  ESTENDL PIC S9(0004) COMP.
  1160     05  ESTENDF PIC  X(0001).
  1161     05  FILLER REDEFINES ESTENDF.
  1162         10  ESTENDA PIC  X(0001).
  1163     05  ESTENDI PIC  X(0008).
  1164*    -------------------------------
  1165     05  DIAGL PIC S9(0004) COMP.
  1166     05  DIAGF PIC  X(0001).
  1167     05  FILLER REDEFINES DIAGF.
  1168         10  DIAGA PIC  X(0001).
  1169     05  DIAGI PIC  X(0060).
  1170*    -------------------------------
  1171     05  BENECDL PIC S9(0004) COMP.
  1172     05  BENECDF PIC  X(0001).
  1173     05  FILLER REDEFINES BENECDF.
  1174         10  BENECDA PIC  X(0001).
  1175     05  BENECDI PIC  X(0010).
  1176*    -------------------------------
  1177     05  BIRTHDTL PIC S9(0004) COMP.
  1178     05  BIRTHDTF PIC  X(0001).
  1179     05  FILLER REDEFINES BIRTHDTF.
  1180         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  26
* EL130.cbl
  1181     05  BIRTHDTI PIC  X(0008).
  1182*    -------------------------------
  1183     05  SSNL PIC S9(0004) COMP.
  1184     05  SSNF PIC  X(0001).
  1185     05  FILLER REDEFINES SSNF.
  1186         10  SSNA PIC  X(0001).
  1187     05  SSNI PIC  X(0011).
  1188*    -------------------------------
  1189     05  SEXL PIC S9(0004) COMP.
  1190     05  SEXF PIC  X(0001).
  1191     05  FILLER REDEFINES SEXF.
  1192         10  SEXA PIC  X(0001).
  1193     05  SEXI PIC  X(0001).
  1194*    -------------------------------
  1195     05  OCCCDL PIC S9(0004) COMP.
  1196     05  OCCCDF PIC  X(0001).
  1197     05  FILLER REDEFINES OCCCDF.
  1198         10  OCCCDA PIC  X(0001).
  1199     05  OCCCDI PIC  X(0006).
  1200*    -------------------------------
  1201     05  LSTNMEL PIC S9(0004) COMP.
  1202     05  LSTNMEF PIC  X(0001).
  1203     05  FILLER REDEFINES LSTNMEF.
  1204         10  LSTNMEA PIC  X(0001).
  1205     05  LSTNMEI PIC  X(0015).
  1206*    -------------------------------
  1207     05  FSTNMEL PIC S9(0004) COMP.
  1208     05  FSTNMEF PIC  X(0001).
  1209     05  FILLER REDEFINES FSTNMEF.
  1210         10  FSTNMEA PIC  X(0001).
  1211     05  FSTNMEI PIC  X(0012).
  1212*    -------------------------------
  1213     05  INITL PIC S9(0004) COMP.
  1214     05  INITF PIC  X(0001).
  1215     05  FILLER REDEFINES INITF.
  1216         10  INITA PIC  X(0001).
  1217     05  INITI PIC  X(0001).
  1218*    -------------------------------
  1219     05  LOANNOL PIC S9(0004) COMP.
  1220     05  LOANNOF PIC  X(0001).
  1221     05  FILLER REDEFINES LOANNOF.
  1222         10  LOANNOA PIC  X(0001).
  1223     05  LOANNOI PIC  X(0008).
  1224*    -------------------------------
  1225     05  CRTLNMEL PIC S9(0004) COMP.
  1226     05  CRTLNMEF PIC  X(0001).
  1227     05  FILLER REDEFINES CRTLNMEF.
  1228         10  CRTLNMEA PIC  X(0001).
  1229     05  CRTLNMEI PIC  X(0015).
  1230*    -------------------------------
  1231     05  CRTFNMEL PIC S9(0004) COMP.
  1232     05  CRTFNMEF PIC  X(0001).
  1233     05  FILLER REDEFINES CRTFNMEF.
  1234         10  CRTFNMEA PIC  X(0001).
  1235     05  CRTFNMEI PIC  X(0012).
  1236*    -------------------------------
  1237     05  CRTINITL PIC S9(0004) COMP.
  1238     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  27
* EL130.cbl
  1239     05  FILLER REDEFINES CRTINITF.
  1240         10  CRTINITA PIC  X(0001).
  1241     05  CRTINITI PIC  X(0001).
  1242*    -------------------------------
  1243     05  LOANBALL PIC S9(0004) COMP.
  1244     05  LOANBALF PIC  X(0001).
  1245     05  FILLER REDEFINES LOANBALF.
  1246         10  LOANBALA PIC  X(0001).
  1247     05  LOANBALI PIC  9(7)V99.
  1248*    -------------------------------
  1249     05  MANRSVL PIC S9(0004) COMP.
  1250     05  MANRSVF PIC  X(0001).
  1251     05  FILLER REDEFINES MANRSVF.
  1252         10  MANRSVA PIC  X(0001).
  1253     05  MANRSVI PIC  9(7)V99.
  1254*    -------------------------------
  1255     05  SUPVL PIC S9(0004) COMP.
  1256     05  SUPVF PIC  X(0001).
  1257     05  FILLER REDEFINES SUPVF.
  1258         10  SUPVA PIC  X(0001).
  1259     05  SUPVI PIC  X(0001).
  1260*    -------------------------------
  1261     05  PRICDL PIC S9(0004) COMP.
  1262     05  PRICDF PIC  X(0001).
  1263     05  FILLER REDEFINES PRICDF.
  1264         10  PRICDA PIC  X(0001).
  1265     05  PRICDI PIC  X(0001).
  1266*    -------------------------------
  1267     05  PRODL PIC S9(0004) COMP.
  1268     05  PRODF PIC  X(0001).
  1269     05  FILLER REDEFINES PRODF.
  1270         10  PRODA PIC  X(0001).
  1271     05  PRODI PIC  X(0008).
  1272*    -------------------------------
  1273     05  PRODCDL PIC S9(0004) COMP.
  1274     05  PRODCDF PIC  X(0001).
  1275     05  FILLER REDEFINES PRODCDF.
  1276         10  PRODCDA PIC  X(0001).
  1277     05  PRODCDI PIC  X(0001).
  1278*    -------------------------------
  1279     05  FILETOL PIC S9(0004) COMP.
  1280     05  FILETOF PIC  X(0001).
  1281     05  FILLER REDEFINES FILETOF.
  1282         10  FILETOA PIC  X(0001).
  1283     05  FILETOI PIC  X(0004).
  1284*    -------------------------------
  1285     05  PROCCDL PIC S9(0004) COMP.
  1286     05  PROCCDF PIC  X(0001).
  1287     05  FILLER REDEFINES PROCCDF.
  1288         10  PROCCDA PIC  X(0001).
  1289     05  PROCCDI PIC  X(0004).
  1290*    -------------------------------
  1291     05  RELCLML PIC S9(0004) COMP.
  1292     05  RELCLMF PIC  X(0001).
  1293     05  FILLER REDEFINES RELCLMF.
  1294         10  RELCLMA PIC  X(0001).
  1295     05  RELCLMI PIC  X(0007).
  1296*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  28
* EL130.cbl
  1297     05  PRTOPTL PIC S9(0004) COMP.
  1298     05  PRTOPTF PIC  X(0001).
  1299     05  FILLER REDEFINES PRTOPTF.
  1300         10  PRTOPTA PIC  X(0001).
  1301     05  PRTOPTI PIC  X(0001).
  1302*    -------------------------------
  1303     05  ALTPRTL PIC S9(0004) COMP.
  1304     05  ALTPRTF PIC  X(0001).
  1305     05  FILLER REDEFINES ALTPRTF.
  1306         10  ALTPRTA PIC  X(0001).
  1307     05  ALTPRTI PIC  X(0004).
  1308*    -------------------------------
  1309     05  CERTMTL PIC S9(0004) COMP.
  1310     05  CERTMTF PIC  X(0001).
  1311     05  FILLER REDEFINES CERTMTF.
  1312         10  CERTMTA PIC  X(0001).
  1313     05  CERTMTI PIC  X(0001).
  1314*    -------------------------------
  1315     05  CRTCARRL PIC S9(0004) COMP.
  1316     05  CRTCARRF PIC  X(0001).
  1317     05  FILLER REDEFINES CRTCARRF.
  1318         10  CRTCARRA PIC  X(0001).
  1319     05  CRTCARRI PIC  X(0001).
  1320*    -------------------------------
  1321     05  GROUPL PIC S9(0004) COMP.
  1322     05  GROUPF PIC  X(0001).
  1323     05  FILLER REDEFINES GROUPF.
  1324         10  GROUPA PIC  X(0001).
  1325     05  GROUPI PIC  X(0006).
  1326*    -------------------------------
  1327     05  STATEL PIC S9(0004) COMP.
  1328     05  STATEF PIC  X(0001).
  1329     05  FILLER REDEFINES STATEF.
  1330         10  STATEA PIC  X(0001).
  1331     05  STATEI PIC  X(0002).
  1332*    -------------------------------
  1333     05  ACCOUNTL PIC S9(0004) COMP.
  1334     05  ACCOUNTF PIC  X(0001).
  1335     05  FILLER REDEFINES ACCOUNTF.
  1336         10  ACCOUNTA PIC  X(0001).
  1337     05  ACCOUNTI PIC  X(0010).
  1338*    -------------------------------
  1339     05  EFFDTL PIC S9(0004) COMP.
  1340     05  EFFDTF PIC  X(0001).
  1341     05  FILLER REDEFINES EFFDTF.
  1342         10  EFFDTA PIC  X(0001).
  1343     05  EFFDTI PIC  X(0008).
  1344*    -------------------------------
  1345     05  CRTSSNL PIC S9(0004) COMP.
  1346     05  CRTSSNF PIC  X(0001).
  1347     05  FILLER REDEFINES CRTSSNF.
  1348         10  CRTSSNA PIC  X(0001).
  1349     05  CRTSSNI PIC  X(0011).
  1350*    -------------------------------
  1351     05  MEMCAPL PIC S9(0004) COMP.
  1352     05  MEMCAPF PIC  X(0001).
  1353     05  FILLER REDEFINES MEMCAPF.
  1354         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  29
* EL130.cbl
  1355     05  MEMCAPI PIC  X(0010).
  1356*    -------------------------------
  1357     05  MEMBERL PIC S9(0004) COMP.
  1358     05  MEMBERF PIC  X(0001).
  1359     05  FILLER REDEFINES MEMBERF.
  1360         10  MEMBERA PIC  X(0001).
  1361     05  MEMBERI PIC  X(0012).
  1362*    -------------------------------
  1363     05  REINCDL PIC S9(0004) COMP.
  1364     05  REINCDF PIC  X(0001).
  1365     05  FILLER REDEFINES REINCDF.
  1366         10  REINCDA PIC  X(0001).
  1367     05  REINCDI PIC  X(0001).
  1368*    -------------------------------
  1369     05  ISSAGEL PIC S9(0004) COMP.
  1370     05  ISSAGEF PIC  X(0001).
  1371     05  FILLER REDEFINES ISSAGEF.
  1372         10  ISSAGEA PIC  X(0001).
  1373     05  ISSAGEI PIC  X(0002).
  1374*    -------------------------------
  1375     05  APRL PIC S9(0004) COMP.
  1376     05  APRF PIC  X(0001).
  1377     05  FILLER REDEFINES APRF.
  1378         10  APRA PIC  X(0001).
  1379     05  APRI PIC  9(4)V9(4).
  1380*    -------------------------------
  1381     05  PMTFREQL PIC S9(0004) COMP.
  1382     05  PMTFREQF PIC  X(0001).
  1383     05  FILLER REDEFINES PMTFREQF.
  1384         10  PMTFREQA PIC  X(0001).
  1385     05  PMTFREQI PIC  99.
  1386*    -------------------------------
  1387     05  INDGRPL PIC S9(0004) COMP.
  1388     05  INDGRPF PIC  X(0001).
  1389     05  FILLER REDEFINES INDGRPF.
  1390         10  INDGRPA PIC  X(0001).
  1391     05  INDGRPI PIC  X(0001).
  1392*    -------------------------------
  1393     05  PREMTYPL PIC S9(0004) COMP.
  1394     05  PREMTYPF PIC  X(0001).
  1395     05  FILLER REDEFINES PREMTYPF.
  1396         10  PREMTYPA PIC  X(0001).
  1397     05  PREMTYPI PIC  X(0001).
  1398*    -------------------------------
  1399     05  ADDONDTL PIC S9(0004) COMP.
  1400     05  ADDONDTF PIC  X(0001).
  1401     05  FILLER REDEFINES ADDONDTF.
  1402         10  ADDONDTA PIC  X(0001).
  1403     05  ADDONDTI PIC  X(0008).
  1404*    -------------------------------
  1405     05  JNTLNMEL PIC S9(0004) COMP.
  1406     05  JNTLNMEF PIC  X(0001).
  1407     05  FILLER REDEFINES JNTLNMEF.
  1408         10  JNTLNMEA PIC  X(0001).
  1409     05  JNTLNMEI PIC  X(0015).
  1410*    -------------------------------
  1411     05  JNTFNMEL PIC S9(0004) COMP.
  1412     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  30
* EL130.cbl
  1413     05  FILLER REDEFINES JNTFNMEF.
  1414         10  JNTFNMEA PIC  X(0001).
  1415     05  JNTFNMEI PIC  X(0002).
  1416*    -------------------------------
  1417     05  JNTINITL PIC S9(0004) COMP.
  1418     05  JNTINITF PIC  X(0001).
  1419     05  FILLER REDEFINES JNTINITF.
  1420         10  JNTINITA PIC  X(0001).
  1421     05  JNTINITI PIC  X(0001).
  1422*    -------------------------------
  1423     05  JNTAGEL PIC S9(0004) COMP.
  1424     05  JNTAGEF PIC  X(0001).
  1425     05  FILLER REDEFINES JNTAGEF.
  1426         10  JNTAGEA PIC  X(0001).
  1427     05  JNTAGEI PIC  X(0002).
  1428*    -------------------------------
  1429     05  LCVDSCRL PIC S9(0004) COMP.
  1430     05  LCVDSCRF PIC  X(0001).
  1431     05  FILLER REDEFINES LCVDSCRF.
  1432         10  LCVDSCRA PIC  X(0001).
  1433     05  LCVDSCRI PIC  X(0006).
  1434*    -------------------------------
  1435     05  LCVKINDL PIC S9(0004) COMP.
  1436     05  LCVKINDF PIC  X(0001).
  1437     05  FILLER REDEFINES LCVKINDF.
  1438         10  LCVKINDA PIC  X(0001).
  1439     05  LCVKINDI PIC  X(0003).
  1440*    -------------------------------
  1441     05  LCVCDL PIC S9(0004) COMP.
  1442     05  LCVCDF PIC  X(0001).
  1443     05  FILLER REDEFINES LCVCDF.
  1444         10  LCVCDA PIC  X(0001).
  1445     05  LCVCDI PIC  X(0002).
  1446*    -------------------------------
  1447     05  LCVOTRML PIC S9(0004) COMP.
  1448     05  LCVOTRMF PIC  X(0001).
  1449     05  FILLER REDEFINES LCVOTRMF.
  1450         10  LCVOTRMA PIC  X(0001).
  1451     05  LCVOTRMI PIC  999.
  1452*    -------------------------------
  1453     05  LCVRTRML PIC S9(0004) COMP.
  1454     05  LCVRTRMF PIC  X(0001).
  1455     05  FILLER REDEFINES LCVRTRMF.
  1456         10  LCVRTRMA PIC  X(0001).
  1457     05  LCVRTRMI PIC  X(0003).
  1458*    -------------------------------
  1459     05  LCVRATEL PIC S9(0004) COMP.
  1460     05  LCVRATEF PIC  X(0001).
  1461     05  FILLER REDEFINES LCVRATEF.
  1462         10  LCVRATEA PIC  X(0001).
  1463     05  LCVRATEI PIC  9999V99.
  1464*    -------------------------------
  1465     05  LCVBENEL PIC S9(0004) COMP.
  1466     05  LCVBENEF PIC  X(0001).
  1467     05  FILLER REDEFINES LCVBENEF.
  1468         10  LCVBENEA PIC  X(0001).
  1469     05  LCVBENEI PIC  9(9)V99.
  1470*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  31
* EL130.cbl
  1471     05  LCVFORML PIC S9(0004) COMP.
  1472     05  LCVFORMF PIC  X(0001).
  1473     05  FILLER REDEFINES LCVFORMF.
  1474         10  LCVFORMA PIC  X(0001).
  1475     05  LCVFORMI PIC  X(0012).
  1476*    -------------------------------
  1477     05  LCVCNDTL PIC S9(0004) COMP.
  1478     05  LCVCNDTF PIC  X(0001).
  1479     05  FILLER REDEFINES LCVCNDTF.
  1480         10  LCVCNDTA PIC  X(0001).
  1481     05  LCVCNDTI PIC  X(0008).
  1482*    -------------------------------
  1483     05  LCVEXITL PIC S9(0004) COMP.
  1484     05  LCVEXITF PIC  X(0001).
  1485     05  FILLER REDEFINES LCVEXITF.
  1486         10  LCVEXITA PIC  X(0001).
  1487     05  LCVEXITI PIC  X(0008).
  1488*    -------------------------------
  1489     05  LCVSTATL PIC S9(0004) COMP.
  1490     05  LCVSTATF PIC  X(0001).
  1491     05  FILLER REDEFINES LCVSTATF.
  1492         10  LCVSTATA PIC  X(0001).
  1493     05  LCVSTATI PIC  X(0006).
  1494*    -------------------------------
  1495     05  ACVDSCRL PIC S9(0004) COMP.
  1496     05  ACVDSCRF PIC  X(0001).
  1497     05  FILLER REDEFINES ACVDSCRF.
  1498         10  ACVDSCRA PIC  X(0001).
  1499     05  ACVDSCRI PIC  X(0006).
  1500*    -------------------------------
  1501     05  ACVKINDL PIC S9(0004) COMP.
  1502     05  ACVKINDF PIC  X(0001).
  1503     05  FILLER REDEFINES ACVKINDF.
  1504         10  ACVKINDA PIC  X(0001).
  1505     05  ACVKINDI PIC  X(0003).
  1506*    -------------------------------
  1507     05  ACVCDL PIC S9(0004) COMP.
  1508     05  ACVCDF PIC  X(0001).
  1509     05  FILLER REDEFINES ACVCDF.
  1510         10  ACVCDA PIC  X(0001).
  1511     05  ACVCDI PIC  X(0002).
  1512*    -------------------------------
  1513     05  ACVOTRML PIC S9(0004) COMP.
  1514     05  ACVOTRMF PIC  X(0001).
  1515     05  FILLER REDEFINES ACVOTRMF.
  1516         10  ACVOTRMA PIC  X(0001).
  1517     05  ACVOTRMI PIC  999.
  1518*    -------------------------------
  1519     05  ACVRTRML PIC S9(0004) COMP.
  1520     05  ACVRTRMF PIC  X(0001).
  1521     05  FILLER REDEFINES ACVRTRMF.
  1522         10  ACVRTRMA PIC  X(0001).
  1523     05  ACVRTRMI PIC  X(0003).
  1524*    -------------------------------
  1525     05  ACVRATEL PIC S9(0004) COMP.
  1526     05  ACVRATEF PIC  X(0001).
  1527     05  FILLER REDEFINES ACVRATEF.
  1528         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  32
* EL130.cbl
  1529     05  ACVRATEI PIC  9999V99.
  1530*    -------------------------------
  1531     05  ACVBENEL PIC S9(0004) COMP.
  1532     05  ACVBENEF PIC  X(0001).
  1533     05  FILLER REDEFINES ACVBENEF.
  1534         10  ACVBENEA PIC  X(0001).
  1535     05  ACVBENEI PIC  9(9)V99.
  1536*    -------------------------------
  1537     05  ACVFORML PIC S9(0004) COMP.
  1538     05  ACVFORMF PIC  X(0001).
  1539     05  FILLER REDEFINES ACVFORMF.
  1540         10  ACVFORMA PIC  X(0001).
  1541     05  ACVFORMI PIC  X(0012).
  1542*    -------------------------------
  1543     05  ACVCNDTL PIC S9(0004) COMP.
  1544     05  ACVCNDTF PIC  X(0001).
  1545     05  FILLER REDEFINES ACVCNDTF.
  1546         10  ACVCNDTA PIC  X(0001).
  1547     05  ACVCNDTI PIC  X(0008).
  1548*    -------------------------------
  1549     05  ACVEXITL PIC S9(0004) COMP.
  1550     05  ACVEXITF PIC  X(0001).
  1551     05  FILLER REDEFINES ACVEXITF.
  1552         10  ACVEXITA PIC  X(0001).
  1553     05  ACVEXITI PIC  X(0008).
  1554*    -------------------------------
  1555     05  ACVSTATL PIC S9(0004) COMP.
  1556     05  ACVSTATF PIC  X(0001).
  1557     05  FILLER REDEFINES ACVSTATF.
  1558         10  ACVSTATA PIC  X(0001).
  1559     05  ACVSTATI PIC  X(0006).
  1560*    -------------------------------
  1561     05  ERRMSG1L PIC S9(0004) COMP.
  1562     05  ERRMSG1F PIC  X(0001).
  1563     05  FILLER REDEFINES ERRMSG1F.
  1564         10  ERRMSG1A PIC  X(0001).
  1565     05  ERRMSG1I PIC  X(0072).
  1566*    -------------------------------
  1567     05  ERRMSG2L PIC S9(0004) COMP.
  1568     05  ERRMSG2F PIC  X(0001).
  1569     05  FILLER REDEFINES ERRMSG2F.
  1570         10  ERRMSG2A PIC  X(0001).
  1571     05  ERRMSG2I PIC  X(0072).
  1572*    -------------------------------
  1573     05  BCERT1L PIC S9(0004) COMP.
  1574     05  BCERT1F PIC  X(0001).
  1575     05  FILLER REDEFINES BCERT1F.
  1576         10  BCERT1A PIC  X(0001).
  1577     05  BCERT1I PIC  X(0010).
  1578*    -------------------------------
  1579     05  BSUFX1L PIC S9(0004) COMP.
  1580     05  BSUFX1F PIC  X(0001).
  1581     05  FILLER REDEFINES BSUFX1F.
  1582         10  BSUFX1A PIC  X(0001).
  1583     05  BSUFX1I PIC  X(0001).
  1584*    -------------------------------
  1585     05  BCERT2L PIC S9(0004) COMP.
  1586     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  33
* EL130.cbl
  1587     05  FILLER REDEFINES BCERT2F.
  1588         10  BCERT2A PIC  X(0001).
  1589     05  BCERT2I PIC  X(0010).
  1590*    -------------------------------
  1591     05  BSUFX2L PIC S9(0004) COMP.
  1592     05  BSUFX2F PIC  X(0001).
  1593     05  FILLER REDEFINES BSUFX2F.
  1594         10  BSUFX2A PIC  X(0001).
  1595     05  BSUFX2I PIC  X(0001).
  1596*    -------------------------------
  1597     05  BCERT3L PIC S9(0004) COMP.
  1598     05  BCERT3F PIC  X(0001).
  1599     05  FILLER REDEFINES BCERT3F.
  1600         10  BCERT3A PIC  X(0001).
  1601     05  BCERT3I PIC  X(0010).
  1602*    -------------------------------
  1603     05  BSUFX3L PIC S9(0004) COMP.
  1604     05  BSUFX3F PIC  X(0001).
  1605     05  FILLER REDEFINES BSUFX3F.
  1606         10  BSUFX3A PIC  X(0001).
  1607     05  BSUFX3I PIC  X(0001).
  1608*    -------------------------------
  1609     05  BCERT4L PIC S9(0004) COMP.
  1610     05  BCERT4F PIC  X(0001).
  1611     05  FILLER REDEFINES BCERT4F.
  1612         10  BCERT4A PIC  X(0001).
  1613     05  BCERT4I PIC  X(0010).
  1614*    -------------------------------
  1615     05  BSUFX4L PIC S9(0004) COMP.
  1616     05  BSUFX4F PIC  X(0001).
  1617     05  FILLER REDEFINES BSUFX4F.
  1618         10  BSUFX4A PIC  X(0001).
  1619     05  BSUFX4I PIC  X(0001).
  1620*    -------------------------------
  1621     05  BCERT5L PIC S9(0004) COMP.
  1622     05  BCERT5F PIC  X(0001).
  1623     05  FILLER REDEFINES BCERT5F.
  1624         10  BCERT5A PIC  X(0001).
  1625     05  BCERT5I PIC  X(0010).
  1626*    -------------------------------
  1627     05  BSUFX5L PIC S9(0004) COMP.
  1628     05  BSUFX5F PIC  X(0001).
  1629     05  FILLER REDEFINES BSUFX5F.
  1630         10  BSUFX5A PIC  X(0001).
  1631     05  BSUFX5I PIC  X(0001).
  1632*    -------------------------------
  1633     05  ENTERPFL PIC S9(0004) COMP.
  1634     05  ENTERPFF PIC  X(0001).
  1635     05  FILLER REDEFINES ENTERPFF.
  1636         10  ENTERPFA PIC  X(0001).
  1637     05  ENTERPFI PIC  99.
  1638*    -------------------------------
  1639     05  PF5L PIC S9(0004) COMP.
  1640     05  PF5F PIC  X(0001).
  1641     05  FILLER REDEFINES PF5F.
  1642         10  PF5A PIC  X(0001).
  1643     05  PF5I PIC  X(0013).
  1644 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  34
* EL130.cbl
  1645     05  FILLER            PIC  X(0012).
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  RUNDTEO PIC  X(0008).
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  RUNTIMEO PIC  99.99.
  1652*    -------------------------------
  1653     05  FILLER            PIC  X(0003).
  1654     05  COMPO PIC  X(0003).
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
  1657     05  SEQUO PIC  X(0010).
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  MAINTO PIC  X(0001).
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
  1663     05  CLMNOO PIC  X(0007).
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  CLMCARRO PIC  X(0001).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  CLMTYPEO PIC  X(0001).
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  CERTNOO PIC  X(0010).
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  SUFXO PIC  X(0001).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  PCERTNOO PIC  X(0010).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  PSUFXO PIC  X(0001).
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  INCURO PIC  X(0008).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  REPORTO PIC  X(0008).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  CAUSEO PIC  X(0006).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  ESTENDO PIC  X(0008).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  DIAGO PIC  X(0060).
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  BENECDO PIC  X(0010).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  35
* EL130.cbl
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  SSNO PIC  X(0011).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  SEXO PIC  X(0001).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  OCCCDO PIC  X(0006).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  LSTNMEO PIC  X(0015).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  FSTNMEO PIC  X(0012).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  INITO PIC  X(0001).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  LOANNOO PIC  X(0008).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  CRTLNMEO PIC  X(0015).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  CRTFNMEO PIC  X(0012).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  CRTINITO PIC  X(0001).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  LOANBALO PIC  ZZZZZ9.99.
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  MANRSVO PIC  Z(5)9.99.
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  SUPVO PIC  X(0001).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  PRICDO PIC  X(0001).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  PRODO PIC  X(0008).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  PRODCDO PIC  X(0001).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  FILETOO PIC  X(0004).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  PROCCDO PIC  X(0004).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  RELCLMO PIC  X(0007).
  1760*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  36
* EL130.cbl
  1761     05  FILLER            PIC  X(0003).
  1762     05  PRTOPTO PIC  X(0001).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  ALTPRTO PIC  X(0004).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  CERTMTO PIC  X(0001).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  CRTCARRO PIC  X(0001).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  GROUPO PIC  X(0006).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  STATEO PIC  X(0002).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  ACCOUNTO PIC  X(0010).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  EFFDTO PIC  X(0008).
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  CRTSSNO PIC  X(0011).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
  1789     05  MEMCAPO PIC  X(0010).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  MEMBERO PIC  X(0012).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  REINCDO PIC  X(0001).
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  ISSAGEO PIC  X(0002).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  APRO PIC  9(3).9(4).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  PMTFREQO PIC  99.
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  INDGRPO PIC  X(0001).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  PREMTYPO PIC  X(0001).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  ADDONDTO PIC  X(0008).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  JNTLNMEO PIC  X(0015).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  37
* EL130.cbl
  1819     05  JNTFNMEO PIC  X(0002).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  JNTINITO PIC  X(0001).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  JNTAGEO PIC  X(0002).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  LCVDSCRO PIC  X(0006).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  LCVKINDO PIC  X(0003).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  LCVCDO PIC  X(0002).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  LCVOTRMO PIC  999.
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  LCVRTRMO PIC  ZZZ.
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  LCVRATEO PIC  ZZZ.ZZ.
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  LCVFORMO PIC  X(0012).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  LCVCNDTO PIC  X(0008).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  LCVEXITO PIC  X(0008).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  LCVSTATO PIC  X(0006).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  ACVDSCRO PIC  X(0006).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  ACVKINDO PIC  X(0003).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  ACVCDO PIC  X(0002).
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  ACVOTRMO PIC  999.
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  ACVRTRMO PIC  ZZZ.
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  38
* EL130.cbl
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  ACVFORMO PIC  X(0012).
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  ACVCNDTO PIC  X(0008).
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  ACVEXITO PIC  X(0008).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  ACVSTATO PIC  X(0006).
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  ERRMSG1O PIC  X(0072).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  ERRMSG2O PIC  X(0072).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  BCERT1O PIC  X(0010).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  BSUFX1O PIC  X(0001).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  BCERT2O PIC  X(0010).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  BSUFX2O PIC  X(0001).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  BCERT3O PIC  X(0010).
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  BSUFX3O PIC  X(0001).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  BCERT4O PIC  X(0010).
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  BSUFX4O PIC  X(0001).
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  BCERT5O PIC  X(0010).
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  BSUFX5O PIC  X(0001).
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  ENTERPFO PIC  X(0002).
  1931*    -------------------------------
  1932     05  FILLER            PIC  X(0003).
  1933     05  PF5O PIC  X(0013).
  1934*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  39
* EL130.cbl
  1936*    COPY ELCDATE.
  1937******************************************************************
  1938*                                                                *
  1939*                                                                *
  1940*                            ELCDATE.                            *
  1941*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1942*                            VMOD=2.003
  1943*                                                                *
  1944*                                                                *
  1945*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1946*                 LENGTH = 200                                   *
  1947******************************************************************
  1948
  1949 01  DATE-CONVERSION-DATA.
  1950     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1951     12  DC-OPTION-CODE                PIC X.
  1952         88  BIN-TO-GREG                VALUE ' '.
  1953         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1954         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1955         88  YMD-GREG-TO-BIN            VALUE '3'.
  1956         88  MDY-GREG-TO-BIN            VALUE '4'.
  1957         88  JULIAN-TO-BIN              VALUE '5'.
  1958         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1959         88  FIND-CENTURY               VALUE '7'.
  1960         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1961         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1962         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1963         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1964         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1965         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1966         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1967         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1968         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1969         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1970         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1971         88  BIN-3-TO-GREG              VALUE 'I'.
  1972         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1973         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1974         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1975         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1976         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1977         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1978         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1979         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1980         88  THREE-CHARACTER-BIN
  1981                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1982         88  GREGORIAN-TO-BIN
  1983                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1984         88  BIN-TO-GREGORIAN
  1985                  VALUES ' ' '1' 'I' '8' 'G'.
  1986         88  JULIAN-TO-BINARY
  1987                  VALUES '5' 'C' 'E' 'F'.
  1988     12  DC-ERROR-CODE                 PIC X.
  1989         88  NO-CONVERSION-ERROR        VALUE ' '.
  1990         88  DATE-CONVERSION-ERROR
  1991                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1992         88  DATE-IS-ZERO               VALUE '1'.
  1993         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  40
* EL130.cbl
  1994         88  DATE-IS-INVALID            VALUE '3'.
  1995         88  DATE1-GREATER-DATE2        VALUE '4'.
  1996         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1997         88  DATE-INVALID-OPTION        VALUE '9'.
  1998         88  INVALID-CENTURY            VALUE 'A'.
  1999         88  ONLY-CENTURY               VALUE 'B'.
  2000         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2001         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2002     12  DC-END-OF-MONTH               PIC X.
  2003         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2004     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2005         88  USE-NORMAL-PROCESS         VALUE ' '.
  2006         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2007         88  ADJUST-UP-100-YRS          VALUE '2'.
  2008     12  FILLER                        PIC X.
  2009     12  DC-CONVERSION-DATES.
  2010         16  DC-BIN-DATE-1             PIC XX.
  2011         16  DC-BIN-DATE-2             PIC XX.
  2012         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2013         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2014                       DC-GREG-DATE-1-EDIT.
  2015             20  DC-EDIT1-MONTH        PIC 99.
  2016             20  SLASH1-1              PIC X.
  2017             20  DC-EDIT1-DAY          PIC 99.
  2018             20  SLASH1-2              PIC X.
  2019             20  DC-EDIT1-YEAR         PIC 99.
  2020         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2021         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2022                     DC-GREG-DATE-2-EDIT.
  2023             20  DC-EDIT2-MONTH        PIC 99.
  2024             20  SLASH2-1              PIC X.
  2025             20  DC-EDIT2-DAY          PIC 99.
  2026             20  SLASH2-2              PIC X.
  2027             20  DC-EDIT2-YEAR         PIC 99.
  2028         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2029         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2030                     DC-GREG-DATE-1-YMD.
  2031             20  DC-YMD-YEAR           PIC 99.
  2032             20  DC-YMD-MONTH          PIC 99.
  2033             20  DC-YMD-DAY            PIC 99.
  2034         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2035         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2036                      DC-GREG-DATE-1-MDY.
  2037             20  DC-MDY-MONTH          PIC 99.
  2038             20  DC-MDY-DAY            PIC 99.
  2039             20  DC-MDY-YEAR           PIC 99.
  2040         16  DC-GREG-DATE-1-ALPHA.
  2041             20  DC-ALPHA-MONTH        PIC X(10).
  2042             20  DC-ALPHA-DAY          PIC 99.
  2043             20  FILLER                PIC XX.
  2044             20  DC-ALPHA-CENTURY.
  2045                 24 DC-ALPHA-CEN-N     PIC 99.
  2046             20  DC-ALPHA-YEAR         PIC 99.
  2047         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2048         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2049         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2050         16  DC-JULIAN-DATE            PIC 9(05).
  2051         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  41
* EL130.cbl
  2052                                       PIC 9(05).
  2053         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2054             20  DC-JULIAN-YEAR        PIC 99.
  2055             20  DC-JULIAN-DAYS        PIC 999.
  2056         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2057         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2058         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2059     12  DATE-CONVERSION-VARIBLES.
  2060         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2061         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2062             20  FILLER                PIC 9(3).
  2063             20  HOLD-CEN-1-CCYY.
  2064                 24  HOLD-CEN-1-CC     PIC 99.
  2065                 24  HOLD-CEN-1-YY     PIC 99.
  2066             20  HOLD-CEN-1-MO         PIC 99.
  2067             20  HOLD-CEN-1-DA         PIC 99.
  2068         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2069             20  HOLD-CEN-1-R-MO       PIC 99.
  2070             20  HOLD-CEN-1-R-DA       PIC 99.
  2071             20  HOLD-CEN-1-R-CCYY.
  2072                 24  HOLD-CEN-1-R-CC   PIC 99.
  2073                 24  HOLD-CEN-1-R-YY   PIC 99.
  2074             20  FILLER                PIC 9(3).
  2075         16  HOLD-CENTURY-1-X.
  2076             20  FILLER                PIC X(3)  VALUE SPACES.
  2077             20  HOLD-CEN-1-X-CCYY.
  2078                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2079                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2080             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2081             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2082         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2083             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2084             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2085             20  HOLD-CEN-1-R-X-CCYY.
  2086                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2087                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2088             20  FILLER                PIC XXX.
  2089         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2090         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2091         16  DC-JULIAN-DATE-1          PIC 9(07).
  2092         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2093             20  DC-JULIAN-1-CCYY.
  2094                 24  DC-JULIAN-1-CC    PIC 99.
  2095                 24  DC-JULIAN-1-YR    PIC 99.
  2096             20  DC-JULIAN-DA-1        PIC 999.
  2097         16  DC-JULIAN-DATE-2          PIC 9(07).
  2098         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2099             20  DC-JULIAN-2-CCYY.
  2100                 24  DC-JULIAN-2-CC    PIC 99.
  2101                 24  DC-JULIAN-2-YR    PIC 99.
  2102             20  DC-JULIAN-DA-2        PIC 999.
  2103         16  DC-GREG-DATE-A-EDIT.
  2104             20  DC-EDITA-MONTH        PIC 99.
  2105             20  SLASHA-1              PIC X VALUE '/'.
  2106             20  DC-EDITA-DAY          PIC 99.
  2107             20  SLASHA-2              PIC X VALUE '/'.
  2108             20  DC-EDITA-CCYY.
  2109                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  42
* EL130.cbl
  2110                 24  DC-EDITA-YEAR     PIC 99.
  2111         16  DC-GREG-DATE-B-EDIT.
  2112             20  DC-EDITB-MONTH        PIC 99.
  2113             20  SLASHB-1              PIC X VALUE '/'.
  2114             20  DC-EDITB-DAY          PIC 99.
  2115             20  SLASHB-2              PIC X VALUE '/'.
  2116             20  DC-EDITB-CCYY.
  2117                 24  DC-EDITB-CENT     PIC 99.
  2118                 24  DC-EDITB-YEAR     PIC 99.
  2119         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2120         16  DC-GREG-DATE-CYMD-R REDEFINES
  2121                              DC-GREG-DATE-CYMD.
  2122             20  DC-CYMD-CEN           PIC 99.
  2123             20  DC-CYMD-YEAR          PIC 99.
  2124             20  DC-CYMD-MONTH         PIC 99.
  2125             20  DC-CYMD-DAY           PIC 99.
  2126         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2127         16  DC-GREG-DATE-MDCY-R REDEFINES
  2128                              DC-GREG-DATE-MDCY.
  2129             20  DC-MDCY-MONTH         PIC 99.
  2130             20  DC-MDCY-DAY           PIC 99.
  2131             20  DC-MDCY-CEN           PIC 99.
  2132             20  DC-MDCY-YEAR          PIC 99.
  2133    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2134        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2135    12  DC-EL310-DATE                  PIC X(21).
  2136    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  43
* EL130.cbl
  2138*    COPY ELCCALC.
  2139******************************************************************
  2140*                                                                *
  2141*                           ELCCALC.                            *
  2142*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2143*                            VMOD=2.025                          *
  2144*                                                                *
  2145*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2146*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2147*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2148*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2149*                                                                *
  2150*  PASSED TO ELRTRM                                              *
  2151*  -----------------                                             *
  2152*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2153*  ORIGINAL TERM                                                 *
  2154*  BEGINNING DATE                                                *
  2155*  ENDING DATE                                                   *
  2156*  COMPANY I.D.                                                  *
  2157*  ACCOUNT MASTER USER FIELD                                     *
  2158*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2159*  FREE LOOK DAYS                                                *
  2160*                                                                *
  2161*  RETURNED FROM ELRTRM                                          *
  2162*  ---------------------                                         *
  2163*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2164*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2165*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2166*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2167*----------------------------------------------------------------*
  2168*  PASSED TO ELRAMT                                              *
  2169*  ----------------                                              *
  2170*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2171*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2172*  ORIGINAL AMOUNT                                               *
  2173*  ALTERNATE BENEFIT (BALLON)                                    *
  2174*  A.P.R. - NET PAY ONLY                                         *
  2175*  METHOD
  2176*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2177*  COMPANY I.D.                                                  *
  2178*  BENEFIT TYPE                                                  *
  2179*                                                                *
  2180*  RETURNED FROM ELRAMT                                          *
  2181*  --------------------                                          *
  2182*  REMAINING AMOUNT 1 - CURRENT                                  *
  2183*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2184*  REMAINING AMOUNT FACTOR
  2185*----------------------------------------------------------------*
  2186*  PASSED TO ELRESV                                              *
  2187*  -----------------                                             *
  2188*  CERTIFICATE EFFECTIVE DATE                                    *
  2189*  VALUATION DATE                                                *
  2190*  PAID THRU DATE                                                *
  2191*  BENEFIT                                                       *
  2192*  INCURRED DATE                                                 *
  2193*  REPORTED DATE                                                 *
  2194*  ISSUE AGE                                                     *
  2195*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  44
* EL130.cbl
  2196*  CDT PERCENT                                                   *
  2197*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2198* *CLAIM TYPE (LIFE, A/H)                                        *
  2199* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2200* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2201*                                                                *
  2202*  RETURNED FROM ELRESV                                          *
  2203*  --------------------                                          *
  2204*  CDT TABLE USED                                                *
  2205*  CDT FACTOR USED                                               *
  2206*  PAY TO CURRENT RESERVE                                        *
  2207*  I.B.N.R. - A/H ONLY                                           *
  2208*  FUTURE (ACCRUED) AH ONLY                                      *
  2209*----------------------------------------------------------------*
  2210*  PASSED TO ELRATE                                              *
  2211*  ----------------                                              *
  2212*  CERT ISSUE DATE                                               *
  2213*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2214*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2215*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2216*  STATE CODE (CLIENT DEFINED)                                   *
  2217*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2218*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2219*  DEVIATION CODE                                                *
  2220*  ISSUE AGE                                                     *
  2221*  ORIGINAL BENEFIT AMOUNT                                       *
  2222*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2223*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2224*  BENEFIT KIND (LIFE OR A/H)                                    *
  2225*  A.P.R.                                                        *
  2226*  METHOD
  2227*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2228*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2229*  COMPANY I.D. (3 CHARACTER)                                    *
  2230*  BENEFIT CODE                                                  *
  2231*  BENEFIT OVERRIDE CODE                                         *
  2232*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2233*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2234*  JOINT INDICATOR (CSL ONLY)                                    *
  2235*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2236*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2237*                                                                *
  2238*  RETURNED FROM ELRATE                                          *
  2239*  --------------------                                          *
  2240*  CALCULATED PREMIUM                                            *
  2241*  PREMIUM RATE                                                  *
  2242*  MORTALITY CODE                                                *
  2243*  MAX ATTAINED AGE                                              *
  2244*  MAX AGE                                                       *
  2245*  MAX TERM                                                      *
  2246*  MAX MONTHLY BENEFIT                                           *
  2247*  MAX TOTAL BENIFIT                                             *
  2248*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2249*----------------------------------------------------------------*
  2250*  PASSED TO ELRFND                                              *
  2251*  ----------------                                              *
  2252*  CERT ISSUE DATE                                               *
  2253*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  45
* EL130.cbl
  2254*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2255*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2256*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2257*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2258*  STATE CODE (CLIENT DEFINED)                                   *
  2259*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2260*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2261*  DEVIATION CODE                                                *
  2262*  ISSUE AGE                                                     *
  2263*  ORIGINAL BENEFIT AMOUNT                                       *
  2264*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2265*  PROCESS TYPE (CANCEL)                                         *
  2266*  BENEFIT KIND (LIFE OR A/H)                                    *
  2267*  A.P.R.                                                        *
  2268*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2269*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2270*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2271*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2272*  COMPANY I.D. (3 CHARACTER)                                    *
  2273*  BENEFIT CODE                                                  *
  2274*  BENEFIT OVERRIDE CODE                                         *
  2275*                                                                *
  2276*  RETURNED FROM ELRFND                                          *
  2277*  --------------------                                          *
  2278*  CALCULATED REFUND                                             *
  2279*----------------------------------------------------------------*
  2280*  PASSED TO ELEARN                                              *
  2281*  ----------------                                              *
  2282*  CERT ISSUE DATE                                               *
  2283*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2284*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2285*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2286*  STATE CODE (CLIENT DEFINED)                                   *
  2287*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2288*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2289*  DEVIATION CODE                                                *
  2290*  ISSUE AGE                                                     *
  2291*  ORIGINAL BENEFIT AMOUNT                                       *
  2292*  BENEFIT KIND (LIFE OR A/H)                                    *
  2293*  A.P.R.                                                        *
  2294*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2295*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2296*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2297*  COMPANY I.D. (3 CHARACTER)                                    *
  2298*  BENEFIT CODE                                                  *
  2299*  BENEFIT OVERRIDE CODE                                         *
  2300*                                                                *
  2301*  RETURNED FROM ELEARN                                          *
  2302*  --------------------                                          *
  2303*  INDICATED  EARNINGS                                           *
  2304*----------------------------------------------------------------*
  2305*                 LENGTH = 450                                   *
  2306*                                                                *
  2307******************************************************************
  2308******************************************************************
  2309*                   C H A N G E   L O G
  2310*
  2311* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  46
* EL130.cbl
  2312*-----------------------------------------------------------------
  2313*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2314* EFFECTIVE    NUMBER
  2315*-----------------------------------------------------------------
  2316* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2317* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2318* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2319* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2320* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2321* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2322* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2323* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2324* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2325******************************************************************
  2326
  2327 01  CALCULATION-PASS-AREA.
  2328     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2329                                     COMP.
  2330
  2331     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2332       88  NO-CP-ERROR                             VALUE ZERO.
  2333       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2334                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2335       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2336       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2337       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2338       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2339       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2340       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2341       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2342       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2343       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2344       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2345       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2346       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2347       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2348       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2349       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2350       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2351       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2352
  2353     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2354       88  NO-CP-ERROR-2                           VALUE ZERO.
  2355***********************  INPUT AREAS ****************************
  2356
  2357     12  CP-CALCULATION-AREA.
  2358         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2359         16  CP-CERT-EFF-DT        PIC XX.
  2360         16  CP-VALUATION-DT       PIC XX.
  2361         16  CP-PAID-THRU-DT       PIC XX.
  2362         16  CP-BENEFIT-TYPE       PIC X.
  2363           88  CP-AH                               VALUE 'A' 'D'
  2364                                                   'I' 'U'.
  2365           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2366           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2367         16  CP-INCURRED-DT        PIC XX.
  2368         16  CP-REPORTED-DT        PIC XX.
  2369         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  47
* EL130.cbl
  2370         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2371         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2372                                     COMP-3.
  2373         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2374                                     COMP-3.
  2375         16  CP-CDT-METHOD         PIC X.
  2376           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2377           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2378           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2379         16  CP-CLAIM-TYPE         PIC X.
  2380           88  CP-AH-CLAIM                         VALUE 'A'.
  2381           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2382         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2383                                     COMP-3.
  2384         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2385                                     COMP-3.
  2386         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2387                                     COMP-3.
  2388         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2389                                     COMP-3.
  2390         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2391                                     COMP-3.
  2392         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2393                                     COMP-3.
  2394         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2395                                     COMP-3.
  2396         16  CP-REM-TERM-METHOD    PIC X.
  2397           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2398           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2399           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2400           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2401           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2402           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2403           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2404         16  CP-EARNING-METHOD     PIC X.
  2405           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2406           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2407           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2408           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2409           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2410           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2411           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2412           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2413           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2414           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2415           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2416           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2417           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2418           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2419         16  CP-PROCESS-TYPE       PIC X.
  2420           88  CP-CLAIM                            VALUE '1'.
  2421           88  CP-CANCEL                           VALUE '2'.
  2422           88  CP-ISSUE                            VALUE '3'.
  2423         16  CP-SPECIAL-CALC-CD    PIC X.
  2424           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2425           88  CP-1-MTH-INTEREST               VALUE ' '.
  2426           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2427           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  48
* EL130.cbl
  2428           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2429           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2430           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2431           88  CP-FARM-PLAN                    VALUE 'F'.
  2432           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2433           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2434           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2435           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2436           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2437           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2438           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2439           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2440           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2441           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2442                                                     'W' 'X'.
  2443           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2444           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2445           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2446           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2447           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2448           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2449           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2450           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2451           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2452           88  CP-CSL-METH-1                   VALUE '5'.
  2453           88  CP-CSL-METH-2                   VALUE '6'.
  2454           88  CP-CSL-METH-3                   VALUE '7'.
  2455           88  CP-CSL-METH-4                   VALUE '8'.
  2456
  2457         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2458                                     COMP-3.
  2459         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2460         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2461         16  CP-STATE              PIC XX          VALUE SPACE.
  2462         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2463         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2464           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2465               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2466         16  CP-R78-OPTION         PIC X.
  2467           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2468           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2469
  2470         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2471         16  CP-IBNR-RESERVE-SW    PIC X.
  2472         16  CP-CLAIM-STATUS       PIC X.
  2473         16  CP-RATE-FILE          PIC X.
  2474         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2475                                     COMP-3.
  2476
  2477         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2478         16  CP-AH-OVERRIDE-CODE   PIC X.
  2479
  2480         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2481                                     COMP-3.
  2482         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2483                                   PIC S9(5)V99 COMP-3.
  2484         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2485                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  49
* EL130.cbl
  2486         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2487                                     COMP-3.
  2488         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2489                                     COMP-3.
  2490         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2491                                  PIC S9(7)V99 COMP-3.
  2492
  2493         16  CP-PAID-FROM-DATE     PIC X(02).
  2494         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2495         16  CP-EXT-DAYS-CALC      PIC X.
  2496           88  CP-EXT-NO-CHG                   VALUE ' '.
  2497           88  CP-EXT-CHG-LF                   VALUE '1'.
  2498           88  CP-EXT-CHG-AH                   VALUE '2'.
  2499           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2500         16  CP-DOMICILE-STATE     PIC XX.
  2501         16  CP-CARRIER            PIC X.
  2502         16  CP-REIN-FLAG          PIC X.
  2503         16  CP-REM-TRM-CALC-OPTION PIC X.
  2504           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2505                      '2' '3' '4' '5'.
  2506           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2507           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2508           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2509           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2510           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2511           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2512           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2513           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2514         16  CP-SIG-SWITCH         PIC X.
  2515         16  CP-RATING-METHOD      PIC X.
  2516           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2517           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2518           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2519           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2520           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2521           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2522           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2523           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2524           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2525         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2526                                     COMP-3.
  2527         16  CP-BEN-CATEGORY       PIC X.
  2528         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2529         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2530                                   PIC S99V9(5) COMP-3.
  2531         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2532         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2533                                   PIC S99V9(5) COMP-3.
  2534         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2535         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2536         16  CP-EXPIRE-DT          PIC XX.
  2537         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2538         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2539         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2540         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2541         16  CP-DDF-SPEC-CALC      PIC X.
  2542             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2543             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  50
* EL130.cbl
  2544         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2545         16  CP-CANCEL-REASON      PIC X.
  2546         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2547         16  CP-PMT-MODE           PIC X.
  2548         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2549         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2550         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2551         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2552         16  FILLER                PIC X.
  2553
  2554***************    OUTPUT FROM ELRESV   ************************
  2555
  2556         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2557
  2558         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2559                                     COMP-3.
  2560         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2561                                     COMP-3.
  2562         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2563                                     COMP-3.
  2564         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2565                                     COMP-3.
  2566         16  FILLER                PIC X(09).
  2567***************    OUTPUT FROM ELRTRM   *************************
  2568
  2569         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2570                                     COMP-3.
  2571         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2572                                     COMP-3.
  2573         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2574                                     COMP-3.
  2575         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2576                                     COMP-3.
  2577         16  FILLER                PIC X(12).
  2578
  2579***************    OUTPUT FROM ELRAMT   *************************
  2580
  2581         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2582                                     COMP-3.
  2583         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2584                                     COMP-3.
  2585         16  FILLER                PIC X(12).
  2586
  2587***************    OUTPUT FROM ELRATE   *************************
  2588
  2589         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2590                                     COMP-3.
  2591         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2592                                     COMP-3.
  2593         16  CP-MORTALITY-CODE     PIC X(4).
  2594         16  CP-RATE-EDIT-FLAG     PIC X.
  2595             88  CP-RATES-NEED-APR                  VALUE '1'.
  2596         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2597                                     COMP-3.
  2598         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2599         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2600         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2601                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  51
* EL130.cbl
  2602         16  FILLER                PIC X(07).
  2603
  2604***************    OUTPUT FROM ELRFND   *************************
  2605
  2606         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2607                                     COMP-3.
  2608         16  CP-REFUND-TYPE-USED   PIC X.
  2609           88  CP-R-AS-R78                         VALUE '1'.
  2610           88  CP-R-AS-PRORATA                     VALUE '2'.
  2611           88  CP-R-AS-CALIF                       VALUE '3'.
  2612           88  CP-R-AS-TEXAS                       VALUE '4'.
  2613           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2614           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2615           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2616           88  CP-R-AS-MEAN                        VALUE '8'.
  2617           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2618           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2619           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2620           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2621           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2622           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2623         16  FILLER                PIC X(12).
  2624
  2625***************    OUTPUT FROM ELEARN   *************************
  2626
  2627         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2628                                     COMP-3.
  2629         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2630                                     COMP-3.
  2631         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2632                                     COMP-3.
  2633         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2634                                     COMP-3.
  2635         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2636                                     COMP-3.
  2637         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2638                                     COMP-3.
  2639         16  CP-EARNING-TYPE-USED  PIC X.
  2640           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2641           88  CP-E-AS-R78                         VALUE '1'.
  2642           88  CP-E-AS-PRORATA                     VALUE '2'.
  2643           88  CP-E-AS-TEXAS                       VALUE '4'.
  2644           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2645           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2646           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2647           88  CP-E-AS-MEAN                        VALUE '8'.
  2648           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2649         16  FILLER                PIC X(12).
  2650
  2651***************    OUTPUT FROM ELPMNT   *************************
  2652
  2653         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2654                                     COMP-3.
  2655         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2656                                     COMP-3.
  2657         16  FILLER                PIC X(12).
  2658
  2659***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  52
* EL130.cbl
  2660         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2661                                     COMP-3.
  2662         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2663                                     COMP-3.
  2664         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2665                                     COMP-3.
  2666         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2667                                     COMP-3.
  2668         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2669                                     COMP-3.
  2670         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2671                                     COMP-3.
  2672         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2673             88  OPEN-RATE-FILE                   VALUE 'O'.
  2674             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2675             88  IO-ERROR                         VALUE 'E'.
  2676
  2677         16  CP-FIRST-PAY-DATE     PIC XX.
  2678
  2679         16  CP-JOINT-INDICATOR    PIC X.
  2680
  2681         16  CP-RESERVE-REMAINING-TERM
  2682                                   PIC S9(4)V9    VALUE ZERO
  2683                                     COMP-3.
  2684
  2685         16  CP-INSURED-BIRTH-DT   PIC XX.
  2686
  2687         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2688                                     COMP-3.
  2689
  2690         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2691                                     COMP-3.
  2692
  2693         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2694                                     COMP-3.
  2695
  2696         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2697                                     COMP-3.
  2698
  2699         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2700                                     COMP-3.
  2701
  2702         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2703                                     COMP-3.
  2704
  2705         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2706                                     COMP-3.
  2707
  2708         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2709             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2710
  2711         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2712                                     COMP-3.
  2713         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2714                                     COMP-3.
  2715         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2716         16  FILLER                PIC X(15).
  2717******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  53
* EL130.cbl
  2719*    COPY ELCLOGOF.
  2720******************************************************************
  2721*                                                                *
  2722*                                                                *
  2723*                            ELCLOGOF.                           *
  2724*                            VMOD=2.001                          *
  2725*                                                                *
  2726*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2727*                                                                *
  2728******************************************************************
  2729 01  CLASIC-LOGOFF.
  2730     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2731     12  LOGOFF-TEXT.
  2732         16  FILLER          PIC X(5)    VALUE SPACES.
  2733         16  LOGOFF-MSG.
  2734             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2735             20  FILLER      PIC X       VALUE SPACES.
  2736             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2737         16  FILLER          PIC X(80)
  2738           VALUE '* YOU ARE NOW LOGGED OFF'.
  2739         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2740         16  FILLER          PIC X       VALUE QUOTE.
  2741         16  LOGOFF-SYS-MSG  PIC X(17)
  2742           VALUE 'S CLAS-IC SYSTEM '.
  2743     12  TEXT-MESSAGES.
  2744         16  UNACCESS-MSG    PIC X(29)
  2745             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2746         16  PGMIDERR-MSG    PIC X(17)
  2747             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  54
* EL130.cbl
  2749*    COPY ELCATTR.
  2750******************************************************************
  2751*                                                                *
  2752*                            ELCATTR.                            *
  2753*                            VMOD=2.001                          *
  2754*                                                                *
  2755*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2756*                                                                *
  2757*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2758*                                                                *
  2759*                   POS 1   P=PROTECTED                          *
  2760*                           U=UNPROTECTED                        *
  2761*                           S=ASKIP                              *
  2762*                   POS 2   A=ALPHA/NUMERIC                      *
  2763*                           N=NUMERIC                            *
  2764*                   POS 3   N=NORMAL                             *
  2765*                           B=BRIGHT                             *
  2766*                           D=DARK                               *
  2767*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2768*                           OF=MODIFIED DATA TAG OFF             *
  2769*                                                                *
  2770*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2771******************************************************************
  2772 01  ATTRIBUTE-LIST.
  2773     12  AL-PABOF            PIC X       VALUE 'Y'.
  2774     12  AL-PABON            PIC X       VALUE 'Z'.
  2775     12  AL-PADOF            PIC X       VALUE '%'.
  2776     12  AL-PADON            PIC X       VALUE '_'.
  2777     12  AL-PANOF            PIC X       VALUE '-'.
  2778     12  AL-PANON            PIC X       VALUE '/'.
  2779     12  AL-SABOF            PIC X       VALUE '8'.
  2780     12  AL-SABON            PIC X       VALUE '9'.
  2781     12  AL-SADOF            PIC X       VALUE '@'.
  2782     12  AL-SADON            PIC X       VALUE QUOTE.
  2783     12  AL-SANOF            PIC X       VALUE '0'.
  2784     12  AL-SANON            PIC X       VALUE '1'.
  2785     12  AL-UABOF            PIC X       VALUE 'H'.
  2786     12  AL-UABON            PIC X       VALUE 'I'.
  2787     12  AL-UADOF            PIC X       VALUE '<'.
  2788     12  AL-UADON            PIC X       VALUE '('.
  2789     12  AL-UANOF            PIC X       VALUE ' '.
  2790     12  AL-UANON            PIC X       VALUE 'A'.
  2791     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2792     12  AL-UNBON            PIC X       VALUE 'R'.
  2793     12  AL-UNDOF            PIC X       VALUE '*'.
  2794     12  AL-UNDON            PIC X       VALUE ')'.
  2795     12  AL-UNNOF            PIC X       VALUE '&'.
  2796     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  55
* EL130.cbl
  2798*    COPY ELCEMIB.
  2799******************************************************************
  2800*                                                                *
  2801*                                                                *
  2802*                            ELCEMIB.                            *
  2803*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2804*                            VMOD=2.005                          *
  2805*                                                                *
  2806*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2807*                                                                *
  2808******************************************************************
  2809 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2810     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2811     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2812     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2813     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2814     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2815     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2816     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2817     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2818     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2819         88  EMI-NO-ERRORS                    VALUE '1'.
  2820         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2821         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2822     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2823         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2824     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2825         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2826         88  EMI-AREA1-FULL                   VALUE '2'.
  2827     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2828         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2829         88  EMI-AREA2-FULL                   VALUE '2'.
  2830     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2831         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2832         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2833         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2834         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2835         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2836     12  EMI-ERROR-LINES.
  2837         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2838         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2839         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2840         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2841             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2842                 24  EMI-ERR-NUM         PIC X(4).
  2843                 24  EMI-FILLER          PIC X.
  2844                 24  EMI-SEV             PIC X.
  2845                 24  FILLER              PIC X.
  2846             20  FILLER                  PIC X(02).
  2847     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2848         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2849             20  EMI-ERROR-NUMBER    PIC X(4).
  2850             20  EMI-FILL            PIC X.
  2851             20  EMI-SEVERITY        PIC X.
  2852             20  FILLER              PIC X.
  2853             20  EMI-ERROR-TEXT.
  2854                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2855                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  56
* EL130.cbl
  2856     12  EMI-SEVERITY-SAVE           PIC X.
  2857         88  EMI-NOTE                    VALUE 'N'.
  2858         88  EMI-WARNING                 VALUE 'W'.
  2859         88  EMI-FORCABLE                VALUE 'F'.
  2860         88  EMI-FATAL                   VALUE 'X'.
  2861     12  EMI-MESSAGE-FLAG            PIC X.
  2862         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2863         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2864     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2865     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2866         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2867         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2868         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2869     12  FILLER                      PIC X(137)  VALUE SPACES.
  2870     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2871     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2872     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2873     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  57
* EL130.cbl
  2875*    COPY ELCJPFX.
  2876******************************************************************
  2877*                                                                *
  2878*                                                                *
  2879*                            ELCJPFX.                            *
  2880*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2881*                            VMOD=2.002                          *
  2882*                                                                *
  2883*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2884*                                                                *
  2885*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2886*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2887*        ELCNTL - CONTROL FILE                                   *
  2888*        ELMSTR - CLAIM MASTERS                                  *
  2889*        ELTRLR - ACTIVITY TRAILERS                              *
  2890*        ELCHKQ - CHECK QUE                                      *
  2891******************************************************************
  2892 01  JOURNAL-RECORD.
  2893     12  JP-USER-ID                  PIC X(4).
  2894     12  JP-FILE-ID                  PIC X(8).
  2895     12  JP-PROGRAM-ID               PIC X(8).
  2896     12  JP-RECORD-TYPE              PIC X.
  2897         88 JP-ADD              VALUE 'A'.
  2898         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2899         88 JP-AFTER-CHANGE     VALUE 'C'.
  2900         88 JP-DELETE           VALUE 'D'.
  2901         88 JP-GENERIC-DELETE   VALUE 'G'.
  2902         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2903         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2904     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2905     12  JP-RECORD-AREA
  2906
  2907
  2908         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  58
* EL130.cbl
  2910*    COPY ELCAID.
  2911******************************************************************
  2912*                                                                *
  2913*                            ELCAID.                             *
  2914*                            VMOD=2.001                          *
  2915*                                                                *
  2916*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2917*                                                                *
  2918*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2919*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2920******************************************************************
  2921
  2922 01  DFHAID.
  2923   02  DFHNULL   PIC  X  VALUE  ' '.
  2924   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2925   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2926   02  DFHPEN    PIC  X  VALUE  '='.
  2927   02  DFHOPID   PIC  X  VALUE  'W'.
  2928   02  DFHPA1    PIC  X  VALUE  '%'.
  2929   02  DFHPA2    PIC  X  VALUE  '>'.
  2930   02  DFHPA3    PIC  X  VALUE  ','.
  2931   02  DFHPF1    PIC  X  VALUE  '1'.
  2932   02  DFHPF2    PIC  X  VALUE  '2'.
  2933   02  DFHPF3    PIC  X  VALUE  '3'.
  2934   02  DFHPF4    PIC  X  VALUE  '4'.
  2935   02  DFHPF5    PIC  X  VALUE  '5'.
  2936   02  DFHPF6    PIC  X  VALUE  '6'.
  2937   02  DFHPF7    PIC  X  VALUE  '7'.
  2938   02  DFHPF8    PIC  X  VALUE  '8'.
  2939   02  DFHPF9    PIC  X  VALUE  '9'.
  2940   02  DFHPF10   PIC  X  VALUE  ':'.
  2941   02  DFHPF11   PIC  X  VALUE  '#'.
  2942   02  DFHPF12   PIC  X  VALUE  '@'.
  2943   02  DFHPF13   PIC  X  VALUE  'A'.
  2944   02  DFHPF14   PIC  X  VALUE  'B'.
  2945   02  DFHPF15   PIC  X  VALUE  'C'.
  2946   02  DFHPF16   PIC  X  VALUE  'D'.
  2947   02  DFHPF17   PIC  X  VALUE  'E'.
  2948   02  DFHPF18   PIC  X  VALUE  'F'.
  2949   02  DFHPF19   PIC  X  VALUE  'G'.
  2950   02  DFHPF20   PIC  X  VALUE  'H'.
  2951   02  DFHPF21   PIC  X  VALUE  'I'.
  2952*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2953   02  DFHPF22   PIC  X  VALUE  '['.
  2954   02  DFHPF23   PIC  X  VALUE  '.'.
  2955   02  DFHPF24   PIC  X  VALUE  '<'.
  2956   02  DFHMSRE   PIC  X  VALUE  'X'.
  2957   02  DFHSTRF   PIC  X  VALUE  'h'.
  2958   02  DFHTRIG   PIC  X  VALUE  '"'.
  2959
  2960 01  FILLER    REDEFINES DFHAID.
  2961     12  FILLER              PIC X(8).
  2962     12  PF-VALUES           PIC X       OCCURS 12.
  2963
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  59
* EL130.cbl
  2965****************************************************************
  2966*
  2967* Copyright (c) 2007 by Clerity Solutions, Inc.
  2968* All rights reserved.
  2969*
  2970****************************************************************
  2971 01  DFHEIV.
  2972   02  DFHEIV0               PIC X(35).
  2973   02  DFHEIV1               PIC X(08).
  2974   02  DFHEIV2               PIC X(08).
  2975   02  DFHEIV3               PIC X(08).
  2976   02  DFHEIV4               PIC X(06).
  2977   02  DFHEIV5               PIC X(04).
  2978   02  DFHEIV6               PIC X(04).
  2979   02  DFHEIV7               PIC X(02).
  2980   02  DFHEIV8               PIC X(02).
  2981   02  DFHEIV9               PIC X(01).
  2982   02  DFHEIV10              PIC S9(7) COMP-3.
  2983   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2984   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2985   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2986   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2987   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2988   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2989   02  DFHEIV17              PIC X(04).
  2990   02  DFHEIV18              PIC X(04).
  2991   02  DFHEIV19              PIC X(04).
  2992   02  DFHEIV20              USAGE IS POINTER.
  2993   02  DFHEIV21              USAGE IS POINTER.
  2994   02  DFHEIV22              USAGE IS POINTER.
  2995   02  DFHEIV23              USAGE IS POINTER.
  2996   02  DFHEIV24              USAGE IS POINTER.
  2997   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2998   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2999   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3000   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3001   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3002   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3003   02  FILLER                PIC X(02).
  3004   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3005   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3006   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3007   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3008   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3009 LINKAGE  SECTION.
  3010*****************************************************************
  3011*                                                               *
  3012* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3013* All rights reserved.                                          *
  3014*                                                               *
  3015*****************************************************************
  3016 01  dfheiblk.
  3017     02  eibtime          pic s9(7) comp-3.
  3018     02  eibdate          pic s9(7) comp-3.
  3019     02  eibtrnid         pic x(4).
  3020     02  eibtaskn         pic s9(7) comp-3.
  3021     02  eibtrmid         pic x(4).
  3022     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  60
* EL130.cbl
  3023     02  eibcposn         pic s9(4) comp.
  3024     02  eibcalen         pic s9(4) comp.
  3025     02  eibaid           pic x(1).
  3026     02  eibfiller1       pic x(1).
  3027     02  eibfn            pic x(2).
  3028     02  eibfiller2       pic x(2).
  3029     02  eibrcode         pic x(6).
  3030     02  eibfiller3       pic x(2).
  3031     02  eibds            pic x(8).
  3032     02  eibreqid         pic x(8).
  3033     02  eibrsrce         pic x(8).
  3034     02  eibsync          pic x(1).
  3035     02  eibfree          pic x(1).
  3036     02  eibrecv          pic x(1).
  3037     02  eibsend          pic x(1).
  3038     02  eibatt           pic x(1).
  3039     02  eibeoc           pic x(1).
  3040     02  eibfmh           pic x(1).
  3041     02  eibcompl         pic x(1).
  3042     02  eibsig           pic x(1).
  3043     02  eibconf          pic x(1).
  3044     02  eiberr           pic x(1).
  3045     02  eibrldbk         pic x(1).
  3046     02  eiberrcd         pic x(4).
  3047     02  eibsynrb         pic x(1).
  3048     02  eibnodat         pic x(1).
  3049     02  eibfiller5       pic x(2).
  3050     02  eibresp          pic 9(09) comp.
  3051     02  eibresp2         pic 9(09) comp.
  3052     02  dfheigdj         pic s9(4) comp.
  3053     02  dfheigdk         pic s9(4) comp.
  3054
  3055 01  DFHCOMMAREA             PIC X(1024).
  3056
  3057*01 PARMLIST .
  3058*    02  FILLER              PIC S9(8)   COMP.
  3059*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3060*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3061*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3062*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3063*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3064*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3065*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3066*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3067*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  61
* EL130.cbl
  3069*    COPY ELCMSTR.
  3070******************************************************************
  3071*                                                                *
  3072*                            ELCMSTR.                            *
  3073*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3074*                            VMOD=2.012                          *
  3075*                                                                *
  3076*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3077*                                                                *
  3078*   FILE TYPE = VSAM,KSDS                                        *
  3079*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3080*                                                                *
  3081*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3082*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3083*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3084*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3085*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3086*                                                 RKP=75,LEN=21  *
  3087*                                                                *
  3088*   **** NOTE ****                                               *
  3089*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3090*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3091*                                                                *
  3092*   LOG = YES                                                    *
  3093*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3094******************************************************************
  3095*                   C H A N G E   L O G
  3096*
  3097* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3098*-----------------------------------------------------------------
  3099*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3100* EFFECTIVE    NUMBER
  3101*-----------------------------------------------------------------
  3102* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3103* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3104******************************************************************
  3105 01  CLAIM-MASTER.
  3106     12  CL-RECORD-ID                PIC XX.
  3107         88  VALID-CL-ID         VALUE 'CL'.
  3108
  3109     12  CL-CONTROL-PRIMARY.
  3110         16  CL-COMPANY-CD           PIC X.
  3111         16  CL-CARRIER              PIC X.
  3112         16  CL-CLAIM-NO             PIC X(7).
  3113         16  CL-CERT-NO.
  3114             20  CL-CERT-PRIME       PIC X(10).
  3115             20  CL-CERT-SFX         PIC X.
  3116
  3117     12  CL-CONTROL-BY-NAME.
  3118         16  CL-COMPANY-CD-A1        PIC X.
  3119         16  CL-INSURED-LAST-NAME    PIC X(15).
  3120         16  CL-INSURED-NAME.
  3121             20  CL-INSURED-1ST-NAME PIC X(12).
  3122             20  CL-INSURED-MID-INIT PIC X.
  3123
  3124     12  CL-CONTROL-BY-SSN.
  3125         16  CL-COMPANY-CD-A2        PIC X.
  3126         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  62
* EL130.cbl
  3127             20  CL-SSN-STATE        PIC XX.
  3128             20  CL-SSN-ACCOUNT      PIC X(6).
  3129             20  CL-SSN-LN3          PIC X(3).
  3130
  3131     12  CL-CONTROL-BY-CERT-NO.
  3132         16  CL-COMPANY-CD-A4        PIC X.
  3133         16  CL-CERT-NO-A4.
  3134             20  CL-CERT-A4-PRIME    PIC X(10).
  3135             20  CL-CERT-A4-SFX      PIC X.
  3136
  3137     12  CL-CONTROL-BY-CCN.
  3138         16  CL-COMPANY-CD-A5        PIC X.
  3139         16  CL-CCN-A5.
  3140             20  CL-CCN.
  3141                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3142                 24  CL-CCN-PRIME-A5 PIC X(12).
  3143             20  CL-CCN-FILLER-A5    PIC X(4).
  3144
  3145     12  CL-INSURED-PROFILE-DATA.
  3146         16  CL-INSURED-BIRTH-DT     PIC XX.
  3147         16  CL-INSURED-SEX-CD       PIC X.
  3148             88  INSURED-IS-MALE        VALUE 'M'.
  3149             88  INSURED-IS-FEMALE      VALUE 'F'.
  3150             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3151         16  CL-INSURED-OCC-CD       PIC X(6).
  3152         16  FILLER                  PIC X(5).
  3153
  3154     12  CL-PROCESSING-INFO.
  3155         16  CL-PROCESSOR-ID         PIC X(4).
  3156         16  CL-CLAIM-STATUS         PIC X.
  3157             88  CLAIM-IS-OPEN          VALUE 'O'.
  3158             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3159         16  CL-CLAIM-TYPE           PIC X.
  3160*            88  AH-CLAIM               VALUE 'A'.
  3161*            88  LIFE-CLAIM             VALUE 'L'.
  3162*            88  PROPERTY-CLAIM         VALUE 'P'.
  3163*            88  IUI-CLAIM              VALUE 'I'.
  3164*            88  GAP-CLAIM              VALUE 'G'.
  3165         16  CL-CLAIM-PREM-TYPE      PIC X.
  3166             88  SINGLE-PREMIUM         VALUE '1'.
  3167             88  O-B-COVERAGE           VALUE '2'.
  3168             88  OPEN-END-COVERAGE      VALUE '3'.
  3169         16  CL-INCURRED-DT          PIC XX.
  3170         16  CL-REPORTED-DT          PIC XX.
  3171         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3172         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3173         16  CL-LAST-PMT-DT          PIC XX.
  3174         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3175         16  CL-PAID-THRU-DT         PIC XX.
  3176         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3177         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3178         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3179         16  CL-PMT-CALC-METHOD      PIC X.
  3180             88  CL-360-DAY-YR          VALUE '1'.
  3181             88  CL-365-DAY-YR          VALUE '2'.
  3182             88  CL-FULL-MONTHS         VALUE '3'.
  3183         16  CL-CAUSE-CD             PIC X(6).
  3184
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  63
* EL130.cbl
  3185         16  CL-PRIME-CERT-NO.
  3186             20  CL-PRIME-CERT-PRIME PIC X(10).
  3187             20  CL-PRIME-CERT-SFX   PIC X.
  3188
  3189         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3190             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3191             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3192
  3193         16  CL-MICROFILM-NO         PIC X(10).
  3194         16  CL-PROG-FORM-TYPE       PIC X.
  3195         16  CL-LAST-ADD-ON-DT       PIC XX.
  3196
  3197         16  CL-LAST-REOPEN-DT       PIC XX.
  3198         16  CL-LAST-CLOSE-DT        PIC XX.
  3199         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3200             88  FINAL-PAID             VALUE '1'.
  3201             88  CLAIM-DENIED           VALUE '2'.
  3202             88  AUTO-CLOSE             VALUE '3'.
  3203             88  MANUAL-CLOSE           VALUE '4'.
  3204             88  BENEFITS-CHANGED       VALUE 'C'.
  3205             88  SETUP-ERRORS           VALUE 'E'.
  3206         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3207         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3208         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3209             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3210         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3211         16  FILLER                  PIC X.
  3212
  3213     12  CL-CERTIFICATE-DATA.
  3214         16  CL-CERT-ORIGIN          PIC X.
  3215             88  CERT-WAS-ONLINE        VALUE '1'.
  3216             88  CERT-WAS-CREATED       VALUE '2'.
  3217             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3218         16  CL-CERT-KEY-DATA.
  3219             20  CL-CERT-CARRIER     PIC X.
  3220             20  CL-CERT-GROUPING    PIC X(6).
  3221             20  CL-CERT-STATE       PIC XX.
  3222             20  CL-CERT-ACCOUNT.
  3223                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3224                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3225             20  CL-CERT-EFF-DT      PIC XX.
  3226
  3227     12  CL-STATUS-CONTROLS.
  3228         16  CL-PRIORITY-CD          PIC X.
  3229             88  CONFIDENTIAL-DATA      VALUE '8'.
  3230             88  HIGHEST-PRIORITY       VALUE '9'.
  3231         16  CL-SUPV-ATTN-CD         PIC X.
  3232             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3233             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3234         16  CL-PURGED-DT            PIC XX.
  3235         16  CL-RESTORED-DT          PIC XX.
  3236         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3237         16  CL-NEXT-RESEND-DT       PIC XX.
  3238         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3239         16  FILLER                  PIC XX.
  3240         16  CL-LAST-MAINT-DT        PIC XX.
  3241         16  CL-LAST-MAINT-USER      PIC X(4).
  3242         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  64
* EL130.cbl
  3243         16  CL-LAST-MAINT-TYPE      PIC X.
  3244             88  CLAIM-SET-UP           VALUE ' '.
  3245             88  PAYMENT-MADE           VALUE '1'.
  3246             88  LETTER-SENT            VALUE '2'.
  3247             88  MASTER-WAS-ALTERED     VALUE '3'.
  3248             88  MASTER-WAS-RESTORED    VALUE '4'.
  3249             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3250             88  FILE-CONVERTED         VALUE '6'.
  3251             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3252             88  ERROR-CORRECTION       VALUE 'E'.
  3253         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3254         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3255         16  CL-BENEFICIARY          PIC X(10).
  3256         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3257         16  CL-DENIAL-TYPE          PIC X.
  3258             88  CL-TYPE-DENIAL          VALUE '1'.
  3259             88  CL-TYPE-RESCISSION      VALUE '2'.
  3260             88  CL-TYPE-REFORMATION     VALUE '3'.
  3261             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3262             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3263         16  FILLER                  PIC X(5).
  3264
  3265     12  CL-TRAILER-CONTROLS.
  3266         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3267             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3268             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3269             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3270         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3271         16  FILLER                  PIC XX.
  3272         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3273         16  CL-ADDRESS-TRAILER-CNT.
  3274             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3275                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3276             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3277                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3278             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3279                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3280             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3281                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3282             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3283                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3284             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3285                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3286             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3287                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3288
  3289     12  CL-CV-REFERENCE-NO.
  3290         16  CL-CV-REFNO-PRIME       PIC X(18).
  3291         16  CL-CV-REFNO-SFX         PIC XX.
  3292
  3293     12  CL-FILE-LOCATION            PIC X(4).
  3294
  3295     12  CL-PROCESS-ERRORS.
  3296         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3297             88  NO-FATAL-ERRORS        VALUE ZERO.
  3298         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3299             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3300
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  65
* EL130.cbl
  3301     12  CL-PRODUCT-CD               PIC X.
  3302
  3303     12  CL-CURRENT-KEY-DATA.
  3304         16  CL-CURRENT-CARRIER      PIC X.
  3305         16  CL-CURRENT-GROUPING     PIC X(6).
  3306         16  CL-CURRENT-STATE        PIC XX.
  3307         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3308
  3309     12  CL-ASSOCIATES               PIC X.
  3310         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3311         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3312         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3313         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3314
  3315     12  CL-ACTIVITY-CODE            PIC 99.
  3316     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3317     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3318
  3319     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3320     12  CL-LAG-REPORT-CODE          PIC 9.
  3321     12  CL-LOAN-TYPE                PIC XX.
  3322     12  CL-LEGAL-STATE              PIC XX.
  3323
  3324*    12  FILLER                      PIC X(5).
  3325     12  CL-YESNOSW                  PIC X.
  3326     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  66
* EL130.cbl
  3328*    COPY ELCCNTL.
  3329******************************************************************
  3330*                                                                *
  3331*                                                                *
  3332*                            ELCCNTL.                            *
  3333*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3334*                            VMOD=2.059                          *
  3335*                                                                *
  3336*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3337*                                                                *
  3338*   FILE TYPE = VSAM,KSDS                                        *
  3339*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3340*                                                                *
  3341*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3342*       ALTERNATE INDEX = NONE                                   *
  3343*                                                                *
  3344*   LOG = YES                                                    *
  3345*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3346******************************************************************
  3347*                   C H A N G E   L O G
  3348*
  3349* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3350*-----------------------------------------------------------------
  3351*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3352* EFFECTIVE    NUMBER
  3353*-----------------------------------------------------------------
  3354* 082503                   PEMA  ADD BENEFIT GROUP
  3355* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3356* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3357* 092705    2005050300006  PEMA  ADD SPP LEASES
  3358* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3359* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3360* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3361* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3362* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3363* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3364* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3365* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3366******************************************************************
  3367*
  3368 01  CONTROL-FILE.
  3369     12  CF-RECORD-ID                       PIC XX.
  3370         88  VALID-CF-ID                        VALUE 'CF'.
  3371
  3372     12  CF-CONTROL-PRIMARY.
  3373         16  CF-COMPANY-ID                  PIC XXX.
  3374         16  CF-RECORD-TYPE                 PIC X.
  3375             88  CF-COMPANY-MASTER              VALUE '1'.
  3376             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3377             88  CF-STATE-MASTER                VALUE '3'.
  3378             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3379             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3380             88  CF-CARRIER-MASTER              VALUE '6'.
  3381             88  CF-MORTALITY-MASTER            VALUE '7'.
  3382             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3383             88  CF-TERMINAL-MASTER             VALUE '9'.
  3384             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3385             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  67
* EL130.cbl
  3386             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3387             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3388             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3389             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3390             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3391             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3392             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3393         16  CF-ACCESS-CD-GENL              PIC X(4).
  3394         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3395             20  CF-PROCESSOR               PIC X(4).
  3396         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3397             20  CF-STATE-CODE              PIC XX.
  3398             20  FILLER                     PIC XX.
  3399         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3400             20  FILLER                     PIC XX.
  3401             20  CF-HI-BEN-IN-REC           PIC XX.
  3402         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3403             20  FILLER                     PIC XXX.
  3404             20  CF-CARRIER-CNTL            PIC X.
  3405         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3406             20  FILLER                     PIC XX.
  3407             20  CF-HI-TYPE-IN-REC          PIC 99.
  3408         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3409             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3410                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3411             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3412             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3413         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3414             20  FILLER                     PIC X.
  3415             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3416         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3417             20  FILLER                     PIC XX.
  3418             20  CF-MORTGAGE-PLAN           PIC XX.
  3419         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3420
  3421     12  CF-LAST-MAINT-DT                   PIC XX.
  3422     12  CF-LAST-MAINT-BY                   PIC X(4).
  3423     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3424
  3425     12  CF-RECORD-BODY                     PIC X(728).
  3426
  3427
  3428****************************************************************
  3429*             COMPANY MASTER RECORD                            *
  3430****************************************************************
  3431
  3432     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3433         16  CF-COMPANY-ADDRESS.
  3434             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3435             20  CF-CL-IN-CARE-OF           PIC X(30).
  3436             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3437             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3438             20  CF-CL-CITY-STATE           PIC X(30).
  3439             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3440             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3441         16  CF-COMPANY-CD                  PIC X.
  3442         16  CF-COMPANY-PASSWORD            PIC X(8).
  3443         16  CF-SECURITY-OPTION             PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  68
* EL130.cbl
  3444             88  ALL-SECURITY                   VALUE '1'.
  3445             88  COMPANY-VERIFY                 VALUE '2'.
  3446             88  PROCESSOR-VERIFY               VALUE '3'.
  3447             88  NO-SECURITY                    VALUE '4'.
  3448             88  ALL-BUT-TERM                   VALUE '5'.
  3449         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3450             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3451         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3452             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3453         16  CF-INFORCE-LOCATION            PIC X.
  3454             88  CERTS-ARE-ONLINE               VALUE '1'.
  3455             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3456             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3457         16  CF-LOWER-CASE-LETTERS          PIC X.
  3458         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3459             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3460             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3461             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3462             88  CF-ACCNT-CNTL                  VALUE '3'.
  3463             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3464
  3465         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3466         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3467
  3468         16  CF-LGX-CREDIT-USER             PIC X.
  3469             88  CO-IS-NOT-USER                 VALUE 'N'.
  3470             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3471
  3472         16 CF-CREDIT-CALC-CODES.
  3473             20  CF-CR-REM-TERM-CALC PIC X.
  3474               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3475               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3476               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3477               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3478               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3479               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3480               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3481             20  CF-CR-R78-METHOD           PIC X.
  3482               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3483               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3484
  3485         16  CF-CLAIM-CONTROL-COUNTS.
  3486             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3487                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3488
  3489             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3490                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3491
  3492             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3493                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3494
  3495             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3496                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3497
  3498         16  CF-CURRENT-MONTH-END           PIC XX.
  3499
  3500         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3501             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  69
* EL130.cbl
  3502             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3503             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3504             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3505                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3506                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3507             20  CF-CO-PREM-REJECT-SW       PIC X.
  3508                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3509                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3510             20  CF-CO-REF-REJECT-SW        PIC X.
  3511                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3512                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3513
  3514         16  CF-CO-REPORTING-DT             PIC XX.
  3515         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3516         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3517           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3518           88  CF-CO-MONTH-END                  VALUE '1'.
  3519
  3520         16  CF-LGX-CLAIM-USER              PIC X.
  3521             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3522             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3523
  3524         16  CF-CREDIT-EDIT-CONTROLS.
  3525             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3526             20  CF-MIN-AGE                 PIC 99.
  3527             20  CF-DEFAULT-AGE             PIC 99.
  3528             20  CF-MIN-TERM                PIC S999      COMP-3.
  3529             20  CF-MAX-TERM                PIC S999      COMP-3.
  3530             20  CF-DEFAULT-SEX             PIC X.
  3531             20  CF-JOINT-AGE-INPUT         PIC X.
  3532                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3533             20  CF-BIRTH-DATE-INPUT        PIC X.
  3534                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3535             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3536                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3537                 88  CF-ZERO-CARRIER            VALUE '1'.
  3538                 88  CF-ZERO-GROUPING           VALUE '2'.
  3539                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3540             20  CF-EDIT-SW                 PIC X.
  3541                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3542             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3543             20  CF-CR-PR-METHOD            PIC X.
  3544               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3545               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3546             20  FILLER                     PIC X.
  3547
  3548         16  CF-CREDIT-MISC-CONTROLS.
  3549             20  CF-REIN-TABLE-SW           PIC X.
  3550                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3551             20  CF-COMP-TABLE-SW           PIC X.
  3552                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3553             20  CF-EXPERIENCE-RETENTION-AGE
  3554                                            PIC S9        COMP-3.
  3555             20  CF-CONVERSION-DT           PIC XX.
  3556             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3557             20  CF-RUN-FREQUENCY-SW        PIC X.
  3558                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3559                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  70
* EL130.cbl
  3560
  3561             20  CF-CR-CHECK-NO-CONTROL.
  3562                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3563                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3564                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3565                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3566                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3567                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3568
  3569                 24  CF-CR-CHECK-COUNT       REDEFINES
  3570                     CF-CR-CHECK-COUNTER      PIC X(4).
  3571
  3572                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3573                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3574
  3575                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3576                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3577                 24  CF-MAIL-PROCESSING       PIC X.
  3578                     88  MAIL-PROCESSING          VALUE 'Y'.
  3579
  3580         16  CF-MISC-SYSTEM-CONTROL.
  3581             20  CF-SYSTEM-C                 PIC X.
  3582                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3583             20  CF-SYSTEM-D                 PIC X.
  3584                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3585             20  CF-SOC-SEC-NO-SW            PIC X.
  3586                 88  SOC-SEC-NO-USED             VALUE '1'.
  3587             20  CF-MEMBER-NO-SW             PIC X.
  3588                 88  MEMBER-NO-USED              VALUE '1'.
  3589             20  CF-TAX-ID-NUMBER            PIC X(11).
  3590             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3591             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3592                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3593                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3594                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3595                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3596             20  CF-SYSTEM-E                 PIC X.
  3597                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3598
  3599         16  CF-LGX-LIFE-USER               PIC X.
  3600             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3601             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3602
  3603         16  CF-CR-MONTH-END-DT             PIC XX.
  3604
  3605         16  CF-FILE-MAINT-DATES.
  3606             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3607                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3608             20  CF-LAST-BATCH       REDEFINES
  3609                 CF-LAST-BATCH-NO               PIC X(4).
  3610             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3611             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3612             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3613             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3614             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3615             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3616             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3617             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  71
* EL130.cbl
  3618             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3619             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3620
  3621         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3622         16  FILLER                         PIC X.
  3623
  3624         16  CF-ALT-MORT-CODE               PIC X(4).
  3625         16  CF-MEMBER-CAPTION              PIC X(10).
  3626
  3627         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3628             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3629             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3630             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3631             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3632             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3633
  3634         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3635
  3636         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3637         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3638         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3639         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3640
  3641         16  CF-AH-OVERRIDE-L1              PIC X.
  3642         16  CF-AH-OVERRIDE-L2              PIC XX.
  3643         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3644         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3645
  3646         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3647         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3648
  3649         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3650         16  CF-AR-LAST-EL860-DT            PIC XX.
  3651         16  CF-MP-MONTH-END-DT             PIC XX.
  3652
  3653         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3654         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3655             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3656
  3657         16  CF-AR-MONTH-END-DT             PIC XX.
  3658
  3659         16  CF-CRDTCRD-USER                PIC X.
  3660             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3661             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3662
  3663         16  CF-CC-MONTH-END-DT             PIC XX.
  3664
  3665         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3666
  3667         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3668             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3669             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3670             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3671         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3672         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3673         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3674         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3675             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  72
* EL130.cbl
  3676             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3677         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3678         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3679         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3680             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3681         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3682
  3683         16  CF-CL-ZIP-CODE.
  3684             20  CF-CL-ZIP-PRIME.
  3685                 24  CF-CL-ZIP-1ST          PIC X.
  3686                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3687                 24  FILLER                 PIC X(4).
  3688             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3689         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3690             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3691             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3692             20  FILLER                     PIC XXX.
  3693
  3694         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3695         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3696         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3697         16  CF-CO-OPTION-START-DATE        PIC XX.
  3698         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3699           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3700                                                      '3' '4'.
  3701           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3702           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3703           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3704           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3705           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3706           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3707
  3708         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3709
  3710         16  CF-PAYMENT-APPROVAL-LEVELS.
  3711             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3712             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3713             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3714             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3715             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3716             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3717
  3718         16  CF-END-USER-REPORTING-USER     PIC X.
  3719             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3720             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3721
  3722         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3723             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3724             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3725
  3726         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3727
  3728         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3729         16  FILLER                         PIC X.
  3730
  3731         16  CF-CREDIT-ARCHIVE-CNTL.
  3732             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3733             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  73
* EL130.cbl
  3734             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3735
  3736         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3737
  3738         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3739             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3740             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3741
  3742         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3743             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3744             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3745
  3746         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3747
  3748         16  CF-CO-ACH-ID-CODE              PIC  X.
  3749             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3750             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3751             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3752         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3753         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3754         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3755         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3756         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3757         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3758         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3759         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3760         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3761                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3762         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3763                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3764
  3765         16  CF-CO-OVER-SHORT.
  3766             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3767             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3768
  3769*         16  FILLER                         PIC X(102).
  3770         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3771             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3772             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3773
  3774         16  CF-AH-APPROVAL-DAYS.
  3775             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3776             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3777             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3778             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3779
  3780         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3781
  3782         16  FILLER                         PIC X(79).
  3783****************************************************************
  3784*             PROCESSOR/USER RECORD                            *
  3785****************************************************************
  3786
  3787     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3788         16  CF-PROCESSOR-NAME              PIC X(30).
  3789         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3790         16  CF-PROCESSOR-TITLE             PIC X(26).
  3791         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  74
* EL130.cbl
  3792                 88  MESSAGE-YES                VALUE 'Y'.
  3793                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3794
  3795*****************************************************
  3796****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3797****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3798****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3799****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3800*****************************************************
  3801
  3802         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3803             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3804             20  CF-APPLICATION-FORCE       PIC X.
  3805             20  CF-INDIVIDUAL-APP.
  3806                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3807                     28  CF-BROWSE-APP      PIC X.
  3808                     28  CF-UPDATE-APP      PIC X.
  3809
  3810         16  CF-CURRENT-TERM-ON             PIC X(4).
  3811         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3812             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3813             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3814             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3815             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3816             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3817             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3818             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3819         16  CF-PROCESSOR-CARRIER           PIC X.
  3820             88  NO-CARRIER-SECURITY            VALUE ' '.
  3821         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3822             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3823         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3824             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3825         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3826             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3827
  3828         16  CF-PROC-SYS-ACCESS-SW.
  3829             20  CF-PROC-CREDIT-CLAIMS-SW.
  3830                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3831                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3832                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3833                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3834             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3835                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3836                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3837             20  CF-PROC-LIFE-GNRLDGR-SW.
  3838                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3839                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3840                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3841                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3842             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3843                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3844                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3845         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3846             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3847             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3848         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3849
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  75
* EL130.cbl
  3850         16  CF-APPROVAL-LEVEL                  PIC X.
  3851             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3852             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3853             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3854             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3855
  3856         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3857
  3858         16  CF-LANGUAGE-TYPE                   PIC X.
  3859             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3860             88  CF-LANG-IS-FR                      VALUE 'F'.
  3861
  3862         16  CF-CSR-IND                         PIC X.
  3863         16  FILLER                             PIC X(239).
  3864
  3865****************************************************************
  3866*             PROCESSOR/REMINDERS RECORD                       *
  3867****************************************************************
  3868
  3869     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3870         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3871             20  CF-START-REMIND-DT         PIC XX.
  3872             20  CF-END-REMIND-DT           PIC XX.
  3873             20  CF-REMINDER-TEXT           PIC X(50).
  3874         16  FILLER                         PIC X(296).
  3875
  3876
  3877****************************************************************
  3878*             STATE MASTER RECORD                              *
  3879****************************************************************
  3880
  3881     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3882         16  CF-STATE-ABBREVIATION          PIC XX.
  3883         16  CF-STATE-NAME                  PIC X(25).
  3884         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3885         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3886             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3887             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3888             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3889             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3890                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3891                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3892             20  CF-ST-PREM-REJECT-SW       PIC X.
  3893                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3894                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3895             20  CF-ST-REF-REJECT-SW        PIC X.
  3896                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3897                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3898         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3899         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3900         16  CF-ST-REFUND-RULES.
  3901             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3902             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3903             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3904         16  CF-ST-FST-PMT-EXTENSION.
  3905             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3906             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3907                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  76
* EL130.cbl
  3908                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3909                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3910                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3911         16  CF-ST-STATE-CALL.
  3912             20  CF-ST-CALL-UNEARNED        PIC X.
  3913             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3914             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3915         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3916             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3917             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3918         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3919         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3920         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3921         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3922         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3923         16  FILLER                         PIC X.
  3924         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3925             20  CF-ST-BENEFIT-CD           PIC XX.
  3926             20  CF-ST-BENEFIT-KIND         PIC X.
  3927                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3928                 88  CF-ST-AH-KIND              VALUE 'A'.
  3929             20  CF-ST-REM-TERM-CALC        PIC X.
  3930                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3931                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3932                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3933                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3934                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3935                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3936                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3937                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3938
  3939             20  CF-ST-REFUND-CALC          PIC X.
  3940                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3941                 88  ST-REFD-BY-R78             VALUE '1'.
  3942                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3943                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3944                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3945                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3946                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3947                 88  ST-REFD-UTAH               VALUE '7'.
  3948                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3949                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3950                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3951
  3952             20  CF-ST-EARNING-CALC         PIC X.
  3953                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3954                 88  ST-EARN-BY-R78             VALUE '1'.
  3955                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3956                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3957                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3958                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3959                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3960                 88  ST-EARN-MEAN               VALUE '8'.
  3961                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3962
  3963             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3964                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3965                 88  ST-OVRD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  77
* EL130.cbl
  3966                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3967                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3968                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3969                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3970                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3971                 88  ST-OVRD-MEAN               VALUE '8'.
  3972                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3973             20  FILLER                     PIC X.
  3974
  3975         16  CF-ST-COMMISSION-CAPS.
  3976             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3977             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3978             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3979             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3980         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3981                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3982
  3983         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3984
  3985         16  CF-ST-STATUTORY-INTEREST.
  3986             20  CF-ST-STAT-DATE-FROM       PIC X.
  3987                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3988                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3989             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3990             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3991             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3992             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3993             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3994
  3995         16  CF-ST-OVER-SHORT.
  3996             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3997             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3998
  3999         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4000
  4001         16  CF-ST-RT-CALC                  PIC X.
  4002
  4003         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4004         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4005         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4006         16  CF-ST-RF-LR-CALC               PIC X.
  4007         16  CF-ST-RF-LL-CALC               PIC X.
  4008         16  CF-ST-RF-LN-CALC               PIC X.
  4009         16  CF-ST-RF-AH-CALC               PIC X.
  4010         16  CF-ST-RF-CP-CALC               PIC X.
  4011*        16  FILLER                         PIC X(206).
  4012*CIDMOD         16  FILLER                         PIC X(192).
  4013         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4014             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4015         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4016         16  CF-ST-VFY-2ND-BENE             PIC X.
  4017         16  CF-ST-CAUSAL-STATE             PIC X.
  4018         16  FILLER                         PIC X(185).
  4019
  4020****************************************************************
  4021*             BENEFIT MASTER RECORD                            *
  4022****************************************************************
  4023
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  78
* EL130.cbl
  4024     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4025         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4026             20  CF-BENEFIT-CODE            PIC XX.
  4027             20  CF-BENEFIT-NUMERIC  REDEFINES
  4028                 CF-BENEFIT-CODE            PIC XX.
  4029             20  CF-BENEFIT-ALPHA           PIC XXX.
  4030             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4031             20  CF-BENEFIT-COMMENT         PIC X(10).
  4032
  4033             20  CF-LF-COVERAGE-TYPE        PIC X.
  4034                 88  CF-REDUCING                VALUE 'R'.
  4035                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4036
  4037             20  CF-SPECIAL-CALC-CD         PIC X.
  4038                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4039                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4040                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4041                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4042                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4043                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4044                 88  CF-FARM-PLAN               VALUE 'F'.
  4045                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4046                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4047                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4048                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4049                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4050                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4051                 88  CF-PRUDENTIAL              VALUE 'P'.
  4052                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4053                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4054                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4055                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4056                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4057                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4058
  4059             20  CF-JOINT-INDICATOR         PIC X.
  4060                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4061
  4062*            20  FILLER                     PIC X(12).
  4063             20  FILLER                     PIC X(11).
  4064             20  CF-BENEFIT-CATEGORY        PIC X.
  4065             20  CF-LOAN-TYPE               PIC X(8).
  4066
  4067             20  CF-CO-REM-TERM-CALC        PIC X.
  4068                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4069                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4070                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4071                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4072                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4073
  4074             20  CF-CO-EARNINGS-CALC        PIC X.
  4075                 88  CO-EARN-BY-R78             VALUE '1'.
  4076                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4077                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4078                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4079                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4080                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4081                 88  CO-EARN-AS-MEAN            VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  79
* EL130.cbl
  4082                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4083
  4084             20  CF-CO-REFUND-CALC          PIC X.
  4085                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4086                 88  CO-REFD-BY-R78             VALUE '1'.
  4087                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4088                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4089                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4090                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4091                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4092                 88  CO-REFD-MEAN               VALUE '8'.
  4093                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4094                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4095                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4096
  4097             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4098                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4099                 88  CO-OVRD-BY-R78             VALUE '1'.
  4100                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4101                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4102                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4103                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4104                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4105                 88  CO-OVRD-MEAN               VALUE '8'.
  4106                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4107
  4108             20  CF-CO-BEN-I-G-CD           PIC X.
  4109                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4110                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4111                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4112
  4113         16  FILLER                         PIC X(304).
  4114
  4115
  4116****************************************************************
  4117*             CARRIER MASTER RECORD                            *
  4118****************************************************************
  4119
  4120     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4121         16  CF-ADDRESS-DATA.
  4122             20  CF-MAIL-TO-NAME            PIC X(30).
  4123             20  CF-IN-CARE-OF              PIC X(30).
  4124             20  CF-ADDRESS-LINE-1          PIC X(30).
  4125             20  CF-ADDRESS-LINE-2          PIC X(30).
  4126             20  CF-CITY-STATE              PIC X(30).
  4127             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4128             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4129
  4130         16  CF-CLAIM-NO-CONTROL.
  4131             20  CF-CLAIM-NO-METHOD         PIC X.
  4132                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4133                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4134                 88  CLAIM-NO-SEQ               VALUE '3'.
  4135                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4136             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4137                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4138                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4139                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  80
* EL130.cbl
  4140
  4141         16  CF-CHECK-NO-CONTROL.
  4142             20  CF-CHECK-NO-METHOD         PIC X.
  4143                 88  CHECK-NO-MANUAL            VALUE '1'.
  4144                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4145                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4146                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4147             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4148                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4149
  4150         16  CF-DOMICILE-STATE              PIC XX.
  4151
  4152         16  CF-EXPENSE-CONTROLS.
  4153             20  CF-EXPENSE-METHOD          PIC X.
  4154                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4155                 88  DOLLARS-PER-PMT            VALUE '2'.
  4156                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4157                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4158             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4159             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4160
  4161         16  CF-CORRESPONDENCE-CONTROL.
  4162             20  CF-LETTER-RESEND-OPT       PIC X.
  4163                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4164                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4165             20  FILLER                     PIC X(4).
  4166
  4167         16  CF-RESERVE-CONTROLS.
  4168             20  CF-MANUAL-SW               PIC X.
  4169                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4170             20  CF-FUTURE-SW               PIC X.
  4171                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4172             20  CF-PTC-SW                  PIC X.
  4173                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4174             20  CF-IBNR-SW                 PIC X.
  4175                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4176             20  CF-PTC-LF-SW               PIC X.
  4177                 88  CF-LF-PTC-USED             VALUE '1'.
  4178             20  CF-CDT-ACCESS-METHOD       PIC X.
  4179                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4180                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4181                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4182             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4183
  4184         16  CF-CLAIM-CALC-METHOD           PIC X.
  4185             88  360-PLUS-MONTHS                VALUE '1'.
  4186             88  365-PLUS-MONTHS                VALUE '2'.
  4187             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4188             88  360-DAILY                      VALUE '4'.
  4189             88  365-DAILY                      VALUE '5'.
  4190
  4191         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4192         16  FILLER                         PIC X(11).
  4193
  4194         16  CF-LIMIT-AMOUNTS.
  4195             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4196             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4197             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  81
* EL130.cbl
  4198             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4199             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4200             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4201             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4202             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4203             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4204             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4205
  4206         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4207         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4208         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4209
  4210         16  CF-ZIP-CODE.
  4211             20  CF-ZIP-PRIME.
  4212                 24  CF-ZIP-1ST             PIC X.
  4213                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4214                 24  FILLER                 PIC X(4).
  4215             20  CF-ZIP-PLUS4               PIC X(4).
  4216         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4217             20  CF-CAN-POSTAL-1            PIC XXX.
  4218             20  CF-CAN-POSTAL-2            PIC XXX.
  4219             20  FILLER                     PIC XXX.
  4220
  4221         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4222         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4223         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4224
  4225         16  CF-RATING-SWITCH               PIC X.
  4226             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4227             88  CF-NO-RATING                   VALUE 'N'.
  4228
  4229         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4230
  4231         16  CF-CARRIER-OVER-SHORT.
  4232             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4233             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4234
  4235         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4236         16  CF-SECPAY-SWITCH               PIC X.
  4237             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4238             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4239         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4240         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4241         16  FILLER                         PIC X(444).
  4242*        16  FILLER                         PIC X(452).
  4243
  4244
  4245****************************************************************
  4246*             MORTALITY MASTER RECORD                          *
  4247****************************************************************
  4248
  4249     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4250         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4251                                INDEXED BY CF-MORT-NDX.
  4252             20  CF-MORT-TABLE              PIC X(5).
  4253             20  CF-MORT-TABLE-TYPE         PIC X.
  4254                 88  CF-MORT-JOINT              VALUE 'J'.
  4255                 88  CF-MORT-SINGLE             VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  82
* EL130.cbl
  4256                 88  CF-MORT-COMBINED           VALUE 'C'.
  4257                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4258                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4259             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4260             20  CF-MORT-AGE-METHOD         PIC XX.
  4261                 88  CF-AGE-LAST                VALUE 'AL'.
  4262                 88  CF-AGE-NEAR                VALUE 'AN'.
  4263             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4264             20  CF-MORT-ADJUSTMENT-DIRECTION
  4265                                            PIC X.
  4266                 88  CF-MINUS                   VALUE '-'.
  4267                 88  CF-PLUS                    VALUE '+'.
  4268             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4269             20  CF-MORT-JOINT-CODE         PIC X.
  4270                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4271             20  CF-MORT-PC-Q               PIC X.
  4272                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4273             20  CF-MORT-TABLE-CODE         PIC X(4).
  4274             20  CF-MORT-COMMENTS           PIC X(15).
  4275             20  FILLER                     PIC X(14).
  4276
  4277         16  FILLER                         PIC X(251).
  4278
  4279
  4280****************************************************************
  4281*             BUSSINESS TYPE MASTER RECORD                     *
  4282****************************************************************
  4283
  4284     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4285* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4286* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4287* AND RECORD 05 IS TYPES 81-99
  4288         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4289             20  CF-BUSINESS-TITLE          PIC  X(19).
  4290             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4291                                            PIC S9V9(4) COMP-3.
  4292             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4293             20  FILLER                     PIC  X.
  4294         16  FILLER                         PIC  X(248).
  4295
  4296
  4297****************************************************************
  4298*             TERMINAL MASTER RECORD                           *
  4299****************************************************************
  4300
  4301     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4302
  4303         16  CF-COMPANY-TERMINALS.
  4304             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4305                                  PIC X(4).
  4306         16  FILLER               PIC X(248).
  4307
  4308
  4309****************************************************************
  4310*             LIFE EDIT MASTER RECORD                          *
  4311****************************************************************
  4312
  4313     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  83
* EL130.cbl
  4314         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4315             20  CF-LIFE-CODE-IN            PIC XX.
  4316             20  CF-LIFE-CODE-OUT           PIC XX.
  4317         16  FILLER                         PIC X(248).
  4318
  4319
  4320****************************************************************
  4321*             AH EDIT MASTER RECORD                            *
  4322****************************************************************
  4323
  4324     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4325         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4326             20  CF-AH-CODE-IN              PIC XXX.
  4327             20  CF-AH-CODE-OUT             PIC XX.
  4328         16  FILLER                         PIC X(248).
  4329
  4330
  4331****************************************************************
  4332*             CREDIBILITY TABLES                               *
  4333****************************************************************
  4334
  4335     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4336         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4337                             INDEXED BY CF-CRDB-NDX.
  4338             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4339             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4340             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4341         16  FILLER                         PIC  X(332).
  4342
  4343
  4344****************************************************************
  4345*             REPORT CUSTOMIZATION RECORD                      *
  4346****************************************************************
  4347
  4348     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4349         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4350             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4351             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4352             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4353**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4354****       A T-TRANSFER.                                   ****
  4355             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4356
  4357         16  FILLER                         PIC XX.
  4358
  4359         16  CF-CARRIER-CNTL-OPT.
  4360             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4361                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4362                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4363             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4364                                            PIC X.
  4365         16  CF-GROUP-CNTL-OPT.
  4366             20  CF-GROUP-OPT-SEQ           PIC 9.
  4367                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4368                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4369             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4370                                            PIC X(6).
  4371         16  CF-STATE-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  84
* EL130.cbl
  4372             20  CF-STATE-OPT-SEQ           PIC 9.
  4373                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4374                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4375             20  CF-STATE-SELECT OCCURS 3 TIMES
  4376                                            PIC XX.
  4377         16  CF-ACCOUNT-CNTL-OPT.
  4378             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4379                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4380                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4381             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4382                                            PIC X(10).
  4383         16  CF-BUS-TYP-CNTL-OPT.
  4384             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4385                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4386                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4387             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4388                                            PIC XX.
  4389         16  CF-LF-TYP-CNTL-OPT.
  4390             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4391                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4392                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4393             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4394                                            PIC XX.
  4395         16  CF-AH-TYP-CNTL-OPT.
  4396             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4397                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4398                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4399             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4400                                            PIC XX.
  4401         16  CF-REPTCD1-CNTL-OPT.
  4402             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4403                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4404                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4405             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4406                                            PIC X(10).
  4407         16  CF-REPTCD2-CNTL-OPT.
  4408             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4409                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4410                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4411             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4412                                            PIC X(10).
  4413         16  CF-USER1-CNTL-OPT.
  4414             20  CF-USER1-OPT-SEQ           PIC 9.
  4415                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4416                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4417             20  CF-USER1-SELECT OCCURS 3 TIMES
  4418                                            PIC X(10).
  4419         16  CF-USER2-CNTL-OPT.
  4420             20  CF-USER2-OPT-SEQ           PIC 9.
  4421                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4422                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4423             20  CF-USER2-SELECT OCCURS 3 TIMES
  4424                                            PIC X(10).
  4425         16  CF-USER3-CNTL-OPT.
  4426             20  CF-USER3-OPT-SEQ           PIC 9.
  4427                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4428                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4429             20  CF-USER3-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  85
* EL130.cbl
  4430                                            PIC X(10).
  4431         16  CF-USER4-CNTL-OPT.
  4432             20  CF-USER4-OPT-SEQ           PIC 9.
  4433                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4434                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4435             20  CF-USER4-SELECT OCCURS 3 TIMES
  4436                                            PIC X(10).
  4437         16  CF-USER5-CNTL-OPT.
  4438             20  CF-USER5-OPT-SEQ           PIC 9.
  4439                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4440                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4441             20  CF-USER5-SELECT OCCURS 3 TIMES
  4442                                            PIC X(10).
  4443         16  CF-REINS-CNTL-OPT.
  4444             20  CF-REINS-OPT-SEQ           PIC 9.
  4445                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4446                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4447             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4448                 24  CF-REINS-PRIME         PIC XXX.
  4449                 24  CF-REINS-SUB           PIC XXX.
  4450
  4451         16  CF-AGENT-CNTL-OPT.
  4452             20  CF-AGENT-OPT-SEQ           PIC 9.
  4453                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4454                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4455             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4456                                            PIC X(10).
  4457
  4458         16  FILLER                         PIC X(43).
  4459
  4460         16  CF-LOSS-RATIO-SELECT.
  4461             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4462             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4463         16  CF-ENTRY-DATE-SELECT.
  4464             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4465             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4466         16  CF-EFFECTIVE-DATE-SELECT.
  4467             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4468             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4469
  4470         16  CF-EXCEPTION-LIST-IND          PIC X.
  4471             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4472
  4473         16  FILLER                         PIC X(318).
  4474
  4475****************************************************************
  4476*                  EXCEPTION REPORTING RECORD                  *
  4477****************************************************************
  4478
  4479     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4480         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4481             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4482
  4483         16  CF-COMBINED-LIFE-AH-OPT.
  4484             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4485             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4486             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4487             20  CF-CANCELLATION-RATIO      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  86
* EL130.cbl
  4488
  4489         16  CF-LIFE-OPT.
  4490             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4491             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4492             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4493             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4494             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4495             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4496             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4497             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4498             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4499             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4500
  4501         16  CF-AH-OPT.
  4502             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4503             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4504             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4505             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4506             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4507             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4508             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4509             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4510             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4511             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4512
  4513         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4514             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4515             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4516             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4517
  4518         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4519
  4520         16  FILLER                         PIC X(673).
  4521
  4522
  4523****************************************************************
  4524*             MORTGAGE SYSTEM PLAN RECORD                      *
  4525****************************************************************
  4526
  4527     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4528         16  CF-PLAN-TYPE                   PIC X.
  4529             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4530             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4531             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4532         16  CF-PLAN-ABBREV                 PIC XXX.
  4533         16  CF-PLAN-DESCRIPT               PIC X(10).
  4534         16  CF-PLAN-NOTES                  PIC X(20).
  4535         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4536         16  CF-PLAN-UNDERWRITING.
  4537             20  CF-PLAN-TERM-DATA.
  4538                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4539                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4540             20  CF-PLAN-AGE-DATA.
  4541                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4542                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4543                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4544             20  CF-PLAN-BENEFIT-DATA.
  4545                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  87
* EL130.cbl
  4546                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4547                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4548                                            PIC S9(7)V99  COMP-3.
  4549         16  CF-PLAN-POLICY-FORMS.
  4550             20  CF-POLICY-FORM             PIC X(12).
  4551             20  CF-MASTER-APPLICATION      PIC X(12).
  4552             20  CF-MASTER-POLICY           PIC X(12).
  4553         16  CF-PLAN-RATING.
  4554             20  CF-RATE-CODE               PIC X(5).
  4555             20  CF-SEX-RATING              PIC X.
  4556                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4557                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4558             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4559             20  CF-SUB-STD-TYPE            PIC X.
  4560                 88  CF-PCT-OF-PREM            VALUE '1'.
  4561                 88  CF-PCT-OF-BENE            VALUE '2'.
  4562         16  CF-PLAN-PREM-TOLERANCES.
  4563             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4564             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4565         16  CF-PLAN-PYMT-TOLERANCES.
  4566             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4567             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4568         16  CF-PLAN-MISC-DATA.
  4569             20  FILLER                     PIC X.
  4570             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4571             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4572         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4573         16  CF-PLAN-IND-GRP                PIC X.
  4574             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4575                                                     '1'.
  4576             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4577                                                     '2'.
  4578         16  CF-MIB-SEARCH-SW               PIC X.
  4579             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4580             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4581             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4582             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4583         16  CF-ALPHA-SEARCH-SW             PIC X.
  4584             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4585             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4586             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4587             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4588             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4589             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4590             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4591             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4592             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4593             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4594                                                     'A' 'B' 'C'
  4595                                                     'X' 'Y' 'Z'.
  4596         16  CF-EFF-DT-RULE-SW              PIC X.
  4597             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4598             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4599             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4600             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4601             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4602         16  FILLER                         PIC X(4).
  4603         16  CF-HEALTH-QUESTIONS            PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  88
* EL130.cbl
  4604             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4605         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4606         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4607         16  CF-PLAN-SNGL-JNT               PIC X.
  4608             88  CF-COMBINED-PLAN              VALUE 'C'.
  4609             88  CF-JNT-PLAN                   VALUE 'J'.
  4610             88  CF-SNGL-PLAN                  VALUE 'S'.
  4611         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4612         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4613         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4614         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4615         16  CF-RERATE-CNTL                 PIC  X.
  4616             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4617             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4618             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4619             88  CF-AUTO-RECALC                 VALUE '4'.
  4620         16  CF-BENEFIT-TYPE                PIC  X.
  4621             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4622             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4623         16  CF-POLICY-FEE                  PIC S999V99
  4624                                                    COMP-3.
  4625         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4626         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4627         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4628         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4629         16  FILLER                         PIC  X(32).
  4630         16  CF-TERMINATION-FORM            PIC  X(04).
  4631         16  FILLER                         PIC  X(08).
  4632         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4633                                                       COMP-3.
  4634         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4635         16  CF-ISSUE-LETTER                PIC  X(4).
  4636         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4637         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4638             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4639             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4640         16  CF-MP-REFUND-CALC              PIC X.
  4641             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4642             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4643             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4644             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4645             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4646             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4647             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4648             88  CF-MP-REFD-MEAN                VALUE '8'.
  4649         16  CF-ALT-RATE-CODE               PIC  X(5).
  4650
  4651
  4652         16  FILLER                         PIC X(498).
  4653****************************************************************
  4654*             MORTGAGE COMPANY MASTER RECORD                   *
  4655****************************************************************
  4656
  4657     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4658         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4659         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4660             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4661             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  89
* EL130.cbl
  4662             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4663             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4664             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4665
  4666         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4667         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4668         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4669         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4670         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4671
  4672         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4673             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4674         16  CF-MP-RECON-USE-IND            PIC X(1).
  4675             88  CF-MP-USE-RECON             VALUE 'Y'.
  4676         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4677             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4678         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4679             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4680             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4681         16  FILLER                         PIC X(1).
  4682         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4683             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4684         16  CF-MORTG-MIB-VERSION           PIC X.
  4685             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4686             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4687             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4688         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4689             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4690                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4691             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4692                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4693             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4694                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4695             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4696                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4697             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4698                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4699             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4700                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4701         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4702         16  FILLER                         PIC X(7).
  4703         16  CF-MORTG-DESTINATION-SYMBOL.
  4704             20  CF-MORTG-MIB-COMM          PIC X(5).
  4705             20  CF-MORTG-MIB-TERM          PIC X(5).
  4706         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4707             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4708         16  FILLER                         PIC X(03).
  4709         16  CF-MP-CHECK-NO-CONTROL.
  4710             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4711                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4712                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4713                                                ' ' LOW-VALUES.
  4714                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4715                                               VALUE '3'.
  4716         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4717         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4718         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4719             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  90
* EL130.cbl
  4720                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4721             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4722                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4723             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4724                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4725             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4726                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4727             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4728                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4729             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4730                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4731         16  CF-MORTG-BILLING-AREA.
  4732             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4733                                            PIC X.
  4734         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4735         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4736         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4737         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4738             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4739             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4740         16  FILLER                         PIC X.
  4741         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4742             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4743             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4744         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4745         16  FILLER                         PIC X(8).
  4746         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4747         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4748         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4749         16  CF-ACH-COMPANY-ID.
  4750             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4751                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4752                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4753                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4754             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4755         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4756             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4757         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4758             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4759             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4760         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4761         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4762         16  FILLER                         PIC X(536).
  4763
  4764****************************************************************
  4765*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4766****************************************************************
  4767
  4768     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4769         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4770             20  CF-FEMALE-HEIGHT.
  4771                 24  CF-FEMALE-FT           PIC 99.
  4772                 24  CF-FEMALE-IN           PIC 99.
  4773             20  CF-FEMALE-MIN-WT           PIC 999.
  4774             20  CF-FEMALE-MAX-WT           PIC 999.
  4775         16  FILLER                         PIC X(428).
  4776
  4777     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  91
* EL130.cbl
  4778         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4779             20  CF-MALE-HEIGHT.
  4780                 24  CF-MALE-FT             PIC 99.
  4781                 24  CF-MALE-IN             PIC 99.
  4782             20  CF-MALE-MIN-WT             PIC 999.
  4783             20  CF-MALE-MAX-WT             PIC 999.
  4784         16  FILLER                         PIC X(428).
  4785******************************************************************
  4786*             AUTOMATIC ACTIVITY RECORD                          *
  4787******************************************************************
  4788     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4789         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4790             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4791             20  CF-SYS-LETTER-ID           PIC X(04).
  4792             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4793             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4794             20  CF-SYS-RESET-SW            PIC X(01).
  4795             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4796             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4797
  4798         16  FILLER                         PIC X(50).
  4799
  4800         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4801             20  CF-USER-ACTIVE-SW          PIC X(01).
  4802             20  CF-USER-LETTER-ID          PIC X(04).
  4803             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4804             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4805             20  CF-USER-RESET-SW           PIC X(01).
  4806             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4807             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4808             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4809
  4810         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  92
* EL130.cbl
  4812*    COPY ELCCERT.
  4813******************************************************************
  4814*                                                                *
  4815*                            ELCCERT.                            *
  4816*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4817*                            VMOD=2.013                          *
  4818*                                                                *
  4819*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4820*                                                                *
  4821*   FILE TYPE = VSAM,KSDS                                        *
  4822*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4823*                                                                *
  4824*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4825*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4826*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4827*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4828*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4829*                                                                *
  4830*   LOG = YES                                                    *
  4831*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4832******************************************************************
  4833*                   C H A N G E   L O G
  4834*
  4835* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4836*-----------------------------------------------------------------
  4837*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4838* EFFECTIVE    NUMBER
  4839*-----------------------------------------------------------------
  4840* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4841* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4842* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4843* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4844* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4845* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4846* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4847* 032612  CR2011110200001  PEMA  AHL CHANGES
  4848******************************************************************
  4849
  4850 01  CERTIFICATE-MASTER.
  4851     12  CM-RECORD-ID                      PIC XX.
  4852         88  VALID-CM-ID                      VALUE 'CM'.
  4853
  4854     12  CM-CONTROL-PRIMARY.
  4855         16  CM-COMPANY-CD                 PIC X.
  4856         16  CM-CARRIER                    PIC X.
  4857         16  CM-GROUPING.
  4858             20  CM-GROUPING-PREFIX        PIC X(3).
  4859             20  CM-GROUPING-PRIME         PIC X(3).
  4860         16  CM-STATE                      PIC XX.
  4861         16  CM-ACCOUNT.
  4862             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4863             20  CM-ACCOUNT-PRIME          PIC X(6).
  4864         16  CM-CERT-EFF-DT                PIC XX.
  4865         16  CM-CERT-NO.
  4866             20  CM-CERT-PRIME             PIC X(10).
  4867             20  CM-CERT-SFX               PIC X.
  4868
  4869     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  93
* EL130.cbl
  4870         16  CM-COMPANY-CD-A1              PIC X.
  4871         16  CM-INSURED-LAST-NAME          PIC X(15).
  4872         16  CM-INSURED-INITIALS.
  4873             20  CM-INSURED-INITIAL1       PIC X.
  4874             20  CM-INSURED-INITIAL2       PIC X.
  4875
  4876     12  CM-CONTROL-BY-SSN.
  4877         16  CM-COMPANY-CD-A2              PIC X.
  4878         16  CM-SOC-SEC-NO.
  4879             20  CM-SSN-STATE              PIC XX.
  4880             20  CM-SSN-ACCOUNT            PIC X(6).
  4881             20  CM-SSN-LN3.
  4882                 25  CM-INSURED-INITIALS-A2.
  4883                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4884                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4885                 25 CM-PART-LAST-NAME-A2         PIC X.
  4886
  4887     12  CM-CONTROL-BY-CERT-NO.
  4888         16  CM-COMPANY-CD-A4              PIC X.
  4889         16  CM-CERT-NO-A4                 PIC X(11).
  4890
  4891     12  CM-CONTROL-BY-MEMB.
  4892         16  CM-COMPANY-CD-A5              PIC X.
  4893         16  CM-MEMBER-NO.
  4894             20  CM-MEMB-STATE             PIC XX.
  4895             20  CM-MEMB-ACCOUNT           PIC X(6).
  4896             20  CM-MEMB-LN4.
  4897                 25  CM-INSURED-INITIALS-A5.
  4898                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4899                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4900                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4901
  4902     12  CM-INSURED-PROFILE-DATA.
  4903         16  CM-INSURED-FIRST-NAME.
  4904             20  CM-INSURED-1ST-INIT       PIC X.
  4905             20  FILLER                    PIC X(9).
  4906         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4907         16  CM-INSURED-SEX                PIC X.
  4908             88  CM-SEX-MALE                  VALUE 'M'.
  4909             88  CM-SEX-FEMAL                 VALUE 'F'.
  4910         16  CM-INSURED-JOINT-AGE          PIC 99.
  4911         16  CM-JOINT-INSURED-NAME.
  4912             20  CM-JT-LAST-NAME           PIC X(15).
  4913             20  CM-JT-FIRST-NAME.
  4914                 24  CM-JT-1ST-INIT        PIC X.
  4915                 24  FILLER                PIC X(9).
  4916             20  CM-JT-INITIAL             PIC X.
  4917
  4918     12  CM-LIFE-DATA.
  4919         16  CM-LF-BENEFIT-CD              PIC XX.
  4920         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4921         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4922         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4923         16  CM-LF-DEV-CODE                PIC XXX.
  4924         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4925         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4926         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4927         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  94
* EL130.cbl
  4928         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4929         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4930         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4931         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4932         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4933         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4934         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4935         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4936         16  FILLER                        PIC XX.
  4937
  4938     12  CM-AH-DATA.
  4939         16  CM-AH-BENEFIT-CD              PIC XX.
  4940         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4941         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4942         16  CM-AH-DEV-CODE                PIC XXX.
  4943         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4944         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4945         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4946         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4947         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4948         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4949         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4950         16  CM-AH-PAID-THRU-DT            PIC XX.
  4951             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4952         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4953         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4954         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4955         16  FILLER                        PIC X.
  4956
  4957     12  CM-LOAN-INFORMATION.
  4958         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4959         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4960                                           PIC S9(5)V99  COMP-3.
  4961         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4962         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4963         16  CM-PAY-FREQUENCY              PIC S99.
  4964         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4965         16  CM-RATE-CLASS                 PIC XX.
  4966         16  CM-BENEFICIARY                PIC X(25).
  4967         16  CM-POLICY-FORM-NO             PIC X(12).
  4968         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4969         16  CM-LAST-ADD-ON-DT             PIC XX.
  4970         16  CM-DEDUCTIBLE-AMOUNTS.
  4971             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4972             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4973         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4974             20  CM-RESIDENT-STATE         PIC XX.
  4975             20  CM-RATE-CODE              PIC X(4).
  4976             20  FILLER                    PIC XX.
  4977         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4978             20  CM-LOAN-OFFICER           PIC X(5).
  4979             20  FILLER                    PIC XXX.
  4980         16  CM-CSR-CODE                   PIC XXX.
  4981         16  CM-UNDERWRITING-CODE          PIC X.
  4982             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4983         16  CM-POST-CARD-IND              PIC X.
  4984         16  CM-NH-INTERFACE-SW            PIC X.
  4985         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  95
* EL130.cbl
  4986             88  CM-SING-PRM                  VALUE '1'.
  4987             88  CM-O-B-COVERAGE              VALUE '2'.
  4988             88  CM-OPEN-END                  VALUE '3'.
  4989         16  CM-IND-GRP-TYPE               PIC X.
  4990             88  CM-INDIVIDUAL                VALUE 'I'.
  4991             88  CM-GROUP                     VALUE 'G'.
  4992         16  CM-SKIP-CODE                  PIC X.
  4993             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4994             88  SKIP-JULY                    VALUE '1'.
  4995             88  SKIP-AUGUST                  VALUE '2'.
  4996             88  SKIP-SEPTEMBER               VALUE '3'.
  4997             88  SKIP-JULY-AUG                VALUE '4'.
  4998             88  SKIP-AUG-SEPT                VALUE '5'.
  4999             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5000             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5001             88  SKIP-JUNE                    VALUE '8'.
  5002             88  SKIP-JUNE-JULY               VALUE '9'.
  5003             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5004             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5005         16  CM-PAYMENT-MODE               PIC X.
  5006             88  PAY-MONTHLY                  VALUE SPACE.
  5007             88  PAY-WEEKLY                   VALUE '1'.
  5008             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5009             88  PAY-BI-WEEKLY                VALUE '3'.
  5010             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5011         16  CM-LOAN-NUMBER                PIC X(8).
  5012         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5013         16  CM-OLD-LOF                    PIC XXX.
  5014*        16  CM-LOAN-OFFICER               PIC XXX.
  5015         16  CM-REIN-TABLE                 PIC XXX.
  5016         16  CM-SPECIAL-REIN-CODE          PIC X.
  5017         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5018         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5019         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5020
  5021     12  CM-STATUS-DATA.
  5022         16  CM-ENTRY-STATUS               PIC X.
  5023         16  CM-ENTRY-DT                   PIC XX.
  5024
  5025         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5026         16  CM-LF-CANCEL-DT               PIC XX.
  5027         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5028
  5029         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5030         16  CM-LF-DEATH-DT                PIC XX.
  5031         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5032
  5033         16  CM-LF-CURRENT-STATUS          PIC X.
  5034             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5035                                                'M' '4' '5' '9'.
  5036             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5037             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5038             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5039             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5040             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5041             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5042             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5043             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  96
* EL130.cbl
  5044             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5045             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5046             88  CM-LF-DECLINED               VALUE 'D'.
  5047             88  CM-LF-VOIDED                 VALUE 'V'.
  5048
  5049         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5050         16  CM-AH-CANCEL-DT               PIC XX.
  5051         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5052
  5053         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5054         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5055         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5056
  5057         16  CM-AH-CURRENT-STATUS          PIC X.
  5058             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5059                                                'M' '4' '5' '9'.
  5060             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5061             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5062             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5063             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5064             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5065             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5066             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5067             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5068             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5069             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5070             88  CM-AH-DECLINED               VALUE 'D'.
  5071             88  CM-AH-VOIDED                 VALUE 'V'.
  5072
  5073         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5074             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5075             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5076             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5077         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5078
  5079         16  CM-ENTRY-BATCH                PIC X(6).
  5080         16  CM-LF-EXIT-BATCH              PIC X(6).
  5081         16  CM-AH-EXIT-BATCH              PIC X(6).
  5082         16  CM-LAST-MONTH-END             PIC XX.
  5083
  5084     12  CM-NOTE-SW                        PIC X.
  5085         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5086         88  CERT-NOTES-PRESENT               VALUE '1'.
  5087         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5088         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5089         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5090         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5091         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5092         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5093     12  CM-COMP-EXCP-SW                   PIC X.
  5094         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5095         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5096     12  CM-INSURED-ADDRESS-SW             PIC X.
  5097         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5098         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5099
  5100*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5101     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  97
* EL130.cbl
  5102     12  FILLER                            PIC X.
  5103
  5104*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5105     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5106     12  FILLER                            PIC X.
  5107*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5108     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5109
  5110     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5111         88  CERT-ADDED-BATCH                 VALUE ' '.
  5112         88  CERT-ADDED-ONLINE                VALUE '1'.
  5113         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5114         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5115         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5116     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5117         88  CERT-AS-LOADED                   VALUE ' '.
  5118         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5119         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5120         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5121         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5122         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5123         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5124         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5125
  5126     12  CM-ACCOUNT-COMM-PCTS.
  5127         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5128         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5129
  5130     12  CM-USER-FIELD                     PIC X.
  5131     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5132     12  CM-CLP-STATE                      PIC XX.
  5133     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5134     12  CM-USER-RESERVED                  PIC XXX.
  5135     12  FILLER REDEFINES CM-USER-RESERVED.
  5136         16  CM-AH-CLASS-CD                PIC XX.
  5137         16  F                             PIC X.
  5138******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  98
* EL130.cbl
  5140*    COPY ERCACCT.
  5141******************************************************************
  5142*                                                                *
  5143*                                                                *
  5144*                            ERCACCT                             *
  5145*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5146*                            VMOD=2.031                          *
  5147*                                                                *
  5148*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5149*                                                                *
  5150*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5151*   VSAM ACCOUNT MASTER FILES.                                   *
  5152*                                                                *
  5153*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5154*                                                                *
  5155*   FILE TYPE = VSAM,KSDS                                        *
  5156*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5157*                                                                *
  5158*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5159*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5160*                                                                *
  5161*   LOG = NO                                                     *
  5162*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5163*                                                                *
  5164*                                                                *
  5165******************************************************************
  5166*                   C H A N G E   L O G
  5167*
  5168* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5169*-----------------------------------------------------------------
  5170*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5171* EFFECTIVE    NUMBER
  5172*-----------------------------------------------------------------
  5173* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5174* 092705    2005050300006  PEMA  ADD SPP LEASES
  5175* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5176* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5177* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5178* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5179* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5180******************************************************************
  5181
  5182 01  ACCOUNT-MASTER.
  5183     12  AM-RECORD-ID                      PIC XX.
  5184         88  VALID-AM-ID                      VALUE 'AM'.
  5185
  5186     12  AM-CONTROL-PRIMARY.
  5187         16  AM-COMPANY-CD                 PIC X.
  5188         16  AM-MSTR-CNTRL.
  5189             20  AM-CONTROL-A.
  5190                 24  AM-CARRIER            PIC X.
  5191                 24  AM-GROUPING.
  5192                     28 AM-GROUPING-PREFIX PIC XXX.
  5193                     28 AM-GROUPING-PRIME  PIC XXX.
  5194                 24  AM-STATE              PIC XX.
  5195                 24  AM-ACCOUNT.
  5196                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5197                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page  99
* EL130.cbl
  5198             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5199                                           PIC X(19).
  5200             20  AM-CNTRL-B.
  5201                 24  AM-EXPIRATION-DT      PIC XX.
  5202                 24  FILLER                PIC X(4).
  5203             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5204                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5205
  5206     12  AM-CONTROL-BY-VAR-GRP.
  5207         16  AM-COMPANY-CD-A1              PIC X.
  5208         16  AM-VG-CARRIER                 PIC X.
  5209         16  AM-VG-GROUPING                PIC X(6).
  5210         16  AM-VG-STATE                   PIC XX.
  5211         16  AM-VG-ACCOUNT                 PIC X(10).
  5212         16  AM-VG-DATE.
  5213             20  AM-VG-EXPIRATION-DT       PIC XX.
  5214             20  FILLER                    PIC X(4).
  5215         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5216                                           PIC 9(11)      COMP-3.
  5217     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5218         16  FILLER                        PIC X(10).
  5219         16  AM-VG-KEY3.
  5220             20  AM-VG3-ACCOUNT            PIC X(10).
  5221             20  AM-VG3-EXP-DT             PIC XX.
  5222         16  FILLER                        PIC X(4).
  5223     12  AM-MAINT-INFORMATION.
  5224         16  AM-LAST-MAINT-DT              PIC XX.
  5225         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5226         16  AM-LAST-MAINT-USER            PIC X(4).
  5227         16  FILLER                        PIC XX.
  5228
  5229     12  AM-EFFECTIVE-DT                   PIC XX.
  5230     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5231
  5232     12  AM-PREV-DATES  COMP-3.
  5233         16  AM-PREV-EXP-DT                PIC 9(11).
  5234         16  AM-PREV-EFF-DT                PIC 9(11).
  5235
  5236     12  AM-REPORT-CODE-1                  PIC X(10).
  5237     12  AM-REPORT-CODE-2                  PIC X(10).
  5238
  5239     12  AM-CITY-CODE                      PIC X(4).
  5240     12  AM-COUNTY-PARISH                  PIC X(6).
  5241
  5242     12  AM-NAME                           PIC X(30).
  5243     12  AM-PERSON                         PIC X(30).
  5244     12  AM-ADDRS                          PIC X(30).
  5245     12  AM-CITY.
  5246         16  AM-ADDR-CITY                  PIC X(28).
  5247         16  AM-ADDR-STATE                 PIC XX.
  5248     12  AM-ZIP.
  5249         16  AM-ZIP-PRIME.
  5250             20  AM-ZIP-PRI-1ST            PIC X.
  5251                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5252             20  FILLER                    PIC X(4).
  5253         16  AM-ZIP-PLUS4                  PIC X(4).
  5254     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5255         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 100
* EL130.cbl
  5256         16  AM-CAN-POSTAL-2               PIC XXX.
  5257         16  FILLER                        PIC XXX.
  5258     12  AM-TEL-NO.
  5259         16  AM-AREA-CODE                  PIC 999.
  5260         16  AM-TEL-PRE                    PIC 999.
  5261         16  AM-TEL-NBR                    PIC 9(4).
  5262     12  AM-TEL-LOC                        PIC X.
  5263         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5264         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5265
  5266     12  AM-COMM-STRUCTURE.
  5267         16  AM-DEFN-1.
  5268             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5269                 24  AM-AGT.
  5270                     28  AM-AGT-PREFIX     PIC X(4).
  5271                     28  AM-AGT-PRIME      PIC X(6).
  5272                 24  AM-COM-TYP            PIC X.
  5273                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5274                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5275                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5276                 24  AM-RECALC-LV-INDIC    PIC X.
  5277                 24  AM-RETRO-LV-INDIC     PIC X.
  5278                 24  AM-GL-CODES           PIC X.
  5279                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5280                 24  FILLER                PIC X(01).
  5281         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5282             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5283                 24  FILLER                PIC X(11).
  5284                 24  AM-L-COMA             PIC XXX.
  5285                 24  AM-J-COMA             PIC XXX.
  5286                 24  AM-A-COMA             PIC XXX.
  5287                 24  FILLER                PIC X(6).
  5288
  5289     12  AM-COMM-CHANGE-STATUS             PIC X.
  5290         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5291
  5292     12  AM-CSR-CODE                       PIC X(4).
  5293
  5294     12  AM-BILLING-STATUS                 PIC X.
  5295         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5296         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5297     12  AM-AUTO-REFUND-SW                 PIC X.
  5298         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5299         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5300     12  AM-GPCD                           PIC 99.
  5301     12  AM-IG                             PIC X.
  5302         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5303         88  AM-HAS-GROUP                     VALUE '2'.
  5304     12  AM-STATUS                         PIC X.
  5305         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5306         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5307         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5308         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5309         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5310         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5311     12  AM-REMIT-TO                       PIC 99.
  5312     12  AM-ID-NO                          PIC X(11).
  5313
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 101
* EL130.cbl
  5314     12  AM-CAL-TABLE                      PIC XX.
  5315     12  AM-LF-DEVIATION                   PIC XXX.
  5316     12  AM-AH-DEVIATION                   PIC XXX.
  5317     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5318     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5319     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5320     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5321     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5322     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5323
  5324     12  AM-USER-FIELDS.
  5325         16  AM-FLD-1                      PIC XX.
  5326         16  AM-FLD-2                      PIC XX.
  5327         16  AM-FLD-3                      PIC XX.
  5328         16  AM-FLD-4                      PIC XX.
  5329         16  AM-FLD-5                      PIC XX.
  5330
  5331     12  AM-1ST-PROD-DATE.
  5332         16  AM-1ST-PROD-YR                PIC XX.
  5333         16  AM-1ST-PROD-MO                PIC XX.
  5334         16  AM-1ST-PROD-DA                PIC XX.
  5335     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5336     12  AM-CERTS-PURGED-DATE.
  5337         16  AM-PUR-YR                     PIC XX.
  5338         16  AM-PUR-MO                     PIC XX.
  5339         16  AM-PUR-DA                     PIC XX.
  5340     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5341     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5342     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5343     12  AM-INACTIVE-DATE.
  5344         16  AM-INA-MO                     PIC 99.
  5345         16  AM-INA-DA                     PIC 99.
  5346         16  AM-INA-YR                     PIC 99.
  5347     12  AM-AR-HI-CERT-DATE                PIC XX.
  5348
  5349     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5350     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5351
  5352     12  AM-OB-PAYMENT-MODE                PIC X.
  5353         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5354         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5355         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5356         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5357
  5358     12  AM-AH-ONLY-INDICATOR              PIC X.
  5359         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5360         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5361
  5362     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5363
  5364     12  AM-OVER-SHORT.
  5365         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5366         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5367
  5368     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5369     12  AM-DCC-CLP-STATE                  PIC XX.
  5370
  5371     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 102
* EL130.cbl
  5372     12  AM-RECALC-REIN                    PIC X.
  5373
  5374     12  AM-REI-TABLE                      PIC XXX.
  5375     12  AM-REI-ET-LF                      PIC X.
  5376     12  AM-REI-ET-AH                      PIC X.
  5377     12  AM-REI-PE-LF                      PIC X.
  5378     12  AM-REI-PE-AH                      PIC X.
  5379     12  AM-REI-PRT-ST                     PIC X.
  5380     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5381     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5382     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5383     12  AM-REI-GROUP-A                    PIC X(6).
  5384     12  AM-REI-MORT                       PIC X(4).
  5385     12  AM-REI-PRT-OW                     PIC X.
  5386     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5387     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5388     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5389     12  AM-REI-GROUP-B                    PIC X(6).
  5390
  5391     12  AM-TRUST-TYPE                     PIC X(2).
  5392
  5393     12  AM-EMPLOYER-STMT-USED             PIC X.
  5394     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5395
  5396     12  AM-STD-AH-TYPE                    PIC XX.
  5397     12  AM-EARN-METHODS.
  5398         16  AM-EARN-METHOD-R              PIC X.
  5399             88 AM-REF-RL-R78                 VALUE 'R'.
  5400             88 AM-REF-RL-PR                  VALUE 'P'.
  5401             88 AM-REF-RL-MEAN                VALUE 'M'.
  5402             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5403         16  AM-EARN-METHOD-L              PIC X.
  5404             88 AM-REF-LL-R78                 VALUE 'R'.
  5405             88 AM-REF-LL-PR                  VALUE 'P'.
  5406             88 AM-REF-LL-MEAN                VALUE 'M'.
  5407             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5408         16  AM-EARN-METHOD-A              PIC X.
  5409             88 AM-REF-AH-R78                 VALUE 'R'.
  5410             88 AM-REF-AH-PR                  VALUE 'P'.
  5411             88 AM-REF-AH-MEAN                VALUE 'M'.
  5412             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5413             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5414             88 AM-REF-AH-NET                 VALUE 'N'.
  5415
  5416     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5417     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5418     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5419
  5420     12  AM-RET-Y-N                        PIC X.
  5421     12  AM-RET-P-E                        PIC X.
  5422     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5423     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5424     12  AM-RET-GRP                        PIC X(6).
  5425     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5426         16  AM-POOL-PRIME                 PIC XXX.
  5427         16  AM-POOL-SUB                   PIC XXX.
  5428     12  AM-RETRO-EARNINGS.
  5429         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 103
* EL130.cbl
  5430         16  AM-RET-EARN-L                 PIC X.
  5431         16  AM-RET-EARN-A                 PIC X.
  5432     12  AM-RET-ST-TAX-USE                 PIC X.
  5433         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5434         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5435     12  AM-RETRO-BEG-EARNINGS.
  5436         16  AM-RET-BEG-EARN-R             PIC X.
  5437         16  AM-RET-BEG-EARN-L             PIC X.
  5438         16  AM-RET-BEG-EARN-A             PIC X.
  5439     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5440     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5441
  5442     12  AM-USER-SELECT-OPTIONS.
  5443         16  AM-USER-SELECT-1              PIC X(10).
  5444         16  AM-USER-SELECT-2              PIC X(10).
  5445         16  AM-USER-SELECT-3              PIC X(10).
  5446         16  AM-USER-SELECT-4              PIC X(10).
  5447         16  AM-USER-SELECT-5              PIC X(10).
  5448
  5449     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5450
  5451     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5452
  5453     12  AM-RPT045A-SWITCH                 PIC X.
  5454         88  RPT045A-OFF                   VALUE 'N'.
  5455
  5456     12  AM-INSURANCE-LIMITS.
  5457         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5458         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5459
  5460     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5461         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5462
  5463     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5464         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5465         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5466
  5467     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5468
  5469     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5470     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5471     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5472     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5473     12  AM-DCC-UEF-STATE                  PIC XX.
  5474     12  FILLER                            PIC XXX.
  5475     12  AM-REPORT-CODE-3                  PIC X(10).
  5476*    12  FILLER                            PIC X(22).
  5477
  5478     12  AM-RESERVE-DATE.
  5479         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5480         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5481         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5482
  5483     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5484     12  AM-NOTIFICATION-TYPES.
  5485         16  AM-NOTIF-OF-LETTERS           PIC X.
  5486         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5487         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 104
* EL130.cbl
  5488         16  AM-NOTIF-OF-STATUS            PIC X.
  5489
  5490     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5491         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5492         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5493         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5494         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5495
  5496     12  AM-BENEFIT-CONTROLS.
  5497         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5498             20  AM-BENEFIT-CODE           PIC XX.
  5499             20  AM-BENEFIT-TYPE           PIC X.
  5500             20  AM-BENEFIT-REVISION       PIC XXX.
  5501             20  AM-BENEFIT-REM-TERM       PIC X.
  5502             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5503             20  FILLER                    PIC XX.
  5504         16  FILLER                        PIC X(80).
  5505
  5506     12  AM-TRANSFER-DATA.
  5507         16  AM-TRANSFERRED-FROM.
  5508             20  AM-TRNFROM-CARRIER        PIC X.
  5509             20  AM-TRNFROM-GROUPING.
  5510                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5511                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5512             20  AM-TRNFROM-STATE          PIC XX.
  5513             20  AM-TRNFROM-ACCOUNT.
  5514                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5515                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5516             20  AM-TRNFROM-DTE            PIC XX.
  5517         16  AM-TRANSFERRED-TO.
  5518             20  AM-TRNTO-CARRIER          PIC X.
  5519             20  AM-TRNTO-GROUPING.
  5520                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5521                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5522             20  AM-TRNTO-STATE            PIC XX.
  5523             20  AM-TRNTO-ACCOUNT.
  5524                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5525                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5526             20  AM-TRNTO-DTE              PIC XX.
  5527         16  FILLER                        PIC X(10).
  5528
  5529     12  AM-SAVED-REMIT-TO                 PIC 99.
  5530
  5531     12  AM-COMM-STRUCTURE-SAVED.
  5532         16  AM-DEFN-1-SAVED.
  5533             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5534                 24  AM-AGT-SV             PIC X(10).
  5535                 24  AM-COM-TYP-SV         PIC X.
  5536                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5537                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5538                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5539                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5540                 24  FILLER                PIC X.
  5541                 24  AM-GL-CODES-SV        PIC X.
  5542                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5543                 24  FILLER                PIC X.
  5544         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5545             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 105
* EL130.cbl
  5546                 24  FILLER                PIC X(11).
  5547                 24  AM-L-COMA-SV          PIC XXX.
  5548                 24  AM-J-COMA-SV          PIC XXX.
  5549                 24  AM-A-COMA-SV          PIC XXX.
  5550                 24  FILLER                PIC X(6).
  5551
  5552     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5553         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5554            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5555            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5556            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5557
  5558     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5559     12  FILLER                            PIC X(120).
  5560
  5561     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5562         16  AM-CONTROL-NAME               PIC X(30).
  5563         16  AM-EXECUTIVE-ONE.
  5564             20  AM-EXEC1-NAME             PIC X(15).
  5565             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5566                                                          COMP-3.
  5567             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5568                                                          COMP-3.
  5569         16  AM-EXECUTIVE-TWO.
  5570             20  AM-EXEC2-NAME             PIC X(15).
  5571             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5572                                                          COMP-3.
  5573             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5574                                                          COMP-3.
  5575
  5576     12  AM-RETRO-ADDITIONAL-DATA.
  5577         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5578         16  AM-RETRO-PREM-P-E             PIC X.
  5579         16  AM-RETRO-CLMS-P-I             PIC X.
  5580         16  AM-RETRO-RET-BRACKET-LF.
  5581             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5582                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5583                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5584             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5585                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5586                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5587             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5588                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5589                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5590         16  AM-RETRO-RET-BRACKET-AH.
  5591             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5592                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5593                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5594                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5595             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5596                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5597                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5598             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5599                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5600                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5601
  5602     12  AM-COMMENTS.
  5603         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 106
* EL130.cbl
  5604
  5605     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5606         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5607         16  AM-FLI-BILLING-CODE           PIC X.
  5608         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5609         16  AM-FLI-UNITED-IDENT           PIC X.
  5610         16  AM-FLI-INTEREST-LOST-DATA.
  5611             20  AM-FLI-BANK-NO            PIC X(5).
  5612             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5613             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5614             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5615         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5616             20  AM-FLI-AGT                PIC X(9).
  5617             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5618             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5619         16  FILLER                        PIC X(102).
  5620
  5621     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5622         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5623             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5624             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5625             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5626             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5627             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5628         16  FILLER                          PIC X(10).
  5629******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 107
* EL130.cbl
  5631*    COPY ELCTRLR.
  5632******************************************************************
  5633*                                                                *
  5634*                            ELCTRLR.                            *
  5635*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5636*                            VMOD=2.014                          *
  5637*                                                                *
  5638*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5639*                                                                *
  5640*   FILE TYPE = VSAM,KSDS                                        *
  5641*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5642*                                                                *
  5643*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5644*       ALTERNATE INDEX = NONE                                   *
  5645*                                                                *
  5646*   LOG = YES                                                    *
  5647*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5648******************************************************************
  5649*                   C H A N G E   L O G
  5650*
  5651* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5652*-----------------------------------------------------------------
  5653*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5654* EFFECTIVE    NUMBER
  5655*-----------------------------------------------------------------
  5656* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5657* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5658* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5659* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5660* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5661* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5662* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5663* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5664* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5665* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5666* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5667* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5668* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5669* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5670* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5671******************************************************************
  5672 01  ACTIVITY-TRAILERS.
  5673     12  AT-RECORD-ID                    PIC XX.
  5674         88  VALID-AT-ID                       VALUE 'AT'.
  5675
  5676     12  AT-CONTROL-PRIMARY.
  5677         16  AT-COMPANY-CD               PIC X.
  5678         16  AT-CARRIER                  PIC X.
  5679         16  AT-CLAIM-NO                 PIC X(7).
  5680         16  AT-CERT-NO.
  5681             20  AT-CERT-PRIME           PIC X(10).
  5682             20  AT-CERT-SFX             PIC X.
  5683         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5684             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5685             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5686             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5687             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5688             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 108
* EL130.cbl
  5689             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5690             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5691             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5692             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5693             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5694             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5695             88  AT-BENEFICIARY-TRL           VALUE +91.
  5696             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5697             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5698             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5699
  5700     12  AT-TRAILER-TYPE                 PIC X.
  5701         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5702         88  PAYMENT-TR                       VALUE '2'.
  5703         88  AUTO-PAY-TR                      VALUE '3'.
  5704         88  CORRESPONDENCE-TR                VALUE '4'.
  5705         88  ADDRESS-TR                       VALUE '5'.
  5706         88  GENERAL-INFO-TR                  VALUE '6'.
  5707         88  AUTO-PROMPT-TR                   VALUE '7'.
  5708         88  DENIAL-TR                        VALUE '8'.
  5709         88  INCURRED-CHG-TR                  VALUE '9'.
  5710         88  FORM-CONTROL-TR                  VALUE 'A'.
  5711
  5712     12  AT-RECORDED-DT                  PIC XX.
  5713     12  AT-RECORDED-BY                  PIC X(4).
  5714     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5715
  5716     12  AT-TRAILER-BODY                 PIC X(165).
  5717
  5718     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5719         16  AT-RESERVE-CONTROLS.
  5720             20  AT-MANUAL-SW            PIC X.
  5721                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5722             20  AT-FUTURE-SW            PIC X.
  5723                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5724             20  AT-PTC-SW               PIC X.
  5725                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5726             20  AT-IBNR-SW              PIC X.
  5727                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5728             20  AT-PTC-LF-SW            PIC X.
  5729                 88  AT-LF-PTC-USED          VALUE '1'.
  5730             20  AT-CDT-ACCESS-METHOD    PIC X.
  5731                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5732                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5733                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5734             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5735         16  AT-LAST-COMPUTED-DT         PIC XX.
  5736         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5737         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5738         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5739         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5740         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5741         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5742         16  AT-EXPENSE-CONTROLS.
  5743             20  AT-EXPENSE-METHOD       PIC X.
  5744                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5745                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5746                 88  PERCENT-OF-PMT           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 109
* EL130.cbl
  5747                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5748             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5749             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5750         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5751         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5752
  5753         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5754         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5755
  5756*        16  FILLER                      PIC X(53).
  5757         16  FILLER                      PIC X(47).
  5758
  5759         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5760         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5761
  5762         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5763             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5764             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5765*                    C = CLOSED
  5766*                    O = OPEN
  5767             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5768*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5769
  5770     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5771         16  AT-PAYMENT-TYPE             PIC X.
  5772             88  PARTIAL-PAYMENT                VALUE '1'.
  5773             88  FINAL-PAYMENT                  VALUE '2'.
  5774             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5775             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5776             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5777             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5778             88  VOIDED-PAYMENT                 VALUE '9'.
  5779             88  TRANSFER                       VALUE 'T'.
  5780             88  LIFE-INTEREST                  VALUE 'I'.
  5781
  5782         16  AT-CLAIM-TYPE               PIC X.
  5783             88  PAID-FOR-AH                    VALUE 'A'.
  5784             88  PAID-FOR-LIFE                  VALUE 'L'.
  5785             88  PAID-FOR-IUI                   VALUE 'I'.
  5786             88  PAID-FOR-GAP                   VALUE 'G'.
  5787         16  AT-CLAIM-PREM-TYPE          PIC X.
  5788             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5789             88  AT-O-B-COVERAGE                VALUE '2'.
  5790             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5791         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5792         16  AT-CHECK-NO                 PIC X(7).
  5793         16  AT-PAID-FROM-DT             PIC XX.
  5794         16  AT-PAID-THRU-DT             PIC XX.
  5795         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5796         16  FILLER                      PIC X.
  5797         16  AT-PAYEES-NAME              PIC X(30).
  5798         16  AT-PAYMENT-ORIGIN           PIC X.
  5799             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5800             88  ONLINE-AUTO-PMT                VALUE '2'.
  5801             88  OFFLINE-PMT                    VALUE '3'.
  5802         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5803         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5804         16  AT-VOID-DATA.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 110
* EL130.cbl
  5805             20  AT-VOID-DT              PIC XX.
  5806*00144       20  AT-VOID-REASON          PIC X(30).
  5807             20  AT-VOID-REASON          PIC X(26).
  5808         16  AT-PMT-APPROVED-BY          PIC X(04).
  5809         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5810         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5811         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5812                                         PIC S99V9(5)  COMP-3.
  5813         16  AT-CREDIT-INTERFACE.
  5814             20  AT-PMT-SELECT-DT        PIC XX.
  5815                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5816             20  AT-PMT-ACCEPT-DT        PIC XX.
  5817                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5818             20  AT-VOID-SELECT-DT       PIC XX.
  5819                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5820             20  AT-VOID-ACCEPT-DT       PIC XX.
  5821                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5822
  5823         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5824                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5825                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5826         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5827
  5828         16  AT-FORCE-CONTROL            PIC X.
  5829             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5830         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5831         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5832         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5833         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5834         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5835         16  AT-BENEFIT-TYPE             PIC X.
  5836
  5837         16  AT-EXPENSE-TYPE             PIC X.
  5838         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5839
  5840         16  AT-PAYEE-TYPE-CD.
  5841             20  AT-PAYEE-TYPE           PIC X.
  5842                 88  INSURED-PAID           VALUE 'I'.
  5843                 88  BENEFICIARY-PAID       VALUE 'B'.
  5844                 88  ACCOUNT-PAID           VALUE 'A'.
  5845                 88  OTHER-1-PAID           VALUE 'O'.
  5846                 88  OTHER-2-PAID           VALUE 'Q'.
  5847                 88  DOCTOR-PAID            VALUE 'P'.
  5848                 88  EMPLOYER-PAID          VALUE 'E'.
  5849             20  AT-PAYEE-SEQ            PIC X.
  5850
  5851         16  AT-CASH-PAYMENT             PIC X.
  5852         16  AT-GROUPED-PAYMENT          PIC X.
  5853         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5854         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5855         16  AT-APPROVED-LEVEL           PIC X.
  5856         16  AT-VOID-TYPE                PIC X.
  5857             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5858             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5859         16  AT-AIG-UNEMP-IND            PIC X.
  5860             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5861         16  AT-ASSOCIATES               PIC X.
  5862             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 111
* EL130.cbl
  5863             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5864
  5865         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  5866         16  AT-CV-PMT-CODE              PIC X.
  5867             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5868             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5869             88  FULL-ADD-PAYMENT           VALUE '3'.
  5870             88  HALF-ADD-PAYMENT           VALUE '4'.
  5871             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5872             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5873             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5874             88  ADDL-PAYMENT               VALUE '8'.
  5875
  5876         16  AT-EOB-CODE1                PIC XXX.
  5877         16  AT-EOB-CODE2                PIC XXX.
  5878         16  AT-EOB-CODE3                PIC XXX.
  5879         16  FILLER REDEFINES AT-EOB-CODE3.
  5880             20  AT-PRINT-CLM-FORM       PIC X.
  5881             20  AT-PRINT-SURVEY         PIC X.
  5882             20  FILLER                  PIC X.
  5883         16  AT-EOB-CODE4                PIC XXX.
  5884         16  FILLER REDEFINES AT-EOB-CODE4.
  5885             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5886             20  FILLER                  PIC X.
  5887         16  AT-EOB-CODE5                PIC XXX.
  5888         16  FILLER REDEFINES AT-EOB-CODE5.
  5889             20  AT-PMT-PROOF-DT         PIC XX.
  5890             20  FILLER                  PIC X.
  5891
  5892         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5893             88  AT-PRINT-EOB            VALUE 'Y'.
  5894
  5895         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5896         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5897
  5898     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5899         16  AT-SCHEDULE-START-DT        PIC XX.
  5900         16  AT-SCHEDULE-END-DT          PIC XX.
  5901         16  AT-TERMINATED-DT            PIC XX.
  5902         16  AT-LAST-PMT-TYPE            PIC X.
  5903             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5904             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5905         16  AT-FIRST-PMT-DATA.
  5906             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5907             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5908             20  AT-1ST-PAY-THRU-DT      PIC XX.
  5909         16  AT-REGULAR-PMT-DATA.
  5910             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  5911             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  5912             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  5913         16  AT-AUTO-PAYEE-CD.
  5914             20  AT-AUTO-PAYEE-TYPE      PIC X.
  5915                 88  INSURED-PAID-AUTO      VALUE 'I'.
  5916                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  5917                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  5918                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  5919                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  5920             20  AT-AUTO-PAYEE-SEQ       PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 112
* EL130.cbl
  5921         16  AT-AUTO-PAY-DAY             PIC 99.
  5922         16  AT-AUTO-CASH                PIC X.
  5923             88  AT-CASH                      VALUE 'Y'.
  5924             88  AT-NON-CASH                  VALUE 'N'.
  5925*        16  FILLER                      PIC X(129).
  5926         16  AT-AUTO-END-LETTER          PIC X(4).
  5927         16  FILLER                      PIC X(125).
  5928
  5929         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  5930         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  5931
  5932     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  5933         16  AT-LETTER-SENT-DT           PIC XX.
  5934         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  5935         16  AT-AUTO-RE-SEND-DT          PIC XX.
  5936         16  AT-LETTER-ANSWERED-DT       PIC XX.
  5937         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  5938         16  AT-LETTER-ORIGIN            PIC X.
  5939             88  ONLINE-CREATION              VALUE '1' '3'.
  5940             88  OFFLINE-CREATION             VALUE '2' '4'.
  5941             88  NAPER-ONLINE-CREATION        VALUE '3'.
  5942             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  5943         16  AT-STD-LETTER-FORM          PIC X(4).
  5944         16  AT-REASON-TEXT              PIC X(70).
  5945         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  5946         16  AT-ADDRESEE-TYPE            PIC X.
  5947              88  INSURED-ADDRESEE            VALUE 'I'.
  5948              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  5949              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  5950              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  5951              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  5952              88  OTHER-ADDRESEE-1            VALUE 'O'.
  5953              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  5954         16  AT-ADDRESSEE-NAME           PIC X(30).
  5955         16  AT-INITIAL-PRINT-DATE       PIC XX.
  5956         16  AT-RESEND-PRINT-DATE        PIC XX.
  5957         16  AT-CORR-SOL-UNSOL           PIC X.
  5958         16  AT-LETTER-PURGED-DT         PIC XX.
  5959*
  5960*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  5961*
  5962         16  AT-CSO-REDEFINITION.
  5963             20  AT-RESEND-LETTER-FORM   PIC X(4).
  5964             20  AT-AUTO-CLOSE-IND       PIC X(1).
  5965             20  AT-LETTER-TO-BENE       PIC X(1).
  5966             20  AT-STOP-LETTER-DT       PIC X(2).
  5967             20  FILLER                  PIC X(19).
  5968*             20  FILLER                  PIC X(27).
  5969             20  AT-CSO-LETTER-STATUS    PIC X.
  5970                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  5971                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  5972                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  5973             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  5974             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  5975*
  5976*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  5977*
  5978*        16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 113
* EL130.cbl
  5979*
  5980*        16  AT-DMD-BSR-CODE             PIC X.
  5981*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  5982*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  5983*
  5984*        16  AT-DMD-LETTER-STATUS        PIC X.
  5985*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  5986*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  5987*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  5988*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  5989*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  5990
  5991         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  5992         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  5993
  5994     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  5995         16  AT-ADDRESS-TYPE             PIC X.
  5996             88  INSURED-ADDRESS               VALUE 'I'.
  5997             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  5998             88  ACCOUNT-ADDRESS               VALUE 'A'.
  5999             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6000             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6001             88  OTHER-ADDRESS-1               VALUE 'O'.
  6002             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6003         16  AT-MAIL-TO-NAME             PIC X(30).
  6004         16  AT-ADDRESS-LINE-1           PIC X(30).
  6005         16  AT-ADDRESS-LINE-2           PIC X(30).
  6006         16  AT-CITY-STATE.
  6007             20  AT-CITY                 PIC X(28).
  6008             20  AT-STATE                PIC XX.
  6009         16  AT-ZIP.
  6010             20  AT-ZIP-CODE.
  6011                 24  AT-ZIP-1ST          PIC X.
  6012                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6013                 24  FILLER              PIC X(4).
  6014             20  AT-ZIP-PLUS4            PIC X(4).
  6015         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6016             20  AT-CAN-POSTAL-1         PIC XXX.
  6017             20  AT-CAN-POSTAL-2         PIC XXX.
  6018             20  FILLER                  PIC XXX.
  6019         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6020*         16  FILLER                      PIC X(23).
  6021         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6022         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6023         16  FILLER                      PIC X(13).
  6024         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6025         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6026
  6027     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6028         16  AT-INFO-LINE-1              PIC X(60).
  6029         16  AT-INFO-LINE-2              PIC X(60).
  6030         16  AT-INFO-TRAILER-TYPE        PIC X.
  6031             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6032             88  AT-CALL-NOTE            VALUE 'C'.
  6033             88  AT-MAINT-NOTE           VALUE 'M'.
  6034             88  AT-CERT-CHANGE          VALUE 'X'.
  6035             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6036             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 114
* EL130.cbl
  6037         16  AT-CALL-TYPE                PIC X.
  6038             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6039             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6040         16  AT-NOTE-CONTINUATION        PIC X.
  6041             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6042         16  AT-EOB-CODES-EXIST          PIC X.
  6043             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6044         16  FILLER                      PIC X(35).
  6045         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6046         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6047
  6048     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6049         16  AT-PROMPT-LINE-1            PIC X(60).
  6050         16  AT-PROMPT-LINE-2            PIC X(60).
  6051         16  AT-PROMPT-START-DT          PIC XX.
  6052         16  AT-PROMPT-END-DT            PIC XX.
  6053         16  FILLER                      PIC X(35).
  6054         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6055         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6056
  6057     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6058         16  AT-DENIAL-INFO-1            PIC X(60).
  6059         16  AT-DENIAL-INFO-2            PIC X(60).
  6060         16  AT-DENIAL-DT                PIC XX.
  6061         16  AT-RETRACTION-DT            PIC XX.
  6062         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6063*         16  FILLER                      PIC X(31).
  6064         16  AT-DENIAL-PROOF-DT          PIC XX.
  6065         16  FILLER                      PIC X(29).
  6066         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6067         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6068
  6069     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6070         16  AT-OLD-INCURRED-DT          PIC XX.
  6071         16  AT-OLD-REPORTED-DT          PIC XX.
  6072         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6073         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6074         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6075         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6076         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6077         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6078         16  FILLER                      PIC X(26).
  6079         16  AT-OLD-DIAG-CODE            PIC X(6).
  6080         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6081         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6082         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6083         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6084         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6085         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6086         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6087         16  FILLER                      PIC X(25).
  6088         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6089
  6090     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6091         16  AT-FORM-SEND-ON-DT          PIC XX.
  6092         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6093         16  AT-FORM-RE-SEND-DT          PIC XX.
  6094         16  AT-FORM-ANSWERED-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 115
* EL130.cbl
  6095         16  AT-FORM-PRINTED-DT          PIC XX.
  6096         16  AT-FORM-REPRINT-DT          PIC XX.
  6097         16  AT-FORM-TYPE                PIC X.
  6098             88  INITIAL-FORM                  VALUE '1'.
  6099             88  PROGRESS-FORM                 VALUE '2'.
  6100         16  AT-INSTRUCT-LN-1            PIC X(28).
  6101         16  AT-INSTRUCT-LN-2            PIC X(28).
  6102         16  AT-INSTRUCT-LN-3            PIC X(28).
  6103         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6104         16  AT-FORM-ADDRESS             PIC X.
  6105             88  FORM-TO-INSURED              VALUE 'I'.
  6106             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6107             88  FORM-TO-OTHER-1              VALUE 'O'.
  6108             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6109         16  AT-RELATED-1.
  6110             20 AT-REL-CARR-1            PIC X.
  6111             20 AT-REL-CLAIM-1           PIC X(7).
  6112             20 AT-REL-CERT-1            PIC X(11).
  6113         16  AT-RELATED-2.
  6114             20 AT-REL-CARR-2            PIC X.
  6115             20 AT-REL-CLAIM-2           PIC X(7).
  6116             20 AT-REL-CERT-2            PIC X(11).
  6117         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6118         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6119         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6120         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6121         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6122         16  AT-STOP-FORM-DT             PIC X(2).
  6123
  6124         16  FILLER                      PIC X(09).
  6125         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6126         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6127******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 116
* EL130.cbl
  6129*    COPY ELCBENE.
  6130******************************************************************
  6131*                                                                *
  6132*                            ELCBENE.                            *
  6133*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6134*                            VMOD=2.006                          *
  6135*                                                                *
  6136*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6137*                                                                *
  6138*   FILE TYPE = VSAM,KSDS                                        *
  6139*   RECORD SIZE = 500   RECFORM = FIX                            *
  6140*                                                                *
  6141*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6142*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6143*                                                                *
  6144*   LOG = YES                                                    *
  6145*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6146*                                                                *
  6147*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6148******************************************************************
  6149
  6150 01  BENEFICIARY-MASTER.
  6151     12  BE-RECORD-ID                PIC XX.
  6152         88  VALID-BE-ID                VALUE 'BE'.
  6153
  6154     12  BE-CONTROL-PRIMARY.
  6155         16  BE-COMPANY-CD           PIC X.
  6156         16  BE-RECORD-TYPE          PIC X.
  6157             88  BENEFICIARY-RECORD  VALUE 'B'.
  6158             88  ADJUSTOR-RECORD     VALUE 'A'.
  6159         16  BE-BENEFICIARY          PIC X(10).
  6160     12  BE-CONTROL-BY-NAME.
  6161         16  BE-COMPANY-CD-A1        PIC X.
  6162         16  BE-RECORD-TYPE-A1       PIC X.
  6163         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6164         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6165
  6166     12  BE-LAST-MAINT-DT            PIC XX.
  6167     12  BE-LAST-MAINT-BY            PIC X(4).
  6168     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6169
  6170     12  BE-ADDRESS-DATA.
  6171         16  BE-MAIL-TO-NAME         PIC X(30).
  6172         16  BE-ADDRESS-LINE-1       PIC X(30).
  6173         16  BE-ADDRESS-LINE-2       PIC X(30).
  6174         16  BE-ADDRESS-LINE-3       PIC X(30).
  6175         16  BE-CITY-STATE.
  6176             20  BE-CITY             PIC X(28).
  6177             20  BE-STATE            PIC XX.
  6178         16  BE-ZIP-CODE.
  6179             20  BE-ZIP-PRIME.
  6180                 24  BE-ZIP-1ST      PIC X.
  6181                     88  BE-CANADIAN-POST-CODE
  6182                                         VALUE 'A' THRU 'Z'.
  6183                 24  FILLER          PIC X(4).
  6184             20  BE-ZIP-PLUS4        PIC X(4).
  6185         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6186             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 117
* EL130.cbl
  6187             20  BE-CAN-POSTAL-2     PIC XXX.
  6188             20  FILLER              PIC XXX.
  6189         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6190         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6191
  6192******************************************************************
  6193*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6194*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6195******************************************************************
  6196     12  BE-CARRIER                  PIC X.
  6197
  6198     12  BE-ADDRESS-DATA2.
  6199         16  BE-MAIL-TO-NAME2        PIC X(30).
  6200         16  BE-ADDRESS-LINE-12      PIC X(30).
  6201         16  BE-ADDRESS-LINE-22      PIC X(30).
  6202         16  BE-ADDRESS-LINE-32      PIC X(30).
  6203         16  BE-CITY-STATE2.
  6204             20  BE-CITY2            PIC X(28).
  6205             20  BE-STATE2           PIC XX.
  6206         16  BE-ZIP-CODE2.
  6207             20  BE-ZIP-PRIME2.
  6208                 24  BE-ZIP-1ST2     PIC X.
  6209                     88  BE-CANADIAN-POST-CODE2
  6210                                         VALUE 'A' THRU 'Z'.
  6211                 24  FILLER          PIC X(4).
  6212             20  BE-ZIP-PLUS42       PIC X(4).
  6213         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6214             20  BE-CAN-POSTAL-12    PIC XXX.
  6215             20  BE-CAN-POSTAL-22    PIC XXX.
  6216             20  FILLER              PIC XXX.
  6217         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6218         16  BE-BILLING-STMT-DATA.
  6219             20  BE-BSR              PIC X.
  6220                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6221                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6222             20  BE-BSR-FROM         PIC X(30).
  6223             20  BE-BSR-DEPT         PIC X(30).
  6224             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6225             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6226             20  BE-OUTPUT-TYPE      PIC X.
  6227                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6228                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6229
  6230     12  FILLER                      PIC X(28).
  6231******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 118
* EL130.cbl
  6233*    COPY ELCDAR.
  6234******************************************************************
  6235*                                                                *
  6236*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6237*   FILE TYPE = VSAM,KSDS                                        *
  6238*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6239*   BASE CLUSTER = DLYACTV                                       *
  6240*   LOG = YES                                                    *
  6241*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6242*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6243*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6244*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6245*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6246*               BY PROGRAM "LGINFCE".                            *
  6247*                                                                *
  6248******************************************************************
  6249 01  DAILY-ACTIVITY-RECORD.
  6250     05  DA-KEY.
  6251         10  DA-COMP-CD          PIC X.
  6252         10  DA-CARRIER          PIC X.
  6253         10  DA-CLAIM-NO         PIC X(7).
  6254         10  DA-CERT-NO.
  6255             15  DA-CERT-PRIME   PIC X(10).
  6256             15  DA-CERT-SFX     PIC X.
  6257     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6258     05  DA-RECORD-TYPE          PIC X.
  6259     05  FILLER                  PIC X(2).
  6260******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 119
* EL130.cbl
  6262*    COPY ELCACTQ.
  6263******************************************************************
  6264*                                                                *
  6265*                            ELCACTQ.                            *
  6266*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6267*                            VMOD=2.004                          *
  6268*                                                                *
  6269*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6270*                                                                *
  6271*   FILE TYPE = VSAM,KSDS                                        *
  6272*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6273*                                                                *
  6274*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6275*       ALTERNATE INDEX = NONE                                   *
  6276*                                                                *
  6277*   LOG = YES                                                    *
  6278*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6279*                                                                *
  6280*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6281******************************************************************
  6282
  6283 01  ACTIVITY-QUE.
  6284     12  AQ-RECORD-ID                PIC XX.
  6285         88  VALID-AQ-ID                VALUE 'AQ'.
  6286
  6287     12  AQ-CONTROL-PRIMARY.
  6288         16  AQ-COMPANY-CD           PIC X.
  6289         16  AQ-CARRIER              PIC X.
  6290         16  AQ-CLAIM-NO             PIC X(7).
  6291         16  AQ-CERT-NO.
  6292             20  AQ-CERT-PRIME       PIC X(10).
  6293             20  AQ-CERT-SFX         PIC X.
  6294
  6295     12  AQ-PENDING-ACTIVITY-FLAGS.
  6296         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6297         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6298             88  PENDING-PAYMENTS       VALUE '1'.
  6299         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6300             88  PENDING-FULL-PRINT     VALUE '1'.
  6301             88  PENDING-PART-PRINT     VALUE '2'.
  6302         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6303             88  PENDING-LETTERS        VALUE '1'.
  6304         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6305             88  PENDING-RESTORE        VALUE 'C'.
  6306             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6307
  6308     12  FILLER                      PIC X(20).
  6309
  6310     12  AQ-RESEND-DATE              PIC XX.
  6311     12  AQ-FOLLOWUP-DATE            PIC XX.
  6312     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6313     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6314     12  AQ-AUTO-LETTER              PIC X(4).
  6315     12  FILLER                      PIC XX.
  6316     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6317*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 120
* EL130.cbl
  6319*    COPY ELCARCH.
  6320******************************************************************
  6321*                                                                *
  6322*                            ELCARCH.                            *
  6323*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6324*                            VMOD=2.007                          *
  6325*                                                                *
  6326*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6327*                                                                *
  6328*   FILE TYPE = VSAM,KSDS                                        *
  6329*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6330*                                                                *
  6331*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6332*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6333*                                                                *
  6334*   LOG = NO                                                     *
  6335*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6336*                                                                *
  6337*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6338******************************************************************
  6339 01  LETTER-ARCHIVE.
  6340     12  LA-RECORD-ID                PIC XX.
  6341         88  VALID-LA-ID                VALUE 'LA'.
  6342
  6343     12  LA-CONTROL-PRIMARY.
  6344         16  LA-COMPANY-CD           PIC X.
  6345         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6346         16  LA-RECORD-TYPE          PIC X.
  6347             88  LA-HEADER-DATA         VALUE '1'.
  6348             88  LA-ADDRESS-DATA        VALUE '2'.
  6349             88  LA-TEXT-DATA           VALUE '3'.
  6350             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6351         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6352
  6353     12  LA-CONTROL-BY-TYPE.
  6354         16  LA-COMPANY-CD-A1        PIC X.
  6355         16  LA-RECORD-TYPE-A1       PIC X.
  6356         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6357         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6358
  6359     12  LA-TEXT-RECORD.
  6360         16  LA-SKIP-CONTROL         PIC XX.
  6361             88  NO-LINES-SKIPPED       VALUE SPACES.
  6362             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6363         16  LA-TEXT-LINE            PIC X(70).
  6364
  6365     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6366         16  FILLER                  PIC XX.
  6367         16  LA-ADDRESS-LINE         PIC X(30).
  6368         16  FILLER                  PIC X(40).
  6369
  6370     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6371         16  FILLER                  PIC XX.
  6372         16  LA-CARRIER              PIC X.
  6373         16  LA-CLAIM-NO             PIC X(7).
  6374         16  LA-CERT-NO.
  6375             20  LA-CERT-PRIME       PIC X(10).
  6376             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 121
* EL130.cbl
  6377         16  LA-NO-OF-COPIES         PIC S9.
  6378         16  LA-RESEND-DATE          PIC XX.
  6379         16  LA-PROCESSOR-CD         PIC X(4).
  6380         16  LA-CREATION-DT          PIC XX.
  6381         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6382         16  LA-RESEND-PRINT-DATE    PIC XX.
  6383         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6384         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6385*
  6386* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6387*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6388*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6389*   I        20  LA-DMD-RES-ST           PIC XX.
  6390*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6391*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6392*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6393*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6394*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6395*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6396*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6397*   I        20  LA-DMD-UND-CODE         PIC XX.
  6398*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6399*   V    16  FILLER                  PIC X(15).
  6400* -----
  6401*
  6402* REINSERTED  CSO  MODS
  6403*
  6404         16  FILLER.
  6405             20  FILLER                  PIC X(29).
  6406             20  LA-CSO-LETTER-STATUS    PIC X.
  6407                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6408                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6409                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6410             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6411             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6412*
  6413
  6414     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6415         16  FILLER                  PIC XX.
  6416         16  LA4-CARRIER             PIC X.
  6417         16  LA4-CLAIM-NO            PIC X(7).
  6418         16  LA4-CERT-NO.
  6419             20  LA4-CERT-PRIME      PIC X(10).
  6420             20  LA4-CERT-SFX        PIC X.
  6421         16  LA4-NO-OF-COPIES        PIC S9.
  6422         16  LA4-RESEND-DATE         PIC XX.
  6423         16  LA4-PROCESSOR-CD        PIC X(4).
  6424         16  LA4-CREATION-DT         PIC XX.
  6425         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6426         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6427         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6428         16  LA4-FORM-TYPE           PIC X.
  6429             88  LA4-INITIAL-FORM    VALUE '1'.
  6430             88  LA4-PROGRESS-FORM   VALUE '2'.
  6431         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6432         16  LA4-STATE               PIC X(02).
  6433         16  FILLER                  PIC X(31).
  6434******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 122
* EL130.cbl
  6436*    COPY ERCREIN.
  6437******************************************************************
  6438*                                                                *
  6439*                            ERCREIN                             *
  6440*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6441*                            VMOD=2.010                          *
  6442*                                                                *
  6443*   ONLINE CREDIT SYSTEM                                         *
  6444*                                                                *
  6445*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6446*                                                                *
  6447*   FILE TYPE = VSAM,KSDS                                        *
  6448*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6449*                                                                *
  6450*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6451*       ALTERNATE PATH = NONE                                    *
  6452*                                                                *
  6453*   LOG = NO                                                     *
  6454*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6455*                                                                *
  6456******************************************************************
  6457*                   C H A N G E   L O G
  6458*
  6459* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6460*-----------------------------------------------------------------
  6461*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6462* EFFECTIVE    NUMBER
  6463*-----------------------------------------------------------------
  6464* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6465* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6466******************************************************************
  6467 01  REINSURANCE-RECORD.
  6468     12  RE-RECORD-ID                      PIC XX.
  6469         88  VALID-RE-ID                      VALUE 'RE'.
  6470
  6471     12  RE-CONTROL-PRIMARY.
  6472         16  RE-COMPANY-CD                 PIC X.
  6473         16  RE-KEY.
  6474             20  RE-CODE                   PIC X.
  6475                 88  RE-TABLE-RECORD          VALUE 'A'.
  6476                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6477             20  RE-TABLE                  PIC XXX.
  6478             20  FILLER                    PIC XXX.
  6479         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6480             20  FILLER                    PIC X.
  6481             20  RE-COMPANY.
  6482                 24  RE-COMP-PRIME         PIC XXX.
  6483                 24  RE-COMP-SUB           PIC XXX.
  6484
  6485     12  RE-MAINT-INFORMATION.
  6486         16  RE-LAST-MAINT-DT              PIC XX.
  6487         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6488         16  RE-LAST-MAINT-USER            PIC X(4).
  6489         16  FILLER                        PIC X(10).
  6490
  6491     12  RE-TABLE-DATA.
  6492         16  RE-100-COMP                   PIC 99.
  6493
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 123
* EL130.cbl
  6494         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6495             20  RE-REI-COMP-NO.
  6496                 24  RE-REI-COMP           PIC XXX.
  6497                 24  RE-REI-COMP-SUB       PIC XXX.
  6498             20  RE-LF-QC                  PIC X.
  6499             20  RE-AH-QC                  PIC X.
  6500             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6501             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6502             20  RE-LFAGE-LO               PIC 99.
  6503             20  RE-LFAGE-HI               PIC 99.
  6504             20  RE-AHAGE-LO               PIC 99.
  6505             20  RE-AHAGE-HI               PIC 99.
  6506             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6507             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6508             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6509             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6510             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6511             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6512             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6513             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6514             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6515             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6516             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6517             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6518             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6519             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6520             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6521             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6522             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6523             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6524             20  RE-LF-BEN-CODE            PIC X.
  6525             20  RE-AH-BEN-CODE            PIC X.
  6526             20  RE-INTERACTIVE            PIC X.
  6527             20  RE-REMAINING              PIC X.
  6528             20  RE-LF-RUNOFF-SW           PIC X.
  6529             20  RE-AH-RUNOFF-SW           PIC X.
  6530             20  FILLER                    PIC X(19).
  6531
  6532         16  RE-COMP-INFO-END              PIC X(6).
  6533         16  RE-NSP-ST-CD-LF               PIC XX.
  6534         16  RE-NSP-ST-CD-AH               PIC XX.
  6535         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6536             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6537
  6538         16  FILLER                        PIC X(27).
  6539
  6540     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6541         16  RE-NAME                       PIC X(30).
  6542         16  RE-LF-PE                      PIC X.
  6543         16  RE-AH-PE                      PIC X.
  6544         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6545         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6546         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6547         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6548         16  RE-PRT-ST                     PIC X.
  6549         16  RE-PRT-OW                     PIC X.
  6550         16  RE-MORT-CODE                  PIC X(4).
  6551         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 124
* EL130.cbl
  6552         16  RE-ZERO-LF-FEE                PIC X.
  6553         16  RE-ZERO-AH-FEE                PIC X.
  6554         16  RE-CEDE-NAME                  PIC X(30).
  6555         16  RE-LF-COMM                    PIC X.
  6556         16  RE-AH-COMM                    PIC X.
  6557         16  RE-LF-TAX                     PIC X.
  6558         16  RE-AH-TAX                     PIC X.
  6559         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6560         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6561         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6562
  6563         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6564             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6565
  6566         16  RE-LF-CEDING-FEE-BRACKETS.
  6567             20  RE-LF-FEE-METHOD          PIC X.
  6568                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6569                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6570                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6571                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6572             20  RE-LF-FEE-BASIS           PIC X.
  6573                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6574                 88  RE-LF-NET-CEDED               VALUE '2'.
  6575                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6576                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6577                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6578                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6579                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6580                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6581             20  FILLER                    PIC XXX.
  6582             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6583                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6584                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6585
  6586         16  RE-AH-CEDING-FEE-BRACKETS.
  6587             20  RE-AH-FEE-METHOD          PIC X.
  6588                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6589                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6590                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6591                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6592             20  RE-AH-FEE-BASIS           PIC X.
  6593                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6594                 88  RE-AH-NET-CEDED               VALUE '2'.
  6595                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6596                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6597                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6598                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6599                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6600                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6601             20  FILLER                    PIC XXX.
  6602             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6603                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6604                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6605
  6606         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6607
  6608         16  RE-OLD-CEDING-STMT            PIC X.
  6609
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 125
* EL130.cbl
  6610         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6611         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6612         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6613         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6614         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6615         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6616         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6617         16  RE-MORT-SW                    PIC X.
  6618         16  RE-CEDING-TYPE-FLAG           PIC X.
  6619             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6620             88  RE-CEDED                          VALUE 'C'.
  6621             88  RE-ASSUMED                        VALUE 'A'.
  6622             88  RE-PHANTOM                        VALUE 'P'.
  6623
  6624         16  RE-CEDING-STMT-OPT-A          PIC X.
  6625             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6626         16  RE-CEDING-STMT-OPT-B          PIC X.
  6627             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6628         16  RE-CEDING-STMT-OPT-C          PIC X.
  6629             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6630         16  RE-CEDING-STMT-OPT-D          PIC X.
  6631             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6632         16  RE-CEDING-STMT-OPT-E          PIC X.
  6633             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6634
  6635         16  RE-PRT-CRSV                   PIC X.
  6636
  6637         16  RE-GL-CENTER                  PIC X(4).
  6638
  6639         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6640
  6641         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6642
  6643         16  RE-EARN-STOP-CODE             PIC X.
  6644             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6645             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6646
  6647         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6648             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6649
  6650         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6651         16  FILLER                        PIC X(2281).
  6652
  6653         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6654
  6655******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 126
* EL130.cbl
  6657*    COPY ERCMAIL.
  6658******************************************************************
  6659*                                                                *
  6660*                                                                *
  6661*                            ERCMAIL                             *
  6662*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6663*                            VMOD=2.003                          *
  6664*                                                                *
  6665*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6666*                                                                *
  6667*   FILE TYPE = VSAM,KSDS                                        *
  6668*   RECORD SIZE = 374   RECFORM = FIX                            *
  6669*                                                                *
  6670*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6671*   ALTERNATE PATH    = NOT USED                                 *
  6672*                                                                *
  6673*   LOG = YES                                                    *
  6674*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6675******************************************************************
  6676*                   C H A N G E   L O G
  6677*
  6678* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6679*-----------------------------------------------------------------
  6680*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6681* EFFECTIVE    NUMBER
  6682*-----------------------------------------------------------------
  6683* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6684* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6685* 111108                   PEMA  ADD CRED BENE ADDR2
  6686******************************************************************
  6687
  6688 01  MAILING-DATA.
  6689     12  MA-RECORD-ID                      PIC XX.
  6690         88  VALID-MA-ID                       VALUE 'MA'.
  6691
  6692     12  MA-CONTROL-PRIMARY.
  6693         16  MA-COMPANY-CD                 PIC X.
  6694         16  MA-CARRIER                    PIC X.
  6695         16  MA-GROUPING.
  6696             20  MA-GROUPING-PREFIX        PIC XXX.
  6697             20  MA-GROUPING-PRIME         PIC XXX.
  6698         16  MA-STATE                      PIC XX.
  6699         16  MA-ACCOUNT.
  6700             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6701             20  MA-ACCOUNT-PRIME          PIC X(6).
  6702         16  MA-CERT-EFF-DT                PIC XX.
  6703         16  MA-CERT-NO.
  6704             20  MA-CERT-PRIME             PIC X(10).
  6705             20  MA-CERT-SFX               PIC X.
  6706
  6707     12  FILLER                            PIC XX.
  6708
  6709     12  MA-ACCESS-CONTROL.
  6710         16  MA-SOURCE-SYSTEM              PIC XX.
  6711             88  MA-FROM-CREDIT                VALUE 'CR'.
  6712             88  MA-FROM-VSI                   VALUE 'VS'.
  6713             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6714             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 127
* EL130.cbl
  6715         16  MA-RECORD-ADD-DT              PIC XX.
  6716         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6717         16  MA-LAST-MAINT-DT              PIC XX.
  6718         16  MA-LAST-MAINT-BY              PIC XXXX.
  6719         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6720
  6721     12  MA-PROFILE-INFO.
  6722         16  MA-QUALIFY-CODE-1             PIC XX.
  6723         16  MA-QUALIFY-CODE-2             PIC XX.
  6724         16  MA-QUALIFY-CODE-3             PIC XX.
  6725         16  MA-QUALIFY-CODE-4             PIC XX.
  6726         16  MA-QUALIFY-CODE-5             PIC XX.
  6727
  6728         16  MA-INSURED-LAST-NAME          PIC X(15).
  6729         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6730         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6731         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6732         16  MA-INSURED-BIRTH-DT           PIC XX.
  6733         16  MA-INSURED-SEX                PIC X.
  6734             88  MA-SEX-MALE                   VALUE 'M'.
  6735             88  MA-SEX-FEMALE                 VALUE 'F'.
  6736         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6737
  6738         16  MA-ADDRESS-CORRECTED          PIC X.
  6739         16  MA-JOINT-BIRTH-DT             PIC XX.
  6740*        16  FILLER                        PIC X(12).
  6741
  6742         16  MA-ADDRESS-LINE-1             PIC X(30).
  6743         16  MA-ADDRESS-LINE-2             PIC X(30).
  6744         16  MA-CITY-STATE.
  6745             20  MA-CITY                   PIC X(28).
  6746             20  MA-ADDR-STATE             PIC XX.
  6747         16  MA-ZIP.
  6748             20  MA-ZIP-CODE.
  6749                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6750                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6751                 24  FILLER                PIC X(4).
  6752             20  MA-ZIP-PLUS4              PIC X(4).
  6753         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6754             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6755             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6756             20  FILLER                    PIC X(3).
  6757
  6758         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6759
  6760         16  FILLER                        PIC XXX.
  6761*        16  FILLER                        PIC X(10).
  6762
  6763     12  MA-CRED-BENE-INFO.
  6764         16  MA-CRED-BENE-NAME                 PIC X(25).
  6765         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6766         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6767         16  MA-CRED-BENE-CTYST.
  6768             20  MA-CRED-BENE-CITY             PIC X(28).
  6769             20  MA-CRED-BENE-STATE            PIC XX.
  6770         16  MA-CRED-BENE-ZIP.
  6771             20  MA-CB-ZIP-CODE.
  6772                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 128
* EL130.cbl
  6773                     88  MA-CB-CANADIAN-POST-CODE
  6774                                           VALUE 'A' THRU 'Z'.
  6775                 24  FILLER                    PIC X(4).
  6776             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6777         16  MA-CB-CANADIAN-POSTAL-CODE
  6778                            REDEFINES MA-CRED-BENE-ZIP.
  6779             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6780             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6781             20  FILLER                        PIC X(3).
  6782     12  MA-POST-CARD-MAIL-DATA.
  6783         16  MA-MAIL-DATA OCCURS 7.
  6784             20  MA-MAIL-TYPE              PIC X.
  6785                 88  MA-12MO-MAILING           VALUE '1'.
  6786                 88  MA-EXP-MAILING            VALUE '2'.
  6787             20  MA-MAIL-STATUS            PIC X.
  6788                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6789                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6790                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6791             20  MA-MAIL-DATE              PIC XX.
  6792     12  FILLER                            PIC XX.
  6793     12  FILLER                            PIC XX.
  6794*    12  FILLER                            PIC X(30).
  6795******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 129
* EL130.cbl
  6797*    COPY ELCCRTT.
  6798******************************************************************
  6799*                                                                *
  6800*                            ELCCRTT.                            *
  6801*                                                                *
  6802*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  6803*                                                                *
  6804*   FILE TYPE = VSAM,KSDS                                        *
  6805*   RECORD SIZE = 552  RECFORM = FIXED                           *
  6806*                                                                *
  6807*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  6808*                                                                *
  6809*   LOG = YES                                                    *
  6810*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6811******************************************************************
  6812*                   C H A N G E   L O G
  6813*
  6814* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6815*-----------------------------------------------------------------
  6816*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6817* EFFECTIVE    NUMBER
  6818*-----------------------------------------------------------------
  6819* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  6820* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  6821* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  6822* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  6823******************************************************************
  6824
  6825 01  CERTIFICATE-TRAILERS.
  6826     12  CS-RECORD-ID                      PIC XX.
  6827         88  VALID-CS-ID                      VALUE 'CS'.
  6828
  6829     12  CS-CONTROL-PRIMARY.
  6830         16  CS-COMPANY-CD                 PIC X.
  6831         16  CS-CARRIER                    PIC X.
  6832         16  CS-GROUPING                   PIC X(6).
  6833         16  CS-STATE                      PIC XX.
  6834         16  CS-ACCOUNT                    PIC X(10).
  6835         16  CS-CERT-EFF-DT                PIC XX.
  6836         16  CS-CERT-NO.
  6837             20  CS-CERT-PRIME             PIC X(10).
  6838             20  CS-CERT-SFX               PIC X.
  6839         16  CS-TRAILER-TYPE               PIC X.
  6840             88  COMM-TRLR           VALUE 'A'.
  6841             88  FUTURE-TRLR         VALUE 'B'.
  6842             88  CERT-DATA-TRLR      VALUE 'C'.
  6843
  6844     12  CS-DATA-AREA                      PIC X(516).
  6845
  6846     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  6847         16  CS-BANK-COMMISSION-AREA.
  6848             20  CS-BANK-COMMS       OCCURS 10.
  6849                 24  CS-AGT                PIC X(10).
  6850                 24  CS-COM-TYP            PIC X.
  6851                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  6852                 24  CS-RECALC-LV-INDIC    PIC X.
  6853                 24  FILLER                PIC X(10).
  6854         16  FILLER                        PIC X(256).
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 130
* EL130.cbl
  6855
  6856     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  6857         16  CS-VIN-NUMBER                 PIC X(17).
  6858         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  6859         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  6860         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  6861         16  FILLER                        PIC X(496).
  6862******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 131
* EL130.cbl
  6864
  6865 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  6866                          CONTROL-FILE CERTIFICATE-MASTER
  6867                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  6868                          BENEFICIARY-MASTER
  6869                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  6870                          LETTER-ARCHIVE REINSURANCE-RECORD
  6871                          MAILING-DATA CERTIFICATE-TRAILERS.
  6872 0000-DFHEXIT SECTION.
  6873     MOVE '9#                    $   ' TO DFHEIV0.
  6874     MOVE 'EL130' TO DFHEIV1.
  6875     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6876     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6877     MOVE '5'                    TO DC-OPTION-CODE.
  6878     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  6879     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  6880     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  6881
  6882     IF EIBCALEN = ZERO
  6883         GO TO 8800-UNAUTHORIZED-ACCESS
  6884     END-IF.
  6885
  6886     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  6887     MOVE EIBTRMID               TO QID-TERM.
  6888     MOVE +2                     TO EMI-NUMBER-OF-LINES.
  6889     MOVE '2'                    TO EMI-SWITCH2.
  6890     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  6891     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  6892
  6893
  6894
  6895* EXEC CICS HANDLE CONDITION
  6896*        QIDERR     (0100-TEST-ENTRY)
  6897*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  6898*        PGMIDERR   (9600-PGMID-ERROR)
  6899*        TERMIDERR  (8820-TERM-ERROR)
  6900*        TRANSIDERR (8830-TRAN-ERROR)
  6901*        ERROR      (9990-ABEND)
  6902*    END-EXEC.
  6903*    MOVE '"$N?L[\.              ! " #00006890' TO DFHEIV0
  6904     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  6905     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6906     MOVE X'2220233030303036383930' TO DFHEIV0(25:11)
  6907     CALL 'kxdfhei1' USING DFHEIV0
  6908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6909
  6910
  6911     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  6912        PI-CALLING-PROGRAM   = XCTL-6592
  6913         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  6914     ELSE
  6915         MOVE SPACES             TO RETURNED-FROM
  6916     END-IF.
  6917
  6918     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6919         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6920             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6921             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 132
* EL130.cbl
  6922             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6923             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6924             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6925             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6926             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6927             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  6928         ELSE
  6929             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  6930             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  6931             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  6932             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  6933             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  6934             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  6935             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  6936             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  6937         END-IF
  6938     END-IF.
  6939
  6940     IF EIBTRNID = TRANS-ID
  6941         IF EIBAID = DFHCLEAR
  6942             GO TO 9400-CLEAR
  6943         ELSE
  6944             GO TO 0200-RECEIVE
  6945         END-IF
  6946     END-IF.
  6947
  6948     IF RETURNED-FROM NOT = SPACES
  6949         GO TO 0600-RECOVER-TEMP-STORAGE
  6950     END-IF.
  6951
  6952     MOVE LOW-VALUES TO EL130AO.
  6953
  6954
  6955
  6956* EXEC CICS DELETEQ TS
  6957*         QUEUE   (QID)
  6958*    END-EXEC.
  6959*    MOVE '*&                    #   #00006943' TO DFHEIV0
  6960     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6961     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6962     MOVE X'2020233030303036393433' TO DFHEIV0(25:11)
  6963     CALL 'kxdfhei1' USING DFHEIV0,
  6964           QID,
  6965           DFHEIV99
  6966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6967
  6968
  6969 0100-TEST-ENTRY.
  6970     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  6971         GO TO 0650-FROM-EL127
  6972     ELSE
  6973         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  6974                                    PI-CERT-PROCESSED
  6975                                    PI-LETTER-ERROR-CODE
  6976     END-IF.
  6977
  6978     IF PI-RETURN-TO-PROGRAM = XCTL-132
  6979         GO TO 0640-FROM-EL132
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 133
* EL130.cbl
  6980     END-IF.
  6981
  6982     GO TO 8100-SEND-INITIAL-MAP.
  6983
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 134
* EL130.cbl
  6985 0200-RECEIVE.
  6986     MOVE LOW-VALUES             TO EL130AI.
  6987
  6988     IF PI-PROCESSOR-ID = 'LGXX'
  6989*        NEXT SENTENCE
  6990         CONTINUE
  6991     ELSE
  6992
  6993* EXEC CICS READQ TS
  6994*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6995*            INTO    (SECURITY-CONTROL)
  6996*            LENGTH  (SC-COMM-LENGTH)
  6997*            ITEM    (SC-ITEM)
  6998*        END-EXEC
  6999*    MOVE '*$II   L              ''   #00006970' TO DFHEIV0
  7000     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7001     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7002     MOVE X'2020233030303036393730' TO DFHEIV0(25:11)
  7003     CALL 'kxdfhei1' USING DFHEIV0,
  7004           PI-SECURITY-TEMP-STORE-ID,
  7005           SECURITY-CONTROL,
  7006           SC-COMM-LENGTH,
  7007           SC-ITEM,
  7008           DFHEIV99,
  7009           DFHEIV99
  7010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7011         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7012         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7013         IF NOT DISPLAY-CAP
  7014             MOVE 'READ'              TO  SM-READ
  7015             PERFORM 9995-SECURITY-VIOLATION
  7016             MOVE ER-0070             TO  EMI-ERROR
  7017             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7018             GO TO 8100-SEND-INITIAL-MAP
  7019         END-IF
  7020     END-IF.
  7021
  7022     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7023         MOVE ER-7008 TO EMI-ERROR
  7024         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7025         MOVE -1 TO MAINTL
  7026         GO TO 8200-SEND-DATAONLY
  7027     END-IF.
  7028
  7029
  7030
  7031* EXEC CICS RECEIVE
  7032*         MAP     (MAP-NAME)
  7033*         MAPSET  (MAPSET-NAME)
  7034*         INTO    (EL130AI)
  7035*    END-EXEC.
  7036     MOVE LENGTH OF
  7037      EL130AI
  7038       TO DFHEIV11
  7039*    MOVE '8"T I  L              ''   #00006995' TO DFHEIV0
  7040     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7041     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7042     MOVE X'2020233030303036393935' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 135
* EL130.cbl
  7043     CALL 'kxdfhei1' USING DFHEIV0,
  7044           MAP-NAME,
  7045           EL130AI,
  7046           DFHEIV11,
  7047           MAPSET-NAME,
  7048           DFHEIV99,
  7049           DFHEIV99
  7050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7051
  7052
  7053     IF NOT PI-NO-CARRIER-SECURITY
  7054        MOVE +1                  TO CLMCARRL
  7055        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7056     END-IF.
  7057
  7058     IF ENTERPFL = ZERO
  7059         GO TO 0300-CHECK-PFKEYS
  7060     END-IF.
  7061
  7062     IF EIBAID NOT = DFHENTER
  7063         MOVE ER-0004            TO EMI-ERROR
  7064         GO TO 0320-INPUT-ERROR
  7065     END-IF.
  7066
  7067     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7068         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7069     ELSE
  7070         MOVE ER-0029            TO EMI-ERROR
  7071         GO TO 0320-INPUT-ERROR
  7072     END-IF.
  7073
  7074 0300-CHECK-PFKEYS.
  7075     IF EIBAID = DFHPF23
  7076         GO TO 8810-PF23
  7077     END-IF.
  7078
  7079     IF EIBAID = DFHPF24
  7080         GO TO 9200-RETURN-MAIN-MENU
  7081     END-IF.
  7082
  7083     IF EIBAID = DFHPF12
  7084         GO TO 9500-PF12
  7085     END-IF.
  7086
  7087     IF EIBAID = DFHPF3
  7088         MOVE SPACES              TO MAINTI
  7089         MOVE ZEROS               TO MAINTL
  7090         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7091         MOVE XCTL-127            TO PGM-NAME
  7092         GO TO 9300-XCTL
  7093     END-IF.
  7094
  7095     IF EIBAID = DFHPF4
  7096         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7097         MOVE XCTL-132            TO PGM-NAME
  7098         GO TO 9300-XCTL
  7099     END-IF.
  7100
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 136
* EL130.cbl
  7101     IF EIBAID = DFHPF13
  7102         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7103             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7104             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7105             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7106             MOVE PI-STATE            TO  PI-CR-STATE
  7107             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7108             MOVE XCTL-650            TO  PGM-NAME
  7109             GO TO 9300-XCTL
  7110         ELSE
  7111             MOVE -1                  TO  ENTERPFL
  7112             MOVE ER-2566             TO  EMI-ERROR
  7113             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7114             GO TO 8100-SEND-INITIAL-MAP
  7115         END-IF
  7116     END-IF.
  7117
  7118     IF EIBAID = DFHPF5
  7119         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7120             ADD +1 TO PI-CERT-PROCESSED
  7121             GO TO 0650-FROM-EL127
  7122         ELSE
  7123             MOVE ER-7686         TO EMI-ERROR
  7124             GO TO 0320-INPUT-ERROR
  7125         END-IF
  7126     END-IF.
  7127
  7128     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7129         GO TO 0800-TEST-PREVIOUS-CONTROL
  7130     END-IF.
  7131
  7132     IF PI-HAS-CLAS-IC-CRDTCRD
  7133         IF EIBAID = DFHPF10
  7134             MOVE XCTL-725          TO PGM-NAME
  7135             GO TO 9300-XCTL
  7136         END-IF
  7137     END-IF.
  7138
  7139     IF EIBAID = DFHPF14
  7140         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7141         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7142         MOVE XCTL-659            TO PGM-NAME
  7143         GO TO 9300-XCTL
  7144     END-IF.
  7145
  7146     IF EIBAID = DFHPF15
  7147         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7148         MOVE XCTL-114            TO PGM-NAME
  7149         GO TO 9300-XCTL
  7150     END-IF.
  7151
  7152     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7153         GO TO 0330-EDIT-DATA
  7154     END-IF.
  7155
  7156     MOVE ER-0029                TO EMI-ERROR.
  7157
  7158 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 137
* EL130.cbl
  7159     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7160
  7161     MOVE AL-UNBON               TO ENTERPFA.
  7162
  7163     IF ENTERPFL = ZERO
  7164         MOVE -1                 TO MAINTL
  7165     ELSE
  7166         MOVE -1                 TO ENTERPFL
  7167     END-IF.
  7168
  7169     GO TO 8200-SEND-DATAONLY.
  7170
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 138
* EL130.cbl
  7172 0330-EDIT-DATA.
  7173
  7174     IF MAINTI = 'S'
  7175         IF PRTOPTL GREATER THAN 0
  7176             IF PRTOPTI NOT = 'N' AND 'L'
  7177                 MOVE AL-UABON   TO  PRTOPTA
  7178                 MOVE -1         TO  PRTOPTL
  7179                 MOVE ER-0334    TO  EMI-ERROR
  7180                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7181                 GO TO 8200-SEND-DATAONLY
  7182             ELSE
  7183                 IF PRTOPTI = 'L'
  7184                     GO TO 0400-CREATE-ELACTQ
  7185                 ELSE
  7186                     GO TO 0480-PRINT-NOW
  7187                 END-IF
  7188             END-IF
  7189         ELSE
  7190             GO TO 1000-SHOW-CLAIM
  7191         END-IF
  7192     END-IF.
  7193
  7194     IF NOT MODIFY-CAP
  7195         MOVE 'UPDATE'       TO  SM-READ
  7196         PERFORM 9995-SECURITY-VIOLATION
  7197         MOVE ER-0070        TO  EMI-ERROR
  7198         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7199         GO TO 8100-SEND-INITIAL-MAP
  7200     END-IF.
  7201
  7202     IF MAINTI = 'D'
  7203         GO TO 2000-DELETE-CLAIM
  7204     END-IF.
  7205
  7206     IF MAINTI = 'A'
  7207         GO TO 3000-ADD-CLAIM
  7208     END-IF.
  7209
  7210     IF MAINTI = 'I'
  7211         GO TO 5000-INCURRED-CHANGE
  7212     END-IF.
  7213
  7214     MOVE ER-0023                TO EMI-ERROR.
  7215     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7216     MOVE -1                     TO MAINTL.
  7217     MOVE AL-UABON               TO MAINTA.
  7218
  7219     GO TO 8200-SEND-DATAONLY.
  7220
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 139
* EL130.cbl
  7222 0400-CREATE-ELACTQ.
  7223     IF CLMNOI   = PI-LAST-CLAIM      AND
  7224        CLMCARRI = PI-LAST-CARR       AND
  7225        CERTNOI  = PI-LAST-CERT-PRIME AND
  7226        SUFXI    = PI-LAST-CERT-SUFX
  7227         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7228         MOVE PI-LAST-CARR       TO PI-CARRIER
  7229         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7230     ELSE
  7231         MOVE ER-0207            TO EMI-ERROR
  7232         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7233         MOVE -1                 TO MAINTL
  7234         GO TO 8200-SEND-DATAONLY
  7235     END-IF.
  7236
  7237     IF (NOT PI-NO-CARRIER-SECURITY OR
  7238         NOT PI-NO-ACCOUNT-SECURITY)
  7239         MOVE AL-UABON      TO  PRTOPTA
  7240         MOVE -1            TO  PRTOPTL
  7241         MOVE ER-2378       TO  EMI-ERROR
  7242         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7243         GO TO 8200-SEND-DATAONLY
  7244     END-IF.
  7245
  7246     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7247     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7248     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7249     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7250
  7251
  7252
  7253* EXEC CICS HANDLE CONDITION
  7254*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7255*    END-EXEC.
  7256*    MOVE '"$I                   ! # #00007200' TO DFHEIV0
  7257     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7258     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7259     MOVE X'2320233030303037323030' TO DFHEIV0(25:11)
  7260     CALL 'kxdfhei1' USING DFHEIV0
  7261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7262
  7263
  7264
  7265
  7266* EXEC CICS READ
  7267*         UPDATE
  7268*         DATASET    (ELACTQ-DSID)
  7269*         SET        (ADDRESS OF ACTIVITY-QUE)
  7270*         RIDFLD     (ELACTQ-KEY)
  7271*    END-EXEC.
  7272*    MOVE '&"S        EU         (   #00007205' TO DFHEIV0
  7273     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7274     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7275     MOVE X'2020233030303037323035' TO DFHEIV0(25:11)
  7276     CALL 'kxdfhei1' USING DFHEIV0,
  7277           ELACTQ-DSID,
  7278           DFHEIV20,
  7279           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 140
* EL130.cbl
  7280           ELACTQ-KEY,
  7281           DFHEIV99,
  7282           DFHEIV99,
  7283           DFHEIV99
  7284     SET ADDRESS OF ACTIVITY-QUE TO
  7285         DFHEIV20
  7286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7287
  7288
  7289     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7290     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7291
  7292
  7293
  7294* EXEC CICS REWRITE
  7295*         DATASET     (ELACTQ-DSID)
  7296*         FROM        (ACTIVITY-QUE)
  7297*    END-EXEC.
  7298     MOVE LENGTH OF
  7299      ACTIVITY-QUE
  7300       TO DFHEIV11
  7301*    MOVE '&& L                  %   #00007216' TO DFHEIV0
  7302     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7303     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7304     MOVE X'2020233030303037323136' TO DFHEIV0(25:11)
  7305     CALL 'kxdfhei1' USING DFHEIV0,
  7306           ELACTQ-DSID,
  7307           ACTIVITY-QUE,
  7308           DFHEIV11,
  7309           DFHEIV99
  7310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7311
  7312
  7313     GO TO 0470-STATUS-FINISH.
  7314
  7315 0450-ADD-ELACTQ-RECORD.
  7316
  7317
  7318* EXEC CICS GETMAIN
  7319*        SET     (ADDRESS OF ACTIVITY-QUE)
  7320*        LENGTH  (ELACTQ-LENGTH)
  7321*        INITIMG (GETMAIN-SPACE)
  7322*    END-EXEC.
  7323*    MOVE ',"IL                  $   #00007225' TO DFHEIV0
  7324     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7325     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7326     MOVE X'2020233030303037323235' TO DFHEIV0(25:11)
  7327     CALL 'kxdfhei1' USING DFHEIV0,
  7328           DFHEIV20,
  7329           ELACTQ-LENGTH,
  7330           GETMAIN-SPACE
  7331     SET ADDRESS OF ACTIVITY-QUE TO
  7332         DFHEIV20
  7333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7334
  7335
  7336     MOVE 'AQ'              TO AQ-RECORD-ID.
  7337     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 141
* EL130.cbl
  7338     MOVE +0                TO AQ-PAYMENT-COUNTER
  7339                               AQ-PMT-UNAPPROVED-COUNT.
  7340     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7341                               AQ-FOLLOWUP-DATE.
  7342     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7343     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7344
  7345
  7346
  7347* EXEC CICS WRITE
  7348*         DATASET     (ELACTQ-DSID)
  7349*         FROM        (ACTIVITY-QUE)
  7350*         RIDFLD      (ELACTQ-KEY)
  7351*    END-EXEC.
  7352     MOVE LENGTH OF
  7353      ACTIVITY-QUE
  7354       TO DFHEIV11
  7355*    MOVE '&$ L                  ''   #00007241' TO DFHEIV0
  7356     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7357     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7358     MOVE X'2020233030303037323431' TO DFHEIV0(25:11)
  7359     CALL 'kxdfhei1' USING DFHEIV0,
  7360           ELACTQ-DSID,
  7361           ACTIVITY-QUE,
  7362           DFHEIV11,
  7363           ELACTQ-KEY,
  7364           DFHEIV99,
  7365           DFHEIV99
  7366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7367
  7368
  7369 0470-STATUS-FINISH.
  7370     MOVE AL-UANOF               TO  PRTOPTA
  7371                                     ALTPRTA.
  7372
  7373     MOVE SPACES                 TO  PRTOPTO
  7374                                     ALTPRTO.
  7375
  7376     MOVE ER-0000                TO EMI-ERROR.
  7377     MOVE -1                     TO MAINTL.
  7378     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7379     GO TO 8100-SEND-INITIAL-MAP.
  7380
  7381 0480-PRINT-NOW.
  7382
  7383
  7384* EXEC CICS HANDLE CONDITION
  7385*        TERMIDERR   (8820-TERM-ERROR)
  7386*        TRANSIDERR  (8830-TRAN-ERROR)
  7387*    END-EXEC.
  7388*    MOVE '"$[\                  ! $ #00007261' TO DFHEIV0
  7389     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7391     MOVE X'2420233030303037323631' TO DFHEIV0(25:11)
  7392     CALL 'kxdfhei1' USING DFHEIV0
  7393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7394
  7395
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 142
* EL130.cbl
  7396     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7397     MOVE '1'                    TO  CNTL-REC-TYPE.
  7398     MOVE SPACES                 TO  CNTL-ACCESS.
  7399     MOVE +0                     TO  CNTL-SEQ-NO.
  7400     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7401
  7402     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7403
  7404     IF CF-FORMS-PRINTER-ID = SPACES
  7405         IF ALTPRTL NOT GREATER THAN 0
  7406             MOVE ER-0337        TO  EMI-ERROR
  7407             MOVE -1             TO  ALTPRTL
  7408             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7409             GO TO 8200-SEND-DATAONLY
  7410         END-IF
  7411     END-IF.
  7412
  7413     IF ALTPRTL GREATER THAN 0
  7414         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7415     END-IF.
  7416
  7417     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7418     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7419     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7420
  7421
  7422
  7423* EXEC CICS START
  7424*        TRANSID   (START-TRANS-ID)
  7425*        TERMID    (CF-FORMS-PRINTER-ID)
  7426*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7427*        LENGTH    (PI-COMM-LENGTH)
  7428*    END-EXEC.
  7429*    MOVE '0( LFT                1   #00007292' TO DFHEIV0
  7430     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7431     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7432     MOVE X'2020233030303037323932' TO DFHEIV0(25:11)
  7433     CALL 'kxdfhei1' USING DFHEIV0,
  7434           DFHEIV99,
  7435           START-TRANS-ID,
  7436           DFHEIV99,
  7437           PROGRAM-INTERFACE-BLOCK,
  7438           PI-COMM-LENGTH,
  7439           CF-FORMS-PRINTER-ID,
  7440           DFHEIV99,
  7441           DFHEIV99,
  7442           DFHEIV99,
  7443           DFHEIV99,
  7444           DFHEIV99,
  7445           DFHEIV99,
  7446           DFHEIV99,
  7447           DFHEIV99,
  7448           DFHEIV99,
  7449           DFHEIV99
  7450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7451
  7452
  7453     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 143
* EL130.cbl
  7454                                     ALTPRTA.
  7455
  7456     MOVE SPACES                 TO  PRTOPTO
  7457                                     ALTPRTO.
  7458
  7459     MOVE ER-0000                TO  EMI-ERROR.
  7460     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7461     MOVE -1                     TO  MAINTL.
  7462     GO TO 8100-SEND-INITIAL-MAP.
  7463
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 144
* EL130.cbl
  7465 0500-CREATE-TEMP-STORAGE.
  7466     MOVE EIBCPOSN               TO PI-CURSOR.
  7467
  7468
  7469
  7470* EXEC CICS WRITEQ TS
  7471*        QUEUE   (QID)
  7472*        FROM    (EL130AI)
  7473*        LENGTH  (QID-MAP-LENGTH)
  7474*    END-EXEC.
  7475*    MOVE '*"                    ''   #00007315' TO DFHEIV0
  7476     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7477     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7478     MOVE X'2020233030303037333135' TO DFHEIV0(25:11)
  7479     CALL 'kxdfhei1' USING DFHEIV0,
  7480           QID,
  7481           EL130AI,
  7482           QID-MAP-LENGTH,
  7483           DFHEIV99,
  7484           DFHEIV99,
  7485           DFHEIV99
  7486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7487
  7488
  7489
  7490
  7491* EXEC CICS WRITEQ TS
  7492*        QUEUE    (QID)
  7493*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7494*        LENGTH   (PI-COMM-LENGTH)
  7495*    END-EXEC.
  7496*    MOVE '*"                    ''   #00007322' TO DFHEIV0
  7497     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7498     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7499     MOVE X'2020233030303037333232' TO DFHEIV0(25:11)
  7500     CALL 'kxdfhei1' USING DFHEIV0,
  7501           QID,
  7502           PROGRAM-INTERFACE-BLOCK,
  7503           PI-COMM-LENGTH,
  7504           DFHEIV99,
  7505           DFHEIV99,
  7506           DFHEIV99
  7507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7508
  7509
  7510 0599-EXIT.
  7511      EXIT.
  7512
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 145
* EL130.cbl
  7514 0600-RECOVER-TEMP-STORAGE.
  7515     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7516     MOVE PI-EL127-TO-EL130-CNTRL
  7517                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7518     MOVE PI-EL659-TO-EL130-CNTRL
  7519                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7520     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7521     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7522     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7523     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7524     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7525     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7526     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7527     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7528     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7529     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7530     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7531     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7532     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7533     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7534     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7535     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7536                                 TO SAVE-BENEFICIARY
  7537
  7538
  7539
  7540* EXEC CICS HANDLE CONDITION
  7541*        NOTFND  (0660-NOT-FOUND)
  7542*        QIDERR  (0670-QIDERR)
  7543*    END-EXEC.
  7544*    MOVE '"$IN                  ! % #00007357' TO DFHEIV0
  7545     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7546     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7547     MOVE X'2520233030303037333537' TO DFHEIV0(25:11)
  7548     CALL 'kxdfhei1' USING DFHEIV0
  7549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7550
  7551
  7552
  7553
  7554* EXEC CICS READQ TS
  7555*        QUEUE    (QID)
  7556*        INTO     (EL130AI)
  7557*        LENGTH   (QID-MAP-LENGTH)
  7558*    END-EXEC.
  7559*    MOVE '*$I    L              ''   #00007363' TO DFHEIV0
  7560     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7561     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7562     MOVE X'2020233030303037333633' TO DFHEIV0(25:11)
  7563     CALL 'kxdfhei1' USING DFHEIV0,
  7564           QID,
  7565           EL130AI,
  7566           QID-MAP-LENGTH,
  7567           DFHEIV99,
  7568           DFHEIV99,
  7569           DFHEIV99
  7570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7571
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 146
* EL130.cbl
  7572
  7573     IF RETURNED-FROM = XCTL-131
  7574        IF CLAIM-DELETED-BY-EL131
  7575            MOVE LOW-VALUES      TO CERTNOI
  7576                                    SUFXI
  7577            MOVE ZEROS           TO CERTNOL
  7578                                    SUFXL
  7579         END-IF
  7580     END-IF.
  7581
  7582     IF RETURNED-FROM = XCTL-131
  7583         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7584         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7585                                    PI-CERT-PROCESSED
  7586     ELSE
  7587
  7588
  7589* EXEC CICS READQ TS
  7590*             QUEUE   (QID)
  7591*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7592*             LENGTH  (PI-COMM-LENGTH)
  7593*        END-EXEC
  7594*    MOVE '*$I    L              ''   #00007384' TO DFHEIV0
  7595     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7596     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7597     MOVE X'2020233030303037333834' TO DFHEIV0(25:11)
  7598     CALL 'kxdfhei1' USING DFHEIV0,
  7599           QID,
  7600           PROGRAM-INTERFACE-BLOCK,
  7601           PI-COMM-LENGTH,
  7602           DFHEIV99,
  7603           DFHEIV99,
  7604           DFHEIV99
  7605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7606     END-IF.
  7607
  7608
  7609* EXEC CICS DELETEQ TS
  7610*        QUEUE   (QID)
  7611*    END-EXEC.
  7612*    MOVE '*&                    #   #00007391' TO DFHEIV0
  7613     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7614     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7615     MOVE X'2020233030303037333931' TO DFHEIV0(25:11)
  7616     CALL 'kxdfhei1' USING DFHEIV0,
  7617           QID,
  7618           DFHEIV99
  7619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7620
  7621
  7622     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7623
  7624     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7625         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7626         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7627         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7628         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7629         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 147
* EL130.cbl
  7630         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7631         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7632         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7633         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7634         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7635         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7636         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7637         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7638         MOVE SAVE-CERT-ACCESS-CONTROL
  7639                                    TO PI-CERT-ACCESS-CONTROL
  7640         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7641                                    TO PI-CARRIER-CONTROL-LEVEL
  7642     END-IF.
  7643
  7644     IF RETURNED-FROM = XCTL-127
  7645         MOVE SAVE-EL127-TO-EL130-CNTRL
  7646                                 TO PI-EL127-TO-EL130-CNTRL
  7647     END-IF.
  7648
  7649     IF RETURNED-FROM = XCTL-6592
  7650        MOVE SAVE-EL659-TO-EL130-CNTRL
  7651                                 TO PI-EL659-TO-EL130-CNTRL
  7652     END-IF.
  7653
  7654     IF RETURNED-FROM = XCTL-114
  7655        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7656           MOVE SAVE-BENEFICIARY TO BENECDI
  7657           MOVE +10              TO BENECDL
  7658           MOVE -1               TO BIRTHDTL
  7659        END-IF
  7660     END-IF.
  7661     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7662
  7663     IF MAINTL NOT = ZERO
  7664         MOVE AL-UANON           TO MAINTA
  7665     END-IF.
  7666
  7667     IF ENTERPFL NOT = ZERO
  7668         MOVE AL-UNNON           TO ENTERPFA
  7669     END-IF.
  7670
  7671     IF RETURNED-FROM = XCTL-127
  7672         GO TO 0650-FROM-EL127
  7673     END-IF.
  7674
  7675     IF RETURNED-FROM = XCTL-132
  7676         GO TO 0640-FROM-EL132
  7677     END-IF.
  7678
  7679     IF RETURNED-FROM = XCTL-650
  7680         MOVE AL-SABON           TO PF5A
  7681         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
  7682     END-IF.
  7683
  7684     IF RETURNED-FROM = XCTL-6592
  7685         GO TO 0630-FROM-EL6592
  7686     END-IF.
  7687
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 148
* EL130.cbl
  7688     IF MAINTI = 'S' OR 'I'
  7689        GO TO 1000-SHOW-CLAIM
  7690     END-IF.
  7691
  7692     GO TO 8100-SEND-INITIAL-MAP.
  7693
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 149
* EL130.cbl
  7695 0630-FROM-EL6592.
  7696     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  7697     MOVE PI-EL659-GROUPING      TO GROUPO.
  7698     MOVE PI-EL659-STATE         TO STATEO.
  7699     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  7700
  7701     MOVE AL-UANON               TO CRTCARRA
  7702                                    GROUPA
  7703                                    STATEA
  7704                                    ACCOUNTA.
  7705     GO TO 8100-SEND-INITIAL-MAP.
  7706
  7707 0640-FROM-EL132.
  7708     IF PI-CLAIM-NO = SPACES
  7709         GO TO 0645-NO-CLAIM-SELECTED
  7710     END-IF.
  7711
  7712     MOVE LOW-VALUES             TO EL130AI.
  7713     MOVE 'MSTR'                 TO FILE-SWITCH.
  7714     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  7715     MOVE PI-CARRIER             TO MSTR-CARRIER.
  7716     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  7717                                    CLMNOO.
  7718     MOVE AL-UANON               TO CLMNOA.
  7719     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  7720
  7721
  7722
  7723* EXEC CICS HANDLE CONDITION
  7724*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  7725*    END-EXEC.
  7726*    MOVE '"$I                   ! & #00007495' TO DFHEIV0
  7727     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7728     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7729     MOVE X'2620233030303037343935' TO DFHEIV0(25:11)
  7730     CALL 'kxdfhei1' USING DFHEIV0
  7731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7732
  7733
  7734     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  7735     MOVE 'X'                    TO CLAIM-SWITCH.
  7736     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  7737     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  7738     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  7739     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7740
  7741     MOVE ER-0213                TO EMI-ERROR.
  7742     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7743     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  7744     GO TO 8100-SEND-INITIAL-MAP.
  7745
  7746 0645-NO-CLAIM-SELECTED.
  7747
  7748     IF MAINTI = 'S' OR 'I'
  7749        GO TO 1000-SHOW-CLAIM
  7750     END-IF.
  7751
  7752     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 150
* EL130.cbl
  7753
  7754 0650-FROM-EL127.
  7755
  7756     IF PI-CERT-SELECT-CNT GREATER THAN +6
  7757         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7758                                    PI-CERT-PROCESSED
  7759     END-IF.
  7760
  7761     IF PI-RETURN-TO-PROGRAM = XCTL-727
  7762         MOVE +1                 TO PI-CERT-SELECT-CNT
  7763                                    PI-CERT-PROCESSED
  7764         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  7765         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  7766         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  7767         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  7768         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  7769         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  7770     END-IF.
  7771
  7772     IF PI-CERT-SELECT-CNT = ZERO
  7773         IF CERTNOI NOT = SPACES AND LOW-VALUES
  7774             MOVE CERTNOI        TO PI-CERT-NO
  7775             MOVE SUFXI          TO PI-CERT-SFX
  7776             GO TO 3000-READ-CERT
  7777         ELSE
  7778             GO TO 8100-SEND-INITIAL-MAP
  7779         END-IF
  7780     END-IF.
  7781
  7782     MOVE AL-SABON               TO PF5A.
  7783
  7784     IF PI-CERT-PROCESSED = 1
  7785         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  7786     END-IF.
  7787
  7788     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  7789     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  7790
  7791     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  7792     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  7793                                 TO CERT-CARRIER
  7794                                    PI-CARRIER.
  7795     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  7796                                 TO CERT-GROUPING
  7797                                    PI-GROUPING.
  7798     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  7799                                 TO CERT-STATE
  7800                                    PI-STATE.
  7801     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  7802                                 TO CERT-ACCOUNT
  7803                                    PI-ACCOUNT.
  7804     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  7805                                 TO CERT-EFF-DT
  7806                                    PI-CERT-EFF-DT.
  7807     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  7808                                 TO CERT-CERT-NO
  7809                                    PI-CERT-NO.
  7810
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 151
* EL130.cbl
  7811     MOVE 'CERT'                 TO FILE-SWITCH.
  7812     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  7813
  7814     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  7815     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  7816     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  7817
  7818     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  7819         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  7820         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  7821         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  7822         IF INCURRED-DATE-MATCH
  7823             MOVE ER-7352        TO EMI-ERROR
  7824             MOVE -1             TO CERTNOL
  7825             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7826         ELSE
  7827             IF NO-CLAIMS-FOR-CERT
  7828                 MOVE ER-7353    TO EMI-ERROR
  7829                 MOVE -1         TO CERTNOL
  7830                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7831             ELSE
  7832                 MOVE ER-0558    TO EMI-ERROR
  7833                 MOVE -1         TO CERTNOL
  7834                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7835             END-IF
  7836         END-IF
  7837     END-IF.
  7838
  7839     MOVE SPACES                 TO PI-PRT-OPT
  7840                                    PI-ALT-PRT.
  7841
  7842     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7843
  7844     IF LSTNMEL NOT GREATER ZERO
  7845        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  7846         MOVE CRTLNMEI           TO  LSTNMEO
  7847         MOVE CRTFNMEI           TO  FSTNMEO
  7848         MOVE CRTINITI           TO  INITO
  7849         MOVE AL-UANON           TO  LSTNMEA
  7850                                     FSTNMEA
  7851                                     INITA
  7852     END-IF.
  7853
  7854     IF SSNL GREATER ZERO
  7855         GO TO 0655-SKIP-SOCIAL-SECURITY
  7856     END-IF.
  7857
  7858     IF CRTSSNI = SPACES OR LOW-VALUES
  7859         GO TO 0655-SKIP-SOCIAL-SECURITY
  7860     END-IF.
  7861
  7862     IF CM-SSN-STATE   = CM-STATE AND
  7863        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  7864            GO TO 0655-SKIP-SOCIAL-SECURITY
  7865     END-IF.
  7866
  7867     MOVE CRTSSNI                TO SSNO
  7868     MOVE AL-UANON               TO SSNA.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 152
* EL130.cbl
  7869
  7870 0655-SKIP-SOCIAL-SECURITY.
  7871
  7872     IF CLMCARRL NOT = ZERO  AND
  7873        CLMCARRI NOT = CRTCARRI
  7874        MOVE ER-0562             TO EMI-ERROR
  7875        MOVE AL-UABON            TO CLMCARRA
  7876        MOVE -1                  TO CLMCARRL
  7877        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7878     END-IF.
  7879
  7880     IF CLMCARRL = ZERO
  7881        MOVE AL-UANON            TO CLMCARRA
  7882        MOVE CRTCARRI            TO CLMCARRI
  7883     END-IF.
  7884
  7885     MOVE 'A'                    TO MAINTO.
  7886     MOVE AL-UANON               TO MAINTA.
  7887
  7888     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7889        GO TO 8100-SEND-INITIAL-MAP
  7890     ELSE
  7891        GO TO 8150-SEND-MAP-CURSOR
  7892     END-IF.
  7893
  7894 0660-NOT-FOUND.
  7895     MOVE ER-0214                TO EMI-ERROR.
  7896     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7897     GO TO 8100-SEND-INITIAL-MAP.
  7898
  7899 0670-QIDERR.
  7900     MOVE ER-0033                TO EMI-ERROR.
  7901     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7902     GO TO 8100-SEND-INITIAL-MAP.
  7903
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 153
* EL130.cbl
  7905 0680-PLUG-SELECTED-CERTS.
  7906
  7907     MOVE AL-SANON               TO BCERT1A
  7908                                    BSUFX1A
  7909                                    BCERT2A
  7910                                    BSUFX2A
  7911                                    BCERT3A
  7912                                    BSUFX3A
  7913                                    BCERT4A
  7914                                    BSUFX4A
  7915                                    BCERT5A
  7916                                    BSUFX5A.
  7917
  7918     IF PCERTNOO = SPACES OR LOW-VALUES
  7919         MOVE PI-EL127-CERT-PRIME (1)
  7920                                 TO PCERTNOO
  7921         MOVE PI-EL127-CERT-SUFX  (1)
  7922                                 TO PSUFXO
  7923     END-IF.
  7924
  7925     MOVE PI-EL127-CERT-PRIME (1)
  7926                                 TO BCERT1O.
  7927     MOVE PI-EL127-CERT-SUFX  (1)
  7928                                 TO BSUFX1O.
  7929
  7930     IF PI-CERT-SELECT-CNT GREATER THAN 1
  7931         MOVE PI-EL127-CERT-PRIME (2)
  7932                                 TO BCERT2O
  7933         MOVE PI-EL127-CERT-SUFX  (2)
  7934                                 TO BSUFX2O
  7935     ELSE
  7936         MOVE LOW-VALUES         TO BCERT2O
  7937                                    BSUFX2O
  7938     END-IF.
  7939
  7940     IF PI-CERT-SELECT-CNT GREATER THAN 2
  7941         MOVE PI-EL127-CERT-PRIME (3)
  7942                                 TO BCERT3O
  7943         MOVE PI-EL127-CERT-SUFX  (3)
  7944                                 TO BSUFX3O
  7945     ELSE
  7946         MOVE LOW-VALUES         TO BCERT3O
  7947                                    BSUFX3O
  7948     END-IF.
  7949
  7950     IF PI-CERT-SELECT-CNT GREATER THAN 3
  7951         MOVE PI-EL127-CERT-PRIME (4)
  7952                                 TO BCERT4O
  7953         MOVE PI-EL127-CERT-SUFX  (4)
  7954                                 TO BSUFX4O
  7955     ELSE
  7956         MOVE LOW-VALUES         TO BCERT4O
  7957                                    BSUFX4O
  7958     END-IF.
  7959
  7960     IF PI-CERT-SELECT-CNT GREATER THAN 4
  7961         MOVE PI-EL127-CERT-PRIME (5)
  7962                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 154
* EL130.cbl
  7963         MOVE PI-EL127-CERT-SUFX  (5)
  7964                                 TO BSUFX5O
  7965     ELSE
  7966         MOVE LOW-VALUES         TO BCERT5O
  7967                                    BSUFX5O
  7968     END-IF.
  7969
  7970 0680-EXIT.
  7971     EXIT.
  7972
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 155
* EL130.cbl
  7974 0690-HIGHLIGHT-CERTS.
  7975
  7976     MOVE AL-UANON               TO PCERTNOA
  7977                                    PSUFXA.
  7978
  7979     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7980        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7981            MOVE AL-SABON        TO BCERT1A
  7982                                    BSUFX1A
  7983     ELSE
  7984         MOVE AL-SANON           TO BCERT1A
  7985                                    BSUFX1A
  7986     END-IF.
  7987
  7988     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7989        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7990            MOVE AL-SABON        TO BCERT2A
  7991                                    BSUFX2A
  7992     ELSE
  7993         MOVE AL-SANON           TO BCERT2A
  7994                                    BSUFX2A
  7995     END-IF.
  7996
  7997     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7998        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7999            MOVE AL-SABON        TO BCERT3A
  8000                                    BSUFX3A
  8001     ELSE
  8002         MOVE AL-SANON           TO BCERT3A
  8003                                    BSUFX3A
  8004     END-IF.
  8005
  8006     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8007        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8008            MOVE AL-SABON        TO BCERT4A
  8009                                    BSUFX4A
  8010     ELSE
  8011         MOVE AL-SANON           TO BCERT4A
  8012                                    BSUFX4A
  8013     END-IF.
  8014
  8015     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8016        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8017            MOVE AL-SABON        TO BCERT5A
  8018                                    BSUFX5A
  8019     ELSE
  8020         MOVE AL-SANON           TO BCERT5A
  8021                                    BSUFX5A
  8022     END-IF.
  8023
  8024 0690-EXIT.
  8025     EXIT.
  8026
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 156
* EL130.cbl
  8028 0800-TEST-PREVIOUS-CONTROL.
  8029     IF CLMNOI   = PI-LAST-CLAIM       AND
  8030        CLMCARRI = PI-LAST-CARR        AND
  8031        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8032        SUFXI    = PI-LAST-CERT-SUFX
  8033*        NEXT SENTENCE
  8034         CONTINUE
  8035     ELSE
  8036         MOVE ER-0207            TO EMI-ERROR
  8037         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8038         MOVE -1                 TO MAINTL
  8039         GO TO 8200-SEND-DATAONLY
  8040     END-IF.
  8041
  8042     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8043
  8044     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8045     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8046     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8047
  8048     IF EIBAID = DFHPF7
  8049         MOVE XCTL-157           TO PGM-NAME
  8050     END-IF.
  8051
  8052     IF EIBAID = DFHPF8
  8053         MOVE XCTL-141           TO PGM-NAME
  8054     END-IF.
  8055
  8056     IF EIBAID = DFHPF9
  8057        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8058                                    PI-SAVED-PROGRAM-2
  8059                                    PI-SAVED-PROGRAM-3
  8060                                    PI-SAVED-PROGRAM-4
  8061                                    PI-SAVED-PROGRAM-5
  8062                                    PI-SAVED-PROGRAM-6
  8063        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8064        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8065        MOVE XCTL-150            TO PGM-NAME
  8066     END-IF.
  8067
  8068     GO TO 9300-XCTL.
  8069
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 157
* EL130.cbl
  8071 1000-SHOW-CLAIM.
  8072
  8073     IF CLMNOL = ZERO
  8074         MOVE -1                 TO CLMNOL
  8075         MOVE AL-UABON           TO CLMNOA
  8076         MOVE ER-0202            TO EMI-ERROR
  8077         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8078     ELSE
  8079         MOVE AL-UANON           TO CLMNOA
  8080     END-IF.
  8081
  8082     IF PI-NO-CARRIER-SECURITY
  8083        IF CLMCARRL = ZERO
  8084             MOVE -1             TO CLMCARRL
  8085             MOVE AL-UABON       TO CLMCARRA
  8086             MOVE ER-0194        TO EMI-ERROR
  8087             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8088         ELSE
  8089             MOVE AL-UANON       TO CLMCARRA
  8090         END-IF
  8091     END-IF.
  8092
  8093     IF SUFXL = ZERO
  8094         MOVE SPACES             TO SUFXI
  8095         MOVE AL-UANON           TO SUFXA
  8096     ELSE
  8097         MOVE AL-UANON           TO SUFXA
  8098     END-IF.
  8099
  8100     IF NOT EMI-NO-ERRORS
  8101         GO TO 1050-SEND-CHECK
  8102     END-IF.
  8103
  8104
  8105
  8106* EXEC CICS HANDLE CONDITION
  8107*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8108*    END-EXEC.
  8109*    MOVE '"$I                   ! '' #00007870' TO DFHEIV0
  8110     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8111     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8112     MOVE X'2720233030303037383730' TO DFHEIV0(25:11)
  8113     CALL 'kxdfhei1' USING DFHEIV0
  8114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8115
  8116
  8117     MOVE 'MSTR'                 TO FILE-SWITCH
  8118     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8119
  8120     MOVE CLMCARRI               TO MSTR-CARRIER.
  8121     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8122
  8123     IF CERTNOL = ZERO     OR
  8124        CERTNOI = SPACES   OR
  8125        CERTNOI = LOW-VALUES
  8126         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8127         MOVE AL-SANON        TO CERTNOA
  8128                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 158
* EL130.cbl
  8129     ELSE
  8130         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8131     END-IF.
  8132
  8133     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8134     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8135
  8136
  8137
  8138* EXEC CICS HANDLE CONDITION
  8139*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8140*    END-EXEC.
  8141*    MOVE '"$I                   ! ( #00007894' TO DFHEIV0
  8142     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8144     MOVE X'2820233030303037383934' TO DFHEIV0(25:11)
  8145     CALL 'kxdfhei1' USING DFHEIV0
  8146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8147
  8148
  8149     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8150
  8151     IF NOT PI-NO-ACCOUNT-SECURITY
  8152         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8153           MOVE ER-2371          TO EMI-ERROR
  8154           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8155           MOVE -1               TO MAINTL
  8156           GO TO 8200-SEND-DATAONLY
  8157         END-IF
  8158     END-IF.
  8159
  8160
  8161
  8162* EXEC CICS HANDLE CONDITION
  8163*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8164*    END-EXEC.
  8165*    MOVE '"$I                   ! ) #00007910' TO DFHEIV0
  8166     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8167     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8168     MOVE X'2920233030303037393130' TO DFHEIV0(25:11)
  8169     CALL 'kxdfhei1' USING DFHEIV0
  8170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8171
  8172
  8173     MOVE 'Y'                    TO CLAIM-SWITCH.
  8174     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8175     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8176     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8177
  8178 1000-SHOW-END-OF-PERFORM.
  8179
  8180     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8181     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8182     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8183     MOVE CL-CERT-STATE          TO CERT-STATE.
  8184     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8185     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8186     MOVE CL-CERT-NO             TO CERT-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 159
* EL130.cbl
  8187
  8188     MOVE 'CERT'                 TO FILE-SWITCH.
  8189
  8190     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8191
  8192     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8193     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8194     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8195     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8196     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8197     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8198     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8199     MOVE CLMCARRI               TO PI-LAST-CARR.
  8200
  8201     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8202
  8203     IF MAINTI = 'I'
  8204         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8205                 BIRTHDTA  LSTNMEA   RELCLMA   OCCCDA
  8206                 LOANNOA   LOANBALA  BENECDA
  8207         MOVE AL-SANON TO  SSNA
  8208         MOVE SPACES   TO  INCURI    REPORTI  ESTENDI
  8209         MOVE 'Y'      TO PI-INCURR-SW
  8210         MOVE ER-0522  TO EMI-ERROR
  8211         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8212     ELSE
  8213         MOVE ' '      TO PI-INCURR-SW
  8214     END-IF.
  8215
  8216     MOVE -1                     TO MAINTL.
  8217     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8218     MOVE CERT-GROUPING          TO PI-GROUPING.
  8219     MOVE CERT-STATE             TO PI-STATE.
  8220     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8221     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8222     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8223     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8224
  8225     IF RETURNED-FROM NOT = SPACES
  8226         GO TO 8100-SEND-INITIAL-MAP
  8227     ELSE
  8228         GO TO 8200-SEND-DATAONLY
  8229     END-IF.
  8230
  8231 1025-SHOW-RECORD-NOT-FOUND.
  8232
  8233     IF FILE-SWITCH = 'MSTR'
  8234         MOVE ER-0204            TO EMI-ERROR
  8235     ELSE
  8236         IF FILE-SWITCH = 'TRLR'
  8237             MOVE ER-0205        TO EMI-ERROR
  8238         ELSE
  8239             MOVE ER-0206        TO EMI-ERROR
  8240         END-IF
  8241     END-IF.
  8242
  8243     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8244
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 160
* EL130.cbl
  8245 1050-SEND-CHECK.
  8246
  8247     IF RETURNED-FROM NOT = SPACES
  8248         GO TO 8100-SEND-INITIAL-MAP
  8249     ELSE
  8250         MOVE -1                 TO MAINTL
  8251         GO TO 8200-SEND-DATAONLY
  8252     END-IF.
  8253
  8254 2000-DELETE-CLAIM.
  8255     IF NOT MODIFY-CAP
  8256         MOVE ER-0070            TO EMI-ERROR
  8257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8258         MOVE -1                 TO MAINTL
  8259         GO TO 8200-SEND-DATAONLY
  8260     END-IF.
  8261
  8262     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8263        CLMCARRI NOT = PI-LAST-CARR        OR
  8264        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8265        SUFXI    NOT = PI-LAST-CERT-SUFX
  8266         MOVE ER-0207            TO EMI-ERROR
  8267         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8268         MOVE -1                 TO MAINTL
  8269         GO TO 8200-SEND-DATAONLY
  8270     END-IF.
  8271
  8272
  8273
  8274* EXEC CICS HANDLE CONDITION
  8275*        NOTFND   (2050-DELETE-NOT-FOUND)
  8276*    END-EXEC.
  8277*    MOVE '"$I                   ! * #00008014' TO DFHEIV0
  8278     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8279     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8280     MOVE X'2A20233030303038303134' TO DFHEIV0(25:11)
  8281     CALL 'kxdfhei1' USING DFHEIV0
  8282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8283
  8284
  8285     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8286
  8287     MOVE CLMCARRI               TO MSTR-CARRIER.
  8288     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8289     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8290     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8291
  8292     MOVE 'MSTR'                 TO FILE-SWITCH.
  8293     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8294
  8295     MOVE 'Y'                    TO CLAIM-SWITCH.
  8296
  8297     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8298        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8299         MOVE ER-0068        TO EMI-ERROR
  8300         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8301         MOVE -1             TO MAINTL
  8302         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 161
* EL130.cbl
  8303     END-IF.
  8304
  8305     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8306         MOVE ER-0569            TO EMI-ERROR
  8307         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8308         MOVE -1                 TO MAINTL
  8309         GO TO 8200-SEND-DATAONLY
  8310     END-IF.
  8311
  8312     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8313         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8314     END-IF.
  8315
  8316     IF CL-PURGED-DT NOT = LOW-VALUES
  8317         MOVE ER-7691            TO EMI-ERROR
  8318         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8319         MOVE -1                 TO MAINTL
  8320         GO TO 8200-SEND-DATAONLY
  8321     END-IF.
  8322
  8323     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8324     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8325     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8326     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8327     MOVE +0                     TO TRLR-SEQ-NO.
  8328     MOVE '1'                    TO TRLR-TYPE.
  8329
  8330     MOVE 'TRLR'                 TO FILE-SWITCH.
  8331
  8332
  8333
  8334* EXEC CICS READ
  8335*        UPDATE
  8336*        DATASET  (ELTRLR-DSID)
  8337*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8338*        RIDFLD   (ELTRLR-KEY)
  8339*    END-EXEC.
  8340*    MOVE '&"S        EU         (   #00008066' TO DFHEIV0
  8341     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8342     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8343     MOVE X'2020233030303038303636' TO DFHEIV0(25:11)
  8344     CALL 'kxdfhei1' USING DFHEIV0,
  8345           ELTRLR-DSID,
  8346           DFHEIV20,
  8347           DFHEIV99,
  8348           ELTRLR-KEY,
  8349           DFHEIV99,
  8350           DFHEIV99,
  8351           DFHEIV99
  8352     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8353         DFHEIV20
  8354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8355
  8356
  8357     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8358        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
  8359         MOVE ER-0068        TO EMI-ERROR
  8360         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 162
* EL130.cbl
  8361         MOVE -1             TO MAINTL
  8362         GO TO 8200-SEND-DATAONLY
  8363     END-IF.
  8364
  8365
  8366
  8367* EXEC CICS DELETE
  8368*        DATASET   (ELTRLR-DSID)
  8369*    END-EXEC.
  8370*    MOVE '&(                    &   #00008082' TO DFHEIV0
  8371     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8372     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8373     MOVE X'2020233030303038303832' TO DFHEIV0(25:11)
  8374     CALL 'kxdfhei1' USING DFHEIV0,
  8375           ELTRLR-DSID,
  8376           DFHEIV99,
  8377           DFHEIV99,
  8378           DFHEIV99,
  8379           DFHEIV99
  8380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8381
  8382
  8383     MOVE +90                    TO TRLR-SEQ-NO.
  8384     MOVE '6'                    TO TRLR-TYPE.
  8385
  8386
  8387
  8388* EXEC CICS READ
  8389*        UPDATE
  8390*        DATASET  (ELTRLR-DSID)
  8391*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8392*        RIDFLD   (ELTRLR-KEY)
  8393*    END-EXEC.
  8394*    MOVE '&"S        EU         (   #00008090' TO DFHEIV0
  8395     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8396     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8397     MOVE X'2020233030303038303930' TO DFHEIV0(25:11)
  8398     CALL 'kxdfhei1' USING DFHEIV0,
  8399           ELTRLR-DSID,
  8400           DFHEIV20,
  8401           DFHEIV99,
  8402           ELTRLR-KEY,
  8403           DFHEIV99,
  8404           DFHEIV99,
  8405           DFHEIV99
  8406     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8407         DFHEIV20
  8408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8409
  8410
  8411
  8412
  8413* EXEC CICS DELETE
  8414*        DATASET   (ELTRLR-DSID)
  8415*    END-EXEC.
  8416*    MOVE '&(                    &   #00008098' TO DFHEIV0
  8417     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8418     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 163
* EL130.cbl
  8419     MOVE X'2020233030303038303938' TO DFHEIV0(25:11)
  8420     CALL 'kxdfhei1' USING DFHEIV0,
  8421           ELTRLR-DSID,
  8422           DFHEIV99,
  8423           DFHEIV99,
  8424           DFHEIV99,
  8425           DFHEIV99
  8426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8427
  8428
  8429     MOVE +91                    TO TRLR-SEQ-NO.
  8430     MOVE '6'                    TO TRLR-TYPE.
  8431
  8432
  8433
  8434* EXEC CICS READ
  8435*        UPDATE
  8436*        DATASET  (ELTRLR-DSID)
  8437*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8438*        RIDFLD   (ELTRLR-KEY)
  8439*        RESP     (WS-RESPONSE)
  8440*    END-EXEC
  8441*    MOVE '&"S        EU         (  N#00008106' TO DFHEIV0
  8442     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8443     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8444     MOVE X'204E233030303038313036' TO DFHEIV0(25:11)
  8445     CALL 'kxdfhei1' USING DFHEIV0,
  8446           ELTRLR-DSID,
  8447           DFHEIV20,
  8448           DFHEIV99,
  8449           ELTRLR-KEY,
  8450           DFHEIV99,
  8451           DFHEIV99,
  8452           DFHEIV99
  8453     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8454         DFHEIV20
  8455     MOVE EIBRESP  TO WS-RESPONSE
  8456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8457
  8458     IF WS-RESP-NORMAL
  8459
  8460* EXEC CICS DELETE
  8461*          DATASET   (ELTRLR-DSID)
  8462*       END-EXEC
  8463*    MOVE '&(                    &   #00008115' TO DFHEIV0
  8464     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8465     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8466     MOVE X'2020233030303038313135' TO DFHEIV0(25:11)
  8467     CALL 'kxdfhei1' USING DFHEIV0,
  8468           ELTRLR-DSID,
  8469           DFHEIV99,
  8470           DFHEIV99,
  8471           DFHEIV99,
  8472           DFHEIV99
  8473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8474     END-IF.
  8475
  8476     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 164
* EL130.cbl
  8477     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8478     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8479     MOVE CL-CERT-STATE          TO CERT-STATE.
  8480     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8481     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8482     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8483
  8484     MOVE 'CERT'                 TO FILE-SWITCH.
  8485
  8486     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8487
  8488     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8489
  8490     IF WS-NUM-HOLD NOT = +0
  8491         GO TO 2005-REWRITE-CERT
  8492     END-IF.
  8493
  8494     IF NOT CERT-WAS-CREATED
  8495         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8496         GO TO 2005-REWRITE-CERT
  8497     END-IF.
  8498
  8499
  8500
  8501* EXEC CICS DELETE
  8502*        DATASET   (ELCERT-DSID)
  8503*    END-EXEC.
  8504*    MOVE '&(                    &   #00008144' TO DFHEIV0
  8505     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8506     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8507     MOVE X'2020233030303038313434' TO DFHEIV0(25:11)
  8508     CALL 'kxdfhei1' USING DFHEIV0,
  8509           ELCERT-DSID,
  8510           DFHEIV99,
  8511           DFHEIV99,
  8512           DFHEIV99,
  8513           DFHEIV99
  8514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8515
  8516
  8517     GO TO 2010-DELETE-CL.
  8518
  8519 2005-REWRITE-CERT.
  8520
  8521     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8522
  8523
  8524
  8525* EXEC CICS HANDLE CONDITION
  8526*         DUPKEY   (2010-DELETE-CL)
  8527*    END-EXEC.
  8528*    MOVE '"$$                   ! + #00008155' TO DFHEIV0
  8529     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8530     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8531     MOVE X'2B20233030303038313535' TO DFHEIV0(25:11)
  8532     CALL 'kxdfhei1' USING DFHEIV0
  8533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8534
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 165
* EL130.cbl
  8535
  8536
  8537
  8538* EXEC CICS REWRITE
  8539*        DATASET  (ELCERT-DSID)
  8540*        FROM     (CERTIFICATE-MASTER)
  8541*    END-EXEC.
  8542     MOVE LENGTH OF
  8543      CERTIFICATE-MASTER
  8544       TO DFHEIV11
  8545*    MOVE '&& L                  %   #00008160' TO DFHEIV0
  8546     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8547     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8548     MOVE X'2020233030303038313630' TO DFHEIV0(25:11)
  8549     CALL 'kxdfhei1' USING DFHEIV0,
  8550           ELCERT-DSID,
  8551           CERTIFICATE-MASTER,
  8552           DFHEIV11,
  8553           DFHEIV99
  8554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8555
  8556
  8557 2010-DELETE-CL.
  8558
  8559
  8560
  8561* EXEC CICS DELETE
  8562*        DATASET  (ELMSTR-DSID)
  8563*    END-EXEC.
  8564*    MOVE '&(                    &   #00008168' TO DFHEIV0
  8565     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8566     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8567     MOVE X'2020233030303038313638' TO DFHEIV0(25:11)
  8568     CALL 'kxdfhei1' USING DFHEIV0,
  8569           ELMSTR-DSID,
  8570           DFHEIV99,
  8571           DFHEIV99,
  8572           DFHEIV99,
  8573           DFHEIV99
  8574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8575
  8576
  8577     MOVE -1                     TO ONE-OR-MIN1.
  8578     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8579
  8580     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8581         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8582                                    WS-SAVE-CLAIM-KEY
  8583         MOVE +1                 TO ONE-OR-MIN1
  8584         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8585     END-IF.
  8586
  8587     MOVE ER-0000                TO EMI-ERROR.
  8588     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8589     MOVE LOW-VALUES             TO EL130AO.
  8590     MOVE -1                     TO MAINTL.
  8591     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8592     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 166
* EL130.cbl
  8593                                    PI-CERT-PROCESSED
  8594                                    PI-LETTER-ERROR-CODE.
  8595     GO TO 8100-SEND-INITIAL-MAP.
  8596
  8597 2050-DELETE-NOT-FOUND.
  8598     IF FILE-SWITCH = 'MSTR'
  8599         MOVE -1                 TO CLMNOL
  8600         MOVE ER-0204            TO EMI-ERROR
  8601     ELSE
  8602         IF FILE-SWITCH = 'TRLR'
  8603             MOVE -1             TO MAINTL
  8604             MOVE ER-0205        TO EMI-ERROR
  8605         ELSE
  8606             MOVE -1             TO CERTNOL
  8607             MOVE ER-0206        TO EMI-ERROR
  8608         END-IF
  8609     END-IF.
  8610
  8611     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8612     GO TO 8200-SEND-DATAONLY.
  8613
  8614 3000-ADD-CLAIM.
  8615     IF NOT MODIFY-CAP
  8616         MOVE ER-0070            TO EMI-ERROR
  8617         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8618         MOVE -1                 TO MAINTL
  8619         GO TO 8200-SEND-DATAONLY
  8620     END-IF.
  8621
  8622     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8623
  8624     IF CERTMTI = 'S'
  8625         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8626            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8627            WS-EFFDT = PI-SAVE-EFFDT       AND
  8628            ACCOUNTI = PI-SAVE-ACCOUNT
  8629             IF EMI-ERROR = 0
  8630                 GO TO 3010-TEST-FOR-ERRORS
  8631             ELSE
  8632                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8633                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8634                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8635                 MOVE PI-STATE         TO  CERT-STATE
  8636                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8637                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8638                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8639
  8640
  8641* EXEC CICS HANDLE CONDITION
  8642*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8643*                END-EXEC
  8644*    MOVE '"$I                   ! , #00008235' TO DFHEIV0
  8645     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8646     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8647     MOVE X'2C20233030303038323335' TO DFHEIV0(25:11)
  8648     CALL 'kxdfhei1' USING DFHEIV0
  8649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8650                 PERFORM 7940-READ-CERT THRU 7940-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 167
* EL130.cbl
  8651                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8652                 GO TO 3010-TEST-FOR-ERRORS
  8653             END-IF
  8654         END-IF
  8655     END-IF.
  8656
  8657     IF CERTMTI = 'A'
  8658         IF NOT PI-NO-CARRIER-SECURITY OR
  8659             NOT PI-NO-ACCOUNT-SECURITY
  8660             MOVE ER-2370          TO EMI-ERROR
  8661             MOVE -1               TO MAINTL
  8662             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8663             GO TO 8200-SEND-DATAONLY
  8664         ELSE
  8665             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  8666             GO TO 3010-TEST-FOR-ERRORS
  8667         END-IF
  8668     END-IF.
  8669
  8670     IF CERTNOL = ZEROS
  8671        GO TO 3010-TEST-FOR-ERRORS
  8672     END-IF.
  8673
  8674 3000-READ-CERT.
  8675
  8676     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  8677                                    MSTR5-COMP-CD.
  8678     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  8679                                    MSTR5-CERT-NO-PRIME.
  8680     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  8681                                    MSTR5-CERT-NO-SUFX.
  8682
  8683
  8684
  8685* EXEC CICS HANDLE CONDITION
  8686*         DUPKEY   (3008-DUP-ERROR)
  8687*         NOTFND   (3009-NOT-FOUND)
  8688*    END-EXEC
  8689*    MOVE '"$$I                  ! - #00008272' TO DFHEIV0
  8690     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  8691     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8692     MOVE X'2D20233030303038323732' TO DFHEIV0(25:11)
  8693     CALL 'kxdfhei1' USING DFHEIV0
  8694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8695
  8696     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  8697
  8698     IF NOT PI-NO-ACCOUNT-SECURITY
  8699         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  8700             MOVE ER-2371          TO EMI-ERROR
  8701             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8702             MOVE -1               TO MAINTL
  8703             GO TO 8200-SEND-DATAONLY
  8704         END-IF
  8705     END-IF.
  8706
  8707     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  8708     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 168
* EL130.cbl
  8709     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  8710     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  8711     MOVE CM-CARRIER             TO PI-CARRIER.
  8712     MOVE CM-GROUPING            TO PI-GROUPING.
  8713     MOVE CM-STATE               TO PI-STATE.
  8714     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  8715     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  8716     MOVE CM-CERT-NO             TO PI-CERT-NO.
  8717     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  8718
  8719     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  8720         IF LSTNMEO = SPACES OR LOW-VALUES
  8721             MOVE CRTLNMEI       TO  LSTNMEO
  8722             MOVE AL-UANON       TO  LSTNMEA
  8723         END-IF
  8724     END-IF.
  8725
  8726     MOVE 'S'                    TO CERTMTO.
  8727*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  8728     MOVE AL-SANON               TO CERTNOA.
  8729     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  8730                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  8731     IF EMI-NO-ERRORS
  8732         MOVE -1                  TO MAINTL
  8733     END-IF.
  8734
  8735     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8736         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8737         IF INCURRED-DATE-MATCH
  8738             MOVE ER-7352         TO EMI-ERROR
  8739             MOVE -1              TO CERTNOL
  8740             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8741         ELSE
  8742             IF NO-CLAIMS-FOR-CERT
  8743                 MOVE ER-7353     TO EMI-ERROR
  8744                 MOVE -1          TO CERTNOL
  8745                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8746             ELSE
  8747                 MOVE ER-0558     TO EMI-ERROR
  8748                 MOVE -1          TO CERTNOL
  8749                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8750                 GO TO 3010-TEST-FOR-ERRORS
  8751             END-IF
  8752         END-IF
  8753     END-IF.
  8754
  8755 3007-SEND-SCREEN.
  8756     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8757         GO TO 8150-SEND-MAP-CURSOR
  8758     ELSE
  8759         GO TO 8200-SEND-DATAONLY
  8760     END-IF.
  8761
  8762 3008-DUP-ERROR.
  8763     MOVE ER-0560                TO EMI-ERROR.
  8764     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8765     MOVE -1                     TO CERTNOL.
  8766     GO TO 3007-SEND-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 169
* EL130.cbl
  8767
  8768 3009-NOT-FOUND.
  8769     MOVE ER-0214                TO EMI-ERROR.
  8770     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8771     MOVE -1                     TO CERTNOL.
  8772     GO TO 3007-SEND-SCREEN.
  8773
  8774 3010-TEST-FOR-ERRORS.
  8775
  8776     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  8777     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  8778
  8779     IF CERTMTI NOT = 'A'
  8780         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8781             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  8782             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  8783             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  8784             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8785             IF INCURRED-DATE-MATCH
  8786                 MOVE ER-7352         TO EMI-ERROR
  8787                 MOVE -1              TO CERTNOL
  8788                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8789             ELSE
  8790                 IF NO-CLAIMS-FOR-CERT
  8791                     MOVE ER-7353     TO EMI-ERROR
  8792                     MOVE -1          TO CERTNOL
  8793                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8794                 ELSE
  8795                     MOVE ER-0558     TO EMI-ERROR
  8796                     MOVE -1          TO CERTNOL
  8797                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8798                 END-IF
  8799             END-IF
  8800         END-IF
  8801     END-IF.
  8802
  8803     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  8804         MOVE ER-0433             TO EMI-ERROR
  8805         MOVE -1                  TO MAINTL
  8806         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8807         GO TO 8200-SEND-DATAONLY
  8808     END-IF.
  8809
  8810     IF EMI-NO-ERRORS
  8811         GO TO 3015-TRY-TO-BUILD
  8812     END-IF.
  8813
  8814     IF EIBAID = DFHPF6
  8815         IF EMI-FATAL-CTR NOT EQUAL ZERO
  8816             MOVE ER-0434         TO EMI-ERROR
  8817             MOVE -1              TO MAINTL
  8818             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8819             GO TO 8200-SEND-DATAONLY
  8820         ELSE
  8821             MOVE +1              TO INCURL
  8822             GO TO 3015-TRY-TO-BUILD
  8823         END-IF
  8824     END-IF.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 170
* EL130.cbl
  8825
  8826     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8827         GO TO 8150-SEND-MAP-CURSOR
  8828     ELSE
  8829         GO TO 8200-SEND-DATAONLY
  8830     END-IF.
  8831
  8832 3015-TRY-TO-BUILD.
  8833     IF CLMNOL EQUAL ZERO
  8834         GO TO 3030-BUILD-CONT
  8835     END-IF.
  8836
  8837
  8838
  8839* EXEC CICS HANDLE CONDITION
  8840*        NOTFND   (3030-BUILD-CONT)
  8841*    END-EXEC.
  8842*    MOVE '"$I                   ! . #00008419' TO DFHEIV0
  8843     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8844     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8845     MOVE X'2E20233030303038343139' TO DFHEIV0(25:11)
  8846     CALL 'kxdfhei1' USING DFHEIV0
  8847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8848
  8849
  8850     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8851
  8852     MOVE CLMCARRI               TO MSTR-CARRIER.
  8853     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8854     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8855     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8856
  8857     MOVE 'MSTR'                 TO FILE-SWITCH.
  8858
  8859     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8860
  8861     MOVE ER-0221                TO EMI-ERROR.
  8862
  8863     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8864     MOVE -1                     TO MAINTL.
  8865     GO TO 8200-SEND-DATAONLY.
  8866
  8867 3030-BUILD-CONT.
  8868     IF CERTMTI NOT = 'A'
  8869         GO TO 3060-BUILD-CONT
  8870     END-IF.
  8871
  8872
  8873
  8874* EXEC CICS HANDLE CONDITION
  8875*        NOTFND   (3033-ACCT-NOT-FOUND)
  8876*        ENDFILE  (3033-ACCT-NOT-FOUND)
  8877*    END-EXEC.
  8878*    MOVE '"$I''                  ! / #00008446' TO DFHEIV0
  8879     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8881     MOVE X'2F20233030303038343436' TO DFHEIV0(25:11)
  8882     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 171
* EL130.cbl
  8883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8884
  8885
  8886     MOVE SPACES                 TO ERACCT-KEY.
  8887
  8888     IF CARR-GROUP-ST-ACCNT-CNTL
  8889         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  8890         MOVE CRTCARRI           TO ACCT-CARRIER
  8891         MOVE GROUPI             TO ACCT-GROUPING
  8892         MOVE STATEI             TO ACCT-STATE
  8893         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  8894         GO TO 3031-MOVE-ACCT-KEY
  8895     END-IF.
  8896
  8897     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  8898     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  8899
  8900     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  8901         MOVE STATEI             TO ACCT-STATE
  8902     END-IF.
  8903
  8904     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  8905         MOVE CRTCARRI           TO ACCT-CARRIER
  8906     END-IF.
  8907
  8908 3031-MOVE-ACCT-KEY.
  8909     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  8910
  8911
  8912
  8913* EXEC CICS STARTBR
  8914*        DATASET     (ERACCT2-DSID)
  8915*        RIDFLD      (SAVE-ERACCT-KEY)
  8916*        GENERIC
  8917*        KEYLENGTH   (20)
  8918*    END-EXEC.
  8919     MOVE 20
  8920       TO DFHEIV11
  8921     MOVE 0
  8922       TO DFHEIV12
  8923*    MOVE '&,   KG    G          &   #00008477' TO DFHEIV0
  8924     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  8925     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8926     MOVE X'2020233030303038343737' TO DFHEIV0(25:11)
  8927     CALL 'kxdfhei1' USING DFHEIV0,
  8928           ERACCT2-DSID,
  8929           SAVE-ERACCT-KEY,
  8930           DFHEIV11,
  8931           DFHEIV12,
  8932           DFHEIV99
  8933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8934
  8935
  8936
  8937
  8938* EXEC CICS HANDLE CONDITION
  8939*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  8940*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 172
* EL130.cbl
  8941*    MOVE '"$''                   ! 0 #00008485' TO DFHEIV0
  8942     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8944     MOVE X'3020233030303038343835' TO DFHEIV0(25:11)
  8945     CALL 'kxdfhei1' USING DFHEIV0
  8946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8947
  8948
  8949 3031-READ-ACCT-LOOP.
  8950
  8951
  8952* EXEC CICS READNEXT
  8953*        DATASET   (ERACCT2-DSID)
  8954*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8955*        RIDFLD    (SAVE-ERACCT-KEY)
  8956*    END-EXEC.
  8957     MOVE 0
  8958       TO DFHEIV11
  8959*    MOVE '&.S                   )   #00008491' TO DFHEIV0
  8960     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8961     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8962     MOVE X'2020233030303038343931' TO DFHEIV0(25:11)
  8963     CALL 'kxdfhei1' USING DFHEIV0,
  8964           ERACCT2-DSID,
  8965           DFHEIV20,
  8966           DFHEIV99,
  8967           SAVE-ERACCT-KEY,
  8968           DFHEIV99,
  8969           DFHEIV11,
  8970           DFHEIV99,
  8971           DFHEIV99
  8972     SET ADDRESS OF ACCOUNT-MASTER TO
  8973         DFHEIV20
  8974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8975
  8976
  8977     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  8978        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  8979        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  8980        ACCT-STATE    NOT = AM-VG-STATE       OR
  8981        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  8982         GO TO 3033-ACCT-NOT-FOUND
  8983     END-IF.
  8984
  8985     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  8986        WS-EFFDT LESS AM-EXPIRATION-DT
  8987         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  8988         MOVE AM-CARRIER       TO CERT-CARRIER
  8989         MOVE AM-GROUPING      TO CERT-GROUPING
  8990         MOVE AM-STATE         TO CERT-STATE
  8991         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  8992         MOVE WS-EFFDT         TO CERT-EFF-DT
  8993         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  8994         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  8995         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  8996         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  8997     END-IF.
  8998
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 173
* EL130.cbl
  8999     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9000         GO TO 3031-READ-ACCT-LOOP
  9001     END-IF.
  9002
  9003 3032-NOT-IN-DT-RANGE.
  9004     MOVE ER-0226                TO EMI-ERROR.
  9005     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9006     MOVE -1                     TO EFFDTL.
  9007     GO TO 8200-SEND-DATAONLY.
  9008
  9009 3033-ACCT-NOT-FOUND.
  9010     MOVE ER-0226 TO EMI-ERROR.
  9011     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9012     MOVE -1                     TO ACCOUNTL.
  9013     GO TO 8200-SEND-DATAONLY.
  9014
  9015 3034-CHECK-EMPLOYER-STATEMENT.
  9016
  9017     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9018*        NEXT SENTENCE
  9019         CONTINUE
  9020     ELSE
  9021         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9022     END-IF.
  9023
  9024     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9025     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9026     MOVE '1'                    TO  DC-OPTION-CODE.
  9027     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9028                                     DC-ELAPSED-DAYS.
  9029     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9030
  9031     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9032         DC-ELAPSED-DAYS LESS THAN +31)
  9033                      OR
  9034        (AM-EMPLOYER-STMT-USED = '2' AND
  9035         DC-ELAPSED-DAYS LESS THAN +61)
  9036                      OR
  9037        (AM-EMPLOYER-STMT-USED = '3' AND
  9038         DC-ELAPSED-DAYS LESS THAN +91)
  9039            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9040     END-IF.
  9041
  9042 3034-CHECK-ACCOUNT-LIMITS.
  9043
  9044     IF CERTMTI NOT = 'A'
  9045         GO TO 3060-BUILD-CONT
  9046     END-IF.
  9047
  9048     IF AM-STATUS NOT = '0'
  9049         MOVE ER-0225                TO EMI-ERROR
  9050         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9051         MOVE -1                     TO ACCOUNTL
  9052     END-IF.
  9053
  9054     IF EIBAID = DFHPF6
  9055         IF EMI-FATAL-CTR NOT = ZERO
  9056             MOVE ER-0434         TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 174
* EL130.cbl
  9057             MOVE -1              TO MAINTL
  9058             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9059             GO TO 8200-SEND-DATAONLY
  9060         END-IF
  9061     END-IF.
  9062
  9063*    IF PI-COMPANY-ID NOT = 'CRI'
  9064*        GO TO 3035-END-BROWSE
  9065*    END-IF.
  9066
  9067 3035-END-BROWSE.
  9068
  9069
  9070* EXEC CICS ENDBR
  9071*        DATASET    (ERACCT2-DSID)
  9072*    END-EXEC.
  9073     MOVE 0
  9074       TO DFHEIV11
  9075*    MOVE '&2                    $   #00008589' TO DFHEIV0
  9076     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9077     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9078     MOVE X'2020233030303038353839' TO DFHEIV0(25:11)
  9079     CALL 'kxdfhei1' USING DFHEIV0,
  9080           ERACCT2-DSID,
  9081           DFHEIV11,
  9082           DFHEIV99
  9083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9084
  9085
  9086 3040-CHECK-CERT-ALREADY-ON.
  9087
  9088
  9089* EXEC CICS HANDLE CONDITION
  9090*        NOTFND   (3070-BUILD-CONT)
  9091*    END-EXEC.
  9092*    MOVE '"$I                   ! 1 #00008595' TO DFHEIV0
  9093     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9094     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9095     MOVE X'3120233030303038353935' TO DFHEIV0(25:11)
  9096     CALL 'kxdfhei1' USING DFHEIV0
  9097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9098
  9099
  9100     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9101
  9102     MOVE ER-0229                TO EMI-ERROR.
  9103     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9104     MOVE -1                     TO MAINTL.
  9105     GO TO 8200-SEND-DATAONLY.
  9106
  9107 3060-BUILD-CONT.
  9108     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9109     MOVE CRTCARRI               TO CERT-CARRIER.
  9110     MOVE GROUPI                 TO CERT-GROUPING.
  9111     MOVE STATEI                 TO CERT-STATE.
  9112     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9113     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9114     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 175
* EL130.cbl
  9115     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9116
  9117
  9118
  9119* EXEC CICS HANDLE CONDITION
  9120*        NOTFND  (3065-CERT-NOT-FOUND)
  9121*    END-EXEC.
  9122*    MOVE '"$I                   ! 2 #00008617' TO DFHEIV0
  9123     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9124     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9125     MOVE X'3220233030303038363137' TO DFHEIV0(25:11)
  9126     CALL 'kxdfhei1' USING DFHEIV0
  9127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9128
  9129
  9130     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9131
  9132     GO TO 3070-BUILD-CONT.
  9133
  9134 3065-CERT-NOT-FOUND.
  9135     MOVE ER-0244                TO EMI-ERROR.
  9136     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9137     MOVE -1                     TO CERTNOL.
  9138     GO TO 8200-SEND-DATAONLY.
  9139
  9140 3070-BUILD-CONT.
  9141     IF CLMNOL NOT = ZERO
  9142         GO TO 3200-BUILD-ZERO-TRAILER
  9143     END-IF.
  9144
  9145     MOVE SPACES                 TO ELCNTL-KEY.
  9146
  9147     IF CONTROL-IS-ACTUAL-CARRIER
  9148         MOVE PI-CARRIER         TO CNTL-CARRIER
  9149     ELSE
  9150         MOVE PI-CARRIER-CONTROL-LEVEL
  9151                                 TO CNTL-CARRIER
  9152     END-IF.
  9153
  9154     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9155     MOVE '6'                    TO CNTL-REC-TYPE.
  9156     MOVE +0                     TO CNTL-SEQ-NO.
  9157
  9158
  9159
  9160* EXEC CICS HANDLE CONDITION
  9161*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9162*    END-EXEC.
  9163*    MOVE '"$I                   ! 3 #00008650' TO DFHEIV0
  9164     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9165     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9166     MOVE X'3320233030303038363530' TO DFHEIV0(25:11)
  9167     CALL 'kxdfhei1' USING DFHEIV0
  9168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9169
  9170
  9171
  9172
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 176
* EL130.cbl
  9173* EXEC CICS READ
  9174*        UPDATE
  9175*        DATASET   (ELCNTL-DSID)
  9176*        SET       (ADDRESS OF CONTROL-FILE)
  9177*        RIDFLD    (ELCNTL-KEY)
  9178*    END-EXEC.
  9179*    MOVE '&"S        EU         (   #00008655' TO DFHEIV0
  9180     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9181     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9182     MOVE X'2020233030303038363535' TO DFHEIV0(25:11)
  9183     CALL 'kxdfhei1' USING DFHEIV0,
  9184           ELCNTL-DSID,
  9185           DFHEIV20,
  9186           DFHEIV99,
  9187           ELCNTL-KEY,
  9188           DFHEIV99,
  9189           DFHEIV99,
  9190           DFHEIV99
  9191     SET ADDRESS OF CONTROL-FILE TO
  9192         DFHEIV20
  9193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9194
  9195
  9196     IF CLAIM-NO-MANUAL
  9197         GO TO 3120-CLAIM-MUST-BE-INPUT
  9198     END-IF.
  9199
  9200     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9201     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9202
  9203     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9204         CONTINUE
  9205     ELSE
  9206         GO TO 3080-ASSIGN-LOOP
  9207     END-IF.
  9208
  9209
  9210
  9211* EXEC CICS UNLOCK
  9212*        DATASET   (ELCNTL-DSID)
  9213*    END-EXEC.
  9214*    MOVE '&*                    #   #00008676' TO DFHEIV0
  9215     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9216     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9217     MOVE X'2020233030303038363736' TO DFHEIV0(25:11)
  9218     CALL 'kxdfhei1' USING DFHEIV0,
  9219           ELCNTL-DSID,
  9220           DFHEIV99
  9221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9222
  9223
  9224     MOVE '1'                    TO CNTL-REC-TYPE.
  9225     MOVE SPACES                 TO CNTL-ACCESS.
  9226
  9227     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9228
  9229
  9230
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 177
* EL130.cbl
  9231* EXEC CICS HANDLE CONDITION
  9232*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9233*    END-EXEC.
  9234*    MOVE '"$I                   ! 4 #00008686' TO DFHEIV0
  9235     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9236     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9237     MOVE X'3420233030303038363836' TO DFHEIV0(25:11)
  9238     CALL 'kxdfhei1' USING DFHEIV0
  9239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9240
  9241
  9242     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9243
  9244     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9245
  9246 3080-ASSIGN-LOOP.
  9247     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9248        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9249         MOVE +0                 TO SAVE-COUNTER
  9250     END-IF.
  9251
  9252     ADD +1 TO SAVE-COUNTER.
  9253
  9254     IF SAVE-METHOD  = '3'
  9255         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9256         GO TO 3090-SET-COMP
  9257     END-IF.
  9258
  9259     IF SAVE-METHOD  = '4'
  9260         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9261         MOVE CLMCARRI           TO WS-CN-PRF-A
  9262         GO TO 3090-SET-COMP
  9263     END-IF.
  9264
  9265     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9266     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9267     MOVE SAVE-DATE              TO CURR-DATE.
  9268
  9269     IF CURR-MM LESS '10'
  9270         MOVE CURR-M2             TO WS-CN-PRF-B
  9271     END-IF.
  9272
  9273     IF CURR-MM = '10'
  9274        MOVE 'A'                 TO WS-CN-PRF-B
  9275     END-IF.
  9276     IF CURR-MM = '11'
  9277        MOVE 'B'                 TO WS-CN-PRF-B
  9278     END-IF.
  9279     IF CURR-MM = '12'
  9280        MOVE 'C'                 TO WS-CN-PRF-B
  9281     END-IF.
  9282
  9283     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9284
  9285 3090-SET-COMP.
  9286
  9287     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9288     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 178
* EL130.cbl
  9289                                    CLMNOO.
  9290     MOVE AL-UANON               TO CLMNOA.
  9291     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9292     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9293     MOVE CLMCARRI               TO MSTR-CARRIER.
  9294
  9295
  9296
  9297* EXEC CICS HANDLE CONDITION
  9298*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9299*    END-EXEC.
  9300*    MOVE '"$I                   ! 5 #00008744' TO DFHEIV0
  9301     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9302     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9303     MOVE X'3520233030303038373434' TO DFHEIV0(25:11)
  9304     CALL 'kxdfhei1' USING DFHEIV0
  9305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9306
  9307
  9308     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9309
  9310     GO TO 3080-ASSIGN-LOOP.
  9311
  9312 3100-CARRIER-NOT-FOUND.
  9313     MOVE ER-0252                TO EMI-ERROR.
  9314     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9315     MOVE -1                     TO CLMCARRL.
  9316     GO TO 8200-SEND-DATAONLY.
  9317
  9318 3110-COMPANY-NOT-FOUND.
  9319     MOVE ER-0254                TO EMI-ERROR.
  9320     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9321     MOVE -1                     TO MAINTL.
  9322     GO TO 8200-SEND-DATAONLY.
  9323
  9324 3120-CLAIM-MUST-BE-INPUT.
  9325     MOVE ER-0264                TO EMI-ERROR.
  9326     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9327     MOVE -1                     TO CLMNOL.
  9328     GO TO 8200-SEND-DATAONLY.
  9329
  9330 3200-BUILD-ZERO-TRAILER.
  9331
  9332
  9333* EXEC CICS HANDLE CONDITION
  9334*        NOTFND
  9335*    END-EXEC.
  9336*    MOVE '"$                   ! 6 #00008772' TO DFHEIV0
  9337     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9338     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9339     MOVE X'3620233030303038373732' TO DFHEIV0(25:11)
  9340     CALL 'kxdfhei1' USING DFHEIV0
  9341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9342
  9343
  9344
  9345
  9346* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 179
* EL130.cbl
  9347*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9348*        LENGTH  (ELTRLR-LENGTH)
  9349*    END-EXEC.
  9350*    MOVE '," L                  $   #00008777' TO DFHEIV0
  9351     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9352     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9353     MOVE X'2020233030303038373737' TO DFHEIV0(25:11)
  9354     CALL 'kxdfhei1' USING DFHEIV0,
  9355           DFHEIV20,
  9356           ELTRLR-LENGTH,
  9357           DFHEIV99
  9358     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9359         DFHEIV20
  9360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9361
  9362
  9363     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9364     MOVE 'AT'                   TO AT-RECORD-ID.
  9365
  9366     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9367     MOVE CLMCARRI               TO AT-CARRIER.
  9368     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9369     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9370     MOVE +0                     TO AT-SEQUENCE-NO.
  9371     MOVE '1'                    TO AT-TRAILER-TYPE.
  9372
  9373     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9374     MOVE '5'                    TO DC-OPTION-CODE.
  9375     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9376     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9377                                    AT-RESERVES-LAST-MAINT-DT.
  9378
  9379     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9380                                    AT-RESERVES-LAST-UPDATED-BY.
  9381
  9382     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9383
  9384     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9385
  9386     MOVE +0                     TO AT-FUTURE-RESERVE
  9387                                    AT-IBNR-RESERVE
  9388                                    AT-PAY-CURRENT-RESERVE
  9389                                    AT-INITIAL-MANUAL-RESERVE
  9390                                    AT-CURRENT-MANUAL-RESERVE
  9391                                    AT-ITD-LIFE-REFUNDS
  9392                                    AT-ITD-AH-REFUNDS
  9393                                    AT-ITD-ADDITIONAL-RESERVE.
  9394
  9395     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9396
  9397     IF MANRSVL NOT = ZERO
  9398         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9399                                    AT-CURRENT-MANUAL-RESERVE
  9400     END-IF.
  9401
  9402     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9403
  9404     MOVE +0                     TO AT-ITD-PAID-EXPENSES
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 180
* EL130.cbl
  9405                                    AT-ITD-CHARGEABLE-EXPENSE.
  9406
  9407     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9408     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9409     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9410
  9411
  9412
  9413* EXEC CICS WRITE
  9414*        DATASET   (ELTRLR-DSID)
  9415*        FROM      (ACTIVITY-TRAILERS)
  9416*        RIDFLD    (AT-CONTROL-PRIMARY)
  9417*    END-EXEC.
  9418     MOVE LENGTH OF
  9419      ACTIVITY-TRAILERS
  9420       TO DFHEIV11
  9421*    MOVE '&$ L                  ''   #00008831' TO DFHEIV0
  9422     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9423     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9424     MOVE X'2020233030303038383331' TO DFHEIV0(25:11)
  9425     CALL 'kxdfhei1' USING DFHEIV0,
  9426           ELTRLR-DSID,
  9427           ACTIVITY-TRAILERS,
  9428           DFHEIV11,
  9429           AT-CONTROL-PRIMARY,
  9430           DFHEIV99,
  9431           DFHEIV99
  9432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9433
  9434
  9435     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9436
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 181
* EL130.cbl
  9438
  9439 3250-BUILD-I1-ADDRESS-TRAILER.
  9440
  9441     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9442     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9443     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9444     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9445     MOVE GROUPI                 TO WS-MA-GROUPING.
  9446     MOVE STATEI                 TO WS-MA-STATE.
  9447     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9448     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9449     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9450     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9451
  9452
  9453* EXEC CICS HANDLE CONDITION
  9454*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9455*    END-EXEC.
  9456*    MOVE '"$I                   ! 7 #00008854' TO DFHEIV0
  9457     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9458     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9459     MOVE X'3720233030303038383534' TO DFHEIV0(25:11)
  9460     CALL 'kxdfhei1' USING DFHEIV0
  9461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9462
  9463
  9464
  9465* EXEC CICS READ
  9466*        EQUAL
  9467*        DATASET   (ERMAIL-DSID)
  9468*        SET       (ADDRESS OF MAILING-DATA)
  9469*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9470*    END-EXEC.
  9471*    MOVE '&"S        E          (   #00008858' TO DFHEIV0
  9472     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9473     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9474     MOVE X'2020233030303038383538' TO DFHEIV0(25:11)
  9475     CALL 'kxdfhei1' USING DFHEIV0,
  9476           ERMAIL-DSID,
  9477           DFHEIV20,
  9478           DFHEIV99,
  9479           WS-MA-CONTROL-PRIMARY,
  9480           DFHEIV99,
  9481           DFHEIV99,
  9482           DFHEIV99
  9483     SET ADDRESS OF MAILING-DATA TO
  9484         DFHEIV20
  9485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9486
  9487
  9488     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9489         GO TO 3290-NO-INSURED-ADDRESS
  9490     END-IF.
  9491
  9492     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9493     MOVE 'AT'                   TO AT-RECORD-ID.
  9494
  9495     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 182
* EL130.cbl
  9496     MOVE CLMCARRI               TO AT-CARRIER.
  9497     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9498     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9499     MOVE +1                     TO AT-SEQUENCE-NO.
  9500     MOVE '5'                    TO AT-TRAILER-TYPE.
  9501
  9502     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9503     IF MA-INSURED-MIDDLE-INIT > SPACES
  9504        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9505               ' ' DELIMITED BY SIZE
  9506               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9507               ' ' DELIMITED BY SIZE
  9508               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9509        INTO AT-MAIL-TO-NAME
  9510     ELSE
  9511        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9512               ' ' DELIMITED BY SIZE
  9513               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9514        INTO AT-MAIL-TO-NAME
  9515     END-IF.
  9516     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9517     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9518*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9519     MOVE MA-CITY                TO AT-CITY
  9520     MOVE MA-ADDR-STATE          TO AT-STATE
  9521     MOVE MA-ZIP                 TO AT-ZIP
  9522     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9523
  9524     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9525                                    AT-ADDRESS-LAST-MAINT-DT.
  9526
  9527     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9528                                    AT-ADDRESS-LAST-UPDATED-BY.
  9529
  9530     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9531
  9532
  9533* EXEC CICS WRITE
  9534*        DATASET   (ELTRLR-DSID)
  9535*        FROM      (ACTIVITY-TRAILERS)
  9536*        RIDFLD    (AT-CONTROL-PRIMARY)
  9537*    END-EXEC.
  9538     MOVE LENGTH OF
  9539      ACTIVITY-TRAILERS
  9540       TO DFHEIV11
  9541*    MOVE '&$ L                  ''   #00008909' TO DFHEIV0
  9542     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9543     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9544     MOVE X'2020233030303038393039' TO DFHEIV0(25:11)
  9545     CALL 'kxdfhei1' USING DFHEIV0,
  9546           ELTRLR-DSID,
  9547           ACTIVITY-TRAILERS,
  9548           DFHEIV11,
  9549           AT-CONTROL-PRIMARY,
  9550           DFHEIV99,
  9551           DFHEIV99
  9552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9553
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 183
* EL130.cbl
  9554
  9555     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9556     GO TO 3300-BUILD-NINETY-TRAILER.
  9557
  9558 3290-NO-INSURED-ADDRESS.
  9559      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9560
  9561 3300-BUILD-NINETY-TRAILER.
  9562
  9563     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9564     MOVE 'AT'                   TO AT-RECORD-ID.
  9565
  9566     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9567     MOVE CLMCARRI               TO AT-CARRIER.
  9568
  9569     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9570     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9571     MOVE +90                    TO AT-SEQUENCE-NO.
  9572     MOVE '6'                    TO AT-TRAILER-TYPE.
  9573
  9574     IF DIAGL NOT = ZERO
  9575         MOVE DIAGI              TO AT-INFO-LINE-1
  9576     END-IF.
  9577
  9578     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9579                                    AT-GEN-INFO-LAST-MAINT-DT.
  9580
  9581     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9582                                    AT-GEN-INFO-LAST-UPDATED-BY.
  9583     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9584
  9585
  9586
  9587* EXEC CICS WRITE
  9588*        DATASET   (ELTRLR-DSID)
  9589*        FROM      (ACTIVITY-TRAILERS)
  9590*        RIDFLD    (AT-CONTROL-PRIMARY)
  9591*    END-EXEC.
  9592     MOVE LENGTH OF
  9593      ACTIVITY-TRAILERS
  9594       TO DFHEIV11
  9595*    MOVE '&$ L                  ''   #00008946' TO DFHEIV0
  9596     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9597     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9598     MOVE X'2020233030303038393436' TO DFHEIV0(25:11)
  9599     CALL 'kxdfhei1' USING DFHEIV0,
  9600           ELTRLR-DSID,
  9601           ACTIVITY-TRAILERS,
  9602           DFHEIV11,
  9603           AT-CONTROL-PRIMARY,
  9604           DFHEIV99,
  9605           DFHEIV99
  9606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9607
  9608
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 184
* EL130.cbl
  9610 3400-CHECK-CERT-MAINT.
  9611
  9612     IF CERTMTI = 'A'
  9613         GO TO 3600-BUILD-NEW-CERT
  9614     END-IF.
  9615
  9616     IF NO-CLAIM-ATTACHED
  9617         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
  9618     END-IF.
  9619
  9620     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
  9621
  9622     IF CM-LF-CURRENT-STATUS = '2' OR
  9623        CM-AH-CURRENT-STATUS = '2'
  9624         GO TO 3400-REWRITE-CERT
  9625     END-IF.
  9626
  9627     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9628
  9629 3400-REWRITE-CERT.
  9630
  9631
  9632
  9633* EXEC CICS HANDLE CONDITION
  9634*        DUPKEY (3410-DUP-KEY)
  9635*    END-EXEC.
  9636*    MOVE '"$$                   ! 8 #00008975' TO DFHEIV0
  9637     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9638     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9639     MOVE X'3820233030303038393735' TO DFHEIV0(25:11)
  9640     CALL 'kxdfhei1' USING DFHEIV0
  9641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9642
  9643
  9644
  9645
  9646* EXEC CICS REWRITE
  9647*        DATASET   (ELCERT-DSID)
  9648*        FROM      (CERTIFICATE-MASTER)
  9649*    END-EXEC.
  9650     MOVE LENGTH OF
  9651      CERTIFICATE-MASTER
  9652       TO DFHEIV11
  9653*    MOVE '&& L                  %   #00008980' TO DFHEIV0
  9654     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9655     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9656     MOVE X'2020233030303038393830' TO DFHEIV0(25:11)
  9657     CALL 'kxdfhei1' USING DFHEIV0,
  9658           ELCERT-DSID,
  9659           CERTIFICATE-MASTER,
  9660           DFHEIV11,
  9661           DFHEIV99
  9662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9663
  9664
  9665 3410-DUP-KEY.
  9666     GO TO 3800-BUILD-NEW-CLAIM.
  9667
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 185
* EL130.cbl
  9668 3600-BUILD-NEW-CERT.
  9669
  9670
  9671* EXEC CICS GETMAIN
  9672*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  9673*        LENGTH   (ELCERT-LENGTH)
  9674*    END-EXEC.
  9675*    MOVE '," L                  $   #00008990' TO DFHEIV0
  9676     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9677     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9678     MOVE X'2020233030303038393930' TO DFHEIV0(25:11)
  9679     CALL 'kxdfhei1' USING DFHEIV0,
  9680           DFHEIV20,
  9681           ELCERT-LENGTH,
  9682           DFHEIV99
  9683     SET ADDRESS OF CERTIFICATE-MASTER TO
  9684         DFHEIV20
  9685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9686
  9687
  9688     MOVE SPACES                 TO CERTIFICATE-MASTER.
  9689
  9690     MOVE 'CM'                   TO CM-RECORD-ID.
  9691
  9692     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
  9693                                    CM-COMPANY-CD-A1
  9694                                    CM-COMPANY-CD-A2
  9695                                    CM-COMPANY-CD-A4
  9696                                    CM-COMPANY-CD-A5.
  9697
  9698     MOVE CERT-CARRIER           TO CM-CARRIER.
  9699     MOVE CERT-GROUPING          TO CM-GROUPING.
  9700     MOVE CERT-STATE             TO CM-STATE.
  9701     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
  9702     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
  9703     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
  9704
  9705     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
  9706                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
  9707                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
  9708                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
  9709                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
  9710                       CM-LIVES              CM-LOAN-TERM
  9711                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
  9712                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
  9713                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
  9714                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
  9715                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
  9716                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
  9717                       CM-LF-ALT-PREMIUM-RATE
  9718                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
  9719                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
  9720                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
  9721                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
  9722                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
  9723
  9724     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
  9725                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 186
* EL130.cbl
  9726                                    CM-AH-SETTLEMENT-DT
  9727                                    CM-AH-CANCEL-EXIT-DT
  9728                                    CM-AH-SETTLEMENT-EXIT-DT
  9729                                    CM-LF-LOAN-EXPIRE-DT
  9730                                    CM-LF-CANCEL-DT
  9731                                    CM-LF-DEATH-DT
  9732                                    CM-LF-CANCEL-EXIT-DT
  9733                                    CM-LF-DEATH-EXIT-DT
  9734                                    CM-LAST-ADD-ON-DT
  9735                                    CM-ENTRY-DT.
  9736
  9737     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
  9738     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
  9739     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
  9740
  9741     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
  9742                                    CM-PART-LAST-NAME-A2
  9743                                    CM-PART-LAST-NAME-A5.
  9744
  9745     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
  9746                                    CM-INSURED-INITIAL1-A2
  9747                                    CM-INSURED-INITIAL1-A5
  9748                                    CM-INSURED-FIRST-NAME.
  9749
  9750     IF CRTINITL GREATER ZERO
  9751         MOVE CRTINITI           TO CM-INSURED-INITIAL2
  9752                                    CM-INSURED-INITIAL2-A2
  9753                                    CM-INSURED-INITIAL2-A5
  9754     ELSE
  9755         MOVE SPACES             TO CM-INSURED-INITIAL2
  9756                                    CM-INSURED-INITIAL2-A2
  9757                                    CM-INSURED-INITIAL2-A5
  9758     END-IF.
  9759
  9760     IF CM-INSURED-INITIALS = SPACES
  9761         MOVE '**'               TO CM-INSURED-INITIALS
  9762     END-IF.
  9763
  9764     IF MEMBERL GREATER ZERO
  9765         MOVE MEMBERI              TO CM-MEMBER-NO
  9766     ELSE
  9767         MOVE CERT-STATE           TO CM-MEMB-STATE
  9768         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
  9769         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
  9770         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
  9771     END-IF.
  9772
  9773     IF JNTLNMEL GREATER ZERO
  9774         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
  9775     END-IF.
  9776
  9777     IF JNTFNMEL GREATER ZERO
  9778         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
  9779     END-IF.
  9780
  9781     IF JNTINITL GREATER ZERO
  9782         MOVE JNTINITI           TO CM-JT-INITIAL
  9783     END-IF.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 187
* EL130.cbl
  9784
  9785     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9786
  9787
  9788
  9789* EXEC CICS HANDLE CONDITION
  9790*        DUPKEY   (3690-CERT-WRITTEN)
  9791*    END-EXEC.
  9792*    MOVE '"$$                   ! 9 #00009095' TO DFHEIV0
  9793     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9794     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9795     MOVE X'3920233030303039303935' TO DFHEIV0(25:11)
  9796     CALL 'kxdfhei1' USING DFHEIV0
  9797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9798
  9799
  9800
  9801
  9802* EXEC CICS WRITE
  9803*        DATASET   (ELCERT-DSID)
  9804*        FROM      (CERTIFICATE-MASTER)
  9805*        RIDFLD    (CM-CONTROL-PRIMARY)
  9806*    END-EXEC.
  9807     MOVE LENGTH OF
  9808      CERTIFICATE-MASTER
  9809       TO DFHEIV11
  9810*    MOVE '&$ L                  ''   #00009100' TO DFHEIV0
  9811     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9812     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9813     MOVE X'2020233030303039313030' TO DFHEIV0(25:11)
  9814     CALL 'kxdfhei1' USING DFHEIV0,
  9815           ELCERT-DSID,
  9816           CERTIFICATE-MASTER,
  9817           DFHEIV11,
  9818           CM-CONTROL-PRIMARY,
  9819           DFHEIV99,
  9820           DFHEIV99
  9821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9822
  9823
  9824 3690-CERT-WRITTEN.
  9825
  9826     GO TO 3800-BUILD-NEW-CLAIM.
  9827
  9828 3690-EXIT.
  9829      EXIT.
  9830
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 188
* EL130.cbl
  9832 3700-BUILD-CERT.
  9833
  9834     IF CERTMTI NOT = 'A'
  9835         GO TO 3700-FINISH-CERT-BUILD
  9836     END-IF.
  9837
  9838     IF CERTMTI = 'A'
  9839         IF LCVCDL = ZEROS
  9840             MOVE ZEROS          TO CM-LF-BENEFIT-CD
  9841                                    CM-LF-ORIG-TERM
  9842                                    CM-LF-BENEFIT-AMT
  9843                                    CM-LF-PREMIUM-RATE
  9844             GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9845         END-IF
  9846     END-IF.
  9847
  9848     IF LCVCDL GREATER ZERO
  9849         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
  9850     END-IF.
  9851
  9852     IF LCVOTRML GREATER ZERO
  9853         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
  9854     END-IF.
  9855
  9856     IF LCVBENEL GREATER ZERO
  9857         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
  9858     END-IF.
  9859
  9860     IF LCVRATEL GREATER ZERO
  9861         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
  9862     END-IF.
  9863
  9864     IF WS-EXPIRE NOT = LOW-VALUES
  9865         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
  9866     END-IF.
  9867
  9868     IF LCVFORML GREATER ZERO
  9869         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
  9870     END-IF.
  9871
  9872     IF LCVCNDTL = ZERO
  9873        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9874     END-IF.
  9875
  9876     IF WS-LCVCNDT NOT = LOW-VALUES
  9877        MOVE '8'                 TO CM-LF-CURRENT-STATUS
  9878        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
  9879        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9880     END-IF.
  9881
  9882     IF CM-LF-CURRENT-STATUS = '7'
  9883        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
  9884        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
  9885        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
  9886                                    CM-LF-DEATH-DT
  9887        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9888     END-IF.
  9889
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 189
* EL130.cbl
  9890     IF CM-LF-CURRENT-STATUS = '8'
  9891        MOVE '1'                 TO CM-LF-CURRENT-STATUS
  9892        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
  9893     END-IF.
  9894
  9895 3700-BUILD-AH-COVERAGE-SIDE.
  9896
  9897     IF CERTMTI = 'A'
  9898         IF ACVCDL = ZEROS
  9899             MOVE ZEROS          TO CM-AH-BENEFIT-CD
  9900                                    CM-AH-ORIG-TERM
  9901                                    CM-AH-BENEFIT-AMT
  9902                                    CM-AH-PREMIUM-RATE
  9903             GO TO 3700-COVERAGE-BUILT
  9904         END-IF
  9905     END-IF.
  9906
  9907     IF ACVCDL GREATER ZERO
  9908         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
  9909     END-IF.
  9910
  9911     IF ACVOTRML GREATER ZERO
  9912         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
  9913     END-IF.
  9914
  9915     IF ACVBENEL GREATER ZERO
  9916         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
  9917     END-IF.
  9918
  9919     IF ACVRATEL GREATER ZERO
  9920         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
  9921     END-IF.
  9922
  9923     IF WS-EXPIRE NOT = LOW-VALUES
  9924         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
  9925     END-IF.
  9926
  9927     IF ACVFORML GREATER ZERO
  9928         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
  9929     END-IF.
  9930
  9931     IF ACVCNDTL = ZERO
  9932        GO TO 3700-COVERAGE-BUILT
  9933     END-IF.
  9934
  9935     IF WS-ACVCNDT NOT = LOW-VALUES
  9936        MOVE '8'                 TO CM-AH-CURRENT-STATUS
  9937        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
  9938        GO TO 3700-COVERAGE-BUILT
  9939     END-IF.
  9940
  9941     IF CM-AH-CURRENT-STATUS = '6'
  9942        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
  9943        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
  9944        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
  9945        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
  9946        GO TO 3700-COVERAGE-BUILT
  9947     END-IF.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 190
* EL130.cbl
  9948
  9949     IF CM-AH-CURRENT-STATUS = '8'
  9950        MOVE '1'                 TO CM-AH-CURRENT-STATUS
  9951        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
  9952     END-IF.
  9953
  9954 3700-COVERAGE-BUILT.
  9955     IF ISSAGEL GREATER ZERO
  9956         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
  9957     END-IF.
  9958
  9959     IF JNTAGEL GREATER ZERO
  9960         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
  9961     END-IF.
  9962
  9963     IF SEXL GREATER ZERO
  9964         MOVE SEXI               TO CM-INSURED-SEX
  9965     END-IF.
  9966
  9967     IF APRL GREATER ZERO
  9968         MOVE WS-APR             TO CM-LOAN-APR
  9969     END-IF.
  9970
  9971     IF PMTFREQL GREATER ZERO
  9972         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
  9973     END-IF.
  9974
  9975     IF INDGRPL GREATER ZERO
  9976         MOVE INDGRPI            TO CM-IND-GRP-TYPE
  9977     END-IF.
  9978
  9979     IF CERTMTI = 'A'
  9980         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
  9981     END-IF.
  9982
  9983     IF REINCDL GREATER ZERO
  9984         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
  9985                                    WS-REIN-1
  9986                                    WS-REIN-2
  9987                                    WS-REIN-3
  9988         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
  9989     END-IF.
  9990
  9991     IF WS-ADD-ON-DT NOT = LOW-VALUES
  9992         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
  9993     END-IF.
  9994
  9995     IF CRTSSNL GREATER ZERO
  9996         MOVE CRTSSNI            TO CM-SOC-SEC-NO
  9997     ELSE
  9998         IF SSNL GREATER ZERO
  9999             MOVE SSNI           TO CM-SOC-SEC-NO
 10000         END-IF
 10001     END-IF.
 10002
 10003     IF CRTSSNL = ZERO AND
 10004        SSNL    = ZERO
 10005         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 191
* EL130.cbl
 10006         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10007         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10008         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10009     END-IF.
 10010
 10011     IF CM-LF-CURRENT-STATUS = SPACES
 10012         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10013     END-IF.
 10014
 10015     IF CM-AH-CURRENT-STATUS = SPACES
 10016         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10017     END-IF.
 10018
 10019     IF CERTMTI = 'A'
 10020         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10021     END-IF.
 10022
 10023 3700-FINISH-CERT-BUILD.
 10024
 10025     IF LOANNOL GREATER ZERO
 10026         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10027     END-IF.
 10028
 10029     IF LOANBALL GREATER ZERO
 10030         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10031     END-IF.
 10032
 10033     IF PREMTYPL GREATER ZERO
 10034         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10035     END-IF.
 10036
 10037 3700-EXIT.
 10038      EXIT.
 10039
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 192
* EL130.cbl
 10041 3800-BUILD-NEW-CLAIM.
 10042
 10043*************************************************************
 10044*****           START OF ACTIVITY FILE PROCESSING          **
 10045*************************************************************
 10046     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10047         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10048                 6700-EXIT
 10049     END-IF.
 10050*************************************************************
 10051*****            END OF ACTIVITY FILE PROCESSING           **
 10052*************************************************************
 10053
 10054
 10055
 10056
 10057* EXEC CICS GETMAIN
 10058*        SET     (ADDRESS OF CLAIM-MASTER)
 10059*        LENGTH  (ELMSTR-LENGTH)
 10060*    END-EXEC.
 10061*    MOVE '," L                  $   #00009338' TO DFHEIV0
 10062     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10063     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10064     MOVE X'2020233030303039333338' TO DFHEIV0(25:11)
 10065     CALL 'kxdfhei1' USING DFHEIV0,
 10066           DFHEIV20,
 10067           ELMSTR-LENGTH,
 10068           DFHEIV99
 10069     SET ADDRESS OF CLAIM-MASTER TO
 10070         DFHEIV20
 10071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10072
 10073
 10074     MOVE SPACES TO CLAIM-MASTER.
 10075
 10076     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10077         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10078         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10079         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10080         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10081         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10082         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10083         CL-ACTIVITY-MAINT-DT.
 10084
 10085     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10086             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10087             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10088             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10089             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10090             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10091             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10092             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10093             CL-FORCEABLE-ERROR-CNT.
 10094
 10095     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10096
 10097     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10098                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 193
* EL130.cbl
 10099                                    CL-LAG-REPORT-CODE.
 10100
 10101     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10102     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10103
 10104     IF BENECDL NOT = ZEROS
 10105        MOVE BENECDI             TO CL-BENEFICIARY
 10106     END-IF.
 10107
 10108     MOVE 'CL'                   TO CL-RECORD-ID.
 10109     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10110
 10111     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10112                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10113                             CL-COMPANY-CD-A5.
 10114
 10115     MOVE CLMCARRI               TO CL-CARRIER.
 10116
 10117     IF CLMNOL = ZERO
 10118         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10119     ELSE
 10120         MOVE CLMNOI             TO CL-CLAIM-NO
 10121     END-IF.
 10122
 10123     MOVE CERTNOI                TO CL-CERT-PRIME
 10124                                    CL-CERT-A4-PRIME.
 10125
 10126     MOVE SUFXI                  TO CL-CERT-SFX
 10127                                    CL-CERT-A4-SFX.
 10128
 10129     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10130
 10131     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10132
 10133     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10134
 10135     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10136
 10137     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10138     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10139
 10140     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10141
 10142     IF CERTMTI = 'A'
 10143         MOVE '2'                TO CL-CERT-ORIGIN
 10144     ELSE
 10145         MOVE '1'                TO CL-CERT-ORIGIN
 10146     END-IF.
 10147
 10148     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10149     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10150     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10151     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10152     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10153
 10154 3820-REWRITE-CONTROL-FILE.
 10155
 10156     IF CLMNOL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 194
* EL130.cbl
 10157         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10158     END-IF.
 10159
 10160     IF CF-RECORD-TYPE = '6'
 10161         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10162     ELSE
 10163         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10164     END-IF.
 10165
 10166
 10167
 10168* EXEC CICS REWRITE
 10169*        DATASET   (ELCNTL-DSID)
 10170*        FROM      (CONTROL-FILE)
 10171*    END-EXEC.
 10172     MOVE LENGTH OF
 10173      CONTROL-FILE
 10174       TO DFHEIV11
 10175*    MOVE '&& L                  %   #00009436' TO DFHEIV0
 10176     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10177     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10178     MOVE X'2020233030303039343336' TO DFHEIV0(25:11)
 10179     CALL 'kxdfhei1' USING DFHEIV0,
 10180           ELCNTL-DSID,
 10181           CONTROL-FILE,
 10182           DFHEIV11,
 10183           DFHEIV99
 10184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10185
 10186
 10187 3830-SEQUENCE-CLAIM-RECORDS.
 10188
 10189     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10190     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10191     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10192
 10193     IF WS-ASSOC-CERT-TOTAL = ZERO
 10194         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10195                                    CL-ASSOC-CERT-TOTAL
 10196         GO TO 3840-WRITE-CLAIM-MASTER
 10197     END-IF.
 10198
 10199     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10200         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10201     ELSE
 10202         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10203     END-IF.
 10204
 10205     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10206     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10207     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10208
 10209 3840-WRITE-CLAIM-MASTER.
 10210
 10211     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
 10212     IF WS-REC-FOUND-SW = 'Y'
 10213         MOVE 01                 TO  CL-ACTIVITY-CODE
 10214         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 195
* EL130.cbl
 10215         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10216     END-IF.
 10217
 10218
 10219
 10220* EXEC CICS HANDLE CONDITION
 10221*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10222*    END-EXEC.
 10223*    MOVE '"$$                   ! : #00009473' TO DFHEIV0
 10224     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10225     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10226     MOVE X'3A20233030303039343733' TO DFHEIV0(25:11)
 10227     CALL 'kxdfhei1' USING DFHEIV0
 10228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10229
 10230
 10231** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10232     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10233
 10234
 10235
 10236* EXEC CICS WRITE
 10237*        DATASET   (ELMSTR-DSID)
 10238*        FROM      (CLAIM-MASTER)
 10239*        RIDFLD    (CL-CONTROL-PRIMARY)
 10240*    END-EXEC.
 10241     MOVE LENGTH OF
 10242      CLAIM-MASTER
 10243       TO DFHEIV11
 10244*    MOVE '&$ L                  ''   #00009481' TO DFHEIV0
 10245     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10246     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10247     MOVE X'2020233030303039343831' TO DFHEIV0(25:11)
 10248     CALL 'kxdfhei1' USING DFHEIV0,
 10249           ELMSTR-DSID,
 10250           CLAIM-MASTER,
 10251           DFHEIV11,
 10252           CL-CONTROL-PRIMARY,
 10253           DFHEIV99,
 10254           DFHEIV99
 10255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10256
 10257
 10258 3850-CLAIM-MSTR-WRITTEN.
 10259
 10260     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10261         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10262     END-IF.
 10263
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 196
* EL130.cbl
 10265 3990-ADD-DONE.
 10266     MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10267                                   EMI-SUB      EMI-SWITCH-AREA-2.
 10268     MOVE SPACES                TO EMI-ACTION-SWITCH
 10269                                   EMI-ERROR-LINES.
 10270
 10271     IF CLMNOL = ZERO
 10272         MOVE ER-0265            TO EMI-ERROR
 10273         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10274         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (1)
 10275                                    PI-LAST-CLAIM
 10276     ELSE
 10277         MOVE CLMNOI             TO PI-LAST-CLAIM
 10278                                    MSTR-CLAIM-NO
 10279         MOVE ER-0000            TO EMI-ERROR
 10280         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10281     END-IF.
 10282
 10283     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10284       AND PI-ST-VFY-2ND-BENE = 'Y'
 10285         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10286         MOVE ER-7575            TO EMI-ERROR
 10287         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10288     END-IF.
 10289
 10290     IF WS-NO-INSURED-ADDRESS = 'Y'
 10291         MOVE ER-3548            TO EMI-ERROR
 10292         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10293     END-IF.
 10294
 10295     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10296       (PI-ST-CAUSAL-STATE = 'L' AND
 10297              CLMTYPEI = PI-LIFE-OVERRIDE-L1)   OR
 10298       (PI-ST-CAUSAL-STATE = 'A' AND
 10299              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10300         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10301         MOVE ER-7577            TO EMI-ERROR
 10302         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10303     END-IF.
 10304
 10305     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10306     MOVE CLMCARRI                   TO  PI-CARRIER.
 10307     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10308     MOVE SUFXI                      TO  PI-CERT-SFX.
 10309
 10310     IF WS-LETTER-SW = 'Y'
 10311         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
 10312         IF W-1523-ERROR-CODE NOT = ZEROS
 10313             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10314             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10315         END-IF
 10316     END-IF.
 10317
 10318     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10319     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10320     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10321     MOVE CLMCARRI               TO PI-LAST-CARR.
 10322
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 197
* EL130.cbl
 10323     IF PRTOPTL GREATER THAN 0
 10324         MOVE PRTOPTI            TO PI-PRT-OPT
 10325     END-IF.
 10326     IF ALTPRTL GREATER THAN 0
 10327         MOVE ALTPRTI            TO PI-ALT-PRT
 10328     END-IF.
 10329
 10330     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10331         MOVE LOW-VALUES         TO EL130AI
 10332         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10333         MOVE AL-SANON           TO CERTNOA
 10334         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10335         MOVE AL-SANON           TO SUFXA
 10336         MOVE PI-LAST-CARR       TO CLMCARRO
 10337         MOVE AL-UANON           TO CLMCARRA
 10338         MOVE PI-LAST-CLAIM      TO CLMNOO
 10339         MOVE AL-UANON           TO CLMNOA
 10340         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10341         MOVE AL-UANON           TO CLMTYPEA
 10342     ELSE
 10343         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10344         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10345     END-IF.
 10346
 10347     IF PI-PRT-OPT = 'N' OR 'L'
 10348         MOVE PI-PRT-OPT         TO PRTOPTO
 10349         MOVE 1                  TO PRTOPTL
 10350     END-IF.
 10351
 10352     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10353         MOVE PI-ALT-PRT         TO ALTPRTO
 10354         MOVE 4                  TO ALTPRTL
 10355     END-IF.
 10356
 10357     IF PRTOPTL GREATER THAN 0
 10358         IF PRTOPTI = 'L'
 10359             GO TO 0400-CREATE-ELACTQ
 10360         ELSE
 10361             GO TO 0480-PRINT-NOW
 10362         END-IF
 10363     END-IF.
 10364
 10365     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10366         GO TO 8100-SEND-INITIAL-MAP
 10367     ELSE
 10368         MOVE LOW-VALUES         TO MAINTO
 10369         MOVE -1                 TO MAINTL
 10370         GO TO 8200-SEND-DATAONLY
 10371     END-IF.
 10372
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 198
* EL130.cbl
 10374 3993-MODIFY-SCREEN-ATTRB.
 10375
 10376     IF CERTMTL GREATER ZERO
 10377         MOVE AL-UANON           TO CERTMTA
 10378     END-IF.
 10379
 10380     IF EFFDTL GREATER ZERO
 10381         MOVE AL-UANON           TO EFFDTA
 10382     END-IF.
 10383
 10384     IF ACCOUNTL GREATER ZERO
 10385         MOVE AL-UANON           TO ACCOUNTA
 10386     END-IF.
 10387
 10388     IF STATEL GREATER ZERO
 10389         MOVE AL-UANON           TO STATEA
 10390     END-IF.
 10391
 10392     IF CRTCARRL GREATER ZERO
 10393         MOVE AL-UANON           TO CRTCARRA
 10394     END-IF.
 10395
 10396     IF GROUPL GREATER ZERO
 10397         MOVE AL-UANON           TO GROUPA
 10398     END-IF.
 10399
 10400     IF CRTLNMEL GREATER ZERO
 10401         MOVE AL-UANON           TO CRTLNMEA
 10402     END-IF.
 10403
 10404     IF CRTFNMEL GREATER ZERO
 10405         MOVE AL-UANON           TO CRTFNMEA
 10406     END-IF.
 10407
 10408     IF CRTINITL GREATER ZERO
 10409         MOVE AL-UANON           TO CRTINITA
 10410     END-IF.
 10411
 10412     IF ISSAGEL GREATER ZERO
 10413         MOVE AL-UNNON           TO ISSAGEA
 10414     END-IF.
 10415
 10416     IF JNTLNMEL GREATER ZERO
 10417         MOVE AL-UANON           TO JNTLNMEA
 10418     END-IF.
 10419
 10420     IF JNTFNMEL GREATER ZERO
 10421         MOVE AL-UANON           TO JNTFNMEA
 10422     END-IF.
 10423
 10424     IF JNTINITL GREATER ZERO
 10425         MOVE AL-UANON           TO JNTINITA
 10426     END-IF.
 10427
 10428     IF JNTAGEL GREATER ZERO
 10429         MOVE AL-UNNON           TO JNTAGEA
 10430     END-IF.
 10431
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 199
* EL130.cbl
 10432     IF CRTSSNL GREATER ZERO
 10433         MOVE AL-UANON           TO CRTSSNA
 10434     END-IF.
 10435
 10436     IF ACVDSCRL GREATER ZERO
 10437         MOVE AL-SANON           TO ACVDSCRA
 10438     END-IF.
 10439
 10440     IF ACVKINDL GREATER ZERO
 10441         MOVE AL-SANON           TO ACVKINDA
 10442     END-IF.
 10443
 10444     IF ACVCDL GREATER ZERO
 10445         MOVE AL-UANON           TO ACVCDA
 10446     END-IF.
 10447
 10448     IF ACVOTRML GREATER ZERO
 10449         MOVE AL-UNNON           TO ACVOTRMA
 10450     END-IF.
 10451
 10452     IF ACVRTRML GREATER ZERO
 10453         MOVE AL-UNNON           TO ACVRTRMA
 10454     END-IF.
 10455
 10456     IF ACVRATEL GREATER ZERO
 10457         MOVE AL-UNNON           TO ACVRATEA
 10458     END-IF.
 10459
 10460     IF ACVBENEL GREATER ZERO
 10461         MOVE AL-UNNON           TO ACVBENEA
 10462     END-IF.
 10463
 10464     IF ACVFORML GREATER ZERO
 10465         MOVE AL-UANON           TO ACVFORMA
 10466     END-IF.
 10467
 10468     IF ACVCNDTL GREATER ZERO
 10469         MOVE AL-UANON           TO ACVCNDTA
 10470     END-IF.
 10471
 10472     IF ACVEXITL GREATER ZERO
 10473         MOVE AL-UANON           TO ACVEXITA
 10474     END-IF.
 10475
 10476     IF ACVSTATL GREATER ZERO
 10477         MOVE AL-UANON           TO ACVSTATA
 10478     END-IF.
 10479
 10480     IF LCVDSCRL GREATER ZERO
 10481         MOVE AL-SANON           TO LCVDSCRA
 10482     END-IF.
 10483
 10484     IF LCVKINDL GREATER ZERO
 10485         MOVE AL-SANON           TO LCVKINDA
 10486     END-IF.
 10487
 10488     IF LCVCDL GREATER ZERO
 10489         MOVE AL-UANON           TO LCVCDA
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 200
* EL130.cbl
 10490     END-IF.
 10491
 10492     IF LCVOTRML GREATER ZERO
 10493         MOVE AL-UNNON           TO LCVOTRMA
 10494     END-IF.
 10495
 10496     IF LCVRTRML GREATER ZERO
 10497         MOVE AL-UNNON           TO LCVRTRMA
 10498     END-IF.
 10499
 10500     IF LCVRATEL GREATER ZERO
 10501         MOVE AL-UNNON           TO LCVRATEA
 10502     END-IF.
 10503
 10504     IF LCVBENEL GREATER ZERO
 10505         MOVE AL-UNNON           TO LCVBENEA
 10506     END-IF.
 10507
 10508     IF LCVFORML GREATER ZERO
 10509         MOVE AL-UANON           TO LCVFORMA
 10510     END-IF.
 10511
 10512     IF LCVCNDTL GREATER ZERO
 10513         MOVE AL-UANON           TO LCVCNDTA
 10514     END-IF.
 10515
 10516     IF LCVEXITL GREATER ZERO
 10517         MOVE AL-UANON           TO LCVEXITA
 10518     END-IF.
 10519
 10520     IF LCVSTATL GREATER ZERO
 10521         MOVE AL-UANON           TO LCVSTATA
 10522     END-IF.
 10523
 10524     IF MEMCAPL GREATER ZERO
 10525         MOVE AL-UANON           TO MEMCAPA
 10526     END-IF.
 10527
 10528     IF APRL GREATER ZERO
 10529         MOVE AL-UNNON           TO APRA
 10530     END-IF.
 10531
 10532     IF PMTFREQL GREATER ZERO
 10533         MOVE AL-UNNON           TO PMTFREQA
 10534     END-IF.
 10535
 10536     IF INDGRPL GREATER ZERO
 10537         MOVE AL-UANON           TO INDGRPA
 10538     END-IF.
 10539
 10540     IF PREMTYPL GREATER ZERO
 10541         MOVE AL-UANON           TO PREMTYPA
 10542     END-IF.
 10543
 10544     IF REINCDL GREATER ZERO
 10545         MOVE AL-UANON           TO REINCDA
 10546     END-IF.
 10547
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 201
* EL130.cbl
 10548     IF ADDONDTL GREATER ZERO
 10549         MOVE AL-UANON           TO ADDONDTA
 10550     END-IF.
 10551
 10552     IF MEMBERL GREATER ZERO
 10553         MOVE AL-UANON           TO MEMBERA
 10554     END-IF.
 10555
 10556     IF BCERT1L GREATER ZERO
 10557         MOVE AL-SANON           TO BCERT1A
 10558                                    BSUFX1A
 10559     END-IF.
 10560
 10561     IF BCERT2L GREATER ZERO
 10562         MOVE AL-SANON           TO BCERT2A
 10563                                    BSUFX2A
 10564     END-IF.
 10565
 10566     IF BCERT3L GREATER ZERO
 10567         MOVE AL-SANON           TO BCERT3A
 10568                                    BSUFX3A
 10569     END-IF.
 10570
 10571     IF BCERT4L GREATER ZERO
 10572         MOVE AL-SANON           TO BCERT4A
 10573                                    BSUFX4A
 10574     END-IF.
 10575
 10576     IF BCERT5L GREATER ZERO
 10577         MOVE AL-SANON           TO BCERT5A
 10578                                    BSUFX5A
 10579     END-IF.
 10580
 10581 3993-MODIFY-CLAIM-ATTRB.
 10582
 10583     IF PCERTNOL GREATER ZERO
 10584         MOVE AL-UANON           TO PCERTNOA
 10585     END-IF.
 10586
 10587     IF PSUFXL GREATER ZERO
 10588         MOVE AL-UANON           TO PSUFXA
 10589     END-IF.
 10590
 10591     IF LSTNMEL GREATER ZERO
 10592         MOVE AL-UANON           TO LSTNMEA
 10593     END-IF.
 10594
 10595     IF FSTNMEL GREATER ZERO
 10596         MOVE AL-UANON           TO FSTNMEA
 10597     END-IF.
 10598
 10599     IF INITL GREATER ZERO
 10600         MOVE AL-UANON           TO INITA
 10601     END-IF.
 10602
 10603     IF SEXL GREATER ZERO
 10604         MOVE AL-UANON           TO SEXA
 10605     END-IF.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 202
* EL130.cbl
 10606
 10607     IF OCCCDL GREATER ZERO
 10608         MOVE AL-UANON           TO OCCCDA
 10609     END-IF.
 10610
 10611     IF BIRTHDTL GREATER ZERO
 10612         MOVE AL-UANON           TO BIRTHDTA
 10613     END-IF.
 10614
 10615     IF SSNL GREATER ZERO
 10616         MOVE AL-UANON           TO SSNA
 10617     END-IF.
 10618
 10619     IF INCURL GREATER ZERO
 10620         MOVE AL-UANON           TO INCURA
 10621     END-IF.
 10622
 10623     IF REPORTL GREATER ZERO
 10624         MOVE AL-UANON           TO REPORTA
 10625     END-IF.
 10626
 10627     IF ESTENDL GREATER ZERO
 10628         MOVE AL-UANON           TO ESTENDA
 10629     END-IF.
 10630
 10631     IF DIAGL GREATER ZERO
 10632         MOVE AL-UANON           TO DIAGA
 10633     END-IF.
 10634
 10635     IF CAUSEL GREATER ZERO
 10636         MOVE AL-UANON           TO CAUSEA
 10637     END-IF.
 10638
 10639     IF MANRSVL GREATER ZERO
 10640         MOVE AL-UNNON           TO MANRSVA
 10641     END-IF.
 10642
 10643     IF RELCLML GREATER ZERO
 10644         MOVE AL-UANON           TO RELCLMA
 10645     END-IF.
 10646
 10647     IF LOANNOL GREATER ZERO
 10648         MOVE AL-UANON           TO LOANNOA
 10649     END-IF.
 10650
 10651     IF LOANBALL GREATER ZERO
 10652         MOVE AL-UNNON           TO LOANBALA
 10653     END-IF.
 10654
 10655     IF PROCCDL GREATER ZERO
 10656         MOVE AL-UANON           TO PROCCDA
 10657     END-IF.
 10658
 10659     IF BENECDL GREATER THAN ZERO
 10660         MOVE AL-UANON           TO  BENECDA
 10661     END-IF.
 10662
 10663     IF PRICDL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 203
* EL130.cbl
 10664         MOVE AL-UANON           TO PRICDA
 10665     END-IF.
 10666
 10667     IF SUPVL GREATER ZERO
 10668         MOVE AL-UANON           TO SUPVA
 10669     END-IF.
 10670
 10671     IF FILETOL GREATER ZERO
 10672         MOVE AL-UANON           TO FILETOA
 10673     END-IF.
 10674
 10675
 10676 3993-MODIFY-CLAIM-KEY-ATTRB.
 10677
 10678     IF CLMNOL GREATER ZERO
 10679         MOVE AL-UANON           TO CLMNOA
 10680     END-IF.
 10681
 10682     IF CLMCARRL GREATER ZERO
 10683         MOVE AL-UANON           TO CLMCARRA
 10684     END-IF.
 10685
 10686     IF CLMTYPEL GREATER ZERO
 10687         MOVE AL-UANON           TO CLMTYPEA
 10688     END-IF.
 10689
 10690     IF CERTNOL GREATER ZERO
 10691         MOVE AL-SANON           TO CERTNOA
 10692     END-IF.
 10693
 10694     IF SUFXL GREATER ZERO
 10695         MOVE AL-SANON           TO SUFXA
 10696     END-IF.
 10697
 10698 3993-EXIT.
 10699     EXIT.
 10700
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 204
* EL130.cbl
 10702 3994-BUILD-NINETY-THREE-TRAILER.
 10703
 10704     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 10705     MOVE 'AT'                   TO AT-RECORD-ID.
 10706
 10707     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 10708     MOVE CLMCARRI               TO AT-CARRIER.
 10709
 10710     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 10711     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 10712     MOVE +93                    TO AT-SEQUENCE-NO.
 10713     MOVE '6'                    TO AT-TRAILER-TYPE.
 10714     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 10715
 10716     MOVE WS-VERIFY-NOTE         TO AT-INFO-LINE-1.
 10717
 10718     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10719                                    AT-GEN-INFO-LAST-MAINT-DT.
 10720
 10721     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10722                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10723     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10724
 10725
 10726
 10727* EXEC CICS WRITE
 10728*        DATASET   (ELTRLR-DSID)
 10729*        FROM      (ACTIVITY-TRAILERS)
 10730*        RIDFLD    (AT-CONTROL-PRIMARY)
 10731*    END-EXEC.
 10732     MOVE LENGTH OF
 10733      ACTIVITY-TRAILERS
 10734       TO DFHEIV11
 10735*    MOVE '&$ L                  ''   #00009955' TO DFHEIV0
 10736     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10737     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10738     MOVE X'2020233030303039393535' TO DFHEIV0(25:11)
 10739     CALL 'kxdfhei1' USING DFHEIV0,
 10740           ELTRLR-DSID,
 10741           ACTIVITY-TRAILERS,
 10742           DFHEIV11,
 10743           AT-CONTROL-PRIMARY,
 10744           DFHEIV99,
 10745           DFHEIV99
 10746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10747
 10748
 10749 3994-EXIT.
 10750     EXIT.
 10751
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 205
* EL130.cbl
 10753 3994B-BUILD-NINETY-FOUR-TRAILER.
 10754
 10755     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 10756     MOVE 'AT'                   TO AT-RECORD-ID.
 10757
 10758     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 10759     MOVE CLMCARRI               TO AT-CARRIER.
 10760
 10761     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 10762     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 10763     MOVE +94                    TO AT-SEQUENCE-NO.
 10764     MOVE '6'                    TO AT-TRAILER-TYPE.
 10765     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 10766
 10767     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 10768
 10769     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10770                                    AT-GEN-INFO-LAST-MAINT-DT.
 10771
 10772     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10773                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10774     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10775
 10776
 10777
 10778* EXEC CICS WRITE
 10779*        DATASET   (ELTRLR-DSID)
 10780*        FROM      (ACTIVITY-TRAILERS)
 10781*        RIDFLD    (AT-CONTROL-PRIMARY)
 10782*    END-EXEC.
 10783     MOVE LENGTH OF
 10784      ACTIVITY-TRAILERS
 10785       TO DFHEIV11
 10786*    MOVE '&$ L                  ''   #00009989' TO DFHEIV0
 10787     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10788     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10789     MOVE X'2020233030303039393839' TO DFHEIV0(25:11)
 10790     CALL 'kxdfhei1' USING DFHEIV0,
 10791           ELTRLR-DSID,
 10792           ACTIVITY-TRAILERS,
 10793           DFHEIV11,
 10794           AT-CONTROL-PRIMARY,
 10795           DFHEIV99,
 10796           DFHEIV99
 10797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10798
 10799
 10800 3994B-EXIT.
 10801     EXIT.
 10802
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 206
* EL130.cbl
 10804 3995-BUILD-CLAIM-RECORD.
 10805
 10806     IF PROCCDL GREATER ZERO
 10807         MOVE PROCCDI            TO CL-PROCESSOR-ID
 10808     ELSE
 10809         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 10810     END-IF.
 10811
 10812     IF FSTNMEL GREATER ZERO
 10813         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 10814     END-IF.
 10815
 10816     IF INITL GREATER ZERO
 10817         MOVE INITI              TO CL-INSURED-MID-INIT
 10818     END-IF.
 10819
 10820     IF BIRTHDTL GREATER ZERO
 10821         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 10822     END-IF.
 10823
 10824     IF SEXL GREATER ZERO
 10825         MOVE SEXI               TO CL-INSURED-SEX-CD
 10826     END-IF.
 10827
 10828     IF OCCCDL GREATER ZERO
 10829         MOVE OCCCDI             TO CL-INSURED-OCC-CD
 10830     END-IF.
 10831
 10832     MOVE 'O'                    TO CL-CLAIM-STATUS.
 10833
 10834*    IF CLMTYPEL GREATER ZERO
 10835     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 10836*    END-IF.
 10837
 10838     IF PREMTYPL GREATER ZERO
 10839         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 10840     END-IF.
 10841
 10842     IF INCURL GREATER ZERO
 10843         MOVE WS-INCUR           TO CL-INCURRED-DT
 10844     END-IF.
 10845
 10846     IF REPORTL GREATER ZERO
 10847         MOVE WS-REPORT          TO CL-REPORTED-DT
 10848     END-IF.
 10849
 10850     IF EIBAID = DFHPF6
 10851         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
 10852             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 10853                 IF EMI-FORCABLE-CTR = +1
 10854                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 10855                 END-IF
 10856         END-IF
 10857     END-IF.
 10858
 10859     IF ESTENDL GREATER ZERO
 10860        MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 10861     END-IF.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 207
* EL130.cbl
 10862
 10863     IF ADDONDTL GREATER ZERO
 10864         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 10865     END-IF.
 10866
 10867     IF CAUSEL GREATER ZERO
 10868         MOVE CAUSEI             TO CL-CAUSE-CD
 10869     END-IF.
 10870
 10871     IF SSNL GREATER ZERO
 10872         MOVE SSNI               TO CL-SOC-SEC-NO
 10873     ELSE
 10874         MOVE CERT-STATE         TO CL-SSN-STATE
 10875         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 10876         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 10877     END-IF.
 10878
 10879     IF PRICDL GREATER ZERO
 10880         MOVE PRICDI             TO CL-PRIORITY-CD
 10881     END-IF.
 10882
 10883     IF SUPVL GREATER ZERO
 10884         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 10885     END-IF.
 10886
 10887     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 10888     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 10889     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 10890
 10891     IF RELCLML GREATER ZERO
 10892         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 10893     END-IF.
 10894
 10895     IF FILETOL GREATER ZERO
 10896         MOVE FILETOI            TO CL-FILE-LOCATION
 10897     END-IF.
 10898
 10899 3995-EXIT.
 10900      EXIT.
 10901
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 208
* EL130.cbl
 10903 4000-CALCULATE-CERT-TERM.
 10904
 10905     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 10906
 10907     MOVE N                      TO WS-TERM.
 10908
 10909     IF WS-TERM GREATER 120
 10910         MOVE 120                TO WS-TERM
 10911     END-IF.
 10912
 10913 4000-CALC-TERM-EXIT.
 10914      EXIT.
 10915
 10916 4100-CALC-GROSS-TERM.
 10917     MOVE HOLD-LOAN-BAL           TO L.
 10918     MOVE WS-ACVBENE              TO M.
 10919     COMPUTE N = L / M.
 10920     IF N LESS 1
 10921         MOVE 1  TO N
 10922     END-IF.
 10923
 10924     IF LCVCDL GREATER ZERO
 10925         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 10926     ELSE
 10927         MOVE ZEROS               TO WS-LF-RATE
 10928     END-IF.
 10929
 10930     IF ACVCDL GREATER ZERO
 10931         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 10932     ELSE
 10933         MOVE ZEROS               TO WS-AH-RATE
 10934     END-IF.
 10935
 10936     COMPUTE I = WS-APR / +1200.
 10937
 10938 4105-LOOP.
 10939     IF N GREATER 240
 10940         GO TO 4200-EXIT
 10941     END-IF.
 10942
 10943     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 10944
 10945     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 10946         ADD 1 TO N
 10947         GO TO 4105-LOOP
 10948     END-IF.
 10949
 10950 4200-EXIT.
 10951      EXIT.
 10952
 10953 4210-CALC-LEFT-RIGHTONE.
 10954      MOVE L         TO LEFT-TOT-1.
 10955      SUBTRACT 1 FROM N.
 10956      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 10957      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 10958      ADD 1 TO N.
 10959
 10960 4211-CALC-TERM1.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 209
* EL130.cbl
 10961      MOVE N         TO TERM1.
 10962      MULTIPLY M BY TERM1.
 10963
 10964 4212-LOOP.
 10965      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 10966      ADD 1 TO A-N.
 10967      MULTIPLY A-N BY TERM1.
 10968      SUBTRACT 1 FROM A-N.
 10969      ADD TERM1 TO LEFT-TOT-1.
 10970
 10971 4213-CALC-TERM2.
 10972      MOVE M         TO TERM2.
 10973      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 10974      MULTIPLY IA-N BY TERM2.
 10975      SUBTRACT TERM2 FROM LEFT-TOT-1.
 10976
 10977 4215-CALC-RIGHTONE.
 10978      MOVE M         TO RIGHT-TOT-1.
 10979      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 10980      MULTIPLY A-N BY RIGHT-TOT-1.
 10981
 10982 4220-EXIT.
 10983      EXIT.
 10984
 10985 4300-CALC-A-N.
 10986     IF N LESS 1
 10987         MOVE 0     TO A-N
 10988         GO TO 4300-EXIT
 10989     END-IF.
 10990
 10991     IF I = 0
 10992         MOVE .00001 TO I
 10993     END-IF.
 10994
 10995     ADD 1 TO I.
 10996     DIVIDE I INTO 1 GIVING V.
 10997     SUBTRACT 1 FROM I.
 10998     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 10999     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 11000     DIVIDE I INTO TERM3 GIVING A-N.
 11001
 11002 4300-EXIT.
 11003      EXIT.
 11004
 11005 4350-CALC-IA-N.
 11006     IF N LESS 1
 11007         MOVE 0      TO IA-N
 11008         GO TO 4400-EXIT
 11009     END-IF.
 11010
 11011     ADD 1 TO N.
 11012     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11013     SUBTRACT 1 FROM N.
 11014     MULTIPLY N BY V-EX-N GIVING TERM3.
 11015     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 11016     SUBTRACT V FROM 1 GIVING TERM4.
 11017     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 11018
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 210
* EL130.cbl
 11019 4400-EXIT.
 11020      EXIT.
 11021
 11022 4450-CALC-V-EX-N.
 11023     IF N LESS 1
 11024         MOVE 1    TO V-EX-N
 11025         GO TO 4490-EXIT
 11026     END-IF.
 11027
 11028     MOVE N        TO NV-STORE.
 11029
 11030     IF V-EX-ONETIME = 1  OR
 11031        V NOT = V-EXPONENT (1)
 11032          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 11033     END-IF.
 11034
 11035 4460-LOOP.
 11036     IF N GREATER 248
 11037         MOVE 248 TO N
 11038     END-IF.
 11039
 11040     IF N = 1
 11041         MOVE V               TO V-EX-N
 11042     ELSE
 11043         MOVE V-EXPONENT (N)  TO V-EX-N
 11044     END-IF.
 11045
 11046     GO TO 4490-EXIT.
 11047
 11048 4470-BUILD-V-EX-TABLE.
 11049     MOVE 2      TO N.
 11050     MOVE V      TO V-EXPONENT (1)
 11051                    V-EX-N.
 11052
 11053 4471-LOOP.
 11054     MULTIPLY V BY V-EX-N.
 11055     MOVE V-EX-N   TO V-EXPONENT (N).
 11056
 11057     ADD 1 TO N.
 11058     IF N LESS 248
 11059         GO TO 4471-LOOP
 11060     END-IF.
 11061
 11062     MOVE NV-STORE     TO N.
 11063     MOVE ZERO         TO V-EX-ONETIME.
 11064
 11065 4480-EXIT.
 11066      EXIT.
 11067
 11068 4490-EXIT.
 11069      EXIT.
 11070
 11071 4500-CALC-NET-TERM.
 11072     MOVE HOLD-LOAN-BAL           TO L.
 11073     MOVE WS-ACVBENE              TO M.
 11074     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 11075
 11076     IF WS-REMAIN GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 211
* EL130.cbl
 11077         ADD 1 TO N
 11078     END-IF.
 11079
 11080     IF N = 0
 11081         MOVE 1 TO N
 11082     END-IF.
 11083
 11084 4700-EXIT.
 11085      EXIT.
 11086
 11087 4999-CALC-TERM-EXIT.
 11088     EXIT.
 11089
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 212
* EL130.cbl
 11091 5000-INCURRED-CHANGE.
 11092     IF NOT MODIFY-CAP
 11093         MOVE ER-0070            TO EMI-ERROR
 11094         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11095         MOVE -1                 TO MAINTL
 11096         GO TO 8200-SEND-DATAONLY
 11097     END-IF.
 11098
 11099     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 11100        CLMCARRI     NOT = PI-LAST-CARR        OR
 11101        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 11102        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 11103        PI-INCURR-SW NOT = 'Y'
 11104          GO TO 1000-SHOW-CLAIM
 11105     END-IF.
 11106
 11107     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 11108     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 11109     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 11110
 11111     IF EMI-NO-ERRORS
 11112         GO TO 5000-TRY-TO-BUILD
 11113     END-IF.
 11114
 11115     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 11116        MOVE ER-0433             TO EMI-ERROR
 11117        MOVE -1                  TO MAINTL
 11118        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11119        GO TO 8200-SEND-DATAONLY
 11120     END-IF.
 11121
 11122     IF EIBAID = DFHPF6
 11123         IF EMI-FATAL-CTR NOT EQUAL ZERO
 11124            MOVE ER-0434         TO EMI-ERROR
 11125            MOVE -1              TO MAINTL
 11126            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11127            GO TO 8200-SEND-DATAONLY
 11128         ELSE
 11129            MOVE +1              TO INCURL
 11130            GO TO 5000-TRY-TO-BUILD
 11131         END-IF
 11132     END-IF.
 11133
 11134     GO TO 8200-SEND-DATAONLY.
 11135
 11136 5000-TRY-TO-BUILD.
 11137
 11138     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 11139
 11140     MOVE CLMCARRI               TO MSTR-CARRIER.
 11141
 11142     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 11143     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 11144     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 11145
 11146     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 11147
 11148     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 213
* EL130.cbl
 11149         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 11150     END-IF.
 11151
 11152     IF CL-PURGED-DT NOT = LOW-VALUES
 11153
 11154
 11155* EXEC CICS UNLOCK
 11156*            DATASET   (ELMSTR-DSID)
 11157*        END-EXEC
 11158*    MOVE '&*                    #   #00010349' TO DFHEIV0
 11159     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11160     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11161     MOVE X'2020233030303130333439' TO DFHEIV0(25:11)
 11162     CALL 'kxdfhei1' USING DFHEIV0,
 11163           ELMSTR-DSID,
 11164           DFHEIV99
 11165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11166         MOVE ER-7691            TO EMI-ERROR
 11167         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11168         MOVE -1                 TO MAINTL
 11169         GO TO 8200-SEND-DATAONLY
 11170     END-IF.
 11171
 11172     IF CL-AUTO-PAY-SEQ NOT = ZERO
 11173
 11174
 11175* EXEC CICS UNLOCK
 11176*            DATASET   (ELMSTR-DSID)
 11177*       END-EXEC
 11178*    MOVE '&*                    #   #00010360' TO DFHEIV0
 11179     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11180     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11181     MOVE X'2020233030303130333630' TO DFHEIV0(25:11)
 11182     CALL 'kxdfhei1' USING DFHEIV0,
 11183           ELMSTR-DSID,
 11184           DFHEIV99
 11185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11186         MOVE ER-0523             TO EMI-ERROR
 11187         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11188         MOVE -1                  TO MAINTL
 11189         GO TO 8200-SEND-DATAONLY
 11190     END-IF.
 11191
 11192     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 11193
 11194     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 11195     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 11196     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 11197     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 11198     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 11199
 11200     IF MANRSVL GREATER ZERO
 11201        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 11202                                    AT-CURRENT-MANUAL-RESERVE
 11203     END-IF.
 11204     MOVE 1                      TO SUB.
 11205
 11206 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 214
* EL130.cbl
 11207     IF SUB = 1
 11208        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 11209        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 11210        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 11211     ELSE
 11212        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 11213        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 11214                                    AT-OPEN-CLOSE-REASON (SUB)
 11215     END-IF.
 11216
 11217     IF SUB NOT = 6
 11218        ADD 1                    TO SUB
 11219        GO TO 5010-LOOP
 11220     END-IF.
 11221
 11222 5020-UPDATE.
 11223
 11224     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11225
 11226     IF DIAGL = ZERO
 11227         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 11228         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 11229         GO TO 5025-BYPASS-UPDATE
 11230     END-IF.
 11231
 11232     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 11233
 11234     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 11235     MOVE DIAGI                  TO AT-INFO-LINE-1.
 11236
 11237     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11238
 11239 5025-BYPASS-UPDATE.
 11240
 11241
 11242
 11243* EXEC CICS GETMAIN
 11244*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11245*        LENGTH   (ELTRLR-LENGTH)
 11246*    END-EXEC.
 11247*    MOVE '," L                  $   #00010419' TO DFHEIV0
 11248     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 11249     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11250     MOVE X'2020233030303130343139' TO DFHEIV0(25:11)
 11251     CALL 'kxdfhei1' USING DFHEIV0,
 11252           DFHEIV20,
 11253           ELTRLR-LENGTH,
 11254           DFHEIV99
 11255     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11256         DFHEIV20
 11257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11258
 11259
 11260     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11261     MOVE 'AT'                   TO AT-RECORD-ID.
 11262
 11263     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11264     MOVE MSTR-CARRIER           TO AT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 215
* EL130.cbl
 11265     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11266     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 11267     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 11268     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 11269     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 11270     MOVE '9'                    TO AT-TRAILER-TYPE.
 11271     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11272     MOVE '5'                    TO DC-OPTION-CODE.
 11273     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11274     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 11275
 11276     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 11277     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11278
 11279     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 11280     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 11281     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 11282     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 11283     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 11284     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 11285     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 11286     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 11287     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 11288     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 11289
 11290     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 11291     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 11292     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 11293     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 11294     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 11295
 11296
 11297
 11298* EXEC CICS WRITE
 11299*        DATASET   (ELTRLR-DSID)
 11300*        FROM      (ACTIVITY-TRAILERS)
 11301*        RIDFLD    (AT-CONTROL-PRIMARY)
 11302*    END-EXEC.
 11303     MOVE LENGTH OF
 11304      ACTIVITY-TRAILERS
 11305       TO DFHEIV11
 11306*    MOVE '&$ L                  ''   #00010461' TO DFHEIV0
 11307     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11308     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11309     MOVE X'2020233030303130343631' TO DFHEIV0(25:11)
 11310     CALL 'kxdfhei1' USING DFHEIV0,
 11311           ELTRLR-DSID,
 11312           ACTIVITY-TRAILERS,
 11313           DFHEIV11,
 11314           AT-CONTROL-PRIMARY,
 11315           DFHEIV99,
 11316           DFHEIV99
 11317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11318
 11319
 11320     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 11321     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 11322     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 216
* EL130.cbl
 11323     MOVE CL-CERT-STATE          TO CERT-STATE.
 11324     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 11325     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 11326     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 11327
 11328
 11329
 11330* EXEC CICS HANDLE CONDITION
 11331*        NOTFND   (5050-CERT-NOT-FOUND)
 11332*    END-EXEC.
 11333*    MOVE '"$I                   ! ; #00010476' TO DFHEIV0
 11334     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11335     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11336     MOVE X'3B20233030303130343736' TO DFHEIV0(25:11)
 11337     CALL 'kxdfhei1' USING DFHEIV0
 11338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11339
 11340
 11341     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 11342
 11343     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 11344
 11345
 11346
 11347* EXEC CICS HANDLE CONDITION
 11348*         DUPKEY   (5030-CERT-WRITTEN)
 11349*    END-EXEC.
 11350*    MOVE '"$$                   ! < #00010485' TO DFHEIV0
 11351     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11352     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11353     MOVE X'3C20233030303130343835' TO DFHEIV0(25:11)
 11354     CALL 'kxdfhei1' USING DFHEIV0
 11355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11356
 11357
 11358
 11359
 11360* EXEC CICS REWRITE
 11361*        DATASET  (ELCERT-DSID)
 11362*        FROM     (CERTIFICATE-MASTER)
 11363*    END-EXEC.
 11364     MOVE LENGTH OF
 11365      CERTIFICATE-MASTER
 11366       TO DFHEIV11
 11367*    MOVE '&& L                  %   #00010490' TO DFHEIV0
 11368     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11369     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11370     MOVE X'2020233030303130343930' TO DFHEIV0(25:11)
 11371     CALL 'kxdfhei1' USING DFHEIV0,
 11372           ELCERT-DSID,
 11373           CERTIFICATE-MASTER,
 11374           DFHEIV11,
 11375           DFHEIV99
 11376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11377
 11378
 11379 5030-CERT-WRITTEN.
 11380
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 217
* EL130.cbl
 11381     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 11382                                    CL-INCURRED-DT
 11383                                    CL-REPORTED-DT
 11384                                    CL-EST-END-OF-DISAB-DT
 11385                                    CL-PAID-THRU-DT.
 11386
 11387     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 11388                                    CL-NO-OF-PMTS-MADE
 11389                                    CL-NO-OF-DAYS-PAID.
 11390
 11391     IF CLAIM-IS-CLOSED
 11392        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 11393        MOVE 'O'                 TO CL-CLAIM-STATUS
 11394     END-IF.
 11395
 11396     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 11397     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 11398     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11399
 11400
 11401
 11402* EXEC CICS HANDLE CONDITION
 11403*         DUPKEY   (5035-CLAIM-WRITTEN)
 11404*    END-EXEC.
 11405*    MOVE '"$$                   ! = #00010517' TO DFHEIV0
 11406     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11407     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11408     MOVE X'3D20233030303130353137' TO DFHEIV0(25:11)
 11409     CALL 'kxdfhei1' USING DFHEIV0
 11410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11411
 11412
 11413
 11414
 11415* EXEC CICS REWRITE
 11416*        DATASET   (ELMSTR-DSID)
 11417*        FROM      (CLAIM-MASTER)
 11418*    END-EXEC.
 11419     MOVE LENGTH OF
 11420      CLAIM-MASTER
 11421       TO DFHEIV11
 11422*    MOVE '&& L                  %   #00010522' TO DFHEIV0
 11423     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11424     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11425     MOVE X'2020233030303130353232' TO DFHEIV0(25:11)
 11426     CALL 'kxdfhei1' USING DFHEIV0,
 11427           ELMSTR-DSID,
 11428           CLAIM-MASTER,
 11429           DFHEIV11,
 11430           DFHEIV99
 11431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11432
 11433
 11434 5035-CLAIM-WRITTEN.
 11435
 11436     MOVE ER-0000                TO EMI-ERROR.
 11437     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11438
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 218
* EL130.cbl
 11439     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 11440     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 11441     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 11442     MOVE CLMCARRI               TO PI-LAST-CARR.
 11443
 11444     IF PRTOPTL GREATER ZERO
 11445         MOVE PRTOPTI            TO PI-PRT-OPT
 11446     END-IF.
 11447
 11448     IF ALTPRTL GREATER ZERO
 11449         MOVE ALTPRTI            TO PI-ALT-PRT
 11450     END-IF.
 11451
 11452     MOVE LOW-VALUES             TO EL130AI.
 11453
 11454     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 11455     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 11456     MOVE PI-LAST-CARR           TO CLMCARRO.
 11457     MOVE PI-LAST-CLAIM          TO CLMNOO.
 11458
 11459     IF PI-PRT-OPT = 'N' OR 'L'
 11460         MOVE PI-PRT-OPT         TO PRTOPTO
 11461         MOVE 1                  TO PRTOPTL
 11462     END-IF.
 11463
 11464     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 11465         MOVE PI-ALT-PRT         TO ALTPRTO
 11466         MOVE 4                  TO ALTPRTL
 11467     END-IF.
 11468
 11469     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 11470     MOVE AL-SANON               TO CERTNOA SUFXA.
 11471
 11472     MOVE SPACES                 TO PI-INCURR-SW.
 11473
 11474     IF PRTOPTL GREATER ZERO
 11475         IF PRTOPTI = 'L'
 11476             GO TO 0400-CREATE-ELACTQ
 11477         ELSE
 11478             GO TO 0480-PRINT-NOW
 11479         END-IF
 11480     END-IF.
 11481
 11482     GO TO 8100-SEND-INITIAL-MAP.
 11483
 11484 5050-CERT-NOT-FOUND.
 11485
 11486     MOVE ER-0244                TO EMI-ERROR.
 11487     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11488     MOVE -1                     TO CERTNOL.
 11489     GO TO 8200-SEND-DATAONLY.
 11490
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 219
* EL130.cbl
 11492 5500-BUILD-FORM-TRAILER.
 11493*************************************************************
 11494*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 11495*************************************************************
 11496
 11497     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 11498
 11499     IF  WS-BEN-ALPHA-2 = '30'
 11500         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 11501         MOVE '6'                TO DC-OPTION-CODE
 11502         IF CL-CARRIER = 'C'
 11503             MOVE +14            TO DC-ELAPSED-DAYS
 11504             MOVE +0             TO DC-ELAPSED-MONTHS
 11505             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11506             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 11507         ELSE
 11508             MOVE +21            TO DC-ELAPSED-DAYS
 11509             MOVE +0             TO DC-ELAPSED-MONTHS
 11510             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11511             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 11512         END-IF
 11513     END-IF.
 11514
 11515
 11516
 11517* EXEC CICS GETMAIN
 11518*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11519*         LENGTH   (ELTRLR-LENGTH)
 11520*         INITIMG  (GETMAIN-SPACE)
 11521*    END-EXEC.
 11522*    MOVE ',"IL                  $   #00010609' TO DFHEIV0
 11523     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11524     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11525     MOVE X'2020233030303130363039' TO DFHEIV0(25:11)
 11526     CALL 'kxdfhei1' USING DFHEIV0,
 11527           DFHEIV20,
 11528           ELTRLR-LENGTH,
 11529           GETMAIN-SPACE
 11530     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11531         DFHEIV20
 11532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11533
 11534
 11535     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 11536     MOVE 'AT'                   TO AT-RECORD-ID.
 11537
 11538     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 11539     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 11540     MOVE 'A'                    TO AT-TRAILER-TYPE.
 11541     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 11542                                    AT-FORM-LAST-MAINT-DT.
 11543     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11544                                    AT-FORM-LAST-UPDATED-BY.
 11545     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11546     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 11547     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 11548                                    AT-FORM-RE-SEND-DT
 11549                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 220
* EL130.cbl
 11550                                    AT-EMP-FORM-ANSWERED-DT
 11551                                    AT-PHY-FORM-ANSWERED-DT
 11552                                    AT-EMP-FORM-SEND-ON-DT
 11553                                    AT-FORM-PRINTED-DT
 11554                                    AT-FORM-REPRINT-DT.
 11555     MOVE '1'                    TO AT-FORM-TYPE.
 11556
 11557     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 11558                                    AT-INSTRUCT-LN-2
 11559                                    AT-INSTRUCT-LN-3.
 11560
 11561     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 11562     MOVE 'I'                    TO AT-FORM-ADDRESS.
 11563
 11564     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 11565
 11566     IF AM-EMPLOYER-STMT-USED = 'Y'
 11567        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 11568     END-IF.
 11569
 11570
 11571
 11572* EXEC CICS WRITE
 11573*         DATASET  (ELTRLR-DSID)
 11574*         FROM     (ACTIVITY-TRAILERS)
 11575*         RIDFLD   (AT-CONTROL-PRIMARY)
 11576*    END-EXEC.
 11577     MOVE LENGTH OF
 11578      ACTIVITY-TRAILERS
 11579       TO DFHEIV11
 11580*    MOVE '&$ L                  ''   #00010651' TO DFHEIV0
 11581     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11582     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11583     MOVE X'2020233030303130363531' TO DFHEIV0(25:11)
 11584     CALL 'kxdfhei1' USING DFHEIV0,
 11585           ELTRLR-DSID,
 11586           ACTIVITY-TRAILERS,
 11587           DFHEIV11,
 11588           AT-CONTROL-PRIMARY,
 11589           DFHEIV99,
 11590           DFHEIV99
 11591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11592
 11593
 11594 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 221
* EL130.cbl
 11596*************************************************************
 11597*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 11598*************************************************************
 11599
 11600 5700-BUILD-ARCHIVE-HEADER.
 11601
 11602     MOVE '1'                    TO CNTL-REC-TYPE.
 11603     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11604     MOVE SPACES                 TO CNTL-ACCESS.
 11605
 11606
 11607
 11608* EXEC CICS READ
 11609*         DATASET  (ELCNTL-DSID)
 11610*         SET      (ADDRESS OF CONTROL-FILE)
 11611*         RIDFLD   (ELCNTL-KEY)
 11612*         UPDATE
 11613*    END-EXEC.
 11614*    MOVE '&"S        EU         (   #00010670' TO DFHEIV0
 11615     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11616     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11617     MOVE X'2020233030303130363730' TO DFHEIV0(25:11)
 11618     CALL 'kxdfhei1' USING DFHEIV0,
 11619           ELCNTL-DSID,
 11620           DFHEIV20,
 11621           DFHEIV99,
 11622           ELCNTL-KEY,
 11623           DFHEIV99,
 11624           DFHEIV99,
 11625           DFHEIV99
 11626     SET ADDRESS OF CONTROL-FILE TO
 11627         DFHEIV20
 11628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11629
 11630
 11631     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 11632
 11633     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 11634
 11635
 11636
 11637* EXEC CICS REWRITE
 11638*         FROM     (CONTROL-FILE)
 11639*         DATASET  (ELCNTL-DSID)
 11640*    END-EXEC.
 11641     MOVE LENGTH OF
 11642      CONTROL-FILE
 11643       TO DFHEIV11
 11644*    MOVE '&& L                  %   #00010682' TO DFHEIV0
 11645     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11646     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11647     MOVE X'2020233030303130363832' TO DFHEIV0(25:11)
 11648     CALL 'kxdfhei1' USING DFHEIV0,
 11649           ELCNTL-DSID,
 11650           CONTROL-FILE,
 11651           DFHEIV11,
 11652           DFHEIV99
 11653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 222
* EL130.cbl
 11654
 11655
 11656
 11657
 11658* EXEC CICS HANDLE CONDITION
 11659*         NOTOPEN  (9990-ABEND)
 11660*         DUPKEY   (5799-EXIT)
 11661*    END-EXEC.
 11662*    MOVE '"$J$                  ! > #00010688' TO DFHEIV0
 11663     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 11664     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11665     MOVE X'3E20233030303130363838' TO DFHEIV0(25:11)
 11666     CALL 'kxdfhei1' USING DFHEIV0
 11667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11668
 11669
 11670
 11671
 11672* EXEC CICS GETMAIN
 11673*         SET     (ADDRESS OF LETTER-ARCHIVE)
 11674*         LENGTH  (ELARCH-LENGTH)
 11675*    END-EXEC.
 11676*    MOVE '," L                  $   #00010694' TO DFHEIV0
 11677     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 11678     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11679     MOVE X'2020233030303130363934' TO DFHEIV0(25:11)
 11680     CALL 'kxdfhei1' USING DFHEIV0,
 11681           DFHEIV20,
 11682           ELARCH-LENGTH,
 11683           DFHEIV99
 11684     SET ADDRESS OF LETTER-ARCHIVE TO
 11685         DFHEIV20
 11686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11687
 11688
 11689     MOVE SPACES                 TO LETTER-ARCHIVE.
 11690     MOVE 'LA'                   TO LA-RECORD-ID.
 11691     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 11692                                    LA-ARCHIVE-NO-A1.
 11693     MOVE '4'                    TO LA-RECORD-TYPE
 11694                                    LA-RECORD-TYPE-A1.
 11695     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 11696                                    LA-LINE-SEQ-NO-A1.
 11697     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 11698                                    LA-COMPANY-CD-A1.
 11699     MOVE CL-CARRIER             TO LA4-CARRIER.
 11700     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 11701     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 11702     MOVE CL-CERT-STATE          TO LA4-STATE.
 11703     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 11704     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 11705     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 11706     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 11707                                    LA4-RESEND-PRINT-DATE
 11708                                    LA4-FORM-REM-PRINT-DT
 11709                                    LA4-RESEND-DATE.
 11710     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 11711     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 223
* EL130.cbl
 11712
 11713
 11714
 11715* EXEC CICS WRITE
 11716*         DATASET  (ELARCH-DSID)
 11717*         FROM     (LETTER-ARCHIVE)
 11718*         RIDFLD   (LA-CONTROL-PRIMARY)
 11719*    END-EXEC.
 11720     MOVE LENGTH OF
 11721      LETTER-ARCHIVE
 11722       TO DFHEIV11
 11723*    MOVE '&$ L                  ''   #00010724' TO DFHEIV0
 11724     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11725     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11726     MOVE X'2020233030303130373234' TO DFHEIV0(25:11)
 11727     CALL 'kxdfhei1' USING DFHEIV0,
 11728           ELARCH-DSID,
 11729           LETTER-ARCHIVE,
 11730           DFHEIV11,
 11731           LA-CONTROL-PRIMARY,
 11732           DFHEIV99,
 11733           DFHEIV99
 11734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11735
 11736
 11737 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 224
* EL130.cbl
 11739 6000-EDIT-CLAIM-DATA.
 11740
 11741     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 11742     MOVE '2'                    TO DC-OPTION-CODE.
 11743     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11744     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 11745
 11746     IF CLMNOL GREATER ZERO
 11747         IF CLMNOI = SPACES OR LOW-VALUES
 11748             MOVE -1             TO CLMNOL
 11749             MOVE AL-UABON       TO CLMNOA
 11750             MOVE ER-7688        TO EMI-ERROR
 11751             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11752         ELSE
 11753             MOVE AL-UANON       TO CLMNOA
 11754         END-IF
 11755     END-IF.
 11756
 11757     IF CERTNOL = ZERO
 11758         MOVE -1                 TO CERTNOL
 11759         MOVE AL-SABON           TO CERTNOA
 11760         MOVE ER-0203            TO EMI-ERROR
 11761         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11762     ELSE
 11763         MOVE AL-SANON           TO CERTNOA
 11764     END-IF.
 11765
 11766     IF SUFXL = ZERO
 11767         MOVE SPACES             TO SUFXI
 11768         MOVE AL-SANON           TO SUFXA
 11769     ELSE
 11770         MOVE AL-SANON           TO SUFXA
 11771     END-IF.
 11772
 11773     IF CLMCARRL = ZERO
 11774         MOVE -1                 TO CLMCARRL
 11775         MOVE ER-0194            TO EMI-ERROR
 11776         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11777     ELSE
 11778         MOVE CLMCARRI           TO PI-CARRIER
 11779         IF PI-NO-CARRIER-SECURITY
 11780             MOVE AL-UANON       TO CLMCARRA
 11781         END-IF
 11782     END-IF.
 11783
 11784     IF CLMTYPEL > ZERO
 11785        IF ((PI-COMPANY-ID = 'DCC')
 11786           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 11787              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G'))
 11788                        OR
 11789           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 11790           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 11791              AND PI-AH-OVERRIDE-L1))
 11792              MOVE -1             TO CLMTYPEL
 11793              MOVE AL-UABON       TO CLMTYPEA
 11794              MOVE ER-7634        TO EMI-ERROR
 11795              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11796        ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 225
* EL130.cbl
 11797           MOVE AL-UANON       TO CLMTYPEA
 11798        END-IF
 11799     ELSE
 11800        IF MAINTI = 'A'
 11801           MOVE -1             TO CLMTYPEL
 11802           MOVE AL-UABON       TO CLMTYPEA
 11803           MOVE ER-0546        TO EMI-ERROR
 11804           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11805        END-IF
 11806     END-IF
 11807
 11808     IF PCERTNOL = ZERO
 11809        MOVE CERTNOI             TO PCERTNOI
 11810        MOVE CERTNOL             TO PCERTNOL
 11811        MOVE AL-UANON            TO PCERTNOA
 11812     ELSE
 11813        MOVE AL-UANON            TO PCERTNOA
 11814     END-IF.
 11815
 11816     IF PSUFXL = ZERO
 11817        MOVE SUFXI               TO PSUFXI
 11818        MOVE SUFXL               TO PSUFXL
 11819        MOVE AL-UANON            TO PSUFXA
 11820     ELSE
 11821        MOVE AL-UANON            TO PSUFXA
 11822     END-IF.
 11823
 11824     IF MAINTI = 'I'
 11825         GO TO 6020-EDIT
 11826     END-IF.
 11827
 11828     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 11829         MOVE -1                 TO LSTNMEL
 11830         MOVE ER-0236            TO EMI-ERROR
 11831         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11832     ELSE
 11833         MOVE AL-UANON           TO LSTNMEA
 11834     END-IF.
 11835     IF SEXL > ZEROS
 11836        IF SEXI = 'M' OR 'F'
 11837           CONTINUE
 11838        ELSE
 11839           MOVE -1               TO SEXL
 11840           MOVE AL-UABON         TO SEXA
 11841           MOVE ER-0219          TO EMI-ERROR
 11842           PERFORM 9900-ERROR-FORMAT
 11843                                 THRU 9900-EXIT
 11844        END-IF
 11845     ELSE
 11846        IF MAINTI = 'A'
 11847           MOVE -1               TO SEXL
 11848           MOVE AL-UABON         TO SEXA
 11849           MOVE ER-0219          TO EMI-ERROR
 11850           PERFORM 9900-ERROR-FORMAT
 11851                                 THRU 9900-EXIT
 11852        END-IF
 11853     END-IF
 11854*    IF SEXI NOT = 'M' AND 'F'
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 226
* EL130.cbl
 11855*        MOVE -1                 TO SEXL
 11856*        MOVE AL-UABON           TO SEXA
 11857*        MOVE ER-0219            TO EMI-ERROR
 11858*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11859*    ELSE
 11860*        MOVE AL-UANON           TO SEXA
 11861*    END-IF.
 11862
 11863     IF SSNL GREATER THAN ZERO
 11864         MOVE SSNI TO WS-SOC-SEC-NUMBER
 11865         IF WS-SOC-SEC-NO NUMERIC AND
 11866           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 11867             NEXT SENTENCE
 11868         ELSE
 11869            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 11870               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 11871               WS-SSN-DASH2 = '-'
 11872                 NEXT SENTENCE
 11873            ELSE
 11874                 MOVE ER-0887        TO  EMI-ERROR
 11875                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11876                 MOVE AL-UABON       TO  SSNA
 11877                 MOVE -1             TO  SSNL
 11878            END-IF
 11879        END-IF
 11880     END-IF.
 11881
 11882     IF BIRTHDTL = ZERO
 11883         GO TO 6020-EDIT
 11884     END-IF.
 11885
 11886     IF BIRTHDTL GREATER ZERO
 11887         MOVE BIRTHDTI           TO DATE-WORK
 11888         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11889         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11890         MOVE '4'                TO DC-OPTION-CODE
 11891         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11892         IF DATE-CONVERSION-ERROR
 11893             MOVE AL-UABON       TO BIRTHDTA
 11894             MOVE -1             TO BIRTHDTL
 11895             MOVE ER-0220        TO EMI-ERROR
 11896             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11897             GO TO 6020-EDIT
 11898         END-IF
 11899     END-IF.
 11900
 11901******************************************************************
 11902**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 11903**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 11904**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 11905******************************************************************
 11906
 11907     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 11908         MOVE BIRTHDTI           TO  DATE-WORK
 11909         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11910         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 11911         MOVE '4'                TO  DC-OPTION-CODE
 11912         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 227
* EL130.cbl
 11913         MOVE +0                 TO  DC-ELAPSED-MONTHS
 11914                                     DC-ELAPSED-DAYS
 11915         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11916         IF DATE-CONVERSION-ERROR
 11917             MOVE AL-UABON       TO  BIRTHDTA
 11918             MOVE -1             TO  BIRTHDTL
 11919             MOVE ER-0220        TO  EMI-ERROR
 11920             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11921             GO TO 6020-EDIT
 11922         END-IF
 11923     END-IF.
 11924
 11925     MOVE AL-UANON               TO  BIRTHDTA.
 11926     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 11927     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 11928     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 11929
 11930 6020-EDIT.
 11931     IF INCURL GREATER ZERO
 11932         MOVE INCURI             TO DATE-WORK
 11933         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11934         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11935         MOVE '4'                TO DC-OPTION-CODE
 11936         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11937         IF DATE-CONVERSION-ERROR
 11938             MOVE AL-UABON       TO INCURA
 11939             MOVE -1             TO INCURL
 11940             MOVE ER-0222        TO EMI-ERROR
 11941             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11942         ELSE
 11943             MOVE AL-UANON       TO INCURA
 11944             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 11945             MOVE DC-BIN-DATE-1  TO WS-INCUR
 11946                                    PI-SAVE-INCUR-DT
 11947             IF WS-INCUR GREATER THAN WS-TODAY-DT
 11948                 MOVE ER-0511     TO EMI-ERROR
 11949                 MOVE -1          TO INCURL
 11950                 MOVE AL-UABON    TO INCURA
 11951                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11952             ELSE
 11953*                NEXT SENTENCE
 11954                 CONTINUE
 11955             END-IF
 11956         END-IF
 11957     ELSE
 11958         MOVE ER-0516         TO EMI-ERROR
 11959         MOVE AL-UABON        TO INCURA
 11960         MOVE -1              TO INCURL
 11961         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11962     END-IF.
 11963
 11964     IF REPORTL GREATER ZERO
 11965         MOVE REPORTI            TO DATE-WORK
 11966         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11967         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11968         MOVE '4'                TO DC-OPTION-CODE
 11969         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11970         IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 228
* EL130.cbl
 11971             MOVE AL-UABON       TO REPORTA
 11972             MOVE -1             TO REPORTL
 11973             MOVE ER-0223        TO EMI-ERROR
 11974             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11975         ELSE
 11976             MOVE AL-UANON       TO REPORTA
 11977             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 11978             MOVE DC-BIN-DATE-1  TO WS-REPORT
 11979             IF WS-REPORT GREATER THAN WS-TODAY-DT
 11980                 MOVE ER-0512     TO EMI-ERROR
 11981                 MOVE -1          TO REPORTL
 11982                 MOVE AL-UABON    TO REPORTA
 11983                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11984             ELSE
 11985*                NEXT SENTENCE
 11986                 CONTINUE
 11987             END-IF
 11988         END-IF
 11989     ELSE
 11990         MOVE ER-0517         TO EMI-ERROR
 11991         MOVE -1              TO REPORTL
 11992         MOVE AL-UABON        TO REPORTA
 11993         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11994     END-IF.
 11995
 11996     IF WS-REPORT NOT = LOW-VALUES
 11997         IF WS-INCUR GREATER THAN WS-REPORT
 11998             MOVE AL-UABON       TO REPORTA
 11999             MOVE -1             TO REPORTL
 12000             MOVE ER-0509        TO EMI-ERROR
 12001             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12002         END-IF
 12003     END-IF.
 12004
 12005     IF ESTENDL GREATER ZERO
 12006         MOVE ESTENDI            TO DATE-WORK
 12007         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12008         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12009         MOVE '4'                TO DC-OPTION-CODE
 12010         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12011         IF DATE-CONVERSION-ERROR
 12012             MOVE AL-UABON       TO ESTENDA
 12013             MOVE -1             TO ESTENDL
 12014             MOVE ER-0224        TO EMI-ERROR
 12015             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12016         ELSE
 12017             MOVE AL-UANON       TO ESTENDA
 12018             MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 12019             MOVE DC-BIN-DATE-1  TO WS-ESTEND
 12020             IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 12021                MOVE AL-UABON    TO ESTENDA
 12022                MOVE -1          TO ESTENDL
 12023                MOVE ER-0544     TO EMI-ERROR
 12024                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12025             END-IF
 12026         END-IF
 12027     END-IF.
 12028
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 229
* EL130.cbl
 12029     IF WS-ESTEND NOT = LOW-VALUES
 12030         IF WS-INCUR GREATER THAN WS-ESTEND
 12031             MOVE AL-UABON       TO ESTENDA
 12032             MOVE -1             TO ESTENDL
 12033             MOVE ER-0510        TO EMI-ERROR
 12034             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12035         END-IF
 12036     END-IF.
 12037
 12038     IF PRTOPTL GREATER ZERO
 12039         IF PRTOPTI NOT = 'N' AND 'L'
 12040             MOVE AL-UABON       TO PRTOPTA
 12041             MOVE -1             TO PRTOPTL
 12042             MOVE ER-0334        TO EMI-ERROR
 12043             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12044         END-IF
 12045     END-IF.
 12046
 12047     IF MANRSVL GREATER ZERO
 12048
 12049* EXEC CICS BIF DEEDIT
 12050*            FIELD   (MANRSVI)
 12051*            LENGTH  (9)
 12052*        END-EXEC
 12053     MOVE 9
 12054       TO DFHEIV11
 12055*    MOVE '@"L                   #   #00011041' TO DFHEIV0
 12056     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12057     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12058     MOVE X'2020233030303131303431' TO DFHEIV0(25:11)
 12059     CALL 'kxdfhei1' USING DFHEIV0,
 12060           MANRSVI,
 12061           DFHEIV11
 12062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12063         IF MANRSVI NOT NUMERIC
 12064             MOVE AL-UNBON       TO MANRSVA
 12065             MOVE -1             TO MANRSVL
 12066             MOVE ER-0489        TO EMI-ERROR
 12067             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12068         ELSE
 12069             MOVE AL-UNNON       TO MANRSVA
 12070             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 12071         END-IF
 12072     END-IF.
 12073
 12074     MOVE SPACES                 TO ELCNTL-KEY.
 12075
 12076     IF CONTROL-IS-ACTUAL-CARRIER
 12077         MOVE PI-CARRIER         TO CNTL-CARRIER
 12078     ELSE
 12079         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 12080     END-IF.
 12081
 12082     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12083     MOVE '6'                    TO CNTL-REC-TYPE.
 12084     MOVE +0                     TO CNTL-SEQ-NO.
 12085
 12086
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 230
* EL130.cbl
 12087
 12088* EXEC CICS HANDLE CONDITION
 12089*        NOTFND   (3100-CARRIER-NOT-FOUND)
 12090*    END-EXEC.
 12091*    MOVE '"$I                   ! ? #00011069' TO DFHEIV0
 12092     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12093     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12094     MOVE X'3F20233030303131303639' TO DFHEIV0(25:11)
 12095     CALL 'kxdfhei1' USING DFHEIV0
 12096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12097
 12098
 12099     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12100
 12101     IF NOT CF-MANUAL-RESERVES-USED AND
 12102           WS-MANRSV GREATER ZERO
 12103         MOVE ER-0518             TO EMI-ERROR
 12104         MOVE -1                  TO MANRSVL
 12105         MOVE AL-UNBON            TO MANRSVA
 12106         MOVE ZEROS               TO WS-MANRSV
 12107         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12108     END-IF.
 12109
 12110     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 12111     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
 12112
 12113     IF SUPVL GREATER ZERO
 12114         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 12115             MOVE -1             TO SUPVL
 12116             MOVE AL-UABON       TO SUPVA
 12117             MOVE ER-0230        TO EMI-ERROR
 12118             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12119         ELSE
 12120             MOVE AL-UANON       TO SUPVA
 12121         END-IF
 12122     END-IF.
 12123
 12124     IF PROCCDL = ZERO
 12125        GO TO 6050-CONTINUE-EDITS
 12126     END-IF.
 12127
 12128     MOVE SPACES                 TO ELCNTL-KEY.
 12129     MOVE PROCCDI                TO CNTL-ACCESS.
 12130
 12131     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12132     MOVE '2'                    TO CNTL-REC-TYPE.
 12133     MOVE +0                     TO CNTL-SEQ-NO.
 12134
 12135
 12136
 12137* EXEC CICS HANDLE CONDITION
 12138*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 12139*    END-EXEC.
 12140*    MOVE '"$I                   ! @ #00011110' TO DFHEIV0
 12141     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12142     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12143     MOVE X'4020233030303131313130' TO DFHEIV0(25:11)
 12144     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 231
* EL130.cbl
 12145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12146
 12147
 12148     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12149
 12150     GO TO 6050-CONTINUE-EDITS.
 12151
 12152 6040-NO-PROCESSOR-RECORD.
 12153     MOVE ER-0019                TO EMI-ERROR.
 12154     MOVE -1                     TO PROCCDL.
 12155     MOVE AL-UABON               TO PROCCDA.
 12156     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12157
 12158 6050-CONTINUE-EDITS.
 12159     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 12160           GO TO 6070-CONTINUE-EDITS
 12161     END-IF.
 12162
 12163     MOVE BENECDI                TO BENE-CODE.
 12164     MOVE 'B'                    TO BENE-RCD-TYPE.
 12165     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 12166
 12167
 12168
 12169* EXEC CICS HANDLE CONDITION
 12170*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 12171*    END-EXEC.
 12172*    MOVE '"$I                   ! A #00011134' TO DFHEIV0
 12173     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12174     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12175     MOVE X'4120233030303131313334' TO DFHEIV0(25:11)
 12176     CALL 'kxdfhei1' USING DFHEIV0
 12177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12178
 12179
 12180
 12181* EXEC CICS READ
 12182*         DATASET   (ELBENE-DSID)
 12183*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 12184*         RIDFLD    (ELBENE-KEY)
 12185*    END-EXEC.
 12186*    MOVE '&"S        E          (   #00011138' TO DFHEIV0
 12187     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12188     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12189     MOVE X'2020233030303131313338' TO DFHEIV0(25:11)
 12190     CALL 'kxdfhei1' USING DFHEIV0,
 12191           ELBENE-DSID,
 12192           DFHEIV20,
 12193           DFHEIV99,
 12194           ELBENE-KEY,
 12195           DFHEIV99,
 12196           DFHEIV99,
 12197           DFHEIV99
 12198     SET ADDRESS OF BENEFICIARY-MASTER TO
 12199         DFHEIV20
 12200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12201
 12202
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 232
* EL130.cbl
 12203     GO TO 6070-CONTINUE-EDITS.
 12204
 12205 6060-NO-BENEFICIARY-RECORD.
 12206     MOVE ER-0565                TO EMI-ERROR.
 12207     MOVE -1                     TO BENECDL.
 12208     MOVE AL-UABON               TO BENECDA.
 12209     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12210
 12211
 12212 6070-CONTINUE-EDITS.
 12213     IF CERTMTL GREATER ZERO
 12214         IF CERTMTI NOT = 'A' AND 'S'
 12215             MOVE -1             TO CERTMTL
 12216             MOVE AL-UABON       TO CERTMTA
 12217             MOVE ER-0267        TO EMI-ERROR
 12218             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12219         ELSE
 12220             MOVE AL-UANON       TO CERTMTA
 12221         END-IF
 12222     ELSE
 12223         GO TO 6000-EXIT
 12224     END-IF.
 12225
 12226     IF EFFDTL GREATER ZERO
 12227         MOVE EFFDTI             TO DATE-WORK
 12228         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12229         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12230         MOVE '4'                TO DC-OPTION-CODE
 12231         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12232         IF DATE-CONVERSION-ERROR
 12233             MOVE AL-UABON       TO EFFDTA
 12234             MOVE -1             TO EFFDTL
 12235             MOVE ER-0231        TO EMI-ERROR
 12236             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12237         ELSE
 12238             MOVE AL-UANON       TO EFFDTA
 12239             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 12240             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 12241         END-IF
 12242     ELSE
 12243         MOVE ER-0231            TO EMI-ERROR
 12244         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12245         MOVE -1                 TO EFFDTL
 12246         MOVE AL-UABON           TO EFFDTA
 12247     END-IF.
 12248
 12249     IF ACCOUNTL = ZERO
 12250         MOVE ER-0232            TO EMI-ERROR
 12251         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12252         MOVE AL-UABON           TO ACCOUNTA
 12253         MOVE -1                 TO ACCOUNTL
 12254     ELSE
 12255         MOVE AL-UANON           TO ACCOUNTA
 12256     END-IF.
 12257
 12258     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 12259        (STATEL = ZERO)
 12260         MOVE ER-0233        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 233
* EL130.cbl
 12261         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12262         MOVE AL-UABON       TO STATEA
 12263         MOVE -1             TO STATEL
 12264     ELSE
 12265         MOVE AL-UANON       TO STATEA
 12266     END-IF.
 12267
 12268     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 12269        (CRTCARRL = ZERO)
 12270         MOVE ER-0234        TO EMI-ERROR
 12271         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12272         MOVE AL-UABON       TO CRTCARRA
 12273         MOVE -1             TO CRTCARRL
 12274     ELSE
 12275         MOVE AL-UANON       TO CRTCARRA
 12276     END-IF.
 12277
 12278     IF PI-CERT-ACCESS-CONTROL = '1' AND
 12279        GROUPL = ZERO
 12280         MOVE ER-0235            TO EMI-ERROR
 12281         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12282         MOVE AL-UABON           TO GROUPA
 12283         MOVE -1                 TO GROUPL
 12284     ELSE
 12285         MOVE AL-UANON           TO GROUPA
 12286     END-IF.
 12287
 12288     IF CRTLNMEL = ZERO
 12289         IF LSTNMEI = SPACES OR LOW-VALUES
 12290             MOVE ER-0236            TO  EMI-ERROR
 12291             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12292             MOVE AL-UABON           TO  CRTLNMEA
 12293             MOVE -1                 TO  CRTLNMEL
 12294         ELSE
 12295             MOVE LSTNMEI            TO  CRTLNMEI
 12296             MOVE AL-UANON           TO  CRTLNMEA
 12297         END-IF
 12298     ELSE
 12299         MOVE AL-UANON               TO  CRTLNMEA
 12300     END-IF.
 12301
 12302     IF CRTFNMEL = ZERO
 12303         IF FSTNMEI = SPACES OR LOW-VALUES
 12304*            NEXT SENTENCE
 12305             CONTINUE
 12306         ELSE
 12307             MOVE FSTNMEI            TO  CRTFNMEI
 12308             MOVE AL-UANON           TO  CRTFNMEA
 12309         END-IF
 12310     END-IF.
 12311
 12312     IF CRTINITL = ZERO
 12313         IF INITI = SPACES OR LOW-VALUES
 12314*            NEXT SENTENCE
 12315             CONTINUE
 12316         ELSE
 12317             MOVE INITI              TO  CRTINITI
 12318             MOVE AL-UANON           TO  CRTINITA
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 234
* EL130.cbl
 12319         END-IF
 12320     END-IF.
 12321
 12322 6000-EXIT.
 12323     EXIT.
 12324
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 235
* EL130.cbl
 12326 6200-EDIT-CERT-DATA.
 12327     IF ISSAGEL GREATER ZERO
 12328         IF ISSAGEI NOT NUMERIC
 12329             MOVE ER-0237        TO EMI-ERROR
 12330             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12331             MOVE -1             TO ISSAGEL
 12332             MOVE AL-UNBON       TO ISSAGEA
 12333         ELSE
 12334             MOVE AL-UNNON       TO ISSAGEA
 12335         END-IF
 12336     END-IF.
 12337
 12338     IF JNTAGEL GREATER ZERO
 12339         IF JNTAGEI NOT NUMERIC
 12340             MOVE ER-0238        TO EMI-ERROR
 12341             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12342             MOVE -1             TO JNTAGEL
 12343             MOVE AL-UNBON       TO JNTAGEA
 12344         ELSE
 12345             MOVE AL-UNNON       TO JNTAGEA
 12346         END-IF
 12347     END-IF.
 12348
 12349     IF LCVCDL GREATER ZERO
 12350         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 12351         IF INVALID-BENEFIT-CODE
 12352             MOVE ER-7635        TO EMI-ERROR
 12353             MOVE -1             TO LCVCDL
 12354             MOVE AL-UABON       TO LCVCDA
 12355             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12356         ELSE
 12357             MOVE LCVCDI         TO WS-BEN-HOLD
 12358             MOVE '4'            TO WS-REC-TYPE
 12359             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 12360             IF WS-BEN-ALPHA-HOLD = SPACES
 12361                MOVE ER-7635     TO EMI-ERROR
 12362                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12363                MOVE -1          TO LCVCDL
 12364                MOVE AL-UABON    TO LCVCDA
 12365             ELSE
 12366                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 12367                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 12368                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 12369                MOVE AL-UANON           TO LCVCDA
 12370             END-IF
 12371         END-IF
 12372     END-IF.
 12373
 12374     IF ACVCDL GREATER ZERO
 12375         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 12376         IF INVALID-BENEFIT-CODE
 12377             MOVE ER-7635        TO EMI-ERROR
 12378             MOVE -1             TO ACVCDL
 12379             MOVE AL-UABON       TO ACVCDA
 12380             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12381         ELSE
 12382             MOVE ACVCDI         TO WS-BEN-HOLD
 12383             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 236
* EL130.cbl
 12384             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 12385             IF WS-BEN-ALPHA-HOLD = SPACES
 12386                MOVE ER-7635     TO EMI-ERROR
 12387                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12388                MOVE -1          TO ACVCDL
 12389                MOVE AL-UABON    TO ACVCDA
 12390             ELSE
 12391                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 12392                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 12393                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 12394                MOVE AL-UANON           TO ACVCDA
 12395             END-IF
 12396         END-IF
 12397     END-IF.
 12398
 12399     IF LCVOTRML GREATER ZERO
 12400         IF LCVOTRMI NOT NUMERIC
 12401             MOVE ER-7636        TO EMI-ERROR
 12402             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12403             MOVE -1             TO LCVOTRML
 12404             MOVE AL-UNBON       TO LCVOTRMA
 12405         ELSE
 12406             MOVE AL-UNNON       TO LCVOTRMA
 12407         END-IF
 12408     END-IF.
 12409
 12410     IF ACVOTRML GREATER ZERO
 12411         IF ACVOTRMI NOT NUMERIC
 12412             MOVE ER-7636        TO EMI-ERROR
 12413             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12414             MOVE -1             TO ACVOTRML
 12415             MOVE AL-UNBON       TO ACVOTRMA
 12416         ELSE
 12417             MOVE AL-UNNON       TO ACVOTRMA
 12418         END-IF
 12419     END-IF.
 12420
 12421     IF LCVRATEL GREATER ZERO
 12422
 12423* EXEC CICS BIF DEEDIT
 12424*            FIELD    (LCVRATEI)
 12425*            LENGTH   (06)
 12426*        END-EXEC
 12427     MOVE 06
 12428       TO DFHEIV11
 12429*    MOVE '@"L                   #   #00011363' TO DFHEIV0
 12430     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12431     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12432     MOVE X'2020233030303131333633' TO DFHEIV0(25:11)
 12433     CALL 'kxdfhei1' USING DFHEIV0,
 12434           LCVRATEI,
 12435           DFHEIV11
 12436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12437         IF LCVRATEI NOT NUMERIC
 12438             MOVE AL-UNBON       TO LCVRATEA
 12439             MOVE -1             TO LCVRATEL
 12440             MOVE ER-2280        TO EMI-ERROR
 12441             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 237
* EL130.cbl
 12442         ELSE
 12443             MOVE AL-UNNON       TO LCVRATEA
 12444             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 12445         END-IF
 12446     END-IF.
 12447
 12448     IF ACVRATEL GREATER ZERO
 12449
 12450* EXEC CICS BIF DEEDIT
 12451*            FIELD    (ACVRATEI)
 12452*            LENGTH   (06)
 12453*        END-EXEC
 12454     MOVE 06
 12455       TO DFHEIV11
 12456*    MOVE '@"L                   #   #00011379' TO DFHEIV0
 12457     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12458     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12459     MOVE X'2020233030303131333739' TO DFHEIV0(25:11)
 12460     CALL 'kxdfhei1' USING DFHEIV0,
 12461           ACVRATEI,
 12462           DFHEIV11
 12463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12464         IF ACVRATEI NOT NUMERIC
 12465             MOVE AL-UNBON       TO ACVRATEA
 12466             MOVE -1             TO ACVRATEL
 12467             MOVE ER-2280        TO EMI-ERROR
 12468             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12469         ELSE
 12470             MOVE AL-UNNON       TO ACVRATEA
 12471             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 12472         END-IF
 12473     END-IF.
 12474
 12475     IF LCVBENEL GREATER ZERO
 12476
 12477* EXEC CICS BIF DEEDIT
 12478*            FIELD    (LCVBENEI)
 12479*            LENGTH   (11)
 12480*        END-EXEC
 12481     MOVE 11
 12482       TO DFHEIV11
 12483*    MOVE '@"L                   #   #00011395' TO DFHEIV0
 12484     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12485     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12486     MOVE X'2020233030303131333935' TO DFHEIV0(25:11)
 12487     CALL 'kxdfhei1' USING DFHEIV0,
 12488           LCVBENEI,
 12489           DFHEIV11
 12490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12491         IF LCVBENEI NOT NUMERIC
 12492             MOVE AL-UNBON       TO LCVBENEA
 12493             MOVE -1             TO LCVBENEL
 12494             MOVE ER-7637        TO EMI-ERROR
 12495             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12496         ELSE
 12497             MOVE AL-UNNON       TO LCVBENEA
 12498             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 12499         END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 238
* EL130.cbl
 12500     END-IF.
 12501
 12502     IF ACVBENEL GREATER ZERO
 12503
 12504* EXEC CICS BIF DEEDIT
 12505*            FIELD    (ACVBENEI)
 12506*            LENGTH   (11)
 12507*        END-EXEC
 12508     MOVE 11
 12509       TO DFHEIV11
 12510*    MOVE '@"L                   #   #00011411' TO DFHEIV0
 12511     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12512     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12513     MOVE X'2020233030303131343131' TO DFHEIV0(25:11)
 12514     CALL 'kxdfhei1' USING DFHEIV0,
 12515           ACVBENEI,
 12516           DFHEIV11
 12517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12518         IF ACVBENEI NOT NUMERIC
 12519             MOVE AL-UNBON       TO ACVBENEA
 12520             MOVE -1             TO ACVBENEL
 12521             MOVE ER-7637        TO EMI-ERROR
 12522             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12523         ELSE
 12524             MOVE AL-UNNON       TO ACVBENEA
 12525             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 12526         END-IF
 12527     END-IF.
 12528
 12529     IF LCVCNDTL GREATER ZERO
 12530         IF LCVCNDTI NOT = SPACES
 12531             MOVE LCVCNDTI        TO DATE-WORK
 12532             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12533             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12534             MOVE '4'             TO DC-OPTION-CODE
 12535             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12536             IF DATE-CONVERSION-ERROR
 12537                 MOVE AL-UABON    TO LCVCNDTA
 12538                 MOVE -1          TO LCVCNDTL
 12539                 MOVE ER-7638     TO EMI-ERROR
 12540                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12541             ELSE
 12542                 MOVE AL-UANON    TO LCVCNDTA
 12543                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 12544                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 12545             END-IF
 12546         END-IF
 12547     END-IF.
 12548
 12549     IF ACVCNDTL GREATER ZERO
 12550         IF ACVCNDTI NOT = SPACES
 12551             MOVE ACVCNDTI        TO DATE-WORK
 12552             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12553             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12554             MOVE '4'             TO DC-OPTION-CODE
 12555             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12556             IF DATE-CONVERSION-ERROR
 12557                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 239
* EL130.cbl
 12558                 MOVE -1          TO ACVCNDTL
 12559                 MOVE ER-7638     TO EMI-ERROR
 12560                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12561             ELSE
 12562                 MOVE AL-UANON    TO ACVCNDTA
 12563                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 12564                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 12565             END-IF
 12566         END-IF
 12567     END-IF.
 12568
 12569     IF ADDONDTL GREATER ZERO
 12570         MOVE ADDONDTI        TO DATE-WORK
 12571         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12572         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12573         MOVE '4'             TO DC-OPTION-CODE
 12574         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12575         IF DATE-CONVERSION-ERROR
 12576             MOVE AL-UABON    TO ADDONDTA
 12577             MOVE -1          TO ADDONDTL
 12578             MOVE ER-7651     TO EMI-ERROR
 12579             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12580         ELSE
 12581             MOVE AL-UANON    TO ADDONDTA
 12582             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 12583             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 12584         END-IF
 12585     END-IF.
 12586
 12587     IF APRL GREATER ZERO
 12588
 12589* EXEC CICS BIF DEEDIT
 12590*            FIELD    (APRI)
 12591*            LENGTH   (8)
 12592*        END-EXEC
 12593     MOVE 8
 12594       TO DFHEIV11
 12595*    MOVE '@"L                   #   #00011485' TO DFHEIV0
 12596     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12597     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12598     MOVE X'2020233030303131343835' TO DFHEIV0(25:11)
 12599     CALL 'kxdfhei1' USING DFHEIV0,
 12600           APRI,
 12601           DFHEIV11
 12602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12603         IF APRI NOT NUMERIC
 12604             MOVE AL-UNBON       TO APRA
 12605             MOVE -1             TO APRL
 12606             MOVE ER-0248        TO EMI-ERROR
 12607             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12608         ELSE
 12609             MOVE AL-UNNON       TO APRA
 12610             MOVE APRI           TO WS-APR APRO
 12611         END-IF
 12612     END-IF.
 12613
 12614     IF PMTFREQL GREATER ZERO
 12615
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 240
* EL130.cbl
 12616* EXEC CICS BIF DEEDIT
 12617*            FIELD   (PMTFREQI)
 12618*            LENGTH  (2)
 12619*        END-EXEC
 12620     MOVE 2
 12621       TO DFHEIV11
 12622*    MOVE '@"L                   #   #00011501' TO DFHEIV0
 12623     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12624     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12625     MOVE X'2020233030303131353031' TO DFHEIV0(25:11)
 12626     CALL 'kxdfhei1' USING DFHEIV0,
 12627           PMTFREQI,
 12628           DFHEIV11
 12629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12630         IF PMTFREQI NOT NUMERIC
 12631             MOVE -1             TO PMTFREQL
 12632             MOVE AL-UNBON       TO PMTFREQA
 12633             MOVE ER-0258        TO EMI-ERROR
 12634             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12635         ELSE
 12636             MOVE AL-UNNON       TO PMTFREQA
 12637             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 12638         END-IF
 12639     END-IF.
 12640
 12641     IF INDGRPL GREATER ZERO
 12642         IF INDGRPI = 'I' OR 'G'
 12643             MOVE AL-UANON       TO INDGRPA
 12644         ELSE
 12645             MOVE -1 TO INDGRPL
 12646             MOVE AL-UABON       TO INDGRPA
 12647             MOVE ER-0260        TO EMI-ERROR
 12648             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12649         END-IF
 12650     END-IF.
 12651
 12652     IF LOANBALL GREATER ZERO
 12653         MOVE LOANBALI           TO DEEDIT-FIELD
 12654
 12655* EXEC CICS BIF DEEDIT
 12656*            FIELD   (DEEDIT-FIELD)
 12657*            LENGTH  (12)
 12658*        END-EXEC
 12659     MOVE 12
 12660       TO DFHEIV11
 12661*    MOVE '@"L                   #   #00011529' TO DFHEIV0
 12662     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12663     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12664     MOVE X'2020233030303131353239' TO DFHEIV0(25:11)
 12665     CALL 'kxdfhei1' USING DFHEIV0,
 12666           DEEDIT-FIELD,
 12667           DFHEIV11
 12668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12669         IF DEEDIT-FIELD NOT NUMERIC
 12670             MOVE AL-UNBON       TO LOANBALA
 12671             MOVE -1             TO LOANBALL
 12672             MOVE ER-0247        TO EMI-ERROR
 12673             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 241
* EL130.cbl
 12674         ELSE
 12675             MOVE AL-UNNON       TO LOANBALA
 12676             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 12677         END-IF
 12678     END-IF.
 12679
 12680     IF PREMTYPL GREATER ZERO
 12681         IF (PREMTYPI = '1' OR '2' OR '3')
 12682             MOVE AL-UANON       TO PREMTYPA
 12683         ELSE
 12684             MOVE -1             TO PREMTYPL
 12685             MOVE AL-UABON       TO PREMTYPA
 12686             MOVE ER-0227        TO EMI-ERROR
 12687             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12688         END-IF
 12689     END-IF.
 12690
 12691     IF REINCDL GREATER ZERO
 12692         MOVE LOW-VALUES         TO  ERREIN-KEY
 12693         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 12694         MOVE REINCDI            TO  REIN-CODE-1
 12695                                     REIN-CODE-2
 12696                                     REIN-CODE-3
 12697         MOVE 'A'                TO  REIN-TYPE
 12698         PERFORM 7992-READ-REIN THRU 7992-EXIT
 12699         IF REIN-REC-NOT-FOUND
 12700             MOVE ER-0266        TO  EMI-ERROR
 12701             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12702             MOVE -1             TO  REINCDL
 12703             MOVE AL-UABON       TO  REINCDA
 12704         ELSE
 12705             MOVE AL-UANON       TO  REINCDA
 12706         END-IF
 12707     END-IF.
 12708
 12709     IF CERTMTI NOT = 'A'
 12710        GO TO 6200-EXIT
 12711     END-IF.
 12712
 12713     IF PREMTYPI = '1'
 12714         IF LCVCDL GREATER ZERO
 12715             IF WS-LF-SPECIAL-CALC-CD = 'O'
 12716                 MOVE ER-0841        TO  EMI-ERROR
 12717                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12718                 MOVE -1             TO  PREMTYPL
 12719                 MOVE AL-UABON       TO  PREMTYPA
 12720             END-IF
 12721         END-IF
 12722     END-IF.
 12723
 12724     IF PREMTYPI = '1'
 12725         IF ACVCDL GREATER ZERO
 12726             IF WS-AH-SPECIAL-CALC-CD = 'O'
 12727                 MOVE ER-0841        TO  EMI-ERROR
 12728                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12729                 MOVE -1             TO  PREMTYPL
 12730                 MOVE AL-UABON       TO  PREMTYPA
 12731             END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 242
* EL130.cbl
 12732         END-IF
 12733     END-IF.
 12734
 12735     IF PREMTYPI = '2'
 12736         IF LCVCDL GREATER ZERO
 12737             IF (PI-COMPANY-ID = 'HAN') AND
 12738                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 12739                        OR
 12740                 WS-LF-SPECIAL-CALC-CD = 'O'
 12741*                NEXT SENTENCE
 12742                 CONTINUE
 12743             ELSE
 12744                 MOVE ER-0840        TO  EMI-ERROR
 12745                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12746                 MOVE -1             TO  PREMTYPL
 12747                 MOVE AL-UABON       TO  PREMTYPA
 12748             END-IF
 12749         END-IF
 12750     END-IF.
 12751
 12752     IF PREMTYPI = '2'
 12753         IF ACVCDL GREATER ZERO
 12754             IF (PI-COMPANY-ID = 'HAN')  AND
 12755                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 12756                        OR
 12757                 WS-AH-SPECIAL-CALC-CD = 'O'
 12758*                NEXT SENTENCE
 12759                 CONTINUE
 12760             ELSE
 12761                 MOVE ER-0840        TO  EMI-ERROR
 12762                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12763                 MOVE -1             TO  PREMTYPL
 12764                 MOVE AL-UABON       TO  PREMTYPA
 12765             END-IF
 12766         END-IF
 12767     END-IF.
 12768
 12769     IF LCVCDL = ZEROS
 12770        GO TO 6200-EXIT
 12771     END-IF.
 12772
 12773     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 12774         IF PMTFREQI NOT = ZEROS
 12775             MOVE ER-0428        TO EMI-ERROR
 12776             MOVE -1             TO PMTFREQL
 12777             MOVE AL-UNBON       TO PMTFREQA
 12778             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12779             GO TO 6200-CHECK-APR
 12780         END-IF
 12781     END-IF.
 12782
 12783     IF PMTFREQL = ZEROS AND TEX-REG
 12784         MOVE ER-0429            TO EMI-ERROR
 12785         MOVE -1                 TO PMTFREQL
 12786         MOVE AL-UNBON           TO PMTFREQA
 12787         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12788         GO TO 6200-CHECK-APR
 12789     END-IF.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 243
* EL130.cbl
 12790
 12791     IF LCVOTRMI NOT NUMERIC
 12792         GO TO 6200-CHECK-APR
 12793     END-IF.
 12794
 12795     IF WS-PMTFREQ NOT = ZERO
 12796         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 12797         GIVING DIVIDE-QUOT
 12798         REMAINDER DIVIDE-REM
 12799         IF DIVIDE-REM GREATER ZERO
 12800             MOVE ER-0430            TO EMI-ERROR
 12801             MOVE -1                 TO PMTFREQL
 12802             MOVE AL-UNBON           TO PMTFREQA
 12803             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12804         END-IF
 12805     END-IF.
 12806
 12807 6200-CHECK-APR.
 12808     IF NET-PAY AND APRL = ZEROS
 12809        MOVE ER-0257             TO EMI-ERROR
 12810        MOVE -1                  TO APRL
 12811        MOVE AL-UABON            TO APRA
 12812        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12813     END-IF.
 12814
 12815 6200-EXIT.
 12816     EXIT.
 12817
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 244
* EL130.cbl
 12819 6300-REQUIRED-CERT-EDIT.
 12820
 12821     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12822        GO TO 6300-REQUIRED-AH-EDIT
 12823     END-IF
 12824
 12825     IF LCVCDL = ZERO
 12826        MOVE ER-7639             TO EMI-ERROR
 12827        MOVE -1                  TO LCVCDL
 12828        MOVE AL-UABON            TO LCVCDA
 12829        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12830     END-IF.
 12831
 12832     IF LCVOTRML = ZERO
 12833        MOVE ER-7670             TO EMI-ERROR
 12834        MOVE -1                  TO LCVOTRML
 12835        MOVE AL-UNBON            TO LCVOTRMA
 12836        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12837     END-IF.
 12838
 12839     IF LCVBENEL = ZERO
 12840        MOVE ER-7671             TO EMI-ERROR
 12841        MOVE -1                  TO LCVBENEL
 12842        MOVE AL-UNBON            TO LCVBENEA
 12843        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12844     END-IF.
 12845
 12846     GO TO 6399-EXIT.
 12847
 12848 6300-REQUIRED-AH-EDIT.
 12849
 12850     IF ACVCDL = ZERO
 12851        MOVE ER-7639             TO EMI-ERROR
 12852        MOVE -1                  TO ACVCDL
 12853        MOVE AL-UABON            TO ACVCDA
 12854        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12855     END-IF.
 12856
 12857     IF ACVOTRML = ZERO
 12858         MOVE ER-7670             TO EMI-ERROR
 12859         MOVE -1                  TO ACVOTRML
 12860         MOVE AL-UNBON            TO ACVOTRMA
 12861         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12862     END-IF.
 12863
 12864     IF ACVBENEL = ZERO
 12865        MOVE ER-7671             TO EMI-ERROR
 12866        MOVE -1                  TO ACVBENEL
 12867        MOVE AL-UNBON            TO ACVBENEA
 12868        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12869     END-IF.
 12870
 12871 6399-EXIT.
 12872      EXIT.
 12873
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 245
* EL130.cbl
 12875 6400-TEST-CLAIM-REASONABILITY.
 12876
 12877     IF WS-INCUR = LOW-VALUES
 12878        GO TO 6499-EXIT
 12879     END-IF.
 12880
 12881     IF WS-EFFDT NOT = LOW-VALUES
 12882         IF WS-INCUR LESS WS-EFFDT
 12883             MOVE ER-0458          TO EMI-ERROR
 12884             MOVE -1               TO INCURL
 12885             MOVE AL-UABON         TO INCURA
 12886             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12887         END-IF
 12888     END-IF.
 12889
 12890     IF CERTMTI = 'A'
 12891        GO TO 6460-TEST-NEW-CERT
 12892     END-IF.
 12893
 12894     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12895     MOVE CRTCARRI               TO CERT-CARRIER.
 12896     MOVE GROUPI                 TO CERT-GROUPING.
 12897     MOVE STATEI                 TO CERT-STATE.
 12898     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 12899     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 12900     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 12901
 12902
 12903
 12904* EXEC CICS HANDLE CONDITION
 12905*         DUPKEY   (6499-EXIT)
 12906*         NOTFND   (6499-EXIT)
 12907*    END-EXEC.
 12908*    MOVE '"$$I                  ! B #00011767' TO DFHEIV0
 12909     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 12910     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12911     MOVE X'4220233030303131373637' TO DFHEIV0(25:11)
 12912     CALL 'kxdfhei1' USING DFHEIV0
 12913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12914
 12915
 12916     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 12917
 12918     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 12919        'I' OR 'G')
 12920        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 12921     ELSE
 12922        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 12923     END-IF.
 12924
 12925     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12926     MOVE '6'                    TO DC-OPTION-CODE.
 12927     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12928
 12929     IF WS-INCUR GREATER THAN DC-BIN-DATE-2
 12930        MOVE ER-0519             TO EMI-ERROR
 12931        MOVE -1                  TO INCURL
 12932        MOVE AL-UABON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 246
* EL130.cbl
 12933        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12934     END-IF.
 12935
 12936     IF CLMCARRI NOT = CRTCARRI
 12937        MOVE ER-0562             TO EMI-ERROR
 12938        MOVE AL-UABON            TO CLMCARRA
 12939        MOVE -1                  TO CLMCARRL
 12940        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12941     END-IF.
 12942
 12943     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 12944        CM-AH-BENEFIT-CD = '00')
 12945                  OR
 12946        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 12947        CM-LF-BENEFIT-CD = '00')
 12948         MOVE ER-0521         TO EMI-ERROR
 12949         MOVE AL-UABON        TO CLMTYPEA
 12950         MOVE -1              TO CLMTYPEL
 12951         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12952     END-IF.
 12953*    IF CLMTYPEI = 'I' AND
 12954*       CM-AH-CRITICAL-PERIOD = +0
 12955*        MOVE ER-0521         TO EMI-ERROR
 12956*        MOVE AL-UABON        TO CLMTYPEA
 12957*        MOVE -1              TO CLMTYPEL
 12958*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12959*    END-IF
 12960
 12961*    IF PI-COMPANY-ID = 'CRI'
 12962*        IF MAINTI = 'A'
 12963*            IF CERT-PEND-ISSUE-ERROR  OR
 12964*               CERT-PEND-ISSUE-RETURNED
 12965*                MOVE -1                 TO CERTNOL
 12966*                MOVE AL-UABON           TO CERTNOA
 12967*                MOVE ER-7640            TO EMI-ERROR
 12968*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12969*            END-IF
 12970*        END-IF
 12971*    END-IF.
 12972
 12973     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 12974         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 12975         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 12976             GO TO 6450-DATE-ERROR
 12977         END-IF
 12978     END-IF.
 12979
 12980     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 12981         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 12982         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 12983             GO TO 6450-DATE-ERROR
 12984         END-IF
 12985     END-IF.
 12986
 12987     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 12988         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 12989             GO TO 6450-DATE-ERROR
 12990         END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 247
* EL130.cbl
 12991     END-IF.
 12992
 12993     GO TO 6499-EXIT.
 12994
 12995 6450-DATE-ERROR.
 12996     MOVE ER-0520                TO EMI-ERROR.
 12997     MOVE -1                     TO INCURL.
 12998     MOVE AL-UABON               TO INCURA.
 12999     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13000
 13001*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 13002*       (EMI-SEVERITY-SAVE = 'X')
 13003*        ADD 1                TO EMI-FORCABLE-CTR
 13004*        SUBTRACT 1 FROM EMI-FATAL-CTR
 13005*    END-IF.
 13006
 13007     GO TO 6499-EXIT.
 13008
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 248
* EL130.cbl
 13010 6460-TEST-NEW-CERT.
 13011
 13012     IF NOT EMI-NO-ERRORS
 13013        GO TO 6499-EXIT
 13014     END-IF.
 13015
 13016     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 13017
 13018     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13019         ACVOTRML GREATER ZERO)
 13020        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 13021     END-IF.
 13022
 13023     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13024         LCVOTRML GREATER ZERO
 13025        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 13026     END-IF.
 13027
 13028     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 13029
 13030*    IF PI-COMPANY-ID = 'HAN'
 13031*        IF ADDONDTL GREATER ZERO
 13032*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 13033*            IF CLMTYPEI = 'A'
 13034*                IF ACVOTRMI NOT = ZEROS
 13035*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 13036*                ELSE
 13037*                    NEXT SENTENCE
 13038*                    CONTINUE
 13039*                END-IF
 13040*            ELSE
 13041*                IF LCVOTRMI NOT = ZEROS
 13042*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 13043*                END-IF
 13044*            END-IF
 13045*        END-IF
 13046*    END-IF.
 13047
 13048     MOVE '6'                    TO DC-OPTION-CODE.
 13049     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13050
 13051     IF NO-CONVERSION-ERROR
 13052         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 13053     END-IF.
 13054
 13055     IF WS-INCUR GREATER THAN WS-EXPIRE
 13056        MOVE ER-0519             TO EMI-ERROR
 13057        MOVE -1                  TO INCURL
 13058        MOVE AL-UABON            TO INCURA
 13059        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13060     END-IF.
 13061
 13062     IF CLMCARRI NOT = CRTCARRI
 13063        MOVE ER-0562             TO EMI-ERROR
 13064        MOVE AL-UABON            TO CLMCARRA
 13065        MOVE -1                  TO CLMCARRL
 13066        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13067     END-IF.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 249
* EL130.cbl
 13068
 13069     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13070         ACVCDL = ZEROS)
 13071             MOVE ER-0521        TO EMI-ERROR
 13072             MOVE AL-UABON       TO CLMTYPEA
 13073             MOVE -1             TO CLMTYPEL
 13074             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13075     END-IF.
 13076
 13077     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13078         LCVCDL = ZEROS
 13079             MOVE ER-0521        TO EMI-ERROR
 13080             MOVE AL-UABON       TO CLMTYPEA
 13081             MOVE -1             TO CLMTYPEL
 13082             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13083     END-IF.
 13084
 13085     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13086         IF LCVCNDTL GREATER ZERO
 13087             IF WS-INCUR GREATER THAN WS-LCVCNDT
 13088                 GO TO 6450-DATE-ERROR
 13089             END-IF
 13090         END-IF
 13091     END-IF.
 13092
 13093     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13094         IF ACVCNDTL GREATER ZERO
 13095             IF WS-INCUR GREATER THAN WS-ACVCNDT
 13096                 GO TO 6450-DATE-ERROR
 13097             END-IF
 13098         END-IF
 13099     END-IF.
 13100
 13101 6499-EXIT.
 13102     EXIT.
 13103
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 250
* EL130.cbl
 13105 6600-CHECK-AUTO-ACTIVITY.
 13106
 13107
 13108* EXEC CICS HANDLE CONDITION
 13109*        NOTFND   (6600-NOT-FOUND)
 13110*    END-EXEC.
 13111*    MOVE '"$I                   ! C #00011963' TO DFHEIV0
 13112     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13113     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13114     MOVE X'4320233030303131393633' TO DFHEIV0(25:11)
 13115     CALL 'kxdfhei1' USING DFHEIV0
 13116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13117
 13118
 13119     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 13120     MOVE 'T'                        TO  CNTL-REC-TYPE.
 13121     MOVE SPACES                     TO  CNTL-ACCESS.
 13122     MOVE +0                         TO  CNTL-SEQ-NO.
 13123
 13124     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13125
 13126     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 13127         MOVE 'N'                    TO  WS-REC-FOUND-SW
 13128                                         WS-LETTER-SW
 13129         GO TO 6600-EXIT
 13130     END-IF.
 13131
 13132     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 13133         MOVE 'N'                     TO  WS-LETTER-SW
 13134     ELSE
 13135         MOVE 'Y'                     TO  WS-LETTER-SW
 13136     END-IF.
 13137
 13138     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 13139     GO TO 6600-EXIT.
 13140
 13141 6600-START-AUTO-LETTER-WRITER.
 13142
 13143     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 13144     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 13145
 13146     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 13147
 13148     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 13149         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 13150         MOVE '6'                     TO  DC-OPTION-CODE
 13151         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 13152         MOVE +0                      TO  DC-ELAPSED-MONTHS
 13153         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13154         IF NO-CONVERSION-ERROR
 13155             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 13156         ELSE
 13157             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 13158         END-IF
 13159     END-IF.
 13160
 13161     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
 13162         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 251
* EL130.cbl
 13163         MOVE '6'                     TO  DC-OPTION-CODE
 13164         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 13165         MOVE +0                      TO  DC-ELAPSED-MONTHS
 13166         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13167         IF NO-CONVERSION-ERROR
 13168             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 13169         ELSE
 13170             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 13171         END-IF
 13172     END-IF.
 13173
 13174
 13175
 13176* EXEC CICS LINK
 13177*        PROGRAM    (LINK-1523)
 13178*        COMMAREA   (W-1523-LINKDATA)
 13179*        LENGTH     (W-1523-COMM-LENGTH)
 13180*    END-EXEC.
 13181*    MOVE '."C                   (   #00012023' TO DFHEIV0
 13182     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13183     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13184     MOVE X'2020233030303132303233' TO DFHEIV0(25:11)
 13185     CALL 'kxdfhei1' USING DFHEIV0,
 13186           LINK-1523,
 13187           W-1523-LINKDATA,
 13188           W-1523-COMM-LENGTH,
 13189           DFHEIV99,
 13190           DFHEIV99,
 13191           DFHEIV99,
 13192           DFHEIV99
 13193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13194
 13195
 13196     GO TO 6600-EXIT.
 13197
 13198 6600-NOT-FOUND.
 13199     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 13200
 13201 6600-EXIT.
 13202     EXIT.
 13203
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 252
* EL130.cbl
 13204/
 13205*************************************************************
 13206*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 13207*************************************************************
 13208
 13209 6700-OUTPUT-ACTIVITY-RECORD.
 13210
 13211
 13212
 13213* EXEC CICS GETMAIN
 13214*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 13215*        LENGTH (DLYACTV-LENGTH)
 13216*        INITIMG (WS-BLANK)
 13217*    END-EXEC.
 13218*    MOVE ',"IL                  $   #00012045' TO DFHEIV0
 13219     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13220     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13221     MOVE X'2020233030303132303435' TO DFHEIV0(25:11)
 13222     CALL 'kxdfhei1' USING DFHEIV0,
 13223           DFHEIV20,
 13224           DLYACTV-LENGTH,
 13225           WS-BLANK
 13226     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 13227         DFHEIV20
 13228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13229
 13230
 13231     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 13232     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 13233     MOVE CLMCARRI               TO DA-CARRIER.
 13234     IF CLMNOL EQUAL ZERO
 13235         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 13236     ELSE
 13237         MOVE CLMNOI             TO DA-CLAIM-NO
 13238     END-IF.
 13239     MOVE CERTNOI                TO DA-CERT-PRIME.
 13240     MOVE SUFXI                  TO DA-CERT-SFX.
 13241     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 13242     MOVE 'A'                    TO DA-RECORD-TYPE.
 13243
 13244
 13245* EXEC CICS HANDLE CONDITION
 13246*        NOTOPEN (6700-NOTOPEN-ERROR)
 13247*        DUPREC (6700-EXIT)
 13248*    END-EXEC.
 13249*    MOVE '"$J%                  ! D #00012064' TO DFHEIV0
 13250     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 13251     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13252     MOVE X'4420233030303132303634' TO DFHEIV0(25:11)
 13253     CALL 'kxdfhei1' USING DFHEIV0
 13254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13255
 13256
 13257
 13258* EXEC CICS WRITE
 13259*        DATASET (DLYACTV-DSID)
 13260*        RIDFLD (DA-KEY)
 13261*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 253
* EL130.cbl
 13262*        LENGTH (DLYACTV-LENGTH)
 13263*    END-EXEC.
 13264*    MOVE '&$ L                  ''   #00012069' TO DFHEIV0
 13265     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13266     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13267     MOVE X'2020233030303132303639' TO DFHEIV0(25:11)
 13268     CALL 'kxdfhei1' USING DFHEIV0,
 13269           DLYACTV-DSID,
 13270           DAILY-ACTIVITY-RECORD,
 13271           DLYACTV-LENGTH,
 13272           DA-KEY,
 13273           DFHEIV99,
 13274           DFHEIV99
 13275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13276
 13277     GO TO 6700-EXIT.
 13278
 13279 6700-NOTOPEN-ERROR.
 13280     MOVE '2955'                 TO EMI-ERROR.
 13281     MOVE -1                     TO MAINTL.
 13282     MOVE AL-UANON               TO MAINTA.
 13283     PERFORM 9900-ERROR-FORMAT THRU
 13284             9900-EXIT.
 13285     GO TO 8200-SEND-DATAONLY.
 13286
 13287 6700-EXIT.
 13288     EXIT.
 13289
 13290*************************************************************
 13291*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 13292*************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 254
* EL130.cbl
 13293/
 13294 6990-DEEDIT-DATE.
 13295
 13296
 13297* EXEC CICS BIF DEEDIT
 13298*        FIELD   (DATE-WORK)
 13299*        LENGTH  (8)
 13300*    END-EXEC.
 13301     MOVE 8
 13302       TO DFHEIV11
 13303*    MOVE '@"L                   #   #00012094' TO DFHEIV0
 13304     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13305     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13306     MOVE X'2020233030303132303934' TO DFHEIV0(25:11)
 13307     CALL 'kxdfhei1' USING DFHEIV0,
 13308           DATE-WORK,
 13309           DFHEIV11
 13310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13311
 13312 6990-EXIT.
 13313     EXIT.
 13314
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 255
* EL130.cbl
 13316 7000-BUILD-OUTPUT-MAP.
 13317
 13318     IF CLAIM-SWITCH = 'N'
 13319         GO TO 7050-BUILD-MAP-CERT-DATA
 13320     END-IF.
 13321
 13322     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 13323         MOVE SPACES                 TO SEQUO
 13324         MOVE AL-SABOF               TO SEQUA
 13325     ELSE
 13326         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 13327         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 13328         MOVE WS-CLAIM-SEQU          TO SEQUO
 13329         MOVE AL-SABON               TO SEQUA
 13330     END-IF.
 13331
 13332     MOVE CL-CARRIER             TO CLMCARRO.
 13333     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 13334     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 13335     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 13336     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 13337     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 13338     MOVE CL-INSURED-MID-INIT    TO INITO.
 13339     MOVE CL-INSURED-SEX-CD      TO SEXO.
 13340     MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 13341
 13342     MOVE AL-UANON               TO CLMCARRA
 13343                                    CLMTYPEA
 13344                                    PCERTNOA
 13345                                    PSUFXA
 13346                                    LSTNMEA
 13347                                    FSTNMEA
 13348                                    INITA
 13349                                    SEXA
 13350                                    OCCCDA.
 13351
 13352     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 13353
 13354     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 13355         MOVE ' '                 TO DC-OPTION-CODE
 13356         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 13357         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13358         IF NOT DATE-CONVERSION-ERROR
 13359             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 13360             MOVE AL-UANON            TO BIRTHDTA
 13361         END-IF
 13362     END-IF.
 13363
 13364     MOVE CL-SOC-SEC-NO          TO SSNO.
 13365     MOVE AL-UANON               TO SSNA.
 13366
 13367     IF CL-INCURRED-DT NOT = LOW-VALUES
 13368         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13369         MOVE ' '                TO DC-OPTION-CODE
 13370         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13371         IF NOT DATE-CONVERSION-ERROR
 13372             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 13373             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 256
* EL130.cbl
 13374         END-IF
 13375     END-IF.
 13376
 13377     IF CL-REPORTED-DT NOT = LOW-VALUES
 13378         MOVE ' '                TO DC-OPTION-CODE
 13379         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 13380         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13381         IF NOT DATE-CONVERSION-ERROR
 13382             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 13383             MOVE AL-UANON            TO REPORTA
 13384         END-IF
 13385     END-IF.
 13386
 13387     IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 13388         MOVE ' '                 TO DC-OPTION-CODE
 13389         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 13390         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13391         IF NOT DATE-CONVERSION-ERROR
 13392             MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 13393             MOVE AL-UANON            TO ESTENDA
 13394         END-IF
 13395     END-IF.
 13396
 13397     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 13398     MOVE CL-CAUSE-CD            TO CAUSEO.
 13399     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 13400     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 13401     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 13402     MOVE CL-PRIORITY-CD         TO PRICDO.
 13403     MOVE AL-UANON               TO DIAGA
 13404                                    CAUSEA
 13405                                    RELCLMA
 13406                                    PROCCDA
 13407                                    PRICDA.
 13408     MOVE AL-UNNON               TO MANRSVA.
 13409
 13410*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 13411*        MOVE CL-PRODUCT-CD          TO PRODCDO
 13412*        MOVE AL-UANON               TO PRODCDA
 13413*    END-IF.
 13414
 13415     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 13416     MOVE CL-FILE-LOCATION       TO FILETOO.
 13417     MOVE CL-BENEFICIARY         TO BENECDO.
 13418     MOVE AL-UANON               TO SUPVA
 13419                                    FILETOA
 13420                                    BENECDA.
 13421
 13422     IF CLAIM-SWITCH = 'X'
 13423         GO TO 7099-EXIT
 13424     END-IF.
 13425
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 257
* EL130.cbl
 13427 7050-BUILD-MAP-CERT-DATA.
 13428     MOVE CM-CERT-PRIME          TO CERTNOO.
 13429     MOVE CM-CERT-SFX            TO SUFXO.
 13430     MOVE AL-SANON               TO CERTNOA
 13431                                    SUFXA.
 13432
 13433     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 13434         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 13435         MOVE ' '                TO DC-OPTION-CODE
 13436         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13437         IF NOT DATE-CONVERSION-ERROR
 13438             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 13439         END-IF
 13440     END-IF.
 13441
 13442     MOVE CM-ACCOUNT             TO ACCOUNTO.
 13443     MOVE CM-STATE               TO STATEO.
 13444     MOVE CM-CARRIER             TO CRTCARRO.
 13445     MOVE CM-GROUPING            TO GROUPO.
 13446     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 13447     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 13448     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 13449     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 13450     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 13451     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 13452     MOVE CM-JT-INITIAL          TO JNTINITO.
 13453     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 13454     MOVE AL-UANON               TO ACCOUNTA
 13455                                    STATEA
 13456                                    CRTCARRA
 13457                                    GROUPA
 13458                                    CRTLNMEA
 13459                                    CRTFNMEA
 13460                                    CRTINITA
 13461                                    JNTLNMEA
 13462                                    JNTFNMEA
 13463                                    JNTINITA.
 13464     MOVE AL-UNNON               TO ISSAGEA
 13465                                    JNTAGEA.
 13466
 13467     IF CM-SSN-STATE   = CM-STATE AND
 13468        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 13469*        NEXT SENTENCE
 13470         CONTINUE
 13471     ELSE
 13472         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 13473     END-IF.
 13474
 13475     MOVE AL-UANON               TO CRTSSNA.
 13476
 13477     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 13478     MOVE '2'                    TO DC-OPTION-CODE.
 13479     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13480     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 13481
 13482*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 13483     MOVE SPACES                 TO ELCNTL-KEY.
 13484     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 258
* EL130.cbl
 13485     MOVE '3'                    TO CNTL-REC-TYPE.
 13486     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13487     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13488
 13489
 13490
 13491* EXEC CICS READ
 13492*        DATASET  (ELCNTL-DSID)
 13493*        SET      (ADDRESS OF CONTROL-FILE)
 13494*        RIDFLD   (ELCNTL-KEY)
 13495*        RESP     (WS-RESPONSE)
 13496*    END-EXEC.
 13497*    MOVE '&"S        E          (  N#00012276' TO DFHEIV0
 13498     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13499     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13500     MOVE X'204E233030303132323736' TO DFHEIV0(25:11)
 13501     CALL 'kxdfhei1' USING DFHEIV0,
 13502           ELCNTL-DSID,
 13503           DFHEIV20,
 13504           DFHEIV99,
 13505           ELCNTL-KEY,
 13506           DFHEIV99,
 13507           DFHEIV99,
 13508           DFHEIV99
 13509     SET ADDRESS OF CONTROL-FILE TO
 13510         DFHEIV20
 13511     MOVE EIBRESP  TO WS-RESPONSE
 13512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13513
 13514
 13515     IF WS-RESP-NOTFND
 13516          MOVE ER-2848           TO EMI-ERROR
 13517          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13518          GO TO 8100-SEND-INITIAL-MAP
 13519     END-IF.
 13520
 13521     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 13522     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 13523     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 259
* EL130.cbl
 13525     IF CM-LF-BENEFIT-CD = '00'
 13526         MOVE ZEROS              TO LCVOTRMO
 13527                                    LCVRTRMO
 13528                                    LCVRATEO
 13529                                    LCVBENEO
 13530         MOVE SPACES             TO LCVDSCRO
 13531                                    LCVCDO
 13532                                    LCVKINDO
 13533                                    LCVFORMO
 13534                                    LCVCNDTO
 13535                                    LCVEXITO
 13536                                    LCVSTATO
 13537         IF CLMTYPEL GREATER THAN ZERO AND
 13538            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13539                MOVE ER-0521     TO EMI-ERROR
 13540                MOVE AL-UABON    TO CLMTYPEA
 13541                MOVE -1          TO CLMTYPEL
 13542                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13543                GO TO 7060-FILL-AH-COVERAGE
 13544         ELSE
 13545             GO TO 7060-FILL-AH-COVERAGE
 13546         END-IF
 13547     END-IF.
 13548
 13549     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 13550     MOVE AL-UANON               TO LCVDSCRA.
 13551     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 13552     MOVE '4'                    TO WS-REC-TYPE.
 13553     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 13554     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 13555     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 13556     MOVE AL-UANON               TO LCVCDA.
 13557     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 13558                                    CP-ORIGINAL-TERM.
 13559     MOVE AL-UNNON               TO LCVOTRMA.
 13560     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13561     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13562     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 13563     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13564     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13565     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13566
 13567     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 13568     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 13569
 13570     IF CM-LF-PREMIUM-RATE NUMERIC
 13571         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 13572     ELSE
 13573         MOVE ZEROS              TO LCVRATEO
 13574     END-IF.
 13575
 13576     MOVE AL-UNNON               TO LCVRATEA.
 13577
 13578     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 13579         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 13580     END-IF.
 13581
 13582     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 260
* EL130.cbl
 13583
 13584     MOVE AL-UNNON               TO LCVBENEA.
 13585
 13586     IF CM-POLICY-FORM-NO NOT = SPACES
 13587         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 13588     ELSE
 13589         MOVE WS-FORM-HOLD       TO LCVFORMO
 13590     END-IF.
 13591
 13592     MOVE SPACES                 TO WS-FORM-HOLD.
 13593     MOVE 'L'                    TO WS-REC-TYPE.
 13594     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 13595
 13596     IF WS-FORM-HOLD NOT = SPACES
 13597         MOVE WS-FORM-HOLD       TO LCVFORMO
 13598         MOVE AL-UANON           TO LCVFORMA
 13599     END-IF.
 13600
 13601     IF CM-LF-CURRENT-STATUS = '8'
 13602         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 13603             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 13604             MOVE ' '             TO DC-OPTION-CODE
 13605             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13606             IF NOT DATE-CONVERSION-ERROR
 13607                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 13608                 MOVE AL-UANON            TO LCVCNDTA
 13609             END-IF
 13610         END-IF
 13611     END-IF.
 13612
 13613     IF CM-LF-CURRENT-STATUS = '7'
 13614         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13615             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 13616             MOVE ' '            TO DC-OPTION-CODE
 13617             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13618             IF NOT DATE-CONVERSION-ERROR
 13619                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 13620                 MOVE AL-UANON   TO LCVCNDTA
 13621             END-IF
 13622         END-IF
 13623     END-IF.
 13624
 13625     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 13626         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 13627             MOVE ' '            TO DC-OPTION-CODE
 13628             MOVE CM-LF-DEATH-EXIT-DT
 13629                                 TO DC-BIN-DATE-1
 13630             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13631             IF NOT DATE-CONVERSION-ERROR
 13632                 MOVE DC-GREG-DATE-1-EDIT
 13633                                 TO LCVEXITO
 13634             END-IF
 13635         END-IF
 13636     END-IF.
 13637
 13638     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 13639         IF CP-REMAINING-TERM-3 = ZEROS
 13640             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 261
* EL130.cbl
 13641         ELSE
 13642             MOVE 'ACTIVE'       TO LCVSTATO
 13643         END-IF
 13644     END-IF.
 13645
 13646     IF CM-LF-CURRENT-STATUS = '2'
 13647        MOVE 'PEND  '            TO LCVSTATO
 13648     END-IF.
 13649     IF CM-LF-CURRENT-STATUS = '3'
 13650        MOVE 'RESTORE'           TO LCVSTATO
 13651     END-IF.
 13652     IF CM-LF-CURRENT-STATUS = '5'
 13653        MOVE 'REISSUE'           TO LCVSTATO
 13654     END-IF.
 13655     IF CM-LF-CURRENT-STATUS = '6'
 13656        MOVE 'LMP DIS'           TO LCVSTATO
 13657     END-IF.
 13658     IF CM-LF-CURRENT-STATUS = '7'
 13659        MOVE 'DEATH  '           TO LCVSTATO
 13660     END-IF.
 13661     IF CM-LF-CURRENT-STATUS = '8'
 13662        MOVE 'CANCEL '           TO LCVSTATO
 13663     END-IF.
 13664     IF CM-LF-CURRENT-STATUS = '9'
 13665        MOVE 'RE-ONLY'           TO LCVSTATO
 13666     END-IF.
 13667     IF CM-LF-CURRENT-STATUS = 'V'
 13668        MOVE 'VOID   '           TO LCVSTATO
 13669     END-IF.
 13670     IF CM-LF-CURRENT-STATUS = 'D'
 13671        MOVE 'DECLINE'           TO LCVSTATO
 13672     END-IF.
 13673
 13674     IF PI-COMPANY-ID = 'CID'
 13675         IF CM-LF-BENEFIT-CD >= '2O' AND
 13676            CM-LF-BENEFIT-CD <= '2V'
 13677             MOVE ER-0878       TO EMI-ERROR
 13678             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13679         END-IF
 13680     END-IF.
 13681
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 262
* EL130.cbl
 13683 7060-FILL-AH-COVERAGE.
 13684
 13685     IF CM-AH-BENEFIT-CD = '00'
 13686         MOVE ZEROS              TO ACVOTRMO
 13687                                    ACVRTRMO
 13688                                    ACVRATEO
 13689                                    ACVBENEO
 13690         MOVE SPACES             TO ACVDSCRO
 13691                                    ACVCDO
 13692                                    ACVKINDO
 13693                                    ACVFORMO
 13694                                    ACVCNDTO
 13695                                    ACVEXITO
 13696                                    ACVSTATO
 13697         IF (CLMTYPEL GREATER THAN ZERO AND
 13698             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 13699             MOVE ER-0521     TO EMI-ERROR
 13700             MOVE AL-UABON    TO CLMTYPEA
 13701             MOVE -1          TO CLMTYPEL
 13702             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13703             GO TO 7070-BUILD-MAP-FINISH
 13704         ELSE
 13705             GO TO 7070-BUILD-MAP-FINISH
 13706         END-IF
 13707     END-IF.
 13708
 13709     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 13710     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 13711     MOVE AL-UANON               TO ACVDSCRA
 13712                                    ACVCDA.
 13713     MOVE '5'                    TO WS-REC-TYPE.
 13714     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 13715     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 13716
 13717     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 13718                                    CP-ORIGINAL-TERM.
 13719     MOVE AL-UNNON               TO ACVOTRMA.
 13720
 13721     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13722     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13723     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 13724     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13725     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13726     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13727
 13728     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 13729     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 13730
 13731     IF CM-AH-PREMIUM-RATE NUMERIC
 13732         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 13733     ELSE
 13734         MOVE ZEROS              TO ACVRATEO
 13735     END-IF.
 13736
 13737     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 13738     MOVE AL-UNNON               TO ACVRATEA
 13739                                    ACVBENEA.
 13740
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 263
* EL130.cbl
 13741     IF CM-POLICY-FORM-NO NOT = SPACES
 13742         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 13743     ELSE
 13744         MOVE WS-FORM-HOLD       TO ACVFORMO
 13745         MOVE SPACES TO WS-FORM-HOLD
 13746         MOVE 'A'                TO WS-REC-TYPE
 13747         PERFORM 7400-READ-STATE THRU 7499-EXIT
 13748         IF WS-FORM-HOLD NOT = SPACES
 13749             MOVE WS-FORM-HOLD   TO ACVFORMO
 13750         END-IF
 13751     END-IF.
 13752
 13753     MOVE AL-UANON               TO ACVFORMA.
 13754
 13755     IF CM-AH-CURRENT-STATUS = '8'
 13756         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 13757             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 13758             MOVE ' '             TO DC-OPTION-CODE
 13759             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13760             IF NOT DATE-CONVERSION-ERROR
 13761                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 13762                MOVE AL-UANON    TO ACVCNDTA
 13763             END-IF
 13764         END-IF
 13765     END-IF.
 13766
 13767     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 13768         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 13769             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 13770             MOVE ' '             TO DC-OPTION-CODE
 13771             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13772             IF NOT DATE-CONVERSION-ERROR
 13773                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 13774                MOVE AL-UANON            TO ACVCNDTA
 13775             END-IF
 13776         END-IF
 13777     END-IF.
 13778
 13779     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 13780         MOVE ' '                TO DC-OPTION-CODE
 13781         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 13782         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13783         IF NOT DATE-CONVERSION-ERROR
 13784             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 13785         END-IF
 13786     END-IF.
 13787
 13788     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 13789         IF CP-REMAINING-TERM-3 = ZEROS
 13790             MOVE 'EXPIRED'      TO ACVSTATO
 13791         ELSE
 13792             MOVE 'ACTIVE'       TO ACVSTATO
 13793         END-IF
 13794     END-IF.
 13795
 13796     IF CM-AH-CURRENT-STATUS = '2'
 13797         MOVE 'PEND  '           TO ACVSTATO
 13798     END-IF.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 264
* EL130.cbl
 13799     IF CM-AH-CURRENT-STATUS = '3'
 13800         MOVE 'RESTORE'          TO ACVSTATO
 13801     END-IF.
 13802     IF CM-AH-CURRENT-STATUS = '5'
 13803         MOVE 'REISSUE'          TO ACVSTATO
 13804     END-IF.
 13805     IF CM-AH-CURRENT-STATUS = '6'
 13806         MOVE 'LMP DIS'          TO ACVSTATO
 13807     END-IF.
 13808     IF CM-AH-CURRENT-STATUS = '7'
 13809         MOVE 'DEATH  '          TO ACVSTATO
 13810     END-IF.
 13811     IF CM-AH-CURRENT-STATUS = '8'
 13812         MOVE 'CANCEL '          TO ACVSTATO
 13813     END-IF.
 13814     IF CM-AH-CURRENT-STATUS = '9'
 13815         MOVE 'RE-ONLY'          TO ACVSTATO
 13816     END-IF.
 13817     IF CM-AH-CURRENT-STATUS = 'V'
 13818         MOVE 'VOID   '          TO ACVSTATO
 13819     END-IF.
 13820     IF CM-AH-CURRENT-STATUS = 'D'
 13821         MOVE 'DECLINE'          TO ACVSTATO
 13822     END-IF.
 13823
 13824     IF PI-COMPANY-ID = 'DCC'
 13825        IF CM-ACCOUNT (9:2) = 'BI'
 13826           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 13827           MOVE CM-CARRIER       TO CTRLR-CARRIER
 13828           MOVE CM-GROUPING      TO CTRLR-GROUPING
 13829           MOVE CM-STATE         TO CTRLR-STATE
 13830           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 13831           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 13832           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 13833           MOVE 'C'              TO CTRLR-REC-TYPE
 13834
 13835* EXEC CICS READ
 13836*            DATASET  (ELCRTT-DSID)
 13837*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13838*            RIDFLD   (ELCRTT-KEY)
 13839*            RESP     (WS-RESPONSE)
 13840*          END-EXEC
 13841*    MOVE '&"S        E          (  N#00012602' TO DFHEIV0
 13842     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13843     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13844     MOVE X'204E233030303132363032' TO DFHEIV0(25:11)
 13845     CALL 'kxdfhei1' USING DFHEIV0,
 13846           ELCRTT-DSID,
 13847           DFHEIV20,
 13848           DFHEIV99,
 13849           ELCRTT-KEY,
 13850           DFHEIV99,
 13851           DFHEIV99,
 13852           DFHEIV99
 13853     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13854         DFHEIV20
 13855     MOVE EIBRESP  TO WS-RESPONSE
 13856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 265
* EL130.cbl
 13857           IF WS-RESP-NORMAL
 13858               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 13859               MOVE WS-DIAG-VIN-MSG TO DIAGO
 13860               MOVE AL-UANON        TO DIAGA
 13861           END-IF
 13862        END-IF
 13863     END-IF.
 13864
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 266
* EL130.cbl
 13866 7070-BUILD-MAP-FINISH.
 13867     MOVE CM-LOAN-APR            TO APRO.
 13868     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 13869     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 13870     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 13871     MOVE AL-UNNON               TO APRA
 13872                                    PMTFREQA.
 13873     MOVE AL-UANON               TO INDGRPA
 13874                                    PREMTYPA.
 13875
 13876     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 13877         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 13878         MOVE AL-UANON               TO REINCDA
 13879     END-IF.
 13880
 13881     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 13882*        NEXT SENTENCE
 13883         CONTINUE
 13884     ELSE
 13885         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 13886         MOVE ' '                TO DC-OPTION-CODE
 13887         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13888         IF NOT DATE-CONVERSION-ERROR
 13889             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 13890             MOVE AL-UANON            TO ADDONDTA
 13891         END-IF
 13892     END-IF.
 13893
 13894     IF CLAIM-SWITCH = 'N'
 13895         IF SEXL = ZEROS
 13896             MOVE CM-INSURED-SEX TO SEXO
 13897*            MOVE AL-UANON       TO SEXA
 13898         END-IF
 13899     END-IF.
 13900
 13901     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 13902         MOVE CM-MEMBER-NO       TO MEMBERO
 13903         MOVE AL-UANON           TO MEMBERA
 13904     END-IF.
 13905
 13906     IF MAINTI = 'A'
 13907         IF (LOANNOL = ZEROS OR
 13908             EIBAID = DFHPF5)
 13909             MOVE CM-LOAN-NUMBER TO LOANNOO
 13910             MOVE AL-UANON       TO LOANNOA
 13911         ELSE
 13912*            NEXT SENTENCE
 13913             CONTINUE
 13914         END-IF
 13915     ELSE
 13916         MOVE CM-LOAN-NUMBER     TO LOANNOO
 13917         MOVE AL-UANON           TO LOANNOA
 13918     END-IF.
 13919
 13920     IF MAINTI = 'A'
 13921         IF (LOANBALL = ZEROS OR
 13922             EIBAID = DFHPF5)
 13923             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 267
* EL130.cbl
 13924             MOVE AL-UNNON       TO LOANBALA
 13925         ELSE
 13926*            NEXT SENTENCE
 13927             CONTINUE
 13928         END-IF
 13929     ELSE
 13930         MOVE CM-LOAN-BALANCE    TO LOANBALO
 13931         MOVE AL-UNNON           TO LOANBALA
 13932     END-IF.
 13933
 13934     IF CM-PREMIUM-TYPE NOT = '3'
 13935         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 13936             PERFORM 7200-PROTECT-CERT-FIELDS
 13937         ELSE
 13938             PERFORM 7300-RESET-KEY-ATTRBS
 13939         END-IF
 13940     ELSE
 13941         PERFORM 7300-RESET-KEY-ATTRBS
 13942     END-IF.
 13943
 13944*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 13945*        NEXT SENTENCE
 13946*        CONTINUE
 13947*    ELSE
 13948         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 13949*    END-IF.
 13950
 13951 7099-EXIT.
 13952     EXIT.
 13953
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 268
* EL130.cbl
 13955 7100-READ-BENEFIT.
 13956
 13957
 13958* EXEC CICS HANDLE CONDITION
 13959*         NOTFND   (7120-NOT-FOUND)
 13960*    END-EXEC.
 13961*    MOVE '"$I                   ! E #00012708' TO DFHEIV0
 13962     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13963     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13964     MOVE X'4520233030303132373038' TO DFHEIV0(25:11)
 13965     CALL 'kxdfhei1' USING DFHEIV0
 13966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13967
 13968
 13969     MOVE SPACES                 TO ELCNTL-KEY.
 13970     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 13971     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 13972     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13973     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13974
 13975 7105-READ-FILE.
 13976     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 13977
 13978     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 13979        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 13980          GO TO 7120-NOT-FOUND
 13981     END-IF.
 13982
 13983     MOVE 1                      TO SUB.
 13984 7110-LOOP.
 13985     IF SUB = 9
 13986         GO TO 7120-NOT-FOUND
 13987     END-IF.
 13988
 13989     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 13990         ADD 1                   TO SUB
 13991         GO TO 7110-LOOP
 13992     END-IF.
 13993
 13994     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 13995     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 13996     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 13997
 13998     GO TO 7199-EXIT.
 13999
 14000 7120-NOT-FOUND.
 14001     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 14002                                    WS-FORM-HOLD.
 14003
 14004 7199-EXIT.
 14005      EXIT.
 14006
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 269
* EL130.cbl
 14008 7200-PROTECT-CERT-FIELDS.
 14009     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 14010                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 14011                                LCVFORMA ACVFORMA JNTLNMEA
 14012                                JNTFNMEA JNTINITA.
 14013
 14014     IF CM-LF-CURRENT-STATUS = '2' OR
 14015        CM-AH-CURRENT-STATUS = '2'
 14016         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 14017     END-IF.
 14018
 14019     MOVE AL-SANOF TO
 14020            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 14021            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 14022            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 14023            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 14024            LCVRATEA   ACVRATEA.
 14025
 14026     MOVE 'S'                    TO CERTMTI.
 14027
 14028 7300-RESET-KEY-ATTRBS.
 14029     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 14030                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 14031                                LCVFORMA ACVFORMA JNTLNMEA
 14032                                JNTFNMEA JNTINITA.
 14033
 14034     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 14035         MOVE AL-SANOF           TO REINCDA
 14036     END-IF.
 14037
 14038     MOVE 'S'                    TO CERTMTI.
 14039
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 270
* EL130.cbl
 14041 7400-READ-STATE.
 14042
 14043
 14044* EXEC CICS HANDLE CONDITION
 14045*         NOTFND   (7499-EXIT)
 14046*    END-EXEC.
 14047*    MOVE '"$I                   ! F #00012786' TO DFHEIV0
 14048     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14049     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14050     MOVE X'4620233030303132373836' TO DFHEIV0(25:11)
 14051     CALL 'kxdfhei1' USING DFHEIV0
 14052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14053
 14054
 14055     MOVE SPACES                 TO ELCNTL-KEY.
 14056     MOVE CM-STATE               TO CNTL-ACCESS.
 14057     MOVE '3'                    TO CNTL-REC-TYPE.
 14058     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14059     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14060
 14061     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14062
 14063     MOVE 1                      TO SUB.
 14064
 14065 7410-LOOP.
 14066     IF SUB = 21
 14067        GO TO 7499-EXIT
 14068     END-IF.
 14069
 14070*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 14071*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 14072*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 14073*        GO TO 7499-EXIT.
 14074
 14075     ADD 1                       TO SUB.
 14076     GO TO 7410-LOOP.
 14077
 14078 7499-EXIT.
 14079      EXIT.
 14080
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 271
* EL130.cbl
 14082 7500-BROWSE-FOR-DUPLICATE.
 14083
 14084     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 14085
 14086
 14087
 14088* EXEC CICS HANDLE CONDITION
 14089*        NOTFND   (7500-EXIT)
 14090*        DUPKEY   (7500-DUPLICATE-KEY)
 14091*        ENDFILE  (7500-EXIT)
 14092*    END-EXEC.
 14093*    MOVE '"$I$''                 ! G #00012822' TO DFHEIV0
 14094     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 14095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14096     MOVE X'4720233030303132383232' TO DFHEIV0(25:11)
 14097     CALL 'kxdfhei1' USING DFHEIV0
 14098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14099
 14100
 14101
 14102
 14103* EXEC CICS STARTBR
 14104*        DATASET    (ELMSTR5-DSID)
 14105*        RIDFLD     (ELMSTR5-KEY)
 14106*    END-EXEC.
 14107     MOVE 0
 14108       TO DFHEIV11
 14109*    MOVE '&,         G          &   #00012829' TO DFHEIV0
 14110     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14111     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14112     MOVE X'2020233030303132383239' TO DFHEIV0(25:11)
 14113     CALL 'kxdfhei1' USING DFHEIV0,
 14114           ELMSTR5-DSID,
 14115           ELMSTR5-KEY,
 14116           DFHEIV99,
 14117           DFHEIV11,
 14118           DFHEIV99
 14119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14120
 14121
 14122
 14123
 14124* EXEC CICS HANDLE CONDITION
 14125*        ENDFILE  (7500-END-BROWSE)
 14126*    END-EXEC.
 14127*    MOVE '"$''                   ! H #00012835' TO DFHEIV0
 14128     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14129     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14130     MOVE X'4820233030303132383335' TO DFHEIV0(25:11)
 14131     CALL 'kxdfhei1' USING DFHEIV0
 14132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14133
 14134
 14135 7500-READ-CLAIM-LOOP.
 14136
 14137
 14138
 14139* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 272
* EL130.cbl
 14140*        DATASET   (ELMSTR5-DSID)
 14141*        SET       (ADDRESS OF CLAIM-MASTER)
 14142*        RIDFLD    (ELMSTR5-KEY)
 14143*    END-EXEC.
 14144     MOVE 0
 14145       TO DFHEIV11
 14146*    MOVE '&.S                   )   #00012842' TO DFHEIV0
 14147     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14148     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14149     MOVE X'2020233030303132383432' TO DFHEIV0(25:11)
 14150     CALL 'kxdfhei1' USING DFHEIV0,
 14151           ELMSTR5-DSID,
 14152           DFHEIV20,
 14153           DFHEIV99,
 14154           ELMSTR5-KEY,
 14155           DFHEIV99,
 14156           DFHEIV11,
 14157           DFHEIV99,
 14158           DFHEIV99
 14159     SET ADDRESS OF CLAIM-MASTER TO
 14160         DFHEIV20
 14161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14162
 14163
 14164 7500-DUPLICATE-KEY.
 14165
 14166     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 14167        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 14168        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 14169        CL-CERT-STATE     NOT = CM-STATE       OR
 14170        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 14171        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 14172        CL-CERT-NO        NOT = CM-CERT-NO
 14173           GO TO 7500-CHECK-MATCH-COUNT
 14174     END-IF.
 14175
 14176     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 14177
 14178     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 14179        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 14180        GO TO 7500-END-BROWSE
 14181     ELSE
 14182        GO TO 7500-READ-CLAIM-LOOP
 14183     END-IF.
 14184
 14185 7500-CHECK-MATCH-COUNT.
 14186
 14187     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 14188        CL-CERT-NO    = CM-CERT-NO
 14189          GO TO 7500-READ-CLAIM-LOOP
 14190     END-IF.
 14191
 14192 7500-END-BROWSE.
 14193
 14194
 14195
 14196* EXEC CICS ENDBR
 14197*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 273
* EL130.cbl
 14198*    END-EXEC.
 14199     MOVE 0
 14200       TO DFHEIV11
 14201*    MOVE '&2                    $   #00012879' TO DFHEIV0
 14202     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14203     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14204     MOVE X'2020233030303132383739' TO DFHEIV0(25:11)
 14205     CALL 'kxdfhei1' USING DFHEIV0,
 14206           ELMSTR5-DSID,
 14207           DFHEIV11,
 14208           DFHEIV99
 14209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14210
 14211
 14212 7500-EXIT.
 14213     EXIT.
 14214
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 274
* EL130.cbl
 14216 7550-FALL-THRU-PARA.
 14217
 14218
 14219
 14220* EXEC CICS DUMP
 14221*         DUMPCODE ('E130')
 14222*         TASK
 14223*    END-EXEC.
 14224     MOVE 'E130' TO DFHEIV5
 14225*    MOVE '<"   T                $   #00012890' TO DFHEIV0
 14226     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 14227     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14228     MOVE X'2020233030303132383930' TO DFHEIV0(25:11)
 14229     CALL 'kxdfhei1' USING DFHEIV0,
 14230           DFHEIV5,
 14231           DFHEIV99,
 14232           DFHEIV99
 14233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14234
 14235
 14236
 14237
 14238* EXEC CICS RETURN
 14239*    END-EXEC.
 14240*    MOVE '.(                    ''   #00012896' TO DFHEIV0
 14241     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 14242     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14243     MOVE X'2020233030303132383936' TO DFHEIV0(25:11)
 14244     CALL 'kxdfhei1' USING DFHEIV0,
 14245           DFHEIV99,
 14246           DFHEIV99,
 14247           DFHEIV99,
 14248           DFHEIV99,
 14249           DFHEIV99,
 14250           DFHEIV99
 14251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14252
 14253
 14254 7600-BROWSE-CLAIM.
 14255
 14256
 14257
 14258* EXEC CICS READ
 14259*        DATASET(ELMSTR-DSID)
 14260*        SET    (ADDRESS OF CLAIM-MASTER)
 14261*        RIDFLD (ELMSTR-KEY)
 14262*        GENERIC
 14263*        EQUAL
 14264*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14265*    END-EXEC.
 14266*    MOVE '&"S  KG    E          (   #00012902' TO DFHEIV0
 14267     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14268     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14269     MOVE X'2020233030303132393032' TO DFHEIV0(25:11)
 14270     CALL 'kxdfhei1' USING DFHEIV0,
 14271           ELMSTR-DSID,
 14272           DFHEIV20,
 14273           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 275
* EL130.cbl
 14274           ELMSTR-KEY,
 14275           ELMSTR-GENERIC-LENGTH,
 14276           DFHEIV99,
 14277           DFHEIV99
 14278     SET ADDRESS OF CLAIM-MASTER TO
 14279         DFHEIV20
 14280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14281
 14282
 14283     MOVE CL-CERT-PRIME          TO CERTNOI.
 14284     MOVE CL-CERT-SFX            TO SUFXI.
 14285
 14286 7610-BROWSE-CLAIM-LOOP.
 14287
 14288     MOVE LOW-VALUES             TO BCERT1O
 14289                                    BSUFX1O
 14290                                    BCERT2O
 14291                                    BSUFX2O
 14292                                    BCERT3O
 14293                                    BSUFX3O
 14294                                    BCERT4O
 14295                                    BSUFX4O
 14296                                    BCERT5O
 14297                                    BSUFX5O.
 14298
 14299     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 14300
 14301
 14302
 14303* EXEC CICS HANDLE CONDITION
 14304*        ENDFILE  (7630-END-BROWSE)
 14305*    END-EXEC.
 14306*    MOVE '"$''                   ! I #00012930' TO DFHEIV0
 14307     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14308     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14309     MOVE X'4920233030303132393330' TO DFHEIV0(25:11)
 14310     CALL 'kxdfhei1' USING DFHEIV0
 14311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14312
 14313
 14314
 14315
 14316* EXEC CICS STARTBR
 14317*        DATASET    (ELMSTR-DSID)
 14318*        RIDFLD     (ELMSTR-KEY)
 14319*    END-EXEC.
 14320     MOVE 0
 14321       TO DFHEIV11
 14322*    MOVE '&,         G          &   #00012935' TO DFHEIV0
 14323     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14324     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14325     MOVE X'2020233030303132393335' TO DFHEIV0(25:11)
 14326     CALL 'kxdfhei1' USING DFHEIV0,
 14327           ELMSTR-DSID,
 14328           ELMSTR-KEY,
 14329           DFHEIV99,
 14330           DFHEIV11,
 14331           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 276
* EL130.cbl
 14332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14333
 14334
 14335     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 14336
 14337 7620-READ-CLAIM-LOOP.
 14338
 14339
 14340
 14341* EXEC CICS READNEXT
 14342*        DATASET   (ELMSTR-DSID)
 14343*        SET       (ADDRESS OF CLAIM-MASTER)
 14344*        RIDFLD    (ELMSTR-KEY)
 14345*    END-EXEC.
 14346     MOVE 0
 14347       TO DFHEIV11
 14348*    MOVE '&.S                   )   #00012945' TO DFHEIV0
 14349     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14350     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14351     MOVE X'2020233030303132393435' TO DFHEIV0(25:11)
 14352     CALL 'kxdfhei1' USING DFHEIV0,
 14353           ELMSTR-DSID,
 14354           DFHEIV20,
 14355           DFHEIV99,
 14356           ELMSTR-KEY,
 14357           DFHEIV99,
 14358           DFHEIV11,
 14359           DFHEIV99,
 14360           DFHEIV99
 14361     SET ADDRESS OF CLAIM-MASTER TO
 14362         DFHEIV20
 14363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14364
 14365
 14366     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 14367        CL-CARRIER     NOT = CLMCARRI       OR
 14368        CL-CLAIM-NO    NOT = CLMNOI
 14369          GO TO 7630-END-BROWSE
 14370     END-IF.
 14371
 14372     IF WS-ASSOCIATED-CERTS = 1
 14373         MOVE CL-CERT-PRIME      TO BCERT1O
 14374         MOVE CL-CERT-SFX        TO BSUFX1O
 14375     END-IF.
 14376
 14377     IF WS-ASSOCIATED-CERTS = 2
 14378         MOVE CL-CERT-PRIME      TO BCERT2O
 14379         MOVE CL-CERT-SFX        TO BSUFX2O
 14380     END-IF.
 14381
 14382     IF WS-ASSOCIATED-CERTS = 3
 14383         MOVE CL-CERT-PRIME      TO BCERT3O
 14384         MOVE CL-CERT-SFX        TO BSUFX3O
 14385     END-IF.
 14386
 14387     IF WS-ASSOCIATED-CERTS = 4
 14388         MOVE CL-CERT-PRIME      TO BCERT4O
 14389         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 277
* EL130.cbl
 14390     END-IF.
 14391
 14392     IF WS-ASSOCIATED-CERTS = 5
 14393         MOVE CL-CERT-PRIME      TO BCERT5O
 14394         MOVE CL-CERT-SFX        TO BSUFX5O
 14395     ELSE
 14396         ADD +1                  TO WS-ASSOCIATED-CERTS
 14397         GO TO 7620-READ-CLAIM-LOOP
 14398     END-IF.
 14399
 14400 7630-END-BROWSE.
 14401
 14402
 14403
 14404* EXEC CICS ENDBR
 14405*        DATASET   (ELMSTR-DSID)
 14406*    END-EXEC.
 14407     MOVE 0
 14408       TO DFHEIV11
 14409*    MOVE '&2                    $   #00012988' TO DFHEIV0
 14410     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14411     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14412     MOVE X'2020233030303132393838' TO DFHEIV0(25:11)
 14413     CALL 'kxdfhei1' USING DFHEIV0,
 14414           ELMSTR-DSID,
 14415           DFHEIV11,
 14416           DFHEIV99
 14417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14418
 14419
 14420 7640-HIGHLIGHT-CERT-DISPLAYED.
 14421
 14422     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 14423     MOVE AL-SANON               TO BCERT1A
 14424                                    BSUFX1A
 14425                                    BCERT2A
 14426                                    BSUFX2A
 14427                                    BCERT3A
 14428                                    BSUFX3A
 14429                                    BCERT4A
 14430                                    BSUFX4A
 14431                                    BCERT5A
 14432                                    BSUFX5A.
 14433
 14434     IF BCERT1O = CERTNOI AND
 14435        BSUFX1O = SUFXI
 14436            MOVE AL-SABON        TO BCERT1A
 14437                                    BSUFX1A
 14438     END-IF.
 14439
 14440     IF BCERT2O = CERTNOI AND
 14441        BSUFX2O = SUFXI
 14442            MOVE AL-SABON        TO BCERT2A
 14443                                    BSUFX2A
 14444     END-IF.
 14445
 14446     IF BCERT3O = CERTNOI AND
 14447        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 278
* EL130.cbl
 14448            MOVE AL-SABON        TO BCERT3A
 14449                                    BSUFX3A
 14450     END-IF.
 14451
 14452     IF BCERT4O = CERTNOI AND
 14453        BSUFX4O = SUFXI
 14454            MOVE AL-SABON        TO BCERT4A
 14455                                    BSUFX4A
 14456     END-IF.
 14457
 14458     IF BCERT5O = CERTNOI AND
 14459        BSUFX5O = SUFXI
 14460            MOVE AL-SABON        TO BCERT5A
 14461                                    BSUFX5A
 14462     END-IF.
 14463
 14464 7699-EXIT.
 14465     EXIT.
 14466
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 279
* EL130.cbl
 14468 7700-CHECK-SEQUENCE.
 14469
 14470
 14471
 14472* EXEC CICS HANDLE CONDITION
 14473*        ENDFILE  (7799-EXIT)
 14474*        NOTFND   (7799-EXIT)
 14475*    END-EXEC.
 14476*    MOVE '"$''I                  ! J #00013043' TO DFHEIV0
 14477     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 14478     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14479     MOVE X'4A20233030303133303433' TO DFHEIV0(25:11)
 14480     CALL 'kxdfhei1' USING DFHEIV0
 14481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14482
 14483
 14484
 14485
 14486* EXEC CICS READ
 14487*        DATASET(ELMSTR-DSID)
 14488*        SET    (ADDRESS OF CLAIM-MASTER)
 14489*        RIDFLD (ELMSTR-KEY)
 14490*        GENERIC
 14491*        EQUAL
 14492*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14493*    END-EXEC.
 14494*    MOVE '&"S  KG    E          (   #00013049' TO DFHEIV0
 14495     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14496     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14497     MOVE X'2020233030303133303439' TO DFHEIV0(25:11)
 14498     CALL 'kxdfhei1' USING DFHEIV0,
 14499           ELMSTR-DSID,
 14500           DFHEIV20,
 14501           DFHEIV99,
 14502           ELMSTR-KEY,
 14503           ELMSTR-GENERIC-LENGTH,
 14504           DFHEIV99,
 14505           DFHEIV99
 14506     SET ADDRESS OF CLAIM-MASTER TO
 14507         DFHEIV20
 14508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14509
 14510
 14511     COMPUTE WS-ASSOC-CERT-TOTAL =
 14512             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 14513
 14514     GO TO 7799-EXIT.
 14515
 14516 7710-RESEQUENCE-CLAIMS.
 14517
 14518
 14519
 14520* EXEC CICS HANDLE CONDITION
 14521*        ENDFILE  (7790-END-BROWSE)
 14522*    END-EXEC.
 14523*    MOVE '"$''                   ! K #00013066' TO DFHEIV0
 14524     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14525     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 280
* EL130.cbl
 14526     MOVE X'4B20233030303133303636' TO DFHEIV0(25:11)
 14527     CALL 'kxdfhei1' USING DFHEIV0
 14528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14529
 14530
 14531
 14532
 14533* EXEC CICS STARTBR
 14534*        DATASET    (ELMSTR-DSID)
 14535*        RIDFLD     (ELMSTR-KEY)
 14536*    END-EXEC.
 14537     MOVE 0
 14538       TO DFHEIV11
 14539*    MOVE '&,         G          &   #00013071' TO DFHEIV0
 14540     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14541     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14542     MOVE X'2020233030303133303731' TO DFHEIV0(25:11)
 14543     CALL 'kxdfhei1' USING DFHEIV0,
 14544           ELMSTR-DSID,
 14545           ELMSTR-KEY,
 14546           DFHEIV99,
 14547           DFHEIV11,
 14548           DFHEIV99
 14549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14550
 14551
 14552     ADD +1 TO WS-ASSOC-CERT-SEQU
 14553               WS-READNEXT-SWITCH.
 14554
 14555 7720-READ-CLAIM-LOOP.
 14556
 14557
 14558
 14559* EXEC CICS READNEXT
 14560*        DATASET   (ELMSTR-DSID)
 14561*        SET       (ADDRESS OF CLAIM-MASTER)
 14562*        RIDFLD    (ELMSTR-KEY)
 14563*    END-EXEC.
 14564     MOVE 0
 14565       TO DFHEIV11
 14566*    MOVE '&.S                   )   #00013082' TO DFHEIV0
 14567     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14568     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14569     MOVE X'2020233030303133303832' TO DFHEIV0(25:11)
 14570     CALL 'kxdfhei1' USING DFHEIV0,
 14571           ELMSTR-DSID,
 14572           DFHEIV20,
 14573           DFHEIV99,
 14574           ELMSTR-KEY,
 14575           DFHEIV99,
 14576           DFHEIV11,
 14577           DFHEIV99,
 14578           DFHEIV99
 14579     SET ADDRESS OF CLAIM-MASTER TO
 14580         DFHEIV20
 14581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14582
 14583
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 281
* EL130.cbl
 14584     IF WS-READNEXT-SWITCH = 1
 14585         ADD 1 TO WS-READNEXT-SWITCH
 14586         GO TO 7720-READ-CLAIM-LOOP
 14587     END-IF.
 14588
 14589 7730-END-BROWSE.
 14590
 14591
 14592
 14593* EXEC CICS ENDBR
 14594*        DATASET   (ELMSTR-DSID)
 14595*    END-EXEC.
 14596     MOVE 0
 14597       TO DFHEIV11
 14598*    MOVE '&2                    $   #00013096' TO DFHEIV0
 14599     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14600     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14601     MOVE X'2020233030303133303936' TO DFHEIV0(25:11)
 14602     CALL 'kxdfhei1' USING DFHEIV0,
 14603           ELMSTR-DSID,
 14604           DFHEIV11,
 14605           DFHEIV99
 14606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14607
 14608
 14609 7740-READ-CLAIM-UPDATE.
 14610
 14611     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 14612        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 14613        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 14614          GO TO 7799-EXIT
 14615     ELSE
 14616          MOVE ZERO              TO WS-READNEXT-SWITCH
 14617     END-IF.
 14618
 14619
 14620
 14621* EXEC CICS READ
 14622*        DATASET(ELMSTR-DSID)
 14623*        SET    (ADDRESS OF CLAIM-MASTER)
 14624*        RIDFLD (ELMSTR-KEY)
 14625*        UPDATE
 14626*    END-EXEC.
 14627*    MOVE '&"S        EU         (   #00013111' TO DFHEIV0
 14628     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14629     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14630     MOVE X'2020233030303133313131' TO DFHEIV0(25:11)
 14631     CALL 'kxdfhei1' USING DFHEIV0,
 14632           ELMSTR-DSID,
 14633           DFHEIV20,
 14634           DFHEIV99,
 14635           ELMSTR-KEY,
 14636           DFHEIV99,
 14637           DFHEIV99,
 14638           DFHEIV99
 14639     SET ADDRESS OF CLAIM-MASTER TO
 14640         DFHEIV20
 14641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 282
* EL130.cbl
 14642
 14643
 14644     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 14645     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 14646
 14647
 14648
 14649* EXEC CICS REWRITE
 14650*         DATASET     (ELMSTR-DSID)
 14651*         FROM        (CLAIM-MASTER)
 14652*    END-EXEC.
 14653     MOVE LENGTH OF
 14654      CLAIM-MASTER
 14655       TO DFHEIV11
 14656*    MOVE '&& L                  %   #00013122' TO DFHEIV0
 14657     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14658     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14659     MOVE X'2020233030303133313232' TO DFHEIV0(25:11)
 14660     CALL 'kxdfhei1' USING DFHEIV0,
 14661           ELMSTR-DSID,
 14662           CLAIM-MASTER,
 14663           DFHEIV11,
 14664           DFHEIV99
 14665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14666
 14667
 14668     GO TO 7710-RESEQUENCE-CLAIMS.
 14669
 14670 7790-END-BROWSE.
 14671
 14672
 14673
 14674* EXEC CICS ENDBR
 14675*        DATASET   (ELMSTR-DSID)
 14676*    END-EXEC.
 14677     MOVE 0
 14678       TO DFHEIV11
 14679*    MOVE '&2                    $   #00013132' TO DFHEIV0
 14680     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14681     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14682     MOVE X'2020233030303133313332' TO DFHEIV0(25:11)
 14683     CALL 'kxdfhei1' USING DFHEIV0,
 14684           ELMSTR-DSID,
 14685           DFHEIV11,
 14686           DFHEIV99
 14687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14688
 14689
 14690 7799-EXIT.
 14691     EXIT.
 14692
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 283
* EL130.cbl
 14694************************************************
 14695*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 14696************************************************
 14697
 14698 7900-READ-ACTV-UPDATE.
 14699     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14700     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14701     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14702     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14703     MOVE +0                     TO TRLR-SEQ-NO.
 14704     MOVE '1'                    TO TRLR-TYPE.
 14705     GO TO 7900-READ-TRAILER-UPDATE.
 14706
 14707 7900-READ-NINETY-UPDATE.
 14708     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14709     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14710     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14711     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14712     MOVE +90                    TO TRLR-SEQ-NO.
 14713     MOVE '6'                    TO TRLR-TYPE.
 14714
 14715 7900-READ-TRAILER-UPDATE.
 14716
 14717
 14718* EXEC CICS READ  UPDATE
 14719*        DATASET    (ELTRLR-DSID)
 14720*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 14721*        RIDFLD     (ELTRLR-KEY)
 14722*    END-EXEC.
 14723*    MOVE '&"S        EU         (   #00013163' TO DFHEIV0
 14724     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14725     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14726     MOVE X'2020233030303133313633' TO DFHEIV0(25:11)
 14727     CALL 'kxdfhei1' USING DFHEIV0,
 14728           ELTRLR-DSID,
 14729           DFHEIV20,
 14730           DFHEIV99,
 14731           ELTRLR-KEY,
 14732           DFHEIV99,
 14733           DFHEIV99,
 14734           DFHEIV99
 14735     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14736         DFHEIV20
 14737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14738
 14739
 14740 7900-EXIT.
 14741      EXIT.
 14742
 14743 7910-READ-ACTV.
 14744     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14745     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14746     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14747     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14748     MOVE +0                     TO TRLR-SEQ-NO.
 14749     MOVE '1'                    TO TRLR-TYPE.
 14750     GO TO 7910-READ-TRAILER.
 14751
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 284
* EL130.cbl
 14752 7910-READ-NINETY.
 14753     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14754     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14755     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14756     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14757     MOVE +90                    TO TRLR-SEQ-NO.
 14758     MOVE '6'                    TO TRLR-TYPE.
 14759
 14760 7910-READ-TRAILER.
 14761     MOVE 'TRLR'                 TO FILE-SWITCH.
 14762
 14763
 14764
 14765* EXEC CICS READ
 14766*        DATASET   (ELTRLR-DSID)
 14767*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14768*        RIDFLD    (ELTRLR-KEY)
 14769*    END-EXEC.
 14770*    MOVE '&"S        E          (   #00013193' TO DFHEIV0
 14771     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14772     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14773     MOVE X'2020233030303133313933' TO DFHEIV0(25:11)
 14774     CALL 'kxdfhei1' USING DFHEIV0,
 14775           ELTRLR-DSID,
 14776           DFHEIV20,
 14777           DFHEIV99,
 14778           ELTRLR-KEY,
 14779           DFHEIV99,
 14780           DFHEIV99,
 14781           DFHEIV99
 14782     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14783         DFHEIV20
 14784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14785
 14786
 14787 7910-EXIT.
 14788      EXIT.
 14789
 14790 7915-REWRITE-TRAILER.
 14791
 14792
 14793* EXEC CICS REWRITE
 14794*        DATASET   (ELTRLR-DSID)
 14795*        FROM      (ACTIVITY-TRAILERS)
 14796*    END-EXEC.
 14797     MOVE LENGTH OF
 14798      ACTIVITY-TRAILERS
 14799       TO DFHEIV11
 14800*    MOVE '&& L                  %   #00013204' TO DFHEIV0
 14801     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14802     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14803     MOVE X'2020233030303133323034' TO DFHEIV0(25:11)
 14804     CALL 'kxdfhei1' USING DFHEIV0,
 14805           ELTRLR-DSID,
 14806           ACTIVITY-TRAILERS,
 14807           DFHEIV11,
 14808           DFHEIV99
 14809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 285
* EL130.cbl
 14810
 14811
 14812 7915-EXIT.
 14813      EXIT.
 14814
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 286
* EL130.cbl
 14816********************************************
 14817*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 14818********************************************
 14819
 14820 7920-READ-CLAIM-UPDATE.
 14821
 14822
 14823
 14824* EXEC CICS READ
 14825*        UPDATE
 14826*        DATASET   (ELMSTR-DSID)
 14827*        SET       (ADDRESS OF CLAIM-MASTER)
 14828*        RIDFLD    (ELMSTR-KEY)
 14829*    END-EXEC.
 14830*    MOVE '&"S        EU         (   #00013220' TO DFHEIV0
 14831     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14832     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14833     MOVE X'2020233030303133323230' TO DFHEIV0(25:11)
 14834     CALL 'kxdfhei1' USING DFHEIV0,
 14835           ELMSTR-DSID,
 14836           DFHEIV20,
 14837           DFHEIV99,
 14838           ELMSTR-KEY,
 14839           DFHEIV99,
 14840           DFHEIV99,
 14841           DFHEIV99
 14842     SET ADDRESS OF CLAIM-MASTER TO
 14843         DFHEIV20
 14844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14845
 14846
 14847 7920-EXIT.
 14848      EXIT.
 14849
 14850 7950-READ-CLAIM.
 14851
 14852
 14853* EXEC CICS READ
 14854*        DATASET   (ELMSTR-DSID)
 14855*        SET       (ADDRESS OF CLAIM-MASTER)
 14856*        RIDFLD    (ELMSTR-KEY)
 14857*    END-EXEC.
 14858*    MOVE '&"S        E          (   #00013232' TO DFHEIV0
 14859     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14860     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14861     MOVE X'2020233030303133323332' TO DFHEIV0(25:11)
 14862     CALL 'kxdfhei1' USING DFHEIV0,
 14863           ELMSTR-DSID,
 14864           DFHEIV20,
 14865           DFHEIV99,
 14866           ELMSTR-KEY,
 14867           DFHEIV99,
 14868           DFHEIV99,
 14869           DFHEIV99
 14870     SET ADDRESS OF CLAIM-MASTER TO
 14871         DFHEIV20
 14872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14873
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 287
* EL130.cbl
 14874
 14875 7950-EXIT.
 14876      EXIT.
 14877
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 288
* EL130.cbl
 14879***************************************
 14880*  I/O REQUESTS AGAINST CONTROL FILE  *
 14881***************************************
 14882
 14883 7960-READ-CNTL-UPDATE.
 14884
 14885
 14886* EXEC CICS READ
 14887*        UPDATE
 14888*        DATASET  (ELCNTL-DSID)
 14889*        SET      (ADDRESS OF CONTROL-FILE)
 14890*        RIDFLD   (ELCNTL-KEY)
 14891*    END-EXEC.
 14892*    MOVE '&"S        EU         (   #00013248' TO DFHEIV0
 14893     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14894     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14895     MOVE X'2020233030303133323438' TO DFHEIV0(25:11)
 14896     CALL 'kxdfhei1' USING DFHEIV0,
 14897           ELCNTL-DSID,
 14898           DFHEIV20,
 14899           DFHEIV99,
 14900           ELCNTL-KEY,
 14901           DFHEIV99,
 14902           DFHEIV99,
 14903           DFHEIV99
 14904     SET ADDRESS OF CONTROL-FILE TO
 14905         DFHEIV20
 14906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14907
 14908
 14909 7960-EXIT.
 14910      EXIT.
 14911
 14912 7970-READ-CNTL.
 14913
 14914
 14915* EXEC CICS READ
 14916*        DATASET  (ELCNTL-DSID)
 14917*        SET      (ADDRESS OF CONTROL-FILE)
 14918*        RIDFLD   (ELCNTL-KEY)
 14919*    END-EXEC.
 14920*    MOVE '&"S        E          (   #00013260' TO DFHEIV0
 14921     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14922     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14923     MOVE X'2020233030303133323630' TO DFHEIV0(25:11)
 14924     CALL 'kxdfhei1' USING DFHEIV0,
 14925           ELCNTL-DSID,
 14926           DFHEIV20,
 14927           DFHEIV99,
 14928           ELCNTL-KEY,
 14929           DFHEIV99,
 14930           DFHEIV99,
 14931           DFHEIV99
 14932     SET ADDRESS OF CONTROL-FILE TO
 14933         DFHEIV20
 14934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14935
 14936
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 289
* EL130.cbl
 14937 7970-EXIT.
 14938      EXIT.
 14939
 14940 7975-READ-CNTL-GTEQ.
 14941
 14942
 14943* EXEC CICS READ
 14944*         DATASET   (ELCNTL-DSID)
 14945*         SET       (ADDRESS OF CONTROL-FILE)
 14946*         RIDFLD    (ELCNTL-KEY)
 14947*         GTEQ
 14948*     END-EXEC.
 14949*    MOVE '&"S        G          (   #00013271' TO DFHEIV0
 14950     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14951     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14952     MOVE X'2020233030303133323731' TO DFHEIV0(25:11)
 14953     CALL 'kxdfhei1' USING DFHEIV0,
 14954           ELCNTL-DSID,
 14955           DFHEIV20,
 14956           DFHEIV99,
 14957           ELCNTL-KEY,
 14958           DFHEIV99,
 14959           DFHEIV99,
 14960           DFHEIV99
 14961     SET ADDRESS OF CONTROL-FILE TO
 14962         DFHEIV20
 14963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14964
 14965
 14966 7975-EXIT.
 14967      EXIT.
 14968
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 290
* EL130.cbl
 14970**************************************************
 14971*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 14972**************************************************
 14973
 14974 7980-READ-CERT5.
 14975
 14976
 14977* EXEC CICS READ
 14978*         DATASET  (ELCERT5-DSID)
 14979*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14980*         RIDFLD   (ELCERT-KEY-5)
 14981*     END-EXEC.
 14982*    MOVE '&"S        E          (   #00013288' TO DFHEIV0
 14983     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14985     MOVE X'2020233030303133323838' TO DFHEIV0(25:11)
 14986     CALL 'kxdfhei1' USING DFHEIV0,
 14987           ELCERT5-DSID,
 14988           DFHEIV20,
 14989           DFHEIV99,
 14990           ELCERT-KEY-5,
 14991           DFHEIV99,
 14992           DFHEIV99,
 14993           DFHEIV99
 14994     SET ADDRESS OF CERTIFICATE-MASTER TO
 14995         DFHEIV20
 14996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14997
 14998
 14999 7980-EXIT.
 15000      EXIT.
 15001
 15002 7930-READ-CERT-UPDATE.
 15003
 15004
 15005* EXEC CICS READ
 15006*        DATASET  (ELCERT-DSID)
 15007*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 15008*        RIDFLD   (ELCERT-KEY)
 15009*        UPDATE
 15010*    END-EXEC.
 15011*    MOVE '&"S        EU         (   #00013299' TO DFHEIV0
 15012     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15013     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15014     MOVE X'2020233030303133323939' TO DFHEIV0(25:11)
 15015     CALL 'kxdfhei1' USING DFHEIV0,
 15016           ELCERT-DSID,
 15017           DFHEIV20,
 15018           DFHEIV99,
 15019           ELCERT-KEY,
 15020           DFHEIV99,
 15021           DFHEIV99,
 15022           DFHEIV99
 15023     SET ADDRESS OF CERTIFICATE-MASTER TO
 15024         DFHEIV20
 15025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15026
 15027
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 291
* EL130.cbl
 15028 7930-EXIT.
 15029      EXIT.
 15030
 15031 7940-READ-CERT.
 15032
 15033
 15034* EXEC CICS READ
 15035*        DATASET  (ELCERT-DSID)
 15036*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 15037*        RIDFLD   (ELCERT-KEY)
 15038*    END-EXEC.
 15039*    MOVE '&"S        E          (   #00013311' TO DFHEIV0
 15040     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15041     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15042     MOVE X'2020233030303133333131' TO DFHEIV0(25:11)
 15043     CALL 'kxdfhei1' USING DFHEIV0,
 15044           ELCERT-DSID,
 15045           DFHEIV20,
 15046           DFHEIV99,
 15047           ELCERT-KEY,
 15048           DFHEIV99,
 15049           DFHEIV99,
 15050           DFHEIV99
 15051     SET ADDRESS OF CERTIFICATE-MASTER TO
 15052         DFHEIV20
 15053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15054
 15055
 15056 7940-EXIT.
 15057      EXIT.
 15058
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 292
* EL130.cbl
 15060**************************************************
 15061*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 15062**************************************************
 15063
 15064 7991-READ-BENE.
 15065
 15066
 15067* EXEC CICS READ
 15068*         DATASET   (ELBENE-DSID)
 15069*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 15070*         RIDFLD    (ELBENE-KEY)
 15071*     END-EXEC.
 15072*    MOVE '&"S        E          (   #00013327' TO DFHEIV0
 15073     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15074     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15075     MOVE X'2020233030303133333237' TO DFHEIV0(25:11)
 15076     CALL 'kxdfhei1' USING DFHEIV0,
 15077           ELBENE-DSID,
 15078           DFHEIV20,
 15079           DFHEIV99,
 15080           ELBENE-KEY,
 15081           DFHEIV99,
 15082           DFHEIV99,
 15083           DFHEIV99
 15084     SET ADDRESS OF BENEFICIARY-MASTER TO
 15085         DFHEIV20
 15086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15087
 15088
 15089 7991-EXIT.
 15090      EXIT.
 15091
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 293
* EL130.cbl
 15093**************************************************
 15094*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 15095**************************************************
 15096
 15097 7992-READ-REIN.
 15098
 15099
 15100
 15101* EXEC CICS HANDLE CONDITION
 15102*        NOTFND   (7992-NOT-FOUND)
 15103*    END-EXEC.
 15104*    MOVE '"$I                   ! L #00013344' TO DFHEIV0
 15105     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15107     MOVE X'4C20233030303133333434' TO DFHEIV0(25:11)
 15108     CALL 'kxdfhei1' USING DFHEIV0
 15109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15110
 15111
 15112
 15113
 15114* EXEC CICS READ
 15115*        DATASET   (ERREIN-DSID)
 15116*        SET       (ADDRESS OF REINSURANCE-RECORD)
 15117*        RIDFLD    (ERREIN-KEY)
 15118*    END-EXEC.
 15119*    MOVE '&"S        E          (   #00013349' TO DFHEIV0
 15120     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15121     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15122     MOVE X'2020233030303133333439' TO DFHEIV0(25:11)
 15123     CALL 'kxdfhei1' USING DFHEIV0,
 15124           ERREIN-DSID,
 15125           DFHEIV20,
 15126           DFHEIV99,
 15127           ERREIN-KEY,
 15128           DFHEIV99,
 15129           DFHEIV99,
 15130           DFHEIV99
 15131     SET ADDRESS OF REINSURANCE-RECORD TO
 15132         DFHEIV20
 15133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15134
 15135
 15136     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 15137
 15138     GO TO 7992-EXIT.
 15139
 15140 7992-NOT-FOUND.
 15141     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 15142
 15143 7992-EXIT.
 15144     EXIT.
 15145
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 294
* EL130.cbl
 15147 8000-LOAD-ERROR-MESSAGES.
 15148     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 15149
 15150     IF EMI-NO-ERRORS
 15151         GO TO 8000-EXIT
 15152     END-IF.
 15153
 15154     IF EMI-NUMBER-OF-LINES = 1
 15155         MOVE EMI-LINE1          TO ERRMSG1O
 15156         GO TO 8000-EXIT
 15157     END-IF.
 15158
 15159     IF EMI-NUMBER-OF-LINES = 2
 15160          MOVE EMI-LINE1         TO ERRMSG1O
 15161          MOVE EMI-LINE2         TO ERRMSG2O
 15162          GO TO 8000-EXIT
 15163     END-IF.
 15164
 15165     MOVE EMI-LINE1              TO ERRMSG1O.
 15166
 15167 8000-EXIT.
 15168     EXIT.
 15169
 15170 8100-SEND-INITIAL-MAP.
 15171     MOVE SAVE-DATE              TO RUNDTEO.
 15172     MOVE EIBTIME                TO TIME-IN.
 15173     MOVE TIME-OUT               TO RUNTIMEO.
 15174     IF RETURNED-FROM = XCTL-114
 15175        CONTINUE
 15176     ELSE
 15177        MOVE -1                  TO MAINTL
 15178     END-IF.
 15179
 15180*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15181         MOVE SPACES             TO PRODO.
 15182         MOVE AL-SANOF           TO PRODCDA.
 15183*    END-IF.
 15184
 15185     MOVE PI-COMPANY-ID          TO COMPO.
 15186     MOVE AL-PABOF               TO COMPA.
 15187     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15188     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15189     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15190
 15191     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15192
 15193     IF NOT PI-NO-CARRIER-SECURITY
 15194        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 15195        MOVE AL-SABOF            TO CLMCARRA
 15196     END-IF.
 15197
 15198     IF PI-PROCESSOR-ID = 'PEMA'
 15199        MOVE AL-UANON            TO CERTNOA
 15200                                    SUFXA
 15201     END-IF.
 15202*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15203*        NEXT SENTENCE
 15204*        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 295
* EL130.cbl
 15205*    ELSE
 15206         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15207*    END-IF.
 15208
 15209
 15210
 15211* EXEC CICS SEND
 15212*        MAP     (MAP-NAME)
 15213*        MAPSET  (MAPSET-NAME)
 15214*        FROM    (EL130AO)
 15215*        ERASE
 15216*        CURSOR
 15217*    END-EXEC.
 15218     MOVE LENGTH OF
 15219      EL130AO
 15220       TO DFHEIV12
 15221     MOVE -1
 15222       TO DFHEIV11
 15223*    MOVE '8$     CT  E    H L F ,   #00013429' TO DFHEIV0
 15224     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15225     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15226     MOVE X'2020233030303133343239' TO DFHEIV0(25:11)
 15227     CALL 'kxdfhei1' USING DFHEIV0,
 15228           MAP-NAME,
 15229           EL130AO,
 15230           DFHEIV12,
 15231           MAPSET-NAME,
 15232           DFHEIV99,
 15233           DFHEIV99,
 15234           DFHEIV99,
 15235           DFHEIV11,
 15236           DFHEIV99,
 15237           DFHEIV99,
 15238           DFHEIV99
 15239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15240
 15241
 15242     GO TO 9100-RETURN-TRAN.
 15243
 15244 8150-SEND-MAP-CURSOR.
 15245     MOVE SAVE-DATE              TO RUNDTEO.
 15246     MOVE EIBTIME                TO TIME-IN.
 15247     MOVE TIME-OUT               TO RUNTIMEO.
 15248     MOVE PI-COMPANY-ID          TO COMPO.
 15249     MOVE AL-PABOF               TO COMPA
 15250     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15251     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15252     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15253
 15254*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15255         MOVE SPACES             TO PRODO.
 15256         MOVE AL-SANOF           TO PRODCDA.
 15257*    END-IF.
 15258
 15259     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15260
 15261     IF NOT PI-NO-CARRIER-SECURITY
 15262         MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 296
* EL130.cbl
 15263         MOVE AL-SABOF            TO CLMCARRA
 15264     END-IF.
 15265
 15266     IF PI-PROCESSOR-ID = 'PEMA'
 15267        MOVE AL-UANON            TO CERTNOA
 15268                                    SUFXA
 15269     END-IF.
 15270*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15271*        NEXT SENTENCE
 15272*        CONTINUE
 15273*    ELSE
 15274         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15275*    END-IF.
 15276
 15277
 15278
 15279* EXEC CICS SEND
 15280*        MAP      (MAP-NAME)
 15281*        MAPSET   (MAPSET-NAME)
 15282*        FROM     (EL130AO)
 15283*        CURSOR   (PI-CURSOR)
 15284*        ERASE
 15285*    END-EXEC.
 15286     MOVE LENGTH OF
 15287      EL130AO
 15288       TO DFHEIV11
 15289*    MOVE '8$     CT  E    H L F ,   #00013473' TO DFHEIV0
 15290     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15291     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15292     MOVE X'2020233030303133343733' TO DFHEIV0(25:11)
 15293     CALL 'kxdfhei1' USING DFHEIV0,
 15294           MAP-NAME,
 15295           EL130AO,
 15296           DFHEIV11,
 15297           MAPSET-NAME,
 15298           DFHEIV99,
 15299           DFHEIV99,
 15300           DFHEIV99,
 15301           PI-CURSOR,
 15302           DFHEIV99,
 15303           DFHEIV99,
 15304           DFHEIV99
 15305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15306
 15307
 15308     GO TO 9100-RETURN-TRAN.
 15309
 15310 8200-SEND-DATAONLY.
 15311     IF EIBAID = DFHPF11
 15312        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 15313        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15314     END-IF.
 15315
 15316     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15317
 15318 8200-BYPASS-ERROR.
 15319     MOVE SAVE-DATE              TO RUNDTEO.
 15320     MOVE EIBTIME                TO TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 297
* EL130.cbl
 15321     MOVE TIME-OUT               TO RUNTIMEO.
 15322     MOVE PI-COMPANY-ID          TO COMPO.
 15323     MOVE AL-PABOF               TO COMPA
 15324     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15325
 15326*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15327         MOVE SPACES             TO PRODO.
 15328         MOVE AL-SANOF           TO PRODCDA.
 15329*    END-IF.
 15330
 15331     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15332     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15333
 15334     IF PI-PROCESSOR-ID = 'PEMA'
 15335        MOVE AL-UANON            TO CERTNOA
 15336                                    SUFXA
 15337     END-IF.
 15338     IF NOT PI-NO-CARRIER-SECURITY
 15339        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 15340        MOVE AL-SABOF            TO CLMCARRA
 15341     END-IF.
 15342
 15343*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15344*        NEXT SENTENCE
 15345*        CONTINUE
 15346*    ELSE
 15347         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15348*    END-IF.
 15349
 15350*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 15351         MOVE AL-SANOF           TO PRODCDA.
 15352*    END-IF.
 15353
 15354
 15355
 15356* EXEC CICS SEND
 15357*        MAP      (MAP-NAME)
 15358*        MAPSET   (MAPSET-NAME)
 15359*        FROM     (EL130AO)
 15360*        DATAONLY
 15361*        CURSOR
 15362*    END-EXEC.
 15363     MOVE LENGTH OF
 15364      EL130AO
 15365       TO DFHEIV12
 15366     MOVE -1
 15367       TO DFHEIV11
 15368*    MOVE '8$D    CT       H L F ,   #00013528' TO DFHEIV0
 15369     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15370     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15371     MOVE X'2020233030303133353238' TO DFHEIV0(25:11)
 15372     CALL 'kxdfhei1' USING DFHEIV0,
 15373           MAP-NAME,
 15374           EL130AO,
 15375           DFHEIV12,
 15376           MAPSET-NAME,
 15377           DFHEIV99,
 15378           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 298
* EL130.cbl
 15379           DFHEIV99,
 15380           DFHEIV11,
 15381           DFHEIV99,
 15382           DFHEIV99,
 15383           DFHEIV99
 15384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15385
 15386
 15387     GO TO 9100-RETURN-TRAN.
 15388
 15389 8300-SEND-TEXT.
 15390
 15391
 15392* EXEC CICS SEND TEXT
 15393*        FROM     (LOGOFF-TEXT)
 15394*        LENGTH   (LOGOFF-LENGTH)
 15395*        ERASE
 15396*        FREEKB
 15397*    END-EXEC.
 15398*    MOVE '8&      T  E F  H   F -   #00013540' TO DFHEIV0
 15399     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 15400     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 15401     MOVE X'2020233030303133353430' TO DFHEIV0(25:11)
 15402     CALL 'kxdfhei1' USING DFHEIV0,
 15403           LOGOFF-TEXT,
 15404           LOGOFF-LENGTH,
 15405           DFHEIV99,
 15406           DFHEIV99,
 15407           DFHEIV99,
 15408           DFHEIV99,
 15409           DFHEIV99,
 15410           DFHEIV99,
 15411           DFHEIV99,
 15412           DFHEIV99,
 15413           DFHEIV99,
 15414           DFHEIV99
 15415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15416
 15417
 15418
 15419
 15420* EXEC CICS RETURN
 15421*    END-EXEC.
 15422*    MOVE '.(                    ''   #00013548' TO DFHEIV0
 15423     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15424     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15425     MOVE X'2020233030303133353438' TO DFHEIV0(25:11)
 15426     CALL 'kxdfhei1' USING DFHEIV0,
 15427           DFHEIV99,
 15428           DFHEIV99,
 15429           DFHEIV99,
 15430           DFHEIV99,
 15431           DFHEIV99,
 15432           DFHEIV99
 15433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15434
 15435
 15436 8800-UNAUTHORIZED-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 299
* EL130.cbl
 15437     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 15438     GO TO 8300-SEND-TEXT.
 15439
 15440 8810-PF23.
 15441     MOVE EIBAID TO PI-ENTRY-CD-1.
 15442     MOVE XCTL-005               TO PGM-NAME.
 15443     GO TO 9300-XCTL.
 15444
 15445 8820-TERM-ERROR.
 15446     MOVE ER-0412                TO EMI-ERROR.
 15447     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15448     MOVE -1                     TO MAINTL.
 15449     GO TO 8200-SEND-DATAONLY.
 15450
 15451 8830-TRAN-ERROR.
 15452     MOVE ER-0413                TO EMI-ERROR.
 15453     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15454     MOVE -1                     TO MAINTL.
 15455     GO TO 8200-SEND-DATAONLY.
 15456
 15457 9000-RETURN-CICS.
 15458
 15459
 15460* EXEC CICS RETURN
 15461*    END-EXEC.
 15462*    MOVE '.(                    ''   #00013574' TO DFHEIV0
 15463     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15464     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15465     MOVE X'2020233030303133353734' TO DFHEIV0(25:11)
 15466     CALL 'kxdfhei1' USING DFHEIV0,
 15467           DFHEIV99,
 15468           DFHEIV99,
 15469           DFHEIV99,
 15470           DFHEIV99,
 15471           DFHEIV99,
 15472           DFHEIV99
 15473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15474
 15475
 15476 9100-RETURN-TRAN.
 15477     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15478     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 15479
 15480
 15481
 15482* EXEC CICS RETURN
 15483*        TRANSID   (TRANS-ID)
 15484*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 15485*        LENGTH    (PI-COMM-LENGTH)
 15486*    END-EXEC.
 15487*    MOVE '.(CT                  ''   #00013582' TO DFHEIV0
 15488     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 15489     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15490     MOVE X'2020233030303133353832' TO DFHEIV0(25:11)
 15491     CALL 'kxdfhei1' USING DFHEIV0,
 15492           TRANS-ID,
 15493           PROGRAM-INTERFACE-BLOCK,
 15494           PI-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 300
* EL130.cbl
 15495           DFHEIV99,
 15496           DFHEIV99,
 15497           DFHEIV99
 15498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15499
 15500
 15501 9200-RETURN-MAIN-MENU.
 15502     MOVE XCTL-126               TO PGM-NAME.
 15503     GO TO 9300-XCTL.
 15504
 15505 9300-XCTL.
 15506
 15507
 15508* EXEC CICS XCTL
 15509*        PROGRAM   (PGM-NAME)
 15510*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 15511*        LENGTH    (PI-COMM-LENGTH)
 15512*    END-EXEC.
 15513*    MOVE '.$C                   %   #00013594' TO DFHEIV0
 15514     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 15515     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15516     MOVE X'2020233030303133353934' TO DFHEIV0(25:11)
 15517     CALL 'kxdfhei1' USING DFHEIV0,
 15518           PGM-NAME,
 15519           PROGRAM-INTERFACE-BLOCK,
 15520           PI-COMM-LENGTH,
 15521           DFHEIV99
 15522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15523
 15524
 15525 9400-CLEAR.
 15526     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 15527     GO TO 9300-XCTL.
 15528
 15529 9500-PF12.
 15530     MOVE XCTL-010               TO PGM-NAME.
 15531     GO TO 9300-XCTL.
 15532
 15533 9600-PGMID-ERROR.
 15534
 15535
 15536* EXEC CICS HANDLE CONDITION
 15537*        PGMIDERR  (8300-SEND-TEXT)
 15538*    END-EXEC.
 15539*    MOVE '"$L                   ! M #00013610' TO DFHEIV0
 15540     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 15541     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15542     MOVE X'4D20233030303133363130' TO DFHEIV0(25:11)
 15543     CALL 'kxdfhei1' USING DFHEIV0
 15544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15545
 15546
 15547     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 15548     MOVE ' '                    TO PI-ENTRY-CD-1.
 15549     MOVE XCTL-005               TO PGM-NAME.
 15550     MOVE PGM-NAME               TO LOGOFF-PGM.
 15551     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 15552     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 301
* EL130.cbl
 15553
 15554 9700-LINK-DATE-CONVERT.
 15555     MOVE LINK-ELDATCV           TO PGM-NAME.
 15556
 15557
 15558* EXEC CICS LINK
 15559*        PROGRAM    (PGM-NAME)
 15560*        COMMAREA   (DATE-CONVERSION-DATA)
 15561*        LENGTH     (DC-COMM-LENGTH)
 15562*    END-EXEC.
 15563*    MOVE '."C                   (   #00013624' TO DFHEIV0
 15564     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15565     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15566     MOVE X'2020233030303133363234' TO DFHEIV0(25:11)
 15567     CALL 'kxdfhei1' USING DFHEIV0,
 15568           PGM-NAME,
 15569           DATE-CONVERSION-DATA,
 15570           DC-COMM-LENGTH,
 15571           DFHEIV99,
 15572           DFHEIV99,
 15573           DFHEIV99,
 15574           DFHEIV99
 15575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15576
 15577
 15578 9700-EXIT.
 15579     EXIT.
 15580
 15581 9800-LINK-REM-TERM.
 15582     MOVE LINK-ELRTRM            TO PGM-NAME.
 15583
 15584
 15585* EXEC CICS LINK
 15586*        PROGRAM    (PGM-NAME)
 15587*        COMMAREA   (CALCULATION-PASS-AREA)
 15588*        LENGTH     (CP-COMM-LENGTH)
 15589*    END-EXEC.
 15590*    MOVE '."C                   (   #00013636' TO DFHEIV0
 15591     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15592     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15593     MOVE X'2020233030303133363336' TO DFHEIV0(25:11)
 15594     CALL 'kxdfhei1' USING DFHEIV0,
 15595           PGM-NAME,
 15596           CALCULATION-PASS-AREA,
 15597           CP-COMM-LENGTH,
 15598           DFHEIV99,
 15599           DFHEIV99,
 15600           DFHEIV99,
 15601           DFHEIV99
 15602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15603
 15604
 15605 9800-EXIT.
 15606     EXIT.
 15607
 15608 9900-ERROR-FORMAT.
 15609     IF NOT EMI-ERRORS-COMPLETE
 15610         MOVE LINK-001           TO PGM-NAME
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 302
* EL130.cbl
 15611
 15612* EXEC CICS LINK
 15613*            PROGRAM   (PGM-NAME)
 15614*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 15615*            LENGTH    (EMI-COMM-LENGTH)
 15616*        END-EXEC
 15617*    MOVE '."C                   (   #00013648' TO DFHEIV0
 15618     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15619     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15620     MOVE X'2020233030303133363438' TO DFHEIV0(25:11)
 15621     CALL 'kxdfhei1' USING DFHEIV0,
 15622           PGM-NAME,
 15623           ERROR-MESSAGE-INTERFACE-BLOCK,
 15624           EMI-COMM-LENGTH,
 15625           DFHEIV99,
 15626           DFHEIV99,
 15627           DFHEIV99,
 15628           DFHEIV99
 15629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15630     END-IF.
 15631
 15632 9900-EXIT.
 15633     EXIT.
 15634
 15635 9990-ABEND.
 15636     MOVE -1                     TO MAINTL.
 15637     MOVE LINK-004               TO PGM-NAME.
 15638     MOVE DFHEIBLK               TO EMI-LINE1.
 15639
 15640
 15641* EXEC CICS LINK
 15642*        PROGRAM   (PGM-NAME)
 15643*        COMMAREA  (EMI-LINE1)
 15644*        LENGTH    (72)
 15645*    END-EXEC.
 15646     MOVE 72
 15647       TO DFHEIV11
 15648*    MOVE '."C                   (   #00013663' TO DFHEIV0
 15649     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15650     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15651     MOVE X'2020233030303133363633' TO DFHEIV0(25:11)
 15652     CALL 'kxdfhei1' USING DFHEIV0,
 15653           PGM-NAME,
 15654           EMI-LINE1,
 15655           DFHEIV11,
 15656           DFHEIV99,
 15657           DFHEIV99,
 15658           DFHEIV99,
 15659           DFHEIV99
 15660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15661
 15662
 15663     MOVE EMI-LINE1              TO ERRMSG2O.
 15664
 15665     GO TO 8200-BYPASS-ERROR.
 15666
 15667
 15668
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 303
* EL130.cbl
 15669* GOBACK.
 15670     MOVE '9%                    "   ' TO DFHEIV0
 15671     MOVE 'EL130' TO DFHEIV1
 15672     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15673     GOBACK.
 15674
 15675 9995-SECURITY-VIOLATION.
 15676*             COPY ELCSCTP.
 15677******************************************************************
 15678*                                                                *
 15679*                            ELCSCTP                             *
 15680*                            VMOD=2.001                          *
 15681*                                                                *
 15682*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 15683******************************************************************
 15684
 15685
 15686     MOVE EIBDATE          TO SM-JUL-DATE.
 15687     MOVE EIBTRMID         TO SM-TERMID.
 15688     MOVE THIS-PGM         TO SM-PGM.
 15689     MOVE EIBTIME          TO TIME-IN.
 15690     MOVE TIME-OUT         TO SM-TIME.
 15691     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 15692
 15693
 15694* EXEC CICS LINK
 15695*         PROGRAM  ('EL003')
 15696*         COMMAREA (SECURITY-MESSAGE)
 15697*         LENGTH   (80)
 15698*    END-EXEC.
 15699     MOVE 'EL003' TO DFHEIV1
 15700     MOVE 80
 15701       TO DFHEIV11
 15702*    MOVE '."C                   (   #00013694' TO DFHEIV0
 15703     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15704     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15705     MOVE X'2020233030303133363934' TO DFHEIV0(25:11)
 15706     CALL 'kxdfhei1' USING DFHEIV0,
 15707           DFHEIV1,
 15708           SECURITY-MESSAGE,
 15709           DFHEIV11,
 15710           DFHEIV99,
 15711           DFHEIV99,
 15712           DFHEIV99,
 15713           DFHEIV99
 15714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15715
 15716
 15717******************************************************************
 15718
 15719
 15720 9995-EXIT.
 15721     EXIT.
 15722
 15723
 15724 9999-DFHBACK SECTION.
 15725     MOVE '9%                    "   ' TO DFHEIV0
 15726     MOVE 'EL130' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 304
* EL130.cbl
 15727     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15728     GOBACK.
 15729 9999-DFHEXIT.
 15730     IF DFHEIGDJ EQUAL 0001
 15731         NEXT SENTENCE
 15732     ELSE IF DFHEIGDJ EQUAL 2
 15733         GO TO 0100-TEST-ENTRY,
 15734               8100-SEND-INITIAL-MAP,
 15735               9600-PGMID-ERROR,
 15736               8820-TERM-ERROR,
 15737               8830-TRAN-ERROR,
 15738               9990-ABEND
 15739         DEPENDING ON DFHEIGDI
 15740     ELSE IF DFHEIGDJ EQUAL 3
 15741         GO TO 0450-ADD-ELACTQ-RECORD
 15742         DEPENDING ON DFHEIGDI
 15743     ELSE IF DFHEIGDJ EQUAL 4
 15744         GO TO 8820-TERM-ERROR,
 15745               8830-TRAN-ERROR
 15746         DEPENDING ON DFHEIGDI
 15747     ELSE IF DFHEIGDJ EQUAL 5
 15748         GO TO 0660-NOT-FOUND,
 15749               0670-QIDERR
 15750         DEPENDING ON DFHEIGDI
 15751     ELSE IF DFHEIGDJ EQUAL 6
 15752         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15753         DEPENDING ON DFHEIGDI
 15754     ELSE IF DFHEIGDJ EQUAL 7
 15755         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15756         DEPENDING ON DFHEIGDI
 15757     ELSE IF DFHEIGDJ EQUAL 8
 15758         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15759         DEPENDING ON DFHEIGDI
 15760     ELSE IF DFHEIGDJ EQUAL 9
 15761         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15762         DEPENDING ON DFHEIGDI
 15763     ELSE IF DFHEIGDJ EQUAL 10
 15764         GO TO 2050-DELETE-NOT-FOUND
 15765         DEPENDING ON DFHEIGDI
 15766     ELSE IF DFHEIGDJ EQUAL 11
 15767         GO TO 2010-DELETE-CL
 15768         DEPENDING ON DFHEIGDI
 15769     ELSE IF DFHEIGDJ EQUAL 12
 15770         GO TO 3010-TEST-FOR-ERRORS
 15771         DEPENDING ON DFHEIGDI
 15772     ELSE IF DFHEIGDJ EQUAL 13
 15773         GO TO 3008-DUP-ERROR,
 15774               3009-NOT-FOUND
 15775         DEPENDING ON DFHEIGDI
 15776     ELSE IF DFHEIGDJ EQUAL 14
 15777         GO TO 3030-BUILD-CONT
 15778         DEPENDING ON DFHEIGDI
 15779     ELSE IF DFHEIGDJ EQUAL 15
 15780         GO TO 3033-ACCT-NOT-FOUND,
 15781               3033-ACCT-NOT-FOUND
 15782         DEPENDING ON DFHEIGDI
 15783     ELSE IF DFHEIGDJ EQUAL 16
 15784         GO TO 3032-NOT-IN-DT-RANGE
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 305
* EL130.cbl
 15785         DEPENDING ON DFHEIGDI
 15786     ELSE IF DFHEIGDJ EQUAL 17
 15787         GO TO 3070-BUILD-CONT
 15788         DEPENDING ON DFHEIGDI
 15789     ELSE IF DFHEIGDJ EQUAL 18
 15790         GO TO 3065-CERT-NOT-FOUND
 15791         DEPENDING ON DFHEIGDI
 15792     ELSE IF DFHEIGDJ EQUAL 19
 15793         GO TO 3100-CARRIER-NOT-FOUND
 15794         DEPENDING ON DFHEIGDI
 15795     ELSE IF DFHEIGDJ EQUAL 20
 15796         GO TO 3110-COMPANY-NOT-FOUND
 15797         DEPENDING ON DFHEIGDI
 15798     ELSE IF DFHEIGDJ EQUAL 21
 15799         GO TO 3200-BUILD-ZERO-TRAILER
 15800         DEPENDING ON DFHEIGDI
 15801     ELSE IF DFHEIGDJ EQUAL 22
 15802         GO TO 9999-DFHBACK
 15803         DEPENDING ON DFHEIGDI
 15804     ELSE IF DFHEIGDJ EQUAL 23
 15805         GO TO 3290-NO-INSURED-ADDRESS
 15806         DEPENDING ON DFHEIGDI
 15807     ELSE IF DFHEIGDJ EQUAL 24
 15808         GO TO 3410-DUP-KEY
 15809         DEPENDING ON DFHEIGDI
 15810     ELSE IF DFHEIGDJ EQUAL 25
 15811         GO TO 3690-CERT-WRITTEN
 15812         DEPENDING ON DFHEIGDI
 15813     ELSE IF DFHEIGDJ EQUAL 26
 15814         GO TO 3850-CLAIM-MSTR-WRITTEN
 15815         DEPENDING ON DFHEIGDI
 15816     ELSE IF DFHEIGDJ EQUAL 27
 15817         GO TO 5050-CERT-NOT-FOUND
 15818         DEPENDING ON DFHEIGDI
 15819     ELSE IF DFHEIGDJ EQUAL 28
 15820         GO TO 5030-CERT-WRITTEN
 15821         DEPENDING ON DFHEIGDI
 15822     ELSE IF DFHEIGDJ EQUAL 29
 15823         GO TO 5035-CLAIM-WRITTEN
 15824         DEPENDING ON DFHEIGDI
 15825     ELSE IF DFHEIGDJ EQUAL 30
 15826         GO TO 9990-ABEND,
 15827               5799-EXIT
 15828         DEPENDING ON DFHEIGDI
 15829     ELSE IF DFHEIGDJ EQUAL 31
 15830         GO TO 3100-CARRIER-NOT-FOUND
 15831         DEPENDING ON DFHEIGDI
 15832     ELSE IF DFHEIGDJ EQUAL 32
 15833         GO TO 6040-NO-PROCESSOR-RECORD
 15834         DEPENDING ON DFHEIGDI
 15835     ELSE IF DFHEIGDJ EQUAL 33
 15836         GO TO 6060-NO-BENEFICIARY-RECORD
 15837         DEPENDING ON DFHEIGDI
 15838     ELSE IF DFHEIGDJ EQUAL 34
 15839         GO TO 6499-EXIT,
 15840               6499-EXIT
 15841         DEPENDING ON DFHEIGDI
 15842     ELSE IF DFHEIGDJ EQUAL 35
* Micro Focus Server Express         V5.1 revision 000 24-Apr-13 11:23 Page 306
* EL130.cbl
 15843         GO TO 6600-NOT-FOUND
 15844         DEPENDING ON DFHEIGDI
 15845     ELSE IF DFHEIGDJ EQUAL 36
 15846         GO TO 6700-NOTOPEN-ERROR,
 15847               6700-EXIT
 15848         DEPENDING ON DFHEIGDI
 15849     ELSE IF DFHEIGDJ EQUAL 37
 15850         GO TO 7120-NOT-FOUND
 15851         DEPENDING ON DFHEIGDI
 15852     ELSE IF DFHEIGDJ EQUAL 38
 15853         GO TO 7499-EXIT
 15854         DEPENDING ON DFHEIGDI
 15855     ELSE IF DFHEIGDJ EQUAL 39
 15856         GO TO 7500-EXIT,
 15857               7500-DUPLICATE-KEY,
 15858               7500-EXIT
 15859         DEPENDING ON DFHEIGDI
 15860     ELSE IF DFHEIGDJ EQUAL 40
 15861         GO TO 7500-END-BROWSE
 15862         DEPENDING ON DFHEIGDI
 15863     ELSE IF DFHEIGDJ EQUAL 41
 15864         GO TO 7630-END-BROWSE
 15865         DEPENDING ON DFHEIGDI
 15866     ELSE IF DFHEIGDJ EQUAL 42
 15867         GO TO 7799-EXIT,
 15868               7799-EXIT
 15869         DEPENDING ON DFHEIGDI
 15870     ELSE IF DFHEIGDJ EQUAL 43
 15871         GO TO 7790-END-BROWSE
 15872         DEPENDING ON DFHEIGDI
 15873     ELSE IF DFHEIGDJ EQUAL 44
 15874         GO TO 7992-NOT-FOUND
 15875         DEPENDING ON DFHEIGDI
 15876     ELSE IF DFHEIGDJ EQUAL 45
 15877         GO TO 8300-SEND-TEXT
 15878         DEPENDING ON DFHEIGDI.
 15879     MOVE '9%                    "   ' TO DFHEIV0
 15880     MOVE 'EL130' TO DFHEIV1
 15881     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15882     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       10552     Code:       48911
