* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   1
* EL154.cbl
* Options: int("EL154.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL154.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL154.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL154.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL154.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 11/21/94 15:39:26.
     7*                            VMOD=2.022
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   2
* EL154.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    TRANSACTION - EX28 - SET-UP AUTOMATIC PAYMENTS.
    26*        USED TO CREATE NEW AUTOMATIC PAYMENT SCHEDULES AND/OR
    27*        SIGN-OFF CURRENT SCHEDULES.  ONCE A SCHEDULE HAS BEEN
    28*        CREATED IT MAY ONLY BY REPLACED - NOT CHANGED
    29*        OR DELETED.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 090108    2007041300006  AJRA  ENTER LETTER FORM NUMBER ON SET U
    39* 031809    2009031600001  AJRA  ALLOW IU PAYMENT PAST EXP DATE
    40* 070909    2009060400001  AJRA  ADD AUTO PAY STOP LETTER
    41* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    42* 100713  IR2013092400001  PEMA  USE EXP DT IF NO CRIT PER - DCC
    43* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    44* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    45* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    46* 030515  IR2015030300002  PEMA  FIX CRIT PERIOD EDITS
    47******************************************************************
    48
    49 ENVIRONMENT DIVISION.
    50
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   3
* EL154.cbl
    52 DATA DIVISION.
    53 WORKING-STORAGE SECTION.
    54 01  DFH-START PIC X(04).
    55 77  FILLER  PIC X(32)  VALUE '********************************'.
    56 77  FILLER  PIC X(32)  VALUE '*    EL154 WORKING STORAGE     *'.
    57 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.022 *********'.
    58 77  P1                          PIC S999 COMP-3 VALUE +0.
    59 77  P2                          PIC S999 COMP-3 VALUE +0.
    60 77  s1                          PIC S999 COMP-3 VALUE +0.
    61 77  s2                          PIC S999 COMP-3 VALUE +0.
    62 77  ws-benefit-expiration-dt    pic xx value low-values.
    63 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
    64 77  ws-proposed-benefits        pic s999 comp-3 value +0.
    65
    66*                            COPY ELCSCTM.
    67******************************************************************
    68*                                                                *
    69*                                                                *
    70*                            ELCSCTM                             *
    71*                            VMOD=2.001                          *
    72*                                                                *
    73*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    74*                                                                *
    75******************************************************************
    76 01  SECURITY-MESSAGE.
    77     12  FILLER                          PIC X(30)
    78            VALUE '** LOGIC SECURITY VIOLATION -'.
    79     12  SM-READ                         PIC X(6).
    80     12  FILLER                          PIC X(5)
    81            VALUE ' PGM='.
    82     12  SM-PGM                          PIC X(6).
    83     12  FILLER                          PIC X(5)
    84            VALUE ' OPR='.
    85     12  SM-PROCESSOR-ID                 PIC X(4).
    86     12  FILLER                          PIC X(6)
    87            VALUE ' TERM='.
    88     12  SM-TERMID                       PIC X(4).
    89     12  FILLER                          PIC XX   VALUE SPACE.
    90     12  SM-JUL-DATE                     PIC 9(5).
    91     12  FILLER                          PIC X    VALUE SPACE.
    92     12  SM-TIME                         PIC 99.99.
    93
    94
    95*                            COPY ELCSCRTY.
    96******************************************************************
    97*                                                                *
    98*                                                                *
    99*                            ELCSCRTY                            *
   100*                            VMOD=2.001                          *
   101*                                                                *
   102*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   103*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   104*        SAVED IN PI-SECURITY-ADDRESS.                           *
   105*                                                                *
   106******************************************************************
   107 01  SECURITY-CONTROL.
   108     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   109     12  FILLER                       PIC XX    VALUE 'SC'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   4
* EL154.cbl
   110     12  SC-CREDIT-CODES.
   111         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   112             20  SC-CREDIT-DISPLAY    PIC X.
   113             20  SC-CREDIT-UPDATE     PIC X.
   114     12  SC-CLAIMS-CODES.
   115         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   116             20  SC-CLAIMS-DISPLAY    PIC X.
   117             20  SC-CLAIMS-UPDATE     PIC X.
   118
   119 01  WS-DATE-AREA.
   120     05  CURRENT-GREG-DATE   PIC X(8)    VALUE SPACES.
   121     05  CURRENT-BIN-DATE    PIC X(2)    VALUE SPACES.
   122     05  RETRO-ELIM-DATE     PIC XX      VALUE LOW-VALUES.
   123
   124 01  ws-dcc-product-code         pic xxx value spaces.
   125 01  ws-ah-benefit-cd            pic xx  value '00'.
   126 01  ws-edit-1st-pmt-amt         pic s9(9)v99 comp-3 value +0.
   127 01  ws-monthly-benefit          pic s9(9)v99 comp-3 value +0.
   128 01  ws-max-benefit-amt          pic s9(9)v99 comp-3 value +0.
   129 01  ws-max-benefit-pmts         pic s999 comp-3 value +0.
   130 01  ws-benefits-prev-paid       pic s999 comp-3 value +0.
   131 01  ws-total-paid               pic s9(9)v99 comp-3 value +0.
   132 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   133     88  PDEF-FOUND                   VALUE 'Y'.
   134 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   135     88  ACCT-FOUND                   VALUE 'Y'.
   136 01  ws-cert-trlr-sw             PIC X  VALUE ' '.
   137     88  cert-trlr-found              VALUE 'Y'.
   138 01  STANDARD-AREAS.
   139     12  WS-RESPONSE             PIC S9(8)   COMP.
   140         88  WS-RESP-NORMAL        VALUE +00.
   141         88  WS-RESP-ERROR         VALUE +01.
   142         88  WS-RESP-NOTFND        VALUE +13.
   143         88  WS-RESP-DUPREC        VALUE +14.
   144         88  WS-RESP-ENDFILE       VALUE +20.
   145     12  SC-ITEM             PIC S9(4)   VALUE +1  COMP.
   146     12  SUB-1               PIC S9(4)   VALUE +0  COMP.
   147     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   148     12  MAP-NAME.
   149         16  MAP-PRE         PIC XX      VALUE 'EL'.
   150         16  MAP-NUMBER      PIC X(4)    VALUE '154A'.
   151         16  FILLER          PIC XX      VALUE SPACES.
   152     12  MAPSET-NAME         PIC X(8)    VALUE 'EL154S'.
   153     12  TRANS-ID            PIC X(4)    VALUE 'EX28'.
   154     12  LGXX-ID             PIC X(4)    VALUE 'LGXX'.
   155     12  PGM-NAME            PIC X(8).
   156     12  TIME-IN             PIC S9(7).
   157     12  TIME-OUT-R  REDEFINES TIME-IN.
   158         16  FILLER          PIC X.
   159         16  TIME-OUT        PIC 99V99.
   160         16  FILLER          PIC X(2).
   161     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   162     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   163     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   164
   165     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   166     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   167     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   5
* EL154.cbl
   168     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   169     12  THIS-PGM            PIC X(8)    VALUE 'EL154'.
   170
   171     12  DEEDIT-FIELD            PIC X(15).
   172     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   173
   174     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   175     12  NEFFDTE-SAVE            PIC XX       VALUE LOW-VALUES.
   176     12  NFSTPMT-SAVE            PIC XX       VALUE LOW-VALUES.
   177     12  NLSTPMT-SAVE            PIC XX       VALUE LOW-VALUES.
   178     12  NFSTAMT-SAVE            PIC S9(7)V99 VALUE +0   COMP-3.
   179     12  NREGPMT-SAVE            PIC S9(7)V99 VALUE +0   COMP-3.
   180     12  CURRENT-SAVE            PIC XX       VALUE LOW-VALUES.
   181     12  LETTDTE-SAVE            PIC X(10)    VALUE SPACES.
   182     12  WS-WORK                 PIC S9(5)    VALUE ZERO COMP-3.
   183     12  WS-REMAINDER            PIC S9(5)    VALUE ZERO COMP-3.
   184     12  WS-DAYS-MINUS-TOL       PIC S9(5)    VALUE ZERO COMP-3.
   185     12  WS-DAYS-PLUS-TOL        PIC S9(5)    VALUE ZERO COMP-3.
   186     12  WS-DAILY-BEN-AMT        PIC S9(5)V99 VALUE ZERO COMP-3.
   187     12  WS-AMT-MINUS-TOL        PIC S9(7)V99 VALUE ZERO COMP-3.
   188     12  WS-AMT-PLUS-TOL         PIC S9(7)V99 VALUE ZERO COMP-3.
   189     12  WS-AMT-TOL              PIC S9(5)V99 VALUE ZERO COMP-3.
   190     12  WS-DAY-TOL              PIC S9(05)   VALUE ZERO COMP-3.
   191     12  WS-MAX-AUTO-PMT         PIC S9(7)V99 VALUE ZERO COMP-3.
   192     12  WS-MAX-AUTO-MOS         PIC S999     VALUE ZERO COMP-3.
   193     12  WS-ELAPSED-DAYS         PIC S9(04)   VALUE +0   COMP.
   194     12  WS-REG-PMT              PIC S9(7)V99 VALUE ZERO COMP-3.
   195     12  WS-EXP-DT               PIC XX       VALUE LOW-VALUES.
   196     12  WS-EXP-DT-PLUS7         PIC XX       VALUE LOW-VALUES.
   197     12  WS-CALC-METHOD          PIC X.
   198     12  WS-DAILY-RATE           PIC S9(3)V99.
   199     12  WS-CONFIRM-NEEDED       PIC X.
   200     12  WS-ELIMINATION-SW       PIC X        VALUE SPACES.
   201         88  NO-EFFDTE-ENTERED   VALUE 'N'.
   202     12  WS-BENEFIT-FOUND-SW     PIC X        VALUE SPACES.
   203         88  BENEFIT-FOUND       VALUE 'Y'.
   204     12  WS-ACT-REC-FOUND-SW     PIC X(01)    VALUE 'N'.
   205     12  WS-LETTER-SW            PIC X(01)    VALUE 'N'.
   206     12  WS-LETTER-FORM-NUM      PIC X(04)    VALUE SPACES.
   207     12  WS-END-LETTER-FORM-NUM  PIC X(04)    VALUE SPACES.
   208     12  WS-RESET-SW             PIC X(01)    VALUE 'N'.
   209     12  WS-PAYEE-CODE.
   210         16  WS-PAYEE-CD         PIC X(01).
   211         16  WS-PAYEE-SEQ        PIC X(01).
   212         16  WS-PAYEE-SEQ-NUM REDEFINES
   213             WS-PAYEE-SEQ        PIC 9(01).
   214     12  WS-ACCESS.
   215         16  FILLER              PIC XX       VALUE SPACES.
   216         16  WS-BEN-CD           PIC XX.
   217
   218     12  MISC-HEADING-AREAS.
   219         16  FIRST-PMT-HD1       PIC X(23)    VALUE
   220             'FIRST PAY THRU DATE   :'.
   221         16  FIRST-PMT-HD2       PIC X(23)    VALUE
   222             'FIRST PAY-TO DATE     :'.
   223         16  FIRST-PMT-HD3       PIC X(26)    VALUE
   224             '   FIRST PAY-THRU DATE   :'.
   225         16  FIRST-PMT-HD4       PIC X(26)    VALUE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   6
* EL154.cbl
   226             '   FIRST PAY-TO DATE     :'.
   227         16  LAST-PMT-HD1        PIC X(24)    VALUE
   228             'LAST PAY-THRU DATE     :'.
   229         16  LAST-PMT-HD2        PIC X(24)    VALUE
   230             'LAST PAY-TO DATE       :'.
   231         16  LAST-PMT-HD3        PIC X(23)    VALUE
   232             'LAST PAY-THRU DATE    :'.
   233         16  LAST-PMT-HD4        PIC X(23)    VALUE
   234             'LAST PAY-TO DATE      :'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   7
* EL154.cbl
   236 01  ERROR-MESSAGES.
   237     12  ER-0000                 PIC X(4)     VALUE '0000'.
   238     12  ER-0004                 PIC X(4)     VALUE '0004'.
   239     12  ER-0008                 PIC X(4)     VALUE '0008'.
   240     12  ER-0029                 PIC X(4)     VALUE '0029'.
   241     12  ER-0042                 PIC X(4)     VALUE '0042'.
   242     12  ER-0050                 PIC X(4)     VALUE '0050'.
   243     12  ER-0070                 PIC X(4)     VALUE '0070'.
   244     12  ER-0130                 PIC X(4)     VALUE '0130'.
   245     12  ER-0154                 PIC X(4)     VALUE '0154'.
   246     12  ER-0169                 PIC X(4)     VALUE '0169'.
   247     12  ER-0172                 PIC X(4)     VALUE '0172'.
   248     12  ER-0186                 PIC X(4)     VALUE '0186'.
   249     12  ER-0206                 PIC X(4)     VALUE '0206'.
   250     12  ER-0283                 PIC X(4)     VALUE '0283'.
   251     12  ER-0346                 PIC X(4)     VALUE '0346'.
   252     12  ER-0347                 PIC X(4)     VALUE '0347'.
   253     12  ER-0348                 PIC X(4)     VALUE '0348'.
   254     12  ER-0349                 PIC X(4)     VALUE '0349'.
   255     12  ER-0350                 PIC X(4)     VALUE '0350'.
   256     12  ER-0351                 PIC X(4)     VALUE '0351'.
   257     12  ER-0352                 PIC X(4)     VALUE '0352'.
   258     12  ER-0353                 PIC X(4)     VALUE '0353'.
   259     12  ER-0354                 PIC X(4)     VALUE '0354'.
   260     12  ER-0357                 PIC X(4)     VALUE '0357'.
   261     12  ER-0358                 PIC X(4)     VALUE '0358'.
   262     12  ER-0372                 PIC X(4)     VALUE '0372'.
   263     12  ER-0396                 PIC X(4)     VALUE '0396'.
   264     12  ER-0397                 PIC X(4)     VALUE '0397'.
   265     12  ER-0398                 PIC X(4)     VALUE '0398'.
   266     12  ER-0399                 PIC X(4)     VALUE '0399'.
   267     12  ER-0401                 PIC X(4)     VALUE '0401'.
   268     12  ER-0402                 PIC X(4)     VALUE '0402'.
   269     12  ER-0403                 PIC X(4)     VALUE '0403'.
   270     12  ER-0404                 PIC X(4)     VALUE '0404'.
   271     12  ER-0450                 PIC X(4)     VALUE '0450'.
   272     12  ER-0541                 PIC X(4)     VALUE '0541'.
   273     12  ER-0559                 PIC X(4)     VALUE '0559'.
   274     12  ER-0563                 PIC X(4)     VALUE '0563'.
   275     12  ER-0597                 PIC X(4)     VALUE '0597'.
   276     12  ER-0632                 PIC X(4)     VALUE '0632'.
   277     12  ER-0670                 PIC X(4)     VALUE '0670'.
   278     12  ER-0802                 PIC X(4)     VALUE '0802'.
   279     12  ER-0803                 PIC X(4)     VALUE '0803'.
   280     12  ER-0815                 PIC X(4)     VALUE '0815'.
   281     12  ER-0826                 PIC X(4)     VALUE '0826'.
   282     12  ER-0839                 PIC X(4)     VALUE '0839'.
   283     12  ER-1599                 PIC X(4)     VALUE '1599'.
   284     12  er-1657                 pic x(4)     value '1657'.
   285     12  er-1658                 pic x(4)     value '1658'.
   286     12  er-1672                 pic x(4)     value '1672'.
   287     12  er-1674                 pic x(4)     value '1674'.
   288     12  ER-3396                 PIC X(4)     VALUE '3396'.
   289     12  ER-3397                 PIC X(4)     VALUE '3397'.
   290     12  ER-3537                 PIC X(4)     VALUE '3537'.
   291     12  ER-3801                 PIC X(4)     VALUE '3801'.
   292     12  ER-8200                 PIC X(4)     VALUE '8200'.
   293     12  ER-9483                 PIC X(4)     VALUE '9483'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   8
* EL154.cbl
   294     12  ER-9883                 PIC X(4)     VALUE '9883'.
   295
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page   9
* EL154.cbl
   297 01  ACCESS-KEYS.
   298     12  CNTL-ID                  PIC X(8)    VALUE 'ELCNTL'.
   299     12  CLAM-ID                  PIC X(8)    VALUE 'ELMSTR'.
   300     12  ACTV-ID                  PIC X(8)    VALUE 'ELTRLR'.
   301     12  CERT-ID                  PIC X(8)    VALUE 'ELCERT'.
   302     12  BENE-ID                  PIC X(8)    VALUE 'ELBENE'.
   303     12  EMPLCY-ID                PIC X(8)    VALUE 'MPPLCY'.
   304
   305     12  CNTL-KEY.
   306         16  CNTL-CO              PIC X(3).
   307         16  CNTL-RECORD-TYPE     PIC X       VALUE '1'.
   308         16  CNTL-GENL.
   309           18 CNTL-GEN1           PIC X(2)    VALUE SPACES.
   310           18 CNTL-GEN2.
   311             20 CNTL-GEN3         PIC X       VALUE SPACES.
   312             20 CNTL-GEN4         PIC X       VALUE SPACES.
   313         16  CNTL-SEQ             PIC S9(4)   VALUE +0    COMP.
   314
   315     12  ELTRLR-KEY.
   316         16  TRLR-COMP-CD        PIC X.
   317         16  TRLR-CARRIER        PIC X.
   318         16  TRLR-CLAIM-NO       PIC X(7).
   319         16  TRLR-CERT-NO        PIC X(11).
   320         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   321     12  CLAM-KEY.
   322         16  CLAM-CO              PIC X.
   323         16  CLAM-CARRIER         PIC X.
   324         16  CLAM-CLAIM           PIC X(7).
   325         16  CLAM-CERT-NUM        PIC X(11).
   326
   327     12  CLAIM-SAVE-KEY           PIC X(20).
   328
   329     12  ACTV-KEY.
   330         16  ACTV-PARTIAL-KEY.
   331             20  ACTV-CO          PIC X.
   332             20  ACTV-CARRIER     PIC X.
   333             20  ACTV-CLAIM       PIC X(7).
   334             20  ACTV-CERT-NUM    PIC X(11).
   335         16  ACTV-SEQ             PIC S9(4)  COMP.
   336
   337     12  CERT-KEY.
   338         16  CERT-CO             PIC X.
   339         16  CERT-CARRIER        PIC X.
   340         16  CERT-GROUPING       PIC X(6).
   341         16  CERT-STATE          PIC XX.
   342         16  CERT-ACCOUNT        PIC X(10).
   343         16  CERT-EFF-DT         PIC XX.
   344         16  CERT-CERT-NUM       PIC X(11).
   345
   346     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   347     12  ERACCT-KEY.
   348         16  ERACCT-PARTIAL-KEY.
   349             20  ACCT-COMP-CD    PIC X.
   350             20  ACCT-CARRIER    PIC X.
   351             20  ACCT-GROUPING   PIC X(6).
   352             20  ACCT-STATE      PIC XX.
   353             20  ACCT-ACCOUNT    PIC X(10).
   354         16  ACCT-EXP-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  10
* EL154.cbl
   355         16  FILLER              PIC X(4) VALUE SPACES.
   356     12  EMPLCY-KEY.
   357         16  EMPLCY-COMPANY-CD   PIC X(01).
   358         16  EMPLCY-CARRIER      PIC X(01).
   359         16  EMPLCY-GROUPING     PIC X(06).
   360         16  EMPLCY-STATE        PIC X(02).
   361         16  EMPLCY-PRODUCER     PIC X(10).
   362         16  EMPLCY-EFF-DT       PIC X(02).
   363         16  EMPLCY-REFERENCE-NO PIC X(20).
   364
   365     12  BENE-KEY.
   366         16  BENE-CO             PIC X(01).
   367         16  BENE-REC-TYPE       PIC X(01).
   368         16  BENE-CODE           PIC X(10).
   369 01  ERPDEF-KEY-SAVE             PIC X(18).
   370 01  ERPDEF-KEY.
   371     12  ERPDEF-COMPANY-CD       PIC X.
   372     12  ERPDEF-STATE            PIC XX.
   373     12  ERPDEF-PROD-CD          PIC XXX.
   374     12  F                       PIC X(7).
   375     12  ERPDEF-BEN-TYPE         PIC X.
   376     12  ERPDEF-BEN-CODE         PIC XX.
   377     12  ERPDEF-EXP-DT           PIC XX.
   378
   379 01  ELCRTT-KEY.
   380     05  CTRLR-COMP-CD       PIC X.
   381     05  CTRLR-CARRIER       PIC X.
   382     05  CTRLR-GROUPING      PIC X(6).
   383     05  CTRLR-STATE         PIC X(2).
   384     05  CTRLR-ACCOUNT       PIC X(10).
   385     05  CTRLR-EFF-DT        PIC XX.
   386     05  CTRLR-CERT-NO       PIC X(11).
   387     05  CTRLR-REC-TYPE      PIC X.
   388*                            COPY ELCCALC.
   389******************************************************************
   390*                                                                *
   391*                           ELCCALC.                            *
   392*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   393*                            VMOD=2.025                          *
   394*                                                                *
   395*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   396*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   397*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   398*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   399*                                                                *
   400*  PASSED TO ELRTRM                                              *
   401*  -----------------                                             *
   402*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   403*  ORIGINAL TERM                                                 *
   404*  BEGINNING DATE                                                *
   405*  ENDING DATE                                                   *
   406*  COMPANY I.D.                                                  *
   407*  ACCOUNT MASTER USER FIELD                                     *
   408*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   409*  FREE LOOK DAYS                                                *
   410*                                                                *
   411*  RETURNED FROM ELRTRM                                          *
   412*  ---------------------                                         *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  11
* EL154.cbl
   413*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   414*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   415*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   416*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   417*----------------------------------------------------------------*
   418*  PASSED TO ELRAMT                                              *
   419*  ----------------                                              *
   420*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   421*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   422*  ORIGINAL AMOUNT                                               *
   423*  ALTERNATE BENEFIT (BALLON)                                    *
   424*  A.P.R. - NET PAY ONLY                                         *
   425*  METHOD
   426*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   427*  COMPANY I.D.                                                  *
   428*  BENEFIT TYPE                                                  *
   429*                                                                *
   430*  RETURNED FROM ELRAMT                                          *
   431*  --------------------                                          *
   432*  REMAINING AMOUNT 1 - CURRENT                                  *
   433*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   434*  REMAINING AMOUNT FACTOR
   435*----------------------------------------------------------------*
   436*  PASSED TO ELRESV                                              *
   437*  -----------------                                             *
   438*  CERTIFICATE EFFECTIVE DATE                                    *
   439*  VALUATION DATE                                                *
   440*  PAID THRU DATE                                                *
   441*  BENEFIT                                                       *
   442*  INCURRED DATE                                                 *
   443*  REPORTED DATE                                                 *
   444*  ISSUE AGE                                                     *
   445*  TERM                                                          *
   446*  CDT PERCENT                                                   *
   447*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   448* *CLAIM TYPE (LIFE, A/H)                                        *
   449* *REMAINING BENEFIT (FROM ELRAMT)                               *
   450* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   451*                                                                *
   452*  RETURNED FROM ELRESV                                          *
   453*  --------------------                                          *
   454*  CDT TABLE USED                                                *
   455*  CDT FACTOR USED                                               *
   456*  PAY TO CURRENT RESERVE                                        *
   457*  I.B.N.R. - A/H ONLY                                           *
   458*  FUTURE (ACCRUED) AH ONLY                                      *
   459*----------------------------------------------------------------*
   460*  PASSED TO ELRATE                                              *
   461*  ----------------                                              *
   462*  CERT ISSUE DATE                                               *
   463*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   464*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   465*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   466*  STATE CODE (CLIENT DEFINED)                                   *
   467*  STATE CODE (STANDARD P.O. ABBRV)                              *
   468*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   469*  DEVIATION CODE                                                *
   470*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  12
* EL154.cbl
   471*  ORIGINAL BENEFIT AMOUNT                                       *
   472*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   473*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   474*  BENEFIT KIND (LIFE OR A/H)                                    *
   475*  A.P.R.                                                        *
   476*  METHOD
   477*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   478*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   479*  COMPANY I.D. (3 CHARACTER)                                    *
   480*  BENEFIT CODE                                                  *
   481*  BENEFIT OVERRIDE CODE                                         *
   482*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   483*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   484*  JOINT INDICATOR (CSL ONLY)                                    *
   485*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   486*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   487*                                                                *
   488*  RETURNED FROM ELRATE                                          *
   489*  --------------------                                          *
   490*  CALCULATED PREMIUM                                            *
   491*  PREMIUM RATE                                                  *
   492*  MORTALITY CODE                                                *
   493*  MAX ATTAINED AGE                                              *
   494*  MAX AGE                                                       *
   495*  MAX TERM                                                      *
   496*  MAX MONTHLY BENEFIT                                           *
   497*  MAX TOTAL BENIFIT                                             *
   498*  COMPOSITE RATE (OPEN-END ONLY)                                *
   499*----------------------------------------------------------------*
   500*  PASSED TO ELRFND                                              *
   501*  ----------------                                              *
   502*  CERT ISSUE DATE                                               *
   503*  REFUND DATE                                                   *
   504*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   505*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   506*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   507*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   508*  STATE CODE (CLIENT DEFINED)                                   *
   509*  STATE CODE (STANDARD P.O. ABBRV)                              *
   510*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   511*  DEVIATION CODE                                                *
   512*  ISSUE AGE                                                     *
   513*  ORIGINAL BENEFIT AMOUNT                                       *
   514*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   515*  PROCESS TYPE (CANCEL)                                         *
   516*  BENEFIT KIND (LIFE OR A/H)                                    *
   517*  A.P.R.                                                        *
   518*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   519*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   520*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   521*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   522*  COMPANY I.D. (3 CHARACTER)                                    *
   523*  BENEFIT CODE                                                  *
   524*  BENEFIT OVERRIDE CODE                                         *
   525*                                                                *
   526*  RETURNED FROM ELRFND                                          *
   527*  --------------------                                          *
   528*  CALCULATED REFUND                                             *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  13
* EL154.cbl
   529*----------------------------------------------------------------*
   530*  PASSED TO ELEARN                                              *
   531*  ----------------                                              *
   532*  CERT ISSUE DATE                                               *
   533*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   534*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   535*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   536*  STATE CODE (CLIENT DEFINED)                                   *
   537*  STATE CODE (STANDARD P.O. ABBRV)                              *
   538*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   539*  DEVIATION CODE                                                *
   540*  ISSUE AGE                                                     *
   541*  ORIGINAL BENEFIT AMOUNT                                       *
   542*  BENEFIT KIND (LIFE OR A/H)                                    *
   543*  A.P.R.                                                        *
   544*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   545*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   546*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   547*  COMPANY I.D. (3 CHARACTER)                                    *
   548*  BENEFIT CODE                                                  *
   549*  BENEFIT OVERRIDE CODE                                         *
   550*                                                                *
   551*  RETURNED FROM ELEARN                                          *
   552*  --------------------                                          *
   553*  INDICATED  EARNINGS                                           *
   554*----------------------------------------------------------------*
   555*                 LENGTH = 450                                   *
   556*                                                                *
   557******************************************************************
   558******************************************************************
   559*                   C H A N G E   L O G
   560*
   561* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   562*-----------------------------------------------------------------
   563*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   564* EFFECTIVE    NUMBER
   565*-----------------------------------------------------------------
   566* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   567* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   568* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   569* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   570* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   571* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   572* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   573* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   574* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   575******************************************************************
   576
   577 01  CALCULATION-PASS-AREA.
   578     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   579                                     COMP.
   580
   581     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   582       88  NO-CP-ERROR                             VALUE ZERO.
   583       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   584                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   585       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   586       88  CP-ERROR-IN-DATES                       VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  14
* EL154.cbl
   587       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   588       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   589       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   590       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   591       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   592       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   593       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   594       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   595       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   596       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   597       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   598       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   599       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   600       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   601       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   602
   603     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   604       88  NO-CP-ERROR-2                           VALUE ZERO.
   605***********************  INPUT AREAS ****************************
   606
   607     12  CP-CALCULATION-AREA.
   608         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   609         16  CP-CERT-EFF-DT        PIC XX.
   610         16  CP-VALUATION-DT       PIC XX.
   611         16  CP-PAID-THRU-DT       PIC XX.
   612         16  CP-BENEFIT-TYPE       PIC X.
   613           88  CP-AH                               VALUE 'A' 'D'
   614                                                   'I' 'U'.
   615           88  CP-REDUCING-LIFE                    VALUE 'R'.
   616           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   617         16  CP-INCURRED-DT        PIC XX.
   618         16  CP-REPORTED-DT        PIC XX.
   619         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   620         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   621         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   622                                     COMP-3.
   623         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   624                                     COMP-3.
   625         16  CP-CDT-METHOD         PIC X.
   626           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   627           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   628           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   629         16  CP-CLAIM-TYPE         PIC X.
   630           88  CP-AH-CLAIM                         VALUE 'A'.
   631           88  CP-LIFE-CLAIM                       VALUE 'L'.
   632         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   633                                     COMP-3.
   634         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   635                                     COMP-3.
   636         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   637                                     COMP-3.
   638         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   639                                     COMP-3.
   640         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   641                                     COMP-3.
   642         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   643                                     COMP-3.
   644         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  15
* EL154.cbl
   645                                     COMP-3.
   646         16  CP-REM-TERM-METHOD    PIC X.
   647           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   648           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   649           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   650           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   651           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   652           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   653           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   654         16  CP-EARNING-METHOD     PIC X.
   655           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   656           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   657           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   658           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   659           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   660           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   661           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   662           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   663           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   664           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   665           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   666           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   667           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   668           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   669         16  CP-PROCESS-TYPE       PIC X.
   670           88  CP-CLAIM                            VALUE '1'.
   671           88  CP-CANCEL                           VALUE '2'.
   672           88  CP-ISSUE                            VALUE '3'.
   673         16  CP-SPECIAL-CALC-CD    PIC X.
   674           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   675           88  CP-1-MTH-INTEREST               VALUE ' '.
   676           88  CP-0-MTH-INTEREST               VALUE 'A'.
   677           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   678           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   679           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   680           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   681           88  CP-FARM-PLAN                    VALUE 'F'.
   682           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   683           88  CP-2-MTH-INTEREST               VALUE 'I'.
   684           88  CP-3-MTH-INTEREST               VALUE 'J'.
   685           88  CP-4-MTH-INTEREST               VALUE 'K'.
   686           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   687           88  CP-MORTGAGE-REC                 VALUE 'M'.
   688           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   689           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   690           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   691           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   692                                                     'W' 'X'.
   693           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   694           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   695           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   696           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   697           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   698           88  CP-SUMMARY-REC                  VALUE 'Z'.
   699           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   700           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   701           88  CP-AD-D-BENEFIT                 VALUE '4'.
   702           88  CP-CSL-METH-1                   VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  16
* EL154.cbl
   703           88  CP-CSL-METH-2                   VALUE '6'.
   704           88  CP-CSL-METH-3                   VALUE '7'.
   705           88  CP-CSL-METH-4                   VALUE '8'.
   706
   707         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   708                                     COMP-3.
   709         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   710         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   711         16  CP-STATE              PIC XX          VALUE SPACE.
   712         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   713         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   714           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   715               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   716         16  CP-R78-OPTION         PIC X.
   717           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   718           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   719
   720         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   721         16  CP-IBNR-RESERVE-SW    PIC X.
   722         16  CP-CLAIM-STATUS       PIC X.
   723         16  CP-RATE-FILE          PIC X.
   724         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   725                                     COMP-3.
   726
   727         16  CP-LIFE-OVERRIDE-CODE PIC X.
   728         16  CP-AH-OVERRIDE-CODE   PIC X.
   729
   730         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   731                                     COMP-3.
   732         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   733                                   PIC S9(5)V99 COMP-3.
   734         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   735                                     COMP-3.
   736         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   737                                     COMP-3.
   738         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   739                                     COMP-3.
   740         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   741                                  PIC S9(7)V99 COMP-3.
   742
   743         16  CP-PAID-FROM-DATE     PIC X(02).
   744         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   745         16  CP-EXT-DAYS-CALC      PIC X.
   746           88  CP-EXT-NO-CHG                   VALUE ' '.
   747           88  CP-EXT-CHG-LF                   VALUE '1'.
   748           88  CP-EXT-CHG-AH                   VALUE '2'.
   749           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   750         16  CP-DOMICILE-STATE     PIC XX.
   751         16  CP-CARRIER            PIC X.
   752         16  CP-REIN-FLAG          PIC X.
   753         16  CP-REM-TRM-CALC-OPTION PIC X.
   754           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   755                      '2' '3' '4' '5'.
   756           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   757           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   758           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   759           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   760           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  17
* EL154.cbl
   761           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   762           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   763           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   764         16  CP-SIG-SWITCH         PIC X.
   765         16  CP-RATING-METHOD      PIC X.
   766           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   767           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   768           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   769           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   770           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   771           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   772           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   773           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   774           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   775         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   776                                     COMP-3.
   777         16  CP-BEN-CATEGORY       PIC X.
   778         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   779         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   780                                   PIC S99V9(5) COMP-3.
   781         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   782         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   783                                   PIC S99V9(5) COMP-3.
   784         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   785         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   786         16  CP-EXPIRE-DT          PIC XX.
   787         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   788         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   789         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   790         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   791         16  CP-DDF-SPEC-CALC      PIC X.
   792             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   793             88  CP-CALC-CLP              VALUE 'C'.
   794         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   795         16  CP-CANCEL-REASON      PIC X.
   796         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   797         16  CP-PMT-MODE           PIC X.
   798         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   799         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   800         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   801         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   802         16  FILLER                PIC X.
   803
   804***************    OUTPUT FROM ELRESV   ************************
   805
   806         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   807
   808         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   809                                     COMP-3.
   810         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   811                                     COMP-3.
   812         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   813                                     COMP-3.
   814         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   815                                     COMP-3.
   816         16  FILLER                PIC X(09).
   817***************    OUTPUT FROM ELRTRM   *************************
   818
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  18
* EL154.cbl
   819         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   820                                     COMP-3.
   821         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   822                                     COMP-3.
   823         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   824                                     COMP-3.
   825         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   826                                     COMP-3.
   827         16  FILLER                PIC X(12).
   828
   829***************    OUTPUT FROM ELRAMT   *************************
   830
   831         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   832                                     COMP-3.
   833         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   834                                     COMP-3.
   835         16  FILLER                PIC X(12).
   836
   837***************    OUTPUT FROM ELRATE   *************************
   838
   839         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   840                                     COMP-3.
   841         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   842                                     COMP-3.
   843         16  CP-MORTALITY-CODE     PIC X(4).
   844         16  CP-RATE-EDIT-FLAG     PIC X.
   845             88  CP-RATES-NEED-APR                  VALUE '1'.
   846         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   847                                     COMP-3.
   848         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   849         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   850         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   851                                   PIC S9(7)V99 COMP-3.
   852         16  FILLER                PIC X(07).
   853
   854***************    OUTPUT FROM ELRFND   *************************
   855
   856         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   857                                     COMP-3.
   858         16  CP-REFUND-TYPE-USED   PIC X.
   859           88  CP-R-AS-R78                         VALUE '1'.
   860           88  CP-R-AS-PRORATA                     VALUE '2'.
   861           88  CP-R-AS-CALIF                       VALUE '3'.
   862           88  CP-R-AS-TEXAS                       VALUE '4'.
   863           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   864           88  CP-R-AS-NET-PAY                     VALUE '5'.
   865           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   866           88  CP-R-AS-MEAN                        VALUE '8'.
   867           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   868           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   869           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   870           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   871           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   872           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   873         16  FILLER                PIC X(12).
   874
   875***************    OUTPUT FROM ELEARN   *************************
   876
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  19
* EL154.cbl
   877         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   878                                     COMP-3.
   879         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   880                                     COMP-3.
   881         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   882                                     COMP-3.
   883         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   884                                     COMP-3.
   885         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   886                                     COMP-3.
   887         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   888                                     COMP-3.
   889         16  CP-EARNING-TYPE-USED  PIC X.
   890           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   891           88  CP-E-AS-R78                         VALUE '1'.
   892           88  CP-E-AS-PRORATA                     VALUE '2'.
   893           88  CP-E-AS-TEXAS                       VALUE '4'.
   894           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
   895           88  CP-E-AS-NET-PAY                     VALUE '5'.
   896           88  CP-E-AS-ANTICIPATION                VALUE '6'.
   897           88  CP-E-AS-MEAN                        VALUE '8'.
   898           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
   899         16  FILLER                PIC X(12).
   900
   901***************    OUTPUT FROM ELPMNT   *************************
   902
   903         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
   904                                     COMP-3.
   905         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
   906                                     COMP-3.
   907         16  FILLER                PIC X(12).
   908
   909***************   MISC WORK AREAS    *****************************
   910         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
   911                                     COMP-3.
   912         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
   913                                     COMP-3.
   914         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
   915                                     COMP-3.
   916         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
   917                                     COMP-3.
   918         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
   919                                     COMP-3.
   920         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
   921                                     COMP-3.
   922         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
   923             88  OPEN-RATE-FILE                   VALUE 'O'.
   924             88  CLOSE-RATE-FILE                  VALUE 'C'.
   925             88  IO-ERROR                         VALUE 'E'.
   926
   927         16  CP-FIRST-PAY-DATE     PIC XX.
   928
   929         16  CP-JOINT-INDICATOR    PIC X.
   930
   931         16  CP-RESERVE-REMAINING-TERM
   932                                   PIC S9(4)V9    VALUE ZERO
   933                                     COMP-3.
   934
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  20
* EL154.cbl
   935         16  CP-INSURED-BIRTH-DT   PIC XX.
   936
   937         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
   938                                     COMP-3.
   939
   940         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
   941                                     COMP-3.
   942
   943         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
   944                                     COMP-3.
   945
   946         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
   947                                     COMP-3.
   948
   949         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
   950                                     COMP-3.
   951
   952         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
   953                                     COMP-3.
   954
   955         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
   956                                     COMP-3.
   957
   958         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
   959             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
   960
   961         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
   962                                     COMP-3.
   963         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
   964                                     COMP-3.
   965         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
   966         16  FILLER                PIC X(15).
   967******************************************************************
   968
   969
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  21
* EL154.cbl
   971*                            COPY ELCDATE.
   972******************************************************************
   973*                                                                *
   974*                                                                *
   975*                            ELCDATE.                            *
   976*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   977*                            VMOD=2.003
   978*                                                                *
   979*                                                                *
   980*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   981*                 LENGTH = 200                                   *
   982******************************************************************
   983
   984 01  DATE-CONVERSION-DATA.
   985     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   986     12  DC-OPTION-CODE                PIC X.
   987         88  BIN-TO-GREG                VALUE ' '.
   988         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   989         88  EDIT-GREG-TO-BIN           VALUE '2'.
   990         88  YMD-GREG-TO-BIN            VALUE '3'.
   991         88  MDY-GREG-TO-BIN            VALUE '4'.
   992         88  JULIAN-TO-BIN              VALUE '5'.
   993         88  BIN-PLUS-ELAPSED           VALUE '6'.
   994         88  FIND-CENTURY               VALUE '7'.
   995         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   996         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   997         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   998         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   999         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1000         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1001         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1002         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1003         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1004         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1005         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1006         88  BIN-3-TO-GREG              VALUE 'I'.
  1007         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1008         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1009         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1010         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1011         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1012         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1013         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1014         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1015         88  THREE-CHARACTER-BIN
  1016                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1017         88  GREGORIAN-TO-BIN
  1018                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1019         88  BIN-TO-GREGORIAN
  1020                  VALUES ' ' '1' 'I' '8' 'G'.
  1021         88  JULIAN-TO-BINARY
  1022                  VALUES '5' 'C' 'E' 'F'.
  1023     12  DC-ERROR-CODE                 PIC X.
  1024         88  NO-CONVERSION-ERROR        VALUE ' '.
  1025         88  DATE-CONVERSION-ERROR
  1026                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1027         88  DATE-IS-ZERO               VALUE '1'.
  1028         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  22
* EL154.cbl
  1029         88  DATE-IS-INVALID            VALUE '3'.
  1030         88  DATE1-GREATER-DATE2        VALUE '4'.
  1031         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1032         88  DATE-INVALID-OPTION        VALUE '9'.
  1033         88  INVALID-CENTURY            VALUE 'A'.
  1034         88  ONLY-CENTURY               VALUE 'B'.
  1035         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1036         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1037     12  DC-END-OF-MONTH               PIC X.
  1038         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1039     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1040         88  USE-NORMAL-PROCESS         VALUE ' '.
  1041         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1042         88  ADJUST-UP-100-YRS          VALUE '2'.
  1043     12  FILLER                        PIC X.
  1044     12  DC-CONVERSION-DATES.
  1045         16  DC-BIN-DATE-1             PIC XX.
  1046         16  DC-BIN-DATE-2             PIC XX.
  1047         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1048         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1049                       DC-GREG-DATE-1-EDIT.
  1050             20  DC-EDIT1-MONTH        PIC 99.
  1051             20  SLASH1-1              PIC X.
  1052             20  DC-EDIT1-DAY          PIC 99.
  1053             20  SLASH1-2              PIC X.
  1054             20  DC-EDIT1-YEAR         PIC 99.
  1055         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1056         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1057                     DC-GREG-DATE-2-EDIT.
  1058             20  DC-EDIT2-MONTH        PIC 99.
  1059             20  SLASH2-1              PIC X.
  1060             20  DC-EDIT2-DAY          PIC 99.
  1061             20  SLASH2-2              PIC X.
  1062             20  DC-EDIT2-YEAR         PIC 99.
  1063         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1064         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1065                     DC-GREG-DATE-1-YMD.
  1066             20  DC-YMD-YEAR           PIC 99.
  1067             20  DC-YMD-MONTH          PIC 99.
  1068             20  DC-YMD-DAY            PIC 99.
  1069         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1070         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1071                      DC-GREG-DATE-1-MDY.
  1072             20  DC-MDY-MONTH          PIC 99.
  1073             20  DC-MDY-DAY            PIC 99.
  1074             20  DC-MDY-YEAR           PIC 99.
  1075         16  DC-GREG-DATE-1-ALPHA.
  1076             20  DC-ALPHA-MONTH        PIC X(10).
  1077             20  DC-ALPHA-DAY          PIC 99.
  1078             20  FILLER                PIC XX.
  1079             20  DC-ALPHA-CENTURY.
  1080                 24 DC-ALPHA-CEN-N     PIC 99.
  1081             20  DC-ALPHA-YEAR         PIC 99.
  1082         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1083         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1084         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1085         16  DC-JULIAN-DATE            PIC 9(05).
  1086         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  23
* EL154.cbl
  1087                                       PIC 9(05).
  1088         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1089             20  DC-JULIAN-YEAR        PIC 99.
  1090             20  DC-JULIAN-DAYS        PIC 999.
  1091         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1092         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1093         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1094     12  DATE-CONVERSION-VARIBLES.
  1095         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1096         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1097             20  FILLER                PIC 9(3).
  1098             20  HOLD-CEN-1-CCYY.
  1099                 24  HOLD-CEN-1-CC     PIC 99.
  1100                 24  HOLD-CEN-1-YY     PIC 99.
  1101             20  HOLD-CEN-1-MO         PIC 99.
  1102             20  HOLD-CEN-1-DA         PIC 99.
  1103         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1104             20  HOLD-CEN-1-R-MO       PIC 99.
  1105             20  HOLD-CEN-1-R-DA       PIC 99.
  1106             20  HOLD-CEN-1-R-CCYY.
  1107                 24  HOLD-CEN-1-R-CC   PIC 99.
  1108                 24  HOLD-CEN-1-R-YY   PIC 99.
  1109             20  FILLER                PIC 9(3).
  1110         16  HOLD-CENTURY-1-X.
  1111             20  FILLER                PIC X(3)  VALUE SPACES.
  1112             20  HOLD-CEN-1-X-CCYY.
  1113                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1114                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1115             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1116             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1117         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1118             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1119             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1120             20  HOLD-CEN-1-R-X-CCYY.
  1121                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1122                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1123             20  FILLER                PIC XXX.
  1124         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1125         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1126         16  DC-JULIAN-DATE-1          PIC 9(07).
  1127         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1128             20  DC-JULIAN-1-CCYY.
  1129                 24  DC-JULIAN-1-CC    PIC 99.
  1130                 24  DC-JULIAN-1-YR    PIC 99.
  1131             20  DC-JULIAN-DA-1        PIC 999.
  1132         16  DC-JULIAN-DATE-2          PIC 9(07).
  1133         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1134             20  DC-JULIAN-2-CCYY.
  1135                 24  DC-JULIAN-2-CC    PIC 99.
  1136                 24  DC-JULIAN-2-YR    PIC 99.
  1137             20  DC-JULIAN-DA-2        PIC 999.
  1138         16  DC-GREG-DATE-A-EDIT.
  1139             20  DC-EDITA-MONTH        PIC 99.
  1140             20  SLASHA-1              PIC X VALUE '/'.
  1141             20  DC-EDITA-DAY          PIC 99.
  1142             20  SLASHA-2              PIC X VALUE '/'.
  1143             20  DC-EDITA-CCYY.
  1144                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  24
* EL154.cbl
  1145                 24  DC-EDITA-YEAR     PIC 99.
  1146         16  DC-GREG-DATE-B-EDIT.
  1147             20  DC-EDITB-MONTH        PIC 99.
  1148             20  SLASHB-1              PIC X VALUE '/'.
  1149             20  DC-EDITB-DAY          PIC 99.
  1150             20  SLASHB-2              PIC X VALUE '/'.
  1151             20  DC-EDITB-CCYY.
  1152                 24  DC-EDITB-CENT     PIC 99.
  1153                 24  DC-EDITB-YEAR     PIC 99.
  1154         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1155         16  DC-GREG-DATE-CYMD-R REDEFINES
  1156                              DC-GREG-DATE-CYMD.
  1157             20  DC-CYMD-CEN           PIC 99.
  1158             20  DC-CYMD-YEAR          PIC 99.
  1159             20  DC-CYMD-MONTH         PIC 99.
  1160             20  DC-CYMD-DAY           PIC 99.
  1161         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1162         16  DC-GREG-DATE-MDCY-R REDEFINES
  1163                              DC-GREG-DATE-MDCY.
  1164             20  DC-MDCY-MONTH         PIC 99.
  1165             20  DC-MDCY-DAY           PIC 99.
  1166             20  DC-MDCY-CEN           PIC 99.
  1167             20  DC-MDCY-YEAR          PIC 99.
  1168    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1169        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1170    12  DC-EL310-DATE                  PIC X(21).
  1171    12  FILLER                         PIC X(28).
  1172
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  25
* EL154.cbl
  1174*                            COPY ELCLOGOF.
  1175******************************************************************
  1176*                                                                *
  1177*                                                                *
  1178*                            ELCLOGOF.                           *
  1179*                            VMOD=2.001                          *
  1180*                                                                *
  1181*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1182*                                                                *
  1183******************************************************************
  1184 01  CLASIC-LOGOFF.
  1185     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1186     12  LOGOFF-TEXT.
  1187         16  FILLER          PIC X(5)    VALUE SPACES.
  1188         16  LOGOFF-MSG.
  1189             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1190             20  FILLER      PIC X       VALUE SPACES.
  1191             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1192         16  FILLER          PIC X(80)
  1193           VALUE '* YOU ARE NOW LOGGED OFF'.
  1194         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1195         16  FILLER          PIC X       VALUE QUOTE.
  1196         16  LOGOFF-SYS-MSG  PIC X(17)
  1197           VALUE 'S CLAS-IC SYSTEM '.
  1198     12  TEXT-MESSAGES.
  1199         16  UNACCESS-MSG    PIC X(29)
  1200             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1201         16  PGMIDERR-MSG    PIC X(17)
  1202             VALUE 'PROGRAM NOT FOUND'.
  1203
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  26
* EL154.cbl
  1205*                            COPY ELCATTR.
  1206******************************************************************
  1207*                                                                *
  1208*                            ELCATTR.                            *
  1209*                            VMOD=2.001                          *
  1210*                                                                *
  1211*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1212*                                                                *
  1213*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1214*                                                                *
  1215*                   POS 1   P=PROTECTED                          *
  1216*                           U=UNPROTECTED                        *
  1217*                           S=ASKIP                              *
  1218*                   POS 2   A=ALPHA/NUMERIC                      *
  1219*                           N=NUMERIC                            *
  1220*                   POS 3   N=NORMAL                             *
  1221*                           B=BRIGHT                             *
  1222*                           D=DARK                               *
  1223*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1224*                           OF=MODIFIED DATA TAG OFF             *
  1225*                                                                *
  1226*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1227******************************************************************
  1228 01  ATTRIBUTE-LIST.
  1229     12  AL-PABOF            PIC X       VALUE 'Y'.
  1230     12  AL-PABON            PIC X       VALUE 'Z'.
  1231     12  AL-PADOF            PIC X       VALUE '%'.
  1232     12  AL-PADON            PIC X       VALUE '_'.
  1233     12  AL-PANOF            PIC X       VALUE '-'.
  1234     12  AL-PANON            PIC X       VALUE '/'.
  1235     12  AL-SABOF            PIC X       VALUE '8'.
  1236     12  AL-SABON            PIC X       VALUE '9'.
  1237     12  AL-SADOF            PIC X       VALUE '@'.
  1238     12  AL-SADON            PIC X       VALUE QUOTE.
  1239     12  AL-SANOF            PIC X       VALUE '0'.
  1240     12  AL-SANON            PIC X       VALUE '1'.
  1241     12  AL-UABOF            PIC X       VALUE 'H'.
  1242     12  AL-UABON            PIC X       VALUE 'I'.
  1243     12  AL-UADOF            PIC X       VALUE '<'.
  1244     12  AL-UADON            PIC X       VALUE '('.
  1245     12  AL-UANOF            PIC X       VALUE ' '.
  1246     12  AL-UANON            PIC X       VALUE 'A'.
  1247     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1248     12  AL-UNBON            PIC X       VALUE 'R'.
  1249     12  AL-UNDOF            PIC X       VALUE '*'.
  1250     12  AL-UNDON            PIC X       VALUE ')'.
  1251     12  AL-UNNOF            PIC X       VALUE '&'.
  1252     12  AL-UNNON            PIC X       VALUE 'J'.
  1253
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  27
* EL154.cbl
  1255*                            COPY ELCEMIB.
  1256******************************************************************
  1257*                                                                *
  1258*                                                                *
  1259*                            ELCEMIB.                            *
  1260*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1261*                            VMOD=2.005                          *
  1262*                                                                *
  1263*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1264*                                                                *
  1265******************************************************************
  1266 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1267     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1268     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1269     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1270     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1271     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1272     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1273     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1274     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1275     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1276         88  EMI-NO-ERRORS                    VALUE '1'.
  1277         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1278         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1279     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1280         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1281     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1282         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1283         88  EMI-AREA1-FULL                   VALUE '2'.
  1284     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1285         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1286         88  EMI-AREA2-FULL                   VALUE '2'.
  1287     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1288         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1289         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1290         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1291         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1292         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1293     12  EMI-ERROR-LINES.
  1294         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1295         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1296         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1297         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1298             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1299                 24  EMI-ERR-NUM         PIC X(4).
  1300                 24  EMI-FILLER          PIC X.
  1301                 24  EMI-SEV             PIC X.
  1302                 24  FILLER              PIC X.
  1303             20  FILLER                  PIC X(02).
  1304     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1305         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1306             20  EMI-ERROR-NUMBER    PIC X(4).
  1307             20  EMI-FILL            PIC X.
  1308             20  EMI-SEVERITY        PIC X.
  1309             20  FILLER              PIC X.
  1310             20  EMI-ERROR-TEXT.
  1311                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1312                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  28
* EL154.cbl
  1313     12  EMI-SEVERITY-SAVE           PIC X.
  1314         88  EMI-NOTE                    VALUE 'N'.
  1315         88  EMI-WARNING                 VALUE 'W'.
  1316         88  EMI-FORCABLE                VALUE 'F'.
  1317         88  EMI-FATAL                   VALUE 'X'.
  1318     12  EMI-MESSAGE-FLAG            PIC X.
  1319         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1320         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1321     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1322     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1323         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1324         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1325         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1326     12  emi-claim-no                pic x(7).
  1327     12  emi-claim-type              pic x(6).
  1328     12  FILLER                      PIC X(124)  VALUE SPACES.
  1329     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1330     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1331     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1332     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  29
* EL154.cbl
  1334*                            COPY ELCLNKLT.
  1335******************************************************************
  1336*                                                                *
  1337*                                                                *
  1338*                           ELCLNKLT                             *
  1339*                            VMOD=2.003                          *
  1340*                                                                *
  1341*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1342*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1343*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1344*                                                                *
  1345*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1346*   COMPLETING THE REQUIRED FIELDS.                              *
  1347*                                                                *
  1348*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1349*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1350*                              9999 INDICATES AN UNKNOWN ABEND   *
  1351*                                   WAS DETECTED.                *
  1352*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1353*                              CODES FOUND IN THE ERROR FILE.    *
  1354******************************************************************
  1355 01  W-1523-LINKDATA.
  1356     12  W-1523-COMMON-PI-DATA.
  1357         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1358         16  FILLER              PIC  X(67).
  1359         16  W-1523-COMPANY-CD   PIC  X(01).
  1360         16  FILLER              PIC  X(10).
  1361         16  W-1523-CONTROL-IN-PROGRESS.
  1362             20  W-1523-CARRIER  PIC  X(01).
  1363             20  W-1523-GROUPING PIC  X(06).
  1364             20  W-1523-STATE    PIC  X(02).
  1365             20  W-1523-ACCOUNT  PIC  X(10).
  1366             20  W-1523-CLAIM-CERT-GRP.
  1367                 24  W-1523-CLAIM-NO
  1368                                 PIC  X(07).
  1369                 24  W-1523-CERT-NO.
  1370                     28  W-1523-CERT-PRIME
  1371                                 PIC  X(10).
  1372                     28  W-1523-CERT-SFX
  1373                                 PIC  X(01).
  1374                 24  W-1523-CERT-EFF-DT
  1375                                 PIC  X(02).
  1376         16  FILLER              PIC X(265).
  1377
  1378     12  W-1523-WORK-AREA.
  1379         16  W-1523-FORM-NUMBER  PIC  X(04).
  1380         16  W-1523-NUMBER-COPIES
  1381                                 PIC  9(01).
  1382         16  W-1523-ADDR-TYPE    PIC  X(02).
  1383         16  W-1523-FOLLOW-UP-DATE
  1384                                 PIC  X(02).
  1385         16  W-1523-RESEND-DATE  PIC  X(02).
  1386         16  W-1523-ERROR-CODE   PIC  9(04).
  1387             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1388             88  W-1523-FATAL-ERROR
  1389                                    VALUES  0006 0013 0042
  1390                                            0154 0168 0169
  1391                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  30
* EL154.cbl
  1392                                            0179 0186 0281
  1393                                            0332 2055 3697
  1394                                            3698 3699 3770
  1395                                            3771 3772 7675
  1396                                            9106 9808 9883
  1397                                            9887.
  1398             88  W-1523-STOP-ERRORS
  1399                                    VALUES  0013 0042 0154
  1400                                            0168 0169 0172
  1401                                            0281 0332 2055
  1402                                            3698 3699 7675
  1403                                            9106 9808 9883
  1404                                            9999.
  1405         16  W-1523-REASON       PIC  X(70).
  1406         16  W-1523-ARCHIVE-NUMBER
  1407                                 PIC  9(08).
  1408     12  W-1523-POINTER-AREA.
  1409         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1410         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1411         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1412         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1413         16  W-1523-PROD-POINTER PIC S9(08) COMP.
  1414
  1415     12  W-1523-LETTER-DATE       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  31
* EL154.cbl
  1417*                            COPY ELCINTF.
  1418******************************************************************
  1419*                                                                *
  1420*                                                                *
  1421*                            ELCINTF.                            *
  1422*                            VMOD=2.017                          *
  1423*                                                                *
  1424*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1425*                                                                *
  1426*       LENGTH = 1024                                            *
  1427*                                                                *
  1428******************************************************************
  1429*                   C H A N G E   L O G
  1430*
  1431* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1432*-----------------------------------------------------------------
  1433*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1434* EFFECTIVE    NUMBER
  1435*-----------------------------------------------------------------
  1436* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1437******************************************************************
  1438 01  PROGRAM-INTERFACE-BLOCK.
  1439     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1440     12  PI-CALLING-PROGRAM              PIC X(8).
  1441     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1442     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1443     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1444     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1445     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1446     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1447     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1448     12  PI-COMPANY-ID                   PIC XXX.
  1449     12  PI-COMPANY-CD                   PIC X.
  1450
  1451     12  PI-COMPANY-PASSWORD             PIC X(8).
  1452
  1453     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1454
  1455     12  PI-CONTROL-IN-PROGRESS.
  1456         16  PI-CARRIER                  PIC X.
  1457         16  PI-GROUPING                 PIC X(6).
  1458         16  PI-STATE                    PIC XX.
  1459         16  PI-ACCOUNT                  PIC X(10).
  1460         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1461                                         PIC X(10).
  1462         16  PI-CLAIM-CERT-GRP.
  1463             20  PI-CLAIM-NO             PIC X(7).
  1464             20  PI-CERT-NO.
  1465                 25  PI-CERT-PRIME       PIC X(10).
  1466                 25  PI-CERT-SFX         PIC X.
  1467             20  PI-CERT-EFF-DT          PIC XX.
  1468         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1469             20  PI-PLAN-CODE            PIC X(2).
  1470             20  PI-REVISION-NUMBER      PIC X(3).
  1471             20  PI-PLAN-EFF-DT          PIC X(2).
  1472             20  PI-PLAN-EXP-DT          PIC X(2).
  1473             20  FILLER                  PIC X(11).
  1474         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  32
* EL154.cbl
  1475             20  PI-OE-REFERENCE-1.
  1476                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1477                 25  PI-OE-REF-1-SUFF    PIC XX.
  1478
  1479     12  PI-SESSION-IN-PROGRESS          PIC X.
  1480         88  CLAIM-SESSION                   VALUE '1'.
  1481         88  CREDIT-SESSION                  VALUE '2'.
  1482         88  WARRANTY-SESSION                VALUE '3'.
  1483         88  MORTGAGE-SESSION                VALUE '4'.
  1484         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1485
  1486
  1487*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1488
  1489     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1490     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1491
  1492     12  PI-CREDIT-USER                  PIC X.
  1493         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1494         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1495
  1496     12  PI-CLAIM-USER                   PIC X.
  1497         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1498         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1499
  1500     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1501         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1502         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1503         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1504         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1505         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1506
  1507     12  PI-PROCESSOR-ID                 PIC X(4).
  1508
  1509     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1510
  1511     12  PI-MEMBER-CAPTION               PIC X(10).
  1512
  1513     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1514         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1515
  1516     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1517     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1518     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1519     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1520
  1521     12  PI-AH-OVERRIDE-L1               PIC X.
  1522     12  PI-AH-OVERRIDE-L2               PIC XX.
  1523     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1524     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1525
  1526     12  PI-NEW-SYSTEM                   PIC X(2).
  1527
  1528     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1529     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1530         88  PI-USES-PAID-TO                 VALUE '1'.
  1531     12  PI-CRDTCRD-SYSTEM.
  1532         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  33
* EL154.cbl
  1533             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1534             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1535         16  PI-CC-MONTH-END-DT          PIC XX.
  1536     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1537
  1538     12  PI-OE-REFERENCE-2.
  1539         16  PI-OE-REF-2-PRIME           PIC X(10).
  1540         16  PI-OE-REF-2-SUFF            PIC X.
  1541
  1542     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1543
  1544     12  PI-LANGUAGE-TYPE                PIC X.
  1545             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1546             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1547             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1548
  1549     12  PI-POLICY-LINKAGE-IND           PIC X.
  1550         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1551         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1552                                                   LOW-VALUES.
  1553
  1554     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1555     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1556         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1557         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1558
  1559     12  PI-PROCESSOR-CSR-IND            PIC X.
  1560         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1561         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1562
  1563     12  FILLER                          PIC X(3).
  1564
  1565     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1566
  1567     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1568         PI-SYSTEM-LEVEL.
  1569
  1570         16  PI-ENTRY-CODES.
  1571             20  PI-ENTRY-CD-1           PIC X.
  1572             20  PI-ENTRY-CD-2           PIC X.
  1573
  1574         16  PI-RETURN-CODES.
  1575             20  PI-RETURN-CD-1          PIC X.
  1576             20  PI-RETURN-CD-2          PIC X.
  1577
  1578         16  PI-UPDATE-STATUS-SAVE.
  1579             20  PI-UPDATE-BY            PIC X(4).
  1580             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1581
  1582         16  PI-LOWER-CASE-LETTERS       PIC X.
  1583             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1584
  1585*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1586*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1587*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1588
  1589         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1590             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  34
* EL154.cbl
  1591             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1592             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1593             88  ACCNT-CNTL                  VALUE '3'.
  1594             88  CARR-ACCNT-CNTL             VALUE '4'.
  1595
  1596         16  PI-PROCESSOR-CAP-LIST.
  1597             20  PI-SYSTEM-CONTROLS.
  1598                24 PI-SYSTEM-DISPLAY     PIC X.
  1599                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1600                24 PI-SYSTEM-MODIFY      PIC X.
  1601                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1602             20  FILLER                  PIC XX.
  1603             20  PI-DISPLAY-CAP          PIC X.
  1604                 88  DISPLAY-CAP             VALUE 'Y'.
  1605             20  PI-MODIFY-CAP           PIC X.
  1606                 88  MODIFY-CAP              VALUE 'Y'.
  1607             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1608                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1609             20  PI-FORCE-CAP            PIC X.
  1610                 88  FORCE-CAP               VALUE 'Y'.
  1611
  1612         16  PI-PROGRAM-CONTROLS.
  1613             20  PI-PGM-PRINT-OPT        PIC X.
  1614             20  PI-PGM-FORMAT-OPT       PIC X.
  1615             20  PI-PGM-PROCESS-OPT      PIC X.
  1616             20  PI-PGM-TOTALS-OPT       PIC X.
  1617
  1618         16  PI-HELP-INTERFACE.
  1619             20  PI-LAST-ERROR-NO        PIC X(4).
  1620             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1621
  1622         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1623             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1624
  1625         16  PI-CR-CONTROL-IN-PROGRESS.
  1626             20  PI-CR-CARRIER           PIC X.
  1627             20  PI-CR-GROUPING          PIC X(6).
  1628             20  PI-CR-STATE             PIC XX.
  1629             20  PI-CR-ACCOUNT           PIC X(10).
  1630             20  PI-CR-FIN-RESP          PIC X(10).
  1631             20  PI-CR-TYPE              PIC X.
  1632
  1633         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1634
  1635         16  PI-CR-MONTH-END-DT          PIC XX.
  1636
  1637         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1638             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1639             88  PI-ZERO-CARRIER             VALUE '1'.
  1640             88  PI-ZERO-GROUPING            VALUE '2'.
  1641             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1642
  1643         16  PI-CARRIER-SECURITY         PIC X.
  1644             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1645
  1646         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1647             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1648             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  35
* EL154.cbl
  1649
  1650         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1651             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1652                                         INDEXED BY PI-ACCESS-NDX
  1653                                         PIC X.
  1654
  1655         16  PI-GA-BILLING-CONTROL       PIC X.
  1656             88  PI-GA-BILLING               VALUE '1'.
  1657
  1658         16  PI-MAIL-PROCESSING          PIC X.
  1659             88  PI-MAIL-YES                 VALUE 'Y'.
  1660
  1661         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1662
  1663         16  PI-AR-SYSTEM.
  1664             20  PI-AR-PROCESSING-CNTL   PIC X.
  1665                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1666             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1667             20  PI-AR-MONTH-END-DT      PIC XX.
  1668
  1669         16  PI-MP-SYSTEM.
  1670             20  PI-MORTGAGE-USER            PIC X.
  1671                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1672                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1673             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1674                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1675                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1676                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1677                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1678                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1679             20  PI-MP-MONTH-END-DT          PIC XX.
  1680             20  PI-MP-REFERENCE-NO.
  1681                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1682                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1683
  1684         16  PI-LABEL-CONTROL            PIC X(01).
  1685             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1686             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1687
  1688         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1689             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1690
  1691         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1692             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1693             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1694
  1695         16  FILLER                      PIC X(14).
  1696
  1697     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1698******************************************************************
  1699     12  PI-REDEF       REDEFINES PI-PROGRAM-WORK-AREA.
  1700         16  PI-BENEFIT-SAVE.
  1701             18  PI-BEN-DAYS      PIC 99.
  1702             18  PI-BEN-TYPE      PIC X.
  1703*00269   16  FILLER               PIC X(637).
  1704         16  PI-AUTO-END-LETTER   PIC X(04).
  1705         16  FILLER               PIC X(633).
  1706
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  36
* EL154.cbl
  1708*                            COPY ELCAID.
  1709******************************************************************
  1710*                                                                *
  1711*                            ELCAID.                             *
  1712*                            VMOD=2.001                          *
  1713*                                                                *
  1714*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1715*                                                                *
  1716*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1717*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1718******************************************************************
  1719
  1720 01  DFHAID.
  1721   02  DFHNULL   PIC  X  VALUE  ' '.
  1722   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1723   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1724   02  DFHPEN    PIC  X  VALUE  '='.
  1725   02  DFHOPID   PIC  X  VALUE  'W'.
  1726   02  DFHPA1    PIC  X  VALUE  '%'.
  1727   02  DFHPA2    PIC  X  VALUE  '>'.
  1728   02  DFHPA3    PIC  X  VALUE  ','.
  1729   02  DFHPF1    PIC  X  VALUE  '1'.
  1730   02  DFHPF2    PIC  X  VALUE  '2'.
  1731   02  DFHPF3    PIC  X  VALUE  '3'.
  1732   02  DFHPF4    PIC  X  VALUE  '4'.
  1733   02  DFHPF5    PIC  X  VALUE  '5'.
  1734   02  DFHPF6    PIC  X  VALUE  '6'.
  1735   02  DFHPF7    PIC  X  VALUE  '7'.
  1736   02  DFHPF8    PIC  X  VALUE  '8'.
  1737   02  DFHPF9    PIC  X  VALUE  '9'.
  1738   02  DFHPF10   PIC  X  VALUE  ':'.
  1739   02  DFHPF11   PIC  X  VALUE  '#'.
  1740   02  DFHPF12   PIC  X  VALUE  '@'.
  1741   02  DFHPF13   PIC  X  VALUE  'A'.
  1742   02  DFHPF14   PIC  X  VALUE  'B'.
  1743   02  DFHPF15   PIC  X  VALUE  'C'.
  1744   02  DFHPF16   PIC  X  VALUE  'D'.
  1745   02  DFHPF17   PIC  X  VALUE  'E'.
  1746   02  DFHPF18   PIC  X  VALUE  'F'.
  1747   02  DFHPF19   PIC  X  VALUE  'G'.
  1748   02  DFHPF20   PIC  X  VALUE  'H'.
  1749   02  DFHPF21   PIC  X  VALUE  'I'.
  1750*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1751   02  DFHPF22   PIC  X  VALUE  '['.
  1752   02  DFHPF23   PIC  X  VALUE  '.'.
  1753   02  DFHPF24   PIC  X  VALUE  '<'.
  1754   02  DFHMSRE   PIC  X  VALUE  'X'.
  1755   02  DFHSTRF   PIC  X  VALUE  'h'.
  1756   02  DFHTRIG   PIC  X  VALUE  '"'.
  1757 01  FILLER    REDEFINES DFHAID.
  1758     12  FILLER              PIC X(8).
  1759     12  PF-VALUES           PIC X       OCCURS 2.
  1760
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  37
* EL154.cbl
  1762*                            COPY EL154S.
  1763 01  EL154AI.
  1764     05  FILLER            PIC  X(0012).
  1765*    -------------------------------
  1766     05  RUNDTEL PIC S9(0004) COMP.
  1767     05  RUNDTEF PIC  X(0001).
  1768     05  FILLER REDEFINES RUNDTEF.
  1769         10  RUNDTEA PIC  X(0001).
  1770     05  RUNDTEI PIC  X(0008).
  1771*    -------------------------------
  1772     05  RUNTIMEL PIC S9(0004) COMP.
  1773     05  RUNTIMEF PIC  X(0001).
  1774     05  FILLER REDEFINES RUNTIMEF.
  1775         10  RUNTIMEA PIC  X(0001).
  1776     05  RUNTIMEI PIC  X(0005).
  1777*    -------------------------------
  1778     05  CLAIML PIC S9(0004) COMP.
  1779     05  CLAIMF PIC  X(0001).
  1780     05  FILLER REDEFINES CLAIMF.
  1781         10  CLAIMA PIC  X(0001).
  1782     05  CLAIMI PIC  X(0007).
  1783*    -------------------------------
  1784     05  CARRL PIC S9(0004) COMP.
  1785     05  CARRF PIC  X(0001).
  1786     05  FILLER REDEFINES CARRF.
  1787         10  CARRA PIC  X(0001).
  1788     05  CARRI PIC  X(0001).
  1789*    -------------------------------
  1790     05  CERTL PIC S9(0004) COMP.
  1791     05  CERTF PIC  X(0001).
  1792     05  FILLER REDEFINES CERTF.
  1793         10  CERTA PIC  X(0001).
  1794     05  CERTI PIC  X(0010).
  1795*    -------------------------------
  1796     05  SUFFIXL PIC S9(0004) COMP.
  1797     05  SUFFIXF PIC  X(0001).
  1798     05  FILLER REDEFINES SUFFIXF.
  1799         10  SUFFIXA PIC  X(0001).
  1800     05  SUFFIXI PIC  X(0001).
  1801*    -------------------------------
  1802     05  CESTDTEL PIC S9(0004) COMP.
  1803     05  CESTDTEF PIC  X(0001).
  1804     05  FILLER REDEFINES CESTDTEF.
  1805         10  CESTDTEA PIC  X(0001).
  1806     05  CESTDTEI PIC  X(0008).
  1807*    -------------------------------
  1808     05  CESTBYL PIC S9(0004) COMP.
  1809     05  CESTBYF PIC  X(0001).
  1810     05  FILLER REDEFINES CESTBYF.
  1811         10  CESTBYA PIC  X(0001).
  1812     05  CESTBYI PIC  X(0004).
  1813*    -------------------------------
  1814     05  FSTHD1L PIC S9(0004) COMP.
  1815     05  FSTHD1F PIC  X(0001).
  1816     05  FILLER REDEFINES FSTHD1F.
  1817         10  FSTHD1A PIC  X(0001).
  1818     05  FSTHD1I PIC  X(0023).
  1819*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  38
* EL154.cbl
  1820     05  CFSTPMTL PIC S9(0004) COMP.
  1821     05  CFSTPMTF PIC  X(0001).
  1822     05  FILLER REDEFINES CFSTPMTF.
  1823         10  CFSTPMTA PIC  X(0001).
  1824     05  CFSTPMTI PIC  X(0008).
  1825*    -------------------------------
  1826     05  CMONTHSL PIC S9(0004) COMP.
  1827     05  CMONTHSF PIC  X(0001).
  1828     05  FILLER REDEFINES CMONTHSF.
  1829         10  CMONTHSA PIC  X(0001).
  1830     05  CMONTHSI PIC  X(0002).
  1831*    -------------------------------
  1832     05  CFSTAMTL PIC S9(0004) COMP.
  1833     05  CFSTAMTF PIC  X(0001).
  1834     05  FILLER REDEFINES CFSTAMTF.
  1835         10  CFSTAMTA PIC  X(0001).
  1836     05  CFSTAMTI PIC  X(0009).
  1837*    -------------------------------
  1838     05  LSTHD1L PIC S9(0004) COMP.
  1839     05  LSTHD1F PIC  X(0001).
  1840     05  FILLER REDEFINES LSTHD1F.
  1841         10  LSTHD1A PIC  X(0001).
  1842     05  LSTHD1I PIC  X(0024).
  1843*    -------------------------------
  1844     05  CLSTPMTL PIC S9(0004) COMP.
  1845     05  CLSTPMTF PIC  X(0001).
  1846     05  FILLER REDEFINES CLSTPMTF.
  1847         10  CLSTPMTA PIC  X(0001).
  1848     05  CLSTPMTI PIC  X(0008).
  1849*    -------------------------------
  1850     05  CLASTL PIC S9(0004) COMP.
  1851     05  CLASTF PIC  X(0001).
  1852     05  FILLER REDEFINES CLASTF.
  1853         10  CLASTA PIC  X(0001).
  1854     05  CLASTI PIC  X(0001).
  1855*    -------------------------------
  1856     05  CREGPMTL PIC S9(0004) COMP.
  1857     05  CREGPMTF PIC  X(0001).
  1858     05  FILLER REDEFINES CREGPMTF.
  1859         10  CREGPMTA PIC  X(0001).
  1860     05  CREGPMTI PIC  X(0009).
  1861*    -------------------------------
  1862     05  CDAYSFL PIC S9(0004) COMP.
  1863     05  CDAYSFF PIC  X(0001).
  1864     05  FILLER REDEFINES CDAYSFF.
  1865         10  CDAYSFA PIC  X(0001).
  1866     05  CDAYSFI PIC  X(0003).
  1867*    -------------------------------
  1868     05  CPAYEEL PIC S9(0004) COMP.
  1869     05  CPAYEEF PIC  X(0001).
  1870     05  FILLER REDEFINES CPAYEEF.
  1871         10  CPAYEEA PIC  X(0001).
  1872     05  CPAYEEI PIC  X(0008).
  1873*    -------------------------------
  1874     05  DAY2PAYL PIC S9(0004) COMP.
  1875     05  DAY2PAYF PIC  X(0001).
  1876     05  FILLER REDEFINES DAY2PAYF.
  1877         10  DAY2PAYA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  39
* EL154.cbl
  1878     05  DAY2PAYI PIC  99.
  1879*    -------------------------------
  1880     05  CEFFDTEL PIC S9(0004) COMP.
  1881     05  CEFFDTEF PIC  X(0001).
  1882     05  FILLER REDEFINES CEFFDTEF.
  1883         10  CEFFDTEA PIC  X(0001).
  1884     05  CEFFDTEI PIC  X(0008).
  1885*    -------------------------------
  1886     05  TERML PIC S9(0004) COMP.
  1887     05  TERMF PIC  X(0001).
  1888     05  FILLER REDEFINES TERMF.
  1889         10  TERMA PIC  X(0001).
  1890     05  TERMI PIC  X(0001).
  1891*    -------------------------------
  1892     05  CINDCTRL PIC S9(0004) COMP.
  1893     05  CINDCTRF PIC  X(0001).
  1894     05  FILLER REDEFINES CINDCTRF.
  1895         10  CINDCTRA PIC  X(0001).
  1896     05  CINDCTRI PIC  X(0001).
  1897*    -------------------------------
  1898     05  PRINTL PIC S9(0004) COMP.
  1899     05  PRINTF PIC  X(0001).
  1900     05  FILLER REDEFINES PRINTF.
  1901         10  PRINTA PIC  X(0001).
  1902     05  PRINTI PIC  X(0004).
  1903*    -------------------------------
  1904     05  FSTHD2L PIC S9(0004) COMP.
  1905     05  FSTHD2F PIC  X(0001).
  1906     05  FILLER REDEFINES FSTHD2F.
  1907         10  FSTHD2A PIC  X(0001).
  1908     05  FSTHD2I PIC  X(0023).
  1909*    -------------------------------
  1910     05  NFSTPMTL PIC S9(0004) COMP.
  1911     05  NFSTPMTF PIC  X(0001).
  1912     05  FILLER REDEFINES NFSTPMTF.
  1913         10  NFSTPMTA PIC  X(0001).
  1914     05  NFSTPMTI PIC  X(0008).
  1915*    -------------------------------
  1916     05  NFSTAMTL PIC S9(0004) COMP.
  1917     05  NFSTAMTF PIC  X(0001).
  1918     05  FILLER REDEFINES NFSTAMTF.
  1919         10  NFSTAMTA PIC  X(0001).
  1920     05  NFSTAMTI PIC  S9(8)V99.
  1921*    -------------------------------
  1922     05  LSTHD2L PIC S9(0004) COMP.
  1923     05  LSTHD2F PIC  X(0001).
  1924     05  FILLER REDEFINES LSTHD2F.
  1925         10  LSTHD2A PIC  X(0001).
  1926     05  LSTHD2I PIC  X(0023).
  1927*    -------------------------------
  1928     05  NLSTPMTL PIC S9(0004) COMP.
  1929     05  NLSTPMTF PIC  X(0001).
  1930     05  FILLER REDEFINES NLSTPMTF.
  1931         10  NLSTPMTA PIC  X(0001).
  1932     05  NLSTPMTI PIC  X(0008).
  1933*    -------------------------------
  1934     05  NEFFDTEL PIC S9(0004) COMP.
  1935     05  NEFFDTEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  40
* EL154.cbl
  1936     05  FILLER REDEFINES NEFFDTEF.
  1937         10  NEFFDTEA PIC  X(0001).
  1938     05  NEFFDTEI PIC  X(0008).
  1939*    -------------------------------
  1940     05  NMONTHSL PIC S9(0004) COMP.
  1941     05  NMONTHSF PIC  X(0001).
  1942     05  FILLER REDEFINES NMONTHSF.
  1943         10  NMONTHSA PIC  X(0001).
  1944     05  NMONTHSI PIC  99.
  1945*    -------------------------------
  1946     05  NDAYSFL PIC S9(0004) COMP.
  1947     05  NDAYSFF PIC  X(0001).
  1948     05  FILLER REDEFINES NDAYSFF.
  1949         10  NDAYSFA PIC  X(0001).
  1950     05  NDAYSFI PIC  999.
  1951*    -------------------------------
  1952     05  NPAYEEL PIC S9(0004) COMP.
  1953     05  NPAYEEF PIC  X(0001).
  1954     05  FILLER REDEFINES NPAYEEF.
  1955         10  NPAYEEA PIC  X(0001).
  1956     05  NPAYEEI PIC  X(0002).
  1957*    -------------------------------
  1958     05  NREGAMTL PIC S9(0004) COMP.
  1959     05  NREGAMTF PIC  X(0001).
  1960     05  FILLER REDEFINES NREGAMTF.
  1961         10  NREGAMTA PIC  X(0001).
  1962     05  NREGAMTI PIC  X(0010).
  1963*    -------------------------------
  1964     05  NLASTL PIC S9(0004) COMP.
  1965     05  NLASTF PIC  X(0001).
  1966     05  FILLER REDEFINES NLASTF.
  1967         10  NLASTA PIC  X(0001).
  1968     05  NLASTI PIC  X(0001).
  1969*    -------------------------------
  1970     05  NINDCTRL PIC S9(0004) COMP.
  1971     05  NINDCTRF PIC  X(0001).
  1972     05  FILLER REDEFINES NINDCTRF.
  1973         10  NINDCTRA PIC  X(0001).
  1974     05  NINDCTRI PIC  X(0001).
  1975*    -------------------------------
  1976     05  DAYPAYL PIC S9(0004) COMP.
  1977     05  DAYPAYF PIC  X(0001).
  1978     05  FILLER REDEFINES DAYPAYF.
  1979         10  DAYPAYA PIC  X(0001).
  1980     05  DAYPAYI PIC  99.
  1981*    -------------------------------
  1982     05  NPRINTL PIC S9(0004) COMP.
  1983     05  NPRINTF PIC  X(0001).
  1984     05  FILLER REDEFINES NPRINTF.
  1985         10  NPRINTA PIC  X(0001).
  1986     05  NPRINTI PIC  X(0004).
  1987*    -------------------------------
  1988     05  LETTDTEL PIC S9(0004) COMP.
  1989     05  LETTDTEF PIC  X(0001).
  1990     05  FILLER REDEFINES LETTDTEF.
  1991         10  LETTDTEA PIC  X(0001).
  1992     05  LETTDTEI PIC  X(0008).
  1993*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  41
* EL154.cbl
  1994     05  ENDLETTL PIC S9(0004) COMP.
  1995     05  ENDLETTF PIC  X(0001).
  1996     05  FILLER REDEFINES ENDLETTF.
  1997         10  ENDLETTA PIC  X(0001).
  1998     05  ENDLETTI PIC  X(0004).
  1999*    -------------------------------
  2000     05  ERRMSG1L PIC S9(0004) COMP.
  2001     05  ERRMSG1F PIC  X(0001).
  2002     05  FILLER REDEFINES ERRMSG1F.
  2003         10  ERRMSG1A PIC  X(0001).
  2004     05  ERRMSG1I PIC  X(0079).
  2005*    -------------------------------
  2006     05  ERRMSG2L PIC S9(0004) COMP.
  2007     05  ERRMSG2F PIC  X(0001).
  2008     05  FILLER REDEFINES ERRMSG2F.
  2009         10  ERRMSG2A PIC  X(0001).
  2010     05  ERRMSG2I PIC  X(0079).
  2011*    -------------------------------
  2012     05  ENTERPFL PIC S9(0004) COMP.
  2013     05  ENTERPFF PIC  X(0001).
  2014     05  FILLER REDEFINES ENTERPFF.
  2015         10  ENTERPFA PIC  X(0001).
  2016     05  ENTERPFI PIC  99.
  2017 01  EL154AO REDEFINES EL154AI.
  2018     05  FILLER            PIC  X(0012).
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  RUNDTEO PIC  X(0008).
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  RUNTIMEO PIC  99.99.
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  CLAIMO PIC  X(0007).
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  CARRO PIC  X(0001).
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  CERTO PIC  X(0010).
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  SUFFIXO PIC  X(0001).
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  CESTDTEO PIC  X(0008).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  CESTBYO PIC  X(0004).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  FSTHD1O PIC  X(0023).
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  CFSTPMTO PIC  X(0008).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  CMONTHSO PIC  99.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  42
* EL154.cbl
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  CFSTAMTO PIC  ZZ,ZZ9.99.
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  LSTHD1O PIC  X(0024).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  CLSTPMTO PIC  X(0008).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  CLASTO PIC  X(0001).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  CREGPMTO PIC  ZZ,ZZ9.99.
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  CDAYSFO PIC  ZZ9.
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  CPAYEEO PIC  X(0008).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  DAY2PAYO PIC  X(0002).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  CEFFDTEO PIC  X(0008).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  TERMO PIC  X(0001).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  CINDCTRO PIC  X(0001).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  PRINTO PIC  X(0004).
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  FSTHD2O PIC  X(0023).
  2091*    -------------------------------
  2092     05  FILLER            PIC  X(0003).
  2093     05  NFSTPMTO PIC  99B99B99.
  2094*    -------------------------------
  2095     05  FILLER            PIC  X(0003).
  2096     05  NFSTAMTO PIC  ZZ,ZZZ.99-.
  2097*    -------------------------------
  2098     05  FILLER            PIC  X(0003).
  2099     05  LSTHD2O PIC  X(0023).
  2100*    -------------------------------
  2101     05  FILLER            PIC  X(0003).
  2102     05  NLSTPMTO PIC  99B99B99.
  2103*    -------------------------------
  2104     05  FILLER            PIC  X(0003).
  2105     05  NEFFDTEO PIC  99B99B99.
  2106*    -------------------------------
  2107     05  FILLER            PIC  X(0003).
  2108     05  NMONTHSO PIC  X(0002).
  2109*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  43
* EL154.cbl
  2110     05  FILLER            PIC  X(0003).
  2111     05  NDAYSFO PIC  X(0003).
  2112*    -------------------------------
  2113     05  FILLER            PIC  X(0003).
  2114     05  NPAYEEO PIC  X(0002).
  2115*    -------------------------------
  2116     05  FILLER            PIC  X(0003).
  2117     05  NREGAMTO PIC  ZZ,ZZZ.99-.
  2118*    -------------------------------
  2119     05  FILLER            PIC  X(0003).
  2120     05  NLASTO PIC  X(0001).
  2121*    -------------------------------
  2122     05  FILLER            PIC  X(0003).
  2123     05  NINDCTRO PIC  X(0001).
  2124*    -------------------------------
  2125     05  FILLER            PIC  X(0003).
  2126     05  DAYPAYO PIC  X(0002).
  2127*    -------------------------------
  2128     05  FILLER            PIC  X(0003).
  2129     05  NPRINTO PIC  X(0004).
  2130*    -------------------------------
  2131     05  FILLER            PIC  X(0003).
  2132     05  LETTDTEO PIC  99B99B99.
  2133*    -------------------------------
  2134     05  FILLER            PIC  X(0003).
  2135     05  ENDLETTO PIC  X(0004).
  2136*    -------------------------------
  2137     05  FILLER            PIC  X(0003).
  2138     05  ERRMSG1O PIC  X(0079).
  2139*    -------------------------------
  2140     05  FILLER            PIC  X(0003).
  2141     05  ERRMSG2O PIC  X(0079).
  2142*    -------------------------------
  2143     05  FILLER            PIC  X(0003).
  2144     05  ENTERPFO PIC  X(0002).
  2145*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  44
* EL154.cbl
  2147****************************************************************
  2148*
  2149* Copyright (c) 2007 by Clerity Solutions, Inc.
  2150* All rights reserved.
  2151*
  2152****************************************************************
  2153 01  DFHEIV.
  2154   02  DFHEIV0               PIC X(35).
  2155   02  DFHEIV1               PIC X(08).
  2156   02  DFHEIV2               PIC X(08).
  2157   02  DFHEIV3               PIC X(08).
  2158   02  DFHEIV4               PIC X(06).
  2159   02  DFHEIV5               PIC X(04).
  2160   02  DFHEIV6               PIC X(04).
  2161   02  DFHEIV7               PIC X(02).
  2162   02  DFHEIV8               PIC X(02).
  2163   02  DFHEIV9               PIC X(01).
  2164   02  DFHEIV10              PIC S9(7) COMP-3.
  2165   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2166   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2167   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2168   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2169   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2170   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2171   02  DFHEIV17              PIC X(04).
  2172   02  DFHEIV18              PIC X(04).
  2173   02  DFHEIV19              PIC X(04).
  2174   02  DFHEIV20              USAGE IS POINTER.
  2175   02  DFHEIV21              USAGE IS POINTER.
  2176   02  DFHEIV22              USAGE IS POINTER.
  2177   02  DFHEIV23              USAGE IS POINTER.
  2178   02  DFHEIV24              USAGE IS POINTER.
  2179   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2180   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2181   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2182   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2183   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2184   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2185   02  FILLER                PIC X(02).
  2186   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2187   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2188   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2189   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2190   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2191 LINKAGE  SECTION.
  2192*****************************************************************
  2193*                                                               *
  2194* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2195* All rights reserved.                                          *
  2196*                                                               *
  2197*****************************************************************
  2198 01  dfheiblk.
  2199     02  eibtime          pic s9(7) comp-3.
  2200     02  eibdate          pic s9(7) comp-3.
  2201     02  eibtrnid         pic x(4).
  2202     02  eibtaskn         pic s9(7) comp-3.
  2203     02  eibtrmid         pic x(4).
  2204     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  45
* EL154.cbl
  2205     02  eibcposn         pic s9(4) comp.
  2206     02  eibcalen         pic s9(4) comp.
  2207     02  eibaid           pic x(1).
  2208     02  eibfiller1       pic x(1).
  2209     02  eibfn            pic x(2).
  2210     02  eibfiller2       pic x(2).
  2211     02  eibrcode         pic x(6).
  2212     02  eibfiller3       pic x(2).
  2213     02  eibds            pic x(8).
  2214     02  eibreqid         pic x(8).
  2215     02  eibrsrce         pic x(8).
  2216     02  eibsync          pic x(1).
  2217     02  eibfree          pic x(1).
  2218     02  eibrecv          pic x(1).
  2219     02  eibsend          pic x(1).
  2220     02  eibatt           pic x(1).
  2221     02  eibeoc           pic x(1).
  2222     02  eibfmh           pic x(1).
  2223     02  eibcompl         pic x(1).
  2224     02  eibsig           pic x(1).
  2225     02  eibconf          pic x(1).
  2226     02  eiberr           pic x(1).
  2227     02  eibrldbk         pic x(1).
  2228     02  eiberrcd         pic x(4).
  2229     02  eibsynrb         pic x(1).
  2230     02  eibnodat         pic x(1).
  2231     02  eibfiller5       pic x(2).
  2232     02  eibresp          pic 9(09) comp.
  2233     02  eibresp2         pic 9(09) comp.
  2234     02  dfheigdj         pic s9(4) comp.
  2235     02  dfheigdk         pic s9(4) comp.
  2236 01  DFHCOMMAREA             PIC X(1024).
  2237
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  46
* EL154.cbl
  2239*                            COPY ELCCNTL.
  2240******************************************************************
  2241*                                                                *
  2242*                                                                *
  2243*                            ELCCNTL.                            *
  2244*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2245*                            VMOD=2.059                          *
  2246*                                                                *
  2247*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2248*                                                                *
  2249*   FILE TYPE = VSAM,KSDS                                        *
  2250*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2251*                                                                *
  2252*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2253*       ALTERNATE INDEX = NONE                                   *
  2254*                                                                *
  2255*   LOG = YES                                                    *
  2256*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2257******************************************************************
  2258*                   C H A N G E   L O G
  2259*
  2260* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2261*-----------------------------------------------------------------
  2262*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2263* EFFECTIVE    NUMBER
  2264*-----------------------------------------------------------------
  2265* 082503                   PEMA  ADD BENEFIT GROUP
  2266* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2267* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2268* 092705    2005050300006  PEMA  ADD SPP LEASES
  2269* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2270* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2271* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2272* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2273* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2274* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2275* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2276* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2277* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2278* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2279******************************************************************
  2280*
  2281 01  CONTROL-FILE.
  2282     12  CF-RECORD-ID                       PIC XX.
  2283         88  VALID-CF-ID                        VALUE 'CF'.
  2284
  2285     12  CF-CONTROL-PRIMARY.
  2286         16  CF-COMPANY-ID                  PIC XXX.
  2287         16  CF-RECORD-TYPE                 PIC X.
  2288             88  CF-COMPANY-MASTER              VALUE '1'.
  2289             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2290             88  CF-STATE-MASTER                VALUE '3'.
  2291             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2292             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2293             88  CF-CARRIER-MASTER              VALUE '6'.
  2294             88  CF-MORTALITY-MASTER            VALUE '7'.
  2295             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2296             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  47
* EL154.cbl
  2297             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2298             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2299             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2300             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2301             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2302             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2303             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2304             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2305             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2306         16  CF-ACCESS-CD-GENL              PIC X(4).
  2307         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2308             20  CF-PROCESSOR               PIC X(4).
  2309         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2310             20  CF-STATE-CODE              PIC XX.
  2311             20  FILLER                     PIC XX.
  2312         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2313             20  FILLER                     PIC XX.
  2314             20  CF-HI-BEN-IN-REC           PIC XX.
  2315         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2316             20  FILLER                     PIC XXX.
  2317             20  CF-CARRIER-CNTL            PIC X.
  2318         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2319             20  FILLER                     PIC XX.
  2320             20  CF-HI-TYPE-IN-REC          PIC 99.
  2321         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2322             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2323                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2324             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2325             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2326         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2327             20  FILLER                     PIC X.
  2328             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2329         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2330             20  FILLER                     PIC XX.
  2331             20  CF-MORTGAGE-PLAN           PIC XX.
  2332         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2333
  2334     12  CF-LAST-MAINT-DT                   PIC XX.
  2335     12  CF-LAST-MAINT-BY                   PIC X(4).
  2336     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2337
  2338     12  CF-RECORD-BODY                     PIC X(728).
  2339
  2340
  2341****************************************************************
  2342*             COMPANY MASTER RECORD                            *
  2343****************************************************************
  2344
  2345     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2346         16  CF-COMPANY-ADDRESS.
  2347             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2348             20  CF-CL-IN-CARE-OF           PIC X(30).
  2349             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2350             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2351             20  CF-CL-CITY-STATE           PIC X(30).
  2352             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2353             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2354         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  48
* EL154.cbl
  2355         16  CF-COMPANY-PASSWORD            PIC X(8).
  2356         16  CF-SECURITY-OPTION             PIC X.
  2357             88  ALL-SECURITY                   VALUE '1'.
  2358             88  COMPANY-VERIFY                 VALUE '2'.
  2359             88  PROCESSOR-VERIFY               VALUE '3'.
  2360             88  NO-SECURITY                    VALUE '4'.
  2361             88  ALL-BUT-TERM                   VALUE '5'.
  2362         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2363             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2364         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2365             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2366         16  CF-INFORCE-LOCATION            PIC X.
  2367             88  CERTS-ARE-ONLINE               VALUE '1'.
  2368             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2369             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2370         16  CF-LOWER-CASE-LETTERS          PIC X.
  2371         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2372             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2373             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2374             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2375             88  CF-ACCNT-CNTL                  VALUE '3'.
  2376             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2377
  2378         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2379         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2380
  2381         16  CF-LGX-CREDIT-USER             PIC X.
  2382             88  CO-IS-NOT-USER                 VALUE 'N'.
  2383             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2384
  2385         16 CF-CREDIT-CALC-CODES.
  2386             20  CF-CR-REM-TERM-CALC PIC X.
  2387               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2388               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2389               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2390               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2391               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2392               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2393               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2394             20  CF-CR-R78-METHOD           PIC X.
  2395               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2396               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2397
  2398         16  CF-CLAIM-CONTROL-COUNTS.
  2399             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2400                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2401
  2402             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2403                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2404
  2405             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2406                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2407
  2408             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2409                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2410
  2411         16  CF-CURRENT-MONTH-END           PIC XX.
  2412
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  49
* EL154.cbl
  2413         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2414             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2415             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2416             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2417             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2418                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2419                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2420             20  CF-CO-PREM-REJECT-SW       PIC X.
  2421                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2422                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2423             20  CF-CO-REF-REJECT-SW        PIC X.
  2424                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2425                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2426
  2427         16  CF-CO-REPORTING-DT             PIC XX.
  2428         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2429         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2430           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2431           88  CF-CO-MONTH-END                  VALUE '1'.
  2432
  2433         16  CF-LGX-CLAIM-USER              PIC X.
  2434             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2435             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2436
  2437         16  CF-CREDIT-EDIT-CONTROLS.
  2438             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2439             20  CF-MIN-AGE                 PIC 99.
  2440             20  CF-DEFAULT-AGE             PIC 99.
  2441             20  CF-MIN-TERM                PIC S999      COMP-3.
  2442             20  CF-MAX-TERM                PIC S999      COMP-3.
  2443             20  CF-DEFAULT-SEX             PIC X.
  2444             20  CF-JOINT-AGE-INPUT         PIC X.
  2445                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2446             20  CF-BIRTH-DATE-INPUT        PIC X.
  2447                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2448             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2449                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2450                 88  CF-ZERO-CARRIER            VALUE '1'.
  2451                 88  CF-ZERO-GROUPING           VALUE '2'.
  2452                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2453             20  CF-EDIT-SW                 PIC X.
  2454                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2455             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2456             20  CF-CR-PR-METHOD            PIC X.
  2457               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2458               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2459             20  FILLER                     PIC X.
  2460
  2461         16  CF-CREDIT-MISC-CONTROLS.
  2462             20  CF-REIN-TABLE-SW           PIC X.
  2463                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2464             20  CF-COMP-TABLE-SW           PIC X.
  2465                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2466             20  CF-EXPERIENCE-RETENTION-AGE
  2467                                            PIC S9        COMP-3.
  2468             20  CF-CONVERSION-DT           PIC XX.
  2469             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2470             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  50
* EL154.cbl
  2471                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2472                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2473
  2474             20  CF-CR-CHECK-NO-CONTROL.
  2475                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2476                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2477                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2478                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2479                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2480                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2481
  2482                 24  CF-CR-CHECK-COUNT       REDEFINES
  2483                     CF-CR-CHECK-COUNTER      PIC X(4).
  2484
  2485                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2486                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2487
  2488                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2489                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2490                 24  CF-MAIL-PROCESSING       PIC X.
  2491                     88  MAIL-PROCESSING          VALUE 'Y'.
  2492
  2493         16  CF-MISC-SYSTEM-CONTROL.
  2494             20  CF-SYSTEM-C                 PIC X.
  2495                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2496             20  CF-SYSTEM-D                 PIC X.
  2497                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2498             20  CF-SOC-SEC-NO-SW            PIC X.
  2499                 88  SOC-SEC-NO-USED             VALUE '1'.
  2500             20  CF-MEMBER-NO-SW             PIC X.
  2501                 88  MEMBER-NO-USED              VALUE '1'.
  2502             20  CF-TAX-ID-NUMBER            PIC X(11).
  2503             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2504             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2505                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2506                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2507                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2508                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2509             20  CF-SYSTEM-E                 PIC X.
  2510                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2511
  2512         16  CF-LGX-LIFE-USER               PIC X.
  2513             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2514             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2515
  2516         16  CF-CR-MONTH-END-DT             PIC XX.
  2517
  2518         16  CF-FILE-MAINT-DATES.
  2519             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2520                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2521             20  CF-LAST-BATCH       REDEFINES
  2522                 CF-LAST-BATCH-NO               PIC X(4).
  2523             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2524             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2525             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2526             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2527             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2528             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  51
* EL154.cbl
  2529             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2530             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2531             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2532             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2533
  2534         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2535         16  FILLER                         PIC X.
  2536
  2537         16  CF-ALT-MORT-CODE               PIC X(4).
  2538         16  CF-MEMBER-CAPTION              PIC X(10).
  2539
  2540         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2541             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2542             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2543             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2544             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2545             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2546
  2547         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2548
  2549         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2550         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2551         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2552         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2553
  2554         16  CF-AH-OVERRIDE-L1              PIC X.
  2555         16  CF-AH-OVERRIDE-L2              PIC XX.
  2556         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2557         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2558
  2559         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2560         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2561
  2562         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2563         16  CF-AR-LAST-EL860-DT            PIC XX.
  2564         16  CF-MP-MONTH-END-DT             PIC XX.
  2565
  2566         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2567         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2568             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2569
  2570         16  CF-AR-MONTH-END-DT             PIC XX.
  2571
  2572         16  CF-CRDTCRD-USER                PIC X.
  2573             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2574             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2575
  2576         16  CF-CC-MONTH-END-DT             PIC XX.
  2577
  2578         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2579
  2580         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2581             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2582             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2583             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2584         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2585         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2586         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  52
* EL154.cbl
  2587         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2588             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2589             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2590         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2591         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2592         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2593             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2594         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2595
  2596         16  CF-CL-ZIP-CODE.
  2597             20  CF-CL-ZIP-PRIME.
  2598                 24  CF-CL-ZIP-1ST          PIC X.
  2599                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2600                 24  FILLER                 PIC X(4).
  2601             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2602         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2603             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2604             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2605             20  FILLER                     PIC XXX.
  2606
  2607         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2608         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2609         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2610         16  CF-CO-OPTION-START-DATE        PIC XX.
  2611         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2612           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2613                                                      '3' '4'.
  2614           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2615           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2616           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2617           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2618           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2619           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2620
  2621         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2622
  2623         16  CF-PAYMENT-APPROVAL-LEVELS.
  2624             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2625             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2626             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2627             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2628             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2629             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2630
  2631         16  CF-END-USER-REPORTING-USER     PIC X.
  2632             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2633             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2634
  2635         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2636             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2637             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2638
  2639         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2640
  2641         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2642         16  FILLER                         PIC X.
  2643
  2644         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  53
* EL154.cbl
  2645             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2646             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2647             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2648
  2649         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2650
  2651         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2652             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2653             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2654
  2655         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2656             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2657             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2658
  2659         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2660
  2661         16  CF-CO-ACH-ID-CODE              PIC  X.
  2662             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2663             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2664             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2665         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2666         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2667         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2668         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2669         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2670         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2671         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2672         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2673         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2674                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2675         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2676                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2677
  2678         16  CF-CO-OVER-SHORT.
  2679             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2680             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2681
  2682*         16  FILLER                         PIC X(102).
  2683         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2684             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2685             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2686
  2687         16  CF-AH-APPROVAL-DAYS.
  2688             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2689             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2690             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2691             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2692
  2693         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2694
  2695         16  CF-APPROV-LEV-5.
  2696             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2697             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2698             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2699
  2700         16  FILLER                         PIC X(68).
  2701****************************************************************
  2702*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  54
* EL154.cbl
  2703****************************************************************
  2704
  2705     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2706         16  CF-PROCESSOR-NAME              PIC X(30).
  2707         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2708         16  CF-PROCESSOR-TITLE             PIC X(26).
  2709         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2710                 88  MESSAGE-YES                VALUE 'Y'.
  2711                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2712
  2713*****************************************************
  2714****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2715****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2716****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2717****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2718*****************************************************
  2719
  2720         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2721             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2722             20  CF-APPLICATION-FORCE       PIC X.
  2723             20  CF-INDIVIDUAL-APP.
  2724                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2725                     28  CF-BROWSE-APP      PIC X.
  2726                     28  CF-UPDATE-APP      PIC X.
  2727
  2728         16  CF-CURRENT-TERM-ON             PIC X(4).
  2729         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2730             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2731             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2732             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2733             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2734             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2735             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2736             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2737         16  CF-PROCESSOR-CARRIER           PIC X.
  2738             88  NO-CARRIER-SECURITY            VALUE ' '.
  2739         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2740             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2741         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2742             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2743         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2744             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2745
  2746         16  CF-PROC-SYS-ACCESS-SW.
  2747             20  CF-PROC-CREDIT-CLAIMS-SW.
  2748                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2749                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2750                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2751                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2752             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2753                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2754                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2755             20  CF-PROC-LIFE-GNRLDGR-SW.
  2756                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2757                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2758                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2759                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2760             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  55
* EL154.cbl
  2761                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2762                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2763         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2764             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2765             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2766         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2767
  2768         16  CF-APPROVAL-LEVEL                  PIC X.
  2769             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2770             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2771             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2772             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2773             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2774
  2775         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2776
  2777         16  CF-LANGUAGE-TYPE                   PIC X.
  2778             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2779             88  CF-LANG-IS-FR                      VALUE 'F'.
  2780
  2781         16  CF-CSR-IND                         PIC X.
  2782         16  FILLER                             PIC X(239).
  2783
  2784****************************************************************
  2785*             PROCESSOR/REMINDERS RECORD                       *
  2786****************************************************************
  2787
  2788     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2789         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2790             20  CF-START-REMIND-DT         PIC XX.
  2791             20  CF-END-REMIND-DT           PIC XX.
  2792             20  CF-REMINDER-TEXT           PIC X(50).
  2793         16  FILLER                         PIC X(296).
  2794
  2795
  2796****************************************************************
  2797*             STATE MASTER RECORD                              *
  2798****************************************************************
  2799
  2800     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2801         16  CF-STATE-ABBREVIATION          PIC XX.
  2802         16  CF-STATE-NAME                  PIC X(25).
  2803         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2804         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2805             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2806             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2807             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2808             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2809                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2810                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2811             20  CF-ST-PREM-REJECT-SW       PIC X.
  2812                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2813                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2814             20  CF-ST-REF-REJECT-SW        PIC X.
  2815                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2816                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2817         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2818         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  56
* EL154.cbl
  2819         16  CF-ST-REFUND-RULES.
  2820             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2821             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2822             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2823         16  CF-ST-FST-PMT-EXTENSION.
  2824             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2825             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2826                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2827                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2828                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2829                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2830         16  CF-ST-STATE-CALL.
  2831             20  CF-ST-CALL-UNEARNED        PIC X.
  2832             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2833             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2834         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2835             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2836             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2837         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2838         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2839         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2840         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2841         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2842         16  FILLER                         PIC X.
  2843         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2844             20  CF-ST-BENEFIT-CD           PIC XX.
  2845             20  CF-ST-BENEFIT-KIND         PIC X.
  2846                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2847                 88  CF-ST-AH-KIND              VALUE 'A'.
  2848             20  CF-ST-REM-TERM-CALC        PIC X.
  2849                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2850                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2851                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2852                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2853                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2854                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2855                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2856                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2857
  2858             20  CF-ST-REFUND-CALC          PIC X.
  2859                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2860                 88  ST-REFD-BY-R78             VALUE '1'.
  2861                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2862                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2863                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2864                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2865                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2866                 88  ST-REFD-UTAH               VALUE '7'.
  2867                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2868                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2869                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2870
  2871             20  CF-ST-EARNING-CALC         PIC X.
  2872                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2873                 88  ST-EARN-BY-R78             VALUE '1'.
  2874                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2875                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2876                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  57
* EL154.cbl
  2877                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2878                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2879                 88  ST-EARN-MEAN               VALUE '8'.
  2880                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2881
  2882             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2883                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2884                 88  ST-OVRD-BY-R78             VALUE '1'.
  2885                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2886                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2887                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2888                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2889                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2890                 88  ST-OVRD-MEAN               VALUE '8'.
  2891                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2892             20  FILLER                     PIC X.
  2893
  2894         16  CF-ST-COMMISSION-CAPS.
  2895             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2896             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2897             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2898             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2899         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2900                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2901
  2902         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2903
  2904         16  CF-ST-STATUTORY-INTEREST.
  2905             20  CF-ST-STAT-DATE-FROM       PIC X.
  2906                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2907                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2908             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2909             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2910             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2911             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2912             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2913
  2914         16  CF-ST-OVER-SHORT.
  2915             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2916             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2917
  2918         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2919
  2920         16  CF-ST-RT-CALC                  PIC X.
  2921
  2922         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2923         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2924         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2925         16  CF-ST-RF-LR-CALC               PIC X.
  2926         16  CF-ST-RF-LL-CALC               PIC X.
  2927         16  CF-ST-RF-LN-CALC               PIC X.
  2928         16  CF-ST-RF-AH-CALC               PIC X.
  2929         16  CF-ST-RF-CP-CALC               PIC X.
  2930*        16  FILLER                         PIC X(206).
  2931*CIDMOD         16  FILLER                         PIC X(192).
  2932         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2933             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2934         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  58
* EL154.cbl
  2935         16  CF-ST-VFY-2ND-BENE             PIC X.
  2936         16  CF-ST-CAUSAL-STATE             PIC X.
  2937         16  FILLER                         PIC X(185).
  2938
  2939****************************************************************
  2940*             BENEFIT MASTER RECORD                            *
  2941****************************************************************
  2942
  2943     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2944         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2945             20  CF-BENEFIT-CODE            PIC XX.
  2946             20  CF-BENEFIT-NUMERIC  REDEFINES
  2947                 CF-BENEFIT-CODE            PIC XX.
  2948             20  CF-BENEFIT-ALPHA           PIC XXX.
  2949             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2950             20  CF-BENEFIT-COMMENT         PIC X(10).
  2951
  2952             20  CF-LF-COVERAGE-TYPE        PIC X.
  2953                 88  CF-REDUCING                VALUE 'R'.
  2954                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2955
  2956             20  CF-SPECIAL-CALC-CD         PIC X.
  2957                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2958                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2959                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2960                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2961                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2962                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2963                 88  CF-FARM-PLAN               VALUE 'F'.
  2964                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2965                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2966                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2967                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2968                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2969                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2970                 88  CF-PRUDENTIAL              VALUE 'P'.
  2971                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2972                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2973                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2974                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2975                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2976                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2977
  2978             20  CF-JOINT-INDICATOR         PIC X.
  2979                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2980
  2981*            20  FILLER                     PIC X(12).
  2982             20  cf-maximum-benefits        pic s999 comp-3.
  2983             20  FILLER                     PIC X(09).
  2984             20  CF-BENEFIT-CATEGORY        PIC X.
  2985             20  CF-LOAN-TYPE               PIC X(8).
  2986
  2987             20  CF-CO-REM-TERM-CALC        PIC X.
  2988                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2989                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2990                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2991                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2992                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  59
* EL154.cbl
  2993
  2994             20  CF-CO-EARNINGS-CALC        PIC X.
  2995                 88  CO-EARN-BY-R78             VALUE '1'.
  2996                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2997                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2998                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2999                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3000                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3001                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3002                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3003
  3004             20  CF-CO-REFUND-CALC          PIC X.
  3005                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3006                 88  CO-REFD-BY-R78             VALUE '1'.
  3007                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3008                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3009                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3010                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3011                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3012                 88  CO-REFD-MEAN               VALUE '8'.
  3013                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3014                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3015                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3016
  3017             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3018                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3019                 88  CO-OVRD-BY-R78             VALUE '1'.
  3020                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3021                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3022                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3023                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3024                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3025                 88  CO-OVRD-MEAN               VALUE '8'.
  3026                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3027
  3028             20  CF-CO-BEN-I-G-CD           PIC X.
  3029                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3030                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3031                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3032
  3033         16  FILLER                         PIC X(304).
  3034
  3035
  3036****************************************************************
  3037*             CARRIER MASTER RECORD                            *
  3038****************************************************************
  3039
  3040     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3041         16  CF-ADDRESS-DATA.
  3042             20  CF-MAIL-TO-NAME            PIC X(30).
  3043             20  CF-IN-CARE-OF              PIC X(30).
  3044             20  CF-ADDRESS-LINE-1          PIC X(30).
  3045             20  CF-ADDRESS-LINE-2          PIC X(30).
  3046             20  CF-CITY-STATE              PIC X(30).
  3047             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3048             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3049
  3050         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  60
* EL154.cbl
  3051             20  CF-CLAIM-NO-METHOD         PIC X.
  3052                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3053                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3054                 88  CLAIM-NO-SEQ               VALUE '3'.
  3055                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3056             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3057                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3058                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3059                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3060
  3061         16  CF-CHECK-NO-CONTROL.
  3062             20  CF-CHECK-NO-METHOD         PIC X.
  3063                 88  CHECK-NO-MANUAL            VALUE '1'.
  3064                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3065                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3066                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3067             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3068                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3069
  3070         16  CF-DOMICILE-STATE              PIC XX.
  3071
  3072         16  CF-EXPENSE-CONTROLS.
  3073             20  CF-EXPENSE-METHOD          PIC X.
  3074                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3075                 88  DOLLARS-PER-PMT            VALUE '2'.
  3076                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3077                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3078             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3079             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3080
  3081         16  CF-CORRESPONDENCE-CONTROL.
  3082             20  CF-LETTER-RESEND-OPT       PIC X.
  3083                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3084                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3085             20  FILLER                     PIC X(4).
  3086
  3087         16  CF-RESERVE-CONTROLS.
  3088             20  CF-MANUAL-SW               PIC X.
  3089                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3090             20  CF-FUTURE-SW               PIC X.
  3091                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3092             20  CF-PTC-SW                  PIC X.
  3093                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3094             20  CF-IBNR-SW                 PIC X.
  3095                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3096             20  CF-PTC-LF-SW               PIC X.
  3097                 88  CF-LF-PTC-USED             VALUE '1'.
  3098             20  CF-CDT-ACCESS-METHOD       PIC X.
  3099                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3100                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3101                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3102             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3103
  3104         16  CF-CLAIM-CALC-METHOD           PIC X.
  3105             88  360-PLUS-MONTHS                VALUE '1'.
  3106             88  365-PLUS-MONTHS                VALUE '2'.
  3107             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3108             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  61
* EL154.cbl
  3109             88  365-DAILY                      VALUE '5'.
  3110
  3111         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3112         16  FILLER                         PIC X(11).
  3113
  3114         16  CF-LIMIT-AMOUNTS.
  3115             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3116             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3117             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3118             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3119             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3120             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3121             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3122             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3123             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3124             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3125
  3126         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3127         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3128         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3129
  3130         16  CF-ZIP-CODE.
  3131             20  CF-ZIP-PRIME.
  3132                 24  CF-ZIP-1ST             PIC X.
  3133                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3134                 24  FILLER                 PIC X(4).
  3135             20  CF-ZIP-PLUS4               PIC X(4).
  3136         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3137             20  CF-CAN-POSTAL-1            PIC XXX.
  3138             20  CF-CAN-POSTAL-2            PIC XXX.
  3139             20  FILLER                     PIC XXX.
  3140
  3141         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3142         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3143         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3144
  3145         16  CF-RATING-SWITCH               PIC X.
  3146             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3147             88  CF-NO-RATING                   VALUE 'N'.
  3148
  3149         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3150
  3151         16  CF-CARRIER-OVER-SHORT.
  3152             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3153             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3154
  3155         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3156         16  CF-SECPAY-SWITCH               PIC X.
  3157             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3158             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3159         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3160         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3161         16  FILLER                         PIC X(444).
  3162*        16  FILLER                         PIC X(452).
  3163
  3164
  3165****************************************************************
  3166*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  62
* EL154.cbl
  3167****************************************************************
  3168
  3169     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3170         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3171                                INDEXED BY CF-MORT-NDX.
  3172             20  CF-MORT-TABLE              PIC X(5).
  3173             20  CF-MORT-TABLE-TYPE         PIC X.
  3174                 88  CF-MORT-JOINT              VALUE 'J'.
  3175                 88  CF-MORT-SINGLE             VALUE 'S'.
  3176                 88  CF-MORT-COMBINED           VALUE 'C'.
  3177                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3178                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3179             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3180             20  CF-MORT-AGE-METHOD         PIC XX.
  3181                 88  CF-AGE-LAST                VALUE 'AL'.
  3182                 88  CF-AGE-NEAR                VALUE 'AN'.
  3183             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3184             20  CF-MORT-ADJUSTMENT-DIRECTION
  3185                                            PIC X.
  3186                 88  CF-MINUS                   VALUE '-'.
  3187                 88  CF-PLUS                    VALUE '+'.
  3188             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3189             20  CF-MORT-JOINT-CODE         PIC X.
  3190                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3191             20  CF-MORT-PC-Q               PIC X.
  3192                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3193             20  CF-MORT-TABLE-CODE         PIC X(4).
  3194             20  CF-MORT-COMMENTS           PIC X(15).
  3195             20  FILLER                     PIC X(14).
  3196
  3197         16  FILLER                         PIC X(251).
  3198
  3199
  3200****************************************************************
  3201*             BUSSINESS TYPE MASTER RECORD                     *
  3202****************************************************************
  3203
  3204     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3205* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3206* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3207* AND RECORD 05 IS TYPES 81-99
  3208         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3209             20  CF-BUSINESS-TITLE          PIC  X(19).
  3210             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3211                                            PIC S9V9(4) COMP-3.
  3212             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3213             20  FILLER                     PIC  X.
  3214         16  FILLER                         PIC  X(248).
  3215
  3216
  3217****************************************************************
  3218*             TERMINAL MASTER RECORD                           *
  3219****************************************************************
  3220
  3221     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3222
  3223         16  CF-COMPANY-TERMINALS.
  3224             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  63
* EL154.cbl
  3225                                  PIC X(4).
  3226         16  FILLER               PIC X(248).
  3227
  3228
  3229****************************************************************
  3230*             LIFE EDIT MASTER RECORD                          *
  3231****************************************************************
  3232
  3233     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3234         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3235             20  CF-LIFE-CODE-IN            PIC XX.
  3236             20  CF-LIFE-CODE-OUT           PIC XX.
  3237         16  FILLER                         PIC X(248).
  3238
  3239
  3240****************************************************************
  3241*             AH EDIT MASTER RECORD                            *
  3242****************************************************************
  3243
  3244     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3245         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3246             20  CF-AH-CODE-IN              PIC XXX.
  3247             20  CF-AH-CODE-OUT             PIC XX.
  3248         16  FILLER                         PIC X(248).
  3249
  3250
  3251****************************************************************
  3252*             CREDIBILITY TABLES                               *
  3253****************************************************************
  3254
  3255     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3256         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3257                             INDEXED BY CF-CRDB-NDX.
  3258             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3259             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3260             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3261         16  FILLER                         PIC  X(332).
  3262
  3263
  3264****************************************************************
  3265*             REPORT CUSTOMIZATION RECORD                      *
  3266****************************************************************
  3267
  3268     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3269         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3270             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3271             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3272             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3273**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3274****       A T-TRANSFER.                                   ****
  3275             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3276
  3277         16  FILLER                         PIC XX.
  3278
  3279         16  CF-CARRIER-CNTL-OPT.
  3280             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3281                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3282                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  64
* EL154.cbl
  3283             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3284                                            PIC X.
  3285         16  CF-GROUP-CNTL-OPT.
  3286             20  CF-GROUP-OPT-SEQ           PIC 9.
  3287                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3288                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3289             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3290                                            PIC X(6).
  3291         16  CF-STATE-CNTL-OPT.
  3292             20  CF-STATE-OPT-SEQ           PIC 9.
  3293                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3294                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3295             20  CF-STATE-SELECT OCCURS 3 TIMES
  3296                                            PIC XX.
  3297         16  CF-ACCOUNT-CNTL-OPT.
  3298             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3299                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3300                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3301             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3302                                            PIC X(10).
  3303         16  CF-BUS-TYP-CNTL-OPT.
  3304             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3305                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3306                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3307             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3308                                            PIC XX.
  3309         16  CF-LF-TYP-CNTL-OPT.
  3310             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3311                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3312                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3313             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3314                                            PIC XX.
  3315         16  CF-AH-TYP-CNTL-OPT.
  3316             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3317                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3318                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3319             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3320                                            PIC XX.
  3321         16  CF-REPTCD1-CNTL-OPT.
  3322             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3323                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3324                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3325             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3326                                            PIC X(10).
  3327         16  CF-REPTCD2-CNTL-OPT.
  3328             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3329                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3330                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3331             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3332                                            PIC X(10).
  3333         16  CF-USER1-CNTL-OPT.
  3334             20  CF-USER1-OPT-SEQ           PIC 9.
  3335                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3336                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3337             20  CF-USER1-SELECT OCCURS 3 TIMES
  3338                                            PIC X(10).
  3339         16  CF-USER2-CNTL-OPT.
  3340             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  65
* EL154.cbl
  3341                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3342                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3343             20  CF-USER2-SELECT OCCURS 3 TIMES
  3344                                            PIC X(10).
  3345         16  CF-USER3-CNTL-OPT.
  3346             20  CF-USER3-OPT-SEQ           PIC 9.
  3347                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3348                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3349             20  CF-USER3-SELECT OCCURS 3 TIMES
  3350                                            PIC X(10).
  3351         16  CF-USER4-CNTL-OPT.
  3352             20  CF-USER4-OPT-SEQ           PIC 9.
  3353                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3354                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3355             20  CF-USER4-SELECT OCCURS 3 TIMES
  3356                                            PIC X(10).
  3357         16  CF-USER5-CNTL-OPT.
  3358             20  CF-USER5-OPT-SEQ           PIC 9.
  3359                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3360                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3361             20  CF-USER5-SELECT OCCURS 3 TIMES
  3362                                            PIC X(10).
  3363         16  CF-REINS-CNTL-OPT.
  3364             20  CF-REINS-OPT-SEQ           PIC 9.
  3365                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3366                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3367             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3368                 24  CF-REINS-PRIME         PIC XXX.
  3369                 24  CF-REINS-SUB           PIC XXX.
  3370
  3371         16  CF-AGENT-CNTL-OPT.
  3372             20  CF-AGENT-OPT-SEQ           PIC 9.
  3373                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3374                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3375             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3376                                            PIC X(10).
  3377
  3378         16  FILLER                         PIC X(43).
  3379
  3380         16  CF-LOSS-RATIO-SELECT.
  3381             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3382             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3383         16  CF-ENTRY-DATE-SELECT.
  3384             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3385             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3386         16  CF-EFFECTIVE-DATE-SELECT.
  3387             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3388             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3389
  3390         16  CF-EXCEPTION-LIST-IND          PIC X.
  3391             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3392
  3393         16  FILLER                         PIC X(318).
  3394
  3395****************************************************************
  3396*                  EXCEPTION REPORTING RECORD                  *
  3397****************************************************************
  3398
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  66
* EL154.cbl
  3399     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3400         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3401             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3402
  3403         16  CF-COMBINED-LIFE-AH-OPT.
  3404             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3405             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3406             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3407             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3408
  3409         16  CF-LIFE-OPT.
  3410             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3411             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3412             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3413             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3414             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3415             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3416             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3417             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3418             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3419             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3420
  3421         16  CF-AH-OPT.
  3422             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3423             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3424             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3425             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3426             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3427             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3428             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3429             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3430             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3431             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3432
  3433         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3434             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3435             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3436             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3437
  3438         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3439
  3440         16  FILLER                         PIC X(673).
  3441
  3442
  3443****************************************************************
  3444*             MORTGAGE SYSTEM PLAN RECORD                      *
  3445****************************************************************
  3446
  3447     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3448         16  CF-PLAN-TYPE                   PIC X.
  3449             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3450             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3451             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3452         16  CF-PLAN-ABBREV                 PIC XXX.
  3453         16  CF-PLAN-DESCRIPT               PIC X(10).
  3454         16  CF-PLAN-NOTES                  PIC X(20).
  3455         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3456         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  67
* EL154.cbl
  3457             20  CF-PLAN-TERM-DATA.
  3458                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3459                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3460             20  CF-PLAN-AGE-DATA.
  3461                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3462                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3463                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3464             20  CF-PLAN-BENEFIT-DATA.
  3465                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3466                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3467                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3468                                            PIC S9(7)V99  COMP-3.
  3469         16  CF-PLAN-POLICY-FORMS.
  3470             20  CF-POLICY-FORM             PIC X(12).
  3471             20  CF-MASTER-APPLICATION      PIC X(12).
  3472             20  CF-MASTER-POLICY           PIC X(12).
  3473         16  CF-PLAN-RATING.
  3474             20  CF-RATE-CODE               PIC X(5).
  3475             20  CF-SEX-RATING              PIC X.
  3476                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3477                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3478             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3479             20  CF-SUB-STD-TYPE            PIC X.
  3480                 88  CF-PCT-OF-PREM            VALUE '1'.
  3481                 88  CF-PCT-OF-BENE            VALUE '2'.
  3482         16  CF-PLAN-PREM-TOLERANCES.
  3483             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3484             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3485         16  CF-PLAN-PYMT-TOLERANCES.
  3486             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3487             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3488         16  CF-PLAN-MISC-DATA.
  3489             20  FILLER                     PIC X.
  3490             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3491             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3492         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3493         16  CF-PLAN-IND-GRP                PIC X.
  3494             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3495                                                     '1'.
  3496             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3497                                                     '2'.
  3498         16  CF-MIB-SEARCH-SW               PIC X.
  3499             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3500             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3501             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3502             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3503         16  CF-ALPHA-SEARCH-SW             PIC X.
  3504             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3505             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3506             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3507             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3508             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3509             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3510             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3511             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3512             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3513             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3514                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  68
* EL154.cbl
  3515                                                     'X' 'Y' 'Z'.
  3516         16  CF-EFF-DT-RULE-SW              PIC X.
  3517             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3518             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3519             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3520             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3521             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3522         16  FILLER                         PIC X(4).
  3523         16  CF-HEALTH-QUESTIONS            PIC X.
  3524             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3525         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3526         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3527         16  CF-PLAN-SNGL-JNT               PIC X.
  3528             88  CF-COMBINED-PLAN              VALUE 'C'.
  3529             88  CF-JNT-PLAN                   VALUE 'J'.
  3530             88  CF-SNGL-PLAN                  VALUE 'S'.
  3531         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3532         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3533         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3534         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3535         16  CF-RERATE-CNTL                 PIC  X.
  3536             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3537             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3538             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3539             88  CF-AUTO-RECALC                 VALUE '4'.
  3540         16  CF-BENEFIT-TYPE                PIC  X.
  3541             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3542             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3543         16  CF-POLICY-FEE                  PIC S999V99
  3544                                                    COMP-3.
  3545         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3546         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3547         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3548         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3549         16  FILLER                         PIC  X(32).
  3550         16  CF-TERMINATION-FORM            PIC  X(04).
  3551         16  FILLER                         PIC  X(08).
  3552         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3553                                                       COMP-3.
  3554         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3555         16  CF-ISSUE-LETTER                PIC  X(4).
  3556         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3557         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3558             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3559             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3560         16  CF-MP-REFUND-CALC              PIC X.
  3561             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3562             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3563             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3564             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3565             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3566             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3567             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3568             88  CF-MP-REFD-MEAN                VALUE '8'.
  3569         16  CF-ALT-RATE-CODE               PIC  X(5).
  3570
  3571
  3572         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  69
* EL154.cbl
  3573****************************************************************
  3574*             MORTGAGE COMPANY MASTER RECORD                   *
  3575****************************************************************
  3576
  3577     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3578         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3579         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3580             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3581             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3582             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3583             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3584             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3585
  3586         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3587         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3588         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3589         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3590         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3591
  3592         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3593             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3594         16  CF-MP-RECON-USE-IND            PIC X(1).
  3595             88  CF-MP-USE-RECON             VALUE 'Y'.
  3596         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3597             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3598         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3599             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3600             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3601         16  FILLER                         PIC X(1).
  3602         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3603             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3604         16  CF-MORTG-MIB-VERSION           PIC X.
  3605             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3606             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3607             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3608         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3609             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3610                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3611             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3612                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3613             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3614                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3615             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3616                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3617             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3618                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3619             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3620                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3621         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3622         16  FILLER                         PIC X(7).
  3623         16  CF-MORTG-DESTINATION-SYMBOL.
  3624             20  CF-MORTG-MIB-COMM          PIC X(5).
  3625             20  CF-MORTG-MIB-TERM          PIC X(5).
  3626         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3627             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3628         16  FILLER                         PIC X(03).
  3629         16  CF-MP-CHECK-NO-CONTROL.
  3630             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  70
* EL154.cbl
  3631                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3632                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3633                                                ' ' LOW-VALUES.
  3634                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3635                                               VALUE '3'.
  3636         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3637         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3638         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3639             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3640                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3641             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3642                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3643             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3644                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3645             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3646                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3647             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3648                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3649             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3650                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3651         16  CF-MORTG-BILLING-AREA.
  3652             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3653                                            PIC X.
  3654         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3655         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3656         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3657         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3658             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3659             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3660         16  FILLER                         PIC X.
  3661         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3662             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3663             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3664         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3665         16  FILLER                         PIC X(8).
  3666         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3667         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3668         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3669         16  CF-ACH-COMPANY-ID.
  3670             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3671                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3672                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3673                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3674             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3675         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3676             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3677         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3678             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3679             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3680         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3681         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3682         16  FILLER                         PIC X(536).
  3683
  3684****************************************************************
  3685*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3686****************************************************************
  3687
  3688     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  71
* EL154.cbl
  3689         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3690             20  CF-FEMALE-HEIGHT.
  3691                 24  CF-FEMALE-FT           PIC 99.
  3692                 24  CF-FEMALE-IN           PIC 99.
  3693             20  CF-FEMALE-MIN-WT           PIC 999.
  3694             20  CF-FEMALE-MAX-WT           PIC 999.
  3695         16  FILLER                         PIC X(428).
  3696
  3697     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3698         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3699             20  CF-MALE-HEIGHT.
  3700                 24  CF-MALE-FT             PIC 99.
  3701                 24  CF-MALE-IN             PIC 99.
  3702             20  CF-MALE-MIN-WT             PIC 999.
  3703             20  CF-MALE-MAX-WT             PIC 999.
  3704         16  FILLER                         PIC X(428).
  3705******************************************************************
  3706*             AUTOMATIC ACTIVITY RECORD                          *
  3707******************************************************************
  3708     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3709         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3710             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3711             20  CF-SYS-LETTER-ID           PIC X(04).
  3712             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3713             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3714             20  CF-SYS-RESET-SW            PIC X(01).
  3715             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3716             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3717
  3718         16  FILLER                         PIC X(50).
  3719
  3720         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3721             20  CF-USER-ACTIVE-SW          PIC X(01).
  3722             20  CF-USER-LETTER-ID          PIC X(04).
  3723             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3724             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3725             20  CF-USER-RESET-SW           PIC X(01).
  3726             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3727             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3728             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3729
  3730         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  72
* EL154.cbl
  3732*                            COPY ELCMSTR.
  3733******************************************************************
  3734*                                                                *
  3735*                            ELCMSTR.                            *
  3736*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3737*                            VMOD=2.012                          *
  3738*                                                                *
  3739*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3740*                                                                *
  3741*   FILE TYPE = VSAM,KSDS                                        *
  3742*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3743*                                                                *
  3744*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3745*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3746*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3747*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3748*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3749*                                                 RKP=75,LEN=21  *
  3750*                                                                *
  3751*   **** NOTE ****                                               *
  3752*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3753*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3754*                                                                *
  3755*   LOG = YES                                                    *
  3756*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3757******************************************************************
  3758*                   C H A N G E   L O G
  3759*
  3760* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3761*-----------------------------------------------------------------
  3762*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3763* EFFECTIVE    NUMBER
  3764*-----------------------------------------------------------------
  3765* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3766* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3767* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3768* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3769* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3770******************************************************************
  3771 01  CLAIM-MASTER.
  3772     12  CL-RECORD-ID                PIC XX.
  3773         88  VALID-CL-ID         VALUE 'CL'.
  3774
  3775     12  CL-CONTROL-PRIMARY.
  3776         16  CL-COMPANY-CD           PIC X.
  3777         16  CL-CARRIER              PIC X.
  3778         16  CL-CLAIM-NO             PIC X(7).
  3779         16  CL-CERT-NO.
  3780             20  CL-CERT-PRIME       PIC X(10).
  3781             20  CL-CERT-SFX         PIC X.
  3782
  3783     12  CL-CONTROL-BY-NAME.
  3784         16  CL-COMPANY-CD-A1        PIC X.
  3785         16  CL-INSURED-LAST-NAME    PIC X(15).
  3786         16  CL-INSURED-NAME.
  3787             20  CL-INSURED-1ST-NAME PIC X(12).
  3788             20  CL-INSURED-MID-INIT PIC X.
  3789
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  73
* EL154.cbl
  3790     12  CL-CONTROL-BY-SSN.
  3791         16  CL-COMPANY-CD-A2        PIC X.
  3792         16  CL-SOC-SEC-NO.
  3793             20  CL-SSN-STATE        PIC XX.
  3794             20  CL-SSN-ACCOUNT      PIC X(6).
  3795             20  CL-SSN-LN3          PIC X(3).
  3796
  3797     12  CL-CONTROL-BY-CERT-NO.
  3798         16  CL-COMPANY-CD-A4        PIC X.
  3799         16  CL-CERT-NO-A4.
  3800             20  CL-CERT-A4-PRIME    PIC X(10).
  3801             20  CL-CERT-A4-SFX      PIC X.
  3802
  3803     12  CL-CONTROL-BY-CCN.
  3804         16  CL-COMPANY-CD-A5        PIC X.
  3805         16  CL-CCN-A5.
  3806             20  CL-CCN.
  3807                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3808                 24  CL-CCN-PRIME-A5 PIC X(12).
  3809             20  CL-CCN-FILLER-A5    PIC X(4).
  3810
  3811     12  CL-INSURED-PROFILE-DATA.
  3812         16  CL-INSURED-BIRTH-DT     PIC XX.
  3813         16  CL-INSURED-SEX-CD       PIC X.
  3814             88  INSURED-IS-MALE        VALUE 'M'.
  3815             88  INSURED-IS-FEMALE      VALUE 'F'.
  3816             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3817         16  CL-INSURED-OCC-CD       PIC X(6).
  3818         16  FILLER                  PIC X(5).
  3819
  3820     12  CL-PROCESSING-INFO.
  3821         16  CL-PROCESSOR-ID         PIC X(4).
  3822         16  CL-CLAIM-STATUS         PIC X.
  3823             88  CLAIM-IS-OPEN          VALUE 'O'.
  3824             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3825         16  CL-CLAIM-TYPE           PIC X.
  3826*            88  AH-CLAIM               VALUE 'A'.
  3827*            88  LIFE-CLAIM             VALUE 'L'.
  3828*            88  PROPERTY-CLAIM         VALUE 'P'.
  3829*            88  IUI-CLAIM              VALUE 'I'.
  3830*            88  GAP-CLAIM              VALUE 'G'.
  3831*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3832         16  CL-CLAIM-PREM-TYPE      PIC X.
  3833             88  SINGLE-PREMIUM         VALUE '1'.
  3834             88  O-B-COVERAGE           VALUE '2'.
  3835             88  OPEN-END-COVERAGE      VALUE '3'.
  3836         16  CL-INCURRED-DT          PIC XX.
  3837         16  CL-REPORTED-DT          PIC XX.
  3838         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3839         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3840         16  CL-LAST-PMT-DT          PIC XX.
  3841         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3842         16  CL-PAID-THRU-DT         PIC XX.
  3843         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3844         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3845         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3846         16  CL-PMT-CALC-METHOD      PIC X.
  3847             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  74
* EL154.cbl
  3848             88  CL-365-DAY-YR          VALUE '2'.
  3849             88  CL-FULL-MONTHS         VALUE '3'.
  3850         16  CL-CAUSE-CD             PIC X(6).
  3851
  3852         16  CL-PRIME-CERT-NO.
  3853             20  CL-PRIME-CERT-PRIME PIC X(10).
  3854             20  CL-PRIME-CERT-SFX   PIC X.
  3855
  3856         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3857             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3858             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3859
  3860         16  CL-MICROFILM-NO         PIC X(10).
  3861         16  FILLER REDEFINES CL-MICROFILM-NO.
  3862             20  CL-BENEFIT-PERIOD   PIC 99.
  3863             20  FILLER              PIC X(8).
  3864         16  CL-PROG-FORM-TYPE       PIC X.
  3865         16  CL-LAST-ADD-ON-DT       PIC XX.
  3866
  3867         16  CL-LAST-REOPEN-DT       PIC XX.
  3868         16  CL-LAST-CLOSE-DT        PIC XX.
  3869         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3870             88  FINAL-PAID             VALUE '1'.
  3871             88  CLAIM-DENIED           VALUE '2'.
  3872             88  AUTO-CLOSE             VALUE '3'.
  3873             88  MANUAL-CLOSE           VALUE '4'.
  3874             88  BENEFITS-CHANGED       VALUE 'C'.
  3875             88  SETUP-ERRORS           VALUE 'E'.
  3876         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3877         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3878         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3879             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3880         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3881         16  FILLER                  PIC X.
  3882
  3883     12  CL-CERTIFICATE-DATA.
  3884         16  CL-CERT-ORIGIN          PIC X.
  3885             88  CERT-WAS-ONLINE        VALUE '1'.
  3886             88  CERT-WAS-CREATED       VALUE '2'.
  3887             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3888         16  CL-CERT-KEY-DATA.
  3889             20  CL-CERT-CARRIER     PIC X.
  3890             20  CL-CERT-GROUPING    PIC X(6).
  3891             20  CL-CERT-STATE       PIC XX.
  3892             20  CL-CERT-ACCOUNT.
  3893                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3894                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3895             20  CL-CERT-EFF-DT      PIC XX.
  3896
  3897     12  CL-STATUS-CONTROLS.
  3898         16  CL-PRIORITY-CD          PIC X.
  3899             88  CONFIDENTIAL-DATA      VALUE '8'.
  3900             88  HIGHEST-PRIORITY       VALUE '9'.
  3901         16  CL-SUPV-ATTN-CD         PIC X.
  3902             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3903             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3904         16  CL-PURGED-DT            PIC XX.
  3905         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  75
* EL154.cbl
  3906         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3907         16  CL-NEXT-RESEND-DT       PIC XX.
  3908         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3909         16  CL-CRITICAL-PERIOD      PIC 99.
  3910*        16  FILLER                  PIC XX.
  3911         16  CL-LAST-MAINT-DT        PIC XX.
  3912         16  CL-LAST-MAINT-USER      PIC X(4).
  3913         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3914         16  CL-LAST-MAINT-TYPE      PIC X.
  3915             88  CLAIM-SET-UP           VALUE ' '.
  3916             88  PAYMENT-MADE           VALUE '1'.
  3917             88  LETTER-SENT            VALUE '2'.
  3918             88  MASTER-WAS-ALTERED     VALUE '3'.
  3919             88  MASTER-WAS-RESTORED    VALUE '4'.
  3920             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3921             88  FILE-CONVERTED         VALUE '6'.
  3922             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3923             88  ERROR-CORRECTION       VALUE 'E'.
  3924         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3925         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3926         16  CL-BENEFICIARY          PIC X(10).
  3927         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3928         16  CL-DENIAL-TYPE          PIC X.
  3929             88  CL-TYPE-DENIAL          VALUE '1'.
  3930             88  CL-TYPE-RESCISSION      VALUE '2'.
  3931             88  CL-TYPE-REFORMATION     VALUE '3'.
  3932             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3933             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3934         16  filler                  pic x(5).
  3935*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3936*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3937*        16  CL-RTW-DT               PIC XX.
  3938
  3939     12  CL-TRAILER-CONTROLS.
  3940         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3941             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3942             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3943             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3944         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3945         16  FILLER                  PIC XX.
  3946         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3947         16  CL-ADDRESS-TRAILER-CNT.
  3948             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3949                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3950             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3951                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3952             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3953                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3954             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3955                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3956             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3957                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3958             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3959                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3960             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3961                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3962
  3963     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  76
* EL154.cbl
  3964         16  CL-CV-REFNO-PRIME       PIC X(18).
  3965         16  CL-CV-REFNO-SFX         PIC XX.
  3966
  3967     12  CL-FILE-LOCATION            PIC X(4).
  3968
  3969     12  CL-PROCESS-ERRORS.
  3970         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3971             88  NO-FATAL-ERRORS        VALUE ZERO.
  3972         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3973             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3974
  3975     12  CL-PRODUCT-CD               PIC X.
  3976
  3977     12  CL-CURRENT-KEY-DATA.
  3978         16  CL-CURRENT-CARRIER      PIC X.
  3979         16  CL-CURRENT-GROUPING     PIC X(6).
  3980         16  CL-CURRENT-STATE        PIC XX.
  3981         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3982
  3983     12  CL-ASSOCIATES               PIC X.
  3984         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3985         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3986         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3987         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3988
  3989     12  CL-ACTIVITY-CODE            PIC 99.
  3990     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3991     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3992
  3993     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3994     12  CL-LAG-REPORT-CODE          PIC 9.
  3995     12  CL-LOAN-TYPE                PIC XX.
  3996     12  CL-LEGAL-STATE              PIC XX.
  3997
  3998     12  CL-YESNOSW                  PIC X.
  3999     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4000         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4001         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4002         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4003     12  cl-insured-type             pic x.
  4004         88  cl-claim-on-primary         value 'P'.
  4005         88  cl-claim-on-co-borrower     value 'C'.
  4006     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  77
* EL154.cbl
  4008*                            COPY ELCTRLR.
  4009******************************************************************
  4010*                                                                *
  4011*                            ELCTRLR.                            *
  4012*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4013*                            VMOD=2.014                          *
  4014*                                                                *
  4015*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4016*                                                                *
  4017*   FILE TYPE = VSAM,KSDS                                        *
  4018*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4019*                                                                *
  4020*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4021*       ALTERNATE INDEX = NONE                                   *
  4022*                                                                *
  4023*   LOG = YES                                                    *
  4024*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4025******************************************************************
  4026*                   C H A N G E   L O G
  4027*
  4028* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4029*-----------------------------------------------------------------
  4030*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4031* EFFECTIVE    NUMBER
  4032*-----------------------------------------------------------------
  4033* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4034* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4035* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4036* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4037* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4038* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4039* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4040* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4041* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4042* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4043* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4044* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4045* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4046* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4047* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4048* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4049* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4050* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4051* 040814    2014030500002  AJRA  ADD ICD CODES
  4052* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4053******************************************************************
  4054 01  ACTIVITY-TRAILERS.
  4055     12  AT-RECORD-ID                    PIC XX.
  4056         88  VALID-AT-ID                       VALUE 'AT'.
  4057
  4058     12  AT-CONTROL-PRIMARY.
  4059         16  AT-COMPANY-CD               PIC X.
  4060         16  AT-CARRIER                  PIC X.
  4061         16  AT-CLAIM-NO                 PIC X(7).
  4062         16  AT-CERT-NO.
  4063             20  AT-CERT-PRIME           PIC X(10).
  4064             20  AT-CERT-SFX             PIC X.
  4065         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  78
* EL154.cbl
  4066             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4067             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4068             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4069             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4070             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4071             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4072             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4073             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4074             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4075             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4076             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4077             88  AT-BENEFICIARY-TRL           VALUE +91.
  4078             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4079             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4080             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4081             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4082
  4083     12  AT-TRAILER-TYPE                 PIC X.
  4084         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4085         88  PAYMENT-TR                       VALUE '2'.
  4086         88  AUTO-PAY-TR                      VALUE '3'.
  4087         88  CORRESPONDENCE-TR                VALUE '4'.
  4088         88  ADDRESS-TR                       VALUE '5'.
  4089         88  GENERAL-INFO-TR                  VALUE '6'.
  4090         88  AUTO-PROMPT-TR                   VALUE '7'.
  4091         88  DENIAL-TR                        VALUE '8'.
  4092         88  INCURRED-CHG-TR                  VALUE '9'.
  4093         88  FORM-CONTROL-TR                  VALUE 'A'.
  4094
  4095     12  AT-RECORDED-DT                  PIC XX.
  4096     12  AT-RECORDED-BY                  PIC X(4).
  4097     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4098
  4099     12  AT-TRAILER-BODY                 PIC X(165).
  4100
  4101     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4102         16  AT-RESERVE-CONTROLS.
  4103             20  AT-MANUAL-SW            PIC X.
  4104                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4105             20  AT-FUTURE-SW            PIC X.
  4106                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4107             20  AT-PTC-SW               PIC X.
  4108                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4109             20  AT-IBNR-SW              PIC X.
  4110                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4111             20  AT-PTC-LF-SW            PIC X.
  4112                 88  AT-LF-PTC-USED          VALUE '1'.
  4113             20  AT-CDT-ACCESS-METHOD    PIC X.
  4114                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4115                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4116                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4117             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4118         16  AT-LAST-COMPUTED-DT         PIC XX.
  4119         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4120         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4121         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4122         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4123         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  79
* EL154.cbl
  4124         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4125         16  AT-EXPENSE-CONTROLS.
  4126             20  AT-EXPENSE-METHOD       PIC X.
  4127                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4128                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4129                 88  PERCENT-OF-PMT           VALUE '3'.
  4130                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4131             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4132             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4133         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4134         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4135
  4136         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4137         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4138
  4139*        16  FILLER                      PIC X(53).
  4140         16  FILLER                      PIC X(47).
  4141
  4142         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4143         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4144
  4145         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4146             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4147             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4148*                    C = CLOSED
  4149*                    O = OPEN
  4150             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4151*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4152
  4153     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4154         16  AT-PAYMENT-TYPE             PIC X.
  4155             88  PARTIAL-PAYMENT                VALUE '1'.
  4156             88  FINAL-PAYMENT                  VALUE '2'.
  4157             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4158             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4159             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4160             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4161             88  VOIDED-PAYMENT                 VALUE '9'.
  4162             88  TRANSFER                       VALUE 'T'.
  4163             88  LIFE-INTEREST                  VALUE 'I'.
  4164
  4165         16  AT-CLAIM-TYPE               PIC X.
  4166             88  PAID-FOR-AH                    VALUE 'A'.
  4167             88  PAID-FOR-LIFE                  VALUE 'L'.
  4168             88  PAID-FOR-IUI                   VALUE 'I'.
  4169             88  PAID-FOR-GAP                   VALUE 'G'.
  4170             88  PAID-FOR-FAM                   VALUE 'F'.
  4171         16  AT-CLAIM-PREM-TYPE          PIC X.
  4172             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4173             88  AT-O-B-COVERAGE                VALUE '2'.
  4174             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4175         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4176         16  AT-CHECK-NO                 PIC X(7).
  4177         16  AT-PAID-FROM-DT             PIC XX.
  4178         16  AT-PAID-THRU-DT             PIC XX.
  4179         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4180         16  FILLER                      PIC X.
  4181         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  80
* EL154.cbl
  4182         16  AT-PAYMENT-ORIGIN           PIC X.
  4183             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4184             88  ONLINE-AUTO-PMT                VALUE '2'.
  4185             88  OFFLINE-PMT                    VALUE '3'.
  4186         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4187         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4188         16  AT-VOID-DATA.
  4189             20  AT-VOID-DT              PIC XX.
  4190*00144       20  AT-VOID-REASON          PIC X(30).
  4191             20  AT-VOID-REASON          PIC X(26).
  4192         16  AT-PMT-APPROVED-BY          PIC X(04).
  4193         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4194         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4195         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4196                                         PIC S99V9(5)  COMP-3.
  4197         16  AT-CREDIT-INTERFACE.
  4198             20  AT-PMT-SELECT-DT        PIC XX.
  4199                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4200             20  AT-PMT-ACCEPT-DT        PIC XX.
  4201                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4202             20  AT-VOID-SELECT-DT       PIC XX.
  4203                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4204             20  AT-VOID-ACCEPT-DT       PIC XX.
  4205                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4206
  4207         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4208                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4209                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4210         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4211
  4212         16  AT-FORCE-CONTROL            PIC X.
  4213             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4214         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4215         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4216         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4217         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4218         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4219         16  AT-BENEFIT-TYPE             PIC X.
  4220
  4221         16  AT-EXPENSE-TYPE             PIC X.
  4222         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4223
  4224         16  AT-PAYEE-TYPE-CD.
  4225             20  AT-PAYEE-TYPE           PIC X.
  4226                 88  INSURED-PAID           VALUE 'I'.
  4227                 88  BENEFICIARY-PAID       VALUE 'B'.
  4228                 88  ACCOUNT-PAID           VALUE 'A'.
  4229                 88  OTHER-1-PAID           VALUE 'O'.
  4230                 88  OTHER-2-PAID           VALUE 'Q'.
  4231                 88  DOCTOR-PAID            VALUE 'P'.
  4232                 88  EMPLOYER-PAID          VALUE 'E'.
  4233             20  AT-PAYEE-SEQ            PIC X.
  4234
  4235         16  AT-CASH-PAYMENT             PIC X.
  4236         16  AT-GROUPED-PAYMENT          PIC X.
  4237         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4238         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4239         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  81
* EL154.cbl
  4240         16  AT-VOID-TYPE                PIC X.
  4241             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4242             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4243         16  AT-AIG-UNEMP-IND            PIC X.
  4244             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4245         16  AT-ASSOCIATES               PIC X.
  4246             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4247             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4248
  4249         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4250         16  AT-CV-PMT-CODE              PIC X.
  4251             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4252             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4253             88  FULL-ADD-PAYMENT           VALUE '3'.
  4254             88  HALF-ADD-PAYMENT           VALUE '4'.
  4255             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4256             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4257             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4258             88  ADDL-PAYMENT               VALUE '8'.
  4259
  4260         16  AT-EOB-CODE1                PIC XXX.
  4261         16  AT-EOB-CODE2                PIC XXX.
  4262         16  AT-EOB-CODE3                PIC XXX.
  4263         16  FILLER REDEFINES AT-EOB-CODE3.
  4264             20  AT-PRINT-CLM-FORM       PIC X.
  4265             20  AT-PRINT-SURVEY         PIC X.
  4266             20  AT-SPECIAL-RELEASE      PIC X.
  4267         16  AT-EOB-CODE4                PIC XXX.
  4268         16  FILLER REDEFINES AT-EOB-CODE4.
  4269             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4270             20  FILLER                  PIC X.
  4271         16  AT-EOB-CODE5                PIC XXX.
  4272         16  FILLER REDEFINES AT-EOB-CODE5.
  4273             20  AT-PMT-PROOF-DT         PIC XX.
  4274             20  FILLER                  PIC X.
  4275
  4276         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4277             88  AT-PRINT-EOB            VALUE 'Y'.
  4278
  4279         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4280         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4281
  4282     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4283         16  AT-SCHEDULE-START-DT        PIC XX.
  4284         16  AT-SCHEDULE-END-DT          PIC XX.
  4285         16  AT-TERMINATED-DT            PIC XX.
  4286         16  AT-LAST-PMT-TYPE            PIC X.
  4287             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4288             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4289         16  AT-FIRST-PMT-DATA.
  4290             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4291             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4292             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4293         16  AT-REGULAR-PMT-DATA.
  4294             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4295             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4296             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4297         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  82
* EL154.cbl
  4298             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4299                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4300                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4301                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4302                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4303                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4304             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4305         16  AT-AUTO-PAY-DAY             PIC 99.
  4306         16  AT-AUTO-CASH                PIC X.
  4307             88  AT-CASH                      VALUE 'Y'.
  4308             88  AT-NON-CASH                  VALUE 'N'.
  4309*        16  FILLER                      PIC X(129).
  4310         16  AT-AUTO-END-LETTER          PIC X(4).
  4311         16  FILLER                      PIC X(125).
  4312
  4313         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4314         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4315
  4316     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4317         16  AT-LETTER-SENT-DT           PIC XX.
  4318         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4319         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4320         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4321         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4322         16  AT-LETTER-ORIGIN            PIC X.
  4323             88  ONLINE-CREATION              VALUE '1' '3'.
  4324             88  OFFLINE-CREATION             VALUE '2' '4'.
  4325             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4326             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4327         16  AT-STD-LETTER-FORM          PIC X(4).
  4328         16  AT-REASON-TEXT              PIC X(70).
  4329         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4330         16  AT-ADDRESEE-TYPE            PIC X.
  4331              88  INSURED-ADDRESEE            VALUE 'I'.
  4332              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4333              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4334              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4335              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4336              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4337              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4338         16  AT-ADDRESSEE-NAME           PIC X(30).
  4339         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4340         16  AT-RESEND-PRINT-DATE        PIC XX.
  4341         16  AT-CORR-SOL-UNSOL           PIC X.
  4342         16  AT-LETTER-PURGED-DT         PIC XX.
  4343*
  4344*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4345*
  4346         16  AT-CSO-REDEFINITION.
  4347             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4348             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4349             20  AT-LETTER-TO-BENE       PIC X(1).
  4350             20  AT-STOP-LETTER-DT       PIC X(2).
  4351             20  FILLER                  PIC X(19).
  4352*             20  FILLER                  PIC X(27).
  4353             20  AT-CSO-LETTER-STATUS    PIC X.
  4354                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4355                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  83
* EL154.cbl
  4356                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4357             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4358             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4359*
  4360*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4361*
  4362*        16  FILLER                      PIC X(26).
  4363*
  4364*        16  AT-DMD-BSR-CODE             PIC X.
  4365*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4366*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4367*
  4368*        16  AT-DMD-LETTER-STATUS        PIC X.
  4369*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4370*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4371*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4372*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4373*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4374
  4375         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4376         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4377
  4378     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4379         16  AT-ADDRESS-TYPE             PIC X.
  4380             88  INSURED-ADDRESS               VALUE 'I'.
  4381             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4382             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4383             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4384             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4385             88  OTHER-ADDRESS-1               VALUE 'O'.
  4386             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4387         16  AT-MAIL-TO-NAME             PIC X(30).
  4388         16  AT-ADDRESS-LINE-1           PIC X(30).
  4389         16  AT-ADDRESS-LINE-2           PIC X(30).
  4390         16  AT-CITY-STATE.
  4391             20  AT-CITY                 PIC X(28).
  4392             20  AT-STATE                PIC XX.
  4393         16  AT-ZIP.
  4394             20  AT-ZIP-CODE.
  4395                 24  AT-ZIP-1ST          PIC X.
  4396                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4397                 24  FILLER              PIC X(4).
  4398             20  AT-ZIP-PLUS4            PIC X(4).
  4399         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4400             20  AT-CAN-POSTAL-1         PIC XXX.
  4401             20  AT-CAN-POSTAL-2         PIC XXX.
  4402             20  FILLER                  PIC XXX.
  4403         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4404*         16  FILLER                      PIC X(23).
  4405         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4406         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4407         16  FILLER                      PIC X(13).
  4408         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4409         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4410
  4411     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4412         16  AT-INFO-LINE-1              PIC X(60).
  4413         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  84
* EL154.cbl
  4414             20  AT-NOTE-ERROR-NO OCCURS 15
  4415                                         PIC X(4).
  4416         16  AT-INFO-LINE-2              PIC X(60).
  4417         16  FILLER REDEFINES AT-INFO-LINE-2.
  4418             20  AT-ICD-CODE-1           PIC X(8).
  4419             20  AT-ICD-CODE-2           PIC X(8).
  4420             20  FILLER                  PIC X(44).
  4421         16  AT-INFO-TRAILER-TYPE        PIC X.
  4422             88  AT-ERRORS-NOTE          VALUE 'E'.
  4423             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4424             88  AT-CALL-NOTE            VALUE 'C'.
  4425             88  AT-MAINT-NOTE           VALUE 'M'.
  4426             88  AT-CERT-CHANGE          VALUE 'X'.
  4427             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4428             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4429             88  AT-CERT-CANCELLED       VALUE 'T'.
  4430         16  AT-CALL-TYPE                PIC X.
  4431             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4432             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4433         16  AT-NOTE-CONTINUATION        PIC X.
  4434             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4435         16  AT-EOB-CODES-EXIST          PIC X.
  4436             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4437         16  FILLER                      PIC X(35).
  4438         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4439         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4440
  4441     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4442         16  AT-PROMPT-LINE-1            PIC X(60).
  4443         16  AT-PROMPT-LINE-2            PIC X(60).
  4444         16  AT-PROMPT-START-DT          PIC XX.
  4445         16  AT-PROMPT-END-DT            PIC XX.
  4446         16  FILLER                      PIC X(35).
  4447         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4448         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4449
  4450     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4451         16  AT-DENIAL-INFO-1            PIC X(60).
  4452         16  AT-DENIAL-INFO-2            PIC X(60).
  4453         16  AT-DENIAL-DT                PIC XX.
  4454         16  AT-RETRACTION-DT            PIC XX.
  4455         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4456*         16  FILLER                      PIC X(31).
  4457         16  AT-DENIAL-PROOF-DT          PIC XX.
  4458         16  FILLER                      PIC X(29).
  4459         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4460         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4461
  4462     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4463         16  AT-OLD-INCURRED-DT          PIC XX.
  4464         16  AT-OLD-REPORTED-DT          PIC XX.
  4465         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4466         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4467         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4468         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4469         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4470         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4471         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  85
* EL154.cbl
  4472         16  AT-OLD-DIAG-CODE            PIC X(6).
  4473         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4474         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4475         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4476         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4477         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4478         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4479         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4480         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4481         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4482         16  FILLER                      PIC X(9).
  4483         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4484
  4485     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4486         16  AT-FORM-SEND-ON-DT          PIC XX.
  4487         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4488         16  AT-FORM-RE-SEND-DT          PIC XX.
  4489         16  AT-FORM-ANSWERED-DT         PIC XX.
  4490         16  AT-FORM-PRINTED-DT          PIC XX.
  4491         16  AT-FORM-REPRINT-DT          PIC XX.
  4492         16  AT-FORM-TYPE                PIC X.
  4493             88  INITIAL-FORM                  VALUE '1'.
  4494             88  PROGRESS-FORM                 VALUE '2'.
  4495         16  AT-INSTRUCT-LN-1            PIC X(28).
  4496         16  AT-INSTRUCT-LN-2            PIC X(28).
  4497         16  AT-INSTRUCT-LN-3            PIC X(28).
  4498         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4499         16  AT-FORM-ADDRESS             PIC X.
  4500             88  FORM-TO-INSURED              VALUE 'I'.
  4501             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4502             88  FORM-TO-OTHER-1              VALUE 'O'.
  4503             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4504         16  AT-RELATED-1.
  4505             20 AT-REL-CARR-1            PIC X.
  4506             20 AT-REL-CLAIM-1           PIC X(7).
  4507             20 AT-REL-CERT-1            PIC X(11).
  4508         16  AT-RELATED-2.
  4509             20 AT-REL-CARR-2            PIC X.
  4510             20 AT-REL-CLAIM-2           PIC X(7).
  4511             20 AT-REL-CERT-2            PIC X(11).
  4512         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4513         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4514         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4515         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4516         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4517         16  AT-STOP-FORM-DT             PIC X(2).
  4518
  4519         16  FILLER                      PIC X(09).
  4520         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4521         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4522******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  86
* EL154.cbl
  4524*                            COPY ELCCERT.
  4525******************************************************************
  4526*                                                                *
  4527*                            ELCCERT.                            *
  4528*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4529*                            VMOD=2.013                          *
  4530*                                                                *
  4531*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4532*                                                                *
  4533*   FILE TYPE = VSAM,KSDS                                        *
  4534*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4535*                                                                *
  4536*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4537*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4538*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4539*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4540*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4541*                                                                *
  4542*   LOG = YES                                                    *
  4543*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4544******************************************************************
  4545*                   C H A N G E   L O G
  4546*
  4547* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4548*-----------------------------------------------------------------
  4549*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4550* EFFECTIVE    NUMBER
  4551*-----------------------------------------------------------------
  4552* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4553* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4554* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4555* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4556* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4557* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4558* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4559* 032612  CR2011110200001  PEMA  AHL CHANGES
  4560* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4561******************************************************************
  4562
  4563 01  CERTIFICATE-MASTER.
  4564     12  CM-RECORD-ID                      PIC XX.
  4565         88  VALID-CM-ID                      VALUE 'CM'.
  4566
  4567     12  CM-CONTROL-PRIMARY.
  4568         16  CM-COMPANY-CD                 PIC X.
  4569         16  CM-CARRIER                    PIC X.
  4570         16  CM-GROUPING.
  4571             20  CM-GROUPING-PREFIX        PIC X(3).
  4572             20  CM-GROUPING-PRIME         PIC X(3).
  4573         16  CM-STATE                      PIC XX.
  4574         16  CM-ACCOUNT.
  4575             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4576             20  CM-ACCOUNT-PRIME          PIC X(6).
  4577         16  CM-CERT-EFF-DT                PIC XX.
  4578         16  CM-CERT-NO.
  4579             20  CM-CERT-PRIME             PIC X(10).
  4580             20  CM-CERT-SFX               PIC X.
  4581
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  87
* EL154.cbl
  4582     12  CM-CONTROL-BY-NAME.
  4583         16  CM-COMPANY-CD-A1              PIC X.
  4584         16  CM-INSURED-LAST-NAME          PIC X(15).
  4585         16  CM-INSURED-INITIALS.
  4586             20  CM-INSURED-INITIAL1       PIC X.
  4587             20  CM-INSURED-INITIAL2       PIC X.
  4588
  4589     12  CM-CONTROL-BY-SSN.
  4590         16  CM-COMPANY-CD-A2              PIC X.
  4591         16  CM-SOC-SEC-NO.
  4592             20  CM-SSN-STATE              PIC XX.
  4593             20  CM-SSN-ACCOUNT            PIC X(6).
  4594             20  CM-SSN-LN3.
  4595                 25  CM-INSURED-INITIALS-A2.
  4596                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4597                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4598                 25 CM-PART-LAST-NAME-A2         PIC X.
  4599
  4600     12  CM-CONTROL-BY-CERT-NO.
  4601         16  CM-COMPANY-CD-A4              PIC X.
  4602         16  CM-CERT-NO-A4                 PIC X(11).
  4603
  4604     12  CM-CONTROL-BY-MEMB.
  4605         16  CM-COMPANY-CD-A5              PIC X.
  4606         16  CM-MEMBER-NO.
  4607             20  CM-MEMB-STATE             PIC XX.
  4608             20  CM-MEMB-ACCOUNT           PIC X(6).
  4609             20  CM-MEMB-LN4.
  4610                 25  CM-INSURED-INITIALS-A5.
  4611                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4612                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4613                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4614
  4615     12  CM-INSURED-PROFILE-DATA.
  4616         16  CM-INSURED-FIRST-NAME.
  4617             20  CM-INSURED-1ST-INIT       PIC X.
  4618             20  FILLER                    PIC X(9).
  4619         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4620         16  CM-INSURED-SEX                PIC X.
  4621             88  CM-SEX-MALE                  VALUE 'M'.
  4622             88  CM-SEX-FEMAL                 VALUE 'F'.
  4623         16  CM-INSURED-JOINT-AGE          PIC 99.
  4624         16  CM-JOINT-INSURED-NAME.
  4625             20  CM-JT-LAST-NAME           PIC X(15).
  4626             20  CM-JT-FIRST-NAME.
  4627                 24  CM-JT-1ST-INIT        PIC X.
  4628                 24  FILLER                PIC X(9).
  4629             20  CM-JT-INITIAL             PIC X.
  4630
  4631     12  CM-LIFE-DATA.
  4632         16  CM-LF-BENEFIT-CD              PIC XX.
  4633         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4634         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4635         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4636         16  CM-LF-DEV-CODE                PIC XXX.
  4637         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4638         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4639         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  88
* EL154.cbl
  4640         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4641         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4642         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4643         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4644         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4645         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4646         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4647         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4648         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4649         16  cm-temp-epiq                  pic xx.
  4650             88  EPIQ-CLASS                  value 'EQ'.
  4651*        16  FILLER                        PIC XX.
  4652
  4653     12  CM-AH-DATA.
  4654         16  CM-AH-BENEFIT-CD              PIC XX.
  4655         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4656         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4657         16  CM-AH-DEV-CODE                PIC XXX.
  4658         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4659         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4660         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4661         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4662         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4663         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4664         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4665         16  CM-AH-PAID-THRU-DT            PIC XX.
  4666             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4667         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4668         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4669         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4670         16  FILLER                        PIC X.
  4671
  4672     12  CM-LOAN-INFORMATION.
  4673         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4674         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4675                                           PIC S9(5)V99  COMP-3.
  4676         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4677         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4678         16  CM-PAY-FREQUENCY              PIC S99.
  4679         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4680         16  CM-RATE-CLASS                 PIC XX.
  4681         16  CM-BENEFICIARY                PIC X(25).
  4682         16  CM-POLICY-FORM-NO             PIC X(12).
  4683         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4684         16  CM-LAST-ADD-ON-DT             PIC XX.
  4685         16  CM-DEDUCTIBLE-AMOUNTS.
  4686             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4687             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4688         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4689             20  CM-RESIDENT-STATE         PIC XX.
  4690             20  CM-RATE-CODE              PIC X(4).
  4691             20  FILLER                    PIC XX.
  4692         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4693             20  CM-LOAN-OFFICER           PIC X(5).
  4694             20  FILLER                    PIC XXX.
  4695         16  CM-CSR-CODE                   PIC XXX.
  4696         16  CM-UNDERWRITING-CODE          PIC X.
  4697             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  89
* EL154.cbl
  4698         16  CM-POST-CARD-IND              PIC X.
  4699         16  CM-NH-INTERFACE-SW            PIC X.
  4700         16  CM-PREMIUM-TYPE               PIC X.
  4701             88  CM-SING-PRM                  VALUE '1'.
  4702             88  CM-O-B-COVERAGE              VALUE '2'.
  4703             88  CM-OPEN-END                  VALUE '3'.
  4704         16  CM-IND-GRP-TYPE               PIC X.
  4705             88  CM-INDIVIDUAL                VALUE 'I'.
  4706             88  CM-GROUP                     VALUE 'G'.
  4707         16  CM-SKIP-CODE                  PIC X.
  4708             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4709             88  SKIP-JULY                    VALUE '1'.
  4710             88  SKIP-AUGUST                  VALUE '2'.
  4711             88  SKIP-SEPTEMBER               VALUE '3'.
  4712             88  SKIP-JULY-AUG                VALUE '4'.
  4713             88  SKIP-AUG-SEPT                VALUE '5'.
  4714             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4715             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4716             88  SKIP-JUNE                    VALUE '8'.
  4717             88  SKIP-JUNE-JULY               VALUE '9'.
  4718             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4719             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4720         16  CM-PAYMENT-MODE               PIC X.
  4721             88  PAY-MONTHLY                  VALUE SPACE.
  4722             88  PAY-WEEKLY                   VALUE '1'.
  4723             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4724             88  PAY-BI-WEEKLY                VALUE '3'.
  4725             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4726         16  CM-LOAN-NUMBER                PIC X(8).
  4727         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4728         16  CM-OLD-LOF                    PIC XXX.
  4729*        16  CM-LOAN-OFFICER               PIC XXX.
  4730         16  CM-REIN-TABLE                 PIC XXX.
  4731         16  CM-SPECIAL-REIN-CODE          PIC X.
  4732         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4733         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4734         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4735
  4736     12  CM-STATUS-DATA.
  4737         16  CM-ENTRY-STATUS               PIC X.
  4738         16  CM-ENTRY-DT                   PIC XX.
  4739
  4740         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4741         16  CM-LF-CANCEL-DT               PIC XX.
  4742         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4743
  4744         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4745         16  CM-LF-DEATH-DT                PIC XX.
  4746         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4747
  4748         16  CM-LF-CURRENT-STATUS          PIC X.
  4749             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4750                                                'M' '4' '5' '9'.
  4751             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4752             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4753             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4754             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4755             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  90
* EL154.cbl
  4756             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4757             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4758             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4759             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4760             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4761             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4762             88  CM-LF-DECLINED               VALUE 'D'.
  4763             88  CM-LF-VOIDED                 VALUE 'V'.
  4764
  4765         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4766         16  CM-AH-CANCEL-DT               PIC XX.
  4767         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4768
  4769         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4770         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4771         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4772
  4773         16  CM-AH-CURRENT-STATUS          PIC X.
  4774             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4775                                                'M' '4' '5' '9'.
  4776             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4777             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4778             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4779             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4780             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4781             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4782             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4783             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4784             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4785             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4786             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4787             88  CM-AH-DECLINED               VALUE 'D'.
  4788             88  CM-AH-VOIDED                 VALUE 'V'.
  4789
  4790         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4791             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4792             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4793             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4794         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4795
  4796         16  CM-ENTRY-BATCH                PIC X(6).
  4797         16  CM-LF-EXIT-BATCH              PIC X(6).
  4798         16  CM-AH-EXIT-BATCH              PIC X(6).
  4799         16  CM-LAST-MONTH-END             PIC XX.
  4800
  4801     12  CM-NOTE-SW                        PIC X.
  4802         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4803         88  CERT-NOTES-PRESENT               VALUE '1'.
  4804         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4805         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4806         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4807         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4808         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4809         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4810     12  CM-COMP-EXCP-SW                   PIC X.
  4811         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4812         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4813     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  91
* EL154.cbl
  4814         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4815         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4816
  4817*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4818     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4819     12  FILLER                            PIC X.
  4820
  4821*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4822     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4823     12  FILLER                            PIC X.
  4824*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4825     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4826
  4827     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4828         88  CERT-ADDED-BATCH                 VALUE ' '.
  4829         88  CERT-ADDED-ONLINE                VALUE '1'.
  4830         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4831         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4832         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4833     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4834         88  CERT-AS-LOADED                   VALUE ' '.
  4835         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4836         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4837         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4838         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4839         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4840         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4841         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4842
  4843     12  CM-ACCOUNT-COMM-PCTS.
  4844         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4845         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4846
  4847     12  CM-USER-FIELD                     PIC X.
  4848     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4849     12  CM-CLP-STATE                      PIC XX.
  4850     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4851     12  CM-USER-RESERVED                  PIC XXX.
  4852     12  FILLER REDEFINES CM-USER-RESERVED.
  4853         16  CM-AH-CLASS-CD                PIC XX.
  4854         16  F                             PIC X.
  4855******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  92
* EL154.cbl
  4857*                            COPY ELCBENE.
  4858******************************************************************
  4859*                                                                *
  4860*                            ELCBENE.                            *
  4861*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4862*                            VMOD=2.006                          *
  4863*                                                                *
  4864*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  4865*                                                                *
  4866*   FILE TYPE = VSAM,KSDS                                        *
  4867*   RECORD SIZE = 500   RECFORM = FIX                            *
  4868*                                                                *
  4869*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  4870*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  4871*                                                                *
  4872*   LOG = YES                                                    *
  4873*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4874*                                                                *
  4875*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  4876******************************************************************
  4877
  4878 01  BENEFICIARY-MASTER.
  4879     12  BE-RECORD-ID                PIC XX.
  4880         88  VALID-BE-ID                VALUE 'BE'.
  4881
  4882     12  BE-CONTROL-PRIMARY.
  4883         16  BE-COMPANY-CD           PIC X.
  4884         16  BE-RECORD-TYPE          PIC X.
  4885             88  BENEFICIARY-RECORD  VALUE 'B'.
  4886             88  ADJUSTOR-RECORD     VALUE 'A'.
  4887         16  BE-BENEFICIARY          PIC X(10).
  4888     12  BE-CONTROL-BY-NAME.
  4889         16  BE-COMPANY-CD-A1        PIC X.
  4890         16  BE-RECORD-TYPE-A1       PIC X.
  4891         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  4892         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  4893
  4894     12  BE-LAST-MAINT-DT            PIC XX.
  4895     12  BE-LAST-MAINT-BY            PIC X(4).
  4896     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4897
  4898     12  BE-ADDRESS-DATA.
  4899         16  BE-MAIL-TO-NAME         PIC X(30).
  4900         16  BE-ADDRESS-LINE-1       PIC X(30).
  4901         16  BE-ADDRESS-LINE-2       PIC X(30).
  4902         16  BE-ADDRESS-LINE-3       PIC X(30).
  4903         16  BE-CITY-STATE.
  4904             20  BE-CITY             PIC X(28).
  4905             20  BE-STATE            PIC XX.
  4906         16  BE-ZIP-CODE.
  4907             20  BE-ZIP-PRIME.
  4908                 24  BE-ZIP-1ST      PIC X.
  4909                     88  BE-CANADIAN-POST-CODE
  4910                                         VALUE 'A' THRU 'Z'.
  4911                 24  FILLER          PIC X(4).
  4912             20  BE-ZIP-PLUS4        PIC X(4).
  4913         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  4914             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  93
* EL154.cbl
  4915             20  BE-CAN-POSTAL-2     PIC XXX.
  4916             20  FILLER              PIC XXX.
  4917         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  4918         16  BE-GROUP-CHECKS-Y-N     PIC X.
  4919
  4920******************************************************************
  4921*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  4922*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  4923******************************************************************
  4924     12  BE-CARRIER                  PIC X.
  4925
  4926     12  BE-ADDRESS-DATA2.
  4927         16  BE-MAIL-TO-NAME2        PIC X(30).
  4928         16  BE-ADDRESS-LINE-12      PIC X(30).
  4929         16  BE-ADDRESS-LINE-22      PIC X(30).
  4930         16  BE-ADDRESS-LINE-32      PIC X(30).
  4931         16  BE-CITY-STATE2.
  4932             20  BE-CITY2            PIC X(28).
  4933             20  BE-STATE2           PIC XX.
  4934         16  BE-ZIP-CODE2.
  4935             20  BE-ZIP-PRIME2.
  4936                 24  BE-ZIP-1ST2     PIC X.
  4937                     88  BE-CANADIAN-POST-CODE2
  4938                                         VALUE 'A' THRU 'Z'.
  4939                 24  FILLER          PIC X(4).
  4940             20  BE-ZIP-PLUS42       PIC X(4).
  4941         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  4942             20  BE-CAN-POSTAL-12    PIC XXX.
  4943             20  BE-CAN-POSTAL-22    PIC XXX.
  4944             20  FILLER              PIC XXX.
  4945         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  4946         16  BE-BILLING-STMT-DATA.
  4947             20  BE-BSR              PIC X.
  4948                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  4949                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  4950             20  BE-BSR-FROM         PIC X(30).
  4951             20  BE-BSR-DEPT         PIC X(30).
  4952             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  4953             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  4954             20  BE-OUTPUT-TYPE      PIC X.
  4955                 88  BE-FAX-OUTPUT         VALUE 'F'.
  4956                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  4957
  4958     12  FILLER                      PIC X(28).
  4959******************************************************************
  4960*                            COPY ERCACCT.
  4961******************************************************************
  4962*                                                                *
  4963*                                                                *
  4964*                            ERCACCT                             *
  4965*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4966*                            VMOD=2.031                          *
  4967*                                                                *
  4968*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4969*                                                                *
  4970*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4971*   VSAM ACCOUNT MASTER FILES.                                   *
  4972*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  94
* EL154.cbl
  4973*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4974*                                                                *
  4975*   FILE TYPE = VSAM,KSDS                                        *
  4976*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4977*                                                                *
  4978*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4979*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4980*                                                                *
  4981*   LOG = NO                                                     *
  4982*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4983*                                                                *
  4984*                                                                *
  4985******************************************************************
  4986*                   C H A N G E   L O G
  4987*
  4988* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4989*-----------------------------------------------------------------
  4990*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4991* EFFECTIVE    NUMBER
  4992*-----------------------------------------------------------------
  4993* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4994* 092705    2005050300006  PEMA  ADD SPP LEASES
  4995* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4996* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4997* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4998* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4999* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5000******************************************************************
  5001
  5002 01  ACCOUNT-MASTER.
  5003     12  AM-RECORD-ID                      PIC XX.
  5004         88  VALID-AM-ID                      VALUE 'AM'.
  5005
  5006     12  AM-CONTROL-PRIMARY.
  5007         16  AM-COMPANY-CD                 PIC X.
  5008         16  AM-MSTR-CNTRL.
  5009             20  AM-CONTROL-A.
  5010                 24  AM-CARRIER            PIC X.
  5011                 24  AM-GROUPING.
  5012                     28 AM-GROUPING-PREFIX PIC XXX.
  5013                     28 AM-GROUPING-PRIME  PIC XXX.
  5014                 24  AM-STATE              PIC XX.
  5015                 24  AM-ACCOUNT.
  5016                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5017                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5018             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5019                                           PIC X(19).
  5020             20  AM-CNTRL-B.
  5021                 24  AM-EXPIRATION-DT      PIC XX.
  5022                 24  FILLER                PIC X(4).
  5023             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5024                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5025
  5026     12  AM-CONTROL-BY-VAR-GRP.
  5027         16  AM-COMPANY-CD-A1              PIC X.
  5028         16  AM-VG-CARRIER                 PIC X.
  5029         16  AM-VG-GROUPING                PIC X(6).
  5030         16  AM-VG-STATE                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  95
* EL154.cbl
  5031         16  AM-VG-ACCOUNT                 PIC X(10).
  5032         16  AM-VG-DATE.
  5033             20  AM-VG-EXPIRATION-DT       PIC XX.
  5034             20  FILLER                    PIC X(4).
  5035         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5036                                           PIC 9(11)      COMP-3.
  5037     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5038         16  FILLER                        PIC X(10).
  5039         16  AM-VG-KEY3.
  5040             20  AM-VG3-ACCOUNT            PIC X(10).
  5041             20  AM-VG3-EXP-DT             PIC XX.
  5042         16  FILLER                        PIC X(4).
  5043     12  AM-MAINT-INFORMATION.
  5044         16  AM-LAST-MAINT-DT              PIC XX.
  5045         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5046         16  AM-LAST-MAINT-USER            PIC X(4).
  5047         16  FILLER                        PIC XX.
  5048
  5049     12  AM-EFFECTIVE-DT                   PIC XX.
  5050     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5051
  5052     12  AM-PREV-DATES  COMP-3.
  5053         16  AM-PREV-EXP-DT                PIC 9(11).
  5054         16  AM-PREV-EFF-DT                PIC 9(11).
  5055
  5056     12  AM-REPORT-CODE-1                  PIC X(10).
  5057     12  AM-REPORT-CODE-2                  PIC X(10).
  5058
  5059     12  AM-CITY-CODE                      PIC X(4).
  5060     12  AM-COUNTY-PARISH                  PIC X(6).
  5061
  5062     12  AM-NAME                           PIC X(30).
  5063     12  AM-PERSON                         PIC X(30).
  5064     12  AM-ADDRS                          PIC X(30).
  5065     12  AM-CITY.
  5066         16  AM-ADDR-CITY                  PIC X(28).
  5067         16  AM-ADDR-STATE                 PIC XX.
  5068     12  AM-ZIP.
  5069         16  AM-ZIP-PRIME.
  5070             20  AM-ZIP-PRI-1ST            PIC X.
  5071                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5072             20  FILLER                    PIC X(4).
  5073         16  AM-ZIP-PLUS4                  PIC X(4).
  5074     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5075         16  AM-CAN-POSTAL-1               PIC XXX.
  5076         16  AM-CAN-POSTAL-2               PIC XXX.
  5077         16  FILLER                        PIC XXX.
  5078     12  AM-TEL-NO.
  5079         16  AM-AREA-CODE                  PIC 999.
  5080         16  AM-TEL-PRE                    PIC 999.
  5081         16  AM-TEL-NBR                    PIC 9(4).
  5082     12  AM-TEL-LOC                        PIC X.
  5083         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5084         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5085
  5086     12  AM-COMM-STRUCTURE.
  5087         16  AM-DEFN-1.
  5088             20  AM-AGT-COMMS       OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  96
* EL154.cbl
  5089                 24  AM-AGT.
  5090                     28  AM-AGT-PREFIX     PIC X(4).
  5091                     28  AM-AGT-PRIME      PIC X(6).
  5092                 24  AM-COM-TYP            PIC X.
  5093                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5094                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5095                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5096                 24  AM-RECALC-LV-INDIC    PIC X.
  5097                 24  AM-RETRO-LV-INDIC     PIC X.
  5098                 24  AM-GL-CODES           PIC X.
  5099                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5100                 24  FILLER                PIC X(01).
  5101         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5102             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5103                 24  FILLER                PIC X(11).
  5104                 24  AM-L-COMA             PIC XXX.
  5105                 24  AM-J-COMA             PIC XXX.
  5106                 24  AM-A-COMA             PIC XXX.
  5107                 24  FILLER                PIC X(6).
  5108
  5109     12  AM-COMM-CHANGE-STATUS             PIC X.
  5110         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5111
  5112     12  AM-CSR-CODE                       PIC X(4).
  5113
  5114     12  AM-BILLING-STATUS                 PIC X.
  5115         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5116         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5117     12  AM-AUTO-REFUND-SW                 PIC X.
  5118         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5119         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5120     12  AM-GPCD                           PIC 99.
  5121     12  AM-IG                             PIC X.
  5122         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5123         88  AM-HAS-GROUP                     VALUE '2'.
  5124     12  AM-STATUS                         PIC X.
  5125         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5126         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5127         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5128         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5129         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5130         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5131     12  AM-REMIT-TO                       PIC 99.
  5132     12  AM-ID-NO                          PIC X(11).
  5133
  5134     12  AM-CAL-TABLE                      PIC XX.
  5135     12  AM-LF-DEVIATION                   PIC XXX.
  5136     12  AM-AH-DEVIATION                   PIC XXX.
  5137     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5138     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5139     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5140     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5141     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5142     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5143
  5144     12  AM-USER-FIELDS.
  5145         16  AM-FLD-1                      PIC XX.
  5146         16  AM-FLD-2                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  97
* EL154.cbl
  5147         16  AM-FLD-3                      PIC XX.
  5148         16  AM-FLD-4                      PIC XX.
  5149         16  AM-FLD-5                      PIC XX.
  5150
  5151     12  AM-1ST-PROD-DATE.
  5152         16  AM-1ST-PROD-YR                PIC XX.
  5153         16  AM-1ST-PROD-MO                PIC XX.
  5154         16  AM-1ST-PROD-DA                PIC XX.
  5155     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5156     12  AM-CERTS-PURGED-DATE.
  5157         16  AM-PUR-YR                     PIC XX.
  5158         16  AM-PUR-MO                     PIC XX.
  5159         16  AM-PUR-DA                     PIC XX.
  5160     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5161     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5162     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5163     12  AM-INACTIVE-DATE.
  5164         16  AM-INA-MO                     PIC 99.
  5165         16  AM-INA-DA                     PIC 99.
  5166         16  AM-INA-YR                     PIC 99.
  5167     12  AM-AR-HI-CERT-DATE                PIC XX.
  5168
  5169     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5170     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5171
  5172     12  AM-OB-PAYMENT-MODE                PIC X.
  5173         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5174         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5175         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5176         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5177
  5178     12  AM-AH-ONLY-INDICATOR              PIC X.
  5179         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5180         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5181
  5182     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5183
  5184     12  AM-OVER-SHORT.
  5185         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5186         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5187
  5188     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5189     12  AM-DCC-CLP-STATE                  PIC XX.
  5190
  5191     12  AM-RECALC-COMM                    PIC X.
  5192     12  AM-RECALC-REIN                    PIC X.
  5193
  5194     12  AM-REI-TABLE                      PIC XXX.
  5195     12  AM-REI-ET-LF                      PIC X.
  5196     12  AM-REI-ET-AH                      PIC X.
  5197     12  AM-REI-PE-LF                      PIC X.
  5198     12  AM-REI-PE-AH                      PIC X.
  5199     12  AM-REI-PRT-ST                     PIC X.
  5200     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5201     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5202     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5203     12  AM-REI-GROUP-A                    PIC X(6).
  5204     12  AM-REI-MORT                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  98
* EL154.cbl
  5205     12  AM-REI-PRT-OW                     PIC X.
  5206     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5207     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5208     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5209     12  AM-REI-GROUP-B                    PIC X(6).
  5210
  5211     12  AM-TRUST-TYPE                     PIC X(2).
  5212
  5213     12  AM-EMPLOYER-STMT-USED             PIC X.
  5214     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5215
  5216     12  AM-STD-AH-TYPE                    PIC XX.
  5217     12  AM-EARN-METHODS.
  5218         16  AM-EARN-METHOD-R              PIC X.
  5219             88 AM-REF-RL-R78                 VALUE 'R'.
  5220             88 AM-REF-RL-PR                  VALUE 'P'.
  5221             88 AM-REF-RL-MEAN                VALUE 'M'.
  5222             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5223         16  AM-EARN-METHOD-L              PIC X.
  5224             88 AM-REF-LL-R78                 VALUE 'R'.
  5225             88 AM-REF-LL-PR                  VALUE 'P'.
  5226             88 AM-REF-LL-MEAN                VALUE 'M'.
  5227             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5228         16  AM-EARN-METHOD-A              PIC X.
  5229             88 AM-REF-AH-R78                 VALUE 'R'.
  5230             88 AM-REF-AH-PR                  VALUE 'P'.
  5231             88 AM-REF-AH-MEAN                VALUE 'M'.
  5232             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5233             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5234             88 AM-REF-AH-NET                 VALUE 'N'.
  5235
  5236     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5237     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5238     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5239
  5240     12  AM-RET-Y-N                        PIC X.
  5241     12  AM-RET-P-E                        PIC X.
  5242     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5243     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5244     12  AM-RET-GRP                        PIC X(6).
  5245     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5246         16  AM-POOL-PRIME                 PIC XXX.
  5247         16  AM-POOL-SUB                   PIC XXX.
  5248     12  AM-RETRO-EARNINGS.
  5249         16  AM-RET-EARN-R                 PIC X.
  5250         16  AM-RET-EARN-L                 PIC X.
  5251         16  AM-RET-EARN-A                 PIC X.
  5252     12  AM-RET-ST-TAX-USE                 PIC X.
  5253         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5254         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5255     12  AM-RETRO-BEG-EARNINGS.
  5256         16  AM-RET-BEG-EARN-R             PIC X.
  5257         16  AM-RET-BEG-EARN-L             PIC X.
  5258         16  AM-RET-BEG-EARN-A             PIC X.
  5259     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5260     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5261
  5262     12  AM-USER-SELECT-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page  99
* EL154.cbl
  5263         16  AM-USER-SELECT-1              PIC X(10).
  5264         16  AM-USER-SELECT-2              PIC X(10).
  5265         16  AM-USER-SELECT-3              PIC X(10).
  5266         16  AM-USER-SELECT-4              PIC X(10).
  5267         16  AM-USER-SELECT-5              PIC X(10).
  5268
  5269     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5270
  5271     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5272
  5273     12  AM-RPT045A-SWITCH                 PIC X.
  5274         88  RPT045A-OFF                   VALUE 'N'.
  5275
  5276     12  AM-INSURANCE-LIMITS.
  5277         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5278         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5279
  5280     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5281         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5282
  5283     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5284         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5285         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5286
  5287     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5288
  5289     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5290     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5291     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5292     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5293     12  AM-DCC-UEF-STATE                  PIC XX.
  5294     12  FILLER                            PIC XXX.
  5295     12  AM-REPORT-CODE-3                  PIC X(10).
  5296*    12  FILLER                            PIC X(22).
  5297
  5298     12  AM-RESERVE-DATE.
  5299         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5300         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5301         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5302
  5303     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5304     12  AM-NOTIFICATION-TYPES.
  5305         16  AM-NOTIF-OF-LETTERS           PIC X.
  5306         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5307         16  AM-NOTIF-OF-REPORTS           PIC X.
  5308         16  AM-NOTIF-OF-STATUS            PIC X.
  5309
  5310     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5311         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5312         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5313         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5314         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5315
  5316     12  AM-BENEFIT-CONTROLS.
  5317         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5318             20  AM-BENEFIT-CODE           PIC XX.
  5319             20  AM-BENEFIT-TYPE           PIC X.
  5320             20  AM-BENEFIT-REVISION       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 100
* EL154.cbl
  5321             20  AM-BENEFIT-REM-TERM       PIC X.
  5322             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5323             20  FILLER                    PIC XX.
  5324         16  FILLER                        PIC X(80).
  5325
  5326     12  AM-TRANSFER-DATA.
  5327         16  AM-TRANSFERRED-FROM.
  5328             20  AM-TRNFROM-CARRIER        PIC X.
  5329             20  AM-TRNFROM-GROUPING.
  5330                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5331                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5332             20  AM-TRNFROM-STATE          PIC XX.
  5333             20  AM-TRNFROM-ACCOUNT.
  5334                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5335                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5336             20  AM-TRNFROM-DTE            PIC XX.
  5337         16  AM-TRANSFERRED-TO.
  5338             20  AM-TRNTO-CARRIER          PIC X.
  5339             20  AM-TRNTO-GROUPING.
  5340                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5341                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5342             20  AM-TRNTO-STATE            PIC XX.
  5343             20  AM-TRNTO-ACCOUNT.
  5344                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5345                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5346             20  AM-TRNTO-DTE              PIC XX.
  5347         16  FILLER                        PIC X(10).
  5348
  5349     12  AM-SAVED-REMIT-TO                 PIC 99.
  5350
  5351     12  AM-COMM-STRUCTURE-SAVED.
  5352         16  AM-DEFN-1-SAVED.
  5353             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5354                 24  AM-AGT-SV             PIC X(10).
  5355                 24  AM-COM-TYP-SV         PIC X.
  5356                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5357                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5358                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5359                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5360                 24  FILLER                PIC X.
  5361                 24  AM-GL-CODES-SV        PIC X.
  5362                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5363                 24  FILLER                PIC X.
  5364         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5365             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5366                 24  FILLER                PIC X(11).
  5367                 24  AM-L-COMA-SV          PIC XXX.
  5368                 24  AM-J-COMA-SV          PIC XXX.
  5369                 24  AM-A-COMA-SV          PIC XXX.
  5370                 24  FILLER                PIC X(6).
  5371
  5372     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5373         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5374            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5375            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5376            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5377
  5378     12  AM-ORIG-DEALER-NO                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 101
* EL154.cbl
  5379     12  FILLER                            PIC X(120).
  5380
  5381     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5382         16  AM-CONTROL-NAME               PIC X(30).
  5383         16  AM-EXECUTIVE-ONE.
  5384             20  AM-EXEC1-NAME             PIC X(15).
  5385             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5386                                                          COMP-3.
  5387             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5388                                                          COMP-3.
  5389         16  AM-EXECUTIVE-TWO.
  5390             20  AM-EXEC2-NAME             PIC X(15).
  5391             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5392                                                          COMP-3.
  5393             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5394                                                          COMP-3.
  5395
  5396     12  AM-RETRO-ADDITIONAL-DATA.
  5397         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5398         16  AM-RETRO-PREM-P-E             PIC X.
  5399         16  AM-RETRO-CLMS-P-I             PIC X.
  5400         16  AM-RETRO-RET-BRACKET-LF.
  5401             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5402                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5403                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5404             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5405                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5406                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5407             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5408                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5409                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5410         16  AM-RETRO-RET-BRACKET-AH.
  5411             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5412                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5413                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5414                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5415             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5416                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5417                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5418             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5419                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5420                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5421
  5422     12  AM-COMMENTS.
  5423         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5424
  5425     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5426         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5427         16  AM-FLI-BILLING-CODE           PIC X.
  5428         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5429         16  AM-FLI-UNITED-IDENT           PIC X.
  5430         16  AM-FLI-INTEREST-LOST-DATA.
  5431             20  AM-FLI-BANK-NO            PIC X(5).
  5432             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5433             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5434             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5435         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5436             20  AM-FLI-AGT                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 102
* EL154.cbl
  5437             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5438             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5439         16  FILLER                        PIC X(102).
  5440
  5441     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5442         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5443             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5444             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5445             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5446             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5447             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5448         16  FILLER                          PIC X(10).
  5449******************************************************************
  5450*                            COPY ERCPDEF.
  5451******************************************************************
  5452*                                                                *
  5453*                                                                *
  5454*                            ERCPDEF.                            *
  5455*                                                                *
  5456*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5457*                                                                *
  5458*    FILE TYPE = VSAM,KSDS                                       *
  5459*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5460*                                                                *
  5461*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5462*                                                                *
  5463*    LOG = YES                                                   *
  5464*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5465******************************************************************
  5466*                   C H A N G E   L O G
  5467*
  5468* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5469*-----------------------------------------------------------------
  5470*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5471* EFFECTIVE    NUMBER
  5472*-----------------------------------------------------------------
  5473* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5474* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5475* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  5476******************************************************************
  5477 01  PRODUCT-MASTER.
  5478    12  PD-RECORD-ID                 PIC X(02).
  5479        88  VALID-PD-ID                  VALUE 'PD'.
  5480    12  PD-CONTROL-PRIMARY.
  5481        16  PD-COMPANY-CD            PIC X.
  5482        16  PD-STATE                 PIC XX.
  5483        16  PD-PRODUCT-CD            PIC XXX.
  5484        16  PD-FILLER                PIC X(7).
  5485        16  PD-BEN-TYPE              PIC X.
  5486        16  PD-BEN-CODE              PIC XX.
  5487        16  PD-PROD-EXP-DT           PIC XX.
  5488    12  FILLER                       PIC X(50).
  5489    12  PD-PRODUCT-DATA OCCURS 8.
  5490        16  PD-PROD-CODE             PIC X.
  5491            88  PD-PROD-LIFE           VALUE 'L'.
  5492            88  PD-PROD-PROP           VALUE 'P'.
  5493            88  PD-PROD-AH             VALUE 'A'.
  5494            88  PD-PROD-IU             VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 103
* EL154.cbl
  5495            88  PD-PROD-GAP            VALUE 'G'.
  5496            88  PD-PROD-FAML           VALUE 'F'.
  5497        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5498        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5499        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5500        16  PD-MAX-TERM              PIC S999        COMP-3.
  5501        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5502        16  FILLER                   PIC X.
  5503        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5504        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5505        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5506        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5507        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5508        16  PD-REC-CRIT-PERIOD       PIC 99.
  5509        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  5510            20  PD-RECURRING-YN      PIC X.
  5511            20  FILLER               PIC X.
  5512        16  PD-RTW-MOS               PIC 99.
  5513        16  PD-MAX-EXTENSION         PIC 99.
  5514        16  pd-ben-pct               pic sv999 comp-3.
  5515*       16  FILLER                   PIC XX.
  5516    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5517    12  PD-TERM-LIMITS OCCURS 15.
  5518        16  PD-LOW-TERM              PIC S999        COMP-3.
  5519        16  PD-HI-TERM               PIC S999        COMP-3.
  5520*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5521    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5522        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5523        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5524    12  PD-EARN-FACTORS.
  5525        16  FILLER OCCURS 15.
  5526            20  FILLER OCCURS 15.
  5527                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5528    12  PD-PRODUCT-DESC              PIC X(80).
  5529    12  PD-TRUNCATED                 PIC X.
  5530    12  FILLER                       PIC X(59).
  5531    12  PD-MAINT-INFORMATION.
  5532        16  PD-LAST-MAINT-DT         PIC X(02).
  5533        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5534        16  PD-LAST-MAINT-BY         PIC X(04).
  5535*                            copy ELCCRTT.
  5536******************************************************************
  5537*                                                                *
  5538*                            ELCCRTT.                            *
  5539*                                                                *
  5540*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5541*                                                                *
  5542*   FILE TYPE = VSAM,KSDS                                        *
  5543*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5544*                                                                *
  5545*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5546*                                                                *
  5547*   LOG = YES                                                    *
  5548*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5549******************************************************************
  5550*                   C H A N G E   L O G
  5551*
  5552* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 104
* EL154.cbl
  5553*-----------------------------------------------------------------
  5554*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5555* EFFECTIVE    NUMBER
  5556*-----------------------------------------------------------------
  5557* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5558* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5559* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5560* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5561* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5562* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5563* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5564******************************************************************
  5565
  5566 01  CERTIFICATE-TRAILERS.
  5567     12  CS-RECORD-ID                      PIC XX.
  5568         88  VALID-CS-ID                      VALUE 'CS'.
  5569
  5570     12  CS-CONTROL-PRIMARY.
  5571         16  CS-COMPANY-CD                 PIC X.
  5572         16  CS-CARRIER                    PIC X.
  5573         16  CS-GROUPING                   PIC X(6).
  5574         16  CS-STATE                      PIC XX.
  5575         16  CS-ACCOUNT                    PIC X(10).
  5576         16  CS-CERT-EFF-DT                PIC XX.
  5577         16  CS-CERT-NO.
  5578             20  CS-CERT-PRIME             PIC X(10).
  5579             20  CS-CERT-SFX               PIC X.
  5580         16  CS-TRAILER-TYPE               PIC X.
  5581             88  COMM-TRLR           VALUE 'A'.
  5582             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5583             88  CERT-DATA-TRLR      VALUE 'C'.
  5584
  5585     12  CS-DATA-AREA                      PIC X(516).
  5586
  5587     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5588         16  CS-BANK-COMMISSION-AREA.
  5589             20  CS-BANK-COMMS       OCCURS 10.
  5590                 24  CS-AGT                PIC X(10).
  5591                 24  CS-COM-TYP            PIC X.
  5592                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5593                 24  CS-RECALC-LV-INDIC    PIC X.
  5594                 24  FILLER                PIC X(10).
  5595         16  FILLER                        PIC X(256).
  5596
  5597     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5598****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5599         16  CS-MB-CLAIM-DATA OCCURS 24.
  5600             20  CS-CLAIM-NO               PIC X(7).
  5601             20  CS-CLAIM-TYPE             PIC X.
  5602                 88  CS-AH-CLM               VALUE 'A'.
  5603                 88  CS-IU-CLM               VALUE 'I'.
  5604                 88  CS-GP-CLM               VALUE 'G'.
  5605                 88  CS-LF-CLM               VALUE 'L'.
  5606                 88  CS-PR-CLM               VALUE 'P'.
  5607                 88  CS-FL-CLM               VALUE 'F'.
  5608             20  CS-INSURED-TYPE           PIC X.
  5609                 88  CS-PRIM-INSURED          VALUE 'P'.
  5610                 88  CS-CO-BORROWER           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 105
* EL154.cbl
  5611             20  CS-BENEFIT-PERIOD         PIC 99.
  5612             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5613             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5614             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5615         16  FILLER                        PIC X(12).
  5616     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5617         16  CS-VIN-NUMBER                 PIC X(17).
  5618         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5619         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5620         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5621         16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 106
* EL154.cbl
  5623*                            COPY MPCPLCY.
  5624******************************************************************
  5625*                                                                *
  5626*                           MPCPLCY                              *
  5627*                            VMOD=1.024                          *
  5628*                                                                *
  5629*   FILE DESCRIPTION = POLICY MASTER                             *
  5630*                                                                *
  5631*   FILE TYPE = VSAM,KSDS                                        *
  5632*   RECORD SIZE = 1200 RECFORM = FIXED                           *
  5633*                                                                *
  5634*   BASE CLUSTER = MPPLCY                         RKP=2,LEN=42   *
  5635*       ALTERNATE PATH2 = ** NOT USED **                         *
  5636*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  5637*       ALTERNATE PATH4 = MPPLCY4 (BY REF. NO.)   RKP=60,LEN=25  *
  5638*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT )   RKP=85,LEN=27  *
  5639*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT )   RKP=112,LEN=15 *
  5640*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO.)   RKP=127,LEN=27 *
  5641*                                                                *
  5642*   LOG = YES                                                    *
  5643*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5644******************************************************************
  5645**WARNING*********************************************************
  5646**ANY CHANGES TO THIS COPY BOOK MAY NEED CORRESPONDING CHANGES****
  5647**TO THE FOLLOWING COPY BOOKS: MPCPOLUP                          *
  5648**                             MPCPHSTD                          *
  5649**                             MPCPHSTC                          *
  5650**                             MPCPHSTT                          *
  5651**                                                               *
  5652******************************************************************
  5653
  5654 01  POLICY-MASTER.
  5655     12  PM-RECORD-ID                      PIC XX.
  5656         88  VALID-PM-ID                      VALUE 'PM'.
  5657
  5658******************************************************************
  5659*   BASE CLUSTER = MPPLCY         (BASE KEY)      RKP=2,LEN=42   *
  5660******************************************************************
  5661
  5662     12  PM-CONTROL-PRIMARY.
  5663         16  PM-PRODUCER-PRIMARY.
  5664             20  PM-PROD-PRIMARY.
  5665                 24  PM-COMPANY-CD         PIC X.
  5666                 24  PM-CGSP-KEY.
  5667                     28  PM-CARRIER        PIC X.
  5668                     28  PM-GROUPING.
  5669                         32  PM-GROUPING-PREFIX
  5670                                           PIC X(3).
  5671                         32  PM-GROUPING-PRIME
  5672                                           PIC X(3).
  5673                     28  PM-STATE          PIC X(2).
  5674                     28  PM-PRODUCER.
  5675                         32  PM-PRODUCER-PREFIX
  5676                                           PIC X(4).
  5677                         32  PM-PRODUCER-PRIME
  5678                                           PIC X(6).
  5679             20  PM-POLICY-EFF-DT              PIC XX.
  5680         16  PM-REFERENCE-NUMBER.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 107
* EL154.cbl
  5681             20  PM-REFNO-PRIME            PIC X(18).
  5682             20  PM-REFNO-SFX              PIC XX.
  5683
  5684******************************************************************
  5685*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  5686******************************************************************
  5687
  5688     12  PM-CONTROL-BY-SSN.
  5689         16  PM-COMPANY-CD-A3              PIC X.
  5690         16  PM-SOC-SEC-NO.
  5691             20  PM-SSN-STATE              PIC XX.
  5692             20  PM-SSN-PRODUCER           PIC X(6).
  5693             20  PM-SSN-LN3.
  5694                 25  PM-INSURED-INITIALS-A3.
  5695                     30 PM-INSURED-INITIAL1-A3 PIC X.
  5696                     30 PM-INSURED-INITIAL2-A3 PIC X.
  5697                 25 PM-PART-LAST-NAME-A3         PIC X.
  5698         16  PM-DATE-A3                     PIC XX.
  5699         16  PM-TIME-A3                     PIC S9(04)   COMP.
  5700
  5701******************************************************************
  5702*       ALTERNATE PATH4 = MPPLCY4 (BY REFRENCE)   RKP=60,LEN=25  *
  5703******************************************************************
  5704
  5705     12  PM-CONTROL-BY-POLICY-NO.
  5706         16  PM-COMPANY-CD-A4              PIC X.
  5707         16  PM-POLICY-NO-A4.
  5708             20  PM-POLICY-PRIME-A4        PIC X(18).
  5709             20  PM-POLICY-SFX-A4          PIC XX.
  5710         16  PM-DATE-A4                    PIC XX.
  5711         16  PM-TIME-A4                    PIC S9(04)   COMP.
  5712
  5713******************************************************************
  5714*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT NO) RKP=85,LEN=27  *
  5715******************************************************************
  5716
  5717     12  PM-CONTROL-BY-ACCOUNT.
  5718         16  PM-COMPANY-CD-A5              PIC X.
  5719         16  PM-BANK-ACCOUNT-NUMBER        PIC X(20).
  5720         16  PM-DATE-A5                    PIC XX.
  5721         16  PM-TIME-A5                    PIC S9(07)   COMP.
  5722
  5723******************************************************************
  5724*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT NO) RKP=112,LEN=15 *
  5725******************************************************************
  5726
  5727     12  PM-CONTROL-BY-TRANSIT.
  5728         16  PM-COMPANY-CD-A6              PIC X.
  5729         16  PM-BANK-TRANSIT-NUMBER.
  5730             20  PM-FEDERAL-NUMBER         PIC X(4).
  5731             20  PM-BANK-NUMBER            PIC X(4).
  5732         16  PM-DATE-A6                    PIC XX.
  5733         16  PM-TIME-A6                    PIC S9(07)   COMP.
  5734
  5735******************************************************************
  5736*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO)    RKP=127,LEN=27 *
  5737******************************************************************
  5738
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 108
* EL154.cbl
  5739     12  PM-CONTROL-BY-LOAN-NO.
  5740         16  PM-COMPANY-CD-A7              PIC X.
  5741         16  PM-LOAN-NUMBER                PIC X(20).
  5742         16  PM-DATE-A7                    PIC XX.
  5743         16  PM-TIME-A7                    PIC S9(07)   COMP.
  5744
  5745******************************************************************
  5746*                 FILE SYNCHRONIZATION DATA                      *
  5747******************************************************************
  5748
  5749     12  FILLER                            PIC X(05).
  5750     12  PM-FILE-SYNCH-DATA.
  5751         16  PM-LAST-CHANGE-DT             PIC XX.
  5752         16  PM-LAST-CHANGE-TIME           PIC S9(7)    COMP.
  5753         16  PM-LAST-CHANGE-PROCESSOR      PIC X(4).
  5754     12  FILLER                            PIC X(05).
  5755
  5756******************************************************************
  5757*                    INSUREDS PROFILE DATA                       *
  5758******************************************************************
  5759
  5760     12  PM-INSURED-PROFILE-DATA.
  5761         16  PM-INSURED-NAME.
  5762             20  PM-INSURED-LAST-NAME     PIC X(15).
  5763             20  PM-INSURED-FIRST-NAME.
  5764                 24  PM-INSURED-1ST-INIT PIC X.
  5765                 24  FILLER               PIC X(9).
  5766             20  PM-INSURED-MIDDLE-INIT PIC X.
  5767         16  PM-INSURED-ADDRESS.
  5768             20  PM-ADDRESS-LINE-1         PIC X(30).
  5769             20  PM-ADDRESS-LINE-2         PIC X(30).
  5770             20  PM-CITY                   PIC X(25).
  5771             20  PM-RESIDENT-STATE         PIC XX.
  5772             20  PM-ZIP-CD.
  5773                 24  PM-ZIP-FIRST-FIVE     PIC X(5).
  5774                 24  PM-ZIP-PLUS-FOUR      PIC X(4).
  5775         16  PM-INSURED-PERSONAL.
  5776             20  PM-INSURED-OCC-CLASS      PIC X.
  5777                 88  PM-PREFERRED            VALUE '1'.
  5778                 88  PM-STANDARD             VALUE '2'.
  5779                 88  PM-HAZARDOUS            VALUE '3'.
  5780                 88  PM-VERY-HAZARDOUS       VALUE '4'.
  5781                 88  PM-EXTREME-HAZARDOUS VALUE '5'.
  5782                 88  PM-NOT-OCC              VALUE '6'.
  5783                 88  PM-OCC-UNKNOWN          VALUE '9'.
  5784             20  PM-INSURED-OCC-CD         PIC X(3).
  5785             20  PM-INSURED-OCC-CD-NUM REDEFINES
  5786                 PM-INSURED-OCC-CD         PIC 9(3).
  5787             20  PM-INSURED-SEX            PIC X.
  5788                 88  PM-INSURED-SEX-MALE      VALUE 'M'.
  5789                 88  PM-INSURED-SEX-FEMALE VALUE 'F'.
  5790             20  PM-INSURED-BIRTH-DT       PIC XX.
  5791             20  PM-INSURED-ISSUE-AGE      PIC S9(3)     COMP-3.
  5792             20  PM-INSURED-HEIGHT-FT      PIC S9(3)     COMP-3.
  5793             20  PM-INSURED-HEIGHT-IN      PIC S9(3)     COMP-3.
  5794             20  PM-INSURED-WEIGHT         PIC S9(3)     COMP-3.
  5795             20  PM-INSURED-BIRTH-STATE PIC XX.
  5796             20  PM-INSURED-PHONE-NO       PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 109
* EL154.cbl
  5797             20  PM-INSURED-RATED-AGE      PIC S9(3)     COMP-3.
  5798         16  PM-INS-LANGUAGE-IND           PIC X(01).
  5799             88  PM-ENGLISH                           VALUE 'E'.
  5800             88  PM-FRENCH                            VALUE 'F'.
  5801             88  PM-SPANISH                           VALUE 'S'.
  5802         16  PM-INSURED-TOT-BENEFIT        PIC S9(7)V99  COMP-3.
  5803
  5804         16  PM-INSURED-AGE-IND            PIC X(01).
  5805             88  PM-INSURED-AGE-75-REACHED            VALUE 'Y'.
  5806     12  FILLER                            PIC X(13).
  5807
  5808******************************************************************
  5809*                JOINT INSUREDS PROFILE DATA                     *
  5810******************************************************************
  5811
  5812     12  PM-JOINT-PROFILE-DATA.
  5813         16  PM-JOINT-NAME.
  5814             20  PM-JOINT-LAST-NAME        PIC X(15).
  5815             20  PM-JOINT-FIRST-NAME.
  5816                 24  PM-JOINT-1ST-INIT     PIC X.
  5817                 24  FILLER                PIC X(9).
  5818             20  PM-JOINT-MIDDLE-INIT      PIC X.
  5819         16  PM-JOINT-SOC-SEC-NO.
  5820             20  PM-JT-SSN-STATE           PIC XX.
  5821             20  PM-JT-SSN-PRODUCER        PIC X(6).
  5822             20  PM-JT-SSN-LN3.
  5823                 25  PM-JT-INSURED-INITIALS-A3.
  5824                     30 PM-JT-INSURED-INITIAL1-A3 PIC X.
  5825                     30 PM-JT-INSURED-INITIAL2-A3 PIC X.
  5826                 25 PM-JT-PART-LAST-NAME-A3        PIC X.
  5827         16  PM-JOINT-PERSONAL.
  5828             20  PM-JOINT-OCC-CLASS        PIC X.
  5829                 88 PM-JNT-PREFERRED          VALUE '1'.
  5830                 88 PM-JNT-STANDARD           VALUE '2'.
  5831                 88 PM-JNT-HAZARDOUS          VALUE '3'.
  5832                 88 PM-JNT-VERY-HAZARDOUS     VALUE '4'.
  5833                 88 PM-JNT-EXTREME-HAZARDOUS VALUE '5'.
  5834                 88 PM-JNT-NOT-OCC            VALUE '6'.
  5835                 88 PM-JNT-OCC-UNKNOWN        VALUE '9'.
  5836             20  PM-JOINT-OCC-CD           PIC X(3).
  5837             20  PM-JOINT-SEX              PIC X.
  5838                 88  PM-JOINT-SEX-MALE        VALUE 'M'.
  5839                 88  PM-JOINT-SEX-FEMALE      VALUE 'F'.
  5840             20  PM-JOINT-BIRTH-DT         PIC XX.
  5841             20  PM-JOINT-ISSUE-AGE        PIC S9(3)     COMP-3.
  5842             20  PM-JOINT-HEIGHT-FT        PIC S9(3)     COMP-3.
  5843             20  PM-JOINT-HEIGHT-IN        PIC S9(3)     COMP-3.
  5844             20  PM-JOINT-WEIGHT           PIC S9(3)     COMP-3.
  5845             20  PM-JOINT-BIRTH-STATE      PIC XX.
  5846             20  PM-JOINT-RATED-AGE        PIC S9(3)     COMP-3.
  5847         16  PM-JOINT-TOT-BENEFIT          PIC S9(7)V99  COMP-3.
  5848         16  PM-JOINT-AGE-IND              PIC X(01).
  5849             88  PM-JOINT-AGE-75-REACHED              VALUE 'Y'.
  5850
  5851     12  FILLER                            PIC X(12).
  5852
  5853******************************************************************
  5854*                  INSURANCE COVERAGE DATA                       *
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 110
* EL154.cbl
  5855******************************************************************
  5856
  5857     12  PM-INS-COVERAGE-DATA.
  5858         16  PM-FREE-PERIOD                PIC S9(03)    COMP-3.
  5859         16  PM-LOAN-TERM                  PIC S9(3)     COMP-3.
  5860         16  PM-LOAN-APR                   PIC S9V9999   COMP-3.
  5861         16  PM-LOAN-DT                    PIC XX.
  5862         16  PM-LOAN-PYMT                  PIC S9(5)V99  COMP-3.
  5863         16  PM-LOAN-BALC                  PIC S9(7)V99  COMP-3.
  5864         16  PM-INS-BENEFIT-MONTHS         PIC S9(3)     COMP-3.
  5865         16  PM-INS-MONTH-BENEFIT          PIC S9(7)V99  COMP-3.
  5866         16  PM-INS-TOTAL-BENEFIT          PIC S9(7)V99  COMP-3.
  5867         16  PM-INS-PLAN-TYPE              PIC X.
  5868             88  PM-AH-MORT-PLAN              VALUE 'A'.
  5869             88  PM-AD-D-MORT-PLAN            VALUE 'E'.
  5870             88  PM-DISMEM-MORT-PLAN          VALUE 'D'.
  5871             88  PM-LIFE-MORT-PLAN            VALUE 'L'.
  5872         16  PM-INS-PLAN-CD                PIC XX.
  5873         16  PM-INS-PLAN-REVISION          PIC X(3).
  5874         16  PM-INS-POLICY-FORM            PIC X(12).
  5875         16  PM-INS-MSTR-POLICY.
  5876             20  PM-FREE-TYPE              PIC X(04).
  5877             20  FILLER                    PIC X(08).
  5878         16  PM-INS-MSTR-APP.
  5879             20  FILLER                    PIC X(11).
  5880             20  PM-INS-B-C-TYPE           PIC X(01).
  5881         16  PM-INS-RATE-CD                PIC X(5).
  5882         16  PM-INS-SEX-RATING             PIC X.
  5883             88  PM-NOT-SEX-RATED              VALUE '1'.
  5884             88  PM-SEX-RATED                  VALUE '2'.
  5885         16  PM-INS-SUBSTANDARD-PCT        PIC S9V9999   COMP-3.
  5886         16  PM-INS-SUBSTANDARD-TYPE       PIC X.
  5887         16  PM-INS-TERMINATION-DT         PIC XX.
  5888         16  PM-INS-MONTH-PREMIUM      PIC S9(5)V999999  COMP-3.
  5889         16  PM-INS-CALC-MO-PREM       PIC S9(5)V999999  COMP-3.
  5890         16  PM-REINSURANCE-TABLE          PIC X(3).
  5891         16  PM-MORTALITY-CD               PIC X(4).
  5892         16  PM-INS-TYPE                   PIC X.
  5893             88  PM-INDIVIDUAL                VALUES ARE '1' 'I'.
  5894             88  PM-GROUP                     VALUES ARE '2' 'G'.
  5895         16  PM-LOAN-OFFICER               PIC X(5).
  5896         16  PM-POLICY-FEE                 PIC S9(3)V99 COMP-3.
  5897         16  PM-DEPENDENT-COUNT            PIC S99      COMP-3.
  5898         16  PM-CWA-AMOUNT                 PIC S9(5)V99  COMP-3.
  5899         16  PM-LAST-AUTO-RERATE-DT        PIC XX.
  5900         16  PM-PREM-FINANCED-SW           PIC X.
  5901             88  PM-PREM-FINANCED              VALUE 'Y'.
  5902             88  PM-PREM-NOT-FINANCED          VALUE 'N'.
  5903
  5904         16  PM-INS-TERM-LETTER-IND        PIC X.
  5905             88  PM-TERM-INITIALIZED           VALUE 'Y'.
  5906         16  PM-INS-UNDERWRITER-MAX-BEN PIC S9(7)V99     COMP-3.
  5907     12  FILLER                            PIC X(11).
  5908
  5909******************************************************************
  5910*                    POLICY BILLING DATA                         *
  5911******************************************************************
  5912
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 111
* EL154.cbl
  5913     12  PM-BILLING-DATA.
  5914         16  PM-BILLING-MODE               PIC X(1).
  5915             88  PM-ANNUAL                    VALUE '1'.
  5916             88  PM-SEMI-ANNUAL               VALUE '2'.
  5917             88  PM-QUARTERLY                 VALUE '3'.
  5918             88  PM-MONTHLY                   VALUE '4'.
  5919             88  PM-BI-MONTHLY                VALUE '5'.
  5920             88  PM-SINGLE-PREM               VALUE '6'.
  5921         16  PM-BILLING-SCHEDULE           PIC X(1).
  5922         16  PM-BILLING-SW                 PIC X(1).
  5923             88  PM-FIRST-BILLING             VALUE 'Y'.
  5924             88  PM-PAID-IN-ADVANCE           VALUE 'A'.
  5925             88  PM-POLICY-FEE-REFUNDED       VALUE 'F'.
  5926         16  PM-BILLING-TYPE               PIC X(1).
  5927             88  PM-LIST-BILL                 VALUE '1'.
  5928             88  PM-TAPE-BILL                 VALUE '2'.
  5929             88  PM-TAPE-LIST-BILL            VALUE '3'.
  5930             88  PM-GROUP-BILL          VALUE ARE '1' '2' '3'.
  5931             88  PM-DIRECT-BILL               VALUE '4'.
  5932             88  PM-PAC-BILL            VALUE ARE '5' 'C' 'S'.
  5933             88  PM-CHARGE-CARD-BILL          VALUE '6'.
  5934             88  PM-INDIV-BILL
  5935                                  VALUE ARE '4' '5' '6' 'C' 'S'.
  5936             88  PM-GRP-PLCY-BILL             VALUE '7'.
  5937             88  PM-GRP-PLCY-PAC              VALUE '8'.
  5938             88  PM-GRP-PLCY-CR-CRD           VALUE '9'.
  5939             88  PM-GRP-PLCY            VALUE ARE '7' '8' '9'.
  5940             88  PM-GRP-PROD                  VALUE 'A'.
  5941             88  PM-EFT-CHECKING              VALUE 'C'.
  5942             88  PM-EFT-SAVINGS               VALUE 'S'.
  5943         16  PM-PAYMENT-AMT                PIC S9(5)V99  COMP-3.
  5944         16  PM-OVER-SHORT-AMT             PIC S9(5)V99  COMP-3.
  5945         16  PM-LAST-BILL-DT               PIC XX.
  5946         16  PM-LAST-BILL-AMT              PIC S9(5)V99  COMP-3.
  5947         16  PM-BILL-TO-DT                 PIC XX.
  5948         16  PM-LAST-PYMT-DT               PIC XX.
  5949         16  PM-PAID-TO-DT                 PIC XX.
  5950         16  PM-PYMT-INVOICE-NUMBER        PIC X(6).
  5951         16  PM-MONTHS-PAID                PIC S9(3)     COMP-3.
  5952         16  PM-TOTAL-PREM-RECVD           PIC S9(7)V99  COMP-3.
  5953         16  PM-BILLING-GROUPING-CODE      PIC X(6).
  5954         16  PM-CHARGE-CARD-EXP-DT         PIC X(2).
  5955         16  PM-CHARGE-CARD-TYPE           PIC X(2).
  5956             88  PM-VISA                      VALUE 'VI'.
  5957             88  PM-MSTR-CARD                 VALUE 'MC'.
  5958             88  PM-DINERS-CLUB               VALUE 'DN'.
  5959             88  PM-DISCOVER                  VALUE 'DS'.
  5960             88  PM-CARTE-BLANCHE             VALUE 'CB'.
  5961             88  PM-AMERICAN-EXPRESS          VALUE 'AE'.
  5962         16  PM-BILL-INVOICE-NUMBER        PIC X(6).
  5963         16  PM-BILL-DAY                   PIC S99       COMP-3.
  5964         16  PM-RES-PREM-TAX           PIC S9(3)V999999  COMP-3.
  5965     12  FILLER                            PIC X(15).
  5966
  5967******************************************************************
  5968*                     CLAIM PAYMENT DATA                         *
  5969******************************************************************
  5970
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 112
* EL154.cbl
  5971     12  PM-CLAIM-PAYMENT-DATA.
  5972         16  PM-CLAIM-BENEFICIARY-NAME     PIC X(25).
  5973         16  PM-CLAIM-INTERFACE-SW         PIC X.
  5974             88  PM-NO-CLAIM-ATTACHED         VALUE SPACE.
  5975             88  PM-POLICY-AND-CLAIM-ONLINE VALUE '1'.
  5976             88  PM-POLICY-CREATED-FOR-CLAIM VALUE '2'.
  5977             88  PM-CLAIM-CLOSED              VALUE '3'.
  5978             88  PM-ACTIVE-CLAIM              VALUE '1' '2'.
  5979             88  PM-CLAIM-ATTACHED            VALUE '1' '2' '3'.
  5980         16  PM-CLAIM-INCURRED-DT          PIC XX.
  5981         16  PM-CLAIM-PAID-TO-DT           PIC XX.
  5982         16  PM-CLAIM-PAYMENT-CNT          PIC S9(3)     COMP-3.
  5983         16  PM-CLAIM-LAST-PAYMENT-AMT     PIC S9(7)V99  COMP-3.
  5984         16  PM-CLAIM-EXPENSES-ITD         PIC S9(7)V99  COMP-3.
  5985         16  PM-CLAIM-PAYMENTS-ITD         PIC S9(7)V99  COMP-3.
  5986         16  PM-CLAIM-ACCUMULATOR          PIC S9(7)V99  COMP-3.
  5987         16  PM-CLAIM-ATTACH-CNT           PIC S9(3)     COMP-3.
  5988         16  PM-CLAIM-LIFE-ITD             PIC S9(7)V99  COMP-3.
  5989         16  PM-CLAIM-AH-ITD               PIC S9(7)V99  COMP-3.
  5990         16  PM-CLAIM-RIDER-ITD            PIC S9(7)V99  COMP-3.
  5991
  5992     12  FILLER                            PIC X(03).
  5993
  5994******************************************************************
  5995*                POLICY STATUS AND DISPOSITION                   *
  5996******************************************************************
  5997
  5998     12  PM-STATUS-DISPOSITION-DATA.
  5999         16  PM-ISSUE-EOM-DT               PIC XX.
  6000         16  PM-REPLACEMENT-SWITCH         PIC X.
  6001         16  PM-APPL-SIGN-DT               PIC XX.
  6002         16  PM-UNDERWRITER                PIC X(3).
  6003         16  PM-ENTRY-PROCESSOR            PIC X(4).
  6004         16  PM-ENTRY-STATUS               PIC X.
  6005             88  PM-NORMAL                    VALUE '1'.
  6006             88  PM-TAKE-OVER                 VALUE '2'.
  6007             88  PM-CONVERSION                VALUE '4'.
  6008             88  PM-RE-ISSUE                  VALUE '5'.
  6009             88  PM-REINSURANCE-ONLY          VALUE '9'.
  6010         16  PM-ENTRY-DT                   PIC XX.
  6011         16  PM-ENTRY-TIME                 PIC S9(7) COMP-3.
  6012         16  PM-EXIT-DT                    PIC XX.
  6013         16  PM-CURRENT-STATUS             PIC X.
  6014             88  PM-LAPSE                     VALUE '0'.
  6015             88  PM-ACTIVE                    VALUE '1'.
  6016             88  PM-PENDING-ISSUE             VALUE '2'.
  6017             88  PM-DECLINED                  VALUE '3'.
  6018             88  PM-PENDING-CANCEL            VALUE '4'.
  6019             88  PM-PENDING-ISSUE-ERROR       VALUE '5'.
  6020             88  PM-CLAIM-APPLIED             VALUE '6'.
  6021             88  PM-CANCEL                    VALUE '7'.
  6022             88  PM-PENDING-UNWTR-REVW        VALUE '8'.
  6023             88  PM-PENDING-CANCEL-ERROR      VALUE '9'.
  6024             88  PM-CANCEL-TRANSFER           VALUE 'C'.
  6025             88  PM-CLAIM-SETTLEMENT          VALUE 'F'.
  6026             88  PM-TERMINATE                 VALUE 'T'.
  6027** NOTE TYPE 1 IS ANYTHING THAT IS OR HAS BEEN ACTIVE.  TYPE 2 IS
  6028** EVERYTHING ELSE.  IF YOU ADD A STATUS ADD THE VALUE TO ONE OF
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 113
* EL154.cbl
  6029** THESE GROUPS.
  6030             88  PM-TYPE-STAT-1
  6031                     VALUES ARE '0' '1' '4' '6' '7' '9'
  6032                                'C' 'F' 'T'.
  6033             88  PM-TYPE-STAT-2
  6034                     VALUES ARE '2' '3' '5' '8'.
  6035             88  PM-BILLABLE-STATUS VALUES ARE '0' '1' '6'.
  6036             88  PM-PENDING-STATUS
  6037                                VALUES ARE '2' '4' '5' '8' '9'.
  6038             88  PM-PENDING-ISSUE-STATUS
  6039                                VALUES ARE '2' '5' '8'.
  6040             88  PM-CANCEL-STATUS
  6041                                VALUES ARE '4' '7' '9' 'C'.
  6042         16  PM-CANCEL-CAUSE-CD            PIC X(3).
  6043         16  PM-CANCEL-DT                  PIC XX.
  6044         16  PM-REFUND-AMT                 PIC S9(5)V99  COMP-3.
  6045         16  PM-CALC-REFUND-AMT            PIC S9(5)V99  COMP-3.
  6046         16  PM-DECLINE-CD                 PIC X(3).
  6047         16  PM-DECLINE-DT                 PIC XX.
  6048         16  PM-LAST-LAPSE-DT              PIC XX.
  6049         16  PM-LAST-REINSTATE-DT          PIC XX.
  6050         16  PM-SECURITY-ACCESS-CODE       PIC X.
  6051         16  PM-PREV-CONTROL-PRIMARY.
  6052             20  PM-PREV-COMPANY-CD             PIC X.
  6053             20  PM-PREV-CARRIER                PIC X.
  6054             20  PM-PREV-GROUPING.
  6055                 24  PM-PREV-GROUPING-PREFIX PIC X(3).
  6056                 24  PM-PREV-GROUPING-PRIME     PIC X(3).
  6057             20  PM-PREV-STATE                  PIC XX.
  6058             20  PM-PREV-PRODUCER.
  6059                 24  PM-PREV-PRODUCER-PREFIX PIC X(4).
  6060                 24  PM-PREV-PRODUCER-PRIME     PIC X(6).
  6061             20  PM-PREV-POLICY-EFF-DT          PIC XX.
  6062             20  PM-PREV-REFERENCE-NUMBER.
  6063                 24  PM-PREV-REFNO-PRIME        PIC X(18).
  6064                 24  PM-PREV-REFNO-SFX          PIC XX.
  6065         16  PM-ACTION-DT                  PIC XX.
  6066         16  PM-ACTION-CODE                PIC X(3).
  6067         16  PM-ACTION-DT-2                PIC XX.
  6068         16  PM-ACTION-CODE-2              PIC X(3).
  6069         16  PM-ACTION-DT-3                PIC XX.
  6070         16  PM-ACTION-CODE-3              PIC X(3).
  6071         16  PM-ACTION-DT-4                PIC XX.
  6072         16  PM-ACTION-CODE-4              PIC X(3).
  6073         16  PM-ACTION-DT-5                PIC XX.
  6074         16  PM-ACTION-CODE-5              PIC X(3).
  6075
  6076         16  PM-KEY-CHANGE                 PIC X.
  6077                 88  PM-NO-KEY-CHG      VALUES ARE ' ' 'N'.
  6078                 88  PM-KEY-CHG              VALUE 'Y'.
  6079         16  PM-KEY-CHANGE-DT              PIC XX.
  6080
  6081         16  PM-RTI-INDICATOR              PIC X.
  6082         16  PM-REASON-CODE                PIC X(3).
  6083         16  PM-IN-OUT-PROCESSING-IND      PIC X(1).
  6084             88  PM-IN-OUT-PROCESSING      VALUE 'Y'.
  6085             88  PM-NOT-IN-OUT-PROCESSING  VALUE SPACES.
  6086
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 114
* EL154.cbl
  6087     12  FILLER                            PIC X(12).
  6088
  6089******************************************************************
  6090*                 AGENT AND COMMISSION DATA                      *
  6091******************************************************************
  6092
  6093     12  PM-COMMISSION-DATA.
  6094         16  PM-REMIT-TO                   PIC S9(3) COMP-3.
  6095         16  PM-COMM-CHANGE-SW             PIC X.
  6096                 88  PM-COMMISSION-CHANGE     VALUE 'Y'.
  6097         16  PM-AGENT-INFORMATION OCCURS     5 TIMES.
  6098             20  PM-AGENT-NUMBER           PIC X(10).
  6099             20  PM-AGENT-TYPE             PIC X.
  6100                 88  PM-PRODUCER-LEVEL-AGENT
  6101                                              VALUES ARE 'C' 'D'.
  6102                 88  PM-AGENT-GROSS           VALUE 'C'.
  6103                 88  PM-AGENT-REINS           VALUE 'R'.
  6104                 88  PM-AGENT-GROSS-REINS     VALUE 'D'.
  6105                 88  PM-OVERWRITE-GROSS       VALUE 'O'.
  6106                 88  PM-OVERWRITE-GROSS-REINS VALUE 'P'.
  6107                 88  PM-OVERWRITE-REINS       VALUE 'T'.
  6108                 88  PM-REINS-ONLY            VALUE 'W'.
  6109             20  PM-COMMISSION-BILL-PAID PIC X(1).
  6110                 88  PM-GENERATE-BILL         VALUE 'B'.
  6111                 88  PM-GENERATE-PAID         VALUE 'P'.
  6112             20  PM-AGENT-COMP-1ST-YEAR PIC S99V999.
  6113             20  PM-COMP-1ST-YEAR-TYPE     PIC X(1).
  6114                 88  PM-COMP-1ST-YEAR-PERCENT VALUE '1'.
  6115                 88  PM-COMP-1ST-YEAR-DOLLARS VALUE '2'.
  6116                 88  PM-COMP-1ST-YEAR-NOT-USED VALUE '3'.
  6117             20  PM-RENEWAL-DATA.
  6118                 24  PM-AGENT-RENEWAL-DATA OCCURS 6 TIMES.
  6119                     28  PM-RENEW-MONTHS     PIC S999    COMP-3.
  6120                     28  PM-RENEW-COMMISSION
  6121                                             PIC S99V999 COMP-3.
  6122                     28  PM-RENEW-TYPE       PIC X(1).
  6123                         88  PM-COMP-RENEW-PERCENT      VALUE '1'.
  6124                         88  PM-COMP-RENEW-DOLLARS      VALUE '2'.
  6125                         88  PM-COMP-RENEW-NOT-USED     VALUE '3'.
  6126             20  PM-COMP-RECALC-FLAG       PIC X(1).
  6127                 88  PM-BYPASS-RECALC         VALUE 'N'.
  6128     12  FILLER                            PIC X(20).
  6129******************************************************************
  6130*             CUSTOMER DATA                                      *
  6131******************************************************************
  6132     12  PM-CUSTOMER-ID                    PIC X(20).
  6133******************************************************************
  6134     12  FILLER                            PIC X(43).
  6135******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 115
* EL154.cbl
  6137 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  6138                          CLAIM-MASTER ACTIVITY-TRAILERS
  6139                          CERTIFICATE-MASTER BENEFICIARY-MASTER
  6140                          ACCOUNT-MASTER PRODUCT-MASTER
  6141                          CERTIFICATE-TRAILERS POLICY-MASTER.
  6142 0000-DFHEXIT SECTION.
  6143     MOVE '9#                    $   ' TO DFHEIV0.
  6144     MOVE 'EL154' TO DFHEIV1.
  6145     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6146     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  6147     MOVE '5'                   TO DC-OPTION-CODE.
  6148     PERFORM 9700-DATE-LINK.
  6149     MOVE DC-GREG-DATE-1-EDIT   TO  CURRENT-GREG-DATE.
  6150     MOVE DC-BIN-DATE-1         TO  CURRENT-BIN-DATE.
  6151
  6152
  6153     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  6154     MOVE 2 TO EMI-NUMBER-OF-LINES.
  6155     IF EIBCALEN = 0
  6156         GO TO 8800-UNAUTHORIZED-ACCESS.
  6157
  6158     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6159         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6160             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6161             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  6162             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6163             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6164             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6165             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6166             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6167             MOVE THIS-PGM  TO PI-CALLING-PROGRAM
  6168             MOVE LOW-VALUES TO EL154AO
  6169             GO TO 7000-BUILD-SCREEN.
  6170
  6171
  6172* EXEC CICS HANDLE CONDITION
  6173*        NOTOPEN(8860-CLAM-NOT-OPEN)
  6174*        PGMIDERR(9600-PGMID-ERROR)
  6175*        ERROR(9990-ABEND)
  6176*        END-EXEC.
  6177*    MOVE '"$JL.                 ! " #00006167' TO DFHEIV0
  6178     MOVE X'22244A4C2E20202020202020' TO DFHEIV0(1:12)
  6179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6180     MOVE X'2220233030303036313637' TO DFHEIV0(25:11)
  6181     CALL 'kxdfhei1' USING DFHEIV0
  6182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6183
  6184
  6185     IF EIBAID = DFHCLEAR
  6186         GO TO 9400-CLEAR.
  6187
  6188     IF PI-PROCESSOR-ID = 'LGXX'
  6189         GO TO 0200-RECEIVE.
  6190
  6191
  6192* EXEC CICS READQ TS
  6193*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6194*        INTO    (SECURITY-CONTROL)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 116
* EL154.cbl
  6195*        LENGTH  (SC-COMM-LENGTH)
  6196*        ITEM    (SC-ITEM)
  6197*    END-EXEC.
  6198*    MOVE '*$II   L              ''   #00006179' TO DFHEIV0
  6199     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6200     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6201     MOVE X'2020233030303036313739' TO DFHEIV0(25:11)
  6202     CALL 'kxdfhei1' USING DFHEIV0,
  6203           PI-SECURITY-TEMP-STORE-ID,
  6204           SECURITY-CONTROL,
  6205           SC-COMM-LENGTH,
  6206           SC-ITEM,
  6207           DFHEIV99,
  6208           DFHEIV99
  6209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6210
  6211
  6212     MOVE SC-CLAIMS-DISPLAY (9)   TO  PI-DISPLAY-CAP.
  6213     MOVE SC-CLAIMS-UPDATE  (9)   TO  PI-MODIFY-CAP.
  6214
  6215     IF NOT MODIFY-CAP
  6216         MOVE 'UPDATE'            TO  SM-READ
  6217         PERFORM 9995-SECURITY-VIOLATION
  6218         MOVE ER-0070             TO  EMI-ERROR
  6219         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6220         GO TO 8100-SEND-INITIAL-MAP.
  6221
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 117
* EL154.cbl
  6223 0200-RECEIVE.
  6224     MOVE LOW-VALUES TO EL154AI.
  6225     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6226         MOVE ER-0008 TO EMI-ERROR
  6227         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6228         GO TO 8200-SEND-DATAONLY.
  6229
  6230
  6231* EXEC CICS RECEIVE
  6232*        MAP(MAP-NAME)
  6233*        MAPSET(MAPSET-NAME)
  6234*        INTO(EL154AI)
  6235*        END-EXEC.
  6236     MOVE LENGTH OF
  6237      EL154AI
  6238       TO DFHEIV11
  6239*    MOVE '8"T I  L              ''   #00006204' TO DFHEIV0
  6240     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6241     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6242     MOVE X'2020233030303036323034' TO DFHEIV0(25:11)
  6243     CALL 'kxdfhei1' USING DFHEIV0,
  6244           MAP-NAME,
  6245           EL154AI,
  6246           DFHEIV11,
  6247           MAPSET-NAME,
  6248           DFHEIV99,
  6249           DFHEIV99
  6250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6251
  6252
  6253     IF ENTERPFL = 0
  6254         GO TO 0300-CHECK-PFKEYS.
  6255     IF EIBAID NOT = DFHENTER
  6256         MOVE ER-0004 TO EMI-ERROR
  6257         GO TO 0320-INPUT-ERROR.
  6258
  6259     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  6260         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  6261     ELSE
  6262         MOVE ER-0029 TO EMI-ERROR
  6263         GO TO 0320-INPUT-ERROR.
  6264
  6265 0300-CHECK-PFKEYS.
  6266
  6267     IF EIBAID = DFHPF23
  6268         GO TO 8810-PF23.
  6269     IF EIBAID = DFHPF24
  6270         GO TO 9200-RETURN-MAIN-MENU.
  6271     IF EIBAID = DFHPF12
  6272         GO TO 9500-PF12.
  6273     IF EIBAID EQUAL DFHPF1
  6274        GO TO 0400-PAGE-FORWARD.
  6275     IF EIBAID EQUAL DFHPF2
  6276        GO TO 0700-PAGE-BACKWARD.
  6277     IF EIBAID EQUAL DFHPF3
  6278        MOVE CURRENT-BIN-DATE TO CURRENT-SAVE
  6279        IF TERMI = 'A'
  6280            GO TO 2000-ADD-ONLY
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 118
* EL154.cbl
  6281        ELSE
  6282        IF TERMI = 'N'
  6283            GO TO 3000-TERMINATE-AND-GENERATE.
  6284     IF (TERML NOT = 0) AND (EIBAID NOT = DFHENTER)
  6285         MOVE ER-0050 TO EMI-ERROR
  6286         GO TO 0320-INPUT-ERROR.
  6287     IF EIBAID = DFHENTER
  6288         GO TO 0330-EDIT-DATA.
  6289
  6290     MOVE ER-0029 TO EMI-ERROR.
  6291 0320-INPUT-ERROR.
  6292     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6293     MOVE AL-UNBON TO ENTERPFA.
  6294     IF ENTERPFL = 0
  6295         MOVE -1 TO TERML
  6296     ELSE
  6297         MOVE -1 TO ENTERPFL.
  6298
  6299     GO TO 8200-SEND-DATAONLY.
  6300
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 119
* EL154.cbl
  6302 0330-EDIT-DATA.
  6303     IF NOT MODIFY-CAP
  6304           MOVE ER-0070          TO EMI-ERROR
  6305           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6306           MOVE LOW-VALUES       TO EL154AO
  6307           GO TO 8100-SEND-INITIAL-MAP.
  6308
  6309     MOVE CURRENT-BIN-DATE       TO CURRENT-SAVE
  6310
  6311     IF TERMI = 'Y'
  6312         GO TO 1000-DELETE-CURRENT.
  6313     IF TERMI = 'A'
  6314         GO TO 2000-ADD-ONLY.
  6315     IF TERMI = 'N'
  6316         GO TO 3000-TERMINATE-AND-GENERATE.
  6317     MOVE ER-0347                TO EMI-ERROR.
  6318     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6319     MOVE -1                     TO TERML.
  6320     MOVE AL-UABON               TO TERMA.
  6321     GO TO 8200-SEND-DATAONLY.
  6322
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 120
* EL154.cbl
  6324 0400-PAGE-FORWARD.
  6325
  6326* EXEC CICS HANDLE CONDITION
  6327*         NOTFND    (8850-CLAM-END-FILE)
  6328*         ENDFILE   (8850-CLAM-END-FILE)
  6329*    END-EXEC.
  6330*    MOVE '"$I''                  ! # #00006282' TO DFHEIV0
  6331     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6332     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6333     MOVE X'2320233030303036323832' TO DFHEIV0(25:11)
  6334     CALL 'kxdfhei1' USING DFHEIV0
  6335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6336
  6337
  6338     MOVE PI-CARRIER      TO CLAM-CARRIER
  6339     MOVE PI-COMPANY-CD   TO CLAM-CO
  6340     MOVE PI-CLAIM-NO     TO CLAM-CLAIM
  6341     MOVE PI-CERT-NO      TO CLAM-CERT-NUM
  6342     MOVE CLAM-KEY        TO CLAIM-SAVE-KEY.
  6343
  6344
  6345* EXEC CICS STARTBR
  6346*         DATASET   ('ELMSTR')
  6347*         RIDFLD    (CLAM-KEY)
  6348*    END-EXEC.
  6349     MOVE 'ELMSTR' TO DFHEIV1
  6350     MOVE 0
  6351       TO DFHEIV11
  6352*    MOVE '&,         G          &   #00006293' TO DFHEIV0
  6353     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6354     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6355     MOVE X'2020233030303036323933' TO DFHEIV0(25:11)
  6356     CALL 'kxdfhei1' USING DFHEIV0,
  6357           DFHEIV1,
  6358           CLAM-KEY,
  6359           DFHEIV99,
  6360           DFHEIV11,
  6361           DFHEIV99
  6362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6363
  6364
  6365 0450-READ-NEXT-CLAIM.
  6366
  6367
  6368* EXEC CICS READNEXT
  6369*         DATASET   ('ELMSTR')
  6370*         RIDFLD    (CLAM-KEY)
  6371*         SET       (ADDRESS OF CLAIM-MASTER)
  6372*    END-EXEC.
  6373     MOVE 'ELMSTR' TO DFHEIV1
  6374     MOVE 0
  6375       TO DFHEIV11
  6376*    MOVE '&.S                   )   #00006300' TO DFHEIV0
  6377     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6378     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6379     MOVE X'2020233030303036333030' TO DFHEIV0(25:11)
  6380     CALL 'kxdfhei1' USING DFHEIV0,
  6381           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 121
* EL154.cbl
  6382           DFHEIV20,
  6383           DFHEIV99,
  6384           CLAM-KEY,
  6385           DFHEIV99,
  6386           DFHEIV11,
  6387           DFHEIV99,
  6388           DFHEIV99
  6389     SET ADDRESS OF CLAIM-MASTER TO
  6390         DFHEIV20
  6391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6392
  6393
  6394     IF PI-COMPANY-CD NOT EQUAL CLAM-CO
  6395        GO TO 8850-CLAM-END-FILE.
  6396
  6397     IF CLAM-KEY EQUAL CLAIM-SAVE-KEY
  6398        GO TO 0450-READ-NEXT-CLAIM.
  6399
  6400     IF PI-CARRIER-SECURITY GREATER SPACES
  6401         IF CL-CERT-CARRIER NOT = PI-CARRIER-SECURITY
  6402             GO TO 0450-READ-NEXT-CLAIM.
  6403
  6404     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6405         IF CL-CERT-ACCOUNT NOT = PI-ACCOUNT-SECURITY
  6406             GO TO 0450-READ-NEXT-CLAIM.
  6407
  6408     IF CL-CLAIM-TYPE IS EQUAL TO PI-LIFE-OVERRIDE-L1
  6409         GO TO 0450-READ-NEXT-CLAIM.
  6410
  6411     MOVE CL-CLAIM-NO         TO PI-CLAIM-NO.
  6412     MOVE CL-CERT-CARRIER     TO PI-CARRIER
  6413     MOVE CL-CERT-GROUPING    TO PI-GROUPING
  6414     MOVE CL-CERT-STATE       TO PI-STATE
  6415     MOVE CL-CERT-ACCOUNT     TO PI-ACCOUNT
  6416     MOVE CL-CERT-EFF-DT      TO PI-CERT-EFF-DT
  6417     MOVE CL-CERT-NO          TO PI-CERT-NO
  6418
  6419     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  6420         MOVE CL-CV-REFERENCE-NO TO  PI-MP-REFERENCE-NO.
  6421
  6422
  6423* EXEC CICS ENDBR
  6424*         DATASET    ('ELMSTR')
  6425*    END-EXEC.
  6426     MOVE 'ELMSTR' TO DFHEIV1
  6427     MOVE 0
  6428       TO DFHEIV11
  6429*    MOVE '&2                    $   #00006334' TO DFHEIV0
  6430     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6431     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6432     MOVE X'2020233030303036333334' TO DFHEIV0(25:11)
  6433     CALL 'kxdfhei1' USING DFHEIV0,
  6434           DFHEIV1,
  6435           DFHEIV11,
  6436           DFHEIV99
  6437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6438
  6439
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 122
* EL154.cbl
  6440     MOVE LOW-VALUES TO EL154AO.
  6441     GO TO 7000-BUILD-SCREEN.
  6442
  6443 0700-PAGE-BACKWARD.
  6444
  6445
  6446* EXEC CICS HANDLE CONDITION
  6447*         NOTFND    (8850-CLAM-END-FILE)
  6448*         ENDFILE   (8850-CLAM-END-FILE)
  6449*    END-EXEC.
  6450*    MOVE '"$I''                  ! $ #00006343' TO DFHEIV0
  6451     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6453     MOVE X'2420233030303036333433' TO DFHEIV0(25:11)
  6454     CALL 'kxdfhei1' USING DFHEIV0
  6455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6456
  6457
  6458     MOVE PI-CARRIER      TO CLAM-CARRIER
  6459     MOVE PI-COMPANY-CD   TO CLAM-CO
  6460     MOVE PI-CLAIM-NO     TO CLAM-CLAIM
  6461     MOVE PI-CERT-NO      TO CLAM-CERT-NUM
  6462     MOVE CLAM-KEY        TO CLAIM-SAVE-KEY.
  6463
  6464
  6465* EXEC CICS STARTBR
  6466*         DATASET   ('ELMSTR')
  6467*         RIDFLD    (CLAM-KEY)
  6468*    END-EXEC.
  6469     MOVE 'ELMSTR' TO DFHEIV1
  6470     MOVE 0
  6471       TO DFHEIV11
  6472*    MOVE '&,         G          &   #00006354' TO DFHEIV0
  6473     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6474     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6475     MOVE X'2020233030303036333534' TO DFHEIV0(25:11)
  6476     CALL 'kxdfhei1' USING DFHEIV0,
  6477           DFHEIV1,
  6478           CLAM-KEY,
  6479           DFHEIV99,
  6480           DFHEIV11,
  6481           DFHEIV99
  6482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6483
  6484
  6485 0750-READ-PREV-CLAIM.
  6486
  6487
  6488* EXEC CICS READPREV
  6489*         DATASET   ('ELMSTR')
  6490*         RIDFLD    (CLAM-KEY)
  6491*         SET       (ADDRESS OF CLAIM-MASTER)
  6492*    END-EXEC.
  6493     MOVE 'ELMSTR' TO DFHEIV1
  6494     MOVE 0
  6495       TO DFHEIV11
  6496*    MOVE '&0S                   )   #00006361' TO DFHEIV0
  6497     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 123
* EL154.cbl
  6498     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6499     MOVE X'2020233030303036333631' TO DFHEIV0(25:11)
  6500     CALL 'kxdfhei1' USING DFHEIV0,
  6501           DFHEIV1,
  6502           DFHEIV20,
  6503           DFHEIV99,
  6504           CLAM-KEY,
  6505           DFHEIV99,
  6506           DFHEIV11,
  6507           DFHEIV99,
  6508           DFHEIV99
  6509     SET ADDRESS OF CLAIM-MASTER TO
  6510         DFHEIV20
  6511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6512
  6513
  6514     IF PI-COMPANY-CD NOT EQUAL CLAM-CO
  6515        GO TO 8850-CLAM-END-FILE.
  6516
  6517     IF CLAM-KEY EQUAL CLAIM-SAVE-KEY
  6518        GO TO 0750-READ-PREV-CLAIM.
  6519
  6520     IF PI-CARRIER-SECURITY GREATER SPACES
  6521         IF CL-CERT-CARRIER NOT = PI-CARRIER-SECURITY
  6522             GO TO 0750-READ-PREV-CLAIM.
  6523
  6524     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6525         IF CL-CERT-ACCOUNT NOT = PI-ACCOUNT-SECURITY
  6526             GO TO 0750-READ-PREV-CLAIM.
  6527
  6528     IF CL-CLAIM-TYPE IS EQUAL TO PI-LIFE-OVERRIDE-L1
  6529         GO TO 0750-READ-PREV-CLAIM.
  6530
  6531     MOVE CL-CLAIM-NO         TO PI-CLAIM-NO.
  6532     MOVE CL-CERT-CARRIER     TO PI-CARRIER
  6533     MOVE CL-CERT-GROUPING    TO PI-GROUPING
  6534     MOVE CL-CERT-STATE       TO PI-STATE
  6535     MOVE CL-CERT-ACCOUNT     TO PI-ACCOUNT
  6536     MOVE CL-CERT-EFF-DT      TO PI-CERT-EFF-DT
  6537     MOVE CL-CERT-NO          TO PI-CERT-NO
  6538
  6539     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  6540         MOVE CL-CV-REFERENCE-NO TO  PI-MP-REFERENCE-NO.
  6541
  6542
  6543* EXEC CICS ENDBR
  6544*         DATASET    ('ELMSTR')
  6545*    END-EXEC.
  6546     MOVE 'ELMSTR' TO DFHEIV1
  6547     MOVE 0
  6548       TO DFHEIV11
  6549*    MOVE '&2                    $   #00006395' TO DFHEIV0
  6550     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6551     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6552     MOVE X'2020233030303036333935' TO DFHEIV0(25:11)
  6553     CALL 'kxdfhei1' USING DFHEIV0,
  6554           DFHEIV1,
  6555           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 124
* EL154.cbl
  6556           DFHEIV99
  6557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6558
  6559
  6560     MOVE LOW-VALUES TO EL154AO.
  6561     GO TO 7000-BUILD-SCREEN.
  6562
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 125
* EL154.cbl
  6564 1000-DELETE-CURRENT.
  6565     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6566     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6567
  6568     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  6569     PERFORM 4000-DELETE-AUTO-PAY THRU 4099-EXIT.
  6570     MOVE ZEROS                  TO CL-AUTO-PAY-SEQ.
  6571     MOVE LOW-VALUES             TO CL-NEXT-AUTO-PAY-DT.
  6572
  6573     PERFORM 7100-CHECK-AUTO-ACTIVITY THRU 7100-EXIT.
  6574
  6575     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6576
  6577     MOVE SPACES TO WS-END-LETTER-FORM-NUM.
  6578*    IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6579     IF PRINTL IS GREATER THAN +0
  6580         MOVE PRINTI   TO PI-AUTO-END-LETTER
  6581     END-IF.
  6582     IF PI-AUTO-END-LETTER IS GREATER THAN SPACES
  6583         IF PI-AUTO-END-LETTER IS EQUAL TO 'N   '
  6584             GO TO 1000-FINISH-DELETE
  6585         ELSE
  6586             MOVE PI-AUTO-END-LETTER TO WS-END-LETTER-FORM-NUM
  6587             MOVE 'Y'    TO WS-ACT-REC-FOUND-SW
  6588                            WS-LETTER-SW
  6589         END-IF
  6590     END-IF.
  6591
  6592     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6593         IF WS-LETTER-SW IS EQUAL TO 'Y'
  6594             PERFORM 7150-CREATE-AUTO-LETTER THRU 7150-EXIT.
  6595
  6596 1000-FINISH-DELETE.
  6597
  6598     IF EMI-NO-ERRORS
  6599         GO TO 8200-SEND-DATAONLY.
  6600
  6601     MOVE LOW-VALUES             TO EL154AO.
  6602     MOVE -1                     TO TERML.
  6603     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 126
* EL154.cbl
  6605 2000-ADD-ONLY.
  6606     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6607     PERFORM 5900-VERIFY-ALL-FIELDS THRU 5999-EXIT.
  6608     IF NOT EMI-NO-ERRORS
  6609        GO TO 8200-SEND-DATAONLY.
  6610
  6611     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6612     PERFORM 6000-EDIT-INPUT-DATA THRU 6300-EXIT.
  6613     IF NOT EMI-NO-ERRORS
  6614         GO TO 8200-SEND-DATAONLY.
  6615
  6616     IF CL-AUTO-PAY-SEQ  NOT = ZEROS
  6617        MOVE ER-0372             TO EMI-ERROR
  6618        MOVE -1                  TO NEFFDTEL
  6619        MOVE AL-UABON            TO NEFFDTEA
  6620        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6621        GO TO 8200-SEND-DATAONLY.
  6622
  6623     PERFORM 6400-PAYMENT-CALCULATION  THRU 6499-EXIT.
  6624
  6625     IF NFSTAMT-SAVE IS EQUAL TO +0
  6626         MOVE ER-0350            TO  EMI-ERROR
  6627         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6628         MOVE -1                 TO  NFSTAMTL
  6629         MOVE AL-UNBON           TO  NFSTAMTA
  6630         GO TO 8200-SEND-DATAONLY.
  6631
  6632     IF EIBAID NOT = DFHPF3
  6633         GO TO 3500-CONFIRM-DATA.
  6634
  6635
  6636* EXEC CICS HANDLE CONDITION
  6637*        NOTOPEN(8870-ACTV-NOT-OPEN)
  6638*        END-EXEC.
  6639*    MOVE '"$J                   ! % #00006474' TO DFHEIV0
  6640     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  6641     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6642     MOVE X'2520233030303036343734' TO DFHEIV0(25:11)
  6643     CALL 'kxdfhei1' USING DFHEIV0
  6644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6645
  6646
  6647     PERFORM 4100-BUILD-AUTO-PAY THRU 4199-EXIT.
  6648
  6649     PERFORM 7100-CHECK-AUTO-ACTIVITY THRU 7100-EXIT.
  6650
  6651     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6652
  6653     MOVE SPACES TO WS-LETTER-FORM-NUM.
  6654*     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6655         IF NPRINTL IS GREATER THAN +0
  6656            IF NPRINTI IS EQUAL TO 'N   '
  6657                GO TO 2000-FINISH-ADD
  6658            ELSE
  6659                MOVE NPRINTI TO WS-LETTER-FORM-NUM
  6660                MOVE 'Y' TO WS-ACT-REC-FOUND-SW
  6661                            WS-LETTER-SW.
  6662
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 127
* EL154.cbl
  6663     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6664         IF WS-LETTER-SW IS EQUAL TO 'Y'
  6665             PERFORM 7150-CREATE-AUTO-LETTER THRU 7150-EXIT.
  6666
  6667 2000-FINISH-ADD.
  6668
  6669     IF EMI-NO-ERRORS
  6670         GO TO 8200-SEND-DATAONLY.
  6671
  6672     MOVE LOW-VALUES             TO EL154AO.
  6673     GO TO 7000-BUILD-SCREEN.
  6674
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 128
* EL154.cbl
  6676 3000-TERMINATE-AND-GENERATE.
  6677     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6678     PERFORM 5900-VERIFY-ALL-FIELDS THRU 5999-EXIT.
  6679     IF NOT EMI-NO-ERRORS
  6680         GO TO 8200-SEND-DATAONLY.
  6681
  6682     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6683     PERFORM 6000-EDIT-INPUT-DATA THRU 6300-EXIT.
  6684     IF NOT EMI-NO-ERRORS
  6685         GO TO 8200-SEND-DATAONLY.
  6686
  6687     PERFORM 6400-PAYMENT-CALCULATION THRU 6499-EXIT.
  6688
  6689     IF EIBAID NOT = DFHPF3
  6690         GO TO 3500-CONFIRM-DATA.
  6691
  6692     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  6693     PERFORM 4000-DELETE-AUTO-PAY THRU 4099-EXIT.
  6694
  6695     PERFORM 4100-BUILD-AUTO-PAY  THRU 4199-EXIT.
  6696
  6697     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6698
  6699     IF EMI-NO-ERRORS
  6700         GO TO 8200-SEND-DATAONLY.
  6701
  6702     MOVE LOW-VALUES TO EL154AO.
  6703     GO TO 7000-BUILD-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 129
* EL154.cbl
  6705 3500-CONFIRM-DATA.
  6706
  6707     MOVE -1                     TO  ENTERPFL.
  6708     MOVE ER-0670                TO  EMI-ERROR.
  6709     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6710     GO TO 8200-SEND-DATAONLY.
  6711
  6712 4000-DELETE-AUTO-PAY.
  6713
  6714* EXEC CICS HANDLE CONDITION
  6715*        NOTOPEN(8870-ACTV-NOT-OPEN)
  6716*        NOTFND(4099-EXIT)
  6717*        END-EXEC.
  6718*    MOVE '"$JI                  ! & #00006544' TO DFHEIV0
  6719     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  6720     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6721     MOVE X'2620233030303036353434' TO DFHEIV0(25:11)
  6722     CALL 'kxdfhei1' USING DFHEIV0
  6723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6724
  6725
  6726
  6727* EXEC CICS READ
  6728*        UPDATE
  6729*        DATASET(ACTV-ID)
  6730*        SET(ADDRESS OF ACTIVITY-TRAILERS)
  6731*        RIDFLD(ACTV-KEY)
  6732*        END-EXEC.
  6733*    MOVE '&"S        EU         (   #00006549' TO DFHEIV0
  6734     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6735     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6736     MOVE X'2020233030303036353439' TO DFHEIV0(25:11)
  6737     CALL 'kxdfhei1' USING DFHEIV0,
  6738           ACTV-ID,
  6739           DFHEIV20,
  6740           DFHEIV99,
  6741           ACTV-KEY,
  6742           DFHEIV99,
  6743           DFHEIV99,
  6744           DFHEIV99
  6745     SET ADDRESS OF ACTIVITY-TRAILERS TO
  6746         DFHEIV20
  6747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6748
  6749
  6750     IF PRINTL > ZEROS
  6751         MOVE PRINTI             TO AT-AUTO-END-LETTER
  6752     END-IF.
  6753
  6754     MOVE CURRENT-SAVE           TO AT-TERMINATED-DT
  6755                                    AT-AUTO-PAY-LAST-MAINT-DT
  6756     MOVE PI-PROCESSOR-ID        TO AT-AUTO-PAY-LAST-UPDATED-BY
  6757     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  6758
  6759* EXEC CICS REWRITE
  6760*        DATASET(ACTV-ID)
  6761*        FROM(ACTIVITY-TRAILERS)
  6762*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 130
* EL154.cbl
  6763     MOVE LENGTH OF
  6764      ACTIVITY-TRAILERS
  6765       TO DFHEIV11
  6766*    MOVE '&& L                  %   #00006564' TO DFHEIV0
  6767     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6768     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6769     MOVE X'2020233030303036353634' TO DFHEIV0(25:11)
  6770     CALL 'kxdfhei1' USING DFHEIV0,
  6771           ACTV-ID,
  6772           ACTIVITY-TRAILERS,
  6773           DFHEIV11,
  6774           DFHEIV99
  6775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6776
  6777
  6778 4099-EXIT.
  6779      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 131
* EL154.cbl
  6781 4100-BUILD-AUTO-PAY.
  6782******************************************************************
  6783*               CREATE AUTO PAY TRAILER
  6784******************************************************************
  6785
  6786     SUBTRACT 1                  FROM CL-TRAILER-SEQ-CNT.
  6787     MOVE CL-TRAILER-SEQ-CNT     TO ACTV-SEQ
  6788                                    CL-AUTO-PAY-SEQ.
  6789
  6790* EXEC CICS GETMAIN
  6791*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  6792*         LENGTH    (TRLR-LENGTH)
  6793*         INITIMG   (GETMAIN-SPACE)
  6794*    END-EXEC.
  6795*    MOVE ',"IL                  $   #00006580' TO DFHEIV0
  6796     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6797     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6798     MOVE X'2020233030303036353830' TO DFHEIV0(25:11)
  6799     CALL 'kxdfhei1' USING DFHEIV0,
  6800           DFHEIV20,
  6801           TRLR-LENGTH,
  6802           GETMAIN-SPACE
  6803     SET ADDRESS OF ACTIVITY-TRAILERS TO
  6804         DFHEIV20
  6805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6806
  6807
  6808     MOVE ZEROS                  TO AT-DAYS-IN-REG-PMT.
  6809     MOVE NEFFDTE-SAVE           TO AT-SCHEDULE-START-DT.
  6810     MOVE NFSTPMT-SAVE           TO AT-1ST-PAY-THRU-DT
  6811                                    CL-NEXT-AUTO-PAY-DT.
  6812     MOVE DAYPAYI                TO AT-AUTO-PAY-DAY.
  6813     MOVE NLSTPMT-SAVE           TO AT-SCHEDULE-END-DT.
  6814     MOVE NFSTAMT-SAVE           TO AT-FIRST-PMT-AMT.
  6815     MOVE NDAYSFI                TO AT-DAYS-IN-1ST-PMT.
  6816
  6817*    IF PI-USES-PAID-TO
  6818*        MOVE NFSTPMT-SAVE       TO  DC-BIN-DATE-1
  6819*        MOVE '6'                TO  DC-OPTION-CODE
  6820*        MOVE -1                 TO  DC-ELAPSED-DAYS
  6821*        MOVE +0                 TO  DC-ELAPSED-MONTHS
  6822*        PERFORM 9700-DATE-LINK
  6823*        IF NO-CONVERSION-ERROR
  6824*            MOVE DC-BIN-DATE-2  TO  AT-1ST-PAY-THRU-DT
  6825*                                    CL-NEXT-AUTO-PAY-DT
  6826*        ELSE
  6827*            MOVE LOW-VALUES     TO  AT-1ST-PAY-THRU-DT
  6828*                                    CL-NEXT-AUTO-PAY-DT
  6829*    ELSE
  6830*        MOVE NFSTPMT-SAVE       TO  AT-1ST-PAY-THRU-DT
  6831*                                    CL-NEXT-AUTO-PAY-DT.
  6832
  6833*    IF PI-USES-PAID-TO
  6834*        MOVE NLSTPMT-SAVE       TO  DC-BIN-DATE-1
  6835*        MOVE '6'                TO  DC-OPTION-CODE
  6836*        MOVE -1                 TO  DC-ELAPSED-DAYS
  6837*        MOVE +0                 TO  DC-ELAPSED-MONTHS
  6838*        PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 132
* EL154.cbl
  6839*        IF NO-CONVERSION-ERROR
  6840*            MOVE DC-BIN-DATE-2  TO  AT-SCHEDULE-END-DT
  6841*        ELSE
  6842*            MOVE LOW-VALUES     TO  AT-SCHEDULE-END-DT
  6843*    ELSE
  6844*        MOVE NLSTPMT-SAVE       TO  AT-SCHEDULE-END-DT.
  6845
  6846     IF NLASTI = 'Y'
  6847        MOVE 'F'                 TO AT-LAST-PMT-TYPE
  6848     ELSE
  6849        MOVE 'P'                 TO AT-LAST-PMT-TYPE.
  6850
  6851     MOVE NMONTHSI               TO AT-INTERVAL-MONTHS.
  6852     MOVE NREGPMT-SAVE           TO AT-REGULAR-PMT-AMT.
  6853
  6854     MOVE WS-PAYEE-CODE          TO AT-AUTO-PAYEE-CD.
  6855
  6856     IF NINDCTRI    IS EQUAL TO  'N'
  6857         MOVE 'N'                TO AT-AUTO-CASH
  6858     ELSE
  6859         MOVE 'Y'                TO AT-AUTO-CASH.
  6860
  6861     MOVE ENDLETTI               TO AT-AUTO-END-LETTER.
  6862
  6863     IF PI-COMPANY-ID = 'CSL'
  6864        IF PI-CARRIER = 'A' OR 'B' OR 'C' OR '1' OR '2' OR
  6865                        '3' OR '4'
  6866         INSPECT AT-AUTO-PAYEE-CD CONVERTING 'IBA' TO 'IOA'.
  6867
  6868     MOVE LOW-VALUE              TO AT-TERMINATED-DT.
  6869     MOVE 'AT'                   TO AT-RECORD-ID.
  6870     MOVE  3                     TO AT-TRAILER-TYPE.
  6871     MOVE CURRENT-SAVE           TO AT-RECORDED-DT
  6872                                    AT-AUTO-PAY-LAST-MAINT-DT
  6873     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  6874                                    AT-AUTO-PAY-LAST-UPDATED-BY
  6875     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  6876     MOVE ACTV-KEY               TO AT-CONTROL-PRIMARY.
  6877
  6878
  6879* EXEC CICS WRITE
  6880*         DATASET(ACTV-ID)
  6881*         FROM   (ACTIVITY-TRAILERS)
  6882*         RIDFLD (AT-CONTROL-PRIMARY)
  6883*         END-EXEC.
  6884     MOVE LENGTH OF
  6885      ACTIVITY-TRAILERS
  6886       TO DFHEIV11
  6887*    MOVE '&$ L                  ''   #00006656' TO DFHEIV0
  6888     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6889     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6890     MOVE X'2020233030303036363536' TO DFHEIV0(25:11)
  6891     CALL 'kxdfhei1' USING DFHEIV0,
  6892           ACTV-ID,
  6893           ACTIVITY-TRAILERS,
  6894           DFHEIV11,
  6895           AT-CONTROL-PRIMARY,
  6896           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 133
* EL154.cbl
  6897           DFHEIV99
  6898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6899
  6900
  6901 4199-EXIT.
  6902      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 134
* EL154.cbl
  6904 5000-READ-CLAIM.
  6905
  6906* EXEC CICS READ
  6907*        UPDATE
  6908*        DATASET(CLAM-ID)
  6909*        SET    (ADDRESS OF CLAIM-MASTER)
  6910*        RIDFLD (CLAM-KEY)
  6911*        END-EXEC.
  6912*    MOVE '&"S        EU         (   #00006666' TO DFHEIV0
  6913     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6914     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6915     MOVE X'2020233030303036363636' TO DFHEIV0(25:11)
  6916     CALL 'kxdfhei1' USING DFHEIV0,
  6917           CLAM-ID,
  6918           DFHEIV20,
  6919           DFHEIV99,
  6920           CLAM-KEY,
  6921           DFHEIV99,
  6922           DFHEIV99,
  6923           DFHEIV99
  6924     SET ADDRESS OF CLAIM-MASTER TO
  6925         DFHEIV20
  6926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6927
  6928
  6929 5099-EXIT.
  6930      EXIT.
  6931
  6932 5200-REWRITE.
  6933
  6934* EXEC CICS HANDLE CONDITION
  6935*        DUPKEY
  6936*        END-EXEC.
  6937*    MOVE '"$                   ! '' #00006677' TO DFHEIV0
  6938     MOVE X'222494202020202020202020' TO DFHEIV0(1:12)
  6939     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6940     MOVE X'2720233030303036363737' TO DFHEIV0(25:11)
  6941     CALL 'kxdfhei1' USING DFHEIV0
  6942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6943
  6944
  6945     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
  6946     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
  6947     MOVE CURRENT-SAVE           TO CL-LAST-MAINT-DT.
  6948
  6949* EXEC CICS REWRITE
  6950*        DATASET(CLAM-ID)
  6951*        FROM   (CLAIM-MASTER)
  6952*        END-EXEC.
  6953     MOVE LENGTH OF
  6954      CLAIM-MASTER
  6955       TO DFHEIV11
  6956*    MOVE '&& L                  %   #00006684' TO DFHEIV0
  6957     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6958     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6959     MOVE X'2020233030303036363834' TO DFHEIV0(25:11)
  6960     CALL 'kxdfhei1' USING DFHEIV0,
  6961           CLAM-ID,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 135
* EL154.cbl
  6962           CLAIM-MASTER,
  6963           DFHEIV11,
  6964           DFHEIV99
  6965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6966
  6967
  6968*    MOVE 1                      TO EMI-NUMBER-OF-LINES.
  6969     MOVE ER-0000                TO EMI-ERROR.
  6970     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6971
  6972 5299-EXIT.
  6973      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 136
* EL154.cbl
  6975 5900-VERIFY-ALL-FIELDS.
  6976******************************************************************
  6977*       PRELIMINARY EDITS TO VERIFY THAT THE REQUIRED FIELDS     *
  6978*       HAVE DATA ENTERED IN THEM                                *
  6979******************************************************************
  6980
  6981     IF DAYPAYL EQUAL +0
  6982        MOVE ZEROS TO DAYPAYI.
  6983
  6984     IF NEFFDTEL EQUAL +0
  6985        MOVE LOW-VALUES TO NEFFDTEI.
  6986
  6987     IF NFSTAMTL EQUAL +0
  6988        MOVE ZEROS TO NFSTAMTI
  6989                      NFSTAMTO.
  6990
  6991     IF NDAYSFL EQUAL +0
  6992        MOVE ZEROS TO NDAYSFI.
  6993
  6994     IF NFSTAMTL EQUAL +0
  6995        IF NDAYSFL NOT EQUAL +0
  6996           MOVE +0        TO NDAYSFL
  6997           MOVE ZEROS     TO NDAYSFI.
  6998
  6999     IF NMONTHSL = ZEROS
  7000        MOVE -1                  TO NMONTHSL
  7001        GO TO 5910-REQUIRED-ERROR.
  7002
  7003     IF NFSTPMTL = ZEROS
  7004        MOVE -1                  TO NFSTPMTL
  7005        GO TO 5910-REQUIRED-ERROR.
  7006
  7007     IF NLSTPMTL = ZEROS
  7008        MOVE -1                  TO NLSTPMTL
  7009        GO TO 5910-REQUIRED-ERROR.
  7010
  7011     IF NLASTL = ZEROS
  7012        MOVE -1                  TO NLASTL
  7013        GO TO 5910-REQUIRED-ERROR.
  7014
  7015     IF NPAYEEL = ZEROS
  7016        MOVE -1                  TO NPAYEEL
  7017        GO TO 5910-REQUIRED-ERROR.
  7018
  7019     IF LETTDTEL EQUAL +0
  7020        MOVE LOW-VALUES TO LETTDTEI.
  7021
  7022     IF (PI-COMPANY-ID  =  'AIG' OR  'AUK') AND
  7023        (NINDCTRL =  ZEROS)
  7024           MOVE -1               TO NINDCTRL
  7025           GO TO 5910-REQUIRED-ERROR.
  7026
  7027     GO TO 5999-EXIT.
  7028
  7029 5910-REQUIRED-ERROR.
  7030     MOVE ER-0358                TO EMI-ERROR.
  7031     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7032
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 137
* EL154.cbl
  7033 5999-EXIT.
  7034      EXIT.
  7035
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 138
* EL154.cbl
  7037 6000-EDIT-INPUT-DATA.
  7038******************************************************
  7039*    IF THE EFFECTIVE OR "PAID FROM" WAS NOT         *
  7040*    ENTERED, THEN USE THE INCURRED OR LAST PAID     *
  7041*    THRU DATE                                       *
  7042******************************************************
  7043
  7044     MOVE SPACES TO WS-ELIMINATION-SW.
  7045
  7046     IF NEFFDTEL NOT = ZEROS
  7047        MOVE NEFFDTEI            TO DEEDIT-FIELD
  7048        PERFORM 8600-DEEDIT
  7049        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7050        MOVE '4'                 TO DC-OPTION-CODE
  7051        PERFORM 9700-DATE-LINK
  7052        IF DATE-CONVERSION-ERROR
  7053           MOVE ER-0348          TO EMI-ERROR
  7054           MOVE -1               TO NEFFDTEL
  7055           MOVE AL-UABON         TO NEFFDTEA
  7056           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7057        ELSE
  7058           MOVE DEEDIT-FIELD-V0  TO NEFFDTEO
  7059           INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7060           MOVE AL-UANON         TO NEFFDTEA
  7061           MOVE DC-BIN-DATE-1    TO NEFFDTE-SAVE
  7062     ELSE
  7063        IF CL-PAID-THRU-DT EQUAL LOW-VALUES
  7064           MOVE 'N' TO WS-ELIMINATION-SW
  7065           MOVE CL-INCURRED-DT TO NEFFDTE-SAVE
  7066                                  DC-BIN-DATE-1
  7067           MOVE ' ' TO DC-OPTION-CODE
  7068           PERFORM 9700-DATE-LINK
  7069           IF NO-CONVERSION-ERROR
  7070              MOVE DC-GREG-DATE-1-MDY  TO NEFFDTEO
  7071              INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7072           ELSE
  7073              MOVE LOW-VALUES TO NEFFDTE-SAVE
  7074        ELSE
  7075           MOVE CL-PAID-THRU-DT TO DC-BIN-DATE-1
  7076           MOVE +1 TO DC-ELAPSED-DAYS
  7077           MOVE +0 TO DC-ELAPSED-MONTHS
  7078           MOVE '6' TO DC-OPTION-CODE
  7079           PERFORM 9700-DATE-LINK
  7080           IF NO-CONVERSION-ERROR
  7081              MOVE DC-BIN-DATE-2 TO NEFFDTE-SAVE
  7082              MOVE DC-GREG-DATE-1-MDY  TO NEFFDTEO
  7083              INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7084           ELSE
  7085              MOVE LOW-VALUES TO NEFFDTE-SAVE.
  7086
  7087******************************************************************
  7088*       EDIT FIRST PAY THRU/TO DATE.  IF THE "PAY TO" OPTION ON
  7089*       THE COMPANY CONTROL IS SET, THE FIRST PAYMENT SAVE DATE
  7090*       IS SET BACK MINUS 1 DAY FOR PROCESSING.
  7091******************************************************************
  7092
  7093     IF NFSTPMTL NOT = ZEROS
  7094        MOVE NFSTPMTI            TO DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 139
* EL154.cbl
  7095        PERFORM 8600-DEEDIT
  7096        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7097        MOVE '4'                 TO DC-OPTION-CODE
  7098        PERFORM 9700-DATE-LINK
  7099        IF DATE-CONVERSION-ERROR
  7100           MOVE ER-0349          TO EMI-ERROR
  7101           MOVE -1               TO NFSTPMTL
  7102           MOVE AL-UABON         TO NFSTPMTA
  7103           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7104          ELSE
  7105           MOVE DEEDIT-FIELD-V0  TO NFSTPMTO
  7106           INSPECT NFSTPMTI CONVERTING SPACES TO '/'
  7107           MOVE AL-UANON         TO NFSTPMTA.
  7108*          MOVE DC-BIN-DATE-1    TO NFSTPMT-SAVE.
  7109
  7110     IF PI-USES-PAID-TO
  7111         MOVE '6'                TO  DC-OPTION-CODE
  7112         MOVE -1                 TO  DC-ELAPSED-DAYS
  7113         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7114         PERFORM 9700-DATE-LINK
  7115         IF NO-CONVERSION-ERROR
  7116             MOVE DC-BIN-DATE-2  TO  NFSTPMT-SAVE
  7117         ELSE
  7118             MOVE ER-0349        TO  EMI-ERROR
  7119             MOVE -1             TO  NFSTPMTL
  7120             MOVE AL-UABON       TO  NFSTPMTA
  7121             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7122     ELSE
  7123         MOVE DC-BIN-DATE-1      TO  NFSTPMT-SAVE.
  7124
  7125******************************************************************
  7126*       EDIT LAST PAY THRU/TO DATE.  IF THE "PAY TO" OPTION ON
  7127*       THE COMPANY CONTROL IS SET, THE FIRST PAYMENT SAVE DATE
  7128*       IS SET BACK MINUS 1 DAY FOR PROCESSING.
  7129******************************************************************
  7130
  7131     IF NLSTPMTL NOT = ZEROS
  7132        MOVE NLSTPMTI            TO DEEDIT-FIELD
  7133        PERFORM 8600-DEEDIT
  7134        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7135        MOVE '4'                 TO DC-OPTION-CODE
  7136        PERFORM 9700-DATE-LINK
  7137        IF DATE-CONVERSION-ERROR
  7138           MOVE ER-0354          TO EMI-ERROR
  7139           MOVE -1               TO NLSTPMTL
  7140           MOVE AL-UABON         TO NLSTPMTA
  7141           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7142          ELSE
  7143           MOVE DEEDIT-FIELD-V0  TO NLSTPMTO
  7144           INSPECT NLSTPMTI CONVERTING SPACES TO '/'
  7145           MOVE AL-UANON         TO NLSTPMTA.
  7146
  7147     IF PI-USES-PAID-TO
  7148         MOVE '6'                TO  DC-OPTION-CODE
  7149         MOVE -1                 TO  DC-ELAPSED-DAYS
  7150         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7151         PERFORM 9700-DATE-LINK
  7152         IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 140
* EL154.cbl
  7153             MOVE DC-BIN-DATE-2  TO  NLSTPMT-SAVE
  7154         ELSE
  7155             MOVE ER-0354        TO  EMI-ERROR
  7156             MOVE -1             TO  NLSTPMTL
  7157             MOVE AL-UABON       TO  NLSTPMTA
  7158             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7159     ELSE
  7160         MOVE DC-BIN-DATE-1      TO  NLSTPMT-SAVE.
  7161
  7162******************************************************************
  7163*       EDIT FIRST PAYMENT AMOUNT
  7164******************************************************************
  7165
  7166     IF NFSTAMTL NOT = ZEROS
  7167
  7168* EXEC CICS BIF DEEDIT
  7169*          FIELD (NFSTAMTI)
  7170*          LENGTH(10)
  7171*       END-EXEC
  7172     MOVE 10
  7173       TO DFHEIV11
  7174*    MOVE '@"L                   #   #00006888' TO DFHEIV0
  7175     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7176     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7177     MOVE X'2020233030303036383838' TO DFHEIV0(25:11)
  7178     CALL 'kxdfhei1' USING DFHEIV0,
  7179           NFSTAMTI,
  7180           DFHEIV11
  7181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7182        IF NFSTAMTI NOT NUMERIC
  7183           MOVE ER-0350          TO EMI-ERROR
  7184           MOVE -1               TO NFSTAMTL
  7185           MOVE AL-UNBON         TO NFSTAMTA
  7186           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7187        ELSE
  7188           MOVE NFSTAMTI         TO NFSTAMT-SAVE
  7189                                    NFSTAMTO
  7190           MOVE AL-UNNON         TO NFSTAMTA
  7191        end-if
  7192     end-if
  7193******************************************************************
  7194*       EDIT DAY TO PAY
  7195******************************************************************
  7196
  7197     IF DAYPAYL NOT EQUAL +0
  7198        IF DAYPAYI NUMERIC AND
  7199           DAYPAYI LESS THAN 32
  7200           MOVE AL-UNNON         TO DAYPAYA
  7201        ELSE
  7202           MOVE ER-0632          TO EMI-ERROR
  7203           MOVE -1               TO DAYPAYL
  7204           MOVE AL-UNBON         TO DAYPAYA
  7205           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7206
  7207******************************************************************
  7208*       EDIT NUMBER OF DAYS IN FIRST PAYMENT PERIOD
  7209******************************************************************
  7210
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 141
* EL154.cbl
  7211     IF NDAYSFL NOT = ZEROS
  7212        IF NDAYSFI NOT NUMERIC
  7213           MOVE ER-0351          TO EMI-ERROR
  7214           MOVE -1               TO NDAYSFL
  7215           MOVE AL-UNBON         TO NDAYSFA
  7216           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7217        ELSE
  7218           MOVE AL-UNNON         TO NDAYSFA.
  7219
  7220******************************************************************
  7221*       EDIT NUMBER OF MONTHS BETWEEN PAYMENTS
  7222******************************************************************
  7223
  7224     IF NMONTHSL EQUAL +0
  7225        MOVE +1                  TO NMONTHSL
  7226        MOVE 1                   TO NMONTHSI.
  7227
  7228     IF NMONTHSL NOT = ZEROS
  7229        IF NMONTHSI NOT NUMERIC
  7230           MOVE ER-0353          TO EMI-ERROR
  7231           MOVE -1               TO NMONTHSL
  7232           MOVE AL-UNBON         TO NMONTHSA
  7233           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7234        ELSE
  7235           IF NMONTHSI NOT GREATER THAN ZERO
  7236              MOVE ER-0353          TO EMI-ERROR
  7237              MOVE -1               TO NMONTHSL
  7238              MOVE AL-UNBON         TO NMONTHSA
  7239              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7240              ELSE
  7241              MOVE AL-UNNON         TO NMONTHSA.
  7242
  7243******************************************************************
  7244*       EDIT PAYEE CODE
  7245******************************************************************
  7246
  7247     MOVE NPAYEEI TO WS-PAYEE-CODE.
  7248
  7249     IF WS-PAYEE-SEQ NOT NUMERIC
  7250        MOVE ER-0357          TO EMI-ERROR
  7251        MOVE -1               TO NPAYEEL
  7252        MOVE AL-UNBON         TO NPAYEEA
  7253        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7254        GO TO 6300-EXIT.
  7255
  7256     IF WS-PAYEE-CD EQUAL 'I' AND
  7257        WS-PAYEE-SEQ-NUM EQUAL 0
  7258        MOVE ER-0357          TO EMI-ERROR
  7259        MOVE -1               TO NPAYEEL
  7260        MOVE AL-UNBON         TO NPAYEEA
  7261        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7262
  7263     IF WS-PAYEE-SEQ-NUM GREATER THAN 9
  7264        MOVE ER-0357          TO EMI-ERROR
  7265        MOVE -1               TO NPAYEEL
  7266        MOVE AL-UNBON         TO NPAYEEA
  7267        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7268
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 142
* EL154.cbl
  7269     IF NPAYEEL NOT EQUAL +0
  7270        IF WS-PAYEE-CD = ('I' OR 'B' OR 'A')
  7271           MOVE AL-UNNON         TO NPAYEEA
  7272        ELSE
  7273           MOVE ER-0357          TO EMI-ERROR
  7274           MOVE -1               TO NPAYEEL
  7275           MOVE AL-UNBON         TO NPAYEEA
  7276           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7277
  7278******************************************************************
  7279*       EDIT LAST PAYMENT TYPE
  7280******************************************************************
  7281
  7282     IF NLASTL NOT = ZEROS
  7283        IF NLASTI = 'Y' OR 'N'
  7284           MOVE AL-UANON         TO NLASTA
  7285        ELSE
  7286           MOVE ER-0352          TO EMI-ERROR
  7287           MOVE -1               TO NLASTL
  7288           MOVE AL-UABON         TO NLASTA
  7289           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7290
  7291******************************************************************
  7292*       EDIT CASH / NON CASH INDICATOR
  7293******************************************************************
  7294
  7295     IF NINDCTRL NOT =  ZEROS
  7296        IF NINDCTRI  = 'Y' OR 'N'
  7297           MOVE AL-UANON         TO NINDCTRA
  7298        ELSE
  7299           MOVE ER-0815          TO EMI-ERROR
  7300           MOVE -1               TO NINDCTRL
  7301           MOVE AL-UABON         TO NINDCTRA
  7302           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7303
  7304     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7305         IF (CL-ASSOCIATES IS EQUAL TO 'A' OR 'N')
  7306             IF NINDCTRI IS EQUAL TO 'N'
  7307                 MOVE ER-3537    TO  EMI-ERROR
  7308                 MOVE -1         TO  NINDCTRL
  7309                 MOVE AL-UABON   TO  NINDCTRA
  7310                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7311
  7312******************************************************************
  7313*       EDIT LETTER PRINT INDICATOR FOR AUTO ACTIVITY
  7314******************************************************************
  7315
  7316     IF NPRINTL IS NOT EQUAL TO +0
  7317*01157         IF NPRINTI IS EQUAL TO 'N'
  7318           MOVE AL-UANON         TO  NPRINTA
  7319*01159         ELSE
  7320*01160            MOVE ER-0826          TO  EMI-ERROR
  7321*01161            MOVE -1               TO  NPRINTL
  7322*01162            MOVE AL-UABON         TO  NPRINTA
  7323*01163            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7324     END-IF.
  7325
  7326******************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 143
* EL154.cbl
  7327*    IF THE AUTO LETTER DATE IS ENTERED IT IS USED   *
  7328*    TO RESOLVE VAIABLE @@AUTOPYDT IN THE LETTER     *
  7329*    FORM THAT IS ENTERED IN THE PRINT LETTER FIELD. *
  7330******************************************************
  7331
  7332     IF LETTDTEL NOT = ZEROS
  7333        MOVE LETTDTEI            TO DEEDIT-FIELD
  7334        PERFORM 8600-DEEDIT
  7335        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7336        MOVE '4'                 TO DC-OPTION-CODE
  7337        PERFORM 9700-DATE-LINK
  7338        IF DATE-CONVERSION-ERROR
  7339           MOVE ER-3801          TO EMI-ERROR
  7340           MOVE -1               TO LETTDTEL
  7341           MOVE AL-UABON         TO LETTDTEA
  7342           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7343        ELSE
  7344           MOVE DEEDIT-FIELD-V0  TO LETTDTEO
  7345           INSPECT LETTDTEI CONVERTING SPACES TO '/'
  7346           MOVE AL-UANON         TO LETTDTEA
  7347           MOVE DC-GREG-DATE-A-EDIT TO LETTDTE-SAVE
  7348        END-IF
  7349     ELSE
  7350         MOVE SPACES TO LETTDTE-SAVE
  7351     END-IF.
  7352
  7353******************************************************************
  7354*       EDIT END LETTER PRINT INDICATOR FOR AUTO ACTIVITY
  7355******************************************************************
  7356     IF ENDLETTL NOT = ZEROS
  7357             MOVE AL-UANON          TO ENDLETTA
  7358     ELSE
  7359         IF NPRINTL NOT = ZEROS
  7360             IF NPRINTI NOT = 'N   '
  7361                 MOVE ER-3397    TO EMI-ERROR
  7362                 MOVE -1         TO ENDLETTL
  7363                 MOVE AL-UABON   TO ENDLETTA
  7364                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7365             END-IF
  7366         END-IF
  7367     END-IF.
  7368
  7369     IF NOT EMI-NO-ERRORS
  7370        GO TO 6300-EXIT.
  7371
  7372     IF PI-PROCESSOR-ID  =  LGXX-ID
  7373        GO TO 6150-READ-CARRIER.
  7374
  7375******************************************************************
  7376*       READ PROCESSOR RECORD ON THE CONTROL FILE TO GET THE
  7377*       PROCESSOR LIMITS
  7378******************************************************************
  7379
  7380
  7381* EXEC CICS HANDLE CONDITION
  7382*         NOTFND (6150-READ-CARRIER)
  7383*         NOTOPEN(8890-CNTL-NOT-OPEN)
  7384*         END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 144
* EL154.cbl
  7385*    MOVE '"$IJ                  ! ( #00007090' TO DFHEIV0
  7386     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  7387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7388     MOVE X'2820233030303037303930' TO DFHEIV0(25:11)
  7389     CALL 'kxdfhei1' USING DFHEIV0
  7390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7391
  7392
  7393
  7394* EXEC CICS READ
  7395*         DATASET(CNTL-ID)
  7396*         RIDFLD (CNTL-KEY)
  7397*         SET    (ADDRESS OF CONTROL-FILE)
  7398*         END-EXEC.
  7399*    MOVE '&"S        E          (   #00007095' TO DFHEIV0
  7400     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7401     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7402     MOVE X'2020233030303037303935' TO DFHEIV0(25:11)
  7403     CALL 'kxdfhei1' USING DFHEIV0,
  7404           CNTL-ID,
  7405           DFHEIV20,
  7406           DFHEIV99,
  7407           CNTL-KEY,
  7408           DFHEIV99,
  7409           DFHEIV99,
  7410           DFHEIV99
  7411     SET ADDRESS OF CONTROL-FILE TO
  7412         DFHEIV20
  7413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7414
  7415
  7416     MOVE CF-PROC-CALC-AMT-TOL       TO WS-AMT-TOL.
  7417     MOVE CF-PROC-CALC-DAYS-TOL      TO WS-DAY-TOL.
  7418     MOVE CF-PROC-MAX-AUTO-PMT       TO WS-MAX-AUTO-PMT.
  7419     MOVE CF-PROC-MAX-AUTO-MOS       TO WS-MAX-AUTO-MOS.
  7420     MOVE CF-PROC-MAX-REG-PMT        TO WS-REG-PMT.
  7421
  7422  6150-READ-CARRIER.
  7423******************************************************************
  7424*       READ THE CARRIER RECORD TO GET PAYMENT TOLERANCES
  7425******************************************************************
  7426
  7427     MOVE '6'                    TO CNTL-RECORD-TYPE.
  7428     MOVE SPACES                 TO CNTL-GENL.
  7429
  7430     IF CONTROL-IS-ACTUAL-CARRIER
  7431         MOVE PI-CARRIER                 TO CNTL-GEN4
  7432     ELSE
  7433         MOVE PI-CARRIER-CONTROL-LEVEL   TO CNTL-GEN4.
  7434
  7435
  7436* EXEC CICS HANDLE CONDITION
  7437*         NOTFND(6180-READ-CERT)
  7438*         END-EXEC.
  7439*    MOVE '"$I                   ! ) #00007120' TO DFHEIV0
  7440     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7441     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7442     MOVE X'2920233030303037313230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 145
* EL154.cbl
  7443     CALL 'kxdfhei1' USING DFHEIV0
  7444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7445
  7446
  7447
  7448* EXEC CICS READ
  7449*         DATASET(CNTL-ID)
  7450*         RIDFLD (CNTL-KEY)
  7451*         SET    (ADDRESS OF CONTROL-FILE)
  7452*         END-EXEC.
  7453*    MOVE '&"S        E          (   #00007124' TO DFHEIV0
  7454     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7455     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7456     MOVE X'2020233030303037313234' TO DFHEIV0(25:11)
  7457     CALL 'kxdfhei1' USING DFHEIV0,
  7458           CNTL-ID,
  7459           DFHEIV20,
  7460           DFHEIV99,
  7461           CNTL-KEY,
  7462           DFHEIV99,
  7463           DFHEIV99,
  7464           DFHEIV99
  7465     SET ADDRESS OF CONTROL-FILE TO
  7466         DFHEIV20
  7467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7468
  7469
  7470     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
  7471
  7472     IF WS-AMT-TOL = ZERO
  7473        MOVE CF-CALC-AMT-TOL     TO WS-AMT-TOL.
  7474
  7475     IF WS-DAY-TOL = ZEROS
  7476        MOVE CF-CALC-DAYS-TOL    TO WS-DAY-TOL.
  7477
  7478     IF WS-MAX-AUTO-PMT = ZEROS
  7479        MOVE CF-MAX-AUTO-PMT     TO WS-MAX-AUTO-PMT.
  7480
  7481     IF WS-MAX-AUTO-MOS = ZEROS
  7482        MOVE CF-MAX-AUTO-MOS     TO WS-MAX-AUTO-MOS.
  7483
  7484     IF WS-REG-PMT = ZEROS
  7485        MOVE CF-MAX-REG-PMT      TO WS-REG-PMT.
  7486
  7487 6180-READ-CERT.
  7488
  7489     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7490         GO TO 6190-READ-EMPLCY.
  7491
  7492
  7493* EXEC CICS HANDLE CONDITION
  7494*         NOTOPEN   (8880-CERT-NOT-OPEN)
  7495*         NOTFND    (6185-CERT-NOT-FOUND)
  7496*         END-EXEC.
  7497*    MOVE '"$JI                  ! * #00007152' TO DFHEIV0
  7498     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7500     MOVE X'2A20233030303037313532' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 146
* EL154.cbl
  7501     CALL 'kxdfhei1' USING DFHEIV0
  7502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7503
  7504
  7505
  7506* EXEC CICS READ
  7507*         DATASET(CERT-ID)
  7508*         RIDFLD (CERT-KEY)
  7509*         SET    (ADDRESS OF CERTIFICATE-MASTER)
  7510*         END-EXEC.
  7511*    MOVE '&"S        E          (   #00007157' TO DFHEIV0
  7512     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7513     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7514     MOVE X'2020233030303037313537' TO DFHEIV0(25:11)
  7515     CALL 'kxdfhei1' USING DFHEIV0,
  7516           CERT-ID,
  7517           DFHEIV20,
  7518           DFHEIV99,
  7519           CERT-KEY,
  7520           DFHEIV99,
  7521           DFHEIV99,
  7522           DFHEIV99
  7523     SET ADDRESS OF CERTIFICATE-MASTER TO
  7524         DFHEIV20
  7525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7526
  7527
  7528     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7529         MOVE CM-LOAN-1ST-PMT-DT     TO  DC-BIN-DATE-1
  7530         MOVE '6'                    TO  DC-OPTION-CODE
  7531         MOVE '1'                    TO  DC-END-OF-MONTH
  7532         MOVE +0                     TO  DC-ELAPSED-DAYS
  7533                                         DC-ODD-DAYS-OVER
  7534         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1
  7535         PERFORM 9700-DATE-LINK
  7536         IF NO-CONVERSION-ERROR
  7537             MOVE DC-BIN-DATE-2      TO  WS-EXP-DT
  7538         ELSE
  7539             MOVE LOW-VALUES         TO  WS-EXP-DT
  7540     ELSE
  7541         MOVE CM-AH-LOAN-EXPIRE-DT   TO  WS-EXP-DT.
  7542
  7543     move cm-ah-benefit-amt      to ws-monthly-benefit
  7544     move cm-ah-benefit-cd       to ws-ah-benefit-cd
  7545     GO TO 6200-START-FINAL-EDITS.
  7546
  7547 6185-CERT-NOT-FOUND.
  7548     MOVE ER-0206                TO EMI-ERROR.
  7549     MOVE -1                     TO NEFFDTEL.
  7550     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7551     GO TO 6300-EXIT.
  7552
  7553 6190-READ-EMPLCY.
  7554
  7555
  7556* EXEC CICS HANDLE CONDITION
  7557*        NOTOPEN   (8885-EMPLCY-NOT-OPEN)
  7558*        NOTFND    (6195-EMPLCY-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 147
* EL154.cbl
  7559*    END-EXEC.
  7560*    MOVE '"$JI                  ! + #00007190' TO DFHEIV0
  7561     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7562     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7563     MOVE X'2B20233030303037313930' TO DFHEIV0(25:11)
  7564     CALL 'kxdfhei1' USING DFHEIV0
  7565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7566
  7567
  7568     MOVE CL-CV-REFERENCE-NO     TO  EMPLCY-REFERENCE-NO.
  7569
  7570
  7571* EXEC CICS READ
  7572*        DATASET   (EMPLCY-ID)
  7573*        RIDFLD    (EMPLCY-KEY)
  7574*        SET       (ADDRESS OF POLICY-MASTER)
  7575*    END-EXEC.
  7576*    MOVE '&"S        E          (   #00007197' TO DFHEIV0
  7577     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7578     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7579     MOVE X'2020233030303037313937' TO DFHEIV0(25:11)
  7580     CALL 'kxdfhei1' USING DFHEIV0,
  7581           EMPLCY-ID,
  7582           DFHEIV20,
  7583           DFHEIV99,
  7584           EMPLCY-KEY,
  7585           DFHEIV99,
  7586           DFHEIV99,
  7587           DFHEIV99
  7588     SET ADDRESS OF POLICY-MASTER TO
  7589         DFHEIV20
  7590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7591
  7592
  7593     MOVE PM-INS-TERMINATION-DT  TO  WS-EXP-DT.
  7594     GO TO 6200-START-FINAL-EDITS.
  7595
  7596 6195-EMPLCY-NOT-FOUND.
  7597
  7598     MOVE ER-9483                TO  EMI-ERROR.
  7599     MOVE -1                     TO  NEFFDTEL.
  7600     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7601     GO TO 6300-EXIT.
  7602
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 148
* EL154.cbl
  7604 6200-START-FINAL-EDITS.
  7605
  7606******************************************************************
  7607****** VERIFY ELIMINATION PERIOD
  7608******************************************************************
  7609
  7610     IF CL-PAID-THRU-DT NOT EQUAL LOW-VALUES
  7611          GO TO 6225-CONTINUE-EDIT.
  7612
  7613     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7614         GO TO 6225-CONTINUE-EDIT.
  7615
  7616     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
  7617     MOVE WS-ACCESS              TO CNTL-GENL.
  7618     MOVE PI-COMPANY-ID          TO CNTL-CO.
  7619     MOVE '5'                    TO CNTL-RECORD-TYPE.
  7620     MOVE ZEROS                  TO CNTL-SEQ.
  7621
  7622     IF WS-BEN-CD = ZEROS
  7623         MOVE ER-0283            TO EMI-ERROR
  7624         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7625         MOVE -1                 TO NFSTPMTL
  7626         MOVE AL-UNBON           TO NFSTPMTA
  7627         GO TO 6300-EXIT.
  7628
  7629     PERFORM 7200-LOCATE-BENEFIT THRU 7200-EXIT.
  7630
  7631     IF NOT BENEFIT-FOUND
  7632         MOVE ER-0283            TO EMI-ERROR
  7633         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7634         MOVE -1                 TO NFSTPMTL
  7635         MOVE AL-UNBON           TO NFSTPMTA
  7636         GO TO 6300-EXIT.
  7637
  7638     MOVE CF-BENEFIT-ALPHA (SUB-1) TO PI-BENEFIT-SAVE.
  7639
  7640     IF PI-BEN-DAYS NOT NUMERIC
  7641        MOVE ZEROS               TO PI-BEN-DAYS.
  7642
  7643     IF PI-BEN-TYPE = 'R'
  7644         IF PI-BEN-DAYS IS EQUAL TO ZEROS
  7645             NEXT SENTENCE
  7646         ELSE
  7647             SUBTRACT 1 FROM PI-BEN-DAYS.
  7648
  7649     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  7650     MOVE PI-BEN-DAYS            TO DC-ELAPSED-DAYS.
  7651     MOVE +0                     TO DC-ELAPSED-MONTHS.
  7652     MOVE '6'                    TO DC-OPTION-CODE.
  7653     PERFORM 9700-DATE-LINK.
  7654     MOVE DC-BIN-DATE-2          TO RETRO-ELIM-DATE.
  7655     IF NO-EFFDTE-ENTERED
  7656        IF PI-BEN-TYPE EQUAL 'E'
  7657          MOVE  SPACES              TO  WS-ELIMINATION-SW
  7658          MOVE  DC-BIN-DATE-2       TO  NEFFDTE-SAVE
  7659          MOVE  DC-GREG-DATE-1-MDY  TO  NEFFDTEO
  7660          INSPECT NEFFDTEI CONVERTING SPACES TO '/'.
  7661
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 149
* EL154.cbl
  7662     IF PI-BEN-TYPE = 'E'
  7663         IF RETRO-ELIM-DATE GREATER THAN NEFFDTE-SAVE
  7664             MOVE ER-0541            TO EMI-ERROR
  7665             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7666             MOVE -1                 TO NEFFDTEL
  7667             MOVE AL-UNBON           TO NEFFDTEA.
  7668
  7669     IF PI-BEN-TYPE = 'R'
  7670         IF RETRO-ELIM-DATE GREATER THAN NFSTPMT-SAVE
  7671             MOVE ER-0541            TO EMI-ERROR
  7672             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7673             MOVE -1                 TO NEFFDTEL
  7674             MOVE AL-UNBON           TO NEFFDTEA.
  7675
  7676
  7677 6225-CONTINUE-EDIT.
  7678******************************************************
  7679*VERIFY THAT THE LAST PAYMENT DATE IS NOT BEYOND     *
  7680*THE EXPIRATION DATE.                                *
  7681******************************************************
  7682* FOR BIU ALLOW PAYMENT PAST EXP + 7 MONTHS
  7683     MOVE WS-EXP-DT TO DC-BIN-DATE-1.
  7684     MOVE 6         TO DC-OPTION-CODE.
  7685     MOVE 0         TO DC-ELAPSED-DAYS.
  7686     MOVE 7         TO DC-ELAPSED-MONTHS.
  7687     PERFORM 9700-DATE-LINK.
  7688     IF NO-CONVERSION-ERROR
  7689         MOVE DC-BIN-DATE-2 TO WS-EXP-DT-PLUS7
  7690     ELSE
  7691         MOVE WS-EXP-DT     TO WS-EXP-DT-PLUS7
  7692     END-IF.
  7693
  7694     IF NLSTPMT-SAVE GREATER THAN WS-EXP-DT
  7695       IF CL-CERT-ACCOUNT (9:2) = 'BI' AND
  7696                      NLSTPMT-SAVE <= WS-EXP-DT-PLUS7
  7697         IF PI-LAST-ERROR-NO EQUAL ER-3396 OR ER-0670
  7698             CONTINUE
  7699         ELSE
  7700             MOVE ER-3396             TO EMI-ERROR
  7701             MOVE AL-UABON            TO NLSTPMTA
  7702             MOVE -1                  TO NLSTPMTL
  7703             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7704         END-IF
  7705       ELSE
  7706        MOVE ER-0396             TO EMI-ERROR
  7707        MOVE AL-UABON            TO NLSTPMTA
  7708        MOVE -1                  TO NLSTPMTL
  7709        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7710        GO TO 6300-EXIT.
  7711
  7712******************************************************
  7713*VERIFY THAT THE LAST PAYMENT DATE IS GREATER THAN   *
  7714*THE FIRST PAYMENT DATE.                             *
  7715******************************************************
  7716
  7717     IF NLSTPMT-SAVE NOT GREATER THAN NFSTPMT-SAVE
  7718        MOVE ER-0559             TO EMI-ERROR
  7719        MOVE AL-UABON            TO NLSTPMTA
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 150
* EL154.cbl
  7720        MOVE -1                  TO NLSTPMTL
  7721        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7722        GO TO 6300-EXIT.
  7723
  7724******************************************************
  7725*    MAKE SURE THE DIFFERENCE BETWEEN THE FIRST      *
  7726*    PAYMENT DATE AND LAST PAYMENT DATE IS           *
  7727*    DIVISABLE BY THE INTERVAL OF MONTHS,            *
  7728*    AND THE DURATION IS IN FULL MONTH PMTS.         *
  7729******************************************************
  7730     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  7731     MOVE NLSTPMT-SAVE           TO DC-BIN-DATE-2.
  7732     MOVE '1'                    TO DC-OPTION-CODE.
  7733     PERFORM 9700-DATE-LINK.
  7734     move dc-elapsed-months      to ws-proposed-benefits
  7735     if dc-elapsed-days > 0
  7736        add 1 to ws-proposed-benefits
  7737     end-if
  7738     DIVIDE DC-ELAPSED-MONTHS BY NMONTHSI GIVING WS-WORK
  7739            REMAINDER WS-REMAINDER.
  7740     IF WS-REMAINDER NOT = 0
  7741        MOVE ER-0397             TO EMI-ERROR
  7742        MOVE -1                  TO NMONTHSL
  7743        MOVE AL-UNBON            TO NMONTHSA
  7744        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7745        GO TO 6300-EXIT.
  7746
  7747     IF DC-ODD-DAYS-OVER GREATER THAN +0
  7748        MOVE ER-0597             TO EMI-ERROR
  7749        MOVE -1                  TO NLSTPMTL
  7750        MOVE AL-UNBON            TO NLSTPMTA
  7751                                    NFSTPMTA
  7752        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7753        GO TO 6300-EXIT.
  7754
  7755******************************************************
  7756*    VERIFY THAT FIRST PAYMENT DATE IS NOT LESS      *
  7757*    THAN THE CURRENT DATE.                          *
  7758******************************************************
  7759     IF NFSTPMT-SAVE LESS THAN CURRENT-SAVE
  7760        MOVE ER-0563             TO EMI-ERROR
  7761        MOVE -1                  TO NFSTPMTL
  7762        MOVE AL-UNBON            TO NFSTPMTA
  7763        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7764        GO TO 6300-EXIT.
  7765
  7766******************************************************
  7767*                                                    *
  7768*    EDIT THE NUMBER OF DAYS IN FIRST PAYMENT        *
  7769*                                                    *
  7770******************************************************
  7771
  7772     MOVE NEFFDTE-SAVE       TO DC-BIN-DATE-1
  7773     MOVE -1                 TO DC-ELAPSED-DAYS
  7774     MOVE +0                 TO DC-ELAPSED-MONTHS
  7775     MOVE '6'                TO DC-OPTION-CODE
  7776     PERFORM 9700-DATE-LINK
  7777     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 151
* EL154.cbl
  7778        MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1.
  7779
  7780     MOVE NFSTPMT-SAVE       TO DC-BIN-DATE-2
  7781     MOVE +0                 TO DC-ELAPSED-MONTHS
  7782                                DC-ELAPSED-DAYS
  7783     MOVE '1'                TO DC-OPTION-CODE
  7784     PERFORM 9700-DATE-LINK
  7785     IF NO-CONVERSION-ERROR
  7786        MOVE DC-ELAPSED-DAYS  TO WS-ELAPSED-DAYS.
  7787
  7788     IF NDAYSFL EQUAL +0
  7789       OR
  7790        NDAYSFI NOT NUMERIC
  7791       OR
  7792        NDAYSFI EQUAL ZEROS
  7793        MOVE DC-ELAPSED-DAYS  TO NDAYSFI.
  7794
  7795     IF DATE1-GREATER-DATE2
  7796        MOVE ER-0450 TO EMI-ERROR
  7797        MOVE -1      TO NEFFDTEL
  7798        MOVE AL-UABON TO NEFFDTEA
  7799        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7800        GO TO 6300-EXIT.
  7801
  7802     ADD WS-DAY-TOL    NDAYSFI GIVING WS-DAYS-PLUS-TOL
  7803     SUBTRACT WS-DAY-TOL FROM NDAYSFI GIVING WS-DAYS-MINUS-TOL
  7804     IF WS-ELAPSED-DAYS  LESS THAN WS-DAYS-MINUS-TOL  OR
  7805        WS-ELAPSED-DAYS GREATER THAN WS-DAYS-PLUS-TOL OR
  7806        NDAYSFI = ZEROS
  7807         MOVE ER-0398             TO EMI-ERROR
  7808         MOVE -1                  TO NDAYSFL
  7809         MOVE AL-UNBON            TO NDAYSFA
  7810         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7811         GO TO 6300-EXIT.
  7812
  7813******************************************************
  7814*                                                    *
  7815*    VERIFY OR CALCULATE THE FIRST PAYMENT AMOUNT    *
  7816*                                                    *
  7817******************************************************
  7818
  7819     MOVE PI-COMPANY-ID         TO CP-COMPANY-ID.
  7820     MOVE NEFFDTE-SAVE          TO CP-PAID-FROM-DATE.
  7821     MOVE NFSTPMT-SAVE          TO CP-PAID-THRU-DT.
  7822     MOVE WS-CALC-METHOD        TO CP-CLAIM-CALC-METHOD.
  7823
  7824     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7825         MOVE PM-PRODUCER           TO CP-ACCOUNT-NUMBER
  7826         MOVE PM-INS-MONTH-BENEFIT  TO  CP-ORIGINAL-BENEFIT
  7827     ELSE
  7828         MOVE CM-AH-BENEFIT-AMT     TO CP-ORIGINAL-BENEFIT
  7829         MOVE CM-ACCOUNT            TO CP-ACCOUNT-NUMBER.
  7830
  7831
  7832* EXEC CICS LINK
  7833*         PROGRAM   ('ELPMNT')
  7834*         COMMAREA  (CALCULATION-PASS-AREA)
  7835*         LENGTH    (CP-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 152
* EL154.cbl
  7836*    END-EXEC.
  7837     MOVE 'ELPMNT' TO DFHEIV1
  7838*    MOVE '."C                   (   #00007441' TO DFHEIV0
  7839     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7840     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7841     MOVE X'2020233030303037343431' TO DFHEIV0(25:11)
  7842     CALL 'kxdfhei1' USING DFHEIV0,
  7843           DFHEIV1,
  7844           CALCULATION-PASS-AREA,
  7845           CP-COMM-LENGTH,
  7846           DFHEIV99,
  7847           DFHEIV99,
  7848           DFHEIV99,
  7849           DFHEIV99
  7850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7851
  7852
  7853     IF CP-CLAIM-PAYMENT NOT NUMERIC
  7854        MOVE +0 TO CP-CLAIM-PAYMENT.
  7855
  7856     IF CP-ACTUAL-DAYS NOT NUMERIC
  7857        MOVE +0 TO CP-ACTUAL-DAYS.
  7858
  7859     IF NFSTAMT-SAVE EQUAL +0
  7860        MOVE CP-CLAIM-PAYMENT TO NFSTAMT-SAVE
  7861                                 NFSTAMTO.
  7862
  7863     IF NDAYSFI EQUAL ZEROS
  7864        MOVE CP-ACTUAL-DAYS   TO NDAYSFI.
  7865
  7866
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 153
* EL154.cbl
  7868******************************************************
  7869*    VERIFY THAT DAYS IN FIRST PAY PERIOD IS REALLY  *
  7870*    THE DIFFERENCE BETWEEN THE IST PAYMENT DATE     *
  7871*    AND THE EFFECTIVE DATE                          *
  7872******************************************************
  7873*    MOVE NEFFDTE-SAVE           TO DC-BIN-DATE-1.
  7874*    MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-2.
  7875*    MOVE '1'                    TO DC-OPTION-CODE.
  7876*    PERFORM 9700-DATE-LINK.
  7877*    IF DATE1-GREATER-DATE2
  7878*       MOVE ER-0450 TO EMI-ERROR
  7879*       MOVE -1      TO NEFFDTEL
  7880*       MOVE AL-UABON TO NEFFDTEA
  7881*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7882*       GO TO 6300-EXIT.
  7883*
  7884*    ADD WS-DAY-TOL    NDAYSFI GIVING WS-DAYS-PLUS-TOL.
  7885*    SUBTRACT WS-DAY-TOL FROM NDAYSFI GIVING WS-DAYS-MINUS-TOL.
  7886*    IF DC-ELAPSED-DAYS  LESS THAN WS-DAYS-MINUS-TOL  OR
  7887*       DC-ELAPSED-DAYS GREATER THAN WS-DAYS-PLUS-TOL OR
  7888*       NDAYSFI = ZEROS
  7889*        MOVE ER-0398             TO EMI-ERROR
  7890*        MOVE -1                  TO NDAYSFL
  7891*        MOVE AL-UNBON            TO NDAYSFA
  7892*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7893*        GO TO 6300-EXIT.
  7894*
  7895******************************************************
  7896*   VERIFY THAT THE FIRST PAYMENT AMOUNT IS WITHIN   *
  7897*   THE TOLERANCE OF THE DAILY BENEFITS              *
  7898******************************************************
  7899*    IF CL-PMT-CALC-METHOD = '2' OR '5'
  7900*       COMPUTE WS-DAILY-BEN-AMT = CM-AH-BENEFIT-AMT * 12  / 365
  7901*    ELSE
  7902*       COMPUTE WS-DAILY-BEN-AMT = CM-AH-BENEFIT-AMT * 12  / 360.
  7903
  7904     IF WS-AMT-TOL NOT = ZEROS
  7905        COMPUTE WS-AMT-PLUS-TOL = (NFSTAMT-SAVE + WS-AMT-TOL)
  7906        COMPUTE WS-AMT-MINUS-TOL = (NFSTAMT-SAVE - WS-AMT-TOL)
  7907        IF CP-CLAIM-PAYMENT LESS THAN WS-AMT-MINUS-TOL OR
  7908           CP-CLAIM-PAYMENT GREATER THAN WS-AMT-PLUS-TOL OR
  7909           NFSTAMT-SAVE = +0
  7910           MOVE ER-0399          TO EMI-ERROR
  7911           MOVE -1               TO NFSTAMTL
  7912           MOVE AL-UNBON         TO NFSTAMTA
  7913           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7914           GO TO 6300-EXIT.
  7915
  7916******************************************************
  7917*   VERIFY THERE IS AN ADDR TRAILER AVAILABLE        *
  7918*   FOR THE PAYEE CODE SPECIFIED                     *
  7919******************************************************
  7920     IF (WS-PAYEE-CD EQUAL 'I' AND
  7921        WS-PAYEE-SEQ-NUM GREATER THAN CL-INSURED-ADDR-CNT)
  7922       OR
  7923        (WS-PAYEE-CD EQUAL 'B' AND
  7924        WS-PAYEE-SEQ-NUM GREATER THAN CL-BENIF-ADDR-CNT)
  7925       OR
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 154
* EL154.cbl
  7926        (WS-PAYEE-CD EQUAL 'A' AND
  7927        WS-PAYEE-SEQ-NUM GREATER THAN CL-ACCOUNT-ADDR-CNT)
  7928        GO TO 6250-ADDR-ERROR.
  7929
  7930     IF (WS-PAYEE-CD EQUAL 'I')
  7931       OR
  7932        ((WS-PAYEE-CD EQUAL 'B' OR 'A') AND
  7933        (WS-PAYEE-SEQ-NUM GREATER THAN 0))
  7934        GO TO 6260-CONT.
  7935
  7936     IF WS-PAYEE-CD EQUAL 'A'
  7937        GO TO 6260-CONT.
  7938
  7939     IF (WS-PAYEE-CD EQUAL 'B' AND
  7940        CL-BENEFICIARY EQUAL SPACES)
  7941        GO TO 6250-ADDR-ERROR.
  7942
  7943     MOVE PI-COMPANY-CD          TO BENE-CO.
  7944     MOVE 'B'                    TO BENE-REC-TYPE.
  7945     MOVE CL-BENEFICIARY         TO BENE-CODE.
  7946
  7947
  7948* EXEC CICS HANDLE CONDITION
  7949*         NOTFND   (6250-ADDR-ERROR)
  7950*         END-EXEC.
  7951*    MOVE '"$I                   ! , #00007541' TO DFHEIV0
  7952     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7953     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7954     MOVE X'2C20233030303037353431' TO DFHEIV0(25:11)
  7955     CALL 'kxdfhei1' USING DFHEIV0
  7956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7957
  7958
  7959
  7960* EXEC CICS READ
  7961*         DATASET     (BENE-ID)
  7962*         SET         (ADDRESS OF BENEFICIARY-MASTER)
  7963*         RIDFLD      (BENE-KEY)
  7964*         END-EXEC.
  7965*    MOVE '&"S        E          (   #00007545' TO DFHEIV0
  7966     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7967     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7968     MOVE X'2020233030303037353435' TO DFHEIV0(25:11)
  7969     CALL 'kxdfhei1' USING DFHEIV0,
  7970           BENE-ID,
  7971           DFHEIV20,
  7972           DFHEIV99,
  7973           BENE-KEY,
  7974           DFHEIV99,
  7975           DFHEIV99,
  7976           DFHEIV99
  7977     SET ADDRESS OF BENEFICIARY-MASTER TO
  7978         DFHEIV20
  7979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7980
  7981
  7982     GO TO 6260-CONT.
  7983
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 155
* EL154.cbl
  7984 6250-ADDR-ERROR.
  7985     IF (PI-COMPANY-ID EQUAL 'AIG' OR 'AUK' OR 'CIG' OR 'CUK')
  7986         IF (WS-PAYEE-CD EQUAL 'B')   AND
  7987            (WS-PAYEE-SEQ-NUM EQUAL 9)
  7988             GO TO 6260-CONT.
  7989
  7990     MOVE ER-0401         TO EMI-ERROR.
  7991     MOVE -1              TO NPAYEEL.
  7992     MOVE AL-UNBON        TO NPAYEEA.
  7993     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7994
  7995 6260-CONT.
  7996******************************************************
  7997*   VERIFY THAT THE EFFECTIVE DATE IS NOT            *
  7998*   BEFORE THE INCURRED DATE                         *
  7999******************************************************
  8000     IF NEFFDTE-SAVE LESS THAN CL-INCURRED-DT
  8001        MOVE ER-0402             TO EMI-ERROR
  8002        MOVE -1                  TO NEFFDTEL
  8003        MOVE AL-UABON            TO NEFFDTEA
  8004        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8005
  8006******************************************************
  8007*   VERIFY THAT THE CLAIM HAS NOT BEEN CLOSED.       *
  8008******************************************************
  8009     IF CLAIM-IS-CLOSED
  8010        MOVE ER-1599            TO EMI-ERROR
  8011        MOVE -1                  TO TERML
  8012        MOVE AL-UABON            TO TERMA
  8013        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8014
  8015******************************************************
  8016*  VERIFY THAT THE EFFECTIVE DATE IS                 *
  8017*  SUBSEQUENT TO THE PAID-THRU DATE                  *
  8018******************************************************
  8019     IF NEFFDTE-SAVE NOT GREATER THAN CL-PAID-THRU-DT
  8020        MOVE ER-0403             TO EMI-ERROR
  8021        MOVE -1                  TO NEFFDTEL
  8022        MOVE AL-UABON            TO NEFFDTEA
  8023        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8024
  8025******************************************************
  8026*  VERIFY THAT THE NUMBER OF MONTHS BETWEEN          *
  8027*  THE EFFECTIVE DATE AND THE LAST PAYMENT DATE      *
  8028*  IS NOT GREATER THAN THE MAXIMUM ALLOWED           *
  8029******************************************************
  8030     IF WS-MAX-AUTO-MOS NOT = ZEROS
  8031        MOVE NEFFDTE-SAVE        TO DC-BIN-DATE-1
  8032        MOVE NLSTPMT-SAVE        TO DC-BIN-DATE-2
  8033        MOVE '1'                 TO DC-OPTION-CODE
  8034        PERFORM 9700-DATE-LINK
  8035        IF DC-ELAPSED-MONTHS GREATER THAN WS-MAX-AUTO-MOS
  8036           MOVE ER-0404             TO EMI-ERROR
  8037           MOVE -1                  TO NEFFDTEL
  8038           MOVE AL-UABON            TO NEFFDTEA NLSTPMTA
  8039           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8040
  8041******************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 156
* EL154.cbl
  8042*  VERIFY THAT THE CERTIFICATE DOES NOT HAVE A       *
  8043*  CURRENT STATUS OF '8' (CANCEL APPLIED)            *
  8044******************************************************
  8045
  8046     IF PI-COMPANY-ID IS EQUAL TO 'HAN' OR 'LGX'
  8047         IF CM-AH-CANCEL-APPLIED
  8048             MOVE ER-0839            TO  EMI-ERROR
  8049             MOVE -1                 TO  ENTERPFL
  8050             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8051******************************************************************
  8052*   check to see if the pd thru dates are past the benefit exp dt
  8053******************************************************************
  8054
  8055     if pi-company-id not = 'DCC'
  8056        GO TO 6300-bypass-dcc
  8057     END-IF
  8058
  8059     move zeros                  to ws-max-benefit-amt
  8060                                    ws-max-benefit-pmts
  8061     perform 6320-read-acct      thru 6320-exit
  8062     if ws-dcc-product-code not = spaces
  8063        perform 6340-GET-DDF-LIMITS
  8064                                 thru 6340-exit
  8065        if pdef-found
  8066           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  8067              (P1 > +8)
  8068              OR (PD-PROD-CODE (P1) = cl-claim-type)
  8069           END-PERFORM
  8070           IF P1 < +9
  8071              if pd-ben-pct (p1) not numeric
  8072                 move zeros      to pd-ben-pct (p1)
  8073              end-if
  8074              if pd-ben-pct (p1) = zeros
  8075                 move +1         to ws-work-ben-pct
  8076              else
  8077                 move pd-ben-pct (p1)
  8078                                 to ws-work-ben-pct
  8079              end-if
  8080              MOVE PD-MAX-AMT (P1)
  8081                                 TO ws-max-benefit-amt
  8082              compute ws-monthly-benefit =
  8083                 ws-monthly-benefit * ws-work-ben-pct
  8084              if ws-monthly-benefit > pd-max-amt (p1)
  8085                 move pd-max-amt (p1) to ws-monthly-benefit
  8086              end-if
  8087              move pd-crit-period (p1)
  8088                                 to ws-max-benefit-pmts
  8089           else
  8090              move er-1674       to emi-error
  8091              PERFORM 9900-ERROR-FORMAT
  8092                                 THRU 9900-EXIT
  8093           END-IF
  8094        else
  8095           move er-1672          to emi-error
  8096           PERFORM 9900-ERROR-FORMAT
  8097                                 THRU 9900-EXIT
  8098        END-IF
  8099     end-if
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 157
* EL154.cbl
  8100*    if (ws-max-benefit-amt not = zeros)
  8101*       and (ws-max-benefit-amt < ws-monthly-benefit)
  8102*       move ws-max-benefit-amt  to ws-monthly-benefit
  8103*    end-if
  8104     perform 6350-get-cert-trlr  thru 6350-exit
  8105
  8106     if (nfstamt-save = zeros)
  8107        or (nfstamt-save = cp-claim-payment)
  8108        move ws-monthly-benefit  to nfstamt-save
  8109                                    nfstamto
  8110     end-if
  8111
  8112     compute ws-edit-1st-pmt-amt rounded =
  8113        ws-monthly-benefit * (ndaysfi / 30)
  8114     if nfstamt-save > ws-edit-1st-pmt-amt
  8115        move er-1657             to emi-error
  8116        move -1                  to nfstamtl
  8117        move al-unbon            to nfstamta
  8118        perform 9900-error-format
  8119                                 thru 9900-exit
  8120     end-if
  8121
  8122     if nfstamt-save = zeros
  8123        move ws-monthly-benefit to nfstamt-save
  8124     end-if
  8125
  8126     move cm-ah-loan-expire-dt   to ws-benefit-expiration-dt
  8127     IF CL-CRITICAL-PERIOD NOT = ZEROS and spaces
  8128        move cl-critical-period  to dc-elapsed-months
  8129        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
  8130        MOVE ZEROS               TO DC-ELAPSED-DAYS
  8131        MOVE '6'                 TO DC-OPTION-CODE
  8132        PERFORM 9700-DATE-LINK
  8133        MOVE DC-BIN-DATE-2       TO ws-BENEFIT-EXPIRATION-DT
  8134     END-IF
  8135
  8136     if nlstpmt-save > ws-benefit-expiration-dt
  8137        move er-1658             to emi-error
  8138        move -1                  to nlstpmtl
  8139        move al-uabon            to nlstpmta
  8140        perform 9900-error-format thru 9900-exit
  8141     end-if
  8142
  8143     MOVE cl-control-primary     TO ELTRLR-KEY
  8144     MOVE +95                    TO TRLR-SEQ-NO
  8145
  8146* EXEC CICS READ
  8147*       DATASET  ('ELTRLR')
  8148*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8149*       RIDFLD   (ELTRLR-KEY)
  8150*       RESP     (WS-RESPONSE)
  8151*    END-EXEC
  8152     MOVE 'ELTRLR' TO DFHEIV1
  8153*    MOVE '&"S        E          (  N#00007714' TO DFHEIV0
  8154     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8155     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8156     MOVE X'204E233030303037373134' TO DFHEIV0(25:11)
  8157     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 158
* EL154.cbl
  8158           DFHEIV1,
  8159           DFHEIV20,
  8160           DFHEIV99,
  8161           ELTRLR-KEY,
  8162           DFHEIV99,
  8163           DFHEIV99,
  8164           DFHEIV99
  8165     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8166         DFHEIV20
  8167     MOVE EIBRESP  TO WS-RESPONSE
  8168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8169
  8170     if ws-resp-normal
  8171        perform varying s1 from +1 by +1 until
  8172           at-note-error-no (s1) = spaces
  8173           if at-note-error-no (s1) not = '1661' and '1662'
  8174           move at-note-error-no (s1)
  8175                                 to emi-error
  8176           if at-note-error-no (s1) = '1653'
  8177              evaluate true
  8178                 when cl-claim-type = 'L'
  8179                    move '  LF  '
  8180                                 to emi-claim-type
  8181                 when cl-claim-type = 'I'
  8182                    move '  IU  '
  8183                                 to emi-claim-type
  8184                 when cl-claim-type = 'F'
  8185                    move '  FL  '
  8186                                 to emi-claim-type
  8187                 when other
  8188                    move '  AH  '
  8189                                 to emi-claim-type
  8190              end-evaluate
  8191           end-if
  8192           move -1               to nlstpmtl
  8193           PERFORM 9900-ERROR-FORMAT
  8194                                 THRU 9900-EXIT
  8195           end-if
  8196        end-perform
  8197     end-if
  8198     go to 6300-exit
  8199     .
  8200 6300-bypass-dcc.
  8201
  8202
  8203     perform 6350-get-cert-trlr  thru 6350-exit
  8204
  8205     compute ws-benefits-prev-paid = ws-benefits-prev-paid +
  8206        (nfstamt-save / ws-monthly-benefit)
  8207     if cl-critical-period > zeros
  8208        if (ws-benefits-prev-paid + ws-proposed-benefits) >
  8209           cl-critical-period
  8210           move er-1658          to emi-error
  8211           move -1               to nlstpmtl
  8212           move al-uabon         to nlstpmta
  8213           perform 9900-error-format
  8214                                 thru 9900-exit
  8215        end-if
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 159
* EL154.cbl
  8216     end-if
  8217     .
  8218 6300-EXIT.
  8219      EXIT.
  8220 6320-read-acct.
  8221
  8222     move spaces              to WS-ACCT-RECORD-SW
  8223                                 ws-dcc-product-code
  8224
  8225     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
  8226     MOVE PI-CARRIER          TO ACCT-CARRIER
  8227     MOVE PI-GROUPING         TO ACCT-GROUPING
  8228     MOVE PI-STATE            TO ACCT-STATE
  8229     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
  8230     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
  8231     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
  8232
  8233
  8234* EXEC CICS READ
  8235*       DATASET ('ERACCT')
  8236*       RIDFLD  (ERACCT-KEY)
  8237*       SET     (ADDRESS OF ACCOUNT-MASTER)
  8238*       GTEQ
  8239*       resp    (WS-RESPONSE)
  8240*    END-EXEC
  8241     MOVE 'ERACCT' TO DFHEIV1
  8242*    MOVE '&"S        G          (  N#00007784' TO DFHEIV0
  8243     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8244     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8245     MOVE X'204E233030303037373834' TO DFHEIV0(25:11)
  8246     CALL 'kxdfhei1' USING DFHEIV0,
  8247           DFHEIV1,
  8248           DFHEIV20,
  8249           DFHEIV99,
  8250           ERACCT-KEY,
  8251           DFHEIV99,
  8252           DFHEIV99,
  8253           DFHEIV99
  8254     SET ADDRESS OF ACCOUNT-MASTER TO
  8255         DFHEIV20
  8256     MOVE EIBRESP  TO WS-RESPONSE
  8257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8258     IF WS-RESP-NORMAL
  8259        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
  8260        and pi-cert-eff-dt < am-expiration-dt
  8261        and pi-cert-eff-dt >= am-effective-dt
  8262        move am-dcc-product-code to ws-dcc-product-code
  8263        set acct-found           to true
  8264     end-if
  8265
  8266     .
  8267 6320-exit.
  8268     exit.
  8269
  8270 6340-GET-DDF-LIMITS.
  8271
  8272     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8273     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 160
* EL154.cbl
  8274     MOVE pi-state               TO ERPDEF-STATE
  8275     MOVE WS-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8276     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  8277     MOVE ws-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  8278     MOVE pi-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8279
  8280     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8281
  8282
  8283* EXEC CICS STARTBR
  8284*        DATASET  ('ERPDEF')
  8285*        RIDFLD   (ERPDEF-KEY)
  8286*        GTEQ
  8287*        RESP     (WS-RESPONSE)
  8288*    END-EXEC
  8289     MOVE 'ERPDEF' TO DFHEIV1
  8290     MOVE 0
  8291       TO DFHEIV11
  8292*    MOVE '&,         G          &  N#00007815' TO DFHEIV0
  8293     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8294     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8295     MOVE X'204E233030303037383135' TO DFHEIV0(25:11)
  8296     CALL 'kxdfhei1' USING DFHEIV0,
  8297           DFHEIV1,
  8298           ERPDEF-KEY,
  8299           DFHEIV99,
  8300           DFHEIV11,
  8301           DFHEIV99
  8302     MOVE EIBRESP  TO WS-RESPONSE
  8303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8304
  8305     IF NOT WS-RESP-NORMAL
  8306        GO TO 6340-EXIT
  8307     END-IF
  8308
  8309     .
  8310 6340-READNEXT.
  8311
  8312
  8313* EXEC CICS READNEXT
  8314*       DATASET  ('ERPDEF')
  8315*       SET      (ADDRESS OF PRODUCT-MASTER)
  8316*       RIDFLD   (ERPDEF-KEY)
  8317*       RESP     (WS-RESPONSE)
  8318*    END-EXEC
  8319     MOVE 'ERPDEF' TO DFHEIV1
  8320     MOVE 0
  8321       TO DFHEIV11
  8322*    MOVE '&.S                   )  N#00007829' TO DFHEIV0
  8323     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8324     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8325     MOVE X'204E233030303037383239' TO DFHEIV0(25:11)
  8326     CALL 'kxdfhei1' USING DFHEIV0,
  8327           DFHEIV1,
  8328           DFHEIV20,
  8329           DFHEIV99,
  8330           ERPDEF-KEY,
  8331           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 161
* EL154.cbl
  8332           DFHEIV11,
  8333           DFHEIV99,
  8334           DFHEIV99
  8335     SET ADDRESS OF PRODUCT-MASTER TO
  8336         DFHEIV20
  8337     MOVE EIBRESP  TO WS-RESPONSE
  8338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8339
  8340     IF NOT WS-RESP-NORMAL
  8341        GO TO 6340-ENDBR
  8342     END-IF
  8343
  8344     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  8345        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  8346           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  8347        ELSE
  8348           GO TO 6340-READNEXT
  8349        END-IF
  8350     ELSE
  8351        GO TO 6340-ENDBR
  8352     END-IF
  8353     .
  8354 6340-ENDBR.
  8355
  8356
  8357* EXEC CICS ENDBR
  8358*       DATASET  ('ERPDEF')
  8359*    END-EXEC
  8360     MOVE 'ERPDEF' TO DFHEIV1
  8361     MOVE 0
  8362       TO DFHEIV11
  8363*    MOVE '&2                    $   #00007852' TO DFHEIV0
  8364     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8365     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8366     MOVE X'2020233030303037383532' TO DFHEIV0(25:11)
  8367     CALL 'kxdfhei1' USING DFHEIV0,
  8368           DFHEIV1,
  8369           DFHEIV11,
  8370           DFHEIV99
  8371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8372
  8373     .
  8374 6340-EXIT.
  8375     EXIT.
  8376
  8377 6350-get-cert-trlr.
  8378
  8379     move spaces                 to ws-cert-trlr-sw
  8380     move zeros                  to ws-benefits-prev-paid
  8381                                    ws-total-paid
  8382     move cl-cert-key-data       to elcrtt-key (2:21)
  8383     move cl-company-cd          to ctrlr-comp-cd
  8384     move cl-cert-no             to ctrlr-cert-no
  8385     move 'B'                    to ctrlr-rec-type
  8386
  8387
  8388* EXEC CICS READ
  8389*       DATASET  ('ELCRTT')
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 162
* EL154.cbl
  8390*       set      (address of CERTIFICATE-TRAILERS)
  8391*       RIDFLD   (ELCRTT-KEY)
  8392*       RESP     (WS-RESPONSE)
  8393*    END-EXEC
  8394     MOVE 'ELCRTT' TO DFHEIV1
  8395*    MOVE '&"S        E          (  N#00007870' TO DFHEIV0
  8396     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8397     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8398     MOVE X'204E233030303037383730' TO DFHEIV0(25:11)
  8399     CALL 'kxdfhei1' USING DFHEIV0,
  8400           DFHEIV1,
  8401           DFHEIV20,
  8402           DFHEIV99,
  8403           ELCRTT-KEY,
  8404           DFHEIV99,
  8405           DFHEIV99,
  8406           DFHEIV99
  8407     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  8408         DFHEIV20
  8409     MOVE EIBRESP  TO WS-RESPONSE
  8410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8411     IF not WS-RESP-NORMAL
  8412        go to 6350-exit
  8413     end-if
  8414
  8415     set cert-trlr-found         to true
  8416     perform varying s1 from +1 by +1 until
  8417        (s1 > +24)
  8418        or (cs-claim-no (s1) = spaces)
  8419        if (cs-benefit-period (s1) = cl-benefit-period)
  8420           and (cs-claim-type (s1) = cl-claim-type)
  8421           and (cs-insured-type (s1) = cl-insured-type)
  8422           compute ws-total-paid =
  8423              ws-total-paid + cs-total-paid (s1)
  8424        end-if
  8425     end-perform
  8426     compute ws-benefits-prev-paid =
  8427        (ws-total-paid / ws-monthly-benefit)
  8428     .
  8429 6350-exit.
  8430     exit.
  8431 6400-PAYMENT-CALCULATION.
  8432
  8433     IF WS-CALC-METHOD = '1' OR '2' OR '3' OR '4' OR '5' OR '6'
  8434         IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  8435             COMPUTE NREGPMT-SAVE ROUNDED =
  8436                 (PM-INS-MONTH-BENEFIT * NMONTHSI)
  8437             MOVE NREGPMT-SAVE   TO  NREGAMTO
  8438             GO TO 6499-EXIT
  8439         ELSE
  8440             COMPUTE NREGPMT-SAVE ROUNDED =
  8441                 (ws-monthly-benefit * NMONTHSI)
  8442             MOVE NREGPMT-SAVE   TO  NREGAMTO
  8443             GO TO 6499-EXIT.
  8444
  8445     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  8446     MOVE +0                     TO DC-ELAPSED-DAYS.
  8447     MOVE NMONTHSI               TO DC-ELAPSED-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 163
* EL154.cbl
  8448     MOVE '6'                    TO DC-OPTION-CODE.
  8449     PERFORM 9700-DATE-LINK.
  8450
  8451     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  8452     MOVE '1'                    TO DC-OPTION-CODE.
  8453     PERFORM 9700-DATE-LINK.
  8454
  8455     IF (PI-COMPANY-ID  = 'FIA' AND
  8456        CL-CERT-ACCOUNT = '0000011043')
  8457        COMPUTE WS-DAILY-RATE ROUNDED =
  8458                             (CM-AH-BENEFIT-AMT * 13) / 365
  8459        COMPUTE NREGPMT-SAVE ROUNDED =
  8460                             WS-DAILY-RATE * DC-ELAPSED-DAYS
  8461        MOVE NREGPMT-SAVE  TO  NREGAMTO
  8462        GO TO 6499-EXIT.
  8463
  8464*    IF WS-CALC-METHOD = '4'
  8465*       COMPUTE WS-DAILY-RATE ROUNDED =
  8466*                            (CM-AH-BENEFIT-AMT / 30)
  8467*       COMPUTE NREGPMT-SAVE ROUNDED =
  8468*                            WS-DAILY-RATE * DC-ELAPSED-DAYS.
  8469*
  8470*    IF WS-CALC-METHOD = '5'
  8471*       COMPUTE WS-DAILY-RATE ROUNDED =
  8472*                            (CM-AH-BENEFIT-AMT * 12) / 365
  8473*       COMPUTE NREGPMT-SAVE ROUNDED =
  8474*                            WS-DAILY-RATE * DC-ELAPSED-DAYS.
  8475
  8476 6499-EXIT.
  8477      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 164
* EL154.cbl
  8479 6900-SET-CODES.
  8480     MOVE PI-CLAIM-NO            TO CLAM-CLAIM
  8481                                    ACTV-CLAIM.
  8482
  8483     MOVE PI-COMPANY-ID          TO CNTL-CO.
  8484
  8485     MOVE PI-COMPANY-CD          TO CLAM-CO
  8486                                    ACTV-CO
  8487                                    CERT-CO
  8488                                    EMPLCY-COMPANY-CD.
  8489
  8490     MOVE PI-CARRIER             TO CLAM-CARRIER
  8491                                    ACTV-CARRIER
  8492                                    CERT-CARRIER
  8493                                    EMPLCY-CARRIER.
  8494
  8495     MOVE PI-CERT-NO             TO CLAM-CERT-NUM
  8496                                    ACTV-CERT-NUM
  8497                                    CERT-CERT-NUM.
  8498
  8499     MOVE PI-GROUPING            TO CERT-GROUPING
  8500                                    EMPLCY-GROUPING.
  8501     MOVE PI-STATE               TO CERT-STATE
  8502                                    EMPLCY-STATE.
  8503     MOVE PI-ACCOUNT             TO CERT-ACCOUNT
  8504                                    EMPLCY-PRODUCER.
  8505     MOVE PI-CERT-EFF-DT         TO CERT-EFF-DT
  8506                                    EMPLCY-EFF-DT.
  8507     MOVE '2'                    TO CNTL-RECORD-TYPE.
  8508     MOVE PI-PROCESSOR-ID        TO CNTL-GENL.
  8509     MOVE ZEROS                  TO CNTL-SEQ.
  8510
  8511 6999-EXIT.
  8512      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 165
* EL154.cbl
  8514 7000-BUILD-SCREEN.
  8515     PERFORM 6900-SET-CODES.
  8516
  8517
  8518* EXEC CICS HANDLE CONDITION
  8519*         NOTOPEN(8860-CLAM-NOT-OPEN)
  8520*         NOTFND (7090-CLAIM-NOT-FOUND)
  8521*         END-EXEC.
  8522*    MOVE '"$JI                  ! - #00007982' TO DFHEIV0
  8523     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8524     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8525     MOVE X'2D20233030303037393832' TO DFHEIV0(25:11)
  8526     CALL 'kxdfhei1' USING DFHEIV0
  8527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8528
  8529
  8530
  8531* EXEC CICS READ
  8532*         DATASET(CLAM-ID)
  8533*         SET    (ADDRESS OF CLAIM-MASTER)
  8534*         RIDFLD (CLAM-KEY)
  8535*         END-EXEC.
  8536*    MOVE '&"S        E          (   #00007987' TO DFHEIV0
  8537     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8538     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8539     MOVE X'2020233030303037393837' TO DFHEIV0(25:11)
  8540     CALL 'kxdfhei1' USING DFHEIV0,
  8541           CLAM-ID,
  8542           DFHEIV20,
  8543           DFHEIV99,
  8544           CLAM-KEY,
  8545           DFHEIV99,
  8546           DFHEIV99,
  8547           DFHEIV99
  8548     SET ADDRESS OF CLAIM-MASTER TO
  8549         DFHEIV20
  8550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8551
  8552
  8553     MOVE CL-CLAIM-NO            TO CLAIMO
  8554     MOVE CL-CERT-PRIME          TO CERTO
  8555     MOVE CL-CERT-SFX            TO SUFFIXO
  8556     MOVE CL-CARRIER             TO CARRO
  8557     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  8558
  8559     IF ACTV-SEQ = ZEROS
  8560        GO TO 7080-NO-TRAILER.
  8561
  8562
  8563* EXEC CICS HANDLE CONDITION
  8564*         NOTOPEN(8870-ACTV-NOT-OPEN)
  8565*         NOTFND (7080-NO-TRAILER)
  8566*         END-EXEC.
  8567*    MOVE '"$JI                  ! . #00008002' TO DFHEIV0
  8568     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8569     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8570     MOVE X'2E20233030303038303032' TO DFHEIV0(25:11)
  8571     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 166
* EL154.cbl
  8572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8573
  8574
  8575
  8576* EXEC CICS READ
  8577*         DATASET(ACTV-ID)
  8578*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  8579*         RIDFLD (ACTV-KEY)
  8580*    END-EXEC.
  8581*    MOVE '&"S        E          (   #00008007' TO DFHEIV0
  8582     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8583     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8584     MOVE X'2020233030303038303037' TO DFHEIV0(25:11)
  8585     CALL 'kxdfhei1' USING DFHEIV0,
  8586           ACTV-ID,
  8587           DFHEIV20,
  8588           DFHEIV99,
  8589           ACTV-KEY,
  8590           DFHEIV99,
  8591           DFHEIV99,
  8592           DFHEIV99
  8593     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8594         DFHEIV20
  8595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8596
  8597
  8598     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
  8599     MOVE SPACE                  TO DC-OPTION-CODE.
  8600     PERFORM 9700-DATE-LINK.
  8601     MOVE DC-GREG-DATE-1-EDIT    TO CESTDTEI.
  8602
  8603
  8604     MOVE AT-SCHEDULE-START-DT   TO DC-BIN-DATE-1.
  8605     MOVE SPACE                  TO DC-OPTION-CODE.
  8606     PERFORM 9700-DATE-LINK.
  8607     MOVE DC-GREG-DATE-1-EDIT    TO CEFFDTEI.
  8608
  8609     IF AT-AUTO-PAY-DAY NUMERIC
  8610         MOVE AT-AUTO-PAY-DAY    TO DAY2PAYI
  8611     ELSE
  8612         MOVE ZEROS              TO DAY2PAYI.
  8613
  8614     IF PI-USES-PAID-TO
  8615         MOVE AT-1ST-PAY-THRU-DT      TO  DC-BIN-DATE-1
  8616         MOVE '6'                     TO  DC-OPTION-CODE
  8617         MOVE +1                      TO  DC-ELAPSED-DAYS
  8618         MOVE +0                      TO  DC-ELAPSED-MONTHS
  8619         PERFORM 9700-DATE-LINK
  8620         IF NO-CONVERSION-ERROR
  8621             MOVE DC-GREG-DATE-1-EDIT TO  CFSTPMTI
  8622         ELSE
  8623             MOVE LOW-VALUES          TO  CFSTPMTI
  8624     ELSE
  8625         MOVE AT-1ST-PAY-THRU-DT      TO  DC-BIN-DATE-1
  8626         MOVE SPACE                   TO  DC-OPTION-CODE
  8627         PERFORM 9700-DATE-LINK
  8628         IF NO-CONVERSION-ERROR
  8629             MOVE DC-GREG-DATE-1-EDIT TO  CFSTPMTI
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 167
* EL154.cbl
  8630         ELSE
  8631             MOVE LOW-VALUES          TO  CFSTPMTI.
  8632
  8633     IF PI-USES-PAID-TO
  8634         MOVE AT-SCHEDULE-END-DT      TO  DC-BIN-DATE-1
  8635         MOVE '6'                     TO  DC-OPTION-CODE
  8636         MOVE +1                      TO  DC-ELAPSED-DAYS
  8637         MOVE +0                      TO  DC-ELAPSED-MONTHS
  8638         PERFORM 9700-DATE-LINK
  8639         IF NO-CONVERSION-ERROR
  8640             MOVE DC-GREG-DATE-1-EDIT TO  CLSTPMTI
  8641         ELSE
  8642             MOVE LOW-VALUES          TO  CLSTPMTI
  8643     ELSE
  8644         MOVE AT-SCHEDULE-END-DT      TO  DC-BIN-DATE-1
  8645         MOVE SPACE                   TO  DC-OPTION-CODE
  8646         MOVE +0                      TO  DC-ELAPSED-DAYS
  8647                                          DC-ELAPSED-MONTHS
  8648         PERFORM 9700-DATE-LINK
  8649         IF NO-CONVERSION-ERROR
  8650             MOVE DC-GREG-DATE-1-EDIT TO  CLSTPMTI
  8651         ELSE
  8652             MOVE LOW-VALUES          TO  CLSTPMTI.
  8653
  8654     MOVE AT-FIRST-PMT-AMT       TO CFSTAMTO.
  8655     MOVE AT-DAYS-IN-1ST-PMT     TO CDAYSFO.
  8656
  8657     IF AT-LAST-PMT-TYPE = 'F'
  8658        MOVE 'Y'                 TO CLASTO
  8659     ELSE
  8660        MOVE 'N'                 TO CLASTO.
  8661
  8662     MOVE AT-RECORDED-BY         TO CESTBYO.
  8663     MOVE AT-REGULAR-PMT-AMT     TO CREGPMTO.
  8664     MOVE AT-AUTO-CASH           TO CINDCTRO.
  8665
  8666     MOVE AT-AUTO-END-LETTER     TO PRINTI
  8667                                    PI-AUTO-END-LETTER.
  8668
  8669     IF AT-AUTO-PAYEE-TYPE EQUAL 'I'
  8670        MOVE 'INSURED'           TO CPAYEEO
  8671     ELSE
  8672     IF AT-AUTO-PAYEE-TYPE EQUAL 'B'
  8673        MOVE 'BENEFIC'           TO CPAYEEO
  8674     ELSE
  8675     IF AT-AUTO-PAYEE-TYPE EQUAL 'A'
  8676        MOVE 'ACCOUNT'           TO CPAYEEO.
  8677
  8678     MOVE AT-INTERVAL-MONTHS     TO CMONTHSO.
  8679     MOVE -1                     TO TERML.
  8680     GO TO 8100-SEND-INITIAL-MAP.
  8681
  8682 7080-NO-TRAILER.
  8683     MOVE 'A'                    TO TERMI.
  8684     MOVE AL-PADON               TO TERMA
  8685                                    PRINTA.
  8686     MOVE -1                     TO NFSTPMTL.
  8687     MOVE ER-0346                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 168
* EL154.cbl
  8688     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8689     GO TO 8100-SEND-INITIAL-MAP.
  8690
  8691 7090-CLAIM-NOT-FOUND.
  8692     MOVE ER-0186                TO EMI-ERROR.
  8693     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8694     GO TO 8100-SEND-INITIAL-MAP.
  8695
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 169
* EL154.cbl
  8697 7100-CHECK-AUTO-ACTIVITY.
  8698
  8699
  8700* EXEC CICS HANDLE CONDITION
  8701*        NOTFND   (7100-NOT-FOUND)
  8702*    END-EXEC.
  8703*    MOVE '"$I                   ! / #00008114' TO DFHEIV0
  8704     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8705     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8706     MOVE X'2F20233030303038313134' TO DFHEIV0(25:11)
  8707     CALL 'kxdfhei1' USING DFHEIV0
  8708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8709
  8710
  8711     MOVE PI-COMPANY-ID          TO  CNTL-CO.
  8712     MOVE 'T'                    TO  CNTL-RECORD-TYPE.
  8713     MOVE SPACES                 TO  CNTL-GENL.
  8714     MOVE +0                     TO  CNTL-SEQ.
  8715
  8716
  8717* EXEC CICS READ
  8718*        DATASET   (CNTL-ID)
  8719*        RIDFLD    (CNTL-KEY)
  8720*        SET       (ADDRESS OF CONTROL-FILE)
  8721*    END-EXEC.
  8722*    MOVE '&"S        E          (   #00008123' TO DFHEIV0
  8723     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8724     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8725     MOVE X'2020233030303038313233' TO DFHEIV0(25:11)
  8726     CALL 'kxdfhei1' USING DFHEIV0,
  8727           CNTL-ID,
  8728           DFHEIV20,
  8729           DFHEIV99,
  8730           CNTL-KEY,
  8731           DFHEIV99,
  8732           DFHEIV99,
  8733           DFHEIV99
  8734     SET ADDRESS OF CONTROL-FILE TO
  8735         DFHEIV20
  8736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8737
  8738
  8739     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
  8740
  8741 7100-CHECK-SYSTEM-ACTIVITY.
  8742
  8743     IF CL-ACTIVITY-CODE IS NOT EQUAL TO ZEROS
  8744         MOVE CL-ACTIVITY-CODE             TO  SUB-1
  8745         IF SUB-1 IS GREATER THAN +9
  8746             SUBTRACT +9 FROM SUB-1
  8747             MOVE CF-USER-RESET-SW (SUB-1) TO  WS-RESET-SW
  8748         ELSE
  8749             MOVE CF-SYS-RESET-SW  (SUB-1) TO  WS-RESET-SW
  8750     ELSE
  8751         MOVE 'Y'                          TO  WS-RESET-SW.
  8752
  8753     IF TERMI IS EQUAL TO 'A'
  8754         IF (CF-SYS-ACTIVE-SW (5) IS EQUAL TO 'N' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 170
* EL154.cbl
  8755             MOVE 'N'                TO  WS-LETTER-SW
  8756                                         WS-RESET-SW
  8757             GO TO 7100-EXIT.
  8758
  8759     IF TERMI IS EQUAL TO 'A'
  8760         IF (CF-SYS-LETTER-ID (5) EQUAL SPACES OR LOW-VALUES)
  8761             MOVE 'N'                TO  WS-LETTER-SW
  8762         ELSE
  8763             MOVE 'Y'                TO  WS-LETTER-SW.
  8764
  8765     IF TERMI IS EQUAL TO 'Y'
  8766         IF (CF-SYS-ACTIVE-SW (6) IS EQUAL TO 'N' OR ' ')
  8767             MOVE 'N'                TO  WS-LETTER-SW
  8768                                         WS-RESET-SW
  8769             GO TO 7100-EXIT.
  8770
  8771     IF TERMI IS EQUAL TO 'Y'
  8772         IF (CF-SYS-LETTER-ID (6) EQUAL SPACES OR LOW-VALUES)
  8773             MOVE 'N'                TO  WS-LETTER-SW
  8774         ELSE
  8775             MOVE 'Y'                TO  WS-LETTER-SW.
  8776
  8777     IF CL-ACTIVITY-CODE IS EQUAL TO 09
  8778         GO TO 7100-EXIT.
  8779
  8780     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK') AND
  8781        (CL-ACTIVITY-CODE IS EQUAL TO 11)
  8782         GO TO 7100-EXIT.
  8783
  8784     IF WS-RESET-SW IS EQUAL TO 'N'
  8785         GO TO 7100-EXIT.
  8786
  8787     MOVE CURRENT-BIN-DATE           TO  CL-ACTIVITY-MAINT-DT.
  8788
  8789     IF TERMI IS EQUAL TO 'A'
  8790         MOVE 05                     TO  CL-ACTIVITY-CODE
  8791         MOVE 'AUTO'                 TO  CL-ACTIVITY-MAINT-TYPE
  8792     ELSE
  8793         MOVE 06                     TO  CL-ACTIVITY-CODE
  8794         MOVE 'TERM'                 TO  CL-ACTIVITY-MAINT-TYPE.
  8795
  8796     GO TO 7100-EXIT.
  8797
  8798 7100-NOT-FOUND.
  8799
  8800     MOVE 'N'                        TO  WS-ACT-REC-FOUND-SW
  8801                                         WS-LETTER-SW.
  8802
  8803 7100-EXIT.
  8804     EXIT.
  8805
  8806 7150-CREATE-AUTO-LETTER.
  8807
  8808     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
  8809     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
  8810
  8811     IF TERMI IS EQUAL TO 'A'
  8812         IF WS-LETTER-FORM-NUM > SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 171
* EL154.cbl
  8813            MOVE WS-LETTER-FORM-NUM     TO  W-1523-FORM-NUMBER
  8814         ELSE
  8815         MOVE CF-SYS-LETTER-ID (5)   TO  W-1523-FORM-NUMBER
  8816         END-IF
  8817     ELSE
  8818         IF WS-END-LETTER-FORM-NUM > SPACES
  8819             MOVE WS-END-LETTER-FORM-NUM TO W-1523-FORM-NUMBER
  8820         ELSE
  8821         MOVE CF-SYS-LETTER-ID (6)   TO  W-1523-FORM-NUMBER.
  8822
  8823     IF TERMI IS EQUAL TO 'A'
  8824       IF CF-SYS-RESEND-DAYS (5) IS NOT EQUAL TO ZEROS
  8825         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8826         MOVE '6'                    TO  DC-OPTION-CODE
  8827         MOVE CF-SYS-RESEND-DAYS (5) TO  DC-ELAPSED-DAYS
  8828         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8829         PERFORM 9700-DATE-LINK
  8830         IF NO-CONVERSION-ERROR
  8831             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
  8832         ELSE
  8833             MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
  8834
  8835
  8836     IF TERMI IS EQUAL TO 'A'
  8837       IF CF-SYS-FOLLOW-UP-DAYS (5) IS NOT EQUAL TO ZEROS
  8838         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8839         MOVE '6'                    TO  DC-OPTION-CODE
  8840         MOVE CF-SYS-FOLLOW-UP-DAYS (5)  TO  DC-ELAPSED-DAYS
  8841         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8842         PERFORM 9700-DATE-LINK
  8843         IF NO-CONVERSION-ERROR
  8844             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
  8845         ELSE
  8846             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
  8847
  8848     IF TERMI IS EQUAL TO 'Y'
  8849       IF CF-SYS-RESEND-DAYS (6) IS NOT EQUAL TO ZEROS
  8850         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8851         MOVE '6'                    TO  DC-OPTION-CODE
  8852         MOVE CF-SYS-RESEND-DAYS (6) TO  DC-ELAPSED-DAYS
  8853         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8854         PERFORM 9700-DATE-LINK
  8855         IF NO-CONVERSION-ERROR
  8856             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
  8857         ELSE
  8858             MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
  8859
  8860
  8861     IF TERMI IS EQUAL TO 'Y'
  8862       IF CF-SYS-FOLLOW-UP-DAYS (6) IS NOT EQUAL TO ZEROS
  8863         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8864         MOVE '6'                    TO  DC-OPTION-CODE
  8865         MOVE CF-SYS-FOLLOW-UP-DAYS (6)  TO  DC-ELAPSED-DAYS
  8866         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8867         PERFORM 9700-DATE-LINK
  8868         IF NO-CONVERSION-ERROR
  8869             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
  8870         ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 172
* EL154.cbl
  8871             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
  8872
  8873     MOVE LETTDTE-SAVE               TO W-1523-LETTER-DATE.
  8874
  8875
  8876* EXEC CICS LINK
  8877*        PROGRAM    (LINK-1523)
  8878*        COMMAREA   (W-1523-LINKDATA)
  8879*        LENGTH     (W-1523-COMM-LENGTH)
  8880*    END-EXEC.
  8881*    MOVE '."C                   (   #00008265' TO DFHEIV0
  8882     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8883     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8884     MOVE X'2020233030303038323635' TO DFHEIV0(25:11)
  8885     CALL 'kxdfhei1' USING DFHEIV0,
  8886           LINK-1523,
  8887           W-1523-LINKDATA,
  8888           W-1523-COMM-LENGTH,
  8889           DFHEIV99,
  8890           DFHEIV99,
  8891           DFHEIV99,
  8892           DFHEIV99
  8893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8894
  8895
  8896     IF W-1523-ERROR-CODE IS EQUAL TO ZEROS
  8897         GO TO 7150-EXIT.
  8898
  8899     IF W-1523-FATAL-ERROR
  8900         MOVE ER-0802                TO  EMI-ERROR
  8901         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8902         GO TO 7150-EXIT.
  8903
  8904     IF W-1523-ERROR-CODE IS EQUAL TO 0191
  8905         MOVE ER-0803                TO  EMI-ERROR
  8906         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8907
  8908 7150-EXIT.
  8909     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 173
* EL154.cbl
  8911 7200-LOCATE-BENEFIT.
  8912     MOVE SPACES TO WS-BENEFIT-FOUND-SW.
  8913
  8914
  8915* EXEC CICS HANDLE CONDITION
  8916*        ENDFILE(7200-EXIT)
  8917*        NOTFND(7200-EXIT)
  8918*        END-EXEC.
  8919*    MOVE '"$''I                  ! 0 #00008289' TO DFHEIV0
  8920     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8921     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8922     MOVE X'3020233030303038323839' TO DFHEIV0(25:11)
  8923     CALL 'kxdfhei1' USING DFHEIV0
  8924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8925
  8926
  8927
  8928* EXEC CICS READ
  8929*        DATASET(CNTL-ID)
  8930*        SET(ADDRESS OF CONTROL-FILE)
  8931*        RIDFLD(CNTL-KEY)
  8932*        GTEQ
  8933*        END-EXEC.
  8934*    MOVE '&"S        G          (   #00008294' TO DFHEIV0
  8935     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8936     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8937     MOVE X'2020233030303038323934' TO DFHEIV0(25:11)
  8938     CALL 'kxdfhei1' USING DFHEIV0,
  8939           CNTL-ID,
  8940           DFHEIV20,
  8941           DFHEIV99,
  8942           CNTL-KEY,
  8943           DFHEIV99,
  8944           DFHEIV99,
  8945           DFHEIV99
  8946     SET ADDRESS OF CONTROL-FILE TO
  8947         DFHEIV20
  8948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8949
  8950
  8951     IF (CNTL-CO NOT = CF-COMPANY-ID)   OR
  8952        (CNTL-RECORD-TYPE NOT = CF-RECORD-TYPE)
  8953           GO TO 7200-EXIT.
  8954
  8955     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
  8956         VARYING SUB-1 FROM 1 BY 1 UNTIL
  8957            ((SUB-1 GREATER 8) OR
  8958            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
  8959
  8960     IF SUB-1 NOT = 9
  8961         MOVE 'Y' TO WS-BENEFIT-FOUND-SW.
  8962
  8963     GO TO 7200-EXIT.
  8964
  8965 7200-BENEFIT-DUMMY.
  8966
  8967 7200-DUMMY-EXIT.
  8968     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 174
* EL154.cbl
  8969
  8970 7200-EXIT.
  8971     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 175
* EL154.cbl
  8973 8100-SEND-INITIAL-MAP.
  8974     MOVE CURRENT-GREG-DATE      TO RUNDTEO.
  8975     MOVE EIBTIME                TO TIME-IN.
  8976     MOVE TIME-OUT               TO RUNTIMEO.
  8977     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8978     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8979
  8980     IF PI-USES-PAID-TO
  8981         MOVE FIRST-PMT-HD2      TO  FSTHD1O
  8982                                     FSTHD2O
  8983         MOVE LAST-PMT-HD2       TO  LSTHD1O
  8984         MOVE LAST-PMT-HD4       TO  LSTHD2O
  8985     ELSE
  8986         MOVE FIRST-PMT-HD1      TO  FSTHD1O
  8987                                     FSTHD2O
  8988         MOVE LAST-PMT-HD1       TO  LSTHD1O
  8989         MOVE LAST-PMT-HD3       TO  LSTHD2O.
  8990
  8991
  8992* EXEC CICS SEND
  8993*        MAP(MAP-NAME)
  8994*        MAPSET(MAPSET-NAME)
  8995*        FROM(EL154AO)
  8996*        ERASE
  8997*        CURSOR
  8998*        END-EXEC.
  8999     MOVE LENGTH OF
  9000      EL154AO
  9001       TO DFHEIV12
  9002     MOVE -1
  9003       TO DFHEIV11
  9004*    MOVE '8$     CT  E    H L F ,   #00008341' TO DFHEIV0
  9005     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9006     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9007     MOVE X'2020233030303038333431' TO DFHEIV0(25:11)
  9008     CALL 'kxdfhei1' USING DFHEIV0,
  9009           MAP-NAME,
  9010           EL154AO,
  9011           DFHEIV12,
  9012           MAPSET-NAME,
  9013           DFHEIV99,
  9014           DFHEIV99,
  9015           DFHEIV99,
  9016           DFHEIV11,
  9017           DFHEIV99,
  9018           DFHEIV99,
  9019           DFHEIV99
  9020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9021
  9022
  9023     MOVE 'EL154   ' TO PI-CALLING-PROGRAM.
  9024     GO TO 9100-RETURN-TRAN.
  9025
  9026 8200-SEND-DATAONLY.
  9027     MOVE CURRENT-GREG-DATE TO RUNDTEO.
  9028     MOVE EIBTIME           TO TIME-IN.
  9029     MOVE TIME-OUT          TO RUNTIMEO.
  9030     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 176
* EL154.cbl
  9031     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  9032
  9033     IF PI-USES-PAID-TO
  9034         MOVE FIRST-PMT-HD2      TO  FSTHD1O
  9035                                     FSTHD2O
  9036         MOVE LAST-PMT-HD2       TO  LSTHD1O
  9037         MOVE LAST-PMT-HD4       TO  LSTHD2O
  9038     ELSE
  9039         MOVE FIRST-PMT-HD1      TO  FSTHD1O
  9040                                     FSTHD2O
  9041         MOVE LAST-PMT-HD1       TO  LSTHD1O
  9042         MOVE LAST-PMT-HD3       TO  LSTHD2O.
  9043
  9044
  9045* EXEC CICS SEND
  9046*        MAP(MAP-NAME)
  9047*        MAPSET(MAPSET-NAME)
  9048*        FROM(EL154AO)
  9049*        DATAONLY
  9050*        ERASEAUP
  9051*        CURSOR
  9052*        END-EXEC.
  9053     MOVE LENGTH OF
  9054      EL154AO
  9055       TO DFHEIV12
  9056     MOVE -1
  9057       TO DFHEIV11
  9058*    MOVE '8$D    CT  A    H L F ,   #00008370' TO DFHEIV0
  9059     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  9060     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9061     MOVE X'2020233030303038333730' TO DFHEIV0(25:11)
  9062     CALL 'kxdfhei1' USING DFHEIV0,
  9063           MAP-NAME,
  9064           EL154AO,
  9065           DFHEIV12,
  9066           MAPSET-NAME,
  9067           DFHEIV99,
  9068           DFHEIV99,
  9069           DFHEIV99,
  9070           DFHEIV11,
  9071           DFHEIV99,
  9072           DFHEIV99,
  9073           DFHEIV99
  9074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9075
  9076
  9077     GO TO 9100-RETURN-TRAN.
  9078
  9079 8300-SEND-TEXT.
  9080
  9081* EXEC CICS SEND TEXT
  9082*        FROM(LOGOFF-TEXT)
  9083*        LENGTH(LOGOFF-LENGTH)
  9084*        ERASE
  9085*        FREEKB
  9086*        END-EXEC.
  9087*    MOVE '8&      T  E F  H   F -   #00008382' TO DFHEIV0
  9088     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 177
* EL154.cbl
  9089     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9090     MOVE X'2020233030303038333832' TO DFHEIV0(25:11)
  9091     CALL 'kxdfhei1' USING DFHEIV0,
  9092           LOGOFF-TEXT,
  9093           LOGOFF-LENGTH,
  9094           DFHEIV99,
  9095           DFHEIV99,
  9096           DFHEIV99,
  9097           DFHEIV99,
  9098           DFHEIV99,
  9099           DFHEIV99,
  9100           DFHEIV99,
  9101           DFHEIV99,
  9102           DFHEIV99,
  9103           DFHEIV99
  9104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9105
  9106
  9107
  9108* EXEC CICS RETURN
  9109*        END-EXEC.
  9110*    MOVE '.(                    ''   #00008389' TO DFHEIV0
  9111     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9112     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9113     MOVE X'2020233030303038333839' TO DFHEIV0(25:11)
  9114     CALL 'kxdfhei1' USING DFHEIV0,
  9115           DFHEIV99,
  9116           DFHEIV99,
  9117           DFHEIV99,
  9118           DFHEIV99,
  9119           DFHEIV99,
  9120           DFHEIV99
  9121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9122
  9123
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 178
* EL154.cbl
  9125 8600-DEEDIT.
  9126
  9127* EXEC CICS BIF DEEDIT
  9128*         FIELD(DEEDIT-FIELD)
  9129*         LENGTH(15)
  9130*         END-EXEC.
  9131     MOVE 15
  9132       TO DFHEIV11
  9133*    MOVE '@"L                   #   #00008394' TO DFHEIV0
  9134     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9135     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9136     MOVE X'2020233030303038333934' TO DFHEIV0(25:11)
  9137     CALL 'kxdfhei1' USING DFHEIV0,
  9138           DEEDIT-FIELD,
  9139           DFHEIV11
  9140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9141
  9142
  9143 8800-UNAUTHORIZED-ACCESS.
  9144     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  9145     GO TO 8300-SEND-TEXT.
  9146
  9147 8810-PF23.
  9148     MOVE EIBAID TO PI-ENTRY-CD-1.
  9149     MOVE XCTL-005 TO PGM-NAME.
  9150     GO TO 9300-XCTL.
  9151
  9152
  9153 8850-CLAM-END-FILE.
  9154     MOVE -1                     TO  ENTERPFL.
  9155     MOVE ER-0130 TO EMI-ERROR.
  9156     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9157     GO TO 8200-SEND-DATAONLY.
  9158
  9159 8860-CLAM-NOT-OPEN.
  9160     MOVE -1                     TO  ENTERPFL.
  9161     MOVE ER-0154 TO EMI-ERROR.
  9162     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9163     GO TO 8200-SEND-DATAONLY.
  9164
  9165 8870-ACTV-NOT-OPEN.
  9166     MOVE -1                     TO  ENTERPFL.
  9167     MOVE ER-0172 TO EMI-ERROR.
  9168     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9169     GO TO 8200-SEND-DATAONLY.
  9170
  9171 8880-CERT-NOT-OPEN.
  9172     MOVE -1                     TO  ENTERPFL.
  9173     MOVE ER-0169                TO EMI-ERROR.
  9174     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9175     GO TO 8200-SEND-DATAONLY.
  9176
  9177 8885-EMPLCY-NOT-OPEN.
  9178     MOVE -1                     TO  ENTERPFL.
  9179     MOVE ER-9883                TO  EMI-ERROR.
  9180     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9181     GO TO 8200-SEND-DATAONLY.
  9182
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 179
* EL154.cbl
  9183 8890-CNTL-NOT-OPEN.
  9184     MOVE -1                     TO  ENTERPFL.
  9185     MOVE ER-0042                TO EMI-ERROR.
  9186     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9187     GO TO 8200-SEND-DATAONLY.
  9188
  9189 9000-RETURN-CICS.
  9190
  9191* EXEC CICS RETURN
  9192*        END-EXEC.
  9193*    MOVE '.(                    ''   #00008446' TO DFHEIV0
  9194     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9195     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9196     MOVE X'2020233030303038343436' TO DFHEIV0(25:11)
  9197     CALL 'kxdfhei1' USING DFHEIV0,
  9198           DFHEIV99,
  9199           DFHEIV99,
  9200           DFHEIV99,
  9201           DFHEIV99,
  9202           DFHEIV99,
  9203           DFHEIV99
  9204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9205
  9206
  9207 9100-RETURN-TRAN.
  9208     MOVE    EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  9209     MOVE '154A' TO PI-CURRENT-SCREEN-NO.
  9210
  9211* EXEC CICS RETURN
  9212*        TRANSID(TRANS-ID)
  9213*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  9214*        LENGTH(PI-COMM-LENGTH)
  9215*        END-EXEC.
  9216*    MOVE '.(CT                  ''   #00008452' TO DFHEIV0
  9217     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9218     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9219     MOVE X'2020233030303038343532' TO DFHEIV0(25:11)
  9220     CALL 'kxdfhei1' USING DFHEIV0,
  9221           TRANS-ID,
  9222           PROGRAM-INTERFACE-BLOCK,
  9223           PI-COMM-LENGTH,
  9224           DFHEIV99,
  9225           DFHEIV99,
  9226           DFHEIV99
  9227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9228
  9229
  9230 9200-RETURN-MAIN-MENU.
  9231     MOVE XCTL-126 TO PGM-NAME.
  9232     GO TO 9300-XCTL.
  9233
  9234 9300-XCTL.
  9235
  9236* EXEC CICS XCTL
  9237*        PROGRAM(PGM-NAME)
  9238*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  9239*        LENGTH(PI-COMM-LENGTH)
  9240*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 180
* EL154.cbl
  9241*    MOVE '.$C                   %   #00008463' TO DFHEIV0
  9242     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9243     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9244     MOVE X'2020233030303038343633' TO DFHEIV0(25:11)
  9245     CALL 'kxdfhei1' USING DFHEIV0,
  9246           PGM-NAME,
  9247           PROGRAM-INTERFACE-BLOCK,
  9248           PI-COMM-LENGTH,
  9249           DFHEIV99
  9250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9251
  9252
  9253 9400-CLEAR.
  9254     MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  9255     GO TO 9300-XCTL.
  9256
  9257 9500-PF12.
  9258     MOVE XCTL-010 TO PGM-NAME.
  9259     GO TO 9300-XCTL.
  9260
  9261 9600-PGMID-ERROR.
  9262
  9263* EXEC CICS HANDLE CONDITION
  9264*        PGMIDERR(8300-SEND-TEXT)
  9265*        END-EXEC.
  9266*    MOVE '"$L                   ! 1 #00008478' TO DFHEIV0
  9267     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9268     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9269     MOVE X'3120233030303038343738' TO DFHEIV0(25:11)
  9270     CALL 'kxdfhei1' USING DFHEIV0
  9271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9272
  9273
  9274     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  9275     MOVE ' '          TO PI-ENTRY-CD-1.
  9276     MOVE XCTL-005     TO PGM-NAME.
  9277     MOVE PGM-NAME     TO LOGOFF-PGM.
  9278     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  9279     GO TO 9300-XCTL.
  9280
  9281 9700-DATE-LINK.
  9282     MOVE LINK-ELDATCV TO PGM-NAME
  9283
  9284* EXEC CICS LINK
  9285*        PROGRAM    (PGM-NAME)
  9286*        COMMAREA   (DATE-CONVERSION-DATA)
  9287*        LENGTH     (DC-COMM-LENGTH)
  9288*        END-EXEC.
  9289*    MOVE '."C                   (   #00008491' TO DFHEIV0
  9290     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9291     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9292     MOVE X'2020233030303038343931' TO DFHEIV0(25:11)
  9293     CALL 'kxdfhei1' USING DFHEIV0,
  9294           PGM-NAME,
  9295           DATE-CONVERSION-DATA,
  9296           DC-COMM-LENGTH,
  9297           DFHEIV99,
  9298           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 181
* EL154.cbl
  9299           DFHEIV99,
  9300           DFHEIV99
  9301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9302
  9303
  9304 9900-ERROR-FORMAT.
  9305     IF NOT EMI-ERRORS-COMPLETE
  9306         MOVE LINK-001 TO PGM-NAME
  9307
  9308* EXEC CICS LINK
  9309*            PROGRAM(PGM-NAME)
  9310*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  9311*            LENGTH(EMI-COMM-LENGTH)
  9312*            END-EXEC.
  9313*    MOVE '."C                   (   #00008500' TO DFHEIV0
  9314     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9315     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9316     MOVE X'2020233030303038353030' TO DFHEIV0(25:11)
  9317     CALL 'kxdfhei1' USING DFHEIV0,
  9318           PGM-NAME,
  9319           ERROR-MESSAGE-INTERFACE-BLOCK,
  9320           EMI-COMM-LENGTH,
  9321           DFHEIV99,
  9322           DFHEIV99,
  9323           DFHEIV99,
  9324           DFHEIV99
  9325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9326
  9327
  9328 9900-EXIT.
  9329     EXIT.
  9330
  9331 9990-ABEND.
  9332     MOVE LINK-004 TO PGM-NAME.
  9333     MOVE DFHEIBLK TO EMI-LINE1.
  9334
  9335* EXEC CICS LINK
  9336*        PROGRAM(PGM-NAME)
  9337*        COMMAREA(EMI-LINE1)
  9338*        LENGTH(72)
  9339*        END-EXEC.
  9340     MOVE 72
  9341       TO DFHEIV11
  9342*    MOVE '."C                   (   #00008512' TO DFHEIV0
  9343     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9344     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9345     MOVE X'2020233030303038353132' TO DFHEIV0(25:11)
  9346     CALL 'kxdfhei1' USING DFHEIV0,
  9347           PGM-NAME,
  9348           EMI-LINE1,
  9349           DFHEIV11,
  9350           DFHEIV99,
  9351           DFHEIV99,
  9352           DFHEIV99,
  9353           DFHEIV99
  9354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9355
  9356
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 182
* EL154.cbl
  9357     GO TO 8200-SEND-DATAONLY.
  9358
  9359* GOBACK.
  9360     MOVE '9%                    "   ' TO DFHEIV0
  9361     MOVE 'EL154' TO DFHEIV1
  9362     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9363     GOBACK.
  9364
  9365 9995-SECURITY-VIOLATION.
  9366*                            COPY ELCSCTP.
  9367******************************************************************
  9368*                                                                *
  9369*                            ELCSCTP                             *
  9370*                            VMOD=2.001                          *
  9371*                                                                *
  9372*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9373******************************************************************
  9374
  9375
  9376     MOVE EIBDATE          TO SM-JUL-DATE.
  9377     MOVE EIBTRMID         TO SM-TERMID.
  9378     MOVE THIS-PGM         TO SM-PGM.
  9379     MOVE EIBTIME          TO TIME-IN.
  9380     MOVE TIME-OUT         TO SM-TIME.
  9381     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9382
  9383
  9384* EXEC CICS LINK
  9385*         PROGRAM  ('EL003')
  9386*         COMMAREA (SECURITY-MESSAGE)
  9387*         LENGTH   (80)
  9388*    END-EXEC.
  9389     MOVE 'EL003' TO DFHEIV1
  9390     MOVE 80
  9391       TO DFHEIV11
  9392*    MOVE '."C                   (   #00008539' TO DFHEIV0
  9393     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9394     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9395     MOVE X'2020233030303038353339' TO DFHEIV0(25:11)
  9396     CALL 'kxdfhei1' USING DFHEIV0,
  9397           DFHEIV1,
  9398           SECURITY-MESSAGE,
  9399           DFHEIV11,
  9400           DFHEIV99,
  9401           DFHEIV99,
  9402           DFHEIV99,
  9403           DFHEIV99
  9404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9405
  9406
  9407******************************************************************
  9408
  9409
  9410 9995-EXIT.
  9411     EXIT.
  9412
  9413
  9414 9999-DFHBACK SECTION.
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 183
* EL154.cbl
  9415     MOVE '9%                    "   ' TO DFHEIV0
  9416     MOVE 'EL154' TO DFHEIV1
  9417     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9418     GOBACK.
  9419 9999-DFHEXIT.
  9420     IF DFHEIGDJ EQUAL 0001
  9421         NEXT SENTENCE
  9422     ELSE IF DFHEIGDJ EQUAL 2
  9423         GO TO 8860-CLAM-NOT-OPEN,
  9424               9600-PGMID-ERROR,
  9425               9990-ABEND
  9426         DEPENDING ON DFHEIGDI
  9427     ELSE IF DFHEIGDJ EQUAL 3
  9428         GO TO 8850-CLAM-END-FILE,
  9429               8850-CLAM-END-FILE
  9430         DEPENDING ON DFHEIGDI
  9431     ELSE IF DFHEIGDJ EQUAL 4
  9432         GO TO 8850-CLAM-END-FILE,
  9433               8850-CLAM-END-FILE
  9434         DEPENDING ON DFHEIGDI
  9435     ELSE IF DFHEIGDJ EQUAL 5
  9436         GO TO 8870-ACTV-NOT-OPEN
  9437         DEPENDING ON DFHEIGDI
  9438     ELSE IF DFHEIGDJ EQUAL 6
  9439         GO TO 8870-ACTV-NOT-OPEN,
  9440               4099-EXIT
  9441         DEPENDING ON DFHEIGDI
  9442     ELSE IF DFHEIGDJ EQUAL 7
  9443         GO TO 9999-DFHBACK
  9444         DEPENDING ON DFHEIGDI
  9445     ELSE IF DFHEIGDJ EQUAL 8
  9446         GO TO 6150-READ-CARRIER,
  9447               8890-CNTL-NOT-OPEN
  9448         DEPENDING ON DFHEIGDI
  9449     ELSE IF DFHEIGDJ EQUAL 9
  9450         GO TO 6180-READ-CERT
  9451         DEPENDING ON DFHEIGDI
  9452     ELSE IF DFHEIGDJ EQUAL 10
  9453         GO TO 8880-CERT-NOT-OPEN,
  9454               6185-CERT-NOT-FOUND
  9455         DEPENDING ON DFHEIGDI
  9456     ELSE IF DFHEIGDJ EQUAL 11
  9457         GO TO 8885-EMPLCY-NOT-OPEN,
  9458               6195-EMPLCY-NOT-FOUND
  9459         DEPENDING ON DFHEIGDI
  9460     ELSE IF DFHEIGDJ EQUAL 12
  9461         GO TO 6250-ADDR-ERROR
  9462         DEPENDING ON DFHEIGDI
  9463     ELSE IF DFHEIGDJ EQUAL 13
  9464         GO TO 8860-CLAM-NOT-OPEN,
  9465               7090-CLAIM-NOT-FOUND
  9466         DEPENDING ON DFHEIGDI
  9467     ELSE IF DFHEIGDJ EQUAL 14
  9468         GO TO 8870-ACTV-NOT-OPEN,
  9469               7080-NO-TRAILER
  9470         DEPENDING ON DFHEIGDI
  9471     ELSE IF DFHEIGDJ EQUAL 15
  9472         GO TO 7100-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 16-Mar-15 14:08 Page 184
* EL154.cbl
  9473         DEPENDING ON DFHEIGDI
  9474     ELSE IF DFHEIGDJ EQUAL 16
  9475         GO TO 7200-EXIT,
  9476               7200-EXIT
  9477         DEPENDING ON DFHEIGDI
  9478     ELSE IF DFHEIGDJ EQUAL 17
  9479         GO TO 8300-SEND-TEXT
  9480         DEPENDING ON DFHEIGDI.
  9481     MOVE '9%                    "   ' TO DFHEIV0
  9482     MOVE 'EL154' TO DFHEIV1
  9483     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9484     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6004     Code:       19329
