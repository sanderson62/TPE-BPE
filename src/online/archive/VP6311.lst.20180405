* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page   1
* VP6311.cbl
* Options: int("VP6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("VP6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"VP6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"VP6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 VP6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page   2
* VP6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - VPB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page   3
* VP6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    79******************************************************************
    80
    81 ENVIRONMENT DIVISION.
    82
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page   4
* VP6311.cbl
    84 DATA DIVISION.
    85 WORKING-STORAGE SECTION.
    86 01  DFH-START PIC X(04).
    87 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    88 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    89 77  FILLER  PIC X(32)  VALUE '********************************'.
    90 77  FILLER  PIC X(32)  VALUE '*    VP6311 WORKING STORAGE    *'.
    91 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    92 77  A1                          PIC S999 COMP-3 VALUE +0.
    93 77  N1                          PIC S999 COMP-3 VALUE +0.
    94 77  N2                          PIC S999 COMP-3 VALUE +0.
    95 77  N3                          PIC S999 COMP-3 VALUE +0.
    96 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    97 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    98 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    99     88  REVERSAL                    VALUE 'Y'.
   100 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   101 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   102 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   103 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   104 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   105     88  ERMAIL-FOUND                 VALUE 'Y'.
   106 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   107 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   108 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   109 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   110     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   111 77  ws-stop-sw                  pic x value ' '.
   112     88  i-say-stop                 value 'Y'.
   113 77  ws-check-sw                 pic x value ' '.
   114     88  i-have-checks              value 'Y'.
   115 77  ws-proc-check-sw            pic x value ' '.
   116     88  i-have-processed-checks    value 'Y'.
   117 77  ws-chek-browse-sw           pic x value ' '.
   118 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   119 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   120 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   121 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   122 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   123 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   124 01  P pointer.
   125 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   126 01  var-ptr pointer.
   127 01  env-var-len                 pic 9(4)  binary.
   128 01  rc                          pic 9(9)  binary.
   129 01  WS-KIXSYS.
   130     05  WS-KIX-FIL1             PIC X(10).
   131     05  WS-KIX-APPS             PIC X(10).
   132     05  WS-KIX-ENV              PIC X(10).
   133     05  WS-KIX-MYENV            PIC X(10).
   134     05  WS-KIX-SYS              PIC X(10).
   135*    COPY ELCSCTM.
   136******************************************************************
   137*                                                                *
   138*                                                                *
   139*                            ELCSCTM                             *
   140*                            VMOD=2.001                          *
   141*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page   5
* VP6311.cbl
   142*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   143*                                                                *
   144******************************************************************
   145 01  SECURITY-MESSAGE.
   146     12  FILLER                          PIC X(30)
   147            VALUE '** LOGIC SECURITY VIOLATION -'.
   148     12  SM-READ                         PIC X(6).
   149     12  FILLER                          PIC X(5)
   150            VALUE ' PGM='.
   151     12  SM-PGM                          PIC X(6).
   152     12  FILLER                          PIC X(5)
   153            VALUE ' OPR='.
   154     12  SM-PROCESSOR-ID                 PIC X(4).
   155     12  FILLER                          PIC X(6)
   156            VALUE ' TERM='.
   157     12  SM-TERMID                       PIC X(4).
   158     12  FILLER                          PIC XX   VALUE SPACE.
   159     12  SM-JUL-DATE                     PIC 9(5).
   160     12  FILLER                          PIC X    VALUE SPACE.
   161     12  SM-TIME                         PIC 99.99.
   162
   163
   164*    COPY ELCSCRTY.
   165******************************************************************
   166*                                                                *
   167*                                                                *
   168*                            ELCSCRTY                            *
   169*                            VMOD=2.001                          *
   170*                                                                *
   171*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   172*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   173*        SAVED IN PI-SECURITY-ADDRESS.                           *
   174*                                                                *
   175******************************************************************
   176 01  SECURITY-CONTROL.
   177     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   178     12  FILLER                       PIC XX    VALUE 'SC'.
   179     12  SC-CREDIT-CODES.
   180         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   181             20  SC-CREDIT-DISPLAY    PIC X.
   182             20  SC-CREDIT-UPDATE     PIC X.
   183     12  SC-CLAIMS-CODES.
   184         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   185             20  SC-CLAIMS-DISPLAY    PIC X.
   186             20  SC-CLAIMS-UPDATE     PIC X.
   187
   188 01  WS-VA-NO-COMM-MESS.
   189     12  FILLER                  PIC X(41) VALUE
   190        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   191 01  WS-OC-MESSAGE.
   192     12  FILLER                  PIC X(43) VALUE
   193        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   194     12  WS-OC-DIS-AMT           PIC -----9.99.
   195     12  FILLER                  PIC X(4) VALUE ' ON '.
   196     12  WS-OC-DATE              PIC X(10).
   197 01  WS-DATE-AREA.
   198     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   199     12  WS-CURRENT-DT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page   6
* VP6311.cbl
   200         16  FILLER              PIC X(6)    VALUE SPACES.
   201         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   202     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   203     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   204     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   205
   206 01  STANDARD-AREAS.
   207     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   208     12  VP631B                  PIC X(8)    VALUE 'VP631B'.
   209     12  VP631C                  PIC X(8)    VALUE 'VP631C'.
   210     12  VP631D                  PIC X(8)    VALUE 'VP631D'.
   211     12  MAPSET-VP6311S          PIC X(8)    VALUE 'VP6311S'.
   212     12  SCREEN-NUMBER           PIC X(6)    VALUE 'VP631B'.
   213     12  TRANS-EXB1              PIC X(4)    VALUE 'VPB1'.
   214     12  THIS-PGM                PIC X(8)    VALUE 'VP6311'.
   215     12  PGM-NAME                PIC X(8).
   216     12  TIME-IN                 PIC S9(7).
   217     12  TIME-OUT-R  REDEFINES TIME-IN.
   218         16  FILLER              PIC X.
   219         16  TIME-OUT            PIC 99V99.
   220         16  FILLER              PIC XX.
   221     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   222     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   223     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   224     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   225     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   226     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   227     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   228     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   229     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   230     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   231     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   232     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   233     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   234     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   235     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   236     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   237     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   238     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   239     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   240     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   241     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   242     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   243     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   244     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   245     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   246     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   247     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   248     12  FILE-ID                 PIC X(8).
   249     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   250     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   251     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   252     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   253     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   254     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   255     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   256     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   257     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page   7
* VP6311.cbl
   258     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   259     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   260     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   261     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   262     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   263     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   264
   265 01  WS-PASS-AREA.
   266     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   267     05  WS-PASS-VADS-REC    PIC X(350).
   268*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   269*                                COPY ELCZREC.
   270******************************************************************
   271*                                                                *
   272*                                                                *
   273*                            ELCZREC.                            *
   274*                                                                *
   275*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   276*                                                                *
   277******************************************************************
   278*-----------------------------------------------------------------
   279*                   C H A N G E   L O G
   280*
   281* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   282*-----------------------------------------------------------------
   283*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   284* EFFECTIVE    NUMBER
   285*-----------------------------------------------------------------
   286* 122011    2011022800001  AJRA  NEW FILE
   287* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   288* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   289* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   290* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   291*-----------------------------------------------------------------
   292 01  W-Z-CONTROL-DATA.
   293     05  W-NUMBER-OF-COPIES      PIC  9.
   294     05  FILLER                  PIC  X.
   295     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   296     05  FILLER                  PIC  X.
   297     05  W-DAYS-TO-RESEND        PIC  999.
   298     05  FILLER                  PIC  X.
   299     05  W-FORM-TO-RESEND        PIC  X(4).
   300     05  W-ADD-BAR-CODE          PIC  X.
   301     05  W-PROMPT-LETTER         PIC  X.
   302     05  W-HAS-RETURN-ENV        PIC  X.
   303     05  W-ENCLOSURE-CD          PIC  XXX.
   304     05  W-SIG-FLAG-DEFAULT      PIC  X.
   305     05  W-AUTO-CLOSE-IND        PIC  X.
   306     05  FILLER                  PIC  X.
   307     05  W-LETTER-TO-BENE        PIC  X.
   308     05  FILLER                  PIC  X.
   309     05  W-LETTER-TO-ACCT        PIC  X.
   310     05  FILLER                  PIC  X.
   311     05  W-LETTER-TYPE           PIC  X.
   312     05  FILLER                  PIC  X.
   313     05  W-PRINT-CERTIFICATE     PIC  X.
   314     05  FILLER                  PIC  X.
   315     05  W-REFUND-REQUIRED       PIC  X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page   8
* VP6311.cbl
   316     05  FILLER                  PIC  X.
   317     05  W-ONBASE-CODE           PIC  XX.
   318     05  FILLER                  PIC  X.
   319     05  W-ACCT-SUMM             PIC  X.
   320     05  FILLER                  PIC  X.
   321     05  W-CSO-SUMM              PIC  X.
   322     05  FILLER                  PIC  X.
   323     05  W-REASONS-REQUIRED      PIC  X.
   324     05  FILLER                  PIC  X(29).
   325******************************************************************
   326*                                                                *
   327*              A C C E S S   K E Y S                             *
   328*                                                                *
   329******************************************************************
   330
   331 01  ACCESS-KEYS.
   332     12  ERPYAJ-KEY.
   333         16  ERPYAJ-COMPANY-CD       PIC X.
   334         16  ERPYAJ-CARRIER          PIC X.
   335         16  ERPYAJ-GROUPING         PIC X(6).
   336         16  ERPYAJ-FIN-RESP         PIC X(10).
   337         16  ERPYAJ-ACCOUNT          PIC X(10).
   338         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   339         16  ERPYAJ-TYPE             PIC X.
   340     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   341     12  ELCERT-KEY.
   342         16  ELCERT-COMPANY-CD       PIC X.
   343         16  ELCERT-CARRIER          PIC X.
   344         16  ELCERT-GROUPING         PIC X(6).
   345         16  ELCERT-STATE            PIC XX.
   346         16  ELCERT-ACCOUNT          PIC X(10).
   347         16  ELCERT-CERT-EFF-DT      PIC XX.
   348         16  ELCERT-CERT-NO.
   349             20  ELCERT-CERT-PRIME   PIC X(10).
   350             20  ELCERT-CERT-SFX     PIC X.
   351
   352     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   353     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   354     12  ELCRTO-KEY.
   355         16  ELCRTO-COMPANY-CD       PIC X.
   356         16  ELCRTO-CARRIER          PIC X.
   357         16  ELCRTO-GROUPING         PIC X(6).
   358         16  ELCRTO-STATE            PIC XX.
   359         16  ELCRTO-ACCOUNT          PIC X(10).
   360         16  ELCRTO-CERT-EFF-DT      PIC XX.
   361         16  ELCRTO-CERT-NO.
   362             20  ELCRTO-CERT-PRIME   PIC X(10).
   363             20  ELCRTO-CERT-SFX     PIC X.
   364         16  ELCRTO-RECORD-TYPE      PIC X.
   365         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   366
   367     12  ELCRTT-KEY.
   368         16  ELCRTT-PRIMARY          PIC X(33).
   369         16  ELCRTT-REC-TYPE         PIC X(1).
   370     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   371     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   372
   373     12  ERPNDB-KEY.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page   9
* VP6311.cbl
   374         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   375         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   376         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   377         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   378             ERPNDB-BATCH-SEQ-NO     PIC XX.
   379         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   380
   381     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   382     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   383     12  ERCHEK-KEY.
   384         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   385         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   386         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   387         16  CHEK-STATE              PIC XX      VALUE SPACES.
   388         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   389         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   390         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   391         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   392         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   393     12  ELLETR-KEY.
   394         16  LETR-COMPANY-CD     PIC X.
   395         16  LETR-LETTER-ID      PIC X(4).
   396         16  LETR-FILLER         PIC X(8).
   397         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   398     12  ERPNDM-KEY.
   399         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   400         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   401         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   402         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   403
   404*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   405     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   406*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   407     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   408
   409     12  ERPNDB-ALT-KEY.
   410         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   411         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   412         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   413         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   414         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   415         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   416         16  ERPNDB-CERT-NO.
   417             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   418             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   419         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   420         16  ERPNDB-RECORD-TYPE      PIC X.
   421
   422      12  ERPNDB-CSR-KEY.
   423          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   424          20  ERPNDB-CSR-ID                PIC X(4).
   425          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   426          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   427          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   428
   429     12  ERNOTE-KEY.
   430         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   431         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  10
* VP6311.cbl
   432         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   433         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   434         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   435         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   436         16  ERNOTE-CERT-NO.
   437             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   438             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   439
   440     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   441     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   442
   443     12  ERCNOT-KEY.
   444         16  ERCNOT-PART-KEY.
   445             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   446             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   447             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   448             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   449             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   450             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   451             20  ERCNOT-CERT-NO.
   452                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   453                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   454         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   455         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   456
   457     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   458     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   459
   460     12  ERMAIL-KEY.
   461         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   462         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   463         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   464         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   465         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   466         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   467         16  ERMAIL-CERT-NO.
   468             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   469             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   470
   471     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   472     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   473
   474     12  ERRQST-KEY.
   475         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   476         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   477
   478     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   479     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   480
   481     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   482
   483     12  ERLOFC-KEY.
   484         16  ERLOFC-COMPANY-CD          PIC  X.
   485         16  ERLOFC-CARRIER             PIC  X.
   486         16  ERLOFC-GROUPING            PIC  X(6).
   487         16  ERLOFC-STATE               PIC  XX.
   488         16  ERLOFC-ACCOUNT             PIC  X(10).
   489         16  ERLOFC-OFFICER-CODE        PIC  X(5).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  11
* VP6311.cbl
   490*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   491
   492     12  ERACCT-KEY.
   493         16  ERACCT-COMPANY-CD          PIC  X.
   494         16  ERACCT-CARRIER             PIC  X.
   495         16  ERACCT-GROUPING            PIC  X(6).
   496         16  ERACCT-STATE               PIC  XX.
   497         16  ERACCT-ACCOUNT             PIC  X(10).
   498         16  ERACCT-EXP-DT.
   499             20  ERACCT-DT              PIC  XX.
   500             20  ERACCT-FILL            PIC  X(4).
   501
   502     12  ERENDT-KEY.
   503         16  ENDT-COMPANY-CD       PIC X.
   504         16  ENDT-CARRIER          PIC X.
   505         16  ENDT-GROUPING         PIC X(6).
   506         16  ENDT-STATE            PIC XX.
   507         16  ENDT-ACCOUNT          PIC X(10).
   508         16  ENDT-CERT-EFF-DT      PIC XX.
   509         16  ENDT-CERT-PRIME       PIC X(10).
   510         16  ENDT-CERT-SFX         PIC X.
   511         16  ENDT-RECORD-TYPE      PIC X.
   512         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   513
   514 01  WS-ELMSTR-WORK.
   515     12  ELMSTR-KEY.
   516         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   517         16  MSTR-CERT-NO.
   518             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   519             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   520     12  W-CLAIM-KEY.
   521         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   522         16  W-CL-CERT-NO.
   523             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   524             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   525      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   526 01  CANCEL-GEN-PASS-AREA.
   527     05  CG-OPTION-CODE          PIC X.
   528         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   529         88  CG-FLAT-CANCEL        VALUE '1'.
   530         88  CG-CANCEL             VALUE '2'.
   531         88  CG-CANCEL-REISSUE     VALUE '3'.
   532     05  CG-ERROR-CODE           PIC 99.
   533         88  CG-SUCCESS            VALUE 00.
   534         88  CG-DATE-ERROR         VALUE 01.
   535         88  CG-CERT-NOT-FOUND     VALUE 02.
   536         88  CG-AMOUNT-ERROR       VALUE 04.
   537         88  CG-OPTION-ERROR       VALUE 05.
   538         88  CG-PREV-CAN           VALUE 06.
   539         88  CG-INVALID-DATA       VALUE 07.
   540         88  CG-NO-ACCT-MSTR       VALUE 08.
   541         88  CG-SFX-A-EXIST        VALUE 09.
   542         88  CG-MISC-ERROR         VALUE 99.
   543     05  CG-COMPANY-ID           PIC XXX.
   544     05  CG-PROC-ID              PIC XXXX.
   545     05  CG-CURRENT-DT           PIC XX.
   546     05  CG-MONTH-END-DT         PIC XX.
   547     05  CG-CERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  12
* VP6311.cbl
   548         10  CG-CERT-COMPANY-CD  PIC X.
   549         10  CG-CERT-CARRIER     PIC X.
   550         10  CG-CERT-GROUP       PIC X(6).
   551         10  CG-CERT-STATE       PIC XX.
   552         10  CG-CERT-ACCOUNT     PIC X(10).
   553         10  CG-CERT-EFF-DT      PIC XX.
   554         10  CG-CERT-CERT-NO     PIC X(11).
   555     05  CG-LF-CAN-DATA.
   556         10  CG-LF-CAN-DT        PIC XX.
   557         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   558     05  CG-AH-CAN-DATA.
   559         10  CG-AH-CAN-DT        PIC XX.
   560         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   561     05  CG-CERT-PROFILE-DATA.
   562         10  CG-INS-LNAME        PIC X(15).
   563         10  CG-INS-FNAME        PIC X(10).
   564         10  CG-INS-MID-INIT     PIC X.
   565         10  CG-INS-AGE          PIC 99.
   566         10  CG-JNT-LNAME        PIC X(15).
   567         10  CG-JNT-FNAME        PIC X(10).
   568         10  CG-JNT-MID-INIT     PIC X.
   569         10  CG-JNT-AGE          PIC 99.
   570     05  CG-LF-ISS-DATA.
   571         10  CG-LF-BENCD         PIC XX.
   572         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   573         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   574     05  CG-AH-ISS-DATA.
   575         10  CG-AH-BENCD         PIC XX.
   576         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   577     05  CG-BATCH-NO             PIC X(6).
   578     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   579     05  FILLER                  PIC X(306).
   580******************************************************************
   581*                                                                *
   582*            G E N E R A L   W O R K   A R E A                   *
   583*                                                                *
   584******************************************************************
   585
   586 01  WORK-AREA.
   587     12  WS-RESPONSE             PIC S9(8)   COMP.
   588         88  RESP-NORMAL           VALUE +0.
   589         88  resp-file-notfnd      value +12.
   590         88  RESP-NOTFND           VALUE +13.
   591         88  resp-duprec           value +14.
   592         88  resp-dupkey           value +15.
   593         88  resp-invreq           value +16.
   594         88  RESP-NOTOPEN          VALUE +19.
   595         88  RESP-ENDFILE          VALUE +20.
   596         88  resp-lengtherr        value +22.
   597     12  DEEDIT-FIELD            PIC X(15).
   598     12  FILLER          REDEFINES DEEDIT-FIELD.
   599         16  FILLER              PIC X(4).
   600         16  DEEDIT-FIELD-X11    PIC X(11).
   601     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   602                                 PIC S9(15).
   603     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   604                                 PIC S9(13)V99.
   605     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  13
* VP6311.cbl
   606                                 PIC S9(11)V9999.
   607     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   608     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   609     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   610         16  WS-CALC-TERM-WHOLE  PIC S999.
   611         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   612
   613     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   614     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   615         16  WS-HR-MINS          PIC 99V99.
   616         16  FILLER              PIC XX.
   617
   618     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   619     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   620
   621     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   622     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   623
   624     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   625     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   626     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   627     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   628     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   629     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   630     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   631
   632     12  QID.
   633         16  QID-TERM            PIC X(4).
   634         16  FILLER              PIC X(4)    VALUE '607B'.
   635
   636     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   637         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   638
   639     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   640         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   641
   642     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   643         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   644                                         'A'.
   645
   646     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   647
   648     12  WS-NUMERIC-SW           PIC X.
   649        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   650
   651     12  WS-EDIT-CSO-FIELD.
   652         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   653                                 PIC X.
   654
   655     12  WS-SAVE-INPUT-FIELDS.
   656         16  WS-BAGE             PIC 99       VALUE ZERO.
   657*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   658         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   659         16  FILLER REDEFINES WS-BAPR.
   660             20  WS-APR-WHOLE-NUM    PIC 99.
   661             20  WS-APR-DEC          PIC 9999.
   662         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   663         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  14
* VP6311.cbl
   664
   665         16  WS-B-COVERAGE OCCURS 2 TIMES.
   666             20  WS-TERM-IN-DAYS-SW  PIC X.
   667                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   668             20  WS-BTERM        PIC 999       COMP-3.
   669             20  WS-BALT-TERM    PIC 999       COMP-3.
   670             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   671             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   672             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   673             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   674             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   675             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   676
   677         16  WS-C-FIELDS COMP-3.
   678             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   679             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   680             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   681
   682         16  WS-D-FIELDS COMP-3.
   683             20  WS-DRISS        PIC S9(5)    VALUE +0.
   684             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   685             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   686             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   687             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   688             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   689
   690     12  WS-SAVE-BIRTH-DATE.
   691         16  FILLER              PIC X(4)   VALUE SPACES.
   692         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   693
   694     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   695     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   696     12  FILLER REDEFINES WS-WORK-BIN-RED.
   697         16  FILLER              PIC X(02).
   698         16  WS-WORK-BIN-DT      PIC X(02).
   699     12  WS-SW-1                 PIC X     VALUE SPACE.
   700     12  WS-SW-2                 PIC X     VALUE SPACE.
   701     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   702         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   703     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   704         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   705
   706     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   707     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   708     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   709     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   710     12  WS-CONVERTED-CANCEL-DATES.
   711         16  WS-CONVERTED-CANDT1                  PIC XX.
   712         16  WS-CONVERTED-CANDT2                  PIC XX.
   713
   714     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   715
   716     12  WS-REC-FOUND-SW         PIC X.
   717         88  RECORD-NOT-FOUND    VALUE 'N'.
   718
   719     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   720         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   721         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  15
* VP6311.cbl
   722
   723     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   724         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   725         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   726
   727     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   728         88  BROWSE-STARTED      VALUE 'Y'.
   729
   730     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   731         88  FIRST-TIME          VALUE 'Y'.
   732
   733     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   734         88  FIRST-ENTRY         VALUE 'Y'.
   735
   736     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   737         88  REC-BILLED          VALUE 'Y'.
   738
   739     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   740         88  NO-CURSOR-SET       VALUE +0.
   741         88  CURSOR-SET          VALUE +1.
   742
   743     12  WS-ERR-SW               PIC X.
   744         88  STD-ERRORS          VALUE 'S'.
   745         88  TRN-ERRORS          VALUE 'T'.
   746
   747     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   748         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   749
   750     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   751         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   752
   753     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   754         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   755
   756     12  WS-ERR-CODE.
   757         16  FILLER              PIC 99.
   758         16  WS-ERROR-SUB        PIC 99.
   759
   760     12  WS-DATE-WORK.
   761         16  WS-WORK-MM          PIC XX.
   762         16  WS-WORK-DD          PIC XX.
   763         16  WS-WORK-YY          PIC XX.
   764
   765     12  WS-MM-YY.
   766         16  WS-MM               PIC XX.
   767         16  FILLER              PIC X     VALUE '/'.
   768         16  WS-YY               PIC XX.
   769
   770     12  WS-CERT-EFF-DT          PIC XX.
   771
   772     12  WS-MEMBER-NO            PIC X(12).
   773     12  FILLER  REDEFINES  WS-MEMBER-NO.
   774         16  WS-MEMBER-NO-1-8    PIC 9(8).
   775         16  FILLER              PIC X(4).
   776
   777     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   778
   779     12  WS-ERPNDB-ALT-KEY.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  16
* VP6311.cbl
   780         16  WS-PB-COMPANY-CD-A1         PIC X.
   781         16  WS-PB-CARRIER               PIC X.
   782         16  WS-PB-GROUPING              PIC X(6).
   783         16  WS-PB-STATE                 PIC XX.
   784         16  WS-PB-ACCOUNT               PIC X(10).
   785         16  WS-PB-CERT-EFF-DT           PIC XX.
   786         16  WS-PB-CERT-NO.
   787             20  WS-PB-CERT-PRIME        PIC X(10).
   788             20  WS-PB-CERT-SFX          PIC X.
   789         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   790         16  WS-PB-RECORD-TYPE           PIC X.
   791
   792     12  WS-SHOW-SAVE-AREAS.
   793         16  WS-NEW-CERT-NO.
   794             20  WS-NEW-PRIME    PIC X(10).
   795             20  WS-NEW-SUFFIX   PIC X.
   796         16  WS-NEW-CERT-EFF-DT  PIC XX.
   797         16  WS-NEW-RECORD-TYPE  PIC X.
   798         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   799             88   SHOW-RECORD            VALUE 'Y'.
   800
   801     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   802
   803     12  WS-BATCH-NO.
   804         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   805         16  FILLER              PIC X(5) VALUE SPACES.
   806
   807     12  WS-FIRST-NAME.
   808         16  WS-1ST-INIT         PIC X.
   809         16  FILLER              PIC X(9).
   810
   811     12  WS-INITIALS.
   812         16  WS-INITIAL-1        PIC X.
   813         16  WS-INITIAL-2        PIC X.
   814
   815     12  WS-C-HDG.
   816         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   817         16  FILLER              PIC X(4) VALUE '-REF'.
   818
   819     12  WS-D-PREM-HDG.
   820         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   821         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   822
   823     12  WS-D-REFUND-HDG.
   824         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   825         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   826
   827     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   828
   829     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   830     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   831     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   832     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   833     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   834     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   835     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   836
   837     12  WS-01-CANCEL-ERR        PIC X(25)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  17
* VP6311.cbl
   838         VALUE 'CANCEL DATE ERROR'.
   839     12  WS-02-CANCEL-ERR        PIC X(25)
   840         VALUE 'CERT NOT FOUND'.
   841     12  WS-04-CANCEL-ERR        PIC X(25)
   842         VALUE 'CANCEL AMOUNT ERROR'.
   843     12  WS-05-CANCEL-ERR        PIC X(25)
   844         VALUE 'CANCEL OPTION ERROR'.
   845     12  WS-06-CANCEL-ERR        PIC X(25)
   846         VALUE 'PREVIOUSLY CANCELLED'.
   847     12  WS-07-CANCEL-ERR        PIC X(25)
   848         VALUE 'INVALID DATA'.
   849     12  WS-08-CANCEL-ERR        PIC X(25)
   850         VALUE 'NO ACCOUNT MASTER'.
   851     12  WS-09-CANCEL-ERR        PIC X(25)
   852         VALUE 'SUFFIX ALREADY EXISTS'.
   853     12  WS-99-CANCEL-ERR        PIC X(25)
   854         VALUE 'MISC CANCEL ERROR'.
   855
   856     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   857     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   858
   859     12  WS-AGE-FIELDS.
   860         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   861         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   862         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   863         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   864
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  18
* VP6311.cbl
   866
   867******************************************************************
   868*                                                                *
   869*                 B A T C H   T O T A L S                        *
   870*                                                                *
   871******************************************************************
   872
   873     12  WS-BATCH-RECORD.
   874         16  FILLER                       PIC X(10).
   875         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   876         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   877         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   878         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   879         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   880         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   881         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   882         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   883         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   884         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   885         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   886         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   887         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   888         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   889         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   890         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   891         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   892         16  WS-ACCOUNT-NAME              PIC X(30).
   893         16  FILLER                       PIC X.
   894         16  WS-REFERENCE                 PIC X(12).
   895         16  FILLER                       PIC X(197).
   896
   897     12  WS-BATCH-TOTALS.
   898         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   899         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   900         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   901         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   902         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   903         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   904         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   905         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   906         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   907         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   908         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   909         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   910         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   911         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   912         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   913         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   914         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   915         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   916         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   917
   918     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   919
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  19
* VP6311.cbl
   921
   922******************************************************************
   923*                                                                *
   924*                E R R O R   M E S S A G E S                     *
   925*                                                                *
   926******************************************************************
   927
   928 01  ERROR-MESSAGES.
   929     12  ER-0004                 PIC  9(4) VALUE 0004.
   930     12  ER-0008                 PIC  9(4) VALUE 0008.
   931     12  ER-0023                 PIC  9(4) VALUE 0023.
   932     12  ER-0029                 PIC  9(4) VALUE 0029.
   933     12  ER-0033                 PIC  9(4) VALUE 0033.
   934     12  ER-0070                 PIC  9(4) VALUE 0070.
   935     12  ER-0220                 PIC  9(4) VALUE 0220.
   936     12  ER-0248                 PIC  9(4) VALUE 0248.
   937     12  ER-0280                 PIC  9(4) VALUE 0280.
   938     12  ER-0348                 PIC  9(4) VALUE 0348.
   939     12  ER-0582                 PIC  9(4) VALUE 0582.
   940     12  ER-0877                 PIC  9(4) VALUE 0877.
   941     12  ER-1236                 PIC  9(4) VALUE 1236.
   942     12  ER-1570                 PIC  9(4) VALUE 1570.
   943     12  ER-1575                 PIC  9(4) VALUE 1575.
   944     12  ER-1609                 PIC  9(4) VALUE 1609.
   945     12  ER-1819                 PIC  9(4) VALUE 1819.
   946     12  ER-2077                 PIC  9(4) VALUE 2077.
   947     12  ER-2129                 PIC  9(4) VALUE 2129.
   948     12  ER-2188                 PIC  9(4) VALUE 2188.
   949     12  ER-2192                 PIC  9(4) VALUE 2192.
   950     12  ER-2196                 PIC  9(4) VALUE 2196.
   951     12  ER-2197                 PIC  9(4) VALUE 2197.
   952     12  ER-2198                 PIC  9(4) VALUE 2198.
   953     12  ER-2200                 PIC  9(4) VALUE 2200.
   954     12  ER-2212                 PIC  9(4) VALUE 2212.
   955     12  ER-2218                 PIC  9(4) VALUE 2218.
   956     12  ER-2220                 PIC  9(4) VALUE 2220.
   957     12  ER-2222                 PIC  9(4) VALUE 2222.
   958     12  ER-2223                 PIC  9(4) VALUE 2223.
   959     12  ER-2224                 PIC  9(4) VALUE 2224.
   960     12  ER-2225                 PIC  9(4) VALUE 2225.
   961     12  ER-2226                 PIC  9(4) VALUE 2226.
   962     12  ER-2227                 PIC  9(4) VALUE 2227.
   963     12  ER-2228                 PIC  9(4) VALUE 2228.
   964     12  ER-2240                 PIC  9(4) VALUE 2240.
   965     12  ER-2241                 PIC  9(4) VALUE 2241.
   966     12  ER-2242                 PIC  9(4) VALUE 2242.
   967     12  ER-2243                 PIC  9(4) VALUE 2243.
   968     12  ER-2244                 PIC  9(4) VALUE 2244.
   969     12  ER-2245                 PIC  9(4) VALUE 2245.
   970     12  ER-2246                 PIC  9(4) VALUE 2246.
   971     12  ER-2247                 PIC  9(4) VALUE 2247.
   972     12  ER-2251                 PIC  9(4) VALUE 2251.
   973     12  ER-2252                 PIC  9(4) VALUE 2252.
   974     12  ER-2253                 PIC  9(4) VALUE 2253.
   975     12  ER-2254                 PIC  9(4) VALUE 2254.
   976     12  ER-2255                 PIC  9(4) VALUE 2255.
   977     12  ER-2256                 PIC  9(4) VALUE 2256.
   978     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  20
* VP6311.cbl
   979     12  ER-2258                 PIC  9(4) VALUE 2258.
   980     12  ER-2259                 PIC  9(4) VALUE 2259.
   981     12  ER-2260                 PIC  9(4) VALUE 2260.
   982     12  ER-2261                 PIC  9(4) VALUE 2261.
   983     12  ER-2287                 PIC  9(4) VALUE 2287.
   984     12  ER-2336                 PIC  9(4) VALUE 2336.
   985     12  ER-2337                 PIC  9(4) VALUE 2337.
   986     12  ER-2437                 PIC  9(4) VALUE 2437.
   987     12  ER-2471                 PIC  9(4) VALUE 2471.
   988     12  ER-2530                 PIC  9(4) VALUE 2530.
   989     12  ER-2531                 PIC  9(4) VALUE 2531.
   990     12  ER-2532                 PIC  9(4) VALUE 2532.
   991     12  ER-2533                 PIC  9(4) VALUE 2533.
   992     12  ER-2547                 PIC  9(4) VALUE 2547.
   993     12  ER-2591                 PIC  9(4) VALUE 2591.
   994     12  ER-2592                 PIC  9(4) VALUE 2592.
   995     12  ER-2593                 PIC  9(4) VALUE 2593.
   996     12  ER-2600                 PIC  9(4) VALUE 2600.
   997     12  ER-2601                 PIC  9(4) VALUE 2601.
   998     12  ER-2604                 PIC  9(4) VALUE 2604.
   999     12  ER-2605                 PIC  9(4) VALUE 2605.
  1000     12  ER-2606                 PIC  9(4) VALUE 2606.
  1001     12  ER-2607                 PIC  9(4) VALUE 2607.
  1002     12  ER-2622                 PIC  9(4) VALUE 2622.
  1003     12  ER-2625                 PIC  9(4) VALUE 2625.
  1004     12  ER-2626                 PIC  9(4) VALUE 2626.
  1005     12  ER-2627                 PIC  9(4) VALUE 2627.
  1006     12  ER-2628                 PIC  9(4) VALUE 2628.
  1007     12  ER-2629                 PIC  9(4) VALUE 2629.
  1008     12  ER-2630                 PIC  9(4) VALUE 2630.
  1009     12  ER-2631                 PIC  9(4) VALUE 2631.
  1010     12  ER-2632                 PIC  9(4) VALUE 2632.
  1011     12  ER-2633                 PIC  9(4) VALUE 2633.
  1012     12  ER-2634                 PIC  9(4) VALUE 2634.
  1013     12  ER-2635                 PIC  9(4) VALUE 2635.
  1014     12  ER-2636                 PIC  9(4) VALUE 2636.
  1015     12  ER-2639                 PIC  9(4) VALUE 2639.
  1016     12  ER-2640                 PIC  9(4) VALUE 2640.
  1017     12  ER-2647                 PIC  9(4) VALUE 2647.
  1018     12  ER-2648                 PIC  9(4) VALUE 2648.
  1019     12  ER-2649                 PIC  9(4) VALUE 2649.
  1020     12  ER-2650                 PIC  9(4) VALUE 2650.
  1021     12  ER-2653                 PIC  9(4) VALUE 2653.
  1022     12  ER-2654                 PIC  9(4) VALUE 2654.
  1023     12  ER-2655                 PIC  9(4) VALUE 2655.
  1024     12  ER-2656                 PIC  9(4) VALUE 2656.
  1025     12  ER-2657                 PIC  9(4) VALUE 2657.
  1026     12  ER-2660                 PIC  9(4) VALUE 2660.
  1027     12  ER-2661                 PIC  9(4) VALUE 2661.
  1028     12  ER-2662                 PIC  9(4) VALUE 2662.
  1029     12  ER-2663                 PIC  9(4) VALUE 2663.
  1030     12  ER-2664                 PIC  9(4) VALUE 2664.
  1031     12  ER-2667                 PIC  9(4) VALUE 2667.
  1032     12  ER-2668                 PIC  9(4) VALUE 2668.
  1033     12  ER-2669                 PIC  9(4) VALUE 2669.
  1034     12  ER-2670                 PIC  9(4) VALUE 2670.
  1035     12  ER-2671                 PIC  9(4) VALUE 2671.
  1036     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  21
* VP6311.cbl
  1037     12  ER-2673                 PIC  9(4) VALUE 2673.
  1038     12  ER-2677                 PIC  9(4) VALUE 2677.
  1039     12  ER-2678                 PIC  9(4) VALUE 2678.
  1040     12  ER-2679                 PIC  9(4) VALUE 2679.
  1041     12  ER-2680                 PIC  9(4) VALUE 2680.
  1042     12  ER-2681                 PIC  9(4) VALUE 2681.
  1043     12  ER-2682                 PIC  9(4) VALUE 2682.
  1044     12  ER-2683                 PIC  9(4) VALUE 2683.
  1045     12  ER-2684                 PIC  9(4) VALUE 2684.
  1046     12  ER-2686                 PIC  9(4) VALUE 2686.
  1047     12  ER-2689                 PIC  9(4) VALUE 2689.
  1048     12  ER-2690                 PIC  9(4) VALUE 2690.
  1049     12  ER-2693                 PIC  9(4) VALUE 2693.
  1050     12  ER-2695                 PIC  9(4) VALUE 2695.
  1051     12  ER-2701                 PIC  9(4) VALUE 2701.
  1052     12  ER-2720                 PIC  9(4) VALUE 2720.
  1053     12  ER-2709                 PIC  9(4) VALUE 2709.
  1054     12  ER-2704                 PIC  9(4) VALUE 2704.
  1055     12  ER-2725                 PIC  9(4) VALUE 2725.
  1056     12  ER-2726                 PIC  9(4) VALUE 2726.
  1057     12  ER-2728                 PIC  9(4) VALUE 2728.
  1058     12  ER-2729                 PIC  9(4) VALUE 2729.
  1059     12  ER-2731                 PIC  9(4) VALUE 2731.
  1060     12  ER-2732                 PIC  9(4) VALUE 2732.
  1061     12  ER-2733                 PIC  9(4) VALUE 2733.
  1062     12  ER-2735                 PIC  9(4) VALUE 2735.
  1063     12  ER-2738                 PIC  9(4) VALUE 2738.
  1064     12  ER-2742                 PIC  9(4) VALUE 2742.
  1065     12  ER-2743                 PIC  9(4) VALUE 2743.
  1066     12  ER-2744                 PIC  9(4) VALUE 2744.
  1067     12  ER-2747                 PIC  9(4) VALUE 2747.
  1068     12  ER-2749                 PIC  9(4) VALUE 2749.
  1069     12  ER-2753                 PIC  9(4) VALUE 2753.
  1070     12  ER-2755                 PIC  9(4) VALUE 2755.
  1071     12  ER-2757                 PIC  9(4) VALUE 2757.
  1072     12  ER-2771                 PIC  9(4) VALUE 2771.
  1073     12  ER-2774                 PIC  9(4) VALUE 2774.
  1074     12  ER-2775                 PIC  9(4) VALUE 2775.
  1075     12  ER-2776                 PIC  9(4) VALUE 2776.
  1076     12  ER-2777                 PIC  9(4) VALUE 2777.
  1077     12  ER-2794                 PIC  9(4) VALUE 2794.
  1078     12  ER-2799                 PIC  9(4) VALUE 2799.
  1079     12  ER-2900                 PIC  9(4) VALUE 2900.
  1080     12  ER-2902                 PIC  9(4) VALUE 2902.
  1081     12  ER-2945                 PIC  9(4) VALUE 2945.
  1082     12  ER-3000                 PIC  9(4) VALUE 3000.
  1083     12  ER-3006                 PIC  9(4) VALUE 3006.
  1084     12  ER-3054                 PIC  9(4) VALUE 3054.
  1085     12  ER-3224                 PIC  9(4) VALUE 3224.
  1086     12  ER-3269                 PIC  9(4) VALUE 3269.
  1087     12  er-3444                 pic  9(4) value 3444.
  1088     12  er-3446                 pic  9(4) value 3446.
  1089     12  er-3447                 pic  9(4) value 3447.
  1090     12  er-3448                 pic  9(4) value 3448.
  1091     12  er-3449                 pic  9(4) value 3449.
  1092     12  ER-3456                 PIC  9(4) VALUE 3456.
  1093     12  ER-3457                 PIC  9(4) VALUE 3457.
  1094     12  ER-3458                 PIC  9(4) VALUE 3458.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  22
* VP6311.cbl
  1095     12  ER-3504                 PIC  9(4) VALUE 3504.
  1096     12  ER-3513                 PIC  9(4) VALUE 3513.
  1097     12  ER-3831                 PIC  9(4) VALUE 3831.
  1098     12  ER-3834                 PIC  9(4) VALUE 3834.
  1099     12  ER-3835                 PIC  9(4) VALUE 3835.
  1100     12  ER-4005                 PIC  9(4) VALUE 4005.
  1101     12  ER-7144                 PIC  9(4) VALUE 7144.
  1102     12  ER-7401                 PIC  9(4) VALUE 7401.
  1103     12  ER-7402                 PIC  9(4) VALUE 7402.
  1104     12  ER-7403                 PIC  9(4) VALUE 7403.
  1105     12  ER-7404                 PIC  9(4) VALUE 7404.
  1106     12  ER-7423                 PIC  9(4) VALUE 7423.
  1107     12  ER-7424                 PIC  9(4) VALUE 7424.
  1108     12  ER-7433                 PIC  9(4) VALUE 7433.
  1109     12  ER-7450                 PIC  9(4) VALUE 7450.
  1110     12  ER-7451                 PIC  9(4) VALUE 7451.
  1111     12  ER-7530                 PIC  9(4) VALUE 7530.
  1112     12  ER-7573                 PIC  9(4) VALUE 7573.
  1113     12  ER-7631                 PIC  9(4) VALUE 7631.
  1114     12  ER-7632                 PIC  9(4) VALUE 7632.
  1115     12  ER-7633                 PIC  9(4) VALUE 7633.
  1116     12  ER-7537                 PIC  9(4) VALUE 7537.
  1117     12  ER-7538                 PIC  9(4) VALUE 7538.
  1118     12  ER-7574                 PIC  9(4) VALUE 7574.
  1119     12  ER-7997                 PIC  9(4) VALUE 7997.
  1120     12  ER-7998                 PIC  9(4) VALUE 7998.
  1121     12  ER-8148                 PIC  9(4) VALUE 8148.
  1122     12  ER-9063                 PIC  9(4) VALUE 9063.
  1123     12  ER-9076                 PIC  9(4) VALUE 9076.
  1124     12  ER-9618                 PIC  9(4) VALUE 9618.
  1125     12  ER-9841                 PIC  9(4) VALUE 9841.
  1126
  1127*                                COPY ELCTEXT.
  1128******************************************************************
  1129*                                                                *
  1130*                                                                *
  1131*                            ELCTEXT.                            *
  1132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1133*                            VMOD=2.008                          *
  1134*                                                                *
  1135*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1136*                                     FORM LETTERS,              *
  1137*                                     CERT FORM DISPLAY.
  1138*                                                                *
  1139*   FILE TYPE = VSAM,KSDS                                        *
  1140*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1141*                                                                *
  1142*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1143*       ALTERNATE INDEX = NONE                                   *
  1144*                                                                *
  1145*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1146*       ALTERNATE INDEX = NONE                                   *
  1147*                                                                *
  1148*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1149*       ALTERNATE INDEX = NONE                                   *
  1150*                                                                *
  1151*   LOG = NO                                                     *
  1152*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  23
* VP6311.cbl
  1153******************************************************************
  1154 01  TEXT-FILES.
  1155     12  TEXT-FILE-ID                PIC XX.
  1156         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1157         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1158         88  HELP-FILE-TEXT             VALUE 'TH'.
  1159
  1160     12  TX-CONTROL-PRIMARY.
  1161         16  TX-COMPANY-CD           PIC X.
  1162             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1163         16  TX-ACCESS-CD-GENL       PIC X(12).
  1164
  1165         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1166             20  TX-LETTER-NO        PIC X(4).
  1167             20  FILLER              PIC X(8).
  1168
  1169         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1170             20  TX-FORM-NO          PIC X(12).
  1171
  1172         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1173             20  TX-HELP-TYPE        PIC X.
  1174                 88  HELP-FOR-GENERAL   VALUE ' '.
  1175                 88  HELP-BY-SCREEN     VALUE 'S'.
  1176                 88  HELP-BY-ERROR      VALUE 'E'.
  1177             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1178                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1179             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1180                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1181             20  FILLER              PIC X(4).
  1182
  1183         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1184
  1185     12  TX-PROCESS-CONTROL          PIC XX.
  1186         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1187
  1188     12  TX-TEXT-LINE                PIC X(70).
  1189
  1190     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1191         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1192         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1193         88  TX-VALID-FORM-SQUEEZE-VALUE
  1194                                        VALUE 'Y' ' '.
  1195
  1196     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1197         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1198         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1199         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1200         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1201         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1202         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1203         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1204                                              'K' 'N' ' '
  1205                                              'Z'.
  1206
  1207     12  TX-ARCHIVE-SW               PIC X.
  1208         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1209         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1210         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  24
* VP6311.cbl
  1211
  1212     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1213     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1214
  1215     12  TX-BSR-CODE                 PIC X.
  1216         88  TX-BSR-LETTER              VALUE 'B'.
  1217         88  TX-NON-BSR-LETTER          VALUE ' '.
  1218
  1219     12  FILLER                      PIC X.
  1220*****************************************************************
  1221*                                COPY ELCCRTO.
  1222******************************************************************
  1223*                                                                *
  1224*                            ELCCRTO.                            *
  1225*                                                                *
  1226*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1227*                                                                *
  1228*   FILE TYPE = VSAM,KSDS                                        *
  1229*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1230*                                                                *
  1231*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1232*                                                                *
  1233*   LOG = YES                                                    *
  1234*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1235******************************************************************
  1236*                   C H A N G E   L O G
  1237*
  1238* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1239*-----------------------------------------------------------------
  1240*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1241* EFFECTIVE    NUMBER
  1242*-----------------------------------------------------------------
  1243* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1244* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1245* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1246* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1247* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1248******************************************************************
  1249 01  ORIGINAL-CERTIFICATE.
  1250     12  OC-RECORD-ID                      PIC XX.
  1251         88  VALID-OC-ID                      VALUE 'OC'.
  1252     12  OC-CONTROL-PRIMARY.
  1253         16  OC-COMPANY-CD                 PIC X.
  1254         16  OC-CARRIER                    PIC X.
  1255         16  OC-GROUPING                   PIC X(6).
  1256         16  OC-STATE                      PIC XX.
  1257         16  OC-ACCOUNT                    PIC X(10).
  1258         16  OC-CERT-EFF-DT                PIC XX.
  1259         16  OC-CERT-NO.
  1260             20  OC-CERT-PRIME             PIC X(10).
  1261             20  OC-CERT-SFX               PIC X.
  1262         16  OC-RECORD-TYPE                PIC X.
  1263         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1264     12  OC-LAST-MAINT-DT                  PIC XX.
  1265     12  OC-LAST-MAINT-BY                  PIC X(4).
  1266     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1267     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1268     12  FILLER                            PIC X(49).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  25
* VP6311.cbl
  1269     12  OC-ORIG-REC.
  1270         16  OC-INS-LAST-NAME              PIC X(15).
  1271         16  OC-INS-FIRST-NAME             PIC X(10).
  1272         16  OC-INS-MIDDLE-INIT            PIC X.
  1273         16  OC-INS-AGE                    PIC S999     COMP-3.
  1274         16  OC-JNT-LAST-NAME              PIC X(15).
  1275         16  OC-JNT-FIRST-NAME             PIC X(10).
  1276         16  OC-JNT-MIDDLE-INIT            PIC X.
  1277         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1278         16  OC-LF-BENCD                   PIC XX.
  1279         16  OC-LF-TERM                    PIC S999      COMP-3.
  1280         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1281         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1282         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1283         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1284         16  OC-LF-EXP-DT                  PIC XX.
  1285         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1286         16  OC-LF-CANCEL-DT               PIC XX.
  1287         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1288         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1289         16  OC-AH-BENCD                   PIC XX.
  1290         16  OC-AH-TERM                    PIC S999      COMP-3.
  1291         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1292         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1293         16  OC-AH-EXP-DT                  PIC XX.
  1294         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1295         16  OC-AH-CP                      PIC 99.
  1296         16  OC-AH-CANCEL-DT               PIC XX.
  1297         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1298         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1299         16  OC-CRED-BENE-NAME             PIC X(25).
  1300         16  OC-1ST-PMT-DT                 PIC XX.
  1301         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1302         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1303         16  OC-ISSUE-TRAN-IND             PIC X.
  1304         16  OC-CANCEL-TRAN-IND            PIC X.
  1305         16  FILLER                        PIC X(211).
  1306
  1307     12  FILLER                            PIC X(50).
  1308******************************************************************
  1309*                                COPY ERCACCT.
  1310******************************************************************
  1311*                                                                *
  1312*                                                                *
  1313*                            ERCACCT                             *
  1314*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1315*                            VMOD=2.031                          *
  1316*                                                                *
  1317*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1318*                                                                *
  1319*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1320*   VSAM ACCOUNT MASTER FILES.                                   *
  1321*                                                                *
  1322*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1323*                                                                *
  1324*   FILE TYPE = VSAM,KSDS                                        *
  1325*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1326*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  26
* VP6311.cbl
  1327*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1328*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1329*                                                                *
  1330*   LOG = NO                                                     *
  1331*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1332*                                                                *
  1333*                                                                *
  1334******************************************************************
  1335*                   C H A N G E   L O G
  1336*
  1337* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1338*-----------------------------------------------------------------
  1339*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1340* EFFECTIVE    NUMBER
  1341*-----------------------------------------------------------------
  1342* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1343* 092705    2005050300006  PEMA  ADD SPP LEASES
  1344* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1345* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1346* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1347* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1348* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1349* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1350******************************************************************
  1351
  1352 01  ACCOUNT-MASTER.
  1353     12  AM-RECORD-ID                      PIC XX.
  1354         88  VALID-AM-ID                      VALUE 'AM'.
  1355
  1356     12  AM-CONTROL-PRIMARY.
  1357         16  AM-COMPANY-CD                 PIC X.
  1358         16  AM-MSTR-CNTRL.
  1359             20  AM-CONTROL-A.
  1360                 24  AM-CARRIER            PIC X.
  1361                 24  AM-GROUPING.
  1362                     28 AM-GROUPING-PREFIX PIC XXX.
  1363                     28 AM-GROUPING-PRIME  PIC XXX.
  1364                 24  AM-STATE              PIC XX.
  1365                 24  AM-ACCOUNT.
  1366                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1367                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1368             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1369                                           PIC X(19).
  1370             20  AM-CNTRL-B.
  1371                 24  AM-EXPIRATION-DT      PIC XX.
  1372                 24  FILLER                PIC X(4).
  1373             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1374                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1375
  1376     12  AM-CONTROL-BY-VAR-GRP.
  1377         16  AM-COMPANY-CD-A1              PIC X.
  1378         16  AM-VG-CARRIER                 PIC X.
  1379         16  AM-VG-GROUPING                PIC X(6).
  1380         16  AM-VG-STATE                   PIC XX.
  1381         16  AM-VG-ACCOUNT                 PIC X(10).
  1382         16  AM-VG-DATE.
  1383             20  AM-VG-EXPIRATION-DT       PIC XX.
  1384             20  FILLER                    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  27
* VP6311.cbl
  1385         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1386                                           PIC 9(11)      COMP-3.
  1387     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1388         16  FILLER                        PIC X(10).
  1389         16  AM-VG-KEY3.
  1390             20  AM-VG3-ACCOUNT            PIC X(10).
  1391             20  AM-VG3-EXP-DT             PIC XX.
  1392         16  FILLER                        PIC X(4).
  1393     12  AM-MAINT-INFORMATION.
  1394         16  AM-LAST-MAINT-DT              PIC XX.
  1395         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1396         16  AM-LAST-MAINT-USER            PIC X(4).
  1397         16  FILLER                        PIC XX.
  1398
  1399     12  AM-EFFECTIVE-DT                   PIC XX.
  1400     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1401
  1402     12  AM-PREV-DATES  COMP-3.
  1403         16  AM-PREV-EXP-DT                PIC 9(11).
  1404         16  AM-PREV-EFF-DT                PIC 9(11).
  1405
  1406     12  AM-REPORT-CODE-1                  PIC X(10).
  1407     12  AM-REPORT-CODE-2                  PIC X(10).
  1408
  1409     12  AM-CITY-CODE                      PIC X(4).
  1410     12  AM-COUNTY-PARISH                  PIC X(6).
  1411
  1412     12  AM-NAME                           PIC X(30).
  1413     12  AM-PERSON                         PIC X(30).
  1414     12  AM-ADDRS                          PIC X(30).
  1415     12  AM-CITY.
  1416         16  AM-ADDR-CITY                  PIC X(28).
  1417         16  AM-ADDR-STATE                 PIC XX.
  1418     12  AM-ZIP.
  1419         16  AM-ZIP-PRIME.
  1420             20  AM-ZIP-PRI-1ST            PIC X.
  1421                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1422             20  FILLER                    PIC X(4).
  1423         16  AM-ZIP-PLUS4                  PIC X(4).
  1424     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1425         16  AM-CAN-POSTAL-1               PIC XXX.
  1426         16  AM-CAN-POSTAL-2               PIC XXX.
  1427         16  FILLER                        PIC XXX.
  1428     12  AM-TEL-NO.
  1429         16  AM-AREA-CODE                  PIC 999.
  1430         16  AM-TEL-PRE                    PIC 999.
  1431         16  AM-TEL-NBR                    PIC 9(4).
  1432     12  AM-TEL-LOC                        PIC X.
  1433         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1434         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1435
  1436     12  AM-COMM-STRUCTURE.
  1437         16  AM-DEFN-1.
  1438             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1439                 24  AM-AGT.
  1440                     28  AM-AGT-PREFIX     PIC X(4).
  1441                     28  AM-AGT-PRIME      PIC X(6).
  1442                 24  AM-COM-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  28
* VP6311.cbl
  1443                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1444                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1445                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1446                 24  AM-RECALC-LV-INDIC    PIC X.
  1447                 24  AM-RETRO-LV-INDIC     PIC X.
  1448                 24  AM-GL-CODES           PIC X.
  1449                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1450                 24  FILLER                PIC X(01).
  1451         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1452             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1453                 24  FILLER                PIC X(11).
  1454                 24  AM-L-COMA             PIC XXX.
  1455                 24  AM-J-COMA             PIC XXX.
  1456                 24  AM-A-COMA             PIC XXX.
  1457                 24  FILLER                PIC X(6).
  1458
  1459     12  AM-COMM-CHANGE-STATUS             PIC X.
  1460         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1461
  1462     12  AM-CSR-CODE                       PIC X(4).
  1463
  1464     12  AM-BILLING-STATUS                 PIC X.
  1465         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1466         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1467     12  AM-AUTO-REFUND-SW                 PIC X.
  1468         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1469         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1470     12  AM-GPCD                           PIC 99.
  1471     12  AM-IG                             PIC X.
  1472         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1473         88  AM-HAS-GROUP                     VALUE '2'.
  1474     12  AM-STATUS                         PIC X.
  1475         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1476         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1477         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1478         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1479         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1480         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1481         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1482         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1483         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1484         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1485     12  AM-REMIT-TO                       PIC 99.
  1486     12  AM-ID-NO                          PIC X(11).
  1487
  1488     12  AM-CAL-TABLE                      PIC XX.
  1489     12  AM-LF-DEVIATION                   PIC XXX.
  1490     12  AM-AH-DEVIATION                   PIC XXX.
  1491     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1492     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1493     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1494     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1495     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1496     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1497
  1498     12  AM-USER-FIELDS.
  1499         16  AM-FLD-1                      PIC XX.
  1500         16  AM-FLD-2                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  29
* VP6311.cbl
  1501         16  AM-FLD-3                      PIC XX.
  1502         16  AM-FLD-4                      PIC XX.
  1503         16  AM-FLD-5                      PIC XX.
  1504
  1505     12  AM-1ST-PROD-DATE.
  1506         16  AM-1ST-PROD-YR                PIC XX.
  1507         16  AM-1ST-PROD-MO                PIC XX.
  1508         16  AM-1ST-PROD-DA                PIC XX.
  1509     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1510     12  AM-CERTS-PURGED-DATE.
  1511         16  AM-PUR-YR                     PIC XX.
  1512         16  AM-PUR-MO                     PIC XX.
  1513         16  AM-PUR-DA                     PIC XX.
  1514     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1515     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1516     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1517     12  AM-INACTIVE-DATE.
  1518         16  AM-INA-MO                     PIC 99.
  1519         16  AM-INA-DA                     PIC 99.
  1520         16  AM-INA-YR                     PIC 99.
  1521     12  AM-AR-HI-CERT-DATE                PIC XX.
  1522
  1523     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1524     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1525
  1526     12  AM-OB-PAYMENT-MODE                PIC X.
  1527         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1528         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1529         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1530         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1531
  1532     12  AM-AH-ONLY-INDICATOR              PIC X.
  1533         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1534         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1535
  1536     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1537
  1538     12  AM-OVER-SHORT.
  1539         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1540         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1541
  1542     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1543     12  AM-DCC-CLP-STATE                  PIC XX.
  1544
  1545     12  AM-RECALC-COMM                    PIC X.
  1546     12  AM-RECALC-REIN                    PIC X.
  1547
  1548     12  AM-REI-TABLE                      PIC XXX.
  1549     12  AM-REI-ET-LF                      PIC X.
  1550     12  AM-REI-ET-AH                      PIC X.
  1551     12  AM-REI-PE-LF                      PIC X.
  1552     12  AM-REI-PE-AH                      PIC X.
  1553     12  AM-REI-PRT-ST                     PIC X.
  1554     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1555     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1556     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1557     12  AM-REI-GROUP-A                    PIC X(6).
  1558     12  AM-REI-MORT                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  30
* VP6311.cbl
  1559     12  AM-REI-PRT-OW                     PIC X.
  1560     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1561     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1562     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1563     12  AM-REI-GROUP-B                    PIC X(6).
  1564
  1565     12  AM-TRUST-TYPE                     PIC X(2).
  1566
  1567     12  AM-EMPLOYER-STMT-USED             PIC X.
  1568     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1569
  1570     12  AM-STD-AH-TYPE                    PIC XX.
  1571     12  AM-EARN-METHODS.
  1572         16  AM-EARN-METHOD-R              PIC X.
  1573             88 AM-REF-RL-R78                 VALUE 'R'.
  1574             88 AM-REF-RL-PR                  VALUE 'P'.
  1575             88 AM-REF-RL-MEAN                VALUE 'M'.
  1576             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1577         16  AM-EARN-METHOD-L              PIC X.
  1578             88 AM-REF-LL-R78                 VALUE 'R'.
  1579             88 AM-REF-LL-PR                  VALUE 'P'.
  1580             88 AM-REF-LL-MEAN                VALUE 'M'.
  1581             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1582         16  AM-EARN-METHOD-A              PIC X.
  1583             88 AM-REF-AH-R78                 VALUE 'R'.
  1584             88 AM-REF-AH-PR                  VALUE 'P'.
  1585             88 AM-REF-AH-MEAN                VALUE 'M'.
  1586             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1587             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1588             88 AM-REF-AH-NET                 VALUE 'N'.
  1589
  1590     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1591     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1592     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1593
  1594     12  AM-RET-Y-N                        PIC X.
  1595     12  AM-RET-P-E                        PIC X.
  1596     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1597     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1598     12  AM-RET-GRP                        PIC X(6).
  1599     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1600         16  AM-POOL-PRIME                 PIC XXX.
  1601         16  AM-POOL-SUB                   PIC XXX.
  1602     12  AM-RETRO-EARNINGS.
  1603         16  AM-RET-EARN-R                 PIC X.
  1604         16  AM-RET-EARN-L                 PIC X.
  1605         16  AM-RET-EARN-A                 PIC X.
  1606     12  AM-RET-ST-TAX-USE                 PIC X.
  1607         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1608         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1609     12  AM-RETRO-BEG-EARNINGS.
  1610         16  AM-RET-BEG-EARN-R             PIC X.
  1611         16  AM-RET-BEG-EARN-L             PIC X.
  1612         16  AM-RET-BEG-EARN-A             PIC X.
  1613     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1614     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1615
  1616     12  AM-USER-SELECT-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  31
* VP6311.cbl
  1617         16  AM-USER-SELECT-1              PIC X(10).
  1618         16  AM-USER-SELECT-2              PIC X(10).
  1619         16  AM-USER-SELECT-3              PIC X(10).
  1620         16  AM-USER-SELECT-4              PIC X(10).
  1621         16  AM-USER-SELECT-5              PIC X(10).
  1622
  1623     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1624
  1625     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1626
  1627     12  AM-RPT045A-SWITCH                 PIC X.
  1628         88  RPT045A-OFF                   VALUE 'N'.
  1629
  1630     12  AM-INSURANCE-LIMITS.
  1631         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1632         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1633
  1634     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1635         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1636
  1637     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1638         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1639         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1640
  1641     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1642
  1643     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1644     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1645     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1646     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1647     12  AM-DCC-UEF-STATE                  PIC XX.
  1648     12  FILLER                            PIC XXX.
  1649     12  AM-REPORT-CODE-3                  PIC X(10).
  1650*    12  FILLER                            PIC X(22).
  1651
  1652     12  AM-RESERVE-DATE.
  1653         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1654         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1655         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1656
  1657     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1658     12  AM-NOTIFICATION-TYPES.
  1659         16  AM-NOTIF-OF-LETTERS           PIC X.
  1660         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1661         16  AM-NOTIF-OF-REPORTS           PIC X.
  1662         16  AM-NOTIF-OF-STATUS            PIC X.
  1663
  1664     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1665         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1666         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1667         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1668         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1669
  1670     12  AM-BENEFIT-CONTROLS.
  1671         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1672             20  AM-BENEFIT-CODE           PIC XX.
  1673             20  AM-BENEFIT-TYPE           PIC X.
  1674             20  AM-BENEFIT-REVISION       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  32
* VP6311.cbl
  1675             20  AM-BENEFIT-REM-TERM       PIC X.
  1676             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1677             20  FILLER                    PIC XX.
  1678         16  FILLER                        PIC X(80).
  1679
  1680     12  AM-TRANSFER-DATA.
  1681         16  AM-TRANSFERRED-FROM.
  1682             20  AM-TRNFROM-CARRIER        PIC X.
  1683             20  AM-TRNFROM-GROUPING.
  1684                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1685                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1686             20  AM-TRNFROM-STATE          PIC XX.
  1687             20  AM-TRNFROM-ACCOUNT.
  1688                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1689                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1690             20  AM-TRNFROM-DTE            PIC XX.
  1691         16  AM-TRANSFERRED-TO.
  1692             20  AM-TRNTO-CARRIER          PIC X.
  1693             20  AM-TRNTO-GROUPING.
  1694                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1695                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1696             20  AM-TRNTO-STATE            PIC XX.
  1697             20  AM-TRNTO-ACCOUNT.
  1698                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1699                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1700             20  AM-TRNTO-DTE              PIC XX.
  1701         16  FILLER                        PIC X(10).
  1702
  1703     12  AM-SAVED-REMIT-TO                 PIC 99.
  1704
  1705     12  AM-COMM-STRUCTURE-SAVED.
  1706         16  AM-DEFN-1-SAVED.
  1707             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1708                 24  AM-AGT-SV             PIC X(10).
  1709                 24  AM-COM-TYP-SV         PIC X.
  1710                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1711                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1712                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1713                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1714                 24  FILLER                PIC X.
  1715                 24  AM-GL-CODES-SV        PIC X.
  1716                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1717                 24  FILLER                PIC X.
  1718         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1719             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1720                 24  FILLER                PIC X(11).
  1721                 24  AM-L-COMA-SV          PIC XXX.
  1722                 24  AM-J-COMA-SV          PIC XXX.
  1723                 24  AM-A-COMA-SV          PIC XXX.
  1724                 24  FILLER                PIC X(6).
  1725
  1726     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1727         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1728            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1729            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1730            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1731
  1732     12  AM-ORIG-DEALER-NO                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  33
* VP6311.cbl
  1733     12  FILLER                            PIC X(120).
  1734
  1735     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1736         16  AM-CONTROL-NAME               PIC X(30).
  1737         16  AM-EXECUTIVE-ONE.
  1738             20  AM-EXEC1-NAME             PIC X(15).
  1739             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1740                                                          COMP-3.
  1741             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1742                                                          COMP-3.
  1743         16  AM-EXECUTIVE-TWO.
  1744             20  AM-EXEC2-NAME             PIC X(15).
  1745             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1746                                                          COMP-3.
  1747             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1748                                                          COMP-3.
  1749
  1750     12  AM-RETRO-ADDITIONAL-DATA.
  1751         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1752         16  AM-RETRO-PREM-P-E             PIC X.
  1753         16  AM-RETRO-CLMS-P-I             PIC X.
  1754         16  AM-RETRO-RET-BRACKET-LF.
  1755             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1756                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1757                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1758             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1759                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1760                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1761             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1762                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1763                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1764         16  AM-RETRO-RET-BRACKET-AH.
  1765             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1766                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1767                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1768                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1769             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1770                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1771                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1772             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1773                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1774                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1775
  1776     12  AM-COMMENTS.
  1777         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1778
  1779     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1780         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1781         16  AM-FLI-BILLING-CODE           PIC X.
  1782         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1783         16  AM-FLI-UNITED-IDENT           PIC X.
  1784         16  AM-FLI-INTEREST-LOST-DATA.
  1785             20  AM-FLI-BANK-NO            PIC X(5).
  1786             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1787             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1788             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1789         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1790             20  AM-FLI-AGT                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  34
* VP6311.cbl
  1791             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1792             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1793         16  FILLER                        PIC X(102).
  1794
  1795     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1796         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1797             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1798             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1799             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1800             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1801             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1802         16  FILLER                          PIC X(10).
  1803******************************************************************
  1804*                                COPY ELCVADS.
  1805******************************************************************
  1806*                                                                *
  1807*                                                                *
  1808*                            ELCVADS.                            *
  1809*                                                                *
  1810*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1811*   ELVADS                  LENGTH = 350                         *
  1812******************************************************************
  1813******************************************************************
  1814*                   C H A N G E   L O G
  1815*
  1816* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1817*-----------------------------------------------------------------
  1818*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1819* EFFECTIVE    NUMBER
  1820*-----------------------------------------------------------------
  1821* 100111    2011022800001  AJRA  NAPERSOFT
  1822******************************************************************
  1823
  1824 01  VIRGINIA-DISCLOSURE.
  1825     12  VD-COMPANY-CD              PIC X.
  1826     12  VD-CARRIER                 PIC X.
  1827     12  VD-GROUPING.
  1828         20  VD-GROUPING-PREFIX     PIC XXX.
  1829         20  VD-GROUPING-PRIME      PIC XXX.
  1830     12  VD-STATE                   PIC XX.
  1831     12  VD-ACCOUNT.
  1832         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1833         20  VD-ACCOUNT-PRIME       PIC X(6).
  1834     12  VD-CERT-EFF-DT             PIC XX.
  1835     12  VD-CERT-NO.
  1836         20  VD-CERT-PRIME          PIC X(10).
  1837         20  VD-CERT-SFX            PIC X.
  1838     12  VD-ENTRY-BATCH             PIC X(6).
  1839     12  VD-CSR-ID                  PIC X(4).
  1840     12  VD-NAME.
  1841         20  VD-INSURED-LAST-NAME   PIC X(15).
  1842         20  VD-INSURED-FIRST-NAME.
  1843             24  VD-INSURED-1ST-INIT PIC X.
  1844             24  FILLER             PIC X(9).
  1845         20  VD-INSURED-MIDDLE-INIT PIC X.
  1846     12  VD-JOINT-INSURED.
  1847         20 VD-JOINT-LAST-NAME      PIC X(15).
  1848         20 VD-JOINT-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  35
* VP6311.cbl
  1849            24  VD-JOINT-FIRST-INIT PIC X.
  1850            24  FILLER              PIC X(9).
  1851         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1852     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1853     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1854     12  VD-INSURED-CITY-STATE.
  1855         20  VD-INSURED-CITY        PIC X(28).
  1856         20  VD-INSURED-STATE       PIC XX.
  1857     12  VD-INSURED-ZIP-CODE.
  1858         20  VD-INSURED-ZIP-PRIME.
  1859             24  VD-INSURED-ZIP-1   PIC X.
  1860                 88  VD-CANADIAN-POST-CODE
  1861                                       VALUE 'A' THRU 'Z'.
  1862             24  FILLER             PIC X(4).
  1863         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1864     12  VD-BENEFICIARY-NAME        PIC X(30).
  1865     12  VD-ACCOUNT-NAME            PIC X(30).
  1866     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1867     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1868     12  VD-1ST-PMT-DT              PIC XX.
  1869     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1870         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1871         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1872                                             '90' THRU '99'.
  1873     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1874                                    PIC XX.
  1875     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1876     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1877     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1878     12  VD-LF-TERM                 PIC S999   COMP-3.
  1879     12  VD-AH-BENEFIT-CD           PIC XX.
  1880         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1881         88  VD-INVALID-AH             VALUE '  ' '00'
  1882                                             '90' THRU '99'.
  1883     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1884     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1885     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1886     12  VD-AH-TERM                 PIC S999   COMP-3.
  1887     12  VD-LETTER-ID               PIC X(4).
  1888     12  VD-PROC-ID                 PIC X(4).
  1889     12  VD-COMP-ID                 PIC X(3).
  1890     12  VD-CURRENT-DATE            PIC XX.
  1891     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1892     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1893     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  36
* VP6311.cbl
  1895*    COPY ELCDATE.
  1896******************************************************************
  1897*                                                                *
  1898*                                                                *
  1899*                            ELCDATE.                            *
  1900*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1901*                            VMOD=2.003
  1902*                                                                *
  1903*                                                                *
  1904*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1905*                 LENGTH = 200                                   *
  1906******************************************************************
  1907
  1908 01  DATE-CONVERSION-DATA.
  1909     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1910     12  DC-OPTION-CODE                PIC X.
  1911         88  BIN-TO-GREG                VALUE ' '.
  1912         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1913         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1914         88  YMD-GREG-TO-BIN            VALUE '3'.
  1915         88  MDY-GREG-TO-BIN            VALUE '4'.
  1916         88  JULIAN-TO-BIN              VALUE '5'.
  1917         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1918         88  FIND-CENTURY               VALUE '7'.
  1919         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1920         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1921         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1922         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1923         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1924         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1925         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1926         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1927         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1928         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1929         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1930         88  BIN-3-TO-GREG              VALUE 'I'.
  1931         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1932         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1933         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1934         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1935         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1936         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1937         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1938         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1939         88  THREE-CHARACTER-BIN
  1940                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1941         88  GREGORIAN-TO-BIN
  1942                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1943         88  BIN-TO-GREGORIAN
  1944                  VALUES ' ' '1' 'I' '8' 'G'.
  1945         88  JULIAN-TO-BINARY
  1946                  VALUES '5' 'C' 'E' 'F'.
  1947     12  DC-ERROR-CODE                 PIC X.
  1948         88  NO-CONVERSION-ERROR        VALUE ' '.
  1949         88  DATE-CONVERSION-ERROR
  1950                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1951         88  DATE-IS-ZERO               VALUE '1'.
  1952         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  37
* VP6311.cbl
  1953         88  DATE-IS-INVALID            VALUE '3'.
  1954         88  DATE1-GREATER-DATE2        VALUE '4'.
  1955         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1956         88  DATE-INVALID-OPTION        VALUE '9'.
  1957         88  INVALID-CENTURY            VALUE 'A'.
  1958         88  ONLY-CENTURY               VALUE 'B'.
  1959         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1960         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1961     12  DC-END-OF-MONTH               PIC X.
  1962         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1963     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1964         88  USE-NORMAL-PROCESS         VALUE ' '.
  1965         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1966         88  ADJUST-UP-100-YRS          VALUE '2'.
  1967     12  FILLER                        PIC X.
  1968     12  DC-CONVERSION-DATES.
  1969         16  DC-BIN-DATE-1             PIC XX.
  1970         16  DC-BIN-DATE-2             PIC XX.
  1971         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1972         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1973                       DC-GREG-DATE-1-EDIT.
  1974             20  DC-EDIT1-MONTH        PIC 99.
  1975             20  SLASH1-1              PIC X.
  1976             20  DC-EDIT1-DAY          PIC 99.
  1977             20  SLASH1-2              PIC X.
  1978             20  DC-EDIT1-YEAR         PIC 99.
  1979         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1980         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1981                     DC-GREG-DATE-2-EDIT.
  1982             20  DC-EDIT2-MONTH        PIC 99.
  1983             20  SLASH2-1              PIC X.
  1984             20  DC-EDIT2-DAY          PIC 99.
  1985             20  SLASH2-2              PIC X.
  1986             20  DC-EDIT2-YEAR         PIC 99.
  1987         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1988         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1989                     DC-GREG-DATE-1-YMD.
  1990             20  DC-YMD-YEAR           PIC 99.
  1991             20  DC-YMD-MONTH          PIC 99.
  1992             20  DC-YMD-DAY            PIC 99.
  1993         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1994         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1995                      DC-GREG-DATE-1-MDY.
  1996             20  DC-MDY-MONTH          PIC 99.
  1997             20  DC-MDY-DAY            PIC 99.
  1998             20  DC-MDY-YEAR           PIC 99.
  1999         16  DC-GREG-DATE-1-ALPHA.
  2000             20  DC-ALPHA-MONTH        PIC X(10).
  2001             20  DC-ALPHA-DAY          PIC 99.
  2002             20  FILLER                PIC XX.
  2003             20  DC-ALPHA-CENTURY.
  2004                 24 DC-ALPHA-CEN-N     PIC 99.
  2005             20  DC-ALPHA-YEAR         PIC 99.
  2006         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2007         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2008         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2009         16  DC-JULIAN-DATE            PIC 9(05).
  2010         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  38
* VP6311.cbl
  2011                                       PIC 9(05).
  2012         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2013             20  DC-JULIAN-YEAR        PIC 99.
  2014             20  DC-JULIAN-DAYS        PIC 999.
  2015         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2016         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2017         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2018     12  DATE-CONVERSION-VARIBLES.
  2019         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2020         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2021             20  FILLER                PIC 9(3).
  2022             20  HOLD-CEN-1-CCYY.
  2023                 24  HOLD-CEN-1-CC     PIC 99.
  2024                 24  HOLD-CEN-1-YY     PIC 99.
  2025             20  HOLD-CEN-1-MO         PIC 99.
  2026             20  HOLD-CEN-1-DA         PIC 99.
  2027         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2028             20  HOLD-CEN-1-R-MO       PIC 99.
  2029             20  HOLD-CEN-1-R-DA       PIC 99.
  2030             20  HOLD-CEN-1-R-CCYY.
  2031                 24  HOLD-CEN-1-R-CC   PIC 99.
  2032                 24  HOLD-CEN-1-R-YY   PIC 99.
  2033             20  FILLER                PIC 9(3).
  2034         16  HOLD-CENTURY-1-X.
  2035             20  FILLER                PIC X(3)  VALUE SPACES.
  2036             20  HOLD-CEN-1-X-CCYY.
  2037                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2038                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2039             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2040             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2041         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2042             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2043             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2044             20  HOLD-CEN-1-R-X-CCYY.
  2045                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2046                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2047             20  FILLER                PIC XXX.
  2048         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2049         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2050         16  DC-JULIAN-DATE-1          PIC 9(07).
  2051         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2052             20  DC-JULIAN-1-CCYY.
  2053                 24  DC-JULIAN-1-CC    PIC 99.
  2054                 24  DC-JULIAN-1-YR    PIC 99.
  2055             20  DC-JULIAN-DA-1        PIC 999.
  2056         16  DC-JULIAN-DATE-2          PIC 9(07).
  2057         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2058             20  DC-JULIAN-2-CCYY.
  2059                 24  DC-JULIAN-2-CC    PIC 99.
  2060                 24  DC-JULIAN-2-YR    PIC 99.
  2061             20  DC-JULIAN-DA-2        PIC 999.
  2062         16  DC-GREG-DATE-A-EDIT.
  2063             20  DC-EDITA-MONTH        PIC 99.
  2064             20  SLASHA-1              PIC X VALUE '/'.
  2065             20  DC-EDITA-DAY          PIC 99.
  2066             20  SLASHA-2              PIC X VALUE '/'.
  2067             20  DC-EDITA-CCYY.
  2068                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  39
* VP6311.cbl
  2069                 24  DC-EDITA-YEAR     PIC 99.
  2070         16  DC-GREG-DATE-B-EDIT.
  2071             20  DC-EDITB-MONTH        PIC 99.
  2072             20  SLASHB-1              PIC X VALUE '/'.
  2073             20  DC-EDITB-DAY          PIC 99.
  2074             20  SLASHB-2              PIC X VALUE '/'.
  2075             20  DC-EDITB-CCYY.
  2076                 24  DC-EDITB-CENT     PIC 99.
  2077                 24  DC-EDITB-YEAR     PIC 99.
  2078         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2079         16  DC-GREG-DATE-CYMD-R REDEFINES
  2080                              DC-GREG-DATE-CYMD.
  2081             20  DC-CYMD-CEN           PIC 99.
  2082             20  DC-CYMD-YEAR          PIC 99.
  2083             20  DC-CYMD-MONTH         PIC 99.
  2084             20  DC-CYMD-DAY           PIC 99.
  2085         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2086         16  DC-GREG-DATE-MDCY-R REDEFINES
  2087                              DC-GREG-DATE-MDCY.
  2088             20  DC-MDCY-MONTH         PIC 99.
  2089             20  DC-MDCY-DAY           PIC 99.
  2090             20  DC-MDCY-CEN           PIC 99.
  2091             20  DC-MDCY-YEAR          PIC 99.
  2092    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2093        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2094    12  DC-EL310-DATE                  PIC X(21).
  2095    12  FILLER                         PIC X(28).
  2096
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  40
* VP6311.cbl
  2098*    COPY ELCLOGOF.
  2099******************************************************************
  2100*                                                                *
  2101*                                                                *
  2102*                            ELCLOGOF.                           *
  2103*                            VMOD=2.001                          *
  2104*                                                                *
  2105*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2106*                                                                *
  2107******************************************************************
  2108 01  CLASIC-LOGOFF.
  2109     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2110     12  LOGOFF-TEXT.
  2111         16  FILLER          PIC X(5)    VALUE SPACES.
  2112         16  LOGOFF-MSG.
  2113             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2114             20  FILLER      PIC X       VALUE SPACES.
  2115             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2116         16  FILLER          PIC X(80)
  2117           VALUE '* YOU ARE NOW LOGGED OFF'.
  2118         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2119         16  FILLER          PIC X       VALUE QUOTE.
  2120         16  LOGOFF-SYS-MSG  PIC X(17)
  2121           VALUE 'S CLAS-IC SYSTEM '.
  2122     12  TEXT-MESSAGES.
  2123         16  UNACCESS-MSG    PIC X(29)
  2124             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2125         16  PGMIDERR-MSG    PIC X(17)
  2126             VALUE 'PROGRAM NOT FOUND'.
  2127
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  41
* VP6311.cbl
  2129*    COPY ELCATTR.
  2130******************************************************************
  2131*                                                                *
  2132*                            ELCATTR.                            *
  2133*                            VMOD=2.001                          *
  2134*                                                                *
  2135*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2136*                                                                *
  2137*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2138*                                                                *
  2139*                   POS 1   P=PROTECTED                          *
  2140*                           U=UNPROTECTED                        *
  2141*                           S=ASKIP                              *
  2142*                   POS 2   A=ALPHA/NUMERIC                      *
  2143*                           N=NUMERIC                            *
  2144*                   POS 3   N=NORMAL                             *
  2145*                           B=BRIGHT                             *
  2146*                           D=DARK                               *
  2147*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2148*                           OF=MODIFIED DATA TAG OFF             *
  2149*                                                                *
  2150*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2151******************************************************************
  2152 01  ATTRIBUTE-LIST.
  2153     12  AL-PABOF            PIC X       VALUE 'Y'.
  2154     12  AL-PABON            PIC X       VALUE 'Z'.
  2155     12  AL-PADOF            PIC X       VALUE '%'.
  2156     12  AL-PADON            PIC X       VALUE '_'.
  2157     12  AL-PANOF            PIC X       VALUE '-'.
  2158     12  AL-PANON            PIC X       VALUE '/'.
  2159     12  AL-SABOF            PIC X       VALUE '8'.
  2160     12  AL-SABON            PIC X       VALUE '9'.
  2161     12  AL-SADOF            PIC X       VALUE '@'.
  2162     12  AL-SADON            PIC X       VALUE QUOTE.
  2163     12  AL-SANOF            PIC X       VALUE '0'.
  2164     12  AL-SANON            PIC X       VALUE '1'.
  2165     12  AL-UABOF            PIC X       VALUE 'H'.
  2166     12  AL-UABON            PIC X       VALUE 'I'.
  2167     12  AL-UADOF            PIC X       VALUE '<'.
  2168     12  AL-UADON            PIC X       VALUE '('.
  2169     12  AL-UANOF            PIC X       VALUE ' '.
  2170     12  AL-UANON            PIC X       VALUE 'A'.
  2171     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2172     12  AL-UNBON            PIC X       VALUE 'R'.
  2173     12  AL-UNDOF            PIC X       VALUE '*'.
  2174     12  AL-UNDON            PIC X       VALUE ')'.
  2175     12  AL-UNNOF            PIC X       VALUE '&'.
  2176     12  AL-UNNON            PIC X       VALUE 'J'.
  2177
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  42
* VP6311.cbl
  2179*    COPY ELCEMIB.
  2180******************************************************************
  2181*                                                                *
  2182*                                                                *
  2183*                            ELCEMIB.                            *
  2184*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2185*                            VMOD=2.005                          *
  2186*                                                                *
  2187*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2188*                                                                *
  2189******************************************************************
  2190 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2191     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2192     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2193     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2194     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2195     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2196     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2197     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2198     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2199     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2200         88  EMI-NO-ERRORS                    VALUE '1'.
  2201         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2202         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2203     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2204         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2205     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2206         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2207         88  EMI-AREA1-FULL                   VALUE '2'.
  2208     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2209         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2210         88  EMI-AREA2-FULL                   VALUE '2'.
  2211     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2212         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2213         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2214         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2215         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2216         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2217     12  EMI-ERROR-LINES.
  2218         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2219         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2220         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2221         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2222             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2223                 24  EMI-ERR-NUM         PIC X(4).
  2224                 24  EMI-FILLER          PIC X.
  2225                 24  EMI-SEV             PIC X.
  2226                 24  FILLER              PIC X.
  2227             20  FILLER                  PIC X(02).
  2228     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2229         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2230             20  EMI-ERROR-NUMBER    PIC X(4).
  2231             20  EMI-FILL            PIC X.
  2232             20  EMI-SEVERITY        PIC X.
  2233             20  FILLER              PIC X.
  2234             20  EMI-ERROR-TEXT.
  2235                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2236                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  43
* VP6311.cbl
  2237     12  EMI-SEVERITY-SAVE           PIC X.
  2238         88  EMI-NOTE                    VALUE 'N'.
  2239         88  EMI-WARNING                 VALUE 'W'.
  2240         88  EMI-FORCABLE                VALUE 'F'.
  2241         88  EMI-FATAL                   VALUE 'X'.
  2242     12  EMI-MESSAGE-FLAG            PIC X.
  2243         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2244         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2245     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2246     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2247         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2248         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2249         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2250     12  emi-claim-no                pic x(7).
  2251     12  emi-claim-type              pic x(6).
  2252     12  FILLER                      PIC X(124)  VALUE SPACES.
  2253     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2254     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2255     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2256     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2257
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  44
* VP6311.cbl
  2259*    COPY ELCINTF.
  2260******************************************************************
  2261*                                                                *
  2262*                                                                *
  2263*                            ELCINTF.                            *
  2264*                            VMOD=2.017                          *
  2265*                                                                *
  2266*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2267*                                                                *
  2268*       LENGTH = 1024                                            *
  2269*                                                                *
  2270******************************************************************
  2271*                   C H A N G E   L O G
  2272*
  2273* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2274*-----------------------------------------------------------------
  2275*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2276* EFFECTIVE    NUMBER
  2277*-----------------------------------------------------------------
  2278* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2279******************************************************************
  2280 01  PROGRAM-INTERFACE-BLOCK.
  2281     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2282     12  PI-CALLING-PROGRAM              PIC X(8).
  2283     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2284     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2285     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2286     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2287     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2288     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2289     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2290     12  PI-COMPANY-ID                   PIC XXX.
  2291     12  PI-COMPANY-CD                   PIC X.
  2292
  2293     12  PI-COMPANY-PASSWORD             PIC X(8).
  2294
  2295     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2296
  2297     12  PI-CONTROL-IN-PROGRESS.
  2298         16  PI-CARRIER                  PIC X.
  2299         16  PI-GROUPING                 PIC X(6).
  2300         16  PI-STATE                    PIC XX.
  2301         16  PI-ACCOUNT                  PIC X(10).
  2302         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2303                                         PIC X(10).
  2304         16  PI-CLAIM-CERT-GRP.
  2305             20  PI-CLAIM-NO             PIC X(7).
  2306             20  PI-CERT-NO.
  2307                 25  PI-CERT-PRIME       PIC X(10).
  2308                 25  PI-CERT-SFX         PIC X.
  2309             20  PI-CERT-EFF-DT          PIC XX.
  2310         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2311             20  PI-PLAN-CODE            PIC X(2).
  2312             20  PI-REVISION-NUMBER      PIC X(3).
  2313             20  PI-PLAN-EFF-DT          PIC X(2).
  2314             20  PI-PLAN-EXP-DT          PIC X(2).
  2315             20  FILLER                  PIC X(11).
  2316         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  45
* VP6311.cbl
  2317             20  PI-OE-REFERENCE-1.
  2318                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2319                 25  PI-OE-REF-1-SUFF    PIC XX.
  2320
  2321     12  PI-SESSION-IN-PROGRESS          PIC X.
  2322         88  CLAIM-SESSION                   VALUE '1'.
  2323         88  CREDIT-SESSION                  VALUE '2'.
  2324         88  WARRANTY-SESSION                VALUE '3'.
  2325         88  MORTGAGE-SESSION                VALUE '4'.
  2326         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2327
  2328
  2329*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2330
  2331     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2332     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2333
  2334     12  PI-CREDIT-USER                  PIC X.
  2335         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2336         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2337
  2338     12  PI-CLAIM-USER                   PIC X.
  2339         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2340         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2341
  2342     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2343         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2344         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2345         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2346         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2347         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2348
  2349     12  PI-PROCESSOR-ID                 PIC X(4).
  2350
  2351     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2352
  2353     12  PI-MEMBER-CAPTION               PIC X(10).
  2354
  2355     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2356         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2357
  2358     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2359     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2360     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2361     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2362
  2363     12  PI-AH-OVERRIDE-L1               PIC X.
  2364     12  PI-AH-OVERRIDE-L2               PIC XX.
  2365     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2366     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2367
  2368     12  PI-NEW-SYSTEM                   PIC X(2).
  2369
  2370     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2371     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2372         88  PI-USES-PAID-TO                 VALUE '1'.
  2373     12  PI-CRDTCRD-SYSTEM.
  2374         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  46
* VP6311.cbl
  2375             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2376             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2377         16  PI-CC-MONTH-END-DT          PIC XX.
  2378     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2379
  2380     12  PI-OE-REFERENCE-2.
  2381         16  PI-OE-REF-2-PRIME           PIC X(10).
  2382         16  PI-OE-REF-2-SUFF            PIC X.
  2383
  2384     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2385
  2386     12  PI-LANGUAGE-TYPE                PIC X.
  2387             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2388             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2389             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2390
  2391     12  PI-POLICY-LINKAGE-IND           PIC X.
  2392         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2393         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2394                                                   LOW-VALUES.
  2395
  2396     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2397     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2398         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2399         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2400
  2401     12  PI-PROCESSOR-CSR-IND            PIC X.
  2402         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2403         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2404
  2405     12  FILLER                          PIC X(3).
  2406
  2407     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2408
  2409     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2410         PI-SYSTEM-LEVEL.
  2411
  2412         16  PI-ENTRY-CODES.
  2413             20  PI-ENTRY-CD-1           PIC X.
  2414             20  PI-ENTRY-CD-2           PIC X.
  2415
  2416         16  PI-RETURN-CODES.
  2417             20  PI-RETURN-CD-1          PIC X.
  2418             20  PI-RETURN-CD-2          PIC X.
  2419
  2420         16  PI-UPDATE-STATUS-SAVE.
  2421             20  PI-UPDATE-BY            PIC X(4).
  2422             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2423
  2424         16  PI-LOWER-CASE-LETTERS       PIC X.
  2425             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2426
  2427*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2428*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2429*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2430
  2431         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2432             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  47
* VP6311.cbl
  2433             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2434             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2435             88  ACCNT-CNTL                  VALUE '3'.
  2436             88  CARR-ACCNT-CNTL             VALUE '4'.
  2437
  2438         16  PI-PROCESSOR-CAP-LIST.
  2439             20  PI-SYSTEM-CONTROLS.
  2440                24 PI-SYSTEM-DISPLAY     PIC X.
  2441                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2442                24 PI-SYSTEM-MODIFY      PIC X.
  2443                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2444             20  FILLER                  PIC XX.
  2445             20  PI-DISPLAY-CAP          PIC X.
  2446                 88  DISPLAY-CAP             VALUE 'Y'.
  2447             20  PI-MODIFY-CAP           PIC X.
  2448                 88  MODIFY-CAP              VALUE 'Y'.
  2449             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2450                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2451             20  PI-FORCE-CAP            PIC X.
  2452                 88  FORCE-CAP               VALUE 'Y'.
  2453
  2454         16  PI-PROGRAM-CONTROLS.
  2455             20  PI-PGM-PRINT-OPT        PIC X.
  2456             20  PI-PGM-FORMAT-OPT       PIC X.
  2457             20  PI-PGM-PROCESS-OPT      PIC X.
  2458             20  PI-PGM-TOTALS-OPT       PIC X.
  2459
  2460         16  PI-HELP-INTERFACE.
  2461             20  PI-LAST-ERROR-NO        PIC X(4).
  2462             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2463
  2464         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2465             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2466
  2467         16  PI-CR-CONTROL-IN-PROGRESS.
  2468             20  PI-CR-CARRIER           PIC X.
  2469             20  PI-CR-GROUPING          PIC X(6).
  2470             20  PI-CR-STATE             PIC XX.
  2471             20  PI-CR-ACCOUNT           PIC X(10).
  2472             20  PI-CR-FIN-RESP          PIC X(10).
  2473             20  PI-CR-TYPE              PIC X.
  2474
  2475         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2476
  2477         16  PI-CR-MONTH-END-DT          PIC XX.
  2478
  2479         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2480             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2481             88  PI-ZERO-CARRIER             VALUE '1'.
  2482             88  PI-ZERO-GROUPING            VALUE '2'.
  2483             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2484
  2485         16  PI-CARRIER-SECURITY         PIC X.
  2486             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2487
  2488         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2489             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2490             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  48
* VP6311.cbl
  2491
  2492         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2493             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2494                                         INDEXED BY PI-ACCESS-NDX
  2495                                         PIC X.
  2496
  2497         16  PI-GA-BILLING-CONTROL       PIC X.
  2498             88  PI-GA-BILLING               VALUE '1'.
  2499
  2500         16  PI-MAIL-PROCESSING          PIC X.
  2501             88  PI-MAIL-YES                 VALUE 'Y'.
  2502
  2503         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2504
  2505         16  PI-AR-SYSTEM.
  2506             20  PI-AR-PROCESSING-CNTL   PIC X.
  2507                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2508             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2509             20  PI-AR-MONTH-END-DT      PIC XX.
  2510
  2511         16  PI-MP-SYSTEM.
  2512             20  PI-MORTGAGE-USER            PIC X.
  2513                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2514                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2515             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2516                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2517                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2518                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2519                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2520                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2521             20  PI-MP-MONTH-END-DT          PIC XX.
  2522             20  PI-MP-REFERENCE-NO.
  2523                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2524                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2525
  2526         16  PI-LABEL-CONTROL            PIC X(01).
  2527             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2528             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2529
  2530         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2531             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2532
  2533         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2534             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2535             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2536
  2537         16  FILLER                      PIC X(14).
  2538
  2539     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2540******************************************************************
  2541
  2542     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2543*    COPY ELC631PI.
  2544******************************************************************
  2545*                                                                *
  2546*                                                                *
  2547*                            ELC631PI                            *
  2548*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  49
* VP6311.cbl
  2549*                                                                *
  2550*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2551*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2552*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2553*                                                                *
  2554*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2555*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2556*    BETWEEN PROGRAMS.                                           *
  2557*                                                                *
  2558*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2559*                                                                *
  2560*               EL631 - EL6311 - EL6312 - EL6313                 *
  2561*                                                                *
  2562******************************************************************
  2563*                   C H A N G E   L O G
  2564*
  2565* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2566*-----------------------------------------------------------------
  2567*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2568* EFFECTIVE    NUMBER
  2569*-----------------------------------------------------------------
  2570* 021414    2003053000001  PEMA  changes for auto chk request
  2571******************************************************************
  2572
  2573         16  PI-631-DATA.
  2574             20  PI-ERPNDB-KEY.
  2575                 24  PI-PB-COMPANY-CD     PIC X.
  2576                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2577                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2578                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2579
  2580             20  PI-ERPNDB-ALT-KEY.
  2581                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2582                 24  PI-PB-CARRIER        PIC X.
  2583                 24  PI-PB-GROUPING       PIC X(6).
  2584                 24  PI-PB-STATE          PIC XX.
  2585                 24  PI-PB-ACCOUNT        PIC X(10).
  2586                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2587                 24  PI-PB-CERT-NO.
  2588                     28  PI-PB-CERT-PRIME PIC X(10).
  2589                     28  PI-PB-CERT-SFX   PIC X.
  2590                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2591                 24  PI-PB-RECORD-TYPE    PIC X.
  2592
  2593             20  PI-ERPNDB-CSR-KEY.
  2594                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2595                 24  PI-PB-CSR-ID             PIC X(4).
  2596                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2597                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2598                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2599
  2600             20  PI-BROWSE-TYPE               PIC X.
  2601                 88  PI-FILE-BROWSE             VALUE ' '.
  2602                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2603                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2604                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2605                 88  PI-CSR-BROWSE              VALUE '4'.
  2606
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  50
* VP6311.cbl
  2607             20  PI-MAINT-FUNCTION            PIC X.
  2608                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2609                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2610                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2611                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2612                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2613                 88  PI-PF5-FUNCTION            VALUE '5'.
  2614                 88  PI-PF6-FUNCTION            VALUE '6'.
  2615
  2616             20  PI-FILE-SWITCHES.
  2617                 24  PI-ALL-ISSUES-SW         PIC X.
  2618                     88  ALL-ISSUES             VALUE 'Y'.
  2619                 24  PI-ALL-CANCELS-SW        PIC X.
  2620                     88  ALL-CANCELS            VALUE 'Y'.
  2621                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2622                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2623                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2624                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2625                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2626                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2627                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2628                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2629                 24  PI-HOLD-REC-SW           PIC X.
  2630                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2631                 24  PI-CHANGE-REC-SW         PIC X.
  2632                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2633                 24  PI-CHK-REQ-REC-SW        PIC X.
  2634                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2635                 24  PI-ISSUE-WARNING-SW      PIC X.
  2636                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2637                 24  PI-CANCEL-WARNING-SW     PIC X.
  2638                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2639             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2640                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2641             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2642                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2643
  2644             20  PI-MAP-NAME                  PIC X(8).
  2645
  2646             20  PI-CURSOR                    PIC S9(4) COMP.
  2647
  2648             20  PI-PREV-ALT-KEY              PIC X(36).
  2649             20  PI-PREV-CSR-KEY              PIC X(15).
  2650             20  PI-PREV-KEY.
  2651                 24  PI-PREV-COMPANY-CD       PIC X.
  2652                 24  PI-PREV-BATCH            PIC X(6).
  2653                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2654                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2655             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2656             20  PI-BROWSE-SW                 PIC X.
  2657                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2658                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2659             20  PI-SV-CARRIER                PIC X.
  2660             20  PI-SV-GROUPING               PIC X(6).
  2661             20  PI-SV-STATE                  PIC XX.
  2662             20  PI-EDIT-SW                   PIC X.
  2663             20  PI-DISPLAY-SW                PIC XX.
  2664                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  51
* VP6311.cbl
  2665                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2666             20  PI-CRITERIA-DATA             PIC X(350).
  2667             20  PI-BMODE                     PIC X.
  2668             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2669             20  PI-BPMTS                     PIC S999     COMP-3.
  2670             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2671             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2672             20  PI-CSR-SESSION-SW            PIC X.
  2673                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2674             20  PI-ERRORS-SW                 PIC X.
  2675                 88  FATAL-ERRORS               VALUE 'X'.
  2676*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2677             20  pi-unforced-sw               pic x.
  2678                 88  unforced-errors            value 'X'.
  2679             20  FILLER                       PIC X(4).
  2680
  2681        16  FILLER             PIC X(94).
  2682
  2683 01  W-LETTER-COMMUNICATION-AREAS.
  2684*    COPY ELC1042.
  2685******************************************************************
  2686*                                                                *
  2687*                                                                *
  2688*                           ELC1042                              *
  2689*                            VMOD=2.002                          *
  2690*                                                                *
  2691*    NOTE                                                        *
  2692*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2693*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2694*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2695*        TO THESE PROGRAMS.                                      *
  2696*                                                                *
  2697*    NOTE                                                        *
  2698*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2699*        USE ONLY!                                               *
  2700*                                                                *
  2701******************************************************************
  2702
  2703         16  PI-1042-WA.
  2704             20  PI-ACTION       PIC  X(01).
  2705                 88 PI-SHOW-MODE           VALUE '1'.
  2706                 88 PI-CLEAR-MODE          VALUE '2'.
  2707                 88 PI-CREATE-MODE         VALUE '3'.
  2708             20  PI-COMM-CONTROL PIC  X(12).
  2709             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2710             20  PI-EOF-SW       PIC  X(01).
  2711                 88  PI-FILE-EOF           VALUE 'Y'.
  2712             20  PI-FILETYP      PIC  X(01).
  2713             20  PI-FORM-SQUEEZE-CONTROL
  2714                                 PIC  X(01).
  2715                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2716                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2717             20  PI-LAST-CONTROL PIC  X(12).
  2718             20  PI-TEMP-STOR-ITEMS
  2719                                 PIC S9(04) COMP.
  2720             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2721             20  PI-UPDATE-SW    PIC  9(01).
  2722                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  52
* VP6311.cbl
  2723             20  PI-104-SCREEN-SENT-IND
  2724                                 PIC  X(01).
  2725                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2726                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2727             20  PI-1042-SCREEN-SENT-IND
  2728                                 PIC  X(01).
  2729                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2730                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2731             20  PI-1042-ARCHIVE-IND
  2732                                 PIC  X(01).
  2733                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2734             20  FILLER          PIC  X(29).
  2735*    COPY ELC689PI.
  2736******************************************************************
  2737*                                                                *
  2738*                            ELC689PI                            *
  2739*                            VMOD=2.003                          *
  2740*                                                                *
  2741*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2742*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2743*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2744*                                                                *
  2745*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2746*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2747*    BETWEEN PROGRAMS.                                           *
  2748*                                                                *
  2749*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2750*                                                                *
  2751*               EL631 - EL689  - EL6891 - EL6892                 *
  2752*                                                                *
  2753******************************************************************
  2754*                   C H A N G E   L O G
  2755*
  2756* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2757*-----------------------------------------------------------------
  2758*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2759* EFFECTIVE    NUMBER
  2760*-----------------------------------------------------------------
  2761* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2762* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2763* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2764******************************************************************
  2765
  2766
  2767         16  PI-689-WORK-AREA.
  2768             20  PI-689-ALT-PRINTER-ID
  2769                                 PIC  X(04).
  2770             20  PI-689-ARCHIVE-NUMBER
  2771                                 PIC  9(08).
  2772             20  PI-689-ARCHIVE-SW
  2773                                 PIC  X(01).
  2774                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2775             20  PI-689-DATA-SOURCE
  2776                                 PIC  X(01).
  2777                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2778                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2779                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2780                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  53
* VP6311.cbl
  2781                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2782             20  PI-689-ERROR-IND
  2783                                 PIC  X(01).
  2784                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2785             20  PI-689-ERROR    PIC  9(04).
  2786                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2787                 88  PI-689-FATAL-ERROR
  2788                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2789                            0042 0047 0051 0066 0067 0070
  2790                            0168 0169 0174 0175 0176 0177 0179
  2791                            0180 0181 0182 0184 0185 0189 0190
  2792                            0191
  2793                            0215 0279 0280
  2794                            0412 0413 0454
  2795                            0533 0537
  2796                            2055 2114 2208 2209 2216 2232 2369
  2797                            2398 2433 2908 2999
  2798                            3000 3770 3771 3775
  2799                            7250 7365 7367 7368 7369 7370 7371
  2800                            7272 7373 7374 7376 7377 7378 7379
  2801                            7381 7388 7390 7393 7395 7396 7398
  2802                            9095 9096 9281 9298 9299 9320 9327
  2803                            9426 9427.
  2804                 88  PI-689-STOP-ERROR
  2805                     VALUES 0004 0008 0013 0023 0029 0033
  2806                            0042 0047 0066 0067 0070
  2807                            0168 0169 0174 0175 0176 0177
  2808                            0181 0182 0184 0185 0189 0190
  2809                            0279 0280
  2810                            0412 0413 0454
  2811                            2055 2208 2209 2216 2232
  2812                            2398 2999
  2813                            3000 3770 3771 3775
  2814                            7250 7365 7369 7370 7371
  2815                            7272 7373 7374 7376 7377 7378 7379
  2816                            7381 7388 7390 7393 7396 7398
  2817                            9095 9096 9299 9320 9426.
  2818             20  PI-689-FOLLOW-UP-DATE
  2819                                 PIC  X(02).
  2820             20  PI-689-FORM-NUMBER
  2821                                 PIC  X(04).
  2822             20  PI-689-LABEL-SOURCE
  2823                                 PIC X(01).
  2824                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2825                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2826                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2827                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2828                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2829                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2830                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2831             20  PI-689-NUMBER-COPIES
  2832                                 PIC  9(01).
  2833             20  PI-689-NUMBER-LABEL-LINES
  2834                                 PIC  9(01).
  2835             20  PI-689-NUMBER-TEXT-RECORDS
  2836                                 PIC  9(03).
  2837             20  PI-689-PRINT-ORDER-SW
  2838                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  54
* VP6311.cbl
  2839                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2840                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2841                 88  PI-689-PRINT-LATER     VALUE '3'.
  2842                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2843             20  PI-689-PRINT-RESTRICTION
  2844                                 PIC  X(01).
  2845                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2846                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2847                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2848             20  PI-689-PRINT-SW PIC  X(01).
  2849                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2850             20  PI-689-RESEND-DATE-1
  2851                                 PIC  X(02).
  2852             20  PI-689-RESEND-LETR-1
  2853                                 PIC X(4).
  2854             20  PI-689-TEMP-STOR-ID
  2855                                 PIC  X(08).
  2856             20  PI-689-USE-SCREEN-IND
  2857                                 PIC  X(01).
  2858                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2859             20  PI-689-ARCH-POINTER
  2860                                 PIC S9(08) COMP.
  2861                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2862             20  PI-689-ARCT-POINTER
  2863                                 PIC S9(08) COMP.
  2864                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2865             20  PI-689-VARIABLE-DATA-GRP.
  2866                 24  PI-689-VARIABLE-DATA-1
  2867                                 PIC  X(30).
  2868                 24  PI-689-VARIABLE-DATA-2
  2869                                 PIC  X(30).
  2870                 24  PI-689-VARIABLE-DATA-3
  2871                                 PIC  X(30).
  2872                 24  PI-689-VARIABLE-DATA-4
  2873                                 PIC  X(30).
  2874
  2875         16  PI-689-KEY-DATA-FIELDS.
  2876             20  PI-689-ACCOUNT  PIC  X(10).
  2877             20  PI-689-CARRIER  PIC  X(01).
  2878             20  PI-689-CERT-NO.
  2879                 24  PI-689-CERT-PRIME
  2880                                 PIC  X(10).
  2881                 24  PI-689-CERT-SFX
  2882                                 PIC  X(01).
  2883             20  PI-689-CHG-SEQ-NO
  2884                                 PIC S9(04)    COMP.
  2885             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2886                                 PIC  X(02).
  2887             20  PI-689-ENTRY-BATCH
  2888                                 PIC  X(06).
  2889             20  PI-689-EFF-DATE PIC  X(02).
  2890             20  PI-689-EXP-DATE PIC  X(02).
  2891             20  PI-689-GROUPING PIC  X(06).
  2892             20  PI-689-RESP-PERSON
  2893                                 PIC  X(10).
  2894             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2895             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2896                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  55
* VP6311.cbl
  2897             20  PI-689-STATE    PIC  X(02).
  2898             20  PI-689-TYPE     PIC  X(01).
  2899             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2900             20  PI-689-ALT-SEQ-NO
  2901                                 PIC S9(04)    COMP.
  2902         16  PI-689-DATE-EDIT    PIC  X(08).
  2903         16  PI-689-FOLLOW-UP-EDIT
  2904                                 PIC  X(08).
  2905         16  PI-689-RESEND1-EDIT PIC  X(08).
  2906         16  PI-689-SEQ-EDIT     PIC  X(08).
  2907         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2908         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2909             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2910         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2911         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  56
* VP6311.cbl
  2913
  2914 01  WS-EL6315-PASS-AREA.
  2915        16  PI-6315-ISS-CAN-SW      PIC X.
  2916        16  FILLER                  PIC X(120).
  2917        16  PI-RES-REF-CLM-TYPE     PIC X.
  2918        16  FILLER                  PIC X.
  2919        16  PI-6315-PASS-AREA.
  2920            20 FILLER               PIC X(236).
  2921            20 PI-6315-FINALIZED    PIC X.
  2922            20 FILLER               PIC X(280).
  2923
  2924 01  WS-EL6316-PASS-AREA.
  2925        16  PI-ISS-CAN-SW           PIC X.
  2926        16  FILLER                  PIC X(121).
  2927        16  PI-CLM-RESC-IND         PIC X.
  2928        16  PI-6316-PASS-AREA.
  2929            20 FILLER               PIC X(236).
  2930            20 PI-6316-FINALIZED    PIC X.
  2931            20 FILLER               PIC X(280).
  2932
  2933******************************************************************
  2934*                                                                *
  2935*         P A S S   A R E A   F O R   E D I T                    *
  2936*                                                                *
  2937******************************************************************
  2938
  2939 01  PASSED-RECORD.
  2940     12  RECORD-SAVE                  PIC X(585).
  2941* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2942*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2943*                    BY  WK-CURRENT-DATE.
  2944******************************************************************
  2945*                                                                *
  2946*                                                                *
  2947*                             ELC50W1                            *
  2948*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2949*                            VMOD=2.004                          *
  2950*                                                                *
  2951*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2952*                                                                *
  2953*                                                                *
  2954******************************************************************
  2955
  2956     12  WK-WORK-AREA.
  2957         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2958         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2959         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2960         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2961         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2962         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2963         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2964         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2965         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2966         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2967         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2968         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2969         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2970         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  57
* VP6311.cbl
  2971         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2972         16  WK-CREDIT-EDIT-CONTROLS.
  2973             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2974             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2975             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2976             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2977             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2978             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2979         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2980         16  WK-SAVE-REIN-DATA.
  2981             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2982             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2983             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2984         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2985             88  ENTRY-FROM-EL6311       VALUE '6'.
  2986         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2987         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2988     12  WK-RECORD-ADDRESSES.
  2989         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2990         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2991         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2992         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2993         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2994         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2995         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2996         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2997     12  WK-OVER-SHORT-AREA.
  2998         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2999         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3000         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3001             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3002         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  58
* VP6311.cbl
  3004
  3005*    COPY ELCEDITC.
  3006******************************************************************
  3007*                                                                *
  3008*                                                                *
  3009*                            ELCEDITC                            *
  3010*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3011*                            VMOD=2.012                          *
  3012*                                                                *
  3013*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3014*                     EL6313, EL050 AND EL517.                   *
  3015*                                                                *
  3016******************************************************************
  3017******************************************************************
  3018*                   C H A N G E   L O G
  3019*
  3020* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3021*-----------------------------------------------------------------
  3022*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3023* EFFECTIVE    NUMBER
  3024*-----------------------------------------------------------------
  3025* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3026******************************************************************
  3027
  3028     12  EDIT-CRITERIA-DATA.
  3029         16  EC-CO-MONTH-END-DT       PIC XX.
  3030         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3031         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3032         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3033         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3034         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3035         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3036         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3037         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3038         16  EC-CO-REM-TERM-CALC      PIC X.
  3039               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3040               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3041               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3042               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3043
  3044         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3045               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3046               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3047               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3048               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3049               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3050               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3051               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3052               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3053               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3054               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3055
  3056         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3057               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3058               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3059               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3060               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3061               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  59
* VP6311.cbl
  3062               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3063               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3064               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3065
  3066         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3067                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3068                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3069
  3070         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3071                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3072                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3073                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3074                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3075                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3076                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3077                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3078                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3079
  3080         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3081               88  EC-BR-REDUCING                   VALUE 'R'.
  3082               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3083
  3084         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3085         16  EC-BR-LF-DESC             PIC X(10).
  3086         16  EC-BR-AH-DESC             PIC X(10).
  3087         16  EC-BR-LF-COMMENT          PIC X(10).
  3088         16  EC-BR-AH-COMMENT          PIC X(10).
  3089
  3090         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3091               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3092               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3093               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3094               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3095
  3096         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3097               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3098               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3099               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3100               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3101
  3102         16  EC-BR-LF-REFUND-CALC      PIC X.
  3103                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3104                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3105                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3106                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3107                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3108                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3109                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3110
  3111         16  EC-BR-AH-REFUND-CALC      PIC X.
  3112                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3113                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3114                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3115                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3116                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3117                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3118                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3119                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  60
* VP6311.cbl
  3120
  3121         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3122                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3123                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3124                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3125
  3126         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3127                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3128                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3129                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3130
  3131         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3132         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3133         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3134         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3135
  3136         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3137         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3138                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3139                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3140                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3141                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3142
  3143         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3144               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3145               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3146               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3147               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3148               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3149
  3150         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3151               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3152               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3153               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3154               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3155               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3156
  3157         16  EC-ST-LF-REFUND-CALC      PIC X.
  3158                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3159                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3160                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3161                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3162                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3163                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3164                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3165                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3166
  3167         16  EC-ST-AH-REFUND-CALC      PIC X.
  3168                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3169                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3170                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3171                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3172                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3173                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3174                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3175                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3176
  3177         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  61
* VP6311.cbl
  3178         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3179         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3180         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3181         16  EC-AM-EXPIRATION-DT       PIC XX.
  3182         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3183         16  EC-AM-CLASS-CD            PIC XX.
  3184         16  EC-AM-LF-DEVIATION        PIC XXX.
  3185         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3186         16  EC-AM-AH-DEVIATION        PIC XXX.
  3187         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3188         16  EC-AM-PHONE-NO            PIC X(10).
  3189
  3190         16  EC-AM-LF-REFUND-CALC      PIC X.
  3191                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3192                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3193                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3194                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3195                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3196                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3197                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3198
  3199         16  EC-AM-AH-REFUND-CALC      PIC X.
  3200                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3201                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3202                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3203                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3204                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3205                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3206                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3207
  3208         16  EC-AM-BEN-I-G-CD          PIC X.
  3209                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3210                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3211                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3212
  3213         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3214         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3215         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3216         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3217         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3218         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3219         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3220         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3221         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3222
  3223         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3224         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3225         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3226         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3227         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3228         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3229         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3230         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3231         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3232         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3233         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3234         16  EC-RT-LF-NSP-ST           PIC XX.
  3235         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  62
* VP6311.cbl
  3236         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3237         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3238
  3239         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3240             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3241                                             'M' '5' '9' '2'.
  3242             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3243             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3244             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3245             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3246             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3247             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3248             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3249             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3250             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3251             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3252
  3253         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3254             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3255                                             'M' '5' '9' '2'.
  3256             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3257             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3258             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3259             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3260             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3261             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3262             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3263             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3264             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3265             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3266
  3267         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3268         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3269         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3270         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3271         16  EC-CM-DEATH-DT            PIC XX.
  3272
  3273*DMD CUSTOM CODING FIELDS BELOW
  3274*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3275         16  EC-BR-DMD-RATING-SW       PIC X.
  3276                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3277                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3278                 88  NO-DMD-RATING               VALUE 'N'.
  3279
  3280         16  EC-NEW-CERT               PIC X(11).
  3281         16  EC-NEW-STATE              PIC XX.
  3282         16  FILLER                    PIC X.
  3283*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3284         16  OVER-SHORT-EDIT-FIELDS.
  3285             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3286             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3287             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3288             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3289             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3290             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3291             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3292             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3293             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  63
* VP6311.cbl
  3294         16  FILLER                    PIC X(71).
  3295
  3296******************************************************************
  3297
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  64
* VP6311.cbl
  3299
  3300*    COPY ELCJPFX.
  3301******************************************************************
  3302*                                                                *
  3303*                                                                *
  3304*                            ELCJPFX.                            *
  3305*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3306*                            VMOD=2.002                          *
  3307*                                                                *
  3308*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3309*                                                                *
  3310*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3311*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3312*        ELCNTL - CONTROL FILE                                   *
  3313*        ELMSTR - CLAIM MASTERS                                  *
  3314*        ELTRLR - ACTIVITY TRAILERS                              *
  3315*        ELCHKQ - CHECK QUE                                      *
  3316******************************************************************
  3317 01  JOURNAL-RECORD.
  3318     12  jp-date                     pic s9(5) comp-3.
  3319     12  jp-time                     pic s9(7) comp-3.
  3320     12  JP-USER-ID                  PIC X(4).
  3321     12  JP-FILE-ID                  PIC X(8).
  3322     12  JP-PROGRAM-ID               PIC X(8).
  3323     12  JP-RECORD-TYPE              PIC X.
  3324         88 JP-ADD              VALUE 'A'.
  3325         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3326         88 JP-AFTER-CHANGE     VALUE 'C'.
  3327         88 JP-DELETE           VALUE 'D'.
  3328         88 JP-GENERIC-DELETE   VALUE 'G'.
  3329         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3330         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3331     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3332     12  JP-RECORD-AREA
  3333
  3334
  3335                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  65
* VP6311.cbl
  3337*    COPY ELCAID.
  3338******************************************************************
  3339*                                                                *
  3340*                            ELCAID.                             *
  3341*                            VMOD=2.001                          *
  3342*                                                                *
  3343*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3344*                                                                *
  3345*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3346*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3347******************************************************************
  3348
  3349 01  DFHAID.
  3350   02  DFHNULL   PIC  X  VALUE  ' '.
  3351   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3352   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3353   02  DFHPEN    PIC  X  VALUE  '='.
  3354   02  DFHOPID   PIC  X  VALUE  'W'.
  3355   02  DFHPA1    PIC  X  VALUE  '%'.
  3356   02  DFHPA2    PIC  X  VALUE  '>'.
  3357   02  DFHPA3    PIC  X  VALUE  ','.
  3358   02  DFHPF1    PIC  X  VALUE  '1'.
  3359   02  DFHPF2    PIC  X  VALUE  '2'.
  3360   02  DFHPF3    PIC  X  VALUE  '3'.
  3361   02  DFHPF4    PIC  X  VALUE  '4'.
  3362   02  DFHPF5    PIC  X  VALUE  '5'.
  3363   02  DFHPF6    PIC  X  VALUE  '6'.
  3364   02  DFHPF7    PIC  X  VALUE  '7'.
  3365   02  DFHPF8    PIC  X  VALUE  '8'.
  3366   02  DFHPF9    PIC  X  VALUE  '9'.
  3367   02  DFHPF10   PIC  X  VALUE  ':'.
  3368   02  DFHPF11   PIC  X  VALUE  '#'.
  3369   02  DFHPF12   PIC  X  VALUE  '@'.
  3370   02  DFHPF13   PIC  X  VALUE  'A'.
  3371   02  DFHPF14   PIC  X  VALUE  'B'.
  3372   02  DFHPF15   PIC  X  VALUE  'C'.
  3373   02  DFHPF16   PIC  X  VALUE  'D'.
  3374   02  DFHPF17   PIC  X  VALUE  'E'.
  3375   02  DFHPF18   PIC  X  VALUE  'F'.
  3376   02  DFHPF19   PIC  X  VALUE  'G'.
  3377   02  DFHPF20   PIC  X  VALUE  'H'.
  3378   02  DFHPF21   PIC  X  VALUE  'I'.
  3379*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3380   02  DFHPF22   PIC  X  VALUE  '['.
  3381   02  DFHPF23   PIC  X  VALUE  '.'.
  3382   02  DFHPF24   PIC  X  VALUE  '<'.
  3383   02  DFHMSRE   PIC  X  VALUE  'X'.
  3384   02  DFHSTRF   PIC  X  VALUE  'h'.
  3385   02  DFHTRIG   PIC  X  VALUE  '"'.
  3386
  3387 01  FILLER    REDEFINES DFHAID.
  3388     12  FILLER              PIC X(8).
  3389     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3390
  3391*                                COPY VP6311S.
  3392 01  VP631BI.
  3393     05  FILLER            PIC  X(0012).
  3394*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  66
* VP6311.cbl
  3395     05  BDATEL PIC S9(0004) COMP.
  3396     05  BDATEF PIC  X(0001).
  3397     05  FILLER REDEFINES BDATEF.
  3398         10  BDATEA PIC  X(0001).
  3399     05  BDATEI PIC  X(0008).
  3400*    -------------------------------
  3401     05  BTIMEL PIC S9(0004) COMP.
  3402     05  BTIMEF PIC  X(0001).
  3403     05  FILLER REDEFINES BTIMEF.
  3404         10  BTIMEA PIC  X(0001).
  3405     05  BTIMEI PIC  X(0005).
  3406*    -------------------------------
  3407     05  BHEADL PIC S9(0004) COMP.
  3408     05  BHEADF PIC  X(0001).
  3409     05  FILLER REDEFINES BHEADF.
  3410         10  BHEADA PIC  X(0001).
  3411     05  BHEADI PIC  X(0038).
  3412*    -------------------------------
  3413     05  BNCERTLL PIC S9(0004) COMP.
  3414     05  BNCERTLF PIC  X(0001).
  3415     05  FILLER REDEFINES BNCERTLF.
  3416         10  BNCERTLA PIC  X(0001).
  3417     05  BNCERTLI PIC  X(0008).
  3418*    -------------------------------
  3419     05  BNCERTL PIC S9(0004) COMP.
  3420     05  BNCERTF PIC  X(0001).
  3421     05  FILLER REDEFINES BNCERTF.
  3422         10  BNCERTA PIC  X(0001).
  3423     05  BNCERTI PIC  X(0011).
  3424*    -------------------------------
  3425     05  BNSTATLL PIC S9(0004) COMP.
  3426     05  BNSTATLF PIC  X(0001).
  3427     05  FILLER REDEFINES BNSTATLF.
  3428         10  BNSTATLA PIC  X(0001).
  3429     05  BNSTATLI PIC  X(0009).
  3430*    -------------------------------
  3431     05  BNSTATL PIC S9(0004) COMP.
  3432     05  BNSTATF PIC  X(0001).
  3433     05  FILLER REDEFINES BNSTATF.
  3434         10  BNSTATA PIC  X(0001).
  3435     05  BNSTATI PIC  X(0002).
  3436*    -------------------------------
  3437     05  BCHGTL PIC S9(0004) COMP.
  3438     05  BCHGTF PIC  X(0001).
  3439     05  FILLER REDEFINES BCHGTF.
  3440         10  BCHGTA PIC  X(0001).
  3441     05  BCHGTI PIC  X(0004).
  3442*    -------------------------------
  3443     05  BCHGL PIC S9(0004) COMP.
  3444     05  BCHGF PIC  X(0001).
  3445     05  FILLER REDEFINES BCHGF.
  3446         10  BCHGA PIC  X(0001).
  3447     05  BCHGI PIC  X(0004).
  3448*    -------------------------------
  3449     05  BCOMPIDL PIC S9(0004) COMP.
  3450     05  BCOMPIDF PIC  X(0001).
  3451     05  FILLER REDEFINES BCOMPIDF.
  3452         10  BCOMPIDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  67
* VP6311.cbl
  3453     05  BCOMPIDI PIC  X(0003).
  3454*    -------------------------------
  3455     05  BREGIONL PIC S9(0004) COMP.
  3456     05  BREGIONF PIC  X(0001).
  3457     05  FILLER REDEFINES BREGIONF.
  3458         10  BREGIONA PIC  X(0001).
  3459     05  BREGIONI PIC  X(0006).
  3460*    -------------------------------
  3461     05  BUSERL PIC S9(0004) COMP.
  3462     05  BUSERF PIC  X(0001).
  3463     05  FILLER REDEFINES BUSERF.
  3464         10  BUSERA PIC  X(0001).
  3465     05  BUSERI PIC  X(0004).
  3466*    -------------------------------
  3467     05  BMAINTL PIC S9(0004) COMP.
  3468     05  BMAINTF PIC  X(0001).
  3469     05  FILLER REDEFINES BMAINTF.
  3470         10  BMAINTA PIC  X(0001).
  3471     05  BMAINTI PIC  X(0001).
  3472*    -------------------------------
  3473     05  BMANTBYL PIC S9(0004) COMP.
  3474     05  BMANTBYF PIC  X(0001).
  3475     05  FILLER REDEFINES BMANTBYF.
  3476         10  BMANTBYA PIC  X(0001).
  3477     05  BMANTBYI PIC  X(0004).
  3478*    -------------------------------
  3479     05  BCHGHDGL PIC S9(0004) COMP.
  3480     05  BCHGHDGF PIC  X(0001).
  3481     05  FILLER REDEFINES BCHGHDGF.
  3482         10  BCHGHDGA PIC  X(0001).
  3483     05  BCHGHDGI PIC  X(0003).
  3484*    -------------------------------
  3485     05  BMANTDTL PIC S9(0004) COMP.
  3486     05  BMANTDTF PIC  X(0001).
  3487     05  FILLER REDEFINES BMANTDTF.
  3488         10  BMANTDTA PIC  X(0001).
  3489     05  BMANTDTI PIC  X(0008).
  3490*    -------------------------------
  3491     05  BMANTATL PIC S9(0004) COMP.
  3492     05  BMANTATF PIC  X(0001).
  3493     05  FILLER REDEFINES BMANTATF.
  3494         10  BMANTATA PIC  X(0001).
  3495     05  BMANTATI PIC  X(0005).
  3496*    -------------------------------
  3497     05  BCSRL PIC S9(0004) COMP.
  3498     05  BCSRF PIC  X(0001).
  3499     05  FILLER REDEFINES BCSRF.
  3500         10  BCSRA PIC  X(0001).
  3501     05  BCSRI PIC  X(0004).
  3502*    -------------------------------
  3503     05  BBATCHL PIC S9(0004) COMP.
  3504     05  BBATCHF PIC  X(0001).
  3505     05  FILLER REDEFINES BBATCHF.
  3506         10  BBATCHA PIC  X(0001).
  3507     05  BBATCHI PIC  X(0006).
  3508*    -------------------------------
  3509     05  BSEQL PIC S9(0004) COMP.
  3510     05  BSEQF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  68
* VP6311.cbl
  3511     05  FILLER REDEFINES BSEQF.
  3512         10  BSEQA PIC  X(0001).
  3513     05  BSEQI PIC  X(0004).
  3514*    -------------------------------
  3515     05  BMOENDTL PIC S9(0004) COMP.
  3516     05  BMOENDTF PIC  X(0001).
  3517     05  FILLER REDEFINES BMOENDTF.
  3518         10  BMOENDTA PIC  X(0001).
  3519     05  BMOENDTI PIC  X(0008).
  3520*    -------------------------------
  3521     05  BCARRL PIC S9(0004) COMP.
  3522     05  BCARRF PIC  X(0001).
  3523     05  FILLER REDEFINES BCARRF.
  3524         10  BCARRA PIC  X(0001).
  3525     05  BCARRI PIC  X(0001).
  3526*    -------------------------------
  3527     05  BGROUPL PIC S9(0004) COMP.
  3528     05  BGROUPF PIC  X(0001).
  3529     05  FILLER REDEFINES BGROUPF.
  3530         10  BGROUPA PIC  X(0001).
  3531     05  BGROUPI PIC  X(0006).
  3532*    -------------------------------
  3533     05  BSTATEL PIC S9(0004) COMP.
  3534     05  BSTATEF PIC  X(0001).
  3535     05  FILLER REDEFINES BSTATEF.
  3536         10  BSTATEA PIC  X(0001).
  3537     05  BSTATEI PIC  X(0002).
  3538*    -------------------------------
  3539     05  BACCTL PIC S9(0004) COMP.
  3540     05  BACCTF PIC  X(0001).
  3541     05  FILLER REDEFINES BACCTF.
  3542         10  BACCTA PIC  X(0001).
  3543     05  BACCTI PIC  X(0010).
  3544*    -------------------------------
  3545     05  BVINHL PIC S9(0004) COMP.
  3546     05  BVINHF PIC  X(0001).
  3547     05  FILLER REDEFINES BVINHF.
  3548         10  BVINHA PIC  X(0001).
  3549     05  BVINHI PIC  X(0004).
  3550*    -------------------------------
  3551     05  BVINL PIC S9(0004) COMP.
  3552     05  BVINF PIC  X(0001).
  3553     05  FILLER REDEFINES BVINF.
  3554         10  BVINA PIC  X(0001).
  3555     05  BVINI PIC  X(0017).
  3556*    -------------------------------
  3557     05  BREFHDGL PIC S9(0004) COMP.
  3558     05  BREFHDGF PIC  X(0001).
  3559     05  FILLER REDEFINES BREFHDGF.
  3560         10  BREFHDGA PIC  X(0001).
  3561     05  BREFHDGI PIC  X(0004).
  3562*    -------------------------------
  3563     05  BREFL PIC S9(0004) COMP.
  3564     05  BREFF PIC  X(0001).
  3565     05  FILLER REDEFINES BREFF.
  3566         10  BREFA PIC  X(0001).
  3567     05  BREFI PIC  X(0012).
  3568*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  69
* VP6311.cbl
  3569     05  BAGEDEFL PIC S9(0004) COMP.
  3570     05  BAGEDEFF PIC  X(0001).
  3571     05  FILLER REDEFINES BAGEDEFF.
  3572         10  BAGEDEFA PIC  X(0001).
  3573     05  BAGEDEFI PIC  X(0004).
  3574*    -------------------------------
  3575     05  BCERTNOL PIC S9(0004) COMP.
  3576     05  BCERTNOF PIC  X(0001).
  3577     05  FILLER REDEFINES BCERTNOF.
  3578         10  BCERTNOA PIC  X(0001).
  3579     05  BCERTNOI PIC  X(0010).
  3580*    -------------------------------
  3581     05  BSUFIXL PIC S9(0004) COMP.
  3582     05  BSUFIXF PIC  X(0001).
  3583     05  FILLER REDEFINES BSUFIXF.
  3584         10  BSUFIXA PIC  X(0001).
  3585     05  BSUFIXI PIC  X(0001).
  3586*    -------------------------------
  3587     05  BEFFDTL PIC S9(0004) COMP.
  3588     05  BEFFDTF PIC  X(0001).
  3589     05  FILLER REDEFINES BEFFDTF.
  3590         10  BEFFDTA PIC  X(0001).
  3591     05  BEFFDTI PIC  X(0008).
  3592*    -------------------------------
  3593     05  BLSTNML PIC S9(0004) COMP.
  3594     05  BLSTNMF PIC  X(0001).
  3595     05  FILLER REDEFINES BLSTNMF.
  3596         10  BLSTNMA PIC  X(0001).
  3597     05  BLSTNMI PIC  X(0015).
  3598*    -------------------------------
  3599     05  B1STNML PIC S9(0004) COMP.
  3600     05  B1STNMF PIC  X(0001).
  3601     05  FILLER REDEFINES B1STNMF.
  3602         10  B1STNMA PIC  X(0001).
  3603     05  B1STNMI PIC  X(0010).
  3604*    -------------------------------
  3605     05  BINITL PIC S9(0004) COMP.
  3606     05  BINITF PIC  X(0001).
  3607     05  FILLER REDEFINES BINITF.
  3608         10  BINITA PIC  X(0001).
  3609     05  BINITI PIC  X(0001).
  3610*    -------------------------------
  3611     05  BSEXL PIC S9(0004) COMP.
  3612     05  BSEXF PIC  X(0001).
  3613     05  FILLER REDEFINES BSEXF.
  3614         10  BSEXA PIC  X(0001).
  3615     05  BSEXI PIC  X(0001).
  3616*    -------------------------------
  3617     05  BAGEL PIC S9(0004) COMP.
  3618     05  BAGEF PIC  X(0001).
  3619     05  FILLER REDEFINES BAGEF.
  3620         10  BAGEA PIC  X(0001).
  3621     05  BAGEI PIC  X(0002).
  3622*    -------------------------------
  3623     05  BBIRTHL PIC S9(0004) COMP.
  3624     05  BBIRTHF PIC  X(0001).
  3625     05  FILLER REDEFINES BBIRTHF.
  3626         10  BBIRTHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  70
* VP6311.cbl
  3627     05  BBIRTHI PIC  X(0008).
  3628*    -------------------------------
  3629     05  BYEARL PIC S9(0004) COMP.
  3630     05  BYEARF PIC  X(0001).
  3631     05  FILLER REDEFINES BYEARF.
  3632         10  BYEARA PIC  X(0001).
  3633     05  BYEARI PIC  X(0004).
  3634*    -------------------------------
  3635     05  BMAKEL PIC S9(0004) COMP.
  3636     05  BMAKEF PIC  X(0001).
  3637     05  FILLER REDEFINES BMAKEF.
  3638         10  BMAKEA PIC  X(0001).
  3639     05  BMAKEI PIC  X(0020).
  3640*    -------------------------------
  3641     05  BMODELL PIC S9(0004) COMP.
  3642     05  BMODELF PIC  X(0001).
  3643     05  FILLER REDEFINES BMODELF.
  3644         10  BMODELA PIC  X(0001).
  3645     05  BMODELI PIC  X(0020).
  3646*    -------------------------------
  3647     05  BFUTUREL PIC S9(0004) COMP.
  3648     05  BFUTUREF PIC  X(0001).
  3649     05  FILLER REDEFINES BFUTUREF.
  3650         10  BFUTUREA PIC  X(0001).
  3651     05  BFUTUREI PIC  X(0020).
  3652*    -------------------------------
  3653     05  BOMETERL PIC S9(0004) COMP.
  3654     05  BOMETERF PIC  X(0001).
  3655     05  FILLER REDEFINES BOMETERF.
  3656         10  BOMETERA PIC  X(0001).
  3657     05  BOMETERI PIC  X(0007).
  3658*    -------------------------------
  3659     05  BMEMCAPL PIC S9(0004) COMP.
  3660     05  BMEMCAPF PIC  X(0001).
  3661     05  FILLER REDEFINES BMEMCAPF.
  3662         10  BMEMCAPA PIC  X(0001).
  3663     05  BMEMCAPI PIC  X(0011).
  3664*    -------------------------------
  3665     05  BORIGHDL PIC S9(0004) COMP.
  3666     05  BORIGHDF PIC  X(0001).
  3667     05  FILLER REDEFINES BORIGHDF.
  3668         10  BORIGHDA PIC  X(0001).
  3669     05  BORIGHDI PIC  X(0010).
  3670*    -------------------------------
  3671     05  BFORCEL PIC S9(0004) COMP.
  3672     05  BFORCEF PIC  X(0001).
  3673     05  FILLER REDEFINES BFORCEF.
  3674         10  BFORCEA PIC  X(0001).
  3675     05  BFORCEI PIC  X(0001).
  3676*    -------------------------------
  3677     05  BENTRYL PIC S9(0004) COMP.
  3678     05  BENTRYF PIC  X(0001).
  3679     05  FILLER REDEFINES BENTRYF.
  3680         10  BENTRYA PIC  X(0001).
  3681     05  BENTRYI PIC  X(0001).
  3682*    -------------------------------
  3683     05  BREINL PIC S9(0004) COMP.
  3684     05  BREINF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  71
* VP6311.cbl
  3685     05  FILLER REDEFINES BREINF.
  3686         10  BREINA PIC  X(0001).
  3687     05  BREINI PIC  X(0001).
  3688*    -------------------------------
  3689     05  BBILCDL PIC S9(0004) COMP.
  3690     05  BBILCDF PIC  X(0001).
  3691     05  FILLER REDEFINES BBILCDF.
  3692         10  BBILCDA PIC  X(0001).
  3693     05  BBILCDI PIC  X(0001).
  3694*    -------------------------------
  3695     05  BUNWRITL PIC S9(0004) COMP.
  3696     05  BUNWRITF PIC  X(0001).
  3697     05  FILLER REDEFINES BUNWRITF.
  3698         10  BUNWRITA PIC  X(0001).
  3699     05  BUNWRITI PIC  X(0001).
  3700*    -------------------------------
  3701     05  BSKPCDL PIC S9(0004) COMP.
  3702     05  BSKPCDF PIC  X(0001).
  3703     05  FILLER REDEFINES BSKPCDF.
  3704         10  BSKPCDA PIC  X(0001).
  3705     05  BSKPCDI PIC  X(0001).
  3706*    -------------------------------
  3707     05  BINDGRPL PIC S9(0004) COMP.
  3708     05  BINDGRPF PIC  X(0001).
  3709     05  FILLER REDEFINES BINDGRPF.
  3710         10  BINDGRPA PIC  X(0001).
  3711     05  BINDGRPI PIC  X(0001).
  3712*    -------------------------------
  3713     05  BSIGL PIC S9(0004) COMP.
  3714     05  BSIGF PIC  X(0001).
  3715     05  FILLER REDEFINES BSIGF.
  3716         10  BSIGA PIC  X(0001).
  3717     05  BSIGI PIC  X(0001).
  3718*    -------------------------------
  3719     05  BRTCLSL PIC S9(0004) COMP.
  3720     05  BRTCLSF PIC  X(0001).
  3721     05  FILLER REDEFINES BRTCLSF.
  3722         10  BRTCLSA PIC  X(0001).
  3723     05  BRTCLSI PIC  X(0002).
  3724*    -------------------------------
  3725     05  BCHGCNTL PIC S9(0004) COMP.
  3726     05  BCHGCNTF PIC  X(0001).
  3727     05  FILLER REDEFINES BCHGCNTF.
  3728         10  BCHGCNTA PIC  X(0001).
  3729     05  BCHGCNTI PIC  X(0003).
  3730*    -------------------------------
  3731     05  BMEMBERL PIC S9(0004) COMP.
  3732     05  BMEMBERF PIC  X(0001).
  3733     05  FILLER REDEFINES BMEMBERF.
  3734         10  BMEMBERA PIC  X(0001).
  3735     05  BMEMBERI PIC  X(0012).
  3736*    -------------------------------
  3737     05  BLNOFCRL PIC S9(0004) COMP.
  3738     05  BLNOFCRF PIC  X(0001).
  3739     05  FILLER REDEFINES BLNOFCRF.
  3740         10  BLNOFCRA PIC  X(0001).
  3741     05  BLNOFCRI PIC  X(0005).
  3742*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  72
* VP6311.cbl
  3743     05  BKIND1L PIC S9(0004) COMP.
  3744     05  BKIND1F PIC  X(0001).
  3745     05  FILLER REDEFINES BKIND1F.
  3746         10  BKIND1A PIC  X(0001).
  3747     05  BKIND1I PIC  X(0002).
  3748*    -------------------------------
  3749     05  BTYPE1L PIC S9(0004) COMP.
  3750     05  BTYPE1F PIC  X(0001).
  3751     05  FILLER REDEFINES BTYPE1F.
  3752         10  BTYPE1A PIC  X(0001).
  3753     05  BTYPE1I PIC  X(0003).
  3754*    -------------------------------
  3755     05  BTERM1L PIC S9(0004) COMP.
  3756     05  BTERM1F PIC  X(0001).
  3757     05  FILLER REDEFINES BTERM1F.
  3758         10  BTERM1A PIC  X(0001).
  3759     05  BTERM1I PIC  X(0003).
  3760*    -------------------------------
  3761     05  BBEN1L PIC S9(0004) COMP.
  3762     05  BBEN1F PIC  X(0001).
  3763     05  FILLER REDEFINES BBEN1F.
  3764         10  BBEN1A PIC  X(0001).
  3765     05  BBEN1I PIC  X(0012).
  3766*    -------------------------------
  3767     05  BPREM1L PIC S9(0004) COMP.
  3768     05  BPREM1F PIC  X(0001).
  3769     05  FILLER REDEFINES BPREM1F.
  3770         10  BPREM1A PIC  X(0001).
  3771     05  BPREM1I PIC  X(0011).
  3772*    -------------------------------
  3773     05  BEXPIR1L PIC S9(0004) COMP.
  3774     05  BEXPIR1F PIC  X(0001).
  3775     05  FILLER REDEFINES BEXPIR1F.
  3776         10  BEXPIR1A PIC  X(0001).
  3777     05  BEXPIR1I PIC  X(0008).
  3778*    -------------------------------
  3779     05  BCP1L PIC S9(0004) COMP.
  3780     05  BCP1F PIC  X(0001).
  3781     05  FILLER REDEFINES BCP1F.
  3782         10  BCP1A PIC  X(0001).
  3783     05  BCP1I PIC  X(0002).
  3784*    -------------------------------
  3785     05  BALTBN1L PIC S9(0004) COMP.
  3786     05  BALTBN1F PIC  X(0001).
  3787     05  FILLER REDEFINES BALTBN1F.
  3788         10  BALTBN1A PIC  X(0001).
  3789     05  BALTBN1I PIC  X(0012).
  3790*    -------------------------------
  3791     05  BALTPR1L PIC S9(0004) COMP.
  3792     05  BALTPR1F PIC  X(0001).
  3793     05  FILLER REDEFINES BALTPR1F.
  3794         10  BALTPR1A PIC  X(0001).
  3795     05  BALTPR1I PIC  X(0011).
  3796*    -------------------------------
  3797     05  BBNCD1L PIC S9(0004) COMP.
  3798     05  BBNCD1F PIC  X(0001).
  3799     05  FILLER REDEFINES BBNCD1F.
  3800         10  BBNCD1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  73
* VP6311.cbl
  3801     05  BBNCD1I PIC  X(0003).
  3802*    -------------------------------
  3803     05  BCPRM1L PIC S9(0004) COMP.
  3804     05  BCPRM1F PIC  X(0001).
  3805     05  FILLER REDEFINES BCPRM1F.
  3806         10  BCPRM1A PIC  X(0001).
  3807     05  BCPRM1I PIC  X(0011).
  3808*    -------------------------------
  3809     05  BCAPRM1L PIC S9(0004) COMP.
  3810     05  BCAPRM1F PIC  X(0001).
  3811     05  FILLER REDEFINES BCAPRM1F.
  3812         10  BCAPRM1A PIC  X(0001).
  3813     05  BCAPRM1I PIC  X(0011).
  3814*    -------------------------------
  3815     05  BENABR1L PIC S9(0004) COMP.
  3816     05  BENABR1F PIC  X(0001).
  3817     05  FILLER REDEFINES BENABR1F.
  3818         10  BENABR1A PIC  X(0001).
  3819     05  BENABR1I PIC  X(0005).
  3820*    -------------------------------
  3821     05  BDIFF1L PIC S9(0004) COMP.
  3822     05  BDIFF1F PIC  X(0001).
  3823     05  FILLER REDEFINES BDIFF1F.
  3824         10  BDIFF1A PIC  X(0001).
  3825     05  BDIFF1I PIC  X(0011).
  3826*    -------------------------------
  3827     05  BBILIT1L PIC S9(0004) COMP.
  3828     05  BBILIT1F PIC  X(0001).
  3829     05  FILLER REDEFINES BBILIT1F.
  3830         10  BBILIT1A PIC  X(0001).
  3831     05  BBILIT1I PIC  X(0008).
  3832*    -------------------------------
  3833     05  BADIFF1L PIC S9(0004) COMP.
  3834     05  BADIFF1F PIC  X(0001).
  3835     05  FILLER REDEFINES BADIFF1F.
  3836         10  BADIFF1A PIC  X(0001).
  3837     05  BADIFF1I PIC  X(0011).
  3838*    -------------------------------
  3839     05  BKIND2L PIC S9(0004) COMP.
  3840     05  BKIND2F PIC  X(0001).
  3841     05  FILLER REDEFINES BKIND2F.
  3842         10  BKIND2A PIC  X(0001).
  3843     05  BKIND2I PIC  X(0002).
  3844*    -------------------------------
  3845     05  BTYPE2L PIC S9(0004) COMP.
  3846     05  BTYPE2F PIC  X(0001).
  3847     05  FILLER REDEFINES BTYPE2F.
  3848         10  BTYPE2A PIC  X(0001).
  3849     05  BTYPE2I PIC  X(0003).
  3850*    -------------------------------
  3851     05  BTERM2L PIC S9(0004) COMP.
  3852     05  BTERM2F PIC  X(0001).
  3853     05  FILLER REDEFINES BTERM2F.
  3854         10  BTERM2A PIC  X(0001).
  3855     05  BTERM2I PIC  X(0003).
  3856*    -------------------------------
  3857     05  BBEN2L PIC S9(0004) COMP.
  3858     05  BBEN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  74
* VP6311.cbl
  3859     05  FILLER REDEFINES BBEN2F.
  3860         10  BBEN2A PIC  X(0001).
  3861     05  BBEN2I PIC  X(0012).
  3862*    -------------------------------
  3863     05  BPREM2L PIC S9(0004) COMP.
  3864     05  BPREM2F PIC  X(0001).
  3865     05  FILLER REDEFINES BPREM2F.
  3866         10  BPREM2A PIC  X(0001).
  3867     05  BPREM2I PIC  X(0011).
  3868*    -------------------------------
  3869     05  BEXPIR2L PIC S9(0004) COMP.
  3870     05  BEXPIR2F PIC  X(0001).
  3871     05  FILLER REDEFINES BEXPIR2F.
  3872         10  BEXPIR2A PIC  X(0001).
  3873     05  BEXPIR2I PIC  X(0008).
  3874*    -------------------------------
  3875     05  BCP2L PIC S9(0004) COMP.
  3876     05  BCP2F PIC  X(0001).
  3877     05  FILLER REDEFINES BCP2F.
  3878         10  BCP2A PIC  X(0001).
  3879     05  BCP2I PIC  X(0002).
  3880*    -------------------------------
  3881     05  BALTBN2L PIC S9(0004) COMP.
  3882     05  BALTBN2F PIC  X(0001).
  3883     05  FILLER REDEFINES BALTBN2F.
  3884         10  BALTBN2A PIC  X(0001).
  3885     05  BALTBN2I PIC  X(0012).
  3886*    -------------------------------
  3887     05  BALTPR2L PIC S9(0004) COMP.
  3888     05  BALTPR2F PIC  X(0001).
  3889     05  FILLER REDEFINES BALTPR2F.
  3890         10  BALTPR2A PIC  X(0001).
  3891     05  BALTPR2I PIC  X(0011).
  3892*    -------------------------------
  3893     05  BBNCD2L PIC S9(0004) COMP.
  3894     05  BBNCD2F PIC  X(0001).
  3895     05  FILLER REDEFINES BBNCD2F.
  3896         10  BBNCD2A PIC  X(0001).
  3897     05  BBNCD2I PIC  X(0003).
  3898*    -------------------------------
  3899     05  BCPRM2L PIC S9(0004) COMP.
  3900     05  BCPRM2F PIC  X(0001).
  3901     05  FILLER REDEFINES BCPRM2F.
  3902         10  BCPRM2A PIC  X(0001).
  3903     05  BCPRM2I PIC  X(0011).
  3904*    -------------------------------
  3905     05  BCAPRM2L PIC S9(0004) COMP.
  3906     05  BCAPRM2F PIC  X(0001).
  3907     05  FILLER REDEFINES BCAPRM2F.
  3908         10  BCAPRM2A PIC  X(0001).
  3909     05  BCAPRM2I PIC  X(0011).
  3910*    -------------------------------
  3911     05  BENABR2L PIC S9(0004) COMP.
  3912     05  BENABR2F PIC  X(0001).
  3913     05  FILLER REDEFINES BENABR2F.
  3914         10  BENABR2A PIC  X(0001).
  3915     05  BENABR2I PIC  X(0005).
  3916*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  75
* VP6311.cbl
  3917     05  BDIFF2L PIC S9(0004) COMP.
  3918     05  BDIFF2F PIC  X(0001).
  3919     05  FILLER REDEFINES BDIFF2F.
  3920         10  BDIFF2A PIC  X(0001).
  3921     05  BDIFF2I PIC  X(0011).
  3922*    -------------------------------
  3923     05  BBILIT2L PIC S9(0004) COMP.
  3924     05  BBILIT2F PIC  X(0001).
  3925     05  FILLER REDEFINES BBILIT2F.
  3926         10  BBILIT2A PIC  X(0001).
  3927     05  BBILIT2I PIC  X(0008).
  3928*    -------------------------------
  3929     05  BADIFF2L PIC S9(0004) COMP.
  3930     05  BADIFF2F PIC  X(0001).
  3931     05  FILLER REDEFINES BADIFF2F.
  3932         10  BADIFF2A PIC  X(0001).
  3933     05  BADIFF2I PIC  X(0011).
  3934*    -------------------------------
  3935     05  BERMSG1L PIC S9(0004) COMP.
  3936     05  BERMSG1F PIC  X(0001).
  3937     05  FILLER REDEFINES BERMSG1F.
  3938         10  BERMSG1A PIC  X(0001).
  3939     05  BERMSG1I PIC  X(0078).
  3940*    -------------------------------
  3941     05  BERMSG2L PIC S9(0004) COMP.
  3942     05  BERMSG2F PIC  X(0001).
  3943     05  FILLER REDEFINES BERMSG2F.
  3944         10  BERMSG2A PIC  X(0001).
  3945     05  BERMSG2I PIC  X(0078).
  3946*    -------------------------------
  3947     05  BERMSG3L PIC S9(0004) COMP.
  3948     05  BERMSG3F PIC  X(0001).
  3949     05  FILLER REDEFINES BERMSG3F.
  3950         10  BERMSG3A PIC  X(0001).
  3951     05  BERMSG3I PIC  X(0078).
  3952*    -------------------------------
  3953     05  BPFENTRL PIC S9(0004) COMP.
  3954     05  BPFENTRF PIC  X(0001).
  3955     05  FILLER REDEFINES BPFENTRF.
  3956         10  BPFENTRA PIC  X(0001).
  3957     05  BPFENTRI PIC  9(2).
  3958*    -------------------------------
  3959     05  BPF5HDRL PIC S9(0004) COMP.
  3960     05  BPF5HDRF PIC  X(0001).
  3961     05  FILLER REDEFINES BPF5HDRF.
  3962         10  BPF5HDRA PIC  X(0001).
  3963     05  BPF5HDRI PIC  X(0005).
  3964*    -------------------------------
  3965     05  BPF4HDRL PIC S9(0004) COMP.
  3966     05  BPF4HDRF PIC  X(0001).
  3967     05  FILLER REDEFINES BPF4HDRF.
  3968         10  BPF4HDRA PIC  X(0001).
  3969     05  BPF4HDRI PIC  X(0013).
  3970*    -------------------------------
  3971     05  BF15HDRL PIC S9(0004) COMP.
  3972     05  BF15HDRF PIC  X(0001).
  3973     05  FILLER REDEFINES BF15HDRF.
  3974         10  BF15HDRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  76
* VP6311.cbl
  3975     05  BF15HDRI PIC  X(0010).
  3976 01  VP631BO REDEFINES VP631BI.
  3977     05  FILLER            PIC  X(0012).
  3978*    -------------------------------
  3979     05  FILLER            PIC  X(0003).
  3980     05  BDATEO PIC  X(0008).
  3981*    -------------------------------
  3982     05  FILLER            PIC  X(0003).
  3983     05  BTIMEO PIC  99.99.
  3984*    -------------------------------
  3985     05  FILLER            PIC  X(0003).
  3986     05  BHEADO PIC  X(0038).
  3987*    -------------------------------
  3988     05  FILLER            PIC  X(0003).
  3989     05  BNCERTLO PIC  X(0008).
  3990*    -------------------------------
  3991     05  FILLER            PIC  X(0003).
  3992     05  BNCERTO PIC  X(0011).
  3993*    -------------------------------
  3994     05  FILLER            PIC  X(0003).
  3995     05  BNSTATLO PIC  X(0009).
  3996*    -------------------------------
  3997     05  FILLER            PIC  X(0003).
  3998     05  BNSTATO PIC  X(0002).
  3999*    -------------------------------
  4000     05  FILLER            PIC  X(0003).
  4001     05  BCHGTO PIC  X(0004).
  4002*    -------------------------------
  4003     05  FILLER            PIC  X(0003).
  4004     05  BCHGO PIC  ZZZ9.
  4005*    -------------------------------
  4006     05  FILLER            PIC  X(0003).
  4007     05  BCOMPIDO PIC  X(0003).
  4008*    -------------------------------
  4009     05  FILLER            PIC  X(0003).
  4010     05  BREGIONO PIC  X(0006).
  4011*    -------------------------------
  4012     05  FILLER            PIC  X(0003).
  4013     05  BUSERO PIC  X(0004).
  4014*    -------------------------------
  4015     05  FILLER            PIC  X(0003).
  4016     05  BMAINTO PIC  X(0001).
  4017*    -------------------------------
  4018     05  FILLER            PIC  X(0003).
  4019     05  BMANTBYO PIC  X(0004).
  4020*    -------------------------------
  4021     05  FILLER            PIC  X(0003).
  4022     05  BCHGHDGO PIC  X(0003).
  4023*    -------------------------------
  4024     05  FILLER            PIC  X(0003).
  4025     05  BMANTDTO PIC  X(0008).
  4026*    -------------------------------
  4027     05  FILLER            PIC  X(0003).
  4028     05  BMANTATO PIC  99.99.
  4029*    -------------------------------
  4030     05  FILLER            PIC  X(0003).
  4031     05  BCSRO PIC  X(0004).
  4032*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  77
* VP6311.cbl
  4033     05  FILLER            PIC  X(0003).
  4034     05  BBATCHO PIC  X(0006).
  4035*    -------------------------------
  4036     05  FILLER            PIC  X(0003).
  4037     05  BSEQO PIC  X(0004).
  4038*    -------------------------------
  4039     05  FILLER            PIC  X(0003).
  4040     05  BMOENDTO PIC  X(0008).
  4041*    -------------------------------
  4042     05  FILLER            PIC  X(0003).
  4043     05  BCARRO PIC  X(0001).
  4044*    -------------------------------
  4045     05  FILLER            PIC  X(0003).
  4046     05  BGROUPO PIC  X(0006).
  4047*    -------------------------------
  4048     05  FILLER            PIC  X(0003).
  4049     05  BSTATEO PIC  X(0002).
  4050*    -------------------------------
  4051     05  FILLER            PIC  X(0003).
  4052     05  BACCTO PIC  X(0010).
  4053*    -------------------------------
  4054     05  FILLER            PIC  X(0003).
  4055     05  BVINHO PIC  X(0004).
  4056*    -------------------------------
  4057     05  FILLER            PIC  X(0003).
  4058     05  BVINO PIC  X(0017).
  4059*    -------------------------------
  4060     05  FILLER            PIC  X(0003).
  4061     05  BREFHDGO PIC  X(0004).
  4062*    -------------------------------
  4063     05  FILLER            PIC  X(0003).
  4064     05  BREFO PIC  X(0012).
  4065*    -------------------------------
  4066     05  FILLER            PIC  X(0003).
  4067     05  BAGEDEFO PIC  X(0004).
  4068*    -------------------------------
  4069     05  FILLER            PIC  X(0003).
  4070     05  BCERTNOO PIC  X(0010).
  4071*    -------------------------------
  4072     05  FILLER            PIC  X(0003).
  4073     05  BSUFIXO PIC  X(0001).
  4074*    -------------------------------
  4075     05  FILLER            PIC  X(0003).
  4076     05  BEFFDTO PIC  X(0008).
  4077*    -------------------------------
  4078     05  FILLER            PIC  X(0003).
  4079     05  BLSTNMO PIC  X(0015).
  4080*    -------------------------------
  4081     05  FILLER            PIC  X(0003).
  4082     05  B1STNMO PIC  X(0010).
  4083*    -------------------------------
  4084     05  FILLER            PIC  X(0003).
  4085     05  BINITO PIC  X(0001).
  4086*    -------------------------------
  4087     05  FILLER            PIC  X(0003).
  4088     05  BSEXO PIC  X(0001).
  4089*    -------------------------------
  4090     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  78
* VP6311.cbl
  4091     05  BAGEO PIC  X(0002).
  4092*    -------------------------------
  4093     05  FILLER            PIC  X(0003).
  4094     05  BBIRTHO PIC  X(0008).
  4095*    -------------------------------
  4096     05  FILLER            PIC  X(0003).
  4097     05  BYEARO PIC  X(0004).
  4098*    -------------------------------
  4099     05  FILLER            PIC  X(0003).
  4100     05  BMAKEO PIC  X(0020).
  4101*    -------------------------------
  4102     05  FILLER            PIC  X(0003).
  4103     05  BMODELO PIC  X(0020).
  4104*    -------------------------------
  4105     05  FILLER            PIC  X(0003).
  4106     05  BFUTUREO PIC  X(0020).
  4107*    -------------------------------
  4108     05  FILLER            PIC  X(0003).
  4109     05  BOMETERO PIC  ZZZ,Z99.
  4110*    -------------------------------
  4111     05  FILLER            PIC  X(0003).
  4112     05  BMEMCAPO PIC  X(0011).
  4113*    -------------------------------
  4114     05  FILLER            PIC  X(0003).
  4115     05  BORIGHDO PIC  X(0010).
  4116*    -------------------------------
  4117     05  FILLER            PIC  X(0003).
  4118     05  BFORCEO PIC  X(0001).
  4119*    -------------------------------
  4120     05  FILLER            PIC  X(0003).
  4121     05  BENTRYO PIC  X(0001).
  4122*    -------------------------------
  4123     05  FILLER            PIC  X(0003).
  4124     05  BREINO PIC  X(0001).
  4125*    -------------------------------
  4126     05  FILLER            PIC  X(0003).
  4127     05  BBILCDO PIC  X(0001).
  4128*    -------------------------------
  4129     05  FILLER            PIC  X(0003).
  4130     05  BUNWRITO PIC  X(0001).
  4131*    -------------------------------
  4132     05  FILLER            PIC  X(0003).
  4133     05  BSKPCDO PIC  X(0001).
  4134*    -------------------------------
  4135     05  FILLER            PIC  X(0003).
  4136     05  BINDGRPO PIC  X(0001).
  4137*    -------------------------------
  4138     05  FILLER            PIC  X(0003).
  4139     05  BSIGO PIC  X(0001).
  4140*    -------------------------------
  4141     05  FILLER            PIC  X(0003).
  4142     05  BRTCLSO PIC  X(0002).
  4143*    -------------------------------
  4144     05  FILLER            PIC  X(0003).
  4145     05  BCHGCNTO PIC  X(0003).
  4146*    -------------------------------
  4147     05  FILLER            PIC  X(0003).
  4148     05  BMEMBERO PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  79
* VP6311.cbl
  4149*    -------------------------------
  4150     05  FILLER            PIC  X(0003).
  4151     05  BLNOFCRO PIC  X(0005).
  4152*    -------------------------------
  4153     05  FILLER            PIC  X(0003).
  4154     05  BKIND1O PIC  X(0002).
  4155*    -------------------------------
  4156     05  FILLER            PIC  X(0003).
  4157     05  BTYPE1O PIC  X(0003).
  4158*    -------------------------------
  4159     05  FILLER            PIC  X(0003).
  4160     05  BTERM1O PIC  X(0003).
  4161*    -------------------------------
  4162     05  FILLER            PIC  X(0003).
  4163     05  BBEN1O PIC  X(0012).
  4164*    -------------------------------
  4165     05  FILLER            PIC  X(0003).
  4166     05  BPREM1O PIC  X(0011).
  4167*    -------------------------------
  4168     05  FILLER            PIC  X(0003).
  4169     05  BEXPIR1O PIC  X(0008).
  4170*    -------------------------------
  4171     05  FILLER            PIC  X(0003).
  4172     05  BCP1O PIC  X(0002).
  4173*    -------------------------------
  4174     05  FILLER            PIC  X(0003).
  4175     05  BALTBN1O PIC  X(0012).
  4176*    -------------------------------
  4177     05  FILLER            PIC  X(0003).
  4178     05  BALTPR1O PIC  X(0011).
  4179*    -------------------------------
  4180     05  FILLER            PIC  X(0003).
  4181     05  BBNCD1O PIC  X(0003).
  4182*    -------------------------------
  4183     05  FILLER            PIC  X(0003).
  4184     05  BCPRM1O PIC  X(0011).
  4185*    -------------------------------
  4186     05  FILLER            PIC  X(0003).
  4187     05  BCAPRM1O PIC  X(0011).
  4188*    -------------------------------
  4189     05  FILLER            PIC  X(0003).
  4190     05  BENABR1O PIC  X(0005).
  4191*    -------------------------------
  4192     05  FILLER            PIC  X(0003).
  4193     05  BDIFF1O PIC  X(0011).
  4194*    -------------------------------
  4195     05  FILLER            PIC  X(0003).
  4196     05  BBILIT1O PIC  X(0008).
  4197*    -------------------------------
  4198     05  FILLER            PIC  X(0003).
  4199     05  BADIFF1O PIC  X(0011).
  4200*    -------------------------------
  4201     05  FILLER            PIC  X(0003).
  4202     05  BKIND2O PIC  X(0002).
  4203*    -------------------------------
  4204     05  FILLER            PIC  X(0003).
  4205     05  BTYPE2O PIC  X(0003).
  4206*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  80
* VP6311.cbl
  4207     05  FILLER            PIC  X(0003).
  4208     05  BTERM2O PIC  X(0003).
  4209*    -------------------------------
  4210     05  FILLER            PIC  X(0003).
  4211     05  BBEN2O PIC  X(0012).
  4212*    -------------------------------
  4213     05  FILLER            PIC  X(0003).
  4214     05  BPREM2O PIC  X(0011).
  4215*    -------------------------------
  4216     05  FILLER            PIC  X(0003).
  4217     05  BEXPIR2O PIC  X(0008).
  4218*    -------------------------------
  4219     05  FILLER            PIC  X(0003).
  4220     05  BCP2O PIC  X(0002).
  4221*    -------------------------------
  4222     05  FILLER            PIC  X(0003).
  4223     05  BALTBN2O PIC  X(0012).
  4224*    -------------------------------
  4225     05  FILLER            PIC  X(0003).
  4226     05  BALTPR2O PIC  X(0011).
  4227*    -------------------------------
  4228     05  FILLER            PIC  X(0003).
  4229     05  BBNCD2O PIC  X(0003).
  4230*    -------------------------------
  4231     05  FILLER            PIC  X(0003).
  4232     05  BCPRM2O PIC  X(0011).
  4233*    -------------------------------
  4234     05  FILLER            PIC  X(0003).
  4235     05  BCAPRM2O PIC  X(0011).
  4236*    -------------------------------
  4237     05  FILLER            PIC  X(0003).
  4238     05  BENABR2O PIC  X(0005).
  4239*    -------------------------------
  4240     05  FILLER            PIC  X(0003).
  4241     05  BDIFF2O PIC  X(0011).
  4242*    -------------------------------
  4243     05  FILLER            PIC  X(0003).
  4244     05  BBILIT2O PIC  X(0008).
  4245*    -------------------------------
  4246     05  FILLER            PIC  X(0003).
  4247     05  BADIFF2O PIC  X(0011).
  4248*    -------------------------------
  4249     05  FILLER            PIC  X(0003).
  4250     05  BERMSG1O PIC  X(0078).
  4251*    -------------------------------
  4252     05  FILLER            PIC  X(0003).
  4253     05  BERMSG2O PIC  X(0078).
  4254*    -------------------------------
  4255     05  FILLER            PIC  X(0003).
  4256     05  BERMSG3O PIC  X(0078).
  4257*    -------------------------------
  4258     05  FILLER            PIC  X(0003).
  4259     05  BPFENTRO PIC  X(0002).
  4260*    -------------------------------
  4261     05  FILLER            PIC  X(0003).
  4262     05  BPF5HDRO PIC  X(0005).
  4263*    -------------------------------
  4264     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  81
* VP6311.cbl
  4265     05  BPF4HDRO PIC  X(0013).
  4266*    -------------------------------
  4267     05  FILLER            PIC  X(0003).
  4268     05  BF15HDRO PIC  X(0010).
  4269*    -------------------------------
  4270 01  VP631CI REDEFINES VP631BI.
  4271     05  FILLER            PIC  X(0012).
  4272*    -------------------------------
  4273     05  CDATEL PIC S9(0004) COMP.
  4274     05  CDATEF PIC  X(0001).
  4275     05  FILLER REDEFINES CDATEF.
  4276         10  CDATEA PIC  X(0001).
  4277     05  CDATEI PIC  X(0008).
  4278*    -------------------------------
  4279     05  CTIMEL PIC S9(0004) COMP.
  4280     05  CTIMEF PIC  X(0001).
  4281     05  FILLER REDEFINES CTIMEF.
  4282         10  CTIMEA PIC  X(0001).
  4283     05  CTIMEI PIC  X(0005).
  4284*    -------------------------------
  4285     05  CHEADL PIC S9(0004) COMP.
  4286     05  CHEADF PIC  X(0001).
  4287     05  FILLER REDEFINES CHEADF.
  4288         10  CHEADA PIC  X(0001).
  4289     05  CHEADI PIC  X(0038).
  4290*    -------------------------------
  4291     05  CCHGTL PIC S9(0004) COMP.
  4292     05  CCHGTF PIC  X(0001).
  4293     05  FILLER REDEFINES CCHGTF.
  4294         10  CCHGTA PIC  X(0001).
  4295     05  CCHGTI PIC  X(0004).
  4296*    -------------------------------
  4297     05  CCHGL PIC S9(0004) COMP.
  4298     05  CCHGF PIC  X(0001).
  4299     05  FILLER REDEFINES CCHGF.
  4300         10  CCHGA PIC  X(0001).
  4301     05  CCHGI PIC  X(0004).
  4302*    -------------------------------
  4303     05  CMAINTL PIC S9(0004) COMP.
  4304     05  CMAINTF PIC  X(0001).
  4305     05  FILLER REDEFINES CMAINTF.
  4306         10  CMAINTA PIC  X(0001).
  4307     05  CMAINTI PIC  X(0001).
  4308*    -------------------------------
  4309     05  CMANTBYL PIC S9(0004) COMP.
  4310     05  CMANTBYF PIC  X(0001).
  4311     05  FILLER REDEFINES CMANTBYF.
  4312         10  CMANTBYA PIC  X(0001).
  4313     05  CMANTBYI PIC  X(0004).
  4314*    -------------------------------
  4315     05  CCHGHDGL PIC S9(0004) COMP.
  4316     05  CCHGHDGF PIC  X(0001).
  4317     05  FILLER REDEFINES CCHGHDGF.
  4318         10  CCHGHDGA PIC  X(0001).
  4319     05  CCHGHDGI PIC  X(0003).
  4320*    -------------------------------
  4321     05  CMANTDTL PIC S9(0004) COMP.
  4322     05  CMANTDTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  82
* VP6311.cbl
  4323     05  FILLER REDEFINES CMANTDTF.
  4324         10  CMANTDTA PIC  X(0001).
  4325     05  CMANTDTI PIC  X(0008).
  4326*    -------------------------------
  4327     05  CMANTATL PIC S9(0004) COMP.
  4328     05  CMANTATF PIC  X(0001).
  4329     05  FILLER REDEFINES CMANTATF.
  4330         10  CMANTATA PIC  X(0001).
  4331     05  CMANTATI PIC  X(0005).
  4332*    -------------------------------
  4333     05  CCSRL PIC S9(0004) COMP.
  4334     05  CCSRF PIC  X(0001).
  4335     05  FILLER REDEFINES CCSRF.
  4336         10  CCSRA PIC  X(0001).
  4337     05  CCSRI PIC  X(0004).
  4338*    -------------------------------
  4339     05  CBATCHL PIC S9(0004) COMP.
  4340     05  CBATCHF PIC  X(0001).
  4341     05  FILLER REDEFINES CBATCHF.
  4342         10  CBATCHA PIC  X(0001).
  4343     05  CBATCHI PIC  X(0006).
  4344*    -------------------------------
  4345     05  CSEQL PIC S9(0004) COMP.
  4346     05  CSEQF PIC  X(0001).
  4347     05  FILLER REDEFINES CSEQF.
  4348         10  CSEQA PIC  X(0001).
  4349     05  CSEQI PIC  X(0004).
  4350*    -------------------------------
  4351     05  CMOENDTL PIC S9(0004) COMP.
  4352     05  CMOENDTF PIC  X(0001).
  4353     05  FILLER REDEFINES CMOENDTF.
  4354         10  CMOENDTA PIC  X(0001).
  4355     05  CMOENDTI PIC  X(0008).
  4356*    -------------------------------
  4357     05  CCARRL PIC S9(0004) COMP.
  4358     05  CCARRF PIC  X(0001).
  4359     05  FILLER REDEFINES CCARRF.
  4360         10  CCARRA PIC  X(0001).
  4361     05  CCARRI PIC  X(0001).
  4362*    -------------------------------
  4363     05  CGROUPL PIC S9(0004) COMP.
  4364     05  CGROUPF PIC  X(0001).
  4365     05  FILLER REDEFINES CGROUPF.
  4366         10  CGROUPA PIC  X(0001).
  4367     05  CGROUPI PIC  X(0006).
  4368*    -------------------------------
  4369     05  CSTATEL PIC S9(0004) COMP.
  4370     05  CSTATEF PIC  X(0001).
  4371     05  FILLER REDEFINES CSTATEF.
  4372         10  CSTATEA PIC  X(0001).
  4373     05  CSTATEI PIC  X(0002).
  4374*    -------------------------------
  4375     05  CACCTL PIC S9(0004) COMP.
  4376     05  CACCTF PIC  X(0001).
  4377     05  FILLER REDEFINES CACCTF.
  4378         10  CACCTA PIC  X(0001).
  4379     05  CACCTI PIC  X(0010).
  4380*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  83
* VP6311.cbl
  4381     05  CORIGHDL PIC S9(0004) COMP.
  4382     05  CORIGHDF PIC  X(0001).
  4383     05  FILLER REDEFINES CORIGHDF.
  4384         10  CORIGHDA PIC  X(0001).
  4385     05  CORIGHDI PIC  X(0011).
  4386*    -------------------------------
  4387     05  CORGNOL PIC S9(0004) COMP.
  4388     05  CORGNOF PIC  X(0001).
  4389     05  FILLER REDEFINES CORGNOF.
  4390         10  CORGNOA PIC  X(0001).
  4391     05  CORGNOI PIC  X(0006).
  4392*    -------------------------------
  4393     05  CORGSEQL PIC S9(0004) COMP.
  4394     05  CORGSEQF PIC  X(0001).
  4395     05  FILLER REDEFINES CORGSEQF.
  4396         10  CORGSEQA PIC  X(0001).
  4397     05  CORGSEQI PIC  X(0004).
  4398*    -------------------------------
  4399     05  CREFHDGL PIC S9(0004) COMP.
  4400     05  CREFHDGF PIC  X(0001).
  4401     05  FILLER REDEFINES CREFHDGF.
  4402         10  CREFHDGA PIC  X(0001).
  4403     05  CREFHDGI PIC  X(0010).
  4404*    -------------------------------
  4405     05  CREFL PIC S9(0004) COMP.
  4406     05  CREFF PIC  X(0001).
  4407     05  FILLER REDEFINES CREFF.
  4408         10  CREFA PIC  X(0001).
  4409     05  CREFI PIC  X(0012).
  4410*    -------------------------------
  4411     05  CNHINTL PIC S9(0004) COMP.
  4412     05  CNHINTF PIC  X(0001).
  4413     05  FILLER REDEFINES CNHINTF.
  4414         10  CNHINTA PIC  X(0001).
  4415     05  CNHINTI PIC  9(7)V99.
  4416*    -------------------------------
  4417     05  CCERTNOL PIC S9(0004) COMP.
  4418     05  CCERTNOF PIC  X(0001).
  4419     05  FILLER REDEFINES CCERTNOF.
  4420         10  CCERTNOA PIC  X(0001).
  4421     05  CCERTNOI PIC  X(0010).
  4422*    -------------------------------
  4423     05  CSUFIXL PIC S9(0004) COMP.
  4424     05  CSUFIXF PIC  X(0001).
  4425     05  FILLER REDEFINES CSUFIXF.
  4426         10  CSUFIXA PIC  X(0001).
  4427     05  CSUFIXI PIC  X(0001).
  4428*    -------------------------------
  4429     05  CEFFDTL PIC S9(0004) COMP.
  4430     05  CEFFDTF PIC  X(0001).
  4431     05  FILLER REDEFINES CEFFDTF.
  4432         10  CEFFDTA PIC  X(0001).
  4433     05  CEFFDTI PIC  X(0008).
  4434*    -------------------------------
  4435     05  CLSTNML PIC S9(0004) COMP.
  4436     05  CLSTNMF PIC  X(0001).
  4437     05  FILLER REDEFINES CLSTNMF.
  4438         10  CLSTNMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  84
* VP6311.cbl
  4439     05  CLSTNMI PIC  X(0015).
  4440*    -------------------------------
  4441     05  CPCYNL PIC S9(0004) COMP.
  4442     05  CPCYNF PIC  X(0001).
  4443     05  FILLER REDEFINES CPCYNF.
  4444         10  CPCYNA PIC  X(0001).
  4445     05  CPCYNI PIC  X(0001).
  4446*    -------------------------------
  4447     05  CINAMEL PIC S9(0004) COMP.
  4448     05  CINAMEF PIC  X(0001).
  4449     05  FILLER REDEFINES CINAMEF.
  4450         10  CINAMEA PIC  X(0001).
  4451     05  CINAMEI PIC  X(0015).
  4452*    -------------------------------
  4453     05  CINITSL PIC S9(0004) COMP.
  4454     05  CINITSF PIC  X(0001).
  4455     05  FILLER REDEFINES CINITSF.
  4456         10  CINITSA PIC  X(0001).
  4457     05  CINITSI PIC  X(0010).
  4458*    -------------------------------
  4459     05  CCANREAL PIC S9(0004) COMP.
  4460     05  CCANREAF PIC  X(0001).
  4461     05  FILLER REDEFINES CCANREAF.
  4462         10  CCANREAA PIC  X(0001).
  4463     05  CCANREAI PIC  X(0001).
  4464*    -------------------------------
  4465     05  CKIND1L PIC S9(0004) COMP.
  4466     05  CKIND1F PIC  X(0001).
  4467     05  FILLER REDEFINES CKIND1F.
  4468         10  CKIND1A PIC  X(0001).
  4469     05  CKIND1I PIC  X(0002).
  4470*    -------------------------------
  4471     05  CCANDT1L PIC S9(0004) COMP.
  4472     05  CCANDT1F PIC  X(0001).
  4473     05  FILLER REDEFINES CCANDT1F.
  4474         10  CCANDT1A PIC  X(0001).
  4475     05  CCANDT1I PIC  X(0008).
  4476*    -------------------------------
  4477     05  CREFND1L PIC S9(0004) COMP.
  4478     05  CREFND1F PIC  X(0001).
  4479     05  FILLER REDEFINES CREFND1F.
  4480         10  CREFND1A PIC  X(0001).
  4481     05  CREFND1I PIC  S9(9)V99.
  4482*    -------------------------------
  4483     05  CMTHD1L PIC S9(0004) COMP.
  4484     05  CMTHD1F PIC  X(0001).
  4485     05  FILLER REDEFINES CMTHD1F.
  4486         10  CMTHD1A PIC  X(0001).
  4487     05  CMTHD1I PIC  X(0001).
  4488*    -------------------------------
  4489     05  CKIND2L PIC S9(0004) COMP.
  4490     05  CKIND2F PIC  X(0001).
  4491     05  FILLER REDEFINES CKIND2F.
  4492         10  CKIND2A PIC  X(0001).
  4493     05  CKIND2I PIC  X(0002).
  4494*    -------------------------------
  4495     05  CCANDT2L PIC S9(0004) COMP.
  4496     05  CCANDT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  85
* VP6311.cbl
  4497     05  FILLER REDEFINES CCANDT2F.
  4498         10  CCANDT2A PIC  X(0001).
  4499     05  CCANDT2I PIC  X(0008).
  4500*    -------------------------------
  4501     05  CREFND2L PIC S9(0004) COMP.
  4502     05  CREFND2F PIC  X(0001).
  4503     05  FILLER REDEFINES CREFND2F.
  4504         10  CREFND2A PIC  X(0001).
  4505     05  CREFND2I PIC  S9(9)V99.
  4506*    -------------------------------
  4507     05  CMTHD2L PIC S9(0004) COMP.
  4508     05  CMTHD2F PIC  X(0001).
  4509     05  FILLER REDEFINES CMTHD2F.
  4510         10  CMTHD2A PIC  X(0001).
  4511     05  CMTHD2I PIC  X(0001).
  4512*    -------------------------------
  4513     05  CLIVESL PIC S9(0004) COMP.
  4514     05  CLIVESF PIC  X(0001).
  4515     05  FILLER REDEFINES CLIVESF.
  4516         10  CLIVESA PIC  X(0001).
  4517     05  CLIVESI PIC  X(0003).
  4518*    -------------------------------
  4519     05  CFORCEL PIC S9(0004) COMP.
  4520     05  CFORCEF PIC  X(0001).
  4521     05  FILLER REDEFINES CFORCEF.
  4522         10  CFORCEA PIC  X(0001).
  4523     05  CFORCEI PIC  X(0001).
  4524*    -------------------------------
  4525     05  CBILCDL PIC S9(0004) COMP.
  4526     05  CBILCDF PIC  X(0001).
  4527     05  FILLER REDEFINES CBILCDF.
  4528         10  CBILCDA PIC  X(0001).
  4529     05  CBILCDI PIC  X(0001).
  4530*    -------------------------------
  4531     05  CCRFND1L PIC S9(0004) COMP.
  4532     05  CCRFND1F PIC  X(0001).
  4533     05  FILLER REDEFINES CCRFND1F.
  4534         10  CCRFND1A PIC  X(0001).
  4535     05  CCRFND1I PIC  X(0011).
  4536*    -------------------------------
  4537     05  CCRFND2L PIC S9(0004) COMP.
  4538     05  CCRFND2F PIC  X(0001).
  4539     05  FILLER REDEFINES CCRFND2F.
  4540         10  CCRFND2A PIC  X(0001).
  4541     05  CCRFND2I PIC  X(0011).
  4542*    -------------------------------
  4543     05  CBILIT1L PIC S9(0004) COMP.
  4544     05  CBILIT1F PIC  X(0001).
  4545     05  FILLER REDEFINES CBILIT1F.
  4546         10  CBILIT1A PIC  X(0001).
  4547     05  CBILIT1I PIC  X(0008).
  4548*    -------------------------------
  4549     05  CDRFND1L PIC S9(0004) COMP.
  4550     05  CDRFND1F PIC  X(0001).
  4551     05  FILLER REDEFINES CDRFND1F.
  4552         10  CDRFND1A PIC  X(0001).
  4553     05  CDRFND1I PIC  X(0011).
  4554*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  86
* VP6311.cbl
  4555     05  CBILIT2L PIC S9(0004) COMP.
  4556     05  CBILIT2F PIC  X(0001).
  4557     05  FILLER REDEFINES CBILIT2F.
  4558         10  CBILIT2A PIC  X(0001).
  4559     05  CBILIT2I PIC  X(0008).
  4560*    -------------------------------
  4561     05  CDRFND2L PIC S9(0004) COMP.
  4562     05  CDRFND2F PIC  X(0001).
  4563     05  FILLER REDEFINES CDRFND2F.
  4564         10  CDRFND2A PIC  X(0001).
  4565     05  CDRFND2I PIC  X(0011).
  4566*    -------------------------------
  4567     05  CCANTXTL PIC S9(0004) COMP.
  4568     05  CCANTXTF PIC  X(0001).
  4569     05  FILLER REDEFINES CCANTXTF.
  4570         10  CCANTXTA PIC  X(0001).
  4571     05  CCANTXTI PIC  X(0005).
  4572*    -------------------------------
  4573     05  CCANFEEL PIC S9(0004) COMP.
  4574     05  CCANFEEF PIC  X(0001).
  4575     05  FILLER REDEFINES CCANFEEF.
  4576         10  CCANFEEA PIC  X(0001).
  4577     05  CCANFEEI PIC  X(0002).
  4578*    -------------------------------
  4579     05  CTERM1L PIC S9(0004) COMP.
  4580     05  CTERM1F PIC  X(0001).
  4581     05  FILLER REDEFINES CTERM1F.
  4582         10  CTERM1A PIC  X(0001).
  4583     05  CTERM1I PIC  X(0003).
  4584*    -------------------------------
  4585     05  CRTERM1L PIC S9(0004) COMP.
  4586     05  CRTERM1F PIC  X(0001).
  4587     05  FILLER REDEFINES CRTERM1F.
  4588         10  CRTERM1A PIC  X(0001).
  4589     05  CRTERM1I PIC  X(0003).
  4590*    -------------------------------
  4591     05  CPREM1L PIC S9(0004) COMP.
  4592     05  CPREM1F PIC  X(0001).
  4593     05  FILLER REDEFINES CPREM1F.
  4594         10  CPREM1A PIC  X(0001).
  4595     05  CPREM1I PIC  X(0011).
  4596*    -------------------------------
  4597     05  CTERM2L PIC S9(0004) COMP.
  4598     05  CTERM2F PIC  X(0001).
  4599     05  FILLER REDEFINES CTERM2F.
  4600         10  CTERM2A PIC  X(0001).
  4601     05  CTERM2I PIC  X(0003).
  4602*    -------------------------------
  4603     05  CRTERM2L PIC S9(0004) COMP.
  4604     05  CRTERM2F PIC  X(0001).
  4605     05  FILLER REDEFINES CRTERM2F.
  4606         10  CRTERM2A PIC  X(0001).
  4607     05  CRTERM2I PIC  X(0003).
  4608*    -------------------------------
  4609     05  CPREM2L PIC S9(0004) COMP.
  4610     05  CPREM2F PIC  X(0001).
  4611     05  FILLER REDEFINES CPREM2F.
  4612         10  CPREM2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  87
* VP6311.cbl
  4613     05  CPREM2I PIC  X(0011).
  4614*    -------------------------------
  4615     05  CENTRDTL PIC S9(0004) COMP.
  4616     05  CENTRDTF PIC  X(0001).
  4617     05  FILLER REDEFINES CENTRDTF.
  4618         10  CENTRDTA PIC  X(0001).
  4619     05  CENTRDTI PIC  X(0008).
  4620*    -------------------------------
  4621     05  CPAYEEL PIC S9(0004) COMP.
  4622     05  CPAYEEF PIC  X(0001).
  4623     05  FILLER REDEFINES CPAYEEF.
  4624         10  CPAYEEA PIC  X(0001).
  4625     05  CPAYEEI PIC  X(0006).
  4626*    -------------------------------
  4627     05  CRFNDSWL PIC S9(0004) COMP.
  4628     05  CRFNDSWF PIC  X(0001).
  4629     05  FILLER REDEFINES CRFNDSWF.
  4630         10  CRFNDSWA PIC  X(0001).
  4631     05  CRFNDSWI PIC  X(0003).
  4632*    -------------------------------
  4633     05  CLFHDGL PIC S9(0004) COMP.
  4634     05  CLFHDGF PIC  X(0001).
  4635     05  FILLER REDEFINES CLFHDGF.
  4636         10  CLFHDGA PIC  X(0001).
  4637     05  CLFHDGI PIC  X(0006).
  4638*    -------------------------------
  4639     05  CAHHDGL PIC S9(0004) COMP.
  4640     05  CAHHDGF PIC  X(0001).
  4641     05  FILLER REDEFINES CAHHDGF.
  4642         10  CAHHDGA PIC  X(0001).
  4643     05  CAHHDGI PIC  X(0006).
  4644*    -------------------------------
  4645     05  CENTDTL PIC S9(0004) COMP.
  4646     05  CENTDTF PIC  X(0001).
  4647     05  FILLER REDEFINES CENTDTF.
  4648         10  CENTDTA PIC  X(0001).
  4649     05  CENTDTI PIC  X(0008).
  4650*    -------------------------------
  4651     05  CENTBYL PIC S9(0004) COMP.
  4652     05  CENTBYF PIC  X(0001).
  4653     05  FILLER REDEFINES CENTBYF.
  4654         10  CENTBYA PIC  X(0001).
  4655     05  CENTBYI PIC  X(0004).
  4656*    -------------------------------
  4657     05  CCHGCNTL PIC S9(0004) COMP.
  4658     05  CCHGCNTF PIC  X(0001).
  4659     05  FILLER REDEFINES CCHGCNTF.
  4660         10  CCHGCNTA PIC  X(0001).
  4661     05  CCHGCNTI PIC  X(0003).
  4662*    -------------------------------
  4663     05  CLFREFNL PIC S9(0004) COMP.
  4664     05  CLFREFNF PIC  X(0001).
  4665     05  FILLER REDEFINES CLFREFNF.
  4666         10  CLFREFNA PIC  X(0001).
  4667     05  CLFREFNI PIC  X(0006).
  4668*    -------------------------------
  4669     05  CAHREFNL PIC S9(0004) COMP.
  4670     05  CAHREFNF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  88
* VP6311.cbl
  4671     05  FILLER REDEFINES CAHREFNF.
  4672         10  CAHREFNA PIC  X(0001).
  4673     05  CAHREFNI PIC  X(0006).
  4674*    -------------------------------
  4675     05  CREINCDL PIC S9(0004) COMP.
  4676     05  CREINCDF PIC  X(0001).
  4677     05  FILLER REDEFINES CREINCDF.
  4678         10  CREINCDA PIC  X(0001).
  4679     05  CREINCDI PIC  X(0003).
  4680*    -------------------------------
  4681     05  CAEFFDTL PIC S9(0004) COMP.
  4682     05  CAEFFDTF PIC  X(0001).
  4683     05  FILLER REDEFINES CAEFFDTF.
  4684         10  CAEFFDTA PIC  X(0001).
  4685     05  CAEFFDTI PIC  X(0008).
  4686*    -------------------------------
  4687     05  CAEXPDTL PIC S9(0004) COMP.
  4688     05  CAEXPDTF PIC  X(0001).
  4689     05  FILLER REDEFINES CAEXPDTF.
  4690         10  CAEXPDTA PIC  X(0001).
  4691     05  CAEXPDTI PIC  X(0008).
  4692*    -------------------------------
  4693     05  COMMLFL PIC S9(0004) COMP.
  4694     05  COMMLFF PIC  X(0001).
  4695     05  FILLER REDEFINES COMMLFF.
  4696         10  COMMLFA PIC  X(0001).
  4697     05  COMMLFI PIC  X(0006).
  4698*    -------------------------------
  4699     05  COMMAHL PIC S9(0004) COMP.
  4700     05  COMMAHF PIC  X(0001).
  4701     05  FILLER REDEFINES COMMAHF.
  4702         10  COMMAHA PIC  X(0001).
  4703     05  COMMAHI PIC  X(0006).
  4704*    -------------------------------
  4705     05  CERMSG1L PIC S9(0004) COMP.
  4706     05  CERMSG1F PIC  X(0001).
  4707     05  FILLER REDEFINES CERMSG1F.
  4708         10  CERMSG1A PIC  X(0001).
  4709     05  CERMSG1I PIC  X(0078).
  4710*    -------------------------------
  4711     05  CERMSG2L PIC S9(0004) COMP.
  4712     05  CERMSG2F PIC  X(0001).
  4713     05  FILLER REDEFINES CERMSG2F.
  4714         10  CERMSG2A PIC  X(0001).
  4715     05  CERMSG2I PIC  X(0078).
  4716*    -------------------------------
  4717     05  CERMSG3L PIC S9(0004) COMP.
  4718     05  CERMSG3F PIC  X(0001).
  4719     05  FILLER REDEFINES CERMSG3F.
  4720         10  CERMSG3A PIC  X(0001).
  4721     05  CERMSG3I PIC  X(0078).
  4722*    -------------------------------
  4723     05  CPFENTRL PIC S9(0004) COMP.
  4724     05  CPFENTRF PIC  X(0001).
  4725     05  FILLER REDEFINES CPFENTRF.
  4726         10  CPFENTRA PIC  X(0001).
  4727     05  CPFENTRI PIC  9(2).
  4728*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  89
* VP6311.cbl
  4729     05  CPF5HDRL PIC S9(0004) COMP.
  4730     05  CPF5HDRF PIC  X(0001).
  4731     05  FILLER REDEFINES CPF5HDRF.
  4732         10  CPF5HDRA PIC  X(0001).
  4733     05  CPF5HDRI PIC  X(0005).
  4734*    -------------------------------
  4735     05  CPF4HDRL PIC S9(0004) COMP.
  4736     05  CPF4HDRF PIC  X(0001).
  4737     05  FILLER REDEFINES CPF4HDRF.
  4738         10  CPF4HDRA PIC  X(0001).
  4739     05  CPF4HDRI PIC  X(0013).
  4740*    -------------------------------
  4741     05  CF15HDRL PIC S9(0004) COMP.
  4742     05  CF15HDRF PIC  X(0001).
  4743     05  FILLER REDEFINES CF15HDRF.
  4744         10  CF15HDRA PIC  X(0001).
  4745     05  CF15HDRI PIC  X(0022).
  4746 01  VP631CO REDEFINES VP631BI.
  4747     05  FILLER            PIC  X(0012).
  4748*    -------------------------------
  4749     05  FILLER            PIC  X(0003).
  4750     05  CDATEO PIC  X(0008).
  4751*    -------------------------------
  4752     05  FILLER            PIC  X(0003).
  4753     05  CTIMEO PIC  99.99.
  4754*    -------------------------------
  4755     05  FILLER            PIC  X(0003).
  4756     05  CHEADO PIC  X(0038).
  4757*    -------------------------------
  4758     05  FILLER            PIC  X(0003).
  4759     05  CCHGTO PIC  X(0004).
  4760*    -------------------------------
  4761     05  FILLER            PIC  X(0003).
  4762     05  CCHGO PIC  ZZZ9.
  4763*    -------------------------------
  4764     05  FILLER            PIC  X(0003).
  4765     05  CMAINTO PIC  X(0001).
  4766*    -------------------------------
  4767     05  FILLER            PIC  X(0003).
  4768     05  CMANTBYO PIC  X(0004).
  4769*    -------------------------------
  4770     05  FILLER            PIC  X(0003).
  4771     05  CCHGHDGO PIC  X(0003).
  4772*    -------------------------------
  4773     05  FILLER            PIC  X(0003).
  4774     05  CMANTDTO PIC  X(0008).
  4775*    -------------------------------
  4776     05  FILLER            PIC  X(0003).
  4777     05  CMANTATO PIC  99.99.
  4778*    -------------------------------
  4779     05  FILLER            PIC  X(0003).
  4780     05  CCSRO PIC  X(0004).
  4781*    -------------------------------
  4782     05  FILLER            PIC  X(0003).
  4783     05  CBATCHO PIC  X(0006).
  4784*    -------------------------------
  4785     05  FILLER            PIC  X(0003).
  4786     05  CSEQO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  90
* VP6311.cbl
  4787*    -------------------------------
  4788     05  FILLER            PIC  X(0003).
  4789     05  CMOENDTO PIC  X(0008).
  4790*    -------------------------------
  4791     05  FILLER            PIC  X(0003).
  4792     05  CCARRO PIC  X(0001).
  4793*    -------------------------------
  4794     05  FILLER            PIC  X(0003).
  4795     05  CGROUPO PIC  X(0006).
  4796*    -------------------------------
  4797     05  FILLER            PIC  X(0003).
  4798     05  CSTATEO PIC  X(0002).
  4799*    -------------------------------
  4800     05  FILLER            PIC  X(0003).
  4801     05  CACCTO PIC  X(0010).
  4802*    -------------------------------
  4803     05  FILLER            PIC  X(0003).
  4804     05  CORIGHDO PIC  X(0011).
  4805*    -------------------------------
  4806     05  FILLER            PIC  X(0003).
  4807     05  CORGNOO PIC  X(0006).
  4808*    -------------------------------
  4809     05  FILLER            PIC  X(0003).
  4810     05  CORGSEQO PIC  X(0004).
  4811*    -------------------------------
  4812     05  FILLER            PIC  X(0003).
  4813     05  CREFHDGO PIC  X(0010).
  4814*    -------------------------------
  4815     05  FILLER            PIC  X(0003).
  4816     05  CREFO PIC  X(0012).
  4817*    -------------------------------
  4818     05  FILLER            PIC  X(0003).
  4819     05  CNHINTO PIC  999999.99.
  4820*    -------------------------------
  4821     05  FILLER            PIC  X(0003).
  4822     05  CCERTNOO PIC  X(0010).
  4823*    -------------------------------
  4824     05  FILLER            PIC  X(0003).
  4825     05  CSUFIXO PIC  X(0001).
  4826*    -------------------------------
  4827     05  FILLER            PIC  X(0003).
  4828     05  CEFFDTO PIC  X(0008).
  4829*    -------------------------------
  4830     05  FILLER            PIC  X(0003).
  4831     05  CLSTNMO PIC  X(0015).
  4832*    -------------------------------
  4833     05  FILLER            PIC  X(0003).
  4834     05  CPCYNO PIC  X(0001).
  4835*    -------------------------------
  4836     05  FILLER            PIC  X(0003).
  4837     05  CINAMEO PIC  X(0015).
  4838*    -------------------------------
  4839     05  FILLER            PIC  X(0003).
  4840     05  CINITSO PIC  X(0010).
  4841*    -------------------------------
  4842     05  FILLER            PIC  X(0003).
  4843     05  CCANREAO PIC  X(0001).
  4844*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  91
* VP6311.cbl
  4845     05  FILLER            PIC  X(0003).
  4846     05  CKIND1O PIC  X(0002).
  4847*    -------------------------------
  4848     05  FILLER            PIC  X(0003).
  4849     05  CCANDT1O PIC  X(0008).
  4850*    -------------------------------
  4851     05  FILLER            PIC  X(0003).
  4852     05  CREFND1O PIC  Z(7).99-.
  4853*    -------------------------------
  4854     05  FILLER            PIC  X(0003).
  4855     05  CMTHD1O PIC  X(0001).
  4856*    -------------------------------
  4857     05  FILLER            PIC  X(0003).
  4858     05  CKIND2O PIC  X(0002).
  4859*    -------------------------------
  4860     05  FILLER            PIC  X(0003).
  4861     05  CCANDT2O PIC  X(0008).
  4862*    -------------------------------
  4863     05  FILLER            PIC  X(0003).
  4864     05  CREFND2O PIC  Z(7).99-.
  4865*    -------------------------------
  4866     05  FILLER            PIC  X(0003).
  4867     05  CMTHD2O PIC  X(0001).
  4868*    -------------------------------
  4869     05  FILLER            PIC  X(0003).
  4870     05  CLIVESO PIC  X(0003).
  4871*    -------------------------------
  4872     05  FILLER            PIC  X(0003).
  4873     05  CFORCEO PIC  X(0001).
  4874*    -------------------------------
  4875     05  FILLER            PIC  X(0003).
  4876     05  CBILCDO PIC  X(0001).
  4877*    -------------------------------
  4878     05  FILLER            PIC  X(0003).
  4879     05  CCRFND1O PIC  Z(7).99-.
  4880*    -------------------------------
  4881     05  FILLER            PIC  X(0003).
  4882     05  CCRFND2O PIC  Z(7).99-.
  4883*    -------------------------------
  4884     05  FILLER            PIC  X(0003).
  4885     05  CBILIT1O PIC  X(0008).
  4886*    -------------------------------
  4887     05  FILLER            PIC  X(0003).
  4888     05  CDRFND1O PIC  Z(7).99-.
  4889*    -------------------------------
  4890     05  FILLER            PIC  X(0003).
  4891     05  CBILIT2O PIC  X(0008).
  4892*    -------------------------------
  4893     05  FILLER            PIC  X(0003).
  4894     05  CDRFND2O PIC  Z(7).99-.
  4895*    -------------------------------
  4896     05  FILLER            PIC  X(0003).
  4897     05  CCANTXTO PIC  X(0005).
  4898*    -------------------------------
  4899     05  FILLER            PIC  X(0003).
  4900     05  CCANFEEO PIC  Z9.
  4901*    -------------------------------
  4902     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  92
* VP6311.cbl
  4903     05  CTERM1O PIC  ZZ9.
  4904*    -------------------------------
  4905     05  FILLER            PIC  X(0003).
  4906     05  CRTERM1O PIC  ZZ9.
  4907*    -------------------------------
  4908     05  FILLER            PIC  X(0003).
  4909     05  CPREM1O PIC  ZZZZZZ9.99-.
  4910*    -------------------------------
  4911     05  FILLER            PIC  X(0003).
  4912     05  CTERM2O PIC  ZZ9.
  4913*    -------------------------------
  4914     05  FILLER            PIC  X(0003).
  4915     05  CRTERM2O PIC  ZZ9.
  4916*    -------------------------------
  4917     05  FILLER            PIC  X(0003).
  4918     05  CPREM2O PIC  ZZZZZZ9.99-.
  4919*    -------------------------------
  4920     05  FILLER            PIC  X(0003).
  4921     05  CENTRDTO PIC  X(0008).
  4922*    -------------------------------
  4923     05  FILLER            PIC  X(0003).
  4924     05  CPAYEEO PIC  X(0006).
  4925*    -------------------------------
  4926     05  FILLER            PIC  X(0003).
  4927     05  CRFNDSWO PIC  X(0003).
  4928*    -------------------------------
  4929     05  FILLER            PIC  X(0003).
  4930     05  CLFHDGO PIC  X(0006).
  4931*    -------------------------------
  4932     05  FILLER            PIC  X(0003).
  4933     05  CAHHDGO PIC  X(0006).
  4934*    -------------------------------
  4935     05  FILLER            PIC  X(0003).
  4936     05  CENTDTO PIC  X(0008).
  4937*    -------------------------------
  4938     05  FILLER            PIC  X(0003).
  4939     05  CENTBYO PIC  X(0004).
  4940*    -------------------------------
  4941     05  FILLER            PIC  X(0003).
  4942     05  CCHGCNTO PIC  X(0003).
  4943*    -------------------------------
  4944     05  FILLER            PIC  X(0003).
  4945     05  CLFREFNO PIC  X(0006).
  4946*    -------------------------------
  4947     05  FILLER            PIC  X(0003).
  4948     05  CAHREFNO PIC  X(0006).
  4949*    -------------------------------
  4950     05  FILLER            PIC  X(0003).
  4951     05  CREINCDO PIC  X(0003).
  4952*    -------------------------------
  4953     05  FILLER            PIC  X(0003).
  4954     05  CAEFFDTO PIC  X(0008).
  4955*    -------------------------------
  4956     05  FILLER            PIC  X(0003).
  4957     05  CAEXPDTO PIC  X(0008).
  4958*    -------------------------------
  4959     05  FILLER            PIC  X(0003).
  4960     05  COMMLFO PIC  .99999.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  93
* VP6311.cbl
  4961*    -------------------------------
  4962     05  FILLER            PIC  X(0003).
  4963     05  COMMAHO PIC  .99999.
  4964*    -------------------------------
  4965     05  FILLER            PIC  X(0003).
  4966     05  CERMSG1O PIC  X(0078).
  4967*    -------------------------------
  4968     05  FILLER            PIC  X(0003).
  4969     05  CERMSG2O PIC  X(0078).
  4970*    -------------------------------
  4971     05  FILLER            PIC  X(0003).
  4972     05  CERMSG3O PIC  X(0078).
  4973*    -------------------------------
  4974     05  FILLER            PIC  X(0003).
  4975     05  CPFENTRO PIC  X(0002).
  4976*    -------------------------------
  4977     05  FILLER            PIC  X(0003).
  4978     05  CPF5HDRO PIC  X(0005).
  4979*    -------------------------------
  4980     05  FILLER            PIC  X(0003).
  4981     05  CPF4HDRO PIC  X(0013).
  4982*    -------------------------------
  4983     05  FILLER            PIC  X(0003).
  4984     05  CF15HDRO PIC  X(0022).
  4985*    -------------------------------
  4986 01  VP631DI REDEFINES VP631BI.
  4987     05  FILLER            PIC  X(0012).
  4988*    -------------------------------
  4989     05  DDATEL PIC S9(0004) COMP.
  4990     05  DDATEF PIC  X(0001).
  4991     05  FILLER REDEFINES DDATEF.
  4992         10  DDATEA PIC  X(0001).
  4993     05  DDATEI PIC  X(0008).
  4994*    -------------------------------
  4995     05  DTIMEL PIC S9(0004) COMP.
  4996     05  DTIMEF PIC  X(0001).
  4997     05  FILLER REDEFINES DTIMEF.
  4998         10  DTIMEA PIC  X(0001).
  4999     05  DTIMEI PIC  X(0005).
  5000*    -------------------------------
  5001     05  DHEADL PIC S9(0004) COMP.
  5002     05  DHEADF PIC  X(0001).
  5003     05  FILLER REDEFINES DHEADF.
  5004         10  DHEADA PIC  X(0001).
  5005     05  DHEADI PIC  X(0038).
  5006*    -------------------------------
  5007     05  DLDATEL PIC S9(0004) COMP.
  5008     05  DLDATEF PIC  X(0001).
  5009     05  FILLER REDEFINES DLDATEF.
  5010         10  DLDATEA PIC  X(0001).
  5011     05  DLDATEI PIC  X(0010).
  5012*    -------------------------------
  5013     05  DBATCHL PIC S9(0004) COMP.
  5014     05  DBATCHF PIC  X(0001).
  5015     05  FILLER REDEFINES DBATCHF.
  5016         10  DBATCHA PIC  X(0001).
  5017     05  DBATCHI PIC  X(0011).
  5018*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  94
* VP6311.cbl
  5019     05  DACCTNML PIC S9(0004) COMP.
  5020     05  DACCTNMF PIC  X(0001).
  5021     05  FILLER REDEFINES DACCTNMF.
  5022         10  DACCTNMA PIC  X(0001).
  5023     05  DACCTNMI PIC  X(0030).
  5024*    -------------------------------
  5025     05  DPROCDTL PIC S9(0004) COMP.
  5026     05  DPROCDTF PIC  X(0001).
  5027     05  FILLER REDEFINES DPROCDTF.
  5028         10  DPROCDTA PIC  X(0001).
  5029     05  DPROCDTI PIC  X(0008).
  5030*    -------------------------------
  5031     05  DINPUTL PIC S9(0004) COMP.
  5032     05  DINPUTF PIC  X(0001).
  5033     05  FILLER REDEFINES DINPUTF.
  5034         10  DINPUTA PIC  X(0001).
  5035     05  DINPUTI PIC  X(0008).
  5036*    -------------------------------
  5037     05  DMAINDTL PIC S9(0004) COMP.
  5038     05  DMAINDTF PIC  X(0001).
  5039     05  FILLER REDEFINES DMAINDTF.
  5040         10  DMAINDTA PIC  X(0001).
  5041     05  DMAINDTI PIC  X(0008).
  5042*    -------------------------------
  5043     05  DCARRL PIC S9(0004) COMP.
  5044     05  DCARRF PIC  X(0001).
  5045     05  FILLER REDEFINES DCARRF.
  5046         10  DCARRA PIC  X(0001).
  5047     05  DCARRI PIC  X(0001).
  5048*    -------------------------------
  5049     05  DGROUPL PIC S9(0004) COMP.
  5050     05  DGROUPF PIC  X(0001).
  5051     05  FILLER REDEFINES DGROUPF.
  5052         10  DGROUPA PIC  X(0001).
  5053     05  DGROUPI PIC  X(0006).
  5054*    -------------------------------
  5055     05  DSTATEL PIC S9(0004) COMP.
  5056     05  DSTATEF PIC  X(0001).
  5057     05  FILLER REDEFINES DSTATEF.
  5058         10  DSTATEA PIC  X(0001).
  5059     05  DSTATEI PIC  X(0002).
  5060*    -------------------------------
  5061     05  DACCTL PIC S9(0004) COMP.
  5062     05  DACCTF PIC  X(0001).
  5063     05  FILLER REDEFINES DACCTF.
  5064         10  DACCTA PIC  X(0001).
  5065     05  DACCTI PIC  X(0010).
  5066*    -------------------------------
  5067     05  DRECVDTL PIC S9(0004) COMP.
  5068     05  DRECVDTF PIC  X(0001).
  5069     05  FILLER REDEFINES DRECVDTF.
  5070         10  DRECVDTA PIC  X(0001).
  5071     05  DRECVDTI PIC  X(0008).
  5072*    -------------------------------
  5073     05  DCSRL PIC S9(0004) COMP.
  5074     05  DCSRF PIC  X(0001).
  5075     05  FILLER REDEFINES DCSRF.
  5076         10  DCSRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  95
* VP6311.cbl
  5077     05  DCSRI PIC  X(0004).
  5078*    -------------------------------
  5079     05  DREFHDGL PIC S9(0004) COMP.
  5080     05  DREFHDGF PIC  X(0001).
  5081     05  FILLER REDEFINES DREFHDGF.
  5082         10  DREFHDGA PIC  X(0001).
  5083     05  DREFHDGI PIC  X(0010).
  5084*    -------------------------------
  5085     05  DREFL PIC S9(0004) COMP.
  5086     05  DREFF PIC  X(0001).
  5087     05  FILLER REDEFINES DREFF.
  5088         10  DREFA PIC  X(0001).
  5089     05  DREFI PIC  X(0012).
  5090*    -------------------------------
  5091     05  DLFPHDGL PIC S9(0004) COMP.
  5092     05  DLFPHDGF PIC  X(0001).
  5093     05  FILLER REDEFINES DLFPHDGF.
  5094         10  DLFPHDGA PIC  X(0001).
  5095     05  DLFPHDGI PIC  X(0010).
  5096*    -------------------------------
  5097     05  DAHPHDGL PIC S9(0004) COMP.
  5098     05  DAHPHDGF PIC  X(0001).
  5099     05  FILLER REDEFINES DAHPHDGF.
  5100         10  DAHPHDGA PIC  X(0001).
  5101     05  DAHPHDGI PIC  X(0010).
  5102*    -------------------------------
  5103     05  DLFRHDGL PIC S9(0004) COMP.
  5104     05  DLFRHDGF PIC  X(0001).
  5105     05  FILLER REDEFINES DLFRHDGF.
  5106         10  DLFRHDGA PIC  X(0001).
  5107     05  DLFRHDGI PIC  X(0009).
  5108*    -------------------------------
  5109     05  DAHRHDGL PIC S9(0004) COMP.
  5110     05  DAHRHDGF PIC  X(0001).
  5111     05  FILLER REDEFINES DAHRHDGF.
  5112         10  DAHRHDGA PIC  X(0001).
  5113     05  DAHRHDGI PIC  X(0009).
  5114*    -------------------------------
  5115     05  DRISSL PIC S9(0004) COMP.
  5116     05  DRISSF PIC  X(0001).
  5117     05  FILLER REDEFINES DRISSF.
  5118         10  DRISSA PIC  X(0001).
  5119     05  DRISSI PIC  X(0005).
  5120*    -------------------------------
  5121     05  DRLFPRML PIC S9(0004) COMP.
  5122     05  DRLFPRMF PIC  X(0001).
  5123     05  FILLER REDEFINES DRLFPRMF.
  5124         10  DRLFPRMA PIC  X(0001).
  5125     05  DRLFPRMI PIC  S9(9)V99.
  5126*    -------------------------------
  5127     05  DRAHPRML PIC S9(0004) COMP.
  5128     05  DRAHPRMF PIC  X(0001).
  5129     05  FILLER REDEFINES DRAHPRMF.
  5130         10  DRAHPRMA PIC  X(0001).
  5131     05  DRAHPRMI PIC  S9(9)V99.
  5132*    -------------------------------
  5133     05  DRCANCL PIC S9(0004) COMP.
  5134     05  DRCANCF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  96
* VP6311.cbl
  5135     05  FILLER REDEFINES DRCANCF.
  5136         10  DRCANCA PIC  X(0001).
  5137     05  DRCANCI PIC  X(0005).
  5138*    -------------------------------
  5139     05  DRLFRFDL PIC S9(0004) COMP.
  5140     05  DRLFRFDF PIC  X(0001).
  5141     05  FILLER REDEFINES DRLFRFDF.
  5142         10  DRLFRFDA PIC  X(0001).
  5143     05  DRLFRFDI PIC  S9(9)V99.
  5144*    -------------------------------
  5145     05  DRAHRFDL PIC S9(0004) COMP.
  5146     05  DRAHRFDF PIC  X(0001).
  5147     05  FILLER REDEFINES DRAHRFDF.
  5148         10  DRAHRFDA PIC  X(0001).
  5149     05  DRAHRFDI PIC  S9(9)V99.
  5150*    -------------------------------
  5151     05  DEISSL PIC S9(0004) COMP.
  5152     05  DEISSF PIC  X(0001).
  5153     05  FILLER REDEFINES DEISSF.
  5154         10  DEISSA PIC  X(0001).
  5155     05  DEISSI PIC  X(0005).
  5156*    -------------------------------
  5157     05  DELFPRML PIC S9(0004) COMP.
  5158     05  DELFPRMF PIC  X(0001).
  5159     05  FILLER REDEFINES DELFPRMF.
  5160         10  DELFPRMA PIC  X(0001).
  5161     05  DELFPRMI PIC  X(0011).
  5162*    -------------------------------
  5163     05  DEAHPRML PIC S9(0004) COMP.
  5164     05  DEAHPRMF PIC  X(0001).
  5165     05  FILLER REDEFINES DEAHPRMF.
  5166         10  DEAHPRMA PIC  X(0001).
  5167     05  DEAHPRMI PIC  X(0011).
  5168*    -------------------------------
  5169     05  DECANCL PIC S9(0004) COMP.
  5170     05  DECANCF PIC  X(0001).
  5171     05  FILLER REDEFINES DECANCF.
  5172         10  DECANCA PIC  X(0001).
  5173     05  DECANCI PIC  X(0005).
  5174*    -------------------------------
  5175     05  DELFRFDL PIC S9(0004) COMP.
  5176     05  DELFRFDF PIC  X(0001).
  5177     05  FILLER REDEFINES DELFRFDF.
  5178         10  DELFRFDA PIC  X(0001).
  5179     05  DELFRFDI PIC  X(0011).
  5180*    -------------------------------
  5181     05  DEAHRFDL PIC S9(0004) COMP.
  5182     05  DEAHRFDF PIC  X(0001).
  5183     05  FILLER REDEFINES DEAHRFDF.
  5184         10  DEAHRFDA PIC  X(0001).
  5185     05  DEAHRFDI PIC  X(0011).
  5186*    -------------------------------
  5187     05  DCISSL PIC S9(0004) COMP.
  5188     05  DCISSF PIC  X(0001).
  5189     05  FILLER REDEFINES DCISSF.
  5190         10  DCISSA PIC  X(0001).
  5191     05  DCISSI PIC  X(0005).
  5192*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  97
* VP6311.cbl
  5193     05  DCLFPRML PIC S9(0004) COMP.
  5194     05  DCLFPRMF PIC  X(0001).
  5195     05  FILLER REDEFINES DCLFPRMF.
  5196         10  DCLFPRMA PIC  X(0001).
  5197     05  DCLFPRMI PIC  X(0011).
  5198*    -------------------------------
  5199     05  DCAHPRML PIC S9(0004) COMP.
  5200     05  DCAHPRMF PIC  X(0001).
  5201     05  FILLER REDEFINES DCAHPRMF.
  5202         10  DCAHPRMA PIC  X(0001).
  5203     05  DCAHPRMI PIC  X(0011).
  5204*    -------------------------------
  5205     05  DCCANCL PIC S9(0004) COMP.
  5206     05  DCCANCF PIC  X(0001).
  5207     05  FILLER REDEFINES DCCANCF.
  5208         10  DCCANCA PIC  X(0001).
  5209     05  DCCANCI PIC  X(0005).
  5210*    -------------------------------
  5211     05  DCLFRFDL PIC S9(0004) COMP.
  5212     05  DCLFRFDF PIC  X(0001).
  5213     05  FILLER REDEFINES DCLFRFDF.
  5214         10  DCLFRFDA PIC  X(0001).
  5215     05  DCLFRFDI PIC  X(0011).
  5216*    -------------------------------
  5217     05  DCAHRFDL PIC S9(0004) COMP.
  5218     05  DCAHRFDF PIC  X(0001).
  5219     05  FILLER REDEFINES DCAHRFDF.
  5220         10  DCAHRFDA PIC  X(0001).
  5221     05  DCAHRFDI PIC  X(0011).
  5222*    -------------------------------
  5223     05  DOISSL PIC S9(0004) COMP.
  5224     05  DOISSF PIC  X(0001).
  5225     05  FILLER REDEFINES DOISSF.
  5226         10  DOISSA PIC  X(0001).
  5227     05  DOISSI PIC  X(0005).
  5228*    -------------------------------
  5229     05  DOLFPRML PIC S9(0004) COMP.
  5230     05  DOLFPRMF PIC  X(0001).
  5231     05  FILLER REDEFINES DOLFPRMF.
  5232         10  DOLFPRMA PIC  X(0001).
  5233     05  DOLFPRMI PIC  X(0011).
  5234*    -------------------------------
  5235     05  DOAHPRML PIC S9(0004) COMP.
  5236     05  DOAHPRMF PIC  X(0001).
  5237     05  FILLER REDEFINES DOAHPRMF.
  5238         10  DOAHPRMA PIC  X(0001).
  5239     05  DOAHPRMI PIC  X(0011).
  5240*    -------------------------------
  5241     05  DOCANCL PIC S9(0004) COMP.
  5242     05  DOCANCF PIC  X(0001).
  5243     05  FILLER REDEFINES DOCANCF.
  5244         10  DOCANCA PIC  X(0001).
  5245     05  DOCANCI PIC  X(0005).
  5246*    -------------------------------
  5247     05  DOLFRFDL PIC S9(0004) COMP.
  5248     05  DOLFRFDF PIC  X(0001).
  5249     05  FILLER REDEFINES DOLFRFDF.
  5250         10  DOLFRFDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  98
* VP6311.cbl
  5251     05  DOLFRFDI PIC  X(0011).
  5252*    -------------------------------
  5253     05  DOAHRFDL PIC S9(0004) COMP.
  5254     05  DOAHRFDF PIC  X(0001).
  5255     05  FILLER REDEFINES DOAHRFDF.
  5256         10  DOAHRFDA PIC  X(0001).
  5257     05  DOAHRFDI PIC  X(0011).
  5258*    -------------------------------
  5259     05  DITOTALL PIC S9(0004) COMP.
  5260     05  DITOTALF PIC  X(0001).
  5261     05  FILLER REDEFINES DITOTALF.
  5262         10  DITOTALA PIC  X(0001).
  5263     05  DITOTALI PIC  X(0005).
  5264*    -------------------------------
  5265     05  DIFATALL PIC S9(0004) COMP.
  5266     05  DIFATALF PIC  X(0001).
  5267     05  FILLER REDEFINES DIFATALF.
  5268         10  DIFATALA PIC  X(0001).
  5269     05  DIFATALI PIC  X(0005).
  5270*    -------------------------------
  5271     05  DIFORCEL PIC S9(0004) COMP.
  5272     05  DIFORCEF PIC  X(0001).
  5273     05  FILLER REDEFINES DIFORCEF.
  5274         10  DIFORCEA PIC  X(0001).
  5275     05  DIFORCEI PIC  X(0005).
  5276*    -------------------------------
  5277     05  DIHOLDL PIC S9(0004) COMP.
  5278     05  DIHOLDF PIC  X(0001).
  5279     05  FILLER REDEFINES DIHOLDF.
  5280         10  DIHOLDA PIC  X(0001).
  5281     05  DIHOLDI PIC  X(0005).
  5282*    -------------------------------
  5283     05  DIAVAILL PIC S9(0004) COMP.
  5284     05  DIAVAILF PIC  X(0001).
  5285     05  FILLER REDEFINES DIAVAILF.
  5286         10  DIAVAILA PIC  X(0001).
  5287     05  DIAVAILI PIC  X(0005).
  5288*    -------------------------------
  5289     05  DIGPREML PIC S9(0004) COMP.
  5290     05  DIGPREMF PIC  X(0001).
  5291     05  FILLER REDEFINES DIGPREMF.
  5292         10  DIGPREMA PIC  X(0001).
  5293     05  DIGPREMI PIC  X(0011).
  5294*    -------------------------------
  5295     05  DIBPREML PIC S9(0004) COMP.
  5296     05  DIBPREMF PIC  X(0001).
  5297     05  FILLER REDEFINES DIBPREMF.
  5298         10  DIBPREMA PIC  X(0001).
  5299     05  DIBPREMI PIC  X(0011).
  5300*    -------------------------------
  5301     05  DCTOTALL PIC S9(0004) COMP.
  5302     05  DCTOTALF PIC  X(0001).
  5303     05  FILLER REDEFINES DCTOTALF.
  5304         10  DCTOTALA PIC  X(0001).
  5305     05  DCTOTALI PIC  X(0005).
  5306*    -------------------------------
  5307     05  DCFATALL PIC S9(0004) COMP.
  5308     05  DCFATALF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page  99
* VP6311.cbl
  5309     05  FILLER REDEFINES DCFATALF.
  5310         10  DCFATALA PIC  X(0001).
  5311     05  DCFATALI PIC  X(0005).
  5312*    -------------------------------
  5313     05  DCFORCEL PIC S9(0004) COMP.
  5314     05  DCFORCEF PIC  X(0001).
  5315     05  FILLER REDEFINES DCFORCEF.
  5316         10  DCFORCEA PIC  X(0001).
  5317     05  DCFORCEI PIC  X(0005).
  5318*    -------------------------------
  5319     05  DCHOLDL PIC S9(0004) COMP.
  5320     05  DCHOLDF PIC  X(0001).
  5321     05  FILLER REDEFINES DCHOLDF.
  5322         10  DCHOLDA PIC  X(0001).
  5323     05  DCHOLDI PIC  X(0005).
  5324*    -------------------------------
  5325     05  DCAVAILL PIC S9(0004) COMP.
  5326     05  DCAVAILF PIC  X(0001).
  5327     05  FILLER REDEFINES DCAVAILF.
  5328         10  DCAVAILA PIC  X(0001).
  5329     05  DCAVAILI PIC  X(0005).
  5330*    -------------------------------
  5331     05  DCGPREML PIC S9(0004) COMP.
  5332     05  DCGPREMF PIC  X(0001).
  5333     05  FILLER REDEFINES DCGPREMF.
  5334         10  DCGPREMA PIC  X(0001).
  5335     05  DCGPREMI PIC  X(0011).
  5336*    -------------------------------
  5337     05  DCBPREML PIC S9(0004) COMP.
  5338     05  DCBPREMF PIC  X(0001).
  5339     05  FILLER REDEFINES DCBPREMF.
  5340         10  DCBPREMA PIC  X(0001).
  5341     05  DCBPREMI PIC  X(0011).
  5342*    -------------------------------
  5343     05  DNTOTALL PIC S9(0004) COMP.
  5344     05  DNTOTALF PIC  X(0001).
  5345     05  FILLER REDEFINES DNTOTALF.
  5346         10  DNTOTALA PIC  X(0001).
  5347     05  DNTOTALI PIC  X(0005).
  5348*    -------------------------------
  5349     05  DNFATALL PIC S9(0004) COMP.
  5350     05  DNFATALF PIC  X(0001).
  5351     05  FILLER REDEFINES DNFATALF.
  5352         10  DNFATALA PIC  X(0001).
  5353     05  DNFATALI PIC  X(0005).
  5354*    -------------------------------
  5355     05  DNFORCEL PIC S9(0004) COMP.
  5356     05  DNFORCEF PIC  X(0001).
  5357     05  FILLER REDEFINES DNFORCEF.
  5358         10  DNFORCEA PIC  X(0001).
  5359     05  DNFORCEI PIC  X(0005).
  5360*    -------------------------------
  5361     05  DNHOLDL PIC S9(0004) COMP.
  5362     05  DNHOLDF PIC  X(0001).
  5363     05  FILLER REDEFINES DNHOLDF.
  5364         10  DNHOLDA PIC  X(0001).
  5365     05  DNHOLDI PIC  X(0005).
  5366*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 100
* VP6311.cbl
  5367     05  DNAVAILL PIC S9(0004) COMP.
  5368     05  DNAVAILF PIC  X(0001).
  5369     05  FILLER REDEFINES DNAVAILF.
  5370         10  DNAVAILA PIC  X(0001).
  5371     05  DNAVAILI PIC  X(0005).
  5372*    -------------------------------
  5373     05  DNGPREML PIC S9(0004) COMP.
  5374     05  DNGPREMF PIC  X(0001).
  5375     05  FILLER REDEFINES DNGPREMF.
  5376         10  DNGPREMA PIC  X(0001).
  5377     05  DNGPREMI PIC  X(0011).
  5378*    -------------------------------
  5379     05  DNBPREML PIC S9(0004) COMP.
  5380     05  DNBPREMF PIC  X(0001).
  5381     05  FILLER REDEFINES DNBPREMF.
  5382         10  DNBPREMA PIC  X(0001).
  5383     05  DNBPREMI PIC  X(0011).
  5384*    -------------------------------
  5385     05  DERMSGL PIC S9(0004) COMP.
  5386     05  DERMSGF PIC  X(0001).
  5387     05  FILLER REDEFINES DERMSGF.
  5388         10  DERMSGA PIC  X(0001).
  5389     05  DERMSGI PIC  X(0075).
  5390*    -------------------------------
  5391     05  DPFENTRL PIC S9(0004) COMP.
  5392     05  DPFENTRF PIC  X(0001).
  5393     05  FILLER REDEFINES DPFENTRF.
  5394         10  DPFENTRA PIC  X(0001).
  5395     05  DPFENTRI PIC  9(2).
  5396 01  VP631DO REDEFINES VP631BI.
  5397     05  FILLER            PIC  X(0012).
  5398*    -------------------------------
  5399     05  FILLER            PIC  X(0003).
  5400     05  DDATEO PIC  X(0008).
  5401*    -------------------------------
  5402     05  FILLER            PIC  X(0003).
  5403     05  DTIMEO PIC  99.99.
  5404*    -------------------------------
  5405     05  FILLER            PIC  X(0003).
  5406     05  DHEADO PIC  X(0038).
  5407*    -------------------------------
  5408     05  FILLER            PIC  X(0003).
  5409     05  DLDATEO PIC  X(0010).
  5410*    -------------------------------
  5411     05  FILLER            PIC  X(0003).
  5412     05  DBATCHO PIC  X(0011).
  5413*    -------------------------------
  5414     05  FILLER            PIC  X(0003).
  5415     05  DACCTNMO PIC  X(0030).
  5416*    -------------------------------
  5417     05  FILLER            PIC  X(0003).
  5418     05  DPROCDTO PIC  X(0008).
  5419*    -------------------------------
  5420     05  FILLER            PIC  X(0003).
  5421     05  DINPUTO PIC  X(0008).
  5422*    -------------------------------
  5423     05  FILLER            PIC  X(0003).
  5424     05  DMAINDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 101
* VP6311.cbl
  5425*    -------------------------------
  5426     05  FILLER            PIC  X(0003).
  5427     05  DCARRO PIC  X(0001).
  5428*    -------------------------------
  5429     05  FILLER            PIC  X(0003).
  5430     05  DGROUPO PIC  X(0006).
  5431*    -------------------------------
  5432     05  FILLER            PIC  X(0003).
  5433     05  DSTATEO PIC  X(0002).
  5434*    -------------------------------
  5435     05  FILLER            PIC  X(0003).
  5436     05  DACCTO PIC  X(0010).
  5437*    -------------------------------
  5438     05  FILLER            PIC  X(0003).
  5439     05  DRECVDTO PIC  X(0008).
  5440*    -------------------------------
  5441     05  FILLER            PIC  X(0003).
  5442     05  DCSRO PIC  X(0004).
  5443*    -------------------------------
  5444     05  FILLER            PIC  X(0003).
  5445     05  DREFHDGO PIC  X(0010).
  5446*    -------------------------------
  5447     05  FILLER            PIC  X(0003).
  5448     05  DREFO PIC  X(0012).
  5449*    -------------------------------
  5450     05  FILLER            PIC  X(0003).
  5451     05  DLFPHDGO PIC  X(0010).
  5452*    -------------------------------
  5453     05  FILLER            PIC  X(0003).
  5454     05  DAHPHDGO PIC  X(0010).
  5455*    -------------------------------
  5456     05  FILLER            PIC  X(0003).
  5457     05  DLFRHDGO PIC  X(0009).
  5458*    -------------------------------
  5459     05  FILLER            PIC  X(0003).
  5460     05  DAHRHDGO PIC  X(0009).
  5461*    -------------------------------
  5462     05  FILLER            PIC  X(0003).
  5463     05  DRISSO PIC  ZZ99-.
  5464*    -------------------------------
  5465     05  FILLER            PIC  X(0003).
  5466     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5467*    -------------------------------
  5468     05  FILLER            PIC  X(0003).
  5469     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5470*    -------------------------------
  5471     05  FILLER            PIC  X(0003).
  5472     05  DRCANCO PIC  ZZ99-.
  5473*    -------------------------------
  5474     05  FILLER            PIC  X(0003).
  5475     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5476*    -------------------------------
  5477     05  FILLER            PIC  X(0003).
  5478     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5479*    -------------------------------
  5480     05  FILLER            PIC  X(0003).
  5481     05  DEISSO PIC  ZZ99-.
  5482*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 102
* VP6311.cbl
  5483     05  FILLER            PIC  X(0003).
  5484     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5485*    -------------------------------
  5486     05  FILLER            PIC  X(0003).
  5487     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5488*    -------------------------------
  5489     05  FILLER            PIC  X(0003).
  5490     05  DECANCO PIC  ZZ99-.
  5491*    -------------------------------
  5492     05  FILLER            PIC  X(0003).
  5493     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5494*    -------------------------------
  5495     05  FILLER            PIC  X(0003).
  5496     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5497*    -------------------------------
  5498     05  FILLER            PIC  X(0003).
  5499     05  DCISSO PIC  ZZ99-.
  5500*    -------------------------------
  5501     05  FILLER            PIC  X(0003).
  5502     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5503*    -------------------------------
  5504     05  FILLER            PIC  X(0003).
  5505     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5506*    -------------------------------
  5507     05  FILLER            PIC  X(0003).
  5508     05  DCCANCO PIC  ZZ99-.
  5509*    -------------------------------
  5510     05  FILLER            PIC  X(0003).
  5511     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5512*    -------------------------------
  5513     05  FILLER            PIC  X(0003).
  5514     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5515*    -------------------------------
  5516     05  FILLER            PIC  X(0003).
  5517     05  DOISSO PIC  ZZ99-.
  5518*    -------------------------------
  5519     05  FILLER            PIC  X(0003).
  5520     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5521*    -------------------------------
  5522     05  FILLER            PIC  X(0003).
  5523     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5524*    -------------------------------
  5525     05  FILLER            PIC  X(0003).
  5526     05  DOCANCO PIC  ZZ99-.
  5527*    -------------------------------
  5528     05  FILLER            PIC  X(0003).
  5529     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5530*    -------------------------------
  5531     05  FILLER            PIC  X(0003).
  5532     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5533*    -------------------------------
  5534     05  FILLER            PIC  X(0003).
  5535     05  DITOTALO PIC  ZZZ99.
  5536*    -------------------------------
  5537     05  FILLER            PIC  X(0003).
  5538     05  DIFATALO PIC  ZZZ99.
  5539*    -------------------------------
  5540     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 103
* VP6311.cbl
  5541     05  DIFORCEO PIC  ZZZ99.
  5542*    -------------------------------
  5543     05  FILLER            PIC  X(0003).
  5544     05  DIHOLDO PIC  ZZZ99.
  5545*    -------------------------------
  5546     05  FILLER            PIC  X(0003).
  5547     05  DIAVAILO PIC  ZZZ99.
  5548*    -------------------------------
  5549     05  FILLER            PIC  X(0003).
  5550     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5551*    -------------------------------
  5552     05  FILLER            PIC  X(0003).
  5553     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5554*    -------------------------------
  5555     05  FILLER            PIC  X(0003).
  5556     05  DCTOTALO PIC  ZZZ99.
  5557*    -------------------------------
  5558     05  FILLER            PIC  X(0003).
  5559     05  DCFATALO PIC  ZZZ99.
  5560*    -------------------------------
  5561     05  FILLER            PIC  X(0003).
  5562     05  DCFORCEO PIC  ZZZ99.
  5563*    -------------------------------
  5564     05  FILLER            PIC  X(0003).
  5565     05  DCHOLDO PIC  ZZZ99.
  5566*    -------------------------------
  5567     05  FILLER            PIC  X(0003).
  5568     05  DCAVAILO PIC  ZZZ99.
  5569*    -------------------------------
  5570     05  FILLER            PIC  X(0003).
  5571     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5572*    -------------------------------
  5573     05  FILLER            PIC  X(0003).
  5574     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5575*    -------------------------------
  5576     05  FILLER            PIC  X(0003).
  5577     05  DNTOTALO PIC  ---99.
  5578*    -------------------------------
  5579     05  FILLER            PIC  X(0003).
  5580     05  DNFATALO PIC  ---99.
  5581*    -------------------------------
  5582     05  FILLER            PIC  X(0003).
  5583     05  DNFORCEO PIC  ---99.
  5584*    -------------------------------
  5585     05  FILLER            PIC  X(0003).
  5586     05  DNHOLDO PIC  ---99.
  5587*    -------------------------------
  5588     05  FILLER            PIC  X(0003).
  5589     05  DNAVAILO PIC  ---99.
  5590*    -------------------------------
  5591     05  FILLER            PIC  X(0003).
  5592     05  DNGPREMO PIC  -------9.99.
  5593*    -------------------------------
  5594     05  FILLER            PIC  X(0003).
  5595     05  DNBPREMO PIC  -------9.99.
  5596*    -------------------------------
  5597     05  FILLER            PIC  X(0003).
  5598     05  DERMSGO PIC  X(0075).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 104
* VP6311.cbl
  5599*    -------------------------------
  5600     05  FILLER            PIC  X(0003).
  5601     05  DPFENTRO PIC  X(0002).
  5602*    -------------------------------
  5603 01  MAP-B REDEFINES VP631BI.
  5604     12  FILLER                  PIC X(569).
  5605*    12  FILLER                  PIC X(512).
  5606*    12  FILLER                  PIC X(510).
  5607     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5608         16  BKIND-LEN               PIC S9(4)  COMP.
  5609         16  BKIND-ATTRB             PIC X.
  5610         16  BKIND                   PIC XX.
  5611         16  BTYPE-LEN               PIC S9(4)  COMP.
  5612         16  BTYPE-ATTRB             PIC X.
  5613         16  BTYPE                   PIC X(3).
  5614         16  BTERM-LEN               PIC S9(4)  COMP.
  5615         16  BTERM-ATTRB             PIC X.
  5616         16  BTERMI                  PIC 999.
  5617         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5618         16  BBEN-LEN                PIC S9(4)  COMP.
  5619         16  BBEN-ATTRB              PIC X.
  5620         16  BBENI                   PIC 9(10)V99.
  5621*        16  BBENI                   PIC 9(12).
  5622         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5623         16  BPREM-LEN               PIC S9(4)  COMP.
  5624         16  BPREM-ATTRB             PIC X.
  5625         16  BPREMI                  PIC S9(9)V99.
  5626*        16  BPREMI                  PIC 9(11).
  5627         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5628         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5629         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5630         16  BEXPIRE-ATTRB           PIC X.
  5631         16  BEXPIRE                 PIC X(8).
  5632         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5633         16  BCRIT-PERD-ATTRB        PIC X.
  5634         16  BCRIT-PERDI             PIC 99.
  5635         16  BCRIT-PERDO REDEFINES
  5636                         BCRIT-PERDI PIC ZZ.
  5637         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5638         16  BALT-BEN-ATTRB          PIC X.
  5639         16  BALT-BENI               PIC 9(10)V99.
  5640*        16  BALT-BENI               PIC 9(12).
  5641         16  BALT-BENO REDEFINES
  5642                           BALT-BENI PIC Z(9).ZZ.
  5643         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5644         16  BALT-PREM-ATTRB         PIC X.
  5645         16  BALT-PREMI              PIC 9(9)V99.
  5646*        16  BALT-PREMI              PIC 9(11).
  5647         16  BALT-PREMO REDEFINES
  5648                          BALT-PREMI PIC Z(7).ZZ-.
  5649         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5650         16  BBEN-CD-ATTRB           PIC X.
  5651         16  BBEN-CD                 PIC XXX.
  5652         16  BCPREM-LEN              PIC S9(4)  COMP.
  5653         16  BCPREM-ATTRB            PIC X.
  5654         16  BCPREMI                 PIC S9(9)V99.
  5655*        16  BCPREMI                 PIC X(11).
  5656         16  BCPREMO REDEFINES BCPREMI
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 105
* VP6311.cbl
  5657                                     PIC Z(7).99-.
  5658         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5659         16  BCALT-PREM-ATTRB        PIC X.
  5660         16  BCALT-PREM              PIC Z(7).99-.
  5661         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5662         16  BBEN-ABBR-ATTRB         PIC X.
  5663         16  BBEN-ABBR               PIC X(5).
  5664         16  BDIFF-LEN               PIC S9(4)  COMP.
  5665         16  BDIFF-ATTRB             PIC X.
  5666         16  BDIFFO                  PIC Z(7).99-.
  5667         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5668         16  BBILL-LIT-ATTRB         PIC X.
  5669         16  BBILL-LIT               PIC X(8).
  5670         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5671         16  BDALT-PREM-ATTRB        PIC X.
  5672         16  BDALT-PREM              PIC Z(7).99-.
  5673
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 106
* VP6311.cbl
  5675
  5676****************************************************************
  5677*
  5678* Copyright (c) 2007-2013 Dell Inc.
  5679* All rights reserved.
  5680*
  5681****************************************************************
  5682 01  DFHEIV.
  5683   02  DFHEIV0               PIC X(35).
  5684   02  DFHEIV1               PIC X(08).
  5685   02  DFHEIV2               PIC X(08).
  5686   02  DFHEIV3               PIC X(08).
  5687   02  DFHEIV4               PIC X(06).
  5688   02  DFHEIV5               PIC X(04).
  5689   02  DFHEIV6               PIC X(04).
  5690   02  DFHEIV7               PIC X(02).
  5691   02  DFHEIV8               PIC X(02).
  5692   02  DFHEIV9               PIC X(01).
  5693   02  DFHEIV10              PIC S9(7) COMP-3.
  5694   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5695   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5696   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5697   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5698   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5699   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5700   02  DFHEIV17              PIC X(04).
  5701   02  DFHEIV18              PIC X(04).
  5702   02  DFHEIV19              PIC X(04).
  5703   02  DFHEIV20              USAGE IS POINTER.
  5704   02  DFHEIV21              USAGE IS POINTER.
  5705   02  DFHEIV22              USAGE IS POINTER.
  5706   02  DFHEIV23              USAGE IS POINTER.
  5707   02  DFHEIV24              USAGE IS POINTER.
  5708   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5709   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5710   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5711   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5712   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5713   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5714   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5715   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5716   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5717   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5718   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5719   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5720   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5721   02  FILLER                PIC X(02).
  5722   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5723   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5724   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5725   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5726   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5727   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5728   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5729 LINKAGE  SECTION.
  5730*****************************************************************
  5731*                                                               *
  5732* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 107
* VP6311.cbl
  5733* All rights reserved.                                          *
  5734*                                                               *
  5735*****************************************************************
  5736 01  dfheiblk.
  5737     02  eibtime          pic s9(7) comp-3.
  5738     02  eibdate          pic s9(7) comp-3.
  5739     02  eibtrnid         pic x(4).
  5740     02  eibtaskn         pic s9(7) comp-3.
  5741     02  eibtrmid         pic x(4).
  5742     02  dfheigdi         pic s9(4) comp.
  5743     02  eibcposn         pic s9(4) comp.
  5744     02  eibcalen         pic s9(4) comp.
  5745     02  eibaid           pic x(1).
  5746     02  eibfiller1       pic x(1).
  5747     02  eibfn            pic x(2).
  5748     02  eibfiller2       pic x(2).
  5749     02  eibrcode         pic x(6).
  5750     02  eibfiller3       pic x(2).
  5751     02  eibds            pic x(8).
  5752     02  eibreqid         pic x(8).
  5753     02  eibrsrce         pic x(8).
  5754     02  eibsync          pic x(1).
  5755     02  eibfree          pic x(1).
  5756     02  eibrecv          pic x(1).
  5757     02  eibsend          pic x(1).
  5758     02  eibatt           pic x(1).
  5759     02  eibeoc           pic x(1).
  5760     02  eibfmh           pic x(1).
  5761     02  eibcompl         pic x(1).
  5762     02  eibsig           pic x(1).
  5763     02  eibconf          pic x(1).
  5764     02  eiberr           pic x(1).
  5765     02  eibrldbk         pic x(1).
  5766     02  eiberrcd         pic x(4).
  5767     02  eibsynrb         pic x(1).
  5768     02  eibnodat         pic x(1).
  5769     02  eibfiller5       pic x(2).
  5770     02  eibresp          pic s9(8) comp.
  5771     02  eibresp2         pic s9(8) comp.
  5772     02  dfheigdj         pic s9(4) comp.
  5773     02  dfheigdk         pic s9(4) comp.
  5774 01  DFHCOMMAREA                 PIC X(1300).
  5775*                                COPY ERCPNDB.
  5776******************************************************************
  5777*                                                                *
  5778*                                                                *
  5779*                            ERCPNDB.                            *
  5780*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5781*                            VMOD=2.025                          *
  5782*                                                                *
  5783*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5784*                                                                *
  5785******************************************************************
  5786*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5787*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5788******************************************************************
  5789*                                                                *
  5790*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 108
* VP6311.cbl
  5791*   FILE TYPE = VSAM,KSDS                                        *
  5792*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5793*                                                                *
  5794*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5795*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5796*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5797*                                                 RKP=13,LEN=36  *
  5798*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5799*                                      AND CHG-SEQ.)             *
  5800*                                                RKP=49,LEN=11   *
  5801*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5802*                                      AND CHG-SEQ.)             *
  5803*                                                RKP=60,LEN=15   *
  5804*                                                                *
  5805*   LOG = NO                                                     *
  5806*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5807******************************************************************
  5808******************************************************************
  5809*                   C H A N G E   L O G
  5810*
  5811* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5812*-----------------------------------------------------------------
  5813*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5814* EFFECTIVE    NUMBER
  5815*-----------------------------------------------------------------
  5816* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5817* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5818* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5819* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5820* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5821* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5822* 032306                   PEMA  ADD BOW LOAN NUMBER
  5823* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5824* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5825* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5826* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5827* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5828* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5829* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5830* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5831* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  5832* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5833* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  5834******************************************************************
  5835
  5836 01  PENDING-BUSINESS.
  5837     12  PB-RECORD-ID                     PIC XX.
  5838         88  VALID-PB-ID                        VALUE 'PB'.
  5839
  5840     12  PB-CONTROL-PRIMARY.
  5841         16  PB-COMPANY-CD                PIC X.
  5842         16  PB-ENTRY-BATCH               PIC X(6).
  5843         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5844         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5845
  5846     12  PB-CONTROL-BY-ACCOUNT.
  5847         16  PB-COMPANY-CD-A1             PIC X.
  5848         16  PB-CARRIER                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 109
* VP6311.cbl
  5849         16  PB-GROUPING.
  5850             20  PB-GROUPING-PREFIX       PIC XXX.
  5851             20  PB-GROUPING-PRIME        PIC XXX.
  5852         16  PB-STATE                     PIC XX.
  5853         16  PB-ACCOUNT.
  5854             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5855             20  PB-ACCOUNT-PRIME         PIC X(6).
  5856         16  PB-CERT-EFF-DT               PIC XX.
  5857         16  PB-CERT-NO.
  5858             20  PB-CERT-PRIME            PIC X(10).
  5859             20  PB-CERT-SFX              PIC X.
  5860         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5861
  5862         16  PB-RECORD-TYPE               PIC X.
  5863             88  PB-MAILING-DATA                VALUE '0'.
  5864             88  PB-ISSUE                       VALUE '1'.
  5865             88  PB-CANCELLATION                VALUE '2'.
  5866             88  PB-BATCH-TRAILER               VALUE '9'.
  5867
  5868     12  PB-CONTROL-BY-ORIG-BATCH.
  5869         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5870         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5871         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5872         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5873
  5874     12  PB-CONTROL-BY-CSR.
  5875         16  PB-CSR-COMPANY-CD            PIC X.
  5876         16  PB-CSR-ID                    PIC X(4).
  5877         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5878         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5879         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5880******************************************************************
  5881*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5882******************************************************************
  5883
  5884     12  PB-LAST-MAINT-DT                 PIC XX.
  5885     12  PB-LAST-MAINT-BY                 PIC X(4).
  5886     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5887
  5888     12  PB-RECORD-BODY                   PIC X(375).
  5889
  5890     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5891         16  PB-CERT-ORIGIN               PIC X.
  5892             88  CLASIC-CREATED-CERT         VALUE '1'.
  5893         16  PB-I-NAME.
  5894             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5895             20  PB-I-INSURED-FIRST-NAME.
  5896                 24  PB-I-INSURED-1ST-INIT PIC X.
  5897                 24  FILLER                PIC X(9).
  5898             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5899         16  PB-I-AGE                     PIC S99   COMP-3.
  5900         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5901         16  PB-I-BIRTHDAY                PIC XX.
  5902         16  PB-I-INSURED-SEX             PIC X.
  5903             88  PB-SEX-MALE     VALUE 'M'.
  5904             88  PB-SEX-FEMALE   VALUE 'F'.
  5905
  5906         16  PB-I-LF-TERM                 PIC S999   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 110
* VP6311.cbl
  5907         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5908         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5909         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5910         16  PB-I-SKIP-CODE               PIC X.
  5911             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5912             88  PB-SKIP-JULY              VALUE '1'.
  5913             88  PB-SKIP-AUGUST            VALUE '2'.
  5914             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5915             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5916             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5917             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5918             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5919             88  PB-SKIP-JUNE              VALUE '8'.
  5920             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5921             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5922             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5923         16  PB-I-TERM-TYPE               PIC X.
  5924             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5925             88  PB-PAID-WEEKLY            VALUE 'W'.
  5926             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5927             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5928             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5929         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5930         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5931         16  PB-I-DATA-ENTRY-SW           PIC X.
  5932             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5933             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5934             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5935             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5936         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5937         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5938*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5939         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5940         16  FILLER                       PIC X.
  5941
  5942         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5943             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5944             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5945                                                   '90' THRU '99'.
  5946         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5947                                          PIC XX.
  5948         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5949         16  PB-I-AMOUNT-FINANCED REDEFINES
  5950                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5951         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  5952         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5953                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5954         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5955         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5956         16  PB-I-CLP-AMOUNT REDEFINES
  5957                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5958         16  PB-I-LF-CALC-FLAG            PIC X.
  5959             88 PB-COMP-LF-PREM               VALUE '?'.
  5960         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5961         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5962         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5963         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5964         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 111
* VP6311.cbl
  5965         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5966         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5967         16  PB-I-LF-ABBR                 PIC XXX.
  5968         16  PB-I-LF-INPUT-CD             PIC XX.
  5969
  5970         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5971             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5972             88  PB-INVALID-AH               VALUE '  ' '00'
  5973                                                   '90' THRU '99'.
  5974         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5975         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5976         16  PB-I-AH-CALC-FLAG            PIC X.
  5977             88 PB-COMP-AH-PREM                  VALUE '?'.
  5978         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5979         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5980         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  5981         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5982         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5983         16  PB-I-AH-ABBR                 PIC XXX.
  5984         16  PB-I-AH-INPUT-CD             PIC XXX.
  5985
  5986         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5987         16  PB-I-REIN-TABLE              PIC XXX.
  5988         16  PB-I-BUSINESS-TYPE           PIC 99.
  5989         16  PB-I-INDV-GRP-CD             PIC X.
  5990         16  PB-I-MORT-CODE.
  5991             20  PB-I-TABLE               PIC X.
  5992             20  PB-I-INTEREST            PIC XX.
  5993             20  PB-I-MORT-TYP            PIC X.
  5994         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5995         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5996         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5997         16  PB-I-INDV-GRP-OVRD           PIC X.
  5998         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5999         16  PB-I-SIG-SW                  PIC X.
  6000             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6001         16  PB-I-RATE-CLASS              PIC XX.
  6002         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6003         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6004         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6005         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6006         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6007         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6008         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6009         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6010         16  PB-I-OB-FLAG                 PIC X.
  6011             88  PB-I-OB                      VALUE 'B'.
  6012             88  PB-I-SUMMARY                 VALUE 'Z'.
  6013         16  PB-I-ENTRY-STATUS            PIC X.
  6014             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6015                                              'M' '5' '9' '2'.
  6016             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6017             88  PB-I-POLICY-PENDING          VALUE '2'.
  6018             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6019             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6020             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  6021             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6022             88  PB-I-REIN-ONLY               VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 112
* VP6311.cbl
  6023             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6024             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6025             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6026             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6027         16  PB-I-INT-CODE                PIC X.
  6028             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6029             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6030         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6031         16  PB-I-SOC-SEC-NO              PIC X(11).
  6032         16  PB-I-MEMBER-NO               PIC X(12).
  6033         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6034*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6035         16  PB-I-OLD-LOF                 PIC XXX.
  6036         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6037         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6038         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6039         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6040         16  PB-I-LIFE-INDICATOR          PIC X.
  6041             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6042         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6043         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6044                                          PIC S9(5)V99    COMP-3.
  6045         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6046             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6047             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6048         16  PB-I-1ST-PMT-DT              PIC XX.
  6049         16  PB-I-JOINT-INSURED.
  6050             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6051             20 PB-I-JOINT-FIRST-NAME.
  6052                24  PB-I-JOINT-FIRST-INIT PIC X.
  6053                24  FILLER                PIC X(9).
  6054             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6055*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6056         16  PB-I-BENEFICIARY-NAME.
  6057             20  PB-I-BANK-NUMBER         PIC X(10).
  6058             20  FILLER                   PIC X(15).
  6059         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6060         16  PB-I-REFERENCE               PIC X(12).
  6061         16  FILLER REDEFINES PB-I-REFERENCE.
  6062             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6063             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6064             20  PB-I-CLP-STATE           PIC XX.
  6065         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6066             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6067             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6068             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6069         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6070         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6071         16  PB-I-RESIDENT-STATE          PIC XX.
  6072         16  PB-I-RATE-CODE               PIC X(4).
  6073         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6074         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6075         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6076         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6077         16  PB-I-BANK-NOCHRGB            PIC 99.
  6078         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6079         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6080
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 113
* VP6311.cbl
  6081     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6082         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6083             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6084         16  PB-C-CANCEL-ORIGIN           PIC X.
  6085             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6086         16  PB-C-LF-CANCEL-DT            PIC XX.
  6087         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6088         16  PB-C-LF-CALC-REQ             PIC X.
  6089             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6090         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6091         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6092         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6093             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6094         16  PB-C-AH-CANCEL-DT            PIC XX.
  6095         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6096         16  PB-C-AH-CALC-REQ             PIC X.
  6097             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6098         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6099         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6100         16  PB-C-LAST-NAME               PIC X(15).
  6101         16  PB-C-REFUND-SW               PIC X.
  6102             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6103             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6104         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6105         16  PB-C-PAYEE-CODE              PIC X(6).
  6106         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6107         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6108         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6109         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6110         16  PB-C-REFERENCE               PIC X(12).
  6111         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6112         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6113         16  PB-C-POST-CARD-IND           PIC X.
  6114         16  PB-C-CANCEL-REASON           PIC X.
  6115         16  PB-C-REF-INTERFACE-SW        PIC X.
  6116         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6117         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6118         16  FILLER                       PIC X(01).
  6119*        16  FILLER                       PIC X(18).
  6120         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6121*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6122         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6123         16  PB-CANCELED-CERT-DATA.
  6124             20  PB-CI-INSURED-NAME.
  6125                 24  PB-CI-LAST-NAME      PIC X(15).
  6126                 24  PB-CI-INITIALS       PIC XX.
  6127             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6128             20  PB-CI-INSURED-SEX        PIC X.
  6129             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6130             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6131             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6132             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6133             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6134             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6135             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6136             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6137             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6138             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 114
* VP6311.cbl
  6139             20  PB-CI-RATE-CLASS         PIC XX.
  6140             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6141             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6142             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6143             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6144             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6145             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6146             20  PB-CI-LF-ABBR            PIC X(3).
  6147             20  PB-CI-AH-ABBR            PIC X(3).
  6148             20  PB-CI-OB-FLAG            PIC X.
  6149                 88  PB-CI-OB                VALUE 'B'.
  6150             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6151                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6152                                           'M' '4' '5' '9' '2'.
  6153                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6154                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6155                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6156                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6157                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6158                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6159                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6160                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6161                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6162                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6163                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6164                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6165                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6166             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6167                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6168                                           'M' '4' '5' '9' '2'.
  6169                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6170                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6171                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6172                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6173                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6174                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6175                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6176                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6177                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6178                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6179                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6180                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6181                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6182             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6183             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6184             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6185             20  PB-CI-MEMBER-NO          PIC X(12).
  6186             20  PB-CI-INT-CODE           PIC X.
  6187                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6188                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6189             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6190             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6191             20  PB-CI-COMP-EXCP-SW       PIC X.
  6192                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6193                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6194             20  PB-CI-ENTRY-STATUS       PIC X.
  6195             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6196             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 115
* VP6311.cbl
  6197             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6198             20  PB-CI-DEATH-DT           PIC XX.
  6199             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6200             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6201             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6202             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6203             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6204             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6205             20  PB-CI-ENTRY-DT              PIC XX.
  6206             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6207             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6208             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6209             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6210             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6211             20  PB-CI-OLD-LOF               PIC XXX.
  6212*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6213             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6214             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6215             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6216             20  PB-CI-INDV-GRP-CD           PIC X.
  6217             20  PB-CI-BENEFICIARY-NAME.
  6218                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6219                 24  FILLER                  PIC X(15).
  6220             20  PB-CI-NOTE-SW               PIC X.
  6221             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6222             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6223             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6224             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6225             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6226             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6227             20  PB-CI-FIRST-NAME            PIC X(10).
  6228             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6229
  6230         16  FILLER                       PIC X(13).
  6231*032306  16  FILLER                       PIC X(27).
  6232*        16  FILLER                       PIC X(46).
  6233
  6234     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6235         16  FILLER                       PIC X(10).
  6236         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6237         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6238         16  PB-M-INSURED-MID-INIT        PIC X.
  6239         16  PB-M-INSURED-AGE             PIC 99.
  6240         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6241         16  PB-M-INSURED-SEX             PIC X.
  6242         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6243         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6244         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6245         16  PB-M-INSURED-CITY-STATE.
  6246             20  PB-M-INSURED-CITY        PIC X(28).
  6247             20  PB-M-INSURED-STATE       PIC XX.
  6248         16  PB-M-INSURED-ZIP-CODE.
  6249             20  PB-M-INSURED-ZIP-PRIME.
  6250                 24  PB-M-INSURED-ZIP-1   PIC X.
  6251                     88  PB-M-CANADIAN-POST-CODE
  6252                                             VALUE 'A' THRU 'Z'.
  6253                 24  FILLER               PIC X(4).
  6254             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 116
* VP6311.cbl
  6255         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6256                                        PB-M-INSURED-ZIP-CODE.
  6257             20  PM-M-INS-CAN-POST1       PIC XXX.
  6258             20  PM-M-INS-CAN-POST2       PIC XXX.
  6259             20  FILLER                   PIC XXX.
  6260         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6261         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6262         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6263         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6264         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6265         16  PB-M-CRED-BENE-CITYST.
  6266             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6267             20  PB-M-CRED-BENE-STATE     PIC XX.
  6268         16  FILLER                       PIC X(92).
  6269
  6270     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6271         16  FILLER                       PIC X(10).
  6272         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6273         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6274         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6275         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6276         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6277         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6278         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6279         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6280         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6281         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6282         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6283         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6284         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6285         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6286         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6287         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6288         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6289         16  PB-ACCOUNT-NAME              PIC X(30).
  6290         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6291         16  PB-REFERENCE                 PIC X(12).
  6292         16  PB-B-RECEIVED-DT             PIC XX.
  6293         16  FILLER                       PIC X(234).
  6294
  6295     12  PB-RECORD-STATUS.
  6296         16  PB-CREDIT-SELECT-DT          PIC XX.
  6297         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6298         16  PB-BILLED-DT                 PIC XX.
  6299         16  PB-BILLING-STATUS            PIC X.
  6300             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6301             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6302             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6303         16  PB-RECORD-BILL               PIC X.
  6304             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6305             88  PB-RECORD-RETURNED           VALUE 'R'.
  6306             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6307             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6308             88  PB-OVERRIDE-AH               VALUE 'A'.
  6309             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6310         16  PB-BATCH-ENTRY               PIC X.
  6311             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6312             88  PB-REIN-ONLY-CERT            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 117
* VP6311.cbl
  6313             88  PB-REISSUED-CERT             VALUE 'E'.
  6314             88  PB-CASH-CERT                 VALUE 'C'.
  6315             88  PB-MONTHLY-CERT              VALUE 'M'.
  6316             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6317             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6318             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6319         16  PB-FORCE-CODE                PIC X.
  6320             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6321             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6322             88  PB-CANCEL-FORCE              VALUE '8'.
  6323             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6324             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6325             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6326             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6327             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6328             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6329             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6330             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6331         16  PB-FATAL-FLAG                PIC X.
  6332             88  PB-FATAL-ERRORS              VALUE 'X'.
  6333         16  PB-FORCE-ER-CD               PIC X.
  6334             88  PB-FORCE-ERRORS              VALUE 'F'.
  6335             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6336         16  PB-WARN-ER-CD                PIC X.
  6337             88  PB-WARNING-ERRORS            VALUE 'W'.
  6338         16  FILLER                       PIC X.
  6339         16  PB-OUT-BAL-CD                PIC X.
  6340             88  PB-OUT-OF-BAL                VALUE 'O'.
  6341         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6342         16  PB-AH-OVERRIDE-L1            PIC X.
  6343         16  PB-INPUT-DT                  PIC XX.
  6344         16  PB-INPUT-BY                  PIC X(4).
  6345         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6346         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6347         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6348         16  PB-LF-EARNING-METHOD         PIC X.
  6349         16  PB-AH-EARNING-METHOD         PIC X.
  6350         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6351         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6352         16  PB-REIN-CD                   PIC XXX.
  6353         16  PB-LF-REFUND-TYPE            PIC X.
  6354         16  PB-AH-REFUND-TYPE            PIC X.
  6355         16  PB-ACCT-EFF-DT               PIC XX.
  6356         16  PB-ACCT-EXP-DT               PIC XX.
  6357         16  PB-COMPANY-ID                PIC X(3).
  6358         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6359         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6360         16  PB-SV-CARRIER                PIC X.
  6361         16  PB-SV-GROUPING               PIC X(6).
  6362         16  PB-SV-STATE                  PIC XX.
  6363         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6364         16  PB-GA-BILLING-INFO.
  6365             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6366                                          PIC XX.
  6367         16  PB-SV-REMIT-TO  REDEFINES
  6368             PB-GA-BILLING-INFO           PIC X(10).
  6369         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6370         16  PB-I-LOAN-OFFICER            PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 118
* VP6311.cbl
  6371         16  PB-I-VIN                     PIC X(17).
  6372
  6373         16  FILLER                       PIC X(04).
  6374         16  IMNET-BYPASS-SW              PIC X.
  6375
  6376******************************************************************
  6377*                COMMON EDIT ERRORS                              *
  6378******************************************************************
  6379
  6380     12  PB-COMMON-ERRORS.
  6381         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6382                                           PIC S9(4)     COMP.
  6383
  6384******************************************************************
  6385*                                COPY ELCCERT.
  6386******************************************************************
  6387*                                                                *
  6388*                            ELCCERT.                            *
  6389*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6390*                            VMOD=2.013                          *
  6391*                                                                *
  6392*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6393*                                                                *
  6394*   FILE TYPE = VSAM,KSDS                                        *
  6395*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6396*                                                                *
  6397*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6398*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6399*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6400*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6401*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6402*                                                                *
  6403*   LOG = YES                                                    *
  6404*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6405******************************************************************
  6406*                   C H A N G E   L O G
  6407*
  6408* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6409*-----------------------------------------------------------------
  6410*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6411* EFFECTIVE    NUMBER
  6412*-----------------------------------------------------------------
  6413* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6414* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6415* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6416* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6417* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6418* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6419* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6420* 032612  CR2011110200001  PEMA  AHL CHANGES
  6421* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6422* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6423******************************************************************
  6424
  6425 01  CERTIFICATE-MASTER.
  6426     12  CM-RECORD-ID                      PIC XX.
  6427         88  VALID-CM-ID                      VALUE 'CM'.
  6428
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 119
* VP6311.cbl
  6429     12  CM-CONTROL-PRIMARY.
  6430         16  CM-COMPANY-CD                 PIC X.
  6431         16  CM-CARRIER                    PIC X.
  6432         16  CM-GROUPING.
  6433             20  CM-GROUPING-PREFIX        PIC X(3).
  6434             20  CM-GROUPING-PRIME         PIC X(3).
  6435         16  CM-STATE                      PIC XX.
  6436         16  CM-ACCOUNT.
  6437             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6438             20  CM-ACCOUNT-PRIME          PIC X(6).
  6439         16  CM-CERT-EFF-DT                PIC XX.
  6440         16  CM-CERT-NO.
  6441             20  CM-CERT-PRIME             PIC X(10).
  6442             20  CM-CERT-SFX               PIC X.
  6443
  6444     12  CM-CONTROL-BY-NAME.
  6445         16  CM-COMPANY-CD-A1              PIC X.
  6446         16  CM-INSURED-LAST-NAME          PIC X(15).
  6447         16  CM-INSURED-INITIALS.
  6448             20  CM-INSURED-INITIAL1       PIC X.
  6449             20  CM-INSURED-INITIAL2       PIC X.
  6450
  6451     12  CM-CONTROL-BY-SSN.
  6452         16  CM-COMPANY-CD-A2              PIC X.
  6453         16  CM-SOC-SEC-NO.
  6454             20  CM-SSN-STATE              PIC XX.
  6455             20  CM-SSN-ACCOUNT            PIC X(6).
  6456             20  CM-SSN-LN3.
  6457                 25  CM-INSURED-INITIALS-A2.
  6458                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6459                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6460                 25 CM-PART-LAST-NAME-A2         PIC X.
  6461
  6462     12  CM-CONTROL-BY-CERT-NO.
  6463         16  CM-COMPANY-CD-A4              PIC X.
  6464         16  CM-CERT-NO-A4                 PIC X(11).
  6465
  6466     12  CM-CONTROL-BY-MEMB.
  6467         16  CM-COMPANY-CD-A5              PIC X.
  6468         16  CM-MEMBER-NO.
  6469             20  CM-MEMB-STATE             PIC XX.
  6470             20  CM-MEMB-ACCOUNT           PIC X(6).
  6471             20  CM-MEMB-LN4.
  6472                 25  CM-INSURED-INITIALS-A5.
  6473                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6474                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6475                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6476
  6477     12  CM-INSURED-PROFILE-DATA.
  6478         16  CM-INSURED-FIRST-NAME.
  6479             20  CM-INSURED-1ST-INIT       PIC X.
  6480             20  FILLER                    PIC X(9).
  6481         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6482         16  CM-INSURED-SEX                PIC X.
  6483             88  CM-SEX-MALE                  VALUE 'M'.
  6484             88  CM-SEX-FEMAL                 VALUE 'F'.
  6485         16  CM-INSURED-JOINT-AGE          PIC 99.
  6486         16  CM-JOINT-INSURED-NAME.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 120
* VP6311.cbl
  6487             20  CM-JT-LAST-NAME           PIC X(15).
  6488             20  CM-JT-FIRST-NAME.
  6489                 24  CM-JT-1ST-INIT        PIC X.
  6490                 24  FILLER                PIC X(9).
  6491             20  CM-JT-INITIAL             PIC X.
  6492
  6493     12  CM-LIFE-DATA.
  6494         16  CM-LF-BENEFIT-CD              PIC XX.
  6495         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6496         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6497         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6498         16  CM-LF-DEV-CODE                PIC XXX.
  6499         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6500         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6501         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6502         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6503         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6504         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6505         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6506         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6507         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6508         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6509         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6510         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6511         16  cm-temp-epiq                  pic xx.
  6512             88  EPIQ-CLASS                  value 'EQ'.
  6513*        16  FILLER                        PIC XX.
  6514
  6515     12  CM-AH-DATA.
  6516         16  CM-AH-BENEFIT-CD              PIC XX.
  6517         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6518         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6519         16  CM-AH-DEV-CODE                PIC XXX.
  6520         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6521         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6522         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6523         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6524         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6525         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6526         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6527         16  CM-AH-PAID-THRU-DT            PIC XX.
  6528             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6529         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6530         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6531         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6532         16  FILLER                        PIC X.
  6533
  6534     12  CM-LOAN-INFORMATION.
  6535         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6536         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6537                                           PIC S9(5)V99  COMP-3.
  6538         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6539         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6540         16  CM-PAY-FREQUENCY              PIC S99.
  6541         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6542         16  CM-RATE-CLASS                 PIC XX.
  6543         16  CM-BENEFICIARY                PIC X(25).
  6544         16  CM-POLICY-FORM-NO             PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 121
* VP6311.cbl
  6545         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6546         16  CM-LAST-ADD-ON-DT             PIC XX.
  6547         16  CM-DEDUCTIBLE-AMOUNTS.
  6548             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6549             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6550         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6551             20  CM-RESIDENT-STATE         PIC XX.
  6552             20  CM-RATE-CODE              PIC X(4).
  6553             20  FILLER                    PIC XX.
  6554         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6555             20  CM-LOAN-OFFICER           PIC X(5).
  6556             20  FILLER                    PIC XXX.
  6557         16  CM-CSR-CODE                   PIC XXX.
  6558         16  CM-UNDERWRITING-CODE          PIC X.
  6559             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6560         16  CM-POST-CARD-IND              PIC X.
  6561         16  CM-NH-INTERFACE-SW            PIC X.
  6562         16  CM-PREMIUM-TYPE               PIC X.
  6563             88  CM-SING-PRM                  VALUE '1'.
  6564             88  CM-O-B-COVERAGE              VALUE '2'.
  6565             88  CM-OPEN-END                  VALUE '3'.
  6566         16  CM-IND-GRP-TYPE               PIC X.
  6567             88  CM-INDIVIDUAL                VALUE 'I'.
  6568             88  CM-GROUP                     VALUE 'G'.
  6569         16  CM-SKIP-CODE                  PIC X.
  6570             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6571             88  SKIP-JULY                    VALUE '1'.
  6572             88  SKIP-AUGUST                  VALUE '2'.
  6573             88  SKIP-SEPTEMBER               VALUE '3'.
  6574             88  SKIP-JULY-AUG                VALUE '4'.
  6575             88  SKIP-AUG-SEPT                VALUE '5'.
  6576             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6577             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6578             88  SKIP-JUNE                    VALUE '8'.
  6579             88  SKIP-JUNE-JULY               VALUE '9'.
  6580             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6581             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6582         16  CM-PAYMENT-MODE               PIC X.
  6583             88  PAY-MONTHLY                  VALUE SPACE.
  6584             88  PAY-WEEKLY                   VALUE '1'.
  6585             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6586             88  PAY-BI-WEEKLY                VALUE '3'.
  6587             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6588         16  CM-LOAN-NUMBER                PIC X(8).
  6589         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6590         16  CM-OLD-LOF                    PIC XXX.
  6591*        16  CM-LOAN-OFFICER               PIC XXX.
  6592         16  CM-REIN-TABLE                 PIC XXX.
  6593         16  CM-SPECIAL-REIN-CODE          PIC X.
  6594         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6595         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6596         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6597
  6598     12  CM-STATUS-DATA.
  6599         16  CM-ENTRY-STATUS               PIC X.
  6600         16  CM-ENTRY-DT                   PIC XX.
  6601
  6602         16  CM-LF-STATUS-AT-CANCEL        PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 122
* VP6311.cbl
  6603         16  CM-LF-CANCEL-DT               PIC XX.
  6604         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6605
  6606         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6607         16  CM-LF-DEATH-DT                PIC XX.
  6608         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6609
  6610         16  CM-LF-CURRENT-STATUS          PIC X.
  6611             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6612                                                'M' '4' '5' '9'.
  6613             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6614             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6615             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6616             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6617             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6618             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6619             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6620             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6621             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6622             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6623             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6624             88  CM-LF-DECLINED               VALUE 'D'.
  6625             88  CM-LF-VOIDED                 VALUE 'V'.
  6626
  6627         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6628         16  CM-AH-CANCEL-DT               PIC XX.
  6629         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6630
  6631         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6632         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6633         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6634
  6635         16  CM-AH-CURRENT-STATUS          PIC X.
  6636             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6637                                                'M' '4' '5' '9'.
  6638             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6639             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6640             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6641             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6642             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6643             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6644             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6645             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6646             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6647             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6648             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6649             88  CM-AH-DECLINED               VALUE 'D'.
  6650             88  CM-AH-VOIDED                 VALUE 'V'.
  6651
  6652         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6653             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6654             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6655             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6656         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6657
  6658         16  CM-ENTRY-BATCH                PIC X(6).
  6659         16  CM-LF-EXIT-BATCH              PIC X(6).
  6660         16  CM-AH-EXIT-BATCH              PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 123
* VP6311.cbl
  6661         16  CM-LAST-MONTH-END             PIC XX.
  6662
  6663     12  CM-NOTE-SW                        PIC X.
  6664         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6665         88  CERT-NOTES-PRESENT               VALUE '1'.
  6666         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6667         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6668         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6669         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6670         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6671         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6672     12  CM-COMP-EXCP-SW                   PIC X.
  6673         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6674         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6675     12  CM-INSURED-ADDRESS-SW             PIC X.
  6676         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6677         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6678
  6679*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6680     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6681     12  FILLER                            PIC X.
  6682
  6683*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6684     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6685     12  FILLER                            PIC X.
  6686*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6687     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6688
  6689     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6690         88  CERT-ADDED-BATCH                 VALUE ' '.
  6691         88  CERT-ADDED-ONLINE                VALUE '1'.
  6692         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6693         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6694         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6695     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6696         88  CERT-AS-LOADED                   VALUE ' '.
  6697         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6698         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6699         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6700         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6701         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6702         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6703         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6704
  6705     12  CM-ACCOUNT-COMM-PCTS.
  6706         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6707         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6708
  6709     12  CM-USER-FIELD                     PIC X.
  6710     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6711     12  CM-CLP-STATE                      PIC XX.
  6712     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6713     12  CM-USER-RESERVED                  PIC XXX.
  6714     12  FILLER REDEFINES CM-USER-RESERVED.
  6715         16  CM-AH-CLASS-CD                PIC XX.
  6716         16  F                             PIC X.
  6717******************************************************************
  6718*                                COPY ERCNOTE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 124
* VP6311.cbl
  6719******************************************************************
  6720*                                                                *
  6721*                                                                *
  6722*                            ERCNOTE                             *
  6723*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6724*                            VMOD=2.003                          *
  6725*                                                                *
  6726*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6727*                                                                *
  6728*        FILE TYPE= VSAM,KSDS                                    *
  6729*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6730*                                                                *
  6731*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6732*                                                                *
  6733*        LOG = YES                                               *
  6734*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6735*                                                                *
  6736******************************************************************
  6737*                   C H A N G E   L O G
  6738*
  6739* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6740*-----------------------------------------------------------------
  6741*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6742* EFFECTIVE    NUMBER
  6743*-----------------------------------------------------------------
  6744* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6745*                                FILE WILL CONTAIN BILLING NOTES O
  6746******************************************************************
  6747
  6748 01  CERTIFICATE-NOTE.
  6749     12  CN-RECORD-ID                PIC  XX.
  6750         88  VALID-CN-ID                  VALUE 'CN'.
  6751
  6752     12  CN-CONTROL-PRIMARY.
  6753         16  CN-COMPANY-CD           PIC X.
  6754         16  CN-CARRIER              PIC X.
  6755         16  CN-GROUPING.
  6756             20 CN-GROUPING-PREFIX   PIC XXX.
  6757             20 CN-GROUPING-PRIME    PIC XXX.
  6758         16  CN-STATE                PIC XX.
  6759         16  CN-ACCOUNT.
  6760             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6761             20 CN-ACCOUNT-PRIME     PIC X(6).
  6762         16  CN-CERT-EFF-DT          PIC XX.
  6763         16  CN-CERT-NO.
  6764             20  CN-CERT-PRIME       PIC X(10).
  6765             20  CN-CERT-SFX         PIC X.
  6766
  6767     12  CN-BILLING-START-LINE-NO    PIC 99.
  6768     12  CN-BILLING-END-LINE-NO      PIC 99.
  6769
  6770     12  CN-LINES.
  6771         16  CN-LINE OCCURS 10       PIC X(77).
  6772
  6773     12  CN-LAST-MAINT-DT            PIC XX.
  6774     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6775     12  CN-LAST-MAINT-USER          PIC X(4).
  6776     12  FILLER                      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 125
* VP6311.cbl
  6777******************************************************************
  6778*                                COPY ERCPNDM.
  6779******************************************************************
  6780*                                                                *
  6781*                                                                *
  6782*                            ERCPNDM                             *
  6783*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6784*                            VMOD=2.003                          *
  6785*                                                                *
  6786*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6787*                                                                *
  6788*   FILE TYPE = VSAM,KSDS                                        *
  6789*   RECORD SIZE = 374   RECFORM = FIX                            *
  6790*                                                                *
  6791*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6792*   ALTERNATE PATH    = NOT USED                                 *
  6793*                                                                *
  6794*   LOG = YES                                                    *
  6795*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6796******************************************************************
  6797*                   C H A N G E   L O G
  6798*
  6799* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6800*-----------------------------------------------------------------
  6801*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6802* EFFECTIVE    NUMBER
  6803*-----------------------------------------------------------------
  6804* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6805* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6806* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6807******************************************************************
  6808
  6809 01  PENDING-MAILING-DATA.
  6810     12  PM-RECORD-ID                      PIC XX.
  6811         88  VALID-MA-ID                       VALUE 'PM'.
  6812
  6813     12  PM-CONTROL-PRIMARY.
  6814         16  PM-COMPANY-CD                 PIC X.
  6815         16  PM-ENTRY-BATCH                PIC X(6).
  6816         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6817         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6818
  6819     12  FILLER                            PIC X(14).
  6820
  6821     12  PM-ACCESS-CONTROL.
  6822         16  PM-SOURCE-SYSTEM              PIC XX.
  6823             88  PM-FROM-CREDIT                VALUE 'CR'.
  6824             88  PM-FROM-VSI                   VALUE 'VS'.
  6825             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6826             88  PM-FROM-OTHER                 VALUE 'OT'.
  6827         16  PM-RECORD-ADD-DT              PIC XX.
  6828         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6829         16  PM-LAST-MAINT-DT              PIC XX.
  6830         16  PM-LAST-MAINT-BY              PIC XXXX.
  6831         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6832
  6833     12  PM-PROFILE-INFO.
  6834         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 126
* VP6311.cbl
  6835         16  PM-QUALIFY-CODE-2             PIC XX.
  6836         16  PM-QUALIFY-CODE-3             PIC XX.
  6837         16  PM-QUALIFY-CODE-4             PIC XX.
  6838         16  PM-QUALIFY-CODE-5             PIC XX.
  6839
  6840         16  PM-INSURED-LAST-NAME          PIC X(15).
  6841         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6842         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6843         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6844         16  PM-INSURED-BIRTH-DT           PIC XX.
  6845         16  PM-INSURED-SEX                PIC X.
  6846             88  PM-SEX-MALE                   VALUE 'M'.
  6847             88  PM-SEX-FEMALE                 VALUE 'F'.
  6848         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6849
  6850         16  PM-ADDRESS-CORRECTED          PIC X.
  6851         16  PM-JOINT-BIRTH-DT             PIC XX.
  6852*        16  FILLER                        PIC X(12).
  6853
  6854         16  PM-ADDRESS-LINE-1             PIC X(30).
  6855         16  PM-ADDRESS-LINE-2             PIC X(30).
  6856         16  PM-CITY-STATE.
  6857             20  PM-CITY                   PIC X(28).
  6858             20  PM-STATE                  PIC XX.
  6859         16  PM-ZIP.
  6860             20  PM-ZIP-CODE.
  6861                 24  PM-ZIP-1              PIC X.
  6862                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6863                 24  FILLER                PIC X(4).
  6864             20  PM-ZIP-PLUS4              PIC X(4).
  6865         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6866             20  PM-CAN-POST1              PIC XXX.
  6867             20  PM-CAN-POST2              PIC XXX.
  6868             20  FILLER                    PIC XXX.
  6869
  6870         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6871
  6872         16  FILLER                        PIC X(03).
  6873
  6874     12  PM-CRED-BENE-INFO.
  6875         16  PM-CRED-BENE-NAME             PIC X(25).
  6876         16  PM-CRED-BENE-ADDR             PIC X(30).
  6877         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6878         16  PM-CRED-BENE-CTYST.
  6879             20  PM-CRED-BENE-CITY         PIC X(28).
  6880             20  PM-CRED-BENE-STATE        PIC XX.
  6881         16  PM-CRED-BENE-ZIP.
  6882             20  PM-CB-ZIP-CODE.
  6883                 24  PM-CB-ZIP-1           PIC X.
  6884                     88  PM-CB-CANADIAN-POST-CODE
  6885                                  VALUE 'A' THRU 'Z'.
  6886                 24  FILLER                PIC X(4).
  6887             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6888         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6889             20  PM-CB-CAN-POST1           PIC XXX.
  6890             20  PM-CB-CAN-POST2           PIC XXX.
  6891             20  FILLER                    PIC XXX.
  6892     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 127
* VP6311.cbl
  6893         16  PM-MAIL-DATA OCCURS 7.
  6894             20  PM-MAIL-TYPE              PIC X.
  6895                 88  PM-12MO-MAILING           VALUE '1'.
  6896                 88  PM-EXP-MAILING            VALUE '2'.
  6897             20  PM-MAIL-STATUS            PIC X.
  6898                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6899                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6900                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6901             20  PM-MAIL-DATE              PIC XX.
  6902     12  FILLER                            PIC XX.
  6903     12  FILLER                            PIC X(12).
  6904*    12  FILLER                            PIC X(30).
  6905
  6906******************************************************************
  6907*                                COPY ERCMAIL.
  6908******************************************************************
  6909*                                                                *
  6910*                                                                *
  6911*                            ERCMAIL                             *
  6912*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6913*                            VMOD=2.003                          *
  6914*                                                                *
  6915*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6916*                                                                *
  6917*   FILE TYPE = VSAM,KSDS                                        *
  6918*   RECORD SIZE = 374   RECFORM = FIX                            *
  6919*                                                                *
  6920*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6921*   ALTERNATE PATH    = NOT USED                                 *
  6922*                                                                *
  6923*   LOG = YES                                                    *
  6924*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6925******************************************************************
  6926*                   C H A N G E   L O G
  6927*
  6928* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6929*-----------------------------------------------------------------
  6930*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6931* EFFECTIVE    NUMBER
  6932*-----------------------------------------------------------------
  6933* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6934* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6935* 111108                   PEMA  ADD CRED BENE ADDR2
  6936******************************************************************
  6937
  6938 01  MAILING-DATA.
  6939     12  MA-RECORD-ID                      PIC XX.
  6940         88  VALID-MA-ID                       VALUE 'MA'.
  6941
  6942     12  MA-CONTROL-PRIMARY.
  6943         16  MA-COMPANY-CD                 PIC X.
  6944         16  MA-CARRIER                    PIC X.
  6945         16  MA-GROUPING.
  6946             20  MA-GROUPING-PREFIX        PIC XXX.
  6947             20  MA-GROUPING-PRIME         PIC XXX.
  6948         16  MA-STATE                      PIC XX.
  6949         16  MA-ACCOUNT.
  6950             20  MA-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 128
* VP6311.cbl
  6951             20  MA-ACCOUNT-PRIME          PIC X(6).
  6952         16  MA-CERT-EFF-DT                PIC XX.
  6953         16  MA-CERT-NO.
  6954             20  MA-CERT-PRIME             PIC X(10).
  6955             20  MA-CERT-SFX               PIC X.
  6956
  6957     12  FILLER                            PIC XX.
  6958
  6959     12  MA-ACCESS-CONTROL.
  6960         16  MA-SOURCE-SYSTEM              PIC XX.
  6961             88  MA-FROM-CREDIT                VALUE 'CR'.
  6962             88  MA-FROM-VSI                   VALUE 'VS'.
  6963             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6964             88  MA-FROM-OTHER                 VALUE 'OT'.
  6965         16  MA-RECORD-ADD-DT              PIC XX.
  6966         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6967         16  MA-LAST-MAINT-DT              PIC XX.
  6968         16  MA-LAST-MAINT-BY              PIC XXXX.
  6969         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6970
  6971     12  MA-PROFILE-INFO.
  6972         16  MA-QUALIFY-CODE-1             PIC XX.
  6973         16  MA-QUALIFY-CODE-2             PIC XX.
  6974         16  MA-QUALIFY-CODE-3             PIC XX.
  6975         16  MA-QUALIFY-CODE-4             PIC XX.
  6976         16  MA-QUALIFY-CODE-5             PIC XX.
  6977
  6978         16  MA-INSURED-LAST-NAME          PIC X(15).
  6979         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6980         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6981         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6982         16  MA-INSURED-BIRTH-DT           PIC XX.
  6983         16  MA-INSURED-SEX                PIC X.
  6984             88  MA-SEX-MALE                   VALUE 'M'.
  6985             88  MA-SEX-FEMALE                 VALUE 'F'.
  6986         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6987
  6988         16  MA-ADDRESS-CORRECTED          PIC X.
  6989         16  MA-JOINT-BIRTH-DT             PIC XX.
  6990*        16  FILLER                        PIC X(12).
  6991
  6992         16  MA-ADDRESS-LINE-1             PIC X(30).
  6993         16  MA-ADDRESS-LINE-2             PIC X(30).
  6994         16  MA-CITY-STATE.
  6995             20  MA-CITY                   PIC X(28).
  6996             20  MA-ADDR-STATE             PIC XX.
  6997         16  MA-ZIP.
  6998             20  MA-ZIP-CODE.
  6999                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7000                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7001                 24  FILLER                PIC X(4).
  7002             20  MA-ZIP-PLUS4              PIC X(4).
  7003         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7004             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7005             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7006             20  FILLER                    PIC X(3).
  7007
  7008         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 129
* VP6311.cbl
  7009
  7010         16  FILLER                        PIC XXX.
  7011*        16  FILLER                        PIC X(10).
  7012
  7013     12  MA-CRED-BENE-INFO.
  7014         16  MA-CRED-BENE-NAME                 PIC X(25).
  7015         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7016         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7017         16  MA-CRED-BENE-CTYST.
  7018             20  MA-CRED-BENE-CITY             PIC X(28).
  7019             20  MA-CRED-BENE-STATE            PIC XX.
  7020         16  MA-CRED-BENE-ZIP.
  7021             20  MA-CB-ZIP-CODE.
  7022                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7023                     88  MA-CB-CANADIAN-POST-CODE
  7024                                           VALUE 'A' THRU 'Z'.
  7025                 24  FILLER                    PIC X(4).
  7026             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7027         16  MA-CB-CANADIAN-POSTAL-CODE
  7028                            REDEFINES MA-CRED-BENE-ZIP.
  7029             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7030             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7031             20  FILLER                        PIC X(3).
  7032     12  MA-POST-CARD-MAIL-DATA.
  7033         16  MA-MAIL-DATA OCCURS 7.
  7034             20  MA-MAIL-TYPE              PIC X.
  7035                 88  MA-12MO-MAILING           VALUE '1'.
  7036                 88  MA-EXP-MAILING            VALUE '2'.
  7037             20  MA-MAIL-STATUS            PIC X.
  7038                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7039                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7040                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7041             20  MA-MAIL-DATE              PIC XX.
  7042     12  FILLER                            PIC XX.
  7043     12  FILLER                            PIC XX.
  7044*    12  FILLER                            PIC X(30).
  7045******************************************************************
  7046*                                COPY ERCRQST.
  7047******************************************************************
  7048*                                                                *
  7049*                                                                *
  7050*                            ERCRQST.                            *
  7051*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7052*                            VMOD=2.002                          *
  7053*                                                                *
  7054*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7055*                                                                *
  7056*   FILE TYPE = VSAM,KSDS                                        *
  7057*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7058*                                                                *
  7059*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7060*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7061*                                   ACCOUNT, REF, BATCH)         *
  7062*                                                RKP=9, LEN=38   *
  7063*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7064*                                   ACCOUNT, REF, BATCH)         *
  7065*                                                RKP=47, LEN=46  *
  7066*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 130
* VP6311.cbl
  7067*                                   BATCH)                       *
  7068*                                                RKP=93, LEN=24  *
  7069*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7070*                                   REF, BATCH)                  *
  7071*                                                RKP=117, LEN=35 *
  7072*   LOG = NO                                                     *
  7073*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7074******************************************************************
  7075
  7076 01  AR-REQUEST-RECORD.
  7077     12  RQ-RECORD-ID                     PIC XX.
  7078         88  VALID-RQ-ID                        VALUE 'RQ'.
  7079
  7080     12  RQ-CONTROL-PRIMARY.
  7081         16  RQ-COMPANY-CD                PIC X.
  7082         16  RQ-ENTRY-BATCH               PIC X(6).
  7083
  7084     12  RQ-CONTROL-BY-ACCT-REF.
  7085         16  RQ-COMPANY-CD-A1             PIC X.
  7086         16  RQ-CARRIER-A1                PIC X.
  7087         16  RQ-GROUPING-A1               PIC X(6).
  7088         16  RQ-STATE-A1                  PIC XX.
  7089         16  RQ-ACCOUNT-A1                PIC X(10).
  7090         16  RQ-REFERENCE-A1              PIC X(12).
  7091         16  RQ-BATCH-A1                  PIC X(6).
  7092
  7093     12  RQ-CONTROL-BY-FIN-RESP.
  7094         16  RQ-COMPANY-CD-A2             PIC X.
  7095         16  RQ-CARRIER-A2                PIC X.
  7096         16  RQ-GROUPING-A2               PIC X(6).
  7097         16  RQ-FIN-RESP-A2               PIC X(10).
  7098         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7099         16  RQ-REFERENCE-A2              PIC X(12).
  7100         16  RQ-BATCH-A2                  PIC X(6).
  7101
  7102     12  RQ-CONTROL-BY-ACCT-AGENT.
  7103         16  RQ-COMPANY-CD-A3             PIC X.
  7104         16  RQ-CARRIER-A3                PIC X.
  7105         16  RQ-GROUPING-A3               PIC X(6).
  7106         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7107         16  RQ-BATCH-A3                  PIC X(6).
  7108
  7109     12  RQ-CONTROL-BY-SUMMARY.
  7110         16  RQ-COMPANY-CD-A4             PIC X.
  7111         16  RQ-SUMMARY-CODE              PIC X(6).
  7112         16  RQ-ACCOUNT-A4                PIC X(10).
  7113         16  RQ-REFERENCE-A4              PIC X(12).
  7114         16  RQ-BATCH-A4                  PIC X(6).
  7115
  7116     12  RQ-REQUEST-METHOD                PIC X.
  7117         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7118         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7119         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7120         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7121     12  FILLER                           PIC X.
  7122     12  RQ-STATUS                        PIC X.
  7123         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7124         88  RQ-RESUBMIT                      VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 131
* VP6311.cbl
  7125     12  RQ-PROCESSOR-ID                  PIC X(4).
  7126     12  RQ-ENTRY-DT                      PIC XX.
  7127     12  RQ-MO-END-DT                     PIC XX.
  7128     12  RQ-REQUEST-DT                    PIC XX.
  7129     12  RQ-STMT-DT                       PIC XX.
  7130     12  RQ-REVERSAL-DT                   PIC XX.
  7131     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7132     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7133
  7134     12  FILLER                           PIC X(27).
  7135
  7136******************************************************************
  7137
  7138*                                COPY ERCLOFC.
  7139******************************************************************
  7140*                                                                *
  7141*                                                                *
  7142*                            ERCLOFC                             *
  7143*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7144*                            VMOD=2.003                          *
  7145*                                                                *
  7146*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7147*                                                                *
  7148*   FILE TYPE = VSAM,KSDS                                        *
  7149*   RECORD SIZE = 670   RECFORM = FIX                            *
  7150*                                                                *
  7151*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7152*                                                                *
  7153*   LOG = YES                                                    *
  7154*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7155*                                                                *
  7156******************************************************************
  7157
  7158 01  LOAN-OFFICER-MASTER.
  7159     12  LO-RECORD-ID                PIC XX.
  7160         88  VALID-LO-ID                VALUE 'LO'.
  7161
  7162     12  LO-CONTROL-PRIMARY.
  7163         16  LO-COMPANY-CD           PIC X.
  7164         16  LO-CARRIER              PIC X.
  7165         16  LO-GROUPING.
  7166             20  LO-GROUPING-PREFIX  PIC XXX.
  7167             20  LO-GROUPING-PRIME   PIC XXX.
  7168         16  LO-STATE                PIC XX.
  7169         16  LO-ACCOUNT.
  7170             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7171             20  LO-ACCOUNT-PRIME    PIC X(6).
  7172         16  LO-OFFICER-CODE         PIC X(5).
  7173
  7174     12  LO-OFFICER-NAME             PIC X(30).
  7175
  7176     12  LO-LAST-MAINT-DT            PIC XX.
  7177     12  LO-LAST-USER                PIC X(4).
  7178     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7179
  7180     12  LO-COMP-CONTROL             PIC X.
  7181             88  LO-SHOW-COMP           VALUE 'Y'.
  7182             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 132
* VP6311.cbl
  7183     12  LO-DETAIL-CONTROL           PIC X.
  7184             88  LO-PRINT-DETAIL        VALUE 'D'.
  7185             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7186
  7187     12  LO-SV-CARRIER               PIC X.
  7188     12  LO-SV-GROUPING              PIC X(6).
  7189     12  LO-SV-STATE                 PIC XX.
  7190
  7191     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7192     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7193
  7194     12  LO-OFFICER-INFO.
  7195         16  FILLER OCCURS 12 TIMES.
  7196             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7197             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7198             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7199             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7200             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7201             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7202             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7203             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7204     12  FILLER                      PIC X(198).
  7205******************************************************************
  7206*                                COPY ERCPYAJ.
  7207******************************************************************
  7208*                                                                *
  7209*                            ERCPYAJ                             *
  7210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7211*                            VMOD=2.015                          *
  7212*                                                                *
  7213*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7214*                                                                *
  7215*                                                                *
  7216*   FILE TYPE = VSAM,KSDS                                        *
  7217*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7218*                                                                *
  7219*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7220*       ALTERNATE PATHS = NONE                                   *
  7221*                                                                *
  7222*   LOG = YES                                                    *
  7223*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7224******************************************************************
  7225******************************************************************
  7226*                   C H A N G E   L O G
  7227*
  7228* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7229*-----------------------------------------------------------------
  7230*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7231* EFFECTIVE    NUMBER
  7232*-----------------------------------------------------------------
  7233* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7234* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7235******************************************************************
  7236
  7237 01  PENDING-PAY-ADJ.
  7238     12  PY-RECORD-ID                     PIC XX.
  7239         88  VALID-PY-ID                        VALUE 'PY'.
  7240
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 133
* VP6311.cbl
  7241     12  PY-CONTROL-PRIMARY.
  7242         16  PY-COMPANY-CD                PIC X.
  7243         16  PY-CARRIER                   PIC X.
  7244         16  PY-GROUPING                  PIC X(6).
  7245         16  PY-FIN-RESP                  PIC X(10).
  7246         16  PY-ACCOUNT                   PIC X(10).
  7247         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7248                                          PIC X(10).
  7249         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7250         16  PY-RECORD-TYPE               PIC X.
  7251             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7252             88  PY-DEPOSIT                   VALUE 'D'.
  7253             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7254             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7255             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7256             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7257             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7258             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7259             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7260             88  PY-FICA-ENTRY                VALUE 'F'.
  7261             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7262             88  PY-POLICY-FEE                VALUE 'W'.
  7263             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7264
  7265     12  PY-PYMT-TYPE                     PIC X.
  7266             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7267             88  PY-REINS-PYMT                VALUE 'R'.
  7268             88  PY-EXP-PYMT                  VALUE 'E'.
  7269
  7270     12  PY-BIL-INV                       PIC X(6).
  7271     12  PY-REF-NO                        PIC X(12).
  7272
  7273     12  PY-LAST-MAINT-DT                 PIC XX.
  7274     12  PY-LAST-MAINT-BY                 PIC X(4).
  7275     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7276
  7277     12  PY-PYADJ-RECORD.
  7278         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7279         16  PY-ENTRY-COMMENT             PIC X(30).
  7280         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7281             20  PY-GL-ACCOUNT            PIC X(10).
  7282             20  PY-GL-STATE              PIC X(02).
  7283             20  PY-GL-CANC-SW            PIC X(01).
  7284                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7285                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7286             20  PY-GL-COMMENT            PIC X(10).
  7287             20  FILLER      REDEFINES PY-GL-COMMENT.
  7288                 24  PY-GL-CHECK-NO       PIC 9(06).
  7289                 24  FILLER               PIC X(04).
  7290             20  FILLER                   PIC X(07).
  7291         16  PY-SAVE-ACCOUNT              PIC X(10).
  7292         16  PY-SAVE-TYPE                 PIC X(01).
  7293
  7294         16  PY-LETTERS.
  7295             20  PY-LETTER OCCURS 3 TIMES
  7296                           INDEXED BY PY-LET-NDX
  7297                                          PIC X(04).
  7298
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 134
* VP6311.cbl
  7299         16  PY-ERCOMP-TYPE               PIC X.
  7300             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7301             88  PY-GA-TYPE                   VALUE 'G'.
  7302             88  PY-BANK-TYPE                 VALUE 'B'.
  7303         16  FILLER                       PIC X(05).
  7304
  7305     12  PY-RECORD-STATUS.
  7306         16  PY-CREDIT-SELECT-DT          PIC XX.
  7307         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7308         16  PY-BILLED-DATE               PIC XX.
  7309         16  PY-REPORTED-DT               PIC XX.
  7310         16  PY-PMT-APPLIED               PIC X.
  7311             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7312             88  PY-GA-PMT                    VALUE 'G'.
  7313             88  PY-OVWRITE-PMT               VALUE 'O'.
  7314             88  PY-NON-AR-PMT                VALUE 'N'.
  7315         16  FILLER                       PIC X(5).
  7316         16  PY-INPUT-DT                  PIC XX.
  7317         16  PY-CHECK-NUMBER              PIC X(6).
  7318         16  PY-VOID-SW                   PIC X.
  7319             88  PY-CHECK-VOIDED              VALUE 'V'.
  7320         16  PY-CHECK-ORIGIN-SW           PIC X.
  7321             88  PY-BILLING-CHECK             VALUE 'B'.
  7322             88  PY-REFUND-CHECK              VALUE 'R'.
  7323             88  PY-GA-CHECK                  VALUE 'G'.
  7324             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7325             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7326         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7327         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7328         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7329         16  PY-BILL-FLAG                 PIC X.
  7330             88  PY-BILLED                    VALUE 'B'.
  7331         16  PY-AR-FLAG                   PIC X.
  7332             88  PY-AR-CYCLE                  VALUE 'C'.
  7333             88  PY-AR-MONTH-END              VALUE 'M'.
  7334         16  PY-AR-DATE                   PIC XX.
  7335
  7336     12  PY-GL-CODES.
  7337         16  PY-GL-DB                     PIC X(14).
  7338         16  PY-GL-CR                     PIC X(14).
  7339         16  PY-GL-FLAG                   PIC X.
  7340         16  PY-GL-DATE                   PIC XX.
  7341
  7342     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7343     12  FILLER                           PIC X(3).
  7344******************************************************************
  7345*                                COPY ERCCNOT.
  7346******************************************************************
  7347*                                                                *
  7348*                            ERCCNOT                             *
  7349*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7350*                            VMOD=2.003                          *
  7351*                                                                *
  7352*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7353*                                                                *
  7354*        FILE TYPE= VSAM,KSDS                                    *
  7355*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7356*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 135
* VP6311.cbl
  7357*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7358*                                                                *
  7359*        LOG = YES                                               *
  7360*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7361*                                                                *
  7362******************************************************************
  7363*                   C H A N G E   L O G
  7364*
  7365* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7366*-----------------------------------------------------------------
  7367*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7368* EFFECTIVE    NUMBER
  7369*-----------------------------------------------------------------
  7370* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7371******************************************************************
  7372
  7373 01  CERT-NOTE-FILE.
  7374     12  CZ-RECORD-ID                PIC  XX.
  7375         88  VALID-CZ-ID                  VALUE 'CZ'.
  7376
  7377     12  CZ-CONTROL-PRIMARY.
  7378         16  CZ-COMPANY-CD           PIC X.
  7379         16  CZ-CARRIER              PIC X.
  7380         16  CZ-GROUPING.
  7381             20 CZ-GROUPING-PREFIX   PIC XXX.
  7382             20 CZ-GROUPING-PRIME    PIC XXX.
  7383         16  CZ-STATE                PIC XX.
  7384         16  CZ-ACCOUNT.
  7385             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7386             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7387         16  CZ-CERT-EFF-DT          PIC XX.
  7388         16  CZ-CERT-NO.
  7389             20  CZ-CERT-PRIME       PIC X(10).
  7390             20  CZ-CERT-SFX         PIC X.
  7391         16  CZ-RECORD-TYPE          PIC X.
  7392             88  CERT-NOTE           VALUE '1'.
  7393             88  CLAIM-CERT-NOTE     VALUE '2'.
  7394         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7395
  7396     12  CZ-LAST-MAINT-DT            PIC XX.
  7397     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7398     12  CZ-LAST-MAINT-USER          PIC X(4).
  7399
  7400     12  CZ-NOTE-INFORMATION.
  7401         16  CZ-NOTE                 PIC X(63).
  7402         16  FILLER                  PIC X(39).
  7403******************************************************************
  7404*                                COPY ELCMSTR.
  7405******************************************************************
  7406*                                                                *
  7407*                            ELCMSTR.                            *
  7408*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7409*                            VMOD=2.012                          *
  7410*                                                                *
  7411*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7412*                                                                *
  7413*   FILE TYPE = VSAM,KSDS                                        *
  7414*   RECORD SIZE = 350  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 136
* VP6311.cbl
  7415*                                                                *
  7416*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7417*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7418*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7419*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7420*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7421*                                                 RKP=75,LEN=21  *
  7422*                                                                *
  7423*   **** NOTE ****                                               *
  7424*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7425*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7426*                                                                *
  7427*   LOG = YES                                                    *
  7428*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7429******************************************************************
  7430*                   C H A N G E   L O G
  7431*
  7432* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7433*-----------------------------------------------------------------
  7434*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7435* EFFECTIVE    NUMBER
  7436*-----------------------------------------------------------------
  7437* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7438* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7439* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7440* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7441* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7442******************************************************************
  7443 01  CLAIM-MASTER.
  7444     12  CL-RECORD-ID                PIC XX.
  7445         88  VALID-CL-ID         VALUE 'CL'.
  7446
  7447     12  CL-CONTROL-PRIMARY.
  7448         16  CL-COMPANY-CD           PIC X.
  7449         16  CL-CARRIER              PIC X.
  7450         16  CL-CLAIM-NO             PIC X(7).
  7451         16  CL-CERT-NO.
  7452             20  CL-CERT-PRIME       PIC X(10).
  7453             20  CL-CERT-SFX         PIC X.
  7454
  7455     12  CL-CONTROL-BY-NAME.
  7456         16  CL-COMPANY-CD-A1        PIC X.
  7457         16  CL-INSURED-LAST-NAME    PIC X(15).
  7458         16  CL-INSURED-NAME.
  7459             20  CL-INSURED-1ST-NAME PIC X(12).
  7460             20  CL-INSURED-MID-INIT PIC X.
  7461
  7462     12  CL-CONTROL-BY-SSN.
  7463         16  CL-COMPANY-CD-A2        PIC X.
  7464         16  CL-SOC-SEC-NO.
  7465             20  CL-SSN-STATE        PIC XX.
  7466             20  CL-SSN-ACCOUNT      PIC X(6).
  7467             20  CL-SSN-LN3          PIC X(3).
  7468
  7469     12  CL-CONTROL-BY-CERT-NO.
  7470         16  CL-COMPANY-CD-A4        PIC X.
  7471         16  CL-CERT-NO-A4.
  7472             20  CL-CERT-A4-PRIME    PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 137
* VP6311.cbl
  7473             20  CL-CERT-A4-SFX      PIC X.
  7474
  7475     12  CL-CONTROL-BY-CCN.
  7476         16  CL-COMPANY-CD-A5        PIC X.
  7477         16  CL-CCN-A5.
  7478             20  CL-CCN.
  7479                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7480                 24  CL-CCN-PRIME-A5 PIC X(12).
  7481             20  CL-CCN-FILLER-A5    PIC X(4).
  7482
  7483     12  CL-INSURED-PROFILE-DATA.
  7484         16  CL-INSURED-BIRTH-DT     PIC XX.
  7485         16  CL-INSURED-SEX-CD       PIC X.
  7486             88  INSURED-IS-MALE        VALUE 'M'.
  7487             88  INSURED-IS-FEMALE      VALUE 'F'.
  7488             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7489         16  CL-INSURED-OCC-CD       PIC X(6).
  7490         16  FILLER                  PIC X(5).
  7491
  7492     12  CL-PROCESSING-INFO.
  7493         16  CL-PROCESSOR-ID         PIC X(4).
  7494         16  CL-CLAIM-STATUS         PIC X.
  7495             88  CLAIM-IS-OPEN          VALUE 'O'.
  7496             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7497         16  CL-CLAIM-TYPE           PIC X.
  7498*            88  AH-CLAIM               VALUE 'A'.
  7499*            88  LIFE-CLAIM             VALUE 'L'.
  7500*            88  PROPERTY-CLAIM         VALUE 'P'.
  7501*            88  IUI-CLAIM              VALUE 'I'.
  7502*            88  GAP-CLAIM              VALUE 'G'.
  7503*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7504         16  CL-CLAIM-PREM-TYPE      PIC X.
  7505             88  SINGLE-PREMIUM         VALUE '1'.
  7506             88  O-B-COVERAGE           VALUE '2'.
  7507             88  OPEN-END-COVERAGE      VALUE '3'.
  7508         16  CL-INCURRED-DT          PIC XX.
  7509         16  CL-REPORTED-DT          PIC XX.
  7510         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7511         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7512         16  CL-LAST-PMT-DT          PIC XX.
  7513         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7514         16  CL-PAID-THRU-DT         PIC XX.
  7515         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7516         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7517         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7518         16  CL-PMT-CALC-METHOD      PIC X.
  7519             88  CL-360-DAY-YR          VALUE '1'.
  7520             88  CL-365-DAY-YR          VALUE '2'.
  7521             88  CL-FULL-MONTHS         VALUE '3'.
  7522         16  CL-CAUSE-CD             PIC X(6).
  7523
  7524         16  CL-PRIME-CERT-NO.
  7525             20  CL-PRIME-CERT-PRIME PIC X(10).
  7526             20  CL-PRIME-CERT-SFX   PIC X.
  7527
  7528         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7529             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7530             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 138
* VP6311.cbl
  7531
  7532         16  CL-MICROFILM-NO         PIC X(10).
  7533         16  FILLER REDEFINES CL-MICROFILM-NO.
  7534             20  CL-BENEFIT-PERIOD   PIC 99.
  7535             20  FILLER              PIC X(8).
  7536         16  CL-PROG-FORM-TYPE       PIC X.
  7537         16  CL-LAST-ADD-ON-DT       PIC XX.
  7538
  7539         16  CL-LAST-REOPEN-DT       PIC XX.
  7540         16  CL-LAST-CLOSE-DT        PIC XX.
  7541         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7542             88  FINAL-PAID             VALUE '1'.
  7543             88  CLAIM-DENIED           VALUE '2'.
  7544             88  AUTO-CLOSE             VALUE '3'.
  7545             88  MANUAL-CLOSE           VALUE '4'.
  7546             88  BENEFITS-CHANGED       VALUE 'C'.
  7547             88  SETUP-ERRORS           VALUE 'E'.
  7548         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7549         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7550         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7551             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7552         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7553         16  FILLER                  PIC X.
  7554
  7555     12  CL-CERTIFICATE-DATA.
  7556         16  CL-CERT-ORIGIN          PIC X.
  7557             88  CERT-WAS-ONLINE        VALUE '1'.
  7558             88  CERT-WAS-CREATED       VALUE '2'.
  7559             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7560         16  CL-CERT-KEY-DATA.
  7561             20  CL-CERT-CARRIER     PIC X.
  7562             20  CL-CERT-GROUPING    PIC X(6).
  7563             20  CL-CERT-STATE       PIC XX.
  7564             20  CL-CERT-ACCOUNT.
  7565                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7566                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7567             20  CL-CERT-EFF-DT      PIC XX.
  7568
  7569     12  CL-STATUS-CONTROLS.
  7570         16  CL-PRIORITY-CD          PIC X.
  7571             88  CONFIDENTIAL-DATA      VALUE '8'.
  7572             88  HIGHEST-PRIORITY       VALUE '9'.
  7573         16  CL-SUPV-ATTN-CD         PIC X.
  7574             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7575             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7576         16  CL-PURGED-DT            PIC XX.
  7577         16  CL-RESTORED-DT          PIC XX.
  7578         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7579         16  CL-NEXT-RESEND-DT       PIC XX.
  7580         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7581         16  CL-CRITICAL-PERIOD      PIC 99.
  7582*        16  FILLER                  PIC XX.
  7583         16  CL-LAST-MAINT-DT        PIC XX.
  7584         16  CL-LAST-MAINT-USER      PIC X(4).
  7585         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7586         16  CL-LAST-MAINT-TYPE      PIC X.
  7587             88  CLAIM-SET-UP           VALUE ' '.
  7588             88  PAYMENT-MADE           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 139
* VP6311.cbl
  7589             88  LETTER-SENT            VALUE '2'.
  7590             88  MASTER-WAS-ALTERED     VALUE '3'.
  7591             88  MASTER-WAS-RESTORED    VALUE '4'.
  7592             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7593             88  FILE-CONVERTED         VALUE '6'.
  7594             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7595             88  ERROR-CORRECTION       VALUE 'E'.
  7596         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7597         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7598         16  CL-BENEFICIARY          PIC X(10).
  7599         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7600         16  CL-DENIAL-TYPE          PIC X.
  7601             88  CL-TYPE-DENIAL          VALUE '1'.
  7602             88  CL-TYPE-RESCISSION      VALUE '2'.
  7603             88  CL-TYPE-REFORMATION     VALUE '3'.
  7604             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7605             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7606         16  filler                  pic x(5).
  7607*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7608*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7609*        16  CL-RTW-DT               PIC XX.
  7610
  7611     12  CL-TRAILER-CONTROLS.
  7612         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7613             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7614             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7615             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7616         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7617         16  FILLER                  PIC XX.
  7618         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7619         16  CL-ADDRESS-TRAILER-CNT.
  7620             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7621                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7622             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7623                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7624             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7625                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7626             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7627                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7628             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7629                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7630             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7631                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7632             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7633                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7634
  7635     12  CL-CV-REFERENCE-NO.
  7636         16  CL-CV-REFNO-PRIME       PIC X(18).
  7637         16  CL-CV-REFNO-SFX         PIC XX.
  7638
  7639     12  CL-FILE-LOCATION            PIC X(4).
  7640
  7641     12  CL-PROCESS-ERRORS.
  7642         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7643             88  NO-FATAL-ERRORS        VALUE ZERO.
  7644         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7645             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7646
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 140
* VP6311.cbl
  7647     12  CL-PRODUCT-CD               PIC X.
  7648
  7649     12  CL-CURRENT-KEY-DATA.
  7650         16  CL-CURRENT-CARRIER      PIC X.
  7651         16  CL-CURRENT-GROUPING     PIC X(6).
  7652         16  CL-CURRENT-STATE        PIC XX.
  7653         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7654
  7655     12  CL-ASSOCIATES               PIC X.
  7656         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7657         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7658         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7659         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7660
  7661     12  CL-ACTIVITY-CODE            PIC 99.
  7662     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7663     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7664
  7665     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7666     12  CL-LAG-REPORT-CODE          PIC 9.
  7667     12  CL-LOAN-TYPE                PIC XX.
  7668     12  CL-LEGAL-STATE              PIC XX.
  7669
  7670     12  CL-YESNOSW                  PIC X.
  7671     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7672         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7673         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7674         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7675     12  cl-insured-type             pic x.
  7676         88  cl-claim-on-primary         value 'P'.
  7677         88  cl-claim-on-co-borrower     value 'C'.
  7678     12  cl-benefit-expiration-dt    PIC XX.
  7679*                                COPY ERCENDT.
  7680******************************************************************
  7681*                                                                *
  7682*                                                                *
  7683*                            ERCENDT.                            *
  7684*                            VMOD=2.001                          *
  7685*                                                                *
  7686*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7687*                                                                *
  7688*   FILE TYPE = VSAM,KSDS                                        *
  7689*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7690*                                                                *
  7691*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7692*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7693*                                                                *
  7694*   LOG = NO                                                     *
  7695*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7696******************************************************************
  7697*-----------------------------------------------------------------
  7698*                   C H A N G E   L O G
  7699*
  7700* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7701*-----------------------------------------------------------------
  7702*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7703* EFFECTIVE    NUMBER
  7704*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 141
* VP6311.cbl
  7705* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7706*                                WITH OPEN CLAIMS
  7707* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7708* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7709* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7710* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7711*-----------------------------------------------------------------
  7712 01  ENDORSEMENT-RECORD.
  7713     12  EN-RECORD-ID                PIC XX.
  7714         88  VALID-EN-ID                VALUE 'EN'.
  7715     12  EN-CONTROL-PRIMARY.
  7716         16  EN-COMPANY-CD           PIC X.
  7717         16  EN-CARRIER              PIC X.
  7718         16  EN-GROUPING             PIC X(6).
  7719         16  EN-STATE                PIC XX.
  7720         16  EN-ACCOUNT              PIC X(10).
  7721         16  EN-CERT-EFF-DT          PIC XX.
  7722         16  EN-CERT-NO.
  7723             20  EN-CERT-PRIME       PIC X(10).
  7724             20  EN-CERT-SFX         PIC X.
  7725         16  EN-REC-TYPE             PIC X.
  7726             88  EN-ISSUE               VALUE 'I'.
  7727             88  EN-CANCELLATION        VALUE 'C'.
  7728         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7729     12  EN-CONTROL-BY-ARCH-NO.
  7730         16  EN-COMPANY-CD-A1              PIC X.
  7731         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7732     12  EN-LAST-MAINT-DT            PIC XX.
  7733     12  EN-LAST-MAINT-BY            PIC X(4).
  7734     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7735     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7736     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7737         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7738         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7739         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7740         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7741         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7742         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7743         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7744         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7745         16  EN-LF-ORIG-BENCD        PIC XX.
  7746         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7747         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7748         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7749         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7750         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7751         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7752*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7753         16  EN-ORIG-CRED-BENE       PIC X(25).
  7754         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7755         16  FILLER                  PIC X.
  7756         16  EN-AH-ORIG-BENCD        PIC XX.
  7757         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7758         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7759         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7760         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7761*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7762*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 142
* VP6311.cbl
  7763         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7764         16  F                       PIC X(09).
  7765         16  EN-AH-ORIG-CP           PIC 99.
  7766         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7767         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7768         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7769         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7770         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7771         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7772         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7773         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7774         16  EN-LF-NEW-BENCD         PIC XX.
  7775         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7776         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7777         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7778         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7779         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7780         16  EN-LF-NEW-EXP-DT        PIC XX.
  7781         16  EN-NEW-CRED-BENE        PIC X(25).
  7782         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7783         16  FILLER                  PIC X.
  7784         16  EN-AH-NEW-BENCD         PIC XX.
  7785         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7786         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7787         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7788         16  EN-AH-NEW-EXP-DT        PIC XX.
  7789*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7790*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7791*        16  F                       PIC X(12).
  7792         16  EN-AH-NEW-CP            PIC 99.
  7793         16  EN-SIG-SW               PIC X.
  7794         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7795         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7796         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7797         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7798         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7799         16  FILLER                  PIC X(33).
  7800     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7801         16  EN-LF-ORIG-REF-DT       PIC XX.
  7802         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7803         16  EN-AH-ORIG-REF-DT       PIC XX.
  7804         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7805         16  EN-LF-NEW-REF-DT        PIC XX.
  7806         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7807         16  EN-AH-NEW-REF-DT        PIC XX.
  7808         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7809         16  EN-FLAG-CERT            PIC X.
  7810         16  EN-INS-LAST-NAME        PIC X(15).
  7811         16  EN-INS-FIRST-NAME       PIC X(10).
  7812         16  EN-INS-MIDDLE-INIT      PIC X.
  7813         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7814         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7815         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7816         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7817         16  FILLER                  PIC X(262).
  7818     12  EN-MONEY-SW             PIC X.
  7819     12  EN-HEALTH-APP           PIC X.
  7820     12  EN-VOUCHER-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 143
* VP6311.cbl
  7821     12  EN-PAYEE                PIC X(14).
  7822     12  EN-INPUT-DT             PIC XX.
  7823     12  EN-PROCESS-DT           PIC XX.
  7824     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7825     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7826     12  EN-REASON-CODES.
  7827         16  F OCCURS 12.
  7828             20  EN-REASON-CODE  PIC X(4).
  7829     12  EN-TEMPLATE-USED        PIC X(8).
  7830     12  EN-DOCU-TYPE            PIC X.
  7831         88  EN-VERI-DOCU          VALUE 'V'.
  7832         88  EN-GCE-DOCU           VALUE 'G'.
  7833         88  EN-CANC-DOCU          VALUE 'C'.
  7834     12  EN-COMMENTS1            PIC X(13).
  7835     12  EN-COMMENTS2            PIC X(70).
  7836     12  EN-COMM-CHGBK           PIC X.
  7837         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7838         88  EN-CHG-ACCT           VALUE 'Y'.
  7839     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7840     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7841     12  EN-BATCH-NUMBER         PIC X(6).
  7842     12  EN-ACCT-SUMM            PIC X.
  7843     12  EN-CSO-SUMM             PIC X.
  7844     12  en-check-type           pic x.
  7845     12  FILLER                  PIC X(12).
  7846******************************************************************
  7847*                                COPY ELCCRTT.
  7848******************************************************************
  7849*                                                                *
  7850*                            ELCCRTT.                            *
  7851*                                                                *
  7852*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7853*                                                                *
  7854*   FILE TYPE = VSAM,KSDS                                        *
  7855*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7856*                                                                *
  7857*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7858*                                                                *
  7859*   LOG = YES                                                    *
  7860*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7861******************************************************************
  7862*                   C H A N G E   L O G
  7863*
  7864* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7865*-----------------------------------------------------------------
  7866*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7867* EFFECTIVE    NUMBER
  7868*-----------------------------------------------------------------
  7869* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7870* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7871* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7872* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7873* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7874* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7875* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7876* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7877* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7878******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 144
* VP6311.cbl
  7879
  7880 01  CERTIFICATE-TRAILERS.
  7881     12  CS-RECORD-ID                      PIC XX.
  7882         88  VALID-CS-ID                      VALUE 'CS'.
  7883
  7884     12  CS-CONTROL-PRIMARY.
  7885         16  CS-COMPANY-CD                 PIC X.
  7886         16  CS-CARRIER                    PIC X.
  7887         16  CS-GROUPING                   PIC X(6).
  7888         16  CS-STATE                      PIC XX.
  7889         16  CS-ACCOUNT                    PIC X(10).
  7890         16  CS-CERT-EFF-DT                PIC XX.
  7891         16  CS-CERT-NO.
  7892             20  CS-CERT-PRIME             PIC X(10).
  7893             20  CS-CERT-SFX               PIC X.
  7894         16  CS-TRAILER-TYPE               PIC X.
  7895             88  COMM-TRLR           VALUE 'A'.
  7896             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7897             88  CERT-DATA-TRLR      VALUE 'C'.
  7898
  7899     12  CS-DATA-AREA                      PIC X(516).
  7900
  7901     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7902         16  CS-BANK-COMMISSION-AREA.
  7903             20  CS-BANK-COMMS       OCCURS 10.
  7904                 24  CS-AGT                PIC X(10).
  7905                 24  CS-COM-TYP            PIC X.
  7906                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7907                 24  CS-RECALC-LV-INDIC    PIC X.
  7908                 24  FILLER                PIC X(10).
  7909         16  FILLER                        PIC X(256).
  7910
  7911     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7912****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7913         16  CS-MB-CLAIM-DATA OCCURS 24.
  7914             20  CS-CLAIM-NO               PIC X(7).
  7915             20  CS-CLAIM-TYPE             PIC X.
  7916                 88  CS-AH-CLM               VALUE 'A'.
  7917                 88  CS-IU-CLM               VALUE 'I'.
  7918                 88  CS-GP-CLM               VALUE 'G'.
  7919                 88  CS-LF-CLM               VALUE 'L'.
  7920                 88  CS-PR-CLM               VALUE 'P'.
  7921                 88  CS-FL-CLM               VALUE 'F'.
  7922             20  CS-INSURED-TYPE           PIC X.
  7923                 88  CS-PRIM-INSURED          VALUE 'P'.
  7924                 88  CS-CO-BORROWER           VALUE 'C'.
  7925             20  CS-BENEFIT-PERIOD         PIC 99.
  7926             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7927             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7928             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7929         16  FILLER                        PIC X(12).
  7930     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7931         16  CS-VIN-NUMBER                 PIC X(17).
  7932         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7933         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7934         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7935         16  cs-agent-name.
  7936             20  cs-agent-fname            pic x(20).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 145
* VP6311.cbl
  7937             20  cs-agent-mi               pic x.
  7938             20  cs-agent-lname            pic x(25).
  7939         16  cs-license-no                 pic x(15).
  7940         16  cs-npn-number                 pic x(10).
  7941         16  cs-agent-edit-status          pic x.
  7942             88  cs-ae-refer-to-manager      value 'M'.
  7943             88  cs-ae-cover-sheet           value 'C'.
  7944             88  cs-ae-sig-form              value 'S'.
  7945             88  cs-ae-verified              value 'V'.
  7946             88  cs-unidentified-signature   value 'U'.
  7947             88  cs-cert-returned            value 'R'.
  7948             88  cs-accept-no-commission     value 'N'.
  7949         16  cs-year                       pic 9999.
  7950         16  cs-make                       pic x(20).
  7951         16  cs-model                      pic x(20).
  7952         16  cs-future                     pic x(20).
  7953         16  cs-vehicle-odometer           pic s9(7) comp-3.
  7954         16  FILLER                        PIC X(356). *> was 420
  7955*        16  FILLER                        PIC X(496).
  7956*                                COPY ERCCHEK.
  7957******************************************************************
  7958*                                                                *
  7959*                                                                *
  7960*                            ERCCHEK                             *
  7961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7962*                            VMOD=2.008                          *
  7963*                                                                *
  7964*   FILE DESCRIPTION = CHECK RECORDS                             *
  7965*                                                                *
  7966*   FILE TYPE = VSAM,KSDS                                        *
  7967*   RECORD SIZE = 600    RECFORM = FIXED                         *
  7968*                                                                *
  7969*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  7970*       ALTERNATE INDEX = NONE                                   *
  7971*                                                                *
  7972*   LOG = YES                                                    *
  7973*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7974******************************************************************
  7975*                   C H A N G E   L O G
  7976*
  7977* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7978*-----------------------------------------------------------------
  7979*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7980* EFFECTIVE    NUMBER
  7981*-----------------------------------------------------------------
  7982* 021414    2003053000001  PEMA  changes for auto chk request
  7983******************************************************************
  7984 01  CHECK-RECORDS.
  7985     12  CH-RECORD-ID                      PIC XX.
  7986         88  VALID-CH-ID                      VALUE 'CH'.
  7987
  7988     12  CH-CONTROL-PRIMARY.
  7989         16  CH-COMPANY-CD                 PIC X.
  7990         16  CH-CARRIER                    PIC X.
  7991         16  CH-GROUPING                   PIC X(6).
  7992         16  CH-STATE                      PIC XX.
  7993         16  CH-ACCOUNT                    PIC X(10).
  7994         16  CH-CERT-EFF-DT                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 146
* VP6311.cbl
  7995         16  CH-CERT-NO.
  7996             20  CH-CERT-PRIME             PIC X(10).
  7997             20  CH-CERT-SFX               PIC X.
  7998         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  7999
  8000     12  CH-RECORDED-DT                    PIC XX.
  8001     12  CH-RECORDED-BY                    PIC X(4).
  8002     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8003
  8004     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8005     12  CH-CHECK-NO                       PIC X(7).
  8006     12  CH-REASON-FOR-CHECK               PIC X(25).
  8007     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8008     12  FILLER                            PIC X.
  8009
  8010     12  CH-PAYEE-INFO.
  8011         16  CH-PAYEE-NAME-1               PIC X(30).
  8012         16  CH-PAYEE-NAME-2               PIC X(30).
  8013         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8014         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8015         16  CH-PAYEE-CITY-ST.
  8016             20  CH-PAYEE-CITY             PIC X(28).
  8017             20  CH-PAYEE-STATE            PIC XX.
  8018         16  CH-PAYEE-ZIP-CODE.
  8019             20  CH-PAYEE-ZIP.
  8020                 24  CH-ZIP-PRI-1ST        PIC X.
  8021                     88  CH-CANADIAN-POST-CODE
  8022                                           VALUES 'A' THRU 'Z'.
  8023                 24  FILLER                PIC X(4).
  8024             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8025         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8026             20  CH-CAN-POSTAL-1           PIC XXX.
  8027             20  CH-CAN-POSTAL-2           PIC XXX.
  8028             20  FILLER                    PIC XXX.
  8029
  8030     12  CH-CHECK-STUB-TEXT.
  8031         16  CH-STUB-LINE-1                PIC X(30).
  8032         16  CH-TEXT-LINE-1                PIC X(50).
  8033         16  CH-TEXT-LINE-2                PIC X(50).
  8034         16  CH-TEXT-LINE-3                PIC X(40).
  8035     12  CH-RETURN-TO                      PIC X(30).
  8036
  8037     12  CH-COMPENSATION-CONTROL.
  8038         16  CH-COMP-CARRIER               PIC X.
  8039         16  CH-COMP-GROUPING              PIC X(6).
  8040         16  CH-COMP-FIN-RESP              PIC X(10).
  8041         16  CH-COMP-ACCOUNT               PIC X(10).
  8042
  8043     12  CH-CREDIT-SELECT-DT               PIC XX.
  8044     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8045     12  CH-PAYEE-CODE                     PIC X(6).
  8046
  8047     12  CH-VOID-DATA.
  8048         20  CH-VOID-DT                    PIC XX.
  8049         20  CH-VOID-BY                    PIC X(4).
  8050         20  CH-VOID-REASON                PIC X(25).
  8051
  8052     12  CH-APPROVAL-DATA.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 147
* VP6311.cbl
  8053         20  CH-APPROVAL-DT                PIC XX.
  8054         20  CH-APPROVAL-STATUS            PIC X.
  8055             88  CH-IN-LIMBO                  VALUE ' '.
  8056             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8057             88  CH-APPROVED                  VALUE 'A'.
  8058             88  CH-DENIED                    VALUE 'D'.
  8059         20  CH-APPROVED-BY                PIC XXXX.
  8060     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8061             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8062     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8063
  8064     12  ch-released-dt                    pic xx.
  8065     12  ch-check-cashed-dt                pic xx.
  8066     12  FILLER                            PIC X.
  8067*    12  CH-CHECK-REFERENCE                PIC X(12).
  8068     12  CH-CHECK-ORIGIN-SW                PIC X.
  8069             88  CH-REFUND-CHECK              VALUE 'R'.
  8070             88  CH-MAINT-CHECK               VALUE 'M'.
  8071
  8072     12  CH-CANC-DT                        PIC XX.
  8073     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8074     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8075
  8076     12  CH-INSURED-NAME                   PIC X(28).
  8077
  8078     12  ch-released-by                    pic x(4).
  8079     12  ch-csr                            pic x(4).
  8080     12  ch-deduct-commission              pic x.
  8081         88  ch-deduct-comm                  value 'Y'.
  8082         88  ch-do-not-deduct-comm           value 'N'.
  8083
  8084     12  FILLER                            PIC X(11).
  8085*    12  CH-LETTER-TABLE.
  8086*        16  CH-LETTERS OCCURS 3 TIMES
  8087*                       INDEXED BY CH-LT-NDX
  8088*                                          PIC X(04).
  8089
  8090     12  FILLER                            PIC X(07).
  8091
  8092 01  var                         pic x(30).
  8093 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8094                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8095                          PENDING-MAILING-DATA MAILING-DATA
  8096                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8097                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8098                          CLAIM-MASTER ENDORSEMENT-RECORD
  8099                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8100                          VAR.
  8101 0000-DFHEXIT SECTION.
  8102     MOVE '9#                    $   ' TO DFHEIV0.
  8103     MOVE 'VP6311' TO DFHEIV1.
  8104     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8105
  8106     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8107     MOVE EIBTRMID               TO QID-TERM.
  8108     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8109     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8110     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 148
* VP6311.cbl
  8111     MOVE 2                      TO EMI-SWITCH2.
  8112
  8113     move spaces to ws-kix-myenv
  8114     set P to address of KIXSYS
  8115     CALL "getenv" using by value P returning var-ptr
  8116     if var-ptr = null then
  8117        display ' kixsys not set '
  8118     else
  8119        set address of var to var-ptr
  8120        move 0 to env-var-len
  8121        inspect var tallying env-var-len
  8122          for characters before X'00'
  8123        unstring var (1:env-var-len) delimited by '/'
  8124           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8125              WS-KIX-SYS
  8126        end-unstring
  8127     end-if
  8128     perform varying a1 from +1 by +1 until a1 > +10
  8129        if ws-kix-myenv (a1:1) = low-values or high-values
  8130           display ' found low or hi val '
  8131           move spaces to ws-kix-myenv (a1:1)
  8132        end-if
  8133     end-perform
  8134*    display ' env *' ws-kix-myenv '*'
  8135     IF EIBCALEN = 0
  8136         GO TO 8800-UNAUTHORIZED-ACCESS.
  8137
  8138     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8139     MOVE '5'                   TO DC-OPTION-CODE.
  8140     PERFORM 9700-DATE-LINK.
  8141     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8142     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8143
  8144     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8145     MOVE SPACE                  TO DC-OPTION-CODE.
  8146     PERFORM 9700-DATE-LINK.
  8147     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8148     MOVE LOW-VALUES             TO VP631BI.
  8149
  8150
  8151* EXEC CICS HANDLE CONDITION
  8152*        PGMIDERR  (9600-PGMID-ERROR)
  8153*        ERROR     (9990-ABEND)
  8154*        INVREQ    (9990-ABEND)
  8155*        QIDERR    (0010-MAIN-LOGIC)
  8156*    END-EXEC.
  8157*    MOVE '"$L.8N                ! " #00008146' TO DFHEIV0
  8158     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8160     MOVE X'2220233030303038313436' TO DFHEIV0(25:11)
  8161     CALL 'kxdfhei1' USING DFHEIV0
  8162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8163
  8164
  8165     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8166         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8167             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8168             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 149
* VP6311.cbl
  8169             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8170             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8171             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8172             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8173             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8174             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8175
  8176             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8177                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8178
  8179             ELSE
  8180                 NEXT SENTENCE
  8181
  8182         ELSE
  8183             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8184             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8185             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8186             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8187             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8188             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8189             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8190             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8191             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8192             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8193             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8194             GO TO 3900-RE-DISPLAY-RECORD
  8195     ELSE
  8196         GO TO 0020-MAIN-LOGIC.
  8197
  8198 0010-MAIN-LOGIC.
  8199     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8200                                    WS-FIRST-ENTRY-SW.
  8201
  8202     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8203
  8204     MOVE LOW-VALUES             TO EC-NEW-CERT
  8205                                    EC-NEW-STATE.
  8206
  8207     IF PI-DISPLAY-ORIGINAL-BATCH
  8208         NEXT SENTENCE
  8209     ELSE
  8210         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8211             GO TO 5000-BROWSE-BATCH-HEADERS.
  8212
  8213     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8214         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8215
  8216     IF PI-CSR-BROWSE
  8217        GO TO 4200-BROWSE-CSR-FORWARD.
  8218
  8219     IF PI-FILE-BROWSE
  8220         GO TO 4300-BROWSE-FILE-FORWARD.
  8221
  8222     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8223
  8224 0020-MAIN-LOGIC.
  8225     IF EIBAID = DFHCLEAR
  8226         GO TO 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 150
* VP6311.cbl
  8227
  8228     MOVE LOW-VALUES             TO EC-NEW-CERT
  8229                                    EC-NEW-STATE.
  8230
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 151
* VP6311.cbl
  8232
  8233******************************************************************
  8234*                                                                *
  8235*              R E C E I V E   M A P                             *
  8236*                                                                *
  8237******************************************************************
  8238
  8239 0200-RECEIVE.
  8240     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8241         MOVE ER-0008            TO EMI-ERROR
  8242         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8243         IF PI-MAP-NAME = VP631B
  8244             MOVE -1                 TO BMAINTL
  8245             GO TO 8200-SEND-DATAONLY
  8246         ELSE
  8247             IF PI-MAP-NAME = VP631C
  8248                 MOVE -1                 TO CMAINTL
  8249                 GO TO 8200-SEND-DATAONLY
  8250             ELSE
  8251                 IF PI-MAP-NAME = VP631D
  8252                     MOVE -1                 TO DPFENTRL
  8253                     GO TO 8200-SEND-DATAONLY.
  8254
  8255
  8256* EXEC CICS RECEIVE
  8257*        MAP      (PI-MAP-NAME)
  8258*        MAPSET   (MAPSET-VP6311S)
  8259*        INTO     (VP631BI)
  8260*    END-EXEC.
  8261     MOVE LENGTH OF
  8262      VP631BI
  8263       TO DFHEIV11
  8264*    MOVE '8"T I  L              ''   #00008243' TO DFHEIV0
  8265     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8266     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8267     MOVE X'2020233030303038323433' TO DFHEIV0(25:11)
  8268     CALL 'kxdfhei1' USING DFHEIV0,
  8269           PI-MAP-NAME,
  8270           VP631BI,
  8271           DFHEIV11,
  8272           MAPSET-VP6311S,
  8273           DFHEIV99,
  8274           DFHEIV99
  8275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8276
  8277
  8278******************************************************************
  8279*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8280******************************************************************
  8281
  8282     IF BTYPE-LEN (1) EQUAL +3
  8283        IF BTYPE (1) EQUAL ALL ' '
  8284            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8285
  8286     IF BTYPE-LEN (2) EQUAL +3
  8287        IF BTYPE (2) EQUAL ALL ' '
  8288            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8289
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 152
* VP6311.cbl
  8290     INSPECT VP631BI CONVERTING '_' TO ' '.
  8291
  8292     IF PI-MAP-NAME = VP631B
  8293         IF BPFENTRL GREATER THAN ZEROS
  8294             IF EIBAID NOT = DFHENTER
  8295                 MOVE ER-0004       TO EMI-ERROR
  8296                 MOVE -1            TO BPFENTRL
  8297                 MOVE AL-UNBOF      TO BPFENTRA
  8298                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8299                 GO TO 8200-SEND-DATAONLY
  8300             ELSE
  8301                 IF BPFENTRI NUMERIC AND
  8302                   (BPFENTRI GREATER 0 AND LESS 25)
  8303                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8304                 ELSE
  8305                     MOVE ER-0029  TO EMI-ERROR
  8306                     MOVE AL-UNBON TO BPFENTRA
  8307                     MOVE -1       TO BPFENTRL
  8308                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8309                     GO TO 8200-SEND-DATAONLY
  8310         ELSE
  8311             NEXT SENTENCE
  8312     ELSE
  8313         IF PI-MAP-NAME = VP631C
  8314            IF CPFENTRL GREATER THAN ZEROS
  8315                IF EIBAID NOT = DFHENTER
  8316                 MOVE ER-0004         TO EMI-ERROR
  8317                 MOVE -1              TO CPFENTRL
  8318                 MOVE AL-UNBOF        TO CPFENTRA
  8319                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8320                 GO TO 8200-SEND-DATAONLY
  8321             ELSE
  8322                 IF CPFENTRI NUMERIC AND
  8323                   (CPFENTRI GREATER 0 AND LESS 25)
  8324                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8325                 ELSE
  8326                     MOVE ER-0029      TO EMI-ERROR
  8327                     MOVE AL-UNBON     TO CPFENTRA
  8328                     MOVE -1           TO CPFENTRL
  8329                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8330                     GO TO 8200-SEND-DATAONLY
  8331         ELSE
  8332             NEXT SENTENCE
  8333     ELSE
  8334     IF PI-MAP-NAME = VP631D
  8335         IF DPFENTRL GREATER THAN ZEROS
  8336             IF EIBAID NOT = DFHENTER
  8337                 MOVE ER-0004         TO EMI-ERROR
  8338                 MOVE -1              TO DPFENTRL
  8339                 MOVE AL-UNBOF        TO DPFENTRA
  8340                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8341                 GO TO 8200-SEND-DATAONLY
  8342             ELSE
  8343                 IF DPFENTRI NUMERIC AND
  8344                   (DPFENTRI GREATER 0 AND LESS 25)
  8345                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8346                 ELSE
  8347                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 153
* VP6311.cbl
  8348                     MOVE AL-UNBON     TO DPFENTRA
  8349                     MOVE -1           TO DPFENTRL
  8350                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8351                     GO TO 8200-SEND-DATAONLY.
  8352
  8353     IF EIBAID = DFHPF23
  8354         GO TO 8810-PF23.
  8355
  8356     IF EIBAID = DFHPF24
  8357         GO TO 9200-RETURN-MAIN-MENU.
  8358
  8359     IF EIBAID = DFHPF12
  8360         GO TO 9500-PF12.
  8361
  8362     IF PI-MAP-NAME = VP631B
  8363        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8364
  8365     IF PI-MAP-NAME = VP631C
  8366        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8367
  8368     IF PI-MAP-NAME = VP631D
  8369        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8370
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 154
* VP6311.cbl
  8372
  8373******************************************************************
  8374*                                                                *
  8375*      ISSUE SCREEN PF KEY CHECKING                              *
  8376*                                                                *
  8377******************************************************************
  8378
  8379******************************************************************
  8380*                                                                *
  8381*      PF KEY FUNCTIONS:                                         *
  8382*                                                                *
  8383*      PF1  = BROWSE FORWARD                                     *
  8384*      PF2  = BROWSE BACKWARD                                    *
  8385*      PF3  = CERTIFICATE LOOKUP                                 *
  8386*      PF4  = DISPLAY BATCH HEADER                               *
  8387*      PF5  = ADD ISSUE  SCREEN                                  *
  8388*      PF6  = ADD CANCEL SCREEN                                  *
  8389*      PF7  = CERTIFICATE DISPLAY                                *
  8390*      PF8  = CERTIFICATE NOTES                                  *
  8391*      PF9  = EDIT CONTROL                                       *
  8392*      PF10 = DISPLAY LETTER SCREEN                              *
  8393*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8394*      PF12 = HELP SCREEN                                        *
  8395*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8396*      PF14 = ACCOUNT MASTER                                     *
  8397*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8398*      PF16 = DISPLAY LETTER REVIEW                              *
  8399*                                                                *
  8400******************************************************************
  8401
  8402 0300-CHECK-ISSUE-PF-KEYS.
  8403     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8404        MOVE ER-2337            TO EMI-ERROR
  8405        MOVE -1                  TO BMAINTL
  8406        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8407        GO TO 8200-SEND-DATAONLY.
  8408
  8409     IF EIBAID = DFHPF1
  8410        MOVE '0'                TO PI-EDIT-SW
  8411        IF PI-PRIMARY-BROWSE
  8412           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8413        ELSE
  8414           IF PI-PRIMARY-WITH-SELECT
  8415              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8416           ELSE
  8417              IF PI-FILE-BROWSE
  8418                 GO TO 4300-BROWSE-FILE-FORWARD
  8419              ELSE
  8420                 IF PI-CSR-BROWSE
  8421                    GO TO 4200-BROWSE-CSR-FORWARD
  8422                 ELSE
  8423                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8424
  8425     IF EIBAID = DFHPF2
  8426        MOVE '0'                TO PI-EDIT-SW
  8427        IF PI-PRIMARY-BROWSE
  8428           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8429        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 155
* VP6311.cbl
  8430           IF PI-PRIMARY-WITH-SELECT
  8431              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8432           ELSE
  8433              IF PI-FILE-BROWSE
  8434                 GO TO 4800-BROWSE-FILE-BACKWARD
  8435              ELSE
  8436                 IF PI-CSR-BROWSE
  8437                    GO TO 4900-BROWSE-CSR-BACKWARD
  8438                 ELSE
  8439                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8440
  8441     IF EIBAID = DFHPF3
  8442        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8443        MOVE XCTL-EL127         TO PGM-NAME
  8444        GO TO 9300-XCTL.
  8445
  8446     IF (EIBAID = DFHPF15 OR DFHPF6)
  8447        AND (CSR-EDIT-SESSION)
  8448*       AND (FATAL-OR-UNFORCED)
  8449        AND (FATAL-ERRORS)
  8450        MOVE ER-1819             TO EMI-ERROR
  8451        MOVE -1                  TO BMAINTL
  8452        MOVE AL-UANON            TO BMAINTA
  8453        PERFORM 9900-ERROR-FORMAT
  8454                                 THRU 9900-EXIT
  8455        GO TO 8200-SEND-DATAONLY
  8456     END-IF
  8457     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8458      OR (EIBAID = DFHPF10)
  8459        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8460        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8461        IF (RESP-NORMAL)
  8462           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8463              AM-CONTROL-PRIMARY (1:20))
  8464            IF AM-NAME NOT GREATER THAN SPACES OR
  8465               AM-ADDRS NOT GREATER THAN SPACES  OR
  8466               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8467               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8468               AM-ZIP NOT GREATER THAN SPACES
  8469               MOVE ER-3834             TO EMI-ERROR
  8470               MOVE -1                  TO BMAINTL
  8471               MOVE AL-UANON            TO BMAINTA
  8472               PERFORM 9900-ERROR-FORMAT
  8473                                 THRU 9900-EXIT
  8474               GO TO 8200-SEND-DATAONLY
  8475            END-IF
  8476        ELSE
  8477           MOVE ER-1609             TO EMI-ERROR
  8478           MOVE -1                  TO BMAINTL
  8479           MOVE AL-UANON            TO BMAINTA
  8480           PERFORM 9900-ERROR-FORMAT
  8481                                THRU 9900-EXIT
  8482           GO TO 8200-SEND-DATAONLY
  8483        END-IF
  8484
  8485        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8486        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8487        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 156
* VP6311.cbl
  8488            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8489               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8490               MA-CITY NOT GREATER THAN SPACES OR
  8491               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8492               MA-ZIP-CODE NOT GREATER THAN SPACES
  8493               MOVE ER-3835             TO EMI-ERROR
  8494               MOVE -1                  TO BMAINTL
  8495               MOVE AL-UANON            TO BMAINTA
  8496               PERFORM 9900-ERROR-FORMAT
  8497                                 THRU 9900-EXIT
  8498               GO TO 8200-SEND-DATAONLY
  8499            END-IF
  8500        ELSE
  8501           MOVE ER-3000             TO EMI-ERROR
  8502           MOVE -1                  TO BMAINTL
  8503           MOVE AL-UANON            TO BMAINTA
  8504           PERFORM 9900-ERROR-FORMAT
  8505                                THRU 9900-EXIT
  8506           GO TO 8200-SEND-DATAONLY
  8507        END-IF
  8508
  8509     END-IF
  8510     IF (EIBAID = DFHPF15)
  8511        AND (CSR-EDIT-SESSION)
  8512        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8513        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8514        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8515        MOVE PI-SV-STATE         TO PI-STATE
  8516        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8517        MOVE BCERTNOI            TO PI-CERT-PRIME
  8518        MOVE BSUFIXI             TO PI-CERT-SFX
  8519        MOVE BEFFDTI             TO DEEDIT-FIELD
  8520        PERFORM 8600-DEEDIT
  8521        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8522        MOVE '4'                 TO DC-OPTION-CODE
  8523        PERFORM 9700-DATE-LINK
  8524        IF DATE-CONVERSION-ERROR
  8525           MOVE ER-0348          TO EMI-ERROR
  8526           MOVE -1               TO BEFFDTL
  8527           MOVE AL-UABON         TO BEFFDTA
  8528           PERFORM 9900-ERROR-FORMAT
  8529                                 THRU 9900-EXIT
  8530           GO TO 8200-SEND-DATAONLY
  8531        ELSE
  8532           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8533           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8534           MOVE XCTL-EL6315      TO PGM-NAME
  8535           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8536           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8537           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8538           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8539           GO TO 9300-XCTL
  8540        END-IF
  8541     END-IF
  8542
  8543     IF EIBAID = DFHPF4
  8544        MOVE '0'                TO PI-EDIT-SW
  8545        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 157
* VP6311.cbl
  8546           NEXT SENTENCE
  8547        ELSE
  8548           GO TO 7200-DISPLAY-BATCHES.
  8549
  8550     IF EIBAID = DFHPF5
  8551        MOVE ER-0029                TO EMI-ERROR
  8552        MOVE -1                     TO BPFENTRL
  8553        MOVE AL-UNBON               TO BPFENTRA
  8554        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8555        GO TO 8200-SEND-DATAONLY.
  8556*        MOVE '0'                TO PI-EDIT-SW
  8557*        IF PI-DISPLAY-ORIGINAL-BATCH
  8558*           NEXT SENTENCE
  8559*        ELSE
  8560*           MOVE VP631B              TO PI-MAP-NAME
  8561*           MOVE LOW-VALUES          TO VP631BI
  8562*           MOVE 'A'                 TO BMAINTO
  8563*           MOVE AL-UANON            TO BMAINTA
  8564*           MOVE -1                  TO BMAINTL
  8565*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8566*           GO TO 8100-SEND-INITIAL-MAP.
  8567
  8568     IF EIBAID = DFHPF6
  8569        IF NOT CSR-EDIT-SESSION
  8570           MOVE ER-0029                TO EMI-ERROR
  8571           MOVE -1                     TO BPFENTRL
  8572           MOVE AL-UNBON               TO BPFENTRA
  8573           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8574           GO TO 8200-SEND-DATAONLY
  8575*           MOVE '0'              TO PI-EDIT-SW
  8576*           IF PI-DISPLAY-ORIGINAL-BATCH
  8577*              NEXT SENTENCE
  8578*           ELSE
  8579*              MOVE VP631C        TO PI-MAP-NAME
  8580*              MOVE LOW-VALUES    TO VP631CI
  8581*              MOVE 'A'           TO CMAINTO
  8582*              MOVE AL-UANON      TO CMAINTA
  8583*              MOVE -1            TO CMAINTL
  8584*              MOVE '6'           TO PI-MAINT-FUNCTION
  8585*              GO TO 8100-SEND-INITIAL-MAP
  8586*           END-IF
  8587        ELSE
  8588           PERFORM 5100-PROCESS-POL-RESC
  8589                                 THRU 5100-EXIT
  8590           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8591           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8592                                    PI-PREV-SEQ-NO
  8593           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8594*                                    WS-CANCEL-LETTER-SW
  8595                                    PI-ALL-ISSUES-SW
  8596                                    PI-ALL-CANCELS-SW
  8597           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8598        END-IF
  8599     END-IF
  8600     IF EIBAID = DFHPF7
  8601        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8602        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8603        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 158
* VP6311.cbl
  8604        MOVE PI-SV-STATE            TO PI-STATE
  8605        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8606        MOVE BCERTNOI               TO PI-CERT-PRIME
  8607        MOVE BSUFIXI                TO PI-CERT-SFX
  8608        MOVE BEFFDTI                TO DEEDIT-FIELD
  8609        PERFORM 8600-DEEDIT
  8610        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8611        MOVE '4'                    TO DC-OPTION-CODE
  8612        PERFORM 9700-DATE-LINK
  8613        IF DATE-CONVERSION-ERROR
  8614           MOVE ER-0348            TO EMI-ERROR
  8615           MOVE -1                  TO BEFFDTL
  8616           MOVE AL-UABON            TO BEFFDTA
  8617           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8618           GO TO 8200-SEND-DATAONLY
  8619        ELSE
  8620           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8621           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8622           MOVE XCTL-EL1273        TO PGM-NAME
  8623           GO TO 9300-XCTL.
  8624
  8625     IF EIBAID = DFHPF8
  8626        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8627        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8628        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8629        MOVE PI-SV-STATE            TO PI-STATE
  8630        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8631        MOVE BCERTNOI               TO PI-CERT-PRIME
  8632        MOVE BSUFIXI                TO PI-CERT-SFX
  8633        MOVE BEFFDTI                TO DEEDIT-FIELD
  8634        PERFORM 8600-DEEDIT
  8635        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8636        MOVE '4'                    TO DC-OPTION-CODE
  8637        PERFORM 9700-DATE-LINK
  8638        IF DATE-CONVERSION-ERROR
  8639           MOVE ER-0348            TO EMI-ERROR
  8640           MOVE -1                  TO BEFFDTL
  8641           MOVE AL-UABON            TO BEFFDTA
  8642           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8643           GO TO 8200-SEND-DATAONLY
  8644        ELSE
  8645           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8646           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8647           IF PI-COMPANY-ID = 'DMD'
  8648               MOVE XCTL-EL401DMD      TO PGM-NAME
  8649             ELSE
  8650               MOVE XCTL-EL1279        TO PGM-NAME
  8651           END-IF
  8652           GO TO 9300-XCTL.
  8653
  8654     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8655        MOVE XCTL-EL6312         TO PGM-NAME
  8656
  8657* EXEC CICS XCTL
  8658*           PROGRAM   (PGM-NAME)
  8659*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8660*           LENGTH    (WS-COMM-LENGTH)
  8661*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 159
* VP6311.cbl
  8662*    MOVE '.$C                   %   #00008627' TO DFHEIV0
  8663     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8664     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8665     MOVE X'2020233030303038363237' TO DFHEIV0(25:11)
  8666     CALL 'kxdfhei1' USING DFHEIV0,
  8667           PGM-NAME,
  8668           PROGRAM-INTERFACE-BLOCK,
  8669           WS-COMM-LENGTH,
  8670           DFHEIV99
  8671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8672     ELSE
  8673        MOVE '0'                 TO  PI-EDIT-SW.
  8674
  8675     IF  EIBAID = DFHPF10
  8676         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8677         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8678         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8679                                    PI-1042-WA
  8680         MOVE 4                  TO PI-689-DATA-SOURCE
  8681         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8682         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8683         MOVE PI-SV-STATE        TO PI-689-STATE
  8684         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8685         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8686         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8687         MOVE PI-PB-ALT-CHG-SEQ-NO
  8688                                 TO PI-689-ALT-SEQ-NO
  8689         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8690         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8691         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8692         MOVE +0                 TO PI-689-CONTROL
  8693         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8694                                    PI-689-EXP-DATE
  8695                                    PI-689-RESP-PERSON
  8696                                    PI-689-TYPE
  8697                                    PI-689-FOLLOW-UP-EDIT
  8698                                    PI-689-RESEND1-EDIT
  8699                                    PI-689-SEQ-EDIT
  8700                                    PI-689-BCSEQ-EDIT
  8701                                    PI-689-LBL-OVERRIDE
  8702         MOVE W-LETTER-COMMUNICATION-AREAS
  8703                                 TO PI-PROGRAM-WORK-AREA
  8704         MOVE XCTL-EL689         TO PGM-NAME
  8705         GO TO 9300-XCTL.
  8706
  8707     IF  EIBAID = DFHPF16
  8708         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8709         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8710         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8711                                    PI-1042-WA
  8712         MOVE 4                  TO PI-689-DATA-SOURCE
  8713         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8714         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8715         MOVE PI-SV-STATE        TO PI-689-STATE
  8716         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8717         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8718         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8719         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 160
* VP6311.cbl
  8720                                 TO PI-689-ALT-SEQ-NO
  8721         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8722         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8723         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8724         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8725         MOVE W-LETTER-COMMUNICATION-AREAS
  8726                                 TO PI-PROGRAM-WORK-AREA
  8727         MOVE XCTL-EL690         TO PGM-NAME
  8728         GO TO 9300-XCTL.
  8729
  8730     IF EIBAID = DFHPF13
  8731         MOVE XCTL-EL6313        TO PGM-NAME
  8732         GO TO 9300-XCTL.
  8733
  8734     IF EIBAID = DFHPF17
  8735        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8736        IF (PB-I-LOAN-APR numeric)
  8737           and (pb-i-loan-apr < 99.9999)
  8738           AND (PB-I-BENEFICIARY-NAME NOT
  8739              = SPACES AND LOW-VALUES)
  8740
  8741           MOVE LINK-ELVADS          TO PGM-NAME
  8742
  8743* EXEC CICS LINK
  8744*              PROGRAM    (PGM-NAME)
  8745*              COMMAREA   (WS-PASS-AREA)
  8746*              LENGTH     (WS-PASS-AREA-LENGTH)
  8747*          END-EXEC
  8748*    MOVE '."C                   (   #00008702' TO DFHEIV0
  8749     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8750     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8751     MOVE X'2020233030303038373032' TO DFHEIV0(25:11)
  8752     CALL 'kxdfhei1' USING DFHEIV0,
  8753           PGM-NAME,
  8754           WS-PASS-AREA,
  8755           WS-PASS-AREA-LENGTH,
  8756           DFHEIV99,
  8757           DFHEIV99,
  8758           DFHEIV99,
  8759           DFHEIV99
  8760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8761
  8762           MOVE 0000             TO EMI-ERROR
  8763           MOVE -1               TO BMAINTL
  8764           PERFORM 9900-ERROR-FORMAT
  8765                                 THRU 9900-EXIT
  8766           GO TO 8200-SEND-DATAONLY
  8767        ELSE
  8768           MOVE ER-0877            TO EMI-ERROR
  8769           MOVE -1                  TO BEFFDTL
  8770           MOVE AL-UABON            TO BEFFDTA
  8771           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8772           GO TO 8200-SEND-DATAONLY
  8773        END-IF
  8774     END-IF
  8775     IF EIBAID = DFHPF14
  8776        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8777        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 161
* VP6311.cbl
  8778        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8779        MOVE PI-SV-STATE            TO PI-CR-STATE
  8780        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8781        MOVE SPACE                  TO PI-EDIT-SW
  8782        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8783        MOVE XCTL-EL650             TO PGM-NAME
  8784        GO TO 9300-XCTL.
  8785
  8786     IF EIBAID = DFHPF15
  8787        IF PI-COMPANY-ID  =  'HER'
  8788            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8789            MOVE XCTL-EL680         TO PGM-NAME
  8790            GO TO 9300-XCTL.
  8791
  8792     IF EIBAID = DFHENTER OR DFHPF11
  8793        GO TO 1000-ISSUE-MAINLINE.
  8794
  8795     MOVE ER-0029                TO EMI-ERROR
  8796     MOVE -1                     TO BPFENTRL
  8797     MOVE AL-UNBON               TO BPFENTRA
  8798     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8799     GO TO 8200-SEND-DATAONLY.
  8800
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 162
* VP6311.cbl
  8802
  8803******************************************************************
  8804*                                                                *
  8805*      CANCEL SCREEN PF KEY CHECKING                             *
  8806*                                                                *
  8807******************************************************************
  8808
  8809******************************************************************
  8810*                                                                *
  8811*      PF KEY FUNCTIONS:                                         *
  8812*                                                                *
  8813*      PF1  = BROWSE FORWARD                                     *
  8814*      PF2  = BROWSE BACKWARD                                    *
  8815*      PF3  = CERTIFICATE LOOKUP                                 *
  8816*      PF4  = DISPLAY BATCH HEADER                               *
  8817*      PF5  = ADD ISSUE SCREEN                                   *
  8818*      PF6  = ADD CANCEL SCREEN                                  *
  8819*      PF7  = CERTIFICATE DISPLAY                                *
  8820*      PF8  = CERTIFICATE NOTES                                  *
  8821*      PF9  = EDIT CONTROL                                       *
  8822*      PF10 = DISPLAY LETTER SCREEN                              *
  8823*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8824*      PF12 = DISPLAY HELP SCREEN                                *
  8825*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8826*      PF14 = ACCOUNT MASTER                                     *
  8827*      PF16 = LETTER REVIEW                                      *
  8828*                                                                *
  8829******************************************************************
  8830
  8831 0400-CHECK-CANCEL-PF-KEYS.
  8832     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8833        MOVE ER-2337             TO EMI-ERROR
  8834        MOVE -1                  TO CMAINTL
  8835        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8836        GO TO 8200-SEND-DATAONLY.
  8837
  8838     IF EIBAID = DFHPF1
  8839        MOVE '0'                TO PI-EDIT-SW
  8840        IF PI-PRIMARY-BROWSE
  8841           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8842        ELSE
  8843           IF PI-PRIMARY-WITH-SELECT
  8844              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8845           ELSE
  8846              IF PI-FILE-BROWSE
  8847                 GO TO 4300-BROWSE-FILE-FORWARD
  8848              ELSE
  8849                 IF PI-CSR-BROWSE
  8850                    GO TO 4200-BROWSE-CSR-FORWARD
  8851                 ELSE
  8852                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8853
  8854     IF EIBAID = DFHPF2
  8855        MOVE '0'                TO PI-EDIT-SW
  8856        IF PI-PRIMARY-BROWSE
  8857           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8858        ELSE
  8859           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 163
* VP6311.cbl
  8860              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8861           ELSE
  8862              IF PI-FILE-BROWSE
  8863                 GO TO 4800-BROWSE-FILE-BACKWARD
  8864              ELSE
  8865                 IF PI-CSR-BROWSE
  8866                    GO TO 4900-BROWSE-CSR-BACKWARD
  8867                 ELSE
  8868                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8869
  8870     IF EIBAID = DFHPF3
  8871        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8872        MOVE XCTL-EL127         TO PGM-NAME
  8873        GO TO 9300-XCTL.
  8874
  8875     IF (EIBAID = DFHPF15 OR DFHPF17)
  8876        AND (CSR-EDIT-SESSION)
  8877*       AND (FATAL-OR-UNFORCED)
  8878        AND (FATAL-ERRORS)
  8879        MOVE ER-1819             TO EMI-ERROR
  8880        MOVE -1                  TO CMAINTL
  8881        MOVE AL-UANON            TO CMAINTA
  8882        PERFORM 9900-ERROR-FORMAT
  8883                                 THRU 9900-EXIT
  8884        GO TO 8200-SEND-DATAONLY
  8885     END-IF
  8886     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8887       AND (CSR-EDIT-SESSION)
  8888        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8889        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8890        IF (RESP-NORMAL)
  8891           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8892              AM-CONTROL-PRIMARY (1:20))
  8893            IF AM-NAME NOT GREATER THAN SPACES OR
  8894               AM-ADDRS NOT GREATER THAN SPACES  OR
  8895               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8896               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8897               AM-ZIP NOT GREATER THAN SPACES
  8898               MOVE ER-3834             TO EMI-ERROR
  8899               MOVE -1                  TO BMAINTL
  8900               MOVE AL-UANON            TO BMAINTA
  8901               PERFORM 9900-ERROR-FORMAT
  8902                                 THRU 9900-EXIT
  8903               GO TO 8200-SEND-DATAONLY
  8904            END-IF
  8905        ELSE
  8906           MOVE ER-1609             TO EMI-ERROR
  8907           MOVE -1                  TO BMAINTL
  8908           MOVE AL-UANON            TO BMAINTA
  8909           PERFORM 9900-ERROR-FORMAT
  8910                                THRU 9900-EXIT
  8911           GO TO 8200-SEND-DATAONLY
  8912        END-IF
  8913
  8914        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8915        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8916        IF (ERMAIL-FOUND)
  8917            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 164
* VP6311.cbl
  8918               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8919               MA-CITY NOT GREATER THAN SPACES OR
  8920               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8921               MA-ZIP-CODE NOT GREATER THAN SPACES
  8922               MOVE ER-3835             TO EMI-ERROR
  8923               MOVE -1                  TO BMAINTL
  8924               MOVE AL-UANON            TO BMAINTA
  8925               PERFORM 9900-ERROR-FORMAT
  8926                                 THRU 9900-EXIT
  8927               GO TO 8200-SEND-DATAONLY
  8928            END-IF
  8929        ELSE
  8930           MOVE ER-3000             TO EMI-ERROR
  8931           MOVE -1                  TO BMAINTL
  8932           MOVE AL-UANON            TO BMAINTA
  8933           PERFORM 9900-ERROR-FORMAT
  8934                                THRU 9900-EXIT
  8935           GO TO 8200-SEND-DATAONLY
  8936        END-IF
  8937
  8938     END-IF
  8939     IF (EIBAID = DFHPF15 OR DFHPF17)
  8940        AND (CSR-EDIT-SESSION)
  8941        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8942        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8943        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8944        MOVE PI-SV-STATE         TO PI-STATE
  8945        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8946        MOVE CCERTNOI            TO PI-CERT-PRIME
  8947        MOVE CSUFIXI             TO PI-CERT-SFX
  8948        MOVE CEFFDTI             TO DEEDIT-FIELD
  8949        PERFORM 8600-DEEDIT
  8950        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8951        MOVE '4'                 TO DC-OPTION-CODE
  8952        PERFORM 9700-DATE-LINK
  8953        IF DATE-CONVERSION-ERROR
  8954           MOVE ER-0348          TO EMI-ERROR
  8955           MOVE -1               TO CEFFDTL
  8956           MOVE AL-UABON         TO CEFFDTA
  8957           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8958           GO TO 8200-SEND-DATAONLY
  8959        ELSE
  8960           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8961           PERFORM 6000-CREATE-TEMP-STORAGE
  8962                                 THRU 6000-EXIT
  8963           IF EIBAID = DFHPF17
  8964               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8965                                  THRU 6400-EXIT
  8966               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8967                                 '2' AND '3' AND '4'
  8968                  MOVE ER-3831     TO  EMI-ERROR
  8969                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8970                  GO TO 8200-SEND-DATAONLY
  8971               END-IF
  8972               MOVE 'Y'          TO PI-CLM-RESC-IND
  8973           ELSE
  8974               MOVE 'N'          TO PI-CLM-RESC-IND
  8975           END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 165
* VP6311.cbl
  8976           MOVE XCTL-EL6316      TO PGM-NAME
  8977           MOVE '2'              TO PI-ISS-CAN-SW
  8978           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8979           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8980           GO TO 9300-XCTL
  8981        END-IF
  8982     END-IF
  8983
  8984     IF EIBAID = DFHPF4
  8985        MOVE '0'                TO PI-EDIT-SW
  8986        IF PI-DISPLAY-ORIGINAL-BATCH
  8987           NEXT SENTENCE
  8988        ELSE
  8989           GO TO 7200-DISPLAY-BATCHES.
  8990
  8991     IF EIBAID = DFHPF5
  8992        MOVE ER-0029                TO EMI-ERROR
  8993        MOVE -1                     TO BPFENTRL
  8994        MOVE AL-UNBON               TO BPFENTRA
  8995        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8996        GO TO 8200-SEND-DATAONLY.
  8997*        MOVE '0'                TO PI-EDIT-SW
  8998*        IF PI-DISPLAY-ORIGINAL-BATCH
  8999*           NEXT SENTENCE
  9000*        ELSE
  9001*           MOVE VP631B              TO PI-MAP-NAME
  9002*           MOVE LOW-VALUES          TO VP631BI
  9003*           MOVE 'A'                 TO BMAINTO
  9004*           MOVE AL-UANON            TO BMAINTA
  9005*           MOVE -1                  TO BMAINTL
  9006*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9007*           GO TO 8100-SEND-INITIAL-MAP.
  9008
  9009     IF EIBAID = DFHPF6
  9010        MOVE ER-0029                TO EMI-ERROR
  9011        MOVE -1                     TO BPFENTRL
  9012        MOVE AL-UNBON               TO BPFENTRA
  9013        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9014        GO TO 8200-SEND-DATAONLY.
  9015*        MOVE '0'                TO PI-EDIT-SW
  9016*        IF PI-DISPLAY-ORIGINAL-BATCH
  9017*           NEXT SENTENCE
  9018*        ELSE
  9019*           MOVE VP631C              TO PI-MAP-NAME
  9020*           MOVE LOW-VALUES          TO VP631CI
  9021*           MOVE 'A'                 TO CMAINTO
  9022*           MOVE AL-UANON            TO CMAINTA
  9023*           MOVE -1                  TO CMAINTL
  9024*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9025*           GO TO 8100-SEND-INITIAL-MAP.
  9026
  9027     IF EIBAID = DFHPF7
  9028        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9029        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9030        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9031        MOVE PI-SV-STATE            TO PI-STATE
  9032        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9033        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 166
* VP6311.cbl
  9034        MOVE CSUFIXI                TO PI-CERT-SFX
  9035        MOVE CEFFDTI                TO DEEDIT-FIELD
  9036        PERFORM 8600-DEEDIT
  9037        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9038        MOVE '4'                    TO DC-OPTION-CODE
  9039        PERFORM 9700-DATE-LINK
  9040        IF DATE-CONVERSION-ERROR
  9041           MOVE ER-0348            TO EMI-ERROR
  9042           MOVE -1                  TO BEFFDTL
  9043           MOVE AL-UABON            TO BEFFDTA
  9044           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9045           GO TO 8200-SEND-DATAONLY
  9046        ELSE
  9047           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9048           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9049           MOVE XCTL-EL1273        TO PGM-NAME
  9050           GO TO 9300-XCTL.
  9051
  9052     IF EIBAID = DFHPF8
  9053        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9054        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9055        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9056        MOVE PI-SV-STATE            TO PI-STATE
  9057        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9058        MOVE CCERTNOI               TO PI-CERT-PRIME
  9059        MOVE CSUFIXI                TO PI-CERT-SFX
  9060        MOVE CEFFDTI                TO DEEDIT-FIELD
  9061        PERFORM 8600-DEEDIT
  9062        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9063        MOVE '4'                    TO DC-OPTION-CODE
  9064        PERFORM 9700-DATE-LINK
  9065        IF DATE-CONVERSION-ERROR
  9066           MOVE ER-0348             TO EMI-ERROR
  9067           MOVE -1                  TO BEFFDTL
  9068           MOVE AL-UABON            TO BEFFDTA
  9069           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9070           GO TO 8200-SEND-DATAONLY
  9071        ELSE
  9072           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9073           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9074           IF PI-COMPANY-ID = 'DMD'
  9075               MOVE XCTL-EL401DMD      TO PGM-NAME
  9076             ELSE
  9077               MOVE XCTL-EL1279        TO PGM-NAME
  9078           END-IF
  9079           GO TO 9300-XCTL.
  9080
  9081     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9082        MOVE XCTL-EL6312     TO PGM-NAME
  9083
  9084* EXEC CICS XCTL
  9085*           PROGRAM  (PGM-NAME)
  9086*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9087*           LENGTH   (WS-COMM-LENGTH)
  9088*       END-EXEC
  9089*    MOVE '.$C                   %   #00009029' TO DFHEIV0
  9090     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9091     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 167
* VP6311.cbl
  9092     MOVE X'2020233030303039303239' TO DFHEIV0(25:11)
  9093     CALL 'kxdfhei1' USING DFHEIV0,
  9094           PGM-NAME,
  9095           PROGRAM-INTERFACE-BLOCK,
  9096           WS-COMM-LENGTH,
  9097           DFHEIV99
  9098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9099     ELSE
  9100        MOVE '0'                 TO  PI-EDIT-SW.
  9101
  9102     IF EIBAID = DFHPF10
  9103         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9104         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9105         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9106         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9107                                    PI-1042-WA
  9108         MOVE 4                  TO PI-689-DATA-SOURCE
  9109         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9110         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9111         MOVE PI-SV-STATE        TO PI-689-STATE
  9112         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9113         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9114         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9115         MOVE PI-PB-ALT-CHG-SEQ-NO
  9116                                 TO PI-689-ALT-SEQ-NO
  9117         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9118         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9119         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9120         MOVE +0                 TO PI-689-CONTROL
  9121         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9122                                    PI-689-EXP-DATE
  9123                                    PI-689-RESP-PERSON
  9124                                    PI-689-TYPE
  9125                                    PI-689-FOLLOW-UP-EDIT
  9126                                    PI-689-RESEND1-EDIT
  9127                                    PI-689-SEQ-EDIT
  9128                                    PI-689-BCSEQ-EDIT
  9129                                    PI-689-LBL-OVERRIDE
  9130         MOVE W-LETTER-COMMUNICATION-AREAS
  9131                                 TO PI-PROGRAM-WORK-AREA
  9132         MOVE XCTL-EL689         TO PGM-NAME
  9133         GO TO 9300-XCTL.
  9134
  9135     IF  EIBAID = DFHPF16
  9136         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9137         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9138         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9139                                    PI-1042-WA
  9140         MOVE 4                  TO PI-689-DATA-SOURCE
  9141         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9142         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9143         MOVE PI-SV-STATE        TO PI-689-STATE
  9144         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9145         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9146         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9147         MOVE PI-PB-ALT-CHG-SEQ-NO
  9148                                 TO PI-689-ALT-SEQ-NO
  9149         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 168
* VP6311.cbl
  9150         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9151         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9152         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9153         MOVE W-LETTER-COMMUNICATION-AREAS
  9154                                 TO PI-PROGRAM-WORK-AREA
  9155         MOVE XCTL-EL690         TO PGM-NAME
  9156         GO TO 9300-XCTL.
  9157     IF (EIBAID = DFHPF13)
  9158        if (not fatal-errors)
  9159           and (not unforced-errors)
  9160           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9161           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9162           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9163           MOVE PI-SV-STATE      TO PI-STATE
  9164           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9165           MOVE CCERTNOI         TO PI-CERT-PRIME
  9166           MOVE CSUFIXI          TO PI-CERT-SFX
  9167           MOVE CEFFDTI          TO DEEDIT-FIELD
  9168           PERFORM 8600-DEEDIT
  9169           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9170           MOVE '4'              TO DC-OPTION-CODE
  9171           PERFORM 9700-DATE-LINK
  9172           IF DATE-CONVERSION-ERROR
  9173              MOVE ER-0348       TO EMI-ERROR
  9174              MOVE -1            TO CEFFDTL
  9175              MOVE AL-UABON      TO CEFFDTA
  9176              PERFORM 9900-ERROR-FORMAT
  9177                                 THRU 9900-EXIT
  9178              GO TO 8200-SEND-DATAONLY
  9179           ELSE
  9180              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9181              MOVE AL-UANON      TO CEFFDTA
  9182              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9183              PERFORM 6000-CREATE-TEMP-STORAGE
  9184                                 THRU 6000-EXIT
  9185              MOVE XCTL-EL677    TO PGM-NAME
  9186              GO TO 9300-XCTL
  9187           end-if
  9188        else
  9189           MOVE ER-3444          TO EMI-ERROR
  9190           MOVE -1               TO CPFENTRL
  9191           MOVE AL-UNBON         TO CPFENTRA
  9192           PERFORM 9900-ERROR-FORMAT
  9193                                 THRU 9900-EXIT
  9194           GO TO 8200-SEND-DATAONLY
  9195        end-if
  9196     end-if
  9197
  9198     IF EIBAID = DFHPF14
  9199        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9200        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9201        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9202        MOVE PI-SV-STATE            TO PI-CR-STATE
  9203        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9204        MOVE SPACE                  TO PI-EDIT-SW
  9205        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9206        MOVE XCTL-EL650             TO PGM-NAME
  9207        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 169
* VP6311.cbl
  9208
  9209     IF EIBAID = DFHENTER OR DFHPF11
  9210        GO TO 2000-CANCEL-MAINLINE.
  9211
  9212     MOVE ER-0029                TO EMI-ERROR.
  9213     MOVE -1                     TO CPFENTRL.
  9214     MOVE AL-UNBON               TO CPFENTRA.
  9215     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9216     GO TO 8200-SEND-DATAONLY.
  9217
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 170
* VP6311.cbl
  9219
  9220******************************************************************
  9221*                                                                *
  9222*      BATCH SCREEN PF KEY CHECKING                              *
  9223*                                                                *
  9224******************************************************************
  9225
  9226******************************************************************
  9227*                                                                *
  9228*      PF KEY FUNCTIONS:                                         *
  9229*                                                                *
  9230*      PF1 = BROWSE FORWARD                                      *
  9231*      PF2 = BROWSE BACKWARD                                     *
  9232*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9233*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9234*                                                                *
  9235*                                                                *
  9236******************************************************************
  9237
  9238 0500-CHECK-BATCH-PF-KEYS.
  9239     IF EIBAID = DFHPF1
  9240        MOVE '0'                TO PI-EDIT-SW
  9241        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9242           GO TO 5000-BROWSE-BATCH-HEADERS
  9243        ELSE
  9244           IF PI-GOOD-BROWSE
  9245              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9246                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9247              ELSE
  9248                 IF PI-FILE-BROWSE
  9249                    GO TO 4300-BROWSE-FILE-FORWARD
  9250                 ELSE
  9251                    IF PI-CSR-BROWSE
  9252                       GO TO 4200-BROWSE-CSR-FORWARD
  9253                    ELSE
  9254                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9255           ELSE
  9256              GO TO 0800-BROWSE-ERROR.
  9257
  9258     IF EIBAID = DFHPF2
  9259        MOVE '0'                TO PI-EDIT-SW
  9260        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9261           GO TO 5500-BROWSE-BATCH-BACKWARD
  9262        ELSE
  9263           IF PI-GOOD-BROWSE
  9264              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9265                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9266              ELSE
  9267                 IF PI-FILE-BROWSE
  9268                    GO TO 4800-BROWSE-FILE-BACKWARD
  9269                 ELSE
  9270                    IF PI-CSR-BROWSE
  9271                       GO TO 4900-BROWSE-CSR-BACKWARD
  9272                    ELSE
  9273                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9274           ELSE
  9275              GO TO 0800-BROWSE-ERROR.
  9276
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 171
* VP6311.cbl
  9277     IF EIBAID = DFHPF3
  9278        GO TO 3000-BATCH-MAINLINE.
  9279
  9280     IF  EIBAID = DFHPF4
  9281        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9282        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9283        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9284        MOVE PI-SV-STATE            TO PI-CR-STATE
  9285        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9286                                       PI-CR-FIN-RESP
  9287        MOVE 'A'                    TO PI-CR-TYPE
  9288        MOVE SPACE                  TO PI-EDIT-SW
  9289        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9290        MOVE XCTL-EL640             TO PGM-NAME
  9291        GO TO 9300-XCTL.
  9292
  9293     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9294       AND
  9295        (EIBAID = DFHENTER)
  9296           GO TO 3500-EDIT-BATCH-DATA.
  9297
  9298     IF EIBAID = DFHENTER
  9299        GO TO 3500-EDIT-BATCH-DATA.
  9300
  9301     MOVE ER-0029             TO EMI-ERROR.
  9302     MOVE -1                  TO DPFENTRL.
  9303     MOVE AL-UNBON            TO DPFENTRA.
  9304     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9305     GO TO 8200-SEND-DATAONLY.
  9306
  9307 0800-BROWSE-ERROR.
  9308     MOVE ER-2258                TO EMI-ERROR.
  9309     MOVE -1                     TO DPFENTRL.
  9310     MOVE AL-UNBON               TO DPFENTRA.
  9311     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9312     GO TO 8200-SEND-DATAONLY.
  9313
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 172
* VP6311.cbl
  9315
  9316******************************************************************
  9317*                                                                *
  9318*                I S S U E   M A I N L I N E                     *
  9319*                                                                *
  9320******************************************************************
  9321
  9322 1000-ISSUE-MAINLINE.
  9323     IF PI-DISPLAY-ORIGINAL-BATCH
  9324        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9325           MOVE ER-0023             TO EMI-ERROR
  9326           MOVE -1                  TO BMAINTL
  9327           MOVE AL-UABON            TO BMAINTA
  9328           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9329           GO TO 8200-SEND-DATAONLY
  9330        ELSE
  9331           NEXT SENTENCE
  9332     ELSE
  9333        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9334           MOVE ER-0023             TO EMI-ERROR
  9335           MOVE -1                  TO BMAINTL
  9336           MOVE AL-UABON            TO BMAINTA
  9337           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9338           GO TO 8200-SEND-DATAONLY.
  9339
  9340     IF BMAINTI = 'S'
  9341        GO TO 1100-SHOW-REQUEST.
  9342
  9343     IF NOT MODIFY-CAP
  9344         MOVE 'UPDATE'       TO SM-READ
  9345         PERFORM 9995-SECURITY-VIOLATION
  9346         MOVE ER-0070        TO EMI-ERROR
  9347         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9348         GO TO 8100-SEND-INITIAL-MAP.
  9349
  9350     IF BMAINTL GREATER THAN ZEROS
  9351        IF PI-PF5-FUNCTION
  9352           IF BMAINTI NOT = 'A'
  9353              MOVE AL-UABON  TO BMAINTA
  9354              MOVE -1        TO BMAINTL
  9355              MOVE ER-2260   TO EMI-ERROR
  9356              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9357              GO TO 8200-SEND-DATAONLY.
  9358
  9359     IF BCERTNOL = ZEROS
  9360       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9361         NEXT SENTENCE
  9362     ELSE
  9363         IF BCERTNOL NOT = ZEROS
  9364             MOVE AL-UANON       TO BCERTNOA
  9365         ELSE
  9366             MOVE -1             TO BCERTNOL
  9367             MOVE  1             TO SET-CURSOR-SW
  9368             MOVE ER-2218        TO EMI-ERROR
  9369             MOVE AL-UABON       TO BCERTNOA
  9370             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9371
  9372     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 173
* VP6311.cbl
  9373         MOVE AL-UANON       TO BSUFIXA
  9374     ELSE
  9375         MOVE AL-SANOF       TO BSUFIXA.
  9376
  9377     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9378        NEXT SENTENCE
  9379     ELSE
  9380        IF BEFFDTL NOT = ZEROS
  9381           MOVE AL-UNNON             TO BEFFDTA
  9382           MOVE BEFFDTI              TO DEEDIT-FIELD
  9383           PERFORM 8600-DEEDIT
  9384           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9385           MOVE 4                    TO DC-OPTION-CODE
  9386           PERFORM 9700-DATE-LINK
  9387           IF NO-CONVERSION-ERROR
  9388              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9389              ELSE
  9390              MOVE -1                TO BEFFDTL
  9391              MOVE  1                TO SET-CURSOR-SW
  9392              MOVE ER-2226           TO EMI-ERROR
  9393              MOVE AL-UNBON          TO BEFFDTA
  9394              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9395           ELSE
  9396              MOVE -1                TO BEFFDTL
  9397              MOVE  1                TO SET-CURSOR-SW
  9398              MOVE ER-2220           TO EMI-ERROR
  9399              MOVE AL-UNBON          TO BEFFDTA
  9400              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9401
  9402     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9403
  9404     IF BCERTNOL NOT = ZEROS
  9405        MOVE BCERTNOI                TO WS-NEW-PRIME
  9406     ELSE
  9407        MOVE SPACES                  TO WS-NEW-PRIME.
  9408
  9409     IF BSUFIXL NOT = ZEROS
  9410        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9411     ELSE
  9412        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9413
  9414     IF BEFFDTL NOT = ZEROS
  9415        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9416     ELSE
  9417        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9418
  9419     IF BMAINTI = 'A' OR 'K' OR 'S'
  9420        NEXT SENTENCE
  9421     ELSE
  9422        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9423        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9424           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9425           WS-PB-RECORD-TYPE NOT = '1'
  9426           IF BMAINTI = 'C'
  9427               MOVE ER-2287          TO EMI-ERROR
  9428               MOVE -1               TO BCERTNOL
  9429               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9430               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 174
* VP6311.cbl
  9431               GO TO 8200-SEND-DATAONLY
  9432             ELSE
  9433               MOVE ER-2260          TO EMI-ERROR
  9434               MOVE -1               TO BCERTNOL
  9435               MOVE AL-UABON         TO BCERTNOA
  9436               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9437               GO TO 8200-SEND-DATAONLY.
  9438
  9439     IF BMAINTI = 'D'
  9440         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9441
  9442*    IF BMICRNOL  NOT =  ZEROS
  9443*        IF BMICRNOI  NUMERIC
  9444*            MOVE AL-UNNON       TO  BMICRNOA
  9445*        ELSE
  9446*            MOVE -1             TO  BMICRNOL
  9447*            MOVE 1              TO  SET-CURSOR-SW
  9448*            MOVE AL-UNBON       TO  BMICRNOA
  9449*            MOVE ER-2701        TO  EMI-ERROR
  9450*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9451     IF BVINL NOT = ZEROS
  9452        MOVE AL-UANON            TO BVINA
  9453     END-IF
  9454     IF B1STNML NOT = ZEROS
  9455         MOVE AL-UANON                TO B1STNMA.
  9456
  9457     IF BINITL  NOT = ZEROS
  9458        MOVE AL-UANON                TO BINITA.
  9459
  9460     IF BSEXL NOT = ZEROS
  9461        IF BSEXI = 'M' OR 'F'
  9462           MOVE AL-UANON             TO BSEXA
  9463        ELSE
  9464           MOVE -1               TO BSEXL
  9465           MOVE ER-2629          TO EMI-ERROR
  9466           MOVE AL-UABON         TO BSEXA
  9467           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9468
  9469     IF BAGEL NOT = ZEROS
  9470         IF BAGEI NUMERIC
  9471             MOVE BAGEI              TO WS-BAGE
  9472             MOVE AL-UNNON           TO BAGEA
  9473         ELSE
  9474             MOVE -1                 TO BAGEL
  9475             MOVE  1                 TO SET-CURSOR-SW
  9476             MOVE ER-2223            TO EMI-ERROR
  9477             MOVE AL-UNBON           TO BAGEA
  9478             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9479
  9480     IF BLSTNML NOT = ZERO  OR
  9481        B1STNML NOT = ZERO  OR
  9482        BINITL NOT = ZERO
  9483         IF BAGEL = ZEROS
  9484             MOVE -1                 TO BAGEL
  9485             MOVE  1                 TO SET-CURSOR-SW
  9486             MOVE ER-3269            TO EMI-ERROR
  9487             MOVE AL-UNBON           TO BAGEA
  9488             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 175
* VP6311.cbl
  9489         END-IF
  9490     END-IF.
  9491
  9492     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9493
  9494     IF (BBIRTHL GREATER THAN +0) AND
  9495        (BBIRTHI NOT EQUAL SPACES)
  9496        NEXT SENTENCE
  9497     ELSE
  9498        GO TO 1010-CHECK-AGE.
  9499
  9500     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9501     PERFORM 8600-DEEDIT.
  9502     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9503     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9504     MOVE AL-UNNON               TO BBIRTHA.
  9505     MOVE '4'                    TO DC-OPTION-CODE.
  9506     PERFORM 9700-DATE-LINK.
  9507     IF DATE-CONVERSION-ERROR
  9508        MOVE -1                  TO BBIRTHL
  9509        MOVE  1                  TO SET-CURSOR-SW
  9510        MOVE ER-2228             TO EMI-ERROR
  9511        MOVE AL-UNBON            TO BBIRTHA
  9512        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9513        GO TO 1010-CHECK-AGE.
  9514
  9515     IF (NO-CONVERSION-ERROR) AND
  9516        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9517        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9518        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9519        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9520                                    WS-CONVERTED-BIRTH
  9521        MOVE AL-UANON            TO BBIRTHA
  9522     ELSE
  9523        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9524        MOVE AL-UANON            TO BBIRTHA.
  9525
  9526 1010-CHECK-AGE.
  9527
  9528*    IF BAGEL = ZERO
  9529*       IF BBIRTHL GREATER THAN ZERO
  9530*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9531
  9532
  9533
  9534
  9535**   IF PI-COMPANY-ID = 'DMD'
  9536     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9537        NEXT SENTENCE
  9538     ELSE
  9539         IF BLNOFCRL NOT = ZEROS
  9540            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9541            IF LOAN-OFFICER-FOUND
  9542                MOVE AL-UANON        TO BLNOFCRA
  9543             ELSE
  9544                 MOVE SPACE          TO WS-LOAN-OFFICER
  9545                 MOVE -1             TO BLNOFCRL
  9546                 MOVE  1             TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 176
* VP6311.cbl
  9547                 MOVE ER-3006        TO EMI-ERROR
  9548                 MOVE AL-UNBON       TO BLNOFCRA
  9549                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9550
  9551 1010-EDIT-CONT.
  9552
  9553     IF BFORCEL  NOT = ZEROS
  9554         IF FORCE-CAP
  9555            MOVE AL-UANON            TO BFORCEA
  9556         ELSE
  9557            MOVE ER-2945             TO EMI-ERROR
  9558            MOVE AL-UABON            TO BFORCEA
  9559            MOVE -1                  TO BFORCEL
  9560            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9561
  9562     IF BENTRYL NOT = ZEROS
  9563        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9564                 'C' and 'D' AND 'V' AND 'U' AND 'M'
  9565           MOVE ER-2224              TO EMI-ERROR
  9566           MOVE AL-UABON             TO BENTRYA
  9567           MOVE -1                   TO BENTRYL
  9568           MOVE  1                   TO SET-CURSOR-SW
  9569           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9570        ELSE
  9571           MOVE AL-UANON             TO BENTRYA.
  9572
  9573     IF BUNWRITL NOT = ZEROS
  9574        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9575           MOVE ER-7574              TO EMI-ERROR
  9576           MOVE AL-UABON             TO BUNWRITA
  9577           MOVE -1                   TO BUNWRITL
  9578           MOVE  1                   TO SET-CURSOR-SW
  9579           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9580        ELSE
  9581           MOVE AL-UANON             TO BUNWRITA.
  9582
  9583     IF BREINL  NOT = ZEROS
  9584         MOVE AL-UANON               TO BREINA.
  9585
  9586     IF BBILCDL NOT = ZEROS
  9587        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9588                             AND 'A' AND 'B' AND 'E'
  9589           MOVE ER-2225              TO EMI-ERROR
  9590           MOVE AL-UABON             TO BBILCDA
  9591           MOVE -1                   TO BBILCDL
  9592           MOVE  1                   TO SET-CURSOR-SW
  9593           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9594        ELSE
  9595           MOVE AL-UANON             TO BBILCDA.
  9596
  9597     IF BSKPCDL NOT = ZEROS
  9598         MOVE AL-UANON               TO BSKPCDA.
  9599
  9600     IF BINDGRPL NOT = ZEROS
  9601         MOVE AL-UANON               TO BINDGRPA.
  9602
  9603     IF BSIGL   NOT = ZEROS
  9604         MOVE AL-UANON               TO BSIGA.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 177
* VP6311.cbl
  9605
  9606     IF BRTCLSL NOT = ZEROS
  9607         MOVE AL-UANON               TO BRTCLSA.
  9608
  9609     IF BMEMBERL NOT = ZEROS
  9610         MOVE AL-UANON               TO BMEMBERA.
  9611
  9612     MOVE +0                         TO WS-SUB1.
  9613
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 178
* VP6311.cbl
  9615
  9616******************************************************************
  9617*                                                                *
  9618*           E D I T   I S S U E   C O V E R A G E S              *
  9619*                                                                *
  9620******************************************************************
  9621
  9622 1020-EDIT-COVERAGES.
  9623     ADD +1                      TO WS-SUB1.
  9624
  9625     IF WS-SUB1 GREATER +2
  9626        GO TO 1025-EDIT-CONTINUE
  9627     END-IF
  9628
  9629
  9630     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9631        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9632        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9633        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9634        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9635        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9636        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9637        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9638        NEXT SENTENCE
  9639         ELSE
  9640            GO TO 1020-EDIT-COVERAGES.
  9641
  9642 1021-CONT-EDIT.
  9643
  9644     IF BMAINTI = 'A'
  9645        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9646           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9647        ELSE
  9648           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9649           MOVE ER-7404          TO EMI-ERROR
  9650           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9651           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9652     ELSE
  9653        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9654           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9655
  9656     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9657        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9658        PERFORM 8600-DEEDIT
  9659        IF DEEDIT-FIELD-V0 NUMERIC
  9660           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9661        ELSE
  9662           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9663
  9664
  9665     IF BMAINTI = ('C' OR 'K')
  9666        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9667           NEXT SENTENCE
  9668        ELSE
  9669           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9670           PERFORM 8600-DEEDIT
  9671           IF DEEDIT-FIELD-V0 NUMERIC
  9672              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 179
* VP6311.cbl
  9673              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9674                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9675              ELSE
  9676                    MOVE ER-2241      TO EMI-ERROR
  9677                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9678                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9679                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9680           ELSE
  9681              MOVE ER-2223          TO EMI-ERROR
  9682              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9683              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9684              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9685     ELSE
  9686        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9687            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9688            PERFORM 8600-DEEDIT
  9689            IF DEEDIT-FIELD-V0      NUMERIC
  9690               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9691                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9692                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9693               ELSE
  9694                  MOVE ER-2241         TO EMI-ERROR
  9695                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9696                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9697                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9698            ELSE
  9699              MOVE ER-2223             TO EMI-ERROR
  9700              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9701              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9702              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9703        ELSE
  9704            MOVE ER-2240               TO EMI-ERROR
  9705            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9706            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9707
  9708     IF BBEN-LEN (WS-SUB1) = ZEROS
  9709        AND BMAINTI = ('C' OR 'K')
  9710           NEXT SENTENCE
  9711     ELSE
  9712        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9713           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9714
  9715* EXEC CICS BIF DEEDIT
  9716*              FIELD  (BBENI (WS-SUB1))
  9717*              LENGTH (12)
  9718*          END-EXEC
  9719     MOVE 12
  9720       TO DFHEIV11
  9721*    MOVE '@"L                   #   #00009649' TO DFHEIV0
  9722     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9723     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9724     MOVE X'2020233030303039363439' TO DFHEIV0(25:11)
  9725     CALL 'kxdfhei1' USING DFHEIV0,
  9726           BBENI(WS-SUB1),
  9727           DFHEIV11
  9728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9729           IF BBENI (WS-SUB1)  NUMERIC
  9730              IF BBENI (WS-SUB1) GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 180
* VP6311.cbl
  9731                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9732*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9733*          PERFORM 8600-DEEDIT
  9734*          IF DEEDIT-FIELD-V2  NUMERIC
  9735*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9736*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9737              ELSE
  9738                 MOVE ER-7632    TO EMI-ERROR
  9739                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9740                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9741                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9742           ELSE
  9743              MOVE ER-2223         TO EMI-ERROR
  9744              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9745              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9746              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9747        ELSE
  9748           MOVE ER-7632    TO EMI-ERROR
  9749           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9750           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9751           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9752
  9753     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9754        AND (BMAINTI = ('C' OR 'K'))
  9755        CONTINUE
  9756     ELSE
  9757        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9758           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9759           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9760              FOR ALL '.'
  9761           IF WS-TALLY > 1
  9762              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9763                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9764              END-PERFORM
  9765              IF A1 < 9
  9766                 ADD 3 TO A1
  9767                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9768              END-IF
  9769           ELSE
  9770              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9771                (A1 > 11)
  9772                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9773                  LOW-VALUES OR SPACES)
  9774              END-PERFORM
  9775              IF A1 > 1 AND < 12
  9776                 MOVE SPACES
  9777                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9778              END-IF
  9779           END-IF
  9780
  9781* EXEC CICS BIF DEEDIT
  9782*              FIELD  (BPREMI (WS-SUB1))
  9783*              LENGTH (11)
  9784*          END-EXEC
  9785     MOVE 11
  9786       TO DFHEIV11
  9787*    MOVE '@"L                   #   #00009704' TO DFHEIV0
  9788     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 181
* VP6311.cbl
  9789     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9790     MOVE X'2020233030303039373034' TO DFHEIV0(25:11)
  9791     CALL 'kxdfhei1' USING DFHEIV0,
  9792           BPREMI(WS-SUB1),
  9793           DFHEIV11
  9794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9795           IF BPREMI (WS-SUB1) NUMERIC
  9796              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9797                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9798*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9799*          PERFORM 8600-DEEDIT
  9800*          IF DEEDIT-FIELD-V2  NUMERIC
  9801*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9802*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9803              ELSE
  9804                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  9805                    MOVE ER-7633    TO EMI-ERROR
  9806                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9807                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9808                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9809                 END-IF
  9810              END-IF
  9811           ELSE
  9812              MOVE ER-2223         TO EMI-ERROR
  9813              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9814              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9815              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9816           END-IF
  9817        ELSE
  9818           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  9819              MOVE ER-7633         TO EMI-ERROR
  9820              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9821              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9822              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9823           END-IF
  9824        END-IF
  9825     END-IF
  9826
  9827     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9828        NEXT SENTENCE
  9829     ELSE
  9830        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9831
  9832* EXEC CICS BIF DEEDIT
  9833*           FIELD  (BCPREMI (WS-SUB1))
  9834*           LENGTH (11)
  9835*       END-EXEC
  9836     MOVE 11
  9837       TO DFHEIV11
  9838*    MOVE '@"L                   #   #00009744' TO DFHEIV0
  9839     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9840     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9841     MOVE X'2020233030303039373434' TO DFHEIV0(25:11)
  9842     CALL 'kxdfhei1' USING DFHEIV0,
  9843           BCPREMI(WS-SUB1),
  9844           DFHEIV11
  9845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9846        IF BCPREMI (WS-SUB1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 182
* VP6311.cbl
  9847           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
  9848*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
  9849*       PERFORM 8600-DEEDIT
  9850*       IF DEEDIT-FIELD-V2  NUMERIC
  9851*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
  9852        ELSE
  9853           MOVE ER-2223         TO EMI-ERROR
  9854           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
  9855           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
  9856           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9857
  9858     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9859        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
  9860        PERFORM 8600-DEEDIT
  9861        IF DEEDIT-FIELD-V0 NUMERIC
  9862           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
  9863           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9864         ELSE
  9865           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
  9866           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9867           MOVE ER-2223              TO EMI-ERROR
  9868           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9869
  9870     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9871        IF BEXPIRE   (WS-SUB1) = SPACES
  9872           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  9873        ELSE
  9874           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
  9875           PERFORM 8600-DEEDIT
  9876           IF DEEDIT-FIELD-V0        NUMERIC
  9877              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
  9878              MOVE 4                TO DC-OPTION-CODE
  9879              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9880              PERFORM 9700-DATE-LINK
  9881              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
  9882                                                        (WS-SUB1)
  9883              IF NO-CONVERSION-ERROR
  9884                 NEXT SENTENCE
  9885              ELSE
  9886                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  9887                 MOVE ER-2531    TO EMI-ERROR
  9888                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  9889                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9890           ELSE
  9891             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  9892             MOVE ER-2532        TO EMI-ERROR
  9893             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  9894             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9895
  9896     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
  9897        NEXT SENTENCE
  9898     ELSE
  9899
  9900* EXEC CICS BIF DEEDIT
  9901*           FIELD  (BALT-BENI (WS-SUB1))
  9902*           LENGTH (12)
  9903*       END-EXEC
  9904     MOVE 12
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 183
* VP6311.cbl
  9905       TO DFHEIV11
  9906*    MOVE '@"L                   #   #00009801' TO DFHEIV0
  9907     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9908     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9909     MOVE X'2020233030303039383031' TO DFHEIV0(25:11)
  9910     CALL 'kxdfhei1' USING DFHEIV0,
  9911           BALT-BENI(WS-SUB1),
  9912           DFHEIV11
  9913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9914        IF BALT-BENI (WS-SUB1) NUMERIC
  9915           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
  9916*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
  9917*       PERFORM 8600-DEEDIT
  9918*       IF DEEDIT-FIELD-V0 NUMERIC
  9919*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
  9920        ELSE
  9921           MOVE ER-2223         TO EMI-ERROR
  9922           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
  9923           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
  9924           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9925
  9926     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
  9927        NEXT SENTENCE
  9928     ELSE
  9929
  9930* EXEC CICS BIF DEEDIT
  9931*           FIELD  (BALT-PREMI (WS-SUB1))
  9932*           LENGTH (11)
  9933*       END-EXEC
  9934     MOVE 11
  9935       TO DFHEIV11
  9936*    MOVE '@"L                   #   #00009820' TO DFHEIV0
  9937     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9938     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9939     MOVE X'2020233030303039383230' TO DFHEIV0(25:11)
  9940     CALL 'kxdfhei1' USING DFHEIV0,
  9941           BALT-PREMI(WS-SUB1),
  9942           DFHEIV11
  9943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9944        IF BALT-PREMI (WS-SUB1) NUMERIC
  9945           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
  9946*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
  9947*       PERFORM 8600-DEEDIT
  9948*       IF DEEDIT-FIELD-V0 NUMERIC
  9949*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
  9950        ELSE
  9951           MOVE ER-2223         TO EMI-ERROR
  9952           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
  9953           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
  9954           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9955
  9956      GO TO 1020-EDIT-COVERAGES.
  9957     .
  9958 1025-edit-continue.
  9959     IF PI-COMPANY-ID  =  'DMD'
  9960        MOVE LOW-VALUES             TO BNCERTI
  9961                                       BNSTATI.
  9962
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 184
* VP6311.cbl
  9963     IF EMI-ERROR = ZEROS
  9964         NEXT SENTENCE
  9965     ELSE
  9966         GO TO 8200-SEND-DATAONLY.
  9967
  9968     IF BMAINTI = 'A'
  9969         GO TO 1200-ADD-ISSUE-ROUTINE.
  9970
  9971     IF BMAINTI = 'C'
  9972         GO TO 1300-CHANGE-ISSUE-ROUTINE.
  9973
  9974     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
  9975
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 185
* VP6311.cbl
  9977
  9978 1030-EDIT-FOR-NUMERICS.
  9979     IF WS-CSO-SUB EQUAL 10
  9980        GO TO 1030-EDIT-EXIT.
  9981
  9982     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
  9983        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
  9984        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
  9985           ADD +1               TO WS-CSO-SUB
  9986           GO TO 1030-EDIT-FOR-NUMERICS.
  9987
  9988     MOVE 'N'                   TO WS-NUMERIC-SW.
  9989
  9990 1030-EDIT-EXIT.
  9991******************************************************************
  9992*                                                                *
  9993*                 C A L C U L A T E   A G E                      *
  9994*                                                                *
  9995******************************************************************
  9996
  9997
  9998 1095-CALC-AGE.
  9999
 10000     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10001     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10002     MOVE 1                  TO DC-OPTION-CODE.
 10003     PERFORM 9700-DATE-LINK
 10004     IF NO-CONVERSION-ERROR
 10005         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10006         MOVE WS-BAGE            TO BAGEI
 10007         MOVE +2                 TO BAGEL
 10008         MOVE AL-UNNON TO BAGEA.
 10009
 10010 1099-EXIT.
 10011     EXIT.
 10012
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 186
* VP6311.cbl
 10014
 10015******************************************************************
 10016*                                                                *
 10017*                   S H O W   I S S U E                          *
 10018*                                                                *
 10019******************************************************************
 10020
 10021 1100-SHOW-REQUEST.
 10022     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10023
 10024     IF BCERTNOL = ZEROS AND
 10025        BEFFDTL  = ZEROS
 10026        MOVE -1                  TO BMAINTL
 10027        GO TO 8200-SEND-DATAONLY.
 10028
 10029     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10030
 10031     IF BSUFIXL NOT = ZEROS
 10032        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10033     ELSE
 10034        MOVE SPACE               TO WS-NEW-SUFFIX.
 10035
 10036     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10037     PERFORM 8600-DEEDIT.
 10038     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10039     MOVE '4'                    TO DC-OPTION-CODE.
 10040     PERFORM 9700-DATE-LINK.
 10041     IF DATE-CONVERSION-ERROR
 10042        MOVE ER-0348             TO EMI-ERROR
 10043        MOVE -1                  TO BEFFDTL
 10044        MOVE AL-UABON            TO BEFFDTA
 10045        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10046        GO TO 8200-SEND-DATAONLY
 10047     ELSE
 10048        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10049        MOVE AL-UANON            TO BEFFDTA
 10050        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10051
 10052     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10053
 10054     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10055        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10056          MOVE 'Y'                    TO WS-SHOW-SW
 10057          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10058             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10059           ELSE
 10060             IF PI-FILE-BROWSE
 10061                GO TO 4300-BROWSE-FILE-FORWARD
 10062              ELSE
 10063                IF PI-CSR-BROWSE
 10064                   GO TO 4200-BROWSE-CSR-FORWARD
 10065                ELSE
 10066                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10067        ELSE
 10068           GO TO 3900-RE-DISPLAY-RECORD.
 10069
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 187
* VP6311.cbl
 10071
 10072******************************************************************
 10073*                                                                *
 10074*            A D D   I S S U E   R O U T I N E                   *
 10075*                                                                *
 10076******************************************************************
 10077
 10078***************************************************************
 10079*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10080*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10081*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10082*     4. LINK TO THE EDIT ROUTINE.                            *
 10083*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10084*     6. WRITE THE NEW ISSUE RECORD.                          *
 10085*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10086*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10087*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10088*        ELSE                                                 *
 10089*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10090***************************************************************
 10091
 10092 1200-ADD-ISSUE-ROUTINE.
 10093     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10094
 10095
 10096* EXEC CICS GETMAIN
 10097*        SET     (ADDRESS OF PENDING-BUSINESS)
 10098*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10099*    END-EXEC.
 10100*    MOVE '," L                  $   #00009975' TO DFHEIV0
 10101     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10102     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10103     MOVE X'2020233030303039393735' TO DFHEIV0(25:11)
 10104     CALL 'kxdfhei1' USING DFHEIV0,
 10105           DFHEIV20,
 10106           ERPNDB-RECORD-LENGTH,
 10107           DFHEIV99
 10108     SET ADDRESS OF PENDING-BUSINESS TO
 10109         DFHEIV20
 10110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10111
 10112
 10113
 10114* EXEC CICS HANDLE CONDITION
 10115*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10116*    END-EXEC.
 10117*    MOVE '"$I                   ! # #00009980' TO DFHEIV0
 10118     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10119     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10120     MOVE X'2320233030303039393830' TO DFHEIV0(25:11)
 10121     CALL 'kxdfhei1' USING DFHEIV0
 10122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10123
 10124
 10125     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10126     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10127     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10128
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 188
* VP6311.cbl
 10129
 10130* EXEC CICS READ
 10131*        INTO    (PENDING-BUSINESS)
 10132*        DATASET (FILE-ID-ERPNDB)
 10133*        RIDFLD  (ERPNDB-KEY)
 10134*    END-EXEC.
 10135     MOVE LENGTH OF
 10136      PENDING-BUSINESS
 10137       TO DFHEIV11
 10138*    MOVE '&"IL       E          (   #00009988' TO DFHEIV0
 10139     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10140     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10141     MOVE X'2020233030303039393838' TO DFHEIV0(25:11)
 10142     CALL 'kxdfhei1' USING DFHEIV0,
 10143           FILE-ID-ERPNDB,
 10144           PENDING-BUSINESS,
 10145           DFHEIV11,
 10146           ERPNDB-KEY,
 10147           DFHEIV99,
 10148           DFHEIV99,
 10149           DFHEIV99
 10150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10151
 10152
 10153     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10154
 10155     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10156     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10157     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10158     MOVE SPACES                 TO PENDING-BUSINESS.
 10159     MOVE 'PB'                   TO PB-RECORD-ID.
 10160     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10161     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10162     MOVE SPACES                 TO PB-CERT-SFX.
 10163     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10164     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10165                                    PB-ALT-CHG-SEQ-NO.
 10166
 10167     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10168     MOVE '1'                    TO PB-RECORD-TYPE.
 10169
 10170     IF BSUFIXL NOT = ZEROS
 10171        MOVE BSUFIXI             TO PB-CERT-SFX.
 10172
 10173     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10174
 10175     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10176     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10177
 10178     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10179                                    PB-I-LF-PREM-CALC
 10180                                    PB-I-LF-ALT-PREM-CALC
 10181                                    PB-I-LF-RATE
 10182                                    PB-I-LF-ALT-RATE
 10183                                    PB-I-LF-REI-RATE
 10184                                    PB-I-LF-ALT-REI-RATE
 10185                                    PB-I-RATE-DEV-PCT-LF
 10186                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 189
* VP6311.cbl
 10187                                    PB-I-AH-RATE
 10188                                    PB-I-AH-REI-RATE
 10189                                    PB-I-AH-RATE-TRM
 10190                                    PB-I-RATE-DEV-PCT-AH
 10191                                    PB-I-BUSINESS-TYPE
 10192                                    PB-I-LIFE-COMMISSION
 10193                                    PB-I-JOINT-COMMISSION
 10194                                    PB-I-JOINT-AGE
 10195                                    PB-I-AH-COMMISSION
 10196                                    PB-I-CURR-SEQ
 10197                                    PB-CHG-COUNT
 10198                                    PB-LF-BILLED-AMTS
 10199                                    PB-AH-BILLED-AMTS
 10200                                    PB-CALC-TOLERANCE
 10201                                    PB-I-EXTENTION-DAYS
 10202*                                   PB-I-MICROFILM-NO
 10203                                    PB-I-TERM-IN-DAYS.
 10204
 10205     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10206                                    PB-I-LF-EXPIRE-DT
 10207                                    PB-I-AH-EXPIRE-DT
 10208                                    PB-BILLED-DT
 10209                                    PB-ACCT-EFF-DT
 10210                                    PB-ACCT-EXP-DT
 10211                                    PB-I-1ST-PMT-DT.
 10212
 10213     MOVE 'X'                    TO PB-FATAL-FLAG.
 10214
 10215     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10216
 10217     IF BLSTNML GREATER THAN ZEROS
 10218         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10219
 10220*    IF BMICRNOL  GREATER  ZEROS
 10221*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10222*    ELSE
 10223*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10224     IF BVINL > ZEROS
 10225        MOVE BVINI               TO PB-I-VIN
 10226     END-IF
 10227     IF B1STNML GREATER THAN ZEROS
 10228         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10229
 10230     IF BINITL  GREATER THAN ZEROS
 10231         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10232
 10233     IF BBIRTHL GREATER THAN ZERO
 10234         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10235     ELSE
 10236         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10237
 10238
 10239     IF BAGEL    GREATER THAN ZEROS
 10240         MOVE BAGEI              TO PB-I-AGE
 10241        ELSE
 10242         MOVE ZEROS              TO PB-I-AGE.
 10243
 10244     IF BSEXL    GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 190
* VP6311.cbl
 10245         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10246
 10247     IF BTERM-LEN (1) GREATER THAN ZEROS
 10248        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10249     ELSE
 10250        MOVE ZEROS               TO PB-I-LF-TERM.
 10251
 10252     IF BTERM-LEN (2) GREATER THAN ZEROS
 10253        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10254     ELSE
 10255        MOVE ZEROS               TO PB-I-AH-TERM.
 10256
 10257
 10258
 10259     IF BSKPCDL       GREATER THAN ZEROS
 10260         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10261
 10262
 10263         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10264                                    PI-BPMTS.
 10265
 10266         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10267
 10268     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10269        IF BTYPE  (1)   NOT = ZEROS
 10270           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10271                                    PI-BTYPE (1)
 10272           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10273           MOVE SPACES           TO PB-I-LF-ABBR
 10274        ELSE
 10275           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10276                                    PB-I-LF-ABBR
 10277           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10278     ELSE
 10279        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10280                                    PB-I-LF-ABBR
 10281        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10282
 10283     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10284         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10285     ELSE
 10286         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10287
 10288     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10289         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10290     ELSE
 10291         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10292
 10293     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10294         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10295            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10296            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10297         ELSE
 10298            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10299*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10300*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10301         END-IF
 10302     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 191
* VP6311.cbl
 10303         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10304
 10305     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10306         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10307
 10308     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10309         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10310         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10311     ELSE
 10312         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10313
 10314     IF  BALT-PREM-LEN     (2) > ZEROS
 10315         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10316     ELSE
 10317         MOVE ZEROS            TO PB-I-TOT-FEES.
 10318
 10319     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10320        IF BTYPE      (2)   NOT = ZEROS
 10321           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10322                                  PI-BTYPE (2)
 10323           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10324           MOVE SPACES         TO PB-I-AH-ABBR
 10325        ELSE
 10326           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10327                                  PB-I-AH-ABBR
 10328           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10329     ELSE
 10330        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10331                                  PB-I-AH-ABBR
 10332        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10333
 10334     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10335         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10336     ELSE
 10337         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10338
 10339     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10340         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10341            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10342            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10343         ELSE
 10344            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10345*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10346*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10347         END-IF
 10348     ELSE
 10349         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10350
 10351     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10352         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10353
 10354     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10355        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10356     ELSE
 10357        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10358
 10359     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10360        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 192
* VP6311.cbl
 10361     ELSE
 10362        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10363
 10364     IF BINDGRPL  GREATER THAN ZEROS
 10365         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10366
 10367     IF BRTCLSL   GREATER THAN ZEROS
 10368         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10369
 10370     IF BSIGL     GREATER THAN ZEROS
 10371         MOVE BSIGI              TO PB-I-SIG-SW.
 10372     IF BMEMBERL  GREATER THAN ZEROS
 10373         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10374
 10375     IF BLNOFCRL  GREATER THAN ZEROS
 10376         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10377
 10378     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10379        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10380     ELSE
 10381        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10382
 10383     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10384        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10385     ELSE
 10386        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10387
 10388
 10389     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10390        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10391           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10392
 10393     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10394        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10395           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10396
 10397
 10398     IF PB-EXT-DAYS-PROCESSING
 10399        IF PB-I-EXTENTION-DAYS = ZEROS
 10400           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10401
 10402     IF PB-EXPIRE-DT-PROCESSING
 10403        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10404           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10405             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10406
 10407     IF PB-1ST-PMT-DT-PROCESSING
 10408        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10409           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10410
 10411     IF BREINL GREATER THAN ZEROS
 10412        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10413
 10414     IF BENTRYL NOT = ZEROS
 10415        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10416        IF PI-COMPANY-ID = 'CID'
 10417           AND (PB-BATCH-ENTRY = 'P')
 10418           AND (PB-STATE = 'VA')
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 193
* VP6311.cbl
 10419           PERFORM 1500-UPDATE-ERNOTE
 10420                                 THRU 1500-EXIT
 10421        END-IF
 10422     END-IF
 10423     IF BUNWRITL NOT = ZEROS
 10424        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10425
 10426     IF BFORCEL NOT = ZEROS
 10427        MOVE BFORCEI             TO PB-FORCE-CODE.
 10428
 10429     IF BBILCDL NOT = ZEROS
 10430        MOVE BBILCDI             TO PB-RECORD-BILL.
 10431
 10432
 10433
 10434 1260-WRITE-PB-RECORD.
 10435     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10436                                    PB-INPUT-BY.
 10437     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10438     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10439                                    PB-INPUT-DT.
 10440
 10441     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10442     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10443                                    PB-CONTROL-BY-ORIG-BATCH.
 10444
 10445
 10446     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10447     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10448     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10449     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10450     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10451
 10452     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10453
 10454     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10455
 10456     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10457     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10458     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10459
 10460     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10461     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10462
 10463 1275-WRITE-PENDING-BUSINESS.
 10464     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10465     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10466     MOVE 'A'                    TO JP-RECORD-TYPE.
 10467     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10468
 10469
 10470* EXEC CICS HANDLE CONDITION
 10471*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10472*    END-EXEC.
 10473*    MOVE '"$%                   ! $ #00010310' TO DFHEIV0
 10474     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10475     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10476     MOVE X'2420233030303130333130' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 194
* VP6311.cbl
 10477     CALL 'kxdfhei1' USING DFHEIV0
 10478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10479
 10480
 10481
 10482* EXEC CICS WRITE
 10483*        DATASET (FILE-ID-ERPNDB)
 10484*        FROM    (PENDING-BUSINESS)
 10485*        RIDFLD  (PB-CONTROL-PRIMARY)
 10486*    END-EXEC.
 10487     MOVE LENGTH OF
 10488      PENDING-BUSINESS
 10489       TO DFHEIV11
 10490*    MOVE '&$ L                  ''   #00010314' TO DFHEIV0
 10491     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10492     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10493     MOVE X'2020233030303130333134' TO DFHEIV0(25:11)
 10494     CALL 'kxdfhei1' USING DFHEIV0,
 10495           FILE-ID-ERPNDB,
 10496           PENDING-BUSINESS,
 10497           DFHEIV11,
 10498           PB-CONTROL-PRIMARY,
 10499           DFHEIV99,
 10500           DFHEIV99
 10501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10502
 10503
 10504     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10505
 10506     PERFORM 8400-LOG-JOURNAL-RECORD.
 10507
 10508******************************************************************
 10509*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10510******************************************************************
 10511     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10512     MOVE ' '                    TO WS-ERMAIL-SW
 10513
 10514* EXEC CICS READ
 10515*       DATASET   (FILE-ID-ERMAIL)
 10516*       SET       (ADDRESS OF MAILING-DATA)
 10517*       RIDFLD    (ERMAIL-KEY)
 10518*       RESP      (WS-RESPONSE)
 10519*    END-EXEC
 10520*    MOVE '&"S        E          (  N#00010330' TO DFHEIV0
 10521     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10522     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10523     MOVE X'204E233030303130333330' TO DFHEIV0(25:11)
 10524     CALL 'kxdfhei1' USING DFHEIV0,
 10525           FILE-ID-ERMAIL,
 10526           DFHEIV20,
 10527           DFHEIV99,
 10528           ERMAIL-KEY,
 10529           DFHEIV99,
 10530           DFHEIV99,
 10531           DFHEIV99
 10532     SET ADDRESS OF MAILING-DATA TO
 10533         DFHEIV20
 10534     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 195
* VP6311.cbl
 10535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10536     IF RESP-NORMAL
 10537        SET ERMAIL-FOUND TO TRUE
 10538     END-IF
 10539
 10540     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10541     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10542     MOVE 'OC'                   TO OC-RECORD-ID
 10543     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10544                                 TO OC-CONTROL-PRIMARY (1:33)
 10545     MOVE 'I'                    TO OC-RECORD-TYPE
 10546     MOVE +4096                  TO OC-KEY-SEQ-NO
 10547     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10548     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10549     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10550     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10551     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10552     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10553     MOVE PB-I-AGE               TO OC-INS-AGE
 10554     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10555     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10556     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10557     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10558     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10559     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10560     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10561     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10562     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10563     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10564     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10565     IF PB-I-JOINT-COMMISSION > +0
 10566         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10567     ELSE
 10568         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10569     END-IF
 10570     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10571     MOVE +0                     TO OC-LF-CANCEL-AMT
 10572                                    OC-LF-ITD-CANCEL-AMT
 10573     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10574     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10575     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10576     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10577     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10578     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10579     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10580     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10581     MOVE +0                     TO OC-AH-CANCEL-AMT
 10582                                    OC-AH-ITD-CANCEL-AMT
 10583     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10584     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10585     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10586     IF ERMAIL-FOUND
 10587        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10588     END-IF
 10589     IF NOT CERT-TRL-REC-NOT-FOUND
 10590        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10591                           OC-INS-AGE-DEFAULT-FLAG
 10592        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 196
* VP6311.cbl
 10593                           OC-JNT-AGE-DEFAULT-FLAG
 10594     END-IF
 10595     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10596     .
 10597 1275-WRITE-ELCRTO.
 10598
 10599* EXEC CICS WRITE
 10600*       DATASET   ('ELCRTO')
 10601*       FROM      (ORIGINAL-CERTIFICATE)
 10602*       RIDFLD    (OC-CONTROL-PRIMARY)
 10603*       RESP      (WS-RESPONSE)
 10604*    END-EXEC
 10605     MOVE LENGTH OF
 10606      ORIGINAL-CERTIFICATE
 10607       TO DFHEIV11
 10608     MOVE 'ELCRTO' TO DFHEIV1
 10609*    MOVE '&$ L                  ''  N#00010398' TO DFHEIV0
 10610     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10611     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10612     MOVE X'204E233030303130333938' TO DFHEIV0(25:11)
 10613     CALL 'kxdfhei1' USING DFHEIV0,
 10614           DFHEIV1,
 10615           ORIGINAL-CERTIFICATE,
 10616           DFHEIV11,
 10617           OC-CONTROL-PRIMARY,
 10618           DFHEIV99,
 10619           DFHEIV99
 10620     MOVE EIBRESP  TO WS-RESPONSE
 10621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10622*    display ' just wrote 1275 ' ws-response
 10623     IF RESP-DUPKEY
 10624        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10625        GO TO 1275-WRITE-ELCRTO
 10626     ELSE
 10627        IF NOT RESP-NORMAL
 10628           MOVE -1               TO BMAINTL
 10629           MOVE ER-7450          TO EMI-ERROR
 10630           PERFORM 9900-ERROR-FORMAT
 10631                                 THRU 9900-EXIT
 10632           GO TO 8200-SEND-DATAONLY
 10633        END-IF
 10634     END-IF
 10635******************************************************************
 10636*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10637******************************************************************
 10638
 10639
 10640* EXEC CICS READ
 10641*        INTO    (PENDING-BUSINESS)
 10642*        DATASET (FILE-ID-ERPNDB)
 10643*        RIDFLD  (ERPNDB-KEY)
 10644*        UPDATE
 10645*    END-EXEC.
 10646     MOVE LENGTH OF
 10647      PENDING-BUSINESS
 10648       TO DFHEIV11
 10649*    MOVE '&"IL       EU         (   #00010421' TO DFHEIV0
 10650     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 197
* VP6311.cbl
 10651     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10652     MOVE X'2020233030303130343231' TO DFHEIV0(25:11)
 10653     CALL 'kxdfhei1' USING DFHEIV0,
 10654           FILE-ID-ERPNDB,
 10655           PENDING-BUSINESS,
 10656           DFHEIV11,
 10657           ERPNDB-KEY,
 10658           DFHEIV99,
 10659           DFHEIV99,
 10660           DFHEIV99
 10661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10662
 10663
 10664     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10665     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10666     MOVE 'B'                    TO JP-RECORD-TYPE.
 10667     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10668
 10669     PERFORM 8400-LOG-JOURNAL-RECORD.
 10670
 10671     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10672
 10673
 10674* EXEC CICS REWRITE
 10675*        DATASET (FILE-ID-ERPNDB)
 10676*        FROM    (PENDING-BUSINESS)
 10677*    END-EXEC.
 10678     MOVE LENGTH OF
 10679      PENDING-BUSINESS
 10680       TO DFHEIV11
 10681*    MOVE '&& L                  %   #00010437' TO DFHEIV0
 10682     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10683     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10684     MOVE X'2020233030303130343337' TO DFHEIV0(25:11)
 10685     CALL 'kxdfhei1' USING DFHEIV0,
 10686           FILE-ID-ERPNDB,
 10687           PENDING-BUSINESS,
 10688           DFHEIV11,
 10689           DFHEIV99
 10690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10691
 10692
 10693     MOVE 'C'                    TO JP-RECORD-TYPE.
 10694     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10695
 10696     PERFORM 8400-LOG-JOURNAL-RECORD.
 10697
 10698     IF WS-ERRORS-PRESENT
 10699         GO TO 3900-RE-DISPLAY-RECORD.
 10700
 10701     MOVE ZEROS                  TO EMI-ERROR.
 10702     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10703     MOVE LOW-VALUES             TO VP631BI.
 10704     MOVE  -1                    TO BMAINTL.
 10705     GO TO 8100-SEND-INITIAL-MAP.
 10706
 10707 1280-BATCH-HDR-NOT-FOUND.
 10708     MOVE -1                     TO BMAINTL.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 198
* VP6311.cbl
 10709     MOVE ER-7450                TO EMI-ERROR.
 10710     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10711     GO TO 8200-SEND-DATAONLY.
 10712
 10713 1290-DUPLICATE-ALT-INDEX.
 10714
 10715******************************************************************
 10716*                                                                *
 10717*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10718*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10719*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10720*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10721*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10722*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10723*                                                                *
 10724******************************************************************
 10725
 10726     IF LCP-ONCTR-01 =  0
 10727         ADD 1 TO LCP-ONCTR-01
 10728        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10729
 10730     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10731
 10732     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10733         NEXT SENTENCE
 10734     ELSE
 10735         ADD +1 TO PB-BATCH-SEQ-NO
 10736                   PB-CSR-BATCH-SEQ-NO
 10737         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10738         GO TO 1275-WRITE-PENDING-BUSINESS.
 10739
 10740     MOVE -1                     TO BCERTNOL.
 10741     MOVE AL-UABON               TO BCERTNOA.
 10742     MOVE AL-UNBON               TO BEFFDTA.
 10743
 10744     MOVE 1                      TO EMI-SUB
 10745                                    EMI-SWITCH1
 10746                                    EMI-SWITCH-AREA-1
 10747                                    EMI-SWITCH-AREA-2.
 10748
 10749     MOVE SPACES                 TO EMI-ERROR-LINES.
 10750
 10751
 10752* EXEC CICS SYNCPOINT ROLLBACK
 10753*    END-EXEC.
 10754*    MOVE '6"R                   !   #00010500' TO DFHEIV0
 10755     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10757     MOVE X'2020233030303130353030' TO DFHEIV0(25:11)
 10758     CALL 'kxdfhei1' USING DFHEIV0
 10759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10760
 10761
 10762     MOVE ER-2247                TO EMI-ERROR.
 10763     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10764     GO TO 8200-SEND-DATAONLY.
 10765
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 199
* VP6311.cbl
 10767
 10768
 10769 1295-READ-CERT-TRAILER.
 10770
 10771
 10772* EXEC CICS GETMAIN
 10773*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10774*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10775*        INITIMG (GETMAIN-SPACE)
 10776*    END-EXEC
 10777*    MOVE ',"IL                  $   #00010512' TO DFHEIV0
 10778     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10779     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10780     MOVE X'2020233030303130353132' TO DFHEIV0(25:11)
 10781     CALL 'kxdfhei1' USING DFHEIV0,
 10782           DFHEIV20,
 10783           ELCRTT-RECORD-LENGTH,
 10784           GETMAIN-SPACE
 10785     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 10786         DFHEIV20
 10787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10788
 10789     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 10790     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 10791     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 10792
 10793
 10794* EXEC CICS HANDLE CONDITION
 10795*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 10796*    END-EXEC.
 10797*    MOVE '"$I                   ! % #00010522' TO DFHEIV0
 10798     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10799     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10800     MOVE X'2520233030303130353232' TO DFHEIV0(25:11)
 10801     CALL 'kxdfhei1' USING DFHEIV0
 10802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10803
 10804
 10805
 10806* EXEC CICS READ
 10807*        DATASET  (CRTT-ID)
 10808*        RIDFLD   (ELCRTT-KEY)
 10809*        INTO     (CERTIFICATE-TRAILERS)
 10810*    END-EXEC.
 10811     MOVE LENGTH OF
 10812      CERTIFICATE-TRAILERS
 10813       TO DFHEIV11
 10814*    MOVE '&"IL       E          (   #00010526' TO DFHEIV0
 10815     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10816     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10817     MOVE X'2020233030303130353236' TO DFHEIV0(25:11)
 10818     CALL 'kxdfhei1' USING DFHEIV0,
 10819           CRTT-ID,
 10820           CERTIFICATE-TRAILERS,
 10821           DFHEIV11,
 10822           ELCRTT-KEY,
 10823           DFHEIV99,
 10824           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 200
* VP6311.cbl
 10825           DFHEIV99
 10826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10827
 10828
 10829     GO TO 1295-EXIT.
 10830
 10831 1295-CERT-TRL-REC-NOTFND.
 10832     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 10833
 10834 1295-EXIT.
 10835     EXIT.
 10836
 10837******************************************************************
 10838*                                                                *
 10839*          C H A N G E   I S S U E   R O U T I N E               *
 10840*                                                                *
 10841******************************************************************
 10842
 10843***************************************************************
 10844*                                                             *
 10845*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 10846*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10847*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 10848*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 10849*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 10850*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 10851*     5. LINK TO THE EDIT ROUTINE.                            *
 10852*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10853*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 10854*              THE EDIT ROUTINE.                              *
 10855*     7. REWRITE THE NEW ISSUE                                *
 10856*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10857*                                                             *
 10858***************************************************************
 10859
 10860 1300-CHANGE-ISSUE-ROUTINE.
 10861     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 10862
 10863     IF BCHGL NOT = ZEROS
 10864        MOVE ER-2196             TO EMI-ERROR
 10865        MOVE AL-UABON            TO BMAINTA
 10866        MOVE -1                  TO BMAINTL
 10867        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10868        GO TO 8200-SEND-DATAONLY.
 10869
 10870     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10871
 10872     IF BSUFIXL NOT = ZEROS
 10873        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10874     ELSE
 10875        MOVE SPACE               TO WS-NEW-SUFFIX.
 10876
 10877     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10878     PERFORM 8600-DEEDIT.
 10879     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10880     MOVE '4'                    TO DC-OPTION-CODE.
 10881     PERFORM 9700-DATE-LINK.
 10882     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 201
* VP6311.cbl
 10883        MOVE ER-0348             TO EMI-ERROR
 10884        MOVE -1                  TO BEFFDTL
 10885        MOVE AL-UABON            TO BEFFDTA
 10886        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10887        GO TO 8200-SEND-DATAONLY
 10888     ELSE
 10889        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10890        MOVE AL-UANON            TO BEFFDTA
 10891        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10892
 10893 1325-PROCESS-ISSUE-CHANGES.
 10894
 10895* EXEC CICS HANDLE CONDITION
 10896*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 10897*    END-EXEC.
 10898*    MOVE '"$I                   ! & #00010597' TO DFHEIV0
 10899     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10900     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10901     MOVE X'2620233030303130353937' TO DFHEIV0(25:11)
 10902     CALL 'kxdfhei1' USING DFHEIV0
 10903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10904
 10905
 10906     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 10907     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 10908     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 10909
 10910
 10911* EXEC CICS GETMAIN
 10912*        SET      (ADDRESS OF PENDING-BUSINESS)
 10913*        LENGTH   (ERPNDB-RECORD-LENGTH)
 10914*        INITIMG  (GETMAIN-SPACE)
 10915*     END-EXEC.
 10916*    MOVE ',"IL                  $   #00010605' TO DFHEIV0
 10917     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10918     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10919     MOVE X'2020233030303130363035' TO DFHEIV0(25:11)
 10920     CALL 'kxdfhei1' USING DFHEIV0,
 10921           DFHEIV20,
 10922           ERPNDB-RECORD-LENGTH,
 10923           GETMAIN-SPACE
 10924     SET ADDRESS OF PENDING-BUSINESS TO
 10925         DFHEIV20
 10926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10927
 10928
 10929
 10930* EXEC CICS READ
 10931*        INTO    (PENDING-BUSINESS)
 10932*        DATASET (FILE-ID-ERPNDB)
 10933*        RIDFLD  (ERPNDB-KEY)
 10934*    END-EXEC.
 10935     MOVE LENGTH OF
 10936      PENDING-BUSINESS
 10937       TO DFHEIV11
 10938*    MOVE '&"IL       E          (   #00010611' TO DFHEIV0
 10939     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10940     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 202
* VP6311.cbl
 10941     MOVE X'2020233030303130363131' TO DFHEIV0(25:11)
 10942     CALL 'kxdfhei1' USING DFHEIV0,
 10943           FILE-ID-ERPNDB,
 10944           PENDING-BUSINESS,
 10945           DFHEIV11,
 10946           ERPNDB-KEY,
 10947           DFHEIV99,
 10948           DFHEIV99,
 10949           DFHEIV99
 10950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10951
 10952
 10953     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10954
 10955
 10956* EXEC CICS HANDLE CONDITION
 10957*         NOTFND     (1385-REC-NOT-FOUND)
 10958*    END-EXEC.
 10959*    MOVE '"$I                   ! '' #00010619' TO DFHEIV0
 10960     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10961     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10962     MOVE X'2720233030303130363139' TO DFHEIV0(25:11)
 10963     CALL 'kxdfhei1' USING DFHEIV0
 10964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10965
 10966
 10967**********************************************************
 10968*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 10969*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 10970**********************************************************
 10971
 10972
 10973* EXEC CICS READ
 10974*        DATASET (FILE-ID-ERPNDB)
 10975*        INTO    (PENDING-BUSINESS)
 10976*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10977*    END-EXEC.
 10978     MOVE LENGTH OF
 10979      PENDING-BUSINESS
 10980       TO DFHEIV11
 10981*    MOVE '&"IL       E          (   #00010628' TO DFHEIV0
 10982     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10983     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10984     MOVE X'2020233030303130363238' TO DFHEIV0(25:11)
 10985     CALL 'kxdfhei1' USING DFHEIV0,
 10986           FILE-ID-ERPNDB,
 10987           PENDING-BUSINESS,
 10988           DFHEIV11,
 10989           PI-PREV-CONTROL-PRIMARY,
 10990           DFHEIV99,
 10991           DFHEIV99,
 10992           DFHEIV99
 10993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10994
 10995
 10996********** DO NOT ALLOW CHANGES IF THRU A/R
 10997     IF BMAINTI = 'C'
 10998         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 203
* VP6311.cbl
 10999             MOVE ER-4005          TO EMI-ERROR
 11000             MOVE -1               TO BMAINTL
 11001             MOVE AL-UABON         TO BMAINTA
 11002             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11003             GO TO 8200-SEND-DATAONLY.
 11004**********
 11005
 11006     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11007        MOVE -1                 TO BMAINTL
 11008        MOVE ER-2197            TO EMI-ERROR
 11009        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11010        GO TO 8200-SEND-DATAONLY.
 11011
 11012     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11013        MOVE ER-2196             TO EMI-ERROR
 11014        MOVE AL-UABON            TO BMAINTA
 11015        MOVE -1                  TO BMAINTL
 11016        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11017        GO TO 8200-SEND-DATAONLY.
 11018
 11019     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11020
 11021     IF PB-BILLED-DT = LOW-VALUES AND
 11022        PB-CHG-COUNT = ZEROS
 11023        NEXT SENTENCE
 11024     ELSE
 11025        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11026            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11027           OR
 11028           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11029            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11030           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11031     move zeros                  to ws-check-amts
 11032     move ' '                    to ws-stop-sw
 11033                                    ws-check-sw
 11034                                    ws-proc-check-sw
 11035                                    ws-chek-browse-sw
 11036
 11037     perform 2500-browse-checks  thru 2500-exit
 11038
 11039     if i-have-processed-checks
 11040        or i-have-checks
 11041        continue
 11042     else
 11043        go to 1330-continue
 11044     end-if
 11045
 11046     compute ws-tot-orig-prem =
 11047        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11048        pb-i-lf-alt-premium-amt
 11049
 11050     if bprem1l <> zeros
 11051        MOVE AL-UNNON            TO bprem1a
 11052        move ws-bprem (1)        to ws-new-iss-total
 11053     else
 11054        move pb-i-lf-premium-amt to ws-new-iss-total
 11055     end-if
 11056     display ' new iss totala ' ws-new-iss-total
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 204
* VP6311.cbl
 11057
 11058     if baltpr1l <> zeros
 11059        MOVE AL-UNNON            TO baltpr1a
 11060        compute ws-new-iss-total =
 11061           ws-new-iss-total + ws-balt-prem(1)
 11062     else
 11063        compute ws-new-iss-total =
 11064           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11065     end-if
 11066
 11067     if bprem2l <> zeros
 11068        MOVE AL-UNNON            TO bprem2a
 11069        compute ws-new-iss-total = ws-new-iss-total +
 11070           ws-bprem (2)
 11071     else
 11072        compute ws-new-iss-total = ws-new-iss-total +
 11073           pb-i-ah-premium-amt
 11074     end-if
 11075
 11076     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11077        if ((bprem1l <> zeros)
 11078           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11079                      or
 11080           ((bprem2l <> zeros)
 11081           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11082           move er-3456          to emi-error
 11083           perform 9900-error-format
 11084                                 thru 9900-exit
 11085           go to 1330-continue
 11086        end-if
 11087     end-if
 11088
 11089     if ws-new-iss-total > ws-tot-orig-prem
 11090        move er-3458             to emi-error
 11091        perform 9900-error-format thru 9900-exit
 11092        move al-uabon            to bmainta
 11093        move -1                  to bmaintl
 11094        go to 8200-send-dataonly
 11095     end-if
 11096
 11097     if ws-new-iss-total < ws-tot-orig-prem
 11098        move er-3457             to emi-error
 11099        move al-uabon            to bprem1a
 11100                                    bprem2a
 11101        move +0 to bprem1l bprem2l
 11102        perform 9900-error-format thru 9900-exit
 11103        move -1                  to bmaintl
 11104        go to 1330-continue
 11105     end-if
 11106
 11107     .
 11108 1330-continue.
 11109
 11110
 11111* EXEC CICS READ
 11112*        DATASET (FILE-ID-ERPNDB)
 11113*        INTO    (PENDING-BUSINESS)
 11114*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 205
* VP6311.cbl
 11115*        UPDATE
 11116*    END-EXEC.
 11117     MOVE LENGTH OF
 11118      PENDING-BUSINESS
 11119       TO DFHEIV11
 11120*    MOVE '&"IL       EU         (   #00010748' TO DFHEIV0
 11121     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11122     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11123     MOVE X'2020233030303130373438' TO DFHEIV0(25:11)
 11124     CALL 'kxdfhei1' USING DFHEIV0,
 11125           FILE-ID-ERPNDB,
 11126           PENDING-BUSINESS,
 11127           DFHEIV11,
 11128           PI-PREV-CONTROL-PRIMARY,
 11129           DFHEIV99,
 11130           DFHEIV99,
 11131           DFHEIV99
 11132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11133
 11134
 11135     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11136     MOVE 'B'                    TO JP-RECORD-TYPE
 11137     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11138     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11139
 11140     PERFORM 8400-LOG-JOURNAL-RECORD.
 11141
 11142     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11143        PB-CHG-COUNT NOT = ZEROS
 11144        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11145            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11146           OR
 11147           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11148            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11149            MOVE LOW-VALUES             TO PB-BILLED-DT
 11150            ADD +1                      TO PB-CHG-COUNT.
 11151
 11152     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11153     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11154     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11155     MOVE '5'                    TO DC-OPTION-CODE.
 11156     PERFORM 9700-DATE-LINK
 11157     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11158
 11159*    IF BMICRNOL  GREATER  ZEROS
 11160*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11161
 11162     IF BVINL > ZEROS
 11163        MOVE BVINI               TO PB-I-VIN
 11164     END-IF
 11165     IF (BFORCEL NOT = ZEROS)
 11166        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11167        AND (BFORCEI = ' ')
 11168        AND (PB-FORCE-CODE = 'O')
 11169        COMPUTE PB-I-AH-PREMIUM-AMT =
 11170           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11171        PERFORM 1800-REMOVE-CERT-NOTES
 11172                                 THRU 1800-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 206
* VP6311.cbl
 11173        PERFORM 1900-DELETE-ERPYAJ
 11174                                 THRU 1900-EXIT
 11175        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11176     END-IF
 11177     IF (BFORCEL NOT = ZEROS)
 11178        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11179        AND (BFORCEI = 'O')
 11180        AND (PB-FORCE-CODE NOT = 'O')
 11181        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11182           PB-I-AH-PREM-CALC
 11183        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11184        MOVE SPACE               TO DC-OPTION-CODE
 11185        PERFORM 9700-DATE-LINK
 11186        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11187        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11188        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11189        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11190        PERFORM 1500-UPDATE-ERNOTE
 11191                                 THRU 1500-EXIT
 11192        PERFORM 1600-UPDATE-ERPYAJ
 11193                                 THRU 1600-EXIT
 11194     END-IF
 11195     IF BLSTNML  GREATER THAN ZEROS
 11196         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11197
 11198     IF B1STNML  GREATER THAN ZEROS
 11199         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11200
 11201     IF BINITL   GREATER THAN ZEROS
 11202         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11203
 11204     IF BBIRTHL  GREATER THAN ZERO
 11205         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11206
 11207
 11208     IF BAGEL    GREATER THAN ZEROS
 11209         MOVE BAGEI              TO PB-I-AGE.
 11210
 11211     MOVE 'N'                    TO WS-INS-AGE-SET
 11212                                    WS-JNT-AGE-SET.
 11213     IF BAGEL    GREATER THAN ZEROS
 11214        MOVE 'Y'                TO WS-INS-AGE-SET
 11215        IF BAGEI = ZERO AND
 11216             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11217           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11218           MOVE 'AGE*'          TO BAGEDEFO
 11219        ELSE
 11220           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11221           MOVE 'AGE '          TO BAGEDEFO
 11222        END-IF
 11223        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11224     END-IF.
 11225     if (byearl      <> zeros)
 11226        or (bmakel   <> zeros)
 11227        or (bmodell  <> zeros)
 11228        or (bometerl <> zeros)
 11229        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11230                                 TO ELCRTT-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 207
* VP6311.cbl
 11231        MOVE 'C'                 TO ELCRTT-REC-TYPE
 11232        perform 1390-read-elcrtt-update
 11233                                 thru 1390-exit
 11234        if resp-normal
 11235           perform 1391-rewrite-elcrtt
 11236                                 thru 1391-exit
 11237        else
 11238           if resp-notfnd
 11239              perform 1392-write-elcrtt
 11240                                 thru 1392-exit
 11241           end-if
 11242        end-if
 11243     end-if
 11244     IF BSEXL    GREATER THAN ZEROS
 11245         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11246
 11247     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11248        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11249
 11250     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11251        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11252
 11253
 11254
 11255     IF BSKPCDL  GREATER THAN ZEROS
 11256         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11257
 11258
 11259
 11260
 11261     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11262         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11263
 11264     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11265         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11266
 11267     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11268
 11269     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11270         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11271            SUBTRACT PB-I-LF-PREMIUM-AMT
 11272                     FROM WS-B-LF-ISS-PRM-ENTERED
 11273            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11274            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11275            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11276         ELSE
 11277            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11278*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11279*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11280         END-IF
 11281     END-IF.
 11282
 11283     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11284            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11285                     FROM WS-B-LF-ISS-PRM-ENTERED
 11286         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11287         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11288
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 208
* VP6311.cbl
 11289     IF  BALT-PREM-LEN     (2)  > ZEROS
 11290         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11291
 11292     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11293         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11294
 11295     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11296         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11297            SUBTRACT PB-I-AH-PREMIUM-AMT
 11298                     FROM WS-B-AH-ISS-PRM-ENTERED
 11299            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11300            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11301            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11302         ELSE
 11303            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11304*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11305*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11306         END-IF
 11307     END-IF
 11308
 11309     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11310        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11311
 11312     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11313        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11314
 11315     IF BINDGRPL            GREATER THAN ZEROS
 11316         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11317
 11318     IF BRTCLSL             GREATER THAN ZEROS
 11319         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11320
 11321     IF BSIGL               GREATER THAN ZEROS
 11322         MOVE BSIGI              TO PB-I-SIG-SW.
 11323
 11324
 11325     IF BMEMBERL            GREATER THAN ZEROS
 11326         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11327
 11328     IF BLNOFCRL            GREATER THAN ZEROS
 11329         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11330
 11331     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11332        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11333
 11334     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11335        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11336
 11337
 11338     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11339        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11340           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11341
 11342     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11343        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11344           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11345
 11346
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 209
* VP6311.cbl
 11347     IF PB-EXT-DAYS-PROCESSING
 11348        IF PB-I-EXTENTION-DAYS = ZEROS
 11349           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11350
 11351     IF PB-EXPIRE-DT-PROCESSING
 11352        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11353           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11354             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11355
 11356     IF PB-1ST-PMT-DT-PROCESSING
 11357        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11358           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11359
 11360     IF BREINL GREATER THAN ZEROS
 11361        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11362
 11363     IF BFORCEL NOT = ZEROS
 11364        MOVE BFORCEI             TO PB-FORCE-CODE.
 11365     IF (BENTRYL NOT = ZEROS)
 11366        AND (PB-COMPANY-ID = 'CID')
 11367        AND (PB-STATE = 'VA')
 11368        AND (BENTRYI NOT = 'P')
 11369        AND (PB-BATCH-ENTRY = 'P')
 11370        PERFORM 1800-REMOVE-CERT-NOTES
 11371                                 THRU 1800-EXIT
 11372     END-IF
 11373     IF BENTRYL NOT = ZEROS
 11374        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11375        IF PI-COMPANY-ID = 'CID'
 11376           AND (PB-BATCH-ENTRY = 'P')
 11377           AND (PB-STATE = 'VA')
 11378           PERFORM 1500-UPDATE-ERNOTE
 11379                                 THRU 1500-EXIT
 11380        END-IF
 11381     END-IF
 11382
 11383     IF BUNWRITL NOT = ZEROS
 11384        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11385
 11386     IF BBILCDL NOT = ZEROS
 11387        MOVE BBILCDI             TO PB-RECORD-BILL.
 11388
 11389
 11390
 11391
 11392
 11393*****************************************************************
 11394*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11395*****************************************************************
 11396
 11397     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11398        IF BTYPE  (1)   = ZEROS OR SPACES
 11399           IF REMOVE-LF-COVERAGE
 11400               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11401                                        PI-BTYPE (1)
 11402               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11403                                        WS-B-LF-ISS-PRM-ENTERED
 11404               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 210
* VP6311.cbl
 11405                                        WS-B-LF-ISS-PRM-ENTERED
 11406               SUBTRACT PB-I-LF-PREM-CALC FROM
 11407                                        WS-B-LF-ISS-PRM-COMPUTED
 11408               MOVE ZEROS            TO PB-I-LF-TERM
 11409                                        PB-I-LF-BENEFIT-AMT
 11410                                        PB-I-LF-PREMIUM-AMT
 11411                                        PB-I-LF-BENEFIT-CD
 11412                                        PB-I-LF-PREM-CALC
 11413                                        PB-I-LF-CRIT-PER
 11414                                        PB-I-LF-ALT-BENEFIT-AMT
 11415                                        PB-I-LF-ALT-PREMIUM-AMT
 11416               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11417           ELSE
 11418               NEXT SENTENCE
 11419        ELSE
 11420           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11421                                    PI-BTYPE (1).
 11422     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11423        IF BTYPE  (2)   = ZEROS OR SPACES
 11424           IF  REMOVE-AH-COVERAGE
 11425               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11426                                        PI-BTYPE (2)
 11427               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11428                                        WS-B-AH-ISS-PRM-ENTERED
 11429               SUBTRACT PB-I-AH-PREM-CALC FROM
 11430                                        WS-B-AH-ISS-PRM-COMPUTED
 11431               MOVE ZEROS            TO PB-I-AH-TERM
 11432                                        PB-I-AH-BENEFIT-AMT
 11433                                        PB-I-AH-PREMIUM-AMT
 11434                                        PB-I-AH-BENEFIT-CD
 11435                                        PB-I-AH-PREM-CALC
 11436                                        PB-I-AH-CRIT-PER
 11437               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11438           ELSE
 11439               NEXT SENTENCE
 11440        ELSE
 11441           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11442                                    PI-BTYPE (2).
 11443 1360-REWRITE-PB-RECORD.
 11444     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11445
 11446     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11447     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11448
 11449     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11450
 11451     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11452     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11453
 11454     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11455         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11456
 11457     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11458         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11459
 11460     PERFORM 1398-UPDATE-ERPNDM THRU 1398-EXIT.
 11461
 11462     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 211
* VP6311.cbl
 11463
 11464     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11465
 11466     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11467     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11468     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11469
 11470     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11471     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11472
 11473 1375-REWRITE-PB-RECORD.
 11474     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11475     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11476     MOVE 'C'                    TO JP-RECORD-TYPE.
 11477     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11478
 11479
 11480* EXEC CICS REWRITE
 11481*        DATASET (FILE-ID-ERPNDB)
 11482*        FROM    (PENDING-BUSINESS)
 11483*    END-EXEC.
 11484     MOVE LENGTH OF
 11485      PENDING-BUSINESS
 11486       TO DFHEIV11
 11487*    MOVE '&& L                  %   #00011099' TO DFHEIV0
 11488     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11489     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11490     MOVE X'2020233030303131303939' TO DFHEIV0(25:11)
 11491     CALL 'kxdfhei1' USING DFHEIV0,
 11492           FILE-ID-ERPNDB,
 11493           PENDING-BUSINESS,
 11494           DFHEIV11,
 11495           DFHEIV99
 11496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11497
 11498
 11499     PERFORM 8400-LOG-JOURNAL-RECORD.
 11500******************************************************************
 11501*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11502******************************************************************
 11503     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11504     MOVE ' '                    TO WS-ERMAIL-SW
 11505
 11506* EXEC CICS READ
 11507*       DATASET   (FILE-ID-ERMAIL)
 11508*       SET       (ADDRESS OF MAILING-DATA)
 11509*       RIDFLD    (ERMAIL-KEY)
 11510*       RESP      (WS-RESPONSE)
 11511*    END-EXEC
 11512*    MOVE '&"S        E          (  N#00011110' TO DFHEIV0
 11513     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11514     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11515     MOVE X'204E233030303131313130' TO DFHEIV0(25:11)
 11516     CALL 'kxdfhei1' USING DFHEIV0,
 11517           FILE-ID-ERMAIL,
 11518           DFHEIV20,
 11519           DFHEIV99,
 11520           ERMAIL-KEY,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 212
* VP6311.cbl
 11521           DFHEIV99,
 11522           DFHEIV99,
 11523           DFHEIV99
 11524     SET ADDRESS OF MAILING-DATA TO
 11525         DFHEIV20
 11526     MOVE EIBRESP  TO WS-RESPONSE
 11527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11528     IF RESP-NORMAL
 11529        SET ERMAIL-FOUND TO TRUE
 11530     END-IF
 11531
 11532     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11533     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11534                                 TO ELCRTO-KEY
 11535     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11536     MOVE +0                     TO ELCRTO-SEQ-NO
 11537
 11538* EXEC CICS READ
 11539*       DATASET   ('ELCRTO')
 11540*       INTO      (ORIGINAL-CERTIFICATE)
 11541*       RIDFLD    (ELCRTO-KEY)
 11542*       GTEQ
 11543*       RESP      (WS-RESPONSE)
 11544*    END-EXEC
 11545     MOVE LENGTH OF
 11546      ORIGINAL-CERTIFICATE
 11547       TO DFHEIV11
 11548     MOVE 'ELCRTO' TO DFHEIV1
 11549*    MOVE '&"IL       G          (  N#00011125' TO DFHEIV0
 11550     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11551     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11552     MOVE X'204E233030303131313235' TO DFHEIV0(25:11)
 11553     CALL 'kxdfhei1' USING DFHEIV0,
 11554           DFHEIV1,
 11555           ORIGINAL-CERTIFICATE,
 11556           DFHEIV11,
 11557           ELCRTO-KEY,
 11558           DFHEIV99,
 11559           DFHEIV99,
 11560           DFHEIV99
 11561     MOVE EIBRESP  TO WS-RESPONSE
 11562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11563*    display ' just read gteq ' ws-response
 11564     IF RESP-NORMAL
 11565        AND (OC-CONTROL-PRIMARY (1:33) =
 11566                 PB-CONTROL-BY-ACCOUNT (1:33))
 11567        AND (OC-RECORD-TYPE = 'I')
 11568        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11569           display ' csr edit session ' PI-CSR-SESSION-SW
 11570           IF NOT CSR-EDIT-SESSION
 11571
 11572* EXEC CICS READ
 11573*                DATASET   ('ELCRTO')
 11574*                INTO      (ORIGINAL-CERTIFICATE)
 11575*                RIDFLD    (OC-CONTROL-PRIMARY)
 11576*                UPDATE
 11577*                RESP      (WS-RESPONSE)
 11578*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 213
* VP6311.cbl
 11579     MOVE LENGTH OF
 11580      ORIGINAL-CERTIFICATE
 11581       TO DFHEIV11
 11582     MOVE 'ELCRTO' TO DFHEIV1
 11583*    MOVE '&"IL       EU         (  N#00011142' TO DFHEIV0
 11584     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11585     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11586     MOVE X'204E233030303131313432' TO DFHEIV0(25:11)
 11587     CALL 'kxdfhei1' USING DFHEIV0,
 11588           DFHEIV1,
 11589           ORIGINAL-CERTIFICATE,
 11590           DFHEIV11,
 11591           OC-CONTROL-PRIMARY,
 11592           DFHEIV99,
 11593           DFHEIV99,
 11594           DFHEIV99
 11595     MOVE EIBRESP  TO WS-RESPONSE
 11596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11597              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11598              IF RESP-NORMAL
 11599                 display ' good read upd '
 11600                 MOVE PB-I-INSURED-LAST-NAME TO
 11601                         OC-INS-LAST-NAME
 11602                 MOVE PB-I-INSURED-FIRST-NAME TO
 11603                         OC-INS-FIRST-NAME
 11604                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11605                         OC-INS-MIDDLE-INIT
 11606                 MOVE PB-I-AGE         TO OC-INS-AGE
 11607                 MOVE PB-I-JOINT-LAST-NAME   TO
 11608                         OC-JNT-LAST-NAME
 11609                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11610                         OC-JNT-FIRST-NAME
 11611                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11612                         OC-JNT-MIDDLE-INIT
 11613                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11614                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11615                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11616                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11617                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11618                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11619                         OC-LF-ALT-BEN-AMT
 11620                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11621                         OC-LF-ALT-PRM-AMT
 11622                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11623                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11624                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11625                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11626                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11627                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11628                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11629                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11630                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11631                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11632                 IF OC-CANCEL-TRAN-IND = 'N'
 11633                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11634                    MOVE +0            TO OC-LF-CANCEL-AMT
 11635                                          OC-LF-ITD-CANCEL-AMT
 11636                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 214
* VP6311.cbl
 11637                    MOVE +0            TO OC-AH-CANCEL-AMT
 11638                                          OC-AH-ITD-CANCEL-AMT
 11639                 END-IF
 11640                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11641                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11642                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11643                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11644                 IF ERMAIL-FOUND
 11645                    MOVE MA-CRED-BENE-NAME
 11646                                 TO OC-CRED-BENE-NAME
 11647                 END-IF
 11648                 IF NOT CERT-TRL-REC-NOT-FOUND
 11649                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11650                           OC-INS-AGE-DEFAULT-FLAG
 11651                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11652                           OC-JNT-AGE-DEFAULT-FLAG
 11653                 END-IF
 11654
 11655* EXEC CICS REWRITE
 11656*                   DATASET   ('ELCRTO')
 11657*                   FROM      (ORIGINAL-CERTIFICATE)
 11658*                   RESP      (WS-RESPONSE)
 11659*                END-EXEC
 11660     MOVE LENGTH OF
 11661      ORIGINAL-CERTIFICATE
 11662       TO DFHEIV11
 11663     MOVE 'ELCRTO' TO DFHEIV1
 11664*    MOVE '&& L                  %  N#00011206' TO DFHEIV0
 11665     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11666     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11667     MOVE X'204E233030303131323036' TO DFHEIV0(25:11)
 11668     CALL 'kxdfhei1' USING DFHEIV0,
 11669           DFHEIV1,
 11670           ORIGINAL-CERTIFICATE,
 11671           DFHEIV11,
 11672           DFHEIV99
 11673     MOVE EIBRESP  TO WS-RESPONSE
 11674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11675                 display ' just rewrote ' ws-response
 11676              END-IF
 11677           END-IF
 11678        ELSE
 11679           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11680           MOVE 'OC'             TO OC-RECORD-ID
 11681           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11682           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11683           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11684           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11685           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11686           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11687           MOVE PB-I-AGE         TO OC-INS-AGE
 11688           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11689           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11690           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11691           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11692           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11693           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11694           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 215
* VP6311.cbl
 11695           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11696           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11697           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11698           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11699           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11700           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11701           MOVE +0               TO OC-LF-CANCEL-AMT
 11702                                    OC-LF-ITD-CANCEL-AMT
 11703           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11704           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11705           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11706           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11707           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11708           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11709           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11710           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11711           MOVE +0               TO OC-AH-CANCEL-AMT
 11712                                    OC-AH-ITD-CANCEL-AMT
 11713           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11714           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11715           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11716           IF ERMAIL-FOUND
 11717              MOVE MA-CRED-BENE-NAME
 11718                                 TO OC-CRED-BENE-NAME
 11719           END-IF
 11720           IF NOT CERT-TRL-REC-NOT-FOUND
 11721              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11722                           OC-INS-AGE-DEFAULT-FLAG
 11723              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11724                           OC-JNT-AGE-DEFAULT-FLAG
 11725           END-IF
 11726           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11727
 11728* EXEC CICS WRITE
 11729*             DATASET   ('ELCRTO')
 11730*             FROM      (ORIGINAL-CERTIFICATE)
 11731*             RIDFLD    (OC-CONTROL-PRIMARY)
 11732*             RESP      (WS-RESPONSE)
 11733*          END-EXEC
 11734     MOVE LENGTH OF
 11735      ORIGINAL-CERTIFICATE
 11736       TO DFHEIV11
 11737     MOVE 'ELCRTO' TO DFHEIV1
 11738*    MOVE '&$ L                  ''  N#00011263' TO DFHEIV0
 11739     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11740     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11741     MOVE X'204E233030303131323633' TO DFHEIV0(25:11)
 11742     CALL 'kxdfhei1' USING DFHEIV0,
 11743           DFHEIV1,
 11744           ORIGINAL-CERTIFICATE,
 11745           DFHEIV11,
 11746           OC-CONTROL-PRIMARY,
 11747           DFHEIV99,
 11748           DFHEIV99
 11749     MOVE EIBRESP  TO WS-RESPONSE
 11750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11751        END-IF
 11752     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 216
* VP6311.cbl
 11753        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11754        MOVE 'OC'                TO OC-RECORD-ID
 11755        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11756                                 TO OC-CONTROL-PRIMARY (1:33)
 11757        MOVE 'I'                 TO OC-RECORD-TYPE
 11758        MOVE +4096               TO OC-KEY-SEQ-NO
 11759        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11760        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 11761        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11762        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11763        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11764        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11765        MOVE PB-I-AGE            TO OC-INS-AGE
 11766        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11767        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11768        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11769        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11770        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11771        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11772        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11773        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11774        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11775        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11776        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11777        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11778        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11779        MOVE +0                  TO OC-LF-CANCEL-AMT
 11780                                    OC-LF-ITD-CANCEL-AMT
 11781        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11782        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11783        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11784        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11785        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11786        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11787        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11788        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11789        MOVE +0                  TO OC-AH-CANCEL-AMT
 11790                                    OC-AH-ITD-CANCEL-AMT
 11791        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11792        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11793        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11794        IF ERMAIL-FOUND
 11795           MOVE MA-CRED-BENE-NAME
 11796                                 TO OC-CRED-BENE-NAME
 11797        END-IF
 11798        IF NOT CERT-TRL-REC-NOT-FOUND
 11799           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11800                           OC-INS-AGE-DEFAULT-FLAG
 11801           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11802                           OC-JNT-AGE-DEFAULT-FLAG
 11803        END-IF
 11804        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11805
 11806* EXEC CICS WRITE
 11807*          DATASET   ('ELCRTO')
 11808*          FROM      (ORIGINAL-CERTIFICATE)
 11809*          RIDFLD    (OC-CONTROL-PRIMARY)
 11810*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 217
* VP6311.cbl
 11811*       END-EXEC
 11812     MOVE LENGTH OF
 11813      ORIGINAL-CERTIFICATE
 11814       TO DFHEIV11
 11815     MOVE 'ELCRTO' TO DFHEIV1
 11816*    MOVE '&$ L                  ''  N#00011323' TO DFHEIV0
 11817     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11818     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11819     MOVE X'204E233030303131333233' TO DFHEIV0(25:11)
 11820     CALL 'kxdfhei1' USING DFHEIV0,
 11821           DFHEIV1,
 11822           ORIGINAL-CERTIFICATE,
 11823           DFHEIV11,
 11824           OC-CONTROL-PRIMARY,
 11825           DFHEIV99,
 11826           DFHEIV99
 11827     MOVE EIBRESP  TO WS-RESPONSE
 11828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11829     END-IF
 11830******************************************************************
 11831*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11832******************************************************************
 11833
 11834     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11835     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11836
 11837
 11838* EXEC CICS READ
 11839*        INTO    (PENDING-BUSINESS)
 11840*        DATASET (FILE-ID-ERPNDB)
 11841*        RIDFLD  (ERPNDB-KEY)
 11842*        UPDATE
 11843*    END-EXEC.
 11844     MOVE LENGTH OF
 11845      PENDING-BUSINESS
 11846       TO DFHEIV11
 11847*    MOVE '&"IL       EU         (   #00011337' TO DFHEIV0
 11848     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11849     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11850     MOVE X'2020233030303131333337' TO DFHEIV0(25:11)
 11851     CALL 'kxdfhei1' USING DFHEIV0,
 11852           FILE-ID-ERPNDB,
 11853           PENDING-BUSINESS,
 11854           DFHEIV11,
 11855           ERPNDB-KEY,
 11856           DFHEIV99,
 11857           DFHEIV99,
 11858           DFHEIV99
 11859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11860
 11861
 11862     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 11863     MOVE 'B'                    TO JP-RECORD-TYPE.
 11864     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11865
 11866     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11867
 11868     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 218
* VP6311.cbl
 11869
 11870     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 11871
 11872     MOVE 'C'                    TO JP-RECORD-TYPE.
 11873     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11874
 11875
 11876* EXEC CICS REWRITE
 11877*        DATASET    (FILE-ID-ERPNDB)
 11878*        FROM       (PENDING-BUSINESS)
 11879*    END-EXEC.
 11880     MOVE LENGTH OF
 11881      PENDING-BUSINESS
 11882       TO DFHEIV11
 11883*    MOVE '&& L                  %   #00011357' TO DFHEIV0
 11884     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11885     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11886     MOVE X'2020233030303131333537' TO DFHEIV0(25:11)
 11887     CALL 'kxdfhei1' USING DFHEIV0,
 11888           FILE-ID-ERPNDB,
 11889           PENDING-BUSINESS,
 11890           DFHEIV11,
 11891           DFHEIV99
 11892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11893
 11894
 11895     PERFORM 8400-LOG-JOURNAL-RECORD.
 11896
 11897     IF WS-ERRORS-PRESENT
 11898        GO TO 3900-RE-DISPLAY-RECORD.
 11899
 11900     MOVE ZEROS                  TO EMI-ERROR.
 11901     MOVE -1                     TO BMAINTL.
 11902     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11903     GO TO 3900-RE-DISPLAY-RECORD.
 11904
 11905 1380-BATCH-HDR-NOT-FOUND.
 11906     MOVE -1                     TO BMAINTL.
 11907     MOVE ER-7450                TO EMI-ERROR.
 11908     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11909     GO TO 8200-SEND-DATAONLY.
 11910
 11911 1385-REC-NOT-FOUND.
 11912     MOVE -1                     TO BMAINTL.
 11913     MOVE ER-7451                TO EMI-ERROR.
 11914     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11915     GO TO 8200-SEND-DATAONLY.
 11916
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 219
* VP6311.cbl
 11918
 11919
 11920 1386-UPDATE-AGE-FLAGS.
 11921
 11922
 11923* EXEC CICS GETMAIN
 11924*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11925*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11926*        INITIMG (GETMAIN-SPACE)
 11927*    END-EXEC
 11928*    MOVE ',"IL                  $   #00011389' TO DFHEIV0
 11929     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11930     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11931     MOVE X'2020233030303131333839' TO DFHEIV0(25:11)
 11932     CALL 'kxdfhei1' USING DFHEIV0,
 11933           DFHEIV20,
 11934           ELCRTT-RECORD-LENGTH,
 11935           GETMAIN-SPACE
 11936     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11937         DFHEIV20
 11938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11939
 11940
 11941* EXEC CICS HANDLE CONDITION
 11942*        NOTFND   (1386-NOTFND)
 11943*    END-EXEC.
 11944*    MOVE '"$I                   ! ( #00011395' TO DFHEIV0
 11945     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11946     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11947     MOVE X'2820233030303131333935' TO DFHEIV0(25:11)
 11948     CALL 'kxdfhei1' USING DFHEIV0
 11949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11950
 11951
 11952     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 11953     MOVE 'C'                TO ELCRTT-REC-TYPE
 11954
 11955
 11956* EXEC CICS READ
 11957*        UPDATE
 11958*        DATASET  (CRTT-ID)
 11959*        RIDFLD   (ELCRTT-KEY)
 11960*        INTO     (CERTIFICATE-TRAILERS)
 11961*    END-EXEC.
 11962     MOVE LENGTH OF
 11963      CERTIFICATE-TRAILERS
 11964       TO DFHEIV11
 11965*    MOVE '&"IL       EU         (   #00011402' TO DFHEIV0
 11966     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11967     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11968     MOVE X'2020233030303131343032' TO DFHEIV0(25:11)
 11969     CALL 'kxdfhei1' USING DFHEIV0,
 11970           CRTT-ID,
 11971           CERTIFICATE-TRAILERS,
 11972           DFHEIV11,
 11973           ELCRTT-KEY,
 11974           DFHEIV99,
 11975           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 220
* VP6311.cbl
 11976           DFHEIV99
 11977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11978
 11979
 11980     IF WS-INS-AGE-SET = 'Y'
 11981        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 11982     END-IF
 11983     IF WS-JNT-AGE-SET = 'Y'
 11984        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 11985     END-IF
 11986
 11987
 11988* EXEC CICS REWRITE
 11989*       DATASET  (CRTT-ID)
 11990*       FROM     (CERTIFICATE-TRAILERS)
 11991*    END-EXEC.
 11992     MOVE LENGTH OF
 11993      CERTIFICATE-TRAILERS
 11994       TO DFHEIV11
 11995*    MOVE '&& L                  %   #00011416' TO DFHEIV0
 11996     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11997     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11998     MOVE X'2020233030303131343136' TO DFHEIV0(25:11)
 11999     CALL 'kxdfhei1' USING DFHEIV0,
 12000           CRTT-ID,
 12001           CERTIFICATE-TRAILERS,
 12002           DFHEIV11,
 12003           DFHEIV99
 12004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12005
 12006
 12007     GO TO 1386-EXIT.
 12008
 12009 1386-NOTFND.
 12010
 12011     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12012     MOVE 'CS'         TO CS-RECORD-ID.
 12013     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12014     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12015     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12016     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12017     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12018
 12019* EXEC CICS WRITE
 12020*       DATASET  (CRTT-ID)
 12021*       RIDFLD   (ELCRTT-KEY)
 12022*       FROM     (CERTIFICATE-TRAILERS)
 12023*    END-EXEC.
 12024     MOVE LENGTH OF
 12025      CERTIFICATE-TRAILERS
 12026       TO DFHEIV11
 12027*    MOVE '&$ L                  ''   #00011432' TO DFHEIV0
 12028     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12029     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12030     MOVE X'2020233030303131343332' TO DFHEIV0(25:11)
 12031     CALL 'kxdfhei1' USING DFHEIV0,
 12032           CRTT-ID,
 12033           CERTIFICATE-TRAILERS,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 221
* VP6311.cbl
 12034           DFHEIV11,
 12035           ELCRTT-KEY,
 12036           DFHEIV99,
 12037           DFHEIV99
 12038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12039
 12040
 12041 1386-EXIT.
 12042     EXIT.
 12043 1390-read-elcrtt-update.
 12044
 12045* EXEC CICS GETMAIN
 12046*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12047*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12048*        INITIMG (GETMAIN-SPACE)
 12049*    END-EXEC
 12050*    MOVE ',"IL                  $   #00011441' TO DFHEIV0
 12051     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12052     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12053     MOVE X'2020233030303131343431' TO DFHEIV0(25:11)
 12054     CALL 'kxdfhei1' USING DFHEIV0,
 12055           DFHEIV20,
 12056           ELCRTT-RECORD-LENGTH,
 12057           GETMAIN-SPACE
 12058     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12059         DFHEIV20
 12060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12061
 12062* EXEC CICS READ
 12063*        UPDATE
 12064*        DATASET  (CRTT-ID)
 12065*        RIDFLD   (ELCRTT-KEY)
 12066*        INTO     (CERTIFICATE-TRAILERS)
 12067*        resp     (ws-response)
 12068*    END-EXEC
 12069     MOVE LENGTH OF
 12070      CERTIFICATE-TRAILERS
 12071       TO DFHEIV11
 12072*    MOVE '&"IL       EU         (  N#00011446' TO DFHEIV0
 12073     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12074     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12075     MOVE X'204E233030303131343436' TO DFHEIV0(25:11)
 12076     CALL 'kxdfhei1' USING DFHEIV0,
 12077           CRTT-ID,
 12078           CERTIFICATE-TRAILERS,
 12079           DFHEIV11,
 12080           ELCRTT-KEY,
 12081           DFHEIV99,
 12082           DFHEIV99,
 12083           DFHEIV99
 12084     MOVE EIBRESP  TO ws-response
 12085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12086     .
 12087 1390-exit.
 12088     exit.
 12089 1391-rewrite-elcrtt.
 12090     perform 1393-update-elcrtt  thru 1393-exit
 12091
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 222
* VP6311.cbl
 12092* EXEC CICS REWRITE
 12093*       DATASET  (CRTT-ID)
 12094*       FROM     (CERTIFICATE-TRAILERS)
 12095*       resp     (ws-response)
 12096*    END-EXEC
 12097     MOVE LENGTH OF
 12098      CERTIFICATE-TRAILERS
 12099       TO DFHEIV11
 12100*    MOVE '&& L                  %  N#00011458' TO DFHEIV0
 12101     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12102     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12103     MOVE X'204E233030303131343538' TO DFHEIV0(25:11)
 12104     CALL 'kxdfhei1' USING DFHEIV0,
 12105           CRTT-ID,
 12106           CERTIFICATE-TRAILERS,
 12107           DFHEIV11,
 12108           DFHEIV99
 12109     MOVE EIBRESP  TO ws-response
 12110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12111     .
 12112 1391-exit.
 12113     exit.
 12114 1392-write-elcrtt.
 12115     move 'CS'                   to certificate-trailers
 12116     move elcrtt-key             to cs-control-primary
 12117     move 'C'                    to cs-trailer-type
 12118     perform 1393-update-elcrtt  thru 1393-exit
 12119
 12120* EXEC CICS WRITE
 12121*       DATASET  (CRTT-ID)
 12122*       ridfld   (elcrtt-key)
 12123*       FROM     (CERTIFICATE-TRAILERS)
 12124*       resp     (ws-response)
 12125*    END-EXEC
 12126     MOVE LENGTH OF
 12127      CERTIFICATE-TRAILERS
 12128       TO DFHEIV11
 12129*    MOVE '&$ L                  ''  N#00011471' TO DFHEIV0
 12130     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12131     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12132     MOVE X'204E233030303131343731' TO DFHEIV0(25:11)
 12133     CALL 'kxdfhei1' USING DFHEIV0,
 12134           CRTT-ID,
 12135           CERTIFICATE-TRAILERS,
 12136           DFHEIV11,
 12137           elcrtt-key,
 12138           DFHEIV99,
 12139           DFHEIV99
 12140     MOVE EIBRESP  TO ws-response
 12141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12142     .
 12143 1392-exit.
 12144     exit.
 12145 1393-update-elcrtt.
 12146     if byearl <> zeros
 12147        move byeari              to cs-year
 12148     end-if
 12149     if bmakel <> zeros
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 223
* VP6311.cbl
 12150        move bmakei              to cs-make
 12151     end-if
 12152     if bmodell <> zeros
 12153        move bmodeli             to cs-model
 12154     end-if
 12155     if bometerl <> zeros
 12156        MOVE Bometeri            TO DEEDIT-FIELD
 12157        PERFORM 8600-DEEDIT
 12158        IF DEEDIT-FIELD-V0 NUMERIC
 12159           MOVE DEEDIT-FIELD-V0  TO cs-vehicle-odometer
 12160        end-if
 12161     end-if
 12162     .
 12163 1393-exit.
 12164     exit.
 12165 1398-UPDATE-ERPNDM.
 12166
 12167
 12168* EXEC CICS HANDLE CONDITION
 12169*        NOTFND (1398-EXIT)
 12170*    END-EXEC.
 12171*    MOVE '"$I                   ! ) #00011502' TO DFHEIV0
 12172     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12173     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12174     MOVE X'2920233030303131353032' TO DFHEIV0(25:11)
 12175     CALL 'kxdfhei1' USING DFHEIV0
 12176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12177
 12178
 12179     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12180
 12181
 12182* EXEC CICS READ
 12183*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12184*        DATASET (FILE-ID-ERPNDM)
 12185*        RIDFLD  (ERPNDM-KEY)
 12186*        UPDATE
 12187*    END-EXEC.
 12188*    MOVE '&"S        EU         (   #00011508' TO DFHEIV0
 12189     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12190     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12191     MOVE X'2020233030303131353038' TO DFHEIV0(25:11)
 12192     CALL 'kxdfhei1' USING DFHEIV0,
 12193           FILE-ID-ERPNDM,
 12194           DFHEIV20,
 12195           DFHEIV99,
 12196           ERPNDM-KEY,
 12197           DFHEIV99,
 12198           DFHEIV99,
 12199           DFHEIV99
 12200     SET ADDRESS OF PENDING-MAILING-DATA TO
 12201         DFHEIV20
 12202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12203
 12204
 12205     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12206     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12207     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 224
* VP6311.cbl
 12208
 12209     IF BLSTNML GREATER THAN ZEROS
 12210         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12211
 12212     IF B1STNML GREATER  THAN ZEROS
 12213         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
 12214
 12215     IF BINITL GREATER THAN ZEROS
 12216         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12217
 12218     IF BAGEL GREATER THAN ZEROS
 12219         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12220
 12221     IF BBIRTHL GREATER THAN ZEROS
 12222         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12223
 12224     IF BSEXL GREATER THAN ZEROS
 12225         MOVE  BSEXI             TO PM-INSURED-SEX.
 12226
 12227
 12228* EXEC CICS REWRITE
 12229*        DATASET (FILE-ID-ERPNDM)
 12230*        FROM    (PENDING-MAILING-DATA)
 12231*    END-EXEC.
 12232     MOVE LENGTH OF
 12233      PENDING-MAILING-DATA
 12234       TO DFHEIV11
 12235*    MOVE '&& L                  %   #00011537' TO DFHEIV0
 12236     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12237     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12238     MOVE X'2020233030303131353337' TO DFHEIV0(25:11)
 12239     CALL 'kxdfhei1' USING DFHEIV0,
 12240           FILE-ID-ERPNDM,
 12241           PENDING-MAILING-DATA,
 12242           DFHEIV11,
 12243           DFHEIV99
 12244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12245
 12246
 12247 1398-EXIT.
 12248     EXIT.
 12249
 12250******************************************************************
 12251*                                                                *
 12252*          D E L E T E   I S S U E   R O U T I N E               *
 12253*                                                                *
 12254******************************************************************
 12255
 12256 1400-DELETE-ISSUE-ROUTINE.
 12257     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12258
 12259     IF BCHGL NOT = ZEROS
 12260        MOVE ER-2196             TO EMI-ERROR
 12261        MOVE AL-UABON            TO BMAINTA
 12262        MOVE -1                  TO BMAINTL
 12263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12264        GO TO 8200-SEND-DATAONLY.
 12265
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 225
* VP6311.cbl
 12266
 12267* EXEC CICS HANDLE CONDITION
 12268*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12269*    END-EXEC.
 12270*    MOVE '"$I                   ! * #00011561' TO DFHEIV0
 12271     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12272     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12273     MOVE X'2A20233030303131353631' TO DFHEIV0(25:11)
 12274     CALL 'kxdfhei1' USING DFHEIV0
 12275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12276
 12277
 12278     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12279     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12280     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12281
 12282
 12283* EXEC CICS READ
 12284*        SET     (ADDRESS OF PENDING-BUSINESS)
 12285*        DATASET (FILE-ID-ERPNDB)
 12286*        RIDFLD  (ERPNDB-KEY)
 12287*    END-EXEC.
 12288*    MOVE '&"S        E          (   #00011569' TO DFHEIV0
 12289     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12290     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12291     MOVE X'2020233030303131353639' TO DFHEIV0(25:11)
 12292     CALL 'kxdfhei1' USING DFHEIV0,
 12293           FILE-ID-ERPNDB,
 12294           DFHEIV20,
 12295           DFHEIV99,
 12296           ERPNDB-KEY,
 12297           DFHEIV99,
 12298           DFHEIV99,
 12299           DFHEIV99
 12300     SET ADDRESS OF PENDING-BUSINESS TO
 12301         DFHEIV20
 12302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12303
 12304
 12305     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12306
 12307     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12308
 12309     IF BSUFIXL NOT = ZEROS
 12310        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12311     ELSE
 12312        MOVE SPACE               TO WS-NEW-SUFFIX.
 12313
 12314     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12315     PERFORM 8600-DEEDIT.
 12316     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12317     MOVE '4'                    TO DC-OPTION-CODE.
 12318     PERFORM 9700-DATE-LINK.
 12319     IF DATE-CONVERSION-ERROR
 12320        MOVE ER-0348             TO EMI-ERROR
 12321        MOVE -1                  TO BEFFDTL
 12322        MOVE AL-UABON            TO BEFFDTA
 12323        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 226
* VP6311.cbl
 12324        GO TO 8200-SEND-DATAONLY
 12325     ELSE
 12326        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12327        MOVE AL-UANON            TO BEFFDTA
 12328        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12329
 12330
 12331* EXEC CICS HANDLE CONDITION
 12332*         NOTFND    (1490-RECORD-NOT-FOUND)
 12333*    END-EXEC.
 12334*    MOVE '"$I                   ! + #00011600' TO DFHEIV0
 12335     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12336     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12337     MOVE X'2B20233030303131363030' TO DFHEIV0(25:11)
 12338     CALL 'kxdfhei1' USING DFHEIV0
 12339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12340
 12341
 12342
 12343* EXEC CICS READ
 12344*        SET     (ADDRESS OF PENDING-BUSINESS)
 12345*        DATASET (FILE-ID-ERPNDB)
 12346*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12347*        UPDATE
 12348*    END-EXEC.
 12349*    MOVE '&"S        EU         (   #00011604' TO DFHEIV0
 12350     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12351     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12352     MOVE X'2020233030303131363034' TO DFHEIV0(25:11)
 12353     CALL 'kxdfhei1' USING DFHEIV0,
 12354           FILE-ID-ERPNDB,
 12355           DFHEIV20,
 12356           DFHEIV99,
 12357           PI-PREV-CONTROL-PRIMARY,
 12358           DFHEIV99,
 12359           DFHEIV99,
 12360           DFHEIV99
 12361     SET ADDRESS OF PENDING-BUSINESS TO
 12362         DFHEIV20
 12363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12364
 12365
 12366     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12367        MOVE -1                 TO BMAINTL
 12368        MOVE ER-2197            TO EMI-ERROR
 12369        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12370        GO TO 8200-SEND-DATAONLY.
 12371
 12372     IF PB-BILLED-DT NOT = LOW-VALUES
 12373        MOVE -1                 TO BMAINTL
 12374        MOVE ER-2129            TO EMI-ERROR
 12375        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12376        GO TO 8200-SEND-DATAONLY.
 12377
 12378     IF PB-CHG-COUNT NOT = ZEROS
 12379        MOVE ER-2336            TO EMI-ERROR
 12380        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12381        MOVE AL-UABON            TO BMAINTA
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 227
* VP6311.cbl
 12382        MOVE -1                  TO BMAINTL
 12383        GO TO 8200-SEND-DATAONLY.
 12384
 12385     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12386        PB-CHG-COUNT NOT = ZEROS
 12387        MOVE ER-2196             TO EMI-ERROR
 12388        MOVE AL-UABON            TO BMAINTA
 12389        MOVE -1                  TO BMAINTL
 12390        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12391        GO TO 8200-SEND-DATAONLY.
 12392******************************************************************
 12393*                                                                *
 12394*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12395*                                                                *
 12396******************************************************************
 12397     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12398     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12399     MOVE +0                     TO ELCRTO-SEQ-NO
 12400
 12401* EXEC CICS READ
 12402*       DATASET   ('ELCRTO')
 12403*       INTO      (ORIGINAL-CERTIFICATE)
 12404*       RIDFLD    (ELCRTO-KEY)
 12405*       GTEQ
 12406*       RESP      (WS-RESPONSE)
 12407*    END-EXEC
 12408     MOVE LENGTH OF
 12409      ORIGINAL-CERTIFICATE
 12410       TO DFHEIV11
 12411     MOVE 'ELCRTO' TO DFHEIV1
 12412*    MOVE '&"IL       G          (  N#00011645' TO DFHEIV0
 12413     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12415     MOVE X'204E233030303131363435' TO DFHEIV0(25:11)
 12416     CALL 'kxdfhei1' USING DFHEIV0,
 12417           DFHEIV1,
 12418           ORIGINAL-CERTIFICATE,
 12419           DFHEIV11,
 12420           ELCRTO-KEY,
 12421           DFHEIV99,
 12422           DFHEIV99,
 12423           DFHEIV99
 12424     MOVE EIBRESP  TO WS-RESPONSE
 12425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12426     IF RESP-NORMAL
 12427        AND (OC-CONTROL-PRIMARY (1:33) =
 12428                 PB-CONTROL-BY-ACCOUNT (1:33))
 12429        AND (OC-RECORD-TYPE = 'I')
 12430
 12431* EXEC CICS READ
 12432*          DATASET   ('ELCRTO')
 12433*          INTO      (ORIGINAL-CERTIFICATE)
 12434*          RIDFLD    (ELCRTO-KEY)
 12435*          UPDATE
 12436*          RESP      (WS-RESPONSE)
 12437*       END-EXEC
 12438     MOVE LENGTH OF
 12439      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 228
* VP6311.cbl
 12440       TO DFHEIV11
 12441     MOVE 'ELCRTO' TO DFHEIV1
 12442*    MOVE '&"IL       EU         (  N#00011656' TO DFHEIV0
 12443     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12444     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12445     MOVE X'204E233030303131363536' TO DFHEIV0(25:11)
 12446     CALL 'kxdfhei1' USING DFHEIV0,
 12447           DFHEIV1,
 12448           ORIGINAL-CERTIFICATE,
 12449           DFHEIV11,
 12450           ELCRTO-KEY,
 12451           DFHEIV99,
 12452           DFHEIV99,
 12453           DFHEIV99
 12454     MOVE EIBRESP  TO WS-RESPONSE
 12455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12456        IF RESP-NORMAL
 12457
 12458* EXEC CICS DELETE
 12459*             DATASET   ('ELCRTO')
 12460*          END-EXEC
 12461     MOVE 'ELCRTO' TO DFHEIV1
 12462*    MOVE '&(                    &   #00011664' TO DFHEIV0
 12463     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12464     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12465     MOVE X'2020233030303131363634' TO DFHEIV0(25:11)
 12466     CALL 'kxdfhei1' USING DFHEIV0,
 12467           DFHEIV1,
 12468           DFHEIV99,
 12469           DFHEIV99,
 12470           DFHEIV99,
 12471           DFHEIV99
 12472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12473        END-IF
 12474     END-IF
 12475******************************************************************
 12476*                                                                *
 12477*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12478*                                                                *
 12479******************************************************************
 12480
 12481* EXEC CICS HANDLE CONDITION
 12482*        NOTFND    (1405-DELETE-CERTIFICATE)
 12483*    END-EXEC.
 12484*    MOVE '"$I                   ! , #00011674' TO DFHEIV0
 12485     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12486     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12487     MOVE X'2C20233030303131363734' TO DFHEIV0(25:11)
 12488     CALL 'kxdfhei1' USING DFHEIV0
 12489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12490
 12491
 12492
 12493* EXEC CICS READ
 12494*        EQUAL
 12495*        DATASET   (FILE-ID-ERPNDM)
 12496*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12497*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 229
* VP6311.cbl
 12498*        UPDATE
 12499*    END-EXEC.
 12500*    MOVE '&"S        EU         (   #00011678' TO DFHEIV0
 12501     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12502     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12503     MOVE X'2020233030303131363738' TO DFHEIV0(25:11)
 12504     CALL 'kxdfhei1' USING DFHEIV0,
 12505           FILE-ID-ERPNDM,
 12506           DFHEIV20,
 12507           DFHEIV99,
 12508           PI-PREV-CONTROL-PRIMARY,
 12509           DFHEIV99,
 12510           DFHEIV99,
 12511           DFHEIV99
 12512     SET ADDRESS OF PENDING-MAILING-DATA TO
 12513         DFHEIV20
 12514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12515
 12516
 12517     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12518     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12519     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12520
 12521     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12522
 12523
 12524* EXEC CICS DELETE
 12525*        DATASET   (FILE-ID-ERPNDM)
 12526*    END-EXEC.
 12527*    MOVE '&(                    &   #00011692' TO DFHEIV0
 12528     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12529     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12530     MOVE X'2020233030303131363932' TO DFHEIV0(25:11)
 12531     CALL 'kxdfhei1' USING DFHEIV0,
 12532           FILE-ID-ERPNDM,
 12533           DFHEIV99,
 12534           DFHEIV99,
 12535           DFHEIV99,
 12536           DFHEIV99
 12537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12538
 12539
 12540******************************************************************
 12541*                PROCESS   CERTIFICATE                           *
 12542******************************************************************
 12543
 12544 1405-DELETE-CERTIFICATE.
 12545
 12546* EXEC CICS HANDLE CONDITION
 12547*         NOTFND  (1420-CONTINUE-DELETE)
 12548*    END-EXEC.
 12549*    MOVE '"$I                   ! - #00011701' TO DFHEIV0
 12550     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12551     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12552     MOVE X'2D20233030303131373031' TO DFHEIV0(25:11)
 12553     CALL 'kxdfhei1' USING DFHEIV0
 12554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12555
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 230
* VP6311.cbl
 12556
 12557     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12558     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12559     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12560     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12561
 12562
 12563* EXEC CICS READ
 12564*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12565*        DATASET (FILE-ID-ELCERT)
 12566*        RIDFLD  (ELCERT-KEY)
 12567*        UPDATE
 12568*    END-EXEC.
 12569*    MOVE '&"S        EU         (   #00011710' TO DFHEIV0
 12570     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12571     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12572     MOVE X'2020233030303131373130' TO DFHEIV0(25:11)
 12573     CALL 'kxdfhei1' USING DFHEIV0,
 12574           FILE-ID-ELCERT,
 12575           DFHEIV20,
 12576           DFHEIV99,
 12577           ELCERT-KEY,
 12578           DFHEIV99,
 12579           DFHEIV99,
 12580           DFHEIV99
 12581     SET ADDRESS OF CERTIFICATE-MASTER TO
 12582         DFHEIV20
 12583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12584
 12585
 12586     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12587
 12588     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12589     MOVE 'B'                    TO JP-RECORD-TYPE
 12590     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12591
 12592     PERFORM 8400-LOG-JOURNAL-RECORD.
 12593
 12594     IF CERT-NOTES-ARE-NOT-PRESENT
 12595        MOVE ' '                 TO WS-CERT-NOTE-SW
 12596     ELSE
 12597        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12598
 12599     IF INSURED-ADDR-PRESENT
 12600        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12601
 12602******************************************************************
 12603******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12604******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12605******************************************************************
 12606******************************************************************
 12607
 12608     IF CERT-ADDED-BATCH AND
 12609        (NOT NO-CLAIM-ATTACHED
 12610         OR
 12611         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12612        GO TO 1410-REWRITE-CERT.
 12613
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 231
* VP6311.cbl
 12614******************************************************************
 12615******************************************************************
 12616
 12617     IF CERT-ADDED-BATCH  AND
 12618        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12619        GO TO 1410-REWRITE-CERT.
 12620
 12621     IF NO-CLAIM-ATTACHED
 12622        NEXT SENTENCE
 12623     ELSE
 12624        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12625        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12626        GO TO 1410-REWRITE-CERT.
 12627
 12628     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12629     MOVE 'D'                      TO JP-RECORD-TYPE.
 12630     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12631
 12632
 12633* EXEC CICS DELETE
 12634*         DATASET    (FILE-ID-ELCERT)
 12635*    END-EXEC.
 12636*    MOVE '&(                    &   #00011763' TO DFHEIV0
 12637     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12638     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12639     MOVE X'2020233030303131373633' TO DFHEIV0(25:11)
 12640     CALL 'kxdfhei1' USING DFHEIV0,
 12641           FILE-ID-ELCERT,
 12642           DFHEIV99,
 12643           DFHEIV99,
 12644           DFHEIV99,
 12645           DFHEIV99
 12646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12647
 12648
 12649     PERFORM 8400-LOG-JOURNAL-RECORD.
 12650
 12651******************************************************************
 12652*                                                                *
 12653*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12654*                                                                *
 12655******************************************************************
 12656
 12657     IF  CERT-NOTES-ARE-PRESENT
 12658         NEXT SENTENCE
 12659     ELSE
 12660         GO TO 1407-DELETE-MAILING.
 12661
 12662
 12663* EXEC CICS HANDLE CONDITION
 12664*         NOTFND  (1406-DELETE-ERNOTE)
 12665*    END-EXEC.
 12666*    MOVE '"$I                   ! . #00011780' TO DFHEIV0
 12667     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12668     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12669     MOVE X'2E20233030303131373830' TO DFHEIV0(25:11)
 12670     CALL 'kxdfhei1' USING DFHEIV0
 12671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 232
* VP6311.cbl
 12672
 12673
 12674     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12675     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12676     MOVE 0                     TO ERCNOT-SEQUENCE.
 12677
 12678 1406-DELETE-ERCNOT-LOOP.
 12679
 12680
 12681* EXEC CICS READ
 12682*        GTEQ
 12683*        DATASET   (FILE-ID-ERCNOT)
 12684*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12685*        RIDFLD    (ERCNOT-KEY)
 12686*    END-EXEC.
 12687*    MOVE '&"S        G          (   #00011790' TO DFHEIV0
 12688     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12689     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12690     MOVE X'2020233030303131373930' TO DFHEIV0(25:11)
 12691     CALL 'kxdfhei1' USING DFHEIV0,
 12692           FILE-ID-ERCNOT,
 12693           DFHEIV20,
 12694           DFHEIV99,
 12695           ERCNOT-KEY,
 12696           DFHEIV99,
 12697           DFHEIV99,
 12698           DFHEIV99
 12699     SET ADDRESS OF CERT-NOTE-FILE TO
 12700         DFHEIV20
 12701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12702
 12703
 12704     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12705     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12706         GO TO 1406-DELETE-ERNOTE
 12707     END-IF.
 12708
 12709     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12710     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12711     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12712
 12713     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12714
 12715
 12716* EXEC CICS DELETE
 12717*        DATASET   (FILE-ID-ERCNOT)
 12718*        RIDFLD    (ERCNOT-KEY)
 12719*        END-EXEC.
 12720*    MOVE '&(  R                 &   #00011808' TO DFHEIV0
 12721     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12722     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12723     MOVE X'2020233030303131383038' TO DFHEIV0(25:11)
 12724     CALL 'kxdfhei1' USING DFHEIV0,
 12725           FILE-ID-ERCNOT,
 12726           ERCNOT-KEY,
 12727           DFHEIV99,
 12728           DFHEIV99,
 12729           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 233
* VP6311.cbl
 12730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12731
 12732
 12733     PERFORM 8400-LOG-JOURNAL-RECORD.
 12734
 12735     GO TO 1406-DELETE-ERCNOT-LOOP.
 12736
 12737 1406-DELETE-ERNOTE.
 12738
 12739
 12740* EXEC CICS HANDLE CONDITION
 12741*         NOTFND  (1407-DELETE-MAILING)
 12742*    END-EXEC.
 12743*    MOVE '"$I                   ! / #00011819' TO DFHEIV0
 12744     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12745     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12746     MOVE X'2F20233030303131383139' TO DFHEIV0(25:11)
 12747     CALL 'kxdfhei1' USING DFHEIV0
 12748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12749
 12750
 12751
 12752* EXEC CICS READ
 12753*        EQUAL
 12754*        DATASET   (FILE-ID-ERNOTE)
 12755*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12756*        RIDFLD    (ELCERT-KEY)
 12757*        UPDATE
 12758*    END-EXEC.
 12759*    MOVE '&"S        EU         (   #00011823' TO DFHEIV0
 12760     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12761     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12762     MOVE X'2020233030303131383233' TO DFHEIV0(25:11)
 12763     CALL 'kxdfhei1' USING DFHEIV0,
 12764           FILE-ID-ERNOTE,
 12765           DFHEIV20,
 12766           DFHEIV99,
 12767           ELCERT-KEY,
 12768           DFHEIV99,
 12769           DFHEIV99,
 12770           DFHEIV99
 12771     SET ADDRESS OF CERTIFICATE-NOTE TO
 12772         DFHEIV20
 12773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12774
 12775
 12776     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12777     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12778     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12779
 12780     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12781
 12782
 12783* EXEC CICS DELETE
 12784*        DATASET   (FILE-ID-ERNOTE)
 12785*        END-EXEC.
 12786*    MOVE '&(                    &   #00011837' TO DFHEIV0
 12787     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 234
* VP6311.cbl
 12788     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12789     MOVE X'2020233030303131383337' TO DFHEIV0(25:11)
 12790     CALL 'kxdfhei1' USING DFHEIV0,
 12791           FILE-ID-ERNOTE,
 12792           DFHEIV99,
 12793           DFHEIV99,
 12794           DFHEIV99,
 12795           DFHEIV99
 12796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12797
 12798
 12799     PERFORM 8400-LOG-JOURNAL-RECORD.
 12800
 12801******************************************************************
 12802*                                                                *
 12803*                DELETE MAILING ADDRESS RECORDS                  *
 12804*                                                                *
 12805******************************************************************
 12806
 12807 1407-DELETE-MAILING.
 12808     IF CERT-ADDRESS-PRESENT
 12809        NEXT SENTENCE
 12810     ELSE
 12811        GO TO 1420-CONTINUE-DELETE.
 12812
 12813
 12814* EXEC CICS HANDLE CONDITION
 12815*         NOTFND  (1420-CONTINUE-DELETE)
 12816*    END-EXEC.
 12817*    MOVE '"$I                   ! 0 #00011855' TO DFHEIV0
 12818     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12820     MOVE X'3020233030303131383535' TO DFHEIV0(25:11)
 12821     CALL 'kxdfhei1' USING DFHEIV0
 12822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12823
 12824
 12825
 12826* EXEC CICS READ
 12827*        EQUAL
 12828*        DATASET   (FILE-ID-ERMAIL)
 12829*        SET       (ADDRESS OF MAILING-DATA)
 12830*        RIDFLD    (ELCERT-KEY)
 12831*        UPDATE
 12832*    END-EXEC.
 12833*    MOVE '&"S        EU         (   #00011859' TO DFHEIV0
 12834     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12835     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12836     MOVE X'2020233030303131383539' TO DFHEIV0(25:11)
 12837     CALL 'kxdfhei1' USING DFHEIV0,
 12838           FILE-ID-ERMAIL,
 12839           DFHEIV20,
 12840           DFHEIV99,
 12841           ELCERT-KEY,
 12842           DFHEIV99,
 12843           DFHEIV99,
 12844           DFHEIV99
 12845     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 235
* VP6311.cbl
 12846         DFHEIV20
 12847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12848
 12849
 12850     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12851     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12852     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12853
 12854     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12855
 12856
 12857* EXEC CICS DELETE
 12858*        DATASET   (FILE-ID-ERMAIL)
 12859*    END-EXEC.
 12860*    MOVE '&(                    &   #00011873' TO DFHEIV0
 12861     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12862     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12863     MOVE X'2020233030303131383733' TO DFHEIV0(25:11)
 12864     CALL 'kxdfhei1' USING DFHEIV0,
 12865           FILE-ID-ERMAIL,
 12866           DFHEIV99,
 12867           DFHEIV99,
 12868           DFHEIV99,
 12869           DFHEIV99
 12870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12871
 12872
 12873     GO TO 1420-CONTINUE-DELETE.
 12874
 12875 1410-REWRITE-CERT.
 12876     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12877     MOVE 'C'                      TO JP-RECORD-TYPE.
 12878     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12879     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12880
 12881
 12882* EXEC CICS REWRITE
 12883*         DATASET    (FILE-ID-ELCERT)
 12884*         FROM       (CERTIFICATE-MASTER)
 12885*         END-EXEC.
 12886     MOVE LENGTH OF
 12887      CERTIFICATE-MASTER
 12888       TO DFHEIV11
 12889*    MOVE '&& L                  %   #00011885' TO DFHEIV0
 12890     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12891     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12892     MOVE X'2020233030303131383835' TO DFHEIV0(25:11)
 12893     CALL 'kxdfhei1' USING DFHEIV0,
 12894           FILE-ID-ELCERT,
 12895           CERTIFICATE-MASTER,
 12896           DFHEIV11,
 12897           DFHEIV99
 12898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12899
 12900
 12901     PERFORM 8400-LOG-JOURNAL-RECORD.
 12902
 12903 1420-CONTINUE-DELETE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 236
* VP6311.cbl
 12904     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12905     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12906
 12907     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12908     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12909
 12910     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12911
 12912 1450-DELETE-PB-RECORD.
 12913     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12914     MOVE 'D'                      TO JP-RECORD-TYPE
 12915     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12916
 12917
 12918* EXEC CICS DELETE
 12919*        DATASET    (FILE-ID-ERPNDB)
 12920*    END-EXEC.
 12921*    MOVE '&(                    &   #00011906' TO DFHEIV0
 12922     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12923     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12924     MOVE X'2020233030303131393036' TO DFHEIV0(25:11)
 12925     CALL 'kxdfhei1' USING DFHEIV0,
 12926           FILE-ID-ERPNDB,
 12927           DFHEIV99,
 12928           DFHEIV99,
 12929           DFHEIV99,
 12930           DFHEIV99
 12931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12932
 12933
 12934     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12935
 12936     PERFORM 8400-LOG-JOURNAL-RECORD.
 12937
 12938     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12939     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12940     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12941
 12942
 12943* EXEC CICS HANDLE CONDITION
 12944*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12945*    END-EXEC.
 12946*    MOVE '"$I                   ! 1 #00011918' TO DFHEIV0
 12947     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12948     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12949     MOVE X'3120233030303131393138' TO DFHEIV0(25:11)
 12950     CALL 'kxdfhei1' USING DFHEIV0
 12951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12952
 12953
 12954
 12955* EXEC CICS READ
 12956*        SET     (ADDRESS OF PENDING-BUSINESS)
 12957*        DATASET (FILE-ID-ERPNDB)
 12958*        RIDFLD  (ERPNDB-KEY)
 12959*        UPDATE
 12960*    END-EXEC.
 12961*    MOVE '&"S        EU         (   #00011922' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 237
* VP6311.cbl
 12962     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12963     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12964     MOVE X'2020233030303131393232' TO DFHEIV0(25:11)
 12965     CALL 'kxdfhei1' USING DFHEIV0,
 12966           FILE-ID-ERPNDB,
 12967           DFHEIV20,
 12968           DFHEIV99,
 12969           ERPNDB-KEY,
 12970           DFHEIV99,
 12971           DFHEIV99,
 12972           DFHEIV99
 12973     SET ADDRESS OF PENDING-BUSINESS TO
 12974         DFHEIV20
 12975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12976
 12977
 12978     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12979
 12980     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 12981
 12982     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12983        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12984        MOVE 'D'                   TO JP-RECORD-TYPE
 12985        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 12986
 12987* EXEC CICS DELETE
 12988*            DATASET    (FILE-ID-ERPNDB)
 12989*       END-EXEC
 12990*    MOVE '&(                    &   #00011937' TO DFHEIV0
 12991     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12992     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12993     MOVE X'2020233030303131393337' TO DFHEIV0(25:11)
 12994     CALL 'kxdfhei1' USING DFHEIV0,
 12995           FILE-ID-ERPNDB,
 12996           DFHEIV99,
 12997           DFHEIV99,
 12998           DFHEIV99,
 12999           DFHEIV99
 13000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13001        PERFORM 8400-LOG-JOURNAL-RECORD
 13002     ELSE
 13003        MOVE 'B'                 TO JP-RECORD-TYPE
 13004        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13005        PERFORM 8400-LOG-JOURNAL-RECORD
 13006        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13007        MOVE 'C'                 TO JP-RECORD-TYPE
 13008        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13009
 13010* EXEC CICS REWRITE
 13011*            DATASET    (FILE-ID-ERPNDB)
 13012*            FROM       (PENDING-BUSINESS)
 13013*       END-EXEC
 13014     MOVE LENGTH OF
 13015      PENDING-BUSINESS
 13016       TO DFHEIV11
 13017*    MOVE '&& L                  %   #00011948' TO DFHEIV0
 13018     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13019     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 238
* VP6311.cbl
 13020     MOVE X'2020233030303131393438' TO DFHEIV0(25:11)
 13021     CALL 'kxdfhei1' USING DFHEIV0,
 13022           FILE-ID-ERPNDB,
 13023           PENDING-BUSINESS,
 13024           DFHEIV11,
 13025           DFHEIV99
 13026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13027        PERFORM 8400-LOG-JOURNAL-RECORD.
 13028
 13029******************************************************************
 13030*                                                                *
 13031*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13032*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13033*                                                                *
 13034******************************************************************
 13035
 13036     IF NOT PI-AR-PROCESSING
 13037        GO TO 1475-DELETE-FINISHED.
 13038
 13039     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13040        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13041        NEXT SENTENCE
 13042     ELSE
 13043        GO TO 1475-DELETE-FINISHED.
 13044
 13045
 13046* EXEC CICS HANDLE CONDITION
 13047*         NOTFND    (1475-DELETE-FINISHED)
 13048*         END-EXEC.
 13049*    MOVE '"$I                   ! 2 #00011970' TO DFHEIV0
 13050     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13051     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13052     MOVE X'3220233030303131393730' TO DFHEIV0(25:11)
 13053     CALL 'kxdfhei1' USING DFHEIV0
 13054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13055
 13056
 13057     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13058     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13059
 13060
 13061* EXEC CICS READ
 13062*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13063*        DATASET (FILE-ID-ERRQST)
 13064*        RIDFLD  (ERRQST-KEY)
 13065*        UPDATE
 13066*    END-EXEC.
 13067*    MOVE '&"S        EU         (   #00011977' TO DFHEIV0
 13068     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13069     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13070     MOVE X'2020233030303131393737' TO DFHEIV0(25:11)
 13071     CALL 'kxdfhei1' USING DFHEIV0,
 13072           FILE-ID-ERRQST,
 13073           DFHEIV20,
 13074           DFHEIV99,
 13075           ERRQST-KEY,
 13076           DFHEIV99,
 13077           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 239
* VP6311.cbl
 13078           DFHEIV99
 13079     SET ADDRESS OF AR-REQUEST-RECORD TO
 13080         DFHEIV20
 13081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13082
 13083
 13084     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13085
 13086     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13087
 13088     MOVE 'D'                      TO JP-RECORD-TYPE.
 13089     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13090
 13091
 13092* EXEC CICS DELETE
 13093*         DATASET    (FILE-ID-ERRQST)
 13094*    END-EXEC.
 13095*    MOVE '&(                    &   #00011991' TO DFHEIV0
 13096     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13097     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13098     MOVE X'2020233030303131393931' TO DFHEIV0(25:11)
 13099     CALL 'kxdfhei1' USING DFHEIV0,
 13100           FILE-ID-ERRQST,
 13101           DFHEIV99,
 13102           DFHEIV99,
 13103           DFHEIV99,
 13104           DFHEIV99
 13105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13106
 13107
 13108     PERFORM 8400-LOG-JOURNAL-RECORD.
 13109
 13110 1475-DELETE-FINISHED.
 13111     MOVE ZEROS                  TO EMI-ERROR.
 13112     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13113     MOVE LOW-VALUES             TO VP631BI.
 13114     MOVE -1                     TO BMAINTL.
 13115     GO TO 8100-SEND-INITIAL-MAP.
 13116
 13117 1480-BATCH-HDR-NOT-FOUND.
 13118     MOVE -1                     TO BMAINTL.
 13119     MOVE ER-7450                TO EMI-ERROR.
 13120     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13121     GO TO 8200-SEND-DATAONLY.
 13122
 13123 1490-RECORD-NOT-FOUND.
 13124     MOVE -1                     TO BMAINTL.
 13125     MOVE ER-7451                TO EMI-ERROR.
 13126     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13127     GO TO 8200-SEND-DATAONLY.
 13128
 13129******************************************************************
 13130*            O V E R   C H A R G E   P R O C E S S I N G         *
 13131******************************************************************
 13132 1500-UPDATE-ERNOTE.
 13133     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13134     MOVE 'A'                    TO WS-NOTE-SW
 13135     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 240
* VP6311.cbl
 13136     .
 13137 1500-EXIT.
 13138     EXIT.
 13139 1510-ADD-ERNOTE-REC.
 13140
 13141* EXEC CICS GETMAIN
 13142*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13143*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13144*        INITIMG (GETMAIN-SPACE)
 13145*    END-EXEC
 13146*    MOVE ',"IL                  $   #00012027' TO DFHEIV0
 13147     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13148     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13149     MOVE X'2020233030303132303237' TO DFHEIV0(25:11)
 13150     CALL 'kxdfhei1' USING DFHEIV0,
 13151           DFHEIV20,
 13152           ERNOTE-RECORD-LENGTH,
 13153           GETMAIN-SPACE
 13154     SET ADDRESS OF CERTIFICATE-NOTE TO
 13155         DFHEIV20
 13156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13157     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13158                                 TO ERNOTE-KEY
 13159
 13160* EXEC CICS READ
 13161*       DATASET    (FILE-ID-ERNOTE)
 13162*       RIDFLD     (ERNOTE-KEY)
 13163*       INTO       (CERTIFICATE-NOTE)
 13164*       RESP       (WS-RESPONSE)
 13165*       UPDATE
 13166*    END-EXEC
 13167     MOVE LENGTH OF
 13168      CERTIFICATE-NOTE
 13169       TO DFHEIV11
 13170*    MOVE '&"IL       EU         (  N#00012034' TO DFHEIV0
 13171     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13172     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13173     MOVE X'204E233030303132303334' TO DFHEIV0(25:11)
 13174     CALL 'kxdfhei1' USING DFHEIV0,
 13175           FILE-ID-ERNOTE,
 13176           CERTIFICATE-NOTE,
 13177           DFHEIV11,
 13178           ERNOTE-KEY,
 13179           DFHEIV99,
 13180           DFHEIV99,
 13181           DFHEIV99
 13182     MOVE EIBRESP  TO WS-RESPONSE
 13183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13184     IF RESP-NORMAL
 13185        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13186           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13187        END-IF
 13188        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13189           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13190        END-IF
 13191        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13192           (N1 > +10)
 13193           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 241
* VP6311.cbl
 13194           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13195        END-PERFORM
 13196        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13197          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13198
 13199* EXEC CICS UNLOCK
 13200*            DATASET    (FILE-ID-ERNOTE)
 13201*          END-EXEC
 13202*    MOVE '&*                    #   #00012055' TO DFHEIV0
 13203     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13204     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13205     MOVE X'2020233030303132303535' TO DFHEIV0(25:11)
 13206     CALL 'kxdfhei1' USING DFHEIV0,
 13207           FILE-ID-ERNOTE,
 13208           DFHEIV99
 13209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13210        ELSE
 13211          PERFORM VARYING N1 FROM +1 BY +1
 13212           UNTIL (N1 > +10)
 13213           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13214          END-PERFORM
 13215          IF (N1 < +11)
 13216            IF N1 >= CN-BILLING-START-LINE-NO AND
 13217              N1 <= CN-BILLING-END-LINE-NO
 13218              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13219                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13220              ELSE
 13221                 MOVE WS-VA-NO-COMM-MESS
 13222                                    TO CN-LINE (N1)
 13223              END-IF
 13224            ELSE
 13225              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13226               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13227                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13228                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13229                ELSE
 13230                  MOVE WS-VA-NO-COMM-MESS
 13231                                    TO CN-LINE (N1)
 13232                END-IF
 13233                MOVE N1             TO CN-BILLING-END-LINE-NO
 13234              ELSE
 13235                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13236                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13237                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13238                  ELSE
 13239                     MOVE WS-VA-NO-COMM-MESS
 13240                                    TO CN-LINE (N1)
 13241                  END-IF
 13242                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13243                                      CN-BILLING-START-LINE-NO
 13244                ELSE
 13245                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13246                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13247                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13248                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13249                     ELSE
 13250                       MOVE WS-VA-NO-COMM-MESS
 13251                                    TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 242
* VP6311.cbl
 13252                     END-IF
 13253                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13254                  ELSE
 13255                     PERFORM 1700-SQUEEZE-IT-IN
 13256                                 THRU 1700-EXIT
 13257                  END-IF
 13258                END-IF
 13259              END-IF
 13260            END-IF
 13261            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13262            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13263            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13264
 13265* EXEC CICS REWRITE
 13266*              DATASET    (FILE-ID-ERNOTE)
 13267*              FROM       (CERTIFICATE-NOTE)
 13268*              RESP       (WS-RESPONSE)
 13269*           END-EXEC
 13270     MOVE LENGTH OF
 13271      CERTIFICATE-NOTE
 13272       TO DFHEIV11
 13273*    MOVE '&& L                  %  N#00012112' TO DFHEIV0
 13274     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13275     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13276     MOVE X'204E233030303132313132' TO DFHEIV0(25:11)
 13277     CALL 'kxdfhei1' USING DFHEIV0,
 13278           FILE-ID-ERNOTE,
 13279           CERTIFICATE-NOTE,
 13280           DFHEIV11,
 13281           DFHEIV99
 13282     MOVE EIBRESP  TO WS-RESPONSE
 13283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13284          END-IF
 13285        END-IF
 13286     ELSE
 13287        MOVE SPACES              TO CERTIFICATE-NOTE
 13288        MOVE 'CN'                TO CN-RECORD-ID
 13289        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13290                                 TO CN-CONTROL-PRIMARY
 13291                                    ERNOTE-KEY
 13292        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13293                                    CN-BILLING-END-LINE-NO
 13294        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13295           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13296        ELSE
 13297           MOVE WS-VA-NO-COMM-MESS
 13298                                 TO CN-LINE (1)
 13299        END-IF
 13300        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13301        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13302        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13303
 13304* EXEC CICS WRITE
 13305*          DATASET    (FILE-ID-ERNOTE)
 13306*          FROM       (CERTIFICATE-NOTE)
 13307*          RIDFLD     (ERNOTE-KEY)
 13308*          RESP       (WS-RESPONSE)
 13309*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 243
* VP6311.cbl
 13310     MOVE LENGTH OF
 13311      CERTIFICATE-NOTE
 13312       TO DFHEIV11
 13313*    MOVE '&$ L                  ''  N#00012136' TO DFHEIV0
 13314     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13315     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13316     MOVE X'204E233030303132313336' TO DFHEIV0(25:11)
 13317     CALL 'kxdfhei1' USING DFHEIV0,
 13318           FILE-ID-ERNOTE,
 13319           CERTIFICATE-NOTE,
 13320           DFHEIV11,
 13321           ERNOTE-KEY,
 13322           DFHEIV99,
 13323           DFHEIV99
 13324     MOVE EIBRESP  TO WS-RESPONSE
 13325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13326     END-IF
 13327     .
 13328 1510-EXIT.
 13329     EXIT.
 13330 1520-UPDATE-ELCERT.
 13331     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13332                                 TO ELCERT-KEY
 13333
 13334* EXEC CICS READ
 13335*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13336*        DATASET (FILE-ID-ELCERT)
 13337*        RIDFLD  (ELCERT-KEY)
 13338*        UPDATE
 13339*        RESP    (WS-RESPONSE)
 13340*    END-EXEC
 13341*    MOVE '&"S        EU         (  N#00012149' TO DFHEIV0
 13342     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13343     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13344     MOVE X'204E233030303132313439' TO DFHEIV0(25:11)
 13345     CALL 'kxdfhei1' USING DFHEIV0,
 13346           FILE-ID-ELCERT,
 13347           DFHEIV20,
 13348           DFHEIV99,
 13349           ELCERT-KEY,
 13350           DFHEIV99,
 13351           DFHEIV99,
 13352           DFHEIV99
 13353     SET ADDRESS OF CERTIFICATE-MASTER TO
 13354         DFHEIV20
 13355     MOVE EIBRESP  TO WS-RESPONSE
 13356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13357     IF RESP-NORMAL
 13358        IF WS-NOTE-SW = 'A'
 13359           IF CM-NOTE-SW = ' '
 13360              MOVE '2'             TO CM-NOTE-SW
 13361           ELSE
 13362             IF CM-NOTE-SW = '1'
 13363                MOVE '3'           TO CM-NOTE-SW
 13364             ELSE
 13365               IF CM-NOTE-SW = '4'
 13366                  MOVE '6'         TO CM-NOTE-SW
 13367               ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 244
* VP6311.cbl
 13368                 IF CM-NOTE-SW = '5'
 13369                    MOVE '7'       TO CM-NOTE-SW
 13370                 END-IF
 13371               END-IF
 13372             END-IF
 13373           END-IF
 13374        ELSE
 13375           IF CM-NOTE-SW = '2'
 13376              MOVE ' '             TO CM-NOTE-SW
 13377           ELSE
 13378             IF CM-NOTE-SW = '3'
 13379                MOVE '1'           TO CM-NOTE-SW
 13380             ELSE
 13381               IF CM-NOTE-SW = '6'
 13382                  MOVE '4'         TO CM-NOTE-SW
 13383               ELSE
 13384                 IF CM-NOTE-SW = '7'
 13385                    MOVE '5'       TO CM-NOTE-SW
 13386                 END-IF
 13387               END-IF
 13388             END-IF
 13389           END-IF
 13390        END-IF
 13391
 13392* EXEC CICS REWRITE
 13393*          DATASET    (FILE-ID-ELCERT)
 13394*          FROM       (CERTIFICATE-MASTER)
 13395*          RESP       (WS-RESPONSE)
 13396*       END-EXEC
 13397     MOVE LENGTH OF
 13398      CERTIFICATE-MASTER
 13399       TO DFHEIV11
 13400*    MOVE '&& L                  %  N#00012190' TO DFHEIV0
 13401     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13402     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13403     MOVE X'204E233030303132313930' TO DFHEIV0(25:11)
 13404     CALL 'kxdfhei1' USING DFHEIV0,
 13405           FILE-ID-ELCERT,
 13406           CERTIFICATE-MASTER,
 13407           DFHEIV11,
 13408           DFHEIV99
 13409     MOVE EIBRESP  TO WS-RESPONSE
 13410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13411        IF RESP-NORMAL
 13412           CONTINUE
 13413        ELSE
 13414           MOVE WS-RESPONSE TO EMI-ERROR
 13415           PERFORM 9900-ERROR-FORMAT
 13416                                 THRU 9900-EXIT
 13417           GO TO 8200-SEND-DATAONLY
 13418        END-IF
 13419     ELSE
 13420        MOVE -1                  TO BMAINTL
 13421        MOVE 0249                TO EMI-ERROR
 13422        PERFORM 9900-ERROR-FORMAT
 13423                                 THRU 9900-EXIT
 13424        GO TO 8200-SEND-DATAONLY
 13425     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 245
* VP6311.cbl
 13426     .
 13427 1520-EXIT.
 13428     EXIT.
 13429 1600-UPDATE-ERPYAJ.
 13430     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13431                                 THRU 1610-EXIT
 13432     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13433                                 THRU 1620-EXIT
 13434     .
 13435 1600-EXIT.
 13436     EXIT.
 13437 1610-ADD-ERPYAJ-BANK-REC.
 13438
 13439* EXEC CICS GETMAIN
 13440*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13441*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13442*        INITIMG (GETMAIN-SPACE)
 13443*    END-EXEC
 13444*    MOVE ',"IL                  $   #00012222' TO DFHEIV0
 13445     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13446     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13447     MOVE X'2020233030303132323232' TO DFHEIV0(25:11)
 13448     CALL 'kxdfhei1' USING DFHEIV0,
 13449           DFHEIV20,
 13450           ERPYAJ-RECORD-LENGTH,
 13451           GETMAIN-SPACE
 13452     SET ADDRESS OF PENDING-PAY-ADJ TO
 13453         DFHEIV20
 13454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13455     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13456     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13457     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13458     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13459     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13460     MOVE +10                    TO ERPYAJ-SEQ-NO
 13461     MOVE 'R'                    TO ERPYAJ-TYPE
 13462     IF REVERSAL
 13463        MOVE 'C'                 TO ERPYAJ-TYPE
 13464     END-IF
 13465     MOVE SPACES                 TO PENDING-PAY-ADJ
 13466     MOVE 'PY'                   TO PY-RECORD-ID
 13467     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13468     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13469     IF REVERSAL
 13470        MOVE PB-I-DCC-OVER-CHG-AMT
 13471                                 TO PY-ENTRY-AMT
 13472     END-IF
 13473     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13474                                    PY-INPUT-DT
 13475*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13476*                                   PY-INPUT-DT
 13477     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13478     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13479     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13480     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13481     IF PB-CARRIER = '2'
 13482        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13483     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 246
* VP6311.cbl
 13484        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13485     END-IF
 13486     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13487                                    PY-BILLED-DATE
 13488                                    PY-AR-DATE
 13489                                    PY-REPORTED-DT
 13490                                    PY-CHECK-WRITTEN-DT
 13491     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13492                                    PY-CHECK-QUE-SEQUENCE
 13493     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13494     PERFORM WITH TEST AFTER
 13495        UNTIL (NOT RESP-DUPKEY)
 13496           AND (NOT RESP-DUPREC)
 13497
 13498* EXEC CICS WRITE
 13499*          DATASET    (FILE-ID-ERPYAJ)
 13500*          FROM       (PENDING-PAY-ADJ)
 13501*          RIDFLD     (ERPYAJ-KEY)
 13502*          RESP       (WS-RESPONSE)
 13503*       END-EXEC
 13504     MOVE LENGTH OF
 13505      PENDING-PAY-ADJ
 13506       TO DFHEIV11
 13507*    MOVE '&$ L                  ''  N#00012269' TO DFHEIV0
 13508     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13509     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13510     MOVE X'204E233030303132323639' TO DFHEIV0(25:11)
 13511     CALL 'kxdfhei1' USING DFHEIV0,
 13512           FILE-ID-ERPYAJ,
 13513           PENDING-PAY-ADJ,
 13514           DFHEIV11,
 13515           ERPYAJ-KEY,
 13516           DFHEIV99,
 13517           DFHEIV99
 13518     MOVE EIBRESP  TO WS-RESPONSE
 13519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13520        IF RESP-DUPKEY OR RESP-DUPREC
 13521           ADD +1                TO ERPYAJ-SEQ-NO
 13522           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13523        END-IF
 13524     END-PERFORM
 13525     .
 13526 1610-EXIT.
 13527     EXIT.
 13528 1620-ADD-ERPYAJ-DLR-REC.
 13529     MOVE 'C'                    TO ERPYAJ-TYPE
 13530     IF REVERSAL
 13531        MOVE 'R'                 TO ERPYAJ-TYPE
 13532     END-IF
 13533     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13534                                    ERPYAJ-ACCOUNT
 13535     ADD +1                      TO ERPYAJ-SEQ-NO
 13536     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13537     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13538     IF PB-CARRIER = '2'
 13539        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13540     ELSE
 13541        MOVE '2725040130'        TO PY-GL-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 247
* VP6311.cbl
 13542     END-IF
 13543     PERFORM WITH TEST AFTER
 13544        UNTIL (NOT RESP-DUPKEY)
 13545           AND (NOT RESP-DUPREC)
 13546
 13547* EXEC CICS WRITE
 13548*          DATASET    (FILE-ID-ERPYAJ)
 13549*          FROM       (PENDING-PAY-ADJ)
 13550*          RIDFLD     (ERPYAJ-KEY)
 13551*          RESP       (WS-RESPONSE)
 13552*       END-EXEC
 13553     MOVE LENGTH OF
 13554      PENDING-PAY-ADJ
 13555       TO DFHEIV11
 13556*    MOVE '&$ L                  ''  N#00012301' TO DFHEIV0
 13557     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13558     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13559     MOVE X'204E233030303132333031' TO DFHEIV0(25:11)
 13560     CALL 'kxdfhei1' USING DFHEIV0,
 13561           FILE-ID-ERPYAJ,
 13562           PENDING-PAY-ADJ,
 13563           DFHEIV11,
 13564           ERPYAJ-KEY,
 13565           DFHEIV99,
 13566           DFHEIV99
 13567     MOVE EIBRESP  TO WS-RESPONSE
 13568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13569        IF RESP-DUPKEY OR RESP-DUPREC
 13570           ADD +1                TO ERPYAJ-SEQ-NO
 13571           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13572        END-IF
 13573     END-PERFORM
 13574     .
 13575 1620-EXIT.
 13576     EXIT.
 13577 1700-SQUEEZE-IT-IN.
 13578     IF (N1 > CN-BILLING-END-LINE-NO)
 13579        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13580           N1 = +1
 13581           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13582           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13583              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13584                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13585              ELSE
 13586                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13587              END-IF
 13588              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13589              MOVE +2 TO N1
 13590           END-IF
 13591        END-PERFORM
 13592     ELSE
 13593        IF (N1 < CN-BILLING-START-LINE-NO)
 13594           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13595              N1 = +10
 13596              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13597              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13598                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13599                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 248
* VP6311.cbl
 13600                 ELSE
 13601                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13602                 END-IF
 13603                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13604                 MOVE +9 TO N1
 13605              END-IF
 13606           END-PERFORM
 13607        END-IF
 13608     END-IF
 13609     .
 13610 1700-EXIT.
 13611     EXIT.
 13612 1800-REMOVE-CERT-NOTES.
 13613     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13614                                 TO ERNOTE-KEY
 13615
 13616* EXEC CICS READ
 13617*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13618*       DATASET    (FILE-ID-ERNOTE)
 13619*       RIDFLD     (ERNOTE-KEY)
 13620*       RESP       (WS-RESPONSE)
 13621*       UPDATE
 13622*    END-EXEC
 13623*    MOVE '&"S        EU         (  N#00012353' TO DFHEIV0
 13624     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13625     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13626     MOVE X'204E233030303132333533' TO DFHEIV0(25:11)
 13627     CALL 'kxdfhei1' USING DFHEIV0,
 13628           FILE-ID-ERNOTE,
 13629           DFHEIV20,
 13630           DFHEIV99,
 13631           ERNOTE-KEY,
 13632           DFHEIV99,
 13633           DFHEIV99,
 13634           DFHEIV99
 13635     SET ADDRESS OF CERTIFICATE-NOTE TO
 13636         DFHEIV20
 13637     MOVE EIBRESP  TO WS-RESPONSE
 13638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13639     IF RESP-NORMAL
 13640        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13641           (N1 > +10)
 13642           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13643           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13644        END-PERFORM
 13645        IF N1 < +11
 13646           MOVE SPACES              TO CN-LINE (N1)
 13647           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13648              N1 <= CN-BILLING-END-LINE-NO
 13649              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13650              IF CN-BILLING-END-LINE-NO <
 13651                               CN-BILLING-START-LINE-NO
 13652                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13653                                     CN-BILLING-START-LINE-NO
 13654              END-IF
 13655              PERFORM 1820-SQUEEZE-ERNOTE
 13656                                  THRU 1820-EXIT
 13657           END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 249
* VP6311.cbl
 13658           IF CN-LINES = SPACES
 13659
 13660* EXEC CICS DELETE
 13661*                DATASET    (FILE-ID-ERNOTE)
 13662*                RESP       (WS-RESPONSE)
 13663*             END-EXEC
 13664*    MOVE '&(                    &  N#00012380' TO DFHEIV0
 13665     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13666     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13667     MOVE X'204E233030303132333830' TO DFHEIV0(25:11)
 13668     CALL 'kxdfhei1' USING DFHEIV0,
 13669           FILE-ID-ERNOTE,
 13670           DFHEIV99,
 13671           DFHEIV99,
 13672           DFHEIV99,
 13673           DFHEIV99
 13674     MOVE EIBRESP  TO WS-RESPONSE
 13675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13676              IF RESP-NORMAL
 13677                 MOVE 'D'        TO WS-NOTE-SW
 13678                 PERFORM 1520-UPDATE-ELCERT
 13679                                 THRU 1520-EXIT
 13680              END-IF
 13681           ELSE
 13682
 13683* EXEC CICS REWRITE
 13684*                DATASET    (FILE-ID-ERNOTE)
 13685*                FROM       (CERTIFICATE-NOTE)
 13686*                RESP       (WS-RESPONSE)
 13687*             END-EXEC
 13688     MOVE LENGTH OF
 13689      CERTIFICATE-NOTE
 13690       TO DFHEIV11
 13691*    MOVE '&& L                  %  N#00012390' TO DFHEIV0
 13692     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13693     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13694     MOVE X'204E233030303132333930' TO DFHEIV0(25:11)
 13695     CALL 'kxdfhei1' USING DFHEIV0,
 13696           FILE-ID-ERNOTE,
 13697           CERTIFICATE-NOTE,
 13698           DFHEIV11,
 13699           DFHEIV99
 13700     MOVE EIBRESP  TO WS-RESPONSE
 13701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13702           END-IF
 13703        END-IF
 13704     END-IF
 13705     .
 13706 1800-EXIT.
 13707     EXIT.
 13708 1820-SQUEEZE-ERNOTE.
 13709     MOVE CN-BILLING-START-LINE-NO TO N2
 13710     IF N2 = 0
 13711         MOVE +1                 TO N2
 13712     END-IF
 13713     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13714        (N1 > +9)
 13715        IF CN-LINE (N1) = SPACES
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 250
* VP6311.cbl
 13716           MOVE CN-LINE (N1 + +1)
 13717                                 TO CN-LINE (N1)
 13718           MOVE SPACES           TO CN-LINE (N1 + +1)
 13719        END-IF
 13720     END-PERFORM
 13721     .
 13722 1820-EXIT.
 13723     EXIT.
 13724 1900-DELETE-ERPYAJ.
 13725     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13726     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13727     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13728     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13729     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13730     MOVE +10                    TO ERPYAJ-SEQ-NO
 13731     MOVE 'R'                    TO ERPYAJ-TYPE
 13732     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13733
 13734* EXEC CICS STARTBR
 13735*       DATASET    (FILE-ID-ERPYAJ)
 13736*       RIDFLD     (ERPYAJ-KEY)
 13737*       RESP       (WS-RESPONSE)
 13738*    END-EXEC
 13739     MOVE 0
 13740       TO DFHEIV11
 13741*    MOVE '&,         G          &  N#00012426' TO DFHEIV0
 13742     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13743     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13744     MOVE X'204E233030303132343236' TO DFHEIV0(25:11)
 13745     CALL 'kxdfhei1' USING DFHEIV0,
 13746           FILE-ID-ERPYAJ,
 13747           ERPYAJ-KEY,
 13748           DFHEIV99,
 13749           DFHEIV11,
 13750           DFHEIV99
 13751     MOVE EIBRESP  TO WS-RESPONSE
 13752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13753     IF RESP-NORMAL
 13754        CONTINUE
 13755     ELSE
 13756        GO TO 1900-GET-DEALER
 13757     END-IF
 13758     .
 13759 1900-READNEXT-ERPYAJ-B.
 13760*  GET THE BANK ERPYAJ RECORD
 13761
 13762* EXEC CICS READNEXT
 13763*       DATASET    (FILE-ID-ERPYAJ)
 13764*       RIDFLD     (ERPYAJ-KEY)
 13765*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13766*       RESP       (WS-RESPONSE)
 13767*    END-EXEC
 13768     MOVE 0
 13769       TO DFHEIV11
 13770*    MOVE '&.S                   )  N#00012439' TO DFHEIV0
 13771     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13772     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13773     MOVE X'204E233030303132343339' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 251
* VP6311.cbl
 13774     CALL 'kxdfhei1' USING DFHEIV0,
 13775           FILE-ID-ERPYAJ,
 13776           DFHEIV20,
 13777           DFHEIV99,
 13778           ERPYAJ-KEY,
 13779           DFHEIV99,
 13780           DFHEIV11,
 13781           DFHEIV99,
 13782           DFHEIV99
 13783     SET ADDRESS OF PENDING-PAY-ADJ TO
 13784         DFHEIV20
 13785     MOVE EIBRESP  TO WS-RESPONSE
 13786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13787     IF RESP-NORMAL
 13788        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13789           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13790              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13791                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13792
 13793* EXEC CICS READ
 13794*                   DATASET    (FILE-ID-ERPYAJ)
 13795*                   RIDFLD     (ERPYAJ-KEY)
 13796*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13797*                   RESP       (WS-RESPONSE)
 13798*                   UPDATE
 13799*                END-EXEC
 13800*    MOVE '&"S        EU         (  N#00012450' TO DFHEIV0
 13801     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13802     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13803     MOVE X'204E233030303132343530' TO DFHEIV0(25:11)
 13804     CALL 'kxdfhei1' USING DFHEIV0,
 13805           FILE-ID-ERPYAJ,
 13806           DFHEIV20,
 13807           DFHEIV99,
 13808           ERPYAJ-KEY,
 13809           DFHEIV99,
 13810           DFHEIV99,
 13811           DFHEIV99
 13812     SET ADDRESS OF PENDING-PAY-ADJ TO
 13813         DFHEIV20
 13814     MOVE EIBRESP  TO WS-RESPONSE
 13815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13816                 IF RESP-NORMAL
 13817
 13818* EXEC CICS DELETE
 13819*                      DATASET   (FILE-ID-ERPYAJ)
 13820*                      RESP      (WS-RESPONSE)
 13821*                   END-EXEC
 13822*    MOVE '&(                    &  N#00012458' TO DFHEIV0
 13823     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13824     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13825     MOVE X'204E233030303132343538' TO DFHEIV0(25:11)
 13826     CALL 'kxdfhei1' USING DFHEIV0,
 13827           FILE-ID-ERPYAJ,
 13828           DFHEIV99,
 13829           DFHEIV99,
 13830           DFHEIV99,
 13831           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 252
* VP6311.cbl
 13832     MOVE EIBRESP  TO WS-RESPONSE
 13833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13834                 END-IF
 13835              ELSE
 13836                 SET REVERSAL    TO TRUE
 13837                 PERFORM 1600-UPDATE-ERPYAJ
 13838                                 THRU 1600-EXIT
 13839                 GO TO 1900-EXIT
 13840              END-IF
 13841           ELSE
 13842              GO TO 1900-READNEXT-ERPYAJ-B
 13843           END-IF
 13844        END-IF
 13845
 13846* EXEC CICS ENDBR
 13847*          DATASET   (FILE-ID-ERPYAJ)
 13848*       END-EXEC
 13849     MOVE 0
 13850       TO DFHEIV11
 13851*    MOVE '&2                    $   #00012473' TO DFHEIV0
 13852     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13853     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13854     MOVE X'2020233030303132343733' TO DFHEIV0(25:11)
 13855     CALL 'kxdfhei1' USING DFHEIV0,
 13856           FILE-ID-ERPYAJ,
 13857           DFHEIV11,
 13858           DFHEIV99
 13859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13860     END-IF
 13861     .
 13862 1900-GET-DEALER.
 13863     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13864     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13865     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13866     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13867     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13868     MOVE +10                    TO ERPYAJ-SEQ-NO
 13869     MOVE 'C'                    TO ERPYAJ-TYPE
 13870     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13871
 13872* EXEC CICS STARTBR
 13873*       DATASET    (FILE-ID-ERPYAJ)
 13874*       RIDFLD     (ERPYAJ-KEY)
 13875*       RESP       (WS-RESPONSE)
 13876*    END-EXEC
 13877     MOVE 0
 13878       TO DFHEIV11
 13879*    MOVE '&,         G          &  N#00012487' TO DFHEIV0
 13880     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13881     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13882     MOVE X'204E233030303132343837' TO DFHEIV0(25:11)
 13883     CALL 'kxdfhei1' USING DFHEIV0,
 13884           FILE-ID-ERPYAJ,
 13885           ERPYAJ-KEY,
 13886           DFHEIV99,
 13887           DFHEIV11,
 13888           DFHEIV99
 13889     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 253
* VP6311.cbl
 13890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13891     IF RESP-NORMAL
 13892        CONTINUE
 13893     ELSE
 13894        GO TO 1900-EXIT
 13895     END-IF
 13896     .
 13897 1900-READNEXT-ERPYAJ-D.
 13898*  GET THE DEALER ERPYAJ RECORD
 13899
 13900* EXEC CICS READNEXT
 13901*       DATASET    (FILE-ID-ERPYAJ)
 13902*       RIDFLD     (ERPYAJ-KEY)
 13903*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13904*       RESP       (WS-RESPONSE)
 13905*    END-EXEC
 13906     MOVE 0
 13907       TO DFHEIV11
 13908*    MOVE '&.S                   )  N#00012500' TO DFHEIV0
 13909     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13910     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13911     MOVE X'204E233030303132353030' TO DFHEIV0(25:11)
 13912     CALL 'kxdfhei1' USING DFHEIV0,
 13913           FILE-ID-ERPYAJ,
 13914           DFHEIV20,
 13915           DFHEIV99,
 13916           ERPYAJ-KEY,
 13917           DFHEIV99,
 13918           DFHEIV11,
 13919           DFHEIV99,
 13920           DFHEIV99
 13921     SET ADDRESS OF PENDING-PAY-ADJ TO
 13922         DFHEIV20
 13923     MOVE EIBRESP  TO WS-RESPONSE
 13924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13925     IF RESP-NORMAL
 13926        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13927           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13928              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13929                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13930
 13931* EXEC CICS READ
 13932*                   DATASET    (FILE-ID-ERPYAJ)
 13933*                   RIDFLD     (ERPYAJ-KEY)
 13934*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13935*                   RESP       (WS-RESPONSE)
 13936*                   UPDATE
 13937*                END-EXEC
 13938*    MOVE '&"S        EU         (  N#00012511' TO DFHEIV0
 13939     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13940     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13941     MOVE X'204E233030303132353131' TO DFHEIV0(25:11)
 13942     CALL 'kxdfhei1' USING DFHEIV0,
 13943           FILE-ID-ERPYAJ,
 13944           DFHEIV20,
 13945           DFHEIV99,
 13946           ERPYAJ-KEY,
 13947           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 254
* VP6311.cbl
 13948           DFHEIV99,
 13949           DFHEIV99
 13950     SET ADDRESS OF PENDING-PAY-ADJ TO
 13951         DFHEIV20
 13952     MOVE EIBRESP  TO WS-RESPONSE
 13953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13954                 IF RESP-NORMAL
 13955
 13956* EXEC CICS DELETE
 13957*                      DATASET   (FILE-ID-ERPYAJ)
 13958*                      RESP      (WS-RESPONSE)
 13959*                   END-EXEC
 13960*    MOVE '&(                    &  N#00012519' TO DFHEIV0
 13961     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13962     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13963     MOVE X'204E233030303132353139' TO DFHEIV0(25:11)
 13964     CALL 'kxdfhei1' USING DFHEIV0,
 13965           FILE-ID-ERPYAJ,
 13966           DFHEIV99,
 13967           DFHEIV99,
 13968           DFHEIV99,
 13969           DFHEIV99
 13970     MOVE EIBRESP  TO WS-RESPONSE
 13971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13972                 END-IF
 13973              ELSE
 13974                 SET REVERSAL    TO TRUE
 13975              END-IF
 13976           ELSE
 13977              GO TO 1900-READNEXT-ERPYAJ-D
 13978           END-IF
 13979        END-IF
 13980
 13981* EXEC CICS ENDBR
 13982*          DATASET   (FILE-ID-ERPYAJ)
 13983*       END-EXEC
 13984     MOVE 0
 13985       TO DFHEIV11
 13986*    MOVE '&2                    $   #00012531' TO DFHEIV0
 13987     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13988     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13989     MOVE X'2020233030303132353331' TO DFHEIV0(25:11)
 13990     CALL 'kxdfhei1' USING DFHEIV0,
 13991           FILE-ID-ERPYAJ,
 13992           DFHEIV11,
 13993           DFHEIV99
 13994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13995     END-IF
 13996     .
 13997 1900-EXIT.
 13998     EXIT.
 13999******************************************************************
 14000*            C A N C E L   M A I N L I N E                       *
 14001******************************************************************
 14002
 14003 2000-CANCEL-MAINLINE.
 14004     IF PI-DISPLAY-ORIGINAL-BATCH
 14005        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 255
* VP6311.cbl
 14006           MOVE ER-0023             TO EMI-ERROR
 14007           MOVE -1                  TO CMAINTL
 14008           MOVE AL-UABON            TO CMAINTA
 14009           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14010           GO TO 8200-SEND-DATAONLY
 14011        ELSE
 14012           NEXT SENTENCE
 14013     ELSE
 14014        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14015           MOVE ER-0023             TO EMI-ERROR
 14016           MOVE -1                  TO CMAINTL
 14017           MOVE AL-UABON            TO CMAINTA
 14018           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14019           GO TO 8200-SEND-DATAONLY.
 14020
 14021     IF CMAINTI = 'S'
 14022        GO TO 2100-SHOW-REQUEST.
 14023
 14024     IF NOT MODIFY-CAP
 14025         MOVE 'UPDATE'       TO SM-READ
 14026         PERFORM 9995-SECURITY-VIOLATION
 14027         MOVE ER-0070        TO EMI-ERROR
 14028         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14029         GO TO 8100-SEND-INITIAL-MAP.
 14030
 14031     IF CMAINTL GREATER THAN ZEROS
 14032        IF PI-PF6-FUNCTION
 14033           IF CMAINTI NOT = 'A'
 14034              MOVE AL-UABON  TO CMAINTA
 14035              MOVE -1        TO CMAINTL
 14036              MOVE ER-2260   TO EMI-ERROR
 14037              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14038              GO TO 8200-SEND-DATAONLY.
 14039
 14040     IF CCERTNOL = ZEROS
 14041       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14042         NEXT SENTENCE
 14043     ELSE
 14044         IF CCERTNOL NOT = ZEROS
 14045             MOVE AL-UANON       TO CCERTNOA
 14046         ELSE
 14047             MOVE -1             TO CCERTNOL
 14048             MOVE  1             TO SET-CURSOR-SW
 14049             MOVE ER-2218       TO EMI-ERROR
 14050             MOVE AL-UABON       TO CCERTNOA
 14051             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14052
 14053     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14054        NEXT SENTENCE
 14055     ELSE
 14056        IF CEFFDTL NOT = ZEROS
 14057           MOVE AL-UNNON         TO CEFFDTA
 14058           MOVE CEFFDTI TO DEEDIT-FIELD
 14059           PERFORM 8600-DEEDIT
 14060           MOVE 4                TO DC-OPTION-CODE
 14061           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14062           PERFORM 9700-DATE-LINK
 14063           IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 256
* VP6311.cbl
 14064              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14065              ELSE
 14066              MOVE -1            TO CEFFDTL
 14067              MOVE  1            TO SET-CURSOR-SW
 14068              MOVE ER-2226      TO EMI-ERROR
 14069              MOVE AL-UNBON      TO CEFFDTA
 14070              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14071          ELSE
 14072          MOVE -1                 TO CEFFDTL
 14073          MOVE  1                 TO SET-CURSOR-SW
 14074          MOVE ER-2220            TO EMI-ERROR
 14075          MOVE AL-UNBON           TO CEFFDTA
 14076          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14077
 14078     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14079
 14080     IF CCERTNOL NOT = ZEROS
 14081        MOVE CCERTNOI                TO WS-NEW-PRIME
 14082     ELSE
 14083        MOVE SPACES                  TO WS-NEW-PRIME.
 14084
 14085     IF CSUFIXL NOT = ZEROS
 14086        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14087     ELSE
 14088        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14089
 14090     IF CEFFDTL NOT = ZEROS
 14091        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14092     ELSE
 14093        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14094
 14095     IF CMAINTI = 'A' OR 'K' OR 'S'
 14096        NEXT SENTENCE
 14097     ELSE
 14098        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14099        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14100           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14101           WS-PB-RECORD-TYPE NOT = '2'
 14102           IF CMAINTI = 'C'
 14103              MOVE ER-2287          TO EMI-ERROR
 14104              MOVE -1               TO CCERTNOL
 14105              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14106              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14107              GO TO 8200-SEND-DATAONLY
 14108             ELSE
 14109              MOVE ER-2260          TO EMI-ERROR
 14110              MOVE -1               TO CCERTNOL
 14111              MOVE AL-UABON         TO CCERTNOA
 14112              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14113              GO TO 8200-SEND-DATAONLY.
 14114
 14115     IF CMAINTI = 'D'
 14116        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14117
 14118     IF CLSTNML GREATER THAN ZEROS
 14119         MOVE AL-UANON           TO CLSTNMA.
 14120
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 257
* VP6311.cbl
 14122
 14123******************************************************************
 14124*                                                                *
 14125*           E D I T   C A N C E L   C O V E R A G E S            *
 14126*                                                                *
 14127******************************************************************
 14128
 14129 2015-EDIT-COVERAGES.
 14130     IF CCANDT1L      GREATER THAN ZEROS OR
 14131        CREFND1L      GREATER THAN ZEROS OR
 14132        CCANDT2L      GREATER THAN ZEROS OR
 14133        CREFND2L      GREATER THAN ZEROS OR
 14134        CMTHD1L       GREATER THAN ZEROS OR
 14135        CMTHD2L       GREATER THAN ZEROS OR
 14136        CLIVESL       GREATER THAN ZEROS OR
 14137        CPAYEEL       GREATER THAN ZEROS OR
 14138        CFORCEL       GREATER THAN ZEROS OR
 14139        CBILCDL       GREATER THAN ZEROS OR
 14140        CCANREAL      GREATER THAN ZEROS
 14141            NEXT SENTENCE
 14142         ELSE
 14143            GO TO 2030-EDIT-COMPLETE.
 14144
 14145     IF CCANDT1L = ZEROS
 14146        AND (CMAINTI = 'C' OR 'K')
 14147        NEXT SENTENCE
 14148     ELSE
 14149        IF CCANDT1L      GREATER THAN ZEROS
 14150            MOVE AL-UNNON            TO CCANDT1A
 14151            IF CCANDT1I = SPACES
 14152               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14153            ELSE
 14154               MOVE CCANDT1I            TO DEEDIT-FIELD
 14155               PERFORM 8600-DEEDIT
 14156               IF DEEDIT-FIELD-V0   NUMERIC
 14157                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14158                  MOVE 4                TO DC-OPTION-CODE
 14159                  PERFORM 9700-DATE-LINK
 14160                  IF NO-CONVERSION-ERROR
 14161                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14162                  ELSE
 14163                      MOVE -1        TO CCANDT1L
 14164                      MOVE ER-2227   TO EMI-ERROR
 14165                      MOVE AL-UNBON  TO CCANDT1A
 14166                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14167               ELSE
 14168                  MOVE -1         TO CCANDT1L
 14169                  MOVE ER-2223    TO EMI-ERROR
 14170                  MOVE AL-UNBON   TO CCANDT1A
 14171                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14172        ELSE
 14173            IF CREFND1L GREATER THAN ZEROS
 14174               MOVE -1             TO CCANDT1L
 14175               MOVE ER-2222        TO EMI-ERROR
 14176               MOVE AL-UNBOF       TO CCANDT1A
 14177               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14178
 14179     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 258
* VP6311.cbl
 14180        AND (CMAINTI = 'C' OR 'K')
 14181         NEXT SENTENCE
 14182     ELSE
 14183         IF CREFND1L NOT = ZEROS
 14184            MOVE AL-UNNON        TO CREFND1A
 14185
 14186* EXEC CICS BIF DEEDIT
 14187*               FIELD  (CREFND1I)
 14188*               LENGTH (11)
 14189*           END-EXEC
 14190     MOVE 11
 14191       TO DFHEIV11
 14192*    MOVE '@"L                   #   #00012724' TO DFHEIV0
 14193     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14194     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14195     MOVE X'2020233030303132373234' TO DFHEIV0(25:11)
 14196     CALL 'kxdfhei1' USING DFHEIV0,
 14197           CREFND1I,
 14198           DFHEIV11
 14199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14200            MOVE CREFND1I        TO WS-CREFND1
 14201*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14202*           PERFORM 8600-DEEDIT
 14203*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14204            IF WS-CREFND1  = ZEROS
 14205               AND CMAINTI = 'A'
 14206             MOVE ER-2437        TO EMI-ERROR
 14207             MOVE -1             TO CREFND1L
 14208             MOVE AL-UNBON       TO CREFND1A
 14209             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14210
 14211     IF CCANREAL > +0
 14212        MOVE AL-UANON            TO CCANREAA
 14213        IF CCANREAI = 'R' OR ' '
 14214           CONTINUE
 14215        ELSE
 14216           MOVE ER-9841        TO EMI-ERROR
 14217           MOVE -1             TO CCANREAL
 14218           MOVE AL-UABON       TO CCANREAA
 14219           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14220        END-IF
 14221     END-IF
 14222     IF CMTHD1L EQUAL +0
 14223        NEXT SENTENCE
 14224     ELSE
 14225        IF CMTHD1L NOT = +0
 14226           MOVE AL-UNNON        TO CMTHD1A
 14227           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14228                         OR '5' OR '6' OR '8' OR '9'
 14229                         OR 'R' OR ' '
 14230              NEXT SENTENCE
 14231           ELSE
 14232              MOVE ER-0582        TO EMI-ERROR
 14233              MOVE -1             TO CMTHD1L
 14234              MOVE AL-UNBON       TO CMTHD1A
 14235              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14236
 14237     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 259
* VP6311.cbl
 14238        AND (CMAINTI = 'C' OR 'K')
 14239         NEXT SENTENCE
 14240     ELSE
 14241         IF CCANDT2L  GREATER THAN ZEROS
 14242             MOVE AL-UNNON       TO CCANDT2A
 14243             IF CCANDT2I = SPACES
 14244                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14245             ELSE
 14246                MOVE CCANDT2I       TO DEEDIT-FIELD
 14247                PERFORM 8600-DEEDIT
 14248                IF DEEDIT-FIELD-V0   NUMERIC
 14249                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14250                   MOVE 4                TO DC-OPTION-CODE
 14251                   PERFORM 9700-DATE-LINK
 14252                   IF NO-CONVERSION-ERROR
 14253                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14254                   ELSE
 14255                      MOVE -1       TO CCANDT2L
 14256                      MOVE ER-2227  TO EMI-ERROR
 14257                      MOVE AL-UNBON TO CCANDT2A
 14258                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14259                ELSE
 14260                   MOVE -1         TO CCANDT2L
 14261                   MOVE ER-2223    TO EMI-ERROR
 14262                   MOVE AL-UNBON   TO CCANDT2A
 14263                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14264         ELSE
 14265            IF CREFND2L GREATER THAN ZEROS
 14266               MOVE -1             TO CCANDT2L
 14267               MOVE ER-2222        TO EMI-ERROR
 14268               MOVE AL-UNBOF       TO CCANDT2A
 14269               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14270
 14271     IF CREFND2L = ZEROS
 14272        AND (CMAINTI = 'C' OR 'K')
 14273         NEXT SENTENCE
 14274     ELSE
 14275         IF CREFND2L NOT = ZEROS
 14276            MOVE AL-UNNON        TO CREFND2A
 14277
 14278* EXEC CICS BIF DEEDIT
 14279*               FIELD  (CREFND2I)
 14280*               LENGTH (11)
 14281*           END-EXEC
 14282     MOVE 11
 14283       TO DFHEIV11
 14284*    MOVE '@"L                   #   #00012805' TO DFHEIV0
 14285     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14286     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14287     MOVE X'2020233030303132383035' TO DFHEIV0(25:11)
 14288     CALL 'kxdfhei1' USING DFHEIV0,
 14289           CREFND2I,
 14290           DFHEIV11
 14291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14292            MOVE CREFND2I        TO WS-CREFND2
 14293*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14294*           PERFORM 8600-DEEDIT
 14295*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 260
* VP6311.cbl
 14296            IF WS-CREFND2  = ZEROS
 14297               AND CMAINTI = 'A'
 14298             MOVE ER-2437        TO EMI-ERROR
 14299             MOVE -1             TO CREFND2L
 14300             MOVE AL-UNBON       TO CREFND2A
 14301             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14302
 14303     IF CMTHD2L EQUAL +0
 14304        NEXT SENTENCE
 14305     ELSE
 14306        IF CMTHD2L NOT = +0
 14307           MOVE AL-UNNON        TO CMTHD2A
 14308           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14309                         OR '5' OR '6' OR '8' OR '9'
 14310                         OR ' ' OR 'R'
 14311              NEXT SENTENCE
 14312           ELSE
 14313              MOVE ER-0582        TO EMI-ERROR
 14314              MOVE -1             TO CMTHD2L
 14315              MOVE AL-UNBON       TO CMTHD2A
 14316              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14317
 14318     IF CLIVESL GREATER THAN ZEROS
 14319         MOVE CLIVESI            TO DEEDIT-FIELD
 14320         PERFORM 8600-DEEDIT
 14321         IF DEEDIT-FIELD-V0 NUMERIC
 14322             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14323             MOVE AL-UNNON       TO CLIVESA
 14324         ELSE
 14325             MOVE -1             TO CLIVESL
 14326             MOVE AL-UNBON       TO CLIVESA
 14327             MOVE ER-2223        TO EMI-ERROR
 14328             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14329
 14330     IF CFORCEL  NOT = ZEROS
 14331         IF FORCE-CAP
 14332            MOVE AL-UANON            TO CFORCEA
 14333         ELSE
 14334            MOVE ER-2945             TO EMI-ERROR
 14335            MOVE AL-UABON            TO CFORCEA
 14336            MOVE -1                  TO CFORCEL
 14337            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14338
 14339     IF CPAYEEL GREATER THAN ZEROS
 14340        MOVE AL-UANON            TO CPAYEEA.
 14341
 14342     IF CBILCDL NOT = ZEROS
 14343        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14344                             AND 'A' AND 'B' AND 'E'
 14345           MOVE ER-2225              TO EMI-ERROR
 14346           MOVE AL-UABON             TO CBILCDA
 14347           MOVE -1                   TO CBILCDL
 14348           MOVE  1                   TO SET-CURSOR-SW
 14349           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14350        ELSE
 14351           MOVE AL-UANON             TO CBILCDA.
 14352
 14353 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 261
* VP6311.cbl
 14354     IF EMI-ERROR = ZEROS
 14355         NEXT SENTENCE
 14356     ELSE
 14357         GO TO 8200-SEND-DATAONLY.
 14358
 14359     IF CMAINTI = 'A'
 14360        GO TO 2200-ADD-CANCEL-ROUTINE.
 14361
 14362     IF CMAINTI = 'C'
 14363        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14364
 14365     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14366
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 262
* VP6311.cbl
 14368
 14369******************************************************************
 14370*                                                                *
 14371*                   S H O W   C A N C E L                        *
 14372*                                                                *
 14373******************************************************************
 14374
 14375 2100-SHOW-REQUEST.
 14376     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14377
 14378     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14379        MOVE -1                  TO CMAINTL
 14380        GO TO 8200-SEND-DATAONLY.
 14381
 14382     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14383
 14384     IF CSUFIXL NOT = ZEROS
 14385        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14386       ELSE
 14387        MOVE SPACE            TO WS-NEW-SUFFIX.
 14388
 14389     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14390     PERFORM 8600-DEEDIT.
 14391     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14392     MOVE '4'                    TO DC-OPTION-CODE.
 14393     PERFORM 9700-DATE-LINK.
 14394     IF DATE-CONVERSION-ERROR
 14395        MOVE ER-0348             TO EMI-ERROR
 14396        MOVE -1                  TO CEFFDTL
 14397        MOVE AL-UABON            TO CEFFDTA
 14398        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14399        GO TO 8200-SEND-DATAONLY
 14400     ELSE
 14401        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14402        MOVE AL-UANON            TO CEFFDTA
 14403        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14404
 14405     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14406
 14407     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14408        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14409        MOVE 'Y'                    TO WS-SHOW-SW
 14410        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14411           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14412        ELSE
 14413           IF PI-FILE-BROWSE
 14414              GO TO 4300-BROWSE-FILE-FORWARD
 14415           ELSE
 14416              IF PI-CSR-BROWSE
 14417                 GO TO 4200-BROWSE-CSR-FORWARD
 14418              ELSE
 14419                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14420     ELSE
 14421        GO TO 3900-RE-DISPLAY-RECORD.
 14422
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 263
* VP6311.cbl
 14424
 14425
 14426******************************************************************
 14427*                                                                *
 14428*            A D D   C A N C E L   R O U T I N E                 *
 14429*                                                                *
 14430******************************************************************
 14431
 14432 2200-ADD-CANCEL-ROUTINE.
 14433     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14434
 14435
 14436* EXEC CICS GETMAIN
 14437*        SET     (ADDRESS OF PENDING-BUSINESS)
 14438*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14439*    END-EXEC.
 14440*    MOVE '," L                  $   #00012952' TO DFHEIV0
 14441     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14442     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14443     MOVE X'2020233030303132393532' TO DFHEIV0(25:11)
 14444     CALL 'kxdfhei1' USING DFHEIV0,
 14445           DFHEIV20,
 14446           ERPNDB-RECORD-LENGTH,
 14447           DFHEIV99
 14448     SET ADDRESS OF PENDING-BUSINESS TO
 14449         DFHEIV20
 14450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14451
 14452
 14453
 14454* EXEC CICS HANDLE CONDITION
 14455*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14456*    END-EXEC.
 14457*    MOVE '"$I                   ! 3 #00012957' TO DFHEIV0
 14458     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14459     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14460     MOVE X'3320233030303132393537' TO DFHEIV0(25:11)
 14461     CALL 'kxdfhei1' USING DFHEIV0
 14462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14463
 14464
 14465     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14466     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14467     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14468
 14469
 14470* EXEC CICS READ
 14471*        INTO    (PENDING-BUSINESS)
 14472*        DATASET (FILE-ID-ERPNDB)
 14473*        RIDFLD  (ERPNDB-KEY)
 14474*    END-EXEC.
 14475     MOVE LENGTH OF
 14476      PENDING-BUSINESS
 14477       TO DFHEIV11
 14478*    MOVE '&"IL       E          (   #00012965' TO DFHEIV0
 14479     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14480     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14481     MOVE X'2020233030303132393635' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 264
* VP6311.cbl
 14482     CALL 'kxdfhei1' USING DFHEIV0,
 14483           FILE-ID-ERPNDB,
 14484           PENDING-BUSINESS,
 14485           DFHEIV11,
 14486           ERPNDB-KEY,
 14487           DFHEIV99,
 14488           DFHEIV99,
 14489           DFHEIV99
 14490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14491
 14492
 14493     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14494
 14495     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14496     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14497     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14498     MOVE SPACES                 TO PENDING-BUSINESS.
 14499     MOVE 'PB'                   TO PB-RECORD-ID.
 14500     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14501     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14502     MOVE SPACES                 TO PB-CERT-SFX.
 14503     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14504     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14505                                    PB-ALT-CHG-SEQ-NO.
 14506
 14507     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14508     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14509     MOVE '2'                    TO PB-RECORD-TYPE.
 14510
 14511     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14512     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14513
 14514
 14515     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14516                                    PB-ALT-CHG-SEQ-NO
 14517                                    PB-C-LF-REF-CALC
 14518                                    PB-C-AH-REF-CALC
 14519                                    PB-C-LF-RFND-CLP
 14520                                    PB-C-AH-RFND-CLP
 14521                                    PB-CI-INSURED-AGE
 14522                                    PB-CI-LF-TERM
 14523                                    PB-CI-AH-TERM
 14524                                    PB-CI-LF-BENEFIT-CD
 14525                                    PB-CI-LF-BENEFIT-AMT
 14526                                    PB-CI-LF-ALT-BENEFIT-AMT
 14527                                    PB-CI-LF-PREMIUM-AMT
 14528                                    PB-CI-LF-ALT-PREMIUM-AMT
 14529                                    PB-CI-AH-BENEFIT-CD
 14530                                    PB-CI-AH-BENEFIT-AMT
 14531                                    PB-CI-AH-PREMIUM-AMT
 14532                                    PB-CI-PAY-FREQUENCY
 14533                                    PB-CI-LOAN-APR
 14534                                    PB-CI-LOAN-TERM
 14535                                    PB-CI-LIFE-COMMISSION
 14536                                    PB-CI-AH-COMMISSION
 14537                                    PB-CI-CURR-SEQ
 14538                                    PB-CI-AH-CANCEL-AMT
 14539                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 265
* VP6311.cbl
 14540                                    PB-CI-RATE-DEV-PCT-LF
 14541                                    PB-CI-RATE-DEV-PCT-AH
 14542                                    PB-CI-EXTENTION-DAYS
 14543                                    PB-CI-TERM-IN-DAYS
 14544                                    PB-CI-LIVES
 14545                                    PB-CI-LF-CRIT-PER
 14546                                    PB-CI-AH-CRIT-PER
 14547                                    PB-C-LF-REM-TERM
 14548                                    PB-C-AH-REM-TERM
 14549                                    PB-CHG-COUNT
 14550                                    PB-LF-BILLED-AMTS
 14551                                    PB-AH-BILLED-AMTS
 14552                                    PB-C-NH-INT-ON-REFS
 14553*                                   PB-C-MICROFILM-NO
 14554                                    PB-CALC-TOLERANCE.
 14555
 14556     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14557                                    PB-CI-AH-SETTLEMENT-DT
 14558                                    PB-CI-DEATH-DT
 14559                                    PB-CI-LF-PRIOR-CANCEL-DT
 14560                                    PB-CI-AH-PRIOR-CANCEL-DT
 14561                                    PB-CI-ENTRY-DT
 14562                                    PB-CI-LF-EXPIRE-DT
 14563                                    PB-CI-AH-EXPIRE-DT
 14564                                    PB-CI-LOAN-1ST-PMT-DT
 14565                                    PB-C-LF-CANCEL-DT
 14566                                    PB-C-AH-CANCEL-DT
 14567                                    PB-CREDIT-ACCEPT-DT
 14568                                    PB-BILLED-DT
 14569                                    PB-ACCT-EFF-DT
 14570                                    PB-ACCT-EXP-DT.
 14571
 14572     MOVE 'X'                    TO PB-FATAL-FLAG.
 14573
 14574     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14575
 14576     IF CSUFIXL     GREATER THAN ZEROS
 14577        MOVE CSUFIXI             TO PB-CERT-SFX.
 14578
 14579*    IF CMICRNOL  GREATER  ZEROS
 14580*        IF CMICRNOI  NUMERIC
 14581*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14582*            MOVE AL-UNNON       TO  CMICRNOA
 14583*        ELSE
 14584*            MOVE -1             TO  CMICRNOL
 14585*            MOVE AL-UNBON       TO  CMICRNOA
 14586*            MOVE ER-2701        TO  EMI-ERROR
 14587*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14588
 14589     IF CLSTNML     GREATER THAN ZEROS
 14590        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14591
 14592     IF CCANREAL > ZEROS
 14593        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14594     END-IF
 14595     IF CPCYNL > ZEROS
 14596        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14597     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 266
* VP6311.cbl
 14598     IF CCANDT1L    GREATER THAN ZEROS
 14599        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14600
 14601     IF CCANDT2L    GREATER THAN ZEROS
 14602        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14603
 14604     IF CMTHD1L    GREATER THAN +0
 14605        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14606
 14607     IF CMTHD2L    GREATER THAN +0
 14608        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14609
 14610     IF CREFND1L    GREATER THAN ZEROS
 14611        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14612        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14613     ELSE
 14614        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14615
 14616     IF CREFND2L    GREATER THAN ZEROS
 14617        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14618        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14619     ELSE
 14620        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14621
 14622     IF CLIVESL     GREATER THAN ZEROS
 14623        MOVE WS-CLIVES           TO PB-C-LIVES
 14624     ELSE
 14625        MOVE ZEROS               TO PB-C-LIVES.
 14626
 14627     IF CPAYEEL     GREATER THAN ZEROS
 14628        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14629
 14630     IF CFORCEL     GREATER THAN ZEROS
 14631        MOVE CFORCEI             TO PB-FORCE-CODE.
 14632
 14633     IF CBILCDL     GREATER THAN ZEROS
 14634        MOVE CBILCDI             TO PB-RECORD-BILL.
 14635
 14636*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14637
 14638 2260-WRITE-PB-RECORD.
 14639     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14640                                    PB-INPUT-BY.
 14641     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14642     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14643                                    PB-INPUT-DT.
 14644
 14645     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14646     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14647                                    PB-CONTROL-BY-ORIG-BATCH.
 14648
 14649     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14650     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14651     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14652     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14653     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14654
 14655     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 267
* VP6311.cbl
 14656
 14657     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14658
 14659     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14660     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14661     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14662
 14663     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14664     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14665
 14666 2275-WRITE-PENDING-BUSINESS.
 14667     MOVE 'A'                    TO JP-RECORD-TYPE.
 14668     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14669     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14670     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14671
 14672
 14673* EXEC CICS HANDLE CONDITION
 14674*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14675*    END-EXEC.
 14676*    MOVE '"$%                   ! 4 #00013150' TO DFHEIV0
 14677     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14679     MOVE X'3420233030303133313530' TO DFHEIV0(25:11)
 14680     CALL 'kxdfhei1' USING DFHEIV0
 14681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14682
 14683
 14684
 14685* EXEC CICS WRITE
 14686*        DATASET (FILE-ID-ERPNDB)
 14687*        FROM    (PENDING-BUSINESS)
 14688*        RIDFLD  (PB-CONTROL-PRIMARY)
 14689*    END-EXEC.
 14690     MOVE LENGTH OF
 14691      PENDING-BUSINESS
 14692       TO DFHEIV11
 14693*    MOVE '&$ L                  ''   #00013154' TO DFHEIV0
 14694     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14695     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14696     MOVE X'2020233030303133313534' TO DFHEIV0(25:11)
 14697     CALL 'kxdfhei1' USING DFHEIV0,
 14698           FILE-ID-ERPNDB,
 14699           PENDING-BUSINESS,
 14700           DFHEIV11,
 14701           PB-CONTROL-PRIMARY,
 14702           DFHEIV99,
 14703           DFHEIV99
 14704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14705
 14706
 14707     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14708
 14709     PERFORM 8400-LOG-JOURNAL-RECORD.
 14710
 14711******************************************************************
 14712*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14713******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 268
* VP6311.cbl
 14714
 14715     display ' made it to add orig CANCEL cert '
 14716     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14717     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14718     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14719     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14720
 14721
 14722* EXEC CICS READ
 14723*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14724*        DATASET (FILE-ID-ELCERT)
 14725*        RIDFLD  (ELCERT-KEY)
 14726*        RESP    (WS-RESPONSE)
 14727*    END-EXEC.
 14728*    MOVE '&"S        E          (  N#00013174' TO DFHEIV0
 14729     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14730     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14731     MOVE X'204E233030303133313734' TO DFHEIV0(25:11)
 14732     CALL 'kxdfhei1' USING DFHEIV0,
 14733           FILE-ID-ELCERT,
 14734           DFHEIV20,
 14735           DFHEIV99,
 14736           ELCERT-KEY,
 14737           DFHEIV99,
 14738           DFHEIV99,
 14739           DFHEIV99
 14740     SET ADDRESS OF CERTIFICATE-MASTER TO
 14741         DFHEIV20
 14742     MOVE EIBRESP  TO WS-RESPONSE
 14743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14744
 14745
 14746     IF NOT RESP-NORMAL
 14747        GO TO 2276-BYPASS-CRTO
 14748     END-IF
 14749
 14750     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14751     MOVE ' '                    TO WS-ERMAIL-SW
 14752
 14753
 14754* EXEC CICS READ
 14755*       DATASET   (FILE-ID-ERMAIL)
 14756*       SET       (ADDRESS OF MAILING-DATA)
 14757*       RIDFLD    (ERMAIL-KEY)
 14758*       RESP      (WS-RESPONSE)
 14759*    END-EXEC
 14760*    MOVE '&"S        E          (  N#00013188' TO DFHEIV0
 14761     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14762     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14763     MOVE X'204E233030303133313838' TO DFHEIV0(25:11)
 14764     CALL 'kxdfhei1' USING DFHEIV0,
 14765           FILE-ID-ERMAIL,
 14766           DFHEIV20,
 14767           DFHEIV99,
 14768           ERMAIL-KEY,
 14769           DFHEIV99,
 14770           DFHEIV99,
 14771           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 269
* VP6311.cbl
 14772     SET ADDRESS OF MAILING-DATA TO
 14773         DFHEIV20
 14774     MOVE EIBRESP  TO WS-RESPONSE
 14775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14776
 14777     IF RESP-NORMAL
 14778        SET ERMAIL-FOUND TO TRUE
 14779     END-IF
 14780
 14781     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14782
 14783     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14784     MOVE 'OC'                   TO OC-RECORD-ID
 14785     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14786                                 TO OC-CONTROL-PRIMARY (1:33)
 14787     MOVE 'I'                    TO OC-RECORD-TYPE
 14788     MOVE +4096                  TO OC-KEY-SEQ-NO
 14789     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14790     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14791     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14792
 14793     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14794     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14795     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14796     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14797     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14798     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14799     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14800     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14801     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14802     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14803     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14804     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14805     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14806     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14807     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14808     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14809     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14810     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14811     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14812     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14813     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14814     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14815     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14816     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14817     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14818     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14819     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14820     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14821     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14822     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14823     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14824     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14825
 14826     IF ERMAIL-FOUND
 14827        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14828     END-IF
 14829     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 270
* VP6311.cbl
 14830        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14831                           OC-INS-AGE-DEFAULT-FLAG
 14832        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14833                           OC-JNT-AGE-DEFAULT-FLAG
 14834     END-IF
 14835     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14836     .
 14837 2275-WRITE-ELCRTO.
 14838
 14839
 14840* EXEC CICS WRITE
 14841*       DATASET   ('ELCRTO')
 14842*       FROM      (ORIGINAL-CERTIFICATE)
 14843*       RIDFLD    (OC-CONTROL-PRIMARY)
 14844*       RESP      (WS-RESPONSE)
 14845*    END-EXEC
 14846     MOVE LENGTH OF
 14847      ORIGINAL-CERTIFICATE
 14848       TO DFHEIV11
 14849     MOVE 'ELCRTO' TO DFHEIV1
 14850*    MOVE '&$ L                  ''  N#00013257' TO DFHEIV0
 14851     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14852     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14853     MOVE X'204E233030303133323537' TO DFHEIV0(25:11)
 14854     CALL 'kxdfhei1' USING DFHEIV0,
 14855           DFHEIV1,
 14856           ORIGINAL-CERTIFICATE,
 14857           DFHEIV11,
 14858           OC-CONTROL-PRIMARY,
 14859           DFHEIV99,
 14860           DFHEIV99
 14861     MOVE EIBRESP  TO WS-RESPONSE
 14862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14863
 14864     display ' just wrote 2275 ' ws-response
 14865     IF RESP-DUPKEY
 14866        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14867        GO TO 2275-WRITE-ELCRTO
 14868     ELSE
 14869        IF NOT RESP-NORMAL
 14870           MOVE -1               TO BMAINTL
 14871           MOVE ER-7450          TO EMI-ERROR
 14872           PERFORM 9900-ERROR-FORMAT
 14873                                 THRU 9900-EXIT
 14874           GO TO 8200-SEND-DATAONLY
 14875        END-IF
 14876     END-IF.
 14877
 14878 2276-BYPASS-CRTO.
 14879******************************************************************
 14880*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14881******************************************************************
 14882
 14883
 14884* EXEC CICS READ
 14885*        INTO    (PENDING-BUSINESS)
 14886*        DATASET (FILE-ID-ERPNDB)
 14887*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 271
* VP6311.cbl
 14888*        UPDATE
 14889*    END-EXEC.
 14890     MOVE LENGTH OF
 14891      PENDING-BUSINESS
 14892       TO DFHEIV11
 14893*    MOVE '&"IL       EU         (   #00013283' TO DFHEIV0
 14894     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14895     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14896     MOVE X'2020233030303133323833' TO DFHEIV0(25:11)
 14897     CALL 'kxdfhei1' USING DFHEIV0,
 14898           FILE-ID-ERPNDB,
 14899           PENDING-BUSINESS,
 14900           DFHEIV11,
 14901           ERPNDB-KEY,
 14902           DFHEIV99,
 14903           DFHEIV99,
 14904           DFHEIV99
 14905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14906
 14907
 14908     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14909     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14910     MOVE 'B'                    TO JP-RECORD-TYPE.
 14911     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14912
 14913     PERFORM 8400-LOG-JOURNAL-RECORD.
 14914
 14915     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14916
 14917
 14918* EXEC CICS REWRITE
 14919*        DATASET (FILE-ID-ERPNDB)
 14920*        FROM    (PENDING-BUSINESS)
 14921*    END-EXEC.
 14922     MOVE LENGTH OF
 14923      PENDING-BUSINESS
 14924       TO DFHEIV11
 14925*    MOVE '&& L                  %   #00013299' TO DFHEIV0
 14926     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14927     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14928     MOVE X'2020233030303133323939' TO DFHEIV0(25:11)
 14929     CALL 'kxdfhei1' USING DFHEIV0,
 14930           FILE-ID-ERPNDB,
 14931           PENDING-BUSINESS,
 14932           DFHEIV11,
 14933           DFHEIV99
 14934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14935
 14936
 14937     MOVE 'C'                    TO JP-RECORD-TYPE.
 14938     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14939
 14940     PERFORM 8400-LOG-JOURNAL-RECORD.
 14941
 14942     IF WS-ERRORS-PRESENT
 14943        GO TO 3900-RE-DISPLAY-RECORD.
 14944
 14945     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 272
* VP6311.cbl
 14946     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14947     MOVE LOW-VALUES             TO VP631CI.
 14948     MOVE  -1                    TO CMAINTL.
 14949     GO TO 8100-SEND-INITIAL-MAP.
 14950
 14951 2280-BATCH-HDR-NOT-FOUND.
 14952     MOVE -1                     TO BMAINTL.
 14953     MOVE ER-7450                TO EMI-ERROR.
 14954     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14955     GO TO 8200-SEND-DATAONLY.
 14956
 14957 2290-DUPLICATE-ALT-INDEX.
 14958
 14959******************************************************************
 14960*                                                                *
 14961*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14962*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14963*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14964*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14965*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14966*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14967*                                                                *
 14968******************************************************************
 14969
 14970     IF LCP-ONCTR-02 =  0
 14971         ADD 1 TO LCP-ONCTR-02
 14972        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14973
 14974     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14975
 14976     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 14977         NEXT SENTENCE
 14978     ELSE
 14979         ADD +1 TO PB-BATCH-SEQ-NO
 14980                   PB-CSR-BATCH-SEQ-NO
 14981         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 14982         GO TO 2275-WRITE-PENDING-BUSINESS.
 14983
 14984     MOVE -1                     TO CCERTNOL.
 14985     MOVE AL-UABON               TO CCERTNOA.
 14986     MOVE AL-UNBON               TO CEFFDTA.
 14987
 14988     MOVE 1                      TO EMI-SUB
 14989                                    EMI-SWITCH1
 14990                                    EMI-SWITCH-AREA-1
 14991                                    EMI-SWITCH-AREA-2.
 14992
 14993     MOVE SPACES                 TO EMI-ERROR-LINES.
 14994
 14995
 14996* EXEC CICS SYNCPOINT ROLLBACK
 14997*    END-EXEC.
 14998*    MOVE '6"R                   !   #00013362' TO DFHEIV0
 14999     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15000     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15001     MOVE X'2020233030303133333632' TO DFHEIV0(25:11)
 15002     CALL 'kxdfhei1' USING DFHEIV0
 15003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 273
* VP6311.cbl
 15004
 15005
 15006     MOVE ER-2247                TO EMI-ERROR.
 15007     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15008     GO TO 8200-SEND-DATAONLY.
 15009
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 274
* VP6311.cbl
 15011
 15012******************************************************************
 15013*                                                                *
 15014*          C H A N G E   C A N C E L   R O U T I N E             *
 15015*                                                                *
 15016******************************************************************
 15017
 15018***************************************************************
 15019*                                                             *
 15020*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15021*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15022*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15023*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15024*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15025*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15026*     5. LINK TO THE EDIT ROUTINE.                            *
 15027*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15028*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15029*              THE EDIT ROUTINE.                              *
 15030*     7. REWRITE THE NEW ISSUE                                *
 15031*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15032*                                                             *
 15033***************************************************************
 15034 2300-CHANGE-CANCEL-ROUTINE.
 15035     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15036
 15037     IF CCHGL NOT = ZEROS
 15038        MOVE ER-2196             TO EMI-ERROR
 15039        MOVE AL-UABON            TO CMAINTA
 15040        MOVE -1                  TO CMAINTL
 15041        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15042        GO TO 8200-SEND-DATAONLY.
 15043
 15044     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15045
 15046     IF CSUFIXL NOT = ZEROS
 15047        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15048     ELSE
 15049        MOVE SPACE               TO WS-NEW-SUFFIX.
 15050
 15051     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15052     PERFORM 8600-DEEDIT.
 15053     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15054     MOVE '4'                    TO DC-OPTION-CODE.
 15055
 15056     PERFORM 9700-DATE-LINK.
 15057
 15058     IF DATE-CONVERSION-ERROR
 15059        MOVE ER-0348             TO EMI-ERROR
 15060        MOVE -1                  TO CEFFDTL
 15061        MOVE AL-UABON            TO CEFFDTA
 15062        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15063        GO TO 8200-SEND-DATAONLY
 15064     ELSE
 15065        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15066        MOVE AL-UANON            TO CEFFDTA
 15067        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15068
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 275
* VP6311.cbl
 15069 2325-PROCESS-CANCEL-CHANGES.
 15070
 15071* EXEC CICS HANDLE CONDITION
 15072*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15073*    END-EXEC.
 15074*    MOVE '"$I                   ! 5 #00013429' TO DFHEIV0
 15075     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15076     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15077     MOVE X'3520233030303133343239' TO DFHEIV0(25:11)
 15078     CALL 'kxdfhei1' USING DFHEIV0
 15079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15080
 15081
 15082     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15083     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15084     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15085
 15086
 15087* EXEC CICS GETMAIN
 15088*        SET      (ADDRESS OF PENDING-BUSINESS)
 15089*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15090*        INITIMG  (GETMAIN-SPACE)
 15091*     END-EXEC.
 15092*    MOVE ',"IL                  $   #00013437' TO DFHEIV0
 15093     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15094     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15095     MOVE X'2020233030303133343337' TO DFHEIV0(25:11)
 15096     CALL 'kxdfhei1' USING DFHEIV0,
 15097           DFHEIV20,
 15098           ERPNDB-RECORD-LENGTH,
 15099           GETMAIN-SPACE
 15100     SET ADDRESS OF PENDING-BUSINESS TO
 15101         DFHEIV20
 15102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15103
 15104
 15105
 15106* EXEC CICS READ
 15107*        INTO    (PENDING-BUSINESS)
 15108*        DATASET (FILE-ID-ERPNDB)
 15109*        RIDFLD  (ERPNDB-KEY)
 15110*    END-EXEC.
 15111     MOVE LENGTH OF
 15112      PENDING-BUSINESS
 15113       TO DFHEIV11
 15114*    MOVE '&"IL       E          (   #00013443' TO DFHEIV0
 15115     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15116     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15117     MOVE X'2020233030303133343433' TO DFHEIV0(25:11)
 15118     CALL 'kxdfhei1' USING DFHEIV0,
 15119           FILE-ID-ERPNDB,
 15120           PENDING-BUSINESS,
 15121           DFHEIV11,
 15122           ERPNDB-KEY,
 15123           DFHEIV99,
 15124           DFHEIV99,
 15125           DFHEIV99
 15126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 276
* VP6311.cbl
 15127
 15128
 15129     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15130
 15131
 15132* EXEC CICS HANDLE CONDITION
 15133*         NOTFND     (2385-REC-NOT-FOUND)
 15134*    END-EXEC.
 15135*    MOVE '"$I                   ! 6 #00013451' TO DFHEIV0
 15136     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15137     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15138     MOVE X'3620233030303133343531' TO DFHEIV0(25:11)
 15139     CALL 'kxdfhei1' USING DFHEIV0
 15140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15141
 15142
 15143**********************************************************
 15144*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15145*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15146**********************************************************
 15147
 15148
 15149* EXEC CICS READ
 15150*        DATASET (FILE-ID-ERPNDB)
 15151*        INTO    (PENDING-BUSINESS)
 15152*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15153*    END-EXEC.
 15154     MOVE LENGTH OF
 15155      PENDING-BUSINESS
 15156       TO DFHEIV11
 15157*    MOVE '&"IL       E          (   #00013460' TO DFHEIV0
 15158     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15159     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15160     MOVE X'2020233030303133343630' TO DFHEIV0(25:11)
 15161     CALL 'kxdfhei1' USING DFHEIV0,
 15162           FILE-ID-ERPNDB,
 15163           PENDING-BUSINESS,
 15164           DFHEIV11,
 15165           PI-PREV-CONTROL-PRIMARY,
 15166           DFHEIV99,
 15167           DFHEIV99,
 15168           DFHEIV99
 15169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15170
 15171
 15172********** DO NOT ALLOW CHANGES IF THRU A/R
 15173     IF BMAINTI = 'C'
 15174         IF PB-EL860-INTERNAL-PROCESS
 15175             MOVE ER-4005          TO EMI-ERROR
 15176             MOVE -1               TO BMAINTL
 15177             MOVE AL-UABON         TO BMAINTA
 15178             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15179             GO TO 8200-SEND-DATAONLY.
 15180**********
 15181
 15182     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15183        MOVE -1                 TO CMAINTL
 15184        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 277
* VP6311.cbl
 15185        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15186        GO TO 8200-SEND-DATAONLY.
 15187
 15188     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15189        MOVE ER-2196             TO EMI-ERROR
 15190        MOVE AL-UABON            TO CMAINTA
 15191        MOVE -1                  TO CMAINTL
 15192        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15193        GO TO 8200-SEND-DATAONLY.
 15194     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15195
 15196     IF PB-BILLED-DT = LOW-VALUES AND
 15197        PB-CHG-COUNT = ZEROS
 15198        NEXT SENTENCE
 15199     ELSE
 15200        IF (CREFND1L GREATER THAN ZEROS AND
 15201            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15202           OR
 15203           (CREFND2L GREATER THAN ZEROS AND
 15204            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15205           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15206     if ((crefnd1l <> zeros)
 15207        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15208                      or
 15209        ((crefnd2l <> zeros)
 15210        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15211        continue
 15212     else
 15213        go to 2330-continue-change
 15214     end-if
 15215
 15216     move zeros                  to ws-check-amts
 15217     move ' '                    to ws-stop-sw
 15218                                    ws-check-sw
 15219                                    ws-proc-check-sw
 15220                                    ws-chek-browse-sw
 15221
 15222     perform 2500-browse-checks  thru 2500-exit
 15223
 15224     if i-have-processed-checks
 15225        or i-have-checks
 15226        continue
 15227     else
 15228        go to 2330-continue-change
 15229     end-if
 15230
 15231     if crefnd1l <> zeros
 15232        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15233        move ws-crefnd1 to ws-new-ref-total
 15234     else
 15235        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15236     end-if
 15237     if crefnd2l <> zeros
 15238        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15239        compute ws-new-ref-total = ws-new-ref-total +
 15240           ws-crefnd2
 15241     else
 15242        compute ws-new-ref-total = ws-new-ref-total +
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 278
* VP6311.cbl
 15243           pb-c-ah-cancel-amt
 15244     end-if
 15245
 15246     if zeros = (ws-lf-diff + ws-ah-diff)
 15247        move er-3449             to emi-error
 15248        perform 9900-error-format thru 9900-exit
 15249        go to 2330-continue-change
 15250     end-if
 15251
 15252     if (ws-new-ref-total < ws-check-amts)
 15253        and (pb-c-refund-sw = 'Y')
 15254        move er-3447             to emi-error
 15255        perform 9900-error-format thru 9900-exit
 15256        move al-uabon            to cmainta
 15257        move -1                  to cmaintl
 15258        go to 8200-send-dataonly
 15259     end-if
 15260
 15261     if (ws-new-ref-total > ws-check-amts)
 15262        and (ws-check-amts not = zeros)
 15263        move er-3448             to emi-error
 15264        move al-uabon            to crefnd1a
 15265                                    crefnd2a
 15266        perform 9900-error-format thru 9900-exit
 15267     end-if
 15268
 15269*     if (ws-lf-diff + ws-ah-diff) < zeros
 15270*        move er-3447             to emi-error
 15271*        perform 9900-error-format thru 9900-exit
 15272*        move al-uabon            to cmainta
 15273*        move -1                  to cmaintl
 15274*        go to 8200-send-dataonly
 15275*     end-if
 15276     .
 15277 2330-continue-change.
 15278
 15279
 15280* EXEC CICS READ
 15281*        DATASET (FILE-ID-ERPNDB)
 15282*        INTO    (PENDING-BUSINESS)
 15283*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15284*        UPDATE
 15285*    END-EXEC.
 15286     MOVE LENGTH OF
 15287      PENDING-BUSINESS
 15288       TO DFHEIV11
 15289*    MOVE '&"IL       EU         (   #00013573' TO DFHEIV0
 15290     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15291     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15292     MOVE X'2020233030303133353733' TO DFHEIV0(25:11)
 15293     CALL 'kxdfhei1' USING DFHEIV0,
 15294           FILE-ID-ERPNDB,
 15295           PENDING-BUSINESS,
 15296           DFHEIV11,
 15297           PI-PREV-CONTROL-PRIMARY,
 15298           DFHEIV99,
 15299           DFHEIV99,
 15300           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 279
* VP6311.cbl
 15301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15302
 15303
 15304     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15305     MOVE 'B'                    TO JP-RECORD-TYPE
 15306     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15307     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15308
 15309     PERFORM 8400-LOG-JOURNAL-RECORD.
 15310
 15311     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15312          PB-CHG-COUNT NOT = ZEROS
 15313        IF (CREFND1L GREATER THAN ZEROS AND
 15314            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15315           OR
 15316           (CREFND2L GREATER THAN ZEROS AND
 15317            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15318            ADD +1                      TO PB-CHG-COUNT
 15319            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15320
 15321*    IF CMICRNOL  GREATER  ZEROS
 15322*        IF CMICRNOI  NUMERIC
 15323*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15324*            MOVE AL-UNNON       TO  CMICRNOA
 15325*        ELSE
 15326*            MOVE -1             TO  CMICRNOL
 15327*            MOVE AL-UNBON       TO  CMICRNOA
 15328*            MOVE ER-2701        TO  EMI-ERROR
 15329*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15330
 15331     IF CSUFIXL GREATER THAN ZEROS
 15332        MOVE CSUFIXI             TO PB-CERT-SFX.
 15333
 15334     IF CLSTNML GREATER THAN ZEROS
 15335         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15336
 15337     IF CCANREAL > ZEROS
 15338        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15339     END-IF
 15340     IF CPCYNL > ZEROS
 15341        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15342     END-IF
 15343     IF CCANDT1L    GREATER THAN ZEROS
 15344        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15345
 15346     IF CCANDT2L    GREATER THAN ZEROS
 15347        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15348
 15349     IF CMTHD1L    GREATER THAN +0
 15350        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15351
 15352     IF CMTHD2L    GREATER THAN +0
 15353        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15354
 15355     IF CREFND1L    GREATER THAN ZEROS
 15356        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15357        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15358        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 280
* VP6311.cbl
 15359        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15360
 15361     IF CREFND2L    GREATER THAN ZEROS
 15362        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15363        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15364        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15365        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15366
 15367     IF CLIVESL     GREATER THAN ZEROS
 15368        MOVE WS-CLIVES           TO PB-C-LIVES.
 15369
 15370     IF CPAYEEL     GREATER THAN ZEROS
 15371        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15372
 15373     IF CFORCEL     GREATER THAN ZEROS
 15374        MOVE CFORCEI             TO PB-FORCE-CODE.
 15375
 15376     IF CBILCDL     GREATER THAN ZEROS
 15377        MOVE CBILCDI             TO PB-RECORD-BILL.
 15378
 15379 2360-REWRITE-PB-RECORD.
 15380     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15381     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15382     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15383     MOVE 'C'                    TO JP-RECORD-TYPE.
 15384     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15385     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15386     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15387
 15388     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15389
 15390     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15391     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15392
 15393     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15394
 15395     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15396
 15397     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15398     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15399     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15400
 15401     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15402     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15403
 15404 2375-REWRITE-PENDING-BUSINESS.
 15405     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15406     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15407     MOVE 'C'                    TO JP-RECORD-TYPE.
 15408     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15409
 15410
 15411* EXEC CICS REWRITE
 15412*        DATASET (FILE-ID-ERPNDB)
 15413*        FROM    (PENDING-BUSINESS)
 15414*    END-EXEC.
 15415     MOVE LENGTH OF
 15416      PENDING-BUSINESS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 281
* VP6311.cbl
 15417       TO DFHEIV11
 15418*    MOVE '&& L                  %   #00013686' TO DFHEIV0
 15419     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15420     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15421     MOVE X'2020233030303133363836' TO DFHEIV0(25:11)
 15422     CALL 'kxdfhei1' USING DFHEIV0,
 15423           FILE-ID-ERPNDB,
 15424           PENDING-BUSINESS,
 15425           DFHEIV11,
 15426           DFHEIV99
 15427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15428
 15429
 15430     PERFORM 8400-LOG-JOURNAL-RECORD.
 15431
 15432******************************************************************
 15433*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15434******************************************************************
 15435
 15436     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15437     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15438     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15439     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15440
 15441
 15442* EXEC CICS READ
 15443*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15444*        DATASET (FILE-ID-ELCERT)
 15445*        RIDFLD  (ELCERT-KEY)
 15446*        RESP    (WS-RESPONSE)
 15447*    END-EXEC.
 15448*    MOVE '&"S        E          (  N#00013702' TO DFHEIV0
 15449     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15450     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15451     MOVE X'204E233030303133373032' TO DFHEIV0(25:11)
 15452     CALL 'kxdfhei1' USING DFHEIV0,
 15453           FILE-ID-ELCERT,
 15454           DFHEIV20,
 15455           DFHEIV99,
 15456           ELCERT-KEY,
 15457           DFHEIV99,
 15458           DFHEIV99,
 15459           DFHEIV99
 15460     SET ADDRESS OF CERTIFICATE-MASTER TO
 15461         DFHEIV20
 15462     MOVE EIBRESP  TO WS-RESPONSE
 15463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15464
 15465
 15466     IF NOT RESP-NORMAL
 15467        GO TO 2376-BYPASS-CRTO
 15468     END-IF
 15469
 15470
 15471     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15472     MOVE ' '                    TO WS-ERMAIL-SW
 15473
 15474
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 282
* VP6311.cbl
 15475* EXEC CICS READ
 15476*       DATASET   (FILE-ID-ERMAIL)
 15477*       SET       (ADDRESS OF MAILING-DATA)
 15478*       RIDFLD    (ERMAIL-KEY)
 15479*       RESP      (WS-RESPONSE)
 15480*    END-EXEC
 15481*    MOVE '&"S        E          (  N#00013717' TO DFHEIV0
 15482     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15483     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15484     MOVE X'204E233030303133373137' TO DFHEIV0(25:11)
 15485     CALL 'kxdfhei1' USING DFHEIV0,
 15486           FILE-ID-ERMAIL,
 15487           DFHEIV20,
 15488           DFHEIV99,
 15489           ERMAIL-KEY,
 15490           DFHEIV99,
 15491           DFHEIV99,
 15492           DFHEIV99
 15493     SET ADDRESS OF MAILING-DATA TO
 15494         DFHEIV20
 15495     MOVE EIBRESP  TO WS-RESPONSE
 15496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15497
 15498     IF RESP-NORMAL
 15499        SET ERMAIL-FOUND TO TRUE
 15500     END-IF
 15501
 15502     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15503
 15504     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15505                                 TO ELCRTO-KEY
 15506     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15507     MOVE +0                     TO ELCRTO-SEQ-NO
 15508
 15509
 15510* EXEC CICS READ
 15511*       DATASET   ('ELCRTO')
 15512*       INTO      (ORIGINAL-CERTIFICATE)
 15513*       RIDFLD    (ELCRTO-KEY)
 15514*       GTEQ
 15515*       RESP      (WS-RESPONSE)
 15516*    END-EXEC
 15517     MOVE LENGTH OF
 15518      ORIGINAL-CERTIFICATE
 15519       TO DFHEIV11
 15520     MOVE 'ELCRTO' TO DFHEIV1
 15521*    MOVE '&"IL       G          (  N#00013735' TO DFHEIV0
 15522     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15523     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15524     MOVE X'204E233030303133373335' TO DFHEIV0(25:11)
 15525     CALL 'kxdfhei1' USING DFHEIV0,
 15526           DFHEIV1,
 15527           ORIGINAL-CERTIFICATE,
 15528           DFHEIV11,
 15529           ELCRTO-KEY,
 15530           DFHEIV99,
 15531           DFHEIV99,
 15532           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 283
* VP6311.cbl
 15533     MOVE EIBRESP  TO WS-RESPONSE
 15534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15535
 15536     IF RESP-NORMAL
 15537        AND (OC-CONTROL-PRIMARY (1:33) =
 15538                 PB-CONTROL-BY-ACCOUNT (1:33))
 15539        AND (OC-RECORD-TYPE = 'I')
 15540        display ' resp norm, key =, type i '
 15541        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15542           display ' end proc blank '
 15543           display ' csr edit session ' PI-CSR-SESSION-SW
 15544           IF NOT CSR-EDIT-SESSION
 15545
 15546* EXEC CICS READ
 15547*                DATASET   ('ELCRTO')
 15548*                INTO      (ORIGINAL-CERTIFICATE)
 15549*                RIDFLD    (OC-CONTROL-PRIMARY)
 15550*                UPDATE
 15551*                RESP      (WS-RESPONSE)
 15552*             END-EXEC
 15553     MOVE LENGTH OF
 15554      ORIGINAL-CERTIFICATE
 15555       TO DFHEIV11
 15556     MOVE 'ELCRTO' TO DFHEIV1
 15557*    MOVE '&"IL       EU         (  N#00013752' TO DFHEIV0
 15558     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15559     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15560     MOVE X'204E233030303133373532' TO DFHEIV0(25:11)
 15561     CALL 'kxdfhei1' USING DFHEIV0,
 15562           DFHEIV1,
 15563           ORIGINAL-CERTIFICATE,
 15564           DFHEIV11,
 15565           OC-CONTROL-PRIMARY,
 15566           DFHEIV99,
 15567           DFHEIV99,
 15568           DFHEIV99
 15569     MOVE EIBRESP  TO WS-RESPONSE
 15570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15571              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15572              IF RESP-NORMAL
 15573                 display ' good read upd '
 15574                 IF OC-ISSUE-TRAN-IND = 'N'
 15575                    MOVE CM-INSURED-LAST-NAME   TO
 15576                         OC-INS-LAST-NAME
 15577                    MOVE CM-INSURED-FIRST-NAME  TO
 15578                         OC-INS-FIRST-NAME
 15579                    MOVE CM-INSURED-INITIAL2    TO
 15580                         OC-INS-MIDDLE-INIT
 15581                    MOVE CM-INSURED-ISSUE-AGE   TO
 15582                         OC-INS-AGE
 15583                    MOVE CM-JT-LAST-NAME        TO
 15584                         OC-JNT-LAST-NAME
 15585                    MOVE CM-JT-FIRST-NAME       TO
 15586                         OC-JNT-FIRST-NAME
 15587                    MOVE CM-JT-INITIAL          TO
 15588                         OC-JNT-MIDDLE-INIT
 15589                    MOVE CM-INSURED-JOINT-AGE   TO
 15590                         OC-JNT-AGE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 284
* VP6311.cbl
 15591                    MOVE CM-LF-BENEFIT-CD       TO
 15592                         OC-LF-BENCD
 15593                    MOVE CM-LF-ORIG-TERM        TO
 15594                         OC-LF-TERM
 15595                    MOVE CM-LF-BENEFIT-AMT      TO
 15596                         OC-LF-BEN-AMT
 15597                    MOVE CM-LF-PREMIUM-AMT      TO
 15598                         OC-LF-PRM-AMT
 15599                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15600                         OC-LF-ALT-BEN-AMT
 15601                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15602                         OC-LF-ALT-PRM-AMT
 15603                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15604                         OC-LF-EXP-DT
 15605                    MOVE CM-LIFE-COMM-PCT       TO
 15606                         OC-LF-COMM-PCT
 15607                    MOVE CM-AH-BENEFIT-CD       TO
 15608                         OC-AH-BENCD
 15609                    MOVE CM-AH-ORIG-TERM        TO
 15610                         OC-AH-TERM
 15611                    MOVE CM-AH-BENEFIT-AMT      TO
 15612                         OC-AH-BEN-AMT
 15613                    MOVE CM-AH-PREMIUM-AMT      TO
 15614                         OC-AH-PRM-AMT
 15615                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15616                         OC-AH-EXP-DT
 15617                    MOVE CM-AH-COMM-PCT         TO
 15618                         OC-AH-COMM-PCT
 15619                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15620                         OC-AH-CP
 15621                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15622                         OC-1ST-PMT-DT
 15623                 END-IF
 15624                 MOVE PB-C-LF-CANCEL-DT      TO
 15625                         OC-LF-CANCEL-DT
 15626                 MOVE PB-C-LF-CANCEL-AMT     TO
 15627                         OC-LF-CANCEL-AMT
 15628                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15629                         OC-LF-ITD-CANCEL-AMT
 15630                 MOVE PB-C-AH-CANCEL-DT      TO
 15631                         OC-AH-CANCEL-DT
 15632                 MOVE PB-C-AH-CANCEL-AMT     TO
 15633                         OC-AH-CANCEL-AMT
 15634                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15635                         OC-AH-ITD-CANCEL-AMT
 15636                 MOVE 'Y'                    TO
 15637                         OC-CANCEL-TRAN-IND
 15638                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15639                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15640                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15641                 IF ERMAIL-FOUND
 15642                    MOVE MA-CRED-BENE-NAME
 15643                                 TO OC-CRED-BENE-NAME
 15644                 END-IF
 15645                 IF NOT CERT-TRL-REC-NOT-FOUND
 15646                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15647                           OC-INS-AGE-DEFAULT-FLAG
 15648                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 285
* VP6311.cbl
 15649                           OC-JNT-AGE-DEFAULT-FLAG
 15650                 END-IF
 15651
 15652* EXEC CICS REWRITE
 15653*                   DATASET   ('ELCRTO')
 15654*                   FROM      (ORIGINAL-CERTIFICATE)
 15655*                   RESP      (WS-RESPONSE)
 15656*                END-EXEC
 15657     MOVE LENGTH OF
 15658      ORIGINAL-CERTIFICATE
 15659       TO DFHEIV11
 15660     MOVE 'ELCRTO' TO DFHEIV1
 15661*    MOVE '&& L                  %  N#00013839' TO DFHEIV0
 15662     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15663     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15664     MOVE X'204E233030303133383339' TO DFHEIV0(25:11)
 15665     CALL 'kxdfhei1' USING DFHEIV0,
 15666           DFHEIV1,
 15667           ORIGINAL-CERTIFICATE,
 15668           DFHEIV11,
 15669           DFHEIV99
 15670     MOVE EIBRESP  TO WS-RESPONSE
 15671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15672                 display ' just rewrote ' ws-response
 15673              END-IF
 15674           END-IF
 15675        ELSE
 15676           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15677           MOVE 'OC'             TO OC-RECORD-ID
 15678           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15679           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15680           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15681           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15682           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15683           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15684           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15685           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15686           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15687           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15688           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15689           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15690           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15691           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15692           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15693           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15694           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15695           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15696           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15697           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15698           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15699           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15700           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15701           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15702           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15703           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15704           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15705           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15706           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 286
* VP6311.cbl
 15707           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15708           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15709           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15710           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15711           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15712           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15713           IF ERMAIL-FOUND
 15714              MOVE MA-CRED-BENE-NAME
 15715                                 TO OC-CRED-BENE-NAME
 15716           END-IF
 15717           IF NOT CERT-TRL-REC-NOT-FOUND
 15718              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15719                           OC-INS-AGE-DEFAULT-FLAG
 15720              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15721                           OC-JNT-AGE-DEFAULT-FLAG
 15722           END-IF
 15723           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15724
 15725* EXEC CICS WRITE
 15726*             DATASET   ('ELCRTO')
 15727*             FROM      (ORIGINAL-CERTIFICATE)
 15728*             RIDFLD    (OC-CONTROL-PRIMARY)
 15729*             RESP      (WS-RESPONSE)
 15730*          END-EXEC
 15731     MOVE LENGTH OF
 15732      ORIGINAL-CERTIFICATE
 15733       TO DFHEIV11
 15734     MOVE 'ELCRTO' TO DFHEIV1
 15735*    MOVE '&$ L                  ''  N#00013896' TO DFHEIV0
 15736     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15737     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15738     MOVE X'204E233030303133383936' TO DFHEIV0(25:11)
 15739     CALL 'kxdfhei1' USING DFHEIV0,
 15740           DFHEIV1,
 15741           ORIGINAL-CERTIFICATE,
 15742           DFHEIV11,
 15743           OC-CONTROL-PRIMARY,
 15744           DFHEIV99,
 15745           DFHEIV99
 15746     MOVE EIBRESP  TO WS-RESPONSE
 15747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15748        END-IF
 15749     ELSE
 15750        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15751        MOVE 'OC'                TO OC-RECORD-ID
 15752        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15753                                 TO OC-CONTROL-PRIMARY (1:33)
 15754        MOVE 'I'                 TO OC-RECORD-TYPE
 15755        MOVE +4096               TO OC-KEY-SEQ-NO
 15756        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15757        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15758        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15759        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15760        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15761        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15762        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15763        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15764        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 287
* VP6311.cbl
 15765        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15766        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15767        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15768        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15769        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15770        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15771        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15772        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15773        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15774        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15775        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15776        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15777        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15778        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15779        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15780        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15781        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15782        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15783        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15784        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15785        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15786        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15787        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15788        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15789        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15790        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15791        IF ERMAIL-FOUND
 15792           MOVE MA-CRED-BENE-NAME
 15793                                 TO OC-CRED-BENE-NAME
 15794        END-IF
 15795        IF NOT CERT-TRL-REC-NOT-FOUND
 15796           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15797                           OC-INS-AGE-DEFAULT-FLAG
 15798           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15799                           OC-JNT-AGE-DEFAULT-FLAG
 15800        END-IF
 15801        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15802
 15803
 15804* EXEC CICS WRITE
 15805*          DATASET   ('ELCRTO')
 15806*          FROM      (ORIGINAL-CERTIFICATE)
 15807*          RIDFLD    (OC-CONTROL-PRIMARY)
 15808*          RESP      (WS-RESPONSE)
 15809*       END-EXEC
 15810     MOVE LENGTH OF
 15811      ORIGINAL-CERTIFICATE
 15812       TO DFHEIV11
 15813     MOVE 'ELCRTO' TO DFHEIV1
 15814*    MOVE '&$ L                  ''  N#00013957' TO DFHEIV0
 15815     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15816     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15817     MOVE X'204E233030303133393537' TO DFHEIV0(25:11)
 15818     CALL 'kxdfhei1' USING DFHEIV0,
 15819           DFHEIV1,
 15820           ORIGINAL-CERTIFICATE,
 15821           DFHEIV11,
 15822           OC-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 288
* VP6311.cbl
 15823           DFHEIV99,
 15824           DFHEIV99
 15825     MOVE EIBRESP  TO WS-RESPONSE
 15826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15827     END-IF.
 15828
 15829 2376-BYPASS-CRTO.
 15830******************************************************************
 15831*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15832******************************************************************
 15833
 15834
 15835* EXEC CICS HANDLE CONDITION
 15836*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15837*    END-EXEC.
 15838*    MOVE '"$I                   ! 7 #00013970' TO DFHEIV0
 15839     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15840     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15841     MOVE X'3720233030303133393730' TO DFHEIV0(25:11)
 15842     CALL 'kxdfhei1' USING DFHEIV0
 15843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15844
 15845
 15846
 15847* EXEC CICS READ
 15848*        INTO    (PENDING-BUSINESS)
 15849*        DATASET (FILE-ID-ERPNDB)
 15850*        RIDFLD  (ERPNDB-KEY)
 15851*        UPDATE
 15852*    END-EXEC.
 15853     MOVE LENGTH OF
 15854      PENDING-BUSINESS
 15855       TO DFHEIV11
 15856*    MOVE '&"IL       EU         (   #00013974' TO DFHEIV0
 15857     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15858     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15859     MOVE X'2020233030303133393734' TO DFHEIV0(25:11)
 15860     CALL 'kxdfhei1' USING DFHEIV0,
 15861           FILE-ID-ERPNDB,
 15862           PENDING-BUSINESS,
 15863           DFHEIV11,
 15864           ERPNDB-KEY,
 15865           DFHEIV99,
 15866           DFHEIV99,
 15867           DFHEIV99
 15868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15869
 15870
 15871     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15872     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15873     MOVE 'B'                    TO JP-RECORD-TYPE.
 15874     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15875
 15876     PERFORM 8400-LOG-JOURNAL-RECORD.
 15877
 15878     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15879
 15880
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 289
* VP6311.cbl
 15881* EXEC CICS REWRITE
 15882*        DATASET (FILE-ID-ERPNDB)
 15883*        FROM    (PENDING-BUSINESS)
 15884*    END-EXEC.
 15885     MOVE LENGTH OF
 15886      PENDING-BUSINESS
 15887       TO DFHEIV11
 15888*    MOVE '&& L                  %   #00013990' TO DFHEIV0
 15889     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15890     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15891     MOVE X'2020233030303133393930' TO DFHEIV0(25:11)
 15892     CALL 'kxdfhei1' USING DFHEIV0,
 15893           FILE-ID-ERPNDB,
 15894           PENDING-BUSINESS,
 15895           DFHEIV11,
 15896           DFHEIV99
 15897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15898
 15899
 15900     MOVE 'C'                    TO JP-RECORD-TYPE.
 15901     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15902
 15903     PERFORM 8400-LOG-JOURNAL-RECORD.
 15904
 15905     IF WS-ERRORS-PRESENT
 15906         GO TO 3900-RE-DISPLAY-RECORD.
 15907
 15908     MOVE ZEROS                  TO EMI-ERROR
 15909     MOVE -1                     TO CMAINTL
 15910     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15911     GO TO 3900-RE-DISPLAY-RECORD.
 15912
 15913 2380-BATCH-HDR-NOT-FOUND.
 15914     MOVE -1                     TO BMAINTL.
 15915     MOVE ER-7450                TO EMI-ERROR.
 15916     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15917     GO TO 8200-SEND-DATAONLY.
 15918
 15919 2385-REC-NOT-FOUND.
 15920     MOVE -1                     TO BMAINTL.
 15921     MOVE ER-7451                TO EMI-ERROR.
 15922     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15923     GO TO 8200-SEND-DATAONLY.
 15924
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 290
* VP6311.cbl
 15926
 15927******************************************************************
 15928*                                                                *
 15929*          D E L E T E   C A N C E L   R O U T I N E             *
 15930*                                                                *
 15931******************************************************************
 15932
 15933 2400-DELETE-CANCEL-ROUTINE.
 15934     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15935
 15936     IF CCHGL NOT = ZEROS
 15937        MOVE ER-2196             TO EMI-ERROR
 15938        MOVE AL-UABON            TO CMAINTA
 15939        MOVE -1                  TO CMAINTL
 15940        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15941        GO TO 8200-SEND-DATAONLY.
 15942
 15943
 15944* EXEC CICS HANDLE CONDITION
 15945*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15946*    END-EXEC.
 15947*    MOVE '"$I                   ! 8 #00014038' TO DFHEIV0
 15948     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15949     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15950     MOVE X'3820233030303134303338' TO DFHEIV0(25:11)
 15951     CALL 'kxdfhei1' USING DFHEIV0
 15952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15953
 15954
 15955     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15956     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15957     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15958
 15959
 15960* EXEC CICS READ
 15961*        SET     (ADDRESS OF PENDING-BUSINESS)
 15962*        DATASET (FILE-ID-ERPNDB)
 15963*        RIDFLD  (ERPNDB-KEY)
 15964*    END-EXEC.
 15965*    MOVE '&"S        E          (   #00014046' TO DFHEIV0
 15966     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15967     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15968     MOVE X'2020233030303134303436' TO DFHEIV0(25:11)
 15969     CALL 'kxdfhei1' USING DFHEIV0,
 15970           FILE-ID-ERPNDB,
 15971           DFHEIV20,
 15972           DFHEIV99,
 15973           ERPNDB-KEY,
 15974           DFHEIV99,
 15975           DFHEIV99,
 15976           DFHEIV99
 15977     SET ADDRESS OF PENDING-BUSINESS TO
 15978         DFHEIV20
 15979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15980
 15981
 15982     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15983
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 291
* VP6311.cbl
 15984     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15985
 15986     IF CSUFIXL NOT = ZEROS
 15987        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15988     ELSE
 15989        MOVE SPACE               TO WS-NEW-SUFFIX.
 15990
 15991     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15992
 15993     PERFORM 8600-DEEDIT.
 15994     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15995     MOVE '4'                    TO DC-OPTION-CODE.
 15996     PERFORM 9700-DATE-LINK.
 15997
 15998     IF DATE-CONVERSION-ERROR
 15999        MOVE ER-0348             TO EMI-ERROR
 16000        MOVE -1                  TO CEFFDTL
 16001        MOVE AL-UABON            TO CEFFDTA
 16002        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16003        GO TO 8200-SEND-DATAONLY
 16004     ELSE
 16005        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16006        MOVE AL-UANON            TO CEFFDTA
 16007        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16008
 16009
 16010* EXEC CICS HANDLE CONDITION
 16011*         NOTFND    (2490-RECORD-NOT-FOUND)
 16012*    END-EXEC.
 16013*    MOVE '"$I                   ! 9 #00014079' TO DFHEIV0
 16014     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16015     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16016     MOVE X'3920233030303134303739' TO DFHEIV0(25:11)
 16017     CALL 'kxdfhei1' USING DFHEIV0
 16018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16019
 16020
 16021
 16022* EXEC CICS READ
 16023*        SET     (ADDRESS OF PENDING-BUSINESS)
 16024*        DATASET (FILE-ID-ERPNDB)
 16025*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16026*        UPDATE
 16027*    END-EXEC.
 16028*    MOVE '&"S        EU         (   #00014083' TO DFHEIV0
 16029     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16030     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16031     MOVE X'2020233030303134303833' TO DFHEIV0(25:11)
 16032     CALL 'kxdfhei1' USING DFHEIV0,
 16033           FILE-ID-ERPNDB,
 16034           DFHEIV20,
 16035           DFHEIV99,
 16036           PI-PREV-CONTROL-PRIMARY,
 16037           DFHEIV99,
 16038           DFHEIV99,
 16039           DFHEIV99
 16040     SET ADDRESS OF PENDING-BUSINESS TO
 16041         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 292
* VP6311.cbl
 16042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16043
 16044
 16045     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16046        MOVE -1                 TO CMAINTL
 16047        MOVE ER-2197            TO EMI-ERROR
 16048        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16049        GO TO 8200-SEND-DATAONLY.
 16050
 16051     IF PB-BILLED-DT NOT = LOW-VALUES
 16052        MOVE -1                 TO CMAINTL
 16053        MOVE ER-2129            TO EMI-ERROR
 16054        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16055        GO TO 8200-SEND-DATAONLY.
 16056
 16057     IF PB-CHG-COUNT NOT = ZEROS
 16058        MOVE ER-2336            TO EMI-ERROR
 16059        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16060        MOVE AL-UABON            TO CMAINTA
 16061        MOVE -1                  TO CMAINTL
 16062        GO TO 8200-SEND-DATAONLY.
 16063
 16064     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16065        PB-CHG-COUNT NOT = ZEROS
 16066        MOVE ER-2196             TO EMI-ERROR
 16067        MOVE AL-UABON            TO CMAINTA
 16068        MOVE -1                  TO CMAINTL
 16069        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16070        GO TO 8200-SEND-DATAONLY.
 16071
 16072     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16073        MOVE ER-2900 TO EMI-ERROR
 16074        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16075        MOVE AL-UABON         TO CMAINTA
 16076        MOVE -1               TO CMAINTL
 16077        GO TO 8200-SEND-DATAONLY.
 16078     move ' '                    to ws-stop-sw
 16079                                    ws-check-sw
 16080                                    ws-proc-check-sw
 16081                                    ws-chek-browse-sw
 16082
 16083     perform 2500-browse-checks  thru 2500-exit
 16084     if (i-have-processed-checks)
 16085        and (pb-c-refund-sw = 'Y')
 16086        move er-3446             to emi-error
 16087        perform 9900-error-format thru 9900-exit
 16088        move al-uabon            to cmainta
 16089        move -1                  to cmaintl
 16090        go to 8200-send-dataonly
 16091     end-if
 16092
 16093* EXEC CICS HANDLE CONDITION
 16094*         NOTFND  (2475-CONTINUE-DELETE)
 16095*    END-EXEC
 16096*    MOVE '"$I                   ! : #00014137' TO DFHEIV0
 16097     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16098     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16099     MOVE X'3A20233030303134313337' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 293
* VP6311.cbl
 16100     CALL 'kxdfhei1' USING DFHEIV0
 16101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16102
 16103     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16104     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16105     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16106     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16107
 16108
 16109* EXEC CICS READ
 16110*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16111*        DATASET (FILE-ID-ELCERT)
 16112*        RIDFLD  (ELCERT-KEY)
 16113*        UPDATE
 16114*    END-EXEC.
 16115*    MOVE '&"S        EU         (   #00014146' TO DFHEIV0
 16116     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16117     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16118     MOVE X'2020233030303134313436' TO DFHEIV0(25:11)
 16119     CALL 'kxdfhei1' USING DFHEIV0,
 16120           FILE-ID-ELCERT,
 16121           DFHEIV20,
 16122           DFHEIV99,
 16123           ELCERT-KEY,
 16124           DFHEIV99,
 16125           DFHEIV99,
 16126           DFHEIV99
 16127     SET ADDRESS OF CERTIFICATE-MASTER TO
 16128         DFHEIV20
 16129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16130
 16131
 16132     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16133
 16134     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16135     MOVE 'B'                    TO JP-RECORD-TYPE.
 16136     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16137     PERFORM 8400-LOG-JOURNAL-RECORD.
 16138
 16139     IF PB-CI-LIVES NOT NUMERIC
 16140         MOVE ZERO                    TO PB-CI-LIVES.
 16141
 16142     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16143        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16144           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16145           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16146           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16147                                            CM-LF-CANCEL-DT
 16148           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16149        ELSE
 16150           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16151           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16152           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16153           MOVE PB-CI-LIVES              TO CM-LIVES.
 16154
 16155     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16156        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16157           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 294
* VP6311.cbl
 16158               MOVE CM-LF-STATUS-AT-CANCEL
 16159                                        TO CM-LF-CURRENT-STATUS
 16160               MOVE SPACE
 16161                                        TO CM-LF-STATUS-AT-CANCEL
 16162           ELSE
 16163               MOVE PB-CI-LF-POLICY-STATUS
 16164                                        TO CM-LF-CURRENT-STATUS
 16165        ELSE
 16166           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16167
 16168
 16169     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16170        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16171           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16172           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16173           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16174                                            CM-AH-CANCEL-DT
 16175           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16176        ELSE
 16177           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16178           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16179           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16180           MOVE PB-CI-LIVES              TO CM-LIVES.
 16181
 16182     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16183        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16184           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16185               MOVE CM-AH-STATUS-AT-CANCEL
 16186                                        TO CM-AH-CURRENT-STATUS
 16187               MOVE SPACE
 16188                                        TO CM-AH-STATUS-AT-CANCEL
 16189           ELSE
 16190               MOVE PB-CI-AH-POLICY-STATUS
 16191                                        TO CM-AH-CURRENT-STATUS
 16192        ELSE
 16193           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16194
 16195 2450-REWRITE-CERT.
 16196     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16197     MOVE 'C'                      TO JP-RECORD-TYPE.
 16198     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16199
 16200
 16201* EXEC CICS REWRITE
 16202*        DATASET  (FILE-ID-ELCERT)
 16203*        FROM     (CERTIFICATE-MASTER)
 16204*    END-EXEC.
 16205     MOVE LENGTH OF
 16206      CERTIFICATE-MASTER
 16207       TO DFHEIV11
 16208*    MOVE '&& L                  %   #00014221' TO DFHEIV0
 16209     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16210     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16211     MOVE X'2020233030303134323231' TO DFHEIV0(25:11)
 16212     CALL 'kxdfhei1' USING DFHEIV0,
 16213           FILE-ID-ELCERT,
 16214           CERTIFICATE-MASTER,
 16215           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 295
* VP6311.cbl
 16216           DFHEIV99
 16217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16218
 16219
 16220     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16221
 16222     PERFORM 8400-LOG-JOURNAL-RECORD.
 16223
 16224     move ' '                    to ws-stop-sw
 16225                                    ws-proc-check-sw
 16226                                    ws-chek-browse-sw
 16227
 16228     if i-have-checks
 16229        perform until i-say-stop
 16230           perform 2510-startbr-erchek
 16231                                 thru 2510-exit
 16232           if resp-normal
 16233              perform 2520-readnext-erchek
 16234                                 thru 2520-exit
 16235           end-if
 16236           if (not resp-normal)
 16237              or (pb-control-by-account (1:33) not =
 16238                 ch-control-primary (1:33))
 16239                 set i-say-stop to true
 16240           else
 16241              perform 2530-readupd-erchek
 16242                                 thru 2530-exit
 16243              if resp-normal
 16244                 perform 2540-delete-erchek
 16245                                 thru 2540-exit
 16246              end-if
 16247              if ws-chek-browse-sw = 'Y'
 16248                 perform 2525-endbr-erchek
 16249                                 thru 2525-exit
 16250                 move ' '        to ws-chek-browse-sw
 16251              end-if
 16252           end-if
 16253        end-perform
 16254     end-if
 16255
 16256     if ws-chek-browse-sw = 'Y'
 16257        perform 2525-endbr-erchek thru 2525-exit
 16258     end-if
 16259     .
 16260 2475-CONTINUE-DELETE.
 16261     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16262     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16263
 16264     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16265     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16266
 16267     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16268
 16269     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16270     MOVE 'D'                    TO JP-RECORD-TYPE
 16271     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16272
 16273
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 296
* VP6311.cbl
 16274* EXEC CICS DELETE
 16275*        DATASET    (FILE-ID-ERPNDB)
 16276*    END-EXEC.
 16277*    MOVE '&(                    &   #00014279' TO DFHEIV0
 16278     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16279     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16280     MOVE X'2020233030303134323739' TO DFHEIV0(25:11)
 16281     CALL 'kxdfhei1' USING DFHEIV0,
 16282           FILE-ID-ERPNDB,
 16283           DFHEIV99,
 16284           DFHEIV99,
 16285           DFHEIV99,
 16286           DFHEIV99
 16287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16288
 16289
 16290     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16291
 16292     PERFORM 8400-LOG-JOURNAL-RECORD.
 16293
 16294     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16295     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16296
 16297
 16298* EXEC CICS HANDLE CONDITION
 16299*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16300*    END-EXEC.
 16301*    MOVE '"$I                   ! ; #00014290' TO DFHEIV0
 16302     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16304     MOVE X'3B20233030303134323930' TO DFHEIV0(25:11)
 16305     CALL 'kxdfhei1' USING DFHEIV0
 16306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16307
 16308
 16309
 16310* EXEC CICS READ
 16311*        SET     (ADDRESS OF PENDING-BUSINESS)
 16312*        DATASET (FILE-ID-ERPNDB)
 16313*        RIDFLD  (ERPNDB-KEY)
 16314*        UPDATE
 16315*    END-EXEC.
 16316*    MOVE '&"S        EU         (   #00014294' TO DFHEIV0
 16317     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16318     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16319     MOVE X'2020233030303134323934' TO DFHEIV0(25:11)
 16320     CALL 'kxdfhei1' USING DFHEIV0,
 16321           FILE-ID-ERPNDB,
 16322           DFHEIV20,
 16323           DFHEIV99,
 16324           ERPNDB-KEY,
 16325           DFHEIV99,
 16326           DFHEIV99,
 16327           DFHEIV99
 16328     SET ADDRESS OF PENDING-BUSINESS TO
 16329         DFHEIV20
 16330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16331
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 297
* VP6311.cbl
 16332
 16333     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16334     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16335
 16336     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16337        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16338        MOVE 'D'                 TO JP-RECORD-TYPE
 16339        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16340
 16341* EXEC CICS DELETE
 16342*            DATASET    (FILE-ID-ERPNDB)
 16343*       END-EXEC
 16344*    MOVE '&(                    &   #00014308' TO DFHEIV0
 16345     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16346     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16347     MOVE X'2020233030303134333038' TO DFHEIV0(25:11)
 16348     CALL 'kxdfhei1' USING DFHEIV0,
 16349           FILE-ID-ERPNDB,
 16350           DFHEIV99,
 16351           DFHEIV99,
 16352           DFHEIV99,
 16353           DFHEIV99
 16354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16355        PERFORM 8400-LOG-JOURNAL-RECORD
 16356     ELSE
 16357        MOVE 'B'                 TO JP-RECORD-TYPE
 16358        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16359        PERFORM 8400-LOG-JOURNAL-RECORD
 16360        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16361        MOVE 'C'                 TO JP-RECORD-TYPE
 16362        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16363
 16364* EXEC CICS REWRITE
 16365*            DATASET    (FILE-ID-ERPNDB)
 16366*            FROM       (PENDING-BUSINESS)
 16367*       END-EXEC
 16368     MOVE LENGTH OF
 16369      PENDING-BUSINESS
 16370       TO DFHEIV11
 16371*    MOVE '&& L                  %   #00014319' TO DFHEIV0
 16372     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16373     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16374     MOVE X'2020233030303134333139' TO DFHEIV0(25:11)
 16375     CALL 'kxdfhei1' USING DFHEIV0,
 16376           FILE-ID-ERPNDB,
 16377           PENDING-BUSINESS,
 16378           DFHEIV11,
 16379           DFHEIV99
 16380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16381        PERFORM 8400-LOG-JOURNAL-RECORD.
 16382
 16383******************************************************************
 16384*                                                                *
 16385*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16386*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16387*                                                                *
 16388******************************************************************
 16389
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 298
* VP6311.cbl
 16390     IF NOT PI-AR-PROCESSING
 16391        GO TO 2480-DELETE-FINISHED.
 16392
 16393     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16394        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16395        NEXT SENTENCE
 16396     ELSE
 16397        GO TO 2480-DELETE-FINISHED.
 16398
 16399
 16400* EXEC CICS HANDLE CONDITION
 16401*         NOTFND    (2480-DELETE-FINISHED)
 16402*    END-EXEC.
 16403*    MOVE '"$I                   ! < #00014341' TO DFHEIV0
 16404     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16406     MOVE X'3C20233030303134333431' TO DFHEIV0(25:11)
 16407     CALL 'kxdfhei1' USING DFHEIV0
 16408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16409
 16410
 16411     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16412     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16413
 16414
 16415* EXEC CICS READ
 16416*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16417*        DATASET (FILE-ID-ERRQST)
 16418*        RIDFLD  (ERRQST-KEY)
 16419*        UPDATE
 16420*    END-EXEC.
 16421*    MOVE '&"S        EU         (   #00014348' TO DFHEIV0
 16422     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16423     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16424     MOVE X'2020233030303134333438' TO DFHEIV0(25:11)
 16425     CALL 'kxdfhei1' USING DFHEIV0,
 16426           FILE-ID-ERRQST,
 16427           DFHEIV20,
 16428           DFHEIV99,
 16429           ERRQST-KEY,
 16430           DFHEIV99,
 16431           DFHEIV99,
 16432           DFHEIV99
 16433     SET ADDRESS OF AR-REQUEST-RECORD TO
 16434         DFHEIV20
 16435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16436
 16437
 16438     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16439
 16440     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16441
 16442     MOVE 'D'                      TO JP-RECORD-TYPE.
 16443     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16444
 16445
 16446* EXEC CICS DELETE
 16447*         DATASET    (FILE-ID-ERRQST)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 299
* VP6311.cbl
 16448*    END-EXEC.
 16449*    MOVE '&(                    &   #00014362' TO DFHEIV0
 16450     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16451     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16452     MOVE X'2020233030303134333632' TO DFHEIV0(25:11)
 16453     CALL 'kxdfhei1' USING DFHEIV0,
 16454           FILE-ID-ERRQST,
 16455           DFHEIV99,
 16456           DFHEIV99,
 16457           DFHEIV99,
 16458           DFHEIV99
 16459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16460
 16461
 16462     PERFORM 8400-LOG-JOURNAL-RECORD.
 16463
 16464 2480-DELETE-FINISHED.
 16465     MOVE ZEROS                  TO EMI-ERROR.
 16466     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16467     MOVE LOW-VALUES             TO VP631CI.
 16468     MOVE -1                     TO CMAINTL.
 16469     GO TO 8100-SEND-INITIAL-MAP.
 16470
 16471 2485-BATCH-HDR-NOT-FOUND.
 16472     MOVE -1                     TO CMAINTL
 16473     MOVE AL-UABON               TO CMAINTA.
 16474     MOVE ER-7450                TO EMI-ERROR.
 16475     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16476     GO TO 8200-SEND-DATAONLY.
 16477
 16478 2490-RECORD-NOT-FOUND.
 16479     MOVE -1                     TO CMAINTL
 16480     MOVE AL-UABON               TO CMAINTA.
 16481     MOVE ER-7451                TO EMI-ERROR.
 16482     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16483     GO TO 8200-SEND-DATAONLY.
 16484***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16485***                                                            ***
 16486***     2500  B R O W S E   C H E C K S                        ***
 16487***  We perform this routine from 2 different places.          ***
 16488***  1. If the user changes the refund amount on a cancel, we  ***
 16489***    want to.........                                        ***
 16490***    a. determine if prior checks have been processed        ***
 16491***    b. If the amt is larger, display message instructing    ***
 16492***     them to create another check to make up the difference.***
 16493***    c. If the amt is less, do not allow the change and      ***
 16494***     display a FATAL error suggesting they deal with check  ***
 16495***     records befor continuing.                              ***
 16496***  2. If the user wants to delete a cancel record we......   ***
 16497***    a. browse through all the checks and if there is a      ***
 16498***     processed check, send FATAL message.                   ***
 16499***    b. If there is a non-released check, then delete that   ***
 16500***     check after you delete the pending cancel record.      ***
 16501***                                                            ***
 16502***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16503
 16504 2500-browse-checks.
 16505
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 300
* VP6311.cbl
 16506     perform 2510-startbr-erchek thru 2510-exit
 16507
 16508     if not resp-normal
 16509        go to 2500-exit
 16510     end-if
 16511
 16512     perform until i-say-stop
 16513        perform 2520-readnext-erchek
 16514                                 thru 2520-exit
 16515        if (not resp-normal)
 16516           or (pb-control-by-account (1:33) not =
 16517              ch-control-primary (1:33))
 16518              set i-say-stop to true
 16519        else
 16520           if (ch-approval-status) = ' '
 16521              and (ch-void-dt = low-values)
 16522              and (ch-released-dt = low-values)
 16523              set i-have-checks to true
 16524           else
 16525              if ch-void-dt = low-values
 16526                 set i-have-processed-checks to true
 16527              end-if
 16528           end-if
 16529           if (ch-credit-accept-dt = low-values)
 16530              and (ch-void-dt = low-values)
 16531              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16532              if (ch-check-origin-sw not = 'R')
 16533                 and (pb-record-type = '2')
 16534                 continue
 16535              else
 16536                 compute ws-check-amts =
 16537                    ws-check-amts + ch-amount-paid
 16538              end-if
 16539           end-if
 16540        end-if
 16541     end-perform
 16542
 16543     if ws-chek-browse-sw = 'Y'
 16544        perform 2525-endbr-erchek thru 2525-exit
 16545     end-if
 16546
 16547    .
 16548 2500-exit.
 16549     exit.
 16550
 16551 2510-startbr-erchek.
 16552
 16553     move pb-control-by-account  to erchek-key
 16554     move +0                     to chek-record-seq
 16555
 16556
 16557* exec cics startbr
 16558*       dataset   ('ERCHEK')
 16559*       ridfld    (erchek-key)
 16560*       gteq
 16561*       resp      (ws-response)
 16562*    end-exec
 16563     MOVE 'ERCHEK' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 301
* VP6311.cbl
 16564     MOVE 0
 16565       TO DFHEIV11
 16566*    MOVE '&,         G          &  N#00014460' TO DFHEIV0
 16567     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16568     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16569     MOVE X'204E233030303134343630' TO DFHEIV0(25:11)
 16570     CALL 'kxdfhei1' USING DFHEIV0,
 16571           DFHEIV1,
 16572           erchek-key,
 16573           DFHEIV99,
 16574           DFHEIV11,
 16575           DFHEIV99
 16576     MOVE EIBRESP  TO ws-response
 16577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16578
 16579     IF RESP-NORMAL
 16580        move 'Y'                 to ws-chek-browse-sw
 16581     end-if
 16582
 16583     .
 16584 2510-exit.
 16585     exit.
 16586
 16587 2520-readnext-erchek.
 16588
 16589
 16590* EXEC CICS READNEXT
 16591*       SET     (ADDRESS OF CHECK-RECORDS)
 16592*       DATASET ('ERCHEK')
 16593*       RIDFLD  (ERCHEK-KEY)
 16594*       RESP    (WS-RESPONSE)
 16595*    END-EXEC
 16596     MOVE 'ERCHEK' TO DFHEIV1
 16597     MOVE 0
 16598       TO DFHEIV11
 16599*    MOVE '&.S                   )  N#00014477' TO DFHEIV0
 16600     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16601     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16602     MOVE X'204E233030303134343737' TO DFHEIV0(25:11)
 16603     CALL 'kxdfhei1' USING DFHEIV0,
 16604           DFHEIV1,
 16605           DFHEIV20,
 16606           DFHEIV99,
 16607           ERCHEK-KEY,
 16608           DFHEIV99,
 16609           DFHEIV11,
 16610           DFHEIV99,
 16611           DFHEIV99
 16612     SET ADDRESS OF CHECK-RECORDS TO
 16613         DFHEIV20
 16614     MOVE EIBRESP  TO WS-RESPONSE
 16615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16616
 16617     .
 16618 2520-exit.
 16619     exit.
 16620
 16621 2525-endbr-erchek.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 302
* VP6311.cbl
 16622
 16623
 16624* exec cics endbr
 16625*       dataset  ('ERCHEK')
 16626*    end-exec
 16627     MOVE 'ERCHEK' TO DFHEIV1
 16628     MOVE 0
 16629       TO DFHEIV11
 16630*    MOVE '&2                    $   #00014490' TO DFHEIV0
 16631     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16632     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16633     MOVE X'2020233030303134343930' TO DFHEIV0(25:11)
 16634     CALL 'kxdfhei1' USING DFHEIV0,
 16635           DFHEIV1,
 16636           DFHEIV11,
 16637           DFHEIV99
 16638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16639
 16640     .
 16641 2525-exit.
 16642     exit.
 16643
 16644 2530-readupd-erchek.
 16645
 16646
 16647* EXEC CICS READ
 16648*       UPDATE
 16649*       SET     (ADDRESS OF CHECK-RECORDS)
 16650*       DATASET ('ERCHEK')
 16651*       RIDFLD  (ERCHEK-KEY)
 16652*       RESP    (WS-RESPONSE)
 16653*    END-EXEC
 16654     MOVE 'ERCHEK' TO DFHEIV1
 16655*    MOVE '&"S        EU         (  N#00014500' TO DFHEIV0
 16656     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16657     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16658     MOVE X'204E233030303134353030' TO DFHEIV0(25:11)
 16659     CALL 'kxdfhei1' USING DFHEIV0,
 16660           DFHEIV1,
 16661           DFHEIV20,
 16662           DFHEIV99,
 16663           ERCHEK-KEY,
 16664           DFHEIV99,
 16665           DFHEIV99,
 16666           DFHEIV99
 16667     SET ADDRESS OF CHECK-RECORDS TO
 16668         DFHEIV20
 16669     MOVE EIBRESP  TO WS-RESPONSE
 16670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16671
 16672     .
 16673 2530-exit.
 16674     exit.
 16675
 16676 2540-delete-erchek.
 16677
 16678
 16679* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 303
* VP6311.cbl
 16680*       DATASET ('ERCHEK')
 16681*       RESP    (WS-RESPONSE)
 16682*    END-EXEC
 16683     MOVE 'ERCHEK' TO DFHEIV1
 16684*    MOVE '&(                    &  N#00014514' TO DFHEIV0
 16685     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16686     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16687     MOVE X'204E233030303134353134' TO DFHEIV0(25:11)
 16688     CALL 'kxdfhei1' USING DFHEIV0,
 16689           DFHEIV1,
 16690           DFHEIV99,
 16691           DFHEIV99,
 16692           DFHEIV99,
 16693           DFHEIV99
 16694     MOVE EIBRESP  TO WS-RESPONSE
 16695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16696
 16697     .
 16698 2540-exit.
 16699     exit.
 16700***************************************************************
 16701*                                                             *
 16702*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16703*                                                             *
 16704***************************************************************
 16705
 16706***************************************************************
 16707*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16708*     AN ALREADY BILLED RECORD.                               *
 16709***************************************************************
 16710
 16711 2700-BUILD-CORRECTION-RECORD.
 16712     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16713     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16714     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16715     MOVE '5'                    TO DC-OPTION-CODE.
 16716     PERFORM 9700-DATE-LINK.
 16717     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16718
 16719     IF PB-CHG-COUNT = ZEROS
 16720        MOVE +1                  TO WS-SEQ-SAVE
 16721     ELSE
 16722        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16723
 16724     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16725     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16726
 16727     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16728
 16729     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16730     MOVE 'A'                    TO JP-RECORD-TYPE.
 16731     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16732
 16733
 16734* EXEC CICS WRITE
 16735*        DATASET    (FILE-ID-ERPNDB)
 16736*        FROM       (PENDING-BUSINESS)
 16737*        RIDFLD     (PB-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 304
* VP6311.cbl
 16738*    END-EXEC.
 16739     MOVE LENGTH OF
 16740      PENDING-BUSINESS
 16741       TO DFHEIV11
 16742*    MOVE '&$ L                  ''   #00014555' TO DFHEIV0
 16743     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16744     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16745     MOVE X'2020233030303134353535' TO DFHEIV0(25:11)
 16746     CALL 'kxdfhei1' USING DFHEIV0,
 16747           FILE-ID-ERPNDB,
 16748           PENDING-BUSINESS,
 16749           DFHEIV11,
 16750           PB-CONTROL-PRIMARY,
 16751           DFHEIV99,
 16752           DFHEIV99
 16753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16754
 16755
 16756     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16757
 16758     PERFORM 8400-LOG-JOURNAL-RECORD.
 16759
 16760 2799-EXIT.
 16761      EXIT.
 16762
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 305
* VP6311.cbl
 16764
 16765******************************************************************
 16766*                                                                *
 16767*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16768*                                                                *
 16769******************************************************************
 16770
 16771 2800-REWRITE-ISSUE-CERT-KEY.
 16772     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16773
 16774     IF  BCERTNOL GREATER THAN ZEROS
 16775         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16776
 16777     IF  BSUFIXL  GREATER THAN ZEROS
 16778         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16779
 16780     IF  BEFFDTL  GREATER THAN ZEROS
 16781         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16782
 16783 2810-READ-BY-ACCOUNT.
 16784
 16785* EXEC CICS HANDLE CONDITION
 16786*         NOTFND    (2820-PROCESS-REWRITE)
 16787*    END-EXEC.
 16788*    MOVE '"$I                   ! = #00014589' TO DFHEIV0
 16789     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16790     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16791     MOVE X'3D20233030303134353839' TO DFHEIV0(25:11)
 16792     CALL 'kxdfhei1' USING DFHEIV0
 16793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16794
 16795
 16796***  read pndb using new key
 16797
 16798* EXEC CICS READ
 16799*        SET     (ADDRESS OF PENDING-BUSINESS)
 16800*        DATASET (FILE-ID-ERPNDB2)
 16801*        RIDFLD  (ERPNDB-ALT-KEY)
 16802*    END-EXEC.
 16803*    MOVE '&"S        E          (   #00014594' TO DFHEIV0
 16804     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16805     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16806     MOVE X'2020233030303134353934' TO DFHEIV0(25:11)
 16807     CALL 'kxdfhei1' USING DFHEIV0,
 16808           FILE-ID-ERPNDB2,
 16809           DFHEIV20,
 16810           DFHEIV99,
 16811           ERPNDB-ALT-KEY,
 16812           DFHEIV99,
 16813           DFHEIV99,
 16814           DFHEIV99
 16815     SET ADDRESS OF PENDING-BUSINESS TO
 16816         DFHEIV20
 16817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16818
 16819
 16820     GO TO 2890-DUPLICATE-RECORD.
 16821
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 306
* VP6311.cbl
 16822  2820-PROCESS-REWRITE.
 16823
 16824* EXEC CICS HANDLE CONDITION
 16825*         NOTFND    (2885-RECORD-MISSING)
 16826*    END-EXEC.
 16827*    MOVE '"$I                   ! > #00014603' TO DFHEIV0
 16828     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16829     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16830     MOVE X'3E20233030303134363033' TO DFHEIV0(25:11)
 16831     CALL 'kxdfhei1' USING DFHEIV0
 16832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16833
 16834
 16835     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16836
 16837***  read pndb using original key
 16838
 16839* EXEC CICS READ
 16840*        SET     (ADDRESS OF PENDING-BUSINESS)
 16841*        DATASET (FILE-ID-ERPNDB)
 16842*        RIDFLD  (ERPNDB-KEY)
 16843*        UPDATE
 16844*    END-EXEC.
 16845*    MOVE '&"S        EU         (   #00014610' TO DFHEIV0
 16846     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16847     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16848     MOVE X'2020233030303134363130' TO DFHEIV0(25:11)
 16849     CALL 'kxdfhei1' USING DFHEIV0,
 16850           FILE-ID-ERPNDB,
 16851           DFHEIV20,
 16852           DFHEIV99,
 16853           ERPNDB-KEY,
 16854           DFHEIV99,
 16855           DFHEIV99,
 16856           DFHEIV99
 16857     SET ADDRESS OF PENDING-BUSINESS TO
 16858         DFHEIV20
 16859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16860
 16861
 16862     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16863     MOVE 'D'                    TO JP-RECORD-TYPE.
 16864     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16865     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16866
 16867     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16868
 16869     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16870     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16871     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16872
 16873***  delete pndb using original key
 16874
 16875* EXEC CICS DELETE
 16876*        DATASET    (FILE-ID-ERPNDB)
 16877*    END-EXEC.
 16878*    MOVE '&(                    &   #00014629' TO DFHEIV0
 16879     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 307
* VP6311.cbl
 16880     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16881     MOVE X'2020233030303134363239' TO DFHEIV0(25:11)
 16882     CALL 'kxdfhei1' USING DFHEIV0,
 16883           FILE-ID-ERPNDB,
 16884           DFHEIV99,
 16885           DFHEIV99,
 16886           DFHEIV99,
 16887           DFHEIV99
 16888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16889
 16890
 16891     PERFORM 8400-LOG-JOURNAL-RECORD.
 16892
 16893
 16894* EXEC CICS GETMAIN
 16895*        SET      (ADDRESS OF PENDING-BUSINESS)
 16896*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16897*        INITIMG  (GETMAIN-SPACE)
 16898*    END-EXEC.
 16899*    MOVE ',"IL                  $   #00014635' TO DFHEIV0
 16900     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16901     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16902     MOVE X'2020233030303134363335' TO DFHEIV0(25:11)
 16903     CALL 'kxdfhei1' USING DFHEIV0,
 16904           DFHEIV20,
 16905           ERPNDB-RECORD-LENGTH,
 16906           GETMAIN-SPACE
 16907     SET ADDRESS OF PENDING-BUSINESS TO
 16908         DFHEIV20
 16909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16910
 16911
 16912***  pending-business now has original record
 16913     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16914
 16915
 16916* EXEC CICS HANDLE CONDITION
 16917*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16918*    END-EXEC.
 16919*    MOVE '"$I                   ! ? #00014644' TO DFHEIV0
 16920     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16921     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16922     MOVE X'3F20233030303134363434' TO DFHEIV0(25:11)
 16923     CALL 'kxdfhei1' USING DFHEIV0
 16924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16925
 16926
 16927***  read elcert using original key
 16928
 16929* EXEC CICS READ
 16930*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16931*        DATASET (FILE-ID-ELCERT)
 16932*        RIDFLD  (ELCERT-KEY)
 16933*        UPDATE
 16934*    END-EXEC.
 16935*    MOVE '&"S        EU         (   #00014649' TO DFHEIV0
 16936     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16937     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 308
* VP6311.cbl
 16938     MOVE X'2020233030303134363439' TO DFHEIV0(25:11)
 16939     CALL 'kxdfhei1' USING DFHEIV0,
 16940           FILE-ID-ELCERT,
 16941           DFHEIV20,
 16942           DFHEIV99,
 16943           ELCERT-KEY,
 16944           DFHEIV99,
 16945           DFHEIV99,
 16946           DFHEIV99
 16947     SET ADDRESS OF CERTIFICATE-MASTER TO
 16948         DFHEIV20
 16949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16950
 16951
 16952     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16953     MOVE 'B'                    TO JP-RECORD-TYPE
 16954     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16955     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16956
 16957     IF INSURED-ADDR-PRESENT
 16958        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16959
 16960     IF CERT-NOTES-ARE-NOT-PRESENT
 16961        MOVE SPACE               TO WS-CERT-NOTE-SW
 16962     ELSE
 16963        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16964
 16965     IF CERT-ADDED-BATCH      OR
 16966        CERT-AND-CLAIM-ONLINE OR
 16967        CERT-WAS-CREATED-FOR-CLAIM
 16968        NEXT SENTENCE
 16969     ELSE
 16970        GO TO 2825-DELETE-CERTIFICATE.
 16971
 16972     PERFORM 8400-LOG-JOURNAL-RECORD.
 16973
 16974*********************************************************
 16975** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16976     IF CERT-ADDED-BATCH
 16977         GO TO 2822-REWRITE-ELCERT.
 16978*********************************************************
 16979
 16980     IF NO-CLAIM-ATTACHED
 16981        NEXT SENTENCE
 16982     ELSE
 16983        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 16984        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 16985
 16986 2822-REWRITE-ELCERT.
 16987     MOVE 'C'                    TO JP-RECORD-TYPE
 16988     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16989
 16990     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16991
 16992
 16993* EXEC CICS REWRITE
 16994*         DATASET    (FILE-ID-ELCERT)
 16995*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 309
* VP6311.cbl
 16996*    END-EXEC.
 16997     MOVE LENGTH OF
 16998      CERTIFICATE-MASTER
 16999       TO DFHEIV11
 17000*    MOVE '&& L                  %   #00014696' TO DFHEIV0
 17001     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17002     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17003     MOVE X'2020233030303134363936' TO DFHEIV0(25:11)
 17004     CALL 'kxdfhei1' USING DFHEIV0,
 17005           FILE-ID-ELCERT,
 17006           CERTIFICATE-MASTER,
 17007           DFHEIV11,
 17008           DFHEIV99
 17009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17010
 17011
 17012     PERFORM 8400-LOG-JOURNAL-RECORD.
 17013
 17014     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17015
 17016 2825-DELETE-CERTIFICATE.
 17017     MOVE 'D'                      TO JP-RECORD-TYPE.
 17018     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17019
 17020     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17021
 17022
 17023* EXEC CICS DELETE
 17024*         DATASET    (FILE-ID-ELCERT)
 17025*    END-EXEC.
 17026*    MOVE '&(                    &   #00014711' TO DFHEIV0
 17027     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17028     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17029     MOVE X'2020233030303134373131' TO DFHEIV0(25:11)
 17030     CALL 'kxdfhei1' USING DFHEIV0,
 17031           FILE-ID-ELCERT,
 17032           DFHEIV99,
 17033           DFHEIV99,
 17034           DFHEIV99,
 17035           DFHEIV99
 17036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17037
 17038
 17039     PERFORM 8400-LOG-JOURNAL-RECORD.
 17040
 17041******************************************************************
 17042*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17043******************************************************************
 17044
 17045     IF CERT-NOTES-ARE-PRESENT
 17046        NEXT SENTENCE
 17047     ELSE
 17048        GO TO 2827-DELETE-MAILING.
 17049
 17050
 17051* EXEC CICS HANDLE CONDITION
 17052*         NOTFND  (2827-DELETE-MAILING)
 17053*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 310
* VP6311.cbl
 17054*    MOVE '"$I                   ! @ #00014726' TO DFHEIV0
 17055     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17056     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17057     MOVE X'4020233030303134373236' TO DFHEIV0(25:11)
 17058     CALL 'kxdfhei1' USING DFHEIV0
 17059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17060
 17061
 17062
 17063* EXEC CICS READ
 17064*        EQUAL
 17065*        DATASET   (FILE-ID-ERNOTE)
 17066*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17067*        RIDFLD    (ELCERT-KEY)
 17068*        UPDATE
 17069*    END-EXEC.
 17070*    MOVE '&"S        EU         (   #00014730' TO DFHEIV0
 17071     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17072     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17073     MOVE X'2020233030303134373330' TO DFHEIV0(25:11)
 17074     CALL 'kxdfhei1' USING DFHEIV0,
 17075           FILE-ID-ERNOTE,
 17076           DFHEIV20,
 17077           DFHEIV99,
 17078           ELCERT-KEY,
 17079           DFHEIV99,
 17080           DFHEIV99,
 17081           DFHEIV99
 17082     SET ADDRESS OF CERTIFICATE-NOTE TO
 17083         DFHEIV20
 17084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17085
 17086
 17087     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17088     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17089     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17090
 17091     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17092
 17093
 17094* EXEC CICS DELETE
 17095*        DATASET   (FILE-ID-ERNOTE)
 17096*    END-EXEC.
 17097*    MOVE '&(                    &   #00014744' TO DFHEIV0
 17098     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17099     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17100     MOVE X'2020233030303134373434' TO DFHEIV0(25:11)
 17101     CALL 'kxdfhei1' USING DFHEIV0,
 17102           FILE-ID-ERNOTE,
 17103           DFHEIV99,
 17104           DFHEIV99,
 17105           DFHEIV99,
 17106           DFHEIV99
 17107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17108
 17109
 17110     PERFORM 8400-LOG-JOURNAL-RECORD.
 17111
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 311
* VP6311.cbl
 17112******************************************************************
 17113*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17114******************************************************************
 17115
 17116 2827-DELETE-MAILING.
 17117     IF CERT-ADDRESS-PRESENT
 17118        NEXT SENTENCE
 17119     ELSE
 17120        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17121
 17122
 17123* EXEC CICS HANDLE CONDITION
 17124*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17125*    END-EXEC.
 17126*    MOVE '"$I                   ! A #00014760' TO DFHEIV0
 17127     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17128     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17129     MOVE X'4120233030303134373630' TO DFHEIV0(25:11)
 17130     CALL 'kxdfhei1' USING DFHEIV0
 17131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17132
 17133
 17134     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17135
 17136
 17137* EXEC CICS READ
 17138*        EQUAL
 17139*        DATASET   (FILE-ID-ERMAIL)
 17140*        SET       (ADDRESS OF MAILING-DATA)
 17141*        RIDFLD    (ERMAIL-KEY)
 17142*        UPDATE
 17143*    END-EXEC.
 17144*    MOVE '&"S        EU         (   #00014766' TO DFHEIV0
 17145     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17146     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17147     MOVE X'2020233030303134373636' TO DFHEIV0(25:11)
 17148     CALL 'kxdfhei1' USING DFHEIV0,
 17149           FILE-ID-ERMAIL,
 17150           DFHEIV20,
 17151           DFHEIV99,
 17152           ERMAIL-KEY,
 17153           DFHEIV99,
 17154           DFHEIV99,
 17155           DFHEIV99
 17156     SET ADDRESS OF MAILING-DATA TO
 17157         DFHEIV20
 17158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17159
 17160
 17161     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17162     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17163     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17164
 17165     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17166
 17167
 17168* EXEC CICS DELETE
 17169*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 312
* VP6311.cbl
 17170*    END-EXEC.
 17171*    MOVE '&(                    &   #00014780' TO DFHEIV0
 17172     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17173     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17174     MOVE X'2020233030303134373830' TO DFHEIV0(25:11)
 17175     CALL 'kxdfhei1' USING DFHEIV0,
 17176           FILE-ID-ERMAIL,
 17177           DFHEIV99,
 17178           DFHEIV99,
 17179           DFHEIV99,
 17180           DFHEIV99
 17181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17182
 17183
 17184     PERFORM 8400-LOG-JOURNAL-RECORD.
 17185
 17186 2830-BUILD-NEW-ISSUE-RECORD.
 17187     MOVE SPACES                 TO ELCERT-KEY.
 17188
 17189     IF  BCERTNOL GREATER THAN ZEROS
 17190         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17191
 17192     IF  BSUFIXL  GREATER THAN ZEROS
 17193         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17194
 17195     IF BEFFDTL GREATER THAN ZEROS
 17196        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17197
 17198 2870-WRITE-PENDING-BUSINESS.
 17199     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17200     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17201     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17202     MOVE '5'                    TO DC-OPTION-CODE.
 17203     PERFORM 9700-DATE-LINK.
 17204     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17205
 17206     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17207
 17208     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17209     MOVE 'A'                    TO JP-RECORD-TYPE.
 17210     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17211
 17212
 17213* EXEC CICS WRITE
 17214*        DATASET  (FILE-ID-ERPNDB)
 17215*        FROM     (PENDING-BUSINESS)
 17216*        RIDFLD   (PB-CONTROL-PRIMARY)
 17217*    END-EXEC.
 17218     MOVE LENGTH OF
 17219      PENDING-BUSINESS
 17220       TO DFHEIV11
 17221*    MOVE '&$ L                  ''   #00014812' TO DFHEIV0
 17222     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17223     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17224     MOVE X'2020233030303134383132' TO DFHEIV0(25:11)
 17225     CALL 'kxdfhei1' USING DFHEIV0,
 17226           FILE-ID-ERPNDB,
 17227           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 313
* VP6311.cbl
 17228           DFHEIV11,
 17229           PB-CONTROL-PRIMARY,
 17230           DFHEIV99,
 17231           DFHEIV99
 17232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17233
 17234
 17235     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17236
 17237     PERFORM 8400-LOG-JOURNAL-RECORD.
 17238
 17239     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17240
 17241 2885-RECORD-MISSING.
 17242     MOVE -1                     TO BMAINTL
 17243     MOVE AL-UABON               TO BMAINTA
 17244     MOVE ER-2902                TO EMI-ERROR.
 17245     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17246     GO TO 8200-SEND-DATAONLY.
 17247
 17248 2890-DUPLICATE-RECORD.
 17249     MOVE -1                     TO BMAINTL.
 17250     MOVE AL-UABON               TO BCERTNOA.
 17251     MOVE AL-UNBON               TO BEFFDTA.
 17252     MOVE SPACE                  TO BMAINTI.
 17253
 17254     MOVE 1                      TO EMI-SUB
 17255                                    EMI-SWITCH1
 17256                                    EMI-SWITCH-AREA-1
 17257                                    EMI-SWITCH-AREA-2.
 17258
 17259     MOVE SPACES                 TO EMI-ERROR-LINES.
 17260
 17261
 17262* EXEC CICS SYNCPOINT ROLLBACK
 17263*    END-EXEC.
 17264*    MOVE '6"R                   !   #00014844' TO DFHEIV0
 17265     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17266     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17267     MOVE X'2020233030303134383434' TO DFHEIV0(25:11)
 17268     CALL 'kxdfhei1' USING DFHEIV0
 17269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17270
 17271
 17272     MOVE ER-2247                TO EMI-ERROR.
 17273     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17274     GO TO 8200-SEND-DATAONLY.
 17275
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 314
* VP6311.cbl
 17277
 17278******************************************************************
 17279*                                                                *
 17280*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17281*                                                                *
 17282******************************************************************
 17283
 17284 2900-REWRITE-CAN-CERT-KEY.
 17285     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17286
 17287     IF  CCERTNOL GREATER THAN ZEROS
 17288         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17289
 17290     IF  CSUFIXL  GREATER THAN ZEROS
 17291         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17292
 17293     IF  CEFFDTL  GREATER THAN ZEROS
 17294         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17295
 17296 2910-READ-BY-ACCOUNT.
 17297
 17298* EXEC CICS HANDLE CONDITION
 17299*         NOTFND    (2920-PROCESS-REWRITE)
 17300*    END-EXEC.
 17301*    MOVE '"$I                   ! B #00014872' TO DFHEIV0
 17302     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17304     MOVE X'4220233030303134383732' TO DFHEIV0(25:11)
 17305     CALL 'kxdfhei1' USING DFHEIV0
 17306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17307
 17308
 17309
 17310* EXEC CICS READ
 17311*        SET     (ADDRESS OF PENDING-BUSINESS)
 17312*        DATASET (FILE-ID-ERPNDB2)
 17313*        RIDFLD  (ERPNDB-ALT-KEY)
 17314*    END-EXEC.
 17315*    MOVE '&"S        E          (   #00014876' TO DFHEIV0
 17316     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17317     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17318     MOVE X'2020233030303134383736' TO DFHEIV0(25:11)
 17319     CALL 'kxdfhei1' USING DFHEIV0,
 17320           FILE-ID-ERPNDB2,
 17321           DFHEIV20,
 17322           DFHEIV99,
 17323           ERPNDB-ALT-KEY,
 17324           DFHEIV99,
 17325           DFHEIV99,
 17326           DFHEIV99
 17327     SET ADDRESS OF PENDING-BUSINESS TO
 17328         DFHEIV20
 17329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17330
 17331
 17332     GO TO 2990-DUPLICATE-RECORD.
 17333
 17334  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 315
* VP6311.cbl
 17335
 17336* EXEC CICS HANDLE CONDITION
 17337*         NOTFND    (2985-RECORD-MISSING)
 17338*    END-EXEC.
 17339*    MOVE '"$I                   ! C #00014885' TO DFHEIV0
 17340     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17341     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17342     MOVE X'4320233030303134383835' TO DFHEIV0(25:11)
 17343     CALL 'kxdfhei1' USING DFHEIV0
 17344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17345
 17346
 17347     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17348
 17349
 17350* EXEC CICS READ
 17351*        SET     (ADDRESS OF PENDING-BUSINESS)
 17352*        DATASET (FILE-ID-ERPNDB)
 17353*        RIDFLD  (ERPNDB-KEY)
 17354*        UPDATE
 17355*    END-EXEC.
 17356*    MOVE '&"S        EU         (   #00014891' TO DFHEIV0
 17357     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17358     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17359     MOVE X'2020233030303134383931' TO DFHEIV0(25:11)
 17360     CALL 'kxdfhei1' USING DFHEIV0,
 17361           FILE-ID-ERPNDB,
 17362           DFHEIV20,
 17363           DFHEIV99,
 17364           ERPNDB-KEY,
 17365           DFHEIV99,
 17366           DFHEIV99,
 17367           DFHEIV99
 17368     SET ADDRESS OF PENDING-BUSINESS TO
 17369         DFHEIV20
 17370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17371
 17372
 17373     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17374     MOVE 'D'                    TO JP-RECORD-TYPE.
 17375     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17376     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17377
 17378     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17379
 17380     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17381     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17382     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17383
 17384
 17385* EXEC CICS DELETE
 17386*        DATASET    (FILE-ID-ERPNDB)
 17387*    END-EXEC.
 17388*    MOVE '&(                    &   #00014909' TO DFHEIV0
 17389     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17390     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17391     MOVE X'2020233030303134393039' TO DFHEIV0(25:11)
 17392     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 316
* VP6311.cbl
 17393           FILE-ID-ERPNDB,
 17394           DFHEIV99,
 17395           DFHEIV99,
 17396           DFHEIV99,
 17397           DFHEIV99
 17398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17399
 17400
 17401     PERFORM 8400-LOG-JOURNAL-RECORD.
 17402
 17403
 17404* EXEC CICS GETMAIN
 17405*        SET      (ADDRESS OF PENDING-BUSINESS)
 17406*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17407*        INITIMG  (GETMAIN-SPACE)
 17408*    END-EXEC.
 17409*    MOVE ',"IL                  $   #00014915' TO DFHEIV0
 17410     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17411     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17412     MOVE X'2020233030303134393135' TO DFHEIV0(25:11)
 17413     CALL 'kxdfhei1' USING DFHEIV0,
 17414           DFHEIV20,
 17415           ERPNDB-RECORD-LENGTH,
 17416           GETMAIN-SPACE
 17417     SET ADDRESS OF PENDING-BUSINESS TO
 17418         DFHEIV20
 17419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17420
 17421
 17422     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17423
 17424 2950-PROCESS-CANCELS.
 17425
 17426
 17427* EXEC CICS HANDLE CONDITION
 17428*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17429*    END-EXEC.
 17430*    MOVE '"$I                   ! D #00014925' TO DFHEIV0
 17431     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17433     MOVE X'4420233030303134393235' TO DFHEIV0(25:11)
 17434     CALL 'kxdfhei1' USING DFHEIV0
 17435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17436
 17437
 17438
 17439* EXEC CICS READ
 17440*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17441*        DATASET (FILE-ID-ELCERT)
 17442*        RIDFLD  (ELCERT-KEY)
 17443*        UPDATE
 17444*    END-EXEC.
 17445*    MOVE '&"S        EU         (   #00014929' TO DFHEIV0
 17446     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17447     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17448     MOVE X'2020233030303134393239' TO DFHEIV0(25:11)
 17449     CALL 'kxdfhei1' USING DFHEIV0,
 17450           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 317
* VP6311.cbl
 17451           DFHEIV20,
 17452           DFHEIV99,
 17453           ELCERT-KEY,
 17454           DFHEIV99,
 17455           DFHEIV99,
 17456           DFHEIV99
 17457     SET ADDRESS OF CERTIFICATE-MASTER TO
 17458         DFHEIV20
 17459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17460
 17461
 17462     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17463
 17464     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17465     MOVE 'B'                      TO JP-RECORD-TYPE.
 17466     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17467     PERFORM 8400-LOG-JOURNAL-RECORD.
 17468
 17469     IF PB-CI-LIVES NOT NUMERIC
 17470         MOVE ZERO                    TO PB-CI-LIVES.
 17471
 17472     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17473        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17474        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17475        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17476                                         CM-LF-CANCEL-DT
 17477     ELSE
 17478        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17479        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17480        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17481        MOVE PB-CI-LIVES              TO CM-LIVES.
 17482
 17483     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17484        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17485            MOVE CM-LF-STATUS-AT-CANCEL
 17486                                     TO CM-LF-CURRENT-STATUS
 17487            MOVE SPACE
 17488                                     TO CM-LF-STATUS-AT-CANCEL
 17489        ELSE
 17490            MOVE PB-CI-LF-POLICY-STATUS
 17491                                     TO CM-LF-CURRENT-STATUS
 17492     ELSE
 17493        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17494
 17495     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17496        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17497        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17498        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17499                                         CM-AH-CANCEL-DT
 17500     ELSE
 17501        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17502        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17503        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17504        MOVE PB-CI-LIVES              TO CM-LIVES.
 17505
 17506     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17507        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17508            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 318
* VP6311.cbl
 17509                                     TO CM-AH-CURRENT-STATUS
 17510            MOVE SPACE
 17511                                     TO CM-AH-STATUS-AT-CANCEL
 17512        ELSE
 17513            MOVE PB-CI-AH-POLICY-STATUS
 17514                                     TO CM-AH-CURRENT-STATUS
 17515     ELSE
 17516        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17517
 17518 2975-REWRITE-CERT.
 17519     MOVE 'C'                      TO JP-RECORD-TYPE.
 17520     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17521
 17522
 17523* EXEC CICS REWRITE
 17524*        DATASET    (FILE-ID-ELCERT)
 17525*        FROM       (CERTIFICATE-MASTER)
 17526*    END-EXEC.
 17527     MOVE LENGTH OF
 17528      CERTIFICATE-MASTER
 17529       TO DFHEIV11
 17530*    MOVE '&& L                  %   #00014996' TO DFHEIV0
 17531     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17532     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17533     MOVE X'2020233030303134393936' TO DFHEIV0(25:11)
 17534     CALL 'kxdfhei1' USING DFHEIV0,
 17535           FILE-ID-ELCERT,
 17536           CERTIFICATE-MASTER,
 17537           DFHEIV11,
 17538           DFHEIV99
 17539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17540
 17541
 17542     PERFORM 8400-LOG-JOURNAL-RECORD.
 17543
 17544 2960-BUILD-NEW-CANCEL-RECORD.
 17545     IF  CCERTNOL GREATER THAN ZEROS
 17546         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17547
 17548     IF  CSUFIXL  GREATER THAN ZEROS
 17549         MOVE CSUFIXI             TO PB-CERT-SFX.
 17550
 17551     IF  CEFFDTL  GREATER  THAN ZEROS
 17552         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17553
 17554 2970-WRITE-PENDING-BUSINESS.
 17555     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17556     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17557     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17558     MOVE '5'                    TO DC-OPTION-CODE.
 17559     PERFORM 9700-DATE-LINK.
 17560     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17561
 17562     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17563
 17564     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17565                                    PB-CI-INSURED-SEX
 17566                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 319
* VP6311.cbl
 17567                                    PB-CI-AH-BENEFIT-CD
 17568                                    PB-CI-RATE-CLASS
 17569                                    PB-CI-RATE-DEV-LF
 17570                                    PB-CI-RATE-DEV-AH
 17571                                    PB-CI-LF-ABBR
 17572                                    PB-CI-AH-ABBR
 17573                                    PB-CI-OB-FLAG
 17574                                    PB-CI-LF-POLICY-STATUS
 17575                                    PB-CI-AH-POLICY-STATUS
 17576                                    PB-CI-INDV-GRP-CD
 17577                                    PB-CI-BENEFICIARY-NAME
 17578                                    PB-CI-NOTE-SW
 17579                                    PB-CI-SOC-SEC-NO
 17580                                    PB-CI-MEMBER-NO
 17581                                    PB-CI-INT-CODE
 17582                                    PB-CI-COMP-EXCP-SW
 17583                                    PB-CI-ENTRY-STATUS
 17584                                    PB-CI-CREDIT-INTERFACE-SW-1
 17585                                    PB-CI-CREDIT-INTERFACE-SW-2
 17586                                    PB-CI-ENTRY-BATCH.
 17587
 17588     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17589                                    PB-CI-AH-SETTLEMENT-DT
 17590                                    PB-CI-DEATH-DT
 17591                                    PB-CI-LF-PRIOR-CANCEL-DT
 17592                                    PB-CI-AH-PRIOR-CANCEL-DT
 17593                                    PB-CI-LOAN-1ST-PMT-DT
 17594                                    PB-CI-ENTRY-DT
 17595                                    PB-CI-LF-EXPIRE-DT
 17596                                    PB-CI-AH-EXPIRE-DT.
 17597
 17598     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17599                                    PB-CI-LF-TERM
 17600                                    PB-CI-LF-BENEFIT-AMT
 17601                                    PB-CI-LF-ALT-BENEFIT-AMT
 17602                                    PB-CI-LF-PREMIUM-AMT
 17603                                    PB-CI-LF-ALT-PREMIUM-AMT
 17604                                    PB-CI-AH-TERM
 17605                                    PB-CI-AH-BENEFIT-AMT
 17606                                    PB-CI-AH-PREMIUM-AMT
 17607                                    PB-CI-RATE-DEV-PCT-LF
 17608                                    PB-CI-RATE-DEV-PCT-AH
 17609                                    PB-CI-LIFE-COMMISSION
 17610                                    PB-CI-AH-COMMISSION
 17611                                    PB-CI-PAY-FREQUENCY
 17612                                    PB-CI-LOAN-APR
 17613                                    PB-CI-LOAN-TERM
 17614                                    PB-CI-CURR-SEQ
 17615                                    PB-CI-AH-CANCEL-AMT
 17616                                    PB-CI-LF-CANCEL-AMT
 17617                                    PB-CI-EXTENTION-DAYS
 17618                                    PB-CI-TERM-IN-DAYS
 17619                                    PB-CI-LOAN-OFFICER
 17620                                    PB-CI-LIVES
 17621                                    PB-CI-LF-CRIT-PER
 17622                                    PB-CI-AH-CRIT-PER
 17623                                    PB-C-LF-REM-TERM
 17624                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 320
* VP6311.cbl
 17625
 17626     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17627     MOVE 'A'                    TO JP-RECORD-TYPE.
 17628     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17629
 17630
 17631* EXEC CICS HANDLE CONDITION
 17632*        DUPREC   (2990-DUPLICATE-RECORD)
 17633*    END-EXEC.
 17634*    MOVE '"$%                   ! E #00015089' TO DFHEIV0
 17635     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17636     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17637     MOVE X'4520233030303135303839' TO DFHEIV0(25:11)
 17638     CALL 'kxdfhei1' USING DFHEIV0
 17639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17640
 17641
 17642
 17643* EXEC CICS WRITE
 17644*        DATASET  (FILE-ID-ERPNDB)
 17645*        FROM     (PENDING-BUSINESS)
 17646*        RIDFLD   (PB-CONTROL-PRIMARY)
 17647*    END-EXEC.
 17648     MOVE LENGTH OF
 17649      PENDING-BUSINESS
 17650       TO DFHEIV11
 17651*    MOVE '&$ L                  ''   #00015093' TO DFHEIV0
 17652     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17653     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17654     MOVE X'2020233030303135303933' TO DFHEIV0(25:11)
 17655     CALL 'kxdfhei1' USING DFHEIV0,
 17656           FILE-ID-ERPNDB,
 17657           PENDING-BUSINESS,
 17658           DFHEIV11,
 17659           PB-CONTROL-PRIMARY,
 17660           DFHEIV99,
 17661           DFHEIV99
 17662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17663
 17664
 17665     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17666
 17667     PERFORM 8400-LOG-JOURNAL-RECORD.
 17668
 17669     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17670
 17671 2985-RECORD-MISSING.
 17672     MOVE -1                     TO CMAINTL
 17673     MOVE AL-UABON               TO CMAINTA.
 17674
 17675     MOVE ER-2902                TO EMI-ERROR.
 17676     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17677     GO TO 8200-SEND-DATAONLY.
 17678
 17679 2990-DUPLICATE-RECORD.
 17680     MOVE SPACE                  TO CMAINTI.
 17681     MOVE -1                     TO CMAINTL.
 17682     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 321
* VP6311.cbl
 17683     MOVE AL-UNBON               TO CEFFDTA.
 17684
 17685     MOVE 1                      TO EMI-SUB
 17686                                    EMI-SWITCH1
 17687                                    EMI-SWITCH-AREA-1
 17688                                    EMI-SWITCH-AREA-2.
 17689     MOVE SPACES                 TO EMI-ERROR-LINES.
 17690
 17691
 17692* EXEC CICS SYNCPOINT ROLLBACK
 17693*    END-EXEC.
 17694*    MOVE '6"R                   !   #00015125' TO DFHEIV0
 17695     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17696     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17697     MOVE X'2020233030303135313235' TO DFHEIV0(25:11)
 17698     CALL 'kxdfhei1' USING DFHEIV0
 17699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17700
 17701
 17702     MOVE ER-2247                TO EMI-ERROR.
 17703     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17704     GO TO 8200-SEND-DATAONLY.
 17705
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 322
* VP6311.cbl
 17707
 17708***************************************************************
 17709*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17710*     PREMIUM FOR A SINGLE BATCH.                             *
 17711*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17712***************************************************************
 17713
 17714 3000-BATCH-MAINLINE.
 17715     IF PI-PREV-KEY NOT = SPACES
 17716         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17717     ELSE
 17718         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17719
 17720     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17721
 17722 3010-READNEXT.
 17723
 17724* EXEC CICS READ
 17725*         DATASET    (FILE-ID-ERPNDB)
 17726*         SET        (ADDRESS OF PENDING-BUSINESS)
 17727*         RIDFLD     (ERPNDB-KEY)
 17728*         GTEQ
 17729*    END-EXEC.
 17730*    MOVE '&"S        G          (   #00015149' TO DFHEIV0
 17731     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17732     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17733     MOVE X'2020233030303135313439' TO DFHEIV0(25:11)
 17734     CALL 'kxdfhei1' USING DFHEIV0,
 17735           FILE-ID-ERPNDB,
 17736           DFHEIV20,
 17737           DFHEIV99,
 17738           ERPNDB-KEY,
 17739           DFHEIV99,
 17740           DFHEIV99,
 17741           DFHEIV99
 17742     SET ADDRESS OF PENDING-BUSINESS TO
 17743         DFHEIV20
 17744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17745
 17746
 17747     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17748        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17749          GO TO 3030-END-BATCH.
 17750
 17751     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17752
 17753     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17754        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17755          GO TO 3020-BUMP-SEQ.
 17756
 17757     IF PB-ISSUE
 17758        ADD +1                   TO WS-ISS-TOTAL-CNT
 17759        IF PB-FATAL-ERRORS
 17760           ADD +1                      TO WS-ISS-FATAL-CNT
 17761           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17762           GO TO 3020-BUMP-SEQ
 17763        ELSE
 17764           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 323
* VP6311.cbl
 17765              ADD +1                      TO WS-ISS-FORCE-CNT
 17766              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17767              GO TO 3020-BUMP-SEQ
 17768           ELSE
 17769              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17770                 ADD +1                      TO WS-ISS-HOLD-CNT
 17771                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17772                 GO TO 3020-BUMP-SEQ
 17773              ELSE
 17774                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17775                     THRU  3299-EXIT
 17776                 GO TO 3020-BUMP-SEQ.
 17777
 17778     IF PB-CANCELLATION
 17779        ADD +1                   TO WS-CAN-TOTAL-CNT
 17780        IF PB-FATAL-ERRORS
 17781           ADD +1                 TO WS-CAN-FATAL-CNT
 17782           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17783           GO TO 3020-BUMP-SEQ
 17784        ELSE
 17785           IF PB-UNFORCED-ERRORS
 17786              ADD +1                 TO WS-CAN-FORCE-CNT
 17787              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17788              GO TO 3020-BUMP-SEQ
 17789           ELSE
 17790              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17791                 ADD +1                 TO WS-CAN-HOLD-CNT
 17792                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17793                 GO TO 3020-BUMP-SEQ
 17794              ELSE
 17795                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17796                     THRU  3499-EXIT
 17797                 GO TO 3020-BUMP-SEQ.
 17798
 17799     IF PB-BATCH-TRAILER
 17800         GO TO 3030-END-BATCH.
 17801
 17802 3020-BUMP-SEQ.
 17803     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17804     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17805     GO TO 3010-READNEXT.
 17806
 17807 3030-END-BATCH.
 17808     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17809     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17810     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17811     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17812
 17813     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17814                                          - WS-ISS-FORCE-CNT
 17815                                          - WS-ISS-HOLD-CNT).
 17816
 17817     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17818     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17819
 17820     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17821     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17822     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 324
* VP6311.cbl
 17823     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17824     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17825                                          - WS-CAN-FORCE-CNT
 17826                                          - WS-CAN-HOLD-CNT).
 17827     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17828     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17829
 17830     COMPUTE WS-NET-TOTAL-CNT
 17831         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17832     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17833     COMPUTE WS-NET-FATAL-CNT
 17834         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17835     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17836     COMPUTE WS-NET-FORCE-CNT
 17837         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17838     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17839     COMPUTE WS-NET-HOLD-CNT
 17840         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17841     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17842
 17843     COMPUTE WS-NET-AVAIL-CNT
 17844          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17845                              - WS-ISS-FORCE-CNT
 17846                              - WS-ISS-HOLD-CNT)
 17847          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17848                              - WS-CAN-FORCE-CNT
 17849                              - WS-CAN-HOLD-CNT).
 17850     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17851
 17852     COMPUTE WS-NET-GOOD-PREM
 17853         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17854     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17855     COMPUTE WS-NET-BAD-PREM
 17856         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17857     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17858
 17859     MOVE 0000                   TO EMI-ERROR.
 17860     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17861     MOVE -1                     TO DPFENTRL.
 17862     GO TO 8200-SEND-DATAONLY.
 17863
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 325
* VP6311.cbl
 17865
 17866******************************************************************
 17867*                                                                *
 17868*           A D D    B A D   I S S U E   P R E M I U M           *
 17869*                                                                *
 17870******************************************************************
 17871
 17872 3100-ADD-BAD-ISSUE-PREM.
 17873     IF PB-OVERRIDE-LIFE
 17874       OR PB-OVERRIDE-BOTH
 17875           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17876           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17877       ELSE
 17878           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17879           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17880
 17881     IF PB-OVERRIDE-AH
 17882       OR PB-OVERRIDE-BOTH
 17883           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17884       ELSE
 17885           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17886
 17887 3199-EXIT.
 17888     EXIT.
 17889
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 326
* VP6311.cbl
 17891
 17892******************************************************************
 17893*                                                                *
 17894*       A D D   G O O D   I S S U E   P R E M I U M              *
 17895*                                                                *
 17896******************************************************************
 17897
 17898 3200-ADD-GOOD-ISSUE-PREM.
 17899     IF PB-OVERRIDE-LIFE
 17900       OR PB-OVERRIDE-BOTH
 17901           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17902           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17903       ELSE
 17904           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17905           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17906
 17907     IF PB-OVERRIDE-AH
 17908       OR PB-OVERRIDE-BOTH
 17909           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17910       ELSE
 17911           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17912
 17913 3299-EXIT.
 17914     EXIT.
 17915
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 327
* VP6311.cbl
 17917
 17918
 17919******************************************************************
 17920*                                                                *
 17921*        A D D   B A D   C A N C E L   P R E M I U M             *
 17922*                                                                *
 17923******************************************************************
 17924
 17925 3300-ADD-BAD-CANCEL-PREM.
 17926     IF PB-OVERRIDE-LIFE
 17927       OR PB-OVERRIDE-BOTH
 17928           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17929       ELSE
 17930           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17931
 17932     IF PB-OVERRIDE-AH
 17933       OR PB-OVERRIDE-BOTH
 17934           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17935       ELSE
 17936           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17937
 17938 3399-EXIT.
 17939     EXIT.
 17940
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 328
* VP6311.cbl
 17942
 17943******************************************************************
 17944*                                                                *
 17945*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17946*                                                                *
 17947******************************************************************
 17948
 17949 3400-ADD-GOOD-CANCEL-PREM.
 17950     IF PB-OVERRIDE-LIFE
 17951       OR PB-OVERRIDE-BOTH
 17952           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17953       ELSE
 17954           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17955
 17956     IF PB-OVERRIDE-AH
 17957       OR PB-OVERRIDE-BOTH
 17958           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17959       ELSE
 17960           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17961
 17962 3499-EXIT.
 17963     EXIT.
 17964
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 329
* VP6311.cbl
 17966
 17967******************************************************************
 17968*                                                                *
 17969*           E D I T   B A T C H   D A T A                        *
 17970*                                                                *
 17971******************************************************************
 17972
 17973 3500-EDIT-BATCH-DATA.
 17974     IF PI-PREV-KEY NOT = SPACES
 17975        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17976     ELSE
 17977        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17978
 17979     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17980     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17981
 17982
 17983* EXEC CICS HANDLE CONDITION
 17984*         NOTFND      (3590-NOT-FOUND)
 17985*    END-EXEC.
 17986*    MOVE '"$I                   ! F #00015391' TO DFHEIV0
 17987     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17988     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17989     MOVE X'4620233030303135333931' TO DFHEIV0(25:11)
 17990     CALL 'kxdfhei1' USING DFHEIV0
 17991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17992
 17993
 17994     IF DRISSL   GREATER THAN ZEROS OR
 17995        DRISSL   GREATER THAN ZEROS OR
 17996        DRLFPRML GREATER THAN ZEROS OR
 17997        DRAHPRML GREATER THAN ZEROS OR
 17998        DRCANCL  GREATER THAN ZEROS OR
 17999        DRLFRFDL GREATER THAN ZEROS OR
 18000        DRAHRFDL GREATER THAN ZEROS
 18001              NEXT SENTENCE
 18002          ELSE
 18003              MOVE ER-3224    TO EMI-ERROR
 18004              MOVE -1         TO DPFENTRL
 18005              MOVE AL-UNBON   TO DPFENTRA
 18006              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18007              GO TO 8200-SEND-DATAONLY.
 18008
 18009     IF NOT MODIFY-CAP
 18010         MOVE 'UPDATE'       TO SM-READ
 18011         PERFORM 9995-SECURITY-VIOLATION
 18012         MOVE ER-0070        TO EMI-ERROR
 18013         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18014         GO TO 8100-SEND-INITIAL-MAP.
 18015
 18016        IF DRISSL GREATER THAN ZEROS
 18017           MOVE AL-UNNON         TO DRISSA
 18018           MOVE DRISSI           TO DEEDIT-FIELD
 18019           PERFORM 8600-DEEDIT
 18020           IF DEEDIT-FIELD-V0  NUMERIC
 18021              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18022           ELSE
 18023              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 330
* VP6311.cbl
 18024              MOVE -1         TO DRISSL
 18025              MOVE AL-UNBON   TO DRISSA
 18026              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18027
 18028        IF DRLFPRML GREATER THAN ZEROS
 18029           MOVE AL-UNNON         TO DRLFPRMA
 18030
 18031* EXEC CICS BIF DEEDIT
 18032*              FIELD  (DRLFPRMI)
 18033*              LENGTH (11)
 18034*          END-EXEC
 18035     MOVE 11
 18036       TO DFHEIV11
 18037*    MOVE '@"L                   #   #00015431' TO DFHEIV0
 18038     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18039     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18040     MOVE X'2020233030303135343331' TO DFHEIV0(25:11)
 18041     CALL 'kxdfhei1' USING DFHEIV0,
 18042           DRLFPRMI,
 18043           DFHEIV11
 18044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18045           IF DRLFPRMI NUMERIC
 18046              MOVE DRLFPRMI   TO WS-DRLFPRM
 18047*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18048*          PERFORM 8600-DEEDIT
 18049*          IF DEEDIT-FIELD-V2  NUMERIC
 18050*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18051           ELSE
 18052              MOVE ER-2223    TO EMI-ERROR
 18053              MOVE -1         TO DRLFPRML
 18054              MOVE AL-UNBON   TO DRLFPRMA
 18055              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18056
 18057        IF DRAHPRML GREATER THAN ZEROS
 18058           MOVE AL-UNNON         TO DRAHPRMA
 18059
 18060* EXEC CICS BIF DEEDIT
 18061*              FIELD  (DRAHPRMI)
 18062*              LENGTH (11)
 18063*          END-EXEC
 18064     MOVE 11
 18065       TO DFHEIV11
 18066*    MOVE '@"L                   #   #00015449' TO DFHEIV0
 18067     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18068     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18069     MOVE X'2020233030303135343439' TO DFHEIV0(25:11)
 18070     CALL 'kxdfhei1' USING DFHEIV0,
 18071           DRAHPRMI,
 18072           DFHEIV11
 18073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18074           IF DRAHPRMI NUMERIC
 18075              MOVE DRAHPRMI   TO WS-DRAHPRM
 18076*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18077*          PERFORM 8600-DEEDIT
 18078*          IF DEEDIT-FIELD-V2  NUMERIC
 18079*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18080           ELSE
 18081              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 331
* VP6311.cbl
 18082              MOVE -1         TO DRAHPRML
 18083              MOVE AL-UNBON   TO DRAHPRMA
 18084              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18085
 18086        IF DRCANCL GREATER THAN ZEROS
 18087           MOVE AL-UNNON         TO DRCANCA
 18088           MOVE DRCANCI          TO DEEDIT-FIELD
 18089           PERFORM 8600-DEEDIT
 18090           IF DEEDIT-FIELD-V0  NUMERIC
 18091              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18092           ELSE
 18093              MOVE ER-2223    TO EMI-ERROR
 18094              MOVE -1         TO DRCANCL
 18095              MOVE AL-UNBON   TO DRCANCL
 18096              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18097
 18098        IF DRLFRFDL GREATER THAN ZEROS
 18099           MOVE AL-UNNON         TO DRLFRFDA
 18100
 18101* EXEC CICS BIF DEEDIT
 18102*              FIELD  (DRLFRFDI)
 18103*              LENGTH (11)
 18104*          END-EXEC
 18105     MOVE 11
 18106       TO DFHEIV11
 18107*    MOVE '@"L                   #   #00015479' TO DFHEIV0
 18108     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18109     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18110     MOVE X'2020233030303135343739' TO DFHEIV0(25:11)
 18111     CALL 'kxdfhei1' USING DFHEIV0,
 18112           DRLFRFDI,
 18113           DFHEIV11
 18114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18115           IF DRLFRFDI NUMERIC
 18116              MOVE DRLFRFDI   TO WS-DRLFRFD
 18117*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18118*          PERFORM 8600-DEEDIT
 18119*          IF DEEDIT-FIELD-V2  NUMERIC
 18120*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18121           ELSE
 18122              MOVE ER-2223    TO EMI-ERROR
 18123              MOVE -1         TO DRLFRFDL
 18124              MOVE AL-UNBON   TO DRLFRFDA
 18125              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18126
 18127        IF DRAHRFDL GREATER THAN ZEROS
 18128           MOVE AL-UNNON         TO DRAHRFDA
 18129
 18130* EXEC CICS BIF DEEDIT
 18131*              FIELD  (DRAHRFDI)
 18132*              LENGTH (11)
 18133*          END-EXEC
 18134     MOVE 11
 18135       TO DFHEIV11
 18136*    MOVE '@"L                   #   #00015497' TO DFHEIV0
 18137     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18138     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18139     MOVE X'2020233030303135343937' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 332
* VP6311.cbl
 18140     CALL 'kxdfhei1' USING DFHEIV0,
 18141           DRAHRFDI,
 18142           DFHEIV11
 18143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18144           IF DRAHRFDI NUMERIC
 18145              MOVE DRAHRFDI   TO WS-DRAHRFD
 18146*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18147*          PERFORM 8600-DEEDIT
 18148*          IF DEEDIT-FIELD-V2  NUMERIC
 18149*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18150           ELSE
 18151              MOVE ER-2223    TO EMI-ERROR
 18152              MOVE -1         TO DRAHRFDL
 18153              MOVE AL-UNBON   TO DRAHRFDA
 18154              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18155
 18156     IF EMI-ERROR = ZEROS
 18157        GO 3600-UPDATE-BATCH-HEADER.
 18158
 18159     GO TO 8200-SEND-DATAONLY.
 18160
 18161 3590-NOT-FOUND.
 18162     MOVE ER-2192                TO EMI-ERROR.
 18163     MOVE -1                     TO DPFENTRL.
 18164     MOVE AL-UNBON               TO DPFENTRA.
 18165     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18166     GO TO 8200-SEND-DATAONLY.
 18167
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 333
* VP6311.cbl
 18169
 18170******************************************************************
 18171*                                                                *
 18172*           U P D A T E   B A T C H   H E A D E R                *
 18173*                                                                *
 18174******************************************************************
 18175
 18176 3600-UPDATE-BATCH-HEADER.
 18177
 18178* EXEC CICS HANDLE CONDITION
 18179*         NOTFND      (3690-NOT-FOUND)
 18180*    END-EXEC.
 18181*    MOVE '"$I                   ! G #00015534' TO DFHEIV0
 18182     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18184     MOVE X'4720233030303135353334' TO DFHEIV0(25:11)
 18185     CALL 'kxdfhei1' USING DFHEIV0
 18186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18187
 18188
 18189
 18190* EXEC CICS READ
 18191*        DATASET (FILE-ID-ERPNDB)
 18192*        RIDFLD  (ERPNDB-KEY)
 18193*        SET     (ADDRESS OF PENDING-BUSINESS)
 18194*        UPDATE
 18195*    END-EXEC.
 18196*    MOVE '&"S        EU         (   #00015538' TO DFHEIV0
 18197     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18198     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18199     MOVE X'2020233030303135353338' TO DFHEIV0(25:11)
 18200     CALL 'kxdfhei1' USING DFHEIV0,
 18201           FILE-ID-ERPNDB,
 18202           DFHEIV20,
 18203           DFHEIV99,
 18204           ERPNDB-KEY,
 18205           DFHEIV99,
 18206           DFHEIV99,
 18207           DFHEIV99
 18208     SET ADDRESS OF PENDING-BUSINESS TO
 18209         DFHEIV20
 18210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18211
 18212
 18213     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18214     MOVE 'B'                    TO JP-RECORD-TYPE.
 18215     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18216
 18217     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18218
 18219     PERFORM 8400-LOG-JOURNAL-RECORD.
 18220
 18221     IF DRISSL GREATER THAN ZEROS
 18222        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18223
 18224     IF DRCANCL GREATER THAN ZEROS
 18225        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18226
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 334
* VP6311.cbl
 18227
 18228     IF DRLFPRML GREATER THAN ZEROS
 18229        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18230
 18231     IF DRAHPRML GREATER THAN ZEROS
 18232        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18233
 18234     IF DRLFRFDL GREATER THAN ZEROS
 18235        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18236
 18237     IF DRAHRFDL GREATER THAN ZEROS
 18238        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18239
 18240 3670-REWRITE-BATCH-HEADER.
 18241     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18242        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18243        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18244        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18245        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18246        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18247        MOVE SPACE               TO PB-OUT-BAL-CD
 18248     ELSE
 18249        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18250
 18251     MOVE 'C'                    TO JP-RECORD-TYPE.
 18252     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18253
 18254
 18255* EXEC CICS REWRITE
 18256*         DATASET      (FILE-ID-ERPNDB)
 18257*         FROM         (PENDING-BUSINESS)
 18258*    END-EXEC.
 18259     MOVE LENGTH OF
 18260      PENDING-BUSINESS
 18261       TO DFHEIV11
 18262*    MOVE '&& L                  %   #00015586' TO DFHEIV0
 18263     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18264     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18265     MOVE X'2020233030303135353836' TO DFHEIV0(25:11)
 18266     CALL 'kxdfhei1' USING DFHEIV0,
 18267           FILE-ID-ERPNDB,
 18268           PENDING-BUSINESS,
 18269           DFHEIV11,
 18270           DFHEIV99
 18271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18272
 18273
 18274     PERFORM 8400-LOG-JOURNAL-RECORD.
 18275
 18276     GO TO 7200-DISPLAY-BATCHES.
 18277
 18278 3690-NOT-FOUND.
 18279     MOVE ER-2192                TO EMI-ERROR.
 18280     MOVE -1                     TO DPFENTRL.
 18281     MOVE AL-UNBON               TO DPFENTRA.
 18282     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18283     GO TO 8200-SEND-DATAONLY.
 18284
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 335
* VP6311.cbl
 18286
 18287******************************************************************
 18288*                                                                *
 18289*           R E - D I S P L A Y   R E C O R D                    *
 18290*                                                                *
 18291******************************************************************
 18292
 18293 3900-RE-DISPLAY-RECORD.
 18294
 18295* EXEC CICS HANDLE CONDITION
 18296*         NOTFND   (3990-NOT-FOUND)
 18297*    END-EXEC.
 18298*    MOVE '"$I                   ! H #00015611' TO DFHEIV0
 18299     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18300     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18301     MOVE X'4820233030303135363131' TO DFHEIV0(25:11)
 18302     CALL 'kxdfhei1' USING DFHEIV0
 18303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18304
 18305
 18306     IF PI-DISPLAY-ORIGINAL-BATCH
 18307         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18308     ELSE
 18309         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18310
 18311
 18312* EXEC CICS READ
 18313*         DATASET   (FILE-ID)
 18314*         RIDFLD    (PI-PREV-KEY)
 18315*         SET       (ADDRESS OF PENDING-BUSINESS)
 18316*    END-EXEC.
 18317*    MOVE '&"S        E          (   #00015620' TO DFHEIV0
 18318     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18319     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18320     MOVE X'2020233030303135363230' TO DFHEIV0(25:11)
 18321     CALL 'kxdfhei1' USING DFHEIV0,
 18322           FILE-ID,
 18323           DFHEIV20,
 18324           DFHEIV99,
 18325           PI-PREV-KEY,
 18326           DFHEIV99,
 18327           DFHEIV99,
 18328           DFHEIV99
 18329     SET ADDRESS OF PENDING-BUSINESS TO
 18330         DFHEIV20
 18331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18332
 18333
 18334     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18335
 18336     IF PB-ISSUE
 18337         GO TO 7000-DISPLAY-ISSUES.
 18338
 18339     IF PB-CANCELLATION
 18340         GO TO 7100-DISPLAY-CANCELS.
 18341
 18342     IF PB-BATCH-TRAILER
 18343         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 336
* VP6311.cbl
 18344
 18345 3990-NOT-FOUND.
 18346     MOVE LOW-VALUES             TO VP631BI.
 18347
 18348     IF PI-MAP-NAME = VP631B
 18349         MOVE -1                  TO BMAINTL
 18350     ELSE
 18351         MOVE -1                  TO CMAINTL.
 18352
 18353     GO TO 8100-SEND-INITIAL-MAP.
 18354
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 337
* VP6311.cbl
 18356
 18357***************************************************************
 18358*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18359*                                                             *
 18360*      1. START BROWSE WITH                                   *
 18361*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18362*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18363*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18364*                                                             *
 18365*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18366*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18367*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18368*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18369*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18370*               AND IS IT TO BE DISPLAYED.                    *
 18371*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18372*               DISPLAYED.                                    *
 18373*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18374*               DISPLAYED.                                    *
 18375*                                                             *
 18376*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18377*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18378***************************************************************
 18379
 18380 4000-BROWSE-DETAIL-FORWARD.
 18381     IF FIRST-TIME
 18382        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18383     ELSE
 18384        IF SHOW-RECORD
 18385           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18386           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18387           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18388           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18389           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18390        ELSE
 18391           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18392
 18393
 18394* EXEC CICS HANDLE CONDITION
 18395*         NOTFND   (4050-END-RECORDS)
 18396*         ENDFILE  (4050-END-RECORDS)
 18397*    END-EXEC.
 18398*    MOVE '"$I''                  ! I #00015685' TO DFHEIV0
 18399     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18401     MOVE X'4920233030303135363835' TO DFHEIV0(25:11)
 18402     CALL 'kxdfhei1' USING DFHEIV0
 18403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18404
 18405
 18406
 18407* EXEC CICS STARTBR
 18408*         DATASET   (FILE-ID-ERPNDB2)
 18409*         RIDFLD    (ERPNDB-ALT-KEY)
 18410*    END-EXEC.
 18411     MOVE 0
 18412       TO DFHEIV11
 18413*    MOVE '&,         G          &   #00015690' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 338
* VP6311.cbl
 18414     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18415     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18416     MOVE X'2020233030303135363930' TO DFHEIV0(25:11)
 18417     CALL 'kxdfhei1' USING DFHEIV0,
 18418           FILE-ID-ERPNDB2,
 18419           ERPNDB-ALT-KEY,
 18420           DFHEIV99,
 18421           DFHEIV11,
 18422           DFHEIV99
 18423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18424
 18425
 18426     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18427
 18428     IF FIRST-TIME OR SHOW-RECORD
 18429        MOVE SPACE               TO WS-FIRST-TIME-SW
 18430        GO TO 4005-READ-NEXT-RECORD.
 18431
 18432
 18433* EXEC CICS READNEXT
 18434*         DATASET    (FILE-ID-ERPNDB2)
 18435*         SET        (ADDRESS OF PENDING-BUSINESS)
 18436*         RIDFLD     (ERPNDB-ALT-KEY)
 18437*    END-EXEC.
 18438     MOVE 0
 18439       TO DFHEIV11
 18440*    MOVE '&.S                   )   #00015701' TO DFHEIV0
 18441     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18442     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18443     MOVE X'2020233030303135373031' TO DFHEIV0(25:11)
 18444     CALL 'kxdfhei1' USING DFHEIV0,
 18445           FILE-ID-ERPNDB2,
 18446           DFHEIV20,
 18447           DFHEIV99,
 18448           ERPNDB-ALT-KEY,
 18449           DFHEIV99,
 18450           DFHEIV11,
 18451           DFHEIV99,
 18452           DFHEIV99
 18453     SET ADDRESS OF PENDING-BUSINESS TO
 18454         DFHEIV20
 18455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18456
 18457
 18458 4005-READ-NEXT-RECORD.
 18459
 18460* EXEC CICS READNEXT
 18461*         DATASET    (FILE-ID-ERPNDB2)
 18462*         SET        (ADDRESS OF PENDING-BUSINESS)
 18463*         RIDFLD     (ERPNDB-ALT-KEY)
 18464*    END-EXEC.
 18465     MOVE 0
 18466       TO DFHEIV11
 18467*    MOVE '&.S                   )   #00015708' TO DFHEIV0
 18468     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18469     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18470     MOVE X'2020233030303135373038' TO DFHEIV0(25:11)
 18471     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 339
* VP6311.cbl
 18472           FILE-ID-ERPNDB2,
 18473           DFHEIV20,
 18474           DFHEIV99,
 18475           ERPNDB-ALT-KEY,
 18476           DFHEIV99,
 18477           DFHEIV11,
 18478           DFHEIV99,
 18479           DFHEIV99
 18480     SET ADDRESS OF PENDING-BUSINESS TO
 18481         DFHEIV20
 18482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18483
 18484
 18485     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18486
 18487     IF WS-BATCH-PREFIX = '#CL'
 18488        GO TO 4005-READ-NEXT-RECORD.
 18489
 18490     IF SHOW-RECORD
 18491        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18492           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18493           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18494           PB-STATE         NOT = PI-PB-STATE          OR
 18495           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18496           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18497           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18498           GO TO 4050-END-RECORDS
 18499        ELSE
 18500           GO TO 4010-CHECK-REC-TYPE.
 18501
 18502     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18503        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18504        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18505        PB-STATE            NOT = PI-PB-STATE          OR
 18506        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18507        GO TO 4050-END-RECORDS.
 18508
 18509     IF PB-BATCH-TRAILER
 18510        GO TO 4005-READ-NEXT-RECORD.
 18511
 18512     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18513        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18514           GO TO 4005-READ-NEXT-RECORD
 18515        ELSE
 18516           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18517              GO TO 4010-CHECK-REC-TYPE
 18518           ELSE
 18519              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18520                 GO TO 4010-CHECK-REC-TYPE
 18521              ELSE
 18522                 GO TO 4005-READ-NEXT-RECORD.
 18523
 18524     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18525        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18526           GO TO 4005-READ-NEXT-RECORD.
 18527
 18528 4010-CHECK-REC-TYPE.
 18529     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 340
* VP6311.cbl
 18530         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18531             NEXT SENTENCE
 18532         ELSE
 18533             GO TO 4005-READ-NEXT-RECORD.
 18534
 18535     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18536         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18537             NEXT SENTENCE
 18538        ELSE
 18539             GO TO 4005-READ-NEXT-RECORD.
 18540
 18541     IF NOT DISPLAY-CHANGE-RECORDS AND
 18542            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18543        GO TO 4005-READ-NEXT-RECORD.
 18544
 18545     IF DISPLAY-HOLD-RECORDS AND
 18546        NOT PB-RECORD-ON-HOLD
 18547          GO TO 4005-READ-NEXT-RECORD.
 18548
 18549     IF PB-ISSUE
 18550        IF DISPLAY-CHK-REQ-RECORDS
 18551            GO TO 4005-READ-NEXT-RECORD.
 18552
 18553     IF PB-ISSUE
 18554        IF ISSUE-WITH-WARNING
 18555           IF PB-WARNING-ERRORS
 18556              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18557                  GO TO 4005-READ-NEXT-RECORD
 18558              ELSE
 18559                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18560                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18561                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18562                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18563                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18564                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18565                 GO TO 7000-DISPLAY-ISSUES
 18566           ELSE
 18567              GO TO 4005-READ-NEXT-RECORD.
 18568
 18569     IF PB-ISSUE
 18570        IF (ISSUES-IN-ERROR AND
 18571            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18572            ALL-ISSUES
 18573            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18574            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18575            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18576            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18577            MOVE PB-SV-STATE            TO PI-SV-STATE
 18578            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18579            GO TO 7000-DISPLAY-ISSUES
 18580        ELSE
 18581            GO TO 4005-READ-NEXT-RECORD.
 18582
 18583     IF PB-CANCELLATION
 18584        IF DISPLAY-CHK-REQ-RECORDS
 18585           IF PB-C-REFUND-REQUESTED
 18586              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18587              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 341
* VP6311.cbl
 18588              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18589              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18590              MOVE PB-SV-STATE            TO PI-SV-STATE
 18591              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18592              GO TO 7100-DISPLAY-CANCELS
 18593           ELSE
 18594               GO TO 4005-READ-NEXT-RECORD.
 18595
 18596     IF PB-CANCELLATION
 18597        IF CANCEL-WITH-WARNING
 18598           IF PB-WARNING-ERRORS
 18599              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18600                  GO TO 4005-READ-NEXT-RECORD
 18601              ELSE
 18602                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18603                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18604                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18605                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18606                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18607                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18608                 GO TO 7100-DISPLAY-CANCELS
 18609           ELSE
 18610              GO TO 4005-READ-NEXT-RECORD.
 18611
 18612     IF PB-CANCELLATION
 18613        IF (CANCEL-IN-ERROR  AND
 18614            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18615            ALL-CANCELS
 18616            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18617            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18618            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18619            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18620            MOVE PB-SV-STATE            TO PI-SV-STATE
 18621            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18622            GO TO 7100-DISPLAY-CANCELS.
 18623
 18624     GO TO 4005-READ-NEXT-RECORD.
 18625
 18626 4050-END-RECORDS.
 18627******************************************************************
 18628*                                                                *
 18629*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18630*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING
 18631*         PROGRAM.                                               *
 18632*                                                                *
 18633******************************************************************
 18634
 18635     IF BROWSE-STARTED
 18636        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18637
 18638* EXEC CICS ENDBR
 18639*            DATASET  (FILE-ID-ERPNDB2)
 18640*       END-EXEC.
 18641     MOVE 0
 18642       TO DFHEIV11
 18643*    MOVE '&2                    $   #00015866' TO DFHEIV0
 18644     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18645     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 342
* VP6311.cbl
 18646     MOVE X'2020233030303135383636' TO DFHEIV0(25:11)
 18647     CALL 'kxdfhei1' USING DFHEIV0,
 18648           FILE-ID-ERPNDB2,
 18649           DFHEIV11,
 18650           DFHEIV99
 18651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18652
 18653
 18654     IF  EIBTRNID NOT = TRANS-EXB1
 18655         IF PENDING-BUS-RECS-FOUND
 18656             NEXT SENTENCE
 18657           ELSE
 18658             MOVE '9'            TO PI-BROWSE-SW
 18659             GO TO 9400-CLEAR.
 18660
 18661     IF SHOW-RECORD
 18662        MOVE ER-2253            TO EMI-ERROR
 18663       ELSE
 18664        MOVE ER-2254            TO EMI-ERROR.
 18665
 18666     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18667
 18668     IF PI-MAP-NAME = SPACES
 18669        MOVE -1                  TO DPFENTRL
 18670        MOVE VP631D               TO PI-MAP-NAME
 18671        GO TO 8100-SEND-INITIAL-MAP.
 18672
 18673     IF PI-MAP-NAME = VP631B
 18674        MOVE -1                  TO BMAINTL
 18675     ELSE
 18676        IF PI-MAP-NAME = VP631C
 18677           MOVE -1               TO CMAINTL
 18678        ELSE
 18679           MOVE -1               TO DPFENTRL.
 18680
 18681     GO TO 8200-SEND-DATAONLY.
 18682
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 343
* VP6311.cbl
 18684
 18685***************************************************************
 18686*                                                             *
 18687*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18688*                                                             *
 18689*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18690*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18691*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18692*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18693*                                                             *
 18694*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18695*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18696*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18697*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18698*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18699*                AND IS IT TO BE DISPLAYED.                   *
 18700*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18701*                DISPLAYED.                                   *
 18702*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18703*                DISPLAYED.                                   *
 18704*                                                             *
 18705*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18706*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18707*                                                             *
 18708*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18709*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18710*                THEY ARE NOT TO BE DISPLAYED.                *
 18711*                                                             *
 18712***************************************************************
 18713
 18714 4100-BROWSE-PRIMARY-FORWARD.
 18715     IF FIRST-TIME  OR SHOW-RECORD
 18716        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18717        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18718        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18719     ELSE
 18720        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18721        IF ERPNDB-BATCH-SEQ-NO = +9999
 18722           GO TO 4150-END-BATCH
 18723        ELSE
 18724           IF DISPLAY-CHANGE-RECORDS
 18725              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18726           ELSE
 18727              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18728              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18729
 18730     IF FIRST-TIME
 18731         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18732            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18733              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18734
 18735
 18736* EXEC CICS HANDLE CONDITION
 18737*         ENDFILE  (4150-END-BATCH)
 18738*    END-EXEC.
 18739*    MOVE '"$''                   ! J #00015951' TO DFHEIV0
 18740     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 344
* VP6311.cbl
 18742     MOVE X'4A20233030303135393531' TO DFHEIV0(25:11)
 18743     CALL 'kxdfhei1' USING DFHEIV0
 18744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18745
 18746
 18747 4105-READ-NEXT.
 18748
 18749* EXEC CICS HANDLE CONDITION
 18750*         NOTFND    (4150-END-BATCH)
 18751*    END-EXEC.
 18752*    MOVE '"$I                   ! K #00015956' TO DFHEIV0
 18753     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18754     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18755     MOVE X'4B20233030303135393536' TO DFHEIV0(25:11)
 18756     CALL 'kxdfhei1' USING DFHEIV0
 18757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18758
 18759
 18760     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18761
 18762     IF PI-DISPLAY-ORIGINAL-BATCH
 18763        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18764     ELSE
 18765        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18766
 18767
 18768* EXEC CICS READ
 18769*         DATASET   (FILE-ID)
 18770*         SET       (ADDRESS OF PENDING-BUSINESS)
 18771*         RIDFLD    (ERPNDB-KEY)
 18772*         GTEQ
 18773*    END-EXEC.
 18774*    MOVE '&"S        G          (   #00015967' TO DFHEIV0
 18775     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18776     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18777     MOVE X'2020233030303135393637' TO DFHEIV0(25:11)
 18778     CALL 'kxdfhei1' USING DFHEIV0,
 18779           FILE-ID,
 18780           DFHEIV20,
 18781           DFHEIV99,
 18782           ERPNDB-KEY,
 18783           DFHEIV99,
 18784           DFHEIV99,
 18785           DFHEIV99
 18786     SET ADDRESS OF PENDING-BUSINESS TO
 18787         DFHEIV20
 18788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18789
 18790
 18791     IF PI-DISPLAY-ORIGINAL-BATCH
 18792        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18793           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18794           GO TO 4150-END-BATCH
 18795        ELSE
 18796           IF PB-BATCH-TRAILER
 18797              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18798              GO TO 4105-READ-NEXT
 18799           ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 345
* VP6311.cbl
 18800              NEXT SENTENCE
 18801     ELSE
 18802        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18803           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18804           GO TO 4150-END-BATCH.
 18805
 18806     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18807
 18808     IF WS-BATCH-PREFIX = '#CL'
 18809         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18810         GO TO 4105-READ-NEXT.
 18811
 18812     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18813     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18814     MOVE PB-STATE               TO PI-PB-STATE.
 18815     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18816
 18817     IF PB-BATCH-TRAILER
 18818        IF SHOW-RECORD
 18819           GO TO 4150-END-BATCH
 18820        ELSE
 18821           MOVE ER-2251         TO EMI-ERROR
 18822           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18823           MOVE 1               TO PI-BROWSE-TYPE
 18824           GO TO 7200-DISPLAY-BATCHES.
 18825
 18826     IF SHOW-RECORD
 18827           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18828              GO TO 4110-BUMP-SEQ
 18829           ELSE
 18830              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18831                 GO TO 4110-BUMP-SEQ
 18832              ELSE
 18833                 GO TO 4107-CHECK-REC-TYPE.
 18834
 18835     IF NOT  PI-PRIMARY-WITH-SELECT
 18836        GO TO 4107-CHECK-REC-TYPE.
 18837
 18838     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18839        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18840           GO TO 4110-BUMP-SEQ
 18841        ELSE
 18842           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18843              GO TO 4107-CHECK-REC-TYPE
 18844           ELSE
 18845              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18846                 GO TO 4107-CHECK-REC-TYPE
 18847              ELSE
 18848                 GO TO 4110-BUMP-SEQ.
 18849
 18850     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18851        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18852           GO TO 4110-BUMP-SEQ.
 18853
 18854 4107-CHECK-REC-TYPE.
 18855     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18856         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18857             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 346
* VP6311.cbl
 18858           ELSE
 18859             GO TO 4110-BUMP-SEQ.
 18860
 18861     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18862         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18863             NEXT SENTENCE
 18864           ELSE
 18865             GO TO 4110-BUMP-SEQ.
 18866
 18867     IF NOT DISPLAY-CHANGE-RECORDS AND
 18868        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18869           GO TO 4110-BUMP-SEQ.
 18870
 18871     IF DISPLAY-HOLD-RECORDS AND
 18872        NOT PB-RECORD-ON-HOLD
 18873          GO TO 4110-BUMP-SEQ.
 18874
 18875     IF PB-ISSUE
 18876        IF DISPLAY-CHK-REQ-RECORDS
 18877            GO TO 4110-BUMP-SEQ.
 18878
 18879     IF PB-ISSUE
 18880        IF ISSUE-WITH-WARNING
 18881           IF PB-WARNING-ERRORS
 18882              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18883                  GO TO 4110-BUMP-SEQ
 18884              ELSE
 18885                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18886                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18887                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18888                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18889                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18890                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18891                 GO TO 7000-DISPLAY-ISSUES
 18892        ELSE
 18893            GO TO 4110-BUMP-SEQ.
 18894
 18895     IF PB-ISSUE
 18896        IF (ISSUES-IN-ERROR AND
 18897            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18898            ALL-ISSUES
 18899            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18900            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18901            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18902            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18903            MOVE PB-SV-STATE            TO PI-SV-STATE
 18904            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18905            GO TO 7000-DISPLAY-ISSUES
 18906        ELSE
 18907            GO TO 4110-BUMP-SEQ.
 18908
 18909     IF PB-CANCELLATION
 18910        IF DISPLAY-CHK-REQ-RECORDS
 18911           IF PB-C-REFUND-REQUESTED
 18912              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18913              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18914              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18915              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 347
* VP6311.cbl
 18916              MOVE PB-SV-STATE            TO PI-SV-STATE
 18917              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18918              GO TO 7100-DISPLAY-CANCELS
 18919           ELSE
 18920              GO TO 4110-BUMP-SEQ.
 18921
 18922     IF PB-CANCELLATION
 18923        IF CANCEL-WITH-WARNING
 18924           IF PB-WARNING-ERRORS
 18925              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18926                  GO TO 4110-BUMP-SEQ
 18927              ELSE
 18928                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18929                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18930                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18931                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18932                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18933                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18934                 GO TO 7100-DISPLAY-CANCELS
 18935           ELSE
 18936              GO TO 4110-BUMP-SEQ.
 18937
 18938     IF PB-CANCELLATION
 18939        IF (CANCEL-IN-ERROR  AND
 18940            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18941            ALL-CANCELS
 18942            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18943            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18944            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18945            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18946            MOVE PB-SV-STATE            TO PI-SV-STATE
 18947            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18948            GO TO 7100-DISPLAY-CANCELS.
 18949
 18950 4110-BUMP-SEQ.
 18951     IF NOT DISPLAY-CHANGE-RECORDS
 18952        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18953        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18954     ELSE
 18955        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18956           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18957           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18958        ELSE
 18959           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18960           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18961
 18962     GO TO 4105-READ-NEXT.
 18963
 18964 4150-END-BATCH.
 18965******************************************************************
 18966*                                                                *
 18967*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18968*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING     *
 18969*         PROGRAM.                                               *
 18970*                                                                *
 18971******************************************************************
 18972
 18973     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 348
* VP6311.cbl
 18974         IF PENDING-BUS-RECS-FOUND
 18975             NEXT SENTENCE
 18976           ELSE
 18977             MOVE '9'            TO PI-BROWSE-SW
 18978             GO TO 9400-CLEAR.
 18979
 18980     IF SHOW-RECORD
 18981        MOVE ER-2253             TO EMI-ERROR
 18982     ELSE
 18983        MOVE ER-2251             TO EMI-ERROR.
 18984
 18985     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18986
 18987     IF PI-MAP-NAME = SPACES
 18988        MOVE -1                  TO BMAINTL
 18989        MOVE VP631B              TO PI-MAP-NAME
 18990        GO TO 8100-SEND-INITIAL-MAP.
 18991
 18992     IF PI-MAP-NAME = VP631B
 18993        MOVE -1                  TO BMAINTL
 18994     ELSE
 18995        IF PI-MAP-NAME = VP631C
 18996           MOVE -1               TO CMAINTL
 18997        ELSE
 18998           MOVE -1               TO DPFENTRL.
 18999
 19000     GO TO 8200-SEND-DATAONLY.
 19001
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 349
* VP6311.cbl
 19003
 19004***************************************************************
 19005*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19006*                                                             *
 19007*      1. START BROWSE WITH                                   *
 19008*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19009*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19010*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19011*                                                             *
 19012*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19013*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19014*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19015*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19016*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19017*               AND IS IT TO BE DISPLAYED.                    *
 19018*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19019*               DISPLAYED.                                    *
 19020*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19021*               DISPLAYED.                                    *
 19022*                                                             *
 19023*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19024*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19025***************************************************************
 19026
 19027 4200-BROWSE-CSR-FORWARD.
 19028
 19029     IF FIRST-TIME
 19030        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19031     ELSE
 19032        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19033
 19034
 19035* EXEC CICS HANDLE CONDITION
 19036*         NOTFND   (4250-END-RECORDS)
 19037*         ENDFILE  (4250-END-RECORDS)
 19038*    END-EXEC.
 19039*    MOVE '"$I''                  ! L #00016217' TO DFHEIV0
 19040     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19042     MOVE X'4C20233030303136323137' TO DFHEIV0(25:11)
 19043     CALL 'kxdfhei1' USING DFHEIV0
 19044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19045
 19046
 19047
 19048* EXEC CICS STARTBR
 19049*         DATASET   (FILE-ID-ERPNDB4)
 19050*         RIDFLD    (ERPNDB-CSR-KEY)
 19051*    END-EXEC.
 19052     MOVE 0
 19053       TO DFHEIV11
 19054*    MOVE '&,         G          &   #00016222' TO DFHEIV0
 19055     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19056     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19057     MOVE X'2020233030303136323232' TO DFHEIV0(25:11)
 19058     CALL 'kxdfhei1' USING DFHEIV0,
 19059           FILE-ID-ERPNDB4,
 19060           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 350
* VP6311.cbl
 19061           DFHEIV99,
 19062           DFHEIV11,
 19063           DFHEIV99
 19064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19065
 19066
 19067     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19068
 19069     IF FIRST-TIME
 19070        MOVE SPACE               TO WS-FIRST-TIME-SW
 19071        GO TO 4205-READ-NEXT-RECORD.
 19072
 19073
 19074* EXEC CICS READNEXT
 19075*         DATASET    (FILE-ID-ERPNDB4)
 19076*         SET        (ADDRESS OF PENDING-BUSINESS)
 19077*         RIDFLD     (ERPNDB-CSR-KEY)
 19078*    END-EXEC.
 19079     MOVE 0
 19080       TO DFHEIV11
 19081*    MOVE '&.S                   )   #00016233' TO DFHEIV0
 19082     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19083     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19084     MOVE X'2020233030303136323333' TO DFHEIV0(25:11)
 19085     CALL 'kxdfhei1' USING DFHEIV0,
 19086           FILE-ID-ERPNDB4,
 19087           DFHEIV20,
 19088           DFHEIV99,
 19089           ERPNDB-CSR-KEY,
 19090           DFHEIV99,
 19091           DFHEIV11,
 19092           DFHEIV99,
 19093           DFHEIV99
 19094     SET ADDRESS OF PENDING-BUSINESS TO
 19095         DFHEIV20
 19096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19097
 19098
 19099 4205-READ-NEXT-RECORD.
 19100
 19101
 19102* EXEC CICS READNEXT
 19103*         DATASET    (FILE-ID-ERPNDB4)
 19104*         SET        (ADDRESS OF PENDING-BUSINESS)
 19105*         RIDFLD     (ERPNDB-CSR-KEY)
 19106*    END-EXEC.
 19107     MOVE 0
 19108       TO DFHEIV11
 19109*    MOVE '&.S                   )   #00016241' TO DFHEIV0
 19110     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19111     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19112     MOVE X'2020233030303136323431' TO DFHEIV0(25:11)
 19113     CALL 'kxdfhei1' USING DFHEIV0,
 19114           FILE-ID-ERPNDB4,
 19115           DFHEIV20,
 19116           DFHEIV99,
 19117           ERPNDB-CSR-KEY,
 19118           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 351
* VP6311.cbl
 19119           DFHEIV11,
 19120           DFHEIV99,
 19121           DFHEIV99
 19122     SET ADDRESS OF PENDING-BUSINESS TO
 19123         DFHEIV20
 19124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19125
 19126
 19127     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19128
 19129     IF WS-BATCH-PREFIX = '#CL'
 19130        GO TO 4205-READ-NEXT-RECORD.
 19131
 19132     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19133        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19134        GO TO 4250-END-RECORDS.
 19135
 19136     IF PB-BATCH-TRAILER
 19137        GO TO 4205-READ-NEXT-RECORD.
 19138
 19139     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19140        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19141           GO TO 4205-READ-NEXT-RECORD
 19142        ELSE
 19143           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19144              GO TO 4210-CHECK-REC-TYPE
 19145           ELSE
 19146              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19147                 GO TO 4210-CHECK-REC-TYPE
 19148              ELSE
 19149                 GO TO 4205-READ-NEXT-RECORD.
 19150
 19151     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19152        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19153           GO TO 4205-READ-NEXT-RECORD.
 19154
 19155 4210-CHECK-REC-TYPE.
 19156     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19157         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19158             NEXT SENTENCE
 19159         ELSE
 19160             GO TO 4205-READ-NEXT-RECORD.
 19161
 19162     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19163         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19164             NEXT SENTENCE
 19165        ELSE
 19166             GO TO 4205-READ-NEXT-RECORD.
 19167
 19168     IF NOT DISPLAY-CHANGE-RECORDS AND
 19169            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19170        GO TO 4205-READ-NEXT-RECORD.
 19171
 19172     IF DISPLAY-HOLD-RECORDS AND
 19173        NOT PB-RECORD-ON-HOLD
 19174          GO TO 4205-READ-NEXT-RECORD.
 19175
 19176     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 352
* VP6311.cbl
 19177        IF DISPLAY-CHK-REQ-RECORDS
 19178            GO TO 4205-READ-NEXT-RECORD.
 19179
 19180     IF PB-ISSUE
 19181        IF ISSUE-WITH-WARNING
 19182           IF PB-WARNING-ERRORS
 19183              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19184                  GO TO 4205-READ-NEXT-RECORD
 19185              ELSE
 19186                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19187                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19188                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19189                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19190                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19191                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19192                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19193                 GO TO 7000-DISPLAY-ISSUES
 19194           ELSE
 19195              GO TO 4205-READ-NEXT-RECORD.
 19196
 19197     IF PB-ISSUE
 19198        IF (ISSUES-IN-ERROR AND
 19199            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19200            ALL-ISSUES
 19201            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19202            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19203            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19204            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19205            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19206            MOVE PB-SV-STATE            TO PI-SV-STATE
 19207            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19208            GO TO 7000-DISPLAY-ISSUES
 19209        ELSE
 19210            GO TO 4205-READ-NEXT-RECORD.
 19211
 19212     IF PB-CANCELLATION
 19213        IF DISPLAY-CHK-REQ-RECORDS
 19214           IF PB-C-REFUND-REQUESTED
 19215              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19216              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19217              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19218              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19219              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19220              MOVE PB-SV-STATE            TO PI-SV-STATE
 19221              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19222              GO TO 7100-DISPLAY-CANCELS
 19223           ELSE
 19224               GO TO 4205-READ-NEXT-RECORD.
 19225
 19226     IF PB-CANCELLATION
 19227        IF CANCEL-WITH-WARNING
 19228           IF PB-WARNING-ERRORS
 19229              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19230                  GO TO 4205-READ-NEXT-RECORD
 19231              ELSE
 19232                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19233                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19234                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 353
* VP6311.cbl
 19235                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19236                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19237                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19238                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19239                 GO TO 7100-DISPLAY-CANCELS
 19240           ELSE
 19241              GO TO 4205-READ-NEXT-RECORD.
 19242
 19243     IF PB-CANCELLATION
 19244        IF (CANCEL-IN-ERROR  AND
 19245            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19246            ALL-CANCELS
 19247            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19248            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19249            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19250            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19251            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19252            MOVE PB-SV-STATE            TO PI-SV-STATE
 19253            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19254            GO TO 7100-DISPLAY-CANCELS.
 19255
 19256     GO TO 4205-READ-NEXT-RECORD.
 19257
 19258 4250-END-RECORDS.
 19259******************************************************************
 19260*                                                                *
 19261*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19262*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING
 19263*         PROGRAM.                                               *
 19264*                                                                *
 19265******************************************************************
 19266
 19267     IF BROWSE-STARTED
 19268        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19269
 19270* EXEC CICS ENDBR
 19271*            DATASET  (FILE-ID-ERPNDB4)
 19272*       END-EXEC.
 19273     MOVE 0
 19274       TO DFHEIV11
 19275*    MOVE '&2                    $   #00016389' TO DFHEIV0
 19276     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19277     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19278     MOVE X'2020233030303136333839' TO DFHEIV0(25:11)
 19279     CALL 'kxdfhei1' USING DFHEIV0,
 19280           FILE-ID-ERPNDB4,
 19281           DFHEIV11,
 19282           DFHEIV99
 19283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19284
 19285
 19286     IF  EIBTRNID NOT = TRANS-EXB1
 19287         IF PENDING-BUS-RECS-FOUND
 19288             NEXT SENTENCE
 19289           ELSE
 19290             MOVE '9'            TO PI-BROWSE-SW
 19291             GO TO 9400-CLEAR.
 19292
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 354
* VP6311.cbl
 19293     IF SHOW-RECORD
 19294        MOVE ER-2253            TO EMI-ERROR
 19295       ELSE
 19296        MOVE ER-2254            TO EMI-ERROR.
 19297
 19298     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19299
 19300     IF PI-MAP-NAME = SPACES
 19301        MOVE -1                  TO DPFENTRL
 19302        MOVE VP631D               TO PI-MAP-NAME
 19303        GO TO 8100-SEND-INITIAL-MAP.
 19304
 19305     IF PI-MAP-NAME = VP631B
 19306        MOVE -1                  TO BMAINTL
 19307     ELSE
 19308        IF PI-MAP-NAME = VP631C
 19309           MOVE -1               TO CMAINTL
 19310        ELSE
 19311           MOVE -1               TO DPFENTRL.
 19312
 19313     GO TO 8200-SEND-DATAONLY.
 19314
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 355
* VP6311.cbl
 19316
 19317***************************************************************
 19318*                                                             *
 19319*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19320*                                                             *
 19321*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19322*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19323*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19324*                                                             *
 19325*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19326*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19327*          A. IS IT WITHIN THE SAME COMPANY                   *
 19328*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19329*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19330*                AND IS IT TO BE DISPLAYED.                   *
 19331*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19332*                DISPLAYED.                                   *
 19333*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19334*                DISPLAYED.                                   *
 19335*                                                             *
 19336*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19337*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19338*                                                             *
 19339*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19340*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19341*                THEY ARE NOT TO BE DISPLAYED.                *
 19342*                                                             *
 19343***************************************************************
 19344
 19345 4300-BROWSE-FILE-FORWARD.
 19346     IF FIRST-TIME OR SHOW-RECORD
 19347        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19348        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19349        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19350     ELSE
 19351        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19352        IF ERPNDB-BATCH-SEQ-NO = +9999
 19353           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19354        ELSE
 19355           IF DISPLAY-CHANGE-RECORDS
 19356              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19357           ELSE
 19358              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19359              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19360
 19361
 19362* EXEC CICS HANDLE CONDITION
 19363*         ENDFILE  (4350-END-BATCH)
 19364*         NOTFND   (4350-END-BATCH)
 19365*    END-EXEC.
 19366*    MOVE '"$''I                  ! M #00016468' TO DFHEIV0
 19367     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19368     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19369     MOVE X'4D20233030303136343638' TO DFHEIV0(25:11)
 19370     CALL 'kxdfhei1' USING DFHEIV0
 19371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19372
 19373
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 356
* VP6311.cbl
 19374 4305-READ-NEXT.
 19375     IF PI-DISPLAY-ORIGINAL-BATCH
 19376        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19377     ELSE
 19378        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19379
 19380
 19381* EXEC CICS READ
 19382*         DATASET   (FILE-ID)
 19383*         SET       (ADDRESS OF PENDING-BUSINESS)
 19384*         RIDFLD    (ERPNDB-KEY)
 19385*         GTEQ
 19386*    END-EXEC.
 19387*    MOVE '&"S        G          (   #00016479' TO DFHEIV0
 19388     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19389     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19390     MOVE X'2020233030303136343739' TO DFHEIV0(25:11)
 19391     CALL 'kxdfhei1' USING DFHEIV0,
 19392           FILE-ID,
 19393           DFHEIV20,
 19394           DFHEIV99,
 19395           ERPNDB-KEY,
 19396           DFHEIV99,
 19397           DFHEIV99,
 19398           DFHEIV99
 19399     SET ADDRESS OF PENDING-BUSINESS TO
 19400         DFHEIV20
 19401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19402
 19403
 19404     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19405        GO TO 4350-END-BATCH.
 19406
 19407     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19408                                    WS-BATCH-NO.
 19409
 19410     IF  WS-BATCH-PREFIX = '#CL'
 19411         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19412         GO TO 4305-READ-NEXT.
 19413
 19414     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19415     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19416     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19417     MOVE PB-STATE               TO PI-PB-STATE.
 19418     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19419
 19420     IF PB-BATCH-TRAILER
 19421        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19422        GO TO 4305-READ-NEXT.
 19423
 19424     IF SHOW-RECORD
 19425           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19426              GO TO 4310-BUMP-SEQ
 19427           ELSE
 19428              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19429                 GO TO 4310-BUMP-SEQ
 19430              ELSE
 19431                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 357
* VP6311.cbl
 19432
 19433     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19434        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19435           GO TO 4310-BUMP-SEQ
 19436        ELSE
 19437           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19438              GO TO 4307-CHECK-REC-TYPE
 19439           ELSE
 19440              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19441                 GO TO 4307-CHECK-REC-TYPE
 19442              ELSE
 19443                 GO TO 4310-BUMP-SEQ.
 19444
 19445     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19446        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19447           GO TO 4310-BUMP-SEQ.
 19448
 19449 4307-CHECK-REC-TYPE.
 19450     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19451         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19452             NEXT SENTENCE
 19453         ELSE
 19454             GO TO 4310-BUMP-SEQ.
 19455
 19456     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19457         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19458             NEXT SENTENCE
 19459        ELSE
 19460             GO TO 4310-BUMP-SEQ.
 19461
 19462     IF NOT DISPLAY-CHANGE-RECORDS AND
 19463            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19464        GO TO 4310-BUMP-SEQ.
 19465
 19466     IF DISPLAY-HOLD-RECORDS AND
 19467        NOT PB-RECORD-ON-HOLD
 19468          GO TO 4310-BUMP-SEQ.
 19469
 19470     IF PB-ISSUE
 19471        IF DISPLAY-CHK-REQ-RECORDS
 19472           GO TO 4310-BUMP-SEQ.
 19473
 19474     IF PB-ISSUE
 19475        IF ISSUE-WITH-WARNING
 19476           IF PB-WARNING-ERRORS
 19477              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19478                  GO TO 4310-BUMP-SEQ
 19479              ELSE
 19480                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19481                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19482                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19483                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19484                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19485                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19486                 GO TO 7000-DISPLAY-ISSUES
 19487           ELSE
 19488              GO TO 4310-BUMP-SEQ.
 19489
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 358
* VP6311.cbl
 19490     IF PB-ISSUE
 19491        IF (ISSUES-IN-ERROR AND
 19492            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19493            ALL-ISSUES
 19494            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19495            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19496            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19497            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19498            MOVE PB-SV-STATE            TO PI-SV-STATE
 19499            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19500            GO TO 7000-DISPLAY-ISSUES
 19501        ELSE
 19502            GO TO 4310-BUMP-SEQ.
 19503
 19504     IF PB-CANCELLATION
 19505        IF DISPLAY-CHK-REQ-RECORDS
 19506           IF PB-C-REFUND-REQUESTED
 19507              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19508              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19509              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19510              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19511              MOVE PB-SV-STATE            TO PI-SV-STATE
 19512              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19513              GO TO 7100-DISPLAY-CANCELS
 19514           ELSE
 19515              GO TO 4310-BUMP-SEQ.
 19516
 19517     IF PB-CANCELLATION
 19518        IF CANCEL-WITH-WARNING
 19519           IF PB-WARNING-ERRORS
 19520              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19521                  GO TO 4310-BUMP-SEQ
 19522              ELSE
 19523                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19524                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19525                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19526                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19527                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19528                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19529                 GO TO 7100-DISPLAY-CANCELS
 19530           ELSE
 19531              GO TO 4310-BUMP-SEQ.
 19532
 19533     IF PB-CANCELLATION
 19534        IF (CANCEL-IN-ERROR  AND
 19535            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19536            ALL-CANCELS
 19537            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19538            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19539            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19540            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19541            MOVE PB-SV-STATE            TO PI-SV-STATE
 19542            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19543            GO TO 7100-DISPLAY-CANCELS.
 19544
 19545 4310-BUMP-SEQ.
 19546     IF NOT DISPLAY-CHANGE-RECORDS
 19547        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 359
* VP6311.cbl
 19548        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19549     ELSE
 19550        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19551           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19552           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19553        ELSE
 19554           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19555           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19556
 19557     GO TO 4305-READ-NEXT.
 19558
 19559 4350-END-BATCH.
 19560
 19561******************************************************************
 19562*                                                                *
 19563*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19564*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING    *
 19565*         PROGRAM.                                               *
 19566*                                                                *
 19567******************************************************************
 19568
 19569     IF  EIBTRNID NOT = TRANS-EXB1
 19570         IF PENDING-BUS-RECS-FOUND
 19571             NEXT SENTENCE
 19572           ELSE
 19573             MOVE '9'            TO PI-BROWSE-SW
 19574             GO TO 9400-CLEAR.
 19575
 19576     IF SHOW-RECORD
 19577        MOVE ER-2253            TO EMI-ERROR
 19578     ELSE
 19579        MOVE ER-2251            TO EMI-ERROR.
 19580
 19581     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19582
 19583     IF PI-MAP-NAME = SPACES
 19584        MOVE -1                  TO BMAINTL
 19585        MOVE VP631B               TO PI-MAP-NAME
 19586        GO TO 8100-SEND-INITIAL-MAP.
 19587
 19588     IF PI-MAP-NAME = VP631B
 19589        MOVE -1                  TO BMAINTL
 19590     ELSE
 19591        IF PI-MAP-NAME = VP631C
 19592           MOVE -1               TO CMAINTL
 19593        ELSE
 19594           MOVE -1               TO DPFENTRL.
 19595
 19596     GO TO 8200-SEND-DATAONLY.
 19597
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 360
* VP6311.cbl
 19599
 19600******************************************************************
 19601*                                                                *
 19602*        B R O W S E   D E T A I L   B A C K W A R D             *
 19603*                                                                *
 19604******************************************************************
 19605
 19606 4500-BROWSE-DETAIL-BACKWARD.
 19607
 19608     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19609
 19610
 19611* EXEC CICS HANDLE CONDITION
 19612*         NOTFND   (4570-NOT-FOUND)
 19613*         ENDFILE  (4550-END-RECORDS)
 19614*    END-EXEC
 19615*    MOVE '"$I''                  ! N #00016692' TO DFHEIV0
 19616     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19618     MOVE X'4E20233030303136363932' TO DFHEIV0(25:11)
 19619     CALL 'kxdfhei1' USING DFHEIV0
 19620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19621
 19622
 19623* EXEC CICS STARTBR
 19624*         DATASET   (FILE-ID-ERPNDB2)
 19625*         RIDFLD    (ERPNDB-ALT-KEY)
 19626*    END-EXEC.
 19627     MOVE 0
 19628       TO DFHEIV11
 19629*    MOVE '&,         G          &   #00016697' TO DFHEIV0
 19630     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19631     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19632     MOVE X'2020233030303136363937' TO DFHEIV0(25:11)
 19633     CALL 'kxdfhei1' USING DFHEIV0,
 19634           FILE-ID-ERPNDB2,
 19635           ERPNDB-ALT-KEY,
 19636           DFHEIV99,
 19637           DFHEIV11,
 19638           DFHEIV99
 19639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19640
 19641
 19642     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19643                                    WS-FIRST-TIME-SW.
 19644
 19645 4505-READ-PREV-RECORD.
 19646
 19647* EXEC CICS READPREV
 19648*         DATASET    (FILE-ID-ERPNDB2)
 19649*         SET        (ADDRESS OF PENDING-BUSINESS)
 19650*         RIDFLD     (ERPNDB-ALT-KEY)
 19651*    END-EXEC.
 19652     MOVE 0
 19653       TO DFHEIV11
 19654*    MOVE '&0S                   )   #00016706' TO DFHEIV0
 19655     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19656     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 361
* VP6311.cbl
 19657     MOVE X'2020233030303136373036' TO DFHEIV0(25:11)
 19658     CALL 'kxdfhei1' USING DFHEIV0,
 19659           FILE-ID-ERPNDB2,
 19660           DFHEIV20,
 19661           DFHEIV99,
 19662           ERPNDB-ALT-KEY,
 19663           DFHEIV99,
 19664           DFHEIV11,
 19665           DFHEIV99,
 19666           DFHEIV99
 19667     SET ADDRESS OF PENDING-BUSINESS TO
 19668         DFHEIV20
 19669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19670
 19671
 19672     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19673
 19674     IF WS-BATCH-PREFIX = '#CL'
 19675         GO TO 4505-READ-PREV-RECORD.
 19676
 19677     IF FIRST-TIME
 19678         MOVE SPACE               TO WS-FIRST-TIME-SW
 19679         GO TO 4505-READ-PREV-RECORD.
 19680
 19681     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19682        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19683        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19684        PB-STATE         NOT = PI-PB-STATE    OR
 19685        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19686          GO TO 4550-END-RECORDS.
 19687
 19688
 19689     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19690
 19691     IF PB-BATCH-TRAILER
 19692        GO TO 4505-READ-PREV-RECORD.
 19693
 19694     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19695
 19696     IF  WS-BATCH-PREFIX = '#CL'
 19697         GO TO 4505-READ-PREV-RECORD.
 19698
 19699     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19700        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19701           GO TO 4505-READ-PREV-RECORD
 19702        ELSE
 19703           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19704              GO TO 4510-CHECK-REC-TYPE
 19705           ELSE
 19706              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19707                 GO TO 4510-CHECK-REC-TYPE
 19708              ELSE
 19709                 GO TO 4505-READ-PREV-RECORD.
 19710
 19711     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19712        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19713           GO TO 4505-READ-PREV-RECORD.
 19714
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 362
* VP6311.cbl
 19715 4510-CHECK-REC-TYPE.
 19716     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19717         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19718             NEXT SENTENCE
 19719         ELSE
 19720             GO TO 4505-READ-PREV-RECORD.
 19721
 19722     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19723         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19724             NEXT SENTENCE
 19725        ELSE
 19726             GO TO 4505-READ-PREV-RECORD.
 19727
 19728     IF NOT DISPLAY-CHANGE-RECORDS AND
 19729            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19730        GO TO 4505-READ-PREV-RECORD.
 19731
 19732     IF DISPLAY-HOLD-RECORDS AND
 19733        NOT PB-RECORD-ON-HOLD
 19734          GO TO 4505-READ-PREV-RECORD.
 19735
 19736     IF PB-ISSUE
 19737        IF DISPLAY-CHK-REQ-RECORDS
 19738           GO TO 4505-READ-PREV-RECORD.
 19739
 19740     IF PB-ISSUE
 19741        IF ISSUE-WITH-WARNING
 19742           IF PB-WARNING-ERRORS
 19743              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19744                  GO TO 4505-READ-PREV-RECORD
 19745              ELSE
 19746                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19747                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19748                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19749                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19750                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19751                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19752                 GO TO 7000-DISPLAY-ISSUES
 19753           ELSE
 19754              GO TO 4505-READ-PREV-RECORD.
 19755
 19756     IF PB-ISSUE
 19757        IF (ISSUES-IN-ERROR AND
 19758            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19759            ALL-ISSUES
 19760            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19761            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19762            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19763            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19764            MOVE PB-SV-STATE            TO PI-SV-STATE
 19765            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19766            GO TO 7000-DISPLAY-ISSUES
 19767        ELSE
 19768            GO TO 4505-READ-PREV-RECORD.
 19769
 19770     IF PB-CANCELLATION
 19771        IF DISPLAY-CHK-REQ-RECORDS
 19772           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 363
* VP6311.cbl
 19773              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19774              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19775              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19776              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19777              MOVE PB-SV-STATE            TO PI-SV-STATE
 19778              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19779              GO TO 7100-DISPLAY-CANCELS
 19780           ELSE
 19781              GO TO 4505-READ-PREV-RECORD.
 19782
 19783     IF PB-CANCELLATION
 19784        IF CANCEL-WITH-WARNING
 19785           IF PB-WARNING-ERRORS
 19786              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19787                  GO TO 4505-READ-PREV-RECORD
 19788              ELSE
 19789                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19790                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19791                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19792                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19793                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19794                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19795                 GO TO 7100-DISPLAY-CANCELS
 19796           ELSE
 19797              GO TO 4505-READ-PREV-RECORD.
 19798
 19799     IF PB-CANCELLATION
 19800        IF (CANCEL-IN-ERROR  AND
 19801            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19802            ALL-CANCELS
 19803            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19804            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19805            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19806            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19807            MOVE PB-SV-STATE            TO PI-SV-STATE
 19808            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19809            GO TO 7100-DISPLAY-CANCELS.
 19810
 19811     GO TO 4505-READ-PREV-RECORD.
 19812
 19813 4550-END-RECORDS.
 19814     IF PI-MAP-NAME = VP631B
 19815        MOVE -1                  TO BMAINTL
 19816     ELSE
 19817        IF PI-MAP-NAME = VP631C
 19818           MOVE -1               TO CMAINTL
 19819        ELSE
 19820           MOVE -1               TO DPFENTRL.
 19821
 19822     MOVE ER-2255               TO EMI-ERROR.
 19823     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19824     GO TO 8200-SEND-DATAONLY.
 19825
 19826 4570-NOT-FOUND.
 19827
 19828******************************************************************
 19829*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19830******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 364
* VP6311.cbl
 19831
 19832
 19833* EXEC CICS RESETBR
 19834*         DATASET    (FILE-ID-ERPNDB2)
 19835*         RIDFLD     (ERPNDB-ALT-KEY)
 19836*    END-EXEC.
 19837     MOVE 0
 19838       TO DFHEIV11
 19839*    MOVE '&4         G          &   #00016872' TO DFHEIV0
 19840     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19841     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19842     MOVE X'2020233030303136383732' TO DFHEIV0(25:11)
 19843     CALL 'kxdfhei1' USING DFHEIV0,
 19844           FILE-ID-ERPNDB2,
 19845           ERPNDB-ALT-KEY,
 19846           DFHEIV99,
 19847           DFHEIV11,
 19848           DFHEIV99
 19849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19850
 19851
 19852
 19853* EXEC CICS READNEXT
 19854*         DATASET    (FILE-ID-ERPNDB2)
 19855*         SET        (ADDRESS OF PENDING-BUSINESS)
 19856*         RIDFLD     (ERPNDB-ALT-KEY)
 19857*    END-EXEC.
 19858     MOVE 0
 19859       TO DFHEIV11
 19860*    MOVE '&.S                   )   #00016877' TO DFHEIV0
 19861     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19862     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19863     MOVE X'2020233030303136383737' TO DFHEIV0(25:11)
 19864     CALL 'kxdfhei1' USING DFHEIV0,
 19865           FILE-ID-ERPNDB2,
 19866           DFHEIV20,
 19867           DFHEIV99,
 19868           ERPNDB-ALT-KEY,
 19869           DFHEIV99,
 19870           DFHEIV11,
 19871           DFHEIV99,
 19872           DFHEIV99
 19873     SET ADDRESS OF PENDING-BUSINESS TO
 19874         DFHEIV20
 19875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19876
 19877
 19878
 19879* EXEC CICS READPREV
 19880*         DATASET    (FILE-ID-ERPNDB2)
 19881*         SET        (ADDRESS OF PENDING-BUSINESS)
 19882*         RIDFLD     (ERPNDB-ALT-KEY)
 19883*    END-EXEC.
 19884     MOVE 0
 19885       TO DFHEIV11
 19886*    MOVE '&0S                   )   #00016883' TO DFHEIV0
 19887     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19888     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 365
* VP6311.cbl
 19889     MOVE X'2020233030303136383833' TO DFHEIV0(25:11)
 19890     CALL 'kxdfhei1' USING DFHEIV0,
 19891           FILE-ID-ERPNDB2,
 19892           DFHEIV20,
 19893           DFHEIV99,
 19894           ERPNDB-ALT-KEY,
 19895           DFHEIV99,
 19896           DFHEIV11,
 19897           DFHEIV99,
 19898           DFHEIV99
 19899     SET ADDRESS OF PENDING-BUSINESS TO
 19900         DFHEIV20
 19901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19902
 19903
 19904 4580-READ-PREV-RECORD.
 19905
 19906* EXEC CICS READPREV
 19907*         DATASET    (FILE-ID-ERPNDB2)
 19908*         SET        (ADDRESS OF PENDING-BUSINESS)
 19909*         RIDFLD     (ERPNDB-ALT-KEY)
 19910*    END-EXEC.
 19911     MOVE 0
 19912       TO DFHEIV11
 19913*    MOVE '&0S                   )   #00016890' TO DFHEIV0
 19914     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19915     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19916     MOVE X'2020233030303136383930' TO DFHEIV0(25:11)
 19917     CALL 'kxdfhei1' USING DFHEIV0,
 19918           FILE-ID-ERPNDB2,
 19919           DFHEIV20,
 19920           DFHEIV99,
 19921           ERPNDB-ALT-KEY,
 19922           DFHEIV99,
 19923           DFHEIV11,
 19924           DFHEIV99,
 19925           DFHEIV99
 19926     SET ADDRESS OF PENDING-BUSINESS TO
 19927         DFHEIV20
 19928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19929
 19930
 19931     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19932
 19933     IF WS-BATCH-PREFIX = '#CL'
 19934        GO TO 4580-READ-PREV-RECORD.
 19935
 19936     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19937     GO TO 4505-READ-PREV-RECORD.
 19938
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 366
* VP6311.cbl
 19940
 19941******************************************************************
 19942*                                                                *
 19943*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19944*                                                                *
 19945******************************************************************
 19946
 19947 4600-BROWSE-PRIMARY-BACKWARD.
 19948        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19949
 19950     IF ERPNDB-BATCH-SEQ-NO = +9999
 19951        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19952
 19953        IF ERPNDB-BATCH-SEQ-NO = +0000
 19954           GO TO 4650-END-BATCH
 19955        ELSE
 19956           IF PI-MAP-NAME NOT = VP631D
 19957              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19958                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19959              ELSE
 19960                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19961                 IF DISPLAY-CHANGE-RECORDS
 19962                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19963                 ELSE
 19964                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19965
 19966
 19967* EXEC CICS HANDLE CONDITION
 19968*         NOTFND    (4680-NOT-FOUND)
 19969*         ENDFILE   (4680-NOT-FOUND)
 19970*    END-EXEC.
 19971*    MOVE '"$I''                  ! O #00016931' TO DFHEIV0
 19972     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19973     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19974     MOVE X'4F20233030303136393331' TO DFHEIV0(25:11)
 19975     CALL 'kxdfhei1' USING DFHEIV0
 19976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19977
 19978
 19979 4605-READ-NEXT.
 19980     IF ERPNDB-BATCH-SEQ-NO = +0000
 19981        GO TO 4650-END-BATCH.
 19982
 19983     IF PI-DISPLAY-ORIGINAL-BATCH
 19984        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19985     ELSE
 19986        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19987
 19988
 19989* EXEC CICS READ
 19990*         DATASET   (FILE-ID)
 19991*         SET       (ADDRESS OF PENDING-BUSINESS)
 19992*         RIDFLD    (ERPNDB-KEY)
 19993*    END-EXEC.
 19994*    MOVE '&"S        E          (   #00016945' TO DFHEIV0
 19995     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19996     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19997     MOVE X'2020233030303136393435' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 367
* VP6311.cbl
 19998     CALL 'kxdfhei1' USING DFHEIV0,
 19999           FILE-ID,
 20000           DFHEIV20,
 20001           DFHEIV99,
 20002           ERPNDB-KEY,
 20003           DFHEIV99,
 20004           DFHEIV99,
 20005           DFHEIV99
 20006     SET ADDRESS OF PENDING-BUSINESS TO
 20007         DFHEIV20
 20008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20009
 20010
 20011     IF NOT  PI-PRIMARY-WITH-SELECT
 20012        GO TO 4607-CHECK-REC-TYPE.
 20013
 20014     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20015
 20016     IF  WS-BATCH-PREFIX = '#CL'
 20017         GO TO 4610-BUMP-SEQ.
 20018
 20019     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20020        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20021           GO TO 4610-BUMP-SEQ
 20022        ELSE
 20023           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20024              GO TO 4607-CHECK-REC-TYPE
 20025           ELSE
 20026              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20027                 GO TO 4607-CHECK-REC-TYPE
 20028              ELSE
 20029                 GO TO 4610-BUMP-SEQ.
 20030
 20031     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20032        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20033           GO TO 4610-BUMP-SEQ.
 20034
 20035 4607-CHECK-REC-TYPE.
 20036     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20037         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20038             NEXT SENTENCE
 20039         ELSE
 20040             GO TO 4610-BUMP-SEQ.
 20041
 20042     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20043         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20044             NEXT SENTENCE
 20045        ELSE
 20046             GO TO 4610-BUMP-SEQ.
 20047
 20048     IF NOT DISPLAY-CHANGE-RECORDS AND
 20049            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20050        GO TO 4610-BUMP-SEQ.
 20051
 20052     IF DISPLAY-HOLD-RECORDS AND
 20053        NOT PB-RECORD-ON-HOLD
 20054          GO TO 4610-BUMP-SEQ.
 20055
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 368
* VP6311.cbl
 20056     IF PB-ISSUE
 20057        IF DISPLAY-CHK-REQ-RECORDS
 20058           GO TO 4610-BUMP-SEQ.
 20059
 20060     IF PB-ISSUE
 20061        IF ISSUE-WITH-WARNING
 20062           IF PB-WARNING-ERRORS
 20063              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20064                  GO TO 4610-BUMP-SEQ
 20065              ELSE
 20066                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20067                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20068                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20069                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20070                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20071                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20072                 GO TO 7000-DISPLAY-ISSUES
 20073           ELSE
 20074              GO TO 4610-BUMP-SEQ.
 20075
 20076     IF PB-ISSUE
 20077        IF (ISSUES-IN-ERROR AND
 20078            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20079            ALL-ISSUES
 20080            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20081            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20082            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20083            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20084            MOVE PB-SV-STATE            TO PI-SV-STATE
 20085            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20086            GO TO 7000-DISPLAY-ISSUES
 20087        ELSE
 20088            GO TO 4610-BUMP-SEQ.
 20089
 20090     IF PB-CANCELLATION
 20091        IF DISPLAY-CHK-REQ-RECORDS
 20092           IF PB-C-REFUND-REQUESTED
 20093              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20094              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20095              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20096              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20097              MOVE PB-SV-STATE            TO PI-SV-STATE
 20098              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20099              GO TO 7100-DISPLAY-CANCELS
 20100           ELSE
 20101              GO TO 4610-BUMP-SEQ.
 20102
 20103     IF PB-CANCELLATION
 20104        IF CANCEL-WITH-WARNING
 20105           IF PB-WARNING-ERRORS
 20106              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20107                  GO TO 4610-BUMP-SEQ
 20108              ELSE
 20109                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20110                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20111                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20112                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20113                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 369
* VP6311.cbl
 20114                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20115                 GO TO 7100-DISPLAY-CANCELS
 20116           ELSE
 20117              GO TO 4610-BUMP-SEQ.
 20118
 20119     IF PB-CANCELLATION
 20120        IF (CANCEL-IN-ERROR  AND
 20121            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20122            ALL-CANCELS
 20123            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20124            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20125            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20126            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20127            MOVE PB-SV-STATE            TO PI-SV-STATE
 20128            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20129            GO TO 7100-DISPLAY-CANCELS.
 20130
 20131 4610-BUMP-SEQ.
 20132     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20133        GO TO 4650-END-BATCH.
 20134
 20135     IF DISPLAY-CHANGE-RECORDS
 20136        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20137           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20138        ELSE
 20139           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20140           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20141        ELSE
 20142           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20143           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20144
 20145        GO TO 4605-READ-NEXT.
 20146
 20147 4650-END-BATCH.
 20148     IF PI-MAP-NAME = VP631B
 20149        MOVE -1                  TO BMAINTL
 20150     ELSE
 20151        IF PI-MAP-NAME = VP631C
 20152           MOVE -1               TO CMAINTL
 20153        ELSE
 20154           MOVE -1               TO DPFENTRL.
 20155
 20156     MOVE ER-2252               TO EMI-ERROR.
 20157     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20158     GO TO 8200-SEND-DATAONLY.
 20159
 20160 4680-NOT-FOUND.
 20161     IF DISPLAY-CHANGE-RECORDS
 20162        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20163           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20164        ELSE
 20165           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20166           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20167     ELSE
 20168        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20169
 20170     GO TO 4605-READ-NEXT.
 20171
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 370
* VP6311.cbl
 20173
 20174******************************************************************
 20175*                                                                *
 20176*        B R O W S E   F I L E   B A C K W A R D S               *
 20177*                                                                *
 20178******************************************************************
 20179
 20180 4800-BROWSE-FILE-BACKWARD.
 20181
 20182* EXEC CICS HANDLE CONDITION
 20183*         NOTFND   (4860-NOT-FOUND)
 20184*         ENDFILE  (4850-END-RECORDS)
 20185*    END-EXEC.
 20186*    MOVE '"$I''                  ! P #00017121' TO DFHEIV0
 20187     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20188     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20189     MOVE X'5020233030303137313231' TO DFHEIV0(25:11)
 20190     CALL 'kxdfhei1' USING DFHEIV0
 20191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20192
 20193
 20194     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20195
 20196     IF PI-DISPLAY-ORIGINAL-BATCH
 20197        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20198     ELSE
 20199        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20200
 20201
 20202* EXEC CICS STARTBR
 20203*         DATASET   (FILE-ID)
 20204*         RIDFLD    (ERPNDB-KEY)
 20205*    END-EXEC.
 20206     MOVE 0
 20207       TO DFHEIV11
 20208*    MOVE '&,         G          &   #00017133' TO DFHEIV0
 20209     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20210     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20211     MOVE X'2020233030303137313333' TO DFHEIV0(25:11)
 20212     CALL 'kxdfhei1' USING DFHEIV0,
 20213           FILE-ID,
 20214           ERPNDB-KEY,
 20215           DFHEIV99,
 20216           DFHEIV11,
 20217           DFHEIV99
 20218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20219
 20220
 20221     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20222
 20223
 20224* EXEC CICS READPREV
 20225*         DATASET    (FILE-ID-ERPNDB)
 20226*         SET        (ADDRESS OF PENDING-BUSINESS)
 20227*         RIDFLD     (ERPNDB-KEY)
 20228*    END-EXEC.
 20229     MOVE 0
 20230       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 371
* VP6311.cbl
 20231*    MOVE '&0S                   )   #00017140' TO DFHEIV0
 20232     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20233     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20234     MOVE X'2020233030303137313430' TO DFHEIV0(25:11)
 20235     CALL 'kxdfhei1' USING DFHEIV0,
 20236           FILE-ID-ERPNDB,
 20237           DFHEIV20,
 20238           DFHEIV99,
 20239           ERPNDB-KEY,
 20240           DFHEIV99,
 20241           DFHEIV11,
 20242           DFHEIV99,
 20243           DFHEIV99
 20244     SET ADDRESS OF PENDING-BUSINESS TO
 20245         DFHEIV20
 20246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20247
 20248
 20249 4810-READ-PREV-RECORD.
 20250
 20251* EXEC CICS READPREV
 20252*         DATASET    (FILE-ID-ERPNDB)
 20253*         SET        (ADDRESS OF PENDING-BUSINESS)
 20254*         RIDFLD     (ERPNDB-KEY)
 20255*    END-EXEC.
 20256     MOVE 0
 20257       TO DFHEIV11
 20258*    MOVE '&0S                   )   #00017147' TO DFHEIV0
 20259     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20260     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20261     MOVE X'2020233030303137313437' TO DFHEIV0(25:11)
 20262     CALL 'kxdfhei1' USING DFHEIV0,
 20263           FILE-ID-ERPNDB,
 20264           DFHEIV20,
 20265           DFHEIV99,
 20266           ERPNDB-KEY,
 20267           DFHEIV99,
 20268           DFHEIV11,
 20269           DFHEIV99,
 20270           DFHEIV99
 20271     SET ADDRESS OF PENDING-BUSINESS TO
 20272         DFHEIV20
 20273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20274
 20275
 20276     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20277        GO TO 4850-END-RECORDS.
 20278
 20279     IF PB-BATCH-TRAILER
 20280        GO TO 4810-READ-PREV-RECORD.
 20281
 20282     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20283
 20284     IF  WS-BATCH-PREFIX = '#CL'
 20285         GO TO 4810-READ-PREV-RECORD.
 20286
 20287     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20288        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 372
* VP6311.cbl
 20289           GO TO 4810-READ-PREV-RECORD
 20290        ELSE
 20291           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20292              GO TO 4820-CHECK-REC-TYPE
 20293           ELSE
 20294              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20295                 GO TO 4820-CHECK-REC-TYPE
 20296              ELSE
 20297                 GO TO 4810-READ-PREV-RECORD.
 20298
 20299     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20300        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20301           GO TO 4810-READ-PREV-RECORD.
 20302
 20303 4820-CHECK-REC-TYPE.
 20304     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20305         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20306             NEXT SENTENCE
 20307         ELSE
 20308             GO TO 4810-READ-PREV-RECORD.
 20309
 20310     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20311         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20312             NEXT SENTENCE
 20313        ELSE
 20314             GO TO 4810-READ-PREV-RECORD.
 20315
 20316     IF NOT DISPLAY-CHANGE-RECORDS AND
 20317            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20318        GO TO 4810-READ-PREV-RECORD.
 20319
 20320     IF DISPLAY-HOLD-RECORDS AND
 20321        NOT PB-RECORD-ON-HOLD
 20322          GO TO 4810-READ-PREV-RECORD.
 20323
 20324     IF PB-ISSUE
 20325        IF DISPLAY-CHK-REQ-RECORDS
 20326           GO TO 4810-READ-PREV-RECORD.
 20327
 20328     IF PB-ISSUE
 20329        IF ISSUE-WITH-WARNING
 20330           IF PB-WARNING-ERRORS
 20331              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20332                  GO TO 4810-READ-PREV-RECORD
 20333              ELSE
 20334                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20335                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20336                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20337                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20338                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20339                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20340                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20341                 GO TO 7000-DISPLAY-ISSUES
 20342           ELSE
 20343              GO TO 4810-READ-PREV-RECORD.
 20344
 20345     IF PB-ISSUE
 20346        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 373
* VP6311.cbl
 20347            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20348            ALL-ISSUES
 20349            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20350            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20351            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20352            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20353            MOVE PB-SV-STATE            TO PI-SV-STATE
 20354            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20355            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20356            GO TO 7000-DISPLAY-ISSUES
 20357        ELSE
 20358            GO TO 4810-READ-PREV-RECORD.
 20359
 20360     IF PB-CANCELLATION
 20361        IF DISPLAY-CHK-REQ-RECORDS
 20362           IF PB-C-REFUND-REQUESTED
 20363              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20364              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20365              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20366              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20367              MOVE PB-SV-STATE            TO PI-SV-STATE
 20368              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20369              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20370              GO TO 7100-DISPLAY-CANCELS
 20371           ELSE
 20372              GO TO 4810-READ-PREV-RECORD.
 20373
 20374     IF PB-CANCELLATION
 20375        IF CANCEL-WITH-WARNING
 20376           IF PB-WARNING-ERRORS
 20377              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20378                  GO TO 4810-READ-PREV-RECORD
 20379              ELSE
 20380                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20381                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20382                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20383                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20384                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20385                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20386                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20387                 GO TO 7100-DISPLAY-CANCELS
 20388           ELSE
 20389              GO TO 4810-READ-PREV-RECORD.
 20390
 20391     IF PB-CANCELLATION
 20392        IF (CANCEL-IN-ERROR  AND
 20393            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20394            ALL-CANCELS
 20395            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20396            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20397            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20398            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20399            MOVE PB-SV-STATE            TO PI-SV-STATE
 20400            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20401            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20402            GO TO 7100-DISPLAY-CANCELS.
 20403
 20404     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 374
* VP6311.cbl
 20405
 20406 4850-END-RECORDS.
 20407     MOVE ER-2252                TO EMI-ERROR.
 20408     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20409
 20410     IF PI-MAP-NAME = VP631B
 20411        MOVE -1                  TO BPFENTRL
 20412     ELSE
 20413        MOVE -1                  TO CPFENTRL.
 20414
 20415     GO TO 8200-SEND-DATAONLY.
 20416
 20417 4860-NOT-FOUND.
 20418
 20419******************************************************************
 20420*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20421******************************************************************
 20422
 20423
 20424* EXEC CICS RESETBR
 20425*         DATASET    (FILE-ID-ERPNDB)
 20426*         RIDFLD     (ERPNDB-KEY)
 20427*     END-EXEC.
 20428     MOVE 0
 20429       TO DFHEIV11
 20430*    MOVE '&4         G          &   #00017300' TO DFHEIV0
 20431     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20432     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20433     MOVE X'2020233030303137333030' TO DFHEIV0(25:11)
 20434     CALL 'kxdfhei1' USING DFHEIV0,
 20435           FILE-ID-ERPNDB,
 20436           ERPNDB-KEY,
 20437           DFHEIV99,
 20438           DFHEIV11,
 20439           DFHEIV99
 20440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20441
 20442
 20443
 20444* EXEC CICS READNEXT
 20445*         DATASET    (FILE-ID-ERPNDB)
 20446*         SET        (ADDRESS OF PENDING-BUSINESS)
 20447*         RIDFLD     (ERPNDB-KEY)
 20448*    END-EXEC.
 20449     MOVE 0
 20450       TO DFHEIV11
 20451*    MOVE '&.S                   )   #00017305' TO DFHEIV0
 20452     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20453     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20454     MOVE X'2020233030303137333035' TO DFHEIV0(25:11)
 20455     CALL 'kxdfhei1' USING DFHEIV0,
 20456           FILE-ID-ERPNDB,
 20457           DFHEIV20,
 20458           DFHEIV99,
 20459           ERPNDB-KEY,
 20460           DFHEIV99,
 20461           DFHEIV11,
 20462           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 375
* VP6311.cbl
 20463           DFHEIV99
 20464     SET ADDRESS OF PENDING-BUSINESS TO
 20465         DFHEIV20
 20466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20467
 20468
 20469
 20470* EXEC CICS READPREV
 20471*         DATASET    (FILE-ID-ERPNDB)
 20472*         SET        (ADDRESS OF PENDING-BUSINESS)
 20473*         RIDFLD     (ERPNDB-KEY)
 20474*    END-EXEC.
 20475     MOVE 0
 20476       TO DFHEIV11
 20477*    MOVE '&0S                   )   #00017311' TO DFHEIV0
 20478     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20479     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20480     MOVE X'2020233030303137333131' TO DFHEIV0(25:11)
 20481     CALL 'kxdfhei1' USING DFHEIV0,
 20482           FILE-ID-ERPNDB,
 20483           DFHEIV20,
 20484           DFHEIV99,
 20485           ERPNDB-KEY,
 20486           DFHEIV99,
 20487           DFHEIV11,
 20488           DFHEIV99,
 20489           DFHEIV99
 20490     SET ADDRESS OF PENDING-BUSINESS TO
 20491         DFHEIV20
 20492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20493
 20494
 20495     GO TO 4810-READ-PREV-RECORD.
 20496
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 376
* VP6311.cbl
 20498
 20499******************************************************************
 20500*                                                                *
 20501*           B R O W S E   C S R   B A C K W A R D                *
 20502*                                                                *
 20503******************************************************************
 20504
 20505 4900-BROWSE-CSR-BACKWARD.
 20506
 20507     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20508
 20509
 20510* EXEC CICS HANDLE CONDITION
 20511*         NOTFND   (4970-NOT-FOUND)
 20512*         ENDFILE  (4950-END-RECORDS)
 20513*    END-EXEC
 20514*    MOVE '"$I''                  ! Q #00017331' TO DFHEIV0
 20515     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20516     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20517     MOVE X'5120233030303137333331' TO DFHEIV0(25:11)
 20518     CALL 'kxdfhei1' USING DFHEIV0
 20519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20520
 20521
 20522* EXEC CICS STARTBR
 20523*         DATASET   (FILE-ID-ERPNDB4)
 20524*         RIDFLD    (ERPNDB-CSR-KEY)
 20525*    END-EXEC.
 20526     MOVE 0
 20527       TO DFHEIV11
 20528*    MOVE '&,         G          &   #00017336' TO DFHEIV0
 20529     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20530     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20531     MOVE X'2020233030303137333336' TO DFHEIV0(25:11)
 20532     CALL 'kxdfhei1' USING DFHEIV0,
 20533           FILE-ID-ERPNDB4,
 20534           ERPNDB-CSR-KEY,
 20535           DFHEIV99,
 20536           DFHEIV11,
 20537           DFHEIV99
 20538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20539
 20540
 20541     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20542                                    WS-FIRST-TIME-SW.
 20543
 20544 4905-READ-PREV-RECORD.
 20545
 20546* EXEC CICS READPREV
 20547*         DATASET    (FILE-ID-ERPNDB4)
 20548*         SET        (ADDRESS OF PENDING-BUSINESS)
 20549*         RIDFLD     (ERPNDB-CSR-KEY)
 20550*    END-EXEC.
 20551     MOVE 0
 20552       TO DFHEIV11
 20553*    MOVE '&0S                   )   #00017345' TO DFHEIV0
 20554     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20555     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 377
* VP6311.cbl
 20556     MOVE X'2020233030303137333435' TO DFHEIV0(25:11)
 20557     CALL 'kxdfhei1' USING DFHEIV0,
 20558           FILE-ID-ERPNDB4,
 20559           DFHEIV20,
 20560           DFHEIV99,
 20561           ERPNDB-CSR-KEY,
 20562           DFHEIV99,
 20563           DFHEIV11,
 20564           DFHEIV99,
 20565           DFHEIV99
 20566     SET ADDRESS OF PENDING-BUSINESS TO
 20567         DFHEIV20
 20568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20569
 20570
 20571     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20572
 20573     IF WS-BATCH-PREFIX = '#CL'
 20574         GO TO 4905-READ-PREV-RECORD.
 20575
 20576     IF FIRST-TIME
 20577         MOVE SPACE               TO WS-FIRST-TIME-SW
 20578         GO TO 4905-READ-PREV-RECORD.
 20579
 20580     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20581        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20582        GO TO 4950-END-RECORDS.
 20583
 20584     IF PB-BATCH-TRAILER
 20585        GO TO 4905-READ-PREV-RECORD.
 20586
 20587     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20588
 20589     IF  WS-BATCH-PREFIX = '#CL'
 20590         GO TO 4905-READ-PREV-RECORD.
 20591
 20592     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20593        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20594           GO TO 4905-READ-PREV-RECORD
 20595        ELSE
 20596           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20597              GO TO 4910-CHECK-REC-TYPE
 20598           ELSE
 20599              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20600                 GO TO 4910-CHECK-REC-TYPE
 20601              ELSE
 20602                 GO TO 4905-READ-PREV-RECORD.
 20603
 20604     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20605        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20606           GO TO 4905-READ-PREV-RECORD.
 20607
 20608 4910-CHECK-REC-TYPE.
 20609     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20610         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20611             NEXT SENTENCE
 20612         ELSE
 20613             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 378
* VP6311.cbl
 20614
 20615     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20616         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20617             NEXT SENTENCE
 20618        ELSE
 20619             GO TO 4905-READ-PREV-RECORD.
 20620
 20621     IF NOT DISPLAY-CHANGE-RECORDS AND
 20622            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20623        GO TO 4905-READ-PREV-RECORD.
 20624
 20625     IF DISPLAY-HOLD-RECORDS AND
 20626        NOT PB-RECORD-ON-HOLD
 20627          GO TO 4905-READ-PREV-RECORD.
 20628
 20629     IF PB-ISSUE
 20630        IF DISPLAY-CHK-REQ-RECORDS
 20631           GO TO 4905-READ-PREV-RECORD.
 20632
 20633     IF PB-ISSUE
 20634        IF ISSUE-WITH-WARNING
 20635           IF PB-WARNING-ERRORS
 20636              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20637                  GO TO 4505-READ-PREV-RECORD
 20638              ELSE
 20639                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20640                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20641                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20642                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20643                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20644                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20645                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20646                 GO TO 7000-DISPLAY-ISSUES
 20647           ELSE
 20648              GO TO 4905-READ-PREV-RECORD.
 20649
 20650     IF PB-ISSUE
 20651        IF (ISSUES-IN-ERROR AND
 20652            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20653            ALL-ISSUES
 20654            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20655            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20656            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20657            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20658            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20659            MOVE PB-SV-STATE            TO PI-SV-STATE
 20660            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20661            GO TO 7000-DISPLAY-ISSUES
 20662        ELSE
 20663            GO TO 4905-READ-PREV-RECORD.
 20664
 20665     IF PB-CANCELLATION
 20666        IF DISPLAY-CHK-REQ-RECORDS
 20667           IF PB-C-REFUND-REQUESTED
 20668              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20669              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20670              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20671              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 379
* VP6311.cbl
 20672              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20673              MOVE PB-SV-STATE            TO PI-SV-STATE
 20674              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20675              GO TO 7100-DISPLAY-CANCELS
 20676           ELSE
 20677              GO TO 4905-READ-PREV-RECORD.
 20678
 20679     IF PB-CANCELLATION
 20680        IF CANCEL-WITH-WARNING
 20681           IF PB-WARNING-ERRORS
 20682              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20683                  GO TO 4505-READ-PREV-RECORD
 20684              ELSE
 20685                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20686                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20687                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20688                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20689                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20690                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20691                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20692                 GO TO 7100-DISPLAY-CANCELS
 20693           ELSE
 20694              GO TO 4905-READ-PREV-RECORD.
 20695
 20696     IF PB-CANCELLATION
 20697        IF (CANCEL-IN-ERROR  AND
 20698            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20699            ALL-CANCELS
 20700            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20701            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20702            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20703            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20704            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20705            MOVE PB-SV-STATE            TO PI-SV-STATE
 20706            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20707            GO TO 7100-DISPLAY-CANCELS.
 20708
 20709     GO TO 4905-READ-PREV-RECORD.
 20710
 20711 4950-END-RECORDS.
 20712     IF PI-MAP-NAME = VP631B
 20713        MOVE -1                  TO BMAINTL
 20714     ELSE
 20715        IF PI-MAP-NAME = VP631C
 20716           MOVE -1               TO CMAINTL
 20717        ELSE
 20718           MOVE -1               TO DPFENTRL.
 20719
 20720     MOVE ER-2255               TO EMI-ERROR.
 20721     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20722     GO TO 8200-SEND-DATAONLY.
 20723
 20724 4970-NOT-FOUND.
 20725
 20726******************************************************************
 20727*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20728******************************************************************
 20729
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 380
* VP6311.cbl
 20730
 20731* EXEC CICS RESETBR
 20732*         DATASET    (FILE-ID-ERPNDB4)
 20733*         RIDFLD     (ERPNDB-CSR-KEY)
 20734*    END-EXEC.
 20735     MOVE 0
 20736       TO DFHEIV11
 20737*    MOVE '&4         G          &   #00017510' TO DFHEIV0
 20738     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20739     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20740     MOVE X'2020233030303137353130' TO DFHEIV0(25:11)
 20741     CALL 'kxdfhei1' USING DFHEIV0,
 20742           FILE-ID-ERPNDB4,
 20743           ERPNDB-CSR-KEY,
 20744           DFHEIV99,
 20745           DFHEIV11,
 20746           DFHEIV99
 20747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20748
 20749
 20750
 20751* EXEC CICS READNEXT
 20752*         DATASET    (FILE-ID-ERPNDB4)
 20753*         SET        (ADDRESS OF PENDING-BUSINESS)
 20754*         RIDFLD     (ERPNDB-CSR-KEY)
 20755*    END-EXEC.
 20756     MOVE 0
 20757       TO DFHEIV11
 20758*    MOVE '&.S                   )   #00017515' TO DFHEIV0
 20759     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20760     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20761     MOVE X'2020233030303137353135' TO DFHEIV0(25:11)
 20762     CALL 'kxdfhei1' USING DFHEIV0,
 20763           FILE-ID-ERPNDB4,
 20764           DFHEIV20,
 20765           DFHEIV99,
 20766           ERPNDB-CSR-KEY,
 20767           DFHEIV99,
 20768           DFHEIV11,
 20769           DFHEIV99,
 20770           DFHEIV99
 20771     SET ADDRESS OF PENDING-BUSINESS TO
 20772         DFHEIV20
 20773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20774
 20775
 20776
 20777* EXEC CICS READPREV
 20778*         DATASET    (FILE-ID-ERPNDB4)
 20779*         SET        (ADDRESS OF PENDING-BUSINESS)
 20780*         RIDFLD     (ERPNDB-CSR-KEY)
 20781*    END-EXEC.
 20782     MOVE 0
 20783       TO DFHEIV11
 20784*    MOVE '&0S                   )   #00017521' TO DFHEIV0
 20785     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20786     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20787     MOVE X'2020233030303137353231' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 381
* VP6311.cbl
 20788     CALL 'kxdfhei1' USING DFHEIV0,
 20789           FILE-ID-ERPNDB4,
 20790           DFHEIV20,
 20791           DFHEIV99,
 20792           ERPNDB-CSR-KEY,
 20793           DFHEIV99,
 20794           DFHEIV11,
 20795           DFHEIV99,
 20796           DFHEIV99
 20797     SET ADDRESS OF PENDING-BUSINESS TO
 20798         DFHEIV20
 20799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20800
 20801
 20802 4980-READ-PREV-RECORD.
 20803
 20804* EXEC CICS READPREV
 20805*         DATASET    (FILE-ID-ERPNDB4)
 20806*         SET        (ADDRESS OF PENDING-BUSINESS)
 20807*         RIDFLD     (ERPNDB-CSR-KEY)
 20808*    END-EXEC.
 20809     MOVE 0
 20810       TO DFHEIV11
 20811*    MOVE '&0S                   )   #00017528' TO DFHEIV0
 20812     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20813     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20814     MOVE X'2020233030303137353238' TO DFHEIV0(25:11)
 20815     CALL 'kxdfhei1' USING DFHEIV0,
 20816           FILE-ID-ERPNDB4,
 20817           DFHEIV20,
 20818           DFHEIV99,
 20819           ERPNDB-CSR-KEY,
 20820           DFHEIV99,
 20821           DFHEIV11,
 20822           DFHEIV99,
 20823           DFHEIV99
 20824     SET ADDRESS OF PENDING-BUSINESS TO
 20825         DFHEIV20
 20826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20827
 20828
 20829     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20830
 20831     IF WS-BATCH-PREFIX = '#CL'
 20832        GO TO 4980-READ-PREV-RECORD.
 20833
 20834     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20835     GO TO 4905-READ-PREV-RECORD.
 20836
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 382
* VP6311.cbl
 20838
 20839
 20840******************************************************************
 20841*                                                                *
 20842*        B R O W S E   B A T C H   H E A D E R S                 *
 20843*                                                                *
 20844******************************************************************
 20845
 20846 5000-BROWSE-BATCH-HEADERS.
 20847
 20848     IF EIBTRNID NOT = TRANS-EXB1
 20849        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20850        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20851        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20852        GO TO 5010-READ-NEXT-RECORD.
 20853
 20854     IF EIBAID = DFHPF4
 20855        MOVE '0'                TO PI-EDIT-SW
 20856        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20857        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20858        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20859        GO TO 5010-READ-NEXT-RECORD.
 20860
 20861     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20862     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20863     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20864
 20865
 20866* EXEC CICS HANDLE CONDITION
 20867*         ENDFILE  (5050-NOT-FOUND)
 20868*    END-EXEC.
 20869*    MOVE '"$''                   ! R #00017570' TO DFHEIV0
 20870     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20872     MOVE X'5220233030303137353730' TO DFHEIV0(25:11)
 20873     CALL 'kxdfhei1' USING DFHEIV0
 20874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20875
 20876
 20877 5010-READ-NEXT-RECORD.
 20878
 20879* EXEC CICS HANDLE CONDITION
 20880*         NOTFND    (5050-NOT-FOUND)
 20881*    END-EXEC.
 20882*    MOVE '"$I                   ! S #00017575' TO DFHEIV0
 20883     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20884     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20885     MOVE X'5320233030303137353735' TO DFHEIV0(25:11)
 20886     CALL 'kxdfhei1' USING DFHEIV0
 20887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20888
 20889
 20890
 20891* EXEC CICS READ
 20892*         DATASET   (FILE-ID-ERPNDB)
 20893*         SET       (ADDRESS OF PENDING-BUSINESS)
 20894*         RIDFLD    (ERPNDB-KEY)
 20895*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 383
* VP6311.cbl
 20896*    END-EXEC.
 20897*    MOVE '&"S        G          (   #00017579' TO DFHEIV0
 20898     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20899     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20900     MOVE X'2020233030303137353739' TO DFHEIV0(25:11)
 20901     CALL 'kxdfhei1' USING DFHEIV0,
 20902           FILE-ID-ERPNDB,
 20903           DFHEIV20,
 20904           DFHEIV99,
 20905           ERPNDB-KEY,
 20906           DFHEIV99,
 20907           DFHEIV99,
 20908           DFHEIV99
 20909     SET ADDRESS OF PENDING-BUSINESS TO
 20910         DFHEIV20
 20911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20912
 20913
 20914     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20915         GO TO 5050-NOT-FOUND.
 20916
 20917     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20918
 20919     IF WS-BATCH-PREFIX = '#CL'
 20920         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20921         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20922         GO TO 5010-READ-NEXT-RECORD.
 20923
 20924     IF NOT PB-BATCH-TRAILER
 20925         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20926         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20927         GO TO 5010-READ-NEXT-RECORD.
 20928
 20929     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20930         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20931             NEXT SENTENCE
 20932         ELSE
 20933             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20934             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20935             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20936             GO TO 5010-READ-NEXT-RECORD.
 20937
 20938     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20939         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20940             NEXT SENTENCE
 20941        ELSE
 20942             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20943             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20944             GO TO 5010-READ-NEXT-RECORD.
 20945
 20946     IF EIBAID = DFHPF4
 20947        MOVE '0'                TO PI-EDIT-SW
 20948        GO TO 7200-DISPLAY-BATCHES.
 20949
 20950     IF PI-CSR-BROWSE
 20951        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20952           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20953           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 384
* VP6311.cbl
 20954           GO TO 5010-READ-NEXT-RECORD.
 20955
 20956     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20957       IF PI-PB-CARRIER    = SPACES AND
 20958          PI-PB-GROUPING   = SPACES AND
 20959          PI-PB-STATE      = SPACES AND
 20960          PI-PB-ACCOUNT    = SPACES
 20961            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20962            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20963            GO TO 7200-DISPLAY-BATCHES
 20964         ELSE
 20965           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20966              PI-PB-GROUPING   = PB-GROUPING AND
 20967              PI-PB-STATE      = PB-STATE    AND
 20968              PI-PB-ACCOUNT    = PB-ACCOUNT
 20969              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20970              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20971              GO TO 7200-DISPLAY-BATCHES.
 20972
 20973     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20974     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20975
 20976
 20977* EXEC CICS HANDLE CONDITION
 20978*         NOTFND    (5050-NOT-FOUND)
 20979*    END-EXEC.
 20980*    MOVE '"$I                   ! T #00017648' TO DFHEIV0
 20981     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20982     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20983     MOVE X'5420233030303137363438' TO DFHEIV0(25:11)
 20984     CALL 'kxdfhei1' USING DFHEIV0
 20985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20986
 20987
 20988
 20989* EXEC CICS READ
 20990*         DATASET   (FILE-ID-ERPNDB)
 20991*         SET       (ADDRESS OF PENDING-BUSINESS)
 20992*         RIDFLD    (ERPNDB-KEY)
 20993*         GTEQ
 20994*    END-EXEC.
 20995*    MOVE '&"S        G          (   #00017652' TO DFHEIV0
 20996     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20997     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20998     MOVE X'2020233030303137363532' TO DFHEIV0(25:11)
 20999     CALL 'kxdfhei1' USING DFHEIV0,
 21000           FILE-ID-ERPNDB,
 21001           DFHEIV20,
 21002           DFHEIV99,
 21003           ERPNDB-KEY,
 21004           DFHEIV99,
 21005           DFHEIV99,
 21006           DFHEIV99
 21007     SET ADDRESS OF PENDING-BUSINESS TO
 21008         DFHEIV20
 21009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21010
 21011
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 385
* VP6311.cbl
 21012     GO TO 5010-READ-NEXT-RECORD.
 21013
 21014 5050-NOT-FOUND.
 21015
 21016******************************************************************
 21017*                                                                *
 21018*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21019*         THE INITIAL ENTRY OF VP6311, RETURN TO THE CALLING     *
 21020*         PROGRAM.                                               *
 21021*                                                                *
 21022******************************************************************
 21023
 21024     IF EIBTRNID NOT = TRANS-EXB1
 21025        IF PENDING-BUS-RECS-FOUND
 21026            NEXT SENTENCE
 21027          ELSE
 21028            MOVE '9'            TO PI-BROWSE-SW
 21029            GO TO 9400-CLEAR.
 21030
 21031     MOVE ER-2256                TO EMI-ERROR.
 21032     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21033
 21034     IF PI-MAP-NAME = SPACES
 21035        MOVE VP631D              TO PI-MAP-NAME
 21036        MOVE -1                  TO DPFENTRL
 21037        GO TO 8100-SEND-INITIAL-MAP.
 21038
 21039     IF PI-MAP-NAME = VP631B
 21040        MOVE -1                  TO BMAINTL
 21041     ELSE
 21042        IF PI-MAP-NAME = VP631C
 21043           MOVE -1               TO CMAINTL
 21044        ELSE
 21045           MOVE -1               TO DPFENTRL
 21046           GO TO 8200-SEND-DATAONLY.
 21047
 21048     GO TO 8100-SEND-INITIAL-MAP.
 21049
 21050     .
 21051 5100-PROCESS-POL-RESC.
 21052     MOVE ZEROS                  TO CG-LF-BENCD
 21053                                    CG-AH-BENCD
 21054                                    CG-LF-CAN-AMT
 21055                                    CG-AH-CAN-AMT
 21056     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21057                                    CG-AH-CAN-DT
 21058     MOVE SPACES                 TO CG-BATCH-NO
 21059     MOVE '4'                    TO CG-OPTION-CODE
 21060     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21061     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21062     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21063     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21064     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21065     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21066     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21067     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21068     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21069     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 386
* VP6311.cbl
 21070     MOVE PI-PREV-ALT-KEY (1:33)
 21071                                 TO CG-CERT-KEY
 21072     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21073     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21074                                    CG-AH-CAN-AMT
 21075     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21076                                    CG-AH-CAN-DT
 21077     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21078     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21079      display 'about to cancel ' cg-cert-key
 21080
 21081* EXEC CICS LINK
 21082*        PROGRAM  ('ELCANC')
 21083*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21084*    END-EXEC
 21085     MOVE LENGTH OF
 21086      CANCEL-GEN-PASS-AREA
 21087       TO DFHEIV11
 21088     MOVE 'ELCANC' TO DFHEIV1
 21089*    MOVE '."C                   (   #00017727' TO DFHEIV0
 21090     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21091     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21092     MOVE X'2020233030303137373237' TO DFHEIV0(25:11)
 21093     CALL 'kxdfhei1' USING DFHEIV0,
 21094           DFHEIV1,
 21095           CANCEL-GEN-PASS-AREA,
 21096           DFHEIV11,
 21097           DFHEIV99,
 21098           DFHEIV99,
 21099           DFHEIV99,
 21100           DFHEIV99
 21101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21102     IF CG-SUCCESS
 21103        CONTINUE
 21104     ELSE
 21105        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21106        MOVE '3'                 TO EMI-SWITCH1
 21107        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21108        EVALUATE TRUE
 21109           WHEN CG-DATE-ERROR
 21110             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21111           WHEN CG-CERT-NOT-FOUND
 21112             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21113           WHEN CG-AMOUNT-ERROR
 21114             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21115           WHEN CG-OPTION-ERROR
 21116             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21117           WHEN CG-PREV-CAN
 21118             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21119           WHEN CG-INVALID-DATA
 21120             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21121           WHEN CG-NO-ACCT-MSTR
 21122             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21123           WHEN CG-SFX-A-EXIST
 21124             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21125           WHEN CG-MISC-ERROR
 21126             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21127           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 387
* VP6311.cbl
 21128             MOVE ' ERROR - ELCANC - RETURN '
 21129                                 TO EMI-ERROR-TEXT (1) (12:25)
 21130        END-EVALUATE
 21131        GO TO 8200-SEND-DATAONLY
 21132     END-IF
 21133     .
 21134 5100-EXIT.
 21135     EXIT.
 21136
 21137******************************************************************
 21138*                                                                *
 21139*        B R O W S E   B A T C H   B A C K W A R D S             *
 21140*                                                                *
 21141******************************************************************
 21142
 21143 5500-BROWSE-BATCH-BACKWARD.
 21144
 21145* EXEC CICS HANDLE CONDITION
 21146*         NOTFND   (5550-END-RECORDS)
 21147*         ENDFILE  (5550-END-RECORDS)
 21148*    END-EXEC.
 21149*    MOVE '"$I''                  ! U #00017773' TO DFHEIV0
 21150     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21151     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21152     MOVE X'5520233030303137373733' TO DFHEIV0(25:11)
 21153     CALL 'kxdfhei1' USING DFHEIV0
 21154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21155
 21156
 21157 5505-START-BROWSE.
 21158     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21159     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21160     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21161
 21162
 21163* EXEC CICS STARTBR
 21164*         DATASET   (FILE-ID-ERPNDB)
 21165*         RIDFLD    (ERPNDB-ALT-KEY)
 21166*    END-EXEC.
 21167     MOVE 0
 21168       TO DFHEIV11
 21169*    MOVE '&,         G          &   #00017783' TO DFHEIV0
 21170     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21171     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21172     MOVE X'2020233030303137373833' TO DFHEIV0(25:11)
 21173     CALL 'kxdfhei1' USING DFHEIV0,
 21174           FILE-ID-ERPNDB,
 21175           ERPNDB-ALT-KEY,
 21176           DFHEIV99,
 21177           DFHEIV11,
 21178           DFHEIV99
 21179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21180
 21181
 21182     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21183
 21184
 21185* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 388
* VP6311.cbl
 21186*         DATASET    (FILE-ID-ERPNDB)
 21187*         SET        (ADDRESS OF PENDING-BUSINESS)
 21188*         RIDFLD     (ERPNDB-KEY)
 21189*    END-EXEC.
 21190     MOVE 0
 21191       TO DFHEIV11
 21192*    MOVE '&.S                   )   #00017790' TO DFHEIV0
 21193     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21194     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21195     MOVE X'2020233030303137373930' TO DFHEIV0(25:11)
 21196     CALL 'kxdfhei1' USING DFHEIV0,
 21197           FILE-ID-ERPNDB,
 21198           DFHEIV20,
 21199           DFHEIV99,
 21200           ERPNDB-KEY,
 21201           DFHEIV99,
 21202           DFHEIV11,
 21203           DFHEIV99,
 21204           DFHEIV99
 21205     SET ADDRESS OF PENDING-BUSINESS TO
 21206         DFHEIV20
 21207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21208
 21209
 21210
 21211* EXEC CICS READPREV
 21212*         DATASET    (FILE-ID-ERPNDB)
 21213*         SET        (ADDRESS OF PENDING-BUSINESS)
 21214*         RIDFLD     (ERPNDB-KEY)
 21215*    END-EXEC.
 21216     MOVE 0
 21217       TO DFHEIV11
 21218*    MOVE '&0S                   )   #00017796' TO DFHEIV0
 21219     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21220     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21221     MOVE X'2020233030303137373936' TO DFHEIV0(25:11)
 21222     CALL 'kxdfhei1' USING DFHEIV0,
 21223           FILE-ID-ERPNDB,
 21224           DFHEIV20,
 21225           DFHEIV99,
 21226           ERPNDB-KEY,
 21227           DFHEIV99,
 21228           DFHEIV11,
 21229           DFHEIV99,
 21230           DFHEIV99
 21231     SET ADDRESS OF PENDING-BUSINESS TO
 21232         DFHEIV20
 21233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21234
 21235
 21236
 21237* EXEC CICS READPREV
 21238*         DATASET    (FILE-ID-ERPNDB)
 21239*         SET        (ADDRESS OF PENDING-BUSINESS)
 21240*         RIDFLD     (ERPNDB-KEY)
 21241*    END-EXEC.
 21242     MOVE 0
 21243       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 389
* VP6311.cbl
 21244*    MOVE '&0S                   )   #00017802' TO DFHEIV0
 21245     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21246     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21247     MOVE X'2020233030303137383032' TO DFHEIV0(25:11)
 21248     CALL 'kxdfhei1' USING DFHEIV0,
 21249           FILE-ID-ERPNDB,
 21250           DFHEIV20,
 21251           DFHEIV99,
 21252           ERPNDB-KEY,
 21253           DFHEIV99,
 21254           DFHEIV11,
 21255           DFHEIV99,
 21256           DFHEIV99
 21257     SET ADDRESS OF PENDING-BUSINESS TO
 21258         DFHEIV20
 21259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21260
 21261
 21262     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21263        GO TO 5550-END-RECORDS.
 21264
 21265     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21266
 21267     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21268
 21269     IF  WS-BATCH-PREFIX = '#CL'
 21270             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21271
 21272* EXEC CICS ENDBR
 21273*                 DATASET  (FILE-ID-ERPNDB)
 21274*            END-EXEC
 21275     MOVE 0
 21276       TO DFHEIV11
 21277*    MOVE '&2                    $   #00017817' TO DFHEIV0
 21278     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21279     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21280     MOVE X'2020233030303137383137' TO DFHEIV0(25:11)
 21281     CALL 'kxdfhei1' USING DFHEIV0,
 21282           FILE-ID-ERPNDB,
 21283           DFHEIV11,
 21284           DFHEIV99
 21285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21286         GO TO 5505-START-BROWSE.
 21287
 21288     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21289         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21290             NEXT SENTENCE
 21291         ELSE
 21292             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21293
 21294* EXEC CICS ENDBR
 21295*                 DATASET  (FILE-ID-ERPNDB)
 21296*            END-EXEC
 21297     MOVE 0
 21298       TO DFHEIV11
 21299*    MOVE '&2                    $   #00017827' TO DFHEIV0
 21300     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21301     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 390
* VP6311.cbl
 21302     MOVE X'2020233030303137383237' TO DFHEIV0(25:11)
 21303     CALL 'kxdfhei1' USING DFHEIV0,
 21304           FILE-ID-ERPNDB,
 21305           DFHEIV11,
 21306           DFHEIV99
 21307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21308             GO TO 5505-START-BROWSE.
 21309
 21310
 21311     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21312         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21313             NEXT SENTENCE
 21314        ELSE
 21315             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21316
 21317* EXEC CICS ENDBR
 21318*                 DATASET  (FILE-ID-ERPNDB)
 21319*            END-EXEC
 21320     MOVE 0
 21321       TO DFHEIV11
 21322*    MOVE '&2                    $   #00017838' TO DFHEIV0
 21323     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21324     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21325     MOVE X'2020233030303137383338' TO DFHEIV0(25:11)
 21326     CALL 'kxdfhei1' USING DFHEIV0,
 21327           FILE-ID-ERPNDB,
 21328           DFHEIV11,
 21329           DFHEIV99
 21330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21331             GO TO 5505-START-BROWSE.
 21332
 21333     IF NOT PB-BATCH-TRAILER
 21334        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21335
 21336* EXEC CICS ENDBR
 21337*            DATASET  (FILE-ID-ERPNDB)
 21338*       END-EXEC
 21339     MOVE 0
 21340       TO DFHEIV11
 21341*    MOVE '&2                    $   #00017845' TO DFHEIV0
 21342     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21343     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21344     MOVE X'2020233030303137383435' TO DFHEIV0(25:11)
 21345     CALL 'kxdfhei1' USING DFHEIV0,
 21346           FILE-ID-ERPNDB,
 21347           DFHEIV11,
 21348           DFHEIV99
 21349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21350        GO TO 5505-START-BROWSE.
 21351
 21352     IF PI-CSR-BROWSE
 21353        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21354           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21355
 21356* EXEC CICS ENDBR
 21357*               DATASET  (FILE-ID-ERPNDB)
 21358*          END-EXEC
 21359     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 391
* VP6311.cbl
 21360       TO DFHEIV11
 21361*    MOVE '&2                    $   #00017853' TO DFHEIV0
 21362     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21363     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21364     MOVE X'2020233030303137383533' TO DFHEIV0(25:11)
 21365     CALL 'kxdfhei1' USING DFHEIV0,
 21366           FILE-ID-ERPNDB,
 21367           DFHEIV11,
 21368           DFHEIV99
 21369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21370           GO TO 5505-START-BROWSE.
 21371
 21372     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21373        IF PI-PB-CARRIER    = SPACES AND
 21374           PI-PB-GROUPING   = SPACES AND
 21375           PI-PB-STATE      = SPACES AND
 21376           PI-PB-ACCOUNT    = SPACES
 21377             GO TO 7200-DISPLAY-BATCHES
 21378          ELSE
 21379            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21380               PI-PB-GROUPING   = PB-GROUPING AND
 21381               PI-PB-STATE      = PB-STATE    AND
 21382               PI-PB-ACCOUNT    = PB-ACCOUNT
 21383                 GO TO 7200-DISPLAY-BATCHES.
 21384
 21385     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21386
 21387
 21388* EXEC CICS ENDBR
 21389*         DATASET  (FILE-ID-ERPNDB)
 21390*    END-EXEC.
 21391     MOVE 0
 21392       TO DFHEIV11
 21393*    MOVE '&2                    $   #00017873' TO DFHEIV0
 21394     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21395     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21396     MOVE X'2020233030303137383733' TO DFHEIV0(25:11)
 21397     CALL 'kxdfhei1' USING DFHEIV0,
 21398           FILE-ID-ERPNDB,
 21399           DFHEIV11,
 21400           DFHEIV99
 21401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21402
 21403
 21404     GO TO 5505-START-BROWSE.
 21405
 21406 5550-END-RECORDS.
 21407     MOVE ER-2257                TO EMI-ERROR.
 21408     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21409     MOVE -1                     TO DPFENTRL.
 21410
 21411     GO TO 8200-SEND-DATAONLY.
 21412
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 392
* VP6311.cbl
 21414
 21415******************************************************************
 21416*                                                                *
 21417*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21418*                                                                *
 21419******************************************************************
 21420
 21421 6000-CREATE-TEMP-STORAGE.
 21422
 21423
 21424* EXEC CICS HANDLE CONDITION
 21425*        QIDERR  (6050-QID-ERROR)
 21426*    END-EXEC.
 21427*    MOVE '"$N                   ! V #00017896' TO DFHEIV0
 21428     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21430     MOVE X'5620233030303137383936' TO DFHEIV0(25:11)
 21431     CALL 'kxdfhei1' USING DFHEIV0
 21432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21433
 21434
 21435
 21436* EXEC CICS WRITEQ TS
 21437*        QUEUE    (QID)
 21438*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21439*        LENGTH   (WS-COMM-LENGTH)
 21440*        ITEM     (W-ONE)
 21441*    END-EXEC.
 21442*    MOVE '*" I   L              ''   #00017900' TO DFHEIV0
 21443     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 21444     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21445     MOVE X'2020233030303137393030' TO DFHEIV0(25:11)
 21446     CALL 'kxdfhei1' USING DFHEIV0,
 21447           QID,
 21448           PROGRAM-INTERFACE-BLOCK,
 21449           WS-COMM-LENGTH,
 21450           W-ONE,
 21451           DFHEIV99,
 21452           DFHEIV99
 21453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21454
 21455
 21456 6000-EXIT.
 21457      EXIT.
 21458
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 393
* VP6311.cbl
 21460
 21461******************************************************************
 21462*                                                                *
 21463*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21464*                                                                *
 21465******************************************************************
 21466
 21467 6050-RECOVER-TEMP-STORAGE.
 21468     IF PGM-NAME = XCTL-EL6312
 21469        GO TO 6050-EXIT.
 21470
 21471     IF PGM-NAME = XCTL-EL6313
 21472        GO TO 6050-EXIT.
 21473
 21474     IF PGM-NAME = XCTL-EL6315
 21475         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21476     END-IF
 21477
 21478     IF PGM-NAME = XCTL-EL6316
 21479         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21480     END-IF
 21481
 21482
 21483* EXEC CICS HANDLE CONDITION
 21484*        QIDERR  (6050-QID-ERROR)
 21485*    END-EXEC.
 21486*    MOVE '"$N                   ! W #00017933' TO DFHEIV0
 21487     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21488     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21489     MOVE X'5720233030303137393333' TO DFHEIV0(25:11)
 21490     CALL 'kxdfhei1' USING DFHEIV0
 21491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21492
 21493
 21494
 21495* EXEC CICS READQ TS
 21496*         QUEUE   (QID)
 21497*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21498*         LENGTH  (WS-COMM-LENGTH)
 21499*         ITEM    (W-ONE)
 21500*     END-EXEC.
 21501*    MOVE '*$II   L              ''   #00017937' TO DFHEIV0
 21502     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21503     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21504     MOVE X'2020233030303137393337' TO DFHEIV0(25:11)
 21505     CALL 'kxdfhei1' USING DFHEIV0,
 21506           QID,
 21507           PROGRAM-INTERFACE-BLOCK,
 21508           WS-COMM-LENGTH,
 21509           W-ONE,
 21510           DFHEIV99,
 21511           DFHEIV99
 21512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21513
 21514
 21515 6050-DELETE-TEMP-STORAGE.
 21516
 21517
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 394
* VP6311.cbl
 21518* EXEC CICS DELETEQ TS
 21519*        QUEUE   (QID)
 21520*    END-EXEC.
 21521*    MOVE '*&                    #   #00017946' TO DFHEIV0
 21522     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21523     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21524     MOVE X'2020233030303137393436' TO DFHEIV0(25:11)
 21525     CALL 'kxdfhei1' USING DFHEIV0,
 21526           QID,
 21527           DFHEIV99
 21528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21529
 21530
 21531     GO TO 6050-EXIT.
 21532
 21533 6050-QID-ERROR.
 21534     MOVE ER-0033                TO EMI-ERROR
 21535     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21536
 21537 6050-EXIT.
 21538      EXIT.
 21539
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 395
* VP6311.cbl
 21541
 21542******************************************************************
 21543*                                                                *
 21544*            T E R M   C O N V E R S I O N                       *
 21545*                                                                *
 21546******************************************************************
 21547
 21548 6100-TERM-CONVERSION.
 21549
 21550     IF PI-BPMTS = ZERO
 21551         GO TO 6199-EXIT.
 21552
 21553
 21554 6105-ROUND-TERM.
 21555
 21556     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21557         ADD +1                  TO WS-CALC-TERM-WHOLE
 21558         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21559
 21560     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21561         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21562
 21563     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21564         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21565                                      WS-BTERM    (WS-SUB1)
 21566         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21567
 21568
 21569 6124-CHECK-BENEFIT.
 21570
 21571     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21572        GO TO 6126-COMPUTE-BENEFIT.
 21573
 21574     GO TO 6199-EXIT.
 21575
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 396
* VP6311.cbl
 21577******************************************************************
 21578**         COMPUTE TERM AND BENEFIT
 21579******************************************************************
 21580 6125-COMPUTE-TERM-BENEFIT.
 21581
 21582     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21583        PI-BPMTAMT = ZERO
 21584         GO TO 6199-EXIT.
 21585
 21586     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21587                                     WS-BTERM  (WS-SUB1).
 21588     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21589
 21590 6126-COMPUTE-BENEFIT.
 21591
 21592
 21593     IF WS-SUB1 = +1
 21594        COMPUTE WS-BBEN (WS-SUB1) =
 21595                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21596
 21597     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21598     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21599     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21600
 21601 6199-EXIT.
 21602     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 397
* VP6311.cbl
 21604
 21605******************************************************************
 21606*                                                                *
 21607*             D I S P L A Y   I S S U E S                        *
 21608*                                                                *
 21609******************************************************************
 21610
 21611 6200-CREATE-VADS.
 21612     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21613     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21614     MOVE SPACES                 TO WS-PASS-VADS-REC
 21615
 21616* EXEC CICS GETMAIN
 21617*       SET      (ADDRESS OF PENDING-BUSINESS)
 21618*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21619*       INITIMG  (GETMAIN-SPACE)
 21620*       RESP     (WS-RESPONSE)
 21621*    END-EXEC
 21622*    MOVE ',"IL                  $  N#00018034' TO DFHEIV0
 21623     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21624     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21625     MOVE X'204E233030303138303334' TO DFHEIV0(25:11)
 21626     CALL 'kxdfhei1' USING DFHEIV0,
 21627           DFHEIV20,
 21628           ERPNDB-RECORD-LENGTH,
 21629           GETMAIN-SPACE
 21630     SET ADDRESS OF PENDING-BUSINESS TO
 21631         DFHEIV20
 21632     MOVE EIBRESP  TO WS-RESPONSE
 21633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21634
 21635* EXEC CICS READ
 21636*       INTO    (PENDING-BUSINESS)
 21637*       DATASET (FILE-ID-ERPNDB)
 21638*       RIDFLD  (ERPNDB-KEY)
 21639*       RESP    (WS-RESPONSE)
 21640*    END-EXEC
 21641     MOVE LENGTH OF
 21642      PENDING-BUSINESS
 21643       TO DFHEIV11
 21644*    MOVE '&"IL       E          (  N#00018040' TO DFHEIV0
 21645     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21646     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21647     MOVE X'204E233030303138303430' TO DFHEIV0(25:11)
 21648     CALL 'kxdfhei1' USING DFHEIV0,
 21649           FILE-ID-ERPNDB,
 21650           PENDING-BUSINESS,
 21651           DFHEIV11,
 21652           ERPNDB-KEY,
 21653           DFHEIV99,
 21654           DFHEIV99,
 21655           DFHEIV99
 21656     MOVE EIBRESP  TO WS-RESPONSE
 21657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21658     IF RESP-NORMAL
 21659        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21660        IF (RESP-NORMAL)
 21661           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 398
* VP6311.cbl
 21662              AM-CONTROL-PRIMARY (1:20))
 21663           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21664        ELSE
 21665           MOVE 'ACCOUNT NOT FOUND'
 21666                                 TO VD-ACCOUNT-NAME
 21667        END-IF
 21668        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21669                                    TO M1
 21670        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21671        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21672           (A2 > M1)
 21673           OR (WS-WORK-FIELD (A2:1) = '*')
 21674           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21675           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21676        END-PERFORM
 21677        IF A2 > M1
 21678           CONTINUE
 21679        ELSE
 21680           MOVE WS-WORK-FIELD (1:A2 - 1)
 21681                                    TO VD-ACCOUNT-NAME
 21682        END-IF
 21683        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21684        MOVE PB-CARRIER          TO VD-CARRIER
 21685        MOVE PB-GROUPING         TO VD-GROUPING
 21686        MOVE PB-STATE            TO VD-STATE
 21687        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21688        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21689        MOVE PB-CERT-NO          TO VD-CERT-NO
 21690        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21691        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21692        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21693        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21694        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21695        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21696        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21697        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21698        MOVE PB-CSR-ID           TO VD-CSR-ID
 21699        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21700        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21701        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21702        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21703        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21704        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21705        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21706        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21707        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21708        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21709        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21710        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21711        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21712     END-IF
 21713     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21714
 21715
 21716* EXEC CICS GETMAIN
 21717*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21718*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21719*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 399
* VP6311.cbl
 21720*       RESP     (WS-RESPONSE)
 21721*    END-EXEC
 21722*    MOVE ',"IL                  $  N#00018103' TO DFHEIV0
 21723     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21724     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21725     MOVE X'204E233030303138313033' TO DFHEIV0(25:11)
 21726     CALL 'kxdfhei1' USING DFHEIV0,
 21727           DFHEIV20,
 21728           ERPNDM-RECORD-LENGTH,
 21729           GETMAIN-SPACE
 21730     SET ADDRESS OF PENDING-MAILING-DATA TO
 21731         DFHEIV20
 21732     MOVE EIBRESP  TO WS-RESPONSE
 21733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21734
 21735
 21736* EXEC CICS READ
 21737*       INTO    (PENDING-MAILING-DATA)
 21738*       DATASET (FILE-ID-ERPNDM)
 21739*       RIDFLD  (ERPNDM-KEY)
 21740*       RESP    (WS-RESPONSE)
 21741*    END-EXEC
 21742     MOVE LENGTH OF
 21743      PENDING-MAILING-DATA
 21744       TO DFHEIV11
 21745*    MOVE '&"IL       E          (  N#00018110' TO DFHEIV0
 21746     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21747     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21748     MOVE X'204E233030303138313130' TO DFHEIV0(25:11)
 21749     CALL 'kxdfhei1' USING DFHEIV0,
 21750           FILE-ID-ERPNDM,
 21751           PENDING-MAILING-DATA,
 21752           DFHEIV11,
 21753           ERPNDM-KEY,
 21754           DFHEIV99,
 21755           DFHEIV99,
 21756           DFHEIV99
 21757     MOVE EIBRESP  TO WS-RESPONSE
 21758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21759
 21760     IF RESP-NORMAL
 21761        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21762        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21763        MOVE PM-CITY              TO VD-INSURED-CITY
 21764        MOVE PM-STATE             TO VD-INSURED-STATE
 21765        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21766     END-IF
 21767
 21768     MOVE 'VAC1'                  TO VD-LETTER-ID
 21769     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21770     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21771     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21772     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21773     MOVE +0                      TO VD-ARCHIVE-NO
 21774     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21775     .
 21776 6200-EXIT.
 21777     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 400
* VP6311.cbl
 21778 6210-READ-ERACCT.
 21779     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21780     MOVE LOW-VALUES             TO ERACCT-FILL
 21781
 21782* EXEC CICS READ
 21783*         DATASET   ('ERACCT')
 21784*         INTO      (ACCOUNT-MASTER)
 21785*         RIDFLD    (ERACCT-KEY)
 21786*         GTEQ
 21787*         RESP      (WS-RESPONSE)
 21788*    END-EXEC
 21789     MOVE LENGTH OF
 21790      ACCOUNT-MASTER
 21791       TO DFHEIV11
 21792     MOVE 'ERACCT' TO DFHEIV1
 21793*    MOVE '&"IL       G          (  N#00018138' TO DFHEIV0
 21794     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21795     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21796     MOVE X'204E233030303138313338' TO DFHEIV0(25:11)
 21797     CALL 'kxdfhei1' USING DFHEIV0,
 21798           DFHEIV1,
 21799           ACCOUNT-MASTER,
 21800           DFHEIV11,
 21801           ERACCT-KEY,
 21802           DFHEIV99,
 21803           DFHEIV99,
 21804           DFHEIV99
 21805     MOVE EIBRESP  TO WS-RESPONSE
 21806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21807     .
 21808 6210-EXIT.
 21809     EXIT.
 21810
 21811 6220-READ-ERMAIL.
 21812
 21813     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21814     MOVE ' '                    TO WS-ERMAIL-SW
 21815
 21816
 21817* EXEC CICS READ
 21818*       DATASET   (FILE-ID-ERMAIL)
 21819*       SET       (ADDRESS OF MAILING-DATA)
 21820*       RIDFLD    (ERMAIL-KEY)
 21821*       RESP      (WS-RESPONSE)
 21822*    END-EXEC
 21823*    MOVE '&"S        E          (  N#00018154' TO DFHEIV0
 21824     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21825     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21826     MOVE X'204E233030303138313534' TO DFHEIV0(25:11)
 21827     CALL 'kxdfhei1' USING DFHEIV0,
 21828           FILE-ID-ERMAIL,
 21829           DFHEIV20,
 21830           DFHEIV99,
 21831           ERMAIL-KEY,
 21832           DFHEIV99,
 21833           DFHEIV99,
 21834           DFHEIV99
 21835     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 401
* VP6311.cbl
 21836         DFHEIV20
 21837     MOVE EIBRESP  TO WS-RESPONSE
 21838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21839
 21840     IF RESP-NORMAL
 21841        SET ERMAIL-FOUND TO TRUE
 21842     END-IF
 21843     .
 21844 6220-EXIT.
 21845     EXIT.
 21846
 21847 6400-CHECK-FOR-RES-REF-CLAIM.
 21848     display 'made it to 6400- for ' pi-cert-no
 21849     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21850
 21851     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21852                                    W-CL-COMP-CD.
 21853     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21854                                    W-CL-CERT-NO.
 21855     MOVE SPACES                 TO MSTR-CERT-SFX.
 21856
 21857
 21858* EXEC CICS HANDLE CONDITION
 21859*        NOTFND  (6400-CONTINUE)
 21860*        ENDFILE (6400-CONTINUE)
 21861*    END-EXEC.
 21862*    MOVE '"$I''                  ! X #00018178' TO DFHEIV0
 21863     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21864     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21865     MOVE X'5820233030303138313738' TO DFHEIV0(25:11)
 21866     CALL 'kxdfhei1' USING DFHEIV0
 21867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21868
 21869
 21870
 21871* EXEC CICS IGNORE CONDITION
 21872*        DUPKEY
 21873*    END-EXEC.
 21874*    MOVE '"*$                   !   #00018183' TO DFHEIV0
 21875     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21876     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21877     MOVE X'2020233030303138313833' TO DFHEIV0(25:11)
 21878     CALL 'kxdfhei1' USING DFHEIV0
 21879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21880
 21881
 21882
 21883* EXEC CICS STARTBR
 21884*        DATASET   (CLMS-ID)
 21885*        RIDFLD    (ELMSTR-KEY)
 21886*        GENERIC   EQUAL
 21887*        KEYLENGTH (ELMSTR-LENGTH)
 21888*    END-EXEC.
 21889     MOVE 0
 21890       TO DFHEIV11
 21891*    MOVE '&,   KG    E          &   #00018187' TO DFHEIV0
 21892     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21893     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 402
* VP6311.cbl
 21894     MOVE X'2020233030303138313837' TO DFHEIV0(25:11)
 21895     CALL 'kxdfhei1' USING DFHEIV0,
 21896           CLMS-ID,
 21897           ELMSTR-KEY,
 21898           ELMSTR-LENGTH,
 21899           DFHEIV11,
 21900           DFHEIV99
 21901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21902
 21903
 21904     display 'browse started'
 21905     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21906
 21907 6400-NEXT-CLAIM.
 21908
 21909
 21910* EXEC CICS READNEXT
 21911*        DATASET   (CLMS-ID)
 21912*        RIDFLD    (ELMSTR-KEY)
 21913*        SET       (ADDRESS OF CLAIM-MASTER)
 21914*    END-EXEC.
 21915     MOVE 0
 21916       TO DFHEIV11
 21917*    MOVE '&.S                   )   #00018199' TO DFHEIV0
 21918     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21919     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21920     MOVE X'2020233030303138313939' TO DFHEIV0(25:11)
 21921     CALL 'kxdfhei1' USING DFHEIV0,
 21922           CLMS-ID,
 21923           DFHEIV20,
 21924           DFHEIV99,
 21925           ELMSTR-KEY,
 21926           DFHEIV99,
 21927           DFHEIV11,
 21928           DFHEIV99,
 21929           DFHEIV99
 21930     SET ADDRESS OF CLAIM-MASTER TO
 21931         DFHEIV20
 21932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21933
 21934
 21935     display 'read claim for ' mstr-cert-no
 21936     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21937        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21938         GO TO 6400-CONTINUE
 21939     END-IF.
 21940
 21941     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21942        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21943        PI-STATE       NOT = CL-CERT-STATE     OR
 21944        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 21945        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 21946         GO TO 6400-NEXT-CLAIM
 21947     END-IF.
 21948
 21949     display 'found claim ' cl-claim-no
 21950        ' with denial type ' cl-denial-type
 21951     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 403
* VP6311.cbl
 21952         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 21953         GO TO 6400-CONTINUE
 21954     END-IF.
 21955
 21956     GO TO 6400-NEXT-CLAIM.
 21957
 21958 6400-CONTINUE.
 21959
 21960     IF WS-BROWSE-STARTED-SW = 'Y'
 21961
 21962* EXEC CICS ENDBR
 21963*            DATASET   (CLMS-ID)
 21964*        END-EXEC
 21965     MOVE 0
 21966       TO DFHEIV11
 21967*    MOVE '&2                    $   #00018231' TO DFHEIV0
 21968     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21969     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21970     MOVE X'2020233030303138323331' TO DFHEIV0(25:11)
 21971     CALL 'kxdfhei1' USING DFHEIV0,
 21972           CLMS-ID,
 21973           DFHEIV11,
 21974           DFHEIV99
 21975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21976         MOVE 'N' TO WS-BROWSE-STARTED-SW
 21977     END-IF.
 21978
 21979 6400-EXIT.
 21980     EXIT.
 21981
 21982 7000-DISPLAY-ISSUES.
 21983
 21984     IF PI-DISPLAY-ORIGINAL-BATCH
 21985        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21986        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21987     ELSE
 21988        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21989
 21990     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21991
 21992     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21993     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21994
 21995     MOVE LOW-VALUES                 TO VP631BI.
 21996     MOVE ZEROS                      TO PI-BPMTAMT
 21997                                        PI-BPMTS.
 21998     MOVE SPACE                      TO PI-BMODE
 21999                                        PI-BTYPE (1)
 22000                                        PI-BTYPE (2).
 22001     MOVE VP631B                     TO PI-MAP-NAME.
 22002     MOVE 'Y'                        TO PI-BROWSE-SW.
 22003     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22004                                        PI-HIGH-SEQ-NO.
 22005
 22006     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22007        MOVE AL-SABOF                TO BCHGTA
 22008        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22009        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 404
* VP6311.cbl
 22010     ELSE
 22011        MOVE AL-SADOF                TO BCHGTA
 22012                                        BCHGA
 22013        MOVE PB-CHG-COUNT            TO BCHGO.
 22014
 22015     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22016     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22017     MOVE WS-HR-MINS                 TO BMANTATO.
 22018
 22019     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22020        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22021        MOVE SPACE                   TO DC-OPTION-CODE
 22022        PERFORM 9700-DATE-LINK
 22023        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22024        MOVE 'INACTIVE'              TO BMOENDTO
 22025     ELSE
 22026        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22027        MOVE SPACE                   TO DC-OPTION-CODE
 22028        PERFORM 9700-DATE-LINK
 22029        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22030        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22031        MOVE SPACE                   TO DC-OPTION-CODE
 22032        PERFORM 9700-DATE-LINK
 22033        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22034
 22035*    MOVE PB-I-REFERENCE             TO BREFO.
 22036
 22037*    IF PI-COMPANY-ID EQUAL 'HER'
 22038*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22039*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22040*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22041*                MOVE WS-MEMBER-NO-1-8
 22042*                                TO  BMICRNOO.
 22043
 22044*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22045*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22046*            MOVE PB-I-MICROFILM-NO
 22047*                                TO  BMICRNOO.
 22048     IF PB-I-VIN NOT = SPACES
 22049        MOVE PB-I-VIN            TO BVINO
 22050     END-IF
 22051
 22052     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22053     MOVE PB-CERT-SFX                TO BSUFIXO.
 22054     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22055     MOVE SPACE                      TO DC-OPTION-CODE.
 22056     PERFORM 9700-DATE-LINK.
 22057     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22058
 22059     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22060     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22061     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22062     MOVE PB-I-INSURED-SEX           TO BSEXO
 22063
 22064     IF PB-I-AGE NOT = ZEROS
 22065         MOVE PB-I-AGE               TO BAGEO.
 22066
 22067     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 405
* VP6311.cbl
 22068                                 TO ELCERT-KEY
 22069     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22070     IF NOT CERT-TRL-REC-NOT-FOUND
 22071         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22072             MOVE 'AGE*'             TO BAGEDEFO
 22073         ELSE
 22074             MOVE 'AGE '             TO BAGEDEFO
 22075         END-IF
 22076         if cs-year numeric
 22077            move cs-year         to byearo
 22078         end-if
 22079         move cs-make            to bmakeo
 22080         move cs-model           to bmodelo
 22081         move cs-future          to bfutureo
 22082         if cs-vehicle-odometer numeric
 22083            move cs-vehicle-odometer
 22084                                 to bometero
 22085         end-if
 22086     ELSE
 22087         MOVE 'AGE '             TO BAGEDEFO
 22088     END-IF
 22089
 22090     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22091         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22092         MOVE SPACE                  TO DC-OPTION-CODE
 22093         PERFORM 9700-DATE-LINK
 22094         IF NO-CONVERSION-ERROR
 22095            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22096
 22097
 22098
 22099
 22100     MOVE PB-FORCE-CODE              TO BFORCEO.
 22101
 22102
 22103
 22104
 22105     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22106     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22107     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22108     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22109     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
 22110     MOVE PB-I-SIG-SW                TO BSIGO.
 22111     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22112     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22113     MOVE PB-RECORD-BILL             TO BBILCDO.
 22114     MOVE PB-FORCE-CODE              TO BFORCEO.
 22115
 22116
 22117
 22118     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22119
 22120
 22121     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22122        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22123
 22124
 22125     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 406
* VP6311.cbl
 22126
 22127     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22128        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22129
 22130     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22131        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22132                                        PI-BTYPE (1).
 22133
 22134     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22135        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22136
 22137     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22138        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22139
 22140     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22141        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22142
 22143     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22144        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22145
 22146     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22147        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22148
 22149     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22150         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22151         MOVE SPACE                  TO DC-OPTION-CODE
 22152         PERFORM 9700-DATE-LINK
 22153         IF NO-CONVERSION-ERROR
 22154            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22155
 22156     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22157        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22158        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22159        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22160        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22161                 GIVING BDIFFO (1)
 22162     ELSE
 22163        MOVE SPACES                  TO BBEN-CD     (1)
 22164                                        BBEN-ABBR   (1).
 22165
 22166     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22167        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22168        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22169                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22170
 22171     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22172       IF PB-RECORD-ON-HOLD
 22173          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22174
 22175     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22176       IF PB-RECORD-RETURNED
 22177          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22178
 22179     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22180        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22181             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22182
 22183     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 407
* VP6311.cbl
 22184
 22185     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22186        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22187
 22188     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22189        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22190                                        PI-BTYPE (2).
 22191
 22192     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22193        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22194
 22195     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22196        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22197
 22198     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22199        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22200
 22201     IF PB-I-TOT-FEES NOT NUMERIC
 22202        MOVE ZEROS               TO PB-I-TOT-FEES
 22203     END-IF
 22204     IF PB-I-TOT-FEES > ZEROS
 22205        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22206
 22207     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22208         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22209         MOVE SPACE                  TO DC-OPTION-CODE
 22210         PERFORM 9700-DATE-LINK
 22211         IF NO-CONVERSION-ERROR
 22212            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22213
 22214     IF PB-I-TOT-FEES > ZEROS
 22215        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22216        SUBTRACT PB-I-TOT-FEES FROM
 22217                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22218
 22219     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22220        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22221        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22222        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22223        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22224                 GIVING BDIFFO (2)
 22225     ELSE
 22226        MOVE SPACES                  TO BBEN-CD     (2)
 22227                                        BBEN-ABBR   (2).
 22228
 22229     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22230       IF PB-RECORD-ON-HOLD
 22231          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22232
 22233     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22234       IF PB-RECORD-RETURNED
 22235          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22236
 22237     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22238        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22239             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22240
 22241     MOVE PB-CSR-ID                  TO BCSRO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 408
* VP6311.cbl
 22242
 22243     IF PI-COMPANY-ID  =  'DMD'
 22244        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22245            NEXT SENTENCE
 22246        ELSE
 22247            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22248               MOVE 'NEW CERT'       TO BNCERTLI
 22249               MOVE EC-NEW-CERT      TO BNCERTO.
 22250
 22251     IF PI-COMPANY-ID  =  'DMD'
 22252        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22253            NEXT SENTENCE
 22254        ELSE
 22255           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22256               MOVE 'NEW STATE'      TO BNSTATLI
 22257               MOVE EC-NEW-STATE     TO BNSTATO.
 22258
 22259 7000-CONTINUE.
 22260     MOVE 'C'                        TO BMAINTI.
 22261     MOVE AL-UANON                   TO BMAINTA.
 22262
 22263     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22264        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22265
 22266     IF PI-6315-FINALIZED = 'Y'   AND
 22267        PB-UNFORCED-ERRORS
 22268          MOVE -1                TO BFORCEL
 22269          MOVE  1                TO SET-CURSOR-SW
 22270     END-IF
 22271
 22272     IF NO-CURSOR-SET
 22273        MOVE -1                      TO BMAINTL.
 22274
 22275     GO TO 8100-SEND-INITIAL-MAP.
 22276
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 409
* VP6311.cbl
 22278
 22279******************************************************************
 22280*                                                                *
 22281*             D I S P L A Y   C A N C E L S                      *
 22282*                                                                *
 22283******************************************************************
 22284
 22285 7100-DISPLAY-CANCELS.
 22286     IF PI-DISPLAY-ORIGINAL-BATCH
 22287        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22288        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22289     ELSE
 22290        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22291
 22292     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22293
 22294     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22295     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22296
 22297     MOVE LOW-VALUES                 TO VP631CI.
 22298     MOVE VP631C                     TO PI-MAP-NAME.
 22299     MOVE 'Y'                        TO PI-BROWSE-SW.
 22300     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22301                                        PI-HIGH-SEQ-NO.
 22302
 22303     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22304        MOVE AL-SABOF                TO CCHGTA
 22305        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22306        MOVE AL-SANON                TO CCHGA
 22307      ELSE
 22308        MOVE AL-SADOF                TO CCHGTA
 22309                                        CCHGA
 22310        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22311
 22312*    MOVE PB-C-REFERENCE             TO CREFO.
 22313
 22314*    IF PB-C-MICROFILM-NO IS NUMERIC
 22315*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22316*          MOVE PB-C-MICROFILM-NO
 22317*                                TO CMICRNOO
 22318*          MOVE AL-UNNON         TO CMICRNOA
 22319*       END-IF
 22320*    END-IF
 22321     IF PB-C-NH-INT-ON-REFS NUMERIC
 22322        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 22323           MOVE PB-C-NH-INT-ON-REFS
 22324                                 TO CNHINTO
 22325           MOVE AL-SANOF         TO CNHINTA
 22326        END-IF
 22327     END-IF
 22328     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22329     MOVE PB-CERT-SFX                TO CSUFIXO.
 22330     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22331     MOVE SPACE                      TO DC-OPTION-CODE.
 22332     PERFORM 9700-DATE-LINK.
 22333     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22334
 22335     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 410
* VP6311.cbl
 22336        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22337        MOVE SPACE                   TO DC-OPTION-CODE
 22338        PERFORM 9700-DATE-LINK
 22339        IF NO-CONVERSION-ERROR
 22340           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22341
 22342     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22343        NEXT SENTENCE
 22344     ELSE
 22345        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22346
 22347     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22348        NEXT SENTENCE
 22349     ELSE
 22350        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22351
 22352     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22353        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22354        MOVE SPACE                   TO DC-OPTION-CODE
 22355        PERFORM 9700-DATE-LINK
 22356        IF NO-CONVERSION-ERROR
 22357           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22358
 22359     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22360         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22361
 22362     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22363         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22364
 22365     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22366        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22367        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22368                 GIVING CDRFND1O.
 22369
 22370     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22371        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22372        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22373                 GIVING CDRFND2O.
 22374
 22375     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22376       IF PB-RECORD-ON-HOLD
 22377          MOVE 'ON HOLD'             TO CBILIT1O.
 22378
 22379     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22380       IF PB-RECORD-RETURNED
 22381          MOVE 'RETURNED'            TO CBILIT1O.
 22382
 22383     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22384        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22385             MOVE 'OVERRIDE'         TO CBILIT1O.
 22386
 22387     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22388       IF PB-RECORD-ON-HOLD
 22389          MOVE 'ON HOLD'             TO CBILIT2O.
 22390
 22391     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22392       IF PB-RECORD-RETURNED
 22393          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 411
* VP6311.cbl
 22394
 22395     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22396        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22397             MOVE 'OVERRIDE'         TO CBILIT2O.
 22398
 22399     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22400     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22401     IF PB-C-POST-CARD-IND = 'Y'
 22402        MOVE 'Y'                     TO CPCYNO
 22403     ELSE
 22404        MOVE 'N'                     TO CPCYNO
 22405     END-IF
 22406     MOVE PB-FORCE-CODE              TO CFORCEO.
 22407     MOVE PB-RECORD-BILL             TO CBILCDO.
 22408     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22409     MOVE SPACES                     TO CINITSO.
 22410     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22411         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22412     ELSE
 22413         MOVE PB-CI-INITIALS         TO CINITSO
 22414     END-IF.
 22415
 22416     IF PB-CI-CANCEL-FEE NUMERIC
 22417        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22418        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22419     ELSE
 22420        MOVE ZEROES                  TO W-CANCEL-FEE.
 22421
 22422     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22423
 22424     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22425        ADD PB-CI-LF-PREMIUM-AMT
 22426             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22427
 22428     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22429        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22430
 22431     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22432     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22433     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22434     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22435
 22436     IF PB-C-LIVES NUMERIC
 22437        MOVE PB-C-LIVES              TO CLIVESO.
 22438
 22439     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22440        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22441
 22442     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22443        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22444        MOVE SPACE                   TO DC-OPTION-CODE
 22445        PERFORM 9700-DATE-LINK
 22446        IF NO-CONVERSION-ERROR
 22447           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22448
 22449     IF  PB-C-REFUND-CREATED
 22450         MOVE 'YES'                  TO CRFNDSWO
 22451     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 412
* VP6311.cbl
 22452         IF PB-C-REFUND-REQUESTED
 22453            MOVE 'REQ'               TO CRFNDSWO
 22454         ELSE
 22455            MOVE 'NO'                TO CRFNDSWO.
 22456
 22457     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22458     MOVE SPACE                      TO DC-OPTION-CODE.
 22459     PERFORM 9700-DATE-LINK.
 22460     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22461     MOVE PB-INPUT-BY                TO CENTBYO.
 22462
 22463     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22464        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22465        MOVE SPACE                   TO DC-OPTION-CODE
 22466        PERFORM 9700-DATE-LINK
 22467        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22468        MOVE 'INACTIVE'              TO CMOENDTO
 22469     ELSE
 22470        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22471        MOVE SPACE                   TO DC-OPTION-CODE
 22472        PERFORM 9700-DATE-LINK
 22473        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22474        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22475        MOVE SPACE                   TO DC-OPTION-CODE
 22476        PERFORM 9700-DATE-LINK
 22477        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22478
 22479     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22480
 22481     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22482     MOVE WS-HR-MINS                 TO CMANTATO.
 22483
 22484     EVALUATE PB-LF-REFUND-TYPE
 22485        WHEN '1'
 22486           MOVE 'RULE78'            TO CLFREFNO
 22487        WHEN '2'
 22488           MOVE 'PRORAT'            TO CLFREFNO
 22489        WHEN '3'
 22490           MOVE 'CALIF'             TO CLFREFNO
 22491        WHEN '4'
 22492           MOVE 'IRREG'             TO CLFREFNO
 22493        WHEN '5'
 22494           MOVE 'NETPAY'            TO CLFREFNO
 22495        WHEN '6'
 22496           MOVE 'ATCP'              TO CLFREFNO
 22497        WHEN '7'
 22498           MOVE 'UTAH'              TO CLFREFNO
 22499        WHEN '8'
 22500           MOVE 'MEAN'              TO CLFREFNO
 22501        WHEN '9'
 22502           MOVE 'SUM '              TO CLFREFNO
 22503        WHEN 'B'
 22504           MOVE 'BALN'              TO CLFREFNO
 22505     END-EVALUATE.
 22506
 22507     EVALUATE TRUE
 22508        WHEN PB-AH-REFUND-TYPE =  '1'
 22509           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 413
* VP6311.cbl
 22510        WHEN PB-AH-REFUND-TYPE =  '2'
 22511           MOVE 'PRORAT'            TO CAHREFNO
 22512        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22513           MOVE 'CALIF'             TO CAHREFNO
 22514        WHEN PB-AH-REFUND-TYPE =  '4'
 22515           MOVE 'IRREG'             TO CAHREFNO
 22516        WHEN PB-AH-REFUND-TYPE =  '5'
 22517           MOVE 'NETPAY'            TO CAHREFNO
 22518        WHEN PB-AH-REFUND-TYPE =  '6'
 22519           MOVE 'ATCP'              TO CAHREFNO
 22520        WHEN PB-AH-REFUND-TYPE =  '7'
 22521           MOVE 'UTAH'              TO CAHREFNO
 22522        WHEN PB-AH-REFUND-TYPE =  '8'
 22523           MOVE 'MEAN'              TO CAHREFNO
 22524        WHEN PB-AH-REFUND-TYPE =  '9'
 22525           MOVE 'SUM '              TO CAHREFNO
 22526        WHEN PB-AH-REFUND-TYPE =  'B'
 22527           MOVE 'BALN'              TO CAHREFNO
 22528     END-EVALUATE.
 22529
 22530     MOVE PB-REIN-CD                 TO CREINCDO.
 22531
 22532     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22533        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22534        MOVE SPACE                   TO DC-OPTION-CODE
 22535        PERFORM 9700-DATE-LINK
 22536        IF NO-CONVERSION-ERROR
 22537           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22538
 22539     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22540        MOVE 999999                  TO WS-EXP-DT-EDIT
 22541        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22542        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22543     ELSE
 22544        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22545           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22546           MOVE SPACE                   TO DC-OPTION-CODE
 22547           PERFORM 9700-DATE-LINK
 22548           IF NO-CONVERSION-ERROR
 22549              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22550
 22551     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22552        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22553           MOVE AL-SANOF                TO CORIGHDA
 22554           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22555           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22556
 22557     MOVE PB-CSR-ID              TO CCSRO.
 22558
 22559     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22560     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22561
 22562     MOVE 'C'                    TO CMAINTI.
 22563     MOVE AL-UANON               TO CMAINTA.
 22564
 22565     IF PI-6316-FINALIZED = 'Y'  AND
 22566        PB-UNFORCED-ERRORS
 22567          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 414
* VP6311.cbl
 22568          MOVE  1                TO SET-CURSOR-SW
 22569     END-IF
 22570
 22571     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22572        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22573
 22574     IF NO-CURSOR-SET
 22575        MOVE -1                  TO CMAINTL.
 22576
 22577     GO TO 8100-SEND-INITIAL-MAP.
 22578
 22579
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 415
* VP6311.cbl
 22581***************************************************************
 22582*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22583*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22584***************************************************************
 22585
 22586 7200-DISPLAY-BATCHES.
 22587     MOVE VP631D                 TO PI-MAP-NAME.
 22588     MOVE LOW-VALUES             TO VP631DI.
 22589
 22590     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22591
 22592
 22593* EXEC CICS HANDLE CONDITION
 22594*         NOTFND   (3690-NOT-FOUND)
 22595*    END-EXEC.
 22596*    MOVE '"$I                   ! Y #00018850' TO DFHEIV0
 22597     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22599     MOVE X'5920233030303138383530' TO DFHEIV0(25:11)
 22600     CALL 'kxdfhei1' USING DFHEIV0
 22601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22602
 22603
 22604     IF PI-DISPLAY-SCREEN
 22605        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22606     ELSE
 22607        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22608
 22609     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22610     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22611
 22612
 22613* EXEC CICS READ
 22614*         DATASET   (FILE-ID-ERPNDB)
 22615*         RIDFLD    (ERPNDB-KEY)
 22616*         SET       (ADDRESS OF PENDING-BUSINESS)
 22617*    END-EXEC.
 22618*    MOVE '&"S        E          (   #00018862' TO DFHEIV0
 22619     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22620     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22621     MOVE X'2020233030303138383632' TO DFHEIV0(25:11)
 22622     CALL 'kxdfhei1' USING DFHEIV0,
 22623           FILE-ID-ERPNDB,
 22624           DFHEIV20,
 22625           DFHEIV99,
 22626           ERPNDB-KEY,
 22627           DFHEIV99,
 22628           DFHEIV99,
 22629           DFHEIV99
 22630     SET ADDRESS OF PENDING-BUSINESS TO
 22631         DFHEIV20
 22632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22633
 22634
 22635     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22636     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22637     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22638     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 416
* VP6311.cbl
 22639     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22640
 22641     MOVE VP631D                 TO PI-MAP-NAME.
 22642     MOVE LOW-VALUES             TO VP631DI.
 22643     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22644
 22645*    IF PI-AR-PROCESSING
 22646*       MOVE PB-REFERENCE        TO DREFO.
 22647
 22648     MOVE PB-CSR-ID              TO DCSRO.
 22649
 22650     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22651        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22652        MOVE SPACE               TO DC-OPTION-CODE
 22653        PERFORM 9700-DATE-LINK
 22654        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22655        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22656        MOVE 'INACTIVE'          TO DLDATEO
 22657     ELSE
 22658        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22659        MOVE SPACE               TO DC-OPTION-CODE
 22660        PERFORM 9700-DATE-LINK
 22661        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22662
 22663     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22664     MOVE SPACE                  TO DC-OPTION-CODE.
 22665     PERFORM 9700-DATE-LINK.
 22666     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22667
 22668     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22669        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22670     ELSE
 22671        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22672        MOVE SPACE               TO DC-OPTION-CODE
 22673        PERFORM 9700-DATE-LINK
 22674        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22675
 22676     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22677     MOVE SPACE                  TO DC-OPTION-CODE.
 22678     PERFORM 9700-DATE-LINK.
 22679     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22680
 22681     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22682     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22683
 22684     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22685        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22686                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22687
 22688     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22689     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22690     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22691
 22692     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22693        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22694                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22695
 22696     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 417
* VP6311.cbl
 22697     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22698     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22699
 22700     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22701        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22702                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22703
 22704     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22705     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22706
 22707     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22708        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22709                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22710
 22711     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22712     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22713     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22714
 22715     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22716        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22717                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22718
 22719     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22720     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22721     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22722
 22723     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22724        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22725                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22726
 22727     MOVE -1                     TO DPFENTRL.
 22728     GO TO 8100-SEND-INITIAL-MAP.
 22729
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 418
* VP6311.cbl
 22731
 22732***************************************************************
 22733*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22734*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22735*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22736*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22737*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22738*     ARE THEN SET ACCORDINGLY.                               *
 22739*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22740*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22741*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22742***************************************************************
 22743
 22744******************************************************************
 22745*                                                                *
 22746*            E R R O R   A N A L Y S I S                         *
 22747*                                                                *
 22748******************************************************************
 22749
 22750******************************************************************
 22751*                                                                *
 22752*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22753*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22754*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22755*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22756*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22757*                                                                *
 22758*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22759*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22760*                                                                *
 22761******************************************************************
 22762
 22763 7300-FORMAT-ERRORS.
 22764     MOVE ' '                    TO PI-ERRORS-SW
 22765     IF PB-COMMON-ERRORS = LOW-VALUES
 22766        IF PB-FATAL-ERRORS
 22767           MOVE ER-2695          TO EMI-ERROR
 22768           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22769           GO TO 7399-EXIT.
 22770
 22771     MOVE +0                     TO WS-SUB4.
 22772
 22773 7310-ERROR-LOOP.
 22774
 22775     ADD +1                      TO WS-SUB4.
 22776
 22777     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22778        GO TO 7350-SET-ERROR-FLAGS.
 22779
 22780     IF PI-COMPANY-ID = 'UCL'
 22781         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22782             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22783             MOVE ' '                   TO DC-OPTION-CODE
 22784             PERFORM 9700-DATE-LINK
 22785             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22786
 22787     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22788     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 419
* VP6311.cbl
 22789     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22790
 22791     GO TO 7310-ERROR-LOOP.
 22792
 22793
 22794 7350-SET-ERROR-FLAGS.
 22795
 22796     IF EMI-FATAL-CTR NOT = ZEROS
 22797        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22798        MOVE 'X'                 TO PB-FATAL-FLAG
 22799                                    PI-ERRORS-SW
 22800        GO TO 7355-SET-ERROR-FLAGS.
 22801
 22802     move ' ' to pi-unforced-sw
 22803     IF EMI-FORCABLE-CTR NOT = ZEROS
 22804        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22805        IF PB-ISSUE
 22806           IF PB-ISSUE-FORCE
 22807              MOVE 'F'           TO PB-FORCE-ER-CD
 22808              MOVE ER-2600       TO EMI-ERROR
 22809              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22810             ELSE
 22811              MOVE 'X'           TO PB-FORCE-ER-CD
 22812*                                   PI-ERRORS-SW
 22813          ELSE
 22814           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22815              MOVE 'F'           TO PB-FORCE-ER-CD
 22816                                    pi-unforced-sw
 22817              MOVE ER-2600       TO EMI-ERROR
 22818              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22819             ELSE
 22820              MOVE 'X'           TO PB-FORCE-ER-CD
 22821                                    pi-unforced-sw.
 22822*                                   PI-ERRORS-SW.
 22823
 22824     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22825     IF PB-ISSUE
 22826         MOVE 'I'                TO ENDT-RECORD-TYPE
 22827     ELSE
 22828         MOVE 'C'                TO ENDT-RECORD-TYPE
 22829     END-IF
 22830     MOVE +0                     TO ENDT-SEQ-NO
 22831
 22832
 22833* EXEC CICS READ
 22834*        DATASET   (FILE-ID-ERENDT)
 22835*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22836*        RIDFLD    (ERENDT-KEY)
 22837*        RESP      (WS-RESPONSE)
 22838*        GTEQ
 22839*    END-EXEC
 22840*    MOVE '&"S        G          (  N#00019065' TO DFHEIV0
 22841     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22842     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22843     MOVE X'204E233030303139303635' TO DFHEIV0(25:11)
 22844     CALL 'kxdfhei1' USING DFHEIV0,
 22845           FILE-ID-ERENDT,
 22846           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 420
* VP6311.cbl
 22847           DFHEIV99,
 22848           ERENDT-KEY,
 22849           DFHEIV99,
 22850           DFHEIV99,
 22851           DFHEIV99
 22852     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22853         DFHEIV20
 22854     MOVE EIBRESP  TO WS-RESPONSE
 22855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22856
 22857     IF RESP-NORMAL
 22858        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22859        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22860            MOVE ER-0280          TO EMI-ERROR
 22861            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22862            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22863            EVALUATE TRUE
 22864              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22865                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22866              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22867                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22868              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22869                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22870            END-EVALUATE
 22871        END-IF
 22872     END-IF
 22873
 22874
 22875
 22876     IF FIRST-ENTRY OR
 22877        EIBAID = DFHPF1 OR DFHPF2
 22878        MOVE '0'                TO PI-EDIT-SW
 22879        GO TO 7399-EXIT.
 22880
 22881 7355-SET-ERROR-FLAGS.
 22882
 22883     IF EMI-WARNING-CTR NOT = ZEROS
 22884        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22885        MOVE 'W'                 TO PB-WARN-ER-CD.
 22886
 22887     IF PB-UNFORCED-ERRORS OR
 22888        PB-FATAL-ERRORS    OR
 22889        PB-RECORD-ON-HOLD  OR
 22890        PB-RECORD-RETURNED OR
 22891        PB-CANCELLATION
 22892          NEXT SENTENCE
 22893        ELSE
 22894          GO TO 7399-EXIT.
 22895
 22896
 22897* EXEC CICS  HANDLE CONDITION
 22898*           NOTFND   (7399-EXIT)
 22899*    END-EXEC.
 22900*    MOVE '"$I                   ! Z #00019112' TO DFHEIV0
 22901     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22902     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22903     MOVE X'5A20233030303139313132' TO DFHEIV0(25:11)
 22904     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 421
* VP6311.cbl
 22905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22906
 22907
 22908     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22909     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 22910     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 22911     MOVE PB-SV-STATE            TO ELCERT-STATE.
 22912
 22913
 22914* EXEC CICS READ
 22915*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 22916*        DATASET (FILE-ID-ELCERT)
 22917*        RIDFLD  (ELCERT-KEY)
 22918*        UPDATE
 22919*    END-EXEC.
 22920*    MOVE '&"S        EU         (   #00019121' TO DFHEIV0
 22921     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22922     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22923     MOVE X'2020233030303139313231' TO DFHEIV0(25:11)
 22924     CALL 'kxdfhei1' USING DFHEIV0,
 22925           FILE-ID-ELCERT,
 22926           DFHEIV20,
 22927           DFHEIV99,
 22928           ELCERT-KEY,
 22929           DFHEIV99,
 22930           DFHEIV99,
 22931           DFHEIV99
 22932     SET ADDRESS OF CERTIFICATE-MASTER TO
 22933         DFHEIV20
 22934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22935
 22936
 22937
 22938     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 22939     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 22940
 22941     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 22942        GO TO 7360-REWRITE-CERT-MASTER.
 22943
 22944     IF PB-ISSUE
 22945        IF PB-RECORD-RETURNED
 22946            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 22947            GO TO 7360-REWRITE-CERT-MASTER
 22948        ELSE
 22949            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 22950            GO TO 7360-REWRITE-CERT-MASTER.
 22951
 22952     IF PB-RECORD-RETURNED
 22953         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 22954         GO TO 7360-REWRITE-CERT-MASTER.
 22955
 22956     IF (PB-C-LF-CANCEL-VOIDED)
 22957        or (pb-c-ah-cancel-voided)
 22958        IF (PB-UNFORCED-ERRORS OR
 22959            PB-FATAL-ERRORS    OR
 22960            PB-RECORD-ON-HOLD)
 22961            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 22962            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 422
* VP6311.cbl
 22963        ELSE
 22964            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 22965            GO TO 7360-REWRITE-CERT-MASTER.
 22966
 22967     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 22968                            OR PB-RECORD-ON-HOLD)
 22969        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 22970     ELSE
 22971        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 22972
 22973 7360-REWRITE-CERT-MASTER.
 22974
 22975     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22976        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22977
 22978* EXEC CICS UNLOCK
 22979*            DATASET    (FILE-ID-ELCERT)
 22980*       END-EXEC
 22981*    MOVE '&*                    #   #00019168' TO DFHEIV0
 22982     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22983     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22984     MOVE X'2020233030303139313638' TO DFHEIV0(25:11)
 22985     CALL 'kxdfhei1' USING DFHEIV0,
 22986           FILE-ID-ELCERT,
 22987           DFHEIV99
 22988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22989        GO TO 7399-EXIT.
 22990
 22991
 22992* EXEC CICS REWRITE
 22993*         DATASET    (FILE-ID-ELCERT)
 22994*         FROM       (CERTIFICATE-MASTER)
 22995*    END-EXEC.
 22996     MOVE LENGTH OF
 22997      CERTIFICATE-MASTER
 22998       TO DFHEIV11
 22999*    MOVE '&& L                  %   #00019173' TO DFHEIV0
 23000     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23001     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23002     MOVE X'2020233030303139313733' TO DFHEIV0(25:11)
 23003     CALL 'kxdfhei1' USING DFHEIV0,
 23004           FILE-ID-ELCERT,
 23005           CERTIFICATE-MASTER,
 23006           DFHEIV11,
 23007           DFHEIV99
 23008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23009
 23010
 23011 7399-EXIT.
 23012      EXIT.
 23013
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 423
* VP6311.cbl
 23015
 23016*************************************************************
 23017*                                                           *
 23018*              S E T   A T T R I B U T E S                  *
 23019*                                                           *
 23020*************************************************************
 23021
 23022 7400-SET-ATTRIBUTES.
 23023
 23024     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23025        GO TO 7499-EXIT.
 23026
 23027**2601**
 23028
 23029     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23030        IF PB-ISSUE
 23031           MOVE AL-UABON         TO BEFFDTA
 23032           GO TO 7499-EXIT
 23033         ELSE
 23034           MOVE AL-UABON         TO CEFFDTA
 23035           GO TO 7499-EXIT.
 23036
 23037**2604**
 23038
 23039     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23040        IF PB-ISSUE
 23041           MOVE AL-UABON         TO BTYPE1A
 23042           MOVE -1               TO BTYPE1L
 23043           MOVE  1               TO SET-CURSOR-SW
 23044           GO TO 7499-EXIT.
 23045
 23046**2605**
 23047
 23048     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23049        IF PB-ISSUE
 23050           MOVE AL-UABON         TO BTYPE2A
 23051           MOVE -1               TO BTYPE2L
 23052           MOVE  1               TO SET-CURSOR-SW
 23053           GO TO 7499-EXIT.
 23054
 23055**2606**
 23056
 23057     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23058        IF PB-ISSUE
 23059           MOVE AL-UABON         TO BSIGA
 23060           MOVE -1               TO BSIGL
 23061           MOVE  1               TO SET-CURSOR-SW
 23062           GO TO 7499-EXIT.
 23063
 23064**2607**
 23065
 23066     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23067        IF PB-ISSUE
 23068           MOVE AL-UABON         TO BSIGA
 23069           MOVE -1               TO BSIGL
 23070           MOVE  1               TO SET-CURSOR-SW
 23071           GO TO 7499-EXIT.
 23072
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 424
* VP6311.cbl
 23073**2615**
 23074
 23075     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23076        IF PB-ISSUE
 23077           MOVE AL-UABOF         TO BREINA
 23078           MOVE -1               TO BREINL
 23079           GO TO 7499-EXIT.
 23080
 23081**2622**
 23082
 23083     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23084        IF PB-ISSUE
 23085           MOVE AL-UABON         TO BEFFDTA
 23086           GO TO 7499-EXIT
 23087        ELSE
 23088           MOVE AL-UABON         TO CEFFDTA
 23089           GO TO 7499-EXIT.
 23090
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 425
* VP6311.cbl
 23092
 23093*************************************************************
 23094*                                                           *
 23095*              I S S U E   E R R O R S                      *
 23096*                                                           *
 23097*************************************************************
 23098
 23099 7420-ISSUE-ERRORS.
 23100
 23101**2626**
 23102
 23103     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23104        MOVE AL-UABON            TO BCERTNOA
 23105        GO TO 7499-EXIT.
 23106
 23107**2627**
 23108
 23109     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23110        MOVE AL-UNBON            TO BAGEA
 23111        MOVE -1                  TO BAGEL
 23112        MOVE  1                  TO SET-CURSOR-SW
 23113        GO TO 7499-EXIT.
 23114
 23115**2628**
 23116
 23117     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23118        MOVE AL-UNBON            TO BAGEA
 23119        MOVE -1                  TO BAGEL
 23120        MOVE  1                  TO SET-CURSOR-SW
 23121        GO TO 7499-EXIT.
 23122
 23123**2629**
 23124
 23125     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23126        MOVE AL-UABON            TO BSEXA
 23127        MOVE -1                  TO BSEXL
 23128        MOVE  1                  TO SET-CURSOR-SW
 23129        GO TO 7499-EXIT.
 23130
 23131**2630**
 23132
 23133     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23134        MOVE -1                  TO BTYPE1L
 23135        MOVE  1                  TO SET-CURSOR-SW
 23136        GO TO 7499-EXIT.
 23137
 23138**2631**
 23139
 23140     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23141        MOVE -1                  TO BTYPE1L
 23142        MOVE  1                  TO SET-CURSOR-SW
 23143        GO TO 7499-EXIT.
 23144
 23145**2632**
 23146
 23147     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23148        MOVE AL-UNBON            TO BBEN1A
 23149        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 426
* VP6311.cbl
 23150        MOVE  1                  TO SET-CURSOR-SW
 23151        GO TO 7499-EXIT.
 23152
 23153**2633**
 23154
 23155     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23156        MOVE AL-UNBON            TO BPREM1A
 23157        MOVE -1                  TO BPREM1L
 23158        MOVE  1                  TO SET-CURSOR-SW
 23159        GO TO 7499-EXIT.
 23160
 23161**2634**
 23162
 23163     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23164        MOVE -1                  TO BTYPE2L
 23165        MOVE  1                  TO SET-CURSOR-SW
 23166        GO TO 7499-EXIT.
 23167
 23168**2635**
 23169
 23170     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23171        MOVE AL-UNBON            TO BBEN2A
 23172        MOVE -1                  TO BBEN2L
 23173        MOVE  1                  TO SET-CURSOR-SW
 23174        GO TO 7499-EXIT.
 23175
 23176**2636**
 23177
 23178     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23179        MOVE AL-UNBON            TO BPREM2A
 23180        MOVE -1                  TO BPREM2L
 23181        MOVE  1                  TO SET-CURSOR-SW
 23182        GO TO 7499-EXIT.
 23183
 23184**2639**
 23185
 23186     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23187        MOVE AL-UNBON            TO BBEN1A
 23188        MOVE -1                  TO BBEN1L
 23189        MOVE  1                  TO SET-CURSOR-SW
 23190        GO TO 7499-EXIT.
 23191
 23192**2640**
 23193
 23194     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23195        MOVE AL-UNBON            TO BBEN2A
 23196        MOVE -1                  TO BBEN2L
 23197        MOVE  1                  TO SET-CURSOR-SW
 23198        GO TO 7499-EXIT.
 23199
 23200**2647**
 23201
 23202     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23203        MOVE AL-UNBON            TO BTERM1A
 23204        MOVE -1                  TO BTERM1L
 23205        MOVE  1                  TO SET-CURSOR-SW
 23206        GO TO 7499-EXIT.
 23207
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 427
* VP6311.cbl
 23208
 23209**2649**
 23210
 23211     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23212        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23213            MOVE AL-UNBON            TO BPREM1A
 23214            MOVE -1                  TO BPREM1L
 23215            MOVE  1                  TO SET-CURSOR-SW
 23216            GO TO 7499-EXIT
 23217     ELSE
 23218        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23219           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23220            MOVE AL-UNBON            TO BPREM2A
 23221            MOVE -1                  TO BPREM2L
 23222            MOVE  1                  TO SET-CURSOR-SW
 23223            GO TO 7499-EXIT.
 23224
 23225**2650**
 23226
 23227     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23228        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23229            MOVE AL-UNBON        TO BPREM1A
 23230            MOVE -1              TO BPREM1L
 23231            MOVE  1              TO SET-CURSOR-SW
 23232            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23233                MOVE AL-UNBON        TO BPREM2A
 23234                MOVE -1              TO BPREM2L
 23235                MOVE  1              TO SET-CURSOR-SW
 23236                GO TO 7499-EXIT
 23237            ELSE
 23238                GO TO 7499-EXIT
 23239        ELSE
 23240            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23241                MOVE AL-UNBON        TO BPREM2A
 23242                MOVE -1              TO BPREM2L
 23243                MOVE  1              TO SET-CURSOR-SW
 23244                GO TO 7499-EXIT
 23245            ELSE
 23246                GO TO 7499-EXIT.
 23247
 23248**2651**
 23249
 23250     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23251        MOVE AL-UABON            TO BSIGA
 23252        MOVE -1                  TO BSIGL
 23253        MOVE  1                  TO SET-CURSOR-SW
 23254        GO TO 7499-EXIT.
 23255
 23256
 23257
 23258
 23259**2658**
 23260
 23261     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23262        MOVE AL-UNBON            TO BTERM2A
 23263        MOVE -1                  TO BTERM2L
 23264        MOVE  1                  TO SET-CURSOR-SW
 23265        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 428
* VP6311.cbl
 23266
 23267**2660**
 23268
 23269     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23270        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23271        MOVE -1                  TO BLSTNML
 23272        MOVE  1                  TO SET-CURSOR-SW
 23273        GO TO 7499-EXIT.
 23274
 23275
 23276**2662**
 23277
 23278     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23279        MOVE AL-UNBON            TO BAGEA
 23280        MOVE -1                  TO BAGEL
 23281        MOVE  1                  TO SET-CURSOR-SW
 23282        GO TO 7499-EXIT.
 23283
 23284**2663**
 23285
 23286     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23287        MOVE AL-UNBON            TO BAGEA
 23288        MOVE -1                  TO BAGEL
 23289        MOVE  1                  TO SET-CURSOR-SW
 23290        GO TO 7499-EXIT.
 23291
 23292**2664**
 23293
 23294     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23295        MOVE AL-UABON            TO BREINA
 23296        MOVE -1                  TO BREINL
 23297        MOVE  1                  TO SET-CURSOR-SW
 23298        GO TO 7499-EXIT.
 23299
 23300**2667**
 23301
 23302     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23303        MOVE AL-UNBON            TO BBEN2A
 23304        MOVE -1                  TO BBEN2L
 23305        MOVE  1                  TO SET-CURSOR-SW
 23306        GO TO 7499-EXIT.
 23307
 23308**2668**
 23309
 23310     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23311        MOVE AL-UABON            TO BEFFDTA
 23312        GO TO 7499-EXIT.
 23313
 23314**2669**
 23315
 23316     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23317       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23318       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23319        MOVE AL-UNBON            TO BAGEA
 23320        MOVE -1                  TO BAGEL
 23321        MOVE  1                  TO SET-CURSOR-SW
 23322        GO TO 7499-EXIT.
 23323
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 429
* VP6311.cbl
 23324**2670**
 23325
 23326     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23327        MOVE AL-UABON            TO BFORCEA
 23328        MOVE -1                  TO BFORCEL
 23329        MOVE  1                  TO SET-CURSOR-SW
 23330        GO TO 7499-EXIT.
 23331
 23332**2671**
 23333
 23334     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23335        MOVE AL-UABON            TO BEFFDTA
 23336        GO TO 7499-EXIT.
 23337
 23338**2672**
 23339
 23340     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23341        MOVE AL-UABON            TO BEFFDTA
 23342        GO TO 7499-EXIT.
 23343
 23344**2673**
 23345
 23346     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23347        MOVE AL-UABON            TO BEFFDTA
 23348        GO TO 7499-EXIT.
 23349
 23350**2674**
 23351
 23352     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23353        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23354        MOVE -1                  TO BTYPE1L
 23355        MOVE  1                  TO SET-CURSOR-SW
 23356        GO TO 7499-EXIT.
 23357
 23358**2677**
 23359
 23360     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23361        MOVE AL-UNBON            TO BTERM1A
 23362        MOVE -1                  TO BTERM1L
 23363        MOVE  1                  TO SET-CURSOR-SW
 23364        GO TO 7499-EXIT.
 23365
 23366**2678**
 23367
 23368     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23369        MOVE AL-UNBON            TO BTERM2A
 23370        MOVE -1                  TO BTERM2L
 23371        MOVE  1                  TO SET-CURSOR-SW
 23372        GO TO 7499-EXIT.
 23373
 23374**2679**
 23375
 23376     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23377        MOVE AL-UABON            TO BTYPE1A
 23378        MOVE -1                  TO BTYPE1L
 23379        MOVE  1                  TO SET-CURSOR-SW
 23380        GO TO 7499-EXIT.
 23381
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 430
* VP6311.cbl
 23382
 23383
 23384**2682**
 23385
 23386     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23387        MOVE AL-UABON            TO BTERM1A
 23388        MOVE -1                  TO BTERM1L
 23389        MOVE  1                  TO SET-CURSOR-SW
 23390        GO TO 7499-EXIT.
 23391
 23392**2683**
 23393
 23394     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23395        MOVE AL-UABON            TO BSKPCDA
 23396        MOVE -1                  TO BSKPCDL
 23397        MOVE  1                  TO SET-CURSOR-SW
 23398        GO TO 7499-EXIT.
 23399
 23400**2684**
 23401
 23402     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23403        MOVE AL-UABON            TO BTYPE2A
 23404        MOVE -1                  TO BTYPE2L
 23405        MOVE  1                  TO SET-CURSOR-SW
 23406        GO TO 7499-EXIT.
 23407
 23408**2686**
 23409
 23410     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23411        MOVE AL-UABON            TO BTYPE2A
 23412        MOVE -1                  TO BTYPE2L
 23413        MOVE  1                  TO SET-CURSOR-SW
 23414        GO TO 7499-EXIT.
 23415
 23416**2689**
 23417
 23418     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23419        MOVE AL-UABON            TO BSIGA
 23420        MOVE -1                  TO BSIGL
 23421        MOVE  1                  TO SET-CURSOR-SW
 23422        GO TO 7499-EXIT.
 23423
 23424**2690**
 23425
 23426     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23427        MOVE AL-UABOF            TO BLNOFCRA
 23428        MOVE -1                  TO BLNOFCRL
 23429        MOVE  1                  TO SET-CURSOR-SW
 23430        GO TO 7499-EXIT.
 23431
 23432**2693**
 23433
 23434     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23435        MOVE AL-UABOF            TO BLNOFCRA
 23436        MOVE AL-UNBON            TO BBEN1A
 23437        MOVE -1                  TO BBEN1L
 23438        MOVE  1                  TO SET-CURSOR-SW
 23439        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 431
* VP6311.cbl
 23440
 23441**2720**
 23442
 23443     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23444        MOVE AL-UNBON            TO BBEN1A
 23445        MOVE -1                  TO BBEN1L
 23446        MOVE  1                  TO SET-CURSOR-SW
 23447        GO TO 7499-EXIT.
 23448
 23449**2709**
 23450
 23451*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23452*       MOVE AL-UNBON            TO BBEN1A
 23453*       MOVE -1                  TO BBEN1L
 23454*       MOVE  1                  TO SET-CURSOR-SW
 23455*       GO TO 7499-EXIT.
 23456
 23457*************************************************************
 23458*                                                           *
 23459*            C A N C E L   E R R O R S                      *
 23460*                                                           *
 23461*************************************************************
 23462
 23463**2726**
 23464
 23465     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23466        MOVE AL-UABON            TO CCERTNOA
 23467        GO TO 7499-EXIT.
 23468
 23469**2728**
 23470
 23471     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23472        MOVE AL-UABON            TO CCERTNOA
 23473        GO TO 7499-EXIT.
 23474
 23475**2729**
 23476
 23477     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23478        MOVE AL-UABON            TO CCERTNOA
 23479        GO TO 7499-EXIT.
 23480
 23481**2730**
 23482
 23483     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23484        MOVE AL-UABON            TO CCERTNOA
 23485        GO TO 7499-EXIT.
 23486
 23487**2731**
 23488
 23489     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23490        MOVE AL-UABON            TO CCANDT1A
 23491        MOVE -1                  TO CCANDT1L
 23492        MOVE  1                  TO SET-CURSOR-SW
 23493        GO TO 7499-EXIT.
 23494
 23495**2732**
 23496
 23497     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 432
* VP6311.cbl
 23498        MOVE AL-UABON            TO CCANDT1A
 23499        MOVE -1                  TO CCANDT1L
 23500        MOVE  1                  TO SET-CURSOR-SW
 23501        GO TO 7499-EXIT.
 23502
 23503**2733**
 23504
 23505     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23506        MOVE AL-UABON            TO CCANDT1A
 23507        MOVE -1                  TO CCANDT1L
 23508        MOVE  1                  TO SET-CURSOR-SW
 23509        GO TO 7499-EXIT.
 23510
 23511**2734**
 23512
 23513     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23514        MOVE AL-UNBON            TO CREFND1A
 23515        MOVE -1                  TO CREFND1L
 23516        MOVE  1                  TO SET-CURSOR-SW
 23517        GO TO 7499-EXIT.
 23518
 23519**2735**
 23520
 23521     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23522        MOVE AL-UABON            TO CCANDT2A
 23523        MOVE -1                  TO CCANDT2L
 23524        MOVE  1                  TO SET-CURSOR-SW
 23525        GO TO 7499-EXIT.
 23526
 23527**2736**
 23528
 23529     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23530        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23531            MOVE AL-UNBON        TO CREFND1A
 23532            MOVE -1              TO CREFND1L
 23533            MOVE  1              TO SET-CURSOR-SW
 23534            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23535                MOVE AL-UNBON        TO CREFND2A
 23536                MOVE -1              TO CREFND2L
 23537                MOVE  1              TO SET-CURSOR-SW
 23538                GO TO 7499-EXIT
 23539            ELSE
 23540                GO TO 7499-EXIT
 23541        ELSE
 23542            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23543                MOVE AL-UNBON        TO CREFND2A
 23544                MOVE -1              TO CREFND2L
 23545                MOVE  1              TO SET-CURSOR-SW
 23546                GO TO 7499-EXIT
 23547            ELSE
 23548                GO TO 7499-EXIT.
 23549
 23550**2738**
 23551
 23552     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23553        MOVE -1                  TO CREFND2L
 23554        MOVE  1                  TO SET-CURSOR-SW
 23555        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 433
* VP6311.cbl
 23556
 23557**2739**
 23558
 23559     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23560        MOVE -1                  TO CREFND1L
 23561        MOVE  1                  TO SET-CURSOR-SW
 23562        GO TO 7499-EXIT.
 23563
 23564**2741**
 23565
 23566     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23567        MOVE -1                  TO CREFND1L
 23568        MOVE  1                  TO SET-CURSOR-SW
 23569        GO TO 7499-EXIT.
 23570
 23571**2743**
 23572
 23573     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23574        MOVE AL-UNBON            TO CCANDT1A
 23575        MOVE -1                  TO CCANDT1L
 23576        MOVE  1                  TO SET-CURSOR-SW
 23577        GO TO 7499-EXIT.
 23578
 23579**2744**
 23580
 23581     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23582        MOVE AL-UNBON            TO CCANDT2A
 23583        MOVE -1                  TO CCANDT2L
 23584        MOVE  1                  TO SET-CURSOR-SW
 23585        GO TO 7499-EXIT.
 23586
 23587**2747**
 23588
 23589     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23590        MOVE AL-UABON            TO CLSTNMA
 23591        MOVE -1                  TO CLSTNML
 23592        MOVE  1                  TO SET-CURSOR-SW
 23593        GO TO 7499-EXIT.
 23594
 23595**2749**
 23596
 23597     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23598        MOVE AL-UABON            TO CFORCEA
 23599        MOVE -1                  TO CFORCEL
 23600        MOVE  1                  TO SET-CURSOR-SW
 23601        GO TO 7499-EXIT.
 23602
 23603**2753**
 23604
 23605     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23606        MOVE AL-UNBON            TO CCANDT1A
 23607        MOVE -1                  TO CCANDT1L
 23608        MOVE  1                  TO SET-CURSOR-SW
 23609        GO TO 7499-EXIT.
 23610
 23611**2755**
 23612
 23613     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 434
* VP6311.cbl
 23614        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23615            MOVE AL-UNBON        TO CREFND1A
 23616            MOVE -1              TO CREFND1L
 23617            MOVE  1              TO SET-CURSOR-SW
 23618            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23619                MOVE AL-UNBON        TO CREFND2A
 23620                MOVE -1              TO CREFND2L
 23621                MOVE  1              TO SET-CURSOR-SW
 23622                GO TO 7499-EXIT
 23623            ELSE
 23624                GO TO 7499-EXIT
 23625        ELSE
 23626            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23627                MOVE AL-UNBON        TO CREFND2A
 23628                MOVE -1              TO CREFND2L
 23629                MOVE  1              TO SET-CURSOR-SW
 23630            ELSE
 23631                GO TO 7499-EXIT.
 23632
 23633**2757**
 23634
 23635     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23636        MOVE AL-UNBON            TO CLIVESA
 23637        MOVE -1                  TO CLIVESL
 23638        MOVE  1                  TO SET-CURSOR-SW
 23639        GO TO 7499-EXIT.
 23640
 23641**2771**
 23642
 23643     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23644        MOVE AL-UABON            TO CCANDT2A
 23645        MOVE -1                  TO CCANDT2L
 23646        MOVE  1                  TO SET-CURSOR-SW
 23647        GO TO 7499-EXIT.
 23648
 23649**2774**
 23650
 23651     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23652        MOVE AL-UABON            TO CCANDT1A
 23653        MOVE -1                  TO CCANDT1L
 23654        MOVE  1                  TO SET-CURSOR-SW
 23655        GO TO 7499-EXIT.
 23656
 23657**2775**
 23658
 23659     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23660        MOVE AL-UABON            TO CCANDT2A
 23661        MOVE -1                  TO CCANDT2L
 23662        MOVE  1                  TO SET-CURSOR-SW
 23663        GO TO 7499-EXIT.
 23664
 23665**2776**
 23666
 23667     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23668        MOVE AL-UABON            TO CCANDT1A
 23669        MOVE -1                  TO CCANDT1L
 23670        MOVE  1                  TO SET-CURSOR-SW
 23671        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 435
* VP6311.cbl
 23672
 23673
 23674**2777**
 23675
 23676     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23677        MOVE AL-UABON            TO CCANDT2A
 23678        MOVE -1                  TO CCANDT2L
 23679        MOVE  1                  TO SET-CURSOR-SW
 23680        GO TO 7499-EXIT.
 23681
 23682**2794**
 23683
 23684     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23685        MOVE AL-UABON            TO CFORCEA
 23686        MOVE -1                  TO CFORCEL
 23687        MOVE  1                  TO SET-CURSOR-SW
 23688        GO TO 7499-EXIT.
 23689
 23690**2799**
 23691
 23692     IF PI-COMPANY-ID = 'UCL'
 23693         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23694             MOVE AL-UNBON            TO BEFFDTA
 23695             MOVE -1                  TO BEFFDTL
 23696             MOVE  1                  TO SET-CURSOR-SW
 23697             GO TO 7499-EXIT.
 23698
 23699 7499-EXIT.
 23700      EXIT.
 23701
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 436
* VP6311.cbl
 23703
 23704 7500-READ-ERLOFC.
 23705     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23706                                     ERLOFC-KEY.
 23707
 23708     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23709
 23710     IF ST-ACCNT-CNTL
 23711         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23712
 23713     IF CARR-GROUP-ST-ACCNT-CNTL
 23714         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23715         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23716         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23717
 23718     IF CARR-ST-ACCNT-CNTL
 23719         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23720         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23721
 23722     IF CARR-ACCNT-CNTL
 23723         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23724
 23725     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23726
 23727     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23728
 23729
 23730* EXEC CICS HANDLE CONDITION
 23731*        NOTFND   (7550-OFFICER-NOTFND)
 23732*    END-EXEC.
 23733*    MOVE '"$I                   ! [ #00019896' TO DFHEIV0
 23734     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23735     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23736     MOVE X'5B20233030303139383936' TO DFHEIV0(25:11)
 23737     CALL 'kxdfhei1' USING DFHEIV0
 23738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23739
 23740
 23741
 23742* EXEC CICS READ
 23743*        DATASET   (FILE-ID-ERLOFC)
 23744*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23745*        RIDFLD    (ERLOFC-KEY)
 23746*        EQUAL
 23747*    END-EXEC.
 23748*    MOVE '&"S        E          (   #00019900' TO DFHEIV0
 23749     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23750     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23751     MOVE X'2020233030303139393030' TO DFHEIV0(25:11)
 23752     CALL 'kxdfhei1' USING DFHEIV0,
 23753           FILE-ID-ERLOFC,
 23754           DFHEIV20,
 23755           DFHEIV99,
 23756           ERLOFC-KEY,
 23757           DFHEIV99,
 23758           DFHEIV99,
 23759           DFHEIV99
 23760     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 437
* VP6311.cbl
 23761         DFHEIV20
 23762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23763
 23764
 23765     GO TO 7599-EXIT.
 23766
 23767 7550-OFFICER-NOTFND.
 23768     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23769
 23770 7599-EXIT.
 23771      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 438
* VP6311.cbl
 23773******************************************************************
 23774*                                                                *
 23775*            S  E N D    I N I T I A L   M A P                   *
 23776*                                                                *
 23777******************************************************************
 23778
 23779 8100-SEND-INITIAL-MAP.
 23780     MOVE EIBTIME                TO TIME-IN.
 23781
 23782     IF EIBAID = DFHPF11
 23783        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23784        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23785
 23786
 23787     IF PI-COMPANY-ID = CLIENT-GIC
 23788        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23789                                       BCPREM-ATTRB (2).
 23790
 23791     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23792                         CLIENT-PEM OR
 23793                         CLIENT-CSO)
 23794        AND PI-DISPLAY-ORIGINAL-BATCH
 23795          IF PI-MAP-NAME = VP631B
 23796             MOVE AL-SADOF               TO BPF5HDRA
 23797                                            BPF4HDRA
 23798          ELSE
 23799             IF PI-MAP-NAME = VP631C
 23800                MOVE AL-SADOF            TO CPF5HDRA
 23801                                            CPF4HDRA.
 23802
 23803     IF PI-MAP-NAME = VP631B
 23804        MOVE AL-SADOF               TO BPF5HDRA
 23805     ELSE
 23806        MOVE AL-SADOF               TO CPF5HDRA
 23807     END-IF
 23808
 23809
 23810     IF PI-PROCESSOR-ID = 'LGXX'
 23811        IF PI-MAP-NAME = VP631B
 23812           MOVE AL-SABOF                    TO BREFHDGA
 23813           MOVE AL-SANOF                    TO BREFA
 23814        ELSE
 23815           IF PI-MAP-NAME = VP631C
 23816              MOVE AL-SABOF                 TO CREFHDGA
 23817              MOVE AL-SANOF                 TO CREFA.
 23818
 23819     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 23820        continue
 23821     ELSE
 23822        IF PI-MAP-NAME = VP631C
 23823           MOVE AL-SADOF         TO CCANTXTA
 23824                                    CCANFEEA
 23825        end-if
 23826     end-if
 23827     IF PI-MAP-NAME = VP631D
 23828        IF PI-AR-PROCESSING
 23829           MOVE AL-SANOF            TO DREFHDGA
 23830        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 439
* VP6311.cbl
 23831           MOVE AL-SADOF            TO DREFHDGA.
 23832
 23833     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 23834        AND (PI-MAP-NAME = VP631B)
 23835        MOVE AL-SADOF            TO BVINHA
 23836                                    BVINA
 23837     END-IF
 23838     IF PI-MAP-NAME = VP631B
 23839        MOVE PI-COMPANY-ID          TO BCOMPIDO
 23840        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 23841                                 TO BREGIONO
 23842        MOVE PI-PROCESSOR-ID     TO BUSERO
 23843        IF CSR-EDIT-SESSION
 23844           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23845                                 TO BHEADO
 23846           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 23847        ELSE
 23848           MOVE AL-SADOF         TO BF15HDRA
 23849           MOVE '4=B-HDR      '  TO BPF4HDRO
 23850        END-IF
 23851        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23852        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 23853        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 23854        MOVE WS-CURRENT-DT          TO BDATEO
 23855        MOVE TIME-OUT               TO BTIMEO
 23856        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23857        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23858        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23859        IF   WS-DISPLAY-SCREEN
 23860             MOVE PB-ENTRY-BATCH    TO BBATCHO
 23861             MOVE PB-SV-CARRIER     TO BCARRO
 23862             MOVE PB-SV-GROUPING    TO BGROUPO
 23863             MOVE PB-SV-STATE       TO BSTATEO
 23864             MOVE PB-ACCOUNT        TO BACCTO
 23865        ELSE
 23866             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 23867     ELSE
 23868        IF PI-MAP-NAME = VP631C
 23869           MOVE '4=B-HDR      '     TO CPF4HDRO
 23870           IF CSR-EDIT-SESSION
 23871              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23872                                 TO CHEADO
 23873           ELSE
 23874              MOVE AL-SADOF      TO CF15HDRA
 23875           END-IF
 23876           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 23877           MOVE WS-CURRENT-DT          TO CDATEO
 23878           MOVE TIME-OUT               TO CTIMEO
 23879           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 23880           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 23881           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 23882           MOVE WS-C-HDG               TO CLFHDGO
 23883           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 23884           MOVE WS-C-HDG               TO CAHHDGO
 23885           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23886           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23887           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23888           IF   WS-DISPLAY-SCREEN
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 440
* VP6311.cbl
 23889                MOVE PB-ENTRY-BATCH    TO CBATCHO
 23890                MOVE PB-SV-CARRIER     TO CCARRO
 23891                MOVE PB-SV-GROUPING    TO CGROUPO
 23892                MOVE PB-SV-STATE       TO CSTATEO
 23893                MOVE PB-ACCOUNT        TO CACCTO
 23894           ELSE
 23895                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 23896        ELSE
 23897           MOVE WS-CURRENT-DT          TO DDATEO
 23898           MOVE TIME-OUT               TO DTIMEO
 23899           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 23900                                          WS-REFUND-HDG-OVERRIDE
 23901           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 23902           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 23903           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 23904                                          WS-REFUND-HDG-OVERRIDE
 23905           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 23906           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 23907           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 23908           IF CSR-EDIT-SESSION
 23909              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23910                                 TO DHEADO
 23911           END-IF
 23912           IF  WS-DISPLAY-SCREEN
 23913               MOVE PB-ENTRY-BATCH     TO DBATCHO
 23914               MOVE PB-CARRIER         TO DCARRO
 23915               MOVE PB-GROUPING        TO DGROUPO
 23916               MOVE PB-STATE           TO DSTATEO
 23917               MOVE PB-ACCOUNT         TO DACCTO
 23918               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 23919           ELSE
 23920               MOVE VP631D             TO PI-MAP-NAME
 23921               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 23922               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 23923
 23924     MOVE SPACE                        TO WS-DISPLAY-SW.
 23925
 23926
 23927* EXEC CICS SEND
 23928*        MAP      (PI-MAP-NAME)
 23929*        MAPSET   (MAPSET-VP6311S)
 23930*        FROM     (VP631BI)
 23931*        ERASE
 23932*        CURSOR
 23933*    END-EXEC.
 23934     MOVE LENGTH OF
 23935      VP631BI
 23936       TO DFHEIV12
 23937     MOVE -1
 23938       TO DFHEIV11
 23939*    MOVE '8$     CT  E    H L F ,   #00020068' TO DFHEIV0
 23940     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 23941     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23942     MOVE X'2020233030303230303638' TO DFHEIV0(25:11)
 23943     CALL 'kxdfhei1' USING DFHEIV0,
 23944           PI-MAP-NAME,
 23945           VP631BI,
 23946           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 441
* VP6311.cbl
 23947           MAPSET-VP6311S,
 23948           DFHEIV99,
 23949           DFHEIV99,
 23950           DFHEIV99,
 23951           DFHEIV11,
 23952           DFHEIV99,
 23953           DFHEIV99,
 23954           DFHEIV99
 23955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23956
 23957
 23958     GO TO 9100-RETURN-TRAN.
 23959
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 442
* VP6311.cbl
 23961
 23962******************************************************************
 23963*                                                                *
 23964*              S E N D    D A T A O N L Y                        *
 23965*                                                                *
 23966******************************************************************
 23967
 23968 8200-SEND-DATAONLY.
 23969     MOVE EIBTIME                TO TIME-IN.
 23970
 23971     IF PI-COMPANY-ID = CLIENT-GIC
 23972        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23973                                       BCPREM-ATTRB (2).
 23974
 23975     IF PI-MAP-NAME = VP631B
 23976        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23977        MOVE WS-CURRENT-DT          TO BDATEO
 23978        MOVE TIME-OUT               TO BTIMEO
 23979        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23980        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23981        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23982        MOVE SPACES                 TO BPFENTRO
 23983        MOVE AL-UANOF               TO BPFENTRA
 23984
 23985     ELSE
 23986        IF PI-MAP-NAME = VP631C
 23987           MOVE WS-CURRENT-DT          TO CDATEO
 23988           MOVE TIME-OUT               TO CTIMEO
 23989           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23990           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23991           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23992           MOVE SPACES                 TO CPFENTRO
 23993           MOVE AL-UANOF               TO CPFENTRA
 23994        ELSE
 23995           MOVE WS-CURRENT-DT          TO DDATEO
 23996           MOVE TIME-OUT               TO DTIMEO
 23997           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 23998
 23999
 24000* EXEC CICS SEND
 24001*        MAP      (PI-MAP-NAME)
 24002*        MAPSET   (MAPSET-VP6311S)
 24003*        FROM     (VP631BI)
 24004*        DATAONLY
 24005*        CURSOR
 24006*    END-EXEC.
 24007     MOVE LENGTH OF
 24008      VP631BI
 24009       TO DFHEIV12
 24010     MOVE -1
 24011       TO DFHEIV11
 24012*    MOVE '8$D    CT       H L F ,   #00020117' TO DFHEIV0
 24013     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24014     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24015     MOVE X'2020233030303230313137' TO DFHEIV0(25:11)
 24016     CALL 'kxdfhei1' USING DFHEIV0,
 24017           PI-MAP-NAME,
 24018           VP631BI,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 443
* VP6311.cbl
 24019           DFHEIV12,
 24020           MAPSET-VP6311S,
 24021           DFHEIV99,
 24022           DFHEIV99,
 24023           DFHEIV99,
 24024           DFHEIV11,
 24025           DFHEIV99,
 24026           DFHEIV99,
 24027           DFHEIV99
 24028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24029
 24030
 24031     GO TO 9100-RETURN-TRAN.
 24032
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 444
* VP6311.cbl
 24034
 24035******************************************************************
 24036*                                                                *
 24037*           U T I L I T Y   R O U T I N E S                      *
 24038*                                                                *
 24039******************************************************************
 24040
 24041 8300-SEND-TEXT.
 24042
 24043* EXEC CICS SEND TEXT
 24044*        FROM     (LOGOFF-TEXT)
 24045*        LENGTH   (LOGOFF-LENGTH)
 24046*        ERASE
 24047*        FREEKB
 24048*    END-EXEC.
 24049*    MOVE '8&      T  E F  H   F -   #00020136' TO DFHEIV0
 24050     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24051     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24052     MOVE X'2020233030303230313336' TO DFHEIV0(25:11)
 24053     CALL 'kxdfhei1' USING DFHEIV0,
 24054           LOGOFF-TEXT,
 24055           LOGOFF-LENGTH,
 24056           DFHEIV99,
 24057           DFHEIV99,
 24058           DFHEIV99,
 24059           DFHEIV99,
 24060           DFHEIV99,
 24061           DFHEIV99,
 24062           DFHEIV99,
 24063           DFHEIV99,
 24064           DFHEIV99,
 24065           DFHEIV99
 24066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24067
 24068
 24069
 24070* EXEC CICS RETURN
 24071*    END-EXEC.
 24072*    MOVE '.(                    ''   #00020143' TO DFHEIV0
 24073     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24074     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24075     MOVE X'2020233030303230313433' TO DFHEIV0(25:11)
 24076     CALL 'kxdfhei1' USING DFHEIV0,
 24077           DFHEIV99,
 24078           DFHEIV99,
 24079           DFHEIV99,
 24080           DFHEIV99,
 24081           DFHEIV99,
 24082           DFHEIV99
 24083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24084
 24085
 24086 8400-LOG-JOURNAL-RECORD.
 24087     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24088     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24089
 24090*    EXEC CICS JOURNAL
 24091*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 445
* VP6311.cbl
 24092*        JTYPEID     ('EL')
 24093*        FROM        (JOURNAL-RECORD)
 24094*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24095*    END-EXEC.
 24096
 24097 8600-DEEDIT.
 24098
 24099* EXEC CICS BIF DEEDIT
 24100*         FIELD   (DEEDIT-FIELD)
 24101*         LENGTH  (15)
 24102*    END-EXEC.
 24103     MOVE 15
 24104       TO DFHEIV11
 24105*    MOVE '@"L                   #   #00020158' TO DFHEIV0
 24106     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24107     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24108     MOVE X'2020233030303230313538' TO DFHEIV0(25:11)
 24109     CALL 'kxdfhei1' USING DFHEIV0,
 24110           DEEDIT-FIELD,
 24111           DFHEIV11
 24112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24113
 24114
 24115 8800-UNAUTHORIZED-ACCESS.
 24116     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24117     GO TO 8300-SEND-TEXT.
 24118
 24119 8810-PF23.
 24120     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24121     MOVE XCTL-EL005             TO PGM-NAME.
 24122     GO TO 9300-XCTL.
 24123
 24124 9100-RETURN-TRAN.
 24125     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24126
 24127     IF  PI-MAP-NAME =  VP631B
 24128         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24129
 24130     IF  PI-MAP-NAME =  VP631C
 24131         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24132
 24133     IF  PI-MAP-NAME =  VP631D
 24134         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24135
 24136
 24137* EXEC CICS RETURN
 24138*        TRANSID    (TRANS-EXB1)
 24139*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24140*        LENGTH     (1300)
 24141*    END-EXEC.
 24142     MOVE 1300
 24143       TO DFHEIV11
 24144*    MOVE '.(CT                  ''   #00020184' TO DFHEIV0
 24145     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24146     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24147     MOVE X'2020233030303230313834' TO DFHEIV0(25:11)
 24148     CALL 'kxdfhei1' USING DFHEIV0,
 24149           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 446
* VP6311.cbl
 24150           PROGRAM-INTERFACE-BLOCK,
 24151           DFHEIV11,
 24152           DFHEIV99,
 24153           DFHEIV99,
 24154           DFHEIV99
 24155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24156
 24157
 24158 9200-RETURN-MAIN-MENU.
 24159     MOVE XCTL-EL626             TO PGM-NAME.
 24160     GO TO 9300-XCTL.
 24161
 24162 9300-XCTL.
 24163
 24164* EXEC CICS XCTL
 24165*        PROGRAM    (PGM-NAME)
 24166*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24167*        LENGTH     (PI-COMM-LENGTH)
 24168*    END-EXEC.
 24169*    MOVE '.$C                   %   #00020195' TO DFHEIV0
 24170     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24171     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24172     MOVE X'2020233030303230313935' TO DFHEIV0(25:11)
 24173     CALL 'kxdfhei1' USING DFHEIV0,
 24174           PGM-NAME,
 24175           PROGRAM-INTERFACE-BLOCK,
 24176           PI-COMM-LENGTH,
 24177           DFHEIV99
 24178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24179
 24180
 24181 9400-CLEAR.
 24182     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24183     GO TO 9300-XCTL.
 24184
 24185 9500-PF12.
 24186     MOVE XCTL-EL010             TO PGM-NAME.
 24187     GO TO 9300-XCTL.
 24188
 24189 9600-PGMID-ERROR.
 24190
 24191* EXEC CICS HANDLE CONDITION
 24192*        PGMIDERR    (8300-SEND-TEXT)
 24193*    END-EXEC.
 24194*    MOVE '"$L                   ! \ #00020210' TO DFHEIV0
 24195     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24197     MOVE X'5C20233030303230323130' TO DFHEIV0(25:11)
 24198     CALL 'kxdfhei1' USING DFHEIV0
 24199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24200
 24201
 24202     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24203     MOVE ' '                    TO PI-ENTRY-CD-1.
 24204     MOVE XCTL-EL005             TO PGM-NAME.
 24205     MOVE PGM-NAME               TO LOGOFF-PGM.
 24206     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24207     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 447
* VP6311.cbl
 24208
 24209 9700-DATE-LINK.
 24210     MOVE LINK-ELDATCV           TO PGM-NAME.
 24211
 24212* EXEC CICS LINK
 24213*        PROGRAM    (PGM-NAME)
 24214*        COMMAREA   (DATE-CONVERSION-DATA)
 24215*        LENGTH     (DC-COMM-LENGTH)
 24216*    END-EXEC.
 24217*    MOVE '."C                   (   #00020223' TO DFHEIV0
 24218     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24219     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24220     MOVE X'2020233030303230323233' TO DFHEIV0(25:11)
 24221     CALL 'kxdfhei1' USING DFHEIV0,
 24222           PGM-NAME,
 24223           DATE-CONVERSION-DATA,
 24224           DC-COMM-LENGTH,
 24225           DFHEIV99,
 24226           DFHEIV99,
 24227           DFHEIV99,
 24228           DFHEIV99
 24229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24230
 24231
 24232 9800-LINK-PENDING-EDIT.
 24233     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24234     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24235
 24236     MOVE LINK-EL050             TO PGM-NAME
 24237     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24238     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24239                                    WK-CO-TOL-CLAIM
 24240                                    WK-CO-TOL-PREM
 24241                                    WK-CO-TOL-REFUND
 24242                                    WK-CO-TOL-PREM-PCT
 24243                                    WK-CO-TOL-REFUND-PCT
 24244                                    WK-REFUND-OVS-AMT
 24245                                    WK-REFUND-OVS-PCT
 24246                                    WK-ACCT-ADDR
 24247                                    WK-LIFE-EDIT-ADDR
 24248                                    WK-AH-EDIT-ADDR
 24249                                    WK-LIFE-BEN-ADDR
 24250                                    WK-AH-BEN-ADDR
 24251                                    WK-STATE-ADDR
 24252                                    WK-PLAN-ADDR
 24253                                    WK-FORM-ADDR
 24254     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24255
 24256     MOVE '6'                    TO WK-ENTRY-SW.
 24257
 24258     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24259
 24260     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24261                                    EC-AM-EXPIRATION-DT
 24262                                    EC-AM-EFFECTIVE-DT
 24263                                    EC-CM-LF-CANCEL-DT
 24264                                    EC-CM-AH-CANCEL-DT
 24265                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 448
* VP6311.cbl
 24266
 24267     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24268                                    EC-CO-TOL-REFUND
 24269                                    EC-CO-MIN-AGE
 24270                                    EC-CO-MIN-PREMIUM
 24271                                    EC-CO-MIN-TERM
 24272                                    EC-CO-MAX-TERM
 24273                                    EC-ST-TOL-PREM
 24274                                    EC-ST-TOL-REFUND
 24275                                    EC-AM-LF-TOL-PREM
 24276                                    EC-AM-AH-TOL-PREM
 24277                                    EC-AM-LF-MAX-ATT-AGE
 24278                                    EC-AM-LF-MAX-AGE
 24279                                    EC-AM-LF-MAX-TERM
 24280                                    EC-AM-LF-MAX-TOT-BEN
 24281                                    EC-AM-AH-MAX-ATT-AGE
 24282                                    EC-AM-AH-MAX-AGE
 24283                                    EC-AM-AH-MAX-TERM
 24284                                    EC-AM-AH-MAX-TOT-BEN
 24285                                    EC-AM-AH-MAX-MON-BEN
 24286                                    EC-RT-LF-MAX-ATT-AGE
 24287                                    EC-RT-LF-MAX-AGE
 24288                                    EC-RT-LF-MAX-TERM
 24289                                    EC-RT-LF-MAX-TOT-BEN
 24290                                    EC-RT-AH-MAX-ATT-AGE
 24291                                    EC-RT-AH-MAX-AGE
 24292                                    EC-RT-AH-MAX-TERM
 24293                                    EC-RT-AH-MAX-TOT-BEN
 24294                                    EC-RT-AH-MAX-MON-BEN
 24295                                    EC-RT-AH-RATE
 24296                                    EC-RT-LF-RATE
 24297                                    EC-RT-LF-NSP-RATE
 24298                                    EC-RT-AH-NSP-RATE
 24299                                    EC-CM-LF-PRIOR-REFUND
 24300                                    EC-CM-AH-PRIOR-REFUND.
 24301
 24302     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24303                                    EC-ST-TOL-PREM-PCT
 24304                                    EC-AM-LF-TOL-REFUND
 24305                                    EC-AM-LF-DEV-PERCENT
 24306                                    EC-CO-TOL-REFUND-PCT
 24307                                    EC-ST-TOL-REFUND-PCT
 24308                                    EC-AM-AH-TOL-REFUND
 24309                                    EC-AM-AH-DEV-PERCENT.
 24310
 24311
 24312* EXEC CICS LINK
 24313*         PROGRAM   (PGM-NAME)
 24314*         COMMAREA  (PASSED-RECORD)
 24315*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24316*    END-EXEC.
 24317*    MOVE '."C                   (   #00020308' TO DFHEIV0
 24318     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24319     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24320     MOVE X'2020233030303230333038' TO DFHEIV0(25:11)
 24321     CALL 'kxdfhei1' USING DFHEIV0,
 24322           PGM-NAME,
 24323           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 449
* VP6311.cbl
 24324           WS-EDIT-PASS-LENGTH,
 24325           DFHEIV99,
 24326           DFHEIV99,
 24327           DFHEIV99,
 24328           DFHEIV99
 24329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24330
 24331
 24332     MOVE '1'                    TO PI-EDIT-SW.
 24333     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24334
 24335     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24336
 24337     IF PI-COMPANY-ID = 'UCL'
 24338         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24339
 24340     IF VALID-PB-ID
 24341        GO TO 9800-EXIT.
 24342
 24343     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24344
 24345     IF PI-MAP-NAME = VP631B
 24346        MOVE -1                  TO BMAINTL
 24347       ELSE
 24348        MOVE -1                  TO CMAINTL.
 24349
 24350     GO TO 8200-SEND-DATAONLY.
 24351
 24352 9800-EXIT.
 24353      EXIT.
 24354
 24355 9900-ERROR-FORMAT.
 24356
 24357     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24358
 24359     IF NOT EMI-ERRORS-COMPLETE
 24360         MOVE LINK-EL001         TO PGM-NAME
 24361
 24362* EXEC CICS LINK
 24363*            PROGRAM    (PGM-NAME)
 24364*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24365*            LENGTH     (EMI-COMM-LENGTH)
 24366*        END-EXEC.
 24367*    MOVE '."C                   (   #00020343' TO DFHEIV0
 24368     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24369     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24370     MOVE X'2020233030303230333433' TO DFHEIV0(25:11)
 24371     CALL 'kxdfhei1' USING DFHEIV0,
 24372           PGM-NAME,
 24373           ERROR-MESSAGE-INTERFACE-BLOCK,
 24374           EMI-COMM-LENGTH,
 24375           DFHEIV99,
 24376           DFHEIV99,
 24377           DFHEIV99,
 24378           DFHEIV99
 24379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24380
 24381
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 450
* VP6311.cbl
 24382 9900-EXIT.
 24383     EXIT.
 24384
 24385 9990-ABEND.
 24386     MOVE LINK-EL004             TO PGM-NAME.
 24387     MOVE DFHEIBLK               TO EMI-LINE1.
 24388
 24389* EXEC CICS LINK
 24390*        PROGRAM   (PGM-NAME)
 24391*        COMMAREA  (EMI-LINE1)
 24392*        LENGTH    (72)
 24393*    END-EXEC.
 24394     MOVE 72
 24395       TO DFHEIV11
 24396*    MOVE '."C                   (   #00020355' TO DFHEIV0
 24397     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24398     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24399     MOVE X'2020233030303230333535' TO DFHEIV0(25:11)
 24400     CALL 'kxdfhei1' USING DFHEIV0,
 24401           PGM-NAME,
 24402           EMI-LINE1,
 24403           DFHEIV11,
 24404           DFHEIV99,
 24405           DFHEIV99,
 24406           DFHEIV99,
 24407           DFHEIV99
 24408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24409
 24410
 24411     IF PI-MAP-NAME = VP631B
 24412        MOVE -1                  TO BMAINTL
 24413       ELSE
 24414        MOVE -1                  TO CMAINTL.
 24415
 24416     IF EIBTRNID NOT = TRANS-EXB1
 24417        GO TO 8100-SEND-INITIAL-MAP
 24418       ELSE
 24419        GO TO 8200-SEND-DATAONLY.
 24420
 24421 9995-SECURITY-VIOLATION.
 24422*                            COPY ELCSCTP.
 24423******************************************************************
 24424*                                                                *
 24425*                            ELCSCTP                             *
 24426*                            VMOD=2.001                          *
 24427*                                                                *
 24428*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24429******************************************************************
 24430
 24431
 24432     MOVE EIBDATE          TO SM-JUL-DATE.
 24433     MOVE EIBTRMID         TO SM-TERMID.
 24434     MOVE THIS-PGM         TO SM-PGM.
 24435     MOVE EIBTIME          TO TIME-IN.
 24436     MOVE TIME-OUT         TO SM-TIME.
 24437     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24438
 24439
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 451
* VP6311.cbl
 24440* EXEC CICS LINK
 24441*         PROGRAM  ('EL003')
 24442*         COMMAREA (SECURITY-MESSAGE)
 24443*         LENGTH   (80)
 24444*    END-EXEC.
 24445     MOVE 'EL003' TO DFHEIV1
 24446     MOVE 80
 24447       TO DFHEIV11
 24448*    MOVE '."C                   (   #00020389' TO DFHEIV0
 24449     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24450     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24451     MOVE X'2020233030303230333839' TO DFHEIV0(25:11)
 24452     CALL 'kxdfhei1' USING DFHEIV0,
 24453           DFHEIV1,
 24454           SECURITY-MESSAGE,
 24455           DFHEIV11,
 24456           DFHEIV99,
 24457           DFHEIV99,
 24458           DFHEIV99,
 24459           DFHEIV99
 24460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24461
 24462
 24463******************************************************************
 24464
 24465
 24466 9999-DFHBACK SECTION.
 24467     MOVE '9%                    "   ' TO DFHEIV0
 24468     MOVE 'VP6311' TO DFHEIV1
 24469     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24470     GOBACK.
 24471 9999-DFHEXIT.
 24472     IF DFHEIGDJ EQUAL 0001
 24473         NEXT SENTENCE
 24474     ELSE IF DFHEIGDJ EQUAL 2
 24475         GO TO 9600-PGMID-ERROR,
 24476               9990-ABEND,
 24477               9990-ABEND,
 24478               0010-MAIN-LOGIC
 24479         DEPENDING ON DFHEIGDI
 24480     ELSE IF DFHEIGDJ EQUAL 3
 24481         GO TO 1280-BATCH-HDR-NOT-FOUND
 24482         DEPENDING ON DFHEIGDI
 24483     ELSE IF DFHEIGDJ EQUAL 4
 24484         GO TO 1290-DUPLICATE-ALT-INDEX
 24485         DEPENDING ON DFHEIGDI
 24486     ELSE IF DFHEIGDJ EQUAL 5
 24487         GO TO 1295-CERT-TRL-REC-NOTFND
 24488         DEPENDING ON DFHEIGDI
 24489     ELSE IF DFHEIGDJ EQUAL 6
 24490         GO TO 1380-BATCH-HDR-NOT-FOUND
 24491         DEPENDING ON DFHEIGDI
 24492     ELSE IF DFHEIGDJ EQUAL 7
 24493         GO TO 1385-REC-NOT-FOUND
 24494         DEPENDING ON DFHEIGDI
 24495     ELSE IF DFHEIGDJ EQUAL 8
 24496         GO TO 1386-NOTFND
 24497         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 452
* VP6311.cbl
 24498     ELSE IF DFHEIGDJ EQUAL 9
 24499         GO TO 1398-EXIT
 24500         DEPENDING ON DFHEIGDI
 24501     ELSE IF DFHEIGDJ EQUAL 10
 24502         GO TO 1480-BATCH-HDR-NOT-FOUND
 24503         DEPENDING ON DFHEIGDI
 24504     ELSE IF DFHEIGDJ EQUAL 11
 24505         GO TO 1490-RECORD-NOT-FOUND
 24506         DEPENDING ON DFHEIGDI
 24507     ELSE IF DFHEIGDJ EQUAL 12
 24508         GO TO 1405-DELETE-CERTIFICATE
 24509         DEPENDING ON DFHEIGDI
 24510     ELSE IF DFHEIGDJ EQUAL 13
 24511         GO TO 1420-CONTINUE-DELETE
 24512         DEPENDING ON DFHEIGDI
 24513     ELSE IF DFHEIGDJ EQUAL 14
 24514         GO TO 1406-DELETE-ERNOTE
 24515         DEPENDING ON DFHEIGDI
 24516     ELSE IF DFHEIGDJ EQUAL 15
 24517         GO TO 1407-DELETE-MAILING
 24518         DEPENDING ON DFHEIGDI
 24519     ELSE IF DFHEIGDJ EQUAL 16
 24520         GO TO 1420-CONTINUE-DELETE
 24521         DEPENDING ON DFHEIGDI
 24522     ELSE IF DFHEIGDJ EQUAL 17
 24523         GO TO 1480-BATCH-HDR-NOT-FOUND
 24524         DEPENDING ON DFHEIGDI
 24525     ELSE IF DFHEIGDJ EQUAL 18
 24526         GO TO 1475-DELETE-FINISHED
 24527         DEPENDING ON DFHEIGDI
 24528     ELSE IF DFHEIGDJ EQUAL 19
 24529         GO TO 2280-BATCH-HDR-NOT-FOUND
 24530         DEPENDING ON DFHEIGDI
 24531     ELSE IF DFHEIGDJ EQUAL 20
 24532         GO TO 2290-DUPLICATE-ALT-INDEX
 24533         DEPENDING ON DFHEIGDI
 24534     ELSE IF DFHEIGDJ EQUAL 21
 24535         GO TO 2380-BATCH-HDR-NOT-FOUND
 24536         DEPENDING ON DFHEIGDI
 24537     ELSE IF DFHEIGDJ EQUAL 22
 24538         GO TO 2385-REC-NOT-FOUND
 24539         DEPENDING ON DFHEIGDI
 24540     ELSE IF DFHEIGDJ EQUAL 23
 24541         GO TO 2380-BATCH-HDR-NOT-FOUND
 24542         DEPENDING ON DFHEIGDI
 24543     ELSE IF DFHEIGDJ EQUAL 24
 24544         GO TO 2485-BATCH-HDR-NOT-FOUND
 24545         DEPENDING ON DFHEIGDI
 24546     ELSE IF DFHEIGDJ EQUAL 25
 24547         GO TO 2490-RECORD-NOT-FOUND
 24548         DEPENDING ON DFHEIGDI
 24549     ELSE IF DFHEIGDJ EQUAL 26
 24550         GO TO 2475-CONTINUE-DELETE
 24551         DEPENDING ON DFHEIGDI
 24552     ELSE IF DFHEIGDJ EQUAL 27
 24553         GO TO 2485-BATCH-HDR-NOT-FOUND
 24554         DEPENDING ON DFHEIGDI
 24555     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 453
* VP6311.cbl
 24556         GO TO 2480-DELETE-FINISHED
 24557         DEPENDING ON DFHEIGDI
 24558     ELSE IF DFHEIGDJ EQUAL 29
 24559         GO TO 2820-PROCESS-REWRITE
 24560         DEPENDING ON DFHEIGDI
 24561     ELSE IF DFHEIGDJ EQUAL 30
 24562         GO TO 2885-RECORD-MISSING
 24563         DEPENDING ON DFHEIGDI
 24564     ELSE IF DFHEIGDJ EQUAL 31
 24565         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24566         DEPENDING ON DFHEIGDI
 24567     ELSE IF DFHEIGDJ EQUAL 32
 24568         GO TO 2827-DELETE-MAILING
 24569         DEPENDING ON DFHEIGDI
 24570     ELSE IF DFHEIGDJ EQUAL 33
 24571         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24572         DEPENDING ON DFHEIGDI
 24573     ELSE IF DFHEIGDJ EQUAL 34
 24574         GO TO 2920-PROCESS-REWRITE
 24575         DEPENDING ON DFHEIGDI
 24576     ELSE IF DFHEIGDJ EQUAL 35
 24577         GO TO 2985-RECORD-MISSING
 24578         DEPENDING ON DFHEIGDI
 24579     ELSE IF DFHEIGDJ EQUAL 36
 24580         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24581         DEPENDING ON DFHEIGDI
 24582     ELSE IF DFHEIGDJ EQUAL 37
 24583         GO TO 2990-DUPLICATE-RECORD
 24584         DEPENDING ON DFHEIGDI
 24585     ELSE IF DFHEIGDJ EQUAL 38
 24586         GO TO 3590-NOT-FOUND
 24587         DEPENDING ON DFHEIGDI
 24588     ELSE IF DFHEIGDJ EQUAL 39
 24589         GO TO 3690-NOT-FOUND
 24590         DEPENDING ON DFHEIGDI
 24591     ELSE IF DFHEIGDJ EQUAL 40
 24592         GO TO 3990-NOT-FOUND
 24593         DEPENDING ON DFHEIGDI
 24594     ELSE IF DFHEIGDJ EQUAL 41
 24595         GO TO 4050-END-RECORDS,
 24596               4050-END-RECORDS
 24597         DEPENDING ON DFHEIGDI
 24598     ELSE IF DFHEIGDJ EQUAL 42
 24599         GO TO 4150-END-BATCH
 24600         DEPENDING ON DFHEIGDI
 24601     ELSE IF DFHEIGDJ EQUAL 43
 24602         GO TO 4150-END-BATCH
 24603         DEPENDING ON DFHEIGDI
 24604     ELSE IF DFHEIGDJ EQUAL 44
 24605         GO TO 4250-END-RECORDS,
 24606               4250-END-RECORDS
 24607         DEPENDING ON DFHEIGDI
 24608     ELSE IF DFHEIGDJ EQUAL 45
 24609         GO TO 4350-END-BATCH,
 24610               4350-END-BATCH
 24611         DEPENDING ON DFHEIGDI
 24612     ELSE IF DFHEIGDJ EQUAL 46
 24613         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 10:15 Page 454
* VP6311.cbl
 24614               4550-END-RECORDS
 24615         DEPENDING ON DFHEIGDI
 24616     ELSE IF DFHEIGDJ EQUAL 47
 24617         GO TO 4680-NOT-FOUND,
 24618               4680-NOT-FOUND
 24619         DEPENDING ON DFHEIGDI
 24620     ELSE IF DFHEIGDJ EQUAL 48
 24621         GO TO 4860-NOT-FOUND,
 24622               4850-END-RECORDS
 24623         DEPENDING ON DFHEIGDI
 24624     ELSE IF DFHEIGDJ EQUAL 49
 24625         GO TO 4970-NOT-FOUND,
 24626               4950-END-RECORDS
 24627         DEPENDING ON DFHEIGDI
 24628     ELSE IF DFHEIGDJ EQUAL 50
 24629         GO TO 5050-NOT-FOUND
 24630         DEPENDING ON DFHEIGDI
 24631     ELSE IF DFHEIGDJ EQUAL 51
 24632         GO TO 5050-NOT-FOUND
 24633         DEPENDING ON DFHEIGDI
 24634     ELSE IF DFHEIGDJ EQUAL 52
 24635         GO TO 5050-NOT-FOUND
 24636         DEPENDING ON DFHEIGDI
 24637     ELSE IF DFHEIGDJ EQUAL 53
 24638         GO TO 5550-END-RECORDS,
 24639               5550-END-RECORDS
 24640         DEPENDING ON DFHEIGDI
 24641     ELSE IF DFHEIGDJ EQUAL 54
 24642         GO TO 6050-QID-ERROR
 24643         DEPENDING ON DFHEIGDI
 24644     ELSE IF DFHEIGDJ EQUAL 55
 24645         GO TO 6050-QID-ERROR
 24646         DEPENDING ON DFHEIGDI
 24647     ELSE IF DFHEIGDJ EQUAL 56
 24648         GO TO 6400-CONTINUE,
 24649               6400-CONTINUE
 24650         DEPENDING ON DFHEIGDI
 24651     ELSE IF DFHEIGDJ EQUAL 57
 24652         GO TO 3690-NOT-FOUND
 24653         DEPENDING ON DFHEIGDI
 24654     ELSE IF DFHEIGDJ EQUAL 58
 24655         GO TO 7399-EXIT
 24656         DEPENDING ON DFHEIGDI
 24657     ELSE IF DFHEIGDJ EQUAL 59
 24658         GO TO 7550-OFFICER-NOTFND
 24659         DEPENDING ON DFHEIGDI
 24660     ELSE IF DFHEIGDJ EQUAL 60
 24661         GO TO 8300-SEND-TEXT
 24662         DEPENDING ON DFHEIGDI.
 24663     MOVE '9%                    "   ' TO DFHEIV0
 24664     MOVE 'VP6311' TO DFHEIV1
 24665     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24666     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15788     Code:       96410
