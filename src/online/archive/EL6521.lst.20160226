* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6521.cbl
* Options: int("EL6521.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6521.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6521.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6521.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6521.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 11/18/94 10:26:25.
     7*                            VMOD=2.004
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6521.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*                                                                *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23*
    24*REMARKS.    TRANSACTION - EXD8 - COMPENSATION GA STATUS DATA.
    25*
    26******************************************************************
    27*                   C H A N G E   L O G
    28*
    29* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    30*-----------------------------------------------------------------
    31*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    32* EFFECTIVE    NUMBER
    33*-----------------------------------------------------------------
    34* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    35* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
    36* 092707    2004020600003  PEMA  ADD DELIVER TO MEL SWITCH
    37* 030211    2010012100001  PEMA  ADD RDS EMAILS TO LOGIC
    38* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    39******************************************************************
    40 ENVIRONMENT DIVISION.
    41
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6521.cbl
    43 DATA DIVISION.
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  FILLER  PIC X(32)  VALUE '********************************'.
    47 77  FILLER  PIC X(32)  VALUE '*    EL6521 WORKING STORAGE    *'.
    48 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.004 *********'.
    49
    50 01  WS-DATE-AREA.
    51     05  WS-SAVE-DATE                PIC X(8) VALUE SPACES.
    52     05  WS-SAVE-BIN-DT              PIC XX   VALUE SPACES.
    53     05  WS-EFF-YMD                  PIC X(6).
    54     05  WS-SAVE-BIN-EFFDT           PIC XX   VALUE SPACES.
    55     05  WS-TRM-YMD                  PIC X(6).
    56     05  WS-SAVE-BIN-TRMDT           PIC XX   VALUE SPACES.
    57     05  WS-ACH-SW                   PIC X    VALUE 'N'.
    58         88  ACH-HAS-CHANGED             VALUE 'Y'.
    59         88  NO-ACH-CHANGE               VALUE 'N'.
    60     05  SUPPRESS-MAP-SW             PIC X    VALUE SPACE.
    61         88  DO-NOT-MOVE-TO-MAP          VALUE 'N'.
    62         88  MOVE-TO-MAP                 VALUE 'Y'.
    63     05  MAP-CHANGED-SW              PIC X    VALUE 'N'.
    64         88  MAP-NOT-CHANGED             VALUE 'N'.
    65         88  MAP-CHANGED                 VALUE 'Y'.
    66     05  BILL-INST-SW                PIC X.
    67         88  BILL-INST-CHANGED           VALUE 'Y'.
    68
    69 01  WS-RESPONSE                 PIC S9(8)   COMP.
    70     88  RESP-NORMAL                  VALUE +00.
    71     88  RESP-NOTFND                  VALUE +13.
    72     88  RESP-NOTOPEN                 VALUE +19.
    73     88  RESP-ENDFILE                 VALUE +20.
    74 01  STANDARD-AREAS.
    75     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
    76     12  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1024.
    77     12  WS-SUB                      PIC S9(4) COMP VALUE +0.
    78     12  MAP-NAME                    PIC X(8) VALUE 'EL6521A'.
    79     12  MAPSET-NAME                 PIC X(8) VALUE 'EL6521S'.
    80     12  SCREEN-NUMBER               PIC X(4) VALUE '652B'.
    81     12  TRANS-ID                    PIC X(4) VALUE 'EXD8'.
    82     12  EL611-TRANS-ID              PIC X(4) VALUE 'EXL3'.
    83     12  EL6525-TRANS-ID             PIC X(4) VALUE 'EXDF'.
    84     12  EL6526-TRANS-ID             PIC X(4) VALUE 'EXDG'.
    85     12  THIS-PGM                    PIC X(8) VALUE 'EL6521'.
    86     12  PGM-NAME                    PIC X(8).
    87     12  TIME-IN                     PIC S9(7).
    88     12  TIME-OUT-R  REDEFINES TIME-IN.
    89         16  FILLER                  PIC X.
    90         16  TIME-OUT                PIC 99V99.
    91         16  FILLER                  PIC XX.
    92     12  XCTL-005                    PIC X(8) VALUE 'EL005'.
    93     12  XCTL-010                    PIC X(8) VALUE 'EL010'.
    94     12  XCTL-626                    PIC X(8) VALUE 'EL626'.
    95     12  XCTL-611                    PIC X(8) VALUE 'EL611'.
    96     12  XCTL-6525                   PIC X(8) VALUE 'EL6525'.
    97     12  XCTL-6526                   PIC X(8) VALUE 'EL6526'.
    98     12  XCTL-652                    PIC X(8) VALUE 'EL652'.
    99     12  LINK-001                    PIC X(8) VALUE 'EL001'.
   100     12  LINK-004                    PIC X(8) VALUE 'EL004'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6521.cbl
   101     12  QID.
   102         16  QID-TERM                PIC X(4) VALUE SPACES.
   103         16  FILLER                  PIC X(4) VALUE '521A'.
   104     12  MAP-LENGTH                  PIC S9(4) VALUE +600  COMP.
   105     12  ERCOBI-FILE-ID              PIC X(8) VALUE 'ERCOBI'.
   106     12  ERCOMP-FILE-ID              PIC X(8) VALUE 'ERCOMP'.
   107     12  ELACHP-FILE-ID              PIC X(8) VALUE 'ELACHP'.
   108     12  ELBANK-FILE-ID              PIC X(8) VALUE 'ELBANK'.
   109     12  WS-AGENT-BANK-DESC.
   110         16 FILLER                   PIC X(7) VALUE '  AGENT'.
   111         16 FILLER                   PIC X(1) VALUE X'7D'.
   112         16 FILLER                   PIC X(15)
   113                                      VALUE 'S BANK ACCOUNT:'.
   114
   115     12  DEEDIT-FIELD                PIC X(15).
   116     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD PIC S9(15).
   117
   118     12  ERCOBI-KEY.
   119         16  ERCOBI-COMPANY-CD      PIC X.
   120         16  ERCOBI-STMT-OWNER      PIC X(4).
   121         16  ERCOBI-RGID            PIC X(12).
   122     12  WS-BILL-INST-SW            PIC X  VALUE SPACES.
   123         88  BILLING-INSTRUCTIONS-FOUND  VALUE 'Y'.
   124     12  ERROR-MESSAGES.
   125         16  ER-0000                 PIC X(4) VALUE '0000'.
   126         16  ER-0004                 PIC X(4) VALUE '0004'.
   127         16  ER-0008                 PIC X(4) VALUE '0008'.
   128         16  ER-0029                 PIC X(4) VALUE '0029'.
   129         16  ER-0068                 PIC X(4) VALUE '0068'.
   130         16  ER-0070                 PIC X(4) VALUE '0070'.
   131         16  ER-0348                 PIC X(4) VALUE '0348'.
   132         16  ER-0454                 PIC X(4) VALUE '0454'.
   133         16  ER-0876                 PIC X(4) VALUE '0876'.
   134         16  ER-1228                 PIC X(4) VALUE '1228'.
   135         16  ER-1626                 PIC X(4) VALUE '1626'.
   136         16  ER-1629                 PIC X(4) VALUE '1629'.
   137         16  ER-2039                 PIC X(4) VALUE '2039'.
   138         16  ER-2233                 PIC X(4) VALUE '2233'.
   139         16  ER-2797                 PIC X(4) VALUE '2797'.
   140         16  ER-7430                 PIC X(4) VALUE '7430'.
   141         16  ER-7431                 PIC X(4) VALUE '7431'.
   142         16  ER-7432                 PIC X(4) VALUE '7432'.
   143         16  ER-7434                 PIC X(4) VALUE '7434'.
   144         16  ER-7435                 PIC X(4) VALUE '7435'.
   145         16  ER-7436                 PIC X(4) VALUE '7436'.
   146         16  ER-7438                 PIC X(4) VALUE '7438'.
   147         16  ER-7440                 PIC X(4) VALUE '7440'.
   148         16  ER-7447                 PIC X(4) VALUE '7447'.
   149         16  ER-7449                 PIC X(4) VALUE '7449'.
   150         16  ER-7462                 PIC X(4) VALUE '7462'.
   151         16  ER-7465                 PIC X(4) VALUE '7465'.
   152         16  ER-7468                 PIC X(4) VALUE '7468'.
   153         16  ER-7469                 PIC X(4) VALUE '7469'.
   154         16  ER-8799                 PIC X(4) VALUE '8799'.
   155         16  ER-9388                 PIC X(4) VALUE '9388'.
   156         16  ER-9399                 PIC X(4) VALUE '9399'.
   157         16  ER-9999                 PIC X(4) VALUE '9999'.
   158
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6521.cbl
   159     12  ELCNTL-KEY.
   160         16  CNTL-COMP-ID            PIC X(3) VALUE SPACES.
   161         16  CNTL-REC-TYPE           PIC X    VALUE SPACES.
   162         16  CNTL-ACCESS             PIC X(4) VALUE SPACES.
   163         16  CNTL-SEQ-NO             PIC S9(4) VALUE +0  COMP.
   164
   165     12  WS-BANK-INFORMATION.
   166         16 WS-BANK-DATA.
   167             20 WS-TRANSIT1              PIC X(4).
   168             20 WS-TRANSIT2              PIC X(4).
   169             20 WS-BKACCTI               PIC X(17).
   170         16 WS-ACTCDI                    PIC X(1).
   171
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6521.cbl
   173*    COPY ELCLOGOF.
   174******************************************************************
   175*                                                                *
   176*                                                                *
   177*                            ELCLOGOF.                           *
   178*                            VMOD=2.001                          *
   179*                                                                *
   180*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   181*                                                                *
   182******************************************************************
   183 01  CLASIC-LOGOFF.
   184     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   185     12  LOGOFF-TEXT.
   186         16  FILLER          PIC X(5)    VALUE SPACES.
   187         16  LOGOFF-MSG.
   188             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   189             20  FILLER      PIC X       VALUE SPACES.
   190             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   191         16  FILLER          PIC X(80)
   192           VALUE '* YOU ARE NOW LOGGED OFF'.
   193         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   194         16  FILLER          PIC X       VALUE QUOTE.
   195         16  LOGOFF-SYS-MSG  PIC X(17)
   196           VALUE 'S CLAS-IC SYSTEM '.
   197     12  TEXT-MESSAGES.
   198         16  UNACCESS-MSG    PIC X(29)
   199             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   200         16  PGMIDERR-MSG    PIC X(17)
   201             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6521.cbl
   203*    COPY ELCDATE.
   204******************************************************************
   205*                                                                *
   206*                                                                *
   207*                            ELCDATE.                            *
   208*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   209*                            VMOD=2.003
   210*                                                                *
   211*                                                                *
   212*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   213*                 LENGTH = 200                                   *
   214******************************************************************
   215
   216 01  DATE-CONVERSION-DATA.
   217     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   218     12  DC-OPTION-CODE                PIC X.
   219         88  BIN-TO-GREG                VALUE ' '.
   220         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   221         88  EDIT-GREG-TO-BIN           VALUE '2'.
   222         88  YMD-GREG-TO-BIN            VALUE '3'.
   223         88  MDY-GREG-TO-BIN            VALUE '4'.
   224         88  JULIAN-TO-BIN              VALUE '5'.
   225         88  BIN-PLUS-ELAPSED           VALUE '6'.
   226         88  FIND-CENTURY               VALUE '7'.
   227         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   228         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   229         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   230         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   231         88  JULIAN-TO-BIN-3            VALUE 'C'.
   232         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   233         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   234         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   235         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   236         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   237         88  CHECK-LEAP-YEAR            VALUE 'H'.
   238         88  BIN-3-TO-GREG              VALUE 'I'.
   239         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   240         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   241         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   242         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   243         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   244         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   245         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   246         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   247         88  THREE-CHARACTER-BIN
   248                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   249         88  GREGORIAN-TO-BIN
   250                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   251         88  BIN-TO-GREGORIAN
   252                  VALUES ' ' '1' 'I' '8' 'G'.
   253         88  JULIAN-TO-BINARY
   254                  VALUES '5' 'C' 'E' 'F'.
   255     12  DC-ERROR-CODE                 PIC X.
   256         88  NO-CONVERSION-ERROR        VALUE ' '.
   257         88  DATE-CONVERSION-ERROR
   258                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   259         88  DATE-IS-ZERO               VALUE '1'.
   260         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6521.cbl
   261         88  DATE-IS-INVALID            VALUE '3'.
   262         88  DATE1-GREATER-DATE2        VALUE '4'.
   263         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   264         88  DATE-INVALID-OPTION        VALUE '9'.
   265         88  INVALID-CENTURY            VALUE 'A'.
   266         88  ONLY-CENTURY               VALUE 'B'.
   267         88  ONLY-LEAP-YEAR             VALUE 'C'.
   268         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   269     12  DC-END-OF-MONTH               PIC X.
   270         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   271     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   272         88  USE-NORMAL-PROCESS         VALUE ' '.
   273         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   274         88  ADJUST-UP-100-YRS          VALUE '2'.
   275     12  FILLER                        PIC X.
   276     12  DC-CONVERSION-DATES.
   277         16  DC-BIN-DATE-1             PIC XX.
   278         16  DC-BIN-DATE-2             PIC XX.
   279         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   280         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   281                       DC-GREG-DATE-1-EDIT.
   282             20  DC-EDIT1-MONTH        PIC 99.
   283             20  SLASH1-1              PIC X.
   284             20  DC-EDIT1-DAY          PIC 99.
   285             20  SLASH1-2              PIC X.
   286             20  DC-EDIT1-YEAR         PIC 99.
   287         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   288         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   289                     DC-GREG-DATE-2-EDIT.
   290             20  DC-EDIT2-MONTH        PIC 99.
   291             20  SLASH2-1              PIC X.
   292             20  DC-EDIT2-DAY          PIC 99.
   293             20  SLASH2-2              PIC X.
   294             20  DC-EDIT2-YEAR         PIC 99.
   295         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   296         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   297                     DC-GREG-DATE-1-YMD.
   298             20  DC-YMD-YEAR           PIC 99.
   299             20  DC-YMD-MONTH          PIC 99.
   300             20  DC-YMD-DAY            PIC 99.
   301         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   302         16  DC-GREG-DATE-1-MDY-R REDEFINES
   303                      DC-GREG-DATE-1-MDY.
   304             20  DC-MDY-MONTH          PIC 99.
   305             20  DC-MDY-DAY            PIC 99.
   306             20  DC-MDY-YEAR           PIC 99.
   307         16  DC-GREG-DATE-1-ALPHA.
   308             20  DC-ALPHA-MONTH        PIC X(10).
   309             20  DC-ALPHA-DAY          PIC 99.
   310             20  FILLER                PIC XX.
   311             20  DC-ALPHA-CENTURY.
   312                 24 DC-ALPHA-CEN-N     PIC 99.
   313             20  DC-ALPHA-YEAR         PIC 99.
   314         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   315         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   316         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   317         16  DC-JULIAN-DATE            PIC 9(05).
   318         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6521.cbl
   319                                       PIC 9(05).
   320         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   321             20  DC-JULIAN-YEAR        PIC 99.
   322             20  DC-JULIAN-DAYS        PIC 999.
   323         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   324         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   325         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   326     12  DATE-CONVERSION-VARIBLES.
   327         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   328         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   329             20  FILLER                PIC 9(3).
   330             20  HOLD-CEN-1-CCYY.
   331                 24  HOLD-CEN-1-CC     PIC 99.
   332                 24  HOLD-CEN-1-YY     PIC 99.
   333             20  HOLD-CEN-1-MO         PIC 99.
   334             20  HOLD-CEN-1-DA         PIC 99.
   335         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   336             20  HOLD-CEN-1-R-MO       PIC 99.
   337             20  HOLD-CEN-1-R-DA       PIC 99.
   338             20  HOLD-CEN-1-R-CCYY.
   339                 24  HOLD-CEN-1-R-CC   PIC 99.
   340                 24  HOLD-CEN-1-R-YY   PIC 99.
   341             20  FILLER                PIC 9(3).
   342         16  HOLD-CENTURY-1-X.
   343             20  FILLER                PIC X(3)  VALUE SPACES.
   344             20  HOLD-CEN-1-X-CCYY.
   345                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   346                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   347             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   348             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   349         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   350             20  HOLD-CEN-1-R-X-MO     PIC XX.
   351             20  HOLD-CEN-1-R-X-DA     PIC XX.
   352             20  HOLD-CEN-1-R-X-CCYY.
   353                 24  HOLD-CEN-1-R-X-CC PIC XX.
   354                 24  HOLD-CEN-1-R-X-YY PIC XX.
   355             20  FILLER                PIC XXX.
   356         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   357         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   358         16  DC-JULIAN-DATE-1          PIC 9(07).
   359         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   360             20  DC-JULIAN-1-CCYY.
   361                 24  DC-JULIAN-1-CC    PIC 99.
   362                 24  DC-JULIAN-1-YR    PIC 99.
   363             20  DC-JULIAN-DA-1        PIC 999.
   364         16  DC-JULIAN-DATE-2          PIC 9(07).
   365         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   366             20  DC-JULIAN-2-CCYY.
   367                 24  DC-JULIAN-2-CC    PIC 99.
   368                 24  DC-JULIAN-2-YR    PIC 99.
   369             20  DC-JULIAN-DA-2        PIC 999.
   370         16  DC-GREG-DATE-A-EDIT.
   371             20  DC-EDITA-MONTH        PIC 99.
   372             20  SLASHA-1              PIC X VALUE '/'.
   373             20  DC-EDITA-DAY          PIC 99.
   374             20  SLASHA-2              PIC X VALUE '/'.
   375             20  DC-EDITA-CCYY.
   376                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6521.cbl
   377                 24  DC-EDITA-YEAR     PIC 99.
   378         16  DC-GREG-DATE-B-EDIT.
   379             20  DC-EDITB-MONTH        PIC 99.
   380             20  SLASHB-1              PIC X VALUE '/'.
   381             20  DC-EDITB-DAY          PIC 99.
   382             20  SLASHB-2              PIC X VALUE '/'.
   383             20  DC-EDITB-CCYY.
   384                 24  DC-EDITB-CENT     PIC 99.
   385                 24  DC-EDITB-YEAR     PIC 99.
   386         16  DC-GREG-DATE-CYMD         PIC 9(08).
   387         16  DC-GREG-DATE-CYMD-R REDEFINES
   388                              DC-GREG-DATE-CYMD.
   389             20  DC-CYMD-CEN           PIC 99.
   390             20  DC-CYMD-YEAR          PIC 99.
   391             20  DC-CYMD-MONTH         PIC 99.
   392             20  DC-CYMD-DAY           PIC 99.
   393         16  DC-GREG-DATE-MDCY         PIC 9(08).
   394         16  DC-GREG-DATE-MDCY-R REDEFINES
   395                              DC-GREG-DATE-MDCY.
   396             20  DC-MDCY-MONTH         PIC 99.
   397             20  DC-MDCY-DAY           PIC 99.
   398             20  DC-MDCY-CEN           PIC 99.
   399             20  DC-MDCY-YEAR          PIC 99.
   400    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   401        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   402    12  DC-EL310-DATE                  PIC X(21).
   403    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6521.cbl
   405*    COPY ELCATTR.
   406******************************************************************
   407*                                                                *
   408*                            ELCATTR.                            *
   409*                            VMOD=2.001                          *
   410*                                                                *
   411*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   412*                                                                *
   413*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   414*                                                                *
   415*                   POS 1   P=PROTECTED                          *
   416*                           U=UNPROTECTED                        *
   417*                           S=ASKIP                              *
   418*                   POS 2   A=ALPHA/NUMERIC                      *
   419*                           N=NUMERIC                            *
   420*                   POS 3   N=NORMAL                             *
   421*                           B=BRIGHT                             *
   422*                           D=DARK                               *
   423*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   424*                           OF=MODIFIED DATA TAG OFF             *
   425*                                                                *
   426*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   427******************************************************************
   428 01  ATTRIBUTE-LIST.
   429     12  AL-PABOF            PIC X       VALUE 'Y'.
   430     12  AL-PABON            PIC X       VALUE 'Z'.
   431     12  AL-PADOF            PIC X       VALUE '%'.
   432     12  AL-PADON            PIC X       VALUE '_'.
   433     12  AL-PANOF            PIC X       VALUE '-'.
   434     12  AL-PANON            PIC X       VALUE '/'.
   435     12  AL-SABOF            PIC X       VALUE '8'.
   436     12  AL-SABON            PIC X       VALUE '9'.
   437     12  AL-SADOF            PIC X       VALUE '@'.
   438     12  AL-SADON            PIC X       VALUE QUOTE.
   439     12  AL-SANOF            PIC X       VALUE '0'.
   440     12  AL-SANON            PIC X       VALUE '1'.
   441     12  AL-UABOF            PIC X       VALUE 'H'.
   442     12  AL-UABON            PIC X       VALUE 'I'.
   443     12  AL-UADOF            PIC X       VALUE '<'.
   444     12  AL-UADON            PIC X       VALUE '('.
   445     12  AL-UANOF            PIC X       VALUE ' '.
   446     12  AL-UANON            PIC X       VALUE 'A'.
   447     12  AL-UNBOF            PIC X       VALUE 'Q'.
   448     12  AL-UNBON            PIC X       VALUE 'R'.
   449     12  AL-UNDOF            PIC X       VALUE '*'.
   450     12  AL-UNDON            PIC X       VALUE ')'.
   451     12  AL-UNNOF            PIC X       VALUE '&'.
   452     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6521.cbl
   454*    COPY ELCEMIB.
   455******************************************************************
   456*                                                                *
   457*                                                                *
   458*                            ELCEMIB.                            *
   459*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   460*                            VMOD=2.005                          *
   461*                                                                *
   462*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   463*                                                                *
   464******************************************************************
   465 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   466     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   467     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   468     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   469     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   470     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   471     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   472     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   473     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   474     12  EMI-SWITCH1             PIC X        VALUE '1'.
   475         88  EMI-NO-ERRORS                    VALUE '1'.
   476         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   477         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   478     12  EMI-SWITCH2             PIC X        VALUE '1'.
   479         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   480     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   481         88  EMI-AREA1-EMPTY                  VALUE '1'.
   482         88  EMI-AREA1-FULL                   VALUE '2'.
   483     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   484         88  EMI-AREA2-EMPTY                  VALUE '1'.
   485         88  EMI-AREA2-FULL                   VALUE '2'.
   486     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   487         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   488         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   489         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   490         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   491         88  EMI-BYPASS-FATALS                VALUE 'X'.
   492     12  EMI-ERROR-LINES.
   493         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   494         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   495         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   496         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   497             20  EMI-ERR-CODES OCCURS 10 TIMES.
   498                 24  EMI-ERR-NUM         PIC X(4).
   499                 24  EMI-FILLER          PIC X.
   500                 24  EMI-SEV             PIC X.
   501                 24  FILLER              PIC X.
   502             20  FILLER                  PIC X(02).
   503     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   504         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   505             20  EMI-ERROR-NUMBER    PIC X(4).
   506             20  EMI-FILL            PIC X.
   507             20  EMI-SEVERITY        PIC X.
   508             20  FILLER              PIC X.
   509             20  EMI-ERROR-TEXT.
   510                 24  EMI-TEXT-VARIABLE   PIC X(10).
   511                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6521.cbl
   512     12  EMI-SEVERITY-SAVE           PIC X.
   513         88  EMI-NOTE                    VALUE 'N'.
   514         88  EMI-WARNING                 VALUE 'W'.
   515         88  EMI-FORCABLE                VALUE 'F'.
   516         88  EMI-FATAL                   VALUE 'X'.
   517     12  EMI-MESSAGE-FLAG            PIC X.
   518         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   519         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   520     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   521     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   522         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   523         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   524         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   525     12  FILLER                      PIC X(137)  VALUE SPACES.
   526     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   527     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   528     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   529     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6521.cbl
   531*    COPY ELCSCTM.
   532******************************************************************
   533*                                                                *
   534*                                                                *
   535*                            ELCSCTM                             *
   536*                            VMOD=2.001                          *
   537*                                                                *
   538*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   539*                                                                *
   540******************************************************************
   541 01  SECURITY-MESSAGE.
   542     12  FILLER                          PIC X(30)
   543            VALUE '** LOGIC SECURITY VIOLATION -'.
   544     12  SM-READ                         PIC X(6).
   545     12  FILLER                          PIC X(5)
   546            VALUE ' PGM='.
   547     12  SM-PGM                          PIC X(6).
   548     12  FILLER                          PIC X(5)
   549            VALUE ' OPR='.
   550     12  SM-PROCESSOR-ID                 PIC X(4).
   551     12  FILLER                          PIC X(6)
   552            VALUE ' TERM='.
   553     12  SM-TERMID                       PIC X(4).
   554     12  FILLER                          PIC XX   VALUE SPACE.
   555     12  SM-JUL-DATE                     PIC 9(5).
   556     12  FILLER                          PIC X    VALUE SPACE.
   557     12  SM-TIME                         PIC 99.99.
   558
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6521.cbl
   560*    COPY ELCSCRTY.
   561******************************************************************
   562*                                                                *
   563*                                                                *
   564*                            ELCSCRTY                            *
   565*                            VMOD=2.001                          *
   566*                                                                *
   567*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   568*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   569*        SAVED IN PI-SECURITY-ADDRESS.                           *
   570*                                                                *
   571******************************************************************
   572 01  SECURITY-CONTROL.
   573     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   574     12  FILLER                       PIC XX    VALUE 'SC'.
   575     12  SC-CREDIT-CODES.
   576         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   577             20  SC-CREDIT-DISPLAY    PIC X.
   578             20  SC-CREDIT-UPDATE     PIC X.
   579     12  SC-CLAIMS-CODES.
   580         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   581             20  SC-CLAIMS-DISPLAY    PIC X.
   582             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6521.cbl
   584*    COPY ELCINTF.
   585******************************************************************
   586*                                                                *
   587*                                                                *
   588*                            ELCINTF.                            *
   589*                            VMOD=2.017                          *
   590*                                                                *
   591*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   592*                                                                *
   593*       LENGTH = 1024                                            *
   594*                                                                *
   595******************************************************************
   596 01  PROGRAM-INTERFACE-BLOCK.
   597     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   598     12  PI-CALLING-PROGRAM              PIC X(8).
   599     12  PI-SAVED-PROGRAM-1              PIC X(8).
   600     12  PI-SAVED-PROGRAM-2              PIC X(8).
   601     12  PI-SAVED-PROGRAM-3              PIC X(8).
   602     12  PI-SAVED-PROGRAM-4              PIC X(8).
   603     12  PI-SAVED-PROGRAM-5              PIC X(8).
   604     12  PI-SAVED-PROGRAM-6              PIC X(8).
   605     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   606     12  PI-COMPANY-ID                   PIC XXX.
   607     12  PI-COMPANY-CD                   PIC X.
   608
   609     12  PI-COMPANY-PASSWORD             PIC X(8).
   610
   611     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   612
   613     12  PI-CONTROL-IN-PROGRESS.
   614         16  PI-CARRIER                  PIC X.
   615         16  PI-GROUPING                 PIC X(6).
   616         16  PI-STATE                    PIC XX.
   617         16  PI-ACCOUNT                  PIC X(10).
   618         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   619                                         PIC X(10).
   620         16  PI-CLAIM-CERT-GRP.
   621             20  PI-CLAIM-NO             PIC X(7).
   622             20  PI-CERT-NO.
   623                 25  PI-CERT-PRIME       PIC X(10).
   624                 25  PI-CERT-SFX         PIC X.
   625             20  PI-CERT-EFF-DT          PIC XX.
   626         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   627             20  PI-PLAN-CODE            PIC X(2).
   628             20  PI-REVISION-NUMBER      PIC X(3).
   629             20  PI-PLAN-EFF-DT          PIC X(2).
   630             20  PI-PLAN-EXP-DT          PIC X(2).
   631             20  FILLER                  PIC X(11).
   632         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   633             20  PI-OE-REFERENCE-1.
   634                 25  PI-OE-REF-1-PRIME   PIC X(18).
   635                 25  PI-OE-REF-1-SUFF    PIC XX.
   636
   637     12  PI-SESSION-IN-PROGRESS          PIC X.
   638         88  CLAIM-SESSION                   VALUE '1'.
   639         88  CREDIT-SESSION                  VALUE '2'.
   640         88  WARRANTY-SESSION                VALUE '3'.
   641         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6521.cbl
   642         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   643
   644
   645*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   646
   647     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   648     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   649
   650     12  PI-CREDIT-USER                  PIC X.
   651         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   652         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   653
   654     12  PI-CLAIM-USER                   PIC X.
   655         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   656         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   657
   658     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   659         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   660         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   661         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   662         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   663         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   664
   665     12  PI-PROCESSOR-ID                 PIC X(4).
   666
   667     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   668
   669     12  PI-MEMBER-CAPTION               PIC X(10).
   670
   671     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   672         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   673
   674     12  PI-LIFE-OVERRIDE-L1             PIC X.
   675     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   676     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   677     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   678
   679     12  PI-AH-OVERRIDE-L1               PIC X.
   680     12  PI-AH-OVERRIDE-L2               PIC XX.
   681     12  PI-AH-OVERRIDE-L6               PIC X(6).
   682     12  PI-AH-OVERRIDE-L12              PIC X(12).
   683
   684     12  PI-NEW-SYSTEM                   PIC X(2).
   685
   686     12  PI-PRIMARY-CERT-NO              PIC X(11).
   687     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   688         88  PI-USES-PAID-TO                 VALUE '1'.
   689     12  PI-CRDTCRD-SYSTEM.
   690         16  PI-CRDTCRD-USER             PIC X.
   691             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   692             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   693         16  PI-CC-MONTH-END-DT          PIC XX.
   694     12  PI-PROCESSOR-PRINTER            PIC X(4).
   695
   696     12  PI-OE-REFERENCE-2.
   697         16  PI-OE-REF-2-PRIME           PIC X(10).
   698         16  PI-OE-REF-2-SUFF            PIC X.
   699
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6521.cbl
   700     12  PI-REM-TRM-CALC-OPTION          PIC X.
   701
   702     12  PI-LANGUAGE-TYPE                PIC X.
   703             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   704             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   705             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   706
   707     12  PI-POLICY-LINKAGE-IND           PIC X.
   708         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   709         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   710                                                   LOW-VALUES.
   711
   712     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   713     12  PI-CLAIM-PW-SESSION             PIC X(1).
   714         88  PI-CLAIM-CREDIT                 VALUE '1'.
   715         88  PI-CLAIM-CONVEN                 VALUE '2'.
   716     12  FILLER                          PIC X(4).
   717
   718     12  PI-SYSTEM-LEVEL                 PIC X(145).
   719
   720     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   721         PI-SYSTEM-LEVEL.
   722
   723         16  PI-ENTRY-CODES.
   724             20  PI-ENTRY-CD-1           PIC X.
   725             20  PI-ENTRY-CD-2           PIC X.
   726
   727         16  PI-RETURN-CODES.
   728             20  PI-RETURN-CD-1          PIC X.
   729             20  PI-RETURN-CD-2          PIC X.
   730
   731         16  PI-UPDATE-STATUS-SAVE.
   732             20  PI-UPDATE-BY            PIC X(4).
   733             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   734
   735         16  PI-LOWER-CASE-LETTERS       PIC X.
   736             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   737
   738*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   739*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   740*            88  CARRIER-CLM-CNTL            VALUE '2'.
   741
   742         16  PI-CERT-ACCESS-CONTROL      PIC X.
   743             88  ST-ACCNT-CNTL               VALUE ' '.
   744             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   745             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   746             88  ACCNT-CNTL                  VALUE '3'.
   747             88  CARR-ACCNT-CNTL             VALUE '4'.
   748
   749         16  PI-PROCESSOR-CAP-LIST.
   750             20  PI-SYSTEM-CONTROLS.
   751                24 PI-SYSTEM-DISPLAY     PIC X.
   752                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   753                24 PI-SYSTEM-MODIFY      PIC X.
   754                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   755             20  FILLER                  PIC XX.
   756             20  PI-DISPLAY-CAP          PIC X.
   757                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6521.cbl
   758             20  PI-MODIFY-CAP           PIC X.
   759                 88  MODIFY-CAP              VALUE 'Y'.
   760             20  PI-MSG-AT-LOGON-CAP     PIC X.
   761                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   762             20  PI-FORCE-CAP            PIC X.
   763                 88  FORCE-CAP               VALUE 'Y'.
   764
   765         16  PI-PROGRAM-CONTROLS.
   766             20  PI-PGM-PRINT-OPT        PIC X.
   767             20  PI-PGM-FORMAT-OPT       PIC X.
   768             20  PI-PGM-PROCESS-OPT      PIC X.
   769             20  PI-PGM-TOTALS-OPT       PIC X.
   770
   771         16  PI-HELP-INTERFACE.
   772             20  PI-LAST-ERROR-NO        PIC X(4).
   773             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   774
   775         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   776             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   777
   778         16  PI-CR-CONTROL-IN-PROGRESS.
   779             20  PI-CR-CARRIER           PIC X.
   780             20  PI-CR-GROUPING          PIC X(6).
   781             20  PI-CR-STATE             PIC XX.
   782             20  PI-CR-ACCOUNT           PIC X(10).
   783             20  PI-CR-FIN-RESP          PIC X(10).
   784             20  PI-CR-TYPE              PIC X.
   785
   786         16  PI-CR-BATCH-NUMBER          PIC X(6).
   787
   788         16  PI-CR-MONTH-END-DT          PIC XX.
   789
   790         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   791             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   792             88  PI-ZERO-CARRIER             VALUE '1'.
   793             88  PI-ZERO-GROUPING            VALUE '2'.
   794             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   795
   796         16  PI-CARRIER-SECURITY         PIC X.
   797             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   798
   799         16  PI-ACCOUNT-SECURITY         PIC X(10).
   800             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   801             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   802
   803         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   804             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   805                                         INDEXED BY PI-ACCESS-NDX
   806                                         PIC X.
   807
   808         16  PI-GA-BILLING-CONTROL       PIC X.
   809             88  PI-GA-BILLING               VALUE '1'.
   810
   811         16  PI-MAIL-PROCESSING          PIC X.
   812             88  PI-MAIL-YES                 VALUE 'Y'.
   813
   814         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   815
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6521.cbl
   816         16  PI-AR-SYSTEM.
   817             20  PI-AR-PROCESSING-CNTL   PIC X.
   818                 88  PI-AR-PROCESSING        VALUE 'Y'.
   819             20  PI-AR-SUMMARY-CODE      PIC X(6).
   820             20  PI-AR-MONTH-END-DT      PIC XX.
   821
   822         16  PI-MP-SYSTEM.
   823             20  PI-MORTGAGE-USER            PIC X.
   824                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   825                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   826             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   827                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   828                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   829                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   830                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   831                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   832             20  PI-MP-MONTH-END-DT          PIC XX.
   833             20  PI-MP-REFERENCE-NO.
   834                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   835                 24  PI-MP-REFERENCE-SFX     PIC XX.
   836
   837         16  PI-LABEL-CONTROL            PIC X(01).
   838             88  PI-CREATE-LABELS                    VALUE 'Y'.
   839             88  PI-BYPASS-LABELS                    VALUE 'N'.
   840
   841         16  PI-BILL-GROUPING-CODE       PIC X(01).
   842             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   843
   844         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   845             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   846             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   847
   848         16  FILLER                      PIC X(14).
   849
   850     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   851******************************************************************
   852     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
   853         16  PI-MAINT                PIC  X.
   854         16  PI-CHECK-TYPE           PIC  X.
   855         16  PI-CHECK-CARRY-BAL      PIC  X.
   856         16  PI-FIRST-TIME-SW        PIC  X.
   857             88  FIRST-TIME                  VALUE 'Y'.
   858         16  PI-ERCOMP-EOF-SW        PIC  X.
   859             88  ERCOMP-EOF                  VALUE 'Y'.
   860         16  PI-SAVE-PHONE           PIC  X(10).
   861         16  PI-SAVE-PHONE-RED REDEFINES PI-SAVE-PHONE  PIC 9(10).
   862         16  PI-ERC-END-BAL          PIC S9(9)V99       COMP-3.
   863         16  PI-ERCOMP-KEY.
   864             20  PI-ERC-GROUP-CD     PIC  X.
   865             20  PI-ERC-CARRIER      PIC  X.
   866             20  PI-ERC-GROUP        PIC  X(6).
   867             20  PI-ERC-RESP         PIC  X(10).
   868             20  PI-ERC-ACCT         PIC  X(10).
   869             20  PI-ERC-TYPE         PIC  X.
   870         16  PI-SAVE-ERCOMP-KEY      PIC  X(29).
   871         16  PI-BANK-TRANSIT-NUMBER.
   872             20  PI-BANK-COMPANY-CD  PIC X.
   873             20  PI-FEDERAL-NUMBER   PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6521.cbl
   874             20  PI-BANK-NUMBER      PIC X(4).
   875         16  PI-BANK-ACCOUNT-NO      PIC X(17).
   876         16  PI-BANK-ACTION-CODE     PIC X.
   877         16  PI-ERCOBI-KEY.
   878             20  PI-ERCOBI-COMPANY-CD PIC X.
   879             20  PI-ERCOBI-STMT-OWNER PIC X(4).
   880             20  PI-ERCOBI-RGID      PIC X(12).
   881         16  PI-SAVE-ERCOBI-KEY      PIC X(17).
   882         16  FILLER                  PIC  X(500).
   883
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6521.cbl
   885*    COPY ELCAID.
   886******************************************************************
   887*                                                                *
   888*                            ELCAID.                             *
   889*                            VMOD=2.001                          *
   890*                                                                *
   891*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   892*                                                                *
   893*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   894*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   895******************************************************************
   896
   897 01  DFHAID.
   898   02  DFHNULL   PIC  X  VALUE  ' '.
   899   02  DFHENTER  PIC  X  VALUE  QUOTE.
   900   02  DFHCLEAR  PIC  X  VALUE  '_'.
   901   02  DFHPEN    PIC  X  VALUE  '='.
   902   02  DFHOPID   PIC  X  VALUE  'W'.
   903   02  DFHPA1    PIC  X  VALUE  '%'.
   904   02  DFHPA2    PIC  X  VALUE  '>'.
   905   02  DFHPA3    PIC  X  VALUE  ','.
   906   02  DFHPF1    PIC  X  VALUE  '1'.
   907   02  DFHPF2    PIC  X  VALUE  '2'.
   908   02  DFHPF3    PIC  X  VALUE  '3'.
   909   02  DFHPF4    PIC  X  VALUE  '4'.
   910   02  DFHPF5    PIC  X  VALUE  '5'.
   911   02  DFHPF6    PIC  X  VALUE  '6'.
   912   02  DFHPF7    PIC  X  VALUE  '7'.
   913   02  DFHPF8    PIC  X  VALUE  '8'.
   914   02  DFHPF9    PIC  X  VALUE  '9'.
   915   02  DFHPF10   PIC  X  VALUE  ':'.
   916   02  DFHPF11   PIC  X  VALUE  '#'.
   917   02  DFHPF12   PIC  X  VALUE  '@'.
   918   02  DFHPF13   PIC  X  VALUE  'A'.
   919   02  DFHPF14   PIC  X  VALUE  'B'.
   920   02  DFHPF15   PIC  X  VALUE  'C'.
   921   02  DFHPF16   PIC  X  VALUE  'D'.
   922   02  DFHPF17   PIC  X  VALUE  'E'.
   923   02  DFHPF18   PIC  X  VALUE  'F'.
   924   02  DFHPF19   PIC  X  VALUE  'G'.
   925   02  DFHPF20   PIC  X  VALUE  'H'.
   926   02  DFHPF21   PIC  X  VALUE  'I'.
   927*00039    02  DFHPF22   PIC  X  VALUE  ''.
   928   02  DFHPF22   PIC  X  VALUE  '['.
   929   02  DFHPF23   PIC  X  VALUE  '.'.
   930   02  DFHPF24   PIC  X  VALUE  '<'.
   931   02  DFHMSRE   PIC  X  VALUE  'X'.
   932   02  DFHSTRF   PIC  X  VALUE  'h'.
   933   02  DFHTRIG   PIC  X  VALUE  '"'.
   934 01  FILLER    REDEFINES DFHAID.
   935     12  FILLER                      PIC X(8).
   936     12  PF-VALUES                   PIC X       OCCURS 2.
   937
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6521.cbl
   939*    COPY EL6521S.
   940 01  EL6521AI.
   941     05  FILLER            PIC  X(0012).
   942*    -------------------------------
   943     05  DATEL PIC S9(0004) COMP.
   944     05  DATEF PIC  X(0001).
   945     05  FILLER REDEFINES DATEF.
   946         10  DATEA PIC  X(0001).
   947     05  DATEI PIC  X(0008).
   948*    -------------------------------
   949     05  TIMEL PIC S9(0004) COMP.
   950     05  TIMEF PIC  X(0001).
   951     05  FILLER REDEFINES TIMEF.
   952         10  TIMEA PIC  X(0001).
   953     05  TIMEI PIC  X(0005).
   954*    -------------------------------
   955     05  CMPNYIDL PIC S9(0004) COMP.
   956     05  CMPNYIDF PIC  X(0001).
   957     05  FILLER REDEFINES CMPNYIDF.
   958         10  CMPNYIDA PIC  X(0001).
   959     05  CMPNYIDI PIC  X(0003).
   960*    -------------------------------
   961     05  USERIDL PIC S9(0004) COMP.
   962     05  USERIDF PIC  X(0001).
   963     05  FILLER REDEFINES USERIDF.
   964         10  USERIDA PIC  X(0001).
   965     05  USERIDI PIC  X(0004).
   966*    -------------------------------
   967     05  MAINTYPL PIC S9(0004) COMP.
   968     05  MAINTYPF PIC  X(0001).
   969     05  FILLER REDEFINES MAINTYPF.
   970         10  MAINTYPA PIC  X(0001).
   971     05  MAINTYPI PIC  X(0001).
   972*    -------------------------------
   973     05  CARRIERL PIC S9(0004) COMP.
   974     05  CARRIERF PIC  X(0001).
   975     05  FILLER REDEFINES CARRIERF.
   976         10  CARRIERA PIC  X(0001).
   977     05  CARRIERI PIC  X(0001).
   978*    -------------------------------
   979     05  GROUPL PIC S9(0004) COMP.
   980     05  GROUPF PIC  X(0001).
   981     05  FILLER REDEFINES GROUPF.
   982         10  GROUPA PIC  X(0001).
   983     05  GROUPI PIC  X(0006).
   984*    -------------------------------
   985     05  TYPEL PIC S9(0004) COMP.
   986     05  TYPEF PIC  X(0001).
   987     05  FILLER REDEFINES TYPEF.
   988         10  TYPEA PIC  X(0001).
   989     05  TYPEI PIC  X(0001).
   990*    -------------------------------
   991     05  FINRESPL PIC S9(0004) COMP.
   992     05  FINRESPF PIC  X(0001).
   993     05  FILLER REDEFINES FINRESPF.
   994         10  FINRESPA PIC  X(0001).
   995     05  FINRESPI PIC  X(0010).
   996*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6521.cbl
   997     05  COACCTL PIC S9(0004) COMP.
   998     05  COACCTF PIC  X(0001).
   999     05  FILLER REDEFINES COACCTF.
  1000         10  COACCTA PIC  X(0001).
  1001     05  COACCTI PIC  X(0010).
  1002*    -------------------------------
  1003     05  EFFDTL PIC S9(0004) COMP.
  1004     05  EFFDTF PIC  X(0001).
  1005     05  FILLER REDEFINES EFFDTF.
  1006         10  EFFDTA PIC  X(0001).
  1007     05  EFFDTI PIC  X(0008).
  1008*    -------------------------------
  1009     05  TRMDTL PIC S9(0004) COMP.
  1010     05  TRMDTF PIC  X(0001).
  1011     05  FILLER REDEFINES TRMDTF.
  1012         10  TRMDTA PIC  X(0001).
  1013     05  TRMDTI PIC  X(0008).
  1014*    -------------------------------
  1015     05  STATL PIC S9(0004) COMP.
  1016     05  STATF PIC  X(0001).
  1017     05  FILLER REDEFINES STATF.
  1018         10  STATA PIC  X(0001).
  1019     05  STATI PIC  X(0001).
  1020*    -------------------------------
  1021     05  WTHLDL PIC S9(0004) COMP.
  1022     05  WTHLDF PIC  X(0001).
  1023     05  FILLER REDEFINES WTHLDF.
  1024         10  WTHLDA PIC  X(0001).
  1025     05  WTHLDI PIC  S99V9999.
  1026*    -------------------------------
  1027     05  GADDL PIC S9(0004) COMP.
  1028     05  GADDF PIC  X(0001).
  1029     05  FILLER REDEFINES GADDF.
  1030         10  GADDA PIC  X(0001).
  1031     05  GADDI PIC  X(0001).
  1032*    -------------------------------
  1033     05  APCHKL PIC S9(0004) COMP.
  1034     05  APCHKF PIC  X(0001).
  1035     05  FILLER REDEFINES APCHKF.
  1036         10  APCHKA PIC  X(0001).
  1037     05  APCHKI PIC  X(0001).
  1038*    -------------------------------
  1039     05  MELSWL PIC S9(0004) COMP.
  1040     05  MELSWF PIC  X(0001).
  1041     05  FILLER REDEFINES MELSWF.
  1042         10  MELSWA PIC  X(0001).
  1043     05  MELSWI PIC  X(0001).
  1044*    -------------------------------
  1045     05  MDACTL PIC S9(0004) COMP.
  1046     05  MDACTF PIC  X(0001).
  1047     05  FILLER REDEFINES MDACTF.
  1048         10  MDACTA PIC  X(0001).
  1049     05  MDACTI PIC  X(0010).
  1050*    -------------------------------
  1051     05  MDDIVL PIC S9(0004) COMP.
  1052     05  MDDIVF PIC  X(0001).
  1053     05  FILLER REDEFINES MDDIVF.
  1054         10  MDDIVA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6521.cbl
  1055     05  MDDIVI PIC  X(0002).
  1056*    -------------------------------
  1057     05  MDCNTRL PIC S9(0004) COMP.
  1058     05  MDCNTRF PIC  X(0001).
  1059     05  FILLER REDEFINES MDCNTRF.
  1060         10  MDCNTRA PIC  X(0001).
  1061     05  MDCNTRI PIC  X(0004).
  1062*    -------------------------------
  1063     05  MDLOBL PIC S9(0004) COMP.
  1064     05  MDLOBF PIC  X(0001).
  1065     05  FILLER REDEFINES MDLOBF.
  1066         10  MDLOBA PIC  X(0001).
  1067     05  MDLOBI PIC  X(0006).
  1068*    -------------------------------
  1069     05  MDSTL PIC S9(0004) COMP.
  1070     05  MDSTF PIC  X(0001).
  1071     05  FILLER REDEFINES MDSTF.
  1072         10  MDSTA PIC  X(0001).
  1073     05  MDSTI PIC  X(0002).
  1074*    -------------------------------
  1075     05  MDAMTL PIC S9(0004) COMP.
  1076     05  MDAMTF PIC  X(0001).
  1077     05  FILLER REDEFINES MDAMTF.
  1078         10  MDAMTA PIC  X(0001).
  1079     05  MDAMTI PIC  S999999V99.
  1080*    -------------------------------
  1081     05  DELTOL PIC S9(0004) COMP.
  1082     05  DELTOF PIC  X(0001).
  1083     05  FILLER REDEFINES DELTOF.
  1084         10  DELTOA PIC  X(0001).
  1085     05  DELTOI PIC  X(0004).
  1086*    -------------------------------
  1087     05  RGIDL PIC S9(0004) COMP.
  1088     05  RGIDF PIC  X(0001).
  1089     05  FILLER REDEFINES RGIDF.
  1090         10  RGIDA PIC  X(0001).
  1091     05  RGIDI PIC  X(0012).
  1092*    -------------------------------
  1093     05  COMM1L PIC S9(0004) COMP.
  1094     05  COMM1F PIC  X(0001).
  1095     05  FILLER REDEFINES COMM1F.
  1096         10  COMM1A PIC  X(0001).
  1097     05  COMM1I PIC  X(0040).
  1098*    -------------------------------
  1099     05  COMM2L PIC S9(0004) COMP.
  1100     05  COMM2F PIC  X(0001).
  1101     05  FILLER REDEFINES COMM2F.
  1102         10  COMM2A PIC  X(0001).
  1103     05  COMM2I PIC  X(0040).
  1104*    -------------------------------
  1105     05  COMM3L PIC S9(0004) COMP.
  1106     05  COMM3F PIC  X(0001).
  1107     05  FILLER REDEFINES COMM3F.
  1108         10  COMM3A PIC  X(0001).
  1109     05  COMM3I PIC  X(0040).
  1110*    -------------------------------
  1111     05  COMM4L PIC S9(0004) COMP.
  1112     05  COMM4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6521.cbl
  1113     05  FILLER REDEFINES COMM4F.
  1114         10  COMM4A PIC  X(0001).
  1115     05  COMM4I PIC  X(0040).
  1116*    -------------------------------
  1117     05  BKLITL PIC S9(0004) COMP.
  1118     05  BKLITF PIC  X(0001).
  1119     05  FILLER REDEFINES BKLITF.
  1120         10  BKLITA PIC  X(0001).
  1121     05  BKLITI PIC  X(0023).
  1122*    -------------------------------
  1123     05  TRNSIT1L PIC S9(0004) COMP.
  1124     05  TRNSIT1F PIC  X(0001).
  1125     05  FILLER REDEFINES TRNSIT1F.
  1126         10  TRNSIT1A PIC  X(0001).
  1127     05  TRNSIT1I PIC  X(0004).
  1128*    -------------------------------
  1129     05  TRDASHL PIC S9(0004) COMP.
  1130     05  TRDASHF PIC  X(0001).
  1131     05  FILLER REDEFINES TRDASHF.
  1132         10  TRDASHA PIC  X(0001).
  1133     05  TRDASHI PIC  X(0001).
  1134*    -------------------------------
  1135     05  TRNSIT2L PIC S9(0004) COMP.
  1136     05  TRNSIT2F PIC  X(0001).
  1137     05  FILLER REDEFINES TRNSIT2F.
  1138         10  TRNSIT2A PIC  X(0001).
  1139     05  TRNSIT2I PIC  X(0004).
  1140*    -------------------------------
  1141     05  BKDESCL PIC S9(0004) COMP.
  1142     05  BKDESCF PIC  X(0001).
  1143     05  FILLER REDEFINES BKDESCF.
  1144         10  BKDESCA PIC  X(0001).
  1145     05  BKDESCI PIC  X(0023).
  1146*    -------------------------------
  1147     05  BKACCTL PIC S9(0004) COMP.
  1148     05  BKACCTF PIC  X(0001).
  1149     05  FILLER REDEFINES BKACCTF.
  1150         10  BKACCTA PIC  X(0001).
  1151     05  BKACCTI PIC  X(0017).
  1152*    -------------------------------
  1153     05  ACTLITL PIC S9(0004) COMP.
  1154     05  ACTLITF PIC  X(0001).
  1155     05  FILLER REDEFINES ACTLITF.
  1156         10  ACTLITA PIC  X(0001).
  1157     05  ACTLITI PIC  X(0023).
  1158*    -------------------------------
  1159     05  ACTCDL PIC S9(0004) COMP.
  1160     05  ACTCDF PIC  X(0001).
  1161     05  FILLER REDEFINES ACTCDF.
  1162         10  ACTCDA PIC  X(0001).
  1163     05  ACTCDI PIC  X(0001).
  1164*    -------------------------------
  1165     05  CRSLITL PIC S9(0004) COMP.
  1166     05  CRSLITF PIC  X(0001).
  1167     05  FILLER REDEFINES CRSLITF.
  1168         10  CRSLITA PIC  X(0001).
  1169     05  CRSLITI PIC  X(0017).
  1170*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6521.cbl
  1171     05  CRSTATL PIC S9(0004) COMP.
  1172     05  CRSTATF PIC  X(0001).
  1173     05  FILLER REDEFINES CRSTATF.
  1174         10  CRSTATA PIC  X(0001).
  1175     05  CRSTATI PIC  X(0010).
  1176*    -------------------------------
  1177     05  ERRMSG1L PIC S9(0004) COMP.
  1178     05  ERRMSG1F PIC  X(0001).
  1179     05  FILLER REDEFINES ERRMSG1F.
  1180         10  ERRMSG1A PIC  X(0001).
  1181     05  ERRMSG1I PIC  X(0071).
  1182*    -------------------------------
  1183     05  ERRMSG2L PIC S9(0004) COMP.
  1184     05  ERRMSG2F PIC  X(0001).
  1185     05  FILLER REDEFINES ERRMSG2F.
  1186         10  ERRMSG2A PIC  X(0001).
  1187     05  ERRMSG2I PIC  X(0071).
  1188*    -------------------------------
  1189     05  PFENTERL PIC S9(0004) COMP.
  1190     05  PFENTERF PIC  X(0001).
  1191     05  FILLER REDEFINES PFENTERF.
  1192         10  PFENTERA PIC  X(0001).
  1193     05  PFENTERI PIC  99.
  1194*    -------------------------------
  1195     05  ACHPF1L PIC S9(0004) COMP.
  1196     05  ACHPF1F PIC  X(0001).
  1197     05  FILLER REDEFINES ACHPF1F.
  1198         10  ACHPF1A PIC  X(0001).
  1199     05  ACHPF1I PIC  X(0015).
  1200 01  EL6521AO REDEFINES EL6521AI.
  1201     05  FILLER            PIC  X(0012).
  1202*    -------------------------------
  1203     05  FILLER            PIC  X(0003).
  1204     05  DATEO PIC  X(0008).
  1205*    -------------------------------
  1206     05  FILLER            PIC  X(0003).
  1207     05  TIMEO PIC  99.99.
  1208*    -------------------------------
  1209     05  FILLER            PIC  X(0003).
  1210     05  CMPNYIDO PIC  X(0003).
  1211*    -------------------------------
  1212     05  FILLER            PIC  X(0003).
  1213     05  USERIDO PIC  X(0004).
  1214*    -------------------------------
  1215     05  FILLER            PIC  X(0003).
  1216     05  MAINTYPO PIC  X(0001).
  1217*    -------------------------------
  1218     05  FILLER            PIC  X(0003).
  1219     05  CARRIERO PIC  X(0001).
  1220*    -------------------------------
  1221     05  FILLER            PIC  X(0003).
  1222     05  GROUPO PIC  X(0006).
  1223*    -------------------------------
  1224     05  FILLER            PIC  X(0003).
  1225     05  TYPEO PIC  X(0001).
  1226*    -------------------------------
  1227     05  FILLER            PIC  X(0003).
  1228     05  FINRESPO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6521.cbl
  1229*    -------------------------------
  1230     05  FILLER            PIC  X(0003).
  1231     05  COACCTO PIC  X(0010).
  1232*    -------------------------------
  1233     05  FILLER            PIC  X(0003).
  1234     05  EFFDTO PIC  X(0008).
  1235*    -------------------------------
  1236     05  FILLER            PIC  X(0003).
  1237     05  TRMDTO PIC  X(0008).
  1238*    -------------------------------
  1239     05  FILLER            PIC  X(0003).
  1240     05  STATO PIC  X(0001).
  1241*    -------------------------------
  1242     05  FILLER            PIC  X(0003).
  1243     05  WTHLDO PIC  Z.9999.
  1244*    -------------------------------
  1245     05  FILLER            PIC  X(0003).
  1246     05  GADDO PIC  X(0001).
  1247*    -------------------------------
  1248     05  FILLER            PIC  X(0003).
  1249     05  APCHKO PIC  X(0001).
  1250*    -------------------------------
  1251     05  FILLER            PIC  X(0003).
  1252     05  MELSWO PIC  X(0001).
  1253*    -------------------------------
  1254     05  FILLER            PIC  X(0003).
  1255     05  MDACTO PIC  X(0010).
  1256*    -------------------------------
  1257     05  FILLER            PIC  X(0003).
  1258     05  MDDIVO PIC  X(0002).
  1259*    -------------------------------
  1260     05  FILLER            PIC  X(0003).
  1261     05  MDCNTRO PIC  X(0004).
  1262*    -------------------------------
  1263     05  FILLER            PIC  X(0003).
  1264     05  MDLOBO PIC  X(0006).
  1265*    -------------------------------
  1266     05  FILLER            PIC  X(0003).
  1267     05  MDSTO PIC  X(0002).
  1268*    -------------------------------
  1269     05  FILLER            PIC  X(0003).
  1270     05  MDAMTO PIC  ZZZZZ.99.
  1271*    -------------------------------
  1272     05  FILLER            PIC  X(0003).
  1273     05  DELTOO PIC  X(0004).
  1274*    -------------------------------
  1275     05  FILLER            PIC  X(0003).
  1276     05  RGIDO PIC  X(0012).
  1277*    -------------------------------
  1278     05  FILLER            PIC  X(0003).
  1279     05  COMM1O PIC  X(0040).
  1280*    -------------------------------
  1281     05  FILLER            PIC  X(0003).
  1282     05  COMM2O PIC  X(0040).
  1283*    -------------------------------
  1284     05  FILLER            PIC  X(0003).
  1285     05  COMM3O PIC  X(0040).
  1286*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6521.cbl
  1287     05  FILLER            PIC  X(0003).
  1288     05  COMM4O PIC  X(0040).
  1289*    -------------------------------
  1290     05  FILLER            PIC  X(0003).
  1291     05  BKLITO PIC  X(0023).
  1292*    -------------------------------
  1293     05  FILLER            PIC  X(0003).
  1294     05  TRNSIT1O PIC  X(0004).
  1295*    -------------------------------
  1296     05  FILLER            PIC  X(0003).
  1297     05  TRDASHO PIC  X(0001).
  1298*    -------------------------------
  1299     05  FILLER            PIC  X(0003).
  1300     05  TRNSIT2O PIC  X(0004).
  1301*    -------------------------------
  1302     05  FILLER            PIC  X(0003).
  1303     05  BKDESCO PIC  X(0023).
  1304*    -------------------------------
  1305     05  FILLER            PIC  X(0003).
  1306     05  BKACCTO PIC  X(0017).
  1307*    -------------------------------
  1308     05  FILLER            PIC  X(0003).
  1309     05  ACTLITO PIC  X(0023).
  1310*    -------------------------------
  1311     05  FILLER            PIC  X(0003).
  1312     05  ACTCDO PIC  X(0001).
  1313*    -------------------------------
  1314     05  FILLER            PIC  X(0003).
  1315     05  CRSLITO PIC  X(0017).
  1316*    -------------------------------
  1317     05  FILLER            PIC  X(0003).
  1318     05  CRSTATO PIC  X(0010).
  1319*    -------------------------------
  1320     05  FILLER            PIC  X(0003).
  1321     05  ERRMSG1O PIC  X(0071).
  1322*    -------------------------------
  1323     05  FILLER            PIC  X(0003).
  1324     05  ERRMSG2O PIC  X(0071).
  1325*    -------------------------------
  1326     05  FILLER            PIC  X(0003).
  1327     05  PFENTERO PIC  99.
  1328*    -------------------------------
  1329     05  FILLER            PIC  X(0003).
  1330     05  ACHPF1O PIC  X(0015).
  1331*    -------------------------------
  1332
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6521.cbl
  1334****************************************************************
  1335*
  1336* Copyright (c) 2007 by Clerity Solutions, Inc.
  1337* All rights reserved.
  1338*
  1339****************************************************************
  1340 01  DFHEIV.
  1341   02  DFHEIV0               PIC X(35).
  1342   02  DFHEIV1               PIC X(08).
  1343   02  DFHEIV2               PIC X(08).
  1344   02  DFHEIV3               PIC X(08).
  1345   02  DFHEIV4               PIC X(06).
  1346   02  DFHEIV5               PIC X(04).
  1347   02  DFHEIV6               PIC X(04).
  1348   02  DFHEIV7               PIC X(02).
  1349   02  DFHEIV8               PIC X(02).
  1350   02  DFHEIV9               PIC X(01).
  1351   02  DFHEIV10              PIC S9(7) COMP-3.
  1352   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1353   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1354   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1355   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1356   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1357   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1358   02  DFHEIV17              PIC X(04).
  1359   02  DFHEIV18              PIC X(04).
  1360   02  DFHEIV19              PIC X(04).
  1361   02  DFHEIV20              USAGE IS POINTER.
  1362   02  DFHEIV21              USAGE IS POINTER.
  1363   02  DFHEIV22              USAGE IS POINTER.
  1364   02  DFHEIV23              USAGE IS POINTER.
  1365   02  DFHEIV24              USAGE IS POINTER.
  1366   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1367   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1368   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1369   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1370   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1371   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1372   02  FILLER                PIC X(02).
  1373   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1374   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1375   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1376   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1377   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1378 LINKAGE  SECTION.
  1379*****************************************************************
  1380*                                                               *
  1381* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1382* All rights reserved.                                          *
  1383*                                                               *
  1384*****************************************************************
  1385 01  dfheiblk.
  1386     02  eibtime          pic s9(7) comp-3.
  1387     02  eibdate          pic s9(7) comp-3.
  1388     02  eibtrnid         pic x(4).
  1389     02  eibtaskn         pic s9(7) comp-3.
  1390     02  eibtrmid         pic x(4).
  1391     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6521.cbl
  1392     02  eibcposn         pic s9(4) comp.
  1393     02  eibcalen         pic s9(4) comp.
  1394     02  eibaid           pic x(1).
  1395     02  eibfiller1       pic x(1).
  1396     02  eibfn            pic x(2).
  1397     02  eibfiller2       pic x(2).
  1398     02  eibrcode         pic x(6).
  1399     02  eibfiller3       pic x(2).
  1400     02  eibds            pic x(8).
  1401     02  eibreqid         pic x(8).
  1402     02  eibrsrce         pic x(8).
  1403     02  eibsync          pic x(1).
  1404     02  eibfree          pic x(1).
  1405     02  eibrecv          pic x(1).
  1406     02  eibsend          pic x(1).
  1407     02  eibatt           pic x(1).
  1408     02  eibeoc           pic x(1).
  1409     02  eibfmh           pic x(1).
  1410     02  eibcompl         pic x(1).
  1411     02  eibsig           pic x(1).
  1412     02  eibconf          pic x(1).
  1413     02  eiberr           pic x(1).
  1414     02  eibrldbk         pic x(1).
  1415     02  eiberrcd         pic x(4).
  1416     02  eibsynrb         pic x(1).
  1417     02  eibnodat         pic x(1).
  1418     02  eibfiller5       pic x(2).
  1419     02  eibresp          pic 9(09) comp.
  1420     02  eibresp2         pic 9(09) comp.
  1421     02  dfheigdj         pic s9(4) comp.
  1422     02  dfheigdk         pic s9(4) comp.
  1423 01  DFHCOMMAREA                     PIC X(1024).
  1424
  1425*    COPY ERCCOMP.
  1426******************************************************************
  1427*                                                                *
  1428*                                                                *
  1429*                            ERCCOMP                             *
  1430*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1431*                            VMOD=2.019                          *
  1432*                                                                *
  1433*   ONLINE CREDIT SYSTEM                                         *
  1434*                                                                *
  1435*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1436*                                                                *
  1437*   FILE TYPE = VSAM,KSDS                                        *
  1438*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1439*                                                                *
  1440*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1441*       ALTERNATE PATH = NONE                                    *
  1442*                                                                *
  1443*   LOG = NO                                                     *
  1444*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1445*                                                                *
  1446******************************************************************
  1447*                   C H A N G E   L O G
  1448*
  1449* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6521.cbl
  1450*-----------------------------------------------------------------
  1451*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1452* EFFECTIVE    NUMBER
  1453*-----------------------------------------------------------------
  1454* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1455* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1456* 092205    2005050300006  PEMA  ADD LEASE FEE
  1457* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1458* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1459* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1460* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1461* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1462******************************************************************
  1463
  1464 01  COMPENSATION-MASTER.
  1465     12  CO-RECORD-ID                          PIC XX.
  1466         88  VALID-CO-ID                          VALUE 'CO'.
  1467
  1468     12  CO-CONTROL-PRIMARY.
  1469         16  CO-COMPANY-CD                     PIC X.
  1470         16  CO-CONTROL.
  1471             20  CO-CTL-1.
  1472                 24  CO-CARR-GROUP.
  1473                     28  CO-CARRIER            PIC X.
  1474                     28  CO-GROUPING.
  1475                         32  CO-GROUP-PREFIX   PIC XXX.
  1476                         32  CO-GROUP-PRIME    PIC XXX.
  1477                 24  CO-RESP-NO.
  1478                     28  CO-RESP-PREFIX        PIC X(4).
  1479                     28  CO-RESP-PRIME         PIC X(6).
  1480             20  CO-CTL-2.
  1481                 24  CO-ACCOUNT.
  1482                     28  CO-ACCT-PREFIX        PIC X(4).
  1483                     28  CO-ACCT-PRIME         PIC X(6).
  1484         16  CO-TYPE                           PIC X.
  1485             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1486             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1487             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1488
  1489     12  CO-MAINT-INFORMATION.
  1490         16  CO-LAST-MAINT-DT                  PIC XX.
  1491         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1492         16  CO-LAST-MAINT-USER                PIC X(4).
  1493     12  FILLER                                PIC XX.
  1494     12  CO-STMT-TYPE                          PIC XXX.
  1495     12  CO-COMP-TYPE                          PIC X.
  1496         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1497     12  CO-STMT-OWNER                         PIC X(4).
  1498     12  CO-BALANCE-CONTROL                    PIC X.
  1499         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1500         88  CO-NO-BALANCE                        VALUE 'N'.
  1501
  1502     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1503         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1504         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1505         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1506
  1507     12  CO-INTERNAL-CONTROL-2                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6521.cbl
  1508         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1509         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1510
  1511     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1512     12  CO-GA-DIRECT-DEP                      PIC X.
  1513     12  CO-FUTURE-SPACE                       PIC X.
  1514         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1515
  1516     12  CO-ACCT-NAME                          PIC X(30).
  1517     12  CO-MAIL-NAME                          PIC X(30).
  1518     12  CO-ADDR-1                             PIC X(30).
  1519     12  CO-ADDR-2                             PIC X(30).
  1520     12  CO-ADDR-3.
  1521         16  CO-ADDR-CITY                      PIC X(27).
  1522         16  CO-ADDR-STATE                     PIC XX.
  1523     12  CO-CSO-1099                           PIC X.
  1524     12  CO-ZIP.
  1525         16  CO-ZIP-PRIME.
  1526             20  CO-ZIP-PRI-1ST                PIC X.
  1527                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1528             20  FILLER                        PIC X(4).
  1529         16  CO-ZIP-PLUS4                      PIC X(4).
  1530     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1531         16  CO-CAN-POSTAL-1                   PIC XXX.
  1532         16  CO-CAN-POSTAL-2                   PIC XXX.
  1533         16  FILLER                            PIC XXX.
  1534     12  CO-SOC-SEC                            PIC X(13).
  1535     12  CO-TELEPHONE.
  1536         16  CO-AREA-CODE                      PIC XXX.
  1537         16  CO-PREFIX                         PIC XXX.
  1538         16  CO-PHONE                          PIC X(4).
  1539
  1540     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1541
  1542     12  CO-AR-BAL-LEVEL                       PIC X.
  1543         88  CO-AR-REF-LVL                        VALUE '1'.
  1544         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1545         88  CO-AR-BILL-LVL                       VALUE '2'.
  1546         88  CO-AR-AGT-LVL                        VALUE '3'.
  1547         88  CO-AR-FR-LVL                         VALUE '4'.
  1548
  1549     12  CO-AR-NORMAL-PRINT                    PIC X.
  1550         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1551         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1552
  1553     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1554
  1555     12  CO-AR-REPORTING                       PIC X.
  1556         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1557         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1558
  1559     12  CO-AR-PULL-CHECK                      PIC X.
  1560         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1561         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1562
  1563     12  CO-AR-BALANCE-PRINT                   PIC X.
  1564         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1565
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6521.cbl
  1566     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1567         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1568         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1569         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1570
  1571     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1572
  1573     12  CO-USER-CODE                          PIC X.
  1574     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1575
  1576******************************************************************
  1577*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1578*    THE LAST MONTH END RUN.
  1579******************************************************************
  1580
  1581     12  CO-LAST-ACTIVITY-DATE.
  1582         16  CO-ACT-YEAR                       PIC 99.
  1583         16  CO-ACT-MONTH                      PIC 99.
  1584         16  CO-ACT-DAY                        PIC 99.
  1585
  1586     12  CO-LAST-STMT-DT.
  1587         16  CO-LAST-STMT-YEAR                 PIC 99.
  1588         16  CO-LAST-STMT-MONTH                PIC 99.
  1589         16  CO-LAST-STMT-DAY                  PIC 99.
  1590
  1591     12  CO-MO-END-TOTALS.
  1592         16  CO-MONTHLY-TOTALS.
  1593             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1594             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1595             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1596             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1597             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1598
  1599         16  CO-AGING-TOTALS.
  1600             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1601             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1602             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1603             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1604
  1605         16  CO-YTD-TOTALS.
  1606             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1607             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1608
  1609         16  CO-OVER-UNDER-TOTALS.
  1610             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1611             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1612
  1613     12  CO-MISCELLANEOUS-TOTALS.
  1614         16  CO-FICA-TOTALS.
  1615             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1616             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1617
  1618         16  CO-CLAIM-TOTALS.
  1619             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1620             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1621
  1622******************************************************************
  1623*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6521.cbl
  1624*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1625******************************************************************
  1626
  1627     12  CO-CURRENT-TOTALS.
  1628         16  CO-CURRENT-LAST-STMT-DT.
  1629             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1630             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1631             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1632
  1633         16  CO-CURRENT-MONTHLY-TOTALS.
  1634             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1635             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1636             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1637             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1638             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1639
  1640         16  CO-CURRENT-AGING-TOTALS.
  1641             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1642             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1643             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1644             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1645
  1646         16  CO-CURRENT-YTD-TOTALS.
  1647             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1648             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1649
  1650     12  CO-PAID-COMM-TOTALS.
  1651         16  CO-YTD-PAID-COMMS.
  1652             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1653             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1654
  1655     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1656         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1657         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1658
  1659     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1660         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1661         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1662         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1663         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1664         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1665         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1666         88  CO-FINAL-LETTER                  VALUE 'F'.
  1667         88  CO-RECONCILING                   VALUE 'R'.
  1668         88  CO-PHONE-CALL                    VALUE 'P'.
  1669         88  CO-LEGAL                         VALUE 'L'.
  1670         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1671         88  CO-WRITE-OFF                     VALUE 'W'.
  1672         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1673
  1674     12  CO-CSR-CODE                       PIC X(4).
  1675
  1676     12  CO-GA-STATUS-INFO.
  1677         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1678         16  CO-GA-TERMINATION-DT          PIC XX.
  1679         16  CO-GA-STATUS-CODE             PIC X.
  1680             88  CO-GA-ACTIVE                 VALUE 'A'.
  1681             88  CO-GA-INACTIVE               VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6521.cbl
  1682             88  CO-GA-PENDING                VALUE 'P'.
  1683         16  CO-GA-COMMENTS.
  1684             20  CO-GA-COMMENT-1           PIC X(40).
  1685             20  CO-GA-COMMENT-2           PIC X(40).
  1686             20  CO-GA-COMMENT-3           PIC X(40).
  1687             20  CO-GA-COMMENT-4           PIC X(40).
  1688
  1689     12  CO-RPTCD2                         PIC X(10).
  1690
  1691     12  CO-TYPE-AGENT                     PIC X(01).
  1692         88  CO-CORPORATION                   VALUE 'C'.
  1693         88  CO-PARTNERSHIP                   VALUE 'P'.
  1694         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1695         88  CO-TRUST                         VALUE 'T'.
  1696         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1697
  1698     12  CO-FAXNO.
  1699         16  CO-FAX-AREA-CODE                  PIC XXX.
  1700         16  CO-FAX-PREFIX                     PIC XXX.
  1701         16  CO-FAX-PHONE                      PIC X(4).
  1702
  1703     12  CO-BANK-INFORMATION.
  1704         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1705         16  CO-BANK-TRANSIT-NON REDEFINES
  1706             CO-BANK-TRANSIT-NO                PIC 9(8).
  1707
  1708         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1709     12  CO-MISC-DEDUCT-INFO REDEFINES
  1710                  CO-BANK-INFORMATION.
  1711         16  CO-MD-GL-ACCT                     PIC X(10).
  1712         16  CO-MD-DIV                         PIC XX.
  1713         16  CO-MD-CENTER                      PIC X(4).
  1714         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1715         16  CO-CREATE-AP-CHECK                PIC X.
  1716         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1717         16  FILLER                            PIC XXX.
  1718     12  CO-ACH-STATUS                         PIC X.
  1719         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1720         88  CO-ACH-PENDING                        VALUE 'P'.
  1721
  1722     12  CO-BILL-SW                            PIC X.
  1723     12  CO-CONTROL-NAME                       PIC X(30).
  1724     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1725     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1726     12  CO-CLP-STATE                          PIC XX.
  1727     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1728     12  CO-SPP-REFUND-EDIT                    PIC X.
  1729
  1730******************************************************************
  1731*    COPY ERCCOBI.
  1732******************************************************************
  1733*                                                                *
  1734*                                                                *
  1735*                            ERCCOBI                             *
  1736*                                                                *
  1737*   ONLINE CREDIT SYSTEM                                         *
  1738*                                                                *
  1739*   FILE DESCRIPTION = COMPENSATION MASTER BILLING INSTRUCTIONS  *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6521.cbl
  1740*                                                                *
  1741*   FILE TYPE = VSAM,KSDS                                        *
  1742*   RECORD SIZE = 620   RECFORM = FIXED                          *
  1743*                                                                *
  1744*   BASE CLUSTER NAME = ERCOBI                   RKP=2,LEN=17    *
  1745*       ALTERNATE PATH = NONE                                    *
  1746*                                                                *
  1747*   LOG = NO                                                     *
  1748*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1749*                                                                *
  1750******************************************************************
  1751*                   C H A N G E   L O G
  1752*
  1753* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1754*-----------------------------------------------------------------
  1755*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1756* EFFECTIVE    NUMBER
  1757*-----------------------------------------------------------------
  1758* 081808    2008061100001  PEMA  NEW FILE FOR BILLING INSTRUCTIONS
  1759******************************************************************
  1760 01  COMP-BILLING-INSTRUCTIONS.
  1761     12  BL-RECORD-ID                          PIC XX.
  1762         88  VALID-BL-ID                          VALUE 'BL'.
  1763     12  BL-CONTROL-PRIMARY.
  1764         16  BL-COMPANY-CD                     PIC X.
  1765         16  BL-STMT-OWNER                     PIC X(4).
  1766         16  BL-REPORT-GROUP-ID                PIC X(12).
  1767     12  BL-MAINT-INFORMATION.
  1768         16  BL-LAST-MAINT-DT                  PIC XX.
  1769         16  BL-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1770         16  BL-LAST-MAINT-USER                PIC X(4).
  1771         16  FILLER                            PIC X(10).
  1772     12  BL-ACCOUNT-NAME                       PIC X(35).
  1773     12  BL-CONTACT-NAME                       PIC X(35).
  1774     12  BL-ADDR1                              PIC X(30).
  1775     12  BL-ADDR2                              PIC X(30).
  1776     12  BL-CITY                               PIC X(30).
  1777     12  BL-STATE                              PIC XX.
  1778     12  BL-ZIP.
  1779         16  BL-ZIP-PRIME.
  1780             20  BL-ZIP-PRI-1ST                PIC X.
  1781                 88  BL-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1782             20  FILLER                        PIC X(4).
  1783         16  BL-ZIP-PLUS4                      PIC X(4).
  1784     12  BL-CANADIAN-POSTAL-CODE  REDEFINES  BL-ZIP.
  1785         16  BL-CAN-POSTAL-1                   PIC XXX.
  1786         16  BL-CAN-POSTAL-2                   PIC XXX.
  1787         16  FILLER                            PIC XXX.
  1788*    12  FILLER                                PIC X(30).
  1789     12  BL-CHECK-HANDLING                     PIC X.
  1790         88  BL-CHECKS-NET                VALUE '1' ' '.
  1791         88  BL-CHECKS-SEPARATE           VALUE '2'.
  1792     12  BL-SPECIAL-INSTRUCTIONS.
  1793         16  BL-SI-LINE-1                      PIC X(70).
  1794         16  BL-SI-LINE-2                      PIC X(70).
  1795         16  BL-SI-LINE-3                      PIC X(70).
  1796         16  BL-SI-LINE-4                      PIC X(70).
  1797         16  BL-SI-LINE-5                      PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6521.cbl
  1798     12  FILLER                                PIC X(59).
  1799
  1800******************************************************************
  1801*    COPY ELCACHP.
  1802******************************************************************
  1803*                                                                *
  1804*                           ELCACHP                              *
  1805*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1806*                            VMOD=2.002                          *
  1807*                                                                *
  1808*   FILE DESCRIPTION = ACH PRE-NOTIFICATION                      *
  1809*                                                                *
  1810*   FILE TYPE = VSAM,KSDS                                        *
  1811*   RECORD SIZE = 120  RECFORM = FIXED                           *
  1812*                                                                *
  1813*   BASE CLUSTER = ELACHP                         RKP=2,LEN=29   *
  1814*       ALTERNATE (NONE)                                         *
  1815*                                                                *
  1816*   LOG = YES                                                    *
  1817*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1818*                                                                *
  1819*  NO  CID  MODS  IN  COPYBOOK  ELCACHP                          *
  1820******************************************************************
  1821
  1822 01  ACH-PRENOTIFICATION.
  1823     12  AP-RECORD-ID                      PIC XX.
  1824         88  VALID-AP-ID                      VALUE 'AP'.
  1825
  1826******************************************************************
  1827*   BASE CLUSTER = ELACHP         (BASE KEY)      RKP=2,LEN=29   *
  1828******************************************************************
  1829
  1830     12  AP-CONTROL-PRIMARY.
  1831         16  AP-CONTROL-CD                 PIC X.
  1832         16  AP-CARRIER                    PIC X.
  1833         16  AP-GROUPING                   PIC X(6).
  1834         16  AP-FIN-RESP                   PIC X(10).
  1835         16  AP-ACCT-AGENT                 PIC X(10).
  1836         16  AP-CO-TYPE                    PIC X.
  1837
  1838     12  AP-CONTROL-ALT   REDEFINES  AP-CONTROL-PRIMARY.
  1839         16  AP-COMPANY-CD-ALT             PIC X.
  1840         16  AP-BENEFICIARY                PIC X(10).
  1841         16  FILLER                        PIC X(18).
  1842
  1843******************************************************************
  1844*                 FILE SYNCHRONIZATION DATA                      *
  1845******************************************************************
  1846
  1847     12  AP-FILE-SYNCH-DATA.
  1848         16  AP-LAST-CHANGE-DT             PIC XX.
  1849         16  AP-LAST-CHANGE-TIME           PIC S9(7)  COMP-3.
  1850         16  AP-LAST-CHANGE-PROCESSOR      PIC X(4).
  1851
  1852******************************************************************
  1853*                     PRENOTE INFORMATION
  1854******************************************************************
  1855
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6521.cbl
  1856     12  AP-BANK-INFORMATION.
  1857         16  AP-TRANSIT-NUMBER             PIC X(8).
  1858         16  AP-BANK-ACCOUNT-NO            PIC X(17).
  1859         16  AP-BANK-NAME                  PIC X(23).
  1860
  1861     12  FILLER                            PIC X(31).
  1862
  1863******************************************************************
  1864*    COPY ELCBANK.
  1865******************************************************************
  1866*                                                                *
  1867*                           ELCBANK                              *
  1868*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1869*                            VMOD=2.002                          *
  1870*                                                                *
  1871*   FILE DESCRIPTION = BANK MASTER FILE                          *
  1872*                                                                *
  1873*   FILE TYPE = VSAM,KSDS                                        *
  1874*   RECORD SIZE = 210  RECFORM = FIXED                           *
  1875*                                                                *
  1876*   BASE CLUSTER = ELBANK                         RKP=2,LEN=9    *
  1877*       ALTERNATE (NONE)                                         *
  1878*                                                                *
  1879*   LOG = YES                                                    *
  1880*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1881*                                                                *
  1882*  NO  CID  MODS  IN  COPYBOOK  ELCBANK                          *
  1883******************************************************************
  1884
  1885 01  BANK-MASTER.
  1886     12  BM-RECORD-ID                      PIC XX.
  1887         88  VALID-BM-ID                      VALUE 'BM'.
  1888
  1889******************************************************************
  1890*   BASE CLUSTER = MPBANK         (BASE KEY)      RKP=2,LEN=9    *
  1891******************************************************************
  1892
  1893     12  BM-CONTROL-PRIMARY.
  1894         16  BM-COMPANY-CD                 PIC X.
  1895         16  BM-TRANSIT-NUMBER.
  1896             20  BM-FEDERAL-NUMBER         PIC X(4).
  1897             20  BM-BANK-NUMBER            PIC X(4).
  1898     12  FILLER                            PIC X(20).
  1899
  1900******************************************************************
  1901*                 FILE SYNCHRONIZATION DATA                      *
  1902******************************************************************
  1903
  1904     12  BM-FILE-SYNCH-DATA.
  1905         16  BM-LAST-CHANGE-DT             PIC XX.
  1906         16  BM-LAST-CHANGE-TIME           PIC S9(7)  COMP-3.
  1907         16  BM-LAST-CHANGE-PROCESSOR      PIC X(4).
  1908
  1909******************************************************************
  1910*                       BANK INFORMATION                         *
  1911******************************************************************
  1912
  1913     12  BM-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6521.cbl
  1914         16  BM-NAME                       PIC X(30).
  1915         16  BM-ADDRESS1                   PIC X(30).
  1916         16  BM-ADDRESS2                   PIC X(30).
  1917         16  BM-CITY                       PIC X(25).
  1918         16  BM-STATE                      PIC X(25).
  1919         16  BM-ZIP.
  1920             20  BM-ZIP1                   PIC X(5).
  1921             20  BM-ZIP2                   PIC X(4).
  1922     12  FILLER                            PIC X(20).
  1923
  1924******************************************************************
  1925 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  1926                          COMPENSATION-MASTER
  1927                          COMP-BILLING-INSTRUCTIONS
  1928                          ACH-PRENOTIFICATION BANK-MASTER.
  1929 0000-DFHEXIT SECTION.
  1930     MOVE '9#                    $   ' TO DFHEIV0.
  1931     MOVE 'EL6521' TO DFHEIV1.
  1932     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1933
  1934     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1935     MOVE '5'                    TO DC-OPTION-CODE.
  1936     PERFORM 9700-DATE-CONVERT THRU 9700-EXIT.
  1937     MOVE DC-GREG-DATE-1-EDIT    TO WS-SAVE-DATE.
  1938     MOVE DC-BIN-DATE-1          TO WS-SAVE-BIN-DT.
  1939
  1940     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  1941     MOVE EIBTRMID               TO QID-TERM.
  1942     MOVE +2                     TO EMI-NUMBER-OF-LINES.
  1943     MOVE SPACE                  TO SUPPRESS-MAP-SW.
  1944
  1945     IF EIBCALEN = 0
  1946        GO TO 8800-UNAUTHORIZED-ACCESS
  1947     END-IF
  1948     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  1949        MOVE PI-CALLING-PROGRAM  TO RETURNED-FROM
  1950     END-IF
  1951     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1952        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1953           MOVE PI-SAVED-PROGRAM-5    TO PI-SAVED-PROGRAM-6
  1954           MOVE PI-SAVED-PROGRAM-4    TO PI-SAVED-PROGRAM-5
  1955           MOVE PI-SAVED-PROGRAM-3    TO PI-SAVED-PROGRAM-4
  1956           MOVE PI-SAVED-PROGRAM-2    TO PI-SAVED-PROGRAM-3
  1957           MOVE PI-SAVED-PROGRAM-1    TO PI-SAVED-PROGRAM-2
  1958           MOVE PI-RETURN-TO-PROGRAM  TO PI-SAVED-PROGRAM-1
  1959           MOVE PI-CALLING-PROGRAM    TO PI-RETURN-TO-PROGRAM
  1960           MOVE THIS-PGM              TO PI-CALLING-PROGRAM
  1961        ELSE
  1962           MOVE PI-RETURN-TO-PROGRAM  TO PI-CALLING-PROGRAM
  1963           MOVE PI-SAVED-PROGRAM-1    TO PI-RETURN-TO-PROGRAM
  1964           MOVE PI-SAVED-PROGRAM-2    TO PI-SAVED-PROGRAM-1
  1965           MOVE PI-SAVED-PROGRAM-3    TO PI-SAVED-PROGRAM-2
  1966           MOVE PI-SAVED-PROGRAM-4    TO PI-SAVED-PROGRAM-3
  1967           MOVE PI-SAVED-PROGRAM-5    TO PI-SAVED-PROGRAM-4
  1968           MOVE PI-SAVED-PROGRAM-6    TO PI-SAVED-PROGRAM-5
  1969           MOVE SPACES                TO PI-SAVED-PROGRAM-6
  1970        END-IF
  1971     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6521.cbl
  1972     MOVE LOW-VALUES             TO EL6521AI
  1973     IF EIBTRNID = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  1974           EL6526-TRANS-ID
  1975        CONTINUE
  1976     ELSE
  1977        GO TO 0100-NOT-EL611-RETURN
  1978     END-IF
  1979
  1980     PERFORM 0600-RECOVER-TS  THRU  0600-EXIT.
  1981     MOVE XCTL-652           TO PI-RETURN-TO-PROGRAM.
  1982
  1983     MOVE PI-FEDERAL-NUMBER      TO TRNSIT1O.
  1984     MOVE PI-BANK-NUMBER         TO TRNSIT2O.
  1985     MOVE PI-BANK-ACCOUNT-NO     TO BKACCTO.
  1986
  1987     IF PI-BANK-ACTION-CODE EQUAL   'P'
  1988        MOVE 'PENDING'           TO CRSTATO.
  1989
  1990     IF PI-BANK-ACTION-CODE EQUAL   'A'
  1991        MOVE 'ACTIVE '           TO CRSTATO.
  1992
  1993     IF MAINTYPL GREATER THAN ZERO
  1994         MOVE AL-UABON           TO MAINTYPA.
  1995
  1996     IF STATL    GREATER THAN ZERO
  1997         MOVE 'Y'                TO MAP-CHANGED-SW
  1998         MOVE AL-UANON           TO STATA.
  1999
  2000     IF WTHLDL > ZERO
  2001        MOVE 'Y'                 TO MAP-CHANGED-SW
  2002        MOVE AL-UNNON            TO WTHLDA
  2003     END-IF
  2004     IF GADDL > ZERO
  2005        MOVE 'Y'                 TO MAP-CHANGED-SW
  2006        MOVE AL-UANON            TO GADDA
  2007     END-IF
  2008     IF MELSWL > ZERO
  2009        MOVE 'Y'                 TO MAP-CHANGED-SW
  2010        MOVE AL-UANON            TO MELSWA
  2011     END-IF
  2012     IF APCHKL > ZERO
  2013        MOVE 'Y'                 TO MAP-CHANGED-SW
  2014        MOVE AL-UANON            TO APCHKA
  2015     END-IF
  2016     IF MDACTL > ZERO
  2017        MOVE 'Y'                 TO MAP-CHANGED-SW
  2018        MOVE AL-UANON            TO MDACTA
  2019     END-IF
  2020     IF MDDIVL > ZERO
  2021        MOVE 'Y'                 TO MAP-CHANGED-SW
  2022        MOVE AL-UANON            TO MDDIVA
  2023     END-IF
  2024     IF MDCNTRL > ZERO
  2025        MOVE 'Y'                 TO MAP-CHANGED-SW
  2026        MOVE AL-UANON            TO MDCNTRA
  2027     END-IF
  2028     IF MDAMTL > ZERO
  2029        MOVE 'Y'                 TO MAP-CHANGED-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6521.cbl
  2030        MOVE AL-UNNON            TO MDAMTA
  2031     END-IF
  2032     IF EFFDTL   GREATER THAN ZERO
  2033         MOVE 'Y'                TO MAP-CHANGED-SW
  2034         MOVE AL-UANON           TO EFFDTA.
  2035
  2036     IF TRMDTL   GREATER THAN ZERO
  2037         MOVE 'Y'                TO MAP-CHANGED-SW
  2038         MOVE AL-UANON           TO TRMDTA.
  2039
  2040     IF COMM1L   GREATER THAN ZERO
  2041         MOVE 'Y'                TO MAP-CHANGED-SW
  2042         MOVE AL-UANON           TO COMM1A.
  2043
  2044     IF COMM2L   GREATER THAN ZERO
  2045         MOVE 'Y'                TO MAP-CHANGED-SW
  2046         MOVE AL-UANON           TO COMM2A.
  2047
  2048     IF COMM3L   GREATER THAN ZERO
  2049         MOVE 'Y'                TO MAP-CHANGED-SW
  2050         MOVE AL-UANON           TO COMM3A.
  2051
  2052     IF COMM4L   GREATER THAN ZERO
  2053         MOVE 'Y'                TO MAP-CHANGED-SW
  2054         MOVE AL-UANON           TO COMM4A.
  2055
  2056     IF TRNSIT1L GREATER THAN ZERO
  2057         MOVE 'Y'                TO MAP-CHANGED-SW
  2058         MOVE AL-UABON           TO TRNSIT1A.
  2059
  2060     IF TRNSIT2L GREATER THAN ZERO
  2061         MOVE 'Y'                TO MAP-CHANGED-SW
  2062         MOVE AL-UABON           TO TRNSIT2A.
  2063
  2064     IF BKACCTL  GREATER THAN ZERO
  2065         MOVE 'Y'                TO MAP-CHANGED-SW
  2066         MOVE AL-UABON           TO BKACCTA.
  2067
  2068     IF ACTCDL   GREATER THAN ZERO
  2069         MOVE 'Y'                TO MAP-CHANGED-SW
  2070         MOVE AL-UABON           TO ACTCDA.
  2071
  2072     IF DELTOL > 0
  2073        MOVE 'Y'                 TO MAP-CHANGED-SW
  2074        MOVE AL-UANON            TO DELTOA
  2075     END-IF
  2076     IF RGIDL > 0
  2077        MOVE 'Y'                 TO MAP-CHANGED-SW
  2078        MOVE AL-UANON            TO RGIDA
  2079     END-IF
  2080     IF MAP-NOT-CHANGED
  2081         GO TO 0100-NOT-EL611-RETURN.
  2082
  2083     GO TO 8100-SEND-INITIAL-MAP.
  2084
  2085 0100-NOT-EL611-RETURN.
  2086
  2087     IF EIBTRNID NOT = TRANS-ID
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6521.cbl
  2088         MOVE PI-MAINT           TO MAINTYPO
  2089         MOVE AL-UANON           TO MAINTYPA
  2090         MOVE -1                 TO MAINTYPL
  2091         IF PI-MAINT = 'S' OR 'C'
  2092             GO TO 4000-SHOW
  2093         ELSE
  2094             GO TO 8100-SEND-INITIAL-MAP.
  2095
  2096
  2097* EXEC CICS HANDLE CONDITION
  2098*        PGMIDERR  (9600-PGMID-ERROR)
  2099*        ERROR     (9990-ABEND)
  2100*    END-EXEC.
  2101*    MOVE '"$L.                  ! " #00002092' TO DFHEIV0
  2102     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2103     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2104     MOVE X'2220233030303032303932' TO DFHEIV0(25:11)
  2105     CALL 'kxdfhei1' USING DFHEIV0
  2106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2107
  2108
  2109     IF EIBAID = DFHCLEAR
  2110         GO TO 9400-CLEAR.
  2111
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6521.cbl
  2113 0200-RECEIVE.
  2114     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  2115         MOVE ER-0008            TO EMI-ERROR
  2116         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2117         MOVE -1                 TO PFENTERL
  2118         GO TO 8200-SEND-DATAONLY.
  2119
  2120
  2121* EXEC CICS RECEIVE
  2122*        MAP      (MAP-NAME)
  2123*        MAPSET   (MAPSET-NAME)
  2124*        INTO     (EL6521AI)
  2125*    END-EXEC.
  2126     MOVE LENGTH OF
  2127      EL6521AI
  2128       TO DFHEIV11
  2129*    MOVE '8"T I  L              ''   #00002108' TO DFHEIV0
  2130     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2131     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2132     MOVE X'2020233030303032313038' TO DFHEIV0(25:11)
  2133     CALL 'kxdfhei1' USING DFHEIV0,
  2134           MAP-NAME,
  2135           EL6521AI,
  2136           DFHEIV11,
  2137           MAPSET-NAME,
  2138           DFHEIV99,
  2139           DFHEIV99
  2140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2141
  2142
  2143     IF PFENTERL = 0
  2144         GO TO 0300-CHECK-PFKEYS.
  2145
  2146     IF EIBAID NOT = DFHENTER
  2147         MOVE ER-0004            TO EMI-ERROR
  2148         GO TO 0320-INPUT-ERROR.
  2149
  2150     IF (PFENTERI NUMERIC) AND (PFENTERI GREATER 0 AND LESS 25)
  2151         MOVE PF-VALUES (PFENTERI) TO EIBAID
  2152     ELSE
  2153         MOVE ER-0029              TO EMI-ERROR
  2154         GO TO 0320-INPUT-ERROR.
  2155
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6521.cbl
  2157
  2158 0300-CHECK-PFKEYS.
  2159     IF PI-AR-PROCESSING
  2160        IF EIBAID = DFHPF1
  2161             PERFORM 0500-WRITE-TS  THRU  0500-EXIT
  2162             MOVE XCTL-611       TO PGM-NAME
  2163             GO TO 9300-XCTL.
  2164     IF EIBAID = DFHPF2
  2165        MOVE PI-COMPANY-CD       TO PI-ERCOBI-COMPANY-CD
  2166        MOVE DELTOI              TO PI-ERCOBI-STMT-OWNER
  2167        MOVE RGIDI               TO PI-ERCOBI-RGID
  2168        PERFORM 0500-WRITE-TS    THRU 0500-EXIT
  2169        MOVE XCTL-6525           TO PGM-NAME
  2170        GO TO 9300-XCTL
  2171     END-IF
  2172     IF EIBAID = DFHPF3
  2173        PERFORM 0500-WRITE-TS    THRU 0500-EXIT
  2174        MOVE XCTL-6526           TO PGM-NAME
  2175        GO TO 9300-XCTL
  2176     END-IF
  2177     IF EIBAID = DFHPF23
  2178         GO TO 8810-PF23.
  2179     IF EIBAID = DFHPF24
  2180         GO TO 9200-RETURN-MAIN-MENU.
  2181     IF EIBAID = DFHPF12
  2182         GO TO 9500-PF12.
  2183     IF EIBAID = DFHENTER
  2184         GO TO 0330-CHECK-MAINTYP.
  2185
  2186     MOVE ER-0029                TO EMI-ERROR.
  2187 0320-INPUT-ERROR.
  2188     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2189     MOVE AL-UNBON               TO PFENTERA.
  2190     MOVE -1                     TO PFENTERL.
  2191     GO TO 8200-SEND-DATAONLY.
  2192
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6521.cbl
  2194 0330-CHECK-MAINTYP.
  2195
  2196     IF MAINTYPL GREATER ZERO
  2197         IF MAINTYPI = 'S' OR 'C'
  2198             MOVE AL-UANON       TO MAINTYPA
  2199             MOVE MAINTYPI       TO PI-MAINT
  2200         ELSE
  2201             MOVE -1             TO MAINTYPL
  2202             MOVE AL-UABON       TO MAINTYPA
  2203             MOVE ER-2039        TO EMI-ERROR
  2204             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2205             GO TO 8200-SEND-DATAONLY
  2206     ELSE
  2207         MOVE -1                 TO MAINTYPL
  2208         MOVE AL-UABON           TO MAINTYPA
  2209         MOVE ER-2039            TO EMI-ERROR
  2210         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2211         GO TO 8200-SEND-DATAONLY.
  2212
  2213     IF PI-MAINT = 'S'
  2214         GO TO 4000-SHOW.
  2215
  2216     GO TO 4200-MAINT.
  2217
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6521.cbl
  2219
  2220 0500-WRITE-TS.
  2221
  2222* EXEC CICS WRITEQ TS
  2223*         QUEUE  (QID)
  2224*         FROM   (EL6521AO)
  2225*         LENGTH (MAP-LENGTH)
  2226*    END-EXEC.
  2227*    MOVE '*"                    ''   #00002192' TO DFHEIV0
  2228     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  2229     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2230     MOVE X'2020233030303032313932' TO DFHEIV0(25:11)
  2231     CALL 'kxdfhei1' USING DFHEIV0,
  2232           QID,
  2233           EL6521AO,
  2234           MAP-LENGTH,
  2235           DFHEIV99,
  2236           DFHEIV99,
  2237           DFHEIV99
  2238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2239
  2240
  2241 0500-EXIT.
  2242      EXIT.
  2243
  2244 0600-RECOVER-TS.
  2245
  2246* EXEC CICS READQ TS
  2247*         QUEUE  (QID)
  2248*         INTO (EL6521AO)
  2249*         LENGTH (MAP-LENGTH)
  2250*    END-EXEC.
  2251*    MOVE '*$I    L              ''   #00002202' TO DFHEIV0
  2252     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  2253     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2254     MOVE X'2020233030303032323032' TO DFHEIV0(25:11)
  2255     CALL 'kxdfhei1' USING DFHEIV0,
  2256           QID,
  2257           EL6521AO,
  2258           MAP-LENGTH,
  2259           DFHEIV99,
  2260           DFHEIV99,
  2261           DFHEIV99
  2262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2263
  2264
  2265     PERFORM 0700-DELETE-TS  THRU  0700-EXIT.
  2266
  2267 0600-EXIT.
  2268      EXIT.
  2269
  2270 0700-DELETE-TS.
  2271
  2272* EXEC CICS HANDLE CONDITION
  2273*        QIDERR (0700-EXIT)
  2274*    END-EXEC.
  2275*    MOVE '"$N                   ! # #00002214' TO DFHEIV0
  2276     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6521.cbl
  2277     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2278     MOVE X'2320233030303032323134' TO DFHEIV0(25:11)
  2279     CALL 'kxdfhei1' USING DFHEIV0
  2280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2281
  2282
  2283
  2284* EXEC CICS DELETEQ TS
  2285*        QUEUE (QID)
  2286*    END-EXEC.
  2287*    MOVE '*&                    #   #00002218' TO DFHEIV0
  2288     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  2289     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2290     MOVE X'2020233030303032323138' TO DFHEIV0(25:11)
  2291     CALL 'kxdfhei1' USING DFHEIV0,
  2292           QID,
  2293           DFHEIV99
  2294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2295
  2296
  2297 0700-EXIT.
  2298      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6521.cbl
  2300
  2301 4000-SHOW.
  2302
  2303     PERFORM 7100-READ-ERCOMP THRU 7100-EXIT.
  2304
  2305     IF EIBTRNID     = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  2306           EL6526-TRANS-ID
  2307         NEXT SENTENCE
  2308     ELSE
  2309         MOVE LOW-VALUES         TO EL6521AO.
  2310
  2311     GO TO 5000-BUILD-INITIAL-SCREEN.
  2312
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6521.cbl
  2314 4200-MAINT.
  2315     IF NOT MODIFY-CAP
  2316         MOVE 'UPDATE'           TO SM-READ
  2317         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2318         MOVE ER-0070            TO EMI-ERROR
  2319         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2320         GO TO 8100-SEND-INITIAL-MAP.
  2321
  2322     MOVE 'N'                     TO SUPPRESS-MAP-SW.
  2323     PERFORM 7100-READ-ERCOMP THRU 7100-EXIT.
  2324
  2325     IF EMI-NO-ERRORS
  2326         NEXT SENTENCE
  2327     ELSE
  2328       IF EIBTRNID     = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  2329              EL6526-TRANS-ID
  2330           GO TO 8100-SEND-INITIAL-MAP
  2331       ELSE
  2332           GO TO 8200-SEND-DATAONLY.
  2333
  2334     PERFORM 7000-EDIT THRU 7099-EXIT.
  2335
  2336     IF EMI-NO-ERRORS
  2337         NEXT SENTENCE
  2338     ELSE
  2339       IF EIBTRNID     = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  2340             EL6526-TRANS-ID
  2341           GO TO 8100-SEND-INITIAL-MAP
  2342       ELSE
  2343           GO TO 8200-SEND-DATAONLY.
  2344
  2345     MOVE ER-0000               TO EMI-ERROR
  2346     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2347
  2348     PERFORM 7300-READ-ERCOMP-UPDATE THRU 7300-EXIT.
  2349
  2350     PERFORM 6000-CHECK-FOR-UPDATE   THRU 6049-EXIT.
  2351
  2352     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  2353     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  2354     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2355     MOVE '5'                    TO DC-OPTION-CODE.
  2356     PERFORM 9700-DATE-CONVERT THRU 9700-EXIT.
  2357
  2358     MOVE DC-BIN-DATE-1          TO CO-LAST-MAINT-DT.
  2359
  2360     PERFORM 5500-PROCESS-ELACHP THRU 5599-PROCESS-EXIT
  2361     PERFORM 6100-CHECK-BILL-INSTR
  2362                                 THRU 6100-EXIT
  2363
  2364
  2365* EXEC CICS REWRITE
  2366*        DATASET  (ERCOMP-FILE-ID)
  2367*        FROM     (COMPENSATION-MASTER)
  2368*    END-EXEC.
  2369     MOVE LENGTH OF
  2370      COMPENSATION-MASTER
  2371       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6521.cbl
  2372*    MOVE '&& L                  %   #00002289' TO DFHEIV0
  2373     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2374     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2375     MOVE X'2020233030303032323839' TO DFHEIV0(25:11)
  2376     CALL 'kxdfhei1' USING DFHEIV0,
  2377           ERCOMP-FILE-ID,
  2378           COMPENSATION-MASTER,
  2379           DFHEIV11,
  2380           DFHEIV99
  2381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2382
  2383
  2384     PERFORM 7100-READ-ERCOMP THRU 7100-EXIT.
  2385     MOVE LOW-VALUES             TO EL6521AO.
  2386     MOVE 'C'                    TO PI-MAINT.
  2387
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6521.cbl
  2389
  2390 5000-BUILD-INITIAL-SCREEN.
  2391     MOVE CO-CARRIER             TO CARRIERO.
  2392     MOVE CO-GROUPING            TO GROUPO.
  2393     MOVE CO-TYPE                TO TYPEO.
  2394     MOVE CO-RESP-NO             TO FINRESPO.
  2395     MOVE CO-CTL-2               TO COACCTO.
  2396     MOVE CO-GA-STATUS-CODE      TO STATO.
  2397     IF CO-GA-STATUS-CODE = 'A' OR 'I' OR 'P'
  2398         MOVE CO-GA-STATUS-CODE  TO STATO
  2399         MOVE AL-UANON           TO STATA
  2400         MOVE +1                 TO STATL
  2401     ELSE
  2402         MOVE AL-UANOF           TO STATA
  2403     END-IF
  2404     IF CO-GA-WITHOLD-PCT NOT NUMERIC
  2405        MOVE ZEROS               TO CO-GA-WITHOLD-PCT
  2406     END-IF
  2407     MOVE CO-GA-WITHOLD-PCT      TO WTHLDO
  2408     IF CO-GA-WITHOLD-PCT NOT = ZEROS
  2409        MOVE +3                  TO WTHLDL
  2410        MOVE AL-UANON            TO WTHLDA
  2411     END-IF
  2412     IF CO-GA-DIRECT-DEP = 'Y'
  2413        MOVE 'Y'                 TO GADDO
  2414        MOVE AL-UANON            TO GADDA
  2415        MOVE +1                  TO GADDL
  2416     ELSE
  2417        MOVE 'N'                 TO GADDO
  2418        MOVE AL-UANON            TO GADDA
  2419        MOVE +1                  TO GADDL
  2420     END-IF
  2421     IF CO-DELIVER-CK-TO-MEL = 'Y'
  2422        MOVE 'Y'                 TO MELSWO
  2423        MOVE AL-UANON            TO MELSWA
  2424        MOVE +1                  TO MELSWL
  2425     ELSE
  2426        MOVE 'N'                 TO MELSWO
  2427        MOVE AL-UANON            TO MELSWA
  2428        MOVE +1                  TO MELSWL
  2429     END-IF
  2430     IF CO-CREATE-AP-CHECK = 'Y'
  2431        MOVE 'Y'                 TO APCHKO
  2432        MOVE AL-UANON            TO APCHKA
  2433        MOVE +1                  TO APCHKL
  2434     ELSE
  2435        MOVE 'N'                 TO APCHKO
  2436        MOVE AL-UANON            TO APCHKA
  2437        MOVE +1                  TO APCHKL
  2438     END-IF
  2439     IF CO-MD-GL-ACCT = SPACES OR LOW-VALUES
  2440        MOVE AL-UANOF            TO MDACTA
  2441     ELSE
  2442        MOVE CO-MD-GL-ACCT       TO MDACTO
  2443        MOVE +2                  TO MDACTL
  2444        MOVE AL-UANON            TO MDACTA
  2445     END-IF
  2446     IF CO-MD-DIV = SPACES OR LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6521.cbl
  2447        MOVE AL-UANOF            TO MDDIVA
  2448     ELSE
  2449        MOVE CO-MD-DIV           TO MDDIVO
  2450        MOVE AL-UANON            TO MDDIVA
  2451     END-IF
  2452     IF CO-MD-CENTER = SPACES OR LOW-VALUES
  2453        MOVE AL-UANOF            TO MDCNTRA
  2454     ELSE
  2455        MOVE CO-MD-CENTER        TO MDCNTRO
  2456        MOVE +2                  TO MDCNTRL
  2457        MOVE AL-UANON            TO MDCNTRA
  2458     END-IF
  2459     IF CO-MD-AMT NOT NUMERIC
  2460        MOVE ZEROS               TO CO-MD-AMT
  2461     END-IF
  2462     MOVE CO-MD-AMT              TO MDAMTO
  2463     IF CO-MD-AMT NOT = ZEROS
  2464        MOVE +3                  TO MDAMTL
  2465        MOVE AL-UANON            TO MDAMTA
  2466     END-IF
  2467     MOVE ZEROS                  TO MDLOBO
  2468                                    MDSTO
  2469     IF CO-GA-EFFECTIVE-DT = LOW-VALUES OR SPACES
  2470         MOVE AL-UANOF           TO EFFDTA
  2471     ELSE
  2472         MOVE CO-GA-EFFECTIVE-DT TO DC-BIN-DATE-1
  2473         MOVE ' '                TO DC-OPTION-CODE
  2474         PERFORM 9700-DATE-CONVERT THRU 9700-EXIT
  2475         MOVE DC-GREG-DATE-1-EDIT
  2476                                 TO EFFDTO
  2477         MOVE AL-UANON           TO EFFDTA
  2478         MOVE +8                 TO EFFDTL.
  2479
  2480     IF CO-GA-TERMINATION-DT = HIGH-VALUES
  2481        MOVE '99/99/99'          TO TRMDTO
  2482        MOVE AL-UANON            TO TRMDTA
  2483     ELSE
  2484        IF CO-GA-TERMINATION-DT = LOW-VALUES OR SPACES
  2485            MOVE AL-UANOF        TO TRMDTA
  2486        ELSE
  2487           MOVE CO-GA-TERMINATION-DT
  2488                                 TO DC-BIN-DATE-1
  2489           MOVE ' '              TO DC-OPTION-CODE
  2490           PERFORM 9700-DATE-CONVERT
  2491                                 THRU 9700-EXIT
  2492           MOVE DC-GREG-DATE-1-EDIT
  2493                                 TO TRMDTO
  2494           MOVE AL-UANON         TO TRMDTA
  2495           MOVE +8               TO TRMDTL
  2496        END-IF
  2497     END-IF
  2498
  2499     IF CO-GA-COMMENT-1 = LOW-VALUES OR SPACES
  2500         MOVE AL-UANOF            TO COMM1A
  2501     ELSE
  2502         MOVE CO-GA-COMMENT-1    TO COMM1O
  2503         MOVE AL-UANON           TO COMM1A
  2504         MOVE +40                TO COMM1L.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6521.cbl
  2505
  2506     IF CO-GA-COMMENT-2 = LOW-VALUES OR SPACES
  2507         MOVE AL-UANOF            TO COMM2A
  2508     ELSE
  2509         MOVE CO-GA-COMMENT-2    TO COMM2O
  2510         MOVE AL-UANON           TO COMM2A
  2511         MOVE +40                TO COMM2L.
  2512
  2513     IF CO-GA-COMMENT-3 = LOW-VALUES OR SPACES
  2514         MOVE AL-UANOF           TO COMM3A
  2515     ELSE
  2516         MOVE CO-GA-COMMENT-3    TO COMM3O
  2517         MOVE AL-UANON           TO COMM3A
  2518         MOVE +40                TO COMM3L.
  2519
  2520     IF CO-GA-COMMENT-4 = LOW-VALUES OR SPACES
  2521         MOVE AL-UANOF           TO COMM4A
  2522     ELSE
  2523         MOVE CO-GA-COMMENT-4    TO COMM4O
  2524         MOVE AL-UANON           TO COMM4A
  2525         MOVE +40                TO COMM4L.
  2526
  2527     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  2528        CONTINUE
  2529     ELSE
  2530        IF (CO-BANK-TRANSIT-NO (1:4) = LOW-VALUES OR SPACES) AND
  2531           (CO-BANK-TRANSIT-NO (5:4) = LOW-VALUES OR SPACES)
  2532            MOVE AL-UANOF        TO TRNSIT1A
  2533            MOVE AL-UANOF        TO TRNSIT2A
  2534        ELSE
  2535           MOVE CO-BANK-TRANSIT-NO (1:4)
  2536                                 TO PI-BANK-TRANSIT-NUMBER (2:4)
  2537                                    TRNSIT1O
  2538           MOVE CO-BANK-TRANSIT-NO (5:4)
  2539                                 TO PI-BANK-TRANSIT-NUMBER (6:4)
  2540                                    TRNSIT2O
  2541        END-IF
  2542        IF CO-BANK-ACCOUNT-NUMBER = LOW-VALUES OR SPACES
  2543           MOVE AL-UANOF         TO BKACCTA
  2544        ELSE
  2545           MOVE CO-BANK-ACCOUNT-NUMBER
  2546                                 TO PI-BANK-ACCOUNT-NO
  2547                                    BKACCTO
  2548        END-IF
  2549     END-IF
  2550     MOVE    '       '           TO CRSTATO.
  2551
  2552     MOVE CO-ACH-STATUS          TO PI-BANK-ACTION-CODE.
  2553
  2554     IF CO-ACH-STATUS IS EQUAL      'P'
  2555        MOVE 'PENDING'           TO CRSTATO.
  2556
  2557     IF CO-ACH-STATUS IS EQUAL      'A'
  2558        MOVE 'ACTIVE '           TO CRSTATO.
  2559     IF CO-STMT-OWNER NOT = SPACES AND LOW-VALUES
  2560        MOVE CO-STMT-OWNER       TO DELTOO
  2561        MOVE AL-UANON            TO DELTOA
  2562        MOVE +4                  TO DELTOL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6521.cbl
  2563     ELSE
  2564        MOVE AL-UANOF            TO DELTOA
  2565     END-IF
  2566     IF CO-REPORT-GROUP-ID NOT = SPACES AND LOW-VALUES
  2567        MOVE CO-REPORT-GROUP-ID  TO RGIDO
  2568        MOVE AL-UANON            TO RGIDA
  2569        MOVE +12                 TO RGIDL
  2570     ELSE
  2571        MOVE AL-UANOF            TO RGIDA
  2572     END-IF
  2573     MOVE PI-MAINT               TO MAINTYPO.
  2574     MOVE AL-UANOF               TO MAINTYPA.
  2575     MOVE -1                     TO MAINTYPL.
  2576
  2577     GO TO 8100-SEND-INITIAL-MAP.
  2578
  2579 5099-EXIT.
  2580     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6521.cbl
  2582 5500-PROCESS-ELACHP.
  2583
  2584     IF ACTCDI = 'D'
  2585        PERFORM 7400-DELETE-PRE-NOTE THRU 7499-EXIT
  2586        MOVE SPACES              TO CO-BANK-INFORMATION
  2587                                    CO-ACH-STATUS
  2588        GO TO 5599-PROCESS-EXIT.
  2589
  2590     IF ACTCDI = 'C'
  2591         PERFORM 7400-DELETE-PRE-NOTE THRU 7499-EXIT
  2592         PERFORM 7600-WRITE-ELACHP THRU 7620-WRITE-EXIT
  2593         MOVE WS-BANK-DATA       TO CO-BANK-INFORMATION
  2594         MOVE WS-BKACCTI         TO CO-BANK-ACCOUNT-NUMBER
  2595         MOVE 'P'                TO CO-ACH-STATUS
  2596         GO TO 5599-PROCESS-EXIT.
  2597
  2598     IF ACTCDI =  'N'
  2599         PERFORM 7600-WRITE-ELACHP THRU 7620-WRITE-EXIT
  2600         MOVE WS-BANK-DATA       TO CO-BANK-INFORMATION
  2601         MOVE WS-BKACCTI         TO CO-BANK-ACCOUNT-NUMBER
  2602         MOVE 'P'                TO CO-ACH-STATUS  WS-ACTCDI
  2603         GO TO 5599-PROCESS-EXIT.
  2604
  2605     IF ACTCDI = 'A'
  2606         MOVE 'A'                TO CO-ACH-STATUS  WS-ACTCDI
  2607         GO TO 5599-PROCESS-EXIT.
  2608
  2609 5599-PROCESS-EXIT.
  2610
  2611     EXIT.
  2612 6000-CHECK-FOR-UPDATE.
  2613     IF STATL GREATER ZERO
  2614        MOVE STATI               TO CO-GA-STATUS-CODE.
  2615
  2616     IF EFFDTL GREATER ZERO
  2617        MOVE WS-SAVE-BIN-EFFDT   TO CO-GA-EFFECTIVE-DT.
  2618
  2619     IF TRMDTL GREATER ZERO
  2620        MOVE WS-SAVE-BIN-TRMDT   TO CO-GA-TERMINATION-DT.
  2621
  2622     IF GADDL > ZERO
  2623        MOVE GADDI               TO CO-GA-DIRECT-DEP
  2624     END-IF
  2625     IF MELSWL > ZERO
  2626        MOVE MELSWI              TO CO-DELIVER-CK-TO-MEL
  2627     END-IF
  2628     IF APCHKL > ZERO
  2629        MOVE APCHKI              TO CO-CREATE-AP-CHECK
  2630     END-IF
  2631     IF MDACTL > ZERO
  2632        MOVE MDACTI              TO CO-MD-GL-ACCT
  2633     END-IF
  2634     IF MDDIVL > ZERO
  2635        MOVE MDDIVI              TO CO-MD-DIV
  2636     END-IF
  2637     IF MDCNTRL > ZERO
  2638        MOVE MDCNTRI             TO CO-MD-CENTER
  2639     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6521.cbl
  2640     IF WTHLDL > ZERO
  2641        MOVE WTHLDI              TO CO-GA-WITHOLD-PCT
  2642     END-IF
  2643     IF MDAMTL > ZERO
  2644        MOVE MDAMTI              TO CO-MD-AMT
  2645     END-IF
  2646     IF DELTOL > ZERO
  2647        MOVE DELTOI              TO CO-STMT-OWNER
  2648     END-IF
  2649     IF RGIDL > ZERO
  2650        MOVE RGIDI               TO CO-REPORT-GROUP-ID
  2651     END-IF
  2652     IF COMM1L GREATER ZERO
  2653        MOVE COMM1I              TO CO-GA-COMMENT-1.
  2654
  2655     IF COMM2L GREATER ZERO
  2656        MOVE COMM2I              TO CO-GA-COMMENT-2.
  2657
  2658     IF COMM3L GREATER ZERO
  2659        MOVE COMM3I              TO CO-GA-COMMENT-3.
  2660
  2661     IF COMM4L GREATER ZERO
  2662        MOVE COMM4I              TO CO-GA-COMMENT-4.
  2663
  2664 6049-EXIT.
  2665     EXIT.
  2666 6100-CHECK-BILL-INSTR.
  2667     MOVE PI-COMPANY-CD          TO ERCOBI-COMPANY-CD
  2668     MOVE DELTOI                 TO ERCOBI-STMT-OWNER
  2669     MOVE RGIDI                  TO ERCOBI-RGID
  2670
  2671* EXEC CICS READ
  2672*       DATASET (ERCOBI-FILE-ID)
  2673*       SET     (ADDRESS OF COMP-BILLING-INSTRUCTIONS)
  2674*       RIDFLD  (ERCOBI-KEY)
  2675*       RESP    (WS-RESPONSE)
  2676*       UPDATE
  2677*    END-EXEC
  2678*    MOVE '&"S        EU         (  N#00002580' TO DFHEIV0
  2679     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2680     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2681     MOVE X'204E233030303032353830' TO DFHEIV0(25:11)
  2682     CALL 'kxdfhei1' USING DFHEIV0,
  2683           ERCOBI-FILE-ID,
  2684           DFHEIV20,
  2685           DFHEIV99,
  2686           ERCOBI-KEY,
  2687           DFHEIV99,
  2688           DFHEIV99,
  2689           DFHEIV99
  2690     SET ADDRESS OF COMP-BILLING-INSTRUCTIONS TO
  2691         DFHEIV20
  2692     MOVE EIBRESP  TO WS-RESPONSE
  2693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2694     IF NOT RESP-NORMAL
  2695        MOVE AL-UABON            TO DELTOA
  2696                                    RGIDA
  2697        MOVE ER-2797             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6521.cbl
  2698        MOVE -1                  TO DELTOL
  2699        PERFORM 9900-ERROR-FORMAT
  2700                                 THRU 9900-EXIT
  2701     END-IF
  2702     .
  2703 6100-EXIT.
  2704     EXIT.
  2705
  2706 7000-EDIT.
  2707     IF STATL GREATER ZERO
  2708         IF STATI = 'A' OR 'I' OR 'P'
  2709             NEXT SENTENCE
  2710          ELSE
  2711             MOVE -1             TO STATL
  2712             MOVE AL-UABON       TO STATA
  2713             MOVE ER-7438        TO EMI-ERROR
  2714             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2715
  2716     MOVE LOW-VALUES             TO WS-SAVE-BIN-EFFDT.
  2717     MOVE LOW-VALUES             TO WS-SAVE-BIN-TRMDT.
  2718
  2719     IF EFFDTL NOT = ZERO
  2720         MOVE EFFDTI             TO DEEDIT-FIELD
  2721         PERFORM 8600-DEEDIT
  2722         MOVE DEEDIT-FIELD-V0    TO DC-GREG-DATE-1-MDY
  2723         MOVE '4'                TO DC-OPTION-CODE
  2724         PERFORM 9700-DATE-CONVERT THRU 9700-EXIT
  2725         IF DATE-CONVERSION-ERROR
  2726             MOVE ER-0348        TO EMI-ERROR
  2727             MOVE -1             TO EFFDTL
  2728             MOVE AL-UABON       TO EFFDTA
  2729             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2730         ELSE
  2731             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
  2732             MOVE AL-UANON             TO EFFDTA
  2733             MOVE DC-BIN-DATE-1        TO WS-SAVE-BIN-EFFDT.
  2734
  2735     IF TRMDTL NOT = ZERO
  2736        MOVE TRMDTI              TO DEEDIT-FIELD
  2737        PERFORM 8600-DEEDIT
  2738        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  2739        IF DC-GREG-DATE-1-MDY = 999999
  2740           MOVE HIGH-VALUES      TO WS-SAVE-BIN-TRMDT
  2741        ELSE
  2742           MOVE '4'              TO DC-OPTION-CODE
  2743           PERFORM 9700-DATE-CONVERT
  2744                                 THRU 9700-EXIT
  2745           IF DATE-CONVERSION-ERROR
  2746              MOVE ER-0454       TO EMI-ERROR
  2747              MOVE -1            TO TRMDTL
  2748              MOVE AL-UABON      TO TRMDTA
  2749              PERFORM 9900-ERROR-FORMAT
  2750                                 THRU 9900-EXIT
  2751           ELSE
  2752              MOVE DC-GREG-DATE-1-EDIT
  2753                                 TO TRMDTI
  2754              MOVE AL-UANON      TO TRMDTA
  2755              MOVE DC-BIN-DATE-1 TO WS-SAVE-BIN-TRMDT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6521.cbl
  2756           END-IF
  2757        END-IF
  2758     END-IF
  2759     IF GADDL > ZERO
  2760        IF GADDI = 'Y' OR 'N' OR ' '
  2761           MOVE AL-UANON         TO GADDA
  2762        ELSE
  2763           MOVE AL-UABON         TO GADDA
  2764           MOVE ER-0876          TO EMI-ERROR
  2765           MOVE -1               TO GADDL
  2766           PERFORM 9900-ERROR-FORMAT
  2767                                 THRU 9900-EXIT
  2768        END-IF
  2769     END-IF
  2770     IF MELSWL > ZERO
  2771        IF MELSWI = 'Y' OR 'N' OR ' '
  2772           MOVE AL-UANON         TO MELSWA
  2773        ELSE
  2774           MOVE AL-UABON         TO MELSWA
  2775           MOVE ER-0876          TO EMI-ERROR
  2776           MOVE -1               TO MELSWL
  2777           PERFORM 9900-ERROR-FORMAT
  2778                                 THRU 9900-EXIT
  2779        END-IF
  2780     END-IF
  2781     IF APCHKL > ZERO
  2782        IF APCHKI = 'Y' OR 'N' OR ' '
  2783           MOVE AL-UANON         TO APCHKA
  2784        ELSE
  2785           MOVE AL-UABON         TO APCHKA
  2786           MOVE ER-0876          TO EMI-ERROR
  2787           MOVE -1               TO APCHKL
  2788           PERFORM 9900-ERROR-FORMAT
  2789                                 THRU 9900-EXIT
  2790        END-IF
  2791     END-IF
  2792     IF WTHLDL  > ZERO
  2793
  2794* EXEC CICS BIF
  2795*          DEEDIT
  2796*          FIELD   (WTHLDI)
  2797*          LENGTH  (6)
  2798*       END-EXEC
  2799     MOVE 6
  2800       TO DFHEIV11
  2801*    MOVE '@"L                   #   #00002686' TO DFHEIV0
  2802     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2803     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2804     MOVE X'2020233030303032363836' TO DFHEIV0(25:11)
  2805     CALL 'kxdfhei1' USING DFHEIV0,
  2806           WTHLDI,
  2807           DFHEIV11
  2808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2809        IF WTHLDI NUMERIC
  2810           MOVE AL-UNNON         TO WTHLDA
  2811        ELSE
  2812           MOVE -1               TO WTHLDL
  2813           MOVE AL-UABON         TO WTHLDA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6521.cbl
  2814           MOVE ER-8799          TO EMI-ERROR
  2815           PERFORM 9900-ERROR-FORMAT
  2816                                 THRU  9900-EXIT
  2817        END-IF
  2818     END-IF
  2819     IF MDAMTL  > ZERO
  2820
  2821* EXEC CICS BIF
  2822*          DEEDIT
  2823*          FIELD   (MDAMTI)
  2824*          LENGTH  (8)
  2825*       END-EXEC
  2826     MOVE 8
  2827       TO DFHEIV11
  2828*    MOVE '@"L                   #   #00002702' TO DFHEIV0
  2829     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2830     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2831     MOVE X'2020233030303032373032' TO DFHEIV0(25:11)
  2832     CALL 'kxdfhei1' USING DFHEIV0,
  2833           MDAMTI,
  2834           DFHEIV11
  2835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2836        IF MDAMTI NUMERIC
  2837           MOVE AL-UNNON         TO MDAMTA
  2838        ELSE
  2839           MOVE -1               TO MDAMTL
  2840           MOVE AL-UABON         TO MDAMTA
  2841           MOVE ER-8799          TO EMI-ERROR
  2842           PERFORM 9900-ERROR-FORMAT
  2843                                 THRU  9900-EXIT
  2844        END-IF
  2845     END-IF
  2846     IF WS-SAVE-BIN-EFFDT = LOW-VALUES OR
  2847        WS-SAVE-BIN-TRMDT = LOW-VALUES
  2848         NEXT SENTENCE
  2849       ELSE
  2850         IF WS-SAVE-BIN-TRMDT LESS THAN WS-SAVE-BIN-EFFDT
  2851             MOVE ER-1228        TO EMI-ERROR
  2852             MOVE -1             TO EFFDTL
  2853             MOVE AL-UABON       TO EFFDTA
  2854             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2855
  2856      IF ((DELTOL > +0)
  2857         OR (RGIDL > +0))
  2858         AND ((DELTOI NOT = SPACES)
  2859         AND (RGIDI NOT = SPACES))
  2860         PERFORM 6100-CHECK-BILL-INSTR
  2861                                 THRU 6100-EXIT
  2862      END-IF
  2863     MOVE SPACES                 TO WS-BANK-INFORMATION.
  2864
  2865     IF PI-AR-PROCESSING
  2866        NEXT SENTENCE
  2867     ELSE
  2868        MOVE ZEROS               TO ACTCDL, TRNSIT1L TRNSIT2L
  2869                                    BKACCTL
  2870        GO TO 7099-EXIT.
  2871
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6521.cbl
  2872     IF (TRNSIT1L NOT = ZERO) OR
  2873        (TRNSIT2L NOT = ZERO) OR
  2874        (BKACCTL  NOT = ZERO) OR
  2875        (ACTCDL   NOT = ZERO)
  2876         MOVE 'Y'                TO WS-ACH-SW
  2877     ELSE
  2878         GO TO 7099-EXIT.
  2879
  2880     IF (ACTCDL = ZERO) OR
  2881        (ACTCDI NOT = 'N' AND 'C' AND 'A' AND 'D')
  2882         MOVE -1                 TO ACTCDL
  2883         MOVE AL-UABON           TO ACTCDA
  2884         MOVE ER-7436            TO EMI-ERROR
  2885         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2886         GO TO 7099-EXIT.
  2887
  2888     IF ACTCDI = 'N'
  2889         GO TO 7020-NEW-ACH.
  2890
  2891     IF ACTCDI = 'C'
  2892         GO TO 7040-CHANGE-ACH.
  2893
  2894     IF ACTCDI = 'A'
  2895         GO TO 7060-ACTIVATE-ACH.
  2896
  2897****   ACH DELETE PROCESSING EDITS
  2898
  2899     IF TRNSIT1L NOT = ZERO OR
  2900        TRNSIT2L NOT = ZERO OR
  2901        BKACCTL  NOT = ZERO
  2902         MOVE -1                 TO ACTCDL
  2903         MOVE AL-UABON           TO ACTCDA
  2904         MOVE ER-7430            TO EMI-ERROR
  2905         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2906
  2907     GO TO 7099-EXIT.
  2908
  2909****   ACH NEW ENTRY PROCESSING EDITS
  2910 7020-NEW-ACH.
  2911
  2912     IF CO-ACH-STATUS = 'A' OR 'P'
  2913         MOVE -1                 TO ACTCDL
  2914         MOVE AL-UABON           TO ACTCDA
  2915         MOVE ER-7434            TO EMI-ERROR
  2916         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2917         GO TO 7099-EXIT.
  2918
  2919     IF TRNSIT1L = ZERO OR
  2920        TRNSIT2L = ZERO OR
  2921        BKACCTL = ZERO
  2922         MOVE -1                 TO TRNSIT1L
  2923         MOVE ER-7431            TO EMI-ERROR
  2924         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2925         GO TO 7099-EXIT.
  2926
  2927     IF TRNSIT1L GREATER THAN ZERO
  2928         IF TRNSIT1I = SPACES
  2929             MOVE -1             TO TRNSIT1L
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6521.cbl
  2930             MOVE ER-7435        TO EMI-ERROR
  2931             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2932             GO TO 7099-EXIT
  2933         ELSE
  2934             MOVE TRNSIT1I       TO WS-TRANSIT1.
  2935
  2936     IF TRNSIT2L GREATER THAN ZERO
  2937         IF TRNSIT2I = SPACES
  2938             MOVE -1             TO TRNSIT2L
  2939             MOVE ER-7435        TO EMI-ERROR
  2940             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2941             GO TO 7099-EXIT
  2942         ELSE
  2943             MOVE TRNSIT2I       TO WS-TRANSIT2.
  2944
  2945     IF BKACCTL GREATER THAN ZERO
  2946         IF BKACCTI = SPACES
  2947             MOVE -1             TO BKACCTL
  2948             MOVE ER-7435        TO EMI-ERROR
  2949             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2950             GO TO 7099-EXIT
  2951         ELSE
  2952             MOVE BKACCTI        TO WS-BKACCTI.
  2953         MOVE BKACCTI            TO WS-BKACCTI.
  2954
  2955     PERFORM 7500-VALIDATE-TRANSIT  THRU  7500-VALIDATE-EXIT.
  2956
  2957     GO TO 7099-EXIT.
  2958
  2959****   ACH CHANGE ENTRY PROCESSING EDITS
  2960 7040-CHANGE-ACH.
  2961
  2962     IF (TRNSIT1L = ZERO) AND
  2963        (TRNSIT2L = ZERO) AND
  2964        (BKACCTL = ZERO)
  2965         MOVE -1                 TO TRNSIT1L
  2966         MOVE ER-7435            TO EMI-ERROR
  2967         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2968         GO TO 7099-EXIT.
  2969
  2970     IF CO-BANK-INFORMATION = SPACES OR LOW-VALUES
  2971         MOVE -1                 TO ACTCDL
  2972         MOVE ER-7432            TO EMI-ERROR
  2973         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2974         GO TO 7099-EXIT.
  2975
  2976     MOVE CO-BANK-INFORMATION    TO WS-BANK-INFORMATION.
  2977
  2978     IF TRNSIT1L GREATER THAN ZERO
  2979         IF TRNSIT1I = SPACES
  2980             MOVE -1             TO TRNSIT1L
  2981             MOVE ER-7435        TO EMI-ERROR
  2982             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2983             GO TO 7099-EXIT
  2984         ELSE
  2985             MOVE TRNSIT1I       TO WS-TRANSIT1.
  2986
  2987     IF TRNSIT2L GREATER THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6521.cbl
  2988         IF TRNSIT2I = SPACES
  2989             MOVE -1             TO TRNSIT2L
  2990             MOVE ER-7435        TO EMI-ERROR
  2991             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2992             GO TO 7099-EXIT
  2993         ELSE
  2994             MOVE TRNSIT2I       TO WS-TRANSIT2.
  2995
  2996     IF BKACCTL GREATER THAN ZERO
  2997         IF BKACCTI = SPACES
  2998             MOVE -1             TO BKACCTL
  2999             MOVE ER-7435        TO EMI-ERROR
  3000             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3001             GO TO 7099-EXIT
  3002         ELSE
  3003             MOVE BKACCTI        TO WS-BKACCTI.
  3004
  3005     IF CO-BANK-INFORMATION = WS-BANK-INFORMATION
  3006         MOVE -1                 TO ACTCDL
  3007         MOVE ER-7449            TO EMI-ERROR
  3008         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3009         GO TO 7099-EXIT.
  3010
  3011     IF TRNSIT1L GREATER THAN ZERO OR
  3012        TRNSIT2L GREATER THAN ZERO
  3013         PERFORM 7500-VALIDATE-TRANSIT  THRU  7500-VALIDATE-EXIT.
  3014
  3015     GO TO 7099-EXIT.
  3016
  3017****   ACH ACTIVATE ENTRY PROCESSING EDITS
  3018 7060-ACTIVATE-ACH.
  3019
  3020     IF NOT CO-ACH-PENDING
  3021         MOVE -1                 TO ACTCDL
  3022         MOVE ER-7465            TO EMI-ERROR
  3023         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3024         GO TO 7099-EXIT.
  3025
  3026     IF TRNSIT1L NOT = ZERO OR
  3027        TRNSIT2L NOT = ZERO OR
  3028        BKACCTL  NOT = ZERO
  3029         MOVE -1                 TO ACTCDL
  3030         MOVE ER-7440            TO EMI-ERROR
  3031         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3032         GO TO 7099-EXIT.
  3033
  3034 7099-EXIT.
  3035     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6521.cbl
  3037
  3038 7100-READ-ERCOMP.
  3039
  3040
  3041* EXEC CICS HANDLE CONDITION
  3042*        NOTOPEN (7100-NOTOPEN)
  3043*        NOTFND  (7100-NOTFND)
  3044*    END-EXEC.
  3045*    MOVE '"$JI                  ! $ #00002911' TO DFHEIV0
  3046     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  3047     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3048     MOVE X'2420233030303032393131' TO DFHEIV0(25:11)
  3049     CALL 'kxdfhei1' USING DFHEIV0
  3050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3051
  3052
  3053
  3054* EXEC CICS READ
  3055*         DATASET  (ERCOMP-FILE-ID)
  3056*         SET      (ADDRESS OF COMPENSATION-MASTER)
  3057*         RIDFLD   (PI-ERCOMP-KEY)
  3058*    END-EXEC.
  3059*    MOVE '&"S        E          (   #00002916' TO DFHEIV0
  3060     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3061     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3062     MOVE X'2020233030303032393136' TO DFHEIV0(25:11)
  3063     CALL 'kxdfhei1' USING DFHEIV0,
  3064           ERCOMP-FILE-ID,
  3065           DFHEIV20,
  3066           DFHEIV99,
  3067           PI-ERCOMP-KEY,
  3068           DFHEIV99,
  3069           DFHEIV99,
  3070           DFHEIV99
  3071     SET ADDRESS OF COMPENSATION-MASTER TO
  3072         DFHEIV20
  3073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3074
  3075
  3076*    PERFORM 7200-READ-ERCOBI    THRU 7200-EXIT
  3077     IF DO-NOT-MOVE-TO-MAP
  3078        MOVE 'Y'                 TO SUPPRESS-MAP-SW
  3079        GO TO 7100-EXIT.
  3080
  3081     MOVE CO-LAST-MAINT-USER     TO PI-UPDATE-BY.
  3082     MOVE CO-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  3083     MOVE CO-CONTROL-PRIMARY     TO PI-ERCOMP-KEY.
  3084     MOVE CO-CARRIER             TO CARRIERO.
  3085     MOVE CO-GROUPING            TO GROUPO.
  3086     MOVE CO-TYPE                TO TYPEO.
  3087     MOVE CO-RESP-NO             TO FINRESPO.
  3088     MOVE CO-CTL-2               TO COACCTO.
  3089     MOVE CO-BANK-INFORMATION    TO PI-BANK-TRANSIT-NUMBER (2:8)
  3090     MOVE PI-FEDERAL-NUMBER      TO TRNSIT1O.
  3091     MOVE PI-BANK-NUMBER         TO TRNSIT2O.
  3092     GO TO 7100-EXIT.
  3093
  3094 7100-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6521.cbl
  3095     MOVE ER-7462               TO EMI-ERROR
  3096     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3097     GO TO 7100-EXIT.
  3098
  3099 7100-NOTOPEN.
  3100     MOVE ER-2233               TO EMI-ERROR
  3101     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3102     GO TO 7100-EXIT.
  3103
  3104 7100-EXIT.
  3105     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6521.cbl
  3107
  3108 7200-READ-ERCOBI.
  3109     MOVE CO-CONTROL-PRIMARY     TO ERCOBI-KEY
  3110
  3111* EXEC CICS READ
  3112*       DATASET (ERCOBI-FILE-ID)
  3113*       SET     (ADDRESS OF COMP-BILLING-INSTRUCTIONS)
  3114*       RIDFLD  (ERCOBI-KEY)
  3115*       RESP    (WS-RESPONSE)
  3116*    END-EXEC
  3117*    MOVE '&"S        E          (  N#00002956' TO DFHEIV0
  3118     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3119     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3120     MOVE X'204E233030303032393536' TO DFHEIV0(25:11)
  3121     CALL 'kxdfhei1' USING DFHEIV0,
  3122           ERCOBI-FILE-ID,
  3123           DFHEIV20,
  3124           DFHEIV99,
  3125           ERCOBI-KEY,
  3126           DFHEIV99,
  3127           DFHEIV99,
  3128           DFHEIV99
  3129     SET ADDRESS OF COMP-BILLING-INSTRUCTIONS TO
  3130         DFHEIV20
  3131     MOVE EIBRESP  TO WS-RESPONSE
  3132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3133     IF RESP-NORMAL
  3134        SET BILLING-INSTRUCTIONS-FOUND TO TRUE
  3135     END-IF
  3136     .
  3137 7200-EXIT.
  3138     EXIT.
  3139 7300-READ-ERCOMP-UPDATE.
  3140
  3141* EXEC CICS HANDLE CONDITION
  3142*        NOTFND  (7300-NOTFND)
  3143*        NOTOPEN (7300-NOTOPEN)
  3144*    END-EXEC.
  3145*    MOVE '"$IJ                  ! % #00002969' TO DFHEIV0
  3146     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3147     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3148     MOVE X'2520233030303032393639' TO DFHEIV0(25:11)
  3149     CALL 'kxdfhei1' USING DFHEIV0
  3150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3151
  3152
  3153
  3154* EXEC CICS READ
  3155*         DATASET  (ERCOMP-FILE-ID)
  3156*         SET      (ADDRESS OF COMPENSATION-MASTER)
  3157*         RIDFLD   (PI-ERCOMP-KEY)
  3158*         UPDATE
  3159*    END-EXEC.
  3160*    MOVE '&"S        EU         (   #00002974' TO DFHEIV0
  3161     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3162     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3163     MOVE X'2020233030303032393734' TO DFHEIV0(25:11)
  3164     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL6521.cbl
  3165           ERCOMP-FILE-ID,
  3166           DFHEIV20,
  3167           DFHEIV99,
  3168           PI-ERCOMP-KEY,
  3169           DFHEIV99,
  3170           DFHEIV99,
  3171           DFHEIV99
  3172     SET ADDRESS OF COMPENSATION-MASTER TO
  3173         DFHEIV20
  3174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3175
  3176     GO TO 7300-EXIT.
  3177
  3178 7300-NOTOPEN.
  3179
  3180     MOVE ER-2233               TO EMI-ERROR
  3181     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3182     GO TO 7300-EXIT.
  3183 7300-NOTFND.
  3184
  3185     MOVE ER-7462               TO EMI-ERROR
  3186     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3187     GO TO 7300-EXIT.
  3188
  3189 7300-EXIT.
  3190     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL6521.cbl
  3192
  3193 7400-DELETE-PRE-NOTE.
  3194
  3195
  3196* EXEC CICS HANDLE CONDITION
  3197*        NOTFND  (7499-EXIT)
  3198*        NOTOPEN (7450-NOTOPEN)
  3199*    END-EXEC.
  3200*    MOVE '"$IJ                  ! & #00002999' TO DFHEIV0
  3201     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3202     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3203     MOVE X'2620233030303032393939' TO DFHEIV0(25:11)
  3204     CALL 'kxdfhei1' USING DFHEIV0
  3205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3206
  3207
  3208
  3209* EXEC CICS READ
  3210*         DATASET  (ELACHP-FILE-ID)
  3211*         SET     (ADDRESS OF ACH-PRENOTIFICATION)
  3212*         RIDFLD   (CO-CONTROL-PRIMARY)
  3213*         UPDATE
  3214*    END-EXEC.
  3215*    MOVE '&"S        EU         (   #00003004' TO DFHEIV0
  3216     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3217     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3218     MOVE X'2020233030303033303034' TO DFHEIV0(25:11)
  3219     CALL 'kxdfhei1' USING DFHEIV0,
  3220           ELACHP-FILE-ID,
  3221           DFHEIV20,
  3222           DFHEIV99,
  3223           CO-CONTROL-PRIMARY,
  3224           DFHEIV99,
  3225           DFHEIV99,
  3226           DFHEIV99
  3227     SET ADDRESS OF ACH-PRENOTIFICATION TO
  3228         DFHEIV20
  3229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3230
  3231
  3232
  3233* EXEC CICS DELETE
  3234*        DATASET   (ELACHP-FILE-ID)
  3235*    END-EXEC.
  3236*    MOVE '&(                    &   #00003011' TO DFHEIV0
  3237     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  3238     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3239     MOVE X'2020233030303033303131' TO DFHEIV0(25:11)
  3240     CALL 'kxdfhei1' USING DFHEIV0,
  3241           ELACHP-FILE-ID,
  3242           DFHEIV99,
  3243           DFHEIV99,
  3244           DFHEIV99,
  3245           DFHEIV99
  3246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3247
  3248
  3249     GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL6521.cbl
  3250
  3251 7450-NOTOPEN.
  3252     MOVE ER-7469               TO EMI-ERROR
  3253     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3254
  3255 7499-EXIT.
  3256     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL6521.cbl
  3258
  3259******************************************************************
  3260*             V A L I D T E  T R A N S I T  N U M B E R
  3261******************************************************************
  3262 7500-VALIDATE-TRANSIT.
  3263
  3264
  3265* EXEC CICS HANDLE CONDITION
  3266*        NOTFND   (7500-NOT-FOUND)
  3267*        NOTOPEN  (7500-NOT-OPEN)
  3268*    END-EXEC.
  3269*    MOVE '"$IJ                  ! '' #00003030' TO DFHEIV0
  3270     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3271     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3272     MOVE X'2720233030303033303330' TO DFHEIV0(25:11)
  3273     CALL 'kxdfhei1' USING DFHEIV0
  3274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3275
  3276
  3277     MOVE WS-TRANSIT1          TO PI-FEDERAL-NUMBER.
  3278     MOVE WS-TRANSIT2          TO PI-BANK-NUMBER.
  3279     MOVE PI-COMPANY-CD        TO PI-BANK-COMPANY-CD.
  3280
  3281
  3282* EXEC CICS READ
  3283*        EQUAL
  3284*        DATASET   (ELBANK-FILE-ID)
  3285*        SET       (ADDRESS OF BANK-MASTER)
  3286*        RIDFLD    (PI-BANK-TRANSIT-NUMBER)
  3287*    END-EXEC.
  3288*    MOVE '&"S        E          (   #00003039' TO DFHEIV0
  3289     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3290     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3291     MOVE X'2020233030303033303339' TO DFHEIV0(25:11)
  3292     CALL 'kxdfhei1' USING DFHEIV0,
  3293           ELBANK-FILE-ID,
  3294           DFHEIV20,
  3295           DFHEIV99,
  3296           PI-BANK-TRANSIT-NUMBER,
  3297           DFHEIV99,
  3298           DFHEIV99,
  3299           DFHEIV99
  3300     SET ADDRESS OF BANK-MASTER TO
  3301         DFHEIV20
  3302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3303
  3304
  3305     GO TO 7500-VALIDATE-EXIT.
  3306
  3307 7500-NOT-OPEN.
  3308
  3309     MOVE -1                    TO TRNSIT1L
  3310     MOVE AL-UABON              TO TRNSIT1A
  3311     MOVE AL-UABON              TO TRNSIT2A
  3312     MOVE ER-7468               TO EMI-ERROR .
  3313     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3314     GO TO 7500-VALIDATE-EXIT.
  3315
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL6521.cbl
  3316 7500-NOT-FOUND.
  3317
  3318     MOVE -1                    TO TRNSIT1L
  3319     MOVE AL-UABON              TO TRNSIT1A
  3320     MOVE AL-UABON              TO TRNSIT2A
  3321     MOVE ER-9388               TO EMI-ERROR .
  3322     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3323     GO TO 7500-VALIDATE-EXIT.
  3324
  3325 7500-VALIDATE-EXIT.
  3326     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL6521.cbl
  3328
  3329 7600-WRITE-ELACHP.
  3330
  3331* EXEC CICS HANDLE CONDITION
  3332*        NOTOPEN (7450-NOTOPEN)
  3333*        DUPREC   (7610-DUPREC)
  3334*    END-EXEC.
  3335*    MOVE '"$J%                  ! ( #00003071' TO DFHEIV0
  3336     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  3337     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3338     MOVE X'2820233030303033303731' TO DFHEIV0(25:11)
  3339     CALL 'kxdfhei1' USING DFHEIV0
  3340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3341
  3342
  3343
  3344* EXEC CICS GETMAIN
  3345*        SET      (ADDRESS OF ACH-PRENOTIFICATION)
  3346*        LENGTH   (210)
  3347*    END-EXEC.
  3348     MOVE 210
  3349       TO DFHEIV11
  3350*    MOVE '," L                  $   #00003076' TO DFHEIV0
  3351     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  3352     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3353     MOVE X'2020233030303033303736' TO DFHEIV0(25:11)
  3354     CALL 'kxdfhei1' USING DFHEIV0,
  3355           DFHEIV20,
  3356           DFHEIV11,
  3357           DFHEIV99
  3358     SET ADDRESS OF ACH-PRENOTIFICATION TO
  3359         DFHEIV20
  3360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3361
  3362
  3363     INITIALIZE  ACH-PRENOTIFICATION.
  3364
  3365     MOVE  'AP'                  TO AP-RECORD-ID.
  3366
  3367     MOVE PI-PROCESSOR-ID        TO AP-LAST-CHANGE-PROCESSOR
  3368     MOVE CO-CONTROL-PRIMARY     TO AP-CONTROL-PRIMARY
  3369     MOVE EIBTIME                TO AP-LAST-CHANGE-TIME
  3370     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  3371     MOVE '5'                    TO DC-OPTION-CODE.
  3372     PERFORM 9700-DATE-CONVERT THRU 9700-EXIT.
  3373
  3374     MOVE DC-BIN-DATE-1          TO AP-LAST-CHANGE-DT.
  3375     MOVE WS-BANK-DATA           TO AP-BANK-INFORMATION.
  3376     MOVE BM-NAME                TO AP-BANK-NAME.
  3377
  3378
  3379* EXEC CICS WRITE
  3380*        FROM      (ACH-PRENOTIFICATION)
  3381*        DATASET   (ELACHP-FILE-ID)
  3382*        RIDFLD    (CO-CONTROL-PRIMARY)
  3383*    END-EXEC.
  3384     MOVE LENGTH OF
  3385      ACH-PRENOTIFICATION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL6521.cbl
  3386       TO DFHEIV11
  3387*    MOVE '&$ L                  ''   #00003096' TO DFHEIV0
  3388     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3389     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3390     MOVE X'2020233030303033303936' TO DFHEIV0(25:11)
  3391     CALL 'kxdfhei1' USING DFHEIV0,
  3392           ELACHP-FILE-ID,
  3393           ACH-PRENOTIFICATION,
  3394           DFHEIV11,
  3395           CO-CONTROL-PRIMARY,
  3396           DFHEIV99,
  3397           DFHEIV99
  3398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3399
  3400
  3401     GO TO 7620-WRITE-EXIT.
  3402
  3403 7610-DUPREC.
  3404
  3405     MOVE    ER-7447            TO EMI-ERROR
  3406     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3407     GO TO 7620-WRITE-EXIT.
  3408
  3409 7620-WRITE-EXIT.
  3410      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL6521.cbl
  3412******************************************************************
  3413 8100-SEND-INITIAL-MAP.
  3414     MOVE WS-SAVE-DATE           TO DATEO.
  3415     MOVE EIBTIME                TO TIME-IN.
  3416     MOVE TIME-OUT               TO TIMEO.
  3417     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3418     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3419     MOVE -1                     TO MAINTYPL.
  3420     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  3421     MOVE WS-AGENT-BANK-DESC    TO BKDESCO.
  3422
  3423* HIDE ACH FIELDS IF NOT AR PROCESSING
  3424     IF PI-AR-PROCESSING
  3425        NEXT SENTENCE
  3426     ELSE
  3427        MOVE AL-SADOF             TO BKLITA, BKDESCA  CRSTATA
  3428                                     ACTLITA CRSLITA ACHPF1A
  3429                                     TRNSIT1A TRNSIT2A TRDASHA
  3430                                     BKACCTA, ACTCDA.
  3431
  3432* EXEC CICS SEND
  3433*        MAP      (MAP-NAME)
  3434*        MAPSET   (MAPSET-NAME)
  3435*        FROM     (EL6521AO)
  3436*        ERASE
  3437*        CURSOR
  3438*    END-EXEC.
  3439     MOVE LENGTH OF
  3440      EL6521AO
  3441       TO DFHEIV12
  3442     MOVE -1
  3443       TO DFHEIV11
  3444*    MOVE '8$     CT  E    H L F ,   #00003132' TO DFHEIV0
  3445     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3446     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3447     MOVE X'2020233030303033313332' TO DFHEIV0(25:11)
  3448     CALL 'kxdfhei1' USING DFHEIV0,
  3449           MAP-NAME,
  3450           EL6521AO,
  3451           DFHEIV12,
  3452           MAPSET-NAME,
  3453           DFHEIV99,
  3454           DFHEIV99,
  3455           DFHEIV99,
  3456           DFHEIV11,
  3457           DFHEIV99,
  3458           DFHEIV99,
  3459           DFHEIV99
  3460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3461
  3462
  3463     GO TO 9100-RETURN-TRAN.
  3464
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL6521.cbl
  3466 8200-SEND-DATAONLY.
  3467     MOVE WS-SAVE-DATE           TO DATEO.
  3468     MOVE EIBTIME                TO TIME-IN.
  3469     MOVE TIME-OUT               TO TIMEO.
  3470     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3471     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3472     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  3473     MOVE WS-AGENT-BANK-DESC     TO BKDESCO.
  3474
  3475* HIDE ACH FIELDS IF NOT AR PROCESSING
  3476     IF PI-AR-PROCESSING
  3477        NEXT SENTENCE
  3478     ELSE
  3479        MOVE AL-SADOF             TO BKLITA, BKDESCA  CRSTATA
  3480                                     ACTLITA CRSLITA ACHPF1A
  3481                                     TRNSIT1A TRNSIT2A TRDASHA
  3482                                     BKACCTA, ACTCDA.
  3483
  3484* EXEC CICS SEND
  3485*        MAP      (MAP-NAME)
  3486*        MAPSET   (MAPSET-NAME)
  3487*        FROM     (EL6521AO)
  3488*        DATAONLY
  3489*        CURSOR
  3490*    END-EXEC.
  3491     MOVE LENGTH OF
  3492      EL6521AO
  3493       TO DFHEIV12
  3494     MOVE -1
  3495       TO DFHEIV11
  3496*    MOVE '8$D    CT       H L F ,   #00003160' TO DFHEIV0
  3497     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3498     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3499     MOVE X'2020233030303033313630' TO DFHEIV0(25:11)
  3500     CALL 'kxdfhei1' USING DFHEIV0,
  3501           MAP-NAME,
  3502           EL6521AO,
  3503           DFHEIV12,
  3504           MAPSET-NAME,
  3505           DFHEIV99,
  3506           DFHEIV99,
  3507           DFHEIV99,
  3508           DFHEIV11,
  3509           DFHEIV99,
  3510           DFHEIV99,
  3511           DFHEIV99
  3512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3513
  3514
  3515     GO TO 9100-RETURN-TRAN.
  3516
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL6521.cbl
  3518 8300-SEND-TEXT.
  3519
  3520* EXEC CICS SEND TEXT
  3521*        FROM     (LOGOFF-TEXT)
  3522*        LENGTH   (LOGOFF-LENGTH)
  3523*        ERASE
  3524*        FREEKB
  3525*    END-EXEC.
  3526*    MOVE '8&      T  E F  H   F -   #00003172' TO DFHEIV0
  3527     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3528     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3529     MOVE X'2020233030303033313732' TO DFHEIV0(25:11)
  3530     CALL 'kxdfhei1' USING DFHEIV0,
  3531           LOGOFF-TEXT,
  3532           LOGOFF-LENGTH,
  3533           DFHEIV99,
  3534           DFHEIV99,
  3535           DFHEIV99,
  3536           DFHEIV99,
  3537           DFHEIV99,
  3538           DFHEIV99,
  3539           DFHEIV99,
  3540           DFHEIV99,
  3541           DFHEIV99,
  3542           DFHEIV99
  3543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3544
  3545
  3546
  3547* EXEC CICS RETURN
  3548*    END-EXEC.
  3549*    MOVE '.(                    &   #00003179' TO DFHEIV0
  3550     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3551     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3552     MOVE X'2020233030303033313739' TO DFHEIV0(25:11)
  3553     CALL 'kxdfhei1' USING DFHEIV0,
  3554           DFHEIV99,
  3555           DFHEIV99,
  3556           DFHEIV99,
  3557           DFHEIV99,
  3558           DFHEIV99
  3559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3560
  3561
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL6521.cbl
  3563 8600-DEEDIT.
  3564
  3565* EXEC CICS BIF DEEDIT
  3566*         FIELD(DEEDIT-FIELD)
  3567*         LENGTH(15)
  3568*    END-EXEC.
  3569     MOVE 15
  3570       TO DFHEIV11
  3571*    MOVE '@"L                   #   #00003184' TO DFHEIV0
  3572     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3573     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3574     MOVE X'2020233030303033313834' TO DFHEIV0(25:11)
  3575     CALL 'kxdfhei1' USING DFHEIV0,
  3576           DEEDIT-FIELD,
  3577           DFHEIV11
  3578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3579
  3580
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL6521.cbl
  3582 8800-UNAUTHORIZED-ACCESS.
  3583     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3584     GO TO 8300-SEND-TEXT.
  3585
  3586 8810-PF23.
  3587     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3588     MOVE XCTL-005               TO PGM-NAME.
  3589     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL6521.cbl
  3591
  3592 9100-RETURN-TRAN.
  3593     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3594     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  3595
  3596* EXEC CICS RETURN
  3597*        TRANSID    (TRANS-ID)
  3598*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3599*        LENGTH     (WS-COMM-LENGTH)
  3600*    END-EXEC.
  3601*    MOVE '.(CT                  &   #00003203' TO DFHEIV0
  3602     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3603     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3604     MOVE X'2020233030303033323033' TO DFHEIV0(25:11)
  3605     CALL 'kxdfhei1' USING DFHEIV0,
  3606           TRANS-ID,
  3607           PROGRAM-INTERFACE-BLOCK,
  3608           WS-COMM-LENGTH,
  3609           DFHEIV99,
  3610           DFHEIV99
  3611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3612
  3613
  3614 9200-RETURN-MAIN-MENU.
  3615     MOVE XCTL-626               TO PGM-NAME.
  3616     GO TO 9300-XCTL.
  3617
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL6521.cbl
  3619 9300-XCTL.
  3620
  3621* EXEC CICS XCTL
  3622*        PROGRAM    (PGM-NAME)
  3623*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3624*        LENGTH     (WS-COMM-LENGTH)
  3625*    END-EXEC.
  3626*    MOVE '.$C                   $   #00003215' TO DFHEIV0
  3627     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3628     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3629     MOVE X'2020233030303033323135' TO DFHEIV0(25:11)
  3630     CALL 'kxdfhei1' USING DFHEIV0,
  3631           PGM-NAME,
  3632           PROGRAM-INTERFACE-BLOCK,
  3633           WS-COMM-LENGTH
  3634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3635
  3636
  3637 9400-CLEAR.
  3638     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  3639     GO TO 9300-XCTL.
  3640
  3641 9500-PF12.
  3642     MOVE XCTL-010               TO PGM-NAME.
  3643     GO TO 9300-XCTL.
  3644
  3645 9600-PGMID-ERROR.
  3646
  3647* EXEC CICS HANDLE CONDITION
  3648*        PGMIDERR    (8300-SEND-TEXT)
  3649*    END-EXEC.
  3650*    MOVE '"$L                   ! ) #00003230' TO DFHEIV0
  3651     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3652     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3653     MOVE X'2920233030303033323330' TO DFHEIV0(25:11)
  3654     CALL 'kxdfhei1' USING DFHEIV0
  3655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3656
  3657
  3658     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  3659     MOVE ' '                    TO PI-ENTRY-CD-1.
  3660     MOVE XCTL-005               TO PGM-NAME.
  3661     MOVE PGM-NAME               TO LOGOFF-PGM.
  3662     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  3663     GO TO 9300-XCTL.
  3664
  3665 9700-DATE-CONVERT.
  3666
  3667* EXEC CICS LINK
  3668*        PROGRAM    ('ELDATCV')
  3669*        COMMAREA   (DATE-CONVERSION-DATA)
  3670*        LENGTH     (DC-COMM-LENGTH)
  3671*    END-EXEC.
  3672     MOVE 'ELDATCV' TO DFHEIV1
  3673*    MOVE '."C                   ''   #00003242' TO DFHEIV0
  3674     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3675     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3676     MOVE X'2020233030303033323432' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL6521.cbl
  3677     CALL 'kxdfhei1' USING DFHEIV0,
  3678           DFHEIV1,
  3679           DATE-CONVERSION-DATA,
  3680           DC-COMM-LENGTH,
  3681           DFHEIV99,
  3682           DFHEIV99,
  3683           DFHEIV99
  3684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3685
  3686
  3687 9700-EXIT.
  3688     EXIT.
  3689
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL6521.cbl
  3691 9900-ERROR-FORMAT.
  3692
  3693     IF NOT EMI-ERRORS-COMPLETE
  3694         MOVE LINK-001           TO PGM-NAME
  3695
  3696* EXEC CICS LINK
  3697*            PROGRAM    (PGM-NAME)
  3698*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  3699*            LENGTH     (EMI-COMM-LENGTH)
  3700*        END-EXEC.
  3701*    MOVE '."C                   ''   #00003256' TO DFHEIV0
  3702     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3703     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3704     MOVE X'2020233030303033323536' TO DFHEIV0(25:11)
  3705     CALL 'kxdfhei1' USING DFHEIV0,
  3706           PGM-NAME,
  3707           ERROR-MESSAGE-INTERFACE-BLOCK,
  3708           EMI-COMM-LENGTH,
  3709           DFHEIV99,
  3710           DFHEIV99,
  3711           DFHEIV99
  3712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3713
  3714
  3715 9900-EXIT.
  3716     EXIT.
  3717
  3718 9990-ABEND.
  3719     MOVE LINK-004               TO PGM-NAME.
  3720     MOVE DFHEIBLK               TO EMI-LINE1.
  3721
  3722* EXEC CICS LINK
  3723*        PROGRAM   (PGM-NAME)
  3724*        COMMAREA  (EMI-LINE1)
  3725*        LENGTH    (72)
  3726*    END-EXEC.
  3727     MOVE 72
  3728       TO DFHEIV11
  3729*    MOVE '."C                   ''   #00003268' TO DFHEIV0
  3730     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3731     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3732     MOVE X'2020233030303033323638' TO DFHEIV0(25:11)
  3733     CALL 'kxdfhei1' USING DFHEIV0,
  3734           PGM-NAME,
  3735           EMI-LINE1,
  3736           DFHEIV11,
  3737           DFHEIV99,
  3738           DFHEIV99,
  3739           DFHEIV99
  3740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3741
  3742
  3743     GO TO 8200-SEND-DATAONLY.
  3744
  3745 9995-SECURITY-VIOLATION.
  3746*           COPY ELCSCTP.
  3747******************************************************************
  3748*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL6521.cbl
  3749*                            ELCSCTP                             *
  3750*                            VMOD=2.001                          *
  3751*                                                                *
  3752*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3753******************************************************************
  3754
  3755
  3756     MOVE EIBDATE          TO SM-JUL-DATE.
  3757     MOVE EIBTRMID         TO SM-TERMID.
  3758     MOVE THIS-PGM         TO SM-PGM.
  3759     MOVE EIBTIME          TO TIME-IN.
  3760     MOVE TIME-OUT         TO SM-TIME.
  3761     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3762
  3763
  3764* EXEC CICS LINK
  3765*         PROGRAM  ('EL003')
  3766*         COMMAREA (SECURITY-MESSAGE)
  3767*         LENGTH   (80)
  3768*    END-EXEC.
  3769     MOVE 'EL003' TO DFHEIV1
  3770     MOVE 80
  3771       TO DFHEIV11
  3772*    MOVE '."C                   ''   #00003294' TO DFHEIV0
  3773     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3774     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3775     MOVE X'2020233030303033323934' TO DFHEIV0(25:11)
  3776     CALL 'kxdfhei1' USING DFHEIV0,
  3777           DFHEIV1,
  3778           SECURITY-MESSAGE,
  3779           DFHEIV11,
  3780           DFHEIV99,
  3781           DFHEIV99,
  3782           DFHEIV99
  3783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3784
  3785
  3786******************************************************************
  3787
  3788
  3789 9995-EXIT.
  3790      EXIT.
  3791
  3792 9999-DFHBACK SECTION.
  3793     MOVE '9%                    "   ' TO DFHEIV0
  3794     MOVE 'EL6521' TO DFHEIV1
  3795     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3796     GOBACK.
  3797 9999-DFHEXIT.
  3798     IF DFHEIGDJ EQUAL 0001
  3799         NEXT SENTENCE
  3800     ELSE IF DFHEIGDJ EQUAL 2
  3801         GO TO 9600-PGMID-ERROR,
  3802               9990-ABEND
  3803         DEPENDING ON DFHEIGDI
  3804     ELSE IF DFHEIGDJ EQUAL 3
  3805         GO TO 0700-EXIT
  3806         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL6521.cbl
  3807     ELSE IF DFHEIGDJ EQUAL 4
  3808         GO TO 7100-NOTOPEN,
  3809               7100-NOTFND
  3810         DEPENDING ON DFHEIGDI
  3811     ELSE IF DFHEIGDJ EQUAL 5
  3812         GO TO 7300-NOTFND,
  3813               7300-NOTOPEN
  3814         DEPENDING ON DFHEIGDI
  3815     ELSE IF DFHEIGDJ EQUAL 6
  3816         GO TO 7499-EXIT,
  3817               7450-NOTOPEN
  3818         DEPENDING ON DFHEIGDI
  3819     ELSE IF DFHEIGDJ EQUAL 7
  3820         GO TO 7500-NOT-FOUND,
  3821               7500-NOT-OPEN
  3822         DEPENDING ON DFHEIGDI
  3823     ELSE IF DFHEIGDJ EQUAL 8
  3824         GO TO 7450-NOTOPEN,
  3825               7610-DUPREC
  3826         DEPENDING ON DFHEIGDI
  3827     ELSE IF DFHEIGDJ EQUAL 9
  3828         GO TO 8300-SEND-TEXT
  3829         DEPENDING ON DFHEIGDI.
  3830     MOVE '9%                    "   ' TO DFHEIV0
  3831     MOVE 'EL6521' TO DFHEIV1
  3832     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3833     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4388     Code:       10953
