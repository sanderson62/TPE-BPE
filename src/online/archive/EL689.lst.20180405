* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page   1
* EL689.cbl
* Options: int("EL689.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL689.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL689.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL689.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL689 .
     5*              PROGRAM CONVERTED BY
     6*              COBOL CONVERSION AID PO 5785-ABJ
     7*              CONVERSION DATE 04/20/94 15:10:07.
     8*                            VMOD=2.037
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12*DATE-COMPILED.
    13*REMARKS.    TRANSACTION - EXH3 - CREDIT LETTER WRITER.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page   2
* EL689.cbl
    14*
    15******************************************************************
    16
    17* W-FILE-USED REFERENCE LIST:
    18* (1)  ELCNTL - COMPANY
    19* (2)  ELCNTL - LIFE BENEFIT
    20* (3)  ELCNTL - A&H BENEFIT
    21* (4)  ELCNTL - CARRIER
    22* (5)  MAIL
    23* (6)  ERACCT
    24* (7)  USED FOR SYSTEM VARIABLES ?
    25* (8)  ELCERT
    26* (9)  PENDING BUSINESS
    27* (10) COMPENSATION
    28* (11) ELCNTL - PROCESSOR DATA ?
    29* (12) ERCHEK
    30* (13) ERPYAJ
    31* (14) NOT USED
    32* (15) NOT USED
    33* (16) NOT USED
    34* (17) NOT USED
    35* (18) NOT USED
    36* (19) NOT USED
    37* (20) NOT USED
    38*
    39******************************************************************
    40*                   C H A N G E   L O G
    41*
    42* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    43*-----------------------------------------------------------------
    44*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    45* EFFECTIVE    NUMBER
    46*-----------------------------------------------------------------
    47* 101501    2001100100006  SMVA  ADD USERID to screen header
    48*                                ADJUSTED REDEFINES EL689AI FILLER
    49* 031504    2004020600009  SMVA  PULL MOST CURRENT ACCT ADDRESS
    50* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    51* 100705    2004072800003  PEMA  ADD NEW VARIABLES
    52* 072308    2008062700001  PEMA  ADD NEW VARIABLES
    53* 092908    2008013100006  PEMA  MOVE VAR 154
    54* 102408  CR2008091000001  PEMA  MOVE PNDB VARS TO CERT VARS
    55* 051209  CR2009021700003  PEMA  ADD CRED BENE VARIABLES
    56* 051209  CR2009042700002  PEMA  ADD ERACCT ACCT NUMBER VARIABLE
    57* 022510  IR2009062300003  PEMA  ADD ENDFILE TEST TO ERACCT READ
    58* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    59* 041811  CR2011010400001  PEMA  DISABLE PF8 FOR CERTAIN USERS
    60* 042011  CR2011010400001  PEMA  FIX CRED BENE ADDRESS LINES
    61* 061411  CR2011061300001  PEMA  ADD ALWA TO PF8 DISABLE LIST
    62* 092911  IR2011092900001  AJRA  CLEAR LABEL LINES BEFORE CRED BEN
    63* 022712  IR2012022700001  AJRA  DON'T COUNT &&&&&& IN LINES
    64* 122011  CR2011022800001  AJRA  NAPERSOFT
    65* 090612  IR2012090600001  AJRA  NAPERSOFT
    66* 091712  IR2012091400001  AJRA  NAPERSOFT CERT ID
    67* 091912  IR2012091900001  AJRA  ALLOW FOLLOW UP DATE TO = CURR DT
    68* 101812  CR2012101700002  AJRA  ADD ENDARCH AND SCREENID
    69* 110512  CR2012101700002  AJRA  EXIT LETTER WRITER AFTER PF7
    70* 120512  CR2012101700002  AJRA  ADD RE ENCL CODE
    71* 011013  CR2012101700002  AJRA  CHECK REQ REASON CODE IND
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page   3
* EL689.cbl
    72* 012413  CR2013012100001  AJRA  ADD AUTO BILLING NOTE
    73* 121213  CR2013090300001  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    74* 123113  CR2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    75* 010814  CR2013090300001  AJRA  CALL SQL STORED PROC FOR NEXT BUS
    76* 021214  IR2014021200002  AJRA  ADD SQL DISCONNECT
    77* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    78******************************************************************
    79
    80 DATA DIVISION.
    81 WORKING-STORAGE SECTION.
    82 01  DFH-START PIC X(04).
    83 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    84 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    85                                   USAGE POINTER.
    86 77  FILLER  PIC X(32) VALUE '********************************'.
    87 77  FILLER  PIC X(32) VALUE '*    EL689 WORKING STORAGE     *'.
    88 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
    89
*   90 EXEC SQL
*   91    INCLUDE SQLDA
*   92 END-EXEC
    93 01 SQLDA sync.
    94    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    95    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    96    05 SQLN                  PIC S9(4) COMP-5 value 0.
    97    05 SQLD                  PIC S9(4) COMP-5 value 0.
    98    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    99       10 SQLTYPE            PIC S9(4) COMP-5.
   100       10 SQLLEN             PIC S9(4) COMP-5.
   101$IF P64 SET
   102X      *> For 64-bit environments, ensure that SQLDATA is
   103X      *> aligned on an 8-byte boundary.
   104X      10 FILLER             PIC S9(9) COMP-5.
   105$END
   106       10 SQLDATA            USAGE POINTER.
   107       10 SQLIND             USAGE POINTER.
   108       10 SQLNAME.
   109          15 SQLNAMEL        PIC S9(4) COMP-5.
   110          15 SQLNAMEC        PIC X(30).
   111
   112* Values for SQLTYPE
   113
   114 78  ESQL-DATE-CHAR              VALUE 384.
   115 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   116 78  ESQL-DATE-REC               VALUE 386.
   117 78  ESQL-DATE-REC-NULL          VALUE 387.
   118 78  ESQL-TIME-CHAR              VALUE 388.
   119 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   120 78  ESQL-TIME-REC               VALUE 390.
   121 78  ESQL-TIME-REC-NULL          VALUE 391.
   122 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   123 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   124 78  ESQL-TIMESTAMP-REC          VALUE 394.
   125 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   126 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   127 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   128 78  ESQL-TS-OFFSET-REC          VALUE 398.
   129 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page   4
* EL689.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-LONGVARBINARY          VALUE 404.
   131 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   132 78  ESQL-LONGVARCHAR            VALUE 408.
   133 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   134 78  ESQL-BINARY                 VALUE 444.
   135 78  ESQL-BINARY-NULL            VALUE 445.
   136 78  ESQL-VARBINARY              VALUE 446.
   137 78  ESQL-VARBINARY-NULL         VALUE 447.
   138 78  ESQL-VARCHAR                VALUE 448.
   139 78  ESQL-VARCHAR-NULL           VALUE 449.
   140
   141 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   142 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   143
   144 78  ESQL-CHAR                   VALUE 452.
   145 78  ESQL-CHAR-NULL              VALUE 453.
   146
   147 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   148 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   149
   150 78  ESQL-DOUBLE                 VALUE 480.
   151 78  ESQL-DOUBLE-NULL            VALUE 481.
   152 78  ESQL-REAL                   VALUE 482.
   153 78  ESQL-REAL-NULL              VALUE 483.
   154 78  ESQL-DECIMAL                VALUE 484.
   155 78  ESQL-DECIMAL-NULL           VALUE 485.
   156 78  ESQL-INTEGER                VALUE 496.
   157 78  ESQL-INTEGER-NULL           VALUE 497.
   158 78  ESQL-SMALLINT               VALUE 500.
   159 78  ESQL-SMALLINT-NULL          VALUE 501.
   160 78  ESQL-TINYINT                VALUE 502.
   161 78  ESQL-TINYINT-NULL           VALUE 503.
   162
*  163 EXEC SQL
*  164    INCLUDE SQLCA
*  165 END-EXEC
   166 01 SQLCA.
   167     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   168     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   169     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   170     05  SQLERRM.
   171         49  SQLERRML    PIC S9(4) COMP-5.
   172         49  SQLERRMC    PIC X(70).
   173     05  SQLERRP         PIC X(8).
   174     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   175     05  SQLWARN.
   176         10  SQLWARN0    PIC X.
   177         10  SQLWARN1    PIC X.
   178         10  SQLWARN2    PIC X.
   179         10  SQLWARN3    PIC X.
   180         10  SQLWARN4    PIC X.
   181         10  SQLWARN5    PIC X.
   182         10  SQLWARN6    PIC X.
   183         10  SQLWARN7    PIC X.
   184     05  SQLEXT.
   185         10  SQLWARN8    PIC X.
   186         10  SQLWARN9    PIC X.
   187         10  SQLWARN10   PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page   5
* EL689.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   189     05  SQLSTATE    PIC X(5).
   190
   191 EXEC SQL
   192    BEGIN DECLARE SECTION
   193 END-EXEC
   194
   195 01  SQLCMD                      PIC X(1024).
   196 01  SVR                         PIC X(32).
   197 01  USR                         PIC X(32).
   198 01  PASS                        PIC X(32).
   199 01  USR-PASS                    PIC X(64).
   200
   201 01  WS-SQL-DATA.
   202     05  WS-CYCLE-DATE           PIC X(10).
   203     05  WS-NEXT-BUS-DT          PIC X(10).
   204
   205 EXEC SQL
   206    END DECLARE SECTION
   207 END-EXEC
   208
   209 01  P pointer.
   210 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   211 01  KIXHOST             pic x(9) value Z"HOSTNAME".
   212 01  var-ptr pointer.
   213 01  env-var-len                 pic 9(4)  binary.
   214 01  rc                          pic 9(9)  binary.
   215 01  WS-KIXHOST                  PIC X(10).
   216 01  WS-KIXSYS.
   217     05  WS-KIX-FIL1             PIC X(10).
   218     05  WS-KIX-APPS             PIC X(10).
   219     05  WS-KIX-ENV              PIC X(10).
   220     05  WS-KIX-MYENV            PIC X(10).
   221     05  WS-KIX-SYS              PIC X(10).
   222 01 srch-commarea.
   223*                                copy ELCADLTRSPI.
   224******************************************************************
   225*                   C H A N G E   L O G
   226*
   227* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   228*-----------------------------------------------------------------
   229*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   230* EFFECTIVE    NUMBER
   231*-----------------------------------------------------------------
   232* 060611    2011022800001  PEMA  NEW COPYBOOK
   233* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   234* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   235******************************************************************
   236****************************************
   237*  commarea for NaperSoft On Demand Admin services letters
   238*  (business logic input & output)
   239****************************************
   240     03  BL-INPUT.
   241         05  BL-DATA-SRCE        PIC X.
   242         05  BL-LETTER-ID        PIC XXXX.
   243         05  BL-CARRIER          PIC X.
   244         05  BL-GROUP            PIC X(6).
   245         05  BL-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page   6
* EL689.cbl
   246         05  BL-ACCOUNT          PIC X(10).
   247         05  BL-EFF-DT           PIC X(10).
   248         05  BL-CERT-NO          PIC X(11).
   249         05  BL-BATCH-NO         PIC X(6).
   250         05  BL-BATCH-SEQ        PIC 9(8).
   251         05  BL-RESP-NO          PIC X(10).
   252         05  BL-NO-OF-COPIES     PIC 99.
   253         05  BL-PROC-ID          PIC XXXX.
   254         05  BL-COMP-ID          PIC XXX.
   255         05  BL-PRINT-NOW-SW     PIC X.
   256         05  BL-ENC-CD           PIC XXX.
   257         05  BL-RESEND-DT        PIC X(10).
   258         05  BL-FOLLOW-UP-DT     PIC X(10).
   259         05  BL-ARCHIVE-NO       PIC 9(8).
   260         05  BL-FUNC             PIC X(8).
   261         05  BL-COMMENTS         PIC X(100).
   262         05  FILLER REDEFINES BL-COMMENTS.
   263             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   264             10  BL-LETTER-TO-ACCT PIC X.
   265             10  BL-LETTER-TO-BENE PIC X.
   266             10  BL-WRITE-ERARCH   PIC X.
   267                 88  ERARCH-QWS      VALUE 'Q'.
   268                 88  ERARCH-BATCH    VALUE 'B'.
   269                 88  ERARCH-TEMP     VALUE 'T'.
   270             10  BL-PROCESS-TYPE PIC X(07).
   271             10  BL-CERT-FORM-ID PIC X(05).
   272             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   273             10  BL-SOURCE-SCREEN PIC X(8).
   274             10  FILLER          PIC X(25).
   275     03  BL-OUTPUT.
   276         05  BL-STATUS                   PIC X.
   277             88  BL-OK                      VALUE "P".
   278             88  BL-FAIL                  VALUE "F".
   279         05  BL-MESSAGE          PIC X(50).
   280     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   281     03  FILLER                  PIC X(31).
   282 01  W-WORK-AREAS.
   283     12  FILLER                  PIC  X(18)
   284                                      VALUE 'PROGRAM WORK AREA:'.
   285
   286     12  W-ASKTIME-CTR           PIC S9(04)  COMP   VALUE +0.
   287     12  W-CWA-NDX               PIC S9(04)  COMP   VALUE +0.
   288     12  W-DISPLAY-NDX           PIC S9(04)  COMP   VALUE +0.
   289     12  W-FIRST-BAD-VARIABLE    PIC S9(04)  COMP   VALUE +0.
   290     12  W-NDX                   PIC S9(04)  COMP   VALUE +0.
   291     12  W-NDX2                  PIC S9(04)  COMP   VALUE +0.
   292     12  W-SEQ-CTR               PIC S9(04)  COMP   VALUE +0.
   293     12  W-TS-ITEM               PIC S9(04)  COMP   VALUE +0.
   294     12  W-TOTAL-LINE-LENGTH     PIC S9(04)  COMP   VALUE +0.
   295     12  W-WORK-NDX              PIC S9(04)  COMP   VALUE +0.
   296
   297     12  W-ADJUST-SHORT          PIC S9(03) VALUE +0   COMP-3.
   298     12  W-DIFFERENCE            PIC S9(07)V9(02)
   299                                            VALUE +0   COMP-3.
   300     12  W-INITIAL-COLUMN        PIC S9(03) VALUE +0   COMP-3.
   301     12  W-LAST-COLUMN           PIC S9(03) VALUE +70 COMP-3.
   302     12  W-LAST-SQUEEZED-SPACE   PIC S9(03) VALUE +0   COMP-3.
   303     12  W-LAST-TX-SPACE         PIC S9(03) VALUE +0   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page   7
* EL689.cbl
   304     12  W-LAST-WC-SPACE         PIC S9(03) VALUE +0   COMP-3.
   305     12  W-LINE-COUNT            PIC S9(03) VALUE +0   COMP-3.
   306     12  W-LINE-INDENT-1         PIC  9(02) VALUE 0    COMP-3.
   307     12  W-LINE-INDENT-2         PIC  9(02) VALUE 0    COMP-3.
   308     12  W-LINE-INDENT-3         PIC  9(02) VALUE 0    COMP-3.
   309     12  W-LINE-INDENT-4         PIC  9(02) VALUE 0    COMP-3.
   310     12  W-LINE-INDENT-5         PIC  9(02) VALUE 0    COMP-3.
   311     12  W-MAX-LINES-PER-PAGE    PIC  9(02) VALUE 56   COMP-3.
   312     12  W-NEXT-INDENT           PIC  9(02) VALUE 0    COMP-3.
   313     12  W-PAGE                  PIC S9(02) VALUE +0   COMP-3.
   314     12  W-PAGE-LINE             PIC S9(03) VALUE +0   COMP-3.
   315     12  W-PARAGRAPH-INDENT      PIC  9(02) VALUE 0    COMP-3.
   316     12  W-ROLL-COUNTER          PIC S9(03) VALUE +0   COMP-3.
   317     12  W-START-COLUMN          PIC S9(03) VALUE +1   COMP-3.
   318     12  W-TEMP-CURRENT-LINE     PIC S9(03) VALUE +0   COMP-3.
   319     12  W-TOO-FAR               PIC S9(03) VALUE +71 COMP-3.
   320     12  W-TOP-MARGIN            PIC  9(02) VALUE 0    COMP-3.
   321     12  W-TOTAL-TX-LINES        PIC S9(03) VALUE +0   COMP-3.
   322     12  W-TS-GROUP-WORK         PIC  9(05) VALUE 0    COMP-3.
   323     12  W-WORK-INDENT           PIC  9(02) VALUE 0    COMP-3.
   324     12  W-WORK-AMOUNT           PIC S9(09)V9(02)
   325                                            VALUE +0   COMP-3.
   326
   327     12  W-DATA-SOURCE           PIC  9(01) VALUE 0.
   328     12  W-LABEL-SOURCE          PIC  9(01) value 0.
   329         88  W-LABEL-SOURCE-VALID           VALUE 1 THRU 7.
   330     12  W-LABEL-JOINT-NAME      PIC  X(30) VALUE SPACES.
   331     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   332     12  W-NUMB-LABEL-LINES      PIC  9(01) VALUE 0.
   333     12  W-PRINT-CONTROL         PIC  9(02) VALUE 0.
   334     12  W-SAVE-REVISION         PIC  9(03) value 0.
   335     12  W-DISPLAY-3             PIC  9(03) value 0.
   336     12  W-DISPLAY-8             PIC  9(08) value 0.
   337     12  W-DISPLAY-7             PIC  9(07) value 0.
   338     12  W-EDIT-2-5-S            PIC  Z9.9(05).
   339     12  W-EDIT-3-0              PIC  ZZ9.
   340     12  W-EDIT-7-2              PIC  $$,$$$,$$9.99.
   341     12  W-EDIT-7-2-NEGATIVE     PIC  $$,$$$,$$9.99-.
   342     12  W-EDIT-9-2              PIC  $$$$,$$$,$$9.99.
   343     12  W-EDIT-12-2             PIC  $$$$,$$$,$$$,$$9.99.
   344
   345     12  WS-ACCT-PKEY-MATCH-SW   PIC  X(01) VALUE SPACE.
   346         88  PRIOR-MATCH-ACCT-PKEY          VALUE 'Y'.
   347
   348     12  W-ARCH-SUPPRESS         PIC 99999999.
   349     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   350                                 PIC  X(08).
   351     12  W-COMP-WORK-AREA.
   352         16  W-CWA-CHAR OCCURS 10 TIMES
   353                                 PIC  X(01).
   354     12  W-INCOMING-ARCHIVE      PIC  X(08).
   355     12  W-INCOMING-ARCH-NO REDEFINES W-INCOMING-ARCHIVE
   356                                 PIC  9(08).
   357
   358     12  W-BATCH-BREAKDOWN.
   359         16  W-BATCH-CONTROL     PIC S9(08) COMP.
   360         16  W-BATCH-SEQ         PIC S9(04) COMP.
   361     12  W-BEN-HOLD              PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page   8
* EL689.cbl
   362     12  W-BENEFIT-WORK          PIC  X(03).
   363     12  W-BEN-R REDEFINES W-BENEFIT-WORK.
   364         16  W-ELIM-DAYS         PIC  X(02).
   365         16  FILLER              PIC  X(01).
   366     12  W-CALL-PGM              PIC  X(08).
   367     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   368
   369     12  FILLER                  PIC  X(09) VALUE 'LINE CNTL'.
   370     12  W-LINE-CONTROL-RECORD.
   371         16  W-LC-LINE-WIDTH     PIC  9(02).
   372         16  FILLER              PIC  X(01).
   373         16  W-LC-PARAGRAPH-INDENT
   374                                 PIC  9(02).
   375         16  FILLER              PIC  X(01).
   376         16  W-LC-MAX-LINES-PER-PAGE
   377                                 PIC  9(02).
   378         16  FILLER              PIC  X(01).
   379         16  W-LC-LINE-ADJUST    PIC  9(02).
   380         16  FILLER              PIC  X(01).
   381         16  W-LC-LINE-INDENT-1  PIC  9(02).
   382         16  FILLER              PIC  X(01).
   383         16  W-LC-LINE-INDENT-2  PIC  9(02).
   384         16  FILLER              PIC  X(01).
   385         16  W-LC-LINE-INDENT-3  PIC  9(02).
   386         16  FILLER              PIC  X(01).
   387         16  W-LC-LINE-INDENT-4  PIC  9(02).
   388         16  FILLER              PIC  X(01).
   389         16  W-LC-LINE-INDENT-5  PIC  9(02).
   390         16  FILLER              PIC  X(01).
   391         16  W-LC-TOP-MARGIN     PIC  9(02).
   392         16  FILLER              PIC  X(01).
   393         16  W-LC-CASE-IND       PIC  X(01).
   394             88  W-LC-USE-BOTH-CASES        VALUE 'Y'.
   395         16  FILLER              PIC  X(01).
   396         16  W-LC-PAGE-IND       PIC  X(01).
   397             88  W-LC-CREATE-PAGES          VALUE 'Y'.
   398     12  W-DATE-WORK             PIC  9(07).
   399     12  W-DT-REDEF REDEFINES W-DATE-WORK.
   400         16  FILLER              PIC  X(02).
   401         16  W-DT-WORK           PIC  9(05).
   402
   403     12  W-DEEDIT-FIELD          PIC  X(15).
   404     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   405
   406     12  W-EDIT-DATE-1.
   407         16  W-ED1-MM            PIC  X(02).
   408         16  FILLER              PIC  X(01) VALUE '/'.
   409         16  W-ED1-DD            PIC  X(02).
   410         16  FILLER              PIC  X(01) VALUE '/'.
   411         16  W-ED1-YY            PIC  X(02).
   412
   413     12  W-EDIT-DATE-2.
   414         16  W-ED2-DD            PIC  X(02).
   415         16  FILLER              PIC  X(01) VALUE '/'.
   416         16  W-ED2-MM            PIC  X(02).
   417         16  FILLER              PIC  X(01) VALUE '/'.
   418         16  W-ED2-YY            PIC  X(02).
   419
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page   9
* EL689.cbl
   420     12  W-EDIT-A-DATE.
   421         16  W-EDIT-A-MM                  PIC X(2).
   422         16  FILLER                       PIC X(1).
   423         16  W-EDIT-A-DD                  PIC X(2).
   424         16  FILLER                       PIC X(1).
   425         16  W-EDIT-A-CCYY.
   426             20  W-EDIT-A-CC              PIC X(2).
   427             20  W-EDIT-A-YY              PIC X(2).
   428
   429     12  W-LABEL-HOLD-AREA.
   430         16  W-LABEL-LINES OCCURS 6 TIMES.
   431             20  W-LABEL-ZIP.
   432                 24  W-LABEL-1ST-ZIP  PIC  X(05).
   433                 24  W-LABEL-DASH     PIC  X(01).
   434                 24  W-LABEL-2ND-ZIP  PIC  X(04).
   435             20  W-LAB-CAN-POSTAL-CODES REDEFINES W-LABEL-ZIP.
   436                 24  W-LAB-CAN-POSTAL-CD-1
   437                                      PIC  X(03).
   438                 24  W-LAB-CAN-DASH   PIC  X(01).
   439                 24  W-LAB-CAN-POSTAL-CD-2
   440                                      PIC  X(03).
   441                 24  W-LAB-CAN-FILLER PIC  X(03).
   442             20  FILLER               PIC  X(10).
   443             20  W-LAST-ZIP.
   444                 24  W-LAST-1ST-ZIP   PIC  X(05).
   445                 24  W-LABEL-DASH-LAST
   446                                      PIC  X(01).
   447                 24  W-LAST-2ND-ZIP   PIC  X(04).
   448             20  W-LAST-CAN-POSTAL-CODES REDEFINES W-LAST-ZIP.
   449                 24  W-LAST-CAN-POSTAL-CD-1
   450                                      PIC  X(03).
   451                 24  W-LAST-CAN-DASH  PIC  X(01).
   452                 24  W-LAST-CAN-POSTAL-CD-2
   453                                      PIC  X(03).
   454                 24  W-LAST-CAN-FILLER
   455                                      PIC  X(03).
   456
   457     12  W-LAST-CHAR             PIC  X(01).
   458         88  W-LAST-CHAR-PUNC    VALUE '-' '/'.
   459     12  W-LAST-SQ-CHAR          PIC  X(01).
   460
   461     12  W-LINE-NUM.
   462         16  W-LINE1             PIC  X(01).
   463         16  W-LINE23            PIC  9(02).
   464     12  W-LIN-NUM REDEFINES W-LINE-NUM
   465                                 PIC  9(03).
   466
   467     12  W-NAME-LAST             PIC  X(15).
   468     12  W-NAME-FIRST.
   469         16  W-NAME-FIRST-INIT   PIC  X(01).
   470         16  W-NAME-FIRST-REMAIN PIC  X(14).
   471     12  W-NAME-MIDDLE.
   472         16  FILLER              PIC  X(01).
   473         16  W-NAME-MIDDLE-2     PIC  X(01).
   474         16  FILLER              PIC  X(13).
   475
   476     12  W-PAGE-PRT.
   477         16  FILLER              PIC  X(34) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  10
* EL689.cbl
   478         16  W-PAGE-NUMBER       PIC  Z9.
   479         16  FILLER              PIC  X(01) VALUE '.'.
   480         16  FILLER              PIC  X(33) VALUE SPACES.
   481
   482     12  W-PHONE-IN              PIC  9(11) VALUE ZEROS.
   483     12  W-PHONE-IN-R   REDEFINES W-PHONE-IN.
   484         16  FILLER              PIC  9(01).
   485         16  W-PHI-AREA          PIC  9(03).
   486         16  W-PHI-PFX           PIC  9(03).
   487         16  W-PHI-SFX           PIC  9(04).
   488     12  W-PHONE-OUT.
   489         16  W-PO-AREA           PIC  X(03).
   490         16  FILLER              PIC  X(01) VALUE '-'.
   491         16  W-PO-PFX            PIC  X(03).
   492         16  FILLER              PIC  X(01) VALUE '-'.
   493         16  W-PO-SFX            PIC  X(04).
   494
   495     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   496     12  W-SAVE-BIN-NEXT-BUS-DT  PIC  X(02) VALUE SPACES.
   497     12  W-SAVE-NEXT-BUS-DT-EDIT-A PIC X(10)   VALUE SPACES.
   498     12  W-SAVE-CYCLE-DAY-OF-WEEK PIC S9   COMP-3 VALUE +0.
   499     12  W-SAVE-EDIT-A-DATE      PIC  X(10) VALUE SPACES.
   500     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   501     12  W-SAVE-PLAN             PIC  X(02) VALUE SPACES.
   502
   503     12  W-SINGLE-LINE           PIC  X(70).
   504     12  W-SINGLE-LINE-BY REDEFINES W-SINGLE-LINE.
   505         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY NDX1 NDX2 NDXA
   506                                 PIC  X(01).
   507
   508     12  W-SQUEEZED-LINE.
   509         16  W-SQ-CHAR OCCURS 70 TIMES
   510                       INDEXED BY W-SQ-NDX
   511                                 PIC  X(01).
   512
   513     12  W-TIME-IN               PIC S9(07).
   514     12  W-TIME-OUT-R REDEFINES W-TIME-IN.
   515         16  FILLER              PIC  X(01).
   516         16  W-TIME-OUT          PIC  99V9(02).
   517         16  FILLER              PIC  X(02).
   518
   519     12  W-TS-NAME-TEXT.
   520         16  W-TS-ID-TEXT        PIC  X(04) VALUE '104A'.
   521         16  W-TS-ID-TIME
   522             REDEFINES W-TS-ID-TEXT
   523                                 PIC S9(07) COMP-3.
   524         16  W-TS-TERM-TEXT.
   525             20 W-TS-TERM-PREFIX PIC  X(02).
   526             20 FILLER           PIC  X(02).
   527     12  W-TS-NAME-SCREEN.
   528         16  FILLER              PIC  X(04) VALUE '689X'.
   529         16  W-TS-TERM-SCREEN    PIC  X(04).
   530
   531     12  W-WORK-LINE.
   532         16  W-WORK-CHAR OCCURS 70 TIMES
   533                       INDEXED BY W-WC-NDX
   534                                  W-WC-NDX2
   535                                  W-WC-NDX3
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  11
* EL689.cbl
   536                                 PIC  X(01).
   537
   538     12  W-WORK-ZIP-NUMERIC      PIC  9(09).
   539     12  W-WORK-ZIP REDEFINES W-WORK-ZIP-NUMERIC.
   540         16  W-WORK-ZIP5         PIC  X(05).
   541         16  W-WORK-ZIP4         PIC  X(04).
   542     12  W-CANADIAN-POSTAL-CODES REDEFINES W-WORK-ZIP-NUMERIC.
   543         16  W-CAN-POSTAL-CD-1.
   544             20  FILLER          PIC  X(01).
   545                 88 W-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   546             20  FILLER          PIC  X(02).
   547         16  W-CAN-POSTAL-CD-2   PIC  X(03).
   548         16  W-FILLER            PIC  X(03).
   549
   550**** Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   551*                   COPY ELCZREC.
   552******************************************************************
   553*                                                                *
   554*                                                                *
   555*                            ELCZREC.                            *
   556*                                                                *
   557*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   558*                                                                *
   559******************************************************************
   560*-----------------------------------------------------------------
   561*                   C H A N G E   L O G
   562*
   563* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   564*-----------------------------------------------------------------
   565*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   566* EFFECTIVE    NUMBER
   567*-----------------------------------------------------------------
   568* 122011    2011022800001  AJRA  NEW FILE
   569* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   570* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   571* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   572* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   573*-----------------------------------------------------------------
   574 01  W-Z-CONTROL-DATA.
   575     05  W-NUMBER-OF-COPIES      PIC  9.
   576     05  FILLER                  PIC  X.
   577     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   578     05  FILLER                  PIC  X.
   579     05  W-DAYS-TO-RESEND        PIC  999.
   580     05  FILLER                  PIC  X.
   581     05  W-FORM-TO-RESEND        PIC  X(4).
   582     05  W-ADD-BAR-CODE          PIC  X.
   583     05  W-PROMPT-LETTER         PIC  X.
   584     05  W-HAS-RETURN-ENV        PIC  X.
   585     05  W-ENCLOSURE-CD          PIC  XXX.
   586     05  W-SIG-FLAG-DEFAULT      PIC  X.
   587     05  W-AUTO-CLOSE-IND        PIC  X.
   588     05  FILLER                  PIC  X.
   589     05  W-LETTER-TO-BENE        PIC  X.
   590     05  FILLER                  PIC  X.
   591     05  W-LETTER-TO-ACCT        PIC  X.
   592     05  FILLER                  PIC  X.
   593     05  W-LETTER-TYPE           PIC  X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  12
* EL689.cbl
   594     05  FILLER                  PIC  X.
   595     05  W-PRINT-CERTIFICATE     PIC  X.
   596     05  FILLER                  PIC  X.
   597     05  W-REFUND-REQUIRED       PIC  X.
   598     05  FILLER                  PIC  X.
   599     05  W-ONBASE-CODE           PIC  XX.
   600     05  FILLER                  PIC  X.
   601     05  W-ACCT-SUMM             PIC  X.
   602     05  FILLER                  PIC  X.
   603     05  W-CSO-SUMM              PIC  X.
   604     05  FILLER                  PIC  X.
   605     05  W-REASONS-REQUIRED      PIC  X.
   606     05  FILLER                  PIC  X(29).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  13
* EL689.cbl
   608 01  W-SWITCH-INDICATORS-AREA.
   609     12  FILLER                  PIC  X(16)
   610                                      VALUE 'PROGRAM SWITCHS:'.
   611     12  W-ADDRESS-ONLY-SW       PIC  X(01) VALUE ' '.
   612         88  W-ADDRESS-ONLY      VALUE 'Y'.
   613         88  W-FULL-DATA         VALUE ' '.
   614     12  W-ACCT-BROWSE-STARTED-SW
   615                                 PIC  X(01) VALUE 'N'.
   616         88  W-ACCT-BROWSE-STARTED          VALUE 'Y'.
   617     12  W-ARCT-BROWSE-STARTED   PIC  X(01) VALUE 'N'.
   618     12  W-CERT-FOUND-SW         PIC  X(01) VALUE 'N'.
   619         88  W-CERT-FOUND                   VALUE 'Y'.
   620     12  W-CHARACTER-TYPE        PIC  X(01).
   621         88  W-END-OF-SENTENCE   VALUE '.' '?' '!'.
   622         88  W-PUNCTUATION       VALUE '.' '?' '!' ',' ';'.
   623         88  W-SPACE             VALUE ' '.
   624     12  W-COMP-BROWSE-SW        PIC  X(01) VALUE 'N'.
   625         88  W-COMP-BROWSE-STARTED          VALUE 'Y'.
   626     12  W-DATA-SHRINK-IND       PIC  X(01) VALUE SPACES.
   627         88  W-DATA-SHRINKING    VALUE 'Y'.
   628     12  W-END-OF-SENTENCE-IND   PIC  X(01) VALUE SPACES.
   629         88  W-END-OF-SENTENCE-WORKING      VALUE 'Y'.
   630     12  W-FIRST-BAD-VARIABLE-IND
   631                                 PIC  X(01) VALUE SPACES.
   632         88  W-FIRST-BAD-VARIABLE-FOUND     VALUE 'Y'.
   633     12  W-FIRST-CHAR-FOUND-IND  PIC  X(01) VALUE SPACES.
   634         88  W-FIRST-CHAR-FOUND             VALUE 'Y'.
   635         88  W-FIRST-CHAR-NOT-FOUND         VALUE SPACES.
   636     12  W-FORM-CHANGED-IND      PIC  X(01) VALUE SPACES.
   637         88  W-FORM-CHANGED                 VALUE 'Y'.
   638     12  W-FORM-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   639         88  W-FORM-SQUEEZE-ON              VALUE 'Y'.
   640         88  W-FORM-SQUEEZE-OFF             VALUE ' '.
   641     12  W-HOLD-IND              PIC  X(01) VALUE SPACES.
   642         88  W-HOLD-ON                      VALUE 'Y'.
   643         88  W-HOLD-OFF                     VALUE ' '.
   644     12  W-INDIVIDUAL-DATA-SW    PIC  X(01) VALUE ' '.
   645         88  W-INDIVIDUAL-DATA-COMPLETED    VALUE 'Y'.
   646         88  W-INDIV-DATA-NOT-COMPLETED     VALUE ' '.
   647     12  W-KEY-FIELDS-CHANGED-IND
   648                                 PIC  X(01) VALUE ' '.
   649         88  W-KEY-FIELDS-CHANGED           VALUE 'Y'.
   650         88  W-KEY-FIELDS-NOT-CHANGED       VALUE ' '.
   651     12  W-LAST-ONE              PIC  X(01) VALUE HIGH-VALUES.
   652         88  W-LAST-ONE-A-SPACE  VALUE ' '.
   653     12  W-LINE-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   654         88  W-NEW-PARAGRAPH                VALUE 'P' 'Q' 'R' 'S'
   655                                                   'T' 'U'.
   656         88  W-CONTINUE-PARAGRAPH           VALUE 'C' 'D' 'E' 'F'
   657                                                   'G' 'H'.
   658         88  W-FORM-CONTROL-LINE            VALUE 'K'.
   659         88  W-DO-NOT-ADJUST                VALUE 'N'.
   660         88  W-ADJUST-TO-LINE-LENGTH        VALUE 'A'.
   661         88  W-AS-IS                        VALUE 'A' 'N'.
   662         88  W-CONTINUE-PREVIOUS-PROCESS    VALUE ' ' '1' '2' '3'
   663                                                   '4' '5'.
   664
   665     12  W-PNDB-FOUND-SW         PIC  X(01) VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  14
* EL689.cbl
   666         88  W-PNDB-FOUND                   VALUE 'Y'.
   667     12  W-REMAINING-VAR-SW      PIC  X(01) VALUE SPACES.
   668         88  W-REMAINING-VAR-FOUND          VALUE 'Y'.
   669     12  W-REVERSE-DATE-SW       PIC  X(01) VALUE SPACES.
   670         88  W-REVERSE-DATE                 VALUE 'Y'.
   671     12  W-TEXT-BROWSED-SW       PIC  X(01) VALUE 'N'.
   672         88  W-TEXT-BROWSE-STARTED          VALUE 'Y'.
   673         88  W-TEXT-BROWSE-NOT-STARTED      VALUE 'N'.
   674
   675     12  W-VALID-ENDT-SW         PIC  X(01) VALUE 'N'.
   676         88  W-VALID-ENDT                   VALUE 'Y'.
   677     12  W-RESPONSE              PIC S9(8)   COMP.
   678         88  RESP-NORMAL                  VALUE +00.
   679         88  RESP-NOTFND                  VALUE +13.
   680         88  RESP-DUPREC                  VALUE +14.
   681         88  RESP-DUPKEY                  VALUE +15.
   682         88  RESP-NOTOPEN                 VALUE +19.
   683         88  RESP-ENDFILE                 VALUE +20.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  15
* EL689.cbl
   685 01  WS-SAVE-AREA.
   686     12  WS-SAV-AM-DEFN-1.
   687         16  WS-SAV-AM-AGT-COMMS OCCURS 10 TIMES.
   688             20  WS-SAV-AM-AGT             PIC  X(10).
   689             20  WS-SAV-AM-COM-TYP         PIC  X(01).
   690             20  FILLER                    PIC  X(15).
   691     12  WS-SAV-AM-REMIT-TO                PIC  9(02).
   692     12  WS-SAV-AM-CSR-CODE                PIC  X(04).
   693     12  WS-SAV-AM-CARRIER                 PIC  X(01).
   694     12  WS-SAV-AM-ACCOUNT                 PIC  X(10).
   695     12  WS-SAV-AM-CONTROL-NAME            PIC  X(30).
   696     12  WS-SAV-AM-NAME                    PIC  X(30).
   697     12  WS-SAV-AM-PERSON                  PIC  X(30).
   698     12  WS-SAV-AM-ADDRS                   PIC  X(30).
   699     12  WS-SAV-AM-CITY                    PIC  X(30).
   700     12  WS-SAV-AM-ERACCT-ACCOUNT          PIC  X(10).
   701     12  WS-SAV-AM-ZIP.
   702         16  WS-SAV-AM-ZIP-PRIME.
   703             20  WS-SAV-AM-ZIP-PRI-1ST     PIC  X(01).
   704                 88  SAVE-AM-CANADIAN-POST-CODE       VALUE
   705                     'A' THRU 'Z'.
   706             20  FILLER                    PIC  X(04).
   707         16  FILLER                        PIC  X(04).
   708     12  WS-SAV-AM-CANADIAN-POSTAL-CODE REDEFINES
   709                        WS-SAV-AM-ZIP      PIC  X(09).
   710     12  WS-SAV-AM-TEL-NO.
   711         16  WS-SAV-AM-AREA-CODE           PIC 9(03).
   712         16  WS-SAV-AM-TEL-PRE             PIC 9(03).
   713         16  WS-SAV-AM-TEL-NBR             PIC 9(04).
   714 01  W-KEY-AREAS.
   715     12  FILLER                    PIC  X(13)
   716                                      VALUE 'PROGRAM KEYS:'.
   717
   718     12  W-ACCT-SAVE-KEY           PIC  X(20).
   719     12  W-ACCT-KEY.
   720         16  W-ACCT-PARTIAL-KEY.
   721             20  W-ACCT-COMPANY-CD PIC  X(01).
   722             20  W-ACCT-CARRIER    PIC  X(01).
   723             20  W-ACCT-GROUPING   PIC  X(06).
   724             20  W-ACCT-STATE      PIC  X(02).
   725             20  W-ACCT-ACCOUNT    PIC  X(10).
   726         16  W-ACCT-EXP-DT         PIC  X(02).
   727
   728     12  W-ARCH-SAVE-KEY         PIC  X(05).
   729     12  W-ARCH-KEY.
   730         16  W-ARCH-PARTIAL-KEY.
   731             20  W-ARCH-COMPANY-CD
   732                                 PIC  X(01).
   733             20  W-ARCH-NUMBER   PIC S9(08)      COMP.
   734         16  W-ARCH-SEQ-NO       PIC S9(04)      COMP VALUE +0.
   735
   736     12  W-ARCT-KEY.
   737         16  W-ARCT-PARTIAL-KEY.
   738             20  W-ARCT-COMPANY-CD
   739                                 PIC  X(01).
   740             20  W-ARCT-NUMBER   PIC S9(08)      COMP.
   741         16  W-ARCT-REC-TYPE     PIC  X(01).
   742         16  W-ARCT-SEQ-NO       PIC S9(04)      COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  16
* EL689.cbl
   743
   744     12  W-CERT-KEY.
   745         16  W-CERT-COMPANY-CD   PIC  X(01).
   746         16  W-CERT-CARRIER      PIC  X(01).
   747         16  W-CERT-GROUPING     PIC  X(06).
   748         16  W-CERT-STATE        PIC  X(02).
   749         16  W-CERT-ACCOUNT      PIC  X(10).
   750         16  W-CERT-EFF-DT       PIC  X(02).
   751         16  W-CERT-CERT-NO.
   752             20  W-CERT-CERT-PRIME
   753                                 PIC  X(10).
   754             20  W-CERT-CERT-SFX PIC  X(01).
   755
   756     12  W-CHEK-KEY.
   757         16  W-CHEK-COMPANY-CD   PIC  X(01).
   758         16  W-CHEK-CARRIER      PIC  X(01).
   759         16  W-CHEK-GROUPING     PIC  X(06).
   760         16  W-CHEK-STATE        PIC  X(02).
   761         16  W-CHEK-ACCOUNT      PIC  X(10).
   762         16  W-CHEK-EFF-DT       PIC  X(02).
   763         16  W-CHEK-CERT-NO.
   764             20  W-CHEK-CERT-PRIME
   765                                 PIC  X(10).
   766             20  W-CHEK-CERT-SFX PIC  X(01).
   767         16  W-CHEK-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   768
   769     12  W-CNTL-KEY.
   770         16  W-CNTL-COMPANY-ID   PIC  X(03).
   771         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   772         16  W-CNTL-GENL.
   773             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   774             20  W-CNTL-GEN2.
   775                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   776                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   777         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   778
   779     12  W-COMP-SAVE-KEY         PIC  X(29).
   780     12  W-COMP-KEY.
   781         16  W-COMP-COMPANY-CD   PIC  X(01).
   782         16  W-COMP-CARRIER      PIC  X(01).
   783         16  W-COMP-GROUPING     PIC  X(06).
   784         16  W-COMP-RESP-PERSON.
   785             20  W-COMP-RP-CHAR OCCURS 10 TIMES
   786                                INDEXED BY W-COMP-NDX
   787                                 PIC  X(01).
   788         16  W-COMP-ACCOUNT      PIC  X(10).
   789         16  W-COMP-TYPE         PIC  X(01).
   790
   791     12  W-DELETE-KEY.
   792         16  W-DELETE-PARTIAL-KEY.
   793             20  W-DELETE-COMPANY-CD
   794                                 PIC  X(01).
   795             20  W-DELETE-NUMBER PIC S9(08)      COMP.
   796         16  W-DELETE-RECORD-TYPE
   797                                 PIC  X(01).
   798         16  W-DELETE-SEQ        PIC S9(04)      COMP VALUE +0.
   799
   800     12  W-MAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  17
* EL689.cbl
   801         16  W-MAIL-COMPANY-CD   PIC  X(01).
   802         16  W-MAIL-CARRIER      PIC  X(01).
   803         16  W-MAIL-GROUPING     PIC  X(06).
   804         16  W-MAIL-STATE        PIC  X(02).
   805         16  W-MAIL-ACCOUNT      PIC  X(10).
   806         16  W-MAIL-EFF-DT       PIC  X(02).
   807         16  W-MAIL-CERT-NO.
   808             20  W-MAIL-CERT-PRIME
   809                                 PIC  X(10).
   810             20  W-MAIL-CERT-SFX PIC  X(01).
   811
   812     12  W-PNDB-KEY.
   813         16  W-PNDB-COMPANY-CD   PIC  X(01).
   814         16  W-PNDB-ENTRY        PIC  X(06).
   815         16  W-PNDB-SEQ-NO       PIC S9(04)  COMP.
   816         16  W-PNDB-CHG-SEQ-NO   PIC S9(04)  COMP.
   817
   818     12  W-PNDB2-KEY.
   819         16  W-PNDB2-COMPANY-CD  PIC  X(01).
   820         16  W-PNDB2-CARRIER     PIC  X(01).
   821         16  W-PNDB2-GROUPING    PIC  X(06).
   822         16  W-PNDB2-STATE       PIC  X(02).
   823         16  W-PNDB2-ACCOUNT     PIC  X(10).
   824         16  W-PNDB2-EFF-DT      PIC  X(02).
   825         16  W-PNDB2-CERT-NO.
   826             20  W-PNDB2-CERT-PRIME
   827                                 PIC  X(10).
   828             20  W-PNDB2-CERT-SFX
   829                                 PIC  X(01).
   830         16  W-PNDB2-ALT-CHG-SEQ-NO
   831                                 PIC S9(04)  COMP.
   832         16  W-PNDB2-TYPE        PIC  X(01).
   833
   834     12  W-PYAJ-KEY.
   835         16  W-PYAJ-COMPANY-CD   PIC  X(01).
   836         16  W-PYAJ-CARRIER      PIC  X(01).
   837         16  W-PYAJ-GROUPING     PIC  X(06).
   838         16  W-PYAJ-FIN-RESP     PIC  X(10).
   839         16  W-PYAJ-ACCOUNT      PIC  X(10).
   840         16  W-PYAJ-FILE-SEQ-NO  PIC S9(08)    COMP.
   841         16  W-PYAJ-RECORD-TYPE  PIC  X(01).
   842
   843     12  W-SC-QUID-KEY.
   844         16  W-SC-QUID-TERMINAL  PIC  X(04).
   845         16  W-SC-QUID-SYSTEM    PIC  X(04).
   846
   847     12  W-TEXT-SAVE-KEY         PIC  X(05).
   848     12  W-TEXT-KEY.
   849         16  W-TEXT-PARTIAL-KEY.
   850             20  W-TEXT-COMPANY-CD
   851                                 PIC  X(01).
   852             20  W-TEXT-LETTER   PIC  X(04).
   853         16  W-TEXT-FILLER       PIC  X(08)   VALUE SPACES.
   854         16  W-TEXT-SEQ          PIC S9(04)   VALUE +0    COMP.
   855
   856     12  W-ERENDT-KEY-BY-ARCH.
   857         16  W-ERENDT-COMPANY-CD-A1 PIC X.
   858         16  W-ERENDT-ARCHIVE       PIC 9(8) BINARY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  18
* EL689.cbl
   859
   860     12  W-ELEOBC-KEY.
   861         16  W-EOBC-COMPANY-CD   PIC X.
   862         16  W-EOBC-REC-TYPE     PIC X.
   863         16  W-EOBC-CODE         PIC X(4).
   864         16  FILLER              PIC X(9).
   865     12  W-ERNOTE-KEY.
   866         16  W-NOTE-COMPANY-CD   PIC X.
   867         16  W-NOTE-CARRIER      PIC X.
   868         16  W-NOTE-GROUPING     PIC X(6).
   869         16  W-NOTE-STATE        PIC XX.
   870         16  W-NOTE-ACCOUNT      PIC X(10).
   871         16  W-NOTE-CERT-EFF-DT  PIC XX.
   872         16  W-NOTE-CERT-PRIME   PIC X(10).
   873         16  W-NOTE-CERT-SFX     PIC X.
   874     12  W-SAVE-KEY.
   875         16  W-SV-COMPANY-CD     PIC X.
   876         16  W-SV-CARRIER        PIC X.
   877         16  W-SV-GROUPING       PIC X(6).
   878         16  W-SV-STATE          PIC XX.
   879         16  W-SV-ACCOUNT        PIC X(10).
   880         16  W-SV-CERT-EFF-DT    PIC XX.
   881         16  W-SV-CERT-PRIME     PIC X(10).
   882         16  W-SV-CERT-SFX       PIC X.
   883     12  W-BILLING-NOTE.
   884         16  W-BN-NOTE           PIC X(25).
   885         16  W-BN-LTRID          PIC X(4).
   886         16  FILLER              PIC X(3).
   887         16  W-BN-DATE           PIC X(8).
   888         16  FILLER              PIC X(3).
   889         16  W-BN-USERID         PIC X(4).
   890         16  FILLER              PIC X(30).
   891     12  W-LEN                   PIC S9(5) COMP-3 VALUE +0.
   892     12  NOTE-SUB                PIC S9(5) COMP-3 VALUE +0.
   893     12  W-CERT-UPDATE-SW        PIC X  VALUE ' '.
   894         88  NO-CERT-RW                 VALUE 'N'.
   895         88  CERT-RW                    VALUE 'Y'.
   896
   897     12  W-ELENCC-KEY.
   898         16  W-ENCC-COMPANY-CD   PIC X.
   899         16  W-ENCC-REC-TYPE     PIC X.
   900         16  W-ENCC-ENC-CODE     PIC X(5).
   901         16  FILLER              PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  19
* EL689.cbl
   903 01  FILLER                      PIC  X(22)
   904                                 VALUE 'INTERFACE AREA STARTS:'.
   905*    COPY ELCINTF.
   906******************************************************************
   907*                                                                *
   908*                                                                *
   909*                            ELCINTF.                            *
   910*                            VMOD=2.017                          *
   911*                                                                *
   912*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   913*                                                                *
   914*       LENGTH = 1024                                            *
   915*                                                                *
   916******************************************************************
   917*                   C H A N G E   L O G
   918*
   919* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   920*-----------------------------------------------------------------
   921*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   922* EFFECTIVE    NUMBER
   923*-----------------------------------------------------------------
   924* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   925******************************************************************
   926 01  PROGRAM-INTERFACE-BLOCK.
   927     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   928     12  PI-CALLING-PROGRAM              PIC X(8).
   929     12  PI-SAVED-PROGRAM-1              PIC X(8).
   930     12  PI-SAVED-PROGRAM-2              PIC X(8).
   931     12  PI-SAVED-PROGRAM-3              PIC X(8).
   932     12  PI-SAVED-PROGRAM-4              PIC X(8).
   933     12  PI-SAVED-PROGRAM-5              PIC X(8).
   934     12  PI-SAVED-PROGRAM-6              PIC X(8).
   935     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   936     12  PI-COMPANY-ID                   PIC XXX.
   937     12  PI-COMPANY-CD                   PIC X.
   938
   939     12  PI-COMPANY-PASSWORD             PIC X(8).
   940
   941     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   942
   943     12  PI-CONTROL-IN-PROGRESS.
   944         16  PI-CARRIER                  PIC X.
   945         16  PI-GROUPING                 PIC X(6).
   946         16  PI-STATE                    PIC XX.
   947         16  PI-ACCOUNT                  PIC X(10).
   948         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   949                                         PIC X(10).
   950         16  PI-CLAIM-CERT-GRP.
   951             20  PI-CLAIM-NO             PIC X(7).
   952             20  PI-CERT-NO.
   953                 25  PI-CERT-PRIME       PIC X(10).
   954                 25  PI-CERT-SFX         PIC X.
   955             20  PI-CERT-EFF-DT          PIC XX.
   956         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   957             20  PI-PLAN-CODE            PIC X(2).
   958             20  PI-REVISION-NUMBER      PIC X(3).
   959             20  PI-PLAN-EFF-DT          PIC X(2).
   960             20  PI-PLAN-EXP-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  20
* EL689.cbl
   961             20  FILLER                  PIC X(11).
   962         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   963             20  PI-OE-REFERENCE-1.
   964                 25  PI-OE-REF-1-PRIME   PIC X(18).
   965                 25  PI-OE-REF-1-SUFF    PIC XX.
   966
   967     12  PI-SESSION-IN-PROGRESS          PIC X.
   968         88  CLAIM-SESSION                   VALUE '1'.
   969         88  CREDIT-SESSION                  VALUE '2'.
   970         88  WARRANTY-SESSION                VALUE '3'.
   971         88  MORTGAGE-SESSION                VALUE '4'.
   972         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   973
   974
   975*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   976
   977     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   978     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   979
   980     12  PI-CREDIT-USER                  PIC X.
   981         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   982         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   983
   984     12  PI-CLAIM-USER                   PIC X.
   985         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   986         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   987
   988     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   989         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   990         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   991         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   992         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   993         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   994
   995     12  PI-PROCESSOR-ID                 PIC X(4).
   996
   997     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   998
   999     12  PI-MEMBER-CAPTION               PIC X(10).
  1000
  1001     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1002         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1003
  1004     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1005     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1006     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1007     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1008
  1009     12  PI-AH-OVERRIDE-L1               PIC X.
  1010     12  PI-AH-OVERRIDE-L2               PIC XX.
  1011     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1012     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1013
  1014     12  PI-NEW-SYSTEM                   PIC X(2).
  1015
  1016     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1017     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1018         88  PI-USES-PAID-TO                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  21
* EL689.cbl
  1019     12  PI-CRDTCRD-SYSTEM.
  1020         16  PI-CRDTCRD-USER             PIC X.
  1021             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1022             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1023         16  PI-CC-MONTH-END-DT          PIC XX.
  1024     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1025
  1026     12  PI-OE-REFERENCE-2.
  1027         16  PI-OE-REF-2-PRIME           PIC X(10).
  1028         16  PI-OE-REF-2-SUFF            PIC X.
  1029
  1030     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1031
  1032     12  PI-LANGUAGE-TYPE                PIC X.
  1033             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1034             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1035             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1036
  1037     12  PI-POLICY-LINKAGE-IND           PIC X.
  1038         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1039         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1040                                                   LOW-VALUES.
  1041
  1042     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1043     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1044         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1045         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1046
  1047     12  PI-PROCESSOR-CSR-IND            PIC X.
  1048         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1049         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1050
  1051     12  FILLER                          PIC X(3).
  1052
  1053     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1054
  1055     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1056         PI-SYSTEM-LEVEL.
  1057
  1058         16  PI-ENTRY-CODES.
  1059             20  PI-ENTRY-CD-1           PIC X.
  1060             20  PI-ENTRY-CD-2           PIC X.
  1061
  1062         16  PI-RETURN-CODES.
  1063             20  PI-RETURN-CD-1          PIC X.
  1064             20  PI-RETURN-CD-2          PIC X.
  1065
  1066         16  PI-UPDATE-STATUS-SAVE.
  1067             20  PI-UPDATE-BY            PIC X(4).
  1068             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1069
  1070         16  PI-LOWER-CASE-LETTERS       PIC X.
  1071             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1072
  1073*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1074*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1075*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1076
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  22
* EL689.cbl
  1077         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1078             88  ST-ACCNT-CNTL               VALUE ' '.
  1079             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1080             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1081             88  ACCNT-CNTL                  VALUE '3'.
  1082             88  CARR-ACCNT-CNTL             VALUE '4'.
  1083
  1084         16  PI-PROCESSOR-CAP-LIST.
  1085             20  PI-SYSTEM-CONTROLS.
  1086                24 PI-SYSTEM-DISPLAY     PIC X.
  1087                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1088                24 PI-SYSTEM-MODIFY      PIC X.
  1089                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1090             20  FILLER                  PIC XX.
  1091             20  PI-DISPLAY-CAP          PIC X.
  1092                 88  DISPLAY-CAP             VALUE 'Y'.
  1093             20  PI-MODIFY-CAP           PIC X.
  1094                 88  MODIFY-CAP              VALUE 'Y'.
  1095             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1096                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1097             20  PI-FORCE-CAP            PIC X.
  1098                 88  FORCE-CAP               VALUE 'Y'.
  1099
  1100         16  PI-PROGRAM-CONTROLS.
  1101             20  PI-PGM-PRINT-OPT        PIC X.
  1102             20  PI-PGM-FORMAT-OPT       PIC X.
  1103             20  PI-PGM-PROCESS-OPT      PIC X.
  1104             20  PI-PGM-TOTALS-OPT       PIC X.
  1105
  1106         16  PI-HELP-INTERFACE.
  1107             20  PI-LAST-ERROR-NO        PIC X(4).
  1108             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1109
  1110         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1111             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1112
  1113         16  PI-CR-CONTROL-IN-PROGRESS.
  1114             20  PI-CR-CARRIER           PIC X.
  1115             20  PI-CR-GROUPING          PIC X(6).
  1116             20  PI-CR-STATE             PIC XX.
  1117             20  PI-CR-ACCOUNT           PIC X(10).
  1118             20  PI-CR-FIN-RESP          PIC X(10).
  1119             20  PI-CR-TYPE              PIC X.
  1120
  1121         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1122
  1123         16  PI-CR-MONTH-END-DT          PIC XX.
  1124
  1125         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1126             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1127             88  PI-ZERO-CARRIER             VALUE '1'.
  1128             88  PI-ZERO-GROUPING            VALUE '2'.
  1129             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1130
  1131         16  PI-CARRIER-SECURITY         PIC X.
  1132             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1133
  1134         16  PI-ACCOUNT-SECURITY         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  23
* EL689.cbl
  1135             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1136             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1137
  1138         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1139             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1140                                         INDEXED BY PI-ACCESS-NDX
  1141                                         PIC X.
  1142
  1143         16  PI-GA-BILLING-CONTROL       PIC X.
  1144             88  PI-GA-BILLING               VALUE '1'.
  1145
  1146         16  PI-MAIL-PROCESSING          PIC X.
  1147             88  PI-MAIL-YES                 VALUE 'Y'.
  1148
  1149         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1150
  1151         16  PI-AR-SYSTEM.
  1152             20  PI-AR-PROCESSING-CNTL   PIC X.
  1153                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1154             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1155             20  PI-AR-MONTH-END-DT      PIC XX.
  1156
  1157         16  PI-MP-SYSTEM.
  1158             20  PI-MORTGAGE-USER            PIC X.
  1159                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1160                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1161             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1162                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1163                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1164                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1165                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1166                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1167             20  PI-MP-MONTH-END-DT          PIC XX.
  1168             20  PI-MP-REFERENCE-NO.
  1169                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1170                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1171
  1172         16  PI-LABEL-CONTROL            PIC X(01).
  1173             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1174             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1175
  1176         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1177             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1178
  1179         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1180             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1181             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1182
  1183         16  FILLER                      PIC X(14).
  1184
  1185     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1186******************************************************************
  1187     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1188*    COPY ELC1042.
  1189******************************************************************
  1190*                                                                *
  1191*                                                                *
  1192*                           ELC1042                              *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  24
* EL689.cbl
  1193*                            VMOD=2.002                          *
  1194*                                                                *
  1195*    NOTE                                                        *
  1196*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1197*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1198*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1199*        TO THESE PROGRAMS.                                      *
  1200*                                                                *
  1201*    NOTE                                                        *
  1202*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1203*        USE ONLY!                                               *
  1204*                                                                *
  1205******************************************************************
  1206
  1207         16  PI-1042-WA.
  1208             20  PI-ACTION       PIC  X(01).
  1209                 88 PI-SHOW-MODE           VALUE '1'.
  1210                 88 PI-CLEAR-MODE          VALUE '2'.
  1211                 88 PI-CREATE-MODE         VALUE '3'.
  1212             20  PI-COMM-CONTROL PIC  X(12).
  1213             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1214             20  PI-EOF-SW       PIC  X(01).
  1215                 88  PI-FILE-EOF           VALUE 'Y'.
  1216             20  PI-FILETYP      PIC  X(01).
  1217             20  PI-FORM-SQUEEZE-CONTROL
  1218                                 PIC  X(01).
  1219                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1220                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1221             20  PI-LAST-CONTROL PIC  X(12).
  1222             20  PI-TEMP-STOR-ITEMS
  1223                                 PIC S9(04) COMP.
  1224             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1225             20  PI-UPDATE-SW    PIC  9(01).
  1226                 88 ANY-UPDATES            VALUE 1.
  1227             20  PI-104-SCREEN-SENT-IND
  1228                                 PIC  X(01).
  1229                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1230                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1231             20  PI-1042-SCREEN-SENT-IND
  1232                                 PIC  X(01).
  1233                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1234                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1235             20  PI-1042-ARCHIVE-IND
  1236                                 PIC  X(01).
  1237                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1238             20  FILLER          PIC  X(29).
  1239*    COPY ELC689PI.
  1240******************************************************************
  1241*                                                                *
  1242*                            ELC689PI                            *
  1243*                            VMOD=2.003                          *
  1244*                                                                *
  1245*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  1246*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  1247*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1248*                                                                *
  1249*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  1250*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  25
* EL689.cbl
  1251*    BETWEEN PROGRAMS.                                           *
  1252*                                                                *
  1253*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1254*                                                                *
  1255*               EL631 - EL689  - EL6891 - EL6892                 *
  1256*                                                                *
  1257******************************************************************
  1258*                   C H A N G E   L O G
  1259*
  1260* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1261*-----------------------------------------------------------------
  1262*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1263* EFFECTIVE    NUMBER
  1264*-----------------------------------------------------------------
  1265* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  1266* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  1267* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1268******************************************************************
  1269
  1270
  1271         16  PI-689-WORK-AREA.
  1272             20  PI-689-ALT-PRINTER-ID
  1273                                 PIC  X(04).
  1274             20  PI-689-ARCHIVE-NUMBER
  1275                                 PIC  9(08).
  1276             20  PI-689-ARCHIVE-SW
  1277                                 PIC  X(01).
  1278                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  1279             20  PI-689-DATA-SOURCE
  1280                                 PIC  X(01).
  1281                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  1282                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  1283                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  1284                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  1285                 88  PI-689-SRC-CHECKS         VALUE '5'.
  1286             20  PI-689-ERROR-IND
  1287                                 PIC  X(01).
  1288                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  1289             20  PI-689-ERROR    PIC  9(04).
  1290                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  1291                 88  PI-689-FATAL-ERROR
  1292                     VALUES 0004 0006 0008 0013 0023 0029 0033
  1293                            0042 0047 0051 0066 0067 0070
  1294                            0168 0169 0174 0175 0176 0177 0179
  1295                            0180 0181 0182 0184 0185 0189 0190
  1296                            0191
  1297                            0215 0279 0280
  1298                            0412 0413 0454
  1299                            0533 0537
  1300                            2055 2114 2208 2209 2216 2232 2369
  1301                            2398 2433 2908 2999
  1302                            3000 3770 3771 3775
  1303                            7250 7365 7367 7368 7369 7370 7371
  1304                            7272 7373 7374 7376 7377 7378 7379
  1305                            7381 7388 7390 7393 7395 7396 7398
  1306                            9095 9096 9281 9298 9299 9320 9327
  1307                            9426 9427.
  1308                 88  PI-689-STOP-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  26
* EL689.cbl
  1309                     VALUES 0004 0008 0013 0023 0029 0033
  1310                            0042 0047 0066 0067 0070
  1311                            0168 0169 0174 0175 0176 0177
  1312                            0181 0182 0184 0185 0189 0190
  1313                            0279 0280
  1314                            0412 0413 0454
  1315                            2055 2208 2209 2216 2232
  1316                            2398 2999
  1317                            3000 3770 3771 3775
  1318                            7250 7365 7369 7370 7371
  1319                            7272 7373 7374 7376 7377 7378 7379
  1320                            7381 7388 7390 7393 7396 7398
  1321                            9095 9096 9299 9320 9426.
  1322             20  PI-689-FOLLOW-UP-DATE
  1323                                 PIC  X(02).
  1324             20  PI-689-FORM-NUMBER
  1325                                 PIC  X(04).
  1326             20  PI-689-LABEL-SOURCE
  1327                                 PIC X(01).
  1328                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1329                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1330                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1331                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1332                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1333                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1334                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1335             20  PI-689-NUMBER-COPIES
  1336                                 PIC  9(01).
  1337             20  PI-689-NUMBER-LABEL-LINES
  1338                                 PIC  9(01).
  1339             20  PI-689-NUMBER-TEXT-RECORDS
  1340                                 PIC  9(03).
  1341             20  PI-689-PRINT-ORDER-SW
  1342                                 PIC  X(01).
  1343                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1344                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1345                 88  PI-689-PRINT-LATER     VALUE '3'.
  1346                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1347             20  PI-689-PRINT-RESTRICTION
  1348                                 PIC  X(01).
  1349                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1350                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1351                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1352             20  PI-689-PRINT-SW PIC  X(01).
  1353                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1354             20  PI-689-RESEND-DATE-1
  1355                                 PIC  X(02).
  1356             20  PI-689-RESEND-LETR-1
  1357                                 PIC X(4).
  1358             20  PI-689-TEMP-STOR-ID
  1359                                 PIC  X(08).
  1360             20  PI-689-USE-SCREEN-IND
  1361                                 PIC  X(01).
  1362                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1363             20  PI-689-ARCH-POINTER
  1364                                 PIC S9(08) COMP.
  1365                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  1366             20  PI-689-ARCT-POINTER
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  27
* EL689.cbl
  1367                                 PIC S9(08) COMP.
  1368                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1369             20  PI-689-VARIABLE-DATA-GRP.
  1370                 24  PI-689-VARIABLE-DATA-1
  1371                                 PIC  X(30).
  1372                 24  PI-689-VARIABLE-DATA-2
  1373                                 PIC  X(30).
  1374                 24  PI-689-VARIABLE-DATA-3
  1375                                 PIC  X(30).
  1376                 24  PI-689-VARIABLE-DATA-4
  1377                                 PIC  X(30).
  1378
  1379         16  PI-689-KEY-DATA-FIELDS.
  1380             20  PI-689-ACCOUNT  PIC  X(10).
  1381             20  PI-689-CARRIER  PIC  X(01).
  1382             20  PI-689-CERT-NO.
  1383                 24  PI-689-CERT-PRIME
  1384                                 PIC  X(10).
  1385                 24  PI-689-CERT-SFX
  1386                                 PIC  X(01).
  1387             20  PI-689-CHG-SEQ-NO
  1388                                 PIC S9(04)    COMP.
  1389             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1390                                 PIC  X(02).
  1391             20  PI-689-ENTRY-BATCH
  1392                                 PIC  X(06).
  1393             20  PI-689-EFF-DATE PIC  X(02).
  1394             20  PI-689-EXP-DATE PIC  X(02).
  1395             20  PI-689-GROUPING PIC  X(06).
  1396             20  PI-689-RESP-PERSON
  1397                                 PIC  X(10).
  1398             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1399             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1400                                 PIC  X(04).
  1401             20  PI-689-STATE    PIC  X(02).
  1402             20  PI-689-TYPE     PIC  X(01).
  1403             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1404             20  PI-689-ALT-SEQ-NO
  1405                                 PIC S9(04)    COMP.
  1406         16  PI-689-DATE-EDIT    PIC  X(08).
  1407         16  PI-689-FOLLOW-UP-EDIT
  1408                                 PIC  X(08).
  1409         16  PI-689-RESEND1-EDIT PIC  X(08).
  1410         16  PI-689-SEQ-EDIT     PIC  X(08).
  1411         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1412         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1413             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1414         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1415         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1416         16  PI-PROMPT-IND       PIC X(1).
  1417         16  PI-CERT-FORM-ID     PIC X(5).
  1418         16  PI-PRINT-NOW        PIC X(1).
  1419         16  PI-ENCLOSURE-CD     PIC X(3).
  1420         16  PI-CERT-REQ-IND     PIC X(1).
  1421         16  PI-ENDT-ARCH-NO     PIC 9(8).
  1422         16  PI-REASON-REQ-IND   PIC X(1).
  1423         16  FILLER              PIC X(244).
  1424*        16  FILLER                        PIC X(276).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  28
* EL689.cbl
  1425*        16  FILLER                        PIC X(280).
  1426
  1427 01  FILLER                      PIC  X(20)
  1428                                 VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  29
* EL689.cbl
  1430 01  FILLER                      PIC  X(16)
  1431                        VALUE 'MAP AREA STARTS:'.
  1432*    COPY EL689S.
  1433 01  EL689AI.
  1434     05  FILLER            PIC  X(0012).
  1435*    -------------------------------
  1436     05  RUNDTEL PIC S9(0004) COMP.
  1437     05  RUNDTEF PIC  X(0001).
  1438     05  FILLER REDEFINES RUNDTEF.
  1439         10  RUNDTEA PIC  X(0001).
  1440     05  RUNDTEI PIC  X(0008).
  1441*    -------------------------------
  1442     05  RUNTIMEL PIC S9(0004) COMP.
  1443     05  RUNTIMEF PIC  X(0001).
  1444     05  FILLER REDEFINES RUNTIMEF.
  1445         10  RUNTIMEA PIC  X(0001).
  1446     05  RUNTIMEI PIC  X(0005).
  1447*    -------------------------------
  1448     05  HOSTL PIC S9(0004) COMP.
  1449     05  HOSTF PIC  X(0001).
  1450     05  FILLER REDEFINES HOSTF.
  1451         10  HOSTA PIC  X(0001).
  1452     05  HOSTI PIC  X(0010).
  1453*    -------------------------------
  1454     05  SYSL PIC S9(0004) COMP.
  1455     05  SYSF PIC  X(0001).
  1456     05  FILLER REDEFINES SYSF.
  1457         10  SYSA PIC  X(0001).
  1458     05  SYSI PIC  X(0008).
  1459*    -------------------------------
  1460     05  COMPANYL PIC S9(0004) COMP.
  1461     05  COMPANYF PIC  X(0001).
  1462     05  FILLER REDEFINES COMPANYF.
  1463         10  COMPANYA PIC  X(0001).
  1464     05  COMPANYI PIC  X(0003).
  1465*    -------------------------------
  1466     05  USERIDL PIC S9(0004) COMP.
  1467     05  USERIDF PIC  X(0001).
  1468     05  FILLER REDEFINES USERIDF.
  1469         10  USERIDA PIC  X(0001).
  1470     05  USERIDI PIC  X(0004).
  1471*    -------------------------------
  1472     05  MAINTL PIC S9(0004) COMP.
  1473     05  MAINTF PIC  X(0001).
  1474     05  FILLER REDEFINES MAINTF.
  1475         10  MAINTA PIC  X(0001).
  1476     05  MAINTI PIC  X(0001).
  1477*    -------------------------------
  1478     05  FORML PIC S9(0004) COMP.
  1479     05  FORMF PIC  X(0001).
  1480     05  FILLER REDEFINES FORMF.
  1481         10  FORMA PIC  X(0001).
  1482     05  FORMI PIC  X(0004).
  1483*    -------------------------------
  1484     05  ARCHNUML PIC S9(0004) COMP.
  1485     05  ARCHNUMF PIC  X(0001).
  1486     05  FILLER REDEFINES ARCHNUMF.
  1487         10  ARCHNUMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  30
* EL689.cbl
  1488     05  ARCHNUMI PIC  99999999.
  1489*    -------------------------------
  1490     05  PRTNOWL PIC S9(0004) COMP.
  1491     05  PRTNOWF PIC  X(0001).
  1492     05  FILLER REDEFINES PRTNOWF.
  1493         10  PRTNOWA PIC  X(0001).
  1494     05  PRTNOWI PIC  X(0001).
  1495*    -------------------------------
  1496     05  CARRIERL PIC S9(0004) COMP.
  1497     05  CARRIERF PIC  X(0001).
  1498     05  FILLER REDEFINES CARRIERF.
  1499         10  CARRIERA PIC  X(0001).
  1500     05  CARRIERI PIC  X(0001).
  1501*    -------------------------------
  1502     05  GROUPL PIC S9(0004) COMP.
  1503     05  GROUPF PIC  X(0001).
  1504     05  FILLER REDEFINES GROUPF.
  1505         10  GROUPA PIC  X(0001).
  1506     05  GROUPI PIC  X(0006).
  1507*    -------------------------------
  1508     05  STATEL PIC S9(0004) COMP.
  1509     05  STATEF PIC  X(0001).
  1510     05  FILLER REDEFINES STATEF.
  1511         10  STATEA PIC  X(0001).
  1512     05  STATEI PIC  X(0002).
  1513*    -------------------------------
  1514     05  ACCTL PIC S9(0004) COMP.
  1515     05  ACCTF PIC  X(0001).
  1516     05  FILLER REDEFINES ACCTF.
  1517         10  ACCTA PIC  X(0001).
  1518     05  ACCTI PIC  X(0010).
  1519*    -------------------------------
  1520     05  CERTL PIC S9(0004) COMP.
  1521     05  CERTF PIC  X(0001).
  1522     05  FILLER REDEFINES CERTF.
  1523         10  CERTA PIC  X(0001).
  1524     05  CERTI PIC  X(0010).
  1525*    -------------------------------
  1526     05  SFXL PIC S9(0004) COMP.
  1527     05  SFXF PIC  X(0001).
  1528     05  FILLER REDEFINES SFXF.
  1529         10  SFXA PIC  X(0001).
  1530     05  SFXI PIC  X(0001).
  1531*    -------------------------------
  1532     05  TYPEL PIC S9(0004) COMP.
  1533     05  TYPEF PIC  X(0001).
  1534     05  FILLER REDEFINES TYPEF.
  1535         10  TYPEA PIC  X(0001).
  1536     05  TYPEI PIC  X(0001).
  1537*    -------------------------------
  1538     05  DATEL PIC S9(0004) COMP.
  1539     05  DATEF PIC  X(0001).
  1540     05  FILLER REDEFINES DATEF.
  1541         10  DATEA PIC  X(0001).
  1542     05  DATEI PIC  X(0008).
  1543*    -------------------------------
  1544     05  FOLLOWL PIC S9(0004) COMP.
  1545     05  FOLLOWF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  31
* EL689.cbl
  1546     05  FILLER REDEFINES FOLLOWF.
  1547         10  FOLLOWA PIC  X(0001).
  1548     05  FOLLOWI PIC  X(0008).
  1549*    -------------------------------
  1550     05  RESEND1L PIC S9(0004) COMP.
  1551     05  RESEND1F PIC  X(0001).
  1552     05  FILLER REDEFINES RESEND1F.
  1553         10  RESEND1A PIC  X(0001).
  1554     05  RESEND1I PIC  X(0008).
  1555*    -------------------------------
  1556     05  ENCL PIC S9(0004) COMP.
  1557     05  ENCF PIC  X(0001).
  1558     05  FILLER REDEFINES ENCF.
  1559         10  ENCA PIC  X(0001).
  1560     05  ENCI PIC  X(0003).
  1561*    -------------------------------
  1562     05  ENDARCHL PIC S9(0004) COMP.
  1563     05  ENDARCHF PIC  X(0001).
  1564     05  FILLER REDEFINES ENDARCHF.
  1565         10  ENDARCHA PIC  X(0001).
  1566     05  ENDARCHI PIC  99999999.
  1567*    -------------------------------
  1568     05  CERTIDL PIC S9(0004) COMP.
  1569     05  CERTIDF PIC  X(0001).
  1570     05  FILLER REDEFINES CERTIDF.
  1571         10  CERTIDA PIC  X(0001).
  1572     05  CERTIDI PIC  X(0005).
  1573*    -------------------------------
  1574     05  ADDRSL PIC S9(0004) COMP.
  1575     05  ADDRSF PIC  X(0001).
  1576     05  FILLER REDEFINES ADDRSF.
  1577         10  ADDRSA PIC  X(0001).
  1578     05  ADDRSI PIC  X(0001).
  1579*    -------------------------------
  1580     05  PRINTERL PIC S9(0004) COMP.
  1581     05  PRINTERF PIC  X(0001).
  1582     05  FILLER REDEFINES PRINTERF.
  1583         10  PRINTERA PIC  X(0001).
  1584     05  PRINTERI PIC  X(0004).
  1585*    -------------------------------
  1586     05  COPIESL PIC S9(0004) COMP.
  1587     05  COPIESF PIC  X(0001).
  1588     05  FILLER REDEFINES COPIESF.
  1589         10  COPIESA PIC  X(0001).
  1590     05  COPIESI PIC  X(0001).
  1591*    -------------------------------
  1592     05  DATASORL PIC S9(0004) COMP.
  1593     05  DATASORF PIC  X(0001).
  1594     05  FILLER REDEFINES DATASORF.
  1595         10  DATASORA PIC  X(0001).
  1596     05  DATASORI PIC  X(0001).
  1597*    -------------------------------
  1598     05  ADDRLBLL PIC S9(0004) COMP.
  1599     05  ADDRLBLF PIC  X(0001).
  1600     05  FILLER REDEFINES ADDRLBLF.
  1601         10  ADDRLBLA PIC  X(0001).
  1602     05  ADDRLBLI PIC  X(0001).
  1603*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  32
* EL689.cbl
  1604     05  RPERSONL PIC S9(0004) COMP.
  1605     05  RPERSONF PIC  X(0001).
  1606     05  FILLER REDEFINES RPERSONF.
  1607         10  RPERSONA PIC  X(0001).
  1608     05  RPERSONI PIC  X(0010).
  1609*    -------------------------------
  1610     05  BENTRYL PIC S9(0004) COMP.
  1611     05  BENTRYF PIC  X(0001).
  1612     05  FILLER REDEFINES BENTRYF.
  1613         10  BENTRYA PIC  X(0001).
  1614     05  BENTRYI PIC  X(0006).
  1615*    -------------------------------
  1616     05  SEQL PIC S9(0004) COMP.
  1617     05  SEQF PIC  X(0001).
  1618     05  FILLER REDEFINES SEQF.
  1619         10  SEQA PIC  X(0001).
  1620     05  SEQI PIC  X(0008).
  1621*    -------------------------------
  1622     05  BCSEQL PIC S9(0004) COMP.
  1623     05  BCSEQF PIC  X(0001).
  1624     05  FILLER REDEFINES BCSEQF.
  1625         10  BCSEQA PIC  X(0001).
  1626     05  BCSEQI PIC  X(0004).
  1627*    -------------------------------
  1628     05  L1L PIC S9(0004) COMP.
  1629     05  L1F PIC  X(0001).
  1630     05  FILLER REDEFINES L1F.
  1631         10  L1A PIC  X(0001).
  1632     05  L1I PIC  X(0003).
  1633*    -------------------------------
  1634     05  TEXT1L PIC S9(0004) COMP.
  1635     05  TEXT1F PIC  X(0001).
  1636     05  FILLER REDEFINES TEXT1F.
  1637         10  TEXT1A PIC  X(0001).
  1638     05  TEXT1I PIC  X(0070).
  1639*    -------------------------------
  1640     05  L2L PIC S9(0004) COMP.
  1641     05  L2F PIC  X(0001).
  1642     05  FILLER REDEFINES L2F.
  1643         10  L2A PIC  X(0001).
  1644     05  L2I PIC  X(0003).
  1645*    -------------------------------
  1646     05  TEXT2L PIC S9(0004) COMP.
  1647     05  TEXT2F PIC  X(0001).
  1648     05  FILLER REDEFINES TEXT2F.
  1649         10  TEXT2A PIC  X(0001).
  1650     05  TEXT2I PIC  X(0070).
  1651*    -------------------------------
  1652     05  L3L PIC S9(0004) COMP.
  1653     05  L3F PIC  X(0001).
  1654     05  FILLER REDEFINES L3F.
  1655         10  L3A PIC  X(0001).
  1656     05  L3I PIC  X(0003).
  1657*    -------------------------------
  1658     05  TEXT3L PIC S9(0004) COMP.
  1659     05  TEXT3F PIC  X(0001).
  1660     05  FILLER REDEFINES TEXT3F.
  1661         10  TEXT3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  33
* EL689.cbl
  1662     05  TEXT3I PIC  X(0070).
  1663*    -------------------------------
  1664     05  L4L PIC S9(0004) COMP.
  1665     05  L4F PIC  X(0001).
  1666     05  FILLER REDEFINES L4F.
  1667         10  L4A PIC  X(0001).
  1668     05  L4I PIC  X(0003).
  1669*    -------------------------------
  1670     05  TEXT4L PIC S9(0004) COMP.
  1671     05  TEXT4F PIC  X(0001).
  1672     05  FILLER REDEFINES TEXT4F.
  1673         10  TEXT4A PIC  X(0001).
  1674     05  TEXT4I PIC  X(0070).
  1675*    -------------------------------
  1676     05  L5L PIC S9(0004) COMP.
  1677     05  L5F PIC  X(0001).
  1678     05  FILLER REDEFINES L5F.
  1679         10  L5A PIC  X(0001).
  1680     05  L5I PIC  X(0003).
  1681*    -------------------------------
  1682     05  TEXT5L PIC S9(0004) COMP.
  1683     05  TEXT5F PIC  X(0001).
  1684     05  FILLER REDEFINES TEXT5F.
  1685         10  TEXT5A PIC  X(0001).
  1686     05  TEXT5I PIC  X(0070).
  1687*    -------------------------------
  1688     05  L6L PIC S9(0004) COMP.
  1689     05  L6F PIC  X(0001).
  1690     05  FILLER REDEFINES L6F.
  1691         10  L6A PIC  X(0001).
  1692     05  L6I PIC  X(0003).
  1693*    -------------------------------
  1694     05  TEXT6L PIC S9(0004) COMP.
  1695     05  TEXT6F PIC  X(0001).
  1696     05  FILLER REDEFINES TEXT6F.
  1697         10  TEXT6A PIC  X(0001).
  1698     05  TEXT6I PIC  X(0070).
  1699*    -------------------------------
  1700     05  L7L PIC S9(0004) COMP.
  1701     05  L7F PIC  X(0001).
  1702     05  FILLER REDEFINES L7F.
  1703         10  L7A PIC  X(0001).
  1704     05  L7I PIC  X(0003).
  1705*    -------------------------------
  1706     05  TEXT7L PIC S9(0004) COMP.
  1707     05  TEXT7F PIC  X(0001).
  1708     05  FILLER REDEFINES TEXT7F.
  1709         10  TEXT7A PIC  X(0001).
  1710     05  TEXT7I PIC  X(0070).
  1711*    -------------------------------
  1712     05  L8L PIC S9(0004) COMP.
  1713     05  L8F PIC  X(0001).
  1714     05  FILLER REDEFINES L8F.
  1715         10  L8A PIC  X(0001).
  1716     05  L8I PIC  X(0003).
  1717*    -------------------------------
  1718     05  TEXT8L PIC S9(0004) COMP.
  1719     05  TEXT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  34
* EL689.cbl
  1720     05  FILLER REDEFINES TEXT8F.
  1721         10  TEXT8A PIC  X(0001).
  1722     05  TEXT8I PIC  X(0070).
  1723*    -------------------------------
  1724     05  L9L PIC S9(0004) COMP.
  1725     05  L9F PIC  X(0001).
  1726     05  FILLER REDEFINES L9F.
  1727         10  L9A PIC  X(0001).
  1728     05  L9I PIC  X(0003).
  1729*    -------------------------------
  1730     05  TEXT9L PIC S9(0004) COMP.
  1731     05  TEXT9F PIC  X(0001).
  1732     05  FILLER REDEFINES TEXT9F.
  1733         10  TEXT9A PIC  X(0001).
  1734     05  TEXT9I PIC  X(0070).
  1735*    -------------------------------
  1736     05  L10L PIC S9(0004) COMP.
  1737     05  L10F PIC  X(0001).
  1738     05  FILLER REDEFINES L10F.
  1739         10  L10A PIC  X(0001).
  1740     05  L10I PIC  X(0003).
  1741*    -------------------------------
  1742     05  TEXT10L PIC S9(0004) COMP.
  1743     05  TEXT10F PIC  X(0001).
  1744     05  FILLER REDEFINES TEXT10F.
  1745         10  TEXT10A PIC  X(0001).
  1746     05  TEXT10I PIC  X(0070).
  1747*    -------------------------------
  1748     05  L11L PIC S9(0004) COMP.
  1749     05  L11F PIC  X(0001).
  1750     05  FILLER REDEFINES L11F.
  1751         10  L11A PIC  X(0001).
  1752     05  L11I PIC  X(0003).
  1753*    -------------------------------
  1754     05  TEXT11L PIC S9(0004) COMP.
  1755     05  TEXT11F PIC  X(0001).
  1756     05  FILLER REDEFINES TEXT11F.
  1757         10  TEXT11A PIC  X(0001).
  1758     05  TEXT11I PIC  X(0070).
  1759*    -------------------------------
  1760     05  L12L PIC S9(0004) COMP.
  1761     05  L12F PIC  X(0001).
  1762     05  FILLER REDEFINES L12F.
  1763         10  L12A PIC  X(0001).
  1764     05  L12I PIC  X(0003).
  1765*    -------------------------------
  1766     05  TEXT12L PIC S9(0004) COMP.
  1767     05  TEXT12F PIC  X(0001).
  1768     05  FILLER REDEFINES TEXT12F.
  1769         10  TEXT12A PIC  X(0001).
  1770     05  TEXT12I PIC  X(0070).
  1771*    -------------------------------
  1772     05  ERRMSGL PIC S9(0004) COMP.
  1773     05  ERRMSGF PIC  X(0001).
  1774     05  FILLER REDEFINES ERRMSGF.
  1775         10  ERRMSGA PIC  X(0001).
  1776     05  ERRMSGI PIC  X(0079).
  1777*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  35
* EL689.cbl
  1778     05  ENTERPFL PIC S9(0004) COMP.
  1779     05  ENTERPFF PIC  X(0001).
  1780     05  FILLER REDEFINES ENTERPFF.
  1781         10  ENTERPFA PIC  X(0001).
  1782     05  ENTERPFI PIC  99.
  1783*    -------------------------------
  1784     05  PF8HDL PIC S9(0004) COMP.
  1785     05  PF8HDF PIC  X(0001).
  1786     05  FILLER REDEFINES PF8HDF.
  1787         10  PF8HDA PIC  X(0001).
  1788     05  PF8HDI PIC  X(0022).
  1789 01  EL689AO REDEFINES EL689AI.
  1790     05  FILLER            PIC  X(0012).
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  RUNDTEO PIC  X(0008).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  RUNTIMEO PIC  99.99.
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  HOSTO PIC  X(0010).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  SYSO PIC  X(0008).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  COMPANYO PIC  X(0003).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  USERIDO PIC  X(0004).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  MAINTO PIC  X(0001).
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  FORMO PIC  X(0004).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  ARCHNUMO PIC  99999999.
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  PRTNOWO PIC  X(0001).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  CARRIERO PIC  X(0001).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  GROUPO PIC  X(0006).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  STATEO PIC  X(0002).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  ACCTO PIC  X(0010).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  CERTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  36
* EL689.cbl
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  SFXO PIC  X(0001).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  TYPEO PIC  X(0001).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  DATEO PIC  X(0008).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  FOLLOWO PIC  X(0008).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  RESEND1O PIC  X(0008).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  ENCO PIC  X(0003).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  ENDARCHO PIC  99999999.
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  CERTIDO PIC  X(0005).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  ADDRSO PIC  X(0001).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  PRINTERO PIC  X(0004).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  COPIESO PIC  X(0001).
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  DATASORO PIC  X(0001).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  ADDRLBLO PIC  X(0001).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  RPERSONO PIC  X(0010).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  BENTRYO PIC  X(0006).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  SEQO PIC  X(0008).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  BCSEQO PIC  X(0004).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  L1O PIC  X(0003).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  TEXT1O PIC  X(0070).
  1893*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  37
* EL689.cbl
  1894     05  FILLER            PIC  X(0003).
  1895     05  L2O PIC  X(0003).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  TEXT2O PIC  X(0070).
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  L3O PIC  X(0003).
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  TEXT3O PIC  X(0070).
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  L4O PIC  X(0003).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  TEXT4O PIC  X(0070).
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  L5O PIC  X(0003).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  TEXT5O PIC  X(0070).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  L6O PIC  X(0003).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  TEXT6O PIC  X(0070).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  L7O PIC  X(0003).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
  1928     05  TEXT7O PIC  X(0070).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  L8O PIC  X(0003).
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  TEXT8O PIC  X(0070).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  L9O PIC  X(0003).
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  TEXT9O PIC  X(0070).
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  L10O PIC  X(0003).
  1944*    -------------------------------
  1945     05  FILLER            PIC  X(0003).
  1946     05  TEXT10O PIC  X(0070).
  1947*    -------------------------------
  1948     05  FILLER            PIC  X(0003).
  1949     05  L11O PIC  X(0003).
  1950*    -------------------------------
  1951     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  38
* EL689.cbl
  1952     05  TEXT11O PIC  X(0070).
  1953*    -------------------------------
  1954     05  FILLER            PIC  X(0003).
  1955     05  L12O PIC  X(0003).
  1956*    -------------------------------
  1957     05  FILLER            PIC  X(0003).
  1958     05  TEXT12O PIC  X(0070).
  1959*    -------------------------------
  1960     05  FILLER            PIC  X(0003).
  1961     05  ERRMSGO PIC  X(0079).
  1962*    -------------------------------
  1963     05  FILLER            PIC  X(0003).
  1964     05  ENTERPFO PIC  X(0002).
  1965*    -------------------------------
  1966     05  FILLER            PIC  X(0003).
  1967     05  PF8HDO PIC  X(0022).
  1968*    -------------------------------
  1969 01  W-MAP-REDEF REDEFINES EL689AI.
  1970*    12  FILLER                  PIC X(218).
  1971     12  FILLER                  PIC X(267).
  1972     12  EL689RI.
  1973         16  W-TEXT-LINES OCCURS 12 TIMES INDEXED BY W-SC-NDX.
  1974             20  W-SC-LINEL      PIC S9(04) COMP.
  1975             20  W-SC-LINEA      PIC  X(01).
  1976             20  W-SC-LINE       PIC  X(03).
  1977             20  W-SC-TEXTL      PIC S9(04) COMP.
  1978             20  W-SC-TEXTA      PIC  X(01).
  1979             20  W-SC-TEXT       PIC  X(70).
  1980*    12  FILLER                  PIC  X(87).
  1981     12  FILLER                  PIC  X(112).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  39
* EL689.cbl
  1983 01  W-CONSTANT-AREA.
  1984     12  FILLER                  PIC  X(18)
  1985                                 VALUE 'PROGRAM CONSTANTS:'.
  1986     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
  1987     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
  1988     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
  1989     12  W-ENDT-LENGTH           PIC S9(04)  COMP  VALUE +579.
  1990     12  W-NOTE-LENGTH           PIC S9(04)  COMP  VALUE +825.
  1991     12  W-EOBC-LENGTH           PIC S9(04)  COMP  VALUE +350.
  1992     12  W-ENCC-LENGTH           PIC S9(04)  COMP  VALUE +400.
  1993     12  W-MAX-LINES             PIC S9(03) VALUE +300 COMP-3.
  1994     12  W-NUM-LINES-PER-SCREEN  PIC  9(02)        VALUE 12.
  1995     12  W-TS-NUM-REC-IN-GROUP   PIC  9(02)        VALUE 50.
  1996     12  W-TS-LENGTH             PIC S9(04)  COMP  VALUE +3650.
  1997     12  W-TS-MAP-LENGTH         PIC S9(04)  COMP  VALUE +1260.
  1998     12  W-ZEROS                 PIC S9(03) VALUE +000 COMP-3.
  1999
  2000     12  W-ACCT-FILE-ID          PIC  X(08) VALUE 'ERACCT'.
  2001     12  W-ACCT2-FILE-ID         PIC  X(08) VALUE 'ERACCT2'.
  2002     12  W-ARCH-FILE-ID          PIC  X(08) VALUE 'ERARCH'.
  2003     12  W-ARCH2-FILE-ID         PIC  X(08) VALUE 'ERARCH2'.
  2004     12  W-ARCH3-FILE-ID         PIC  X(08) VALUE 'ERARCH3'.
  2005     12  W-ARCH4-FILE-ID         PIC  X(08) VALUE 'ERARCH4'.
  2006     12  W-ARCH5-FILE-ID         PIC  X(08) VALUE 'ERARCH5'.
  2007     12  W-ARCT-FILE-ID          PIC  X(08) VALUE 'ERARCT'.
  2008     12  W-CERT-FILE-ID          PIC  X(08) VALUE 'ELCERT'.
  2009     12  W-CHEK-FILE-ID          PIC  X(08) VALUE 'ERCHEK'.
  2010     12  W-CNTL-FILE-ID          PIC  X(08) VALUE 'ELCNTL'.
  2011     12  W-COMP-FILE-ID          PIC  X(08) VALUE 'ERCOMP'.
  2012     12  W-NOTE-FILE-ID          PIC  X(08) VALUE 'ERNOTE'.
  2013     12  W-EOBC-FILE-ID          PIC  X(08) VALUE 'ELEOBC'.
  2014     12  W-ENCC-FILE-ID          PIC  X(08) VALUE 'ELENCC'.
  2015     12  W-GETMAIN-SPACE         PIC  X(01) VALUE SPACE.
  2016     12  W-LGXX-ID               PIC  X(04) VALUE 'LGXX'.
  2017     12  W-LINK-001              PIC  X(05) VALUE 'EL001'.
  2018     12  W-LINK-004              PIC  X(05) VALUE 'EL004'.
  2019     12  W-LINK-ELDATCV          PIC  X(07) VALUE 'ELDATCV'.
  2020     12  W-LOWER-CASE            PIC  X(26)
  2021         VALUE 'abcdefghijklmnopqrstuvwxyz'.
  2022     12  W-MAIL-FILE-ID          PIC  X(08) VALUE 'ERMAIL'.
  2023     12  W-MAP.
  2024         16  W-MAP-PREFIX        PIC  X(02) VALUE 'EL'.
  2025         16  W-MAP-NUM           PIC  X(04) VALUE '689A'.
  2026         16  W-MAP-FILLER        PIC  X(02) VALUE SPACES.
  2027     12  W-MAPSET                PIC  X(08) VALUE 'EL689S'.
  2028     12  W-PGM-EL1042            PIC  X(08) VALUE 'EL1042'.
  2029     12  W-PGM-EL690             PIC  X(08) VALUE 'EL690'.
  2030     12  W-PGM-EL626             PIC  X(08) VALUE 'EL626'.
  2031     12  W-PNDB-FILE-ID          PIC  X(08) VALUE 'ERPNDB'.
  2032     12  W-PRINT-TRANS           PIC  X(04) VALUE 'EXH5'.
  2033     12  W-PYAJ-FILE-ID          PIC  X(08) VALUE 'ERPYAJ'.
  2034
  2035     12  W-TEXT-FILE-ID          PIC  X(08) VALUE 'ELLETR'.
  2036     12  W-THIS-PGM              PIC  X(08) VALUE 'EL689'.
  2037     12  W-TOP-FORM              PIC  X(70)
  2038                              VALUE '*****TOP OF FORM *****'.
  2039     12  W-TRANSACTION           PIC  X(04) VALUE 'EXH3'.
  2040     12  W-UPPER-CASE            PIC  X(26)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  40
* EL689.cbl
  2041         VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
  2042     12  W-XCTL-005              PIC  X(05) VALUE 'EL005'.
  2043     12  W-XCTL-010              PIC  X(05) VALUE 'EL010'.
  2044     12  W-XCTL-626              PIC  X(05) VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  41
* EL689.cbl
  2046 01  W-VARIABLE-PROCESS-CNTLS.
  2047     12  FILLER                  PIC  X(26)
  2048                        VALUE 'VARIABLE WORK AREA STARTS:'.
  2049     12  W-NUM-OF-VARIABLES      PIC S9(03) VALUE +189 COMP-3.
  2050     12  W-VAR-HOLD.
  2051         16  W-V1                PIC  X(01).
  2052         16  W-V2                PIC  X(01).
  2053         16  W-V3                PIC  X(01).
  2054     12  FILLER REDEFINES W-VAR-HOLD.
  2055         16  W-VAR-RELATIVE-NUM  PIC  9(03).
  2056     12  W-FIELD-SQUEEZE-IND     PIC  X(01).
  2057         88  W-SQUEEZE-FIELD          VALUE '#'.
  2058
  2059 01  W-SUPPORTED-VARIABLES.
  2060
  2061*****************COMPANY VARIABLES - ELCNTL ********************
  2062*****COMPANY NAME
  2063     12  FILLER                  PIC  X(03) VALUE '001'.
  2064     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2065     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2066     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2067     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2068
  2069*****FULL COMPANY ADDRESS
  2070     12  FILLER                  PIC  X(03) VALUE '002'.
  2071     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2072     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2073     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2074     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2075
  2076     12  FILLER                  PIC  X(03) VALUE '003'.
  2077     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2078     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2079     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2080     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2081
  2082     12  FILLER                  PIC  X(03) VALUE '004'.
  2083     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2084     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2085     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2086     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2087
  2088     12  FILLER                  PIC  X(03) VALUE '005'.
  2089     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2090     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2091     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2092     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2093
  2094     12  FILLER                  PIC  X(03) VALUE '006'.
  2095     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2096     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2097     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2098     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2099
  2100*****REMAINING 4 ARE NOT CURRENTLY USED
  2101     12  FILLER                  PIC  X(03) VALUE '007'.
  2102     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2103     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  42
* EL689.cbl
  2104     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2105     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2106
  2107     12  FILLER                  PIC  X(03) VALUE '008'.
  2108     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2109     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2110     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2111     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2112
  2113     12  FILLER                  PIC  X(03) VALUE '009'.
  2114     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2115     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2116     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2117     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2118
  2119     12  FILLER                  PIC  X(03) VALUE '010'.
  2120     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2121     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2122     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2123     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2124
  2125************ LIFE BENEFIT VARIABLES - ELCNTL *******************
  2126*****LIFE BENEFIT DESCRIPTION
  2127     12  FILLER                  PIC  X(03) VALUE '011'.
  2128     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2129     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2130     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2131     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2132
  2133*****REMAINING 3 ARE NOT CURRENTLY USED
  2134     12  FILLER                  PIC  X(03) VALUE '012'.
  2135     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2136     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2137     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2138     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2139
  2140     12  FILLER                  PIC  X(03) VALUE '013'.
  2141     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2142     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2143     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2144     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2145
  2146     12  FILLER                  PIC  X(03) VALUE '014'.
  2147     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2148     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2149     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2150     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2151
  2152************* A&H BENEFIT VARIABLES - ELCNTL *******************
  2153*****AH BENEFIT DESCRIPTION
  2154     12  FILLER                  PIC  X(03) VALUE '015'.
  2155     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2156     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2157     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2158     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2159
  2160*****ELIMINATION PERIOD
  2161     12  FILLER                  PIC  X(03) VALUE '016'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  43
* EL689.cbl
  2162     12  FILLER                  PIC S9(04) COMP VALUE +2.
  2163     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2164     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2165     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2166
  2167*****REMAINING 3 ARE NOT CURRENTLY USED
  2168     12  FILLER                  PIC  X(03) VALUE '017'.
  2169     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2170     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2171     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2172     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2173
  2174     12  FILLER                  PIC  X(03) VALUE '018'.
  2175     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2176     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2177     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2178     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2179
  2180     12  FILLER                  PIC  X(03) VALUE '019'.
  2181     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2182     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2183     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2184     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2185
  2186*****************CARRIER VARIABLES - ELCNTL ********************
  2187*****CARRIER NAME
  2188     12  FILLER                  PIC  X(03) VALUE '020'.
  2189     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2190     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2191     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2192     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2193
  2194*****FULL CARRIER ADDRESS
  2195     12  FILLER                  PIC  X(03) VALUE '021'.
  2196     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2197     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2198     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2199     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2200
  2201     12  FILLER                  PIC  X(03) VALUE '022'.
  2202     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2203     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2204     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2205     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2206
  2207     12  FILLER                  PIC  X(03) VALUE '023'.
  2208     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2209     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2210     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2211     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2212
  2213     12  FILLER                  PIC  X(03) VALUE '024'.
  2214     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2215     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2216     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2217     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2218
  2219     12  FILLER                  PIC  X(03) VALUE '025'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  44
* EL689.cbl
  2220     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2221     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2222     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2223     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2224
  2225*****CARRIER PHONE NUMBER
  2226     12  FILLER                  PIC  X(03) VALUE '026'.
  2227     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2228     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2229     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2230     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2231
  2232*****REMAINING 4 ARE NOT CURRENTLY USED
  2233     12  FILLER                  PIC  X(03) VALUE '027'.
  2234     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2235     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2236     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2237     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2238
  2239     12  FILLER                  PIC  X(03) VALUE '028'.
  2240     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2241     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2242     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2243     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2244
  2245     12  FILLER                  PIC  X(03) VALUE '029'.
  2246     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2247     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2248     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2249     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2250
  2251     12  FILLER                  PIC  X(03) VALUE '030'.
  2252     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2253     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2254     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2255     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2256
  2257***************** MAIL VARIABLES - ELMAIL **********************
  2258*****FULL MAIL ADDRESS
  2259     12  FILLER                  PIC  X(03) VALUE '031'.
  2260     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2261     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2262     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2263     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2264
  2265     12  FILLER                  PIC  X(03) VALUE '032'.
  2266     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2267     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2268     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2269     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2270
  2271     12  FILLER                  PIC  X(03) VALUE '033'.
  2272     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2273     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2274     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2275     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2276
  2277     12  FILLER                  PIC  X(03) VALUE '034'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  45
* EL689.cbl
  2278     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2279     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2280     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2281     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2282
  2283     12  FILLER                  PIC  X(03) VALUE '035'.
  2284     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2285     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2286     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2287     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2288
  2289     12  FILLER                  PIC  X(03) VALUE '036'.
  2290     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2291     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2292     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2293     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2294**** CRED BENE NAME FROM ERMAIL
  2295     12  FILLER                  PIC  X(03) VALUE '037'.
  2296     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2297     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2298     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2299     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2300*****REMAINING 2 ARE NOT CURRENTLY USED
  2301     12  FILLER                  PIC  X(03) VALUE '038'.
  2302     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2303     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2304     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2305     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2306
  2307     12  FILLER                  PIC  X(03) VALUE '039'.
  2308     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2309     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2310     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2311     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2312
  2313*************** ACCOUNT VARIABLES - ERACCT *********************
  2314*****ACCOUNT NAME
  2315     12  FILLER                  PIC  X(03) VALUE '040'.
  2316     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2317     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2318     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2319     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2320
  2321*****FULL ACCOUNT ADDRESS
  2322     12  FILLER                  PIC  X(03) VALUE '041'.
  2323     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2324     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2325     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2326     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2327
  2328     12  FILLER                  PIC  X(03) VALUE '042'.
  2329     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2330     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2331     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2332     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2333
  2334     12  FILLER                  PIC  X(03) VALUE '043'.
  2335     12  FILLER                  PIC S9(04) COMP VALUE +30.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  46
* EL689.cbl
  2336     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2337     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2338     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2339
  2340     12  FILLER                  PIC  X(03) VALUE '044'.
  2341     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2342     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2343     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2344     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2345
  2346     12  FILLER                  PIC  X(03) VALUE '045'.
  2347     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2348     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2349     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2350     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2351
  2352*****ACCOUNT PHONE NUMBER
  2353     12  FILLER                  PIC  X(03) VALUE '046'.
  2354     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2355     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2356     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2357     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2358
  2359*****ACCOUNT CONTROL NAME AM-CONTROL-NAME
  2360     12  FILLER                  PIC  X(03) VALUE '047'.
  2361     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2362     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2363     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2364     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2365
  2366****ACCOUNT CSR CODE
  2367     12  FILLER                  PIC  X(03) VALUE '048'.
  2368     12  FILLER                  PIC S9(04) COMP VALUE +4..
  2369     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2370     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2371     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2372****ACCOUNT ACCOUNT NUMBER
  2373     12  FILLER                  PIC  X(03) VALUE '049'.
  2374     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2375     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2376     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2377     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2378
  2379**** CRED BENE ADDRESS LINE 1 ERMAIL
  2380     12  FILLER                  PIC  X(03) VALUE '050'.
  2381     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2382     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2383     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2384     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2385
  2386**** CRED BENE ADDRESS LINE 2 ERMAIL
  2387     12  FILLER                  PIC  X(03) VALUE '051'.
  2388     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2389     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2390     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2391     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2392
  2393**** CRED BENE CITY STATE   ERMAIL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  47
* EL689.cbl
  2394     12  FILLER                  PIC  X(03) VALUE '052'.
  2395     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2396     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2397     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2398     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2399
  2400**** CRED BENE ZIP  1 ERMAIL
  2401     12  FILLER                  PIC  X(03) VALUE '053'.
  2402     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2403     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2404     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2405     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2406
  2407*****REMAINING 6 ARE NOT CURRENTLY USED
  2408     12  FILLER                  PIC  X(03) VALUE '054'.
  2409     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2410     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2411     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2412     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2413
  2414     12  FILLER                  PIC  X(03) VALUE '055'.
  2415     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2416     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2417     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2418     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2419
  2420     12  FILLER                  PIC  X(03) VALUE '056'.
  2421     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2422     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2423     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2424     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2425
  2426     12  FILLER                  PIC  X(03) VALUE '057'.
  2427     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2428     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2429     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2430     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2431
  2432     12  FILLER                  PIC  X(03) VALUE '058'.
  2433     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2434     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2435     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2436     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2437
  2438     12  FILLER                  PIC  X(03) VALUE '059'.
  2439     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2440     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2441     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2442     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2443
  2444*************** NON FILE VARIABLES *****************************
  2445*****CURRENT DATE
  2446     12  FILLER                  PIC  X(03) VALUE '060'.
  2447     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2448     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2449     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2450     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2451
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  48
* EL689.cbl
  2452*****FULL CURRENT DATE
  2453     12  FILLER                  PIC  X(03) VALUE '061'.
  2454     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2455     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2456     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2457     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2458
  2459*****FORM
  2460     12  FILLER                  PIC  X(03) VALUE '062'.
  2461     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2462     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2463     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2464     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2465
  2466*****VARIABLE 1
  2467     12  FILLER                  PIC  X(03) VALUE '063'.
  2468     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2469     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2470     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2471     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2472
  2473*****VARIABLE 2
  2474     12  FILLER                  PIC  X(03) VALUE '064'.
  2475     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2476     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2477     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2478     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2479
  2480*****VARIABLE 3
  2481     12  FILLER                  PIC  X(03) VALUE '065'.
  2482     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2483     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2484     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2485     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2486
  2487*****VARIABLE 4
  2488     12  FILLER                  PIC  X(03) VALUE '066'.
  2489     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2490     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2491     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2492     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2493
  2494*****REMAINING 3 ARE NOT CURRENTLY USED
  2495     12  FILLER                  PIC  X(03) VALUE '067'.
  2496     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2497     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2498     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2499     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2500
  2501     12  FILLER                  PIC  X(03) VALUE '068'.
  2502     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2503     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2504     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2505     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2506
  2507     12  FILLER                  PIC  X(03) VALUE '069'.
  2508     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2509     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  49
* EL689.cbl
  2510     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2511     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2512
  2513************** CERTIFICATE VARIABLES - ELCERT *****************
  2514*****CARRIER CODE IN CERT
  2515     12  FILLER                  PIC  X(03) VALUE '070'.
  2516     12  FILLER                  PIC S9(04) COMP VALUE +1.
  2517     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2518     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2519     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2520
  2521*****GROUPING CODE IN CERT
  2522     12  FILLER                  PIC  X(03) VALUE '071'.
  2523     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2524     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2525     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2526     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2527
  2528*****ACCOUNT NUMBER IN CERT
  2529     12  FILLER                  PIC  X(03) VALUE '072'.
  2530     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2531     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2532     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2533     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2534
  2535*****CERTIFICATE NUMBER
  2536     12  FILLER                  PIC  X(03) VALUE '073'.
  2537     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2538     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2539     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2540     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2541
  2542*****CERT EFFECTIVE DATE
  2543     12  FILLER                  PIC  X(03) VALUE '074'.
  2544     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2545     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2546     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2547     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2548
  2549*****CERT EXPIRATION DATE (LIFE)
  2550     12  FILLER                  PIC  X(03) VALUE '075'.
  2551     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2552     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2553     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2554     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2555
  2556*****CERT EXPIRATION DATE (AH)
  2557     12  FILLER                  PIC  X(03) VALUE '076'.
  2558     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2559     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2560     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2561     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2562
  2563*****LIFE TERM
  2564     12  FILLER                  PIC  X(03) VALUE '077'.
  2565     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2566     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2567     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  50
* EL689.cbl
  2568     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2569
  2570*****AH  TERM
  2571     12  FILLER                  PIC  X(03) VALUE '078'.
  2572     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2573     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2574     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2575     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2576
  2577*****LIFE COVERAGE AMOUNT
  2578     12  FILLER                  PIC  X(03) VALUE '079'.
  2579     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2580     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2581     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2582     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2583
  2584*****AH MONTHLY BENEFIT
  2585     12  FILLER                  PIC  X(03) VALUE '080'.
  2586     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2587     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2588     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2589     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2590
  2591*****LIFE CANCEL DATE
  2592     12  FILLER                  PIC  X(03) VALUE '081'.
  2593     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2594     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2595     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2596     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2597
  2598*****AH CANCEL DATE
  2599     12  FILLER                  PIC  X(03) VALUE '082'.
  2600     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2601     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2602     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2603     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2604
  2605*****LIFE COVERAGE FORM NUMBER
  2606     12  FILLER                  PIC  X(03) VALUE '083'.
  2607     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2608     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2609     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2610     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2611
  2612*****UNUSED
  2613     12  FILLER                  PIC  X(03) VALUE '084'.
  2614     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2615     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2616     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2617     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2618
  2619*****INSUREDS AGE AT POLICY ISSUE (NOT USED)
  2620     12  FILLER                  PIC  X(03) VALUE '085'.
  2621     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2622     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2623     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2624     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2625
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  51
* EL689.cbl
  2626*****LOAN NUMBER
  2627     12  FILLER                  PIC  X(03) VALUE '086'.
  2628     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2629     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2630     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2631     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2632
  2633*****LOAN BALANCE
  2634     12  FILLER                  PIC  X(03) VALUE '087'.
  2635     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2636     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2637     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2638     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2639
  2640*****MEMBER NUMBER
  2641     12  FILLER                  PIC  X(03) VALUE '088'.
  2642     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2643     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2644     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2645     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2646
  2647*****INSURED SOC SEC NUMBER
  2648     12  FILLER                  PIC  X(03) VALUE '089'.
  2649     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2650     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2651     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2652     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2653
  2654*****INSURED INITIALS & LAST NAME (CERTIFICATE)
  2655     12  FILLER                  PIC  X(03) VALUE '090'.
  2656     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2657     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2658     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2659     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2660
  2661*****INSURED FIRST NAME (CERTIFICATE)
  2662     12  FILLER                  PIC  X(03) VALUE '091'.
  2663     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2664     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2665     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2666     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2667
  2668*****INSURED MIDDLE INITIAL (CERTIFICATE)
  2669     12  FILLER                  PIC  X(03) VALUE '092'.
  2670     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2671     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2672     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2673     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2674
  2675*****ORIG TERM * MON BEN
  2676     12  FILLER                  PIC  X(03) VALUE '093'.
  2677     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2678     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2679     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2680     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2681
  2682*****INSURED'S NAME (LAST, FIRST, INIT)
  2683     12  FILLER                  PIC  X(03) VALUE '094'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  52
* EL689.cbl
  2684     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2685     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2686     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2687     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2688
  2689*****INSURED'S NAME (FIRST, INIT, LAST)
  2690     12  FILLER                  PIC  X(03) VALUE  '095'.
  2691     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2692     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2693     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2694     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2695
  2696*****TITLE (MR/MS)
  2697     12  FILLER                  PIC  X(03) VALUE '096'.
  2698     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2699     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2700     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2701     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2702
  2703*****LIFE PREMIUM (CERTIFICATE)
  2704     12  FILLER                  PIC  X(03) VALUE '097'.
  2705     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2706     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2707     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2708     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2709
  2710*****A/H PREMIUM (CERTIFICATE)
  2711     12  FILLER                  PIC  X(03) VALUE '098'.
  2712     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2713     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2714     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2715     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2716
  2717*****JOINT'S INITIALS & LAST NAME (CERTIFICATE)
  2718     12  FILLER                  PIC  X(03) VALUE '099'.
  2719     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2720     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2721     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2722     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2723
  2724*****JOINT'S FIRST NAME (CERTIFICATE)
  2725     12  FILLER                  PIC  X(03) VALUE '100'.
  2726     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2727     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2728     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2729     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2730
  2731*****JOINT'S MIDDLE INITIAL (CERTIFICATE)
  2732     12  FILLER                  PIC  X(03) VALUE '101'.
  2733     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2734     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2735     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2736     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2737
  2738*****JOINT'S NAME (LAST, FIRST, INIT)
  2739     12  FILLER                  PIC  X(03) VALUE '102'.
  2740     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2741     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  53
* EL689.cbl
  2742     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2743     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2744
  2745*****JOINT'S NAME (FIRST, INIT, LAST)
  2746     12  FILLER                  PIC  X(03) VALUE '103'.
  2747     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2748     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2749     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2750     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2751
  2752*****INSURED'S FIRST AND LAST NAME
  2753     12  FILLER                  PIC  X(03) VALUE '104'.
  2754     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2755     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2756     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2757     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2758
  2759*****JOINT'S FIRST AND LAST NAME
  2760     12  FILLER                  PIC  X(03) VALUE '105'.
  2761     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2762     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2763     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2764     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2765
  2766*****ENTERED LIFE REFUND (CERT)
  2767     12  FILLER                  PIC  X(03) VALUE '106'.
  2768     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2769     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2770     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2771     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2772
  2773*****ENTERED A/H REFUND (CERT)
  2774     12  FILLER                  PIC  X(03) VALUE '107'.
  2775     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2776     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2777     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2778     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2779
  2780*****INSURED'S LAST NAME
  2781     12  FILLER                  PIC  X(03) VALUE '108'.
  2782     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2783     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2784     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2785     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2786
  2787*****BENEFICIARY
  2788     12  FILLER                  PIC  X(03) VALUE  '109'.
  2789     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2790     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2791     12  FILLER                  PIC  X(01) VALUE 'Y'.
  2792     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2793
  2794************** PENDING VARIABLES - ERPNDB *********************
  2795*****INSURED DATE OF BIRTH
  2796     12  FILLER                  PIC  X(03) VALUE '110'.
  2797     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2798     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2799     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  54
* EL689.cbl
  2800     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2801
  2802*****ENTERED LIFE PREMIUM (PENDING)
  2803     12  FILLER                  PIC  X(03) VALUE '111'.
  2804     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2805     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2806     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2807     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2808
  2809*****ENTERED A/H PREMIUM (PENDING)
  2810     12  FILLER                  PIC  X(03) VALUE '112'.
  2811     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2812     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2813     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2814     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2815
  2816*****CALCULATED LIFE PREMIUM (PENDING)
  2817     12  FILLER                  PIC  X(03) VALUE '113'.
  2818     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2819     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2820     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2821     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2822
  2823*****CALCULATED A/H PREMIUM (PENDING)
  2824     12  FILLER                  PIC  X(03) VALUE '114'.
  2825     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2826     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2827     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2828     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2829
  2830*****DIFFERENCE ENTER/COMPUTED LIFE PREMIUM (PENDING)
  2831     12  FILLER                  PIC  X(03) VALUE '115'.
  2832     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2833     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2834     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2835     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2836
  2837*****DIFFERENCE ENTER/COMPUTED A/H PREMIUM (PENDING)
  2838     12  FILLER                  PIC  X(03) VALUE '116'.
  2839     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2840     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2841     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2842     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2843
  2844*****PRIOR CANCEL DATE
  2845     12  FILLER                  PIC  X(03) VALUE '117'.
  2846     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2847     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2848     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2849     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2850
  2851*****ENTERED LIFE REFUND (PENDING)
  2852     12  FILLER                  PIC  X(03) VALUE '118'.
  2853     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2854     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2855     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2856     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2857
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  55
* EL689.cbl
  2858*****ENTERED A/H REFUND (PENDING)
  2859     12  FILLER                  PIC  X(03) VALUE '119'.
  2860     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2861     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2862     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2863     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2864
  2865*****CALCULATED LIFE REFUND (PENDING)
  2866     12  FILLER                  PIC  X(03) VALUE '120'.
  2867     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2868     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2869     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2870     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2871
  2872*****CALCULATED A/H REFUND (PENDING)
  2873     12  FILLER                  PIC  X(03) VALUE '121'.
  2874     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2875     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2876     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2877     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2878
  2879*****DIFFERENCE ENTER/COMPUTED LIFE REFUND (PENDING)
  2880     12  FILLER                  PIC  X(03) VALUE '122'.
  2881     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2882     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2883     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2884     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2885
  2886*****DIFFERENCE ENTER/COMPUTED A/H REFUND (PENDING)
  2887     12  FILLER                  PIC  X(03) VALUE '123'.
  2888     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2889     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2890     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2891     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2892
  2893*****INSUREDS AGE
  2894     12  FILLER                  PIC  X(03) VALUE '124'.
  2895     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2896     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2897     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2898     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2899
  2900*****LIFE BENEFIT (PENDING)
  2901     12  FILLER                  PIC  X(03) VALUE '125'.
  2902     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2903     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2904     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2905     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2906
  2907*****A/H BENEFIT (PENDING)
  2908     12  FILLER                  PIC  X(03) VALUE '126'.
  2909     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2910     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2911     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2912     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2913
  2914*****LIFE RATE
  2915     12  FILLER                  PIC  X(03) VALUE '127'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  56
* EL689.cbl
  2916     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2917     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2918     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2919     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2920
  2921*****A/H RATE
  2922     12  FILLER                  PIC  X(03) VALUE '128'.
  2923     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2924     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2925     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2926     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2927
  2928*****TERM (PENDING)
  2929     12  FILLER                  PIC  X(03) VALUE '129'.
  2930     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2931     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2932     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2933     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2934
  2935*****BATCH NUMBER
  2936     12  FILLER                  PIC  X(03) VALUE '130'.
  2937     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2938     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2939     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2940     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2941
  2942*****TOTAL OF LIFE AND A&H REFUND
  2943     12  FILLER                  PIC  X(03) VALUE '131'.
  2944     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2945     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2946     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2947     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2948
  2949*****NH INTEREST ON REFUNDS
  2950     12  FILLER                  PIC  X(03) VALUE '132'.
  2951     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2952     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2953     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2954     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2955*****GREATER OF THE LIFE AND AH CANCEL DATE
  2956     12  FILLER                  PIC  X(03) VALUE '133'.
  2957     12  FILLER                  PIC S9(04) COMP VALUE +8.
  2958     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2959     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2960     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2961
  2962*****THE NEXT 6 NOT CURRENTLY USED
  2963     12  FILLER                  PIC  X(03) VALUE '134'.
  2964     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2965     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2966     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2967     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2968
  2969     12  FILLER                  PIC  X(03) VALUE '135'.
  2970     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2971     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2972     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2973     12  FILLER                  PIC S9(04) COMP VALUE +09.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  57
* EL689.cbl
  2974
  2975     12  FILLER                  PIC  X(03) VALUE '136'.
  2976     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2977     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2978     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2979     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2980
  2981     12  FILLER                  PIC  X(03) VALUE '137'.
  2982     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2983     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2984     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2985     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2986
  2987     12  FILLER                  PIC  X(03) VALUE '138'.
  2988     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2989     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2990     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2991     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2992
  2993     12  FILLER                  PIC  X(03) VALUE '139'.
  2994     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2995     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2996     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2997     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2998
  2999************** COMPENSATION VARIABLES - ERCOMP ****************
  3000*****COMPENSATION ACCT NAME
  3001     12  FILLER                  PIC  X(03) VALUE '140'.
  3002     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3003     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3004     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3005     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3006
  3007*****FULL COMPENSATION ADDRESS TYPE 'A'
  3008     12  FILLER                  PIC  X(03) VALUE '141'.
  3009     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3010     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3011     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3012     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3013
  3014     12  FILLER                  PIC  X(03) VALUE '142'.
  3015     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3016     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3017     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3018     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3019
  3020     12  FILLER                  PIC  X(03) VALUE '143'.
  3021     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3022     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3023     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3024     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3025
  3026     12  FILLER                  PIC  X(03) VALUE '144'.
  3027     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3028     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3029     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3030     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3031
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  58
* EL689.cbl
  3032     12  FILLER                  PIC  X(03) VALUE '145'.
  3033     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3034     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3035     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3036     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3037
  3038     12  FILLER                  PIC  X(03) VALUE '146'.
  3039     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3040     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3041     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3042     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3043
  3044*****COMPENSATION PHONE NUMBER
  3045     12  FILLER                  PIC  X(03) VALUE '147'.
  3046     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3047     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3048     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3049     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3050
  3051*****COMPENSATION CSR NAME
  3052     12  FILLER                  PIC  X(03) VALUE '148'.
  3053     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3054     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3055     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3056     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3057
  3058*****COMPENSATION LAST STATEMENT DATE
  3059     12  FILLER                  PIC  X(03) VALUE '149'.
  3060     12  FILLER                  PIC S9(04) COMP VALUE +18.
  3061     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3062     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3063     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3064
  3065*****COMPENSATION ENDING BALANCE
  3066     12  FILLER                  PIC  X(03) VALUE '150'.
  3067     12  FILLER                  PIC S9(04) COMP VALUE +14.
  3068     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3069     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3070     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3071
  3072******************  PROCESSOR DATA - ELCNTL (2) ****************
  3073*****EXECUTING PROCESSOR NAME
  3074     12  FILLER                  PIC  X(03) VALUE '151'.
  3075     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3076     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3077     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3078     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3079
  3080*****PROCESSOR TITLE
  3081     12  FILLER                  PIC  X(03) VALUE '152'.
  3082     12  FILLER                  PIC S9(04) COMP VALUE +26.
  3083     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3084     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3085     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3086
  3087*****PROCESSOR
  3088     12  FILLER                  PIC  X(03) VALUE '153'.
  3089     12  FILLER                  PIC S9(04) COMP VALUE +04.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  59
* EL689.cbl
  3090     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3091     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3092     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3093
  3094*****CSR TITLE
  3095     12  FILLER                  PIC  X(03) VALUE '154'.
  3096     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3097     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3098     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3099     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3100*****REMAINING 2 ARE NOT CURRENTLY USED
  3101     12  FILLER                  PIC  X(03) VALUE '155'.
  3102     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3103     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3104     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3105     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3106
  3107     12  FILLER                  PIC  X(03) VALUE '156'.
  3108     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3109     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3110     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3111     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3112
  3113******************  CHECK DATA - ERCHEK    *********************
  3114*****CHECK AMOUNT
  3115     12  FILLER                  PIC  X(03) VALUE '157'.
  3116     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3117     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3118     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3119     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3120
  3121*****CHECK NUMBER
  3122     12  FILLER                  PIC  X(03) VALUE '158'.
  3123     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3124     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3125     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3126     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3127
  3128*****PAYEE 1 NAME
  3129     12  FILLER                  PIC  X(03) VALUE '159'.
  3130     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3131     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3132     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3133     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3134
  3135*****PAYEE 2 NAME
  3136     12  FILLER                  PIC  X(03) VALUE '160'.
  3137     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3138     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3139     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3140     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3141
  3142*****ADDRSS 1
  3143     12  FILLER                  PIC  X(03) VALUE '161'.
  3144     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3145     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3146     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3147     12  FILLER                  PIC S9(04) COMP VALUE +12.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  60
* EL689.cbl
  3148
  3149*****ADDRESS 2
  3150     12  FILLER                  PIC  X(03) VALUE '162'.
  3151     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3152     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3153     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3154     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3155
  3156*****PAYEE CITY STATE
  3157     12  FILLER                  PIC  X(03) VALUE '163'.
  3158     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3159     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3160     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3161     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3162
  3163*****ZIP CODE
  3164     12  FILLER                  PIC  X(03) VALUE '164'.
  3165     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3166     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3167     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3168     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3169
  3170*****CHECK CONTROL
  3171     12  FILLER                  PIC  X(03) VALUE '165'.
  3172     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3173     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3174     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3175     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3176
  3177*****REASON FOR CHECK
  3178     12  FILLER                  PIC  X(03) VALUE '166'.
  3179     12  FILLER                  PIC S9(04) COMP VALUE +25.
  3180     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3181     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3182     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3183
  3184*****REMAINING 3 ARE NOT CURRENTLY USED
  3185     12  FILLER                  PIC  X(03) VALUE '167'.
  3186     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3187     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3188     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3189     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3190
  3191     12  FILLER                  PIC  X(03) VALUE '168'.
  3192     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3193     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3194     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3195     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3196
  3197     12  FILLER                  PIC  X(03) VALUE '169'.
  3198     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3199     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3200     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3201     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3202
  3203
  3204*********** PAYMENT AND ADJUSTMENT DATA - ERPYAJ  **************
  3205*****CHECK AMOUNT - PYAJ
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  61
* EL689.cbl
  3206     12  FILLER                  PIC  X(03) VALUE '170'.
  3207     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3208     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3209     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3210     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3211
  3212*****CHECK NUMBER - PYAJ
  3213     12  FILLER                  PIC  X(03) VALUE '171'.
  3214     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3215     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3216     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3217     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3218
  3219*****CHECK CONTROL - PYAJ
  3220     12  FILLER                  PIC  X(03) VALUE '172'.
  3221     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3222     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3223     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3224     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3225
  3226***** COMMENT - PYAJ
  3227     12  FILLER                  PIC  X(03) VALUE '173'.
  3228     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3229     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3230     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3231     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3232
  3233*****NEW FIELDS.
  3234*****COMPENSATION FULL ADDRESS TYPE 'G'
  3235     12  FILLER                  PIC  X(03) VALUE '174'.
  3236     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3237     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3238     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3239     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3240
  3241     12  FILLER                  PIC  X(03) VALUE '175'.
  3242     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3243     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3244     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3245     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3246
  3247     12  FILLER                  PIC  X(03) VALUE '176'.
  3248     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3249     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3250     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3251     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3252
  3253     12  FILLER                  PIC  X(03) VALUE '177'.
  3254     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3255     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3256     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3257     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3258
  3259     12  FILLER                  PIC  X(03) VALUE '178'.
  3260     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3261     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3262     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3263     12  FILLER                  PIC S9(04) COMP VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  62
* EL689.cbl
  3264
  3265     12  FILLER                  PIC  X(03) VALUE '179'.
  3266     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3267     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3268     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3269     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3270
  3271*****COMPENSATION FINANCIAL RESPONSIBLE NO.
  3272     12  FILLER                  PIC  X(03) VALUE '180'.
  3273     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3274     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3275     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3276     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3277**** COMPENSATION BILLING SWITCH
  3278     12  FILLER                  PIC XXX    VALUE '181'.
  3279     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3280     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3281     12  FILLER                  PIC X      VALUE ALL 'N'.
  3282     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3283*****COMPENSATION FAX NUMBER
  3284     12  FILLER                  PIC  X(03) VALUE '182'.
  3285     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3286     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3287     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3288     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3289**** COMPENSATION STATUS
  3290     12  FILLER                  PIC XXX    VALUE '183'.
  3291     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3292     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3293     12  FILLER                  PIC X      VALUE ALL 'N'.
  3294     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3295***** THE VARS 184 - 189 WILL TYPICALLY BE USED FOR DCC BANKS
  3296*****COMPENSATION FULL ADDRESS TYPE 'B'
  3297     12  FILLER                  PIC  X(03) VALUE '184'.
  3298     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3299     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3300     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3301     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3302
  3303     12  FILLER                  PIC  X(03) VALUE '185'.
  3304     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3305     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3306     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3307     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3308
  3309     12  FILLER                  PIC  X(03) VALUE '186'.
  3310     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3311     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3312     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3313     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3314
  3315     12  FILLER                  PIC  X(03) VALUE '187'.
  3316     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3317     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3318     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3319     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3320
  3321     12  FILLER                  PIC  X(03) VALUE '188'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  63
* EL689.cbl
  3322     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3323     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3324     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3325     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3326
  3327     12  FILLER                  PIC  X(03) VALUE '189'.
  3328     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3329     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3330     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3331     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3332
  3333
  3334 01  FILLER REDEFINES W-SUPPORTED-VARIABLES.
  3335*    12  W-VARIABLE-GRP OCCURS 180 TIMES
  3336     12  W-VARIABLE-GRP OCCURS 189 TIMES
  3337                        INDEXED BY W-VG-NDX.
  3338         16  W-VARIABLE-ID         PIC  X(03).
  3339         16  W-VARIABLE-SIZE       PIC S9(04) COMP.
  3340         16  W-VG-TEXT.
  3341             20  W-VAR-CHAR
  3342                        OCCURS 30 TIMES
  3343                        INDEXED BY W-VC-NDX
  3344                                   PIC  X(01).
  3345         16  W-VARIABLE-UPLOW-IND  PIC  X(01).
  3346             88  W-USE-UPPER-AND-LOWER-CASE VALUE 'Y'.
  3347
  3348         16  W-VARIABLE-SOURCE   PIC S9(04) COMP.
  3349
  3350 01  W-VAR-END                   PIC  X(23)
  3351                        VALUE ':VARIABLE WORK AREA END'.
  3352
  3353 01  W-PROGRAM-TABLE-AREA.
  3354     12  FILLER                  PIC  X(15)
  3355                                 VALUE 'PROGRAM TABLES:'.
  3356
  3357     12  W-RECORD-TABLE              VALUE SPACES.
  3358         16  W-RC-GRP OCCURS 500 TIMES
  3359                       INDEXED BY W-RG-NDX
  3360                                  W-RG-NDX1.
  3361             20  W-RC-TEXT.
  3362                 24  W-RC-CHAR OCCURS 70 TIMES
  3363                                INDEXED BY W-RC-NDX
  3364                                           W-RC-NDX1
  3365                                 PIC  X(01).
  3366             20  W-RC-PC         PIC  9(02).
  3367             20  W-RC-SC         PIC  X(01).
  3368
  3369     12  FILLER REDEFINES W-RECORD-TABLE.
  3370         16  W-REC-CHAR OCCURS 36500 TIMES
  3371                        INDEXED BY W-RVS-NDX
  3372                                   W-RVS-NDX2
  3373                                 PIC  X(01).
  3374     12  FILLER REDEFINES W-RECORD-TABLE.
  3375         16  W-TS-GROUP OCCURS 10 TIMES
  3376                        INDEXED BY W-TS-NDX
  3377                                 PIC X(3650).
  3378
  3379     12  FILLER                  PIC  X(11)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  64
* EL689.cbl
  3380                                 VALUE 'TEXT TABLE:'.
  3381     12  W-TX-TABLE                  VALUE SPACES.
  3382         16  W-TX-GRP OCCURS 500 TIMES
  3383                       INDEXED BY W-TG-NDX
  3384                                  W-TG-NDX2.
  3385             20  W-TX-TEXT.
  3386                 24  W-TX-CHAR OCCURS 70 TIMES
  3387                                    INDEXED BY W-TX-NDX
  3388                                               W-TX-NDX1
  3389                                               W-TX-NDX2
  3390                                 PIC  X(01).
  3391             20  W-TX-PC         PIC  9(02).
  3392             20  W-TX-SC         PIC  X(01).
  3393
  3394     12  FILLER                  PIC  X(11)
  3395                                 VALUE 'FILE TABLE:'.
  3396     12  W-FILE-TABLE                VALUE SPACES.
  3397         16  W-FILE-USE-IND OCCURS 20 TIMES
  3398                       INDEXED BY W-FILE-NDX
  3399                                 PIC  X(01).
  3400             88  W-FILE-NOT-USED     VALUE SPACE.
  3401             88  W-FILE-USED         VALUE 'Y'.
  3402
  3403     12  FILLER                  PIC  X(14)
  3404                                 VALUE 'END OF TABLES:'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  65
* EL689.cbl
  3406 01  ERROR-MESSAGES.
  3407     12  ER-0000                 PIC  X(04) VALUE '0000'.
  3408     12  ER-0004                 PIC  X(04) VALUE '0004'.
  3409     12  ER-0006                 PIC  X(04) VALUE '0006'.
  3410     12  ER-0008                 PIC  X(04) VALUE '0008'.
  3411     12  ER-0013                 PIC  X(04) VALUE '0013'.
  3412     12  ER-0023                 PIC  X(04) VALUE '0023'.
  3413     12  ER-0029                 PIC  X(04) VALUE '0029'.
  3414     12  ER-0033                 PIC  X(04) VALUE '0033'.
  3415     12  ER-0042                 PIC  X(04) VALUE '0042'.
  3416     12  ER-0047                 PIC  X(04) VALUE '0047'.
  3417     12  ER-0051                 PIC  X(04) VALUE '0051'.
  3418     12  ER-0066                 PIC  X(04) VALUE '0066'.
  3419     12  ER-0067                 PIC  X(04) VALUE '0067'.
  3420     12  ER-0070                 PIC  X(04) VALUE '0070'.
  3421     12  ER-0168                 PIC  X(04) VALUE '0168'.
  3422     12  ER-0169                 PIC  X(04) VALUE '0169'.
  3423     12  ER-0174                 PIC  X(04) VALUE '0174'.
  3424     12  ER-0175                 PIC  X(04) VALUE '0175'.
  3425     12  ER-0176                 PIC  X(04) VALUE '0176'.
  3426     12  ER-0177                 PIC  X(04) VALUE '0177'.
  3427     12  ER-0179                 PIC  X(04) VALUE '0179'.
  3428     12  ER-0180                 PIC  X(04) VALUE '0180'.
  3429     12  ER-0181                 PIC  X(04) VALUE '0181'.
  3430     12  ER-0182                 PIC  X(04) VALUE '0182'.
  3431     12  ER-0184                 PIC  X(04) VALUE '0184'.
  3432     12  ER-0185                 PIC  X(04) VALUE '0185'.
  3433     12  ER-0187                 PIC  X(04) VALUE '0187'.
  3434     12  ER-0188                 PIC  X(04) VALUE '0188'.
  3435     12  ER-0189                 PIC  X(04) VALUE '0189'.
  3436     12  ER-0190                 PIC  X(04) VALUE '0190'.
  3437     12  ER-0191                 PIC  X(04) VALUE '0191'.
  3438     12  ER-0215                 PIC  X(04) VALUE '0215'.
  3439     12  ER-0279                 PIC  X(04) VALUE '0279'.
  3440     12  ER-0280                 PIC  X(04) VALUE '0280'.
  3441     12  ER-0412                 PIC  X(04) VALUE '0412'.
  3442     12  ER-0413                 PIC  X(04) VALUE '0413'.
  3443     12  ER-0454                 PIC  X(04) VALUE '0454'.
  3444     12  ER-0533                 PIC  X(04) VALUE '0533'.
  3445     12  ER-0537                 PIC  X(04) VALUE '0537'.
  3446     12  ER-0715                 PIC  X(04) VALUE '0715'.
  3447     12  ER-0894                 PIC  X(04) VALUE '0894'.
  3448     12  ER-1560                 PIC  X(04) VALUE '1560'.
  3449     12  ER-1565                 PIC  X(04) VALUE '1565'.
  3450     12  ER-1778                 PIC  X(04) VALUE '1778'.
  3451     12  ER-1818                 PIC  X(04) VALUE '1818'.
  3452     12  ER-2055                 PIC  X(04) VALUE '2055'.
  3453     12  ER-2114                 PIC  X(04) VALUE '2114'.
  3454     12  ER-2208                 PIC  X(04) VALUE '2208'.
  3455     12  ER-2209                 PIC  X(04) VALUE '2209'.
  3456     12  ER-2216                 PIC  X(04) VALUE '2216'.
  3457     12  ER-2232                 PIC  X(04) VALUE '2232'.
  3458     12  ER-2369                 PIC  X(04) VALUE '2369'.
  3459     12  ER-2398                 PIC  X(04) VALUE '2398'.
  3460     12  ER-2433                 PIC  X(04) VALUE '2433'.
  3461     12  ER-2908                 PIC  X(04) VALUE '2908'.
  3462     12  ER-2999                 PIC  X(04) VALUE '2999'.
  3463     12  ER-3000                 PIC  X(04) VALUE '3000'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  66
* EL689.cbl
  3464     12  ER-3770                 PIC  X(04) VALUE '3770'.
  3465     12  ER-3771                 PIC  X(04) VALUE '3771'.
  3466     12  ER-3775                 PIC  X(04) VALUE '3775'.
  3467     12  ER-3783                 PIC  X(04) VALUE '3783'.
  3468     12  ER-7243                 PIC  X(04) VALUE '7243'.
  3469     12  ER-7245                 PIC  X(04) VALUE '7245'.
  3470     12  ER-7246                 PIC  X(04) VALUE '7246'.
  3471     12  ER-7247                 PIC  X(04) VALUE '7247'.
  3472     12  ER-7250                 PIC  X(04) VALUE '7250'.
  3473     12  ER-7365                 PIC  X(04) VALUE '7365'.
  3474     12  ER-7367                 PIC  X(04) VALUE '7367'.
  3475     12  ER-7368                 PIC  X(04) VALUE '7368'.
  3476     12  ER-7369                 PIC  X(04) VALUE '7369'.
  3477     12  ER-7370                 PIC  X(04) VALUE '7370'.
  3478     12  ER-7371                 PIC  X(04) VALUE '7371'.
  3479     12  ER-7372                 PIC  X(04) VALUE '7372'.
  3480     12  ER-7373                 PIC  X(04) VALUE '7373'.
  3481     12  ER-7374                 PIC  X(04) VALUE '7374'.
  3482     12  ER-7376                 PIC  X(04) VALUE '7376'.
  3483     12  ER-7377                 PIC  X(04) VALUE '7377'.
  3484     12  ER-7378                 PIC  X(04) VALUE '7378'.
  3485     12  ER-7379                 PIC  X(04) VALUE '7379'.
  3486     12  ER-7381                 PIC  X(04) VALUE '7381'.
  3487     12  ER-7388                 PIC  X(04) VALUE '7388'.
  3488     12  ER-7390                 PIC  X(04) VALUE '7390'.
  3489     12  ER-7393                 PIC  X(04) VALUE '7393'.
  3490     12  ER-7395                 PIC  X(04) VALUE '7395'.
  3491     12  ER-7396                 PIC  X(04) VALUE '7396'.
  3492     12  ER-7398                 PIC  X(04) VALUE '7398'.
  3493     12  ER-8965                 PIC  X(04) VALUE '8965'.
  3494     12  ER-9095                 PIC  X(04) VALUE '9095'.
  3495     12  ER-9097                 PIC  X(04) VALUE '9097'.
  3496     12  ER-9281                 PIC  X(04) VALUE '9281'.
  3497     12  ER-9283                 PIC  X(04) VALUE '9283'.
  3498     12  ER-9298                 PIC  X(04) VALUE '9298'.
  3499     12  ER-9299                 PIC  X(04) VALUE '9299'.
  3500     12  ER-9320                 PIC  X(04) VALUE '9320'.
  3501     12  ER-9327                 PIC  X(04) VALUE '9327'.
  3502     12  ER-9426                 PIC  X(04) VALUE '9426'.
  3503     12  ER-9427                 PIC  X(04) VALUE '9427'.
  3504     12  ER-9840                 PIC  X(04) VALUE '9840'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  67
* EL689.cbl
  3506*    COPY ELCAID.
  3507******************************************************************
  3508*                                                                *
  3509*                            ELCAID.                             *
  3510*                            VMOD=2.001                          *
  3511*                                                                *
  3512*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3513*                                                                *
  3514*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3515*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3516******************************************************************
  3517
  3518 01  DFHAID.
  3519   02  DFHNULL   PIC  X  VALUE  ' '.
  3520   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3521   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3522   02  DFHPEN    PIC  X  VALUE  '='.
  3523   02  DFHOPID   PIC  X  VALUE  'W'.
  3524   02  DFHPA1    PIC  X  VALUE  '%'.
  3525   02  DFHPA2    PIC  X  VALUE  '>'.
  3526   02  DFHPA3    PIC  X  VALUE  ','.
  3527   02  DFHPF1    PIC  X  VALUE  '1'.
  3528   02  DFHPF2    PIC  X  VALUE  '2'.
  3529   02  DFHPF3    PIC  X  VALUE  '3'.
  3530   02  DFHPF4    PIC  X  VALUE  '4'.
  3531   02  DFHPF5    PIC  X  VALUE  '5'.
  3532   02  DFHPF6    PIC  X  VALUE  '6'.
  3533   02  DFHPF7    PIC  X  VALUE  '7'.
  3534   02  DFHPF8    PIC  X  VALUE  '8'.
  3535   02  DFHPF9    PIC  X  VALUE  '9'.
  3536   02  DFHPF10   PIC  X  VALUE  ':'.
  3537   02  DFHPF11   PIC  X  VALUE  '#'.
  3538   02  DFHPF12   PIC  X  VALUE  '@'.
  3539   02  DFHPF13   PIC  X  VALUE  'A'.
  3540   02  DFHPF14   PIC  X  VALUE  'B'.
  3541   02  DFHPF15   PIC  X  VALUE  'C'.
  3542   02  DFHPF16   PIC  X  VALUE  'D'.
  3543   02  DFHPF17   PIC  X  VALUE  'E'.
  3544   02  DFHPF18   PIC  X  VALUE  'F'.
  3545   02  DFHPF19   PIC  X  VALUE  'G'.
  3546   02  DFHPF20   PIC  X  VALUE  'H'.
  3547   02  DFHPF21   PIC  X  VALUE  'I'.
  3548*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3549   02  DFHPF22   PIC  X  VALUE  '['.
  3550   02  DFHPF23   PIC  X  VALUE  '.'.
  3551   02  DFHPF24   PIC  X  VALUE  '<'.
  3552   02  DFHMSRE   PIC  X  VALUE  'X'.
  3553   02  DFHSTRF   PIC  X  VALUE  'h'.
  3554   02  DFHTRIG   PIC  X  VALUE  '"'.
  3555 01  FILLER    REDEFINES DFHAID.
  3556     12  FILLER                  PIC  X(08).
  3557     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  68
* EL689.cbl
  3559*    COPY ELCATTR.
  3560******************************************************************
  3561*                                                                *
  3562*                            ELCATTR.                            *
  3563*                            VMOD=2.001                          *
  3564*                                                                *
  3565*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  3566*                                                                *
  3567*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  3568*                                                                *
  3569*                   POS 1   P=PROTECTED                          *
  3570*                           U=UNPROTECTED                        *
  3571*                           S=ASKIP                              *
  3572*                   POS 2   A=ALPHA/NUMERIC                      *
  3573*                           N=NUMERIC                            *
  3574*                   POS 3   N=NORMAL                             *
  3575*                           B=BRIGHT                             *
  3576*                           D=DARK                               *
  3577*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  3578*                           OF=MODIFIED DATA TAG OFF             *
  3579*                                                                *
  3580*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  3581******************************************************************
  3582 01  ATTRIBUTE-LIST.
  3583     12  AL-PABOF            PIC X       VALUE 'Y'.
  3584     12  AL-PABON            PIC X       VALUE 'Z'.
  3585     12  AL-PADOF            PIC X       VALUE '%'.
  3586     12  AL-PADON            PIC X       VALUE '_'.
  3587     12  AL-PANOF            PIC X       VALUE '-'.
  3588     12  AL-PANON            PIC X       VALUE '/'.
  3589     12  AL-SABOF            PIC X       VALUE '8'.
  3590     12  AL-SABON            PIC X       VALUE '9'.
  3591     12  AL-SADOF            PIC X       VALUE '@'.
  3592     12  AL-SADON            PIC X       VALUE QUOTE.
  3593     12  AL-SANOF            PIC X       VALUE '0'.
  3594     12  AL-SANON            PIC X       VALUE '1'.
  3595     12  AL-UABOF            PIC X       VALUE 'H'.
  3596     12  AL-UABON            PIC X       VALUE 'I'.
  3597     12  AL-UADOF            PIC X       VALUE '<'.
  3598     12  AL-UADON            PIC X       VALUE '('.
  3599     12  AL-UANOF            PIC X       VALUE ' '.
  3600     12  AL-UANON            PIC X       VALUE 'A'.
  3601     12  AL-UNBOF            PIC X       VALUE 'Q'.
  3602     12  AL-UNBON            PIC X       VALUE 'R'.
  3603     12  AL-UNDOF            PIC X       VALUE '*'.
  3604     12  AL-UNDON            PIC X       VALUE ')'.
  3605     12  AL-UNNOF            PIC X       VALUE '&'.
  3606     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  69
* EL689.cbl
  3608*    COPY ELCDATE.
  3609******************************************************************
  3610*                                                                *
  3611*                                                                *
  3612*                            ELCDATE.                            *
  3613*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3614*                            VMOD=2.003
  3615*                                                                *
  3616*                                                                *
  3617*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3618*                 LENGTH = 200                                   *
  3619******************************************************************
  3620
  3621 01  DATE-CONVERSION-DATA.
  3622     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3623     12  DC-OPTION-CODE                PIC X.
  3624         88  BIN-TO-GREG                VALUE ' '.
  3625         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3626         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3627         88  YMD-GREG-TO-BIN            VALUE '3'.
  3628         88  MDY-GREG-TO-BIN            VALUE '4'.
  3629         88  JULIAN-TO-BIN              VALUE '5'.
  3630         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3631         88  FIND-CENTURY               VALUE '7'.
  3632         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3633         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3634         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3635         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3636         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3637         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3638         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3639         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3640         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3641         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3642         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3643         88  BIN-3-TO-GREG              VALUE 'I'.
  3644         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3645         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3646         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3647         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3648         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3649         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3650         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3651         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3652         88  THREE-CHARACTER-BIN
  3653                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3654         88  GREGORIAN-TO-BIN
  3655                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3656         88  BIN-TO-GREGORIAN
  3657                  VALUES ' ' '1' 'I' '8' 'G'.
  3658         88  JULIAN-TO-BINARY
  3659                  VALUES '5' 'C' 'E' 'F'.
  3660     12  DC-ERROR-CODE                 PIC X.
  3661         88  NO-CONVERSION-ERROR        VALUE ' '.
  3662         88  DATE-CONVERSION-ERROR
  3663                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3664         88  DATE-IS-ZERO               VALUE '1'.
  3665         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  70
* EL689.cbl
  3666         88  DATE-IS-INVALID            VALUE '3'.
  3667         88  DATE1-GREATER-DATE2        VALUE '4'.
  3668         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3669         88  DATE-INVALID-OPTION        VALUE '9'.
  3670         88  INVALID-CENTURY            VALUE 'A'.
  3671         88  ONLY-CENTURY               VALUE 'B'.
  3672         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3673         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3674     12  DC-END-OF-MONTH               PIC X.
  3675         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3676     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3677         88  USE-NORMAL-PROCESS         VALUE ' '.
  3678         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3679         88  ADJUST-UP-100-YRS          VALUE '2'.
  3680     12  FILLER                        PIC X.
  3681     12  DC-CONVERSION-DATES.
  3682         16  DC-BIN-DATE-1             PIC XX.
  3683         16  DC-BIN-DATE-2             PIC XX.
  3684         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3685         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3686                       DC-GREG-DATE-1-EDIT.
  3687             20  DC-EDIT1-MONTH        PIC 99.
  3688             20  SLASH1-1              PIC X.
  3689             20  DC-EDIT1-DAY          PIC 99.
  3690             20  SLASH1-2              PIC X.
  3691             20  DC-EDIT1-YEAR         PIC 99.
  3692         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3693         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3694                     DC-GREG-DATE-2-EDIT.
  3695             20  DC-EDIT2-MONTH        PIC 99.
  3696             20  SLASH2-1              PIC X.
  3697             20  DC-EDIT2-DAY          PIC 99.
  3698             20  SLASH2-2              PIC X.
  3699             20  DC-EDIT2-YEAR         PIC 99.
  3700         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3701         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3702                     DC-GREG-DATE-1-YMD.
  3703             20  DC-YMD-YEAR           PIC 99.
  3704             20  DC-YMD-MONTH          PIC 99.
  3705             20  DC-YMD-DAY            PIC 99.
  3706         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3707         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3708                      DC-GREG-DATE-1-MDY.
  3709             20  DC-MDY-MONTH          PIC 99.
  3710             20  DC-MDY-DAY            PIC 99.
  3711             20  DC-MDY-YEAR           PIC 99.
  3712         16  DC-GREG-DATE-1-ALPHA.
  3713             20  DC-ALPHA-MONTH        PIC X(10).
  3714             20  DC-ALPHA-DAY          PIC 99.
  3715             20  FILLER                PIC XX.
  3716             20  DC-ALPHA-CENTURY.
  3717                 24 DC-ALPHA-CEN-N     PIC 99.
  3718             20  DC-ALPHA-YEAR         PIC 99.
  3719         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3720         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3721         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3722         16  DC-JULIAN-DATE            PIC 9(05).
  3723         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  71
* EL689.cbl
  3724                                       PIC 9(05).
  3725         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3726             20  DC-JULIAN-YEAR        PIC 99.
  3727             20  DC-JULIAN-DAYS        PIC 999.
  3728         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3729         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3730         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3731     12  DATE-CONVERSION-VARIBLES.
  3732         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3733         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3734             20  FILLER                PIC 9(3).
  3735             20  HOLD-CEN-1-CCYY.
  3736                 24  HOLD-CEN-1-CC     PIC 99.
  3737                 24  HOLD-CEN-1-YY     PIC 99.
  3738             20  HOLD-CEN-1-MO         PIC 99.
  3739             20  HOLD-CEN-1-DA         PIC 99.
  3740         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3741             20  HOLD-CEN-1-R-MO       PIC 99.
  3742             20  HOLD-CEN-1-R-DA       PIC 99.
  3743             20  HOLD-CEN-1-R-CCYY.
  3744                 24  HOLD-CEN-1-R-CC   PIC 99.
  3745                 24  HOLD-CEN-1-R-YY   PIC 99.
  3746             20  FILLER                PIC 9(3).
  3747         16  HOLD-CENTURY-1-X.
  3748             20  FILLER                PIC X(3)  VALUE SPACES.
  3749             20  HOLD-CEN-1-X-CCYY.
  3750                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3751                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3752             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3753             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3754         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3755             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3756             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3757             20  HOLD-CEN-1-R-X-CCYY.
  3758                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3759                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3760             20  FILLER                PIC XXX.
  3761         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3762         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3763         16  DC-JULIAN-DATE-1          PIC 9(07).
  3764         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3765             20  DC-JULIAN-1-CCYY.
  3766                 24  DC-JULIAN-1-CC    PIC 99.
  3767                 24  DC-JULIAN-1-YR    PIC 99.
  3768             20  DC-JULIAN-DA-1        PIC 999.
  3769         16  DC-JULIAN-DATE-2          PIC 9(07).
  3770         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3771             20  DC-JULIAN-2-CCYY.
  3772                 24  DC-JULIAN-2-CC    PIC 99.
  3773                 24  DC-JULIAN-2-YR    PIC 99.
  3774             20  DC-JULIAN-DA-2        PIC 999.
  3775         16  DC-GREG-DATE-A-EDIT.
  3776             20  DC-EDITA-MONTH        PIC 99.
  3777             20  SLASHA-1              PIC X VALUE '/'.
  3778             20  DC-EDITA-DAY          PIC 99.
  3779             20  SLASHA-2              PIC X VALUE '/'.
  3780             20  DC-EDITA-CCYY.
  3781                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  72
* EL689.cbl
  3782                 24  DC-EDITA-YEAR     PIC 99.
  3783         16  DC-GREG-DATE-B-EDIT.
  3784             20  DC-EDITB-MONTH        PIC 99.
  3785             20  SLASHB-1              PIC X VALUE '/'.
  3786             20  DC-EDITB-DAY          PIC 99.
  3787             20  SLASHB-2              PIC X VALUE '/'.
  3788             20  DC-EDITB-CCYY.
  3789                 24  DC-EDITB-CENT     PIC 99.
  3790                 24  DC-EDITB-YEAR     PIC 99.
  3791         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3792         16  DC-GREG-DATE-CYMD-R REDEFINES
  3793                              DC-GREG-DATE-CYMD.
  3794             20  DC-CYMD-CEN           PIC 99.
  3795             20  DC-CYMD-YEAR          PIC 99.
  3796             20  DC-CYMD-MONTH         PIC 99.
  3797             20  DC-CYMD-DAY           PIC 99.
  3798         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3799         16  DC-GREG-DATE-MDCY-R REDEFINES
  3800                              DC-GREG-DATE-MDCY.
  3801             20  DC-MDCY-MONTH         PIC 99.
  3802             20  DC-MDCY-DAY           PIC 99.
  3803             20  DC-MDCY-CEN           PIC 99.
  3804             20  DC-MDCY-YEAR          PIC 99.
  3805    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3806        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3807    12  DC-EL310-DATE                  PIC X(21).
  3808    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  73
* EL689.cbl
  3810*    COPY ELCNWA.
  3811*****************************************************************
  3812*                                                               *
  3813*                                                               *
  3814*                            ELCNWA.                            *
  3815*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3816*                            VMOD=2.003                         *
  3817*                                                               *
  3818*            M O V E   N A M E   W O R K   A R E A.             *
  3819*                                                               *
  3820*****************************************************************.
  3821
  3822 01  WS-NAME-WORK-AREA.
  3823     05  WS-INSURED-LAST-NAME        PIC X(15).
  3824     05  WS-INSURED-1ST-NAME         PIC X(12).
  3825     05  WS-INSURED-MID-INIT         PIC X.
  3826
  3827     05  WS-NAME-WORK.
  3828         10  WS-NW                   PIC X
  3829             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  3830
  3831     05  WS-NAME-WORK2.
  3832         10  WS-NW2                  PIC X
  3833             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  3834                                        NWA-INDEX0.
  3835
  3836     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  3837                                     COMP-3.
  3838
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  74
* EL689.cbl
  3840*    COPY ELCEMIB.
  3841******************************************************************
  3842*                                                                *
  3843*                                                                *
  3844*                            ELCEMIB.                            *
  3845*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3846*                            VMOD=2.005                          *
  3847*                                                                *
  3848*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  3849*                                                                *
  3850******************************************************************
  3851 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  3852     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  3853     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  3854     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  3855     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  3856     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  3857     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  3858     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  3859     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  3860     12  EMI-SWITCH1             PIC X        VALUE '1'.
  3861         88  EMI-NO-ERRORS                    VALUE '1'.
  3862         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  3863         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  3864     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3865         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3866     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3867         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3868         88  EMI-AREA1-FULL                   VALUE '2'.
  3869     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3870         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3871         88  EMI-AREA2-FULL                   VALUE '2'.
  3872     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3873         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3874         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3875         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3876         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3877         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3878     12  EMI-ERROR-LINES.
  3879         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3880         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3881         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3882         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3883             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3884                 24  EMI-ERR-NUM         PIC X(4).
  3885                 24  EMI-FILLER          PIC X.
  3886                 24  EMI-SEV             PIC X.
  3887                 24  FILLER              PIC X.
  3888             20  FILLER                  PIC X(02).
  3889     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3890         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3891             20  EMI-ERROR-NUMBER    PIC X(4).
  3892             20  EMI-FILL            PIC X.
  3893             20  EMI-SEVERITY        PIC X.
  3894             20  FILLER              PIC X.
  3895             20  EMI-ERROR-TEXT.
  3896                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3897                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  75
* EL689.cbl
  3898     12  EMI-SEVERITY-SAVE           PIC X.
  3899         88  EMI-NOTE                    VALUE 'N'.
  3900         88  EMI-WARNING                 VALUE 'W'.
  3901         88  EMI-FORCABLE                VALUE 'F'.
  3902         88  EMI-FATAL                   VALUE 'X'.
  3903     12  EMI-MESSAGE-FLAG            PIC X.
  3904         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3905         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3906     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3907     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3908         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3909         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3910         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3911     12  emi-claim-no                pic x(7).
  3912     12  emi-claim-type              pic x(6).
  3913     12  FILLER                      PIC X(124)  VALUE SPACES.
  3914     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3915     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3916     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3917     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  3918 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  76
* EL689.cbl
  3920*    COPY ELCLOGOF.
  3921******************************************************************
  3922*                                                                *
  3923*                                                                *
  3924*                            ELCLOGOF.                           *
  3925*                            VMOD=2.001                          *
  3926*                                                                *
  3927*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  3928*                                                                *
  3929******************************************************************
  3930 01  CLASIC-LOGOFF.
  3931     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  3932     12  LOGOFF-TEXT.
  3933         16  FILLER          PIC X(5)    VALUE SPACES.
  3934         16  LOGOFF-MSG.
  3935             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  3936             20  FILLER      PIC X       VALUE SPACES.
  3937             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  3938         16  FILLER          PIC X(80)
  3939           VALUE '* YOU ARE NOW LOGGED OFF'.
  3940         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  3941         16  FILLER          PIC X       VALUE QUOTE.
  3942         16  LOGOFF-SYS-MSG  PIC X(17)
  3943           VALUE 'S CLAS-IC SYSTEM '.
  3944     12  TEXT-MESSAGES.
  3945         16  UNACCESS-MSG    PIC X(29)
  3946             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  3947         16  PGMIDERR-MSG    PIC X(17)
  3948             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  77
* EL689.cbl
  3950*    COPY ELCSCTM.
  3951******************************************************************
  3952*                                                                *
  3953*                                                                *
  3954*                            ELCSCTM                             *
  3955*                            VMOD=2.001                          *
  3956*                                                                *
  3957*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  3958*                                                                *
  3959******************************************************************
  3960 01  SECURITY-MESSAGE.
  3961     12  FILLER                          PIC X(30)
  3962            VALUE '** LOGIC SECURITY VIOLATION -'.
  3963     12  SM-READ                         PIC X(6).
  3964     12  FILLER                          PIC X(5)
  3965            VALUE ' PGM='.
  3966     12  SM-PGM                          PIC X(6).
  3967     12  FILLER                          PIC X(5)
  3968            VALUE ' OPR='.
  3969     12  SM-PROCESSOR-ID                 PIC X(4).
  3970     12  FILLER                          PIC X(6)
  3971            VALUE ' TERM='.
  3972     12  SM-TERMID                       PIC X(4).
  3973     12  FILLER                          PIC XX   VALUE SPACE.
  3974     12  SM-JUL-DATE                     PIC 9(5).
  3975     12  FILLER                          PIC X    VALUE SPACE.
  3976     12  SM-TIME                         PIC 99.99.
  3977
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  78
* EL689.cbl
  3979*    COPY ELCSCRTY.
  3980******************************************************************
  3981*                                                                *
  3982*                                                                *
  3983*                            ELCSCRTY                            *
  3984*                            VMOD=2.001                          *
  3985*                                                                *
  3986*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  3987*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  3988*        SAVED IN PI-SECURITY-ADDRESS.                           *
  3989*                                                                *
  3990******************************************************************
  3991 01  SECURITY-CONTROL.
  3992     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  3993     12  FILLER                       PIC XX    VALUE 'SC'.
  3994     12  SC-CREDIT-CODES.
  3995         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  3996             20  SC-CREDIT-DISPLAY    PIC X.
  3997             20  SC-CREDIT-UPDATE     PIC X.
  3998     12  SC-CLAIMS-CODES.
  3999         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  4000             20  SC-CLAIMS-DISPLAY    PIC X.
  4001             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  79
* EL689.cbl
  4003
  4004 01  W-TS-WORK-AREA              PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  80
* EL689.cbl
  4006****************************************************************
  4007*
  4008* Copyright (c) 2007-2013 Dell Inc.
  4009* All rights reserved.
  4010*
  4011****************************************************************
  4012 01  DFHEIV.
  4013   02  DFHEIV0               PIC X(35).
  4014   02  DFHEIV1               PIC X(08).
  4015   02  DFHEIV2               PIC X(08).
  4016   02  DFHEIV3               PIC X(08).
  4017   02  DFHEIV4               PIC X(06).
  4018   02  DFHEIV5               PIC X(04).
  4019   02  DFHEIV6               PIC X(04).
  4020   02  DFHEIV7               PIC X(02).
  4021   02  DFHEIV8               PIC X(02).
  4022   02  DFHEIV9               PIC X(01).
  4023   02  DFHEIV10              PIC S9(7) COMP-3.
  4024   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4025   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4026   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4027   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4028   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4029   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4030   02  DFHEIV17              PIC X(04).
  4031   02  DFHEIV18              PIC X(04).
  4032   02  DFHEIV19              PIC X(04).
  4033   02  DFHEIV20              USAGE IS POINTER.
  4034   02  DFHEIV21              USAGE IS POINTER.
  4035   02  DFHEIV22              USAGE IS POINTER.
  4036   02  DFHEIV23              USAGE IS POINTER.
  4037   02  DFHEIV24              USAGE IS POINTER.
  4038   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4039   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4040   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4041   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4042   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4043   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4044   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4045   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4046   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4047   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4048   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4049   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4050   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4051   02  FILLER                PIC X(02).
  4052   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4053   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4054   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4055   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4056   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4057   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4058   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4059 LINKAGE  SECTION.
  4060*****************************************************************
  4061*                                                               *
  4062* Copyright (c) 2007-2013 Dell Inc.                             *
  4063* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  81
* EL689.cbl
  4064*                                                               *
  4065*****************************************************************
  4066 01  dfheiblk.
  4067     02  eibtime          pic s9(7) comp-3.
  4068     02  eibdate          pic s9(7) comp-3.
  4069     02  eibtrnid         pic x(4).
  4070     02  eibtaskn         pic s9(7) comp-3.
  4071     02  eibtrmid         pic x(4).
  4072     02  dfheigdi         pic s9(4) comp.
  4073     02  eibcposn         pic s9(4) comp.
  4074     02  eibcalen         pic s9(4) comp.
  4075     02  eibaid           pic x(1).
  4076     02  eibfiller1       pic x(1).
  4077     02  eibfn            pic x(2).
  4078     02  eibfiller2       pic x(2).
  4079     02  eibrcode         pic x(6).
  4080     02  eibfiller3       pic x(2).
  4081     02  eibds            pic x(8).
  4082     02  eibreqid         pic x(8).
  4083     02  eibrsrce         pic x(8).
  4084     02  eibsync          pic x(1).
  4085     02  eibfree          pic x(1).
  4086     02  eibrecv          pic x(1).
  4087     02  eibsend          pic x(1).
  4088     02  eibatt           pic x(1).
  4089     02  eibeoc           pic x(1).
  4090     02  eibfmh           pic x(1).
  4091     02  eibcompl         pic x(1).
  4092     02  eibsig           pic x(1).
  4093     02  eibconf          pic x(1).
  4094     02  eiberr           pic x(1).
  4095     02  eibrldbk         pic x(1).
  4096     02  eiberrcd         pic x(4).
  4097     02  eibsynrb         pic x(1).
  4098     02  eibnodat         pic x(1).
  4099     02  eibfiller5       pic x(2).
  4100     02  eibresp          pic s9(8) comp.
  4101     02  eibresp2         pic s9(8) comp.
  4102     02  dfheigdj         pic s9(4) comp.
  4103     02  dfheigdk         pic s9(4) comp.
  4104 01  DFHCOMMAREA                 PIC X(1024).
  4105 01  var  pic x(30).
  4106
  4107*    COPY ERCACCT.
  4108******************************************************************
  4109*                                                                *
  4110*                                                                *
  4111*                            ERCACCT                             *
  4112*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4113*                            VMOD=2.031                          *
  4114*                                                                *
  4115*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4116*                                                                *
  4117*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4118*   VSAM ACCOUNT MASTER FILES.                                   *
  4119*                                                                *
  4120*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4121*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  82
* EL689.cbl
  4122*   FILE TYPE = VSAM,KSDS                                        *
  4123*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4124*                                                                *
  4125*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4126*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4127*                                                                *
  4128*   LOG = NO                                                     *
  4129*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4130*                                                                *
  4131*                                                                *
  4132******************************************************************
  4133*                   C H A N G E   L O G
  4134*
  4135* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4136*-----------------------------------------------------------------
  4137*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4138* EFFECTIVE    NUMBER
  4139*-----------------------------------------------------------------
  4140* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4141* 092705    2005050300006  PEMA  ADD SPP LEASES
  4142* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4143* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4144* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4145* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4146* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4147* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  4148******************************************************************
  4149
  4150 01  ACCOUNT-MASTER.
  4151     12  AM-RECORD-ID                      PIC XX.
  4152         88  VALID-AM-ID                      VALUE 'AM'.
  4153
  4154     12  AM-CONTROL-PRIMARY.
  4155         16  AM-COMPANY-CD                 PIC X.
  4156         16  AM-MSTR-CNTRL.
  4157             20  AM-CONTROL-A.
  4158                 24  AM-CARRIER            PIC X.
  4159                 24  AM-GROUPING.
  4160                     28 AM-GROUPING-PREFIX PIC XXX.
  4161                     28 AM-GROUPING-PRIME  PIC XXX.
  4162                 24  AM-STATE              PIC XX.
  4163                 24  AM-ACCOUNT.
  4164                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4165                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4166             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4167                                           PIC X(19).
  4168             20  AM-CNTRL-B.
  4169                 24  AM-EXPIRATION-DT      PIC XX.
  4170                 24  FILLER                PIC X(4).
  4171             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4172                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4173
  4174     12  AM-CONTROL-BY-VAR-GRP.
  4175         16  AM-COMPANY-CD-A1              PIC X.
  4176         16  AM-VG-CARRIER                 PIC X.
  4177         16  AM-VG-GROUPING                PIC X(6).
  4178         16  AM-VG-STATE                   PIC XX.
  4179         16  AM-VG-ACCOUNT                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  83
* EL689.cbl
  4180         16  AM-VG-DATE.
  4181             20  AM-VG-EXPIRATION-DT       PIC XX.
  4182             20  FILLER                    PIC X(4).
  4183         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4184                                           PIC 9(11)      COMP-3.
  4185     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4186         16  FILLER                        PIC X(10).
  4187         16  AM-VG-KEY3.
  4188             20  AM-VG3-ACCOUNT            PIC X(10).
  4189             20  AM-VG3-EXP-DT             PIC XX.
  4190         16  FILLER                        PIC X(4).
  4191     12  AM-MAINT-INFORMATION.
  4192         16  AM-LAST-MAINT-DT              PIC XX.
  4193         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4194         16  AM-LAST-MAINT-USER            PIC X(4).
  4195         16  FILLER                        PIC XX.
  4196
  4197     12  AM-EFFECTIVE-DT                   PIC XX.
  4198     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4199
  4200     12  AM-PREV-DATES  COMP-3.
  4201         16  AM-PREV-EXP-DT                PIC 9(11).
  4202         16  AM-PREV-EFF-DT                PIC 9(11).
  4203
  4204     12  AM-REPORT-CODE-1                  PIC X(10).
  4205     12  AM-REPORT-CODE-2                  PIC X(10).
  4206
  4207     12  AM-CITY-CODE                      PIC X(4).
  4208     12  AM-COUNTY-PARISH                  PIC X(6).
  4209
  4210     12  AM-NAME                           PIC X(30).
  4211     12  AM-PERSON                         PIC X(30).
  4212     12  AM-ADDRS                          PIC X(30).
  4213     12  AM-CITY.
  4214         16  AM-ADDR-CITY                  PIC X(28).
  4215         16  AM-ADDR-STATE                 PIC XX.
  4216     12  AM-ZIP.
  4217         16  AM-ZIP-PRIME.
  4218             20  AM-ZIP-PRI-1ST            PIC X.
  4219                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4220             20  FILLER                    PIC X(4).
  4221         16  AM-ZIP-PLUS4                  PIC X(4).
  4222     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4223         16  AM-CAN-POSTAL-1               PIC XXX.
  4224         16  AM-CAN-POSTAL-2               PIC XXX.
  4225         16  FILLER                        PIC XXX.
  4226     12  AM-TEL-NO.
  4227         16  AM-AREA-CODE                  PIC 999.
  4228         16  AM-TEL-PRE                    PIC 999.
  4229         16  AM-TEL-NBR                    PIC 9(4).
  4230     12  AM-TEL-LOC                        PIC X.
  4231         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4232         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4233
  4234     12  AM-COMM-STRUCTURE.
  4235         16  AM-DEFN-1.
  4236             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4237                 24  AM-AGT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  84
* EL689.cbl
  4238                     28  AM-AGT-PREFIX     PIC X(4).
  4239                     28  AM-AGT-PRIME      PIC X(6).
  4240                 24  AM-COM-TYP            PIC X.
  4241                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4242                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4243                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4244                 24  AM-RECALC-LV-INDIC    PIC X.
  4245                 24  AM-RETRO-LV-INDIC     PIC X.
  4246                 24  AM-GL-CODES           PIC X.
  4247                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4248                 24  FILLER                PIC X(01).
  4249         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4250             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4251                 24  FILLER                PIC X(11).
  4252                 24  AM-L-COMA             PIC XXX.
  4253                 24  AM-J-COMA             PIC XXX.
  4254                 24  AM-A-COMA             PIC XXX.
  4255                 24  FILLER                PIC X(6).
  4256
  4257     12  AM-COMM-CHANGE-STATUS             PIC X.
  4258         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4259
  4260     12  AM-CSR-CODE                       PIC X(4).
  4261
  4262     12  AM-BILLING-STATUS                 PIC X.
  4263         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4264         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4265     12  AM-AUTO-REFUND-SW                 PIC X.
  4266         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4267         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4268     12  AM-GPCD                           PIC 99.
  4269     12  AM-IG                             PIC X.
  4270         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4271         88  AM-HAS-GROUP                     VALUE '2'.
  4272     12  AM-STATUS                         PIC X.
  4273         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4274         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4275         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4276         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4277         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4278         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4279         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  4280         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  4281         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  4282         88  AM-ACCOUNT-PENDING               VALUE '9'.
  4283     12  AM-REMIT-TO                       PIC 99.
  4284     12  AM-ID-NO                          PIC X(11).
  4285
  4286     12  AM-CAL-TABLE                      PIC XX.
  4287     12  AM-LF-DEVIATION                   PIC XXX.
  4288     12  AM-AH-DEVIATION                   PIC XXX.
  4289     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4290     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4291     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4292     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4293     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4294     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4295
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  85
* EL689.cbl
  4296     12  AM-USER-FIELDS.
  4297         16  AM-FLD-1                      PIC XX.
  4298         16  AM-FLD-2                      PIC XX.
  4299         16  AM-FLD-3                      PIC XX.
  4300         16  AM-FLD-4                      PIC XX.
  4301         16  AM-FLD-5                      PIC XX.
  4302
  4303     12  AM-1ST-PROD-DATE.
  4304         16  AM-1ST-PROD-YR                PIC XX.
  4305         16  AM-1ST-PROD-MO                PIC XX.
  4306         16  AM-1ST-PROD-DA                PIC XX.
  4307     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4308     12  AM-CERTS-PURGED-DATE.
  4309         16  AM-PUR-YR                     PIC XX.
  4310         16  AM-PUR-MO                     PIC XX.
  4311         16  AM-PUR-DA                     PIC XX.
  4312     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4313     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4314     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4315     12  AM-INACTIVE-DATE.
  4316         16  AM-INA-MO                     PIC 99.
  4317         16  AM-INA-DA                     PIC 99.
  4318         16  AM-INA-YR                     PIC 99.
  4319     12  AM-AR-HI-CERT-DATE                PIC XX.
  4320
  4321     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4322     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4323
  4324     12  AM-OB-PAYMENT-MODE                PIC X.
  4325         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4326         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4327         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4328         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4329
  4330     12  AM-AH-ONLY-INDICATOR              PIC X.
  4331         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4332         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4333
  4334     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4335
  4336     12  AM-OVER-SHORT.
  4337         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4338         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4339
  4340     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4341     12  AM-DCC-CLP-STATE                  PIC XX.
  4342
  4343     12  AM-RECALC-COMM                    PIC X.
  4344     12  AM-RECALC-REIN                    PIC X.
  4345
  4346     12  AM-REI-TABLE                      PIC XXX.
  4347     12  AM-REI-ET-LF                      PIC X.
  4348     12  AM-REI-ET-AH                      PIC X.
  4349     12  AM-REI-PE-LF                      PIC X.
  4350     12  AM-REI-PE-AH                      PIC X.
  4351     12  AM-REI-PRT-ST                     PIC X.
  4352     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4353     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  86
* EL689.cbl
  4354     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4355     12  AM-REI-GROUP-A                    PIC X(6).
  4356     12  AM-REI-MORT                       PIC X(4).
  4357     12  AM-REI-PRT-OW                     PIC X.
  4358     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4359     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4360     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4361     12  AM-REI-GROUP-B                    PIC X(6).
  4362
  4363     12  AM-TRUST-TYPE                     PIC X(2).
  4364
  4365     12  AM-EMPLOYER-STMT-USED             PIC X.
  4366     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4367
  4368     12  AM-STD-AH-TYPE                    PIC XX.
  4369     12  AM-EARN-METHODS.
  4370         16  AM-EARN-METHOD-R              PIC X.
  4371             88 AM-REF-RL-R78                 VALUE 'R'.
  4372             88 AM-REF-RL-PR                  VALUE 'P'.
  4373             88 AM-REF-RL-MEAN                VALUE 'M'.
  4374             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4375         16  AM-EARN-METHOD-L              PIC X.
  4376             88 AM-REF-LL-R78                 VALUE 'R'.
  4377             88 AM-REF-LL-PR                  VALUE 'P'.
  4378             88 AM-REF-LL-MEAN                VALUE 'M'.
  4379             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4380         16  AM-EARN-METHOD-A              PIC X.
  4381             88 AM-REF-AH-R78                 VALUE 'R'.
  4382             88 AM-REF-AH-PR                  VALUE 'P'.
  4383             88 AM-REF-AH-MEAN                VALUE 'M'.
  4384             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4385             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4386             88 AM-REF-AH-NET                 VALUE 'N'.
  4387
  4388     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4389     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4390     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4391
  4392     12  AM-RET-Y-N                        PIC X.
  4393     12  AM-RET-P-E                        PIC X.
  4394     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4395     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4396     12  AM-RET-GRP                        PIC X(6).
  4397     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4398         16  AM-POOL-PRIME                 PIC XXX.
  4399         16  AM-POOL-SUB                   PIC XXX.
  4400     12  AM-RETRO-EARNINGS.
  4401         16  AM-RET-EARN-R                 PIC X.
  4402         16  AM-RET-EARN-L                 PIC X.
  4403         16  AM-RET-EARN-A                 PIC X.
  4404     12  AM-RET-ST-TAX-USE                 PIC X.
  4405         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4406         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4407     12  AM-RETRO-BEG-EARNINGS.
  4408         16  AM-RET-BEG-EARN-R             PIC X.
  4409         16  AM-RET-BEG-EARN-L             PIC X.
  4410         16  AM-RET-BEG-EARN-A             PIC X.
  4411     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  87
* EL689.cbl
  4412     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4413
  4414     12  AM-USER-SELECT-OPTIONS.
  4415         16  AM-USER-SELECT-1              PIC X(10).
  4416         16  AM-USER-SELECT-2              PIC X(10).
  4417         16  AM-USER-SELECT-3              PIC X(10).
  4418         16  AM-USER-SELECT-4              PIC X(10).
  4419         16  AM-USER-SELECT-5              PIC X(10).
  4420
  4421     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4422
  4423     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4424
  4425     12  AM-RPT045A-SWITCH                 PIC X.
  4426         88  RPT045A-OFF                   VALUE 'N'.
  4427
  4428     12  AM-INSURANCE-LIMITS.
  4429         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4430         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4431
  4432     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4433         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4434
  4435     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4436         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4437         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4438
  4439     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4440
  4441     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4442     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4443     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4444     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4445     12  AM-DCC-UEF-STATE                  PIC XX.
  4446     12  FILLER                            PIC XXX.
  4447     12  AM-REPORT-CODE-3                  PIC X(10).
  4448*    12  FILLER                            PIC X(22).
  4449
  4450     12  AM-RESERVE-DATE.
  4451         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4452         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4453         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4454
  4455     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4456     12  AM-NOTIFICATION-TYPES.
  4457         16  AM-NOTIF-OF-LETTERS           PIC X.
  4458         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4459         16  AM-NOTIF-OF-REPORTS           PIC X.
  4460         16  AM-NOTIF-OF-STATUS            PIC X.
  4461
  4462     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4463         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4464         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4465         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4466         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4467
  4468     12  AM-BENEFIT-CONTROLS.
  4469         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  88
* EL689.cbl
  4470             20  AM-BENEFIT-CODE           PIC XX.
  4471             20  AM-BENEFIT-TYPE           PIC X.
  4472             20  AM-BENEFIT-REVISION       PIC XXX.
  4473             20  AM-BENEFIT-REM-TERM       PIC X.
  4474             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4475             20  FILLER                    PIC XX.
  4476         16  FILLER                        PIC X(80).
  4477
  4478     12  AM-TRANSFER-DATA.
  4479         16  AM-TRANSFERRED-FROM.
  4480             20  AM-TRNFROM-CARRIER        PIC X.
  4481             20  AM-TRNFROM-GROUPING.
  4482                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4483                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4484             20  AM-TRNFROM-STATE          PIC XX.
  4485             20  AM-TRNFROM-ACCOUNT.
  4486                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4487                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4488             20  AM-TRNFROM-DTE            PIC XX.
  4489         16  AM-TRANSFERRED-TO.
  4490             20  AM-TRNTO-CARRIER          PIC X.
  4491             20  AM-TRNTO-GROUPING.
  4492                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4493                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4494             20  AM-TRNTO-STATE            PIC XX.
  4495             20  AM-TRNTO-ACCOUNT.
  4496                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4497                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4498             20  AM-TRNTO-DTE              PIC XX.
  4499         16  FILLER                        PIC X(10).
  4500
  4501     12  AM-SAVED-REMIT-TO                 PIC 99.
  4502
  4503     12  AM-COMM-STRUCTURE-SAVED.
  4504         16  AM-DEFN-1-SAVED.
  4505             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4506                 24  AM-AGT-SV             PIC X(10).
  4507                 24  AM-COM-TYP-SV         PIC X.
  4508                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4509                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4510                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4511                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4512                 24  FILLER                PIC X.
  4513                 24  AM-GL-CODES-SV        PIC X.
  4514                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4515                 24  FILLER                PIC X.
  4516         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4517             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4518                 24  FILLER                PIC X(11).
  4519                 24  AM-L-COMA-SV          PIC XXX.
  4520                 24  AM-J-COMA-SV          PIC XXX.
  4521                 24  AM-A-COMA-SV          PIC XXX.
  4522                 24  FILLER                PIC X(6).
  4523
  4524     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4525         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4526            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4527            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  89
* EL689.cbl
  4528            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4529
  4530     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4531     12  FILLER                            PIC X(120).
  4532
  4533     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4534         16  AM-CONTROL-NAME               PIC X(30).
  4535         16  AM-EXECUTIVE-ONE.
  4536             20  AM-EXEC1-NAME             PIC X(15).
  4537             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4538                                                          COMP-3.
  4539             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4540                                                          COMP-3.
  4541         16  AM-EXECUTIVE-TWO.
  4542             20  AM-EXEC2-NAME             PIC X(15).
  4543             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4544                                                          COMP-3.
  4545             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4546                                                          COMP-3.
  4547
  4548     12  AM-RETRO-ADDITIONAL-DATA.
  4549         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4550         16  AM-RETRO-PREM-P-E             PIC X.
  4551         16  AM-RETRO-CLMS-P-I             PIC X.
  4552         16  AM-RETRO-RET-BRACKET-LF.
  4553             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4554                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4555                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4556             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4557                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4558                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4559             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4560                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4561                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4562         16  AM-RETRO-RET-BRACKET-AH.
  4563             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4564                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4565                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4566                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4567             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4568                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4569                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4570             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4571                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4572                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4573
  4574     12  AM-COMMENTS.
  4575         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4576
  4577     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4578         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4579         16  AM-FLI-BILLING-CODE           PIC X.
  4580         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4581         16  AM-FLI-UNITED-IDENT           PIC X.
  4582         16  AM-FLI-INTEREST-LOST-DATA.
  4583             20  AM-FLI-BANK-NO            PIC X(5).
  4584             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4585             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  90
* EL689.cbl
  4586             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4587         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4588             20  AM-FLI-AGT                PIC X(9).
  4589             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4590             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4591         16  FILLER                        PIC X(102).
  4592
  4593     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4594         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4595             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4596             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4597             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4598             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4599             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4600         16  FILLER                          PIC X(10).
  4601******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  91
* EL689.cbl
  4603*    COPY ERCARCH.
  4604******************************************************************
  4605*                                                                *
  4606*                            ERCARCH.                            *
  4607*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4608*                            VMOD=2.002                          *
  4609*                                                                *
  4610*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4611*                                                                *
  4612*   FILE TYPE = VSAM,KSDS                                        *
  4613*   RECORD SIZE = 250  RECFORM = FIXED                           *
  4614*                                                                *
  4615*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  4616*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  4617*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  4618*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  4619*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  4620*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  4621*                                                                *
  4622*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4623******************************************************************
  4624*                   C H A N G E   L O G
  4625*
  4626* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4627*-----------------------------------------------------------------
  4628*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4629* EFFECTIVE    NUMBER
  4630*-----------------------------------------------------------------
  4631* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  4632* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4633* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4634******************************************************************
  4635 01  LETTER-ARCHIVE.
  4636     12  LA-RECORD-ID                PIC  X(02).
  4637         88  LA-VALID-ID                VALUE 'LA'.
  4638
  4639     12  LA-CONTROL-PRIMARY.
  4640         16  LA-COMPANY-CD           PIC  X(01).
  4641         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  4642
  4643     12  LA-CONTROL-BY-CERT-RESP.
  4644         16  LA-COMPANY-CD-A2        PIC  X(01).
  4645         16  LA-CERT-NO-A2.
  4646             20  LA-CERT-PRIME-A2    PIC  X(10).
  4647             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  4648         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  4649             20  LA-RESP-PERSON-A2   PIC  X(10).
  4650             20  LA-TYPE-A2          PIC  X(01).
  4651         16  LA-CARRIER-A2           PIC  X(01).
  4652         16  LA-GROUPING-A2          PIC  X(06).
  4653         16  LA-STATE-A2             PIC  X(02).
  4654         16  LA-ACCOUNT-A2           PIC  X(10).
  4655         16  LA-EFFECT-DATE-A2       PIC  X(02).
  4656         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  4657
  4658     12  LA-CONTROL-BY-FORM.
  4659         16  LA-COMPANY-CD-A3        PIC  X(01).
  4660         16  LA-FORM-A3              PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  92
* EL689.cbl
  4661         16  LA-CARRIER-A3           PIC  X(01).
  4662         16  LA-GROUPING-A3          PIC  X(06).
  4663         16  LA-STATE-A3             PIC  X(02).
  4664         16  LA-ACCOUNT-A3           PIC  X(10).
  4665         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  4666
  4667     12  LA-CONTROL-BY-PROCESSOR.
  4668         16  LA-COMPANY-CD-A4        PIC  X(01).
  4669         16  LA-PROCESSOR-CD         PIC  X(04).
  4670         16  LA-CARRIER-A4           PIC  X(01).
  4671         16  LA-GROUPING-A4          PIC  X(06).
  4672         16  LA-STATE-A4             PIC  X(02).
  4673         16  LA-ACCOUNT-A4           PIC  X(10).
  4674         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  4675
  4676     12  LA-CONTROL-BY-KEY-FIELDS.
  4677         16  LA-COMPANY-CD-A5        PIC  X(01).
  4678         16  LA-CARRIER-A5           PIC  X(01).
  4679         16  LA-GROUPING-A5          PIC  X(06).
  4680         16  LA-STATE-A5             PIC  X(02).
  4681         16  LA-ACCOUNT-A5           PIC  X(10).
  4682         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  4683
  4684     12  LA-CONTROL-BY-GROUP-CODE.
  4685         16  LA-COMPANY-CD-A6        PIC  X(01).
  4686         16  LA-ENTRY-A6.
  4687             20  LA-FILLER           PIC  X(02).
  4688             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  4689         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  4690
  4691     12  FILLER                      PIC  X(09).
  4692
  4693     12  LA-HEADER-RECORD.
  4694         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  4695         16  LA-CREATION-DATE        PIC  X(02).
  4696         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  4697         16  LA-FINAL-ACT-DATE       REDEFINES
  4698               LA-FOLLOW-UP-DATE     PIC  X(02).
  4699         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  4700         16  LA-NO-OF-COPIES         PIC S9(01).
  4701         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  4702         16  LA-REPLY-DATE           PIC  X(02).
  4703         16  LA-RESEND-DATES.
  4704             20  LA-RESEND-DATE      PIC  X(02).
  4705             20  LA-SENT-DATE        PIC  X(02).
  4706             20  FILLER              PIC  X(08).
  4707         16  LA-SOURCE-INFORMATION.
  4708             20  LA-DATA-SOURCE      PIC  X(01).
  4709             20  LA-ADDR-SOURCE      PIC  X(01).
  4710         16  LA-STATUS               PIC  X(01).
  4711             88  LA-STATUS-ACTIVE         VALUE 'A'.
  4712             88  LA-STATUS-COMPLETED      VALUE 'C'.
  4713             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  4714             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  4715             88  LA-STATUS-PURGED         VALUE 'P'.
  4716             88  LA-STATUS-VOIDED         VALUE 'V'.
  4717         16  LA-LAST-RESENT-PRINT-DATE
  4718                                     PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  93
* EL689.cbl
  4719         16  LA-PRINT-RESTRICTION    PIC  X(01).
  4720             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4721                                          VALUE 'C'.
  4722             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4723                                          VALUE 'F'.
  4724             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4725                                          VALUE 'P'.
  4726         16  LA-PURGED-DATE          PIC  X(02).
  4727         16  LA-VOIDED-DATE          PIC  X(02).
  4728         16  LA-RESEND-LETR          PIC  X(4).
  4729         16  FILLER                  PIC  X(08).
  4730*        16  LA-RESEND-LETR-2        PIC  X(4).
  4731*        16  LA-RESEND-LETR-3        PIC  X(4).
  4732*        16  FILLER                  PIC  X(59).
  4733         16  LA-ARCHIVE-STATUS       PIC  X.
  4734             88  LA-TEMP                VALUE 'T'.
  4735             88  LA-QWS                 VALUE 'Q'.
  4736             88  LA-BATCH               VALUE 'B'.
  4737         16  LA-FINAL-ACT-IND        PIC  X(1).
  4738         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  4739         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  4740         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  4741                                     PIC X(4).
  4742         16  FILLER                  PIC  X(42).
  4743*        16  FILLER                  PIC  X(71).
  4744         16  LA-LAST-MAINT-DATE      PIC  X(2).
  4745         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  4746         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  4747                                     PIC  X(4).
  4748         16  LA-LAST-UPDATED-BY      PIC  X(4).
  4749
  4750******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  94
* EL689.cbl
  4752*    COPY ERCARCT.
  4753******************************************************************
  4754*                                                                *
  4755*                            ERCARCT.                            *
  4756*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4757*                            VMOD=2.002                          *
  4758*                                                                *
  4759*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  4760*                                                                *
  4761*   FILE TYPE = VSAM,KSDS                                        *
  4762*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  4763*                                                                *
  4764*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  4765*                                                                *
  4766*   LOG = NO                                                     *
  4767*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4768******************************************************************
  4769*                   C H A N G E   L O G
  4770*
  4771* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4772*-----------------------------------------------------------------
  4773*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4774* EFFECTIVE    NUMBER
  4775*-----------------------------------------------------------------
  4776* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4777******************************************************************
  4778 01  LETTER-ARCHIVE-TEXT.
  4779     12  LT-RECORD-ID                PIC  X(02).
  4780         88  LT-VALID-ID                VALUE 'LT'.
  4781
  4782     12  LT-CONTROL-PRIMARY.
  4783         16  LT-COMPANY-CD           PIC  X(01).
  4784         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  4785         16  LT-RECORD-TYPE          PIC  X(01).
  4786             88  LT-ADDRESS-DATA        VALUE '1'.
  4787             88  LT-TEXT-DATA           VALUE '2'.
  4788             88  LT-COMMENT-DATA        VALUE '3'.
  4789         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  4790
  4791     12  FILLER                      PIC  X(28).
  4792     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  4793
  4794     12  LT-TEXT-RECORD.
  4795         16  LT-LETTER-TEXT OCCURS 20 TIMES
  4796                            INDEXED BY LT-NDX.
  4797             20  LT-TEXT-LINE        PIC  X(70).
  4798             20  LT-SKIP-CONTROL     PIC  X(02).
  4799                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  4800                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  4801             20  FILLER              PIC  X(08).
  4802
  4803     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  4804         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  4805             20  LT-COMMENT-LINE     PIC X(69).
  4806             20  LT-COMMENT-CHG-DT   PIC X(02).
  4807             20  LT-COMMENT-CHG-BY   PIC X(04).
  4808             20  FILLER              PIC X(05).
  4809
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  95
* EL689.cbl
  4811*    COPY ELCCERT.
  4812******************************************************************
  4813*                                                                *
  4814*                            ELCCERT.                            *
  4815*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4816*                            VMOD=2.013                          *
  4817*                                                                *
  4818*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4819*                                                                *
  4820*   FILE TYPE = VSAM,KSDS                                        *
  4821*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4822*                                                                *
  4823*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4824*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4825*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4826*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4827*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4828*                                                                *
  4829*   LOG = YES                                                    *
  4830*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4831******************************************************************
  4832*                   C H A N G E   L O G
  4833*
  4834* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4835*-----------------------------------------------------------------
  4836*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4837* EFFECTIVE    NUMBER
  4838*-----------------------------------------------------------------
  4839* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4840* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4841* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4842* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4843* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4844* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4845* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4846* 032612  CR2011110200001  PEMA  AHL CHANGES
  4847* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4848* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4849******************************************************************
  4850
  4851 01  CERTIFICATE-MASTER.
  4852     12  CM-RECORD-ID                      PIC XX.
  4853         88  VALID-CM-ID                      VALUE 'CM'.
  4854
  4855     12  CM-CONTROL-PRIMARY.
  4856         16  CM-COMPANY-CD                 PIC X.
  4857         16  CM-CARRIER                    PIC X.
  4858         16  CM-GROUPING.
  4859             20  CM-GROUPING-PREFIX        PIC X(3).
  4860             20  CM-GROUPING-PRIME         PIC X(3).
  4861         16  CM-STATE                      PIC XX.
  4862         16  CM-ACCOUNT.
  4863             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4864             20  CM-ACCOUNT-PRIME          PIC X(6).
  4865         16  CM-CERT-EFF-DT                PIC XX.
  4866         16  CM-CERT-NO.
  4867             20  CM-CERT-PRIME             PIC X(10).
  4868             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  96
* EL689.cbl
  4869
  4870     12  CM-CONTROL-BY-NAME.
  4871         16  CM-COMPANY-CD-A1              PIC X.
  4872         16  CM-INSURED-LAST-NAME          PIC X(15).
  4873         16  CM-INSURED-INITIALS.
  4874             20  CM-INSURED-INITIAL1       PIC X.
  4875             20  CM-INSURED-INITIAL2       PIC X.
  4876
  4877     12  CM-CONTROL-BY-SSN.
  4878         16  CM-COMPANY-CD-A2              PIC X.
  4879         16  CM-SOC-SEC-NO.
  4880             20  CM-SSN-STATE              PIC XX.
  4881             20  CM-SSN-ACCOUNT            PIC X(6).
  4882             20  CM-SSN-LN3.
  4883                 25  CM-INSURED-INITIALS-A2.
  4884                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4885                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4886                 25 CM-PART-LAST-NAME-A2         PIC X.
  4887
  4888     12  CM-CONTROL-BY-CERT-NO.
  4889         16  CM-COMPANY-CD-A4              PIC X.
  4890         16  CM-CERT-NO-A4                 PIC X(11).
  4891
  4892     12  CM-CONTROL-BY-MEMB.
  4893         16  CM-COMPANY-CD-A5              PIC X.
  4894         16  CM-MEMBER-NO.
  4895             20  CM-MEMB-STATE             PIC XX.
  4896             20  CM-MEMB-ACCOUNT           PIC X(6).
  4897             20  CM-MEMB-LN4.
  4898                 25  CM-INSURED-INITIALS-A5.
  4899                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4900                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4901                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4902
  4903     12  CM-INSURED-PROFILE-DATA.
  4904         16  CM-INSURED-FIRST-NAME.
  4905             20  CM-INSURED-1ST-INIT       PIC X.
  4906             20  FILLER                    PIC X(9).
  4907         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4908         16  CM-INSURED-SEX                PIC X.
  4909             88  CM-SEX-MALE                  VALUE 'M'.
  4910             88  CM-SEX-FEMAL                 VALUE 'F'.
  4911         16  CM-INSURED-JOINT-AGE          PIC 99.
  4912         16  CM-JOINT-INSURED-NAME.
  4913             20  CM-JT-LAST-NAME           PIC X(15).
  4914             20  CM-JT-FIRST-NAME.
  4915                 24  CM-JT-1ST-INIT        PIC X.
  4916                 24  FILLER                PIC X(9).
  4917             20  CM-JT-INITIAL             PIC X.
  4918
  4919     12  CM-LIFE-DATA.
  4920         16  CM-LF-BENEFIT-CD              PIC XX.
  4921         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4922         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4923         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4924         16  CM-LF-DEV-CODE                PIC XXX.
  4925         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4926         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  97
* EL689.cbl
  4927         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4928         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4929         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4930         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4931         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4932         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4933         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4934         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4935         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4936         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4937         16  cm-temp-epiq                  pic xx.
  4938             88  EPIQ-CLASS                  value 'EQ'.
  4939*        16  FILLER                        PIC XX.
  4940
  4941     12  CM-AH-DATA.
  4942         16  CM-AH-BENEFIT-CD              PIC XX.
  4943         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4944         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4945         16  CM-AH-DEV-CODE                PIC XXX.
  4946         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4947         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4948         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4949         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4950         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4951         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4952         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4953         16  CM-AH-PAID-THRU-DT            PIC XX.
  4954             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4955         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4956         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4957         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4958         16  FILLER                        PIC X.
  4959
  4960     12  CM-LOAN-INFORMATION.
  4961         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4962         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4963                                           PIC S9(5)V99  COMP-3.
  4964         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4965         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4966         16  CM-PAY-FREQUENCY              PIC S99.
  4967         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4968         16  CM-RATE-CLASS                 PIC XX.
  4969         16  CM-BENEFICIARY                PIC X(25).
  4970         16  CM-POLICY-FORM-NO             PIC X(12).
  4971         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4972         16  CM-LAST-ADD-ON-DT             PIC XX.
  4973         16  CM-DEDUCTIBLE-AMOUNTS.
  4974             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4975             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4976         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4977             20  CM-RESIDENT-STATE         PIC XX.
  4978             20  CM-RATE-CODE              PIC X(4).
  4979             20  FILLER                    PIC XX.
  4980         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4981             20  CM-LOAN-OFFICER           PIC X(5).
  4982             20  FILLER                    PIC XXX.
  4983         16  CM-CSR-CODE                   PIC XXX.
  4984         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  98
* EL689.cbl
  4985             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4986         16  CM-POST-CARD-IND              PIC X.
  4987         16  CM-NH-INTERFACE-SW            PIC X.
  4988         16  CM-PREMIUM-TYPE               PIC X.
  4989             88  CM-SING-PRM                  VALUE '1'.
  4990             88  CM-O-B-COVERAGE              VALUE '2'.
  4991             88  CM-OPEN-END                  VALUE '3'.
  4992         16  CM-IND-GRP-TYPE               PIC X.
  4993             88  CM-INDIVIDUAL                VALUE 'I'.
  4994             88  CM-GROUP                     VALUE 'G'.
  4995         16  CM-SKIP-CODE                  PIC X.
  4996             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4997             88  SKIP-JULY                    VALUE '1'.
  4998             88  SKIP-AUGUST                  VALUE '2'.
  4999             88  SKIP-SEPTEMBER               VALUE '3'.
  5000             88  SKIP-JULY-AUG                VALUE '4'.
  5001             88  SKIP-AUG-SEPT                VALUE '5'.
  5002             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5003             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5004             88  SKIP-JUNE                    VALUE '8'.
  5005             88  SKIP-JUNE-JULY               VALUE '9'.
  5006             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5007             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5008         16  CM-PAYMENT-MODE               PIC X.
  5009             88  PAY-MONTHLY                  VALUE SPACE.
  5010             88  PAY-WEEKLY                   VALUE '1'.
  5011             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5012             88  PAY-BI-WEEKLY                VALUE '3'.
  5013             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5014         16  CM-LOAN-NUMBER                PIC X(8).
  5015         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5016         16  CM-OLD-LOF                    PIC XXX.
  5017*        16  CM-LOAN-OFFICER               PIC XXX.
  5018         16  CM-REIN-TABLE                 PIC XXX.
  5019         16  CM-SPECIAL-REIN-CODE          PIC X.
  5020         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5021         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5022         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5023
  5024     12  CM-STATUS-DATA.
  5025         16  CM-ENTRY-STATUS               PIC X.
  5026         16  CM-ENTRY-DT                   PIC XX.
  5027
  5028         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5029         16  CM-LF-CANCEL-DT               PIC XX.
  5030         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5031
  5032         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5033         16  CM-LF-DEATH-DT                PIC XX.
  5034         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5035
  5036         16  CM-LF-CURRENT-STATUS          PIC X.
  5037             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5038                                                'M' '4' '5' '9'.
  5039             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5040             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5041             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5042             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page  99
* EL689.cbl
  5043             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5044             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5045             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5046             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5047             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5048             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5049             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5050             88  CM-LF-DECLINED               VALUE 'D'.
  5051             88  CM-LF-VOIDED                 VALUE 'V'.
  5052
  5053         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5054         16  CM-AH-CANCEL-DT               PIC XX.
  5055         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5056
  5057         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5058         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5059         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5060
  5061         16  CM-AH-CURRENT-STATUS          PIC X.
  5062             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5063                                                'M' '4' '5' '9'.
  5064             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5065             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5066             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5067             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5068             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5069             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5070             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5071             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5072             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5073             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5074             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5075             88  CM-AH-DECLINED               VALUE 'D'.
  5076             88  CM-AH-VOIDED                 VALUE 'V'.
  5077
  5078         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5079             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5080             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5081             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5082         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5083
  5084         16  CM-ENTRY-BATCH                PIC X(6).
  5085         16  CM-LF-EXIT-BATCH              PIC X(6).
  5086         16  CM-AH-EXIT-BATCH              PIC X(6).
  5087         16  CM-LAST-MONTH-END             PIC XX.
  5088
  5089     12  CM-NOTE-SW                        PIC X.
  5090         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5091         88  CERT-NOTES-PRESENT               VALUE '1'.
  5092         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5093         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5094         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5095         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5096         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5097         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5098     12  CM-COMP-EXCP-SW                   PIC X.
  5099         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5100         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 100
* EL689.cbl
  5101     12  CM-INSURED-ADDRESS-SW             PIC X.
  5102         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5103         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5104
  5105*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5106     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5107     12  FILLER                            PIC X.
  5108
  5109*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5110     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5111     12  FILLER                            PIC X.
  5112*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5113     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5114
  5115     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5116         88  CERT-ADDED-BATCH                 VALUE ' '.
  5117         88  CERT-ADDED-ONLINE                VALUE '1'.
  5118         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5119         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5120         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5121     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5122         88  CERT-AS-LOADED                   VALUE ' '.
  5123         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5124         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5125         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5126         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5127         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5128         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5129         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5130
  5131     12  CM-ACCOUNT-COMM-PCTS.
  5132         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5133         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5134
  5135     12  CM-USER-FIELD                     PIC X.
  5136     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5137     12  CM-CLP-STATE                      PIC XX.
  5138     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5139     12  CM-USER-RESERVED                  PIC XXX.
  5140     12  FILLER REDEFINES CM-USER-RESERVED.
  5141         16  CM-AH-CLASS-CD                PIC XX.
  5142         16  F                             PIC X.
  5143******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 101
* EL689.cbl
  5145*    COPY ERCCHEK.
  5146******************************************************************
  5147*                                                                *
  5148*                                                                *
  5149*                            ERCCHEK                             *
  5150*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5151*                            VMOD=2.008                          *
  5152*                                                                *
  5153*   FILE DESCRIPTION = CHECK RECORDS                             *
  5154*                                                                *
  5155*   FILE TYPE = VSAM,KSDS                                        *
  5156*   RECORD SIZE = 600    RECFORM = FIXED                         *
  5157*                                                                *
  5158*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  5159*       ALTERNATE INDEX = NONE                                   *
  5160*                                                                *
  5161*   LOG = YES                                                    *
  5162*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5163******************************************************************
  5164*                   C H A N G E   L O G
  5165*
  5166* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5167*-----------------------------------------------------------------
  5168*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5169* EFFECTIVE    NUMBER
  5170*-----------------------------------------------------------------
  5171* 021414    2003053000001  PEMA  changes for auto chk request
  5172******************************************************************
  5173 01  CHECK-RECORDS.
  5174     12  CH-RECORD-ID                      PIC XX.
  5175         88  VALID-CH-ID                      VALUE 'CH'.
  5176
  5177     12  CH-CONTROL-PRIMARY.
  5178         16  CH-COMPANY-CD                 PIC X.
  5179         16  CH-CARRIER                    PIC X.
  5180         16  CH-GROUPING                   PIC X(6).
  5181         16  CH-STATE                      PIC XX.
  5182         16  CH-ACCOUNT                    PIC X(10).
  5183         16  CH-CERT-EFF-DT                PIC XX.
  5184         16  CH-CERT-NO.
  5185             20  CH-CERT-PRIME             PIC X(10).
  5186             20  CH-CERT-SFX               PIC X.
  5187         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  5188
  5189     12  CH-RECORDED-DT                    PIC XX.
  5190     12  CH-RECORDED-BY                    PIC X(4).
  5191     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  5192
  5193     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  5194     12  CH-CHECK-NO                       PIC X(7).
  5195     12  CH-REASON-FOR-CHECK               PIC X(25).
  5196     12  CH-CHECK-WRITTEN-DT               PIC XX.
  5197     12  FILLER                            PIC X.
  5198
  5199     12  CH-PAYEE-INFO.
  5200         16  CH-PAYEE-NAME-1               PIC X(30).
  5201         16  CH-PAYEE-NAME-2               PIC X(30).
  5202         16  CH-PAYEE-ADDRESS-1            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 102
* EL689.cbl
  5203         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  5204         16  CH-PAYEE-CITY-ST.
  5205             20  CH-PAYEE-CITY             PIC X(28).
  5206             20  CH-PAYEE-STATE            PIC XX.
  5207         16  CH-PAYEE-ZIP-CODE.
  5208             20  CH-PAYEE-ZIP.
  5209                 24  CH-ZIP-PRI-1ST        PIC X.
  5210                     88  CH-CANADIAN-POST-CODE
  5211                                           VALUES 'A' THRU 'Z'.
  5212                 24  FILLER                PIC X(4).
  5213             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  5214         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  5215             20  CH-CAN-POSTAL-1           PIC XXX.
  5216             20  CH-CAN-POSTAL-2           PIC XXX.
  5217             20  FILLER                    PIC XXX.
  5218
  5219     12  CH-CHECK-STUB-TEXT.
  5220         16  CH-STUB-LINE-1                PIC X(30).
  5221         16  CH-TEXT-LINE-1                PIC X(50).
  5222         16  CH-TEXT-LINE-2                PIC X(50).
  5223         16  CH-TEXT-LINE-3                PIC X(40).
  5224     12  CH-RETURN-TO                      PIC X(30).
  5225
  5226     12  CH-COMPENSATION-CONTROL.
  5227         16  CH-COMP-CARRIER               PIC X.
  5228         16  CH-COMP-GROUPING              PIC X(6).
  5229         16  CH-COMP-FIN-RESP              PIC X(10).
  5230         16  CH-COMP-ACCOUNT               PIC X(10).
  5231
  5232     12  CH-CREDIT-SELECT-DT               PIC XX.
  5233     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  5234     12  CH-PAYEE-CODE                     PIC X(6).
  5235
  5236     12  CH-VOID-DATA.
  5237         20  CH-VOID-DT                    PIC XX.
  5238         20  CH-VOID-BY                    PIC X(4).
  5239         20  CH-VOID-REASON                PIC X(25).
  5240
  5241     12  CH-APPROVAL-DATA.
  5242         20  CH-APPROVAL-DT                PIC XX.
  5243         20  CH-APPROVAL-STATUS            PIC X.
  5244             88  CH-IN-LIMBO                  VALUE ' '.
  5245             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  5246             88  CH-APPROVED                  VALUE 'A'.
  5247             88  CH-DENIED                    VALUE 'D'.
  5248         20  CH-APPROVED-BY                PIC XXXX.
  5249     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  5250             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5251     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  5252
  5253     12  ch-released-dt                    pic xx.
  5254     12  ch-check-cashed-dt                pic xx.
  5255     12  FILLER                            PIC X.
  5256*    12  CH-CHECK-REFERENCE                PIC X(12).
  5257     12  CH-CHECK-ORIGIN-SW                PIC X.
  5258             88  CH-REFUND-CHECK              VALUE 'R'.
  5259             88  CH-MAINT-CHECK               VALUE 'M'.
  5260
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 103
* EL689.cbl
  5261     12  CH-CANC-DT                        PIC XX.
  5262     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  5263     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  5264
  5265     12  CH-INSURED-NAME                   PIC X(28).
  5266
  5267     12  ch-released-by                    pic x(4).
  5268     12  ch-csr                            pic x(4).
  5269     12  ch-deduct-commission              pic x.
  5270         88  ch-deduct-comm                  value 'Y'.
  5271         88  ch-do-not-deduct-comm           value 'N'.
  5272
  5273     12  FILLER                            PIC X(11).
  5274*    12  CH-LETTER-TABLE.
  5275*        16  CH-LETTERS OCCURS 3 TIMES
  5276*                       INDEXED BY CH-LT-NDX
  5277*                                          PIC X(04).
  5278
  5279     12  FILLER                            PIC X(07).
  5280
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 104
* EL689.cbl
  5282*    COPY ELCCNTL.
  5283******************************************************************
  5284*                                                                *
  5285*                                                                *
  5286*                            ELCCNTL.                            *
  5287*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5288*                            VMOD=2.059                          *
  5289*                                                                *
  5290*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5291*                                                                *
  5292*   FILE TYPE = VSAM,KSDS                                        *
  5293*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5294*                                                                *
  5295*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5296*       ALTERNATE INDEX = NONE                                   *
  5297*                                                                *
  5298*   LOG = YES                                                    *
  5299*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5300******************************************************************
  5301*                   C H A N G E   L O G
  5302*
  5303* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5304*-----------------------------------------------------------------
  5305*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5306* EFFECTIVE    NUMBER
  5307*-----------------------------------------------------------------
  5308* 082503                   PEMA  ADD BENEFIT GROUP
  5309* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5310* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5311* 092705    2005050300006  PEMA  ADD SPP LEASES
  5312* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5313* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5314* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5315* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5316* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5317* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5318* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5319* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5320* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5321* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5322******************************************************************
  5323*
  5324 01  CONTROL-FILE.
  5325     12  CF-RECORD-ID                       PIC XX.
  5326         88  VALID-CF-ID                        VALUE 'CF'.
  5327
  5328     12  CF-CONTROL-PRIMARY.
  5329         16  CF-COMPANY-ID                  PIC XXX.
  5330         16  CF-RECORD-TYPE                 PIC X.
  5331             88  CF-COMPANY-MASTER              VALUE '1'.
  5332             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5333             88  CF-STATE-MASTER                VALUE '3'.
  5334             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5335             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5336             88  CF-CARRIER-MASTER              VALUE '6'.
  5337             88  CF-MORTALITY-MASTER            VALUE '7'.
  5338             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5339             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 105
* EL689.cbl
  5340             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5341             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5342             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5343             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5344             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5345             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5346             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5347             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5348             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5349         16  CF-ACCESS-CD-GENL              PIC X(4).
  5350         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5351             20  CF-PROCESSOR               PIC X(4).
  5352         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5353             20  CF-STATE-CODE              PIC XX.
  5354             20  FILLER                     PIC XX.
  5355         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5356             20  FILLER                     PIC XX.
  5357             20  CF-HI-BEN-IN-REC           PIC XX.
  5358         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5359             20  FILLER                     PIC XXX.
  5360             20  CF-CARRIER-CNTL            PIC X.
  5361         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5362             20  FILLER                     PIC XX.
  5363             20  CF-HI-TYPE-IN-REC          PIC 99.
  5364         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5365             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5366                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5367             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5368             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5369         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5370             20  FILLER                     PIC X.
  5371             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5372         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5373             20  FILLER                     PIC XX.
  5374             20  CF-MORTGAGE-PLAN           PIC XX.
  5375         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5376
  5377     12  CF-LAST-MAINT-DT                   PIC XX.
  5378     12  CF-LAST-MAINT-BY                   PIC X(4).
  5379     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5380
  5381     12  CF-RECORD-BODY                     PIC X(728).
  5382
  5383
  5384****************************************************************
  5385*             COMPANY MASTER RECORD                            *
  5386****************************************************************
  5387
  5388     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5389         16  CF-COMPANY-ADDRESS.
  5390             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5391             20  CF-CL-IN-CARE-OF           PIC X(30).
  5392             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5393             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5394             20  CF-CL-CITY-STATE           PIC X(30).
  5395             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5396             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5397         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 106
* EL689.cbl
  5398         16  CF-COMPANY-PASSWORD            PIC X(8).
  5399         16  CF-SECURITY-OPTION             PIC X.
  5400             88  ALL-SECURITY                   VALUE '1'.
  5401             88  COMPANY-VERIFY                 VALUE '2'.
  5402             88  PROCESSOR-VERIFY               VALUE '3'.
  5403             88  NO-SECURITY                    VALUE '4'.
  5404             88  ALL-BUT-TERM                   VALUE '5'.
  5405         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5406             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5407         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5408             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5409         16  CF-INFORCE-LOCATION            PIC X.
  5410             88  CERTS-ARE-ONLINE               VALUE '1'.
  5411             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5412             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5413         16  CF-LOWER-CASE-LETTERS          PIC X.
  5414         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5415             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5416             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5417             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5418             88  CF-ACCNT-CNTL                  VALUE '3'.
  5419             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5420
  5421         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5422         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5423
  5424         16  CF-LGX-CREDIT-USER             PIC X.
  5425             88  CO-IS-NOT-USER                 VALUE 'N'.
  5426             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5427
  5428         16 CF-CREDIT-CALC-CODES.
  5429             20  CF-CR-REM-TERM-CALC PIC X.
  5430               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5431               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5432               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5433               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5434               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5435               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5436               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5437             20  CF-CR-R78-METHOD           PIC X.
  5438               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5439               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5440
  5441         16  CF-CLAIM-CONTROL-COUNTS.
  5442             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5443                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5444
  5445             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5446                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5447
  5448             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5449                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5450
  5451             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5452                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5453
  5454         16  CF-CURRENT-MONTH-END           PIC XX.
  5455
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 107
* EL689.cbl
  5456         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5457             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5458             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5459             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5460             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5461                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5462                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5463             20  CF-CO-PREM-REJECT-SW       PIC X.
  5464                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5465                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5466             20  CF-CO-REF-REJECT-SW        PIC X.
  5467                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5468                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5469
  5470         16  CF-CO-REPORTING-DT             PIC XX.
  5471         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5472         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5473           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5474           88  CF-CO-MONTH-END                  VALUE '1'.
  5475
  5476         16  CF-LGX-CLAIM-USER              PIC X.
  5477             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5478             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5479
  5480         16  CF-CREDIT-EDIT-CONTROLS.
  5481             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5482             20  CF-MIN-AGE                 PIC 99.
  5483             20  CF-DEFAULT-AGE             PIC 99.
  5484             20  CF-MIN-TERM                PIC S999      COMP-3.
  5485             20  CF-MAX-TERM                PIC S999      COMP-3.
  5486             20  CF-DEFAULT-SEX             PIC X.
  5487             20  CF-JOINT-AGE-INPUT         PIC X.
  5488                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5489             20  CF-BIRTH-DATE-INPUT        PIC X.
  5490                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5491             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5492                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5493                 88  CF-ZERO-CARRIER            VALUE '1'.
  5494                 88  CF-ZERO-GROUPING           VALUE '2'.
  5495                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5496             20  CF-EDIT-SW                 PIC X.
  5497                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5498             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5499             20  CF-CR-PR-METHOD            PIC X.
  5500               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5501               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5502             20  FILLER                     PIC X.
  5503
  5504         16  CF-CREDIT-MISC-CONTROLS.
  5505             20  CF-REIN-TABLE-SW           PIC X.
  5506                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5507             20  CF-COMP-TABLE-SW           PIC X.
  5508                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5509             20  CF-EXPERIENCE-RETENTION-AGE
  5510                                            PIC S9        COMP-3.
  5511             20  CF-CONVERSION-DT           PIC XX.
  5512             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5513             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 108
* EL689.cbl
  5514                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5515                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5516
  5517             20  CF-CR-CHECK-NO-CONTROL.
  5518                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5519                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5520                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5521                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5522                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5523                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5524
  5525                 24  CF-CR-CHECK-COUNT       REDEFINES
  5526                     CF-CR-CHECK-COUNTER      PIC X(4).
  5527
  5528                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5529                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5530
  5531                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5532                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5533                 24  CF-MAIL-PROCESSING       PIC X.
  5534                     88  MAIL-PROCESSING          VALUE 'Y'.
  5535
  5536         16  CF-MISC-SYSTEM-CONTROL.
  5537             20  CF-SYSTEM-C                 PIC X.
  5538                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5539             20  CF-SYSTEM-D                 PIC X.
  5540                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5541             20  CF-SOC-SEC-NO-SW            PIC X.
  5542                 88  SOC-SEC-NO-USED             VALUE '1'.
  5543             20  CF-MEMBER-NO-SW             PIC X.
  5544                 88  MEMBER-NO-USED              VALUE '1'.
  5545             20  CF-TAX-ID-NUMBER            PIC X(11).
  5546             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5547             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5548                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5549                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5550                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5551                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5552             20  CF-SYSTEM-E                 PIC X.
  5553                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5554
  5555         16  CF-LGX-LIFE-USER               PIC X.
  5556             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5557             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5558
  5559         16  CF-CR-MONTH-END-DT             PIC XX.
  5560
  5561         16  CF-FILE-MAINT-DATES.
  5562             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5563                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5564             20  CF-LAST-BATCH       REDEFINES
  5565                 CF-LAST-BATCH-NO               PIC X(4).
  5566             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5567             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5568             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5569             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5570             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5571             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 109
* EL689.cbl
  5572             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5573             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5574             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5575             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5576
  5577         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5578         16  FILLER                         PIC X.
  5579
  5580         16  CF-ALT-MORT-CODE               PIC X(4).
  5581         16  CF-MEMBER-CAPTION              PIC X(10).
  5582
  5583         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5584             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5585             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5586             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5587             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5588             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5589
  5590         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5591
  5592         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5593         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5594         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5595         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5596
  5597         16  CF-AH-OVERRIDE-L1              PIC X.
  5598         16  CF-AH-OVERRIDE-L2              PIC XX.
  5599         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5600         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5601
  5602         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5603         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5604
  5605         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5606         16  CF-AR-LAST-EL860-DT            PIC XX.
  5607         16  CF-MP-MONTH-END-DT             PIC XX.
  5608
  5609         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5610         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5611             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5612
  5613         16  CF-AR-MONTH-END-DT             PIC XX.
  5614
  5615         16  CF-CRDTCRD-USER                PIC X.
  5616             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5617             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5618
  5619         16  CF-CC-MONTH-END-DT             PIC XX.
  5620
  5621         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5622
  5623         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5624             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5625             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5626             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5627         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5628         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5629         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 110
* EL689.cbl
  5630         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5631             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5632             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5633         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5634         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5635         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5636             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5637         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5638
  5639         16  CF-CL-ZIP-CODE.
  5640             20  CF-CL-ZIP-PRIME.
  5641                 24  CF-CL-ZIP-1ST          PIC X.
  5642                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5643                 24  FILLER                 PIC X(4).
  5644             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5645         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5646             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5647             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5648             20  FILLER                     PIC XXX.
  5649
  5650         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5651         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5652         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5653         16  CF-CO-OPTION-START-DATE        PIC XX.
  5654         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5655           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5656                                                      '3' '4'.
  5657           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5658           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5659           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5660           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5661           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5662           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5663
  5664         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5665
  5666         16  CF-PAYMENT-APPROVAL-LEVELS.
  5667             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5668             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5669             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5670             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5671             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5672             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5673
  5674         16  CF-END-USER-REPORTING-USER     PIC X.
  5675             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5676             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5677
  5678         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5679             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5680             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5681
  5682         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5683
  5684         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5685         16  FILLER                         PIC X.
  5686
  5687         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 111
* EL689.cbl
  5688             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5689             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5690             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5691
  5692         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5693
  5694         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5695             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5696             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5697
  5698         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5699             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5700             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5701
  5702         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5703
  5704         16  CF-CO-ACH-ID-CODE              PIC  X.
  5705             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5706             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5707             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5708         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5709         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5710         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5711         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5712         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5713         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5714         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5715         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5716         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5717                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5718         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5719                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5720
  5721         16  CF-CO-OVER-SHORT.
  5722             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5723             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5724
  5725*         16  FILLER                         PIC X(102).
  5726         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5727             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5728             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5729
  5730         16  CF-AH-APPROVAL-DAYS.
  5731             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5732             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5733             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5734             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5735
  5736         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5737
  5738         16  CF-APPROV-LEV-5.
  5739             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5740             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5741             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5742
  5743         16  FILLER                         PIC X(68).
  5744****************************************************************
  5745*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 112
* EL689.cbl
  5746****************************************************************
  5747
  5748     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5749         16  CF-PROCESSOR-NAME              PIC X(30).
  5750         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5751         16  CF-PROCESSOR-TITLE             PIC X(26).
  5752         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5753                 88  MESSAGE-YES                VALUE 'Y'.
  5754                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5755
  5756*****************************************************
  5757****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5758****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5759****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5760****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5761*****************************************************
  5762
  5763         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5764             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5765             20  CF-APPLICATION-FORCE       PIC X.
  5766             20  CF-INDIVIDUAL-APP.
  5767                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5768                     28  CF-BROWSE-APP      PIC X.
  5769                     28  CF-UPDATE-APP      PIC X.
  5770
  5771         16  CF-CURRENT-TERM-ON             PIC X(4).
  5772         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5773             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5774             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5775             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5776             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5777             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5778             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5779             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5780         16  CF-PROCESSOR-CARRIER           PIC X.
  5781             88  NO-CARRIER-SECURITY            VALUE ' '.
  5782         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5783             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5784         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5785             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5786         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5787             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5788
  5789         16  CF-PROC-SYS-ACCESS-SW.
  5790             20  CF-PROC-CREDIT-CLAIMS-SW.
  5791                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5792                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5793                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5794                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5795             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5796                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5797                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5798             20  CF-PROC-LIFE-GNRLDGR-SW.
  5799                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5800                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5801                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5802                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5803             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 113
* EL689.cbl
  5804                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5805                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5806         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5807             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5808             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5809         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5810
  5811         16  CF-APPROVAL-LEVEL                  PIC X.
  5812             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5813             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5814             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5815             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5816             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5817
  5818         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5819
  5820         16  CF-LANGUAGE-TYPE                   PIC X.
  5821             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5822             88  CF-LANG-IS-FR                      VALUE 'F'.
  5823
  5824         16  CF-CSR-IND                         PIC X.
  5825         16  FILLER                             PIC X(239).
  5826
  5827****************************************************************
  5828*             PROCESSOR/REMINDERS RECORD                       *
  5829****************************************************************
  5830
  5831     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5832         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5833             20  CF-START-REMIND-DT         PIC XX.
  5834             20  CF-END-REMIND-DT           PIC XX.
  5835             20  CF-REMINDER-TEXT           PIC X(50).
  5836         16  FILLER                         PIC X(296).
  5837
  5838
  5839****************************************************************
  5840*             STATE MASTER RECORD                              *
  5841****************************************************************
  5842
  5843     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5844         16  CF-STATE-ABBREVIATION          PIC XX.
  5845         16  CF-STATE-NAME                  PIC X(25).
  5846         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5847         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5848             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5849             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5850             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5851             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5852                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5853                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5854             20  CF-ST-PREM-REJECT-SW       PIC X.
  5855                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5856                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5857             20  CF-ST-REF-REJECT-SW        PIC X.
  5858                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5859                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5860         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5861         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 114
* EL689.cbl
  5862         16  CF-ST-REFUND-RULES.
  5863             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5864             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5865             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5866         16  CF-ST-FST-PMT-EXTENSION.
  5867             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5868             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5869                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5870                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5871                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5872                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5873         16  CF-ST-STATE-CALL.
  5874             20  CF-ST-CALL-UNEARNED        PIC X.
  5875             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5876             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5877         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5878             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5879             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5880         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5881         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5882         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5883         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5884         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5885         16  FILLER                         PIC X.
  5886         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5887             20  CF-ST-BENEFIT-CD           PIC XX.
  5888             20  CF-ST-BENEFIT-KIND         PIC X.
  5889                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5890                 88  CF-ST-AH-KIND              VALUE 'A'.
  5891             20  CF-ST-REM-TERM-CALC        PIC X.
  5892                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5893                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5894                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5895                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5896                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5897                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5898                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5899                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5900
  5901             20  CF-ST-REFUND-CALC          PIC X.
  5902                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5903                 88  ST-REFD-BY-R78             VALUE '1'.
  5904                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5905                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5906                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5907                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5908                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5909                 88  ST-REFD-UTAH               VALUE '7'.
  5910                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5911                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5912                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5913
  5914             20  CF-ST-EARNING-CALC         PIC X.
  5915                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5916                 88  ST-EARN-BY-R78             VALUE '1'.
  5917                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5918                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5919                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 115
* EL689.cbl
  5920                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5921                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5922                 88  ST-EARN-MEAN               VALUE '8'.
  5923                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5924
  5925             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5926                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5927                 88  ST-OVRD-BY-R78             VALUE '1'.
  5928                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5929                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5930                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5931                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5932                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5933                 88  ST-OVRD-MEAN               VALUE '8'.
  5934                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5935             20  cf-st-extra-periods        pic 9.
  5936*            20  FILLER                     PIC X.
  5937
  5938         16  CF-ST-COMMISSION-CAPS.
  5939             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5940             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5941             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5942             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5943         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5944                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5945
  5946         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5947
  5948         16  CF-ST-STATUTORY-INTEREST.
  5949             20  CF-ST-STAT-DATE-FROM       PIC X.
  5950                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5951                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5952             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5953             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5954             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5955             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5956             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5957
  5958         16  CF-ST-OVER-SHORT.
  5959             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5960             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5961
  5962         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5963
  5964         16  CF-ST-RT-CALC                  PIC X.
  5965
  5966         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5967         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5968         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5969         16  CF-ST-RF-LR-CALC               PIC X.
  5970         16  CF-ST-RF-LL-CALC               PIC X.
  5971         16  CF-ST-RF-LN-CALC               PIC X.
  5972         16  CF-ST-RF-AH-CALC               PIC X.
  5973         16  CF-ST-RF-CP-CALC               PIC X.
  5974*        16  FILLER                         PIC X(206).
  5975*CIDMOD         16  FILLER                         PIC X(192).
  5976         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5977             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 116
* EL689.cbl
  5978         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5979         16  CF-ST-VFY-2ND-BENE             PIC X.
  5980         16  CF-ST-CAUSAL-STATE             PIC X.
  5981         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5982         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5983         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5984             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5985         16  CF-ST-NET-ONLY-STATE           PIC X.
  5986             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5987         16  FILLER                         PIC X(181).
  5988
  5989****************************************************************
  5990*             BENEFIT MASTER RECORD                            *
  5991****************************************************************
  5992
  5993     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5994         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5995             20  CF-BENEFIT-CODE            PIC XX.
  5996             20  CF-BENEFIT-NUMERIC  REDEFINES
  5997                 CF-BENEFIT-CODE            PIC XX.
  5998             20  CF-BENEFIT-ALPHA           PIC XXX.
  5999             20  CF-BENEFIT-DESCRIP         PIC X(10).
  6000             20  CF-BENEFIT-COMMENT         PIC X(10).
  6001
  6002             20  CF-LF-COVERAGE-TYPE        PIC X.
  6003                 88  CF-REDUCING                VALUE 'R'.
  6004                 88  CF-LEVEL                   VALUE 'L' 'P'.
  6005
  6006             20  CF-SPECIAL-CALC-CD         PIC X.
  6007                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  6008                 88  CF-NP-0-MO-INT             VALUE 'A'.
  6009                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  6010                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  6011                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  6012                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  6013                 88  CF-FARM-PLAN               VALUE 'F'.
  6014                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  6015                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  6016                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  6017                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  6018                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  6019                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  6020                 88  CF-PRUDENTIAL              VALUE 'P'.
  6021                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  6022                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  6023                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  6024                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  6025                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  6026                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  6027
  6028             20  CF-JOINT-INDICATOR         PIC X.
  6029                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  6030
  6031*            20  FILLER                     PIC X(12).
  6032             20  cf-maximum-benefits        pic s999 comp-3.
  6033             20  FILLER                     PIC X(09).
  6034             20  CF-BENEFIT-CATEGORY        PIC X.
  6035             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 117
* EL689.cbl
  6036
  6037             20  CF-CO-REM-TERM-CALC        PIC X.
  6038                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  6039                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  6040                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  6041                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  6042                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  6043
  6044             20  CF-CO-EARNINGS-CALC        PIC X.
  6045                 88  CO-EARN-BY-R78             VALUE '1'.
  6046                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  6047                 88  CO-EARN-AS-CALIF           VALUE '3'.
  6048                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  6049                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  6050                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  6051                 88  CO-EARN-AS-MEAN            VALUE '8'.
  6052                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  6053
  6054             20  CF-CO-REFUND-CALC          PIC X.
  6055                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  6056                 88  CO-REFD-BY-R78             VALUE '1'.
  6057                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  6058                 88  CO-REFD-AS-CALIF           VALUE '3'.
  6059                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  6060                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  6061                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  6062                 88  CO-REFD-MEAN               VALUE '8'.
  6063                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  6064                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  6065                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  6066
  6067             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  6068                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  6069                 88  CO-OVRD-BY-R78             VALUE '1'.
  6070                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  6071                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  6072                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  6073                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  6074                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  6075                 88  CO-OVRD-MEAN               VALUE '8'.
  6076                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  6077
  6078             20  CF-CO-BEN-I-G-CD           PIC X.
  6079                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  6080                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  6081                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  6082
  6083         16  FILLER                         PIC X(304).
  6084
  6085
  6086****************************************************************
  6087*             CARRIER MASTER RECORD                            *
  6088****************************************************************
  6089
  6090     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6091         16  CF-ADDRESS-DATA.
  6092             20  CF-MAIL-TO-NAME            PIC X(30).
  6093             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 118
* EL689.cbl
  6094             20  CF-ADDRESS-LINE-1          PIC X(30).
  6095             20  CF-ADDRESS-LINE-2          PIC X(30).
  6096             20  CF-CITY-STATE              PIC X(30).
  6097             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  6098             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  6099
  6100         16  CF-CLAIM-NO-CONTROL.
  6101             20  CF-CLAIM-NO-METHOD         PIC X.
  6102                 88  CLAIM-NO-MANUAL            VALUE '1'.
  6103                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  6104                 88  CLAIM-NO-SEQ               VALUE '3'.
  6105                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  6106             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  6107                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  6108                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  6109                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  6110
  6111         16  CF-CHECK-NO-CONTROL.
  6112             20  CF-CHECK-NO-METHOD         PIC X.
  6113                 88  CHECK-NO-MANUAL            VALUE '1'.
  6114                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6115                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6116                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6117             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6118                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6119
  6120         16  CF-DOMICILE-STATE              PIC XX.
  6121
  6122         16  CF-EXPENSE-CONTROLS.
  6123             20  CF-EXPENSE-METHOD          PIC X.
  6124                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6125                 88  DOLLARS-PER-PMT            VALUE '2'.
  6126                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6127                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6128             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6129             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6130
  6131         16  CF-CORRESPONDENCE-CONTROL.
  6132             20  CF-LETTER-RESEND-OPT       PIC X.
  6133                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6134                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6135             20  FILLER                     PIC X(4).
  6136
  6137         16  CF-RESERVE-CONTROLS.
  6138             20  CF-MANUAL-SW               PIC X.
  6139                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6140             20  CF-FUTURE-SW               PIC X.
  6141                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6142             20  CF-PTC-SW                  PIC X.
  6143                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6144             20  CF-IBNR-SW                 PIC X.
  6145                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6146             20  CF-PTC-LF-SW               PIC X.
  6147                 88  CF-LF-PTC-USED             VALUE '1'.
  6148             20  CF-CDT-ACCESS-METHOD       PIC X.
  6149                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6150                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6151                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 119
* EL689.cbl
  6152             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6153
  6154         16  CF-CLAIM-CALC-METHOD           PIC X.
  6155             88  360-PLUS-MONTHS                VALUE '1'.
  6156             88  365-PLUS-MONTHS                VALUE '2'.
  6157             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6158             88  360-DAILY                      VALUE '4'.
  6159             88  365-DAILY                      VALUE '5'.
  6160
  6161         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6162         16  FILLER                         PIC X(11).
  6163
  6164         16  CF-LIMIT-AMOUNTS.
  6165             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6166             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6167             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6168             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6169             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6170             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6171             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6172             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6173             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6174             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6175
  6176         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6177         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6178         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6179
  6180         16  CF-ZIP-CODE.
  6181             20  CF-ZIP-PRIME.
  6182                 24  CF-ZIP-1ST             PIC X.
  6183                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6184                 24  FILLER                 PIC X(4).
  6185             20  CF-ZIP-PLUS4               PIC X(4).
  6186         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6187             20  CF-CAN-POSTAL-1            PIC XXX.
  6188             20  CF-CAN-POSTAL-2            PIC XXX.
  6189             20  FILLER                     PIC XXX.
  6190
  6191         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6192         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6193         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6194
  6195         16  CF-RATING-SWITCH               PIC X.
  6196             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6197             88  CF-NO-RATING                   VALUE 'N'.
  6198
  6199         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6200
  6201         16  CF-CARRIER-OVER-SHORT.
  6202             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6203             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6204
  6205         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6206         16  CF-SECPAY-SWITCH               PIC X.
  6207             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6208             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6209         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 120
* EL689.cbl
  6210         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6211         16  FILLER                         PIC X(444).
  6212*        16  FILLER                         PIC X(452).
  6213
  6214
  6215****************************************************************
  6216*             MORTALITY MASTER RECORD                          *
  6217****************************************************************
  6218
  6219     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6220         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6221                                INDEXED BY CF-MORT-NDX.
  6222             20  CF-MORT-TABLE              PIC X(5).
  6223             20  CF-MORT-TABLE-TYPE         PIC X.
  6224                 88  CF-MORT-JOINT              VALUE 'J'.
  6225                 88  CF-MORT-SINGLE             VALUE 'S'.
  6226                 88  CF-MORT-COMBINED           VALUE 'C'.
  6227                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6228                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6229             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6230             20  CF-MORT-AGE-METHOD         PIC XX.
  6231                 88  CF-AGE-LAST                VALUE 'AL'.
  6232                 88  CF-AGE-NEAR                VALUE 'AN'.
  6233             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6234             20  CF-MORT-ADJUSTMENT-DIRECTION
  6235                                            PIC X.
  6236                 88  CF-MINUS                   VALUE '-'.
  6237                 88  CF-PLUS                    VALUE '+'.
  6238             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6239             20  CF-MORT-JOINT-CODE         PIC X.
  6240                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6241             20  CF-MORT-PC-Q               PIC X.
  6242                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6243             20  CF-MORT-TABLE-CODE         PIC X(4).
  6244             20  CF-MORT-COMMENTS           PIC X(15).
  6245             20  FILLER                     PIC X(14).
  6246
  6247         16  FILLER                         PIC X(251).
  6248
  6249
  6250****************************************************************
  6251*             BUSSINESS TYPE MASTER RECORD                     *
  6252****************************************************************
  6253
  6254     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6255* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6256* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6257* AND RECORD 05 IS TYPES 81-99
  6258         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6259             20  CF-BUSINESS-TITLE          PIC  X(19).
  6260             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6261                                            PIC S9V9(4) COMP-3.
  6262             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6263             20  FILLER                     PIC  X.
  6264         16  FILLER                         PIC  X(248).
  6265
  6266
  6267****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 121
* EL689.cbl
  6268*             TERMINAL MASTER RECORD                           *
  6269****************************************************************
  6270
  6271     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6272
  6273         16  CF-COMPANY-TERMINALS.
  6274             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6275                                  PIC X(4).
  6276         16  FILLER               PIC X(248).
  6277
  6278
  6279****************************************************************
  6280*             LIFE EDIT MASTER RECORD                          *
  6281****************************************************************
  6282
  6283     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6284         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6285             20  CF-LIFE-CODE-IN            PIC XX.
  6286             20  CF-LIFE-CODE-OUT           PIC XX.
  6287         16  FILLER                         PIC X(248).
  6288
  6289
  6290****************************************************************
  6291*             AH EDIT MASTER RECORD                            *
  6292****************************************************************
  6293
  6294     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6295         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6296             20  CF-AH-CODE-IN              PIC XXX.
  6297             20  CF-AH-CODE-OUT             PIC XX.
  6298         16  FILLER                         PIC X(248).
  6299
  6300
  6301****************************************************************
  6302*             CREDIBILITY TABLES                               *
  6303****************************************************************
  6304
  6305     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6306         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6307                             INDEXED BY CF-CRDB-NDX.
  6308             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6309             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6310             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6311         16  FILLER                         PIC  X(332).
  6312
  6313
  6314****************************************************************
  6315*             REPORT CUSTOMIZATION RECORD                      *
  6316****************************************************************
  6317
  6318     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6319         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6320             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6321             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6322             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6323**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6324****       A T-TRANSFER.                                   ****
  6325             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 122
* EL689.cbl
  6326
  6327         16  FILLER                         PIC XX.
  6328
  6329         16  CF-CARRIER-CNTL-OPT.
  6330             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6331                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6332                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6333             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6334                                            PIC X.
  6335         16  CF-GROUP-CNTL-OPT.
  6336             20  CF-GROUP-OPT-SEQ           PIC 9.
  6337                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6338                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6339             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6340                                            PIC X(6).
  6341         16  CF-STATE-CNTL-OPT.
  6342             20  CF-STATE-OPT-SEQ           PIC 9.
  6343                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6344                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6345             20  CF-STATE-SELECT OCCURS 3 TIMES
  6346                                            PIC XX.
  6347         16  CF-ACCOUNT-CNTL-OPT.
  6348             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6349                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6350                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6351             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6352                                            PIC X(10).
  6353         16  CF-BUS-TYP-CNTL-OPT.
  6354             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6355                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6356                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6357             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6358                                            PIC XX.
  6359         16  CF-LF-TYP-CNTL-OPT.
  6360             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6361                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6362                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6363             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6364                                            PIC XX.
  6365         16  CF-AH-TYP-CNTL-OPT.
  6366             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6367                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6368                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6369             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6370                                            PIC XX.
  6371         16  CF-REPTCD1-CNTL-OPT.
  6372             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6373                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6374                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6375             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6376                                            PIC X(10).
  6377         16  CF-REPTCD2-CNTL-OPT.
  6378             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6379                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6380                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6381             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6382                                            PIC X(10).
  6383         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 123
* EL689.cbl
  6384             20  CF-USER1-OPT-SEQ           PIC 9.
  6385                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6386                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6387             20  CF-USER1-SELECT OCCURS 3 TIMES
  6388                                            PIC X(10).
  6389         16  CF-USER2-CNTL-OPT.
  6390             20  CF-USER2-OPT-SEQ           PIC 9.
  6391                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6392                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6393             20  CF-USER2-SELECT OCCURS 3 TIMES
  6394                                            PIC X(10).
  6395         16  CF-USER3-CNTL-OPT.
  6396             20  CF-USER3-OPT-SEQ           PIC 9.
  6397                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6398                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6399             20  CF-USER3-SELECT OCCURS 3 TIMES
  6400                                            PIC X(10).
  6401         16  CF-USER4-CNTL-OPT.
  6402             20  CF-USER4-OPT-SEQ           PIC 9.
  6403                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6404                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6405             20  CF-USER4-SELECT OCCURS 3 TIMES
  6406                                            PIC X(10).
  6407         16  CF-USER5-CNTL-OPT.
  6408             20  CF-USER5-OPT-SEQ           PIC 9.
  6409                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6410                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6411             20  CF-USER5-SELECT OCCURS 3 TIMES
  6412                                            PIC X(10).
  6413         16  CF-REINS-CNTL-OPT.
  6414             20  CF-REINS-OPT-SEQ           PIC 9.
  6415                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6416                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6417             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6418                 24  CF-REINS-PRIME         PIC XXX.
  6419                 24  CF-REINS-SUB           PIC XXX.
  6420
  6421         16  CF-AGENT-CNTL-OPT.
  6422             20  CF-AGENT-OPT-SEQ           PIC 9.
  6423                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6424                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6425             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6426                                            PIC X(10).
  6427
  6428         16  FILLER                         PIC X(43).
  6429
  6430         16  CF-LOSS-RATIO-SELECT.
  6431             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6432             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6433         16  CF-ENTRY-DATE-SELECT.
  6434             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6435             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6436         16  CF-EFFECTIVE-DATE-SELECT.
  6437             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6438             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6439
  6440         16  CF-EXCEPTION-LIST-IND          PIC X.
  6441             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 124
* EL689.cbl
  6442
  6443         16  FILLER                         PIC X(318).
  6444
  6445****************************************************************
  6446*                  EXCEPTION REPORTING RECORD                  *
  6447****************************************************************
  6448
  6449     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6450         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6451             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6452
  6453         16  CF-COMBINED-LIFE-AH-OPT.
  6454             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6455             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6456             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6457             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6458
  6459         16  CF-LIFE-OPT.
  6460             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6461             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6462             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6463             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6464             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6465             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6466             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6467             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6468             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6469             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6470
  6471         16  CF-AH-OPT.
  6472             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6473             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6474             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6475             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6476             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6477             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6478             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6479             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6480             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6481             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6482
  6483         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6484             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6485             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6486             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6487
  6488         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6489
  6490         16  FILLER                         PIC X(673).
  6491
  6492
  6493****************************************************************
  6494*             MORTGAGE SYSTEM PLAN RECORD                      *
  6495****************************************************************
  6496
  6497     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6498         16  CF-PLAN-TYPE                   PIC X.
  6499             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 125
* EL689.cbl
  6500             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6501             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6502         16  CF-PLAN-ABBREV                 PIC XXX.
  6503         16  CF-PLAN-DESCRIPT               PIC X(10).
  6504         16  CF-PLAN-NOTES                  PIC X(20).
  6505         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6506         16  CF-PLAN-UNDERWRITING.
  6507             20  CF-PLAN-TERM-DATA.
  6508                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6509                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6510             20  CF-PLAN-AGE-DATA.
  6511                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6512                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6513                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6514             20  CF-PLAN-BENEFIT-DATA.
  6515                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6516                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6517                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6518                                            PIC S9(7)V99  COMP-3.
  6519         16  CF-PLAN-POLICY-FORMS.
  6520             20  CF-POLICY-FORM             PIC X(12).
  6521             20  CF-MASTER-APPLICATION      PIC X(12).
  6522             20  CF-MASTER-POLICY           PIC X(12).
  6523         16  CF-PLAN-RATING.
  6524             20  CF-RATE-CODE               PIC X(5).
  6525             20  CF-SEX-RATING              PIC X.
  6526                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6527                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6528             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6529             20  CF-SUB-STD-TYPE            PIC X.
  6530                 88  CF-PCT-OF-PREM            VALUE '1'.
  6531                 88  CF-PCT-OF-BENE            VALUE '2'.
  6532         16  CF-PLAN-PREM-TOLERANCES.
  6533             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6534             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6535         16  CF-PLAN-PYMT-TOLERANCES.
  6536             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6537             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6538         16  CF-PLAN-MISC-DATA.
  6539             20  FILLER                     PIC X.
  6540             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6541             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6542         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6543         16  CF-PLAN-IND-GRP                PIC X.
  6544             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6545                                                     '1'.
  6546             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6547                                                     '2'.
  6548         16  CF-MIB-SEARCH-SW               PIC X.
  6549             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6550             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6551             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6552             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6553         16  CF-ALPHA-SEARCH-SW             PIC X.
  6554             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6555             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6556             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6557             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 126
* EL689.cbl
  6558             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6559             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6560             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6561             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6562             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6563             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6564                                                     'A' 'B' 'C'
  6565                                                     'X' 'Y' 'Z'.
  6566         16  CF-EFF-DT-RULE-SW              PIC X.
  6567             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6568             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6569             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6570             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6571             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6572         16  FILLER                         PIC X(4).
  6573         16  CF-HEALTH-QUESTIONS            PIC X.
  6574             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6575         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6576         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6577         16  CF-PLAN-SNGL-JNT               PIC X.
  6578             88  CF-COMBINED-PLAN              VALUE 'C'.
  6579             88  CF-JNT-PLAN                   VALUE 'J'.
  6580             88  CF-SNGL-PLAN                  VALUE 'S'.
  6581         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6582         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6583         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6584         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6585         16  CF-RERATE-CNTL                 PIC  X.
  6586             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6587             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6588             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6589             88  CF-AUTO-RECALC                 VALUE '4'.
  6590         16  CF-BENEFIT-TYPE                PIC  X.
  6591             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6592             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6593         16  CF-POLICY-FEE                  PIC S999V99
  6594                                                    COMP-3.
  6595         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6596         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6597         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6598         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6599         16  FILLER                         PIC  X(32).
  6600         16  CF-TERMINATION-FORM            PIC  X(04).
  6601         16  FILLER                         PIC  X(08).
  6602         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6603                                                       COMP-3.
  6604         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6605         16  CF-ISSUE-LETTER                PIC  X(4).
  6606         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6607         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6608             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6609             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6610         16  CF-MP-REFUND-CALC              PIC X.
  6611             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6612             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6613             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6614             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6615             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 127
* EL689.cbl
  6616             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6617             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6618             88  CF-MP-REFD-MEAN                VALUE '8'.
  6619         16  CF-ALT-RATE-CODE               PIC  X(5).
  6620
  6621
  6622         16  FILLER                         PIC X(498).
  6623****************************************************************
  6624*             MORTGAGE COMPANY MASTER RECORD                   *
  6625****************************************************************
  6626
  6627     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6628         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6629         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6630             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6631             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6632             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6633             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6634             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6635
  6636         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6637         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6638         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6639         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6640         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6641
  6642         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6643             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6644         16  CF-MP-RECON-USE-IND            PIC X(1).
  6645             88  CF-MP-USE-RECON             VALUE 'Y'.
  6646         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6647             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6648         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6649             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6650             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6651         16  FILLER                         PIC X(1).
  6652         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6653             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6654         16  CF-MORTG-MIB-VERSION           PIC X.
  6655             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6656             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6657             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6658         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6659             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6660                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6661             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6662                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6663             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6664                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6665             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6666                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6667             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6668                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6669             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6670                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6671         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6672         16  FILLER                         PIC X(7).
  6673         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 128
* EL689.cbl
  6674             20  CF-MORTG-MIB-COMM          PIC X(5).
  6675             20  CF-MORTG-MIB-TERM          PIC X(5).
  6676         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6677             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6678         16  FILLER                         PIC X(03).
  6679         16  CF-MP-CHECK-NO-CONTROL.
  6680             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6681                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6682                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6683                                                ' ' LOW-VALUES.
  6684                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6685                                               VALUE '3'.
  6686         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6687         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6688         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6689             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6690                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6691             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6692                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6693             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6694                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6695             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6696                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6697             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6698                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6699             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6700                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6701         16  CF-MORTG-BILLING-AREA.
  6702             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6703                                            PIC X.
  6704         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6705         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6706         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6707         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6708             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6709             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6710         16  FILLER                         PIC X.
  6711         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6712             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6713             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6714         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6715         16  FILLER                         PIC X(8).
  6716         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6717         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6718         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6719         16  CF-ACH-COMPANY-ID.
  6720             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6721                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6722                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6723                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6724             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6725         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6726             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6727         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6728             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6729             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6730         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6731         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 129
* EL689.cbl
  6732         16  FILLER                         PIC X(536).
  6733
  6734****************************************************************
  6735*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6736****************************************************************
  6737
  6738     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6739         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6740             20  CF-FEMALE-HEIGHT.
  6741                 24  CF-FEMALE-FT           PIC 99.
  6742                 24  CF-FEMALE-IN           PIC 99.
  6743             20  CF-FEMALE-MIN-WT           PIC 999.
  6744             20  CF-FEMALE-MAX-WT           PIC 999.
  6745         16  FILLER                         PIC X(428).
  6746
  6747     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6748         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6749             20  CF-MALE-HEIGHT.
  6750                 24  CF-MALE-FT             PIC 99.
  6751                 24  CF-MALE-IN             PIC 99.
  6752             20  CF-MALE-MIN-WT             PIC 999.
  6753             20  CF-MALE-MAX-WT             PIC 999.
  6754         16  FILLER                         PIC X(428).
  6755******************************************************************
  6756*             AUTOMATIC ACTIVITY RECORD                          *
  6757******************************************************************
  6758     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6759         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6760             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6761             20  CF-SYS-LETTER-ID           PIC X(04).
  6762             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6763             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6764             20  CF-SYS-RESET-SW            PIC X(01).
  6765             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6766             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6767
  6768         16  FILLER                         PIC X(50).
  6769
  6770         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6771             20  CF-USER-ACTIVE-SW          PIC X(01).
  6772             20  CF-USER-LETTER-ID          PIC X(04).
  6773             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6774             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6775             20  CF-USER-RESET-SW           PIC X(01).
  6776             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6777             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6778             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6779
  6780         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 130
* EL689.cbl
  6782*    COPY ERCCOMP.
  6783******************************************************************
  6784*                                                                *
  6785*                                                                *
  6786*                            ERCCOMP                             *
  6787*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6788*                            VMOD=2.019                          *
  6789*                                                                *
  6790*   ONLINE CREDIT SYSTEM                                         *
  6791*                                                                *
  6792*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6793*                                                                *
  6794*   FILE TYPE = VSAM,KSDS                                        *
  6795*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6796*                                                                *
  6797*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6798*       ALTERNATE PATH = NONE                                    *
  6799*                                                                *
  6800*   LOG = NO                                                     *
  6801*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6802*                                                                *
  6803******************************************************************
  6804*                   C H A N G E   L O G
  6805*
  6806* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6807*-----------------------------------------------------------------
  6808*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6809* EFFECTIVE    NUMBER
  6810*-----------------------------------------------------------------
  6811* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6812* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6813* 092205    2005050300006  PEMA  ADD LEASE FEE
  6814* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6815* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6816* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6817* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6818* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6819* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  6820******************************************************************
  6821
  6822 01  COMPENSATION-MASTER.
  6823     12  CO-RECORD-ID                          PIC XX.
  6824         88  VALID-CO-ID                          VALUE 'CO'.
  6825
  6826     12  CO-CONTROL-PRIMARY.
  6827         16  CO-COMPANY-CD                     PIC X.
  6828         16  CO-CONTROL.
  6829             20  CO-CTL-1.
  6830                 24  CO-CARR-GROUP.
  6831                     28  CO-CARRIER            PIC X.
  6832                     28  CO-GROUPING.
  6833                         32  CO-GROUP-PREFIX   PIC XXX.
  6834                         32  CO-GROUP-PRIME    PIC XXX.
  6835                 24  CO-RESP-NO.
  6836                     28  CO-RESP-PREFIX        PIC X(4).
  6837                     28  CO-RESP-PRIME         PIC X(6).
  6838             20  CO-CTL-2.
  6839                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 131
* EL689.cbl
  6840                     28  CO-ACCT-PREFIX        PIC X(4).
  6841                     28  CO-ACCT-PRIME         PIC X(6).
  6842         16  CO-TYPE                           PIC X.
  6843             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6844             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6845             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6846
  6847     12  CO-MAINT-INFORMATION.
  6848         16  CO-LAST-MAINT-DT                  PIC XX.
  6849         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6850         16  CO-LAST-MAINT-USER                PIC X(4).
  6851     12  FILLER                                PIC XX.
  6852     12  CO-STMT-TYPE                          PIC XXX.
  6853     12  CO-COMP-TYPE                          PIC X.
  6854         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6855     12  CO-STMT-OWNER                         PIC X(4).
  6856     12  CO-BALANCE-CONTROL                    PIC X.
  6857         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6858         88  CO-NO-BALANCE                        VALUE 'N'.
  6859
  6860     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6861         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6862         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6863         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6864
  6865     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6866         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6867         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6868
  6869     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6870     12  CO-GA-DIRECT-DEP                      PIC X.
  6871     12  CO-FUTURE-SPACE                       PIC X.
  6872         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6873
  6874     12  CO-ACCT-NAME                          PIC X(30).
  6875     12  CO-MAIL-NAME                          PIC X(30).
  6876     12  CO-ADDR-1                             PIC X(30).
  6877     12  CO-ADDR-2                             PIC X(30).
  6878     12  CO-ADDR-3.
  6879         16  CO-ADDR-CITY                      PIC X(27).
  6880         16  CO-ADDR-STATE                     PIC XX.
  6881     12  CO-CSO-1099                           PIC X.
  6882     12  CO-ZIP.
  6883         16  CO-ZIP-PRIME.
  6884             20  CO-ZIP-PRI-1ST                PIC X.
  6885                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6886             20  FILLER                        PIC X(4).
  6887         16  CO-ZIP-PLUS4                      PIC X(4).
  6888     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6889         16  CO-CAN-POSTAL-1                   PIC XXX.
  6890         16  CO-CAN-POSTAL-2                   PIC XXX.
  6891         16  FILLER                            PIC XXX.
  6892     12  CO-SOC-SEC                            PIC X(13).
  6893     12  CO-TELEPHONE.
  6894         16  CO-AREA-CODE                      PIC XXX.
  6895         16  CO-PREFIX                         PIC XXX.
  6896         16  CO-PHONE                          PIC X(4).
  6897
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 132
* EL689.cbl
  6898     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  6899
  6900     12  CO-AR-BAL-LEVEL                       PIC X.
  6901         88  CO-AR-REF-LVL                        VALUE '1'.
  6902         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6903         88  CO-AR-BILL-LVL                       VALUE '2'.
  6904         88  CO-AR-AGT-LVL                        VALUE '3'.
  6905         88  CO-AR-FR-LVL                         VALUE '4'.
  6906
  6907     12  CO-AR-NORMAL-PRINT                    PIC X.
  6908         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6909         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6910
  6911     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6912
  6913     12  CO-AR-REPORTING                       PIC X.
  6914         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6915         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6916
  6917     12  CO-AR-PULL-CHECK                      PIC X.
  6918         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6919         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6920
  6921     12  CO-AR-BALANCE-PRINT                   PIC X.
  6922         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6923
  6924     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6925         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6926         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6927         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6928
  6929     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6930
  6931     12  CO-USER-CODE                          PIC X.
  6932     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6933
  6934******************************************************************
  6935*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6936*    THE LAST MONTH END RUN.
  6937******************************************************************
  6938
  6939     12  CO-LAST-ACTIVITY-DATE.
  6940         16  CO-ACT-YEAR                       PIC 99.
  6941         16  CO-ACT-MONTH                      PIC 99.
  6942         16  CO-ACT-DAY                        PIC 99.
  6943
  6944     12  CO-LAST-STMT-DT.
  6945         16  CO-LAST-STMT-YEAR                 PIC 99.
  6946         16  CO-LAST-STMT-MONTH                PIC 99.
  6947         16  CO-LAST-STMT-DAY                  PIC 99.
  6948
  6949     12  CO-MO-END-TOTALS.
  6950         16  CO-MONTHLY-TOTALS.
  6951             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6952             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6953             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6954             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6955             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 133
* EL689.cbl
  6956
  6957         16  CO-AGING-TOTALS.
  6958             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6959             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6960             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6961             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6962
  6963         16  CO-YTD-TOTALS.
  6964             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6965             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6966
  6967         16  CO-OVER-UNDER-TOTALS.
  6968             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6969             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6970
  6971     12  CO-MISCELLANEOUS-TOTALS.
  6972         16  CO-FICA-TOTALS.
  6973             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6974             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6975
  6976         16  CO-CLAIM-TOTALS.
  6977             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6978             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6979
  6980******************************************************************
  6981*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6982*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6983******************************************************************
  6984
  6985     12  CO-CURRENT-TOTALS.
  6986         16  CO-CURRENT-LAST-STMT-DT.
  6987             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6988             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6989             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6990
  6991         16  CO-CURRENT-MONTHLY-TOTALS.
  6992             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6993             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6994             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6995             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6996             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6997
  6998         16  CO-CURRENT-AGING-TOTALS.
  6999             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7000             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7001             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7002             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7003
  7004         16  CO-CURRENT-YTD-TOTALS.
  7005             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7006             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7007
  7008     12  CO-PAID-COMM-TOTALS.
  7009         16  CO-YTD-PAID-COMMS.
  7010             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7011             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7012
  7013     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 134
* EL689.cbl
  7014         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7015         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7016
  7017     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7018         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7019         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7020         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7021         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7022         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7023         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7024         88  CO-FINAL-LETTER                  VALUE 'F'.
  7025         88  CO-RECONCILING                   VALUE 'R'.
  7026         88  CO-PHONE-CALL                    VALUE 'P'.
  7027         88  CO-LEGAL                         VALUE 'L'.
  7028         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7029         88  CO-WRITE-OFF                     VALUE 'W'.
  7030         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7031
  7032     12  CO-CSR-CODE                       PIC X(4).
  7033
  7034     12  CO-GA-STATUS-INFO.
  7035         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7036         16  CO-GA-TERMINATION-DT          PIC XX.
  7037         16  CO-GA-STATUS-CODE             PIC X.
  7038             88  CO-GA-ACTIVE                 VALUE 'A'.
  7039             88  CO-GA-INACTIVE               VALUE 'I'.
  7040             88  CO-GA-PENDING                VALUE 'P'.
  7041         16  CO-GA-COMMENTS.
  7042             20  CO-GA-COMMENT-1           PIC X(40).
  7043             20  CO-GA-COMMENT-2           PIC X(40).
  7044             20  CO-GA-COMMENT-3           PIC X(40).
  7045             20  CO-GA-COMMENT-4           PIC X(40).
  7046
  7047     12  CO-RPTCD2                         PIC X(10).
  7048     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7049         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7050         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7051
  7052     12  CO-TYPE-AGENT                     PIC X(01).
  7053         88  CO-CORPORATION                   VALUE 'C'.
  7054         88  CO-PARTNERSHIP                   VALUE 'P'.
  7055         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7056         88  CO-TRUST                         VALUE 'T'.
  7057         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7058
  7059     12  CO-FAXNO.
  7060         16  CO-FAX-AREA-CODE                  PIC XXX.
  7061         16  CO-FAX-PREFIX                     PIC XXX.
  7062         16  CO-FAX-PHONE                      PIC X(4).
  7063
  7064     12  CO-BANK-INFORMATION.
  7065         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7066         16  CO-BANK-TRANSIT-NON REDEFINES
  7067             CO-BANK-TRANSIT-NO                PIC 9(8).
  7068
  7069         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7070     12  CO-MISC-DEDUCT-INFO REDEFINES
  7071                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 135
* EL689.cbl
  7072         16  CO-MD-GL-ACCT                     PIC X(10).
  7073         16  CO-MD-DIV                         PIC XX.
  7074         16  CO-MD-CENTER                      PIC X(4).
  7075         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7076         16  CO-CREATE-AP-CHECK                PIC X.
  7077         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7078         16  FILLER                            PIC XXX.
  7079     12  CO-ACH-STATUS                         PIC X.
  7080         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7081         88  CO-ACH-PENDING                        VALUE 'P'.
  7082
  7083     12  CO-BILL-SW                            PIC X.
  7084     12  CO-CONTROL-NAME                       PIC X(30).
  7085     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7086     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7087     12  CO-CLP-STATE                          PIC XX.
  7088     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7089     12  CO-SPP-REFUND-EDIT                    PIC X.
  7090
  7091******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 136
* EL689.cbl
  7093*    COPY ERCMAIL.
  7094******************************************************************
  7095*                                                                *
  7096*                                                                *
  7097*                            ERCMAIL                             *
  7098*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7099*                            VMOD=2.003                          *
  7100*                                                                *
  7101*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7102*                                                                *
  7103*   FILE TYPE = VSAM,KSDS                                        *
  7104*   RECORD SIZE = 374   RECFORM = FIX                            *
  7105*                                                                *
  7106*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7107*   ALTERNATE PATH    = NOT USED                                 *
  7108*                                                                *
  7109*   LOG = YES                                                    *
  7110*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7111******************************************************************
  7112*                   C H A N G E   L O G
  7113*
  7114* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7115*-----------------------------------------------------------------
  7116*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7117* EFFECTIVE    NUMBER
  7118*-----------------------------------------------------------------
  7119* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7120* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7121* 111108                   PEMA  ADD CRED BENE ADDR2
  7122******************************************************************
  7123
  7124 01  MAILING-DATA.
  7125     12  MA-RECORD-ID                      PIC XX.
  7126         88  VALID-MA-ID                       VALUE 'MA'.
  7127
  7128     12  MA-CONTROL-PRIMARY.
  7129         16  MA-COMPANY-CD                 PIC X.
  7130         16  MA-CARRIER                    PIC X.
  7131         16  MA-GROUPING.
  7132             20  MA-GROUPING-PREFIX        PIC XXX.
  7133             20  MA-GROUPING-PRIME         PIC XXX.
  7134         16  MA-STATE                      PIC XX.
  7135         16  MA-ACCOUNT.
  7136             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7137             20  MA-ACCOUNT-PRIME          PIC X(6).
  7138         16  MA-CERT-EFF-DT                PIC XX.
  7139         16  MA-CERT-NO.
  7140             20  MA-CERT-PRIME             PIC X(10).
  7141             20  MA-CERT-SFX               PIC X.
  7142
  7143     12  FILLER                            PIC XX.
  7144
  7145     12  MA-ACCESS-CONTROL.
  7146         16  MA-SOURCE-SYSTEM              PIC XX.
  7147             88  MA-FROM-CREDIT                VALUE 'CR'.
  7148             88  MA-FROM-VSI                   VALUE 'VS'.
  7149             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7150             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 137
* EL689.cbl
  7151         16  MA-RECORD-ADD-DT              PIC XX.
  7152         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7153         16  MA-LAST-MAINT-DT              PIC XX.
  7154         16  MA-LAST-MAINT-BY              PIC XXXX.
  7155         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7156
  7157     12  MA-PROFILE-INFO.
  7158         16  MA-QUALIFY-CODE-1             PIC XX.
  7159         16  MA-QUALIFY-CODE-2             PIC XX.
  7160         16  MA-QUALIFY-CODE-3             PIC XX.
  7161         16  MA-QUALIFY-CODE-4             PIC XX.
  7162         16  MA-QUALIFY-CODE-5             PIC XX.
  7163
  7164         16  MA-INSURED-LAST-NAME          PIC X(15).
  7165         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7166         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7167         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7168         16  MA-INSURED-BIRTH-DT           PIC XX.
  7169         16  MA-INSURED-SEX                PIC X.
  7170             88  MA-SEX-MALE                   VALUE 'M'.
  7171             88  MA-SEX-FEMALE                 VALUE 'F'.
  7172         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7173
  7174         16  MA-ADDRESS-CORRECTED          PIC X.
  7175         16  MA-JOINT-BIRTH-DT             PIC XX.
  7176*        16  FILLER                        PIC X(12).
  7177
  7178         16  MA-ADDRESS-LINE-1             PIC X(30).
  7179         16  MA-ADDRESS-LINE-2             PIC X(30).
  7180         16  MA-CITY-STATE.
  7181             20  MA-CITY                   PIC X(28).
  7182             20  MA-ADDR-STATE             PIC XX.
  7183         16  MA-ZIP.
  7184             20  MA-ZIP-CODE.
  7185                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7186                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7187                 24  FILLER                PIC X(4).
  7188             20  MA-ZIP-PLUS4              PIC X(4).
  7189         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7190             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7191             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7192             20  FILLER                    PIC X(3).
  7193
  7194         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7195
  7196         16  FILLER                        PIC XXX.
  7197*        16  FILLER                        PIC X(10).
  7198
  7199     12  MA-CRED-BENE-INFO.
  7200         16  MA-CRED-BENE-NAME                 PIC X(25).
  7201         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7202         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7203         16  MA-CRED-BENE-CTYST.
  7204             20  MA-CRED-BENE-CITY             PIC X(28).
  7205             20  MA-CRED-BENE-STATE            PIC XX.
  7206         16  MA-CRED-BENE-ZIP.
  7207             20  MA-CB-ZIP-CODE.
  7208                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 138
* EL689.cbl
  7209                     88  MA-CB-CANADIAN-POST-CODE
  7210                                           VALUE 'A' THRU 'Z'.
  7211                 24  FILLER                    PIC X(4).
  7212             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7213         16  MA-CB-CANADIAN-POSTAL-CODE
  7214                            REDEFINES MA-CRED-BENE-ZIP.
  7215             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7216             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7217             20  FILLER                        PIC X(3).
  7218     12  MA-POST-CARD-MAIL-DATA.
  7219         16  MA-MAIL-DATA OCCURS 7.
  7220             20  MA-MAIL-TYPE              PIC X.
  7221                 88  MA-12MO-MAILING           VALUE '1'.
  7222                 88  MA-EXP-MAILING            VALUE '2'.
  7223             20  MA-MAIL-STATUS            PIC X.
  7224                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7225                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7226                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7227             20  MA-MAIL-DATE              PIC XX.
  7228     12  FILLER                            PIC XX.
  7229     12  FILLER                            PIC XX.
  7230*    12  FILLER                            PIC X(30).
  7231******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 139
* EL689.cbl
  7233*    COPY ERCPNDB.
  7234******************************************************************
  7235*                                                                *
  7236*                                                                *
  7237*                            ERCPNDB.                            *
  7238*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7239*                            VMOD=2.025                          *
  7240*                                                                *
  7241*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  7242*                                                                *
  7243******************************************************************
  7244*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  7245*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  7246******************************************************************
  7247*                                                                *
  7248*                                                                *
  7249*   FILE TYPE = VSAM,KSDS                                        *
  7250*   RECORD SIZE = 585  RECFORM = FIXED                           *
  7251*                                                                *
  7252*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  7253*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  7254*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  7255*                                                 RKP=13,LEN=36  *
  7256*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  7257*                                      AND CHG-SEQ.)             *
  7258*                                                RKP=49,LEN=11   *
  7259*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  7260*                                      AND CHG-SEQ.)             *
  7261*                                                RKP=60,LEN=15   *
  7262*                                                                *
  7263*   LOG = NO                                                     *
  7264*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7265******************************************************************
  7266******************************************************************
  7267*                   C H A N G E   L O G
  7268*
  7269* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7270*-----------------------------------------------------------------
  7271*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7272* EFFECTIVE    NUMBER
  7273*-----------------------------------------------------------------
  7274* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7275* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7276* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7277* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  7278* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  7279* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  7280* 032306                   PEMA  ADD BOW LOAN NUMBER
  7281* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  7282* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7283* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7284* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7285* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  7286* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7287* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7288* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  7289* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  7290* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 140
* EL689.cbl
  7291* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  7292******************************************************************
  7293
  7294 01  PENDING-BUSINESS.
  7295     12  PB-RECORD-ID                     PIC XX.
  7296         88  VALID-PB-ID                        VALUE 'PB'.
  7297
  7298     12  PB-CONTROL-PRIMARY.
  7299         16  PB-COMPANY-CD                PIC X.
  7300         16  PB-ENTRY-BATCH               PIC X(6).
  7301         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  7302         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  7303
  7304     12  PB-CONTROL-BY-ACCOUNT.
  7305         16  PB-COMPANY-CD-A1             PIC X.
  7306         16  PB-CARRIER                   PIC X.
  7307         16  PB-GROUPING.
  7308             20  PB-GROUPING-PREFIX       PIC XXX.
  7309             20  PB-GROUPING-PRIME        PIC XXX.
  7310         16  PB-STATE                     PIC XX.
  7311         16  PB-ACCOUNT.
  7312             20  PB-ACCOUNT-PREFIX        PIC X(4).
  7313             20  PB-ACCOUNT-PRIME         PIC X(6).
  7314         16  PB-CERT-EFF-DT               PIC XX.
  7315         16  PB-CERT-NO.
  7316             20  PB-CERT-PRIME            PIC X(10).
  7317             20  PB-CERT-SFX              PIC X.
  7318         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  7319
  7320         16  PB-RECORD-TYPE               PIC X.
  7321             88  PB-MAILING-DATA                VALUE '0'.
  7322             88  PB-ISSUE                       VALUE '1'.
  7323             88  PB-CANCELLATION                VALUE '2'.
  7324             88  PB-BATCH-TRAILER               VALUE '9'.
  7325
  7326     12  PB-CONTROL-BY-ORIG-BATCH.
  7327         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  7328         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  7329         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  7330         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  7331
  7332     12  PB-CONTROL-BY-CSR.
  7333         16  PB-CSR-COMPANY-CD            PIC X.
  7334         16  PB-CSR-ID                    PIC X(4).
  7335         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  7336         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  7337         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  7338******************************************************************
  7339*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  7340******************************************************************
  7341
  7342     12  PB-LAST-MAINT-DT                 PIC XX.
  7343     12  PB-LAST-MAINT-BY                 PIC X(4).
  7344     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7345
  7346     12  PB-RECORD-BODY                   PIC X(375).
  7347
  7348     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 141
* EL689.cbl
  7349         16  PB-CERT-ORIGIN               PIC X.
  7350             88  CLASIC-CREATED-CERT         VALUE '1'.
  7351         16  PB-I-NAME.
  7352             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  7353             20  PB-I-INSURED-FIRST-NAME.
  7354                 24  PB-I-INSURED-1ST-INIT PIC X.
  7355                 24  FILLER                PIC X(9).
  7356             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  7357         16  PB-I-AGE                     PIC S99   COMP-3.
  7358         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  7359         16  PB-I-BIRTHDAY                PIC XX.
  7360         16  PB-I-INSURED-SEX             PIC X.
  7361             88  PB-SEX-MALE     VALUE 'M'.
  7362             88  PB-SEX-FEMALE   VALUE 'F'.
  7363
  7364         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  7365         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  7366         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  7367         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  7368         16  PB-I-SKIP-CODE               PIC X.
  7369             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  7370             88  PB-SKIP-JULY              VALUE '1'.
  7371             88  PB-SKIP-AUGUST            VALUE '2'.
  7372             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  7373             88  PB-SKIP-JULY-AUG          VALUE '4'.
  7374             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  7375             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  7376             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  7377             88  PB-SKIP-JUNE              VALUE '8'.
  7378             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  7379             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  7380             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  7381         16  PB-I-TERM-TYPE               PIC X.
  7382             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  7383             88  PB-PAID-WEEKLY            VALUE 'W'.
  7384             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  7385             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  7386             88  PB-PAID-13-YEARLY         VALUE 'T'.
  7387         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  7388         16  PB-I-POLICY-FORM-NO          PIC X(12).
  7389         16  PB-I-DATA-ENTRY-SW           PIC X.
  7390             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  7391             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  7392             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  7393             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  7394         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  7395         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  7396*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  7397         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  7398         16  FILLER                       PIC X.
  7399
  7400         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  7401             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  7402             88  PB-INVALID-LIFE             VALUE '  ' '00'
  7403                                                   '90' THRU '99'.
  7404         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  7405                                          PIC XX.
  7406         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 142
* EL689.cbl
  7407         16  PB-I-AMOUNT-FINANCED REDEFINES
  7408                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  7409         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  7410         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  7411                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  7412         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7413         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  7414         16  PB-I-CLP-AMOUNT REDEFINES
  7415                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  7416         16  PB-I-LF-CALC-FLAG            PIC X.
  7417             88 PB-COMP-LF-PREM               VALUE '?'.
  7418         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  7419         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  7420         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  7421         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  7422         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7423         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  7424         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  7425         16  PB-I-LF-ABBR                 PIC XXX.
  7426         16  PB-I-LF-INPUT-CD             PIC XX.
  7427
  7428         16  PB-I-AH-BENEFIT-CD           PIC XX.
  7429             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  7430             88  PB-INVALID-AH               VALUE '  ' '00'
  7431                                                   '90' THRU '99'.
  7432         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  7433         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7434         16  PB-I-AH-CALC-FLAG            PIC X.
  7435             88 PB-COMP-AH-PREM                  VALUE '?'.
  7436         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  7437         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  7438         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  7439         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  7440         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  7441         16  PB-I-AH-ABBR                 PIC XXX.
  7442         16  PB-I-AH-INPUT-CD             PIC XXX.
  7443
  7444         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  7445         16  PB-I-REIN-TABLE              PIC XXX.
  7446         16  PB-I-BUSINESS-TYPE           PIC 99.
  7447         16  PB-I-INDV-GRP-CD             PIC X.
  7448         16  PB-I-MORT-CODE.
  7449             20  PB-I-TABLE               PIC X.
  7450             20  PB-I-INTEREST            PIC XX.
  7451             20  PB-I-MORT-TYP            PIC X.
  7452         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  7453         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  7454         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  7455         16  PB-I-INDV-GRP-OVRD           PIC X.
  7456         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  7457         16  PB-I-SIG-SW                  PIC X.
  7458             88  PB-POLICY-SIGNED             VALUE 'Y'.
  7459         16  PB-I-RATE-CLASS              PIC XX.
  7460         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  7461         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  7462         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  7463         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  7464         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 143
* EL689.cbl
  7465         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  7466         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  7467         16  PB-I-BENEFIT-TYPE            PIC XXX.
  7468         16  PB-I-OB-FLAG                 PIC X.
  7469             88  PB-I-OB                      VALUE 'B'.
  7470             88  PB-I-SUMMARY                 VALUE 'Z'.
  7471         16  PB-I-ENTRY-STATUS            PIC X.
  7472             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  7473                                              'M' '5' '9' '2'.
  7474             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  7475             88  PB-I-POLICY-PENDING          VALUE '2'.
  7476             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  7477             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  7478             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  7479             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  7480             88  PB-I-REIN-ONLY               VALUE '9'.
  7481             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  7482             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  7483             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  7484             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  7485         16  PB-I-INT-CODE                PIC X.
  7486             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  7487             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  7488         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  7489         16  PB-I-SOC-SEC-NO              PIC X(11).
  7490         16  PB-I-MEMBER-NO               PIC X(12).
  7491         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  7492*        16  PB-I-LOAN-OFFICER            PIC XXX.
  7493         16  PB-I-OLD-LOF                 PIC XXX.
  7494         16  PB-I-LF-EXPIRE-DT            PIC XX.
  7495         16  PB-I-AH-EXPIRE-DT            PIC XX.
  7496         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  7497         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  7498         16  PB-I-LIFE-INDICATOR          PIC X.
  7499             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  7500         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  7501         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  7502                                          PIC S9(5)V99    COMP-3.
  7503         16  PB-I-MAIL-ADDRS-SW           PIC X.
  7504             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  7505             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  7506         16  PB-I-1ST-PMT-DT              PIC XX.
  7507         16  PB-I-JOINT-INSURED.
  7508             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  7509             20 PB-I-JOINT-FIRST-NAME.
  7510                24  PB-I-JOINT-FIRST-INIT PIC X.
  7511                24  FILLER                PIC X(9).
  7512             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  7513*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  7514         16  PB-I-BENEFICIARY-NAME.
  7515             20  PB-I-BANK-NUMBER         PIC X(10).
  7516             20  FILLER                   PIC X(15).
  7517         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  7518         16  PB-I-REFERENCE               PIC X(12).
  7519         16  FILLER REDEFINES PB-I-REFERENCE.
  7520             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  7521             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  7522             20  PB-I-CLP-STATE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 144
* EL689.cbl
  7523         16  PB-I-UNDERWRITING-STATUS     PIC X.
  7524             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  7525             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  7526             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  7527         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  7528         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  7529         16  PB-I-RESIDENT-STATE          PIC XX.
  7530         16  PB-I-RATE-CODE               PIC X(4).
  7531         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  7532         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7533         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7534         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  7535         16  PB-I-BANK-NOCHRGB            PIC 99.
  7536         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  7537         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  7538
  7539     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  7540         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  7541             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  7542         16  PB-C-CANCEL-ORIGIN           PIC X.
  7543             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  7544         16  PB-C-LF-CANCEL-DT            PIC XX.
  7545         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7546         16  PB-C-LF-CALC-REQ             PIC X.
  7547             88 PB-COMP-LF-CANCEL            VALUE '?'.
  7548         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  7549         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  7550         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  7551             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  7552         16  PB-C-AH-CANCEL-DT            PIC XX.
  7553         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7554         16  PB-C-AH-CALC-REQ             PIC X.
  7555             88 PB-COMP-AH-CANCEL            VALUE '?'.
  7556         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  7557         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  7558         16  PB-C-LAST-NAME               PIC X(15).
  7559         16  PB-C-REFUND-SW               PIC X.
  7560             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  7561             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  7562         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  7563         16  PB-C-PAYEE-CODE              PIC X(6).
  7564         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  7565         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  7566         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  7567         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  7568         16  PB-C-REFERENCE               PIC X(12).
  7569         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7570         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7571         16  PB-C-POST-CARD-IND           PIC X.
  7572         16  PB-C-CANCEL-REASON           PIC X.
  7573         16  PB-C-REF-INTERFACE-SW        PIC X.
  7574         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  7575         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  7576         16  FILLER                       PIC X(01).
  7577*        16  FILLER                       PIC X(18).
  7578         16  PB-C-POLICY-FORM-NO          PIC X(12).
  7579*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  7580         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 145
* EL689.cbl
  7581         16  PB-CANCELED-CERT-DATA.
  7582             20  PB-CI-INSURED-NAME.
  7583                 24  PB-CI-LAST-NAME      PIC X(15).
  7584                 24  PB-CI-INITIALS       PIC XX.
  7585             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  7586             20  PB-CI-INSURED-SEX        PIC X.
  7587             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  7588             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  7589             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  7590             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  7591             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7592             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  7593             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  7594             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  7595             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  7596             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7597             20  PB-CI-RATE-CLASS         PIC XX.
  7598             20  PB-CI-RATE-DEV-LF        PIC XXX.
  7599             20  PB-CI-RATE-DEV-AH        PIC XXX.
  7600             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  7601             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  7602             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  7603             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  7604             20  PB-CI-LF-ABBR            PIC X(3).
  7605             20  PB-CI-AH-ABBR            PIC X(3).
  7606             20  PB-CI-OB-FLAG            PIC X.
  7607                 88  PB-CI-OB                VALUE 'B'.
  7608             20  PB-CI-LF-POLICY-STATUS   PIC X.
  7609                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  7610                                           'M' '4' '5' '9' '2'.
  7611                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  7612                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  7613                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  7614                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  7615                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  7616                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  7617                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  7618                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  7619                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  7620                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  7621                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  7622                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  7623                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  7624             20  PB-CI-AH-POLICY-STATUS   PIC X.
  7625                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  7626                                           'M' '4' '5' '9' '2'.
  7627                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  7628                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  7629                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  7630                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  7631                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  7632                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  7633                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  7634                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  7635                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  7636                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  7637                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  7638                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 146
* EL689.cbl
  7639                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  7640             20  PB-CI-PAY-FREQUENCY      PIC 99.
  7641             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  7642             20  PB-CI-SOC-SEC-NO         PIC X(11).
  7643             20  PB-CI-MEMBER-NO          PIC X(12).
  7644             20  PB-CI-INT-CODE           PIC X.
  7645                 88  PB-CI-ADD-ON                  VALUE 'A'.
  7646                 88  PB-CI-SIMPLE                  VALUE 'S'.
  7647             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  7648             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  7649             20  PB-CI-COMP-EXCP-SW       PIC X.
  7650                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  7651                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  7652             20  PB-CI-ENTRY-STATUS       PIC X.
  7653             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  7654             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  7655             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  7656             20  PB-CI-DEATH-DT           PIC XX.
  7657             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  7658             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  7659             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7660             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7661             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  7662             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  7663             20  PB-CI-ENTRY-DT              PIC XX.
  7664             20  PB-CI-ENTRY-BATCH           PIC X(6).
  7665             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  7666             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  7667             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  7668             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  7669             20  PB-CI-OLD-LOF               PIC XXX.
  7670*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  7671             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  7672             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  7673             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  7674             20  PB-CI-INDV-GRP-CD           PIC X.
  7675             20  PB-CI-BENEFICIARY-NAME.
  7676                 24  PB-CI-BANK-NUMBER       PIC X(10).
  7677                 24  FILLER                  PIC X(15).
  7678             20  PB-CI-NOTE-SW               PIC X.
  7679             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  7680             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  7681             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  7682             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  7683             20  PB-CI-LOAN-OFFICER          PIC X(5).
  7684             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  7685             20  PB-CI-FIRST-NAME            PIC X(10).
  7686             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  7687
  7688         16  FILLER                       PIC X(13).
  7689*032306  16  FILLER                       PIC X(27).
  7690*        16  FILLER                       PIC X(46).
  7691
  7692     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  7693         16  FILLER                       PIC X(10).
  7694         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  7695         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  7696         16  PB-M-INSURED-MID-INIT        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 147
* EL689.cbl
  7697         16  PB-M-INSURED-AGE             PIC 99.
  7698         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  7699         16  PB-M-INSURED-SEX             PIC X.
  7700         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  7701         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  7702         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  7703         16  PB-M-INSURED-CITY-STATE.
  7704             20  PB-M-INSURED-CITY        PIC X(28).
  7705             20  PB-M-INSURED-STATE       PIC XX.
  7706         16  PB-M-INSURED-ZIP-CODE.
  7707             20  PB-M-INSURED-ZIP-PRIME.
  7708                 24  PB-M-INSURED-ZIP-1   PIC X.
  7709                     88  PB-M-CANADIAN-POST-CODE
  7710                                             VALUE 'A' THRU 'Z'.
  7711                 24  FILLER               PIC X(4).
  7712             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  7713         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  7714                                        PB-M-INSURED-ZIP-CODE.
  7715             20  PM-M-INS-CAN-POST1       PIC XXX.
  7716             20  PM-M-INS-CAN-POST2       PIC XXX.
  7717             20  FILLER                   PIC XXX.
  7718         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  7719         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  7720         16  PB-M-CRED-BENE-NAME          PIC X(30).
  7721         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  7722         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  7723         16  PB-M-CRED-BENE-CITYST.
  7724             20  PB-M-CRED-BENE-CITY      PIC X(28).
  7725             20  PB-M-CRED-BENE-STATE     PIC XX.
  7726         16  FILLER                       PIC X(92).
  7727
  7728     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  7729         16  FILLER                       PIC X(10).
  7730         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7731         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7732         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7733         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7734         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7735         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7736         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7737         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7738         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7739         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7740         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7741         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7742         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  7743         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  7744         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  7745         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  7746         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  7747         16  PB-ACCOUNT-NAME              PIC X(30).
  7748         16  PB-PREM-REF-RPT-FLAG         PIC X.
  7749         16  PB-REFERENCE                 PIC X(12).
  7750         16  PB-B-RECEIVED-DT             PIC XX.
  7751         16  FILLER                       PIC X(234).
  7752
  7753     12  PB-RECORD-STATUS.
  7754         16  PB-CREDIT-SELECT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 148
* EL689.cbl
  7755         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  7756         16  PB-BILLED-DT                 PIC XX.
  7757         16  PB-BILLING-STATUS            PIC X.
  7758             88  PB-ENTRY-REVERSED            VALUE 'R'.
  7759             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  7760             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  7761         16  PB-RECORD-BILL               PIC X.
  7762             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  7763             88  PB-RECORD-RETURNED           VALUE 'R'.
  7764             88  PB-RECORD-ENDORSED           VALUE 'E'.
  7765             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  7766             88  PB-OVERRIDE-AH               VALUE 'A'.
  7767             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  7768         16  PB-BATCH-ENTRY               PIC X.
  7769             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  7770             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  7771             88  PB-REISSUED-CERT             VALUE 'E'.
  7772             88  PB-CASH-CERT                 VALUE 'C'.
  7773             88  PB-MONTHLY-CERT              VALUE 'M'.
  7774             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  7775             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  7776             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  7777         16  PB-FORCE-CODE                PIC X.
  7778             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  7779             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  7780             88  PB-CANCEL-FORCE              VALUE '8'.
  7781             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  7782             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  7783             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  7784             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  7785             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  7786             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  7787             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  7788             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  7789         16  PB-FATAL-FLAG                PIC X.
  7790             88  PB-FATAL-ERRORS              VALUE 'X'.
  7791         16  PB-FORCE-ER-CD               PIC X.
  7792             88  PB-FORCE-ERRORS              VALUE 'F'.
  7793             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  7794         16  PB-WARN-ER-CD                PIC X.
  7795             88  PB-WARNING-ERRORS            VALUE 'W'.
  7796         16  FILLER                       PIC X.
  7797         16  PB-OUT-BAL-CD                PIC X.
  7798             88  PB-OUT-OF-BAL                VALUE 'O'.
  7799         16  PB-LIFE-OVERRIDE-L1          PIC X.
  7800         16  PB-AH-OVERRIDE-L1            PIC X.
  7801         16  PB-INPUT-DT                  PIC XX.
  7802         16  PB-INPUT-BY                  PIC X(4).
  7803         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  7804         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  7805         16  PB-TOLERANCE-REJECT-SW       PIC X.
  7806         16  PB-LF-EARNING-METHOD         PIC X.
  7807         16  PB-AH-EARNING-METHOD         PIC X.
  7808         16  PB-LF-TERM-CALC-METHOD       PIC X.
  7809         16  PB-AH-TERM-CALC-METHOD       PIC X.
  7810         16  PB-REIN-CD                   PIC XXX.
  7811         16  PB-LF-REFUND-TYPE            PIC X.
  7812         16  PB-AH-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 149
* EL689.cbl
  7813         16  PB-ACCT-EFF-DT               PIC XX.
  7814         16  PB-ACCT-EXP-DT               PIC XX.
  7815         16  PB-COMPANY-ID                PIC X(3).
  7816         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7817         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7818         16  PB-SV-CARRIER                PIC X.
  7819         16  PB-SV-GROUPING               PIC X(6).
  7820         16  PB-SV-STATE                  PIC XX.
  7821         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  7822         16  PB-GA-BILLING-INFO.
  7823             20  PB-GA-BILL-DT OCCURS 5 TIMES
  7824                                          PIC XX.
  7825         16  PB-SV-REMIT-TO  REDEFINES
  7826             PB-GA-BILLING-INFO           PIC X(10).
  7827         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  7828         16  PB-I-LOAN-OFFICER            PIC X(5).
  7829         16  PB-I-VIN                     PIC X(17).
  7830
  7831         16  FILLER                       PIC X(04).
  7832         16  IMNET-BYPASS-SW              PIC X.
  7833
  7834******************************************************************
  7835*                COMMON EDIT ERRORS                              *
  7836******************************************************************
  7837
  7838     12  PB-COMMON-ERRORS.
  7839         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  7840                                           PIC S9(4)     COMP.
  7841
  7842******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 150
* EL689.cbl
  7844*    COPY ERCPYAJ.
  7845******************************************************************
  7846*                                                                *
  7847*                            ERCPYAJ                             *
  7848*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7849*                            VMOD=2.015                          *
  7850*                                                                *
  7851*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7852*                                                                *
  7853*                                                                *
  7854*   FILE TYPE = VSAM,KSDS                                        *
  7855*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7856*                                                                *
  7857*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7858*       ALTERNATE PATHS = NONE                                   *
  7859*                                                                *
  7860*   LOG = YES                                                    *
  7861*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7862******************************************************************
  7863******************************************************************
  7864*                   C H A N G E   L O G
  7865*
  7866* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7867*-----------------------------------------------------------------
  7868*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7869* EFFECTIVE    NUMBER
  7870*-----------------------------------------------------------------
  7871* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7872* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7873******************************************************************
  7874
  7875 01  PENDING-PAY-ADJ.
  7876     12  PY-RECORD-ID                     PIC XX.
  7877         88  VALID-PY-ID                        VALUE 'PY'.
  7878
  7879     12  PY-CONTROL-PRIMARY.
  7880         16  PY-COMPANY-CD                PIC X.
  7881         16  PY-CARRIER                   PIC X.
  7882         16  PY-GROUPING                  PIC X(6).
  7883         16  PY-FIN-RESP                  PIC X(10).
  7884         16  PY-ACCOUNT                   PIC X(10).
  7885         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7886                                          PIC X(10).
  7887         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7888         16  PY-RECORD-TYPE               PIC X.
  7889             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7890             88  PY-DEPOSIT                   VALUE 'D'.
  7891             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7892             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7893             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7894             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7895             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7896             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7897             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7898             88  PY-FICA-ENTRY                VALUE 'F'.
  7899             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7900             88  PY-POLICY-FEE                VALUE 'W'.
  7901             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 151
* EL689.cbl
  7902
  7903     12  PY-PYMT-TYPE                     PIC X.
  7904             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7905             88  PY-REINS-PYMT                VALUE 'R'.
  7906             88  PY-EXP-PYMT                  VALUE 'E'.
  7907
  7908     12  PY-BIL-INV                       PIC X(6).
  7909     12  PY-REF-NO                        PIC X(12).
  7910
  7911     12  PY-LAST-MAINT-DT                 PIC XX.
  7912     12  PY-LAST-MAINT-BY                 PIC X(4).
  7913     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7914
  7915     12  PY-PYADJ-RECORD.
  7916         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7917         16  PY-ENTRY-COMMENT             PIC X(30).
  7918         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7919             20  PY-GL-ACCOUNT            PIC X(10).
  7920             20  PY-GL-STATE              PIC X(02).
  7921             20  PY-GL-CANC-SW            PIC X(01).
  7922                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7923                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7924             20  PY-GL-COMMENT            PIC X(10).
  7925             20  FILLER      REDEFINES PY-GL-COMMENT.
  7926                 24  PY-GL-CHECK-NO       PIC 9(06).
  7927                 24  FILLER               PIC X(04).
  7928             20  FILLER                   PIC X(07).
  7929         16  PY-SAVE-ACCOUNT              PIC X(10).
  7930         16  PY-SAVE-TYPE                 PIC X(01).
  7931
  7932         16  PY-LETTERS.
  7933             20  PY-LETTER OCCURS 3 TIMES
  7934                           INDEXED BY PY-LET-NDX
  7935                                          PIC X(04).
  7936
  7937         16  PY-ERCOMP-TYPE               PIC X.
  7938             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7939             88  PY-GA-TYPE                   VALUE 'G'.
  7940             88  PY-BANK-TYPE                 VALUE 'B'.
  7941         16  FILLER                       PIC X(05).
  7942
  7943     12  PY-RECORD-STATUS.
  7944         16  PY-CREDIT-SELECT-DT          PIC XX.
  7945         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7946         16  PY-BILLED-DATE               PIC XX.
  7947         16  PY-REPORTED-DT               PIC XX.
  7948         16  PY-PMT-APPLIED               PIC X.
  7949             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7950             88  PY-GA-PMT                    VALUE 'G'.
  7951             88  PY-OVWRITE-PMT               VALUE 'O'.
  7952             88  PY-NON-AR-PMT                VALUE 'N'.
  7953         16  FILLER                       PIC X(5).
  7954         16  PY-INPUT-DT                  PIC XX.
  7955         16  PY-CHECK-NUMBER              PIC X(6).
  7956         16  PY-VOID-SW                   PIC X.
  7957             88  PY-CHECK-VOIDED              VALUE 'V'.
  7958         16  PY-CHECK-ORIGIN-SW           PIC X.
  7959             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 152
* EL689.cbl
  7960             88  PY-REFUND-CHECK              VALUE 'R'.
  7961             88  PY-GA-CHECK                  VALUE 'G'.
  7962             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7963             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7964         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7965         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7966         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7967         16  PY-BILL-FLAG                 PIC X.
  7968             88  PY-BILLED                    VALUE 'B'.
  7969         16  PY-AR-FLAG                   PIC X.
  7970             88  PY-AR-CYCLE                  VALUE 'C'.
  7971             88  PY-AR-MONTH-END              VALUE 'M'.
  7972         16  PY-AR-DATE                   PIC XX.
  7973
  7974     12  PY-GL-CODES.
  7975         16  PY-GL-DB                     PIC X(14).
  7976         16  PY-GL-CR                     PIC X(14).
  7977         16  PY-GL-FLAG                   PIC X.
  7978         16  PY-GL-DATE                   PIC XX.
  7979
  7980     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7981     12  FILLER                           PIC X(3).
  7982******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 153
* EL689.cbl
  7984*    COPY ELCTEXT.
  7985******************************************************************
  7986*                                                                *
  7987*                                                                *
  7988*                            ELCTEXT.                            *
  7989*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7990*                            VMOD=2.008                          *
  7991*                                                                *
  7992*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  7993*                                     FORM LETTERS,              *
  7994*                                     CERT FORM DISPLAY.
  7995*                                                                *
  7996*   FILE TYPE = VSAM,KSDS                                        *
  7997*   RECORD SIZE = 100   RECFORM = FIXED                          *
  7998*                                                                *
  7999*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  8000*       ALTERNATE INDEX = NONE                                   *
  8001*                                                                *
  8002*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  8003*       ALTERNATE INDEX = NONE                                   *
  8004*                                                                *
  8005*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  8006*       ALTERNATE INDEX = NONE                                   *
  8007*                                                                *
  8008*   LOG = NO                                                     *
  8009*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8010******************************************************************
  8011 01  TEXT-FILES.
  8012     12  TEXT-FILE-ID                PIC XX.
  8013         88  FORMS-FILE-TEXT            VALUE 'TF'.
  8014         88  LETTER-FILE-TEXT           VALUE 'TL'.
  8015         88  HELP-FILE-TEXT             VALUE 'TH'.
  8016
  8017     12  TX-CONTROL-PRIMARY.
  8018         16  TX-COMPANY-CD           PIC X.
  8019             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  8020         16  TX-ACCESS-CD-GENL       PIC X(12).
  8021
  8022         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  8023             20  TX-LETTER-NO        PIC X(4).
  8024             20  FILLER              PIC X(8).
  8025
  8026         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  8027             20  TX-FORM-NO          PIC X(12).
  8028
  8029         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  8030             20  TX-HELP-TYPE        PIC X.
  8031                 88  HELP-FOR-GENERAL   VALUE ' '.
  8032                 88  HELP-BY-SCREEN     VALUE 'S'.
  8033                 88  HELP-BY-ERROR      VALUE 'E'.
  8034             20  TX-SCREEN-OR-ERROR  PIC X(4).
  8035                 88  GENERAL-INFO-HELP  VALUE '0000'.
  8036             20  TX-HELP-FOR-COMPANY  PIC XXX.
  8037                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  8038             20  FILLER              PIC X(4).
  8039
  8040         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  8041
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 154
* EL689.cbl
  8042     12  TX-PROCESS-CONTROL          PIC XX.
  8043         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  8044
  8045     12  TX-TEXT-LINE                PIC X(70).
  8046
  8047     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  8048         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  8049         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  8050         88  TX-VALID-FORM-SQUEEZE-VALUE
  8051                                        VALUE 'Y' ' '.
  8052
  8053     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  8054         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  8055         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  8056         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  8057         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  8058         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  8059         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  8060         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  8061                                              'K' 'N' ' '
  8062                                              'Z'.
  8063
  8064     12  TX-ARCHIVE-SW               PIC X.
  8065         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  8066         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  8067         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  8068
  8069     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  8070     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  8071
  8072     12  TX-BSR-CODE                 PIC X.
  8073         88  TX-BSR-LETTER              VALUE 'B'.
  8074         88  TX-NON-BSR-LETTER          VALUE ' '.
  8075
  8076     12  FILLER                      PIC X.
  8077*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 155
* EL689.cbl
  8079*    COPY ERCENDT.
  8080******************************************************************
  8081*                                                                *
  8082*                                                                *
  8083*                            ERCENDT.                            *
  8084*                            VMOD=2.001                          *
  8085*                                                                *
  8086*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  8087*                                                                *
  8088*   FILE TYPE = VSAM,KSDS                                        *
  8089*   RECORD SIZE = 579  RECFORM = FIXED                           *
  8090*                                                                *
  8091*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  8092*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  8093*                                                                *
  8094*   LOG = NO                                                     *
  8095*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8096******************************************************************
  8097*-----------------------------------------------------------------
  8098*                   C H A N G E   L O G
  8099*
  8100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8101*-----------------------------------------------------------------
  8102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8103* EFFECTIVE    NUMBER
  8104*-----------------------------------------------------------------
  8105* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  8106*                                WITH OPEN CLAIMS
  8107* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  8108* 110612    2012101700002  AJRA  ADD NEW FIELDS
  8109* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8110* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  8111*-----------------------------------------------------------------
  8112 01  ENDORSEMENT-RECORD.
  8113     12  EN-RECORD-ID                PIC XX.
  8114         88  VALID-EN-ID                VALUE 'EN'.
  8115     12  EN-CONTROL-PRIMARY.
  8116         16  EN-COMPANY-CD           PIC X.
  8117         16  EN-CARRIER              PIC X.
  8118         16  EN-GROUPING             PIC X(6).
  8119         16  EN-STATE                PIC XX.
  8120         16  EN-ACCOUNT              PIC X(10).
  8121         16  EN-CERT-EFF-DT          PIC XX.
  8122         16  EN-CERT-NO.
  8123             20  EN-CERT-PRIME       PIC X(10).
  8124             20  EN-CERT-SFX         PIC X.
  8125         16  EN-REC-TYPE             PIC X.
  8126             88  EN-ISSUE               VALUE 'I'.
  8127             88  EN-CANCELLATION        VALUE 'C'.
  8128         16  EN-SEQ-NO               PIC 9(04) BINARY.
  8129     12  EN-CONTROL-BY-ARCH-NO.
  8130         16  EN-COMPANY-CD-A1              PIC X.
  8131         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  8132     12  EN-LAST-MAINT-DT            PIC XX.
  8133     12  EN-LAST-MAINT-BY            PIC X(4).
  8134     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  8135     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  8136     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 156
* EL689.cbl
  8137         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  8138         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  8139         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  8140         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  8141         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  8142         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  8143         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  8144         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  8145         16  EN-LF-ORIG-BENCD        PIC XX.
  8146         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  8147         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  8148         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  8149         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  8150         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  8151         16  EN-LF-ORIG-EXP-DT       PIC XX.
  8152*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  8153         16  EN-ORIG-CRED-BENE       PIC X(25).
  8154         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  8155         16  FILLER                  PIC X.
  8156         16  EN-AH-ORIG-BENCD        PIC XX.
  8157         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  8158         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  8159         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  8160         16  EN-AH-ORIG-EXP-DT       PIC XX.
  8161*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  8162*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  8163         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  8164         16  F                       PIC X(09).
  8165         16  EN-AH-ORIG-CP           PIC 99.
  8166         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  8167         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  8168         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  8169         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  8170         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  8171         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  8172         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  8173         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  8174         16  EN-LF-NEW-BENCD         PIC XX.
  8175         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  8176         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8177         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8178         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  8179         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  8180         16  EN-LF-NEW-EXP-DT        PIC XX.
  8181         16  EN-NEW-CRED-BENE        PIC X(25).
  8182         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8183         16  FILLER                  PIC X.
  8184         16  EN-AH-NEW-BENCD         PIC XX.
  8185         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  8186         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8187         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8188         16  EN-AH-NEW-EXP-DT        PIC XX.
  8189*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  8190*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  8191*        16  F                       PIC X(12).
  8192         16  EN-AH-NEW-CP            PIC 99.
  8193         16  EN-SIG-SW               PIC X.
  8194         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 157
* EL689.cbl
  8195         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  8196         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  8197         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8198         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8199         16  FILLER                  PIC X(33).
  8200     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8201         16  EN-LF-ORIG-REF-DT       PIC XX.
  8202         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8203         16  EN-AH-ORIG-REF-DT       PIC XX.
  8204         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8205         16  EN-LF-NEW-REF-DT        PIC XX.
  8206         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8207         16  EN-AH-NEW-REF-DT        PIC XX.
  8208         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8209         16  EN-FLAG-CERT            PIC X.
  8210         16  EN-INS-LAST-NAME        PIC X(15).
  8211         16  EN-INS-FIRST-NAME       PIC X(10).
  8212         16  EN-INS-MIDDLE-INIT      PIC X.
  8213         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8214         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8215         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8216         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8217         16  FILLER                  PIC X(262).
  8218     12  EN-MONEY-SW             PIC X.
  8219     12  EN-HEALTH-APP           PIC X.
  8220     12  EN-VOUCHER-SW           PIC X.
  8221     12  EN-PAYEE                PIC X(14).
  8222     12  EN-INPUT-DT             PIC XX.
  8223     12  EN-PROCESS-DT           PIC XX.
  8224     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8225     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8226     12  EN-REASON-CODES.
  8227         16  F OCCURS 12.
  8228             20  EN-REASON-CODE  PIC X(4).
  8229     12  EN-TEMPLATE-USED        PIC X(8).
  8230     12  EN-DOCU-TYPE            PIC X.
  8231         88  EN-VERI-DOCU          VALUE 'V'.
  8232         88  EN-GCE-DOCU           VALUE 'G'.
  8233         88  EN-CANC-DOCU          VALUE 'C'.
  8234     12  EN-COMMENTS1            PIC X(13).
  8235     12  EN-COMMENTS2            PIC X(70).
  8236     12  EN-COMM-CHGBK           PIC X.
  8237         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8238         88  EN-CHG-ACCT           VALUE 'Y'.
  8239     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8240     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8241     12  EN-BATCH-NUMBER         PIC X(6).
  8242     12  EN-ACCT-SUMM            PIC X.
  8243     12  EN-CSO-SUMM             PIC X.
  8244     12  en-check-type           pic x.
  8245     12  FILLER                  PIC X(12).
  8246******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 158
* EL689.cbl
  8248*    COPY ERCNOTE.
  8249******************************************************************
  8250*                                                                *
  8251*                                                                *
  8252*                            ERCNOTE                             *
  8253*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8254*                            VMOD=2.003                          *
  8255*                                                                *
  8256*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  8257*                                                                *
  8258*        FILE TYPE= VSAM,KSDS                                    *
  8259*        RECORD SIZE = 825    RECFORM = FIXED                    *
  8260*                                                                *
  8261*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  8262*                                                                *
  8263*        LOG = YES                                               *
  8264*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  8265*                                                                *
  8266******************************************************************
  8267*                   C H A N G E   L O G
  8268*
  8269* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8270*-----------------------------------------------------------------
  8271*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8272* EFFECTIVE    NUMBER
  8273*-----------------------------------------------------------------
  8274* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  8275*                                FILE WILL CONTAIN BILLING NOTES O
  8276******************************************************************
  8277
  8278 01  CERTIFICATE-NOTE.
  8279     12  CN-RECORD-ID                PIC  XX.
  8280         88  VALID-CN-ID                  VALUE 'CN'.
  8281
  8282     12  CN-CONTROL-PRIMARY.
  8283         16  CN-COMPANY-CD           PIC X.
  8284         16  CN-CARRIER              PIC X.
  8285         16  CN-GROUPING.
  8286             20 CN-GROUPING-PREFIX   PIC XXX.
  8287             20 CN-GROUPING-PRIME    PIC XXX.
  8288         16  CN-STATE                PIC XX.
  8289         16  CN-ACCOUNT.
  8290             20 CN-ACCOUNT-PREFIX    PIC X(4).
  8291             20 CN-ACCOUNT-PRIME     PIC X(6).
  8292         16  CN-CERT-EFF-DT          PIC XX.
  8293         16  CN-CERT-NO.
  8294             20  CN-CERT-PRIME       PIC X(10).
  8295             20  CN-CERT-SFX         PIC X.
  8296
  8297     12  CN-BILLING-START-LINE-NO    PIC 99.
  8298     12  CN-BILLING-END-LINE-NO      PIC 99.
  8299
  8300     12  CN-LINES.
  8301         16  CN-LINE OCCURS 10       PIC X(77).
  8302
  8303     12  CN-LAST-MAINT-DT            PIC XX.
  8304     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8305     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 159
* EL689.cbl
  8306     12  FILLER                      PIC X(6).
  8307******************************************************************
  8308*    COPY ELCEOBC.
  8309******************************************************************
  8310*                                                                *
  8311*                                                                *
  8312*                            ELCEOBC                             *
  8313*                            VMOD=2.001                          *
  8314*                                                                *
  8315*   CLAIM SYSTEM EOB CODE TABLE                                  *
  8316*                                                                *
  8317*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  8318*   VSAM EOB CODE TABLE                                          *
  8319*                                                                *
  8320*   FILE DESCRIPTION = EOB CODE TABLE                            *
  8321*                                                                *
  8322*   FILE TYPE = VSAM,KSDS                                        *
  8323*   RECORD SIZE = 350   RECFORM = FIX                            *
  8324*                                                                *
  8325*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  8326*                                                                *
  8327*   LOG = NO                                                     *
  8328*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8329*                                                                *
  8330*                                                                *
  8331******************************************************************
  8332*                   C H A N G E   L O G
  8333*
  8334* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8335*-----------------------------------------------------------------
  8336*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8337* EFFECTIVE    NUMBER
  8338*-----------------------------------------------------------------
  8339* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  8340* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  8341* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  8342******************************************************************
  8343 01  EOB-CODES.
  8344     12  EO-RECORD-ID                      PIC XX.
  8345         88  VALID-DN-ID                      VALUE 'EO'.
  8346     12  EO-CONTROL-PRIMARY.
  8347         16  EO-COMPANY-CD                 PIC X.
  8348         16  EO-RECORD-TYPE                PIC X.
  8349             88  EO-EOB-RECS                  VALUE '1'.
  8350             88  EO-VERIF-RECS                VALUE '2'.
  8351             88  EO-GCE-RECS                  VALUE '3'.
  8352             88  EO-CANC-RECS                 VALUE '4'.
  8353             88  EO-BILL-NOTE-RECS            VALUE '5'.
  8354         16  EO-EOB-CODE                   PIC X(4).
  8355         16  FILLER                        PIC X(9).
  8356     12  EO-MAINT-INFORMATION.
  8357         16  EO-LAST-MAINT-DT              PIC XX.
  8358         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  8359         16  EO-LAST-MAINT-USER            PIC X(4).
  8360         16  FILLER                        PIC XX.
  8361     12  EO-DESCRIPTION                    PIC X(275).
  8362     12  FILLER                            PIC X(46).
  8363******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 160
* EL689.cbl
  8365*    COPY ELCENCC.
  8366******************************************************************
  8367*                                                                *
  8368*                                                                *
  8369*                            ELCENCC                             *
  8370*                            VMOD=2.001                          *
  8371*                                                                *
  8372*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  8373*                                                                *
  8374*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  8375*   A NAPERSOFT DOCUMENT                                         *
  8376*                                                                *
  8377*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  8378*                                                                *
  8379*   FILE TYPE = VSAM,KSDS                                        *
  8380*   RECORD SIZE = 400   RECFORM = FIX                            *
  8381*                                                                *
  8382*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  8383*                                                                *
  8384*   LOG = NO                                                     *
  8385*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8386*                                                                *
  8387*                                                                *
  8388******************************************************************
  8389*                   C H A N G E   L O G
  8390*
  8391* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8392*-----------------------------------------------------------------
  8393*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8394* EFFECTIVE    NUMBER
  8395*-----------------------------------------------------------------
  8396* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  8397* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  8398******************************************************************
  8399 01  ENCLOSURE-CODES.
  8400     12  NC-RECORD-ID                      PIC XX.
  8401         88  VALID-NC-ID                      VALUE 'NC'.
  8402     12  NC-CONTROL-PRIMARY.
  8403         16  NC-COMPANY-CD                 PIC X.
  8404         16  NC-REC-TYPE                   PIC X.
  8405             88  NC-CLAIMS                   VALUE '1'.
  8406             88  NC-ADMIN                    VALUE '2'.
  8407         16  NC-ENC-CODE                   PIC X(5).
  8408         16  FILLER                        PIC X(09).
  8409     12  NC-MAINT-INFORMATION.
  8410         16  NC-LAST-MAINT-DT              PIC XX.
  8411         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  8412         16  NC-LAST-MAINT-USER            PIC X(4).
  8413         16  FILLER                        PIC XX.
  8414     12  NC-OUTPUT-STACK                   PIC XXX.
  8415     12  NC-ENCLOSURE-LINE                 PIC X(100).
  8416     12  NC-ATTACHMENTS                    PIC X(255).
  8417     12  NC-FUTURE                         PIC X(12).
  8418******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 161
* EL689.cbl
  8420 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  8421                          ACCOUNT-MASTER LETTER-ARCHIVE
  8422                          LETTER-ARCHIVE-TEXT
  8423                          CERTIFICATE-MASTER CHECK-RECORDS
  8424                          CONTROL-FILE COMPENSATION-MASTER
  8425                          MAILING-DATA PENDING-BUSINESS
  8426                          PENDING-PAY-ADJ TEXT-FILES
  8427                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  8428                          EOB-CODES ENCLOSURE-CODES.
  8429 0000-DFHEXIT SECTION.
  8430     MOVE '9#                    $   ' TO DFHEIV0.
  8431     MOVE 'EL689' TO DFHEIV1.
  8432     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8433     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  8434
  8435     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8436     MOVE '5'                    TO DC-OPTION-CODE.
  8437     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  8438     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  8439     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  8440                                    W-CURRENT-SAVE.
  8441     MOVE DC-GREG-DATE-A-EDIT    TO W-SAVE-EDIT-A-DATE
  8442     MOVE DC-DAY-OF-WEEK         TO W-SAVE-CYCLE-DAY-OF-WEEK
  8443
  8444     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8445     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  8446                                 TO EMI-SAVE-AREA.
  8447
  8448     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8449                                    W-TS-TERM-SCREEN.
  8450
  8451     IF  EIBCALEN EQUAL 0
  8452         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  8453         GO TO 8300-SEND-TEXT
  8454     END-IF.
  8455     set P to address of KIXSYS
  8456     CALL "getenv" using by value P returning var-ptr
  8457     if var-ptr = null then
  8458        display ' kixsys not set '
  8459     else
  8460        set address of var to var-ptr
  8461        move 0 to env-var-len
  8462        inspect var tallying env-var-len
  8463          for characters before X'00'
  8464*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  8465        unstring var (1:env-var-len) delimited by '/'
  8466           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8467              WS-KIX-SYS
  8468        end-unstring
  8469*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  8470*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8471     end-if
  8472     set P to address of KIXHOST
  8473     CALL "getenv" using by value P returning var-ptr
  8474     if var-ptr = null then
  8475        display ' kixhost not set '
  8476     else
  8477        set address of var to var-ptr
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 162
* EL689.cbl
  8478        move 0 to env-var-len
  8479        inspect var tallying env-var-len
  8480          for characters before X'00'
  8481*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  8482        MOVE var(1:env-var-len)  to ws-kixhost
  8483*       unstring var (1:env-var-len) delimited by '/'
  8484*          into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8485*             WS-KIX-SYS
  8486*       end-unstring
  8487        DISPLAY ' WS KIX HOST ' WS-KIXSYS
  8488*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8489     end-if
  8490
  8491**** This routine will connect to the Logic Database on SQL Server
  8492**** and call a stored procedure to determine the next business da
  8493
  8494     PERFORM 4500-CONNECT-TO-DB  THRU 4500-EXIT
  8495     IF SQLCODE = 0
  8496        PERFORM 4600-GET-NEXT-BUS-DT  THRU 4600-EXIT
  8497        IF SQLCODE = 0
  8498            MOVE WS-NEXT-BUS-DT TO W-SAVE-NEXT-BUS-DT-EDIT-A
  8499                                   W-EDIT-A-DATE
  8500            MOVE W-EDIT-A-YY    TO DC-YMD-YEAR
  8501            MOVE W-EDIT-A-MM    TO DC-YMD-MONTH
  8502            MOVE W-EDIT-A-DD    TO DC-YMD-DAY
  8503            MOVE '3'            TO DC-OPTION-CODE
  8504            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8505            IF NO-CONVERSION-ERROR
  8506               MOVE DC-BIN-DATE-1 TO W-SAVE-BIN-NEXT-BUS-DT
  8507            ELSE
  8508               MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8509               MOVE '6'         TO DC-OPTION-CODE
  8510               MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8511               IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
  8512                  MOVE 3        TO DC-ELAPSED-DAYS
  8513               ELSE
  8514                 IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8515                    MOVE 2     TO DC-ELAPSED-DAYS
  8516                 ELSE
  8517                    MOVE 1     TO DC-ELAPSED-DAYS
  8518                 END-IF
  8519               END-IF
  8520               PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8521               IF NO-CONVERSION-ERROR
  8522                   MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8523                   MOVE DC-GREG-DATE-A-EDIT TO
  8524                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8525               ELSE
  8526                   MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8527                   MOVE W-SAVE-EDIT-A-DATE TO
  8528                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8529               END-IF
  8530            END-IF
  8531        ELSE
  8532            MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8533            MOVE '6'         TO DC-OPTION-CODE
  8534            MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8535            IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 163
* EL689.cbl
  8536               MOVE 3        TO DC-ELAPSED-DAYS
  8537            ELSE
  8538              IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8539                 MOVE 2     TO DC-ELAPSED-DAYS
  8540              ELSE
  8541                 MOVE 1     TO DC-ELAPSED-DAYS
  8542              END-IF
  8543            END-IF
  8544            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8545            IF NO-CONVERSION-ERROR
  8546                MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8547                MOVE DC-GREG-DATE-A-EDIT TO
  8548                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8549            ELSE
  8550                MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8551                MOVE W-SAVE-EDIT-A-DATE TO
  8552                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8553            END-IF
  8554        END-IF
  8555     ELSE
  8556        MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8557        MOVE '6'         TO DC-OPTION-CODE
  8558        MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8559        IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
  8560           MOVE 3        TO DC-ELAPSED-DAYS
  8561        ELSE
  8562          IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8563             MOVE 2     TO DC-ELAPSED-DAYS
  8564          ELSE
  8565             MOVE 1     TO DC-ELAPSED-DAYS
  8566          END-IF
  8567        END-IF
  8568        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8569        IF NO-CONVERSION-ERROR
  8570            MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8571            MOVE DC-GREG-DATE-A-EDIT TO
  8572                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8573        ELSE
  8574            MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8575            MOVE W-SAVE-EDIT-A-DATE TO
  8576                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8577        END-IF
  8578     END-IF
  8579     PERFORM 4700-DISCONNECT THRU 4700-EXIT
  8580
  8581     IF  PI-689-CREATE-NO-SCREENS
  8582         GO TO 0600-BYPASS-SCREEN-CNTL
  8583     END-IF.
  8584
  8585     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  8586         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  8587             MOVE PI-SAVED-PROGRAM-5
  8588                                 TO PI-SAVED-PROGRAM-6
  8589             MOVE PI-SAVED-PROGRAM-4
  8590                                 TO PI-SAVED-PROGRAM-5
  8591             MOVE PI-SAVED-PROGRAM-3
  8592                                 TO PI-SAVED-PROGRAM-4
  8593             MOVE PI-SAVED-PROGRAM-2
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 164
* EL689.cbl
  8594                                 TO PI-SAVED-PROGRAM-3
  8595             MOVE PI-SAVED-PROGRAM-1
  8596                                 TO PI-SAVED-PROGRAM-2
  8597             MOVE PI-RETURN-TO-PROGRAM
  8598                                 TO PI-SAVED-PROGRAM-1
  8599             MOVE PI-CALLING-PROGRAM
  8600                                 TO PI-RETURN-TO-PROGRAM
  8601             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  8602             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8603             MOVE LOW-VALUES     TO EL689AO
  8604             PERFORM 9905-INITIALIZE-SECURITY THRU 9905-EXIT
  8605             IF PI-689-ARCHIVE-NUMBER NOT NUMERIC
  8606                MOVE ZEROS       TO PI-689-ARCHIVE-NUMBEr
  8607             END-IF
  8608             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  8609                     AND
  8610                 PI-689-KEY-DATA-FIELDS GREATER THAN LOW-VALUES
  8611                 GO TO 0400-EL6311-INCOMING
  8612             ELSE
  8613                 MOVE PI-689-ARCHIVE-NUMBER
  8614                                 TO W-INCOMING-ARCHIVE
  8615                 MOVE LOW-VALUES TO PI-1042-WA
  8616                                    PI-689-WORK-AREA
  8617                 MOVE ZEROS      TO PI-CURRENT-LINE
  8618                                    PI-TEMP-STOR-ITEMS
  8619                                    PI-TOTAL-LINES
  8620                                    PI-UPDATE-SW
  8621                                    PI-689-NUMBER-LABEL-LINES
  8622                                    PI-689-NUMBER-TEXT-RECORDS
  8623                                    PI-689-ERROR
  8624                 MOVE SPACES     TO PI-689-PRINT-SW
  8625                                    PI-689-ALT-PRINTER-ID
  8626                                    PI-689-LBL-OVERRIDE
  8627                                    PI-COMM-CONTROL
  8628                                    PI-689-FORM-NUMBER
  8629                                    PI-689-TEMP-STOR-ID
  8630                                    PI-689-LABEL-SOURCE
  8631                                    PI-689-USE-SCREEN-IND
  8632                 MOVE '2'        TO PI-ACTION
  8633                 MOVE -1         TO MAINTL
  8634                 MOVE PI-LOWER-CASE-LETTERS
  8635                                 TO W-LC-CASE-IND
  8636                 IF  W-INCOMING-ARCHIVE NUMERIC
  8637                         AND
  8638                     W-INCOMING-ARCH-NO GREATER THAN ZEROS
  8639                     MOVE 'S'    TO MAINTI
  8640                     MOVE +1     TO MAINTL
  8641                     MOVE AL-UANON
  8642                                 TO MAINTA
  8643                     MOVE W-INCOMING-ARCH-NO
  8644                                 TO ARCHNUMI
  8645                     MOVE +8     TO ARCHNUML
  8646                     MOVE AL-UNNON
  8647                                 TO ARCHNUMA
  8648                     GO TO 1000-SHOW
  8649                 ELSE
  8650                     GO TO 0450-SPECIAL-INPUT-PROCESS
  8651                 END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 165
* EL689.cbl
  8652             END-IF
  8653         ELSE
  8654             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  8655             MOVE PI-RETURN-TO-PROGRAM
  8656                                     TO PI-CALLING-PROGRAM
  8657             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  8658             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  8659             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  8660             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  8661             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  8662             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  8663             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  8664             PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8665             MOVE LOW-VALUES         TO EL689AO
  8666             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8667             SET W-RG-NDX            TO PI-CURRENT-LINE
  8668             PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8669                 VARYING
  8670                     W-SC-NDX FROM 1 BY 1
  8671                 UNTIL
  8672                     W-SC-NDX GREATER THAN
  8673                     W-NUM-LINES-PER-SCREEN
  8674             MOVE PI-689-ALT-PRINTER-ID
  8675                                     TO PRINTERO
  8676             MOVE AL-UANON           TO PRINTERA
  8677             MOVE -1                 TO PRINTERL
  8678             GO TO 8100-SEND-INITIAL-MAP
  8679         END-IF
  8680     END-IF.
  8681
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 166
* EL689.cbl
  8683 0200-RECEIVE.
  8684
  8685     MOVE PI-689-FATAL-CTR       TO EMI-FATAL-CTR
  8686     MOVE PI-689-FORCABLE-CTR    TO EMI-FORCABLE-CTR
  8687     IF  EMI-FATAL-CTR GREATER THAN ZEROS
  8688             OR
  8689         EMI-FORCABLE-CTR GREATER THAN ZEROS
  8690         MOVE 'Y'                TO W-HOLD-IND.
  8691
  8692     MOVE W-TRANSACTION          TO EIBTRNID.
  8693     MOVE EMI-SAVE-AREA          TO ERROR-MESSAGE-INTERFACE-BLOCK.
  8694     MOVE ZEROS                  TO W-LAST-ERROR.
  8695     MOVE LOW-VALUES             TO EL689AI.
  8696     MOVE '104A'                 TO W-TS-ID-TEXT.
  8697     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8698                                    W-TS-TERM-SCREEN.
  8699
  8700
  8701* EXEC CICS HANDLE AID
  8702*        CLEAR    (9300-DFHCLEAR)
  8703*        PA1      (9200-PA)
  8704*        PA2      (9200-PA)
  8705*        PA3      (9200-PA)
  8706*    END-EXEC.
  8707*    MOVE '"&=!"#               V! " #00008603' TO DFHEIV0
  8708     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  8709     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  8710     MOVE X'2220233030303038363033' TO DFHEIV0(25:11)
  8711     CALL 'kxdfhei1' USING DFHEIV0
  8712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8713
  8714
  8715
  8716* EXEC CICS HANDLE CONDITION
  8717*        PGMIDERR (9700-PGMID-ERROR)
  8718*        ERROR    (9800-ABEND)
  8719*        MAPFAIL  (0325-MAPFAIL)
  8720*    END-EXEC.
  8721*    MOVE '"$L.?                 ! # #00008610' TO DFHEIV0
  8722     MOVE X'22244C2E3F20202020202020' TO DFHEIV0(1:12)
  8723     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8724     MOVE X'2320233030303038363130' TO DFHEIV0(25:11)
  8725     CALL 'kxdfhei1' USING DFHEIV0
  8726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8727
  8728
  8729
  8730* EXEC CICS SYNCPOINT
  8731*    END-EXEC.
  8732*    MOVE '6"                    !   #00008616' TO DFHEIV0
  8733     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  8734     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8735     MOVE X'2020233030303038363136' TO DFHEIV0(25:11)
  8736     CALL 'kxdfhei1' USING DFHEIV0
  8737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8738
  8739
  8740     IF PI-LOWER-CASE-LETTERS = 'Y'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 167
* EL689.cbl
  8741*    IF  W-LC-USE-BOTH-CASES
  8742
  8743* EXEC CICS RECEIVE
  8744*            MAP      (W-MAP)
  8745*            MAPSET   (W-MAPSET)
  8746*            INTO     (EL689AI)
  8747*            ASIS
  8748*        END-EXEC
  8749     MOVE LENGTH OF
  8750      EL689AI
  8751       TO DFHEIV11
  8752*    MOVE '8"TAI  L              ''   #00008621' TO DFHEIV0
  8753     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8754     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8755     MOVE X'2020233030303038363231' TO DFHEIV0(25:11)
  8756     CALL 'kxdfhei1' USING DFHEIV0,
  8757           W-MAP,
  8758           EL689AI,
  8759           DFHEIV11,
  8760           W-MAPSET,
  8761           DFHEIV99,
  8762           DFHEIV99
  8763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8764     ELSE
  8765
  8766* EXEC CICS RECEIVE
  8767*            MAP      (W-MAP)
  8768*            MAPSET   (W-MAPSET)
  8769*            INTO     (EL689AI)
  8770*        END-EXEC.
  8771     MOVE LENGTH OF
  8772      EL689AI
  8773       TO DFHEIV11
  8774*    MOVE '8"T I  L              ''   #00008628' TO DFHEIV0
  8775     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8776     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8777     MOVE X'2020233030303038363238' TO DFHEIV0(25:11)
  8778     CALL 'kxdfhei1' USING DFHEIV0,
  8779           W-MAP,
  8780           EL689AI,
  8781           DFHEIV11,
  8782           W-MAPSET,
  8783           DFHEIV99,
  8784           DFHEIV99
  8785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8786
  8787
  8788     IF  NOT DISPLAY-CAP
  8789         MOVE 'READ'             TO SM-READ
  8790         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8791         MOVE ER-9097            TO EMI-ERROR
  8792         MOVE -1                 TO MAINTL
  8793         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8794         GO TO 8100-SEND-INITIAL-MAP.
  8795
  8796     INSPECT MAINTI CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
  8797
  8798     IF  ENTERPFL EQUAL 0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 168
* EL689.cbl
  8799         GO TO 0300-CHECK-PFKEYS.
  8800
  8801     IF  EIBAID NOT EQUAL DFHENTER
  8802         MOVE ER-0004            TO EMI-ERROR
  8803         GO TO 0320-INPUT-ERROR.
  8804
  8805     IF  ENTERPFI NUMERIC
  8806             AND
  8807         ENTERPFI GREATER THAN 0
  8808             AND
  8809         ENTERPFI LESS THAN 25
  8810         MOVE PF-VALUES (ENTERPFI)
  8811                                 TO EIBAID
  8812     ELSE
  8813         MOVE ER-0029            TO EMI-ERROR
  8814         GO TO 0320-INPUT-ERROR.
  8815
  8816 0300-CHECK-PFKEYS.
  8817
  8818     IF  EIBAID EQUAL DFHPF23
  8819         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8820         MOVE ZEROS              TO PI-TOTAL-LINES
  8821                                    PI-CURRENT-LINE
  8822         MOVE EIBAID             TO PI-ENTRY-CD-1
  8823         MOVE W-XCTL-005         TO W-CALL-PGM
  8824         GO TO 9400-XCTL.
  8825
  8826     IF  EIBAID EQUAL DFHPF24
  8827         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8828         MOVE ZEROS              TO PI-TOTAL-LINES
  8829                                    PI-CURRENT-LINE
  8830         MOVE W-XCTL-626         TO W-CALL-PGM
  8831         GO TO 9400-XCTL.
  8832
  8833     MOVE SPACES                 TO W-KEY-FIELDS-CHANGED-IND
  8834                                    W-FORM-CHANGED-IND.
  8835
  8836     IF  PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8837             OR
  8838         PI-SHOW-MODE
  8839         NEXT SENTENCE
  8840     ELSE
  8841         IF  PI-689-FORM-NUMBER GREATER THAN SPACES
  8842                 AND
  8843             FORML NOT EQUAL ZEROS
  8844                 AND
  8845             PI-689-FORM-NUMBER NOT EQUAL FORMI
  8846             MOVE FORMI          TO PI-689-FORM-NUMBER
  8847             MOVE LOW-VALUES     TO EL689AI
  8848                                    PI-1042-WA
  8849                                    PI-689-FOLLOW-UP-DATE
  8850                                    PI-689-PRINT-RESTRICTION
  8851                                    PI-689-RESEND-DATE-1
  8852                                    PI-689-RESEND1-EDIT
  8853                                    PI-689-FOLLOW-UP-DATE
  8854                                    PI-689-FOLLOW-UP-EDIT
  8855                                    PI-689-ERROR-IND
  8856             MOVE ZEROS          TO PI-689-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 169
* EL689.cbl
  8857                                    PI-689-NUMBER-COPIES
  8858                                    PI-689-NUMBER-LABEL-LINES
  8859                                    PI-689-NUMBER-TEXT-RECORDS
  8860                                    PI-CURRENT-LINE
  8861                                    PI-TEMP-STOR-ITEMS
  8862                                    PI-TOTAL-LINES
  8863                                    PI-UPDATE-SW
  8864             MOVE SPACES         TO PI-689-PRINT-SW
  8865                                    PI-689-ALT-PRINTER-ID
  8866                                    PI-COMM-CONTROL
  8867                                    PI-689-TEMP-STOR-ID
  8868                                    PI-689-USE-SCREEN-IND
  8869                                    PI-689-RESEND-LETR-1
  8870                                    PI-CERT-FORM-ID
  8871                                    PI-CERT-REQ-IND
  8872                                    PI-REASON-REQ-IND
  8873             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8874             MOVE DFHENTER       TO EIBAID
  8875             MOVE 'Y'            TO W-FORM-CHANGED-IND
  8876             GO TO 0330-FUNCTION-CHECK
  8877         ELSE
  8878             IF  PI-689-DATA-SOURCE NOT EQUAL DATASORI
  8879                     OR
  8880                 (PI-689-LABEL-SOURCE NOT EQUAL ADDRSI
  8881                         AND
  8882                     (PI-689-LABEL-SOURCE NOT EQUAL SPACES
  8883                             OR
  8884                         ADDRSI NOT EQUAL LOW-VALUES))
  8885                     OR
  8886                 PI-689-CARRIER NOT EQUAL CARRIERI
  8887                     OR
  8888                 PI-689-GROUPING NOT EQUAL GROUPI
  8889                     OR
  8890                 PI-689-STATE NOT EQUAL STATEI
  8891                     OR
  8892                 PI-689-ACCOUNT NOT EQUAL ACCTI
  8893                     OR
  8894                 PI-689-CERT-PRIME NOT EQUAL CERTI
  8895                     OR
  8896                 PI-689-CERT-SFX NOT EQUAL SFXI
  8897                     OR
  8898                 PI-689-TYPE NOT EQUAL TYPEI
  8899                     OR
  8900                 PI-689-DATE-EDIT NOT EQUAL DATEI
  8901                     OR
  8902                 PI-689-RESP-PERSON NOT EQUAL RPERSONI
  8903                     OR
  8904                 PI-689-SEQ-EDIT NOT EQUAL SEQI
  8905                     OR
  8906                 PI-689-ENTRY-BATCH NOT EQUAL BENTRYI
  8907                     OR
  8908                 PI-689-BCSEQ-EDIT NOT EQUAL BCSEQI
  8909                 MOVE 'Y'        TO W-KEY-FIELDS-CHANGED-IND
  8910                 MOVE DFHENTER   TO EIBAID
  8911                 GO TO 0330-FUNCTION-CHECK.
  8912
  8913*    IF  EIBAID EQUAL DFHPF1
  8914*        MOVE +7                 TO W-ROLL-COUNTER
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 170
* EL689.cbl
  8915*        GO TO 4000-ROLL-PAGE.
  8916
  8917*    IF  EIBAID EQUAL DFHPF2
  8918*        MOVE -7                 TO W-ROLL-COUNTER
  8919*        GO TO 4000-ROLL-PAGE.
  8920
  8921*    IF  EIBAID EQUAL DFHPF3
  8922*        IF  W-HOLD-ON
  8923*            MOVE ER-7245        TO EMI-ERROR
  8924*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8925*            MOVE -1             TO MAINTL
  8926*            MOVE AL-UABON       TO MAINTA
  8927*            GO TO 8200-SEND-DATAONLY
  8928*        ELSE
  8929*            GO TO 0330-FUNCTION-CHECK.
  8930*    IF (EIBAID = DFHPF8)
  8931*       AND (PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR
  8932*         'CAGB' OR 'DLVA' OR 'ECCA' OR 'KRHA' OR 'ALWA')
  8933*       MOVE ER-0029             TO EMI-ERROR
  8934*       GO TO 0320-INPUT-ERROR
  8935*    END-IF
  8936*    IF EIBAID = DFHPF4 OR DFHPF8
  8937*        IF  W-HOLD-ON
  8938*            MOVE ER-7245        TO EMI-ERROR
  8939*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8940*            MOVE -1             TO MAINTL
  8941*            MOVE AL-UABON       TO MAINTA
  8942*            GO TO 8200-SEND-DATAONLY
  8943*        ELSE
  8944*            GO TO 0330-FUNCTION-CHECK.
  8945
  8946*    IF  EIBAID = DFHPF5
  8947*        COMPUTE W-ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  8948*        GO TO 4000-ROLL-PAGE.
  8949
  8950*    IF  EIBAID = DFHPF6
  8951*        MOVE PI-TOTAL-LINES     TO W-ROLL-COUNTER
  8952*        GO TO 4000-ROLL-PAGE.
  8953
  8954     IF  EIBAID EQUAL DFHPF7
  8955         IF PI-PROMPT-IND EQUAL 'Y'
  8956             MOVE ER-0894        TO EMI-ERROR
  8957             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8958             MOVE -1             TO MAINTL
  8959             MOVE AL-UABON       TO MAINTA
  8960             GO TO 8200-SEND-DATAONLY
  8961         END-IF
  8962     END-IF.
  8963
  8964     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8965         IF  W-HOLD-ON
  8966             MOVE ER-7245        TO EMI-ERROR
  8967             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8968             MOVE -1             TO MAINTL
  8969             MOVE AL-UABON       TO MAINTA
  8970             GO TO 8200-SEND-DATAONLY
  8971         ELSE
  8972             GO TO 0330-FUNCTION-CHECK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 171
* EL689.cbl
  8973
  8974     IF  EIBAID EQUAL DFHENTER
  8975         GO TO 0330-FUNCTION-CHECK.
  8976
  8977     MOVE ER-0029                TO EMI-ERROR.
  8978
  8979 0320-INPUT-ERROR.
  8980
  8981     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8982
  8983     IF  ENTERPFL EQUAL 0
  8984         MOVE -1                 TO MAINTL
  8985         MOVE AL-UABON           TO MAINTA
  8986     ELSE
  8987         MOVE AL-UNBON           TO ENTERPFA
  8988         MOVE -1                 TO ENTERPFL.
  8989
  8990     GO TO 8200-SEND-DATAONLY.
  8991
  8992 0325-MAPFAIL.
  8993***********************************************************
  8994*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  8995*      LETTERS ON A 3275 PRINTER.                         *
  8996***********************************************************
  8997
  8998     PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8999
  9000     SET W-RG-NDX                TO PI-CURRENT-LINE.
  9001     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  9002             VARYING
  9003         W-SC-NDX FROM 1 BY 1
  9004             UNTIL
  9005         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  9006
  9007     MOVE -1                     TO MAINTL.
  9008     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 172
* EL689.cbl
  9010 0330-FUNCTION-CHECK.
  9011
  9012     IF  MAINTI EQUAL 'S'
  9013*        IF EIBAID = DFHPF4 OR DFHPF8
  9014*            GO TO 7900-PRINT-LETTER-NOW
  9015*        ELSE
  9016             GO TO 1000-SHOW.
  9017
  9018     IF  NOT MODIFY-CAP
  9019         MOVE 'UPDATE'           TO SM-READ
  9020         PERFORM 9995-SECURITY-VIOLATION
  9021         MOVE ER-0070            TO EMI-ERROR
  9022         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9023         MOVE -1                 TO MAINTL
  9024         GO TO 8100-SEND-INITIAL-MAP.
  9025
  9026     IF  W-FORM-CHANGED
  9027             OR
  9028         W-KEY-FIELDS-CHANGED
  9029         GO TO 0330-EDIT.
  9030
  9031     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  9032
  9033
  9034*    IF  EIBAID EQUAL DFHPF3
  9035*        IF  PI-NO-CARRIER-SECURITY
  9036*                AND
  9037*            PI-NO-ACCOUNT-SECURITY
  9038*            GO TO 5000-EDIT-MODE.
  9039
  9040     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  9041         IF  PI-NO-CARRIER-SECURITY
  9042                 AND
  9043             PI-NO-ACCOUNT-SECURITY
  9044             GO TO 5400-LETTER-RELEASE
  9045         ELSE
  9046             IF  PI-689-PRINT-PERFORMED
  9047                 GO TO 5400-LETTER-RELEASE
  9048             ELSE
  9049                 MOVE AL-UNBON TO ENTERPFA
  9050                 MOVE -1       TO ENTERPFL
  9051                 MOVE ER-2398  TO EMI-ERROR
  9052                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9053                 GO TO 8200-SEND-DATAONLY.
  9054
  9055*    IF  EIBAID = DFHPF4 OR DFHPF8
  9056*        GO TO 7900-PRINT-LETTER-NOW.
  9057
  9058 0330-EDIT.
  9059
  9060     IF  W-SC-TEXTL (1) NOT EQUAL ZEROS
  9061             OR
  9062         W-SC-TEXTL (2) NOT EQUAL ZEROS
  9063             OR
  9064         W-SC-TEXTL (3) NOT EQUAL ZEROS
  9065             OR
  9066         W-SC-TEXTL (4) NOT EQUAL ZEROS
  9067             OR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 173
* EL689.cbl
  9068         W-SC-TEXTL (5) NOT EQUAL ZEROS
  9069             OR
  9070         W-SC-TEXTL (6) NOT EQUAL ZEROS
  9071             OR
  9072         W-SC-TEXTL (7) NOT EQUAL ZEROS
  9073             OR
  9074         W-SC-TEXTL (8) NOT EQUAL ZEROS
  9075             OR
  9076         W-SC-TEXTL (9) NOT EQUAL ZEROS
  9077             OR
  9078         W-SC-TEXTL (10) NOT EQUAL ZEROS
  9079             OR
  9080         W-SC-TEXTL (11) NOT EQUAL ZEROS
  9081         IF  W-KEY-FIELDS-CHANGED
  9082                 OR
  9083             W-FORM-CHANGED
  9084             MOVE ER-7250        TO EMI-ERROR
  9085             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9086             MOVE -1             TO MAINTL
  9087             MOVE AL-UABON       TO MAINTA
  9088         ELSE
  9089             PERFORM 4100-SET-NDX THRU 4100-EXIT
  9090             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
  9091                     VARYING
  9092                 W-SC-NDX FROM 1 BY 1
  9093                     UNTIL
  9094                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
  9095             MOVE ER-7398        TO EMI-ERROR
  9096             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9097             MOVE -1             TO MAINTL
  9098             MOVE AL-UABON       TO MAINTA
  9099             GO TO 8200-SEND-DATAONLY.
  9100
  9101     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  9102
  9103     IF  W-KEY-FIELDS-CHANGED
  9104             OR
  9105         PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  9106         PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  9107         IF  MAINTI EQUAL 'C'
  9108             GO TO 2000-CREATE
  9109         ELSE
  9110             NEXT SENTENCE
  9111     ELSE
  9112         IF  W-FORM-CHANGED
  9113             PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  9114             IF  MAINTI EQUAL 'C'
  9115                 GO TO 2000-CREATE
  9116             ELSE
  9117                 NEXT SENTENCE
  9118         ELSE
  9119             MOVE -1             TO MAINTL
  9120             GO TO 8200-SEND-DATAONLY.
  9121
  9122     MOVE ER-0023                TO EMI-ERROR.
  9123     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9124     MOVE -1                     TO MAINTL.
  9125     MOVE AL-UABON               TO MAINTA.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 174
* EL689.cbl
  9126     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 175
* EL689.cbl
  9128 0350-EDIT-ROUTINE.
  9129
  9130     IF  MAINTI EQUAL 'C'
  9131             AND
  9132         FORML EQUAL ZEROS
  9133         MOVE -1                 TO FORML
  9134         MOVE ER-0177            TO EMI-ERROR
  9135         MOVE AL-UABON           TO FORMA
  9136         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9137
  9138     IF PRTNOWL > ZEROS
  9139        IF PRTNOWI = 'Y' OR 'N' OR 'P' OR ' '
  9140           MOVE PRTNOWI          TO PI-PRINT-NOW
  9141           MOVE AL-UANON         TO PRTNOWA
  9142        END-IF
  9143     END-IF
  9144     IF ENDARCHL > ZEROS
  9145        IF ENDARCHI NUMERIC
  9146            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
  9147            MOVE AL-UNNON       TO ENDARCHA
  9148            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
  9149            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
  9150            MOVE 'N'            TO W-VALID-ENDT-SW
  9151            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
  9152            IF NOT W-VALID-ENDT
  9153                MOVE -1         TO ENDARCHL
  9154                MOVE ER-1565    TO EMI-ERROR
  9155                MOVE AL-UNBON   TO ENDARCHA
  9156                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9157            END-IF
  9158        END-IF
  9159     ELSE
  9160        MOVE ZEROS              TO PI-ENDT-ARCH-NO
  9161     END-IF
  9162     MOVE SPACES                 TO PI-689-PRINT-RESTRICTION
  9163*    IF  PRTRESTL NOT EQUAL ZEROS
  9164*        PERFORM 0360-EDIT-PRINT-RESTRICTIONS THRU 0360-EXIT.
  9165
  9166     IF  FOLLOWL NOT EQUAL ZEROS
  9167         MOVE FOLLOWI            TO W-DEEDIT-FIELD
  9168         PERFORM 8600-DEEDIT
  9169         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9170         MOVE '4'                TO DC-OPTION-CODE
  9171         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9172         IF  DATE-CONVERSION-ERROR
  9173             MOVE ER-0182        TO EMI-ERROR
  9174             MOVE -1             TO FOLLOWL
  9175             MOVE AL-UABON       TO FOLLOWA
  9176             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9177         ELSE
  9178             MOVE DC-GREG-DATE-1-EDIT
  9179                                 TO FOLLOWO
  9180                                    PI-689-FOLLOW-UP-EDIT
  9181             MOVE AL-UANON       TO FOLLOWA
  9182             MOVE DC-BIN-DATE-1  TO PI-689-FOLLOW-UP-DATE
  9183     ELSE
  9184         MOVE LOW-VALUES         TO PI-689-FOLLOW-UP-DATE.
  9185
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 176
* EL689.cbl
  9186     IF  PI-689-FOLLOW-UP-DATE NOT EQUAL LOW-VALUES
  9187         IF  PI-689-FOLLOW-UP-DATE LESS THAN
  9188                 W-SAVE-BIN-DATE
  9189             MOVE ER-0533        TO EMI-ERROR
  9190             MOVE AL-UABON       TO FOLLOWA
  9191             MOVE -1             TO FOLLOWL
  9192             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9193
  9194     IF  RESEND1L NOT EQUAL ZEROS
  9195         MOVE RESEND1I           TO W-DEEDIT-FIELD
  9196         PERFORM 8600-DEEDIT
  9197         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9198         MOVE '4'                TO DC-OPTION-CODE
  9199         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9200         IF  DATE-CONVERSION-ERROR
  9201             MOVE ER-0185        TO EMI-ERROR
  9202             MOVE -1             TO RESEND1L
  9203             MOVE AL-UABON       TO RESEND1A
  9204             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9205         ELSE
  9206             MOVE DC-GREG-DATE-1-EDIT
  9207                                 TO RESEND1O
  9208                                    PI-689-RESEND1-EDIT
  9209             MOVE AL-UANON       TO RESEND1A
  9210             MOVE DC-BIN-DATE-1  TO PI-689-RESEND-DATE-1
  9211     ELSE
  9212         MOVE LOW-VALUES         TO PI-689-RESEND-DATE-1.
  9213
  9214     IF  PI-689-RESEND-DATE-1 NOT EQUAL LOW-VALUES
  9215         IF  PI-689-RESEND-DATE-1 NOT GREATER THAN
  9216                 W-SAVE-BIN-DATE
  9217             MOVE ER-0537        TO EMI-ERROR
  9218             MOVE AL-UABON       TO RESEND1A
  9219             MOVE -1             TO RESEND1L
  9220             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9221
  9222     IF ENCL > ZEROS
  9223        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  9224                                          PI-ENCLOSURE-CD
  9225        MOVE SPACES             TO W-ELENCC-KEY
  9226        MOVE PI-COMPANY-CD      TO W-ENCC-COMPANY-CD
  9227        MOVE '2'                TO W-ENCC-REC-TYPE
  9228        MOVE ENCI               TO W-ENCC-ENC-CODE
  9229
  9230
  9231* EXEC CICS READ
  9232*           DATASET    (W-ENCC-FILE-ID)
  9233*           SET        (ADDRESS OF ENCLOSURE-CODES)
  9234*           RIDFLD     (W-ELENCC-KEY)
  9235*           RESP       (W-RESPONSE)
  9236*       END-EXEC
  9237*    MOVE '&"S        E          (  N#00009076' TO DFHEIV0
  9238     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9239     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9240     MOVE X'204E233030303039303736' TO DFHEIV0(25:11)
  9241     CALL 'kxdfhei1' USING DFHEIV0,
  9242           W-ENCC-FILE-ID,
  9243           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 177
* EL689.cbl
  9244           DFHEIV99,
  9245           W-ELENCC-KEY,
  9246           DFHEIV99,
  9247           DFHEIV99,
  9248           DFHEIV99
  9249     SET ADDRESS OF ENCLOSURE-CODES TO
  9250         DFHEIV20
  9251     MOVE EIBRESP  TO W-RESPONSE
  9252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9253
  9254        IF RESP-NORMAL
  9255           MOVE ENCI             TO PI-ENCLOSURE-CD
  9256                                    W-ENCLOSURE-CD
  9257           MOVE AL-UANON         TO ENCA
  9258        ELSE
  9259           MOVE ER-1560          TO EMI-ERROR
  9260           MOVE -1               TO ENCL
  9261           MOVE AL-UABON         TO ENCA
  9262           PERFORM 9900-ERROR-FORMAT
  9263                                 THRU 9900-EXIT
  9264        END-IF
  9265     END-IF
  9266
  9267
  9268     IF NOT PI-CREATE-LABELS
  9269         MOVE PI-LABEL-CONTROL   TO ADDRLBLI
  9270         MOVE AL-PANON           TO ADDRLBLA
  9271         GO TO 0350-BYPASS-OVERRIDE.
  9272
  9273     IF  ADDRLBLL GREATER THAN ZEROS
  9274          INSPECT ADDRLBLI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9275          IF ADDRLBLI = 'N' OR 'Y'
  9276              MOVE ADDRLBLI      TO PI-689-LBL-OVERRIDE
  9277              MOVE AL-UANON      TO ADDRLBLA
  9278          ELSE
  9279             MOVE ER-3783        TO EMI-ERROR
  9280             MOVE -1             TO ADDRLBLL
  9281             MOVE AL-UABON       TO ADDRLBLA
  9282             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9283
  9284 0350-BYPASS-OVERRIDE.
  9285
  9286     IF  PI-BYPASS-LABELS
  9287             OR
  9288         FORMI EQUAL '9999'
  9289             OR
  9290         PI-689-LABELS-OVERRIDEN
  9291         MOVE SPACES             TO PI-689-LABEL-SOURCE
  9292         MOVE LOW-VALUES         TO ADDRSI
  9293         MOVE AL-UANOF           TO ADDRSA
  9294         MOVE ZEROS              TO ADDRSL
  9295     ELSE
  9296         IF  ADDRSL GREATER THAN ZEROS
  9297             MOVE ADDRSI         TO W-LABEL-SOURCE
  9298             IF  W-LABEL-SOURCE-VALID
  9299                 MOVE ADDRSI     TO PI-689-LABEL-SOURCE
  9300             ELSE
  9301                 MOVE -1         TO ADDRSL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 178
* EL689.cbl
  9302                 MOVE ER-0176    TO EMI-ERROR
  9303                 MOVE AL-UABON   TO ADDRSA
  9304                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9305         ELSE
  9306             IF  MAINTI EQUAL 'C'
  9307                 MOVE -1         TO ADDRSL
  9308                 MOVE ER-0176    TO EMI-ERROR
  9309                 MOVE AL-UABON   TO ADDRSA
  9310                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9311
  9312     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  9313     IF  PRINTERL GREATER ZERO
  9314         INSPECT PRINTERI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9315         MOVE AL-UANON           TO PRINTERA
  9316         MOVE PRINTERI           TO PI-689-ALT-PRINTER-ID
  9317                                    PI-ALT-DMD-PRT-ID
  9318     ELSE
  9319         IF  PI-NO-CARRIER-SECURITY
  9320                 AND
  9321             PI-NO-ACCOUNT-SECURITY
  9322             IF  PI-PROCESSOR-PRINTER GREATER THAN SPACES
  9323                 MOVE PI-PROCESSOR-PRINTER
  9324                                 TO PI-689-ALT-PRINTER-ID
  9325                                    PRINTERI
  9326                 MOVE AL-UABON   TO PRINTERA
  9327             ELSE
  9328                 MOVE PI-COMPANY-ID
  9329                                 TO W-CNTL-COMPANY-ID
  9330                 MOVE '1'        TO W-CNTL-RECORD-TYPE
  9331                 MOVE SPACES     TO W-CNTL-GENL
  9332                 MOVE ZEROS      TO W-CNTL-SEQ-NO
  9333
  9334* EXEC CICS HANDLE CONDITION
  9335*                     NOTOPEN    (8040-CNTL-NOT-OPEN)
  9336*                     NOTFND     (7945-NOT-FOUND)
  9337*                END-EXEC
  9338*    MOVE '"$JI                  ! $ #00009162' TO DFHEIV0
  9339     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9340     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9341     MOVE X'2420233030303039313632' TO DFHEIV0(25:11)
  9342     CALL 'kxdfhei1' USING DFHEIV0
  9343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9344
  9345* EXEC CICS READ
  9346*                     DATASET    (W-CNTL-FILE-ID)
  9347*                     SET        (ADDRESS OF CONTROL-FILE)
  9348*                     RIDFLD     (W-CNTL-KEY)
  9349*                END-EXEC
  9350*    MOVE '&"S        E          (   #00009166' TO DFHEIV0
  9351     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9352     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9353     MOVE X'2020233030303039313636' TO DFHEIV0(25:11)
  9354     CALL 'kxdfhei1' USING DFHEIV0,
  9355           W-CNTL-FILE-ID,
  9356           DFHEIV20,
  9357           DFHEIV99,
  9358           W-CNTL-KEY,
  9359           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 179
* EL689.cbl
  9360           DFHEIV99,
  9361           DFHEIV99
  9362     SET ADDRESS OF CONTROL-FILE TO
  9363         DFHEIV20
  9364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9365                 MOVE CF-FORMS-PRINTER-ID
  9366                                 TO PI-689-ALT-PRINTER-ID
  9367                                    PRINTERI
  9368                                    W-TS-TERM-TEXT
  9369                 MOVE AL-UABON   TO PRINTERA
  9370         ELSE
  9371             MOVE AL-UABON       TO PRINTERA
  9372             MOVE -1             TO PRINTERL
  9373             MOVE ER-9283        TO EMI-ERROR
  9374             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9375
  9376     IF  COPIESL NOT EQUAL ZEROS
  9377         IF  COPIESI NOT NUMERIC
  9378                 OR
  9379             COPIESI EQUAL '0'
  9380             MOVE ER-0184        TO EMI-ERROR
  9381             MOVE -1             TO COPIESL
  9382             MOVE AL-UABON       TO COPIESA
  9383             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9384         ELSE
  9385             MOVE COPIESI        TO PI-689-NUMBER-COPIES
  9386             MOVE AL-UANON       TO COPIESA
  9387     ELSE
  9388         IF FORMI EQUAL '9999'
  9389             MOVE 1              TO PI-689-NUMBER-COPIES
  9390                                    COPIESL
  9391                                    COPIESO.
  9392
  9393     IF  FORML NOT EQUAL ZEROS
  9394         INSPECT FORMI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9395         MOVE FORMI              TO PI-689-FORM-NUMBER.
  9396
  9397     MOVE SPACES                 TO W-HOLD-IND.
  9398
  9399     IF PI-CERT-REQ-IND = 'Y'
  9400       IF  CERTIDL NOT EQUAL ZEROS
  9401         IF CERTIDI NUMERIC
  9402             MOVE AL-UANON      TO CERTIDA
  9403             MOVE CERTIDI       TO PI-CERT-FORM-ID
  9404         ELSE
  9405             MOVE ER-1778       TO EMI-ERROR
  9406             MOVE -1            TO CERTIDL
  9407             MOVE AL-UABON      TO CERTIDA
  9408             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9409         END-IF
  9410       ELSE
  9411          MOVE ER-0715       TO EMI-ERROR
  9412          MOVE -1            TO CERTIDL
  9413          MOVE AL-UABON      TO CERTIDA
  9414          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9415       END-IF
  9416     END-IF.
  9417
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 180
* EL689.cbl
  9418     IF PI-REASON-REQ-IND = 'Y'
  9419        IF PI-ENDT-ARCH-NO NOT > ZERO
  9420          MOVE ER-9840       TO EMI-ERROR
  9421          MOVE -1            TO FORML
  9422          MOVE AL-UABON      TO FORMA
  9423          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9424        END-IF
  9425     END-IF.
  9426
  9427     IF  NOT EMI-NO-ERRORS
  9428         IF  EMI-ERROR EQUAL ER-7250
  9429             GO TO 0350-EXIT
  9430         ELSE
  9431            MOVE -1             TO MAINTL
  9432            GO TO 8200-SEND-DATAONLY.
  9433
  9434 0350-EXIT.
  9435      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 181
* EL689.cbl
  9437 0355-CHECK-ERENDT.
  9438
  9439*     EXEC CICS GETMAIN
  9440*          SET      (ADDRESS OF ENDORSEMENT-RECORD)
  9441*          LENGTH   (W-ENDT-LENGTH)
  9442*     END-EXEC
  9443
  9444
  9445* EXEC CICS READ
  9446*         DATASET    ('ERENDT2')
  9447*         SET        (ADDRESS OF ENDORSEMENT-RECORD)
  9448*         RIDFLD     (W-ERENDT-KEY-BY-ARCH)
  9449*         RESP       (W-RESPONSE)
  9450*    END-EXEC
  9451     MOVE 'ERENDT2' TO DFHEIV1
  9452*    MOVE '&"S        E          (  N#00009250' TO DFHEIV0
  9453     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9454     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9455     MOVE X'204E233030303039323530' TO DFHEIV0(25:11)
  9456     CALL 'kxdfhei1' USING DFHEIV0,
  9457           DFHEIV1,
  9458           DFHEIV20,
  9459           DFHEIV99,
  9460           W-ERENDT-KEY-BY-ARCH,
  9461           DFHEIV99,
  9462           DFHEIV99,
  9463           DFHEIV99
  9464     SET ADDRESS OF ENDORSEMENT-RECORD TO
  9465         DFHEIV20
  9466     MOVE EIBRESP  TO W-RESPONSE
  9467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9468
  9469     IF (RESP-NORMAL)
  9470         IF PI-RETURN-TO-PROGRAM EQUAL 'EL6311'  AND
  9471            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9472            EN-CARRIER     =  PI-689-CARRIER     AND
  9473            EN-GROUPING    =  PI-689-GROUPING    AND
  9474            EN-STATE       =  PI-689-STATE       AND
  9475            EN-ACCOUNT     =  PI-689-ACCOUNT     AND
  9476            EN-CERT-EFF-DT =  PI-689-EFF-DATE    AND
  9477            EN-CERT-NO     =  PI-689-CERT-NO
  9478               SET W-VALID-ENDT TO TRUE
  9479         END-IF
  9480         IF PI-RETURN-TO-PROGRAM EQUAL 'EL1273'  AND
  9481            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9482            EN-CARRIER     =  PI-CARRIER         AND
  9483            EN-GROUPING    =  PI-GROUPING        AND
  9484            EN-STATE       =  PI-STATE           AND
  9485            EN-ACCOUNT     =  PI-ACCOUNT         AND
  9486            EN-CERT-EFF-DT =  PI-CERT-EFF-DT     AND
  9487            EN-CERT-NO     =  PI-CERT-NO
  9488               SET W-VALID-ENDT TO TRUE
  9489         END-IF
  9490     END-IF
  9491      .
  9492
  9493 0355-EXIT.
  9494      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 182
* EL689.cbl
  9496 0360-EDIT-PRINT-RESTRICTIONS.
  9497
  9498*    INSPECT PRTRESTI CONVERTING W-LOWER-CASE
  9499*                                TO W-UPPER-CASE.
  9500*
  9501*    IF  (PI-689-PRINT-RESTRICTION EQUAL ' ' OR 'F'
  9502*                                     OR 'P' OR LOW-VALUES)
  9503*            AND
  9504*        PRTRESTI EQUAL 'C'
  9505*            AND
  9506*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9507*        MOVE ER-7243            TO EMI-ERROR
  9508*        MOVE -1                 TO PRTRESTL
  9509*        MOVE AL-UABON           TO PRTRESTA
  9510*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9511*        GO TO 0360-EXIT.
  9512*
  9513*    IF  PRTRESTL NOT EQUAL ZEROS
  9514*        IF PRTRESTI = 'C' OR 'F' OR 'P'
  9515*            MOVE PRTRESTI       TO PI-689-PRINT-RESTRICTION
  9516*            MOVE AL-UANON       TO PRTRESTA
  9517*        ELSE
  9518*            IF  PRTRESTI EQUAL ' '
  9519*                MOVE SPACES     TO PI-689-PRINT-RESTRICTION
  9520*                MOVE AL-UANON   TO PRTRESTA
  9521*            ELSE
  9522*                MOVE ER-7393    TO EMI-ERROR
  9523*                MOVE -1         TO PRTRESTL
  9524*                MOVE AL-UABON   TO PRTRESTA
  9525*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9526*
  9527*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
  9528*            AND
  9529*        W-HOLD-ON
  9530*            AND
  9531*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9532*        MOVE ER-7243            TO EMI-ERROR
  9533*        MOVE -1                 TO PRTRESTL
  9534*        MOVE AL-UABON           TO PRTRESTA
  9535*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9536     .
  9537 0360-EXIT.
  9538      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 183
* EL689.cbl
  9540 0400-EL6311-INCOMING.
  9541
  9542     MOVE ZEROS                  TO PI-CURRENT-LINE
  9543                                    PI-TEMP-STOR-ITEMS
  9544                                    PI-TOTAL-LINES
  9545                                    PI-UPDATE-SW
  9546                                    PI-689-NUMBER-LABEL-LINES
  9547                                    PI-689-ERROR
  9548                                    PI-689-NUMBER-TEXT-RECORDS.
  9549     MOVE SPACES                 TO PI-689-PRINT-SW
  9550                                    PI-689-ALT-PRINTER-ID
  9551                                    PI-COMM-CONTROL
  9552                                    PI-689-FORM-NUMBER
  9553                                    PI-689-TEMP-STOR-ID
  9554                                    PI-689-LABEL-SOURCE
  9555                                    PI-689-USE-SCREEN-IND.
  9556
  9557     IF PI-CREATE-LABELS
  9558         MOVE  AL-UANON          TO ADDRLBLA
  9559         MOVE  +1                TO ADDRLBLL.
  9560
  9561     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9562                                    PI-689-LBL-OVERRIDE.
  9563
  9564     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  9565     MOVE '2'                    TO PI-ACTION.
  9566     MOVE -1                     TO MAINTL.
  9567
  9568     MOVE AL-UANON               TO PRTNOWA.
  9569     MOVE +1                     TO PRTNOWL.
  9570     MOVE 'N'                    TO PRTNOWI
  9571                                    PI-PRINT-NOW.
  9572
  9573     IF  PI-689-CARRIER NOT EQUAL LOW-VALUES
  9574         MOVE AL-UANON           TO CARRIERA
  9575         MOVE +1                 TO CARRIERL
  9576         MOVE PI-689-CARRIER     TO CARRIERI.
  9577
  9578     IF  PI-689-GROUPING NOT EQUAL LOW-VALUES
  9579         MOVE +6                 TO GROUPL
  9580         MOVE AL-UANON           TO GROUPA
  9581         MOVE PI-689-GROUPING    TO GROUPI.
  9582
  9583     IF  PI-689-STATE NOT EQUAL LOW-VALUES
  9584         MOVE +2                 TO STATEL
  9585         MOVE AL-UANON           TO STATEA
  9586         MOVE PI-689-STATE       TO STATEI.
  9587
  9588     IF  PI-689-ACCOUNT NOT EQUAL LOW-VALUES
  9589         MOVE +10                TO ACCTL
  9590         MOVE AL-UANON           TO ACCTA
  9591         MOVE PI-689-ACCOUNT     TO ACCTI.
  9592
  9593     IF  PI-689-CERT-PRIME NOT EQUAL LOW-VALUES
  9594         MOVE +10                TO CERTL
  9595         MOVE AL-UANON           TO CERTA
  9596         MOVE PI-689-CERT-PRIME  TO CERTI.
  9597
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 184
* EL689.cbl
  9598     IF  PI-689-CERT-SFX NOT EQUAL LOW-VALUES
  9599         MOVE +1                 TO SFXL
  9600         MOVE AL-UANON           TO SFXA
  9601         MOVE PI-689-CERT-SFX    TO SFXI.
  9602
  9603     IF  PI-689-ENTRY-BATCH NOT EQUAL LOW-VALUES
  9604         MOVE +6                 TO BENTRYL
  9605         MOVE AL-UANON           TO BENTRYA
  9606         MOVE PI-689-ENTRY-BATCH TO BENTRYI.
  9607
  9608     MOVE +4                     TO BCSEQL.
  9609     MOVE AL-UANON               TO BCSEQA.
  9610     MOVE PI-689-CHG-SEQ-NO      TO BCSEQI.
  9611
  9612     IF  PI-689-SEQ-NO NOT EQUAL ZEROS
  9613         MOVE +8                 TO SEQL
  9614         MOVE AL-UANON           TO SEQA
  9615         MOVE PI-689-SEQ-NO      TO SEQI.
  9616
  9617     IF  PI-689-EFF-DATE NOT EQUAL LOW-VALUES
  9618         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  9619         MOVE ' '                TO DC-OPTION-CODE
  9620         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9621         MOVE +8                 TO DATEL
  9622         MOVE DC-GREG-DATE-1-EDIT
  9623                                 TO DATEI
  9624         MOVE AL-UANON           TO DATEA.
  9625
  9626     MOVE -1                     TO MAINTL.
  9627     MOVE '4'                    TO DATASORI
  9628                                    PI-689-DATA-SOURCE.
  9629     MOVE +1                     TO DATASORL.
  9630     MOVE AL-UANON               TO DATASORA.
  9631
  9632     GO TO 8100-SEND-INITIAL-MAP.
  9633
  9634 0400-EXIT.
  9635      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 185
* EL689.cbl
  9637 0450-SPECIAL-INPUT-PROCESS.
  9638
  9639     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  9640             AND
  9641         PI-CARRIER GREATER THAN LOW-VALUES
  9642         MOVE '1'                TO DATASORI
  9643                                    PI-689-DATA-SOURCE
  9644         MOVE PI-CARRIER         TO CARRIERI
  9645         MOVE PI-GROUPING        TO GROUPI
  9646         MOVE PI-STATE           TO STATEI
  9647         MOVE PI-ACCOUNT         TO ACCTI
  9648         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  9649         MOVE ' '                TO DC-OPTION-CODE
  9650         PERFORM 9500-LINK-DATE-CONVERT
  9651             THRU 9500-EXIT
  9652         MOVE DC-GREG-DATE-1-EDIT
  9653                                 TO DATEI
  9654         MOVE 'N'                TO PRTNOWI
  9655                                    PI-PRINT-NOW
  9656         MOVE AL-UANON           TO ACCTA
  9657                                    CARRIERA
  9658                                    DATEA
  9659                                    DATASORA
  9660                                    GROUPA
  9661                                    STATEA
  9662                                    PRTNOWA
  9663         MOVE +1                 TO CARRIERL
  9664                                    DATASORL
  9665                                    PRTNOWL
  9666         MOVE -1                 TO MAINTL
  9667         MOVE +6                 TO GROUPL
  9668         MOVE +2                 TO STATEL
  9669         MOVE +8                 TO DATEL
  9670         MOVE +10                TO ACCTL
  9671     ELSE
  9672         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  9673                 AND
  9674             PI-CARRIER GREATER THAN LOW-VALUES
  9675             MOVE '3'            TO DATASORI
  9676                                    PI-689-DATA-SOURCE
  9677             MOVE PI-CR-CARRIER  TO CARRIERI
  9678             MOVE PI-CR-GROUPING TO GROUPI
  9679             MOVE PI-CR-ACCOUNT  TO ACCTI
  9680             MOVE PI-CR-FIN-RESP TO RPERSONI
  9681             MOVE PI-CR-TYPE     TO TYPEI
  9682             MOVE 'N'            TO PRTNOWI
  9683                                    PI-PRINT-NOW
  9684             MOVE AL-UANON       TO CARRIERA
  9685                                    GROUPA
  9686                                    ACCTA
  9687                                    DATASORA
  9688                                    RPERSONA
  9689                                    TYPEA
  9690                                    PRTNOWA
  9691             MOVE +1             TO CARRIERL
  9692                                    DATASORL
  9693                                    TYPEL
  9694                                    PRTNOWL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 186
* EL689.cbl
  9695             MOVE -1             TO MAINTL
  9696             MOVE +6             TO GROUPL
  9697             MOVE +10            TO ACCTL
  9698                                    RPERSONL
  9699         ELSE
  9700             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  9701                     AND
  9702                 PI-CARRIER GREATER THAN LOW-VALUES
  9703                 MOVE '2'        TO DATASORI
  9704                                    PI-689-DATA-SOURCE
  9705                 MOVE PI-CARRIER TO CARRIERI
  9706                 MOVE PI-GROUPING
  9707                                 TO GROUPI
  9708                 MOVE PI-STATE   TO STATEI
  9709                 MOVE PI-ACCOUNT TO ACCTI
  9710                 MOVE PI-CERT-PRIME
  9711                                 TO CERTI
  9712                 MOVE PI-CERT-SFX
  9713                                 TO SFXI
  9714                 MOVE PI-CERT-EFF-DT
  9715                                 TO DC-BIN-DATE-1
  9716                 MOVE ' '        TO DC-OPTION-CODE
  9717                 PERFORM 9500-LINK-DATE-CONVERT
  9718                     THRU 9500-EXIT
  9719                 MOVE DC-GREG-DATE-1-EDIT
  9720                                 TO DATEI
  9721                 MOVE 'N'        TO PRTNOWI
  9722                                    PI-PRINT-NOW
  9723                 MOVE AL-UANON   TO CARRIERA
  9724                                    GROUPA
  9725                                    STATEA
  9726                                    ACCTA
  9727                                    CERTA
  9728                                    SFXA
  9729                                    DATEA
  9730                                    ADDRSA
  9731                                    DATASORA
  9732                                    PRTNOWA
  9733                 MOVE +1         TO CARRIERL
  9734                                    SFXL
  9735                                    DATASORL
  9736                                    ADDRSL
  9737                                    PRTNOWL
  9738                 MOVE -1         TO MAINTL
  9739                 MOVE +6         TO GROUPL
  9740                 MOVE +2         TO STATEL
  9741                 MOVE +8         TO DATEL
  9742                 MOVE +10        TO ACCTL
  9743                                    CERTL.
  9744
  9745     IF PI-CREATE-LABELS
  9746         MOVE  AL-UANON          TO ADDRLBLA
  9747         MOVE  +1                TO ADDRLBLL.
  9748
  9749     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9750                                    PI-689-LBL-OVERRIDE.
  9751
  9752     MOVE LOW-VALUES             TO PI-689-KEY-DATA-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 187
* EL689.cbl
  9753     GO TO 8100-SEND-INITIAL-MAP.
  9754
  9755 0450-EXIT.
  9756      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 188
* EL689.cbl
  9758 0600-BYPASS-SCREEN-CNTL.
  9759***************************************************************
  9760*     THIS ROUTINE WILL PROCESS A NEW LETTER REQUIREMENT      *
  9761*     WITH THE INFORMATION FOUND IN THE PI AREA WITHOUT       *
  9762*     PERFORMING ANY SCREEN IO.                               *
  9763***************************************************************
  9764
  9765
  9766* EXEC CICS HANDLE CONDITION
  9767*        PGMIDERR (9700-PGMID-ERROR)
  9768*        MAPFAIL  (0325-MAPFAIL)
  9769*        ERROR    (9800-ABEND)
  9770*    END-EXEC.
  9771*    MOVE '"$L?.                 ! % #00009553' TO DFHEIV0
  9772     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  9773     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9774     MOVE X'2520233030303039353533' TO DFHEIV0(25:11)
  9775     CALL 'kxdfhei1' USING DFHEIV0
  9776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9777
  9778
  9779     MOVE LOW-VALUES             TO EL689AI.
  9780
  9781     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM
  9782
  9783     MOVE PI-689-FORM-NUMBER     TO FORMI.
  9784     MOVE +4                     TO FORML.
  9785
  9786     IF  PI-689-NUMBER-COPIES GREATER THAN ZERO
  9787         MOVE PI-689-NUMBER-COPIES
  9788                                 TO COPIESI
  9789         MOVE +1                 TO COPIESL.
  9790
  9791     MOVE PI-689-LABEL-SOURCE    TO ADDRSI.
  9792     MOVE +1                     TO ADDRSL.
  9793     MOVE PI-689-DATA-SOURCE     TO DATASORI.
  9794     MOVE +1                     TO DATASORL.
  9795
  9796*    IF  PI-689-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  9797*        MOVE PI-689-PRINT-RESTRICTION
  9798*                                TO PRTRESTI
  9799*        MOVE +1                 TO PRTRESTL.
  9800
  9801     MOVE SPACES                 TO PI-689-PRINT-SW
  9802                                    PI-689-LBL-OVERRIDE.
  9803     MOVE ZEROS                  TO PI-TOTAL-LINES
  9804                                    PI-CURRENT-LINE
  9805                                    PI-TEMP-STOR-ITEMS
  9806                                    PI-UPDATE-SW
  9807                                    PI-689-ERROR
  9808                                    PI-689-NUMBER-LABEL-LINES
  9809                                    PI-689-NUMBER-TEXT-RECORDS.
  9810
  9811     IF  PI-689-ALT-PRINTER-ID NOT EQUAL LOW-VALUES
  9812         MOVE +4                 TO PRINTERL
  9813         MOVE PI-689-ALT-PRINTER-ID
  9814                                 TO PRINTERI PI-ALT-DMD-PRT-ID.
  9815
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 189
* EL689.cbl
  9816     MOVE SPACES                 TO PI-689-ALT-PRINTER-ID.
  9817
  9818     IF  PI-689-SOURCE-VARIABLE
  9819         PERFORM 0700-GET-VARIABLE-LABEL THRU 0700-EXIT.
  9820
  9821     MOVE SPACES                 TO W-CNTL-KEY
  9822     MOVE LOW-VALUES             TO W-ACCT-KEY
  9823                                    W-CERT-KEY
  9824                                    W-CHEK-KEY
  9825                                    W-COMP-KEY
  9826                                    W-MAIL-KEY
  9827                                    W-PNDB-KEY
  9828                                    W-PNDB2-KEY
  9829                                    W-PYAJ-KEY.
  9830
  9831     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9832     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9833                                    W-CERT-COMPANY-CD
  9834                                    W-CHEK-COMPANY-CD
  9835                                    W-COMP-COMPANY-CD
  9836                                    W-MAIL-COMPANY-CD
  9837                                    W-PNDB-COMPANY-CD
  9838                                    W-PNDB2-COMPANY-CD
  9839                                    W-PYAJ-COMPANY-CD.
  9840
  9841     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
  9842         MOVE PI-689-CARRIER     TO W-ACCT-CARRIER
  9843                                    W-CERT-CARRIER
  9844                                    W-MAIL-CARRIER
  9845                                    W-CERT-CARRIER
  9846                                    W-COMP-CARRIER
  9847                                    W-CHEK-CARRIER
  9848                                    W-PNDB2-CARRIER
  9849                                    W-PYAJ-CARRIER.
  9850
  9851     IF  PI-689-GROUPING GREATER THAN LOW-VALUES
  9852         MOVE PI-689-GROUPING    TO W-ACCT-GROUPING
  9853                                    W-CERT-GROUPING
  9854                                    W-CHEK-GROUPING
  9855                                    W-COMP-GROUPING
  9856                                    W-MAIL-GROUPING
  9857                                    W-PNDB2-GROUPING
  9858                                    W-PYAJ-GROUPING.
  9859
  9860     IF  PI-689-STATE GREATER THAN LOW-VALUES
  9861         MOVE PI-689-STATE       TO W-ACCT-STATE
  9862                                    W-CERT-STATE
  9863                                    W-CHEK-STATE
  9864                                    W-MAIL-STATE
  9865                                    W-PNDB2-STATE.
  9866
  9867     IF  PI-689-ACCOUNT GREATER THAN LOW-VALUES
  9868         IF PI-689-DATA-SOURCE = '3' OR '6'
  9869             MOVE PI-689-ACCOUNT TO W-COMP-ACCOUNT
  9870                                    W-PYAJ-ACCOUNT
  9871         ELSE
  9872             MOVE PI-689-ACCOUNT TO W-ACCT-ACCOUNT
  9873                                    W-CERT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 190
* EL689.cbl
  9874                                    W-CHEK-ACCOUNT
  9875                                    W-MAIL-ACCOUNT
  9876                                    W-PNDB2-ACCOUNT.
  9877
  9878     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  9879         MOVE PI-689-EFF-DATE    TO W-CERT-EFF-DT
  9880                                    W-CHEK-EFF-DT
  9881                                    W-MAIL-EFF-DT
  9882                                    W-PNDB2-EFF-DT.
  9883
  9884     IF  PI-689-CERT-PRIME GREATER THAN LOW-VALUES
  9885         MOVE PI-689-CERT-PRIME  TO W-CERT-CERT-PRIME
  9886                                    W-CHEK-CERT-PRIME
  9887                                    W-MAIL-CERT-PRIME
  9888                                    W-PNDB2-CERT-PRIME
  9889
  9890         IF  PI-689-CERT-SFX GREATER THAN LOW-VALUES
  9891             MOVE PI-689-CERT-SFX
  9892                                 TO W-CERT-CERT-SFX
  9893                                    W-CHEK-CERT-SFX
  9894                                    W-MAIL-CERT-SFX
  9895                                    W-PNDB2-CERT-SFX
  9896         ELSE
  9897             MOVE SPACES         TO W-CERT-CERT-SFX
  9898                                    W-CHEK-CERT-SFX
  9899                                    W-MAIL-CERT-SFX
  9900                                    W-PNDB2-CERT-SFX.
  9901
  9902     IF  PI-689-RESP-PERSON GREATER THAN LOW-VALUES
  9903         IF PI-689-DATA-SOURCE = '3' OR '6'
  9904             MOVE PI-689-RESP-PERSON
  9905                                 TO W-COMP-RESP-PERSON
  9906                                    W-PYAJ-FIN-RESP.
  9907
  9908     IF  PI-689-TYPE GREATER THAN LOW-VALUES
  9909         IF PI-689-DATA-SOURCE = '3' OR '6'
  9910             MOVE PI-689-TYPE    TO W-COMP-TYPE
  9911                                    W-PYAJ-RECORD-TYPE
  9912         ELSE
  9913             MOVE PI-689-TYPE    TO W-PNDB2-TYPE.
  9914
  9915     IF  PI-689-SEQ-NO GREATER THAN ZEROS
  9916         MOVE PI-689-SEQ-NO      TO W-PNDB-SEQ-NO
  9917                                    W-PYAJ-FILE-SEQ-NO
  9918                                    W-CHEK-SEQ-NO.
  9919
  9920     IF  PI-689-CHG-SEQ-NO GREATER THAN ZEROS
  9921         MOVE PI-689-CHG-SEQ-NO  TO W-PNDB-CHG-SEQ-NO
  9922                                    W-PNDB2-ALT-CHG-SEQ-NO.
  9923
  9924     IF  PI-689-ENTRY-BATCH GREATER THAN LOW-VALUES
  9925         MOVE PI-689-ENTRY-BATCH TO W-PNDB-ENTRY.
  9926
  9927     IF  PI-689-NO-ERRORS-DETECTED
  9928         PERFORM 2000-CREATE THRU 2000-EXIT
  9929         IF  NOT PI-689-FATAL-ERROR
  9930                 AND
  9931             NOT PI-689-ERR-DETECTED-PREV
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 191
* EL689.cbl
  9932             IF  PI-689-PRINT-ONLY
  9933                 PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9934             ELSE
  9935                 IF  PI-689-PRINT-FIRST
  9936                     PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9937                     IF  NOT PI-689-FATAL-ERROR
  9938                         IF  PI-689-ARCHIVE-LETTER
  9939                             PERFORM 5400-LETTER-RELEASE
  9940                                 THRU 5400-EXIT
  9941                         ELSE
  9942                             MOVE ER-7390
  9943                                 TO PI-689-ERROR
  9944                     ELSE
  9945                         NEXT SENTENCE
  9946                 ELSE
  9947                     IF  NOT PI-689-ARCHIVE-LETTER
  9948                         MOVE ER-7390
  9949                                 TO PI-689-ERROR
  9950                     ELSE
  9951                         PERFORM 5400-LETTER-RELEASE
  9952                             THRU 5400-EXIT
  9953                         IF  NOT PI-689-FATAL-ERROR
  9954                             IF  PI-689-PRINT-SECOND
  9955                                 PERFORM 7900-PRINT-LETTER-NOW
  9956                                     THRU 7900-EXIT.
  9957
  9958 0600-EXIT.
  9959     EXIT.
  9960
  9961 0620-RETURN-TO-CALLER.
  9962
  9963     MOVE PROGRAM-INTERFACE-BLOCK
  9964                                 TO DFHCOMMAREA.
  9965
  9966* EXEC CICS RETURN
  9967*    END-EXEC.
  9968*    MOVE '.(                    ''   #00009745' TO DFHEIV0
  9969     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9970     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9971     MOVE X'2020233030303039373435' TO DFHEIV0(25:11)
  9972     CALL 'kxdfhei1' USING DFHEIV0,
  9973           DFHEIV99,
  9974           DFHEIV99,
  9975           DFHEIV99,
  9976           DFHEIV99,
  9977           DFHEIV99,
  9978           DFHEIV99
  9979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9980
  9981
  9982 0700-GET-VARIABLE-LABEL.
  9983
  9984     IF  PI-689-VARIABLE-DATA-1 NOT GREATER THAN SPACES
  9985         MOVE '(VARIABLE NOT PROVIDED)'
  9986                                 TO W-RC-TEXT (1)
  9987                                    W-VG-TEXT (48)
  9988         GO TO 0700-EXIT.
  9989
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 192
* EL689.cbl
  9990     MOVE PI-689-VARIABLE-DATA-1 TO W-RC-TEXT (1)
  9991                                    W-VG-TEXT (48).
  9992     MOVE PI-689-VARIABLE-DATA-2 TO W-RC-TEXT (2)
  9993                                    W-VG-TEXT (49).
  9994     MOVE PI-689-VARIABLE-DATA-3 TO W-RC-TEXT (3)
  9995                                    W-VG-TEXT (50).
  9996     MOVE PI-689-VARIABLE-DATA-4 TO W-RC-TEXT (4)
  9997                                    W-VG-TEXT (51).
  9998     SET W-RG-NDX                TO +5.
  9999
 10000 0700-EXIT.
 10001     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 193
* EL689.cbl
 10003 0800-EDIT-KEY-FIELDS.
 10004***************************************************************
 10005*     THIS ROUTINE WILL DECIDE WHAT FIELDS ARE NECESSARY      *
 10006*     FROM THE DATA SOURCE FIELD.  IF A NECESSARY FIELD       *
 10007*     IS NOT PROVIDED AN ERROR WILL PREVENT FURTHER           *
 10008*     PROCESSING.                                             *
 10009***************************************************************
 10010     MOVE SPACES                 TO W-CNTL-KEY
 10011     MOVE LOW-VALUES             TO W-ACCT-KEY
 10012                                    W-CERT-KEY
 10013                                    W-CHEK-KEY
 10014                                    W-COMP-KEY
 10015                                    W-MAIL-KEY
 10016                                    W-PNDB-KEY
 10017                                    W-PNDB2-KEY
 10018                                    W-PYAJ-KEY.
 10019
 10020     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10021     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
 10022                                    W-CERT-COMPANY-CD
 10023                                    W-CHEK-COMPANY-CD
 10024                                    W-COMP-COMPANY-CD
 10025                                    W-MAIL-COMPANY-CD
 10026                                    W-PNDB-COMPANY-CD
 10027                                    W-PNDB2-COMPANY-CD
 10028                                    W-PYAJ-COMPANY-CD.
 10029
 10030     PERFORM 0900-EDIT-CARRIER THRU 0900-EXIT.
 10031     PERFORM 0905-EDIT-GROUPING THRU 0905-EXIT.
 10032     PERFORM 0910-EDIT-STATE THRU 0910-EXIT.
 10033     PERFORM 0915-EDIT-ACCOUNT THRU 0915-EXIT.
 10034     PERFORM 0920-EDIT-EXP-DATE THRU 0920-EXIT.
 10035     PERFORM 0925-EDIT-EFF-DATE THRU 0925-EXIT.
 10036     PERFORM 0930-EDIT-CERTIFICATE THRU 0930-EXIT.
 10037     PERFORM 0935-EDIT-RESP-PERSON THRU 0935-EXIT.
 10038     PERFORM 0940-EDIT-ACCOUNT THRU 0940-EXIT.
 10039     PERFORM 0945-EDIT-TYPE THRU 0945-EXIT.
 10040     PERFORM 0950-EDIT-ENTRY THRU 0950-EXIT.
 10041     PERFORM 0955-EDIT-SEQUENCE THRU 0955-EXIT.
 10042     PERFORM 0960-EDIT-BATCH-SEQ THRU 0960-EXIT.
 10043     PERFORM 0965-EDIT-TYPE THRU 0965-EXIT.
 10044     PERFORM 0970-EDIT-CSO THRU 0970-EXIT.
 10045
 10046     IF  DATASORI NUMERIC
 10047         MOVE DATASORI           TO W-DATA-SOURCE
 10048                                    PI-689-DATA-SOURCE
 10049         GO TO 0800-SOURCE-ACCOUNT
 10050               0800-SOURCE-CERTIFICATE
 10051               0800-SOURCE-COMPENSATION
 10052               0800-SOURCE-PENDING
 10053               0800-SOURCE-CHEK
 10054               0800-SOURCE-PAYMENTS-ADJS
 10055                                 DEPENDING ON W-DATA-SOURCE.
 10056
 10057     IF  FORMI NOT EQUAL '9999'
 10058         MOVE ER-7365            TO EMI-ERROR
 10059         MOVE -1                 TO MAINTL
 10060         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 194
* EL689.cbl
 10061         GO TO 8200-SEND-DATAONLY
 10062
 10063     ELSE
 10064         GO TO 0800-EXIT.
 10065
 10066 0800-SOURCE-ACCOUNT.
 10067
 10068     IF  W-ACCT-COMPANY-CD EQUAL LOW-VALUES
 10069             OR
 10070         W-ACCT-CARRIER EQUAL LOW-VALUES
 10071             OR
 10072         W-ACCT-GROUPING EQUAL LOW-VALUES
 10073             OR
 10074         W-ACCT-STATE EQUAL LOW-VALUES
 10075             OR
 10076         W-ACCT-ACCOUNT EQUAL LOW-VALUES
 10077             OR
 10078         W-ACCT-EXP-DT EQUAL LOW-VALUES
 10079         MOVE ER-7376            TO EMI-ERROR
 10080         MOVE -1                 TO MAINTL
 10081         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10082
 10083     GO TO 0800-ERROR-TEST.
 10084
 10085 0800-SOURCE-CERTIFICATE.
 10086
 10087     IF  W-CERT-COMPANY-CD EQUAL LOW-VALUES
 10088             OR
 10089         W-CERT-CARRIER EQUAL LOW-VALUES
 10090             OR
 10091         W-CERT-GROUPING EQUAL LOW-VALUES
 10092             OR
 10093         W-CERT-STATE EQUAL LOW-VALUES
 10094             OR
 10095         W-CERT-ACCOUNT EQUAL LOW-VALUES
 10096             OR
 10097         W-CERT-EFF-DT EQUAL LOW-VALUES
 10098             OR
 10099         W-CERT-CERT-NO EQUAL LOW-VALUES
 10100         MOVE ER-7377            TO EMI-ERROR
 10101         MOVE -1                 TO MAINTL
 10102         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10103
 10104     GO TO 0800-ERROR-TEST.
 10105
 10106 0800-SOURCE-COMPENSATION.
 10107
 10108     IF  W-COMP-COMPANY-CD EQUAL LOW-VALUES
 10109             OR
 10110         W-COMP-CARRIER EQUAL LOW-VALUES
 10111             OR
 10112         W-COMP-GROUPING EQUAL LOW-VALUES
 10113             OR
 10114         W-COMP-RESP-PERSON EQUAL LOW-VALUES
 10115             OR
 10116         W-COMP-TYPE EQUAL LOW-VALUES
 10117             OR
 10118         (W-COMP-TYPE EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 195
* EL689.cbl
 10119                 AND
 10120             W-COMP-ACCOUNT EQUAL LOW-VALUES)
 10121         MOVE ER-7378            TO EMI-ERROR
 10122         MOVE -1                 TO MAINTL
 10123         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10124
 10125     GO TO 0800-ERROR-TEST.
 10126
 10127 0800-SOURCE-PENDING.
 10128
 10129     IF  BENTRYL EQUAL ZEROS
 10130         IF  W-PNDB2-COMPANY-CD EQUAL LOW-VALUES
 10131                 OR
 10132             W-PNDB2-CARRIER EQUAL LOW-VALUES
 10133                 OR
 10134             W-PNDB2-GROUPING EQUAL LOW-VALUES
 10135                 OR
 10136             W-PNDB2-STATE EQUAL LOW-VALUES
 10137                 OR
 10138             W-PNDB2-ACCOUNT EQUAL LOW-VALUES
 10139                 OR
 10140             W-PNDB2-EFF-DT EQUAL LOW-VALUES
 10141                 OR
 10142             W-PNDB2-CERT-NO EQUAL LOW-VALUES
 10143                 OR
 10144             W-PNDB2-TYPE EQUAL LOW-VALUES
 10145                 OR
 10146             W-PNDB2-ALT-CHG-SEQ-NO NOT = ZEROS
 10147             MOVE ER-7379        TO EMI-ERROR
 10148             MOVE -1             TO MAINTL
 10149             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10150         ELSE
 10151             NEXT SENTENCE
 10152     ELSE
 10153         IF  W-PNDB-COMPANY-CD EQUAL LOW-VALUES
 10154                 OR
 10155             W-PNDB-ENTRY EQUAL LOW-VALUES
 10156                 OR
 10157             W-PNDB-SEQ-NO EQUAL ZEROS
 10158             MOVE ER-7379        TO EMI-ERROR
 10159             MOVE -1             TO MAINTL
 10160             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10161
 10162     GO TO 0800-ERROR-TEST.
 10163
 10164 0800-SOURCE-CHEK.
 10165
 10166     IF  W-CHEK-COMPANY-CD EQUAL LOW-VALUES
 10167             OR
 10168         W-CHEK-CARRIER EQUAL LOW-VALUES
 10169             OR
 10170         W-CHEK-GROUPING EQUAL LOW-VALUES
 10171             OR
 10172         W-CHEK-STATE EQUAL LOW-VALUES
 10173             OR
 10174         W-CHEK-ACCOUNT EQUAL LOW-VALUES
 10175             OR
 10176         W-CHEK-EFF-DT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 196
* EL689.cbl
 10177             OR
 10178         W-CHEK-CERT-NO EQUAL LOW-VALUES
 10179         MOVE ER-7381            TO EMI-ERROR
 10180         MOVE -1                 TO MAINTL
 10181         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10182
 10183     GO TO 0800-ERROR-TEST.
 10184
 10185 0800-SOURCE-PAYMENTS-ADJS.
 10186
 10187     IF  W-PYAJ-COMPANY-CD EQUAL LOW-VALUES
 10188             OR
 10189         W-PYAJ-CARRIER EQUAL LOW-VALUES
 10190             OR
 10191         W-PYAJ-GROUPING EQUAL LOW-VALUES
 10192             OR
 10193         W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 10194             OR
 10195         W-PYAJ-ACCOUNT EQUAL LOW-VALUES
 10196             OR
 10197         W-PYAJ-RECORD-TYPE EQUAL LOW-VALUES
 10198         MOVE ER-7396            TO EMI-ERROR
 10199         MOVE -1                 TO MAINTL
 10200         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10201
 10202     GO TO 0800-ERROR-TEST.
 10203
 10204 0800-ERROR-TEST.
 10205
 10206     IF  NOT EMI-NO-ERRORS
 10207         IF  EMI-ERROR EQUAL ER-7250
 10208             GO TO 0800-EXIT
 10209         ELSE
 10210             GO TO 8200-SEND-DATAONLY.
 10211
 10212 0800-EXIT.
 10213     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 197
* EL689.cbl
 10215 0900-EDIT-CARRIER.
 10216
 10217     IF  CARRIERL EQUAL ZEROES
 10218         MOVE LOW-VALUES         TO PI-689-CARRIER
 10219                                    W-ACCT-CARRIER
 10220                                    W-CERT-CARRIER
 10221                                    W-COMP-CARRIER
 10222                                    W-CHEK-CARRIER
 10223                                    W-MAIL-CARRIER
 10224                                    W-PNDB2-CARRIER
 10225                                    W-PYAJ-CARRIER
 10226     ELSE
 10227         PERFORM 0990-CARRIER-VALIDITY-CHECK THRU 0990-EXIT.
 10228
 10229 0900-EXIT.
 10230     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 198
* EL689.cbl
 10232 0905-EDIT-GROUPING.
 10233
 10234     IF  GROUPL EQUAL ZEROES
 10235         MOVE LOW-VALUES         TO PI-689-GROUPING
 10236                                    W-ACCT-GROUPING
 10237                                    W-CERT-GROUPING
 10238                                    W-CHEK-GROUPING
 10239                                    W-COMP-GROUPING
 10240                                    W-MAIL-GROUPING
 10241                                    W-PNDB2-GROUPING
 10242                                    W-PYAJ-GROUPING
 10243     ELSE
 10244         MOVE AL-UANON           TO GROUPA
 10245         MOVE GROUPI             TO PI-689-GROUPING
 10246                                    W-ACCT-GROUPING
 10247                                    W-CERT-GROUPING
 10248                                    W-CHEK-GROUPING
 10249                                    W-COMP-GROUPING
 10250                                    W-MAIL-GROUPING
 10251                                    W-PNDB2-GROUPING
 10252                                    W-PYAJ-GROUPING.
 10253
 10254 0905-EXIT.
 10255     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 199
* EL689.cbl
 10257 0910-EDIT-STATE.
 10258
 10259     IF  STATEL EQUAL ZEROES
 10260         MOVE LOW-VALUES         TO PI-689-STATE
 10261                                    W-ACCT-STATE
 10262                                    W-CERT-STATE
 10263                                    W-CHEK-STATE
 10264                                    W-MAIL-STATE
 10265                                    W-PNDB2-STATE
 10266     ELSE
 10267         PERFORM 0994-STATE-VALIDITY-CHECK THRU 0994-EXIT.
 10268
 10269 0910-EXIT.
 10270     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 200
* EL689.cbl
 10272 0915-EDIT-ACCOUNT.
 10273
 10274     IF  ACCTL EQUAL ZEROES
 10275         MOVE LOW-VALUES         TO PI-689-ACCOUNT
 10276                                    W-ACCT-ACCOUNT
 10277                                    W-CERT-ACCOUNT
 10278                                    W-CHEK-ACCOUNT
 10279                                    W-COMP-ACCOUNT
 10280                                    W-MAIL-ACCOUNT
 10281                                    W-PNDB2-ACCOUNT
 10282                                    W-PYAJ-ACCOUNT
 10283     ELSE
 10284         MOVE AL-UANON           TO ACCTA
 10285         MOVE ACCTI              TO PI-689-ACCOUNT
 10286                                    W-ACCT-ACCOUNT
 10287                                    W-CERT-ACCOUNT
 10288                                    W-CHEK-ACCOUNT
 10289                                    W-COMP-ACCOUNT
 10290                                    W-MAIL-ACCOUNT
 10291                                    W-PYAJ-ACCOUNT
 10292                                    W-PNDB2-ACCOUNT.
 10293
 10294 0915-EXIT.
 10295     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 201
* EL689.cbl
 10297 0920-EDIT-EXP-DATE.
 10298
 10299     IF  DATEL NOT EQUAL ZEROS
 10300         IF  DATEI EQUAL '99/99/99' OR '999999'
 10301             MOVE '99/99/99'     TO DATEO
 10302                                    PI-689-DATE-EDIT
 10303             MOVE AL-UANON       TO DATEA
 10304             MOVE HIGH-VALUES    TO PI-689-EXP-DATE
 10305                                    W-ACCT-EXP-DT
 10306         ELSE
 10307             MOVE DATEI          TO W-DEEDIT-FIELD
 10308             PERFORM 8600-DEEDIT
 10309             MOVE W-DEEDIT-FIELD-V0
 10310                                 TO DC-GREG-DATE-1-MDY
 10311             MOVE '4'            TO DC-OPTION-CODE
 10312             PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10313             IF  DATE-CONVERSION-ERROR
 10314                 MOVE ER-0454    TO EMI-ERROR
 10315                 MOVE -1         TO DATEL
 10316                 MOVE AL-UABON   TO DATEA
 10317                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10318             ELSE
 10319                 MOVE DC-GREG-DATE-1-EDIT
 10320                                 TO DATEO
 10321                                    PI-689-DATE-EDIT
 10322                 MOVE AL-UANON   TO DATEA
 10323                 MOVE DC-BIN-DATE-1
 10324                                 TO PI-689-EXP-DATE
 10325                                    W-ACCT-EXP-DT
 10326     ELSE
 10327         MOVE LOW-VALUES         TO PI-689-EXP-DATE
 10328                                    W-ACCT-EXP-DT
 10329                                    PI-689-DATE-EDIT.
 10330
 10331 0920-EXIT.
 10332     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 202
* EL689.cbl
 10334 0925-EDIT-EFF-DATE.
 10335
 10336     IF  CERTL EQUAL ZERO
 10337             AND
 10338         DATASORI NOT EQUAL '2'
 10339         GO TO 0925-EXIT.
 10340
 10341     IF  DATEL NOT EQUAL ZEROS
 10342         MOVE DATEI              TO W-DEEDIT-FIELD
 10343         PERFORM 8600-DEEDIT
 10344         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 10345         MOVE '4'                TO DC-OPTION-CODE
 10346         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10347
 10348         IF  DATE-CONVERSION-ERROR
 10349             MOVE ER-0215        TO EMI-ERROR
 10350             MOVE -1             TO DATEL
 10351             MOVE AL-UABON       TO DATEA
 10352             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10353         ELSE
 10354             MOVE DC-GREG-DATE-1-EDIT
 10355                                 TO DATEO
 10356                                    PI-689-DATE-EDIT
 10357             MOVE AL-UANON       TO DATEA
 10358             MOVE DC-BIN-DATE-1  TO PI-689-EFF-DATE
 10359                                    W-CERT-EFF-DT
 10360                                    W-CHEK-EFF-DT
 10361                                    W-MAIL-EFF-DT
 10362                                    W-PNDB2-EFF-DT
 10363     ELSE
 10364         MOVE LOW-VALUES         TO PI-689-EFF-DATE
 10365                                    W-PNDB2-EFF-DT
 10366                                    W-CHEK-EFF-DT
 10367                                    W-MAIL-EFF-DT
 10368                                    W-CERT-EFF-DT
 10369                                    PI-689-DATE-EDIT.
 10370
 10371 0925-EXIT.
 10372     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 203
* EL689.cbl
 10374 0930-EDIT-CERTIFICATE.
 10375
 10376     IF  CERTL EQUAL ZEROES
 10377         MOVE LOW-VALUES         TO PI-689-CERT-PRIME
 10378                                    W-CERT-CERT-PRIME
 10379                                    W-CHEK-CERT-PRIME
 10380                                    W-MAIL-CERT-PRIME
 10381                                    W-PNDB2-CERT-PRIME
 10382                                    PI-689-CERT-SFX
 10383                                    W-CERT-CERT-SFX
 10384                                    W-CHEK-CERT-SFX
 10385                                    W-MAIL-CERT-SFX
 10386                                    W-PNDB2-CERT-SFX
 10387     ELSE
 10388         MOVE AL-UANON           TO CERTA
 10389         MOVE CERTI              TO PI-689-CERT-PRIME
 10390                                    W-CERT-CERT-PRIME
 10391                                    W-CHEK-CERT-PRIME
 10392                                    W-MAIL-CERT-PRIME
 10393                                    W-PNDB2-CERT-PRIME
 10394         IF  SFXL EQUAL ZEROES
 10395                 OR
 10396             SFXI EQUAL LOW-VALUES
 10397             MOVE SPACES         TO PI-689-CERT-SFX
 10398                                    W-CERT-CERT-SFX
 10399                                    W-CHEK-CERT-SFX
 10400                                    W-MAIL-CERT-SFX
 10401                                    W-PNDB2-CERT-SFX
 10402         ELSE
 10403             MOVE AL-UANON       TO SFXA
 10404             MOVE SFXI           TO PI-689-CERT-SFX
 10405                                    W-CERT-CERT-SFX
 10406                                    W-CHEK-CERT-SFX
 10407                                    W-MAIL-CERT-SFX
 10408                                    W-PNDB2-CERT-SFX.
 10409
 10410 0930-EXIT.
 10411     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 204
* EL689.cbl
 10413 0935-EDIT-RESP-PERSON.
 10414
 10415     IF  RPERSONL EQUAL ZEROES
 10416         MOVE LOW-VALUES         TO PI-689-RESP-PERSON
 10417                                    W-COMP-RESP-PERSON
 10418                                    W-PYAJ-FIN-RESP
 10419     ELSE
 10420         MOVE AL-UANON           TO RPERSONA
 10421         MOVE RPERSONI           TO PI-689-RESP-PERSON
 10422                                    W-PYAJ-FIN-RESP
 10423                                    W-COMP-RESP-PERSON.
 10424
 10425 0935-EXIT.
 10426     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 205
* EL689.cbl
 10428 0940-EDIT-ACCOUNT.
 10429
 10430     IF  ACCTL EQUAL ZEROES
 10431         MOVE LOW-VALUES         TO PI-689-ACCOUNT
 10432                                    W-COMP-ACCOUNT
 10433                                    W-PYAJ-ACCOUNT
 10434     ELSE
 10435         MOVE AL-UANON           TO ACCTA
 10436         MOVE ACCTI              TO PI-689-ACCOUNT
 10437                                    W-PYAJ-ACCOUNT
 10438                                    W-COMP-ACCOUNT.
 10439
 10440 0940-EXIT.
 10441     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 206
* EL689.cbl
 10443 0945-EDIT-TYPE.
 10444
 10445     IF  TYPEL EQUAL ZEROES
 10446         MOVE LOW-VALUES         TO PI-689-TYPE
 10447                                    W-COMP-TYPE
 10448                                    W-PYAJ-RECORD-TYPE
 10449     ELSE
 10450         INSPECT TYPEI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
 10451         IF TYPEI = 'C' OR 'G' OR 'A'
 10452             MOVE AL-UANON       TO TYPEA
 10453             MOVE TYPEI          TO PI-689-TYPE
 10454                                    W-COMP-TYPE
 10455                                    W-PYAJ-RECORD-TYPE
 10456         ELSE
 10457             MOVE ER-7368        TO EMI-ERROR
 10458             MOVE -1             TO TYPEL
 10459             MOVE AL-UABON       TO TYPEA
 10460             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10461
 10462 0945-EXIT.
 10463     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 207
* EL689.cbl
 10465 0950-EDIT-ENTRY.
 10466
 10467     IF  BENTRYL EQUAL ZEROES
 10468         MOVE LOW-VALUES         TO PI-689-ENTRY-BATCH
 10469                                    W-PNDB-ENTRY
 10470     ELSE
 10471         MOVE AL-UANON           TO BENTRYA
 10472         MOVE BENTRYI            TO PI-689-ENTRY-BATCH
 10473                                    W-PNDB-ENTRY.
 10474
 10475 0950-EXIT.
 10476     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 208
* EL689.cbl
 10478 0955-EDIT-SEQUENCE.
 10479
 10480     IF  SEQL NOT EQUAL ZEROS
 10481         IF  SEQI NOT NUMERIC
 10482                 OR
 10483             SEQI EQUAL '0'
 10484             MOVE ER-7367        TO EMI-ERROR
 10485             MOVE -1             TO SEQL
 10486             MOVE AL-UABON       TO SEQA
 10487             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10488         ELSE
 10489             MOVE AL-UANON       TO SEQA
 10490             MOVE SEQI           TO PI-689-SEQ-NO
 10491                                    W-CHEK-SEQ-NO
 10492                                    W-PYAJ-FILE-SEQ-NO
 10493                                    W-PNDB-SEQ-NO
 10494                                    PI-689-SEQ-EDIT
 10495     ELSE
 10496         MOVE LOW-VALUES         TO PI-689-SEQ-EDIT.
 10497
 10498 0955-EXIT.
 10499     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 209
* EL689.cbl
 10501 0960-EDIT-BATCH-SEQ.
 10502
 10503     IF  BCSEQL NOT EQUAL ZEROS
 10504         IF  BCSEQI NOT NUMERIC
 10505             MOVE ER-7368        TO EMI-ERROR
 10506             MOVE -1             TO BCSEQL
 10507             MOVE AL-UABON       TO BCSEQA
 10508             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10509         ELSE
 10510             MOVE AL-UANON       TO BCSEQA
 10511             MOVE BCSEQI         TO PI-689-CHG-SEQ-NO
 10512                                    W-PNDB-CHG-SEQ-NO
 10513                                    W-PNDB2-ALT-CHG-SEQ-NO
 10514                                    PI-689-BCSEQ-EDIT
 10515     ELSE
 10516         MOVE LOW-VALUES         TO PI-689-BCSEQ-EDIT.
 10517
 10518 0960-EXIT.
 10519     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 210
* EL689.cbl
 10521 0965-EDIT-TYPE.
 10522
 10523     IF  TYPEL EQUAL ZEROES
 10524         MOVE LOW-VALUES         TO PI-689-TYPE
 10525                                    W-PNDB2-TYPE
 10526     ELSE
 10527         IF  DATASORI NOT EQUAL '4'
 10528             GO TO 0965-EXIT
 10529         ELSE
 10530             IF TYPEI = '0' OR '1' OR '2' OR '3'
 10531                 MOVE AL-UANON   TO TYPEA
 10532                 MOVE TYPEI      TO PI-689-TYPE
 10533                                    W-PNDB2-TYPE
 10534             ELSE
 10535                 MOVE ER-7370    TO EMI-ERROR
 10536                 MOVE -1         TO TYPEL
 10537                 MOVE AL-UABON   TO TYPEA
 10538                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10539
 10540 0965-EXIT.
 10541     EXIT.
 10542
 10543 0970-EDIT-CSO.
 10544
 10545     IF ENDARCHL > ZEROS
 10546        IF ENDARCHI NUMERIC
 10547            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
 10548            MOVE AL-UNNON       TO ENDARCHA
 10549            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
 10550            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
 10551            MOVE 'N'            TO W-VALID-ENDT-SW
 10552            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
 10553            IF NOT W-VALID-ENDT
 10554                MOVE -1         TO ENDARCHL
 10555                MOVE ER-1565    TO EMI-ERROR
 10556                MOVE AL-UNBON   TO ENDARCHA
 10557                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10558            END-IF
 10559        END-IF
 10560     ELSE
 10561        MOVE ZEROS              TO PI-ENDT-ARCH-NO
 10562     END-IF
 10563
 10564     IF PI-CERT-REQ-IND = 'Y'
 10565       IF  CERTIDL NOT EQUAL ZEROS
 10566         IF CERTIDI NUMERIC
 10567             MOVE AL-UANON      TO CERTIDA
 10568             MOVE CERTIDI       TO PI-CERT-FORM-ID
 10569         ELSE
 10570             MOVE ER-1778       TO EMI-ERROR
 10571             MOVE -1            TO CERTIDL
 10572             MOVE AL-UABON      TO CERTIDA
 10573             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10574         END-IF
 10575       ELSE
 10576          MOVE ER-0715       TO EMI-ERROR
 10577          MOVE -1            TO CERTIDL
 10578          MOVE AL-UABON      TO CERTIDA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 211
* EL689.cbl
 10579          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10580       END-IF
 10581     END-IF.
 10582
 10583 0970-EXIT.
 10584      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 212
* EL689.cbl
 10586 0990-CARRIER-VALIDITY-CHECK.
 10587
 10588     IF  CARRIERI EQUAL SPACES
 10589         GO TO 0990-EXIT.
 10590
 10591     MOVE SPACES                 TO W-CNTL-KEY.
 10592     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10593     MOVE '6'                    TO W-CNTL-RECORD-TYPE.
 10594     MOVE CARRIERI               TO W-CNTL-GEN4.
 10595     MOVE +0                     TO W-CNTL-SEQ-NO.
 10596
 10597
 10598* EXEC CICS HANDLE CONDITION
 10599*        NOTFND  (0990-CARRIER-NOT-FOUND)
 10600*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10601*    END-EXEC.
 10602*    MOVE '"$IJ                  ! & #00010363' TO DFHEIV0
 10603     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10605     MOVE X'2620233030303130333633' TO DFHEIV0(25:11)
 10606     CALL 'kxdfhei1' USING DFHEIV0
 10607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10608
 10609
 10610
 10611* EXEC CICS READ
 10612*        DATASET (W-CNTL-FILE-ID)
 10613*        SET     (ADDRESS OF CONTROL-FILE)
 10614*        RIDFLD  (W-CNTL-KEY)
 10615*    END-EXEC.
 10616*    MOVE '&"S        E          (   #00010368' TO DFHEIV0
 10617     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10618     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10619     MOVE X'2020233030303130333638' TO DFHEIV0(25:11)
 10620     CALL 'kxdfhei1' USING DFHEIV0,
 10621           W-CNTL-FILE-ID,
 10622           DFHEIV20,
 10623           DFHEIV99,
 10624           W-CNTL-KEY,
 10625           DFHEIV99,
 10626           DFHEIV99,
 10627           DFHEIV99
 10628     SET ADDRESS OF CONTROL-FILE TO
 10629         DFHEIV20
 10630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10631
 10632
 10633     IF  PI-NO-CARRIER-SECURITY
 10634             OR
 10635         PI-CARRIER-SECURITY EQUAL CARRIERI
 10636         MOVE AL-UANON           TO CARRIERA
 10637         MOVE CARRIERI           TO PI-689-CARRIER
 10638                                    W-ACCT-CARRIER
 10639                                    W-CERT-CARRIER
 10640                                    W-CHEK-CARRIER
 10641                                    W-COMP-CARRIER
 10642                                    W-MAIL-CARRIER
 10643                                    W-PNDB2-CARRIER
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 213
* EL689.cbl
 10644                                    W-PYAJ-CARRIER
 10645     ELSE
 10646         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
 10647         MOVE ER-9095            TO EMI-ERROR
 10648         MOVE -1                 TO MAINTL
 10649         MOVE AL-UANON           TO MAINTA
 10650         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10651
 10652     GO TO 0990-EXIT.
 10653
 10654 0990-CARRIER-NOT-FOUND.
 10655
 10656     MOVE -1                     TO CARRIERL.
 10657     MOVE AL-UABON               TO CARRIERA.
 10658     MOVE ER-2208                TO EMI-ERROR.
 10659     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10660
 10661 0990-EXIT.
 10662     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 214
* EL689.cbl
 10664 0994-STATE-VALIDITY-CHECK.
 10665
 10666     IF  STATEI EQUAL SPACES
 10667         GO TO 0994-EXIT.
 10668
 10669     MOVE SPACES                 TO W-CNTL-KEY.
 10670     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10671     MOVE '3'                    TO W-CNTL-RECORD-TYPE.
 10672     MOVE STATEI                 TO W-CNTL-GEN1.
 10673     MOVE +0                     TO W-CNTL-SEQ-NO.
 10674
 10675
 10676* EXEC CICS HANDLE CONDITION
 10677*        NOTFND  (0994-STATE-NOT-FOUND)
 10678*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10679*    END-EXEC.
 10680*    MOVE '"$IJ                  ! '' #00010416' TO DFHEIV0
 10681     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10683     MOVE X'2720233030303130343136' TO DFHEIV0(25:11)
 10684     CALL 'kxdfhei1' USING DFHEIV0
 10685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10686
 10687
 10688
 10689* EXEC CICS READ
 10690*        DATASET (W-CNTL-FILE-ID)
 10691*        SET     (ADDRESS OF CONTROL-FILE)
 10692*        RIDFLD  (W-CNTL-KEY)
 10693*    END-EXEC.
 10694*    MOVE '&"S        E          (   #00010421' TO DFHEIV0
 10695     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10696     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10697     MOVE X'2020233030303130343231' TO DFHEIV0(25:11)
 10698     CALL 'kxdfhei1' USING DFHEIV0,
 10699           W-CNTL-FILE-ID,
 10700           DFHEIV20,
 10701           DFHEIV99,
 10702           W-CNTL-KEY,
 10703           DFHEIV99,
 10704           DFHEIV99,
 10705           DFHEIV99
 10706     SET ADDRESS OF CONTROL-FILE TO
 10707         DFHEIV20
 10708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10709
 10710
 10711     MOVE AL-UANON               TO STATEA.
 10712     MOVE STATEI                 TO PI-689-STATE
 10713                                    W-ACCT-STATE
 10714                                    W-CERT-STATE
 10715                                    W-CHEK-STATE
 10716                                    W-MAIL-STATE
 10717                                    W-PNDB2-STATE.
 10718
 10719     GO TO 0994-EXIT.
 10720
 10721 0994-STATE-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 215
* EL689.cbl
 10722
 10723     MOVE -1                     TO STATEL.
 10724     MOVE AL-UABON               TO STATEA.
 10725     MOVE ER-2209                TO EMI-ERROR.
 10726     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10727
 10728 0994-EXIT.
 10729     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 216
* EL689.cbl
 10731 1000-SHOW.
 10732***************************************************************
 10733*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
 10734*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN.  IF THE       *
 10735*     HEADER RECORD IS FOUND THE TEXT IS THEN READ AND        *
 10736*     WILL BE INSERTED INTO THE W-TS-TABLE AND DISPLAYED.     *
 10737***************************************************************
 10738
 10739     MOVE SPACES                 TO W-RECORD-TABLE.
 10740
 10741     IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 10742          MOVE PI-689-LBL-OVERRIDE
 10743                                 TO ADDRLBLI
 10744          MOVE +1                TO ADDRLBLL
 10745          MOVE AL-UANON          TO ADDRLBLA
 10746     ELSE
 10747          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 10748          MOVE +1                TO ADDRLBLL
 10749          MOVE AL-UANON          TO ADDRLBLA.
 10750
 10751     IF  ARCHNUML EQUAL ZEROS
 10752         MOVE -1                 TO ARCHNUML
 10753         MOVE AL-UNBON           TO ARCHNUMA
 10754         MOVE ER-0174            TO EMI-ERROR
 10755         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10756         GO TO 8200-SEND-DATAONLY.
 10757
 10758     IF  ARCHNUMI NOT NUMERIC
 10759         MOVE -1                 TO ARCHNUML
 10760         MOVE AL-UNBON           TO ARCHNUMA
 10761         MOVE ER-0175            TO EMI-ERROR
 10762         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10763         GO TO 8200-SEND-DATAONLY.
 10764
 10765     IF  PI-SHOW-MODE
 10766
 10767         IF  PI-689-ARCHIVE-NUMBER EQUAL ARCHNUMI
 10768             MOVE -1             TO MAINTL
 10769             GO TO 8200-SEND-DATAONLY
 10770         ELSE
 10771             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT.
 10772
 10773     MOVE +0                     TO W-ARCH-SEQ-NO
 10774                                    W-ARCT-SEQ-NO.
 10775     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
 10776                                    W-ARCT-COMPANY-CD.
 10777     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 10778                                    W-ARCT-NUMBER
 10779                                    PI-689-ARCHIVE-NUMBER.
 10780     MOVE ' '                    TO W-ARCT-REC-TYPE.
 10781     MOVE '1'                    TO PI-ACTION.
 10782     MOVE SPACES                 TO PI-689-PRINT-SW
 10783                                    PI-689-FORM-NUMBER
 10784                                    W-DELETE-KEY.
 10785     SET W-RG-NDX                TO W-ZEROS.
 10786
 10787
 10788* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 217
* EL689.cbl
 10789*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 10790*         NOTFND     (1070-ARCH-NOT-FOUND)
 10791*         ENDFILE    (1070-ARCH-NOT-FOUND)
 10792*    END-EXEC.
 10793*    MOVE '"$JI''                 ! ( #00010503' TO DFHEIV0
 10794     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 10795     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10796     MOVE X'2820233030303130353033' TO DFHEIV0(25:11)
 10797     CALL 'kxdfhei1' USING DFHEIV0
 10798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10799
 10800
 10801
 10802* EXEC CICS READ
 10803*        DATASET (W-ARCH-FILE-ID)
 10804*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10805*        RIDFLD  (W-ARCH-KEY)
 10806*    END-EXEC.
 10807*    MOVE '&"S        E          (   #00010509' TO DFHEIV0
 10808     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10809     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10810     MOVE X'2020233030303130353039' TO DFHEIV0(25:11)
 10811     CALL 'kxdfhei1' USING DFHEIV0,
 10812           W-ARCH-FILE-ID,
 10813           DFHEIV20,
 10814           DFHEIV99,
 10815           W-ARCH-KEY,
 10816           DFHEIV99,
 10817           DFHEIV99,
 10818           DFHEIV99
 10819     SET ADDRESS OF LETTER-ARCHIVE TO
 10820         DFHEIV20
 10821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10822
 10823
 10824     PERFORM 1040-FORMAT-HEADER-DATA THRU 1040-EXIT.
 10825
 10826*    EXEC CICS HANDLE CONDITION
 10827*         NOTOPEN    (8015-ARCT-NOT-OPEN)
 10828*         NOTFND     (1020-ARCT-ENDBR)
 10829*         ENDFILE    (1020-ARCT-ENDBR)
 10830*    END-EXEC.
 10831*
 10832*1005-START-BROWSE.
 10833*
 10834*    EXEC CICS STARTBR
 10835*         DATASET    (W-ARCT-FILE-ID)
 10836*         RIDFLD     (W-ARCT-KEY)
 10837*         GTEQ
 10838*    END-EXEC.
 10839*
 10840*    MOVE 'Y'                    TO W-ARCT-BROWSE-STARTED.
 10841*
 10842*1010-READ-NEXT.
 10843*
 10844*    EXEC CICS READNEXT
 10845*         SET       (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10846*         DATASET   (W-ARCT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 218
* EL689.cbl
 10847*         RIDFLD    (W-ARCT-KEY)
 10848*    END-EXEC.
 10849*
 10850*    IF  W-ARCH-PARTIAL-KEY EQUAL W-ARCT-PARTIAL-KEY
 10851*        IF  LT-ADDRESS-DATA
 10852*            IF  PI-CREATE-LABELS  AND
 10853*                NOT PI-689-LABELS-OVERRIDEN
 10854*                PERFORM 1050-MOVE-LABELS THRU 1050-EXIT
 10855*                        VARYING
 10856*                    LT-NDX FROM 1 BY 1
 10857*                        UNTIL
 10858*                    LT-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 10859*                GO TO 1010-READ-NEXT
 10860*            ELSE
 10861*                MOVE LT-CONTROL-PRIMARY
 10862*                                TO W-DELETE-KEY
 10863*                GO TO 1010-READ-NEXT
 10864*        ELSE
 10865*            PERFORM 1030-TEXT-BUILD THRU 1030-EXIT
 10866*                    VARYING
 10867*                LT-NDX FROM 1 BY 1
 10868*                    UNTIL
 10869*                LT-NDX GREATER THAN LT-NUM-LINES-ON-RECORD
 10870*                    OR
 10871*                LT-NDX GREATER THAN +20
 10872*            GO TO 1010-READ-NEXT.
 10873*
 10874*1020-ARCT-ENDBR.
 10875*
 10876*    IF  W-ARCT-BROWSE-STARTED EQUAL 'Y'
 10877*        EXEC CICS ENDBR
 10878*             DATASET   (W-ARCT-FILE-ID)
 10879*        END-EXEC.
 10880*
 10881*    IF  W-RG-NDX EQUAL ZEROS
 10882*        GO TO 1080-ARCHIVE-TEXT-NOT-FOUND.
 10883*
 10884*    IF  PI-689-NUMBER-LABEL-LINES GREATER THAN +0
 10885*            AND
 10886*        PI-BYPASS-LABELS
 10887*        MOVE W-DELETE-KEY       TO W-ARCT-KEY
 10888*        PERFORM 1060-DELETE-ADDRESS-RECORD THRU 1060-EXIT
 10889*        MOVE +0                 TO PI-689-NUMBER-LABEL-LINES.
 10890*
 10891*    SET PI-TOTAL-LINES          TO W-RG-NDX.
 10892*    MOVE 1                      TO PI-CURRENT-LINE.
 10893*    SET W-RG-NDX                TO +1.
 10894*
 10895*    PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10896*            VARYING
 10897*        W-SC-NDX FROM 1 BY 1
 10898*            UNTIL
 10899*        W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10900
 10901     MOVE -1                     TO MAINTL.
 10902     GO TO 8100-SEND-INITIAL-MAP.
 10903
 10904 1020-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 219
* EL689.cbl
 10905     EXIT.
 10906
 10907 1030-TEXT-BUILD.
 10908
 10909     SET W-RG-NDX UP BY 1.
 10910     MOVE LT-SKIP-CONTROL (LT-NDX)
 10911                                 TO W-PRINT-CONTROL.
 10912
 10913     IF  W-PRINT-CONTROL EQUAL 99
 10914         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 10915         SET W-RG-NDX UP BY 1
 10916     ELSE
 10917         SET W-RG-NDX UP BY W-PRINT-CONTROL.
 10918
 10919     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10920     MOVE LT-SKIP-CONTROL (LT-NDX)
 10921                                 TO W-RC-PC (W-RG-NDX).
 10922     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10923
 10924 1030-EXIT.
 10925     EXIT.
 10926
 10927 1040-FORMAT-HEADER-DATA.
 10928
 10929     MOVE LA-ACCOUNT-A2          TO ACCTO.
 10930     MOVE LA-ADDR-SOURCE         TO ADDRSO.
 10931     MOVE LA-CARRIER-A2          TO CARRIERO.
 10932     MOVE LA-CERT-NO-A2          TO CERTO.
 10933     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
 10934     MOVE LA-DATA-SOURCE         TO DATASORO.
 10935
 10936     IF  LA-EFFECT-DATE-A2 EQUAL LOW-VALUES
 10937         MOVE ZEROES             TO DATEO
 10938
 10939     ELSE
 10940         MOVE LA-EFFECT-DATE-A2  TO DC-BIN-DATE-1
 10941         MOVE ' '                TO DC-OPTION-CODE
 10942         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10943         MOVE DC-GREG-DATE-1-EDIT
 10944                                 TO DATEO.
 10945
 10946     IF  LA-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10947         MOVE ZEROES             TO FOLLOWO
 10948     ELSE
 10949         MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
 10950         MOVE ' '                TO DC-OPTION-CODE
 10951         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10952         MOVE DC-GREG-DATE-1-EDIT
 10953                                 TO FOLLOWO.
 10954
 10955     MOVE LA-FORM-A3             TO FORMO.
 10956     MOVE LA-GROUPING-A2         TO GROUPO.
 10957     MOVE LA-NO-OF-COPIES        TO COPIESO
 10958                                    PI-689-NUMBER-COPIES.
 10959
 10960*    IF LA-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
 10961*        MOVE LA-PRINT-RESTRICTION
 10962*                                TO PRTRESTO
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 220
* EL689.cbl
 10963*    ELSE
 10964*        MOVE SPACES             TO PRTRESTO.
 10965
 10966     IF  LA-RESEND-DATE = LOW-VALUES
 10967         MOVE ZEROES             TO RESEND1O
 10968     ELSE
 10969         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
 10970         MOVE ' '                TO DC-OPTION-CODE
 10971         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10972         MOVE DC-GREG-DATE-1-EDIT
 10973                                 TO RESEND1O.
 10974
 10975     MOVE LA-STATE-A2            TO STATEO.
 10976
 10977     MOVE LA-NUMBER-LABEL-LINES  TO PI-689-NUMBER-LABEL-LINES.
 10978
 10979 1040-EXIT.
 10980     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 221
* EL689.cbl
 10982 1050-MOVE-LABELS.
 10983
 10984     SET W-RG-NDX                TO LT-NDX.
 10985     MOVE ZEROS                  TO W-RC-PC (W-RG-NDX).
 10986     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10987     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10988
 10989 1050-EXIT.
 10990     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 222
* EL689.cbl
 10992 1060-DELETE-ADDRESS-RECORD.
 10993
 10994
 10995* EXEC CICS DELETE
 10996*        DATASET (W-ARCT-FILE-ID)
 10997*        RIDFLD  (W-DELETE-KEY)
 10998*    END-EXEC.
 10999*    MOVE '&(  R                 &   #00010685' TO DFHEIV0
 11000     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 11001     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11002     MOVE X'2020233030303130363835' TO DFHEIV0(25:11)
 11003     CALL 'kxdfhei1' USING DFHEIV0,
 11004           W-ARCT-FILE-ID,
 11005           W-DELETE-KEY,
 11006           DFHEIV99,
 11007           DFHEIV99,
 11008           DFHEIV99
 11009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11010
 11011
 11012
 11013* EXEC CICS READ
 11014*        DATASET (W-ARCH-FILE-ID)
 11015*        SET     (ADDRESS OF LETTER-ARCHIVE)
 11016*        RIDFLD  (W-ARCH-KEY)
 11017*        UPDATE
 11018*    END-EXEC.
 11019*    MOVE '&"S        EU         (   #00010690' TO DFHEIV0
 11020     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11021     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11022     MOVE X'2020233030303130363930' TO DFHEIV0(25:11)
 11023     CALL 'kxdfhei1' USING DFHEIV0,
 11024           W-ARCH-FILE-ID,
 11025           DFHEIV20,
 11026           DFHEIV99,
 11027           W-ARCH-KEY,
 11028           DFHEIV99,
 11029           DFHEIV99,
 11030           DFHEIV99
 11031     SET ADDRESS OF LETTER-ARCHIVE TO
 11032         DFHEIV20
 11033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11034
 11035
 11036     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES.
 11037
 11038
 11039* EXEC CICS REWRITE
 11040*         FROM      (LETTER-ARCHIVE)
 11041*         DATASET   (W-ARCH-FILE-ID)
 11042*    END-EXEC.
 11043     MOVE LENGTH OF
 11044      LETTER-ARCHIVE
 11045       TO DFHEIV11
 11046*    MOVE '&& L                  %   #00010699' TO DFHEIV0
 11047     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11048     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11049     MOVE X'2020233030303130363939' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 223
* EL689.cbl
 11050     CALL 'kxdfhei1' USING DFHEIV0,
 11051           W-ARCH-FILE-ID,
 11052           LETTER-ARCHIVE,
 11053           DFHEIV11,
 11054           DFHEIV99
 11055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11056
 11057
 11058 1060-EXIT.
 11059     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 224
* EL689.cbl
 11061 1070-ARCH-NOT-FOUND.
 11062
 11063     MOVE ER-7371                TO EMI-ERROR.
 11064     MOVE -1                     TO ARCHNUML.
 11065     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11066     GO TO 8100-SEND-INITIAL-MAP.
 11067
 11068 1080-ARCHIVE-TEXT-NOT-FOUND.
 11069
 11070     MOVE ER-7372                TO EMI-ERROR.
 11071     MOVE -1                     TO ARCHNUML.
 11072     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11073     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 225
* EL689.cbl
 11075 2000-CREATE.
 11076***************************************************************
 11077*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
 11078*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
 11079*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
 11080*    WILL BE DISPLAYED ON THE SCREEN.                         *
 11081*                                                             *
 11082***************************************************************
 11083
 11084***************************************************************
 11085*    CHECK TO SEE IF IT IS THE SAME REQUEST OR NOT.           *
 11086*    IF IT IS A NEW REQUEST AND A LETTER WAS PRINTED          *
 11087*    THEN FORCE AN ERROR.                                     *
 11088***************************************************************
 11089
 11090     IF  PI-689-CREATE-NO-SCREENS
 11091         GO TO 2000-GET-TEXT.
 11092
 11093     IF  PI-CREATE-MODE
 11094         IF  PI-689-PRINT-PERFORMED
 11095                 AND
 11096             FORMI NOT EQUAL 9999
 11097             MOVE ER-0279    TO EMI-ERROR
 11098             MOVE -1         TO MAINTL
 11099             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11100             GO TO 8200-SEND-DATAONLY.
 11101
 11102     IF  ARCHNUML GREATER THAN ZEROS
 11103         MOVE ER-9320            TO EMI-ERROR
 11104         MOVE -1                 TO ARCHNUML
 11105         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11106         GO TO 8200-SEND-DATAONLY.
 11107
 11108***************************************************************
 11109*    IF  A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE     *
 11110*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
 11111***************************************************************
 11112
 11113     IF  FORMI EQUAL '9999'
 11114         MOVE 16                 TO PI-TOTAL-LINES
 11115         MOVE 1                  TO PI-CURRENT-LINE
 11116         MOVE SPACES             TO W-FILE-TABLE
 11117                                    W-LINE-CONTROL-RECORD
 11118                                    W-RECORD-TABLE
 11119                                    W-SINGLE-LINE
 11120                                    W-SQUEEZED-LINE
 11121                                    W-TS-WORK-AREA
 11122                                    W-TX-TABLE
 11123         PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 11124         MOVE '3'                TO PI-ACTION
 11125         MOVE FORMI              TO PI-689-FORM-NUMBER
 11126                                    PI-COMM-CONTROL
 11127         MOVE ZEROS              TO PI-UPDATE-SW
 11128         MOVE W-PGM-EL1042       TO W-CALL-PGM
 11129         GO TO 9400-XCTL.
 11130
 11131 2000-GET-TEXT.
 11132
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 226
* EL689.cbl
 11133     MOVE SPACES                 TO W-FILE-TABLE
 11134                                    W-LINE-CONTROL-RECORD
 11135                                    W-RECORD-TABLE
 11136                                    W-SINGLE-LINE
 11137                                    W-SQUEEZED-LINE
 11138                                    W-TS-WORK-AREA
 11139                                    W-TX-TABLE.
 11140     SET W-TG-NDX                TO +1
 11141     MOVE ZEROS                  TO W-INITIAL-COLUMN
 11142                                    W-LINE-COUNT
 11143                                    W-LINE-INDENT-1
 11144                                    W-LINE-INDENT-2
 11145                                    W-LINE-INDENT-3
 11146                                    W-LINE-INDENT-4
 11147                                    W-LINE-INDENT-5
 11148                                    W-PAGE
 11149                                    W-PARAGRAPH-INDENT
 11150                                    W-TOP-MARGIN
 11151                                    W-WORK-INDENT.
 11152     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
 11153     MOVE +70                    TO W-LAST-COLUMN.
 11154     MOVE +56                    TO W-MAX-LINES-PER-PAGE.
 11155     MOVE +1                     TO W-START-COLUMN.
 11156     MOVE +71                    TO W-TOO-FAR.
 11157
 11158     MOVE PI-COMPANY-CD          TO W-TEXT-COMPANY-CD.
 11159     MOVE FORMI                  TO W-TEXT-LETTER.
 11160     MOVE W-TEXT-PARTIAL-KEY     TO W-TEXT-SAVE-KEY.
 11161     MOVE 'N'                    TO W-TEXT-BROWSED-SW.
 11162
 11163
 11164* EXEC CICS HANDLE CONDITION
 11165*         NOTFND     (2001-NOT-FOUND)
 11166*         ENDFILE    (2001-NOT-FOUND)
 11167*         NOTOPEN    (8050-TEXT-NOT-OPEN)
 11168*    END-EXEC.
 11169*    MOVE '"$I''J                 ! ) #00010809' TO DFHEIV0
 11170     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 11171     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11172     MOVE X'2920233030303130383039' TO DFHEIV0(25:11)
 11173     CALL 'kxdfhei1' USING DFHEIV0
 11174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11175
 11176
 11177
 11178* EXEC CICS STARTBR
 11179*         DATASET    (W-TEXT-FILE-ID)
 11180*         RIDFLD     (W-TEXT-KEY)
 11181*         GTEQ
 11182*    END-EXEC.
 11183     MOVE 0
 11184       TO DFHEIV11
 11185*    MOVE '&,         G          &   #00010815' TO DFHEIV0
 11186     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11187     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11188     MOVE X'2020233030303130383135' TO DFHEIV0(25:11)
 11189     CALL 'kxdfhei1' USING DFHEIV0,
 11190           W-TEXT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 227
* EL689.cbl
 11191           W-TEXT-KEY,
 11192           DFHEIV99,
 11193           DFHEIV11,
 11194           DFHEIV99
 11195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11196
 11197
 11198
 11199* EXEC CICS HANDLE CONDITION
 11200*         ENDFILE    (2000-ENDBR)
 11201*    END-EXEC.
 11202*    MOVE '"$''                   ! * #00010821' TO DFHEIV0
 11203     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 11204     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11205     MOVE X'2A20233030303130383231' TO DFHEIV0(25:11)
 11206     CALL 'kxdfhei1' USING DFHEIV0
 11207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11208
 11209
 11210 2000-READ-NEXT.
 11211
 11212     IF  W-TG-NDX GREATER THAN W-MAX-LINES
 11213         MOVE ER-0051            TO EMI-ERROR
 11214         MOVE -1                 TO MAINTL
 11215         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11216         GO TO 2000-ENDBR.
 11217
 11218
 11219* EXEC CICS READNEXT
 11220*         DATASET    (W-TEXT-FILE-ID)
 11221*         SET        (ADDRESS OF TEXT-FILES)
 11222*         RIDFLD     (W-TEXT-KEY)
 11223*    END-EXEC.
 11224     MOVE 0
 11225       TO DFHEIV11
 11226*    MOVE '&.S                   )   #00010833' TO DFHEIV0
 11227     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11228     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11229     MOVE X'2020233030303130383333' TO DFHEIV0(25:11)
 11230     CALL 'kxdfhei1' USING DFHEIV0,
 11231           W-TEXT-FILE-ID,
 11232           DFHEIV20,
 11233           DFHEIV99,
 11234           W-TEXT-KEY,
 11235           DFHEIV99,
 11236           DFHEIV11,
 11237           DFHEIV99,
 11238           DFHEIV99
 11239     SET ADDRESS OF TEXT-FILES TO
 11240         DFHEIV20
 11241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11242
 11243
 11244     IF  W-TEXT-PARTIAL-KEY NOT EQUAL W-TEXT-SAVE-KEY
 11245         GO TO 2000-ENDBR.
 11246
 11247     MOVE 'Y'                    TO W-TEXT-BROWSED-SW.
 11248
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 228
* EL689.cbl
 11249     MOVE TX-FORM-SQUEEZE-CONTROL
 11250                                 TO W-FORM-SQUEEZE-IND.
 11251
 11252     IF  PI-689-ARCHIVE-SW NOT GREATER THAN SPACES
 11253         MOVE TX-ARCHIVE-SW      TO PI-689-ARCHIVE-SW.
 11254
 11255     IF  TX-FORM-CONTROL-LINE
 11256         PERFORM 2100-PROCESS-FORM-CONTROL-LINE THRU 2100-EXIT
 11257         GO TO 2000-READ-NEXT.
 11258
 11259     IF  TX-LINE-SQUEEZE-CONTROL EQUAL 'Z'
 11260         PERFORM 2150-PROCESS-Z-CONTROLS THRU 2150-EXIT
 11261         GO TO 2000-READ-NEXT.
 11262
 11263     MOVE TX-TEXT-LINE           TO W-TX-TEXT (W-TG-NDX).
 11264     MOVE TX-PROCESS-CONTROL     TO W-TX-PC (W-TG-NDX).
 11265     PERFORM 2200-CHECK-FOR-VARIABLE THRU 2200-EXIT.
 11266     MOVE TX-LINE-SQUEEZE-CONTROL
 11267                                 TO W-TX-SC (W-TG-NDX).
 11268
 11269     SET W-TG-NDX UP BY 1.
 11270     GO TO 2000-READ-NEXT.
 11271
 11272 2000-ENDBR.
 11273
 11274
 11275* EXEC CICS ENDBR
 11276*        DATASET     (W-TEXT-FILE-ID)
 11277*    END-EXEC.
 11278     MOVE 0
 11279       TO DFHEIV11
 11280*    MOVE '&2                    $   #00010869' TO DFHEIV0
 11281     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11282     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11283     MOVE X'2020233030303130383639' TO DFHEIV0(25:11)
 11284     CALL 'kxdfhei1' USING DFHEIV0,
 11285           W-TEXT-FILE-ID,
 11286           DFHEIV11,
 11287           DFHEIV99
 11288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11289
 11290
 11291     IF  W-TEXT-BROWSE-NOT-STARTED
 11292         MOVE ER-0006            TO EMI-ERROR
 11293         MOVE -1                 TO FORML
 11294         MOVE AL-UABON           TO FORMA
 11295         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11296         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 11297
 11298     SET  W-TOTAL-TX-LINES       TO W-TG-NDX.
 11299     SUBTRACT +1 FROM W-TOTAL-TX-LINES.
 11300     MOVE 1                      TO PI-CURRENT-LINE.
 11301
 11302     IF  COPIESL NOT GREATER THAN ZEROS
 11303         MOVE +1                 TO COPIESI
 11304                                    PI-689-NUMBER-COPIES
 11305         MOVE +1                 TO COPIESL
 11306         MOVE AL-UNNON           TO COPIESA.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 229
* EL689.cbl
 11307
 11308***************************************************************
 11309*    IF IT IS A FORM WITH VARIABLES, THEN RESOLVE ALL OF      *
 11310*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
 11311***************************************************************
 11312
 11313     PERFORM 6000-RESOLVE-VARIABLES THRU 6000-EXIT.
 11314
 11315*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
 11316*        IF  PI-689-CONTROL NOT GREATER THAN ZEROS
 11317*            MOVE ER-7243        TO EMI-ERROR
 11318*            MOVE -1             TO PRTRESTL
 11319*            MOVE AL-UABON       TO PRTRESTA
 11320*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11321
 11322     IF  PI-CREATE-LABELS AND
 11323         NOT  PI-689-LABELS-OVERRIDEN
 11324         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11325         SET W-RG-NDX UP BY +1
 11326     ELSE
 11327         SET W-RG-NDX            TO +1.
 11328
 11329     MOVE W-TOP-FORM             TO W-RC-TEXT (W-RG-NDX).
 11330     SET W-RG-NDX UP BY W-TOP-MARGIN.
 11331
 11332     PERFORM 7400-CREATE-LETTER THRU 7400-EXIT.
 11333
 11334     SET PI-TOTAL-LINES          TO W-RG-NDX.
 11335
 11336     IF  W-FIRST-BAD-VARIABLE-FOUND
 11337         SET W-RG-NDX            TO W-FIRST-BAD-VARIABLE
 11338         MOVE W-FIRST-BAD-VARIABLE
 11339                                 TO PI-CURRENT-LINE
 11340     ELSE
 11341         SET W-RG-NDX            TO 1.
 11342
 11343     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11344             VARYING
 11345         W-SC-NDX FROM 1 BY 1
 11346             UNTIL
 11347         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11348     IF  PI-689-CREATE-NO-SCREENS
 11349         GO TO 2000-EXIT
 11350     ELSE
 11351         IF  W-FORM-CHANGED
 11352             MOVE '3'            TO PI-ACTION
 11353             MOVE -1             TO MAINTL
 11354             GO TO 8100-SEND-INITIAL-MAP
 11355         ELSE
 11356             MOVE '3'            TO PI-ACTION
 11357             MOVE -1             TO MAINTL
 11358             GO TO 8350-SEND-DATAONLY-ERASEAUP.
 11359
 11360 2000-EXIT.
 11361     EXIT.
 11362
 11363 2001-NOT-FOUND.
 11364
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 230
* EL689.cbl
 11365     MOVE ER-0006                TO EMI-ERROR.
 11366     MOVE -1                     TO FORML.
 11367     MOVE AL-UABON               TO FORMA.
 11368     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11369     GO TO 8350-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 231
* EL689.cbl
 11371 2100-PROCESS-FORM-CONTROL-LINE.
 11372
 11373     MOVE TX-TEXT-LINE           TO W-LINE-CONTROL-RECORD.
 11374
 11375     IF  W-LC-LINE-WIDTH NUMERIC
 11376             AND
 11377         W-LC-LINE-WIDTH GREATER THAN ZEROS
 11378         COMPUTE W-INITIAL-COLUMN
 11379             = (70 - W-LC-LINE-WIDTH) / 2
 11380         COMPUTE W-START-COLUMN = W-INITIAL-COLUMN + 1
 11381         COMPUTE W-LAST-COLUMN ROUNDED
 11382             = W-INITIAL-COLUMN + W-LC-LINE-WIDTH
 11383         COMPUTE W-TOO-FAR = W-LAST-COLUMN + 1
 11384     ELSE
 11385         MOVE 70                 TO W-LC-LINE-WIDTH.
 11386
 11387     IF  W-LC-PARAGRAPH-INDENT NUMERIC
 11388             AND
 11389         W-LC-PARAGRAPH-INDENT GREATER THAN ZEROS
 11390         MOVE W-LC-PARAGRAPH-INDENT
 11391                                 TO W-PARAGRAPH-INDENT.
 11392
 11393     IF  W-LC-MAX-LINES-PER-PAGE NUMERIC
 11394             AND
 11395         W-LC-MAX-LINES-PER-PAGE GREATER THAN ZEROS
 11396         MOVE W-LC-MAX-LINES-PER-PAGE
 11397                                 TO W-MAX-LINES-PER-PAGE.
 11398
 11399     IF  W-LC-LINE-ADJUST NUMERIC
 11400             AND
 11401         W-LC-LINE-ADJUST GREATER THAN ZEROS
 11402         COMPUTE W-TOTAL-LINE-LENGTH
 11403             = W-LC-LINE-WIDTH + (W-LC-LINE-ADJUST * 2)
 11404         IF  W-TOTAL-LINE-LENGTH LESS THAN +71
 11405             ADD W-LC-LINE-ADJUST
 11406                                 TO W-INITIAL-COLUMN
 11407                                    W-LAST-COLUMN
 11408                                    W-START-COLUMN
 11409                                    W-TOO-FAR.
 11410
 11411     IF  W-LC-LINE-INDENT-1 NUMERIC
 11412             AND
 11413         W-LC-LINE-INDENT-1 LESS THAN W-LC-LINE-WIDTH
 11414         MOVE W-LC-LINE-INDENT-1 TO W-LINE-INDENT-1
 11415     ELSE
 11416         MOVE +0                 TO W-LINE-INDENT-1.
 11417
 11418     IF  W-LC-LINE-INDENT-2 NUMERIC
 11419             AND
 11420         W-LC-LINE-INDENT-2 LESS THAN W-LC-LINE-WIDTH
 11421         MOVE W-LC-LINE-INDENT-2 TO W-LINE-INDENT-2
 11422     ELSE
 11423         MOVE +0                 TO W-LINE-INDENT-2.
 11424
 11425     IF  W-LC-LINE-INDENT-3 NUMERIC
 11426             AND
 11427         W-LC-LINE-INDENT-3 LESS THAN W-LC-LINE-WIDTH
 11428         MOVE W-LC-LINE-INDENT-3 TO W-LINE-INDENT-3
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 232
* EL689.cbl
 11429     ELSE
 11430         MOVE +0                 TO W-LINE-INDENT-3.
 11431
 11432     IF  W-LC-LINE-INDENT-4 NUMERIC
 11433             AND
 11434         W-LC-LINE-INDENT-4 LESS THAN W-LC-LINE-WIDTH
 11435         MOVE W-LC-LINE-INDENT-4 TO W-LINE-INDENT-4
 11436     ELSE
 11437         MOVE +0                 TO W-LINE-INDENT-4.
 11438
 11439     IF  W-LC-LINE-INDENT-5 NUMERIC
 11440             AND
 11441         W-LC-LINE-INDENT-5 LESS THAN W-LC-LINE-WIDTH
 11442         MOVE W-LC-LINE-INDENT-5 TO W-LINE-INDENT-5
 11443
 11444     ELSE
 11445         MOVE +0                 TO W-LINE-INDENT-5.
 11446
 11447     IF  W-LC-TOP-MARGIN NUMERIC
 11448         MOVE W-LC-TOP-MARGIN    TO W-TOP-MARGIN
 11449     ELSE
 11450         MOVE +0                 TO W-TOP-MARGIN.
 11451
 11452     IF W-LC-CASE-IND = 'Y' OR 'N'
 11453         NEXT SENTENCE
 11454     ELSE
 11455         MOVE PI-LOWER-CASE-LETTERS
 11456                                 TO W-LC-CASE-IND.
 11457
 11458 2100-EXIT.
 11459     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 233
* EL689.cbl
 11461 2150-PROCESS-Z-CONTROLS.
 11462
 11463     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
 11464
 11465     IF PI-689-RESEND-DATE-1 = LOW-VALUES
 11466        IF W-DAYS-TO-RESEND NUMERIC
 11467           IF W-DAYS-TO-RESEND > ZEROS
 11468              MOVE '6'           TO DC-OPTION-CODE
 11469              MOVE W-SAVE-BIN-NEXT-BUS-DT
 11470                                 TO DC-BIN-DATE-1
 11471              MOVE ZEROS         TO DC-ELAPSED-MONTHS
 11472              MOVE W-DAYS-TO-RESEND
 11473                                 TO DC-ELAPSED-DAYS
 11474              PERFORM 9500-LINK-DATE-CONVERT
 11475                                 THRU 9500-EXIT
 11476              IF NO-CONVERSION-ERROR
 11477                 MOVE DC-BIN-DATE-2
 11478                                 TO PI-689-RESEND-DATE-1
 11479                 MOVE DC-GREG-DATE-1-EDIT
 11480                                 TO RESEND1O
 11481                                    PI-689-RESEND1-EDIT
 11482                 MOVE AL-UANON
 11483                                 TO RESEND1A
 11484                 MOVE +8         TO RESEND1L
 11485              ELSE
 11486                 MOVE ER-3770
 11487                                 TO EMI-ERROR
 11488                 MOVE -1         TO MAINTL
 11489                 PERFORM 9900-ERROR-FORMAT
 11490                                 THRU 9900-EXIT
 11491                 GO TO 8200-SEND-DATAONLY
 11492              END-IF
 11493           END-IF
 11494        END-IF
 11495     END-IF
 11496     IF W-FORM-TO-RESEND NOT = SPACES AND ZEROS
 11497        MOVE W-FORM-TO-RESEND    TO PI-689-RESEND-LETR-1
 11498     END-IF
 11499     IF  PI-689-FOLLOW-UP-DATE EQUAL LOW-VALUES
 11500         IF  W-DAYS-TO-FOLLOW-UP NUMERIC
 11501            IF  W-DAYS-TO-FOLLOW-UP >= ZEROS
 11502                 MOVE '6'        TO DC-OPTION-CODE
 11503                 MOVE W-SAVE-BIN-DATE
 11504                                 TO DC-BIN-DATE-1
 11505                 MOVE ZEROS      TO DC-ELAPSED-MONTHS
 11506                 MOVE W-DAYS-TO-FOLLOW-UP
 11507                                 TO DC-ELAPSED-DAYS
 11508                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 11509                 IF  NO-CONVERSION-ERROR
 11510                     MOVE DC-BIN-DATE-2
 11511                                 TO PI-689-FOLLOW-UP-DATE
 11512                     MOVE DC-GREG-DATE-1-EDIT
 11513                                 TO FOLLOWO
 11514                     MOVE AL-UANON
 11515                                 TO FOLLOWA
 11516                     MOVE +8     TO FOLLOWL
 11517                 ELSE
 11518                     MOVE ER-3771
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 234
* EL689.cbl
 11519                                 TO EMI-ERROR
 11520                     MOVE -1     TO MAINTL
 11521                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11522                     GO TO 8200-SEND-DATAONLY.
 11523
 11524     IF  COPIESI NOT NUMERIC
 11525             OR
 11526         COPIESI NOT GREATER THAN ZEROS
 11527         IF  W-NUMBER-OF-COPIES NUMERIC
 11528             IF  W-NUMBER-OF-COPIES GREATER THAN ZEROS
 11529                 MOVE W-NUMBER-OF-COPIES
 11530                                 TO COPIESI
 11531                                    PI-689-NUMBER-COPIES
 11532                 MOVE AL-UNNON   TO COPIESA
 11533                 MOVE +1         TO COPIESL
 11534             ELSE
 11535                 MOVE +1         TO COPIESI
 11536                                    PI-689-NUMBER-COPIES
 11537                 MOVE AL-UNNON   TO COPIESA
 11538                 MOVE +1         TO COPIESL
 11539         ELSE
 11540             MOVE +1             TO COPIESI
 11541                                    PI-689-NUMBER-COPIES
 11542             MOVE AL-UNNON       TO COPIESA
 11543             MOVE +1             TO COPIESL.
 11544
 11545     IF W-PROMPT-LETTER EQUAL 'Y'
 11546         MOVE 'Y'                TO PI-PROMPT-IND
 11547         MOVE ER-0894            TO EMI-ERROR
 11548         MOVE -1                 TO MAINTL
 11549         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11550     END-IF.
 11551
 11552     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
 11553                                           ENCO
 11554     MOVE AL-UANON                      TO ENCA
 11555     MOVE +3                            TO ENCL
 11556
 11557     IF W-PRINT-CERTIFICATE = 'Y'
 11558        MOVE 'Y' TO PI-CERT-REQ-IND
 11559        IF CERTIDL > ZEROS
 11560            IF CERTIDI NUMERIC
 11561              MOVE AL-UANON      TO CERTIDA
 11562              MOVE CERTIDI       TO PI-CERT-FORM-ID
 11563            ELSE
 11564              MOVE ER-1778       TO EMI-ERROR
 11565              MOVE -1            TO CERTIDL
 11566              MOVE AL-UABON      TO CERTIDA
 11567              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11568           END-IF
 11569        ELSE
 11570              MOVE ER-0715       TO EMI-ERROR
 11571              MOVE -1            TO CERTIDL
 11572              MOVE AL-UABON      TO CERTIDA
 11573              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11574        END-IF
 11575     END-IF.
 11576
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 235
* EL689.cbl
 11577     IF W-REASONS-REQUIRED = 'Y'
 11578        MOVE 'Y' TO PI-REASON-REQ-IND
 11579        IF PI-ENDT-ARCH-NO NOT > ZERO
 11580          MOVE ER-9840       TO EMI-ERROR
 11581          MOVE -1            TO FORML
 11582          MOVE AL-UABON      TO FORMA
 11583          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11584        END-IF
 11585     END-IF.
 11586
 11587*    IF  PI-689-PRINT-RESTRICTION NOT = 'C' AND 'F' AND 'P' AND
 11588*                                       SPACES
 11589*        IF  W-PRINT-RESTRICTED
 11590*            MOVE W-PRINT-RESTRICTED-IND
 11591*                                TO PRTRESTI
 11592*                                   PI-689-PRINT-RESTRICTION
 11593*            MOVE AL-UANON       TO PRTRESTA
 11594*            MOVE +1             TO PRTRESTL.
 11595     .
 11596 2150-EXIT.
 11597     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 236
* EL689.cbl
 11599 2200-CHECK-FOR-VARIABLE.
 11600
 11601     IF  W-TX-TEXT (W-TG-NDX) EQUAL SPACES
 11602         GO TO 2200-EXIT.
 11603
 11604     SET W-TX-NDX                TO +1.
 11605
 11606 2200-CONTINUE.
 11607
 11608     SEARCH W-TX-CHAR
 11609         VARYING
 11610             W-TX-NDX
 11611         AT END
 11612             GO TO 2200-EXIT
 11613         WHEN
 11614             W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11615             NEXT SENTENCE.
 11616
 11617     SET W-TX-NDX UP BY +1.
 11618
 11619     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11620         PERFORM 2220-BUILD-VARIABLE-NUMBER THRU 2220-EXIT
 11621         GO TO 2200-CONTINUE.
 11622
 11623 2200-EXIT.
 11624     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 237
* EL689.cbl
 11626 2220-BUILD-VARIABLE-NUMBER.
 11627
 11628     SET W-TX-NDX UP BY +1.
 11629     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V1.
 11630     SET W-TX-NDX UP BY +1.
 11631     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V2.
 11632     SET W-TX-NDX UP BY +1.
 11633     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V3.
 11634
 11635     IF  W-VAR-RELATIVE-NUM NUMERIC
 11636         SET W-FILE-NDX TO W-VARIABLE-SOURCE (W-VAR-RELATIVE-NUM)
 11637         MOVE 'Y' TO W-FILE-USE-IND (W-FILE-NDX).
 11638
 11639 2220-EXIT.
 11640     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 238
* EL689.cbl
 11642 4000-ROLL-PAGE.
 11643
 11644     IF  ENTERPFL NOT EQUAL ZEROS
 11645         MOVE -1                 TO ENTERPFL
 11646     ELSE
 11647         MOVE -1                 TO MAINTL.
 11648
 11649     IF  PI-TOTAL-LINES EQUAL 0
 11650         MOVE ER-0047            TO EMI-ERROR
 11651         MOVE -1                 TO MAINTL
 11652         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11653         GO TO 8200-SEND-DATAONLY.
 11654
 11655     COMPUTE W-TEMP-CURRENT-LINE EQUAL
 11656         PI-CURRENT-LINE + W-ROLL-COUNTER.
 11657
 11658     IF  W-TEMP-CURRENT-LINE NEGATIVE
 11659             OR
 11660         W-TEMP-CURRENT-LINE EQUAL ZEROS
 11661         MOVE ER-0067            TO EMI-ERROR
 11662         MOVE -1                 TO MAINTL
 11663         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11664         MOVE 1                  TO W-TEMP-CURRENT-LINE.
 11665
 11666*    IF  W-TEMP-CURRENT-LINE GREATER THAN PI-TOTAL-LINES
 11667*            AND
 11668*        (EIBAID EQUAL DFHPF1 OR DFHPF6)
 11669*        MOVE ER-0066            TO EMI-ERROR
 11670*        MOVE -1                 TO MAINTL
 11671*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11672*        COMPUTE W-TEMP-CURRENT-LINE
 11673*            = PI-TOTAL-LINES + 1 - W-NUM-LINES-PER-SCREEN
 11674*        IF  W-TEMP-CURRENT-LINE NEGATIVE
 11675*                OR
 11676*            W-TEMP-CURRENT-LINE = ZEROS
 11677*            MOVE 1 TO W-TEMP-CURRENT-LINE.
 11678
 11679     IF  EMI-ERROR NOT EQUAL ER-0191
 11680             AND
 11681         MAINTI NOT EQUAL 'S'
 11682         PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
 11683         PERFORM 4100-SET-NDX THRU 4100-EXIT
 11684         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11685                 VARYING
 11686             W-SC-NDX FROM 1 BY 1
 11687                 UNTIL
 11688             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11689
 11690     IF  EMI-ERROR EQUAL ER-0066 OR ER-0067 OR ER-0000 OR
 11691                         ER-0191
 11692         NEXT SENTENCE
 11693     ELSE
 11694         GO TO 8200-SEND-DATAONLY.
 11695
 11696     MOVE W-TEMP-CURRENT-LINE    TO PI-CURRENT-LINE
 11697     SET W-RG-NDX                TO PI-CURRENT-LINE
 11698     MOVE LOW-VALUES             TO EL689RI
 11699*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 239
* EL689.cbl
 11700     PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
 11701     SET W-RG-NDX                TO PI-CURRENT-LINE
 11702     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11703             VARYING
 11704         W-SC-NDX FROM 1 BY 1
 11705             UNTIL
 11706         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11707
 11708     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 240
* EL689.cbl
 11710 4100-SET-NDX.
 11711
 11712     IF  PI-CURRENT-LINE EQUAL 0
 11713         SET W-RG-NDX            TO 1
 11714     ELSE
 11715         SET W-RG-NDX            TO PI-CURRENT-LINE.
 11716
 11717 4100-EXIT.
 11718      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 241
* EL689.cbl
 11720 4200-UPDATE-TABLE-FROM-SCREEN.
 11721
 11722     IF  W-SC-TEXTL (W-SC-NDX) NOT EQUAL ZEROS
 11723         MOVE ZEROS              TO W-SC-TEXTL (W-SC-NDX)
 11724         IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11725             IF  PI-TOTAL-LINES EQUAL W-MAX-LINES
 11726                 MOVE ER-0051    TO EMI-ERROR
 11727                 MOVE -1         TO MAINTL
 11728                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11729                 GO TO 8200-SEND-DATAONLY
 11730             ELSE
 11731                 MOVE W-SC-TEXT (W-SC-NDX)
 11732                                 TO W-RC-TEXT (W-RG-NDX)
 11733                 ADD 1           TO PI-TOTAL-LINES
 11734         ELSE
 11735             MOVE W-SC-TEXT (W-SC-NDX)
 11736                                 TO W-RC-TEXT (W-RG-NDX).
 11737
 11738     SET W-RG-NDX UP BY 1.
 11739
 11740 4200-EXIT.
 11741      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 242
* EL689.cbl
 11743
 11744
 11745 4500-CONNECT-TO-DB.
 11746
 11747     MOVE 'NTCSO2_LOGIC'         TO SVR
 11748     MOVE 'sa'                   TO USR
 11749     MOVE 'ntcso2'               TO PASS
 11750
 11751     STRING
 11752         USR DELIMITED SPACE
 11753         "." DELIMITED SIZE
 11754         PASS DELIMITED SPACE INTO USR-PASS
 11755     END-STRING
 11756
 11757     EXEC SQL
 11758        CONNECT TO :SVR USER :USR-PASS
 11759     END-EXEC
 11760
 11761     IF SQLCODE NOT = 0
 11762        DISPLAY "ERROR: CANNOT CONNECT "
 11763        DISPLAY SQLCODE
 11764        DISPLAY SQLERRMC
 11765        GO TO 4500-EXIT
 11766     END-IF
 11767
 11768     .
 11769 4500-EXIT.
 11770     EXIT.
 11771
 11772
 11773
 11774 4600-GET-NEXT-BUS-DT.
 11775
 11776     MOVE W-SAVE-EDIT-A-DATE     TO WS-CYCLE-DATE
 11777     MOVE SPACES                 TO WS-NEXT-BUS-DT
 11778
 11779     IF WS-KIXHOST = 'logictest'
 11780        EXEC SQL
 11781          CALL NaperTestCalcNextBusDt
 11782                        @cycledate = :WS-CYCLE-DATE,
 11783                        @nextbusdate = :WS-NEXT-BUS-DT OUT
 11784        END-EXEC
 11785     ELSE
 11786        EXEC SQL
 11787          CALL NaperProdCalcNextBusDt
 11788                        @cycledate = :WS-CYCLE-DATE,
 11789                        @nextbusdate = :WS-NEXT-BUS-DT OUT
 11790        END-EXEC
 11791     END-IF
 11792
 11793     IF SQLCODE NOT = 0
 11794        DISPLAY "ERROR: DID NOT RETURN NEXT BUS DT "
 11795        DISPLAY ' SQL RETURN CODE ' SQLCODE
 11796        DISPLAY ' SQL ERR MESS    ' SQLERRMC
 11797        GO TO 4600-EXIT
 11798     END-IF
 11799
 11800     .
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 243
* EL689.cbl
 11801 4600-EXIT.
 11802     EXIT.
 11803
 11804
 11805
 11806 4700-DISCONNECT.
 11807
 11808     EXEC SQL
 11809        DISCONNECT
 11810     END-EXEC
 11811     .
 11812 4700-EXIT.
 11813     EXIT.
 11814
 11815 5000-EDIT-MODE.
 11816***************************************************************
 11817*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
 11818*    AND THE W-TS-TABLE OF LETTER TEXT.  IT WILL THEN         *
 11819*    TRANSFER TO THE W-TEXT-EDITOR PROGRAM.                   *
 11820***************************************************************
 11821
 11822     IF  PI-SHOW-MODE
 11823         MOVE ER-0188            TO EMI-ERROR
 11824         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11825         MOVE -1                 TO MAINTL
 11826         MOVE AL-UABON           TO MAINTA
 11827         GO TO 8200-SEND-DATAONLY.
 11828
 11829     IF  PI-CURRENT-LINE EQUAL ZEROS
 11830         MOVE ER-0187            TO EMI-ERROR
 11831         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11832         MOVE -1                 TO MAINTL
 11833         GO TO 8200-SEND-DATAONLY.
 11834
 11835     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11836     PERFORM 4100-SET-NDX THRU 4100-EXIT.
 11837     PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11838             VARYING
 11839         W-SC-NDX FROM 1 BY 1
 11840             UNTIL
 11841         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11842
 11843     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 11844
 11845     MOVE PI-689-FORM-NUMBER     TO PI-COMM-CONTROL.
 11846     MOVE ZEROS                  TO PI-UPDATE-SW.
 11847     MOVE '1'                    TO PI-ENTRY-CD-1.
 11848     MOVE W-PGM-EL1042           TO W-CALL-PGM.
 11849     GO TO 9400-XCTL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 244
* EL689.cbl
 11851 5400-LETTER-RELEASE.
 11852***************************************************************
 11853*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
 11854*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS IN       *
 11855*    THE ARCHIVE FILE.                                        *
 11856*    THE FUNCTIONS BELOW WILL BE PERFORMED.                   *
 11857*        1. CHECK SECURITY.                                   *
 11858*        2. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS.        *
 11859*        3. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
 11860*        4. WRITE THE NEW ARCHIVE RECORDS FROM W-TS-TABLE.    *
 11861*        5. RESET INSURED'S CONTROL FIELDS AND RETURN THE     *
 11862*           ARCHIVE NUMBER USED  TO FILE THE RECORDS.         *
 11863***************************************************************
 11864
 11865     IF  NOT MODIFY-CAP
 11866         MOVE ER-0070            TO EMI-ERROR
 11867         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11868         MOVE -1                 TO MAINTL
 11869         GO TO 8200-SEND-DATAONLY.
 11870
 11871     IF  PI-SHOW-MODE
 11872         MOVE ER-0188            TO EMI-ERROR
 11873         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11874         MOVE -1                 TO MAINTL
 11875         MOVE AL-UABON           TO MAINTA
 11876         GO TO 8200-SEND-DATAONLY.
 11877
 11878      IF  ARCHNUML GREATER THAN ZEROS
 11879          MOVE ER-9320            TO EMI-ERROR
 11880          MOVE -1                 TO ARCHNUML
 11881          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11882          GO TO 8200-SEND-DATAONLY.
 11883
 11884*     IF  PI-CURRENT-LINE EQUAL ZEROS
 11885*        MOVE ER-0187            TO EMI-ERROR
 11886*        MOVE -1                 TO MAINTL
 11887*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11888*        GO TO 8200-SEND-DATAONLY.
 11889
 11890*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11891*
 11892*    IF  NOT PI-689-CREATE-NO-SCREENS
 11893*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 11894*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11895*                VARYING
 11896*            W-SC-NDX FROM 1 BY 1
 11897*                UNTIL
 11898*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 11899*        IF  EMI-FATAL-CTR GREATER THAN ZEROS
 11900*                OR
 11901*            PI-689-FATAL-ERROR
 11902*            GO TO 8200-SEND-DATAONLY.
 11903*
 11904*    MOVE SPACES                 TO W-REMAINING-VAR-SW.
 11905*    PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 11906*            VARYING
 11907*        W-RVS-NDX FROM +1 BY +1
 11908*            UNTIL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 245
* EL689.cbl
 11909*        W-RVS-NDX > +36500
 11910*            OR
 11911*        W-REMAINING-VAR-FOUND.
 11912*
 11913*    IF  NOT PI-689-CREATE-NO-SCREENS
 11914*        IF  W-REMAINING-VAR-FOUND
 11915*            GO TO 4000-ROLL-PAGE.
 11916
 11917*    MOVE SPACES                 TO W-CNTL-KEY.
 11918*    MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11919*    MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11920*    MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 11921*
 11922*    EXEC CICS HANDLE CONDITION
 11923*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11924*         NOTFND     (5470-CNTL-NOT-FOUND)
 11925*    END-EXEC.
 11926*
 11927*    EXEC CICS READ
 11928*         DATASET    (W-CNTL-FILE-ID)
 11929*         SET        (ADDRESS OF CONTROL-FILE)
 11930*         RIDFLD     (W-CNTL-KEY)
 11931*         UPDATE
 11932*    END-EXEC.
 11933*
 11934*    IF  CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
 11935*        MOVE ZEROS              TO CF-CREDIT-LAST-ARCH-NUM
 11936*                                   CF-CREDIT-START-ARCH-NUM.
 11937*
 11938*    ADD 1                       TO CF-CREDIT-LAST-ARCH-NUM.
 11939*    MOVE CF-CREDIT-LAST-ARCH-NUM
 11940*                                TO W-ARCH-NUMBER
 11941*                                   W-ARCT-NUMBER.
 11942*
 11943*    EXEC CICS REWRITE
 11944*         FROM      (CONTROL-FILE)
 11945*         DATASET   (W-CNTL-FILE-ID)
 11946*    END-EXEC
 11947
 11948*    EXEC CICS HANDLE CONDITION
 11949*         NOTOPEN   (8010-ARCH-NOT-OPEN)
 11950*    END-EXEC.
 11951*
 11952*    EXEC CICS GETMAIN
 11953*       SET      (ADDRESS OF LETTER-ARCHIVE)
 11954*       LENGTH   (W-ARCH-LENGTH)
 11955*    END-EXEC
 11956*
 11957*    MOVE SPACES                 TO LETTER-ARCHIVE
 11958*    MOVE 'LA'                   TO LA-RECORD-ID.
 11959*    MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
 11960*                                   LA-ARCHIVE-NO-A2
 11961*                                   LA-ARCHIVE-NO-A3
 11962*                                   LA-ARCHIVE-NO-A4
 11963*                                   LA-ARCHIVE-NO-A5
 11964*                                   LA-ARCHIVE-NO-A6
 11965*                                   PI-689-ARCHIVE-NUMBER.
 11966*    MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 246
* EL689.cbl
 11967*                                   LA-COMPANY-CD-A2
 11968*                                   LA-COMPANY-CD-A3
 11969*                                   LA-COMPANY-CD-A4
 11970*                                   LA-COMPANY-CD-A5
 11971*                                   LA-COMPANY-CD-A6.
 11972*    MOVE PI-689-CARRIER         TO LA-CARRIER-A2
 11973*                                   LA-CARRIER-A3
 11974*                                   LA-CARRIER-A4
 11975*                                   LA-CARRIER-A5.
 11976*    MOVE PI-689-EFF-DATE        TO LA-EFFECT-DATE-A2.
 11977*    MOVE PI-689-GROUPING        TO LA-GROUPING-A2
 11978*                                   LA-GROUPING-A3
 11979*                                   LA-GROUPING-A4
 11980*                                   LA-GROUPING-A5.
 11981*    MOVE PI-689-ACCOUNT         TO LA-ACCOUNT-A2
 11982*                                   LA-ACCOUNT-A3
 11983*                                   LA-ACCOUNT-A4
 11984*                                   LA-ACCOUNT-A5.
 11985*    MOVE PI-689-STATE           TO LA-STATE-A2
 11986*                                   LA-STATE-A3
 11987*                                   LA-STATE-A4
 11988*                                   LA-STATE-A5.
 11989*
 11990*    IF  PI-689-DATA-SOURCE EQUAL '3'
 11991*            AND
 11992*        PI-689-RESP-PERSON GREATER THAN SPACES
 11993*        MOVE PI-689-RESP-PERSON
 11994*                                TO LA-RESP-PERSON-A2
 11995*        MOVE PI-689-TYPE        TO LA-TYPE-A2
 11996*    ELSE
 11997*        IF  PI-689-CERT-PRIME GREATER THAN SPACES
 11998*            MOVE PI-689-CERT-PRIME
 11999*                                TO LA-CERT-PRIME-A2
 12000*            MOVE PI-689-CERT-SFX
 12001*                                TO LA-CERT-SUFFIX-A2
 12002*        ELSE
 12003*            MOVE LOW-VALUE      TO LA-RESP-PERSON-A2
 12004*                                   LA-TYPE-A2.
 12005*
 12006*    IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 12007*        MOVE PI-689-ENTRY-BATCH TO LA-ENTRY-A6
 12008*        IF  PI-689-CONTROL GREATER THAN ZEROS
 12009*                AND
 12010*            PI-689-PRINT-RESTRICTION EQUAL 'C'
 12011*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 12012*            MOVE 'CK'           TO LA-FILLER
 12013*        ELSE
 12014*            NEXT SENTENCE
 12015*    ELSE
 12016*        IF  PI-689-CONTROL GREATER THAN ZEROS
 12017*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 12018*            MOVE 'CK'           TO LA-FILLER
 12019*        ELSE
 12020*            MOVE LOW-VALUES     TO LA-ENTRY-A6.
 12021*
 12022*    MOVE ZEROS                  TO W-SEQ-CTR.
 12023*
 12024*    MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 247
* EL689.cbl
 12025*
 12026*    MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
 12027*                                   LA-INITIAL-PRINT-DATE
 12028*                                   LA-SENT-DATE
 12029*                                   LA-REPLY-DATE.
 12030*    MOVE 'A'                    TO LA-STATUS.
 12031*
 12032*    IF  PI-689-NUMBER-COPIES NOT NUMERIC
 12033*            OR
 12034*        PI-689-NUMBER-COPIES EQUAL ZEROS
 12035*        MOVE  1                 TO LA-NO-OF-COPIES
 12036*    ELSE
 12037*        MOVE PI-689-NUMBER-COPIES
 12038*                                TO LA-NO-OF-COPIES.
 12039*
 12040*    MOVE PI-689-FORM-NUMBER     TO LA-FORM-A3.
 12041*    MOVE PI-689-FOLLOW-UP-DATE  TO LA-FOLLOW-UP-DATE.
 12042*    MOVE PI-689-PRINT-RESTRICTION
 12043*                                TO LA-PRINT-RESTRICTION
 12044*    MOVE PI-689-LABEL-SOURCE    TO LA-ADDR-SOURCE.
 12045*    MOVE PI-689-DATA-SOURCE     TO LA-DATA-SOURCE.
 12046*    MOVE PI-689-RESEND-DATE-1   TO LA-RESEND-DATE
 12047*    MOVE PI-689-RESEND-LETR-1   TO LA-RESEND-LETR
 12048*    MOVE W-CURRENT-SAVE         TO LA-CREATION-DATE.
 12049*
 12050*    IF  PI-689-PRINT-PERFORMED
 12051*        MOVE SPACES             TO PI-689-PRINT-SW
 12052*        MOVE W-CURRENT-SAVE     TO LA-INITIAL-PRINT-DATE
 12053*        IF  LA-RESEND-DATE = LOW-VALUES
 12054*            MOVE 'C'            TO LA-STATUS.
 12055*
 12056*    MOVE PI-689-NUMBER-LABEL-LINES
 12057*                                TO LA-NUMBER-LABEL-LINES.
 12058*    MOVE ZEROS                  TO PI-689-NUMBER-TEXT-RECORDS.
 12059*
 12060*    PERFORM 5410-CREATE-TEXT-RECORDS THRU 5410-EXIT.
 12061*
 12062*    MOVE PI-689-NUMBER-TEXT-RECORDS
 12063*    MOVE ZEROS                  TO LA-NO-OF-TEXT-RECORDS.
 12064*
 12065*    EXEC CICS HANDLE CONDITION
 12066*        DUPREC    (5460-DUPLICATE-ARCHIVE-RCD)
 12067*    END-EXEC.
 12068*
 12069*    PERFORM 5650-WRITE-ARCHIVE THRU 5650-EXIT.
 12070*    MOVE ER-0280                TO EMI-ERROR.
 12071*    MOVE -1                     TO MAINTL.
 12072*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12073*    MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 12074*    MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1).
 12075     .
 12076 5400-END.
 12077     DISPLAY ' MADE IT TO 5400 '
 12078     MOVE SPACES                 TO BL-INPUT
 12079     MOVE ZEROS                  TO BL-ARCHIVE-NO
 12080     MOVE PI-689-DATA-SOURCE     TO BL-DATA-SRCE
 12081     MOVE PI-689-CARRIER         TO BL-CARRIER
 12082     MOVE PI-689-GROUPING        TO BL-GROUP
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 248
* EL689.cbl
 12083     MOVE PI-689-STATE           TO BL-STATE
 12084     MOVE PI-689-ACCOUNT         TO BL-ACCOUNT
 12085     IF PI-689-EFF-DATE NOT = LOW-VALUES
 12086        MOVE PI-689-EFF-DATE     TO DC-BIN-DATE-1
 12087        MOVE ' '                 TO DC-OPTION-CODE
 12088        PERFORM 9500-LINK-DATE-CONVERT
 12089                                 THRU 9500-EXIT
 12090        IF NO-CONVERSION-ERROR
 12091           MOVE DC-GREG-DATE-1-EDIT
 12092                                 TO BL-EFF-DT
 12093        END-IF
 12094     END-IF
 12095     MOVE PI-689-CERT-NO         TO BL-CERT-NO
 12096     MOVE PI-689-ENTRY-BATCH     TO BL-BATCH-NO
 12097     MOVE PI-689-SEQ-NO          TO BL-BATCH-SEQ
 12098     MOVE PI-689-RESP-PERSON     TO BL-RESP-NO
 12099     MOVE PI-689-FORM-NUMBER     TO BL-LETTER-ID
 12100     MOVE PI-689-NUMBER-COPIES   TO BL-NO-OF-COPIES
 12101     IF PI-ENDT-ARCH-NO > ZERO
 12102         MOVE PI-ENDT-ARCH-NO    TO BL-ENDT-ARCH-NO
 12103     END-IF
 12104     MOVE 'LETTER  '             TO BL-SOURCE-SCREEN
 12105     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
 12106*    MOVE 'ALWA'                 TO BL-PROC-ID
 12107     MOVE PI-COMPANY-ID          TO BL-COMP-ID
 12108*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
 12109     MOVE PI-ENCLOSURE-CD        TO BL-ENC-CD
 12110     IF PI-689-RESEND-DATE-1 NOT = LOW-VALUES
 12111        MOVE PI-689-RESEND-DATE-1 TO DC-BIN-DATE-1
 12112        MOVE ' '                 TO DC-OPTION-CODE
 12113        PERFORM 9500-LINK-DATE-CONVERT
 12114                                 THRU 9500-EXIT
 12115        IF NO-CONVERSION-ERROR
 12116           MOVE DC-GREG-DATE-B-EDIT
 12117                                 TO BL-RESEND-DT
 12118        END-IF
 12119     END-IF
 12120     IF PI-689-FOLLOW-UP-DATE NOT = LOW-VALUES
 12121        MOVE PI-689-FOLLOW-UP-DATE TO DC-BIN-DATE-1
 12122        MOVE ' '                 TO DC-OPTION-CODE
 12123        PERFORM 9500-LINK-DATE-CONVERT
 12124                                 THRU 9500-EXIT
 12125        IF NO-CONVERSION-ERROR
 12126           MOVE DC-GREG-DATE-B-EDIT
 12127                                 TO BL-FOLLOW-UP-DT
 12128        END-IF
 12129     END-IF
 12130*    MOVE IFF-COMMENTS           TO BL-COMMENTS
 12131*    MOVE 'TEST COMMENTS'        TO BL-COMMENTS
 12132     MOVE PI-CERT-FORM-ID        TO BL-CERT-FORM-ID
 12133     if eibaid = dfhpf7
 12134        move 'B'                 TO BL-WRITE-ERARCH
 12135     else
 12136        move 'T'                 to bl-write-erarch
 12137     end-if
 12138    DISPLAY ' ABOUT TO LINK TO NSRASBL '
 12139*****************************************
 12140* Invoke the LETTER business logic
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 249
* EL689.cbl
 12141*****************************************
 12142
 12143* exec cics link
 12144*       program('NSRASBL')
 12145*       commarea(srch-commarea)
 12146*    end-exec.
 12147     MOVE LENGTH OF
 12148      srch-commarea
 12149       TO DFHEIV11
 12150     MOVE 'NSRASBL' TO DFHEIV1
 12151*    MOVE '."C                   (   #00011724' TO DFHEIV0
 12152     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12153     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12154     MOVE X'2020233030303131373234' TO DFHEIV0(25:11)
 12155     CALL 'kxdfhei1' USING DFHEIV0,
 12156           DFHEIV1,
 12157           srch-commarea,
 12158           DFHEIV11,
 12159           DFHEIV99,
 12160           DFHEIV99,
 12161           DFHEIV99,
 12162           DFHEIV99
 12163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12164
 12165     DISPLAY ' MADE IT BACK FROM NSRASBL ' bl-status ' '
 12166        bl-message ' ' bl-archive-no
 12167     move bl-archive-no to w-arch-number
 12168
 12169     if eibaid = dfhpf7
 12170        PERFORM 5440-ADD-BILLING-NOTE THRU 5440-EXIT
 12171        MOVE ER-0280                TO EMI-ERROR
 12172        MOVE -1                     TO MAINTL
 12173        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12174        MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 12175        MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1)
 12176        MOVE '2'                    TO PI-ACTION
 12177        MOVE ZEROS                  TO PI-TOTAL-LINES
 12178                                       PI-CURRENT-LINE
 12179        MOVE SPACES                 TO PI-689-PRINT-SW
 12180                                       PI-689-FORM-NUMBER
 12181        GO TO 9300-DFHCLEAR
 12182     else
 12183        move w-arch-number          to archnumo
 12184        MOVE ER-1818                TO EMI-ERROR
 12185        MOVE -1                     TO MAINTL
 12186        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12187     end-if
 12188     MOVE -1                     TO MAINTL
 12189     GO TO 8200-SEND-DATAONLY
 12190     .
 12191 5400-EXIT.
 12192     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 250
* EL689.cbl
 12194 5410-CREATE-TEXT-RECORDS.
 12195
 12196*    EXEC CICS HANDLE CONDITION
 12197*         NOTOPEN   (8015-ARCT-NOT-OPEN)
 12198*         DUPREC    (5465-DUPLICATE-ARCH-TEXT)
 12199*    END-EXEC.
 12200*
 12201*    IF  PI-689-CREATE-NO-SCREENS
 12202*        IF  PI-689-GET-ARCT-MAIN
 12203*            EXEC CICS GETMAIN
 12204*                 SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 12205*                 LENGTH   (W-ARCT-LENGTH)
 12206*            END-EXEC
 12207*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF
 12208*                                    LETTER-ARCHIVE-TEXT
 12209*            MOVE LCP-WS-ADDR-COMP
 12210*                                TO PI-689-ARCT-POINTER
 12211*        ELSE
 12212*            MOVE PI-689-ARCT-POINTER
 12213*                                TO LCP-WS-ADDR-COMP
 12214*            SET ADDRESS OF LETTER-ARCHIVE-TEXT
 12215*                                TO LCP-WS-ADDR-PNTR
 12216*    ELSE
 12217*        EXEC CICS GETMAIN
 12218*             SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 12219*             LENGTH   (W-ARCT-LENGTH)
 12220*        END-EXEC.
 12221*
 12222*    PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 12223*
 12224*    MOVE ZEROS                  TO W-SEQ-CTR
 12225*
 12226*    IF  PI-CREATE-LABELS AND
 12227*        NOT PI-689-LABELS-OVERRIDEN
 12228*        MOVE '1'                TO LT-RECORD-TYPE
 12229*        MOVE +0                 TO LT-LINE-SEQ-NO
 12230*        PERFORM 5600-FORMAT-ADDRESS-LINE THRU 5600-EXIT
 12231*                VARYING
 12232*            W-RG-NDX FROM 1 BY 1
 12233*                UNTIL
 12234*            W-RG-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 12235*        PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12236*        PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT
 12237*    ELSE
 12238*        SET W-RG-NDX            TO +1.
 12239*
 12240*    SET LT-NDX                  TO W-ZEROS.
 12241*
 12242*    PERFORM 5500-FORMAT-TEXT THRU 5500-EXIT
 12243*            VARYING
 12244*        W-RG-NDX FROM W-RG-NDX BY +1
 12245*            UNTIL
 12246*        W-RG-NDX GREATER THAN PI-TOTAL-LINES.
 12247
 12248 5410-EXIT.
 12249     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 251
* EL689.cbl
 12251 5415-INITIALIZE-TEXT.
 12252
 12253     MOVE SPACES                 TO LETTER-ARCHIVE-TEXT.
 12254     MOVE 'LT'                   TO LT-RECORD-ID.
 12255
 12256     MOVE LA-ARCHIVE-NO          TO LT-ARCHIVE-NO.
 12257     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
 12258
 12259     MOVE ZEROS                  TO LT-LINE-SEQ-NO
 12260                                    LT-NUM-LINES-ON-RECORD.
 12261
 12262 5415-EXIT.
 12263     EXIT.
 12264
 12265 5440-ADD-BILLING-NOTE.
 12266
 12267     MOVE LOW-VALUES             TO W-ELEOBC-KEY
 12268     MOVE PI-COMPANY-CD          TO W-EOBC-COMPANY-CD
 12269     MOVE '5'                    TO W-EOBC-REC-TYPE
 12270
 12271
 12272* EXEC CICS STARTBR
 12273*        DATASET   ('ELEOBC')
 12274*        RIDFLD    (W-ELEOBC-KEY)
 12275*        GTEQ
 12276*        RESP      (W-RESPONSE)
 12277*    END-EXEC
 12278     MOVE 'ELEOBC' TO DFHEIV1
 12279     MOVE 0
 12280       TO DFHEIV11
 12281*    MOVE '&,         G          &  N#00011834' TO DFHEIV0
 12282     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12283     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12284     MOVE X'204E233030303131383334' TO DFHEIV0(25:11)
 12285     CALL 'kxdfhei1' USING DFHEIV0,
 12286           DFHEIV1,
 12287           W-ELEOBC-KEY,
 12288           DFHEIV99,
 12289           DFHEIV11,
 12290           DFHEIV99
 12291     MOVE EIBRESP  TO W-RESPONSE
 12292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12293
 12294     IF NOT RESP-NORMAL
 12295        GO TO 5440-EXIT
 12296     END-IF
 12297      .
 12298 5440-READNEXT-ELEOBC.
 12299
 12300
 12301* EXEC CICS READNEXT
 12302*       INTO    (EOB-CODES)
 12303*       DATASET ('ELEOBC')
 12304*       RIDFLD  (W-ELEOBC-KEY)
 12305*       RESP    (W-RESPONSE)
 12306*    END-EXEC
 12307     MOVE LENGTH OF
 12308      EOB-CODES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 252
* EL689.cbl
 12309       TO DFHEIV12
 12310     MOVE 'ELEOBC' TO DFHEIV1
 12311     MOVE 0
 12312       TO DFHEIV11
 12313*    MOVE '&.IL                  )  N#00011847' TO DFHEIV0
 12314     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12315     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12316     MOVE X'204E233030303131383437' TO DFHEIV0(25:11)
 12317     CALL 'kxdfhei1' USING DFHEIV0,
 12318           DFHEIV1,
 12319           EOB-CODES,
 12320           DFHEIV12,
 12321           W-ELEOBC-KEY,
 12322           DFHEIV99,
 12323           DFHEIV11,
 12324           DFHEIV99,
 12325           DFHEIV99
 12326     MOVE EIBRESP  TO W-RESPONSE
 12327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12328
 12329     IF RESP-NORMAL
 12330         IF EO-RECORD-TYPE NOT = '5'
 12331             GO TO 5440-EXIT
 12332         END-IF
 12333     ELSE
 12334         GO TO 5440-EXIT
 12335     END-IF
 12336
 12337     IF EO-RECORD-TYPE = '5' AND
 12338        EO-EOB-CODE = PI-689-FORM-NUMBER
 12339           CONTINUE
 12340     ELSE
 12341         GO TO 5440-READNEXT-ELEOBC
 12342     END-IF
 12343
 12344     MOVE SPACES TO W-BILLING-NOTE
 12345     MOVE EO-DESCRIPTION TO W-BN-NOTE
 12346     MOVE PI-689-FORM-NUMBER TO W-BN-LTRID
 12347     MOVE W-SAVE-DATE TO W-BN-DATE
 12348     MOVE PI-PROCESSOR-ID TO W-BN-USERID
 12349     MOVE +25 TO W-LEN
 12350
 12351     PERFORM 5441-UPDATE-BILLING-NOTE THRU 5441-EXIT
 12352     .
 12353 5440-EXIT.
 12354     EXIT.
 12355
 12356 5441-UPDATE-BILLING-NOTE.
 12357
 12358     MOVE PI-COMPANY-CD          TO W-SV-COMPANY-CD
 12359     MOVE PI-689-CARRIER         TO W-SV-CARRIER
 12360     MOVE PI-689-GROUPING        TO W-SV-GROUPING
 12361     MOVE PI-689-STATE           TO W-SV-STATE
 12362     MOVE PI-689-ACCOUNT         TO W-SV-ACCOUNT
 12363     MOVE PI-689-EFF-DATE        TO W-SV-CERT-EFF-DT
 12364     MOVE PI-689-CERT-PRIME      TO W-SV-CERT-PRIME
 12365     MOVE PI-689-CERT-SFX        TO W-SV-CERT-SFX
 12366     MOVE W-SAVE-KEY             TO W-ERNOTE-KEY
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 253
* EL689.cbl
 12367
 12368
 12369* EXEC CICS READ
 12370*       DATASET    (W-NOTE-FILE-ID)
 12371*       RIDFLD     (W-ERNOTE-KEY)
 12372*       INTO       (CERTIFICATE-NOTE)
 12373*       RESP       (W-RESPONSE)
 12374*       UPDATE
 12375*    END-EXEC
 12376     MOVE LENGTH OF
 12377      CERTIFICATE-NOTE
 12378       TO DFHEIV11
 12379*    MOVE '&"IL       EU         (  N#00011893' TO DFHEIV0
 12380     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12381     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12382     MOVE X'204E233030303131383933' TO DFHEIV0(25:11)
 12383     CALL 'kxdfhei1' USING DFHEIV0,
 12384           W-NOTE-FILE-ID,
 12385           CERTIFICATE-NOTE,
 12386           DFHEIV11,
 12387           W-ERNOTE-KEY,
 12388           DFHEIV99,
 12389           DFHEIV99,
 12390           DFHEIV99
 12391     MOVE EIBRESP  TO W-RESPONSE
 12392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12393
 12394     IF RESP-NORMAL
 12395       IF CN-BILLING-START-LINE-NO NOT NUMERIC
 12396          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 12397       END-IF
 12398       IF CN-BILLING-END-LINE-NO NOT NUMERIC
 12399          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 12400       END-IF
 12401       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 12402           (NOTE-SUB > +10) OR
 12403           (CN-LINE (NOTE-SUB) (1:W-LEN) =
 12404                             W-BILLING-NOTE (1:W-LEN))
 12405       END-PERFORM
 12406       IF CN-LINE (NOTE-SUB) (1:W-LEN) =
 12407                              W-BILLING-NOTE (1:W-LEN)
 12408
 12409* EXEC CICS UNLOCK
 12410*           DATASET    (W-NOTE-FILE-ID)
 12411*        END-EXEC
 12412*    MOVE '&*                    #   #00011915' TO DFHEIV0
 12413     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12414     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12415     MOVE X'2020233030303131393135' TO DFHEIV0(25:11)
 12416     CALL 'kxdfhei1' USING DFHEIV0,
 12417           W-NOTE-FILE-ID,
 12418           DFHEIV99
 12419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12420       ELSE
 12421         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 12422           (NOTE-SUB > +10) OR
 12423           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
 12424         END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 254
* EL689.cbl
 12425         IF (NOTE-SUB < +11)
 12426           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
 12427              NOTE-SUB <= CN-BILLING-END-LINE-NO
 12428                MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 12429           ELSE
 12430             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 12431              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
 12432                MOVE W-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
 12433                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
 12434             ELSE
 12435               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 12436                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
 12437                     MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 12438                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
 12439               ELSE
 12440                 IF (CN-BILLING-END-LINE-NO = ZEROS)
 12441                   MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
 12442                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
 12443                                       CN-BILLING-START-LINE-NO
 12444                 ELSE
 12445                    PERFORM 5442-SQUEEZE-IT-IN THRU 5442-EXIT
 12446                 END-IF
 12447               END-IF
 12448             END-IF
 12449           END-IF
 12450           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 12451           MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 12452           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12453
 12454* EXEC CICS REWRITE
 12455*             DATASET    (W-NOTE-FILE-ID)
 12456*             FROM       (CERTIFICATE-NOTE)
 12457*             RESP       (W-RESPONSE)
 12458*          END-EXEC
 12459     MOVE LENGTH OF
 12460      CERTIFICATE-NOTE
 12461       TO DFHEIV11
 12462*    MOVE '&& L                  %  N#00011951' TO DFHEIV0
 12463     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12464     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12465     MOVE X'204E233030303131393531' TO DFHEIV0(25:11)
 12466     CALL 'kxdfhei1' USING DFHEIV0,
 12467           W-NOTE-FILE-ID,
 12468           CERTIFICATE-NOTE,
 12469           DFHEIV11,
 12470           DFHEIV99
 12471     MOVE EIBRESP  TO W-RESPONSE
 12472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12473           PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12474         END-IF
 12475       END-IF
 12476     ELSE
 12477        MOVE SPACES              TO CERTIFICATE-NOTE
 12478        MOVE 'CN'                TO CN-RECORD-ID
 12479        MOVE W-SAVE-KEY          TO CN-CONTROL-PRIMARY
 12480                                    W-ERNOTE-KEY
 12481        MOVE 01                  TO CN-BILLING-START-LINE-NO
 12482                                    CN-BILLING-END-LINE-NO
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 255
* EL689.cbl
 12483        MOVE W-BILLING-NOTE      TO CN-LINE (01)
 12484        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 12485        MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 12486        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12487
 12488* EXEC CICS WRITE
 12489*          DATASET    (W-NOTE-FILE-ID)
 12490*          FROM       (CERTIFICATE-NOTE)
 12491*          RIDFLD     (W-ERNOTE-KEY)
 12492*          RESP       (W-RESPONSE)
 12493*       END-EXEC
 12494     MOVE LENGTH OF
 12495      CERTIFICATE-NOTE
 12496       TO DFHEIV11
 12497*    MOVE '&$ L                  ''  N#00011970' TO DFHEIV0
 12498     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12499     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12500     MOVE X'204E233030303131393730' TO DFHEIV0(25:11)
 12501     CALL 'kxdfhei1' USING DFHEIV0,
 12502           W-NOTE-FILE-ID,
 12503           CERTIFICATE-NOTE,
 12504           DFHEIV11,
 12505           W-ERNOTE-KEY,
 12506           DFHEIV99,
 12507           DFHEIV99
 12508     MOVE EIBRESP  TO W-RESPONSE
 12509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12510
 12511        PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12512     END-IF
 12513
 12514     .
 12515 5441-EXIT.
 12516     EXIT.
 12517
 12518
 12519 5442-SQUEEZE-IT-IN.
 12520
 12521     IF NOTE-SUB < CN-BILLING-START-LINE-NO
 12522        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
 12523           NOTE-SUB = +10
 12524           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
 12525           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
 12526             MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
 12527             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
 12528             MOVE +9 TO NOTE-SUB
 12529           END-IF
 12530        END-PERFORM
 12531     ELSE
 12532        IF NOTE-SUB > CN-BILLING-END-LINE-NO
 12533           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
 12534             UNTIL NOTE-SUB = +1
 12535             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
 12536             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
 12537                MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
 12538                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
 12539                MOVE +2          TO NOTE-SUB
 12540             END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 256
* EL689.cbl
 12541           END-PERFORM
 12542        END-IF
 12543     END-IF
 12544
 12545     .
 12546 5442-EXIT.
 12547     EXIT.
 12548
 12549 5445-CERTIFICATE-UPDATE.
 12550
 12551     MOVE W-SAVE-KEY         TO W-CERT-KEY
 12552
 12553
 12554* EXEC CICS READ
 12555*        DATASET  (W-CERT-FILE-ID)
 12556*        RIDFLD   (W-CERT-KEY)
 12557*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 12558*        RESP     (W-RESPONSE)
 12559*        UPDATE
 12560*    END-EXEC
 12561*    MOVE '&"S        EU         (  N#00012019' TO DFHEIV0
 12562     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12563     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12564     MOVE X'204E233030303132303139' TO DFHEIV0(25:11)
 12565     CALL 'kxdfhei1' USING DFHEIV0,
 12566           W-CERT-FILE-ID,
 12567           DFHEIV20,
 12568           DFHEIV99,
 12569           W-CERT-KEY,
 12570           DFHEIV99,
 12571           DFHEIV99,
 12572           DFHEIV99
 12573     SET ADDRESS OF CERTIFICATE-MASTER TO
 12574         DFHEIV20
 12575     MOVE EIBRESP  TO W-RESPONSE
 12576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12577
 12578     IF RESP-NORMAL
 12579        EVALUATE CM-NOTE-SW
 12580           WHEN '2'
 12581           WHEN '3'
 12582           WHEN '6'
 12583           WHEN '7'
 12584              SET NO-CERT-RW     TO TRUE
 12585           WHEN ' '
 12586              MOVE '2'           TO CM-NOTE-SW
 12587           WHEN '1'
 12588              MOVE '3'           TO CM-NOTE-SW
 12589           WHEN '4'
 12590              MOVE '6'           TO CM-NOTE-SW
 12591           WHEN '5'
 12592              MOVE '7'           TO CM-NOTE-SW
 12593        END-EVALUATE
 12594     END-IF
 12595     IF NOT NO-CERT-RW
 12596
 12597* EXEC CICS REWRITE
 12598*          FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 257
* EL689.cbl
 12599*          DATASET  (W-CERT-FILE-ID)
 12600*          RESP     (W-RESPONSE)
 12601*       END-EXEC
 12602     MOVE LENGTH OF
 12603      CERTIFICATE-MASTER
 12604       TO DFHEIV11
 12605*    MOVE '&& L                  %  N#00012045' TO DFHEIV0
 12606     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12607     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12608     MOVE X'204E233030303132303435' TO DFHEIV0(25:11)
 12609     CALL 'kxdfhei1' USING DFHEIV0,
 12610           W-CERT-FILE-ID,
 12611           CERTIFICATE-MASTER,
 12612           DFHEIV11,
 12613           DFHEIV99
 12614     MOVE EIBRESP  TO W-RESPONSE
 12615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12616     ELSE
 12617
 12618* EXEC CICS UNLOCK
 12619*          DATASET  (W-CERT-FILE-ID)
 12620*       END-EXEC
 12621*    MOVE '&*                    #   #00012051' TO DFHEIV0
 12622     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12623     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12624     MOVE X'2020233030303132303531' TO DFHEIV0(25:11)
 12625     CALL 'kxdfhei1' USING DFHEIV0,
 12626           W-CERT-FILE-ID,
 12627           DFHEIV99
 12628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12629     END-IF
 12630
 12631     .
 12632 5445-EXIT.
 12633     EXIT.
 12634
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 258
* EL689.cbl
 12636 5460-DUPLICATE-ARCHIVE-RCD.
 12637
 12638     IF  NOT PI-689-CREATE-NO-SCREENS
 12639
 12640* EXEC CICS SYNCPOINT ROLLBACK
 12641*        END-EXEC.
 12642*    MOVE '6"R                   !   #00012064' TO DFHEIV0
 12643     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12644     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12645     MOVE X'2020233030303132303634' TO DFHEIV0(25:11)
 12646     CALL 'kxdfhei1' USING DFHEIV0
 12647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12648
 12649
 12650     MOVE ER-9426                TO EMI-ERROR.
 12651     MOVE -1                     TO MAINTL.
 12652     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12653     GO TO 8200-SEND-DATAONLY.
 12654
 12655 5465-DUPLICATE-ARCH-TEXT.
 12656
 12657     IF  NOT PI-689-CREATE-NO-SCREENS
 12658
 12659* EXEC CICS SYNCPOINT ROLLBACK
 12660*        END-EXEC.
 12661*    MOVE '6"R                   !   #00012075' TO DFHEIV0
 12662     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12664     MOVE X'2020233030303132303735' TO DFHEIV0(25:11)
 12665     CALL 'kxdfhei1' USING DFHEIV0
 12666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12667
 12668
 12669     MOVE ER-7369                TO EMI-ERROR.
 12670     MOVE -1                     TO MAINTL.
 12671     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12672     GO TO 8200-SEND-DATAONLY.
 12673
 12674 5470-CNTL-NOT-FOUND.
 12675
 12676     MOVE ER-9299                TO EMI-ERROR.
 12677     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12678     MOVE -1                     TO MAINTL.
 12679     MOVE AL-UANON               TO MAINTA.
 12680     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 259
* EL689.cbl
 12682 5500-FORMAT-TEXT.
 12683
 12684     SET LT-NDX UP BY +1.
 12685
 12686     IF  W-RC-TEXT (W-RG-NDX) EQUAL W-TOP-FORM
 12687         SET W-RG-NDX UP BY 1
 12688         MOVE 99                 TO LT-SKIP-CONTROL (LT-NDX)
 12689         MOVE W-RC-TEXT (W-RG-NDX)
 12690                                 TO LT-TEXT-LINE (LT-NDX)
 12691     ELSE
 12692         IF  W-RC-TEXT (W-RG-NDX) EQUAL SPACES
 12693             MOVE ZEROS          TO W-PRINT-CONTROL
 12694             PERFORM 5505-FIND-USED-LINE THRU 5505-EXIT
 12695                     VARYING
 12696                 W-RG-NDX FROM W-RG-NDX BY 1
 12697                     UNTIL
 12698                 W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12699                     OR
 12700                 W-RC-TEXT (W-RG-NDX) GREATER THAN SPACES
 12701             IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12702                 GO TO 5500-WRITE-TEST
 12703             ELSE
 12704                 MOVE W-PRINT-CONTROL
 12705                                 TO LT-SKIP-CONTROL (LT-NDX)
 12706                 MOVE W-RC-TEXT (W-RG-NDX)
 12707                                 TO LT-TEXT-LINE (LT-NDX)
 12708         ELSE
 12709             MOVE W-RC-TEXT (W-RG-NDX)
 12710                                 TO LT-TEXT-LINE (LT-NDX)
 12711             MOVE ZEROS          TO W-PRINT-CONTROL.
 12712
 12713     ADD +1                      TO LT-NUM-LINES-ON-RECORD.
 12714
 12715 5500-WRITE-TEST.
 12716
 12717     IF  W-RG-NDX NOT LESS THAN PI-TOTAL-LINES
 12718         IF  LT-TEXT-RECORD NOT EQUAL SPACES
 12719             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12720             MOVE '2'            TO LT-RECORD-TYPE
 12721             ADD +1              TO W-SEQ-CTR
 12722             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12723             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12724         ELSE
 12725             NEXT SENTENCE
 12726     ELSE
 12727         IF  LT-NDX EQUAL +20
 12728             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12729             MOVE '2'            TO LT-RECORD-TYPE
 12730             ADD +1              TO W-SEQ-CTR
 12731             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12732             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12733             SET LT-NDX          TO W-ZEROS
 12734             PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 12735
 12736 5500-EXIT.
 12737      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 260
* EL689.cbl
 12739 5505-FIND-USED-LINE.
 12740
 12741     ADD +1                      TO W-PRINT-CONTROL.
 12742
 12743 5505-EXIT.
 12744      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 261
* EL689.cbl
 12746 5600-FORMAT-ADDRESS-LINE.
 12747
 12748     SET LT-NDX                  TO W-RG-NDX.
 12749     MOVE W-RC-TEXT (W-RG-NDX)   TO LT-TEXT-LINE (LT-NDX).
 12750
 12751 5600-EXIT.
 12752     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 262
* EL689.cbl
 12754 5650-WRITE-ARCHIVE.
 12755
 12756
 12757* EXEC CICS WRITE
 12758*         DATASET   (W-ARCH-FILE-ID)
 12759*         FROM      (LETTER-ARCHIVE)
 12760*         RIDFLD    (LA-CONTROL-PRIMARY)
 12761*    END-EXEC.
 12762     MOVE LENGTH OF
 12763      LETTER-ARCHIVE
 12764       TO DFHEIV11
 12765*    MOVE '&$ L                  ''   #00012165' TO DFHEIV0
 12766     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12767     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12768     MOVE X'2020233030303132313635' TO DFHEIV0(25:11)
 12769     CALL 'kxdfhei1' USING DFHEIV0,
 12770           W-ARCH-FILE-ID,
 12771           LETTER-ARCHIVE,
 12772           DFHEIV11,
 12773           LA-CONTROL-PRIMARY,
 12774           DFHEIV99,
 12775           DFHEIV99
 12776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12777
 12778
 12779 5650-EXIT.
 12780     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 263
* EL689.cbl
 12782 5655-WRITE-ARCHIVE-TEXT.
 12783
 12784
 12785* EXEC CICS WRITE
 12786*         DATASET   (W-ARCT-FILE-ID)
 12787*         FROM      (LETTER-ARCHIVE-TEXT)
 12788*         RIDFLD    (LT-CONTROL-PRIMARY)
 12789*    END-EXEC.
 12790     MOVE LENGTH OF
 12791      LETTER-ARCHIVE-TEXT
 12792       TO DFHEIV11
 12793*    MOVE '&$ L                  ''   #00012176' TO DFHEIV0
 12794     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12795     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12796     MOVE X'2020233030303132313736' TO DFHEIV0(25:11)
 12797     CALL 'kxdfhei1' USING DFHEIV0,
 12798           W-ARCT-FILE-ID,
 12799           LETTER-ARCHIVE-TEXT,
 12800           DFHEIV11,
 12801           LT-CONTROL-PRIMARY,
 12802           DFHEIV99,
 12803           DFHEIV99
 12804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12805
 12806
 12807 5655-EXIT.
 12808     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 264
* EL689.cbl
 12810 6000-RESOLVE-VARIABLES.
 12811***************************************************************
 12812*    THIS ROUTINE WILL FORMAT THE SYSTEM DEFINED SYMBOLS      *
 12813*    WITH DATA PERTAINING TO THE FORM WITH VARIABLES.         *
 12814*    THIS ROUTINE IS PERFORM THRU 6000-EXIT IN ORDER TO       *
 12815*    RESOLVE ALL OF THE SYMBOLS.                              *
 12816*                                                             *
 12817***************************************************************
 12818
 12819     PERFORM 6200-GET-COMPANY-DATA THRU 6200-EXIT.
 12820     PERFORM 6250-GET-CNTL2-DATA THRU 6250-EXIT.
 12821     PERFORM 6400-GET-PENDING-DATA THRU 6400-EXIT.
 12822     PERFORM 6450-GET-CERT-DATA THRU 6450-EXIT.
 12823     PERFORM 6500-GET-ACCOUNT-DATA THRU 6500-EXIT
 12824*    PERFORM 6350-GET-CSR-DATA   THRU 6350-EXIT
 12825     PERFORM 6600-GET-COMPENSATION-DATA THRU 6600-EXIT.
 12826     PERFORM 6700-GET-MAIL-DATA THRU 6700-EXIT.
 12827     PERFORM 6300-GET-CARRIER-DATA THRU 6300-EXIT.
 12828     PERFORM 6750-GET-LIFE-BENEFIT-DATA THRU 6750-EXIT.
 12829     PERFORM 6800-GET-A-H-BENEFIT-DATA THRU 6800-EXIT.
 12830     PERFORM 6850-GET-CHECK-DATA THRU 6850-EXIT.
 12831     PERFORM 6900-GET-PYAJ-DATA THRU 6900-EXIT.
 12832     PERFORM 6950-MOVE-SYSTEM-DATA THRU 6950-EXIT.
 12833
 12834     MOVE SPACES                 TO W-REVERSE-DATE-SW.
 12835
 12836 6000-EXIT.
 12837     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 265
* EL689.cbl
 12839 6200-GET-COMPANY-DATA.
 12840
 12841     IF  ADDRSI EQUAL '3'
 12842             AND
 12843         PI-CREATE-LABELS
 12844             AND
 12845         NOT PI-689-LABELS-OVERRIDEN
 12846         NEXT SENTENCE
 12847     ELSE
 12848         IF  W-FILE-NOT-USED (1)
 12849             GO TO 6200-EXIT.
 12850
 12851     MOVE SPACES                 TO W-CNTL-KEY.
 12852     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12853     MOVE +0                     TO W-CNTL-SEQ-NO.
 12854     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 12855
 12856
 12857* EXEC CICS HANDLE CONDITION
 12858*         NOTOPEN   (8040-CNTL-NOT-OPEN)
 12859*         NOTFND    (6200-CNTL1-NOT-FOUND)
 12860*    END-EXEC.
 12861*    MOVE '"$JI                  ! + #00012231' TO DFHEIV0
 12862     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12864     MOVE X'2B20233030303132323331' TO DFHEIV0(25:11)
 12865     CALL 'kxdfhei1' USING DFHEIV0
 12866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12867
 12868
 12869
 12870* EXEC CICS READ
 12871*         DATASET   (W-CNTL-FILE-ID)
 12872*         SET       (ADDRESS OF CONTROL-FILE)
 12873*         RIDFLD    (W-CNTL-KEY)
 12874*    END-EXEC.
 12875*    MOVE '&"S        E          (   #00012236' TO DFHEIV0
 12876     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12877     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12878     MOVE X'2020233030303132323336' TO DFHEIV0(25:11)
 12879     CALL 'kxdfhei1' USING DFHEIV0,
 12880           W-CNTL-FILE-ID,
 12881           DFHEIV20,
 12882           DFHEIV99,
 12883           W-CNTL-KEY,
 12884           DFHEIV99,
 12885           DFHEIV99,
 12886           DFHEIV99
 12887     SET ADDRESS OF CONTROL-FILE TO
 12888         DFHEIV20
 12889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12890
 12891
 12892     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12893     MOVE CF-CL-MAIL-TO-NAME     TO W-LABEL-LINES (1)
 12894                                    W-VG-TEXT (25).
 12895     MOVE CF-CL-IN-CARE-OF       TO W-LABEL-LINES (2).
 12896     MOVE CF-CL-ADDR-LINE-1      TO W-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 266
* EL689.cbl
 12897     MOVE CF-CL-ADDR-LINE-2      TO W-LABEL-LINES (4).
 12898     MOVE CF-CL-CITY-STATE       TO W-LABEL-LINES (5).
 12899
 12900     IF  CF-CL-CAN-POST-CODE
 12901         MOVE CF-CL-CANADIAN-POSTAL-CODE
 12902                                 TO W-CANADIAN-POSTAL-CODES
 12903         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12904         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12905         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12906                                    W-LAB-CAN-FILLER (6)
 12907         GO TO 6200-CONTINUE.
 12908
 12909     IF CF-CL-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 12910         MOVE CF-CL-ZIP-CODE     TO W-WORK-ZIP
 12911         MOVE SPACES             TO W-LABEL-ZIP (6)
 12912         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12913
 12914         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12915             MOVE '-'            TO W-LABEL-DASH (6)
 12916             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12917             GO TO 6200-CONTINUE
 12918         ELSE
 12919             MOVE SPACES         TO W-LABEL-DASH (6)
 12920                                    W-LABEL-2ND-ZIP (6)
 12921             GO TO 6200-CONTINUE.
 12922
 12923     IF  CF-CL-ZIP-CODE-NUM NOT NUMERIC
 12924         GO TO 6200-CONTINUE.
 12925
 12926     MOVE CF-CL-ZIP-CODE-NUM     TO W-WORK-ZIP-NUMERIC.
 12927
 12928     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 12929         COMPUTE W-WORK-ZIP-NUMERIC
 12930             = W-WORK-ZIP-NUMERIC * 10000.
 12931
 12932     MOVE SPACES                 TO W-LABEL-ZIP (6).
 12933     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 12934
 12935     IF  W-WORK-ZIP4 GREATER THAN '0000'
 12936         MOVE '-'                TO W-LABEL-DASH (6)
 12937         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 12938         GO TO 6200-CONTINUE
 12939     ELSE
 12940         MOVE SPACES             TO W-LABEL-DASH (6)
 12941                                    W-LABEL-2ND-ZIP (6)
 12942         GO TO 6200-CONTINUE.
 12943
 12944 6200-CONTINUE.
 12945
 12946     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12947
 12948     IF  ADDRSI EQUAL '3'
 12949             AND
 12950         PI-CREATE-LABELS
 12951             AND
 12952         NOT PI-689-LABELS-OVERRIDEN
 12953         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (1)
 12954         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (2)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 267
* EL689.cbl
 12955         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (3)
 12956         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (04)
 12957         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (5)
 12958         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (6)
 12959         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12960         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12961         SET W-RG-NDX UP BY +1
 12962     ELSE
 12963         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (1)
 12964         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (2)
 12965         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (3)
 12966         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (4)
 12967         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (5)
 12968         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (6).
 12969
 12970     GO TO 6200-EXIT.
 12971
 12972 6200-CNTL1-NOT-FOUND.
 12973
 12974     MOVE ER-9299                TO EMI-ERROR.
 12975     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12976     MOVE -1                     TO ADDRSL.
 12977     MOVE AL-UANON               TO ADDRSA.
 12978     GO TO 8200-SEND-DATAONLY.
 12979
 12980 6200-EXIT.
 12981     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 268
* EL689.cbl
 12983 6250-GET-CNTL2-DATA.
 12984
 12985     IF  PI-PROCESSOR-ID EQUAL W-LGXX-ID
 12986         GO TO 6250-EXIT.
 12987
 12988     IF  W-FILE-NOT-USED (11)
 12989         GO TO 6250-EXIT.
 12990
 12991     MOVE SPACES                 TO W-CNTL-KEY.
 12992     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12993     MOVE +0                     TO W-CNTL-SEQ-NO.
 12994     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 12995     MOVE PI-PROCESSOR-ID        TO W-CNTL-GENL.
 12996
 12997
 12998* EXEC CICS HANDLE CONDITION
 12999*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13000*         NOTFND     (6250-CNTL2-NOT-FOUND)
 13001*    END-EXEC.
 13002*    MOVE '"$JI                  ! , #00012347' TO DFHEIV0
 13003     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13004     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13005     MOVE X'2C20233030303132333437' TO DFHEIV0(25:11)
 13006     CALL 'kxdfhei1' USING DFHEIV0
 13007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13008
 13009
 13010
 13011* EXEC CICS READ
 13012*         DATASET    (W-CNTL-FILE-ID)
 13013*         SET        (ADDRESS OF CONTROL-FILE)
 13014*         RIDFLD     (W-CNTL-KEY)
 13015*    END-EXEC.
 13016*    MOVE '&"S        E          (   #00012352' TO DFHEIV0
 13017     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13018     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13019     MOVE X'2020233030303132333532' TO DFHEIV0(25:11)
 13020     CALL 'kxdfhei1' USING DFHEIV0,
 13021           W-CNTL-FILE-ID,
 13022           DFHEIV20,
 13023           DFHEIV99,
 13024           W-CNTL-KEY,
 13025           DFHEIV99,
 13026           DFHEIV99,
 13027           DFHEIV99
 13028     SET ADDRESS OF CONTROL-FILE TO
 13029         DFHEIV20
 13030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13031
 13032
 13033     MOVE CF-PROCESSOR           TO W-VG-TEXT (153).
 13034     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (151).
 13035     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (152).
 13036     GO TO 6250-EXIT.
 13037
 13038 6250-CNTL2-NOT-FOUND.
 13039
 13040     MOVE ER-9299                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 269
* EL689.cbl
 13041     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13042     MOVE -1                     TO MAINTL.
 13043     MOVE AL-UANON               TO MAINTA.
 13044     GO TO 8200-SEND-DATAONLY.
 13045
 13046 6250-EXIT.
 13047     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 270
* EL689.cbl
 13049 6300-GET-CARRIER-DATA.
 13050
 13051     IF  ADDRSI EQUAL '2'
 13052             AND
 13053         PI-CREATE-LABELS
 13054             AND
 13055         NOT PI-689-LABELS-OVERRIDEN
 13056         NEXT SENTENCE
 13057     ELSE
 13058         IF  W-FILE-NOT-USED (4)
 13059             GO TO 6300-EXIT.
 13060
 13061     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
 13062         MOVE SPACES             TO W-CNTL-KEY
 13063         MOVE PI-COMPANY-ID      TO W-CNTL-COMPANY-ID
 13064         MOVE +0                 TO W-CNTL-SEQ-NO
 13065         MOVE '6'                TO W-CNTL-RECORD-TYPE
 13066         MOVE PI-689-CARRIER     TO W-CNTL-GEN4
 13067     ELSE
 13068         MOVE ER-9327            TO EMI-ERROR
 13069         MOVE -1                 TO CARRIERL
 13070         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13071         GO TO 6300-EXIT.
 13072
 13073
 13074* EXEC CICS HANDLE CONDITION
 13075*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13076*         NOTFND     (6300-CNTL6-NOT-FOUND)
 13077*    END-EXEC.
 13078*    MOVE '"$JI                  ! - #00012398' TO DFHEIV0
 13079     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13080     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13081     MOVE X'2D20233030303132333938' TO DFHEIV0(25:11)
 13082     CALL 'kxdfhei1' USING DFHEIV0
 13083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13084
 13085
 13086
 13087* EXEC CICS READ
 13088*         DATASET    (W-CNTL-FILE-ID)
 13089*         SET        (ADDRESS OF CONTROL-FILE)
 13090*         RIDFLD     (W-CNTL-KEY)
 13091*    END-EXEC.
 13092*    MOVE '&"S        E          (   #00012403' TO DFHEIV0
 13093     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13094     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13095     MOVE X'2020233030303132343033' TO DFHEIV0(25:11)
 13096     CALL 'kxdfhei1' USING DFHEIV0,
 13097           W-CNTL-FILE-ID,
 13098           DFHEIV20,
 13099           DFHEIV99,
 13100           W-CNTL-KEY,
 13101           DFHEIV99,
 13102           DFHEIV99,
 13103           DFHEIV99
 13104     SET ADDRESS OF CONTROL-FILE TO
 13105         DFHEIV20
 13106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 271
* EL689.cbl
 13107
 13108
 13109     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13110     MOVE CF-MAIL-TO-NAME        TO W-LABEL-LINES (1).
 13111     MOVE CF-IN-CARE-OF          TO W-LABEL-LINES (2).
 13112     MOVE CF-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 13113     MOVE CF-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 13114     MOVE CF-CITY-STATE          TO W-LABEL-LINES (5).
 13115
 13116     IF  CF-CANADIAN-POST-CODE
 13117         MOVE CF-CANADIAN-POSTAL-CODE
 13118                                 TO W-CANADIAN-POSTAL-CODES
 13119         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13120         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13121         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13122                                    W-LAB-CAN-FILLER (6)
 13123         GO TO 6300-CONTINUE.
 13124
 13125     IF CF-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 13126         MOVE CF-ZIP-CODE        TO W-WORK-ZIP
 13127         MOVE SPACES             TO W-LABEL-ZIP (6)
 13128         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13129         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13130             MOVE '-'            TO W-LABEL-DASH (6)
 13131             MOVE W-WORK-ZIP4
 13132                                 TO W-LABEL-2ND-ZIP (6)
 13133             GO TO 6300-CONTINUE
 13134         ELSE
 13135             MOVE SPACES         TO W-LABEL-DASH (6)
 13136                                    W-LABEL-2ND-ZIP (6)
 13137             GO TO 6300-CONTINUE.
 13138
 13139     IF  CF-ZIP-CODE-NUM NOT NUMERIC
 13140         GO TO 6300-CONTINUE.
 13141
 13142     MOVE CF-ZIP-CODE-NUM TO W-WORK-ZIP-NUMERIC.
 13143
 13144     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 13145         COMPUTE W-WORK-ZIP-NUMERIC
 13146             = W-WORK-ZIP-NUMERIC * 10000.
 13147
 13148     MOVE SPACES                 TO W-LABEL-ZIP (6).
 13149     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 13150
 13151     IF  W-WORK-ZIP4 GREATER THAN '0000'
 13152         MOVE '-'                TO W-LABEL-DASH (6)
 13153         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 13154         GO TO 6300-CONTINUE
 13155     ELSE
 13156         MOVE SPACES             TO W-LABEL-DASH (6)
 13157                                    W-LABEL-2ND-ZIP (6)
 13158         GO TO 6300-CONTINUE.
 13159
 13160 6300-CONTINUE.
 13161
 13162     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13163
 13164     IF  ADDRSI EQUAL '2'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 272
* EL689.cbl
 13165             AND
 13166         PI-CREATE-LABELS
 13167             AND
 13168         NOT PI-689-LABELS-OVERRIDEN
 13169         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (20)
 13170         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (21)
 13171         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (22)
 13172         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (23)
 13173         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (24)
 13174         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (25)
 13175         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13176         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13177         SET W-RG-NDX UP BY +1
 13178     ELSE
 13179         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (20)
 13180         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (21)
 13181         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (22)
 13182         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (23)
 13183         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (24)
 13184         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (25).
 13185
 13186     IF  W-FULL-DATA
 13187         MOVE ZEROS              TO W-PHONE-IN
 13188         MOVE CF-PHONE-NO        TO W-PHONE-IN
 13189         MOVE W-PHI-AREA         TO W-PO-AREA
 13190         MOVE W-PHI-PFX          TO W-PO-PFX
 13191         MOVE W-PHI-SFX          TO W-PO-SFX
 13192         MOVE W-PHONE-OUT        TO W-VG-TEXT (26).
 13193
 13194     GO TO 6300-EXIT.
 13195
 13196 6300-CNTL6-NOT-FOUND.
 13197
 13198     MOVE ER-9298                TO EMI-ERROR.
 13199     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13200     MOVE -1                     TO ADDRSL.
 13201     MOVE AL-UANON               TO ADDRSA.
 13202     GO TO 8200-SEND-DATAONLY.
 13203
 13204 6300-EXIT.
 13205     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 273
* EL689.cbl
 13207 6350-GET-CSR-DATA.
 13208     IF W-VG-TEXT (148) (1:4) = '****' OR SPACES
 13209        GO TO 6350-EXIT
 13210     END-IF
 13211*    IF W-FILE-NOT-USED (11)
 13212*       GO TO 6350-EXIT
 13213*    END-IF
 13214     MOVE SPACES                 TO W-CNTL-KEY
 13215     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
 13216     MOVE +0                     TO W-CNTL-SEQ-NO
 13217     MOVE '2'                    TO W-CNTL-RECORD-TYPE
 13218     MOVE CO-CSR-CODE            TO W-CNTL-GENL
 13219
 13220* EXEC CICS HANDLE CONDITION
 13221*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13222*         NOTFND     (6350-CNTL2-NOT-FOUND)
 13223*    END-EXEC
 13224*    MOVE '"$JI                  ! . #00012519' TO DFHEIV0
 13225     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13227     MOVE X'2E20233030303132353139' TO DFHEIV0(25:11)
 13228     CALL 'kxdfhei1' USING DFHEIV0
 13229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13230
 13231* EXEC CICS READ
 13232*         DATASET    (W-CNTL-FILE-ID)
 13233*         SET        (ADDRESS OF CONTROL-FILE)
 13234*         RIDFLD     (W-CNTL-KEY)
 13235*    END-EXEC
 13236*    MOVE '&"S        E          (   #00012523' TO DFHEIV0
 13237     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13238     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13239     MOVE X'2020233030303132353233' TO DFHEIV0(25:11)
 13240     CALL 'kxdfhei1' USING DFHEIV0,
 13241           W-CNTL-FILE-ID,
 13242           DFHEIV20,
 13243           DFHEIV99,
 13244           W-CNTL-KEY,
 13245           DFHEIV99,
 13246           DFHEIV99,
 13247           DFHEIV99
 13248     SET ADDRESS OF CONTROL-FILE TO
 13249         DFHEIV20
 13250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13251     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 13252     GO TO 6350-EXIT
 13253     .
 13254 6350-CNTL2-NOT-FOUND.
 13255     MOVE ER-9299                TO EMI-ERROR.
 13256     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13257     MOVE -1                     TO MAINTL.
 13258     MOVE AL-UANON               TO MAINTA.
 13259     GO TO 8200-SEND-DATAONLY.
 13260 6350-EXIT.
 13261     EXIT.
 13262 6400-GET-PENDING-DATA.
 13263
 13264     IF (ADDRSI EQUAL '7')
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 274
* EL689.cbl
 13265        AND (PI-CREATE-LABELS)
 13266        AND (NOT PI-689-LABELS-OVERRIDEN)
 13267        CONTINUE
 13268     ELSE
 13269        IF PI-689-DATA-SOURCE = '4'
 13270           CONTINUE
 13271        ELSE
 13272           IF W-FILE-NOT-USED (9)
 13273              GO TO 6400-EXIT
 13274           END-IF
 13275        END-IF
 13276     END-IF
 13277     IF  W-PNDB-ENTRY EQUAL LOW-VALUES
 13278         MOVE ER-9327            TO EMI-ERROR
 13279         MOVE -1                 TO MAINTL
 13280         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13281         GO TO 6400-EXIT.
 13282
 13283 6400-READ-PNDB-ONLY.
 13284
 13285
 13286* EXEC CICS HANDLE CONDITION
 13287*         NOTOPEN (8060-PNDB-NOT-OPEN)
 13288*         NOTFND  (8070-PNDB-NOT-FOUND)
 13289*    END-EXEC.
 13290*    MOVE '"$JI                  ! / #00012562' TO DFHEIV0
 13291     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13292     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13293     MOVE X'2F20233030303132353632' TO DFHEIV0(25:11)
 13294     CALL 'kxdfhei1' USING DFHEIV0
 13295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13296
 13297
 13298
 13299* EXEC CICS READ
 13300*         DATASET (W-PNDB-FILE-ID)
 13301*         SET     (ADDRESS OF PENDING-BUSINESS)
 13302*         RIDFLD  (W-PNDB-KEY)
 13303*    END-EXEC.
 13304*    MOVE '&"S        E          (   #00012567' TO DFHEIV0
 13305     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13306     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13307     MOVE X'2020233030303132353637' TO DFHEIV0(25:11)
 13308     CALL 'kxdfhei1' USING DFHEIV0,
 13309           W-PNDB-FILE-ID,
 13310           DFHEIV20,
 13311           DFHEIV99,
 13312           W-PNDB-KEY,
 13313           DFHEIV99,
 13314           DFHEIV99,
 13315           DFHEIV99
 13316     SET ADDRESS OF PENDING-BUSINESS TO
 13317         DFHEIV20
 13318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13319
 13320
 13321     MOVE 'Y'                    TO W-PNDB-FOUND-SW.
 13322
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 275
* EL689.cbl
 13323     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 13324         MOVE PB-SV-CARRIER      TO PB-CARRIER
 13325                                    PI-689-CARRIER
 13326         MOVE PB-SV-GROUPING     TO PB-GROUPING
 13327                                    PI-689-GROUPING
 13328         MOVE PB-SV-STATE        TO PB-STATE
 13329                                    PI-689-STATE
 13330         MOVE PB-CONTROL-BY-ACCOUNT
 13331                                 TO W-CERT-KEY
 13332                                    W-MAIL-KEY
 13333                                    W-ACCT-KEY
 13334         MOVE PB-ACCOUNT         TO PI-689-ACCOUNT
 13335         MOVE PB-CERT-EFF-DT     TO PI-689-EFF-DATE
 13336         MOVE PB-CERT-NO         TO PI-689-CERT-NO.
 13337
 13338 6400-ONLY-STOP.
 13339
 13340     MOVE PB-ENTRY-BATCH         TO W-VG-TEXT (130).
 13341
 13342     IF  NOT PB-ISSUE
 13343         GO TO 6400-CANCEL.
 13344
 13345     MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1.
 13346     MOVE SPACES                 TO DC-OPTION-CODE.
 13347     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13348
 13349     IF  NO-CONVERSION-ERROR
 13350         MOVE DC-GREG-DATE-1-EDIT
 13351                                 TO W-VG-TEXT (110).
 13352
 13353     MOVE PB-I-AGE               TO W-EDIT-3-0.
 13354     MOVE W-EDIT-3-0             TO W-VG-TEXT (124).
 13355     MOVE PB-I-LF-PREMIUM-AMT    TO W-EDIT-7-2.
 13356     MOVE W-EDIT-7-2             TO W-VG-TEXT (111).
 13357     MOVE PB-I-AH-PREMIUM-AMT    TO W-EDIT-7-2.
 13358     MOVE W-EDIT-7-2             TO W-VG-TEXT (112).
 13359     MOVE PB-I-LF-PREM-CALC      TO W-EDIT-7-2.
 13360     MOVE W-EDIT-7-2             TO W-VG-TEXT (113).
 13361     MOVE PB-I-AH-PREM-CALC      TO W-EDIT-7-2.
 13362     MOVE W-EDIT-7-2             TO W-VG-TEXT (114).
 13363     MOVE PB-I-LF-BENEFIT-AMT    TO W-EDIT-9-2.
 13364     MOVE W-EDIT-9-2             TO W-VG-TEXT (125).
 13365     MOVE PB-I-AH-BENEFIT-AMT    TO W-EDIT-7-2.
 13366     MOVE W-EDIT-7-2             TO W-VG-TEXT (126).
 13367     MOVE PB-I-LF-RATE           TO W-EDIT-2-5-S.
 13368     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (127).
 13369     MOVE PB-I-AH-RATE           TO W-EDIT-2-5-S.
 13370     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (128).
 13371     MOVE PB-I-LOAN-TERM         TO W-EDIT-3-0.
 13372     MOVE W-EDIT-3-0             TO W-VG-TEXT (129).
 13373
 13374     COMPUTE W-DIFFERENCE
 13375         = PB-I-LF-PREM-CALC - PB-I-LF-PREMIUM-AMT.
 13376
 13377     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13378     MOVE W-EDIT-7-2             TO W-VG-TEXT (115).
 13379
 13380     COMPUTE W-DIFFERENCE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 276
* EL689.cbl
 13381         = PB-I-AH-PREM-CALC - PB-I-AH-PREMIUM-AMT.
 13382
 13383     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13384     MOVE W-EDIT-7-2             TO W-VG-TEXT (116).
 13385
 13386 6400-CANCEL.
 13387
 13388     IF  NOT PB-CANCELLATION
 13389         GO TO 6400-EXIT.
 13390
 13391     MOVE PB-CI-AH-PRIOR-CANCEL-DT
 13392                                 TO DC-BIN-DATE-1.
 13393     MOVE SPACES                 TO DC-OPTION-CODE.
 13394     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13395
 13396     IF  NO-CONVERSION-ERROR
 13397         MOVE DC-GREG-DATE-1-EDIT
 13398                                 TO W-VG-TEXT (117).
 13399
 13400     MOVE PB-C-LF-CANCEL-AMT     TO W-EDIT-7-2.
 13401     MOVE W-EDIT-7-2             TO W-VG-TEXT (118).
 13402     MOVE PB-C-AH-CANCEL-AMT     TO W-EDIT-7-2.
 13403     MOVE W-EDIT-7-2             TO W-VG-TEXT (119).
 13404     MOVE PB-C-LF-REF-CALC       TO W-EDIT-7-2.
 13405     MOVE W-EDIT-7-2             TO W-VG-TEXT (120).
 13406     MOVE PB-C-AH-REF-CALC       TO W-EDIT-7-2.
 13407     MOVE W-EDIT-7-2             TO W-VG-TEXT (121).
 13408     COMPUTE W-EDIT-7-2 = PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
 13409     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 13410
 13411     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 13412        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 13413     END-IF
 13414     MOVE PB-C-NH-INT-ON-REFS    TO W-EDIT-7-2
 13415     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 13416     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
 13417     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-1
 13418        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
 13419     END-IF
 13420     MOVE SPACES                 TO DC-OPTION-CODE
 13421     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 13422
 13423     IF NO-CONVERSION-ERROR
 13424        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 13425     END-IF
 13426
 13427     COMPUTE W-DIFFERENCE = PB-C-LF-REF-CALC
 13428                           - PB-C-LF-CANCEL-AMT.
 13429
 13430     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13431     MOVE W-EDIT-7-2             TO W-VG-TEXT (122).
 13432
 13433     COMPUTE W-DIFFERENCE = PB-C-AH-REF-CALC
 13434                           - PB-C-AH-CANCEL-AMT.
 13435
 13436     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13437     MOVE W-EDIT-7-2             TO W-VG-TEXT (123).
 13438
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 277
* EL689.cbl
 13439 6400-EXIT.
 13440     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 278
* EL689.cbl
 13442 6450-GET-CERT-DATA.
 13443     IF  W-FILE-NOT-USED (8)
 13444         GO TO 6450-EXIT.
 13445
 13446     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 13447         MOVE ER-9327            TO EMI-ERROR
 13448         MOVE -1                 TO MAINTL
 13449         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13450         GO TO 6450-EXIT.
 13451
 13452 6450-READ-CERT-ONLY.
 13453
 13454
 13455* EXEC CICS HANDLE CONDITION
 13456*         NOTOPEN (8030-CERT-NOT-OPEN)
 13457*         NOTFND  (8035-CERT-NOT-FOUND)
 13458*    END-EXEC.
 13459*    MOVE '"$JI                  ! 0 #00012706' TO DFHEIV0
 13460     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13462     MOVE X'3020233030303132373036' TO DFHEIV0(25:11)
 13463     CALL 'kxdfhei1' USING DFHEIV0
 13464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13465
 13466
 13467
 13468* EXEC CICS READ
 13469*         DATASET (W-CERT-FILE-ID)
 13470*         SET     (ADDRESS OF CERTIFICATE-MASTER)
 13471*         RIDFLD  (W-CERT-KEY)
 13472*    END-EXEC.
 13473*    MOVE '&"S        E          (   #00012711' TO DFHEIV0
 13474     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13475     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13476     MOVE X'2020233030303132373131' TO DFHEIV0(25:11)
 13477     CALL 'kxdfhei1' USING DFHEIV0,
 13478           W-CERT-FILE-ID,
 13479           DFHEIV20,
 13480           DFHEIV99,
 13481           W-CERT-KEY,
 13482           DFHEIV99,
 13483           DFHEIV99,
 13484           DFHEIV99
 13485     SET ADDRESS OF CERTIFICATE-MASTER TO
 13486         DFHEIV20
 13487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13488
 13489
 13490     MOVE 'Y'                    TO W-CERT-FOUND-SW.
 13491
 13492 6450-ONLY-STOP.
 13493
 13494     MOVE CM-INSURED-LAST-NAME   TO W-VG-TEXT (108).
 13495
 13496     MOVE CM-BENEFICIARY         TO W-VG-TEXT (109).
 13497
 13498     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13499     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 279
* EL689.cbl
 13500     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13501     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13502     MOVE WS-NAME-WORK           TO W-VG-TEXT (95).
 13503
 13504     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13505     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13506     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13507     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13508     MOVE WS-NAME-WORK           TO W-VG-TEXT (94).
 13509
 13510     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13511     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13512     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13513     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13514     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13515     MOVE WS-NAME-WORK           TO W-VG-TEXT (90).
 13516
 13517     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13518     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13519     MOVE SPACES                 TO W-NAME-MIDDLE.
 13520     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13521     MOVE WS-NAME-WORK           TO W-VG-TEXT (104).
 13522
 13523     MOVE CM-INSURED-FIRST-NAME  TO W-VG-TEXT (91).
 13524     MOVE CM-INSURED-INITIAL2    TO W-VG-TEXT (92).
 13525
 13526     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13527     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13528     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13529     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13530     MOVE WS-NAME-WORK           TO W-VG-TEXT (103)
 13531                                    W-LABEL-JOINT-NAME.
 13532
 13533     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13534     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13535     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13536     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13537     MOVE WS-NAME-WORK           TO W-VG-TEXT (102).
 13538
 13539     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13540     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13541     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13542     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13543     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13544     MOVE WS-NAME-WORK           TO W-VG-TEXT (99).
 13545
 13546     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13547     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13548     MOVE SPACES                 TO W-NAME-MIDDLE.
 13549     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13550     MOVE WS-NAME-WORK           TO W-VG-TEXT (105).
 13551
 13552     MOVE CM-JT-FIRST-NAME       TO W-VG-TEXT (100).
 13553     MOVE CM-JT-INITIAL          TO W-VG-TEXT (101).
 13554
 13555     COMPUTE W-WORK-AMOUNT
 13556         = CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT.
 13557     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 280
* EL689.cbl
 13558     MOVE W-EDIT-9-2             TO W-VG-TEXT (97).
 13559     MOVE CM-AH-PREMIUM-AMT      TO W-EDIT-7-2.
 13560     MOVE W-EDIT-7-2             TO W-VG-TEXT (98).
 13561
 13562     IF  CM-SEX-FEMAL
 13563         MOVE 'MS.'              TO W-VG-TEXT (96)
 13564
 13565     ELSE
 13566         MOVE 'MR.'              TO W-VG-TEXT (96).
 13567
 13568     MOVE CM-CARRIER OF CERTIFICATE-MASTER
 13569                                 TO W-VG-TEXT (70).
 13570     MOVE CM-GROUPING            TO W-VG-TEXT (71).
 13571     MOVE CM-ACCOUNT             TO W-VG-TEXT (72).
 13572     MOVE CM-CERT-NO             TO W-VG-TEXT (73).
 13573     MOVE CM-INSURED-ISSUE-AGE   TO W-DISPLAY-3.
 13574     MOVE W-DISPLAY-3            TO W-VG-TEXT (83).
 13575     MOVE CM-LOAN-NUMBER         TO W-VG-TEXT (86).
 13576     MOVE CM-LOAN-BALANCE        TO W-EDIT-7-2.
 13577     MOVE W-EDIT-7-2             TO W-VG-TEXT (87).
 13578     MOVE CM-MEMBER-NO           TO W-VG-TEXT (88).
 13579     MOVE CM-SOC-SEC-NO          TO W-VG-TEXT (89).
 13580     MOVE CM-POLICY-FORM-NO      TO W-VG-TEXT (83).
 13581     MOVE CM-LF-ORIG-TERM        TO W-EDIT-3-0.
 13582     MOVE W-EDIT-3-0             TO W-VG-TEXT (77).
 13583     MOVE CM-LF-BENEFIT-AMT      TO W-EDIT-9-2.
 13584     MOVE W-EDIT-9-2             TO W-VG-TEXT (79).
 13585     MOVE CM-AH-ORIG-TERM        TO W-EDIT-3-0.
 13586     MOVE W-EDIT-3-0             TO W-VG-TEXT (78).
 13587     MOVE CM-AH-BENEFIT-AMT      TO W-EDIT-7-2.
 13588     MOVE W-EDIT-7-2             TO W-VG-TEXT (80).
 13589     MOVE CM-AH-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13590     MOVE W-EDIT-7-2             TO W-VG-TEXT (107).
 13591     MOVE CM-LF-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13592     MOVE W-EDIT-7-2             TO W-VG-TEXT (106).
 13593     IF PI-689-DATA-SOURCE NOT = '4'
 13594     COMPUTE W-EDIT-7-2 = CM-LF-ITD-CANCEL-AMT
 13595        + CM-AH-ITD-CANCEL-AMT
 13596     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 13597     IF CM-NH-INT-ON-REFS NOT NUMERIC
 13598        MOVE ZEROS               TO CM-NH-INT-ON-REFS
 13599     END-IF
 13600     MOVE CM-NH-INT-ON-REFS      TO W-EDIT-7-2
 13601     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 13602     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
 13603     IF CM-AH-CANCEL-DT > DC-BIN-DATE-1
 13604        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
 13605     END-IF
 13606     MOVE SPACES                 TO DC-OPTION-CODE
 13607     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 13608
 13609     IF NO-CONVERSION-ERROR
 13610        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 13611     END-IF
 13612     END-IF
 13613     COMPUTE W-WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 13614     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
 13615     MOVE W-EDIT-9-2             TO W-VG-TEXT (93).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 281
* EL689.cbl
 13616
 13617     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1.
 13618     MOVE SPACES                 TO DC-OPTION-CODE.
 13619     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13620
 13621     IF  NO-CONVERSION-ERROR
 13622         MOVE DC-GREG-DATE-1-EDIT
 13623                                 TO W-VG-TEXT (81).
 13624
 13625     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1.
 13626     MOVE SPACES                 TO DC-OPTION-CODE.
 13627     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13628
 13629     IF  NO-CONVERSION-ERROR
 13630         MOVE DC-GREG-DATE-1-EDIT
 13631                                 TO W-VG-TEXT (82).
 13632
 13633     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13634     MOVE SPACES                 TO DC-OPTION-CODE.
 13635     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13636
 13637     IF  NO-CONVERSION-ERROR
 13638         MOVE DC-GREG-DATE-1-EDIT
 13639                                 TO W-VG-TEXT (74).
 13640
 13641     MOVE CM-LF-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13642
 13643     IF  CM-PMT-EXTENSION-DAYS NUMERIC
 13644         MOVE CM-PMT-EXTENSION-DAYS
 13645                                 TO DC-ELAPSED-DAYS
 13646     ELSE
 13647         MOVE ZEROS              TO DC-ELAPSED-DAYS.
 13648
 13649     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13650     MOVE '6'                    TO DC-OPTION-CODE.
 13651     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13652
 13653     IF  NO-CONVERSION-ERROR
 13654         MOVE DC-GREG-DATE-1-EDIT
 13655                                 TO W-VG-TEXT (75).
 13656
 13657     MOVE CM-AH-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13658     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13659     MOVE '6'                    TO DC-OPTION-CODE.
 13660     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13661
 13662     IF  NO-CONVERSION-ERROR
 13663         MOVE DC-GREG-DATE-1-EDIT
 13664                                 TO W-VG-TEXT (76).
 13665
 13666 6450-EXIT.
 13667     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 282
* EL689.cbl
 13669 6500-GET-ACCOUNT-DATA.
 13670
 13671     IF  ADDRSI EQUAL '1'
 13672             AND
 13673         PI-CREATE-LABELS
 13674             AND
 13675         NOT PI-689-LABELS-OVERRIDEN
 13676         NEXT SENTENCE
 13677     ELSE
 13678         IF  W-FILE-NOT-USED (6)
 13679             GO TO 6500-EXIT
 13680         END-IF
 13681     END-IF.
 13682
 13683 6500-READ-ACCT-ONLY.
 13684
 13685     IF  W-ACCT-ACCOUNT EQUAL LOW-VALUES
 13686         MOVE ER-9327            TO EMI-ERROR
 13687         MOVE -1                 TO MAINTL
 13688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13689         GO TO 6500-EXIT.
 13690
 13691
 13692* EXEC CICS HANDLE CONDITION
 13693*         NOTOPEN    (8020-ACCT-NOT-OPEN)
 13694*         NOTFND     (6500-ACCT-NOT-FOUND)
 13695*         ENDFILE    (6500-ONLY-STOP)
 13696*    END-EXEC.
 13697*    MOVE '"$JI''                 ! 1 #00012918' TO DFHEIV0
 13698     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 13699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13700     MOVE X'3120233030303132393138' TO DFHEIV0(25:11)
 13701     CALL 'kxdfhei1' USING DFHEIV0
 13702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13703
 13704
 13705
 13706* EXEC CICS STARTBR
 13707*         RIDFLD     (W-ACCT-KEY)
 13708*         DATASET    (W-ACCT-FILE-ID)
 13709*         KEYLENGTH  (20)
 13710*         GENERIC
 13711*    END-EXEC.
 13712     MOVE 20
 13713       TO DFHEIV11
 13714     MOVE 0
 13715       TO DFHEIV12
 13716*    MOVE '&,   KG    G          &   #00012924' TO DFHEIV0
 13717     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 13718     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13719     MOVE X'2020233030303132393234' TO DFHEIV0(25:11)
 13720     CALL 'kxdfhei1' USING DFHEIV0,
 13721           W-ACCT-FILE-ID,
 13722           W-ACCT-KEY,
 13723           DFHEIV11,
 13724           DFHEIV12,
 13725           DFHEIV99
 13726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 283
* EL689.cbl
 13727
 13728
 13729     MOVE W-ACCT-PARTIAL-KEY     TO W-ACCT-SAVE-KEY.
 13730     MOVE 'Y'                    TO W-ACCT-BROWSE-STARTED-SW.
 13731
 13732 6500-READNEXT.
 13733
 13734
 13735* EXEC CICS READNEXT
 13736*         DATASET    (W-ACCT-FILE-ID)
 13737*         SET        (ADDRESS OF ACCOUNT-MASTER)
 13738*         RIDFLD     (W-ACCT-KEY)
 13739*    END-EXEC.
 13740     MOVE 0
 13741       TO DFHEIV11
 13742*    MOVE '&.S                   )   #00012936' TO DFHEIV0
 13743     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13744     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13745     MOVE X'2020233030303132393336' TO DFHEIV0(25:11)
 13746     CALL 'kxdfhei1' USING DFHEIV0,
 13747           W-ACCT-FILE-ID,
 13748           DFHEIV20,
 13749           DFHEIV99,
 13750           W-ACCT-KEY,
 13751           DFHEIV99,
 13752           DFHEIV11,
 13753           DFHEIV99,
 13754           DFHEIV99
 13755     SET ADDRESS OF ACCOUNT-MASTER TO
 13756         DFHEIV20
 13757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13758
 13759
 13760     IF  W-ACCT-PARTIAL-KEY NOT EQUAL W-ACCT-SAVE-KEY
 13761         IF  PRIOR-MATCH-ACCT-PKEY
 13762             CONTINUE
 13763*            GO TO 6500-ONLY-STOP
 13764         ELSE
 13765             IF  W-FILE-NOT-USED (6)
 13766                 PERFORM 6500-ENDBR
 13767                 GO TO 6500-EXIT
 13768             ELSE
 13769                 GO TO 6500-ACCT-NOT-FOUND
 13770             END-IF
 13771         END-IF
 13772     ELSE
 13773         SET PRIOR-MATCH-ACCT-PKEY TO TRUE
 13774         MOVE AM-CARRIER           TO WS-SAV-AM-CARRIER
 13775         MOVE AM-ACCOUNT           TO WS-SAV-AM-ACCOUNT
 13776         MOVE AM-DEFN-1            TO WS-SAV-AM-DEFN-1
 13777         MOVE AM-REMIT-TO          TO WS-SAV-AM-REMIT-TO
 13778         MOVE AM-NAME              TO WS-SAV-AM-NAME
 13779         MOVE AM-PERSON            TO WS-SAV-AM-PERSON
 13780         MOVE AM-ADDRS             TO WS-SAV-AM-ADDRS
 13781         MOVE SPACES               TO WS-SAV-AM-CITY
 13782*        MOVE AM-CITY              TO WS-SAV-AM-CITY
 13783         STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 13784            DELIMITED BY '  ' INTO WS-SAV-AM-CITY
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 284
* EL689.cbl
 13785         END-STRING
 13786         MOVE AM-ZIP               TO WS-SAV-AM-ZIP
 13787         MOVE AM-TEL-NO            TO WS-SAV-AM-TEL-NO
 13788         MOVE AM-CONTROL-NAME      TO WS-SAV-AM-CONTROL-NAME
 13789         MOVE AM-CSR-CODE          TO WS-SAV-AM-CSR-CODE
 13790         MOVE AM-ACCOUNT           TO WS-SAV-AM-ERACCT-ACCOUNT
 13791         GO TO 6500-READNEXT
 13792     END-IF
 13793     .
 13794 6500-ONLY-STOP.
 13795
 13796     IF  NOT PI-NO-CARRIER-SECURITY
 13797             AND
 13798         PI-CARRIER-SECURITY NOT = WS-SAV-AM-CARRIER
 13799         MOVE -1                 TO CARRIERL
 13800         MOVE AL-UANON           TO CARRIERA
 13801         MOVE ER-9095            TO EMI-ERROR
 13802         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13803         PERFORM 6500-ENDBR
 13804         GO TO 8200-SEND-DATAONLY.
 13805
 13806     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13807     MOVE WS-SAV-AM-NAME         TO W-LABEL-LINES (1).
 13808     MOVE WS-SAV-AM-PERSON       TO W-LABEL-LINES (2).
 13809     MOVE WS-SAV-AM-ADDRS        TO W-LABEL-LINES (3).
 13810     MOVE WS-SAV-AM-CITY         TO W-LABEL-LINES (4).
 13811
 13812     MOVE WS-SAV-AM-ZIP          TO W-WORK-ZIP.
 13813     MOVE SPACES                 TO W-LABEL-ZIP (5).
 13814
 13815     IF  SAVE-AM-CANADIAN-POST-CODE
 13816         MOVE WS-SAV-AM-CANADIAN-POSTAL-CODE
 13817                                 TO W-CANADIAN-POSTAL-CODES
 13818         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 13819         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 13820         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 13821                                    W-LAB-CAN-FILLER (5)
 13822     ELSE
 13823         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 13824
 13825         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13826             MOVE '-'            TO W-LABEL-DASH (5)
 13827             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 13828         ELSE
 13829             MOVE SPACES         TO W-LABEL-DASH (5)
 13830                                    W-LABEL-2ND-ZIP (5).
 13831
 13832     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13833
 13834     IF  ADDRSI EQUAL '1'
 13835             AND
 13836         PI-CREATE-LABELS
 13837             AND
 13838         NOT PI-689-LABELS-OVERRIDEN
 13839         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13840                                    W-VG-TEXT (40)
 13841         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13842                                    W-VG-TEXT (41)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 285
* EL689.cbl
 13843         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13844                                    W-VG-TEXT (42)
 13845         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13846                                    W-VG-TEXT (43)
 13847         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13848                                    W-VG-TEXT (44)
 13849         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13850                                    W-VG-TEXT (45)
 13851         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13852         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13853         SET W-RG-NDX UP BY +1
 13854     ELSE
 13855         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (40)
 13856         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (41)
 13857         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (42)
 13858         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (43)
 13859         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (44)
 13860         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (45).
 13861
 13862     IF  WS-SAV-AM-TEL-NO NOT NUMERIC
 13863             OR
 13864         WS-SAV-AM-TEL-NO EQUAL ZEROS
 13865         MOVE SPACES             TO W-VG-TEXT (46)
 13866     ELSE
 13867         MOVE ZEROS                  TO W-PHONE-IN
 13868         MOVE WS-SAV-AM-AREA-CODE    TO W-PO-AREA
 13869         MOVE WS-SAV-AM-TEL-PRE      TO W-PO-PFX
 13870         MOVE WS-SAV-AM-TEL-NBR      TO W-PO-SFX
 13871         MOVE W-PHONE-OUT            TO W-VG-TEXT (46).
 13872
 13873     IF WS-SAV-AM-CONTROL-NAME (1:1) NOT = LOW-VALUES
 13874        MOVE WS-SAV-AM-CONTROL-NAME  TO W-VG-TEXT (47)
 13875     ELSE
 13876        MOVE SPACES                   TO W-VG-TEXT (47)
 13877     END-IF.
 13878     MOVE WS-SAV-AM-CSR-CODE     TO W-VG-TEXT (48)
 13879     MOVE WS-SAV-AM-ERACCT-ACCOUNT
 13880                                 TO W-VG-TEXT (49)
 13881
 13882     MOVE WS-SAV-AM-ACCOUNT      TO W-VG-TEXT (72)
 13883     PERFORM 6500-ENDBR.
 13884
 13885     GO TO 6500-EXIT.
 13886
 13887 6500-ENDBR.
 13888
 13889     IF  W-ACCT-BROWSE-STARTED
 13890         MOVE 'N'                TO W-ACCT-BROWSE-STARTED-SW
 13891
 13892* EXEC CICS ENDBR
 13893*            DATASET (W-ACCT-FILE-ID)
 13894*        END-EXEC
 13895     MOVE 0
 13896       TO DFHEIV11
 13897*    MOVE '&2                    $   #00013073' TO DFHEIV0
 13898     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13899     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13900     MOVE X'2020233030303133303733' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 286
* EL689.cbl
 13901     CALL 'kxdfhei1' USING DFHEIV0,
 13902           W-ACCT-FILE-ID,
 13903           DFHEIV11,
 13904           DFHEIV99
 13905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13906     END-IF.
 13907
 13908 6500-ACCT-NOT-FOUND.
 13909
 13910     PERFORM 6500-ENDBR.
 13911
 13912     IF  DATASORI NOT EQUAL '1'
 13913         MOVE ER-0179            TO EMI-ERROR
 13914         GO TO 6500-EXIT.
 13915
 13916     MOVE ER-0179                TO EMI-ERROR.
 13917     MOVE -1                     TO MAINTL.
 13918     MOVE AL-UNBON               TO MAINTA.
 13919     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13920     GO TO 8200-SEND-DATAONLY.
 13921
 13922 6500-EXIT.
 13923     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 287
* EL689.cbl
 13925 6600-GET-COMPENSATION-DATA.
 13926
 13927     IF  ADDRSI EQUAL '4'
 13928             AND
 13929         PI-CREATE-LABELS
 13930             AND
 13931         NOT PI-689-LABELS-OVERRIDEN
 13932         NEXT SENTENCE
 13933     ELSE
 13934         IF  W-FILE-NOT-USED (10)
 13935             GO TO 6600-EXIT.
 13936
 13937     IF  W-COMP-RESP-PERSON GREATER THAN LOW-VALUES
 13938         MOVE W-COMP-KEY         TO W-COMP-SAVE-KEY
 13939         GO TO 6600-START.
 13940
 13941     IF  PI-ZERO-CARRIER
 13942             OR
 13943         PI-ZERO-CAR-GROUP
 13944         MOVE ZEROS              TO W-COMP-CARRIER.
 13945
 13946     IF  PI-ZERO-GROUPING
 13947             OR
 13948         PI-ZERO-CAR-GROUP
 13949         MOVE ZEROS              TO W-COMP-GROUPING.
 13950
 13951     IF  W-FILE-NOT-USED (6)
 13952         PERFORM 6500-READ-ACCT-ONLY THRU 6500-READNEXT
 13953         IF  EMI-ERROR EQUAL ER-0179
 13954             MOVE ER-9327        TO EMI-ERROR
 13955             MOVE -1             TO MAINTL
 13956             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13957             GO TO 6600-EXIT.
 13958
 13959     MOVE  'A'                   TO W-COMP-TYPE.
 13960
 13961     IF  WS-SAV-AM-REMIT-TO GREATER THAN ZEROS
 13962         MOVE WS-SAV-AM-AGT (WS-SAV-AM-REMIT-TO)
 13963                                 TO W-COMP-RESP-PERSON
 13964     ELSE
 13965         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 13966
 13967     PERFORM VARYING W-NDX FROM +1 BY +1 UNTIL
 13968        (W-NDX > +10)
 13969            OR
 13970         (WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'F')
 13971     END-PERFORM
 13972
 13973     IF  WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'F'
 13974         MOVE WS-SAV-AM-AGT (W-NDX)  TO W-COMP-ACCOUNT
 13975     ELSE
 13976         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 13977
 13978     PERFORM 6500-ENDBR.
 13979     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 13980
 13981     IF  W-COMP-RESP-PERSON EQUAL LOW-VALUES
 13982         MOVE ER-9327            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 288
* EL689.cbl
 13983         MOVE -1                 TO MAINTL
 13984         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13985         GO TO 6600-EXIT.
 13986
 13987 6600-START.
 13988
 13989
 13990* EXEC CICS HANDLE CONDITION
 13991*         NOTOPEN (8080-COMP-NOT-OPEN)
 13992*         NOTFND  (6600-COMP-NOT-FOUND)
 13993*    END-EXEC.
 13994*    MOVE '"$JI                  ! 2 #00013159' TO DFHEIV0
 13995     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13996     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13997     MOVE X'3220233030303133313539' TO DFHEIV0(25:11)
 13998     CALL 'kxdfhei1' USING DFHEIV0
 13999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14000
 14001
 14002
 14003* EXEC CICS STARTBR
 14004*         RIDFLD  (W-COMP-KEY)
 14005*         DATASET (W-COMP-FILE-ID)
 14006*    END-EXEC.
 14007     MOVE 0
 14008       TO DFHEIV11
 14009*    MOVE '&,         G          &   #00013164' TO DFHEIV0
 14010     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14011     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14012     MOVE X'2020233030303133313634' TO DFHEIV0(25:11)
 14013     CALL 'kxdfhei1' USING DFHEIV0,
 14014           W-COMP-FILE-ID,
 14015           W-COMP-KEY,
 14016           DFHEIV99,
 14017           DFHEIV11,
 14018           DFHEIV99
 14019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14020
 14021
 14022     MOVE 'Y'                    TO W-COMP-BROWSE-SW.
 14023
 14024 6600-READNEXT.
 14025
 14026
 14027* EXEC CICS READNEXT
 14028*         DATASET (W-COMP-FILE-ID)
 14029*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14030*         RIDFLD  (W-COMP-KEY)
 14031*    END-EXEC.
 14032     MOVE 0
 14033       TO DFHEIV11
 14034*    MOVE '&.S                   )   #00013173' TO DFHEIV0
 14035     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14036     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14037     MOVE X'2020233030303133313733' TO DFHEIV0(25:11)
 14038     CALL 'kxdfhei1' USING DFHEIV0,
 14039           W-COMP-FILE-ID,
 14040           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 289
* EL689.cbl
 14041           DFHEIV99,
 14042           W-COMP-KEY,
 14043           DFHEIV99,
 14044           DFHEIV11,
 14045           DFHEIV99,
 14046           DFHEIV99
 14047     SET ADDRESS OF COMPENSATION-MASTER TO
 14048         DFHEIV20
 14049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14050
 14051
 14052     IF CO-CONTROL-PRIMARY
 14053           NOT = W-COMP-SAVE-KEY
 14054        GO TO 6600-COMP-NOT-FOUND.
 14055
 14056     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14057     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1)
 14058                                    W-VG-TEXT (140).
 14059     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14060     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14061     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14062*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14063     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14064        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14065     END-STRING
 14066
 14067     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14068
 14069     IF  CO-CANADIAN-POST-CODE
 14070         MOVE CO-CANADIAN-POSTAL-CODE
 14071                                 TO W-CANADIAN-POSTAL-CODES
 14072         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14073         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14074         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14075                                    W-LAB-CAN-FILLER (6)
 14076     ELSE
 14077         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14078
 14079         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14080             MOVE '-'            TO W-LABEL-DASH (6)
 14081             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14082         ELSE
 14083             MOVE SPACES         TO W-LABEL-DASH (6)
 14084                                    W-LABEL-2ND-ZIP (6).
 14085
 14086     IF  CO-TELEPHONE NOT NUMERIC
 14087             OR
 14088         CO-TELEPHONE = ZEROS
 14089         MOVE SPACES             TO W-VG-TEXT (147)
 14090     ELSE
 14091         MOVE ZEROS              TO W-PHONE-IN
 14092         MOVE CO-AREA-CODE       TO W-PO-AREA
 14093         MOVE CO-PREFIX          TO W-PO-PFX
 14094         MOVE CO-PHONE           TO W-PO-SFX
 14095         MOVE W-PHONE-OUT        TO W-VG-TEXT (147).
 14096
 14097     IF (CO-FAXNO NOT NUMERIC)
 14098        OR (CO-FAXNO = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 290
* EL689.cbl
 14099        MOVE SPACES              TO W-VG-TEXT (182)
 14100     ELSE
 14101        MOVE ZEROS               TO W-PHONE-IN
 14102        MOVE CO-FAX-AREA-CODE    TO W-PO-AREA
 14103        MOVE CO-FAX-PREFIX       TO W-PO-PFX
 14104        MOVE CO-FAX-PHONE        TO W-PO-SFX
 14105        MOVE W-PHONE-OUT         TO W-VG-TEXT (182)
 14106     END-IF
 14107     IF CO-GA-STATUS-CODE NOT = 'A' AND 'I' AND 'P'
 14108        MOVE SPACES              TO W-VG-TEXT (183)
 14109     ELSE
 14110        EVALUATE CO-GA-STATUS-CODE
 14111           WHEN 'A'
 14112              MOVE 'ACTIVE'      TO W-VG-TEXT (183)
 14113           WHEN 'I'
 14114              MOVE 'INACTIVE'    TO W-VG-TEXT (183)
 14115           WHEN 'P'
 14116              MOVE 'PENDING'     TO W-VG-TEXT (183)
 14117        END-EVALUATE
 14118     END-IF
 14119     IF CO-BILL-SW NOT = 'B' AND 'R' AND 'T' AND 'S'
 14120        MOVE SPACES              TO W-VG-TEXT (181)
 14121     ELSE
 14122        EVALUATE CO-BILL-SW
 14123           WHEN 'B'
 14124              MOVE 'BILLED'      TO W-VG-TEXT (181)
 14125           WHEN 'R'
 14126              MOVE 'REMIT'       TO W-VG-TEXT (181)
 14127           WHEN 'T'
 14128              MOVE 'T'           TO W-VG-TEXT (181)
 14129           WHEN 'S'
 14130              MOVE 'S'           TO W-VG-TEXT (181)
 14131        END-EVALUATE
 14132     END-IF
 14133     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14134
 14135     IF  ADDRSI EQUAL '4'
 14136             AND
 14137         PI-CREATE-LABELS
 14138             AND
 14139         NOT PI-689-LABELS-OVERRIDEN
 14140         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14141                                    W-VG-TEXT (141)
 14142         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14143                                    W-VG-TEXT (142)
 14144         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14145                                    W-VG-TEXT (143)
 14146         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14147                                    W-VG-TEXT (144)
 14148         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14149                                    W-VG-TEXT (145)
 14150         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14151                                    W-VG-TEXT (146)
 14152         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14153         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14154         SET W-RG-NDX UP BY +1
 14155     ELSE
 14156         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (141)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 291
* EL689.cbl
 14157         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (142)
 14158         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (143)
 14159         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (144)
 14160         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (145)
 14161         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (146).
 14162
 14163     PERFORM 6630-GET-CSR-NAME THRU 6630-EXIT.
 14164
 14165     MOVE CO-RESP-NO             TO W-VG-TEXT (180).
 14166     MOVE CO-END-BAL             TO W-EDIT-7-2-NEGATIVE.
 14167     MOVE W-EDIT-7-2-NEGATIVE    TO W-VG-TEXT (150).
 14168
 14169     MOVE CO-LAST-STMT-DT        TO DC-GREG-DATE-1-YMD.
 14170     MOVE '3'                    TO DC-OPTION-CODE.
 14171     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 14172
 14173     IF  NO-CONVERSION-ERROR
 14174         MOVE DC-GREG-DATE-1-ALPHA
 14175                                 TO W-VG-TEXT (149).
 14176
 14177     PERFORM 6620-GET-G-DATA THRU 6620-EXIT.
 14178     PERFORM 6626-GET-B-DATA     THRU 6626-EXIT
 14179
 14180     PERFORM 6600-ENDBR.
 14181     GO TO 6600-EXIT.
 14182
 14183 6600-ENDBR.
 14184
 14185     IF  W-COMP-BROWSE-STARTED
 14186         MOVE 'N'                      TO W-COMP-BROWSE-SW
 14187
 14188* EXEC CICS ENDBR
 14189*             DATASET(W-COMP-FILE-ID)
 14190*        END-EXEC.
 14191     MOVE 0
 14192       TO DFHEIV11
 14193*    MOVE '&2                    $   #00013314' TO DFHEIV0
 14194     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14195     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14196     MOVE X'2020233030303133333134' TO DFHEIV0(25:11)
 14197     CALL 'kxdfhei1' USING DFHEIV0,
 14198           W-COMP-FILE-ID,
 14199           DFHEIV11,
 14200           DFHEIV99
 14201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14202
 14203
 14204 6600-COMP-NOT-FOUND.
 14205
 14206     PERFORM 6600-ENDBR.
 14207
 14208     IF ADDRSL GREATER ZERO
 14209         IF ADDRSI = '4'
 14210            IF PI-689-TYPE EQUAL LOW-VALUES OR SPACES
 14211                MOVE ER-7378                TO EMI-ERROR
 14212                MOVE -1                     TO TYPEL
 14213                MOVE AL-UNBON               TO TYPEA
 14214                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 292
* EL689.cbl
 14215                GO TO 8200-SEND-DATAONLY
 14216            ELSE
 14217                MOVE ER-2114                TO EMI-ERROR
 14218                MOVE -1                     TO ADDRSL
 14219                MOVE AL-UNBON               TO ADDRSA
 14220                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14221                GO TO 8200-SEND-DATAONLY.
 14222
 14223 6600-EXIT.
 14224     EXIT.
 14225 6620-GET-G-DATA.
 14226
 14227     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY.
 14228
 14229     IF  CO-RPTCD2 GREATER THAN SPACES
 14230         MOVE SPACES             TO W-COMP-RESP-PERSON
 14231         MOVE CO-RPTCD2          TO W-COMP-WORK-AREA
 14232         MOVE +10                TO W-CWA-NDX
 14233         PERFORM 6622-FIND-LAST-NON-SPACE
 14234         SET W-COMP-NDX          TO +10
 14235         PERFORM 6625-FILL-IN-RESP-PERSON.
 14236         INSPECT W-COMP-RESP-PERSON CONVERTING SPACES TO ZEROS.
 14237
 14238     MOVE LOW-VALUES             TO W-COMP-ACCOUNT.
 14239     MOVE 'G'                    TO W-COMP-TYPE.
 14240     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 14241
 14242
 14243* EXEC CICS RESETBR
 14244*         RIDFLD  (W-COMP-KEY)
 14245*         DATASET (W-COMP-FILE-ID)
 14246*    END-EXEC.
 14247     MOVE 0
 14248       TO DFHEIV11
 14249*    MOVE '&4         G          &   #00013356' TO DFHEIV0
 14250     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 14251     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14252     MOVE X'2020233030303133333536' TO DFHEIV0(25:11)
 14253     CALL 'kxdfhei1' USING DFHEIV0,
 14254           W-COMP-FILE-ID,
 14255           W-COMP-KEY,
 14256           DFHEIV99,
 14257           DFHEIV11,
 14258           DFHEIV99
 14259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14260
 14261
 14262
 14263* EXEC CICS READNEXT
 14264*         DATASET (W-COMP-FILE-ID)
 14265*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14266*         RIDFLD  (W-COMP-KEY)
 14267*    END-EXEC.
 14268     MOVE 0
 14269       TO DFHEIV11
 14270*    MOVE '&.S                   )   #00013361' TO DFHEIV0
 14271     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14272     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 293
* EL689.cbl
 14273     MOVE X'2020233030303133333631' TO DFHEIV0(25:11)
 14274     CALL 'kxdfhei1' USING DFHEIV0,
 14275           W-COMP-FILE-ID,
 14276           DFHEIV20,
 14277           DFHEIV99,
 14278           W-COMP-KEY,
 14279           DFHEIV99,
 14280           DFHEIV11,
 14281           DFHEIV99,
 14282           DFHEIV99
 14283     SET ADDRESS OF COMPENSATION-MASTER TO
 14284         DFHEIV20
 14285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14286
 14287
 14288     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 14289         GO TO 6620-EXIT.
 14290
 14291     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14292     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 14293     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14294     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14295     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14296*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14297     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14298        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14299     END-STRING
 14300
 14301     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14302
 14303     IF  CO-CANADIAN-POST-CODE
 14304         MOVE CO-CANADIAN-POSTAL-CODE
 14305                                 TO W-CANADIAN-POSTAL-CODES
 14306         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14307         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14308         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14309                                    W-LAB-CAN-FILLER (6)
 14310     ELSE
 14311         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14312         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14313             MOVE '-'            TO W-LABEL-DASH (6)
 14314             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14315         ELSE
 14316             MOVE SPACES         TO W-LABEL-DASH (6)
 14317                                    W-LABEL-2ND-ZIP (6).
 14318
 14319     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14320
 14321     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (174).
 14322     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (175).
 14323     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (176).
 14324     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (177).
 14325     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (178).
 14326     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (179).
 14327
 14328 6620-EXIT.
 14329     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 294
* EL689.cbl
 14331 6622-FIND-LAST-NON-SPACE.
 14332
 14333     IF  W-CWA-CHAR (W-CWA-NDX) EQUAL SPACES
 14334         SUBTRACT +1 FROM W-CWA-NDX
 14335         GO TO 6622-FIND-LAST-NON-SPACE.
 14336
 14337 6622-EXIT.
 14338     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 295
* EL689.cbl
 14340 6625-FILL-IN-RESP-PERSON.
 14341
 14342     MOVE W-CWA-CHAR (W-CWA-NDX) TO W-COMP-RP-CHAR (W-COMP-NDX)
 14343     SET W-COMP-NDX DOWN BY +1.
 14344     SUBTRACT +1 FROM W-CWA-NDX.
 14345
 14346     IF  W-CWA-NDX GREATER THAN ZEROS
 14347         GO TO 6625-FILL-IN-RESP-PERSON.
 14348
 14349 6625-EXIT.
 14350     EXIT.
 14351 6626-GET-B-DATA.
 14352     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY
 14353     IF W-FILE-USED (8)
 14354        PERFORM 6450-READ-CERT-ONLY
 14355        IF W-CERT-FOUND
 14356           MOVE CM-BENEFICIARY (1:10)
 14357                                 TO W-COMP-RESP-PERSON
 14358        ELSE
 14359           MOVE SPACES           TO W-COMP-RESP-PERSON
 14360           GO TO 6626-EXIT
 14361        END-IF
 14362     ELSE
 14363        MOVE CM-BENEFICIARY (1:10)
 14364                                 TO W-COMP-RESP-PERSON
 14365     END-IF
 14366     MOVE LOW-VALUES             TO W-COMP-ACCOUNT
 14367     MOVE 'B'                    TO W-COMP-TYPE
 14368     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY
 14369
 14370
 14371* EXEC CICS RESETBR
 14372*         RIDFLD  (W-COMP-KEY)
 14373*         DATASET (W-COMP-FILE-ID)
 14374*    END-EXEC.
 14375     MOVE 0
 14376       TO DFHEIV11
 14377*    MOVE '&4         G          &   #00013449' TO DFHEIV0
 14378     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 14379     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14380     MOVE X'2020233030303133343439' TO DFHEIV0(25:11)
 14381     CALL 'kxdfhei1' USING DFHEIV0,
 14382           W-COMP-FILE-ID,
 14383           W-COMP-KEY,
 14384           DFHEIV99,
 14385           DFHEIV11,
 14386           DFHEIV99
 14387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14388
 14389
 14390
 14391* EXEC CICS READNEXT
 14392*         DATASET (W-COMP-FILE-ID)
 14393*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14394*         RIDFLD  (W-COMP-KEY)
 14395*    END-EXEC.
 14396     MOVE 0
 14397       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 296
* EL689.cbl
 14398*    MOVE '&.S                   )   #00013454' TO DFHEIV0
 14399     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14400     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14401     MOVE X'2020233030303133343534' TO DFHEIV0(25:11)
 14402     CALL 'kxdfhei1' USING DFHEIV0,
 14403           W-COMP-FILE-ID,
 14404           DFHEIV20,
 14405           DFHEIV99,
 14406           W-COMP-KEY,
 14407           DFHEIV99,
 14408           DFHEIV11,
 14409           DFHEIV99,
 14410           DFHEIV99
 14411     SET ADDRESS OF COMPENSATION-MASTER TO
 14412         DFHEIV20
 14413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14414
 14415
 14416     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 14417         GO TO 6626-EXIT.
 14418
 14419     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14420     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 14421     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14422     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14423     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14424*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14425     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14426        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14427     END-STRING
 14428
 14429     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14430
 14431     IF  CO-CANADIAN-POST-CODE
 14432         MOVE CO-CANADIAN-POSTAL-CODE
 14433                                 TO W-CANADIAN-POSTAL-CODES
 14434         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14435         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14436         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14437                                    W-LAB-CAN-FILLER (6)
 14438     ELSE
 14439         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14440         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14441             MOVE '-'            TO W-LABEL-DASH (6)
 14442             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14443         ELSE
 14444             MOVE SPACES         TO W-LABEL-DASH (6)
 14445                                    W-LABEL-2ND-ZIP (6).
 14446
 14447     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14448
 14449     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (184).
 14450     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (185).
 14451     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (186).
 14452     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (187).
 14453     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (188).
 14454     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (189).
 14455
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 297
* EL689.cbl
 14456 6626-EXIT.
 14457     EXIT.
 14458 6630-GET-CSR-NAME.
 14459
 14460     MOVE SPACES                 TO W-CNTL-KEY.
 14461     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 14462     MOVE +0                     TO W-CNTL-SEQ-NO.
 14463     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 14464     MOVE CO-CSR-CODE            TO W-CNTL-GENL.
 14465
 14466
 14467* EXEC CICS HANDLE CONDITION
 14468*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 14469*         NOTFND     (6630-CNTL2-NOT-FOUND)
 14470*    END-EXEC.
 14471*    MOVE '"$JI                  ! 3 #00013510' TO DFHEIV0
 14472     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14473     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14474     MOVE X'3320233030303133353130' TO DFHEIV0(25:11)
 14475     CALL 'kxdfhei1' USING DFHEIV0
 14476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14477
 14478
 14479
 14480* EXEC CICS READ
 14481*         DATASET    (W-CNTL-FILE-ID)
 14482*         SET        (ADDRESS OF CONTROL-FILE)
 14483*         RIDFLD     (W-CNTL-KEY)
 14484*    END-EXEC.
 14485*    MOVE '&"S        E          (   #00013515' TO DFHEIV0
 14486     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14487     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14488     MOVE X'2020233030303133353135' TO DFHEIV0(25:11)
 14489     CALL 'kxdfhei1' USING DFHEIV0,
 14490           W-CNTL-FILE-ID,
 14491           DFHEIV20,
 14492           DFHEIV99,
 14493           W-CNTL-KEY,
 14494           DFHEIV99,
 14495           DFHEIV99,
 14496           DFHEIV99
 14497     SET ADDRESS OF CONTROL-FILE TO
 14498         DFHEIV20
 14499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14500
 14501
 14502     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (148).
 14503     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 14504     GO TO 6630-EXIT.
 14505
 14506 6630-CNTL2-NOT-FOUND.
 14507
 14508*    MOVE ER-8965                TO EMI-ERROR.
 14509*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14510*    MOVE -1                     TO MAINTL.
 14511*    MOVE AL-UANON               TO MAINTA.
 14512*    GO TO 8200-SEND-DATAONLY
 14513     .
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 298
* EL689.cbl
 14514 6630-EXIT.
 14515     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 299
* EL689.cbl
 14517 6700-GET-MAIL-DATA.
 14518
 14519     IF  ADDRSI EQUAL '5'
 14520             AND
 14521         PI-CREATE-LABELS
 14522             AND
 14523         NOT PI-689-LABELS-OVERRIDEN
 14524         NEXT SENTENCE
 14525     ELSE
 14526         IF  W-FILE-NOT-USED (5)
 14527             GO TO 6700-EXIT.
 14528
 14529     IF  W-MAIL-CERT-NO EQUAL LOW-VALUES
 14530         MOVE ER-9327            TO EMI-ERROR
 14531         MOVE -1                 TO MAINTL
 14532         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14533         GO TO 6700-EXIT.
 14534
 14535
 14536* EXEC CICS HANDLE CONDITION
 14537*         NOTOPEN (8090-MAIL-NOT-OPEN)
 14538*         NOTFND  (6700-MAIL-NOT-FOUND)
 14539*    END-EXEC.
 14540*    MOVE '"$JI                  ! 4 #00013554' TO DFHEIV0
 14541     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14543     MOVE X'3420233030303133353534' TO DFHEIV0(25:11)
 14544     CALL 'kxdfhei1' USING DFHEIV0
 14545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14546
 14547
 14548
 14549* EXEC CICS READ
 14550*         DATASET(W-MAIL-FILE-ID)
 14551*         SET    (ADDRESS OF MAILING-DATA)
 14552*         RIDFLD (W-MAIL-KEY)
 14553*    END-EXEC.
 14554*    MOVE '&"S        E          (   #00013559' TO DFHEIV0
 14555     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14557     MOVE X'2020233030303133353539' TO DFHEIV0(25:11)
 14558     CALL 'kxdfhei1' USING DFHEIV0,
 14559           W-MAIL-FILE-ID,
 14560           DFHEIV20,
 14561           DFHEIV99,
 14562           W-MAIL-KEY,
 14563           DFHEIV99,
 14564           DFHEIV99,
 14565           DFHEIV99
 14566     SET ADDRESS OF MAILING-DATA TO
 14567         DFHEIV20
 14568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14569
 14570
 14571     MOVE MA-INSURED-LAST-NAME   TO W-NAME-LAST.
 14572     MOVE MA-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 14573     MOVE MA-INSURED-MIDDLE-INIT TO W-NAME-MIDDLE.
 14574     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 300
* EL689.cbl
 14575
 14576     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14577     MOVE WS-NAME-WORK           TO W-LABEL-LINES (1).
 14578     MOVE W-LABEL-JOINT-NAME     TO W-LABEL-LINES (2).
 14579     MOVE MA-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 14580     MOVE MA-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 14581*    MOVE MA-CITY-STATE          TO W-LABEL-LINES (5).
 14582     STRING MA-CITY ' ' MA-ADDR-STATE
 14583        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14584     END-STRING
 14585
 14586     MOVE MA-ZIP                 TO W-WORK-ZIP.
 14587     MOVE SPACES                 TO W-LABEL-ZIP (6).
 14588
 14589     IF  MA-CANADIAN-POST-CODE
 14590         MOVE MA-CANADIAN-POSTAL-CODE
 14591                                 TO W-CANADIAN-POSTAL-CODES
 14592         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14593         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14594         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14595                                    W-LAB-CAN-FILLER (6)
 14596     ELSE
 14597         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14598         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14599             MOVE '-'            TO W-LABEL-DASH (6)
 14600             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14601         ELSE
 14602             MOVE SPACES         TO W-LABEL-DASH (6)
 14603                                    W-LABEL-2ND-ZIP (6).
 14604
 14605     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14606
 14607     IF  ADDRSI EQUAL '5'
 14608             AND
 14609         PI-CREATE-LABELS
 14610             AND
 14611         NOT PI-689-LABELS-OVERRIDEN
 14612         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14613                                    W-VG-TEXT (31)
 14614         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14615                                    W-VG-TEXT (32)
 14616         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14617                                    W-VG-TEXT (33)
 14618         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14619                                    W-VG-TEXT (34)
 14620         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14621                                    W-VG-TEXT (35)
 14622         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14623                                    W-VG-TEXT (36)
 14624         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14625         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14626         SET W-RG-NDX UP BY +1
 14627     ELSE
 14628         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (31)
 14629         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (32)
 14630         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (33)
 14631         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (34)
 14632         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (35)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 301
* EL689.cbl
 14633         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (36).
 14634     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14635     MOVE MA-CRED-BENE-NAME      TO W-LABEL-LINES (1)
 14636     MOVE MA-CRED-BENE-ADDR      TO W-LABEL-LINES (2)
 14637     MOVE MA-CRED-BENE-ADDR2     TO W-LABEL-LINES (3)
 14638     STRING MA-CRED-BENE-CITY ' ' MA-CRED-BENE-STATE
 14639        DELIMITED BY '  ' INTO W-LABEL-LINES (4)
 14640     END-STRING
 14641
 14642     MOVE MA-CRED-BENE-ZIP       TO W-WORK-ZIP
 14643     MOVE SPACES                 TO W-LABEL-ZIP (5)
 14644
 14645     IF  MA-CB-CANADIAN-POST-CODE
 14646         MOVE MA-CB-CANADIAN-POSTAL-CODE
 14647                                 TO W-CANADIAN-POSTAL-CODES
 14648         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 14649         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 14650         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 14651                                    W-LAB-CAN-FILLER (5)
 14652     ELSE
 14653         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 14654         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14655             MOVE '-'            TO W-LABEL-DASH (5)
 14656             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 14657         ELSE
 14658             MOVE SPACES         TO W-LABEL-DASH (5)
 14659                                    W-LABEL-2ND-ZIP (5)
 14660         END-IF
 14661     END-IF
 14662     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT
 14663     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (37)
 14664     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (50)
 14665     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (51)
 14666     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (52)
 14667     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (53)
 14668     GO TO 6700-EXIT.
 14669
 14670 6700-MAIL-NOT-FOUND.
 14671
 14672     IF  ADDRSL GREATER ZERO
 14673         IF ADDRSI = '5'
 14674            MOVE ER-3000         TO EMI-ERROR
 14675            MOVE -1              TO ADDRSL
 14676            MOVE AL-UNBON        TO ADDRSA
 14677            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14678            GO TO 8200-SEND-DATAONLY.
 14679
 14680 6700-EXIT.
 14681     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 302
* EL689.cbl
 14683 6750-GET-LIFE-BENEFIT-DATA.
 14684
 14685     IF  W-FILE-NOT-USED (2)
 14686         GO TO 6750-EXIT.
 14687
 14688     MOVE SPACES                 TO W-CNTL-GEN2.
 14689
 14690     IF  DATASORI EQUAL '2'
 14691         IF  W-FILE-NOT-USED (8)
 14692             PERFORM 6450-READ-CERT-ONLY
 14693             IF  W-CERT-FOUND
 14694                 MOVE CM-LF-BENEFIT-CD
 14695                                 TO W-BEN-HOLD
 14696                                    W-CNTL-GEN2
 14697             ELSE
 14698                 NEXT SENTENCE
 14699         ELSE
 14700             MOVE CM-LF-BENEFIT-CD
 14701                                 TO W-BEN-HOLD
 14702                                    W-CNTL-GEN2
 14703     ELSE
 14704         IF  DATASORI EQUAL '4'
 14705             IF  W-FILE-NOT-USED (9)
 14706                 PERFORM 6400-READ-PNDB-ONLY
 14707                 IF  W-PNDB-FOUND
 14708                     IF  PI-689-TYPE = '1'
 14709                         MOVE PB-I-LF-BENEFIT-CD
 14710                                 TO W-BEN-HOLD
 14711                                    W-CNTL-GEN2
 14712                     ELSE
 14713                         MOVE PB-CI-LF-BENEFIT-CD
 14714                                 TO W-BEN-HOLD
 14715                                    W-CNTL-GEN2
 14716             ELSE
 14717                 NEXT SENTENCE
 14718         ELSE
 14719             IF  W-FILE-USED (8)
 14720                 MOVE CM-LF-BENEFIT-CD
 14721                                 TO W-BEN-HOLD
 14722                                    W-CNTL-GEN2
 14723             ELSE
 14724                 IF  W-FILE-USED (9)
 14725                     IF  PI-689-TYPE = '1'
 14726                         MOVE PB-I-LF-BENEFIT-CD
 14727                                 TO W-BEN-HOLD
 14728                                    W-CNTL-GEN2
 14729                     ELSE
 14730                         MOVE PB-CI-LF-BENEFIT-CD
 14731                                 TO W-BEN-HOLD
 14732                                    W-CNTL-GEN2.
 14733
 14734     IF  W-CNTL-GEN2 EQUAL SPACES
 14735         MOVE ER-9327            TO EMI-ERROR
 14736         MOVE -1                 TO MAINTL
 14737         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14738         GO TO 6750-EXIT.
 14739
 14740     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 303
* EL689.cbl
 14741     MOVE '4'                    TO W-CNTL-RECORD-TYPE.
 14742     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14743
 14744
 14745* EXEC CICS HANDLE CONDITION
 14746*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14747*         NOTFND  (6750-EXIT)
 14748*    END-EXEC.
 14749*    MOVE '"$JI                  ! 5 #00013738' TO DFHEIV0
 14750     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14752     MOVE X'3520233030303133373338' TO DFHEIV0(25:11)
 14753     CALL 'kxdfhei1' USING DFHEIV0
 14754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14755
 14756
 14757
 14758* EXEC CICS READ
 14759*         DATASET (W-CNTL-FILE-ID)
 14760*         SET     (ADDRESS OF CONTROL-FILE)
 14761*         GTEQ
 14762*         RIDFLD  (W-CNTL-KEY)
 14763*    END-EXEC.
 14764*    MOVE '&"S        G          (   #00013743' TO DFHEIV0
 14765     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14766     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14767     MOVE X'2020233030303133373433' TO DFHEIV0(25:11)
 14768     CALL 'kxdfhei1' USING DFHEIV0,
 14769           W-CNTL-FILE-ID,
 14770           DFHEIV20,
 14771           DFHEIV99,
 14772           W-CNTL-KEY,
 14773           DFHEIV99,
 14774           DFHEIV99,
 14775           DFHEIV99
 14776     SET ADDRESS OF CONTROL-FILE TO
 14777         DFHEIV20
 14778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14779
 14780
 14781     MOVE 1                      TO W-NDX.
 14782
 14783 6750-LOOP.
 14784
 14785     IF  W-NDX = 9
 14786         GO TO 6750-EXIT.
 14787
 14788     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14789         ADD 1                   TO W-NDX
 14790         GO TO 6750-LOOP.
 14791
 14792     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14793         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14794                                 TO W-VG-TEXT (11).
 14795
 14796 6750-EXIT.
 14797     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 304
* EL689.cbl
 14799 6800-GET-A-H-BENEFIT-DATA.
 14800
 14801     IF  W-FILE-NOT-USED (3)
 14802         GO TO 6800-EXIT.
 14803
 14804     MOVE SPACES                 TO W-CNTL-GEN2.
 14805
 14806     IF  DATASORI EQUAL '2'
 14807         IF  W-FILE-NOT-USED (8)
 14808             PERFORM 6450-READ-CERT-ONLY
 14809             IF  W-CERT-FOUND
 14810                 MOVE CM-AH-BENEFIT-CD
 14811                                 TO W-BEN-HOLD
 14812                                    W-CNTL-GEN2
 14813             ELSE
 14814                 NEXT SENTENCE
 14815         ELSE
 14816             MOVE CM-AH-BENEFIT-CD
 14817                                 TO W-BEN-HOLD
 14818                                    W-CNTL-GEN2
 14819     ELSE
 14820         IF  DATASORI EQUAL '4'
 14821             IF  W-FILE-NOT-USED (9)
 14822                 PERFORM 6400-READ-PNDB-ONLY
 14823                 IF  W-PNDB-FOUND
 14824                     IF  PI-689-TYPE = '1'
 14825                         MOVE PB-I-AH-BENEFIT-CD
 14826                                 TO W-BEN-HOLD
 14827                                    W-CNTL-GEN2
 14828                     ELSE
 14829                         MOVE PB-CI-AH-BENEFIT-CD
 14830                                 TO W-BEN-HOLD
 14831                                    W-CNTL-GEN2
 14832             ELSE
 14833                 NEXT SENTENCE
 14834         ELSE
 14835             IF  W-FILE-USED (8)
 14836                 MOVE CM-AH-BENEFIT-CD
 14837                                 TO W-BEN-HOLD
 14838                                    W-CNTL-GEN2
 14839             ELSE
 14840                 IF  W-FILE-USED (9)
 14841                     IF  PI-689-TYPE = '1'
 14842                         MOVE PB-I-AH-BENEFIT-CD
 14843                                 TO W-BEN-HOLD
 14844                                    W-CNTL-GEN2
 14845                     ELSE
 14846                         MOVE PB-CI-AH-BENEFIT-CD
 14847                                 TO W-BEN-HOLD
 14848                                    W-CNTL-GEN2.
 14849
 14850     IF  W-CNTL-GEN2 EQUAL SPACES
 14851         MOVE ER-9327            TO EMI-ERROR
 14852         MOVE -1                 TO MAINTL
 14853         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14854         GO TO 6800-EXIT.
 14855
 14856     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 305
* EL689.cbl
 14857     MOVE '5'                    TO W-CNTL-RECORD-TYPE.
 14858     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14859
 14860
 14861* EXEC CICS HANDLE CONDITION
 14862*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14863*         NOTFND  (6800-EXIT)
 14864*    END-EXEC.
 14865*    MOVE '"$JI                  ! 6 #00013829' TO DFHEIV0
 14866     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14867     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14868     MOVE X'3620233030303133383239' TO DFHEIV0(25:11)
 14869     CALL 'kxdfhei1' USING DFHEIV0
 14870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14871
 14872
 14873
 14874* EXEC CICS READ
 14875*         DATASET (W-CNTL-FILE-ID)
 14876*         SET     (ADDRESS OF CONTROL-FILE)
 14877*         RIDFLD  (W-CNTL-KEY)
 14878*         GTEQ
 14879*    END-EXEC.
 14880*    MOVE '&"S        G          (   #00013834' TO DFHEIV0
 14881     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14882     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14883     MOVE X'2020233030303133383334' TO DFHEIV0(25:11)
 14884     CALL 'kxdfhei1' USING DFHEIV0,
 14885           W-CNTL-FILE-ID,
 14886           DFHEIV20,
 14887           DFHEIV99,
 14888           W-CNTL-KEY,
 14889           DFHEIV99,
 14890           DFHEIV99,
 14891           DFHEIV99
 14892     SET ADDRESS OF CONTROL-FILE TO
 14893         DFHEIV20
 14894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14895
 14896
 14897     MOVE 1                      TO W-NDX.
 14898
 14899 6800-LOOP-AH.
 14900
 14901     IF  W-NDX = 9
 14902         GO TO 6800-EXIT.
 14903
 14904     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14905         ADD 1                   TO W-NDX
 14906         GO TO 6800-LOOP-AH.
 14907
 14908     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14909         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14910                                 TO W-VG-TEXT (15)
 14911         MOVE CF-BENEFIT-ALPHA (W-NDX)
 14912                                 TO W-BENEFIT-WORK
 14913         MOVE W-ELIM-DAYS        TO W-VG-TEXT (16).
 14914
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 306
* EL689.cbl
 14915 6800-EXIT.
 14916     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 307
* EL689.cbl
 14918 6850-GET-CHECK-DATA.
 14919
 14920     IF  ADDRSI EQUAL '6'
 14921             AND
 14922         PI-CREATE-LABELS
 14923             AND
 14924         NOT PI-689-LABELS-OVERRIDEN
 14925         NEXT SENTENCE
 14926     ELSE
 14927         IF  W-FILE-NOT-USED (12)
 14928             GO TO 6850-EXIT.
 14929
 14930     IF  W-CHEK-CERT-NO EQUAL LOW-VALUES
 14931         MOVE ER-9327            TO EMI-ERROR
 14932         MOVE -1                 TO MAINTL
 14933         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14934         GO TO 6850-EXIT.
 14935
 14936
 14937* EXEC CICS HANDLE CONDITION
 14938*         NOTOPEN (8045-CHEK-NOT-OPEN)
 14939*         NOTFND  (6850-CHEK-NOT-FOUND)
 14940*    END-EXEC.
 14941*    MOVE '"$JI                  ! 7 #00013880' TO DFHEIV0
 14942     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14944     MOVE X'3720233030303133383830' TO DFHEIV0(25:11)
 14945     CALL 'kxdfhei1' USING DFHEIV0
 14946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14947
 14948
 14949
 14950* EXEC CICS READ
 14951*         DATASET (W-CHEK-FILE-ID)
 14952*         SET     (ADDRESS OF CHECK-RECORDS)
 14953*         RIDFLD  (W-CHEK-KEY)
 14954*    END-EXEC.
 14955*    MOVE '&"S        E          (   #00013885' TO DFHEIV0
 14956     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14957     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14958     MOVE X'2020233030303133383835' TO DFHEIV0(25:11)
 14959     CALL 'kxdfhei1' USING DFHEIV0,
 14960           W-CHEK-FILE-ID,
 14961           DFHEIV20,
 14962           DFHEIV99,
 14963           W-CHEK-KEY,
 14964           DFHEIV99,
 14965           DFHEIV99,
 14966           DFHEIV99
 14967     SET ADDRESS OF CHECK-RECORDS TO
 14968         DFHEIV20
 14969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14970
 14971
 14972     MOVE CH-CHECK-NO            TO W-VG-TEXT (158).
 14973     MOVE CH-AMOUNT-PAID         TO W-EDIT-7-2.
 14974     MOVE W-EDIT-7-2             TO W-VG-TEXT (157).
 14975     MOVE CH-CHECK-QUE-CONTROL   TO W-DISPLAY-8
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 308
* EL689.cbl
 14976                                    PI-689-CONTROL.
 14977     MOVE W-DISPLAY-8            TO W-VG-TEXT (165).
 14978     MOVE CH-REASON-FOR-CHECK    TO W-VG-TEXT (166).
 14979
 14980     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14981     MOVE CH-PAYEE-NAME-1        TO W-LABEL-LINES (1).
 14982     MOVE CH-PAYEE-NAME-2        TO W-LABEL-LINES (2).
 14983     MOVE CH-PAYEE-ADDRESS-1     TO W-LABEL-LINES (3).
 14984     MOVE CH-PAYEE-ADDRESS-2     TO W-LABEL-LINES (4).
 14985     MOVE CH-PAYEE-CITY-ST       TO W-LABEL-LINES (5).
 14986
 14987     MOVE CH-PAYEE-ZIP           TO W-WORK-ZIP.
 14988     MOVE SPACES                 TO W-LABEL-ZIP (6).
 14989
 14990     IF  CH-CANADIAN-POST-CODE
 14991         MOVE CH-CANADIAN-POSTAL-CODE
 14992                                 TO W-CANADIAN-POSTAL-CODES
 14993         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14994         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14995         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14996                                    W-LAB-CAN-FILLER (6)
 14997     ELSE
 14998         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14999         IF  W-WORK-ZIP4 GREATER THAN '0000'
 15000             MOVE '-'            TO W-LABEL-DASH (6)
 15001             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 15002         ELSE
 15003             MOVE SPACES         TO W-LABEL-DASH (6)
 15004                                    W-LABEL-2ND-ZIP (6).
 15005
 15006     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 15007
 15008     IF  ADDRSI EQUAL '6'
 15009             AND
 15010         PI-CREATE-LABELS
 15011             AND
 15012         NOT PI-689-LABELS-OVERRIDEN
 15013         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 15014                                    W-VG-TEXT (159)
 15015         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 15016                                    W-VG-TEXT (160)
 15017         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 15018                                    W-VG-TEXT (161)
 15019         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 15020                                    W-VG-TEXT (162)
 15021         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 15022                                    W-VG-TEXT (163)
 15023         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 15024                                    W-VG-TEXT (164)
 15025         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 15026         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 15027         SET W-RG-NDX UP BY +1
 15028     ELSE
 15029         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (159)
 15030         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (160)
 15031         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (161)
 15032         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (162)
 15033         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (163)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 309
* EL689.cbl
 15034         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (164).
 15035
 15036     GO TO 6850-EXIT.
 15037
 15038 6850-CHEK-NOT-FOUND.
 15039
 15040     IF  ADDRSL GREATER ZERO
 15041         IF ADDRSI = '6'
 15042            MOVE ER-2908         TO EMI-ERROR
 15043            MOVE -1              TO ADDRSL
 15044            MOVE AL-UNBON        TO ADDRSA
 15045            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15046            GO TO 8200-SEND-DATAONLY.
 15047
 15048 6850-EXIT.
 15049     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 310
* EL689.cbl
 15051 6900-GET-PYAJ-DATA.
 15052
 15053     IF  W-FILE-NOT-USED (13)
 15054         GO TO 6900-EXIT.
 15055
 15056     IF  W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 15057         MOVE ER-9327            TO EMI-ERROR
 15058         MOVE -1                 TO MAINTL
 15059         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15060         GO TO 6900-EXIT.
 15061
 15062
 15063* EXEC CICS HANDLE CONDITION
 15064*         NOTOPEN (8085-PYAJ-NOT-OPEN)
 15065*         NOTFND  (6900-PYAJ-NOT-FOUND)
 15066*    END-EXEC.
 15067*    MOVE '"$JI                  ! 8 #00013981' TO DFHEIV0
 15068     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 15069     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15070     MOVE X'3820233030303133393831' TO DFHEIV0(25:11)
 15071     CALL 'kxdfhei1' USING DFHEIV0
 15072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15073
 15074
 15075 6900-READ-NEXT.
 15076
 15077
 15078* EXEC CICS READ
 15079*         DATASET (W-PYAJ-FILE-ID)
 15080*         SET     (ADDRESS OF PENDING-PAY-ADJ)
 15081*         RIDFLD  (W-PYAJ-KEY)
 15082*         GTEQ
 15083*    END-EXEC.
 15084*    MOVE '&"S        G          (   #00013988' TO DFHEIV0
 15085     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15086     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15087     MOVE X'2020233030303133393838' TO DFHEIV0(25:11)
 15088     CALL 'kxdfhei1' USING DFHEIV0,
 15089           W-PYAJ-FILE-ID,
 15090           DFHEIV20,
 15091           DFHEIV99,
 15092           W-PYAJ-KEY,
 15093           DFHEIV99,
 15094           DFHEIV99,
 15095           DFHEIV99
 15096     SET ADDRESS OF PENDING-PAY-ADJ TO
 15097         DFHEIV20
 15098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15099
 15100
 15101     IF  PY-COMPANY-CD NOT EQUAL W-PYAJ-COMPANY-CD
 15102             OR
 15103         PY-CARRIER NOT EQUAL W-PYAJ-CARRIER
 15104             OR
 15105         PY-GROUPING NOT EQUAL W-PYAJ-GROUPING
 15106             OR
 15107         PY-FIN-RESP NOT EQUAL W-PYAJ-FIN-RESP
 15108             OR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 311
* EL689.cbl
 15109         PY-ACCOUNT NOT EQUAL W-PYAJ-ACCOUNT
 15110         GO TO 6900-PYAJ-NOT-FOUND.
 15111
 15112     IF  PI-689-SEQ-NO GREATER THAN ZEROS
 15113             AND
 15114         PY-FILE-SEQ-NO NOT EQUAL PI-689-SEQ-NO
 15115         GO TO 6900-PYAJ-NOT-FOUND.
 15116
 15117     IF  PY-RECORD-TYPE NOT EQUAL W-PYAJ-RECORD-TYPE
 15118         MOVE PY-CONTROL-PRIMARY TO W-PYAJ-KEY
 15119         ADD +1                  TO W-PYAJ-FILE-SEQ-NO
 15120         GO TO 6900-READ-NEXT.
 15121
 15122     MOVE PY-CHECK-NUMBER        TO W-DISPLAY-7.
 15123     MOVE W-DISPLAY-7            TO W-VG-TEXT (171).
 15124
 15125     MOVE PY-ENTRY-AMT           TO W-EDIT-7-2.
 15126     MOVE W-EDIT-7-2             TO W-VG-TEXT (170).
 15127
 15128     MOVE PY-CHECK-QUE-CONTROL   TO W-DISPLAY-8
 15129                                    PI-689-CONTROL.
 15130     MOVE W-DISPLAY-8            TO W-VG-TEXT (172).
 15131     MOVE PY-ENTRY-COMMENT       TO W-VG-TEXT (173).
 15132
 15133     GO TO 6900-EXIT.
 15134
 15135 6900-PYAJ-NOT-FOUND.
 15136
 15137     MOVE ER-7395                TO EMI-ERROR
 15138     MOVE -1                     TO DATASORL
 15139     MOVE AL-UNBON               TO DATASORA
 15140     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15141     GO TO 8200-SEND-DATAONLY.
 15142
 15143 6900-EXIT.
 15144     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 312
* EL689.cbl
 15146 6950-MOVE-SYSTEM-DATA.
 15147
 15148     IF  W-FILE-NOT-USED (7)
 15149         GO TO 6950-EXIT.
 15150
 15151     MOVE EIBDATE                TO W-DATE-WORK.
 15152     MOVE W-DT-WORK              TO DC-JULIAN-YYDDD.
 15153     MOVE '5'                    TO DC-OPTION-CODE.
 15154     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 15155     MOVE DC-GREG-DATE-1-EDIT    TO W-VG-TEXT (60).
 15156     MOVE DC-GREG-DATE-1-ALPHA   TO W-VG-TEXT (61).
 15157
 15158     MOVE FORMI                  TO W-VG-TEXT (62).
 15159
 15160     IF  PI-689-VARIABLE-DATA-1 GREATER THAN SPACES
 15161         MOVE PI-689-VARIABLE-DATA-1
 15162                                 TO W-VG-TEXT (63)
 15163         MOVE PI-689-VARIABLE-DATA-2
 15164                                 TO W-VG-TEXT (64)
 15165         MOVE PI-689-VARIABLE-DATA-3
 15166                                 TO W-VG-TEXT (65)
 15167         MOVE PI-689-VARIABLE-DATA-4
 15168                                 TO W-VG-TEXT (66)
 15169     ELSE
 15170         MOVE '(VARIABLE NOT PROVIDED)'
 15171                                 TO W-VG-TEXT (63).
 15172
 15173 6950-EXIT.
 15174     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 313
* EL689.cbl
 15176 7000-FORMAT-SCREEN.
 15177
 15178     IF  MAINTI EQUAL 'S'
 15179             OR
 15180         PI-SHOW-MODE
 15181         MOVE AL-PANOF           TO W-SC-TEXTA (W-SC-NDX)
 15182     ELSE
 15183         MOVE AL-UANOF           TO W-SC-TEXTA (W-SC-NDX).
 15184
 15185     IF  W-RG-NDX NOT GREATER THAN PI-689-NUMBER-LABEL-LINES
 15186         SET W-LINE23            TO W-RG-NDX
 15187         MOVE 'A'                TO W-LINE1
 15188     ELSE
 15189         SET W-LIN-NUM           TO W-RG-NDX
 15190         COMPUTE W-LIN-NUM
 15191             = W-LIN-NUM - PI-689-NUMBER-LABEL-LINES - 1.
 15192
 15193     MOVE W-LINE-NUM             TO W-SC-LINE (W-SC-NDX).
 15194     MOVE W-RC-TEXT (W-RG-NDX)   TO W-SC-TEXT (W-SC-NDX).
 15195     SET W-RG-NDX UP BY 1.
 15196
 15197 7000-EXIT.
 15198      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 314
* EL689.cbl
 15200 7100-FORMAT-LAST-NAME-1ST.
 15201*****************************************************************
 15202*             M O V E   N A M E   R O U T I N E                 *
 15203*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15204*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15205*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15206*                  FIELD                   VALUE                *
 15207*           W-NAME-LAST    (CL15)      SMITH                    *
 15208*           W-NAME-FIRST   (CL15)      JOHN                     *
 15209*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15210*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15211*     CONTAIN                                                   *
 15212*                SMITH, JOHN ALLEN                              *
 15213*     OR                                                        *
 15214*                SMITH, JOHN A.                                 *
 15215*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15216*     COPYBOOK, ELCNWA.                                         *
 15217*****************************************************************.
 15218
 15219     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15220     MOVE ZERO                   TO WS-NAME-SW.
 15221     SET NWA-INDEX               TO +1.
 15222
 15223     IF  W-NAME-LAST EQUAL SPACES
 15224             AND
 15225         W-NAME-MIDDLE EQUAL SPACES
 15226         MOVE +1                 TO WS-NAME-SW.
 15227
 15228     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15229     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15230
 15231     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15232     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15233
 15234     SET NWA-INDEX UP BY +1.
 15235
 15236     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 15237         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 15238             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15239             SET NWA-INDEX UP BY +1
 15240             MOVE '.'            TO WS-NW (NWA-INDEX)
 15241             SET NWA-INDEX UP BY +2
 15242         ELSE
 15243             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15244             PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15245
 15246 7100-EXIT.
 15247     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 315
* EL689.cbl
 15249 7110-MOVE-NAME.
 15250
 15251     IF  WS-NAME-SW GREATER THAN +1
 15252         GO TO 7110-EXIT.
 15253
 15254     IF  WS-NAME-WORK2 = SPACES
 15255         GO TO 7110-EXIT.
 15256
 15257     SET NWA-INDEX2            TO +1.
 15258     SET NWA-INDEX3            TO +2.
 15259
 15260 7110-MOVE-NAME-CYCLE.
 15261
 15262     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15263
 15264     IF  NWA-INDEX LESS THAN +30
 15265         SET NWA-INDEX UP BY +1
 15266     ELSE
 15267         ADD +2                TO WS-NAME-SW
 15268         GO TO 7110-EXIT.
 15269
 15270     IF  NWA-INDEX2 LESS THAN +20
 15271         SET NWA-INDEX3 UP BY +1
 15272         SET NWA-INDEX2 UP BY +1.
 15273
 15274     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 15275             AND
 15276         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 15277         IF  WS-NAME-SW EQUAL ZERO
 15278             MOVE ','            TO WS-NW (NWA-INDEX)
 15279             SET NWA-INDEX UP BY +2
 15280             MOVE +1             TO WS-NAME-SW
 15281             GO TO 7110-EXIT
 15282         ELSE
 15283             GO TO 7110-EXIT.
 15284
 15285     GO TO 7110-MOVE-NAME-CYCLE.
 15286
 15287 7110-EXIT.
 15288     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 316
* EL689.cbl
 15290 7200-FORMAT-NAME-STRAIGHT.
 15291*****************************************************************
 15292*           M O V E   N A M E   R O U T I N E                   *
 15293*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15294*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15295*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15296*                  FIELD                   VALUE                *
 15297*           W-NAME-LAST    (CL15)      SMITH                    *
 15298*           W-NAME-FIRST   (CL15)      JOHN                     *
 15299*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15300*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15301*     CONTAIN                                                   *
 15302*              JOHN A. SMITH                                    *
 15303*     OR                                                        *
 15304*              JOHN ALLEN SMITH                                 *
 15305*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15306*     COPYBOOK, ELCNWA.                                         *
 15307*****************************************************************
 15308
 15309     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15310     MOVE ZERO                   TO WS-NAME-SW.
 15311     SET NWA-INDEX               TO +1.
 15312
 15313     IF  W-NAME-FIRST EQUAL SPACES
 15314             AND
 15315         W-NAME-MIDDLE EQUAL SPACES
 15316         MOVE W-NAME-LAST        TO WS-NAME-WORK
 15317         GO TO 7200-EXIT.
 15318
 15319     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15320     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15321
 15322     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 15323         SET NWA-INDEX UP BY +1
 15324
 15325         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 15326             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15327             SET NWA-INDEX UP BY +1
 15328             MOVE '.'            TO WS-NW (NWA-INDEX)
 15329             SET NWA-INDEX UP BY +1
 15330
 15331         ELSE
 15332             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15333             PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15334
 15335     SET NWA-INDEX UP BY +1
 15336     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15337     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15338
 15339 7200-EXIT.
 15340     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 317
* EL689.cbl
 15342 7290-MOVE-NAME.
 15343
 15344     IF  WS-NAME-SW GREATER THAN +1
 15345         GO TO 7290-EXIT.
 15346
 15347     IF  WS-NAME-WORK2 EQUAL SPACES
 15348         GO TO 7290-EXIT.
 15349
 15350     SET NWA-INDEX2            TO +1.
 15351     SET NWA-INDEX3            TO +2.
 15352
 15353 7290-MOVE-NAME-CYCLE.
 15354
 15355     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15356
 15357     IF  NWA-INDEX LESS THAN +30
 15358         SET NWA-INDEX UP BY +1
 15359     ELSE
 15360         ADD +2                TO WS-NAME-SW
 15361         GO TO 7290-EXIT.
 15362
 15363     IF  NWA-INDEX2 LESS THAN +20
 15364         SET NWA-INDEX2 UP BY +1
 15365         SET NWA-INDEX3 UP BY +1.
 15366
 15367     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 15368             AND
 15369         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 15370         GO TO 7290-EXIT.
 15371
 15372     GO TO 7290-MOVE-NAME-CYCLE.
 15373
 15374 7290-EXIT.
 15375     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 318
* EL689.cbl
 15377 7300-LABEL-MOVE.
 15378
 15379     IF  W-LABEL-HOLD-AREA = SPACES
 15380         MOVE +0                 TO W-NUMB-LABEL-LINES
 15381         GO TO 7300-EXIT.
 15382
 15383     IF  W-LABEL-LINES (1) = SPACES
 15384         MOVE W-LABEL-LINES (2)  TO W-LABEL-LINES (1)
 15385         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 15386         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15387         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15388         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15389         MOVE SPACES             TO W-LABEL-LINES (6)
 15390         GO TO 7300-LABEL-MOVE.
 15391
 15392     IF  W-LABEL-LINES (2) = SPACES
 15393             AND
 15394         W-LABEL-LINES (3) = SPACES
 15395             AND
 15396         W-LABEL-LINES (4) = SPACES
 15397             AND
 15398         W-LABEL-LINES (5) = SPACES
 15399             AND
 15400         W-LABEL-LINES (6) = SPACES
 15401         MOVE 1                  TO W-NDX
 15402                                    W-NUMB-LABEL-LINES
 15403         GO TO 7300-EXIT.
 15404
 15405 7300-TRY-2.
 15406
 15407     IF  W-LABEL-LINES (2) = SPACES
 15408         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 15409         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15410         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15411         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15412         MOVE SPACES             TO W-LABEL-LINES (6)
 15413         GO TO 7300-TRY-2.
 15414
 15415     IF  W-LABEL-LINES (3) = SPACES
 15416             AND
 15417         W-LABEL-LINES (4) = SPACES
 15418             AND
 15419         W-LABEL-LINES (5) = SPACES
 15420             AND
 15421         W-LABEL-LINES (6) = SPACES
 15422         MOVE 2                  TO W-NDX
 15423         GO TO 7300-MOVE-ZIP.
 15424
 15425 7300-TRY-3.
 15426
 15427     IF  W-LABEL-LINES (3) = SPACES
 15428         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15429         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15430         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15431         MOVE SPACES             TO W-LABEL-LINES (6)
 15432         GO TO 7300-TRY-3.
 15433
 15434     IF  W-LABEL-LINES (4) = SPACES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 319
* EL689.cbl
 15435             AND
 15436         W-LABEL-LINES (5) = SPACES
 15437             AND
 15438         W-LABEL-LINES (6) = SPACES
 15439         MOVE 3                   TO W-NDX
 15440         GO TO 7300-MOVE-ZIP.
 15441
 15442 7300-TRY-4.
 15443
 15444     IF  W-LABEL-LINES (4) = SPACES
 15445         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15446         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15447         MOVE SPACES             TO W-LABEL-LINES (6)
 15448         GO TO 7300-TRY-4.
 15449
 15450     IF  W-LABEL-LINES (5) = SPACES
 15451             AND
 15452         W-LABEL-LINES (6) = SPACES
 15453         MOVE 4                  TO W-NDX
 15454         GO TO 7300-MOVE-ZIP.
 15455
 15456 7300-TRY-5.
 15457
 15458     IF  W-LABEL-LINES (5) = SPACES
 15459         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15460         MOVE SPACES             TO W-LABEL-LINES (6)
 15461         GO TO 7300-TRY-5
 15462     ELSE
 15463         IF  W-LABEL-LINES (6) = SPACES
 15464             MOVE 5              TO W-NDX
 15465             GO TO 7300-MOVE-ZIP
 15466         ELSE
 15467             MOVE 6              TO W-NDX.
 15468
 15469 7300-MOVE-ZIP.
 15470
 15471     COMPUTE W-NDX2 = W-NDX - 1.
 15472
 15473     IF  W-LAST-ZIP (W-NDX2) = SPACES
 15474*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 15475
 15476         IF  W-LABEL-1ST-ZIP (W-NDX) NUMERIC
 15477                 MOVE W-LABEL-ZIP (W-NDX)
 15478                                 TO W-LAST-ZIP (W-NDX2)
 15479                 MOVE SPACES     TO W-LABEL-LINES (W-NDX)
 15480                 MOVE W-NDX2     TO W-NUMB-LABEL-LINES
 15481                 GO TO 7300-EXIT.
 15482
 15483     MOVE W-NDX                  TO W-NUMB-LABEL-LINES.
 15484
 15485 7300-EXIT.
 15486     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 320
* EL689.cbl
 15488 7400-CREATE-LETTER.
 15489****************************************************************
 15490*    THIS AREA CONTROLS THE PROCESSING OF INDIVIDUAL INPUT     *
 15491*    RECORDS.                                                  *
 15492****************************************************************
 15493
 15494     SET W-SQ-NDX                TO W-START-COLUMN.
 15495     MOVE SPACES                 TO W-SQUEEZED-LINE
 15496                                    W-WORK-LINE.
 15497     MOVE W-START-COLUMN         TO W-LAST-SQUEEZED-SPACE
 15498     MOVE +1                     TO W-LAST-WC-SPACE.
 15499     MOVE HIGH-VALUES            TO W-LAST-SQ-CHAR.
 15500
 15501     SET W-TG-NDX                TO +1.
 15502
 15503     PERFORM 7410-TEXT-LINE-PROCESS THRU 7410-EXIT
 15504            VARYING
 15505         W-TG-NDX FROM W-TG-NDX BY +1
 15506            UNTIL
 15507         W-TG-NDX GREATER THAN W-TOTAL-TX-LINES.
 15508
 15509     IF  W-FORM-SQUEEZE-ON
 15510             AND
 15511         W-SQUEEZED-LINE GREATER THAN SPACES
 15512         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT.
 15513
 15514     PERFORM 7640-PAGING THRU 7640-EXIT.
 15515
 15516 7400-EXIT.
 15517     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 321
* EL689.cbl
 15519 7410-TEXT-LINE-PROCESS.
 15520***************************************************************
 15521*    THIS ROUTINE SEARCHES THE TEXT WORK AREA FOR ANY         *
 15522*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 15523*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 15524*    DATA THAT WAS GENERATED PREVIOUSLY.  WHILE PERFORMING    *
 15525*    THIS FUNCTION THE ROUTINE MOVES EACH CHARACTER OR ITS    *
 15526*    VARIABLE REPLACEMENT TO A WORK LINE.                     *
 15527***************************************************************
 15528
 15529
 15530     SET W-WC-NDX                TO W-ZEROS.
 15531     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15532
 15533     MOVE W-TX-SC (W-TG-NDX)     TO W-LINE-SQUEEZE-IND.
 15534
 15535     PERFORM 7420-TEXT-CHAR-PROCESS THRU 7420-EXIT
 15536             VARYING
 15537         W-TX-NDX FROM +1 BY +1
 15538             UNTIL
 15539         W-TX-NDX GREATER THAN +70.
 15540
 15541****************************************************************
 15542*    IF SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS    *
 15543*    EACH LINE OF TEXT IS PROCESSED ACCORDING TO THE INDICATED *
 15544*    LINE SQUEEZE CONTROL.                                     *
 15545****************************************************************
 15546     IF  W-FORM-SQUEEZE-ON
 15547
 15548         IF  W-WORK-LINE GREATER THAN SPACES
 15549                 OR
 15550             W-AS-IS
 15551             PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15552
 15553         ELSE
 15554             NEXT SENTENCE
 15555****************************************************************
 15556*    IF NO SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS *
 15557*    EACH LINE OF TEXT IS PRINT AS IS EXCEPT FOR VARIABLES     *
 15558****************************************************************
 15559     ELSE
 15560         IF  W-WORK-LINE GREATER THAN SPACES
 15561             MOVE W-TX-PC (W-TG-NDX)
 15562                                 TO W-PRINT-CONTROL
 15563             MOVE W-WORK-LINE    TO W-SQUEEZED-LINE
 15564             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15565             MOVE SPACES         TO W-WORK-LINE.
 15566
 15567 7410-EXIT.
 15568     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 322
* EL689.cbl
 15570 7420-TEXT-CHAR-PROCESS.
 15571****************************************************************
 15572*    LOOKING FOR VARIABLE INDICATORS (**XXX) THIS SECTION      *
 15573*    CONTROLS THE CONVERSION OF THESE INDICATORS INTO THEIR    *
 15574*    ACTUAL VALUES.  IT MOVES THESE REPLACEMENTS AND THE       *
 15575*    REMAINING CHARACTERS TO THE WORK LINE.                    *
 15576****************************************************************
 15577
 15578     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 15579             AND
 15580         W-LAST-CHAR EQUAL '@'
 15581         PERFORM 7430-PROCESS-VARIABLE THRU 7430-EXIT.
 15582
 15583     SET W-WC-NDX UP BY +1.
 15584
 15585     IF  W-WC-NDX GREATER THAN +70
 15586         IF  W-FORM-SQUEEZE-ON
 15587                 AND
 15588             NOT W-AS-IS
 15589             PERFORM 7440-BACK-TO-NEAREST-WORD THRU 7440-EXIT
 15590                     VARYING
 15591                 W-WC-NDX FROM W-LAST-WC-SPACE BY +1
 15592                     UNTIL
 15593                 W-WC-NDX EQUAL +71
 15594             SET W-TX-NDX        TO W-LAST-TX-SPACE
 15595
 15596             IF  W-WORK-LINE GREATER THAN SPACES
 15597                 PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15598                 MOVE SPACES     TO W-WORK-LINE
 15599                                    W-LINE-SQUEEZE-IND
 15600                 SET W-WC-NDX    TO +1
 15601             ELSE
 15602                 SET W-WC-NDX    TO +1
 15603         ELSE
 15604             PERFORM 7460-REMAIN-CHAR-CHECK THRU 7460-EXIT.
 15605
 15606     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15607                                 TO W-CHARACTER-TYPE.
 15608
 15609     SET W-WC-NDX2               TO W-WC-NDX.
 15610     SET W-WC-NDX2 DOWN BY +1.
 15611
 15612     IF  W-PUNCTUATION
 15613             AND
 15614         W-WC-NDX2 GREATER THAN W-ZEROS
 15615             AND
 15616         W-WORK-CHAR (W-WC-NDX2) EQUAL SPACES
 15617         SET W-WC-NDX DOWN BY +1.
 15618
 15619     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15620                                 TO W-LAST-CHAR
 15621                                    W-WORK-CHAR (W-WC-NDX).
 15622
 15623     IF  W-LAST-CHAR EQUAL SPACES
 15624         SET W-LAST-WC-SPACE     TO W-WC-NDX
 15625         SET W-LAST-TX-SPACE     TO W-TX-NDX.
 15626
 15627 7420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 323
* EL689.cbl
 15628     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 324
* EL689.cbl
 15630 7430-PROCESS-VARIABLE.
 15631******************************************************************
 15632*    THIS SECTION CHECKS ON ALL '@@XXX' FORMATED CHARACTER       *
 15633*    GROUPS.  IF IN PROPER FORMAT, EACH GROUP IS REPLACED WITH   *
 15634*    ITS CORRESPONDING VALUES.                                   *
 15635******************************************************************
 15636
 15637     SET W-TX-NDX UP BY +1.
 15638
 15639     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15640         MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15641                                 TO W-V1
 15642         SET W-TX-NDX UP BY +1
 15643
 15644         IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15645             MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15646                                 TO W-V2
 15647             SET W-TX-NDX UP BY +1
 15648             IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15649                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15650                                 TO W-V3
 15651                 SET W-TX-NDX UP BY +1
 15652                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15653                                 TO W-FIELD-SQUEEZE-IND
 15654                 GO TO 7430-CONTINUE
 15655             ELSE
 15656                 SET W-TX-NDX DOWN BY +3
 15657                 MOVE ER-0180    TO EMI-ERROR
 15658                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15659                 MOVE -1         TO MAINTL
 15660                 MOVE HIGH-VALUES
 15661                                 TO W-LAST-CHAR
 15662         ELSE
 15663             SET W-TX-NDX DOWN BY +2
 15664             MOVE ER-0180        TO EMI-ERROR
 15665             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15666             MOVE -1             TO MAINTL
 15667             MOVE HIGH-VALUES    TO W-LAST-CHAR
 15668     ELSE
 15669         SET W-TX-NDX DOWN BY +1
 15670         MOVE ER-7246            TO EMI-ERROR
 15671         MOVE -1                 TO MAINTL
 15672         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15673         MOVE HIGH-VALUES        TO W-LAST-CHAR.
 15674
 15675****************************************************************
 15676*    WHEN THE PROPER FORM IS NOT FOUND THE CHARACTERS INVOLVED *
 15677*    ARE TRANSFERRED INTACT AND A NOTE MADE INDICATING THIS    *
 15678*    ACTION.                                                   *
 15679****************************************************************
 15680
 15681     IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15682         MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15683         GO TO 7430-EXIT
 15684     ELSE
 15685         GO TO 7430-EXIT.
 15686
 15687 7430-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 325
* EL689.cbl
 15688
 15689     IF  W-VAR-RELATIVE-NUM LESS THAN 001
 15690             OR
 15691         W-VAR-RELATIVE-NUM GREATER THAN W-NUM-OF-VARIABLES
 15692         SET W-TX-NDX DOWN BY +4
 15693         MOVE ER-0180            TO EMI-ERROR
 15694         MOVE -1                 TO MAINTL
 15695         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15696         MOVE HIGH-VALUES        TO W-LAST-CHAR
 15697         IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15698             MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15699             GO TO 7430-EXIT
 15700         ELSE
 15701             GO TO 7430-EXIT.
 15702
 15703     SET W-VG-NDX                TO W-VAR-RELATIVE-NUM.
 15704
 15705     SET W-WC-NDX DOWN BY +1.
 15706
 15707     IF  (W-FORM-SQUEEZE-OFF
 15708                 AND
 15709             NOT W-SQUEEZE-FIELD)
 15710             OR
 15711         (W-FORM-SQUEEZE-ON
 15712                 AND
 15713             W-AS-IS)
 15714         PERFORM 7435-MOVE-VARIABLE-DIRECT THRU 7435-EXIT
 15715                 VARYING
 15716             W-VC-NDX FROM +1 BY +1
 15717                 UNTIL
 15718             W-VC-NDX GREATER THAN
 15719                 W-VARIABLE-SIZE (W-VG-NDX)
 15720
 15721         IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +5
 15722             SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15723             SET W-TX-NDX DOWN BY +5
 15724             IF  W-TX-NDX GREATER THAN +70
 15725                 SET W-TX-NDX    TO +70
 15726                 GO TO 7430-EXIT
 15727             ELSE
 15728                 GO TO 7430-EXIT
 15729         ELSE
 15730             COMPUTE W-ADJUST-SHORT
 15731                 = 5 - W-VARIABLE-SIZE (W-VG-NDX)
 15732             SET W-WC-NDX UP BY W-ADJUST-SHORT
 15733             GO TO 7430-EXIT.
 15734
 15735     IF  W-SQUEEZE-FIELD
 15736         SET W-TX-NDX UP BY +1.
 15737
 15738     MOVE SPACES                 TO W-FIRST-CHAR-FOUND-IND.
 15739
 15740     PERFORM 7470-MOVE-CHAR THRU 7470-EXIT
 15741             VARYING
 15742         W-VC-NDX FROM +1 BY +1
 15743             UNTIL
 15744         W-VC-NDX GREATER THAN
 15745             W-VARIABLE-SIZE (W-VG-NDX).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 326
* EL689.cbl
 15746
 15747     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15748
 15749     IF  W-FORM-SQUEEZE-ON
 15750         GO TO 7430-EXIT.
 15751
 15752     IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +6
 15753         SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15754         SET W-TX-NDX DOWN BY +6
 15755         IF  W-TX-NDX GREATER THAN +70
 15756             SET W-TX-NDX        TO +70.
 15757
 15758     IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 15759         SET W-WC-NDX DOWN BY +1.
 15760
 15761 7430-EXIT.
 15762     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 327
* EL689.cbl
 15764 7435-MOVE-VARIABLE-DIRECT.
 15765
 15766     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 15767             AND
 15768         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 15769             AND
 15770         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 15771             AND
 15772         (W-VC-NDX GREATER THAN +1
 15773                 AND
 15774             W-LAST-CHAR NOT EQUAL SPACE
 15775                 AND
 15776             NOT W-LAST-CHAR-PUNC)
 15777         IF  W-LC-USE-BOTH-CASES
 15778             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15779                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 15780         ELSE
 15781             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15782                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 15783
 15784     SET W-WC-NDX UP BY +1.
 15785     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15786                                 TO W-WORK-CHAR (W-WC-NDX)
 15787                                    W-LAST-CHAR.
 15788
 15789 7435-EXIT.
 15790     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 328
* EL689.cbl
 15792 7437-FIND-NEXT-CHARACTER.
 15793*DELIBERATELY LEFT BLANK.
 15794 7437-EXIT.
 15795     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 329
* EL689.cbl
 15797 7440-BACK-TO-NEAREST-WORD.
 15798
 15799     MOVE SPACES                 TO W-WORK-CHAR (W-WC-NDX).
 15800
 15801 7440-EXIT.
 15802     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 330
* EL689.cbl
 15804 7450-SQUEEZING.
 15805
 15806     IF  W-NEW-PARAGRAPH
 15807         PERFORM 7600-SET-PARA-INDENT THRU 7600-EXIT
 15808         MOVE SPACES             TO W-LINE-SQUEEZE-IND
 15809         IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15810             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15811             MOVE W-TX-PC (W-TG-NDX)
 15812                                 TO W-PRINT-CONTROL
 15813             MOVE SPACES         TO W-SQUEEZED-LINE
 15814             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15815             SET W-SQ-NDX UP BY W-WORK-INDENT
 15816         ELSE
 15817             MOVE W-TX-PC (W-TG-NDX)
 15818                                 TO W-PRINT-CONTROL
 15819             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15820             SET W-SQ-NDX UP BY W-WORK-INDENT
 15821     ELSE
 15822         IF  W-DO-NOT-ADJUST
 15823             MOVE SPACES         TO W-LINE-SQUEEZE-IND
 15824             IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15825                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15826                 MOVE W-WORK-LINE
 15827                                 TO W-SQUEEZED-LINE
 15828                 MOVE W-TX-PC (W-TG-NDX)
 15829                                 TO W-PRINT-CONTROL
 15830                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15831                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15832                 MOVE SPACES     TO W-SQUEEZED-LINE
 15833                 GO TO 7450-EXIT
 15834             ELSE
 15835                 MOVE W-WORK-LINE
 15836                                 TO W-SQUEEZED-LINE
 15837                 MOVE W-TX-PC (W-TG-NDX)
 15838                                 TO W-PRINT-CONTROL
 15839                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15840                 MOVE SPACES     TO W-SQUEEZED-LINE
 15841                                    W-WORK-LINE
 15842                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15843                 GO TO 7450-EXIT
 15844         ELSE
 15845             IF  W-ADJUST-TO-LINE-LENGTH
 15846                 MOVE SPACES     TO W-LINE-SQUEEZE-IND
 15847
 15848                 IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15849                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15850                     SET W-SQ-NDX
 15851                                 TO W-INITIAL-COLUMN
 15852                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15853                             VARYING
 15854                         W-WC-NDX FROM 1 BY 1
 15855                             UNTIL
 15856                         W-SQ-NDX EQUAL W-TOO-FAR
 15857                     MOVE W-TX-PC (W-TG-NDX)
 15858                                 TO W-PRINT-CONTROL
 15859                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15860                     SET W-SQ-NDX
 15861                                 TO W-INITIAL-COLUMN
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 331
* EL689.cbl
 15862                     MOVE SPACES TO W-SQUEEZED-LINE
 15863                                    W-WORK-LINE
 15864                     GO TO 7450-EXIT
 15865                 ELSE
 15866                     SET W-SQ-NDX
 15867                                 TO W-INITIAL-COLUMN
 15868                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15869                             VARYING
 15870                         W-WC-NDX FROM 1 BY 1
 15871                             UNTIL
 15872                         W-SQ-NDX EQUAL W-TOO-FAR
 15873                     MOVE W-TX-PC (W-TG-NDX)
 15874                                 TO W-PRINT-CONTROL
 15875                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15876                     MOVE SPACES TO W-SQUEEZED-LINE
 15877                                    W-WORK-LINE
 15878                     SET W-SQ-NDX
 15879                                 TO W-INITIAL-COLUMN
 15880                     GO TO 7450-EXIT
 15881             ELSE
 15882                 IF  W-CONTINUE-PARAGRAPH
 15883                     IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15884                         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15885                         PERFORM 7610-SET-CONP-INDENT
 15886                             THRU 7610-EXIT
 15887                         MOVE SPACES
 15888                                 TO W-LINE-SQUEEZE-IND
 15889                         MOVE W-TX-PC (W-TG-NDX)
 15890                                 TO W-PRINT-CONTROL
 15891                         MOVE SPACES
 15892                                 TO W-SQUEEZED-LINE
 15893                         SET W-SQ-NDX
 15894                                 TO W-INITIAL-COLUMN
 15895                         SET W-SQ-NDX UP BY W-WORK-INDENT
 15896                     ELSE
 15897                         PERFORM 7610-SET-CONP-INDENT
 15898                             THRU 7610-EXIT
 15899                         MOVE SPACES
 15900                                 TO W-LINE-SQUEEZE-IND
 15901                         MOVE W-TX-PC (W-TG-NDX)
 15902                                 TO W-PRINT-CONTROL
 15903                         MOVE SPACES
 15904                                 TO W-SQUEEZED-LINE
 15905                         SET W-SQ-NDX
 15906                                 TO W-INITIAL-COLUMN
 15907                         SET W-SQ-NDX UP BY W-WORK-INDENT.
 15908
 15909
 15910     PERFORM 7480-UPDATE-SQUEEZED-LINE THRU 7480-EXIT
 15911             VARYING
 15912         W-WC-NDX FROM +1 BY +1
 15913             UNTIL
 15914         W-WC-NDX GREATER THAN +70.
 15915
 15916 7450-EXIT.
 15917     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 332
* EL689.cbl
 15919 7460-REMAIN-CHAR-CHECK.
 15920
 15921     IF  W-TX-NDX EQUAL W-WC-NDX
 15922         MOVE W-TX-PC (W-TG-NDX)
 15923                                 TO W-PRINT-CONTROL
 15924         MOVE W-WORK-LINE        TO W-SQUEEZED-LINE
 15925         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15926         MOVE SPACES             TO W-WORK-LINE
 15927         SET W-WC-NDX            TO +1
 15928     ELSE
 15929         SET W-TX-NDX1           TO W-TX-NDX
 15930         SEARCH W-TX-CHAR
 15931             VARYING W-TX-NDX1
 15932             AT END
 15933                 MOVE W-TX-PC (W-TG-NDX)
 15934                                 TO W-PRINT-CONTROL
 15935                 MOVE W-WORK-LINE
 15936                                 TO W-SQUEEZED-LINE
 15937                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15938                 MOVE SPACES     TO W-WORK-LINE
 15939                 SET W-WC-NDX    TO +1
 15940                 SET W-TX-NDX    TO +1
 15941                 SET W-TG-NDX UP BY +1
 15942             WHEN
 15943                 W-TX-CHAR (W-TG-NDX W-TX-NDX1) NOT EQUAL SPACES
 15944                 MOVE ER-9427    TO EMI-ERROR
 15945                 MOVE -1         TO MAINTL
 15946                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15947                 MOVE W-TX-PC (W-TG-NDX)
 15948                                 TO W-PRINT-CONTROL
 15949                 MOVE W-WORK-LINE
 15950                                 TO W-SQUEEZED-LINE
 15951                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15952                 MOVE SPACES     TO W-WORK-LINE
 15953                 SET W-WC-NDX    TO +1.
 15954
 15955 7460-EXIT.
 15956     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 333
* EL689.cbl
 15958 7470-MOVE-CHAR.
 15959
 15960     IF  W-FIRST-CHAR-NOT-FOUND
 15961             AND
 15962         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 15963         MOVE SPACES             TO W-LAST-CHAR
 15964         GO TO 7470-EXIT.
 15965
 15966     MOVE 'Y'                    TO W-FIRST-CHAR-FOUND-IND.
 15967
 15968     IF  W-SQUEEZE-FIELD
 15969             AND
 15970         W-LAST-CHAR EQUAL SPACES
 15971             AND
 15972         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 15973         GO TO 7470-EXIT.
 15974
 15975     SET W-WC-NDX UP BY +1.
 15976
 15977     IF  W-WC-NDX GREATER THAN +70
 15978         IF  W-FORM-SQUEEZE-ON
 15979             GO TO 7470-EXIT
 15980         ELSE
 15981             MOVE ER-9427        TO EMI-ERROR
 15982             MOVE -1             TO MAINTL
 15983             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15984             GO TO 7470-EXIT.
 15985
 15986     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 15987             AND
 15988         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 15989             AND
 15990         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 15991             AND
 15992         (W-VC-NDX GREATER THAN +1
 15993                 AND
 15994             W-LAST-CHAR NOT EQUAL SPACE
 15995                 AND
 15996             NOT W-LAST-CHAR-PUNC)
 15997         IF  W-LC-USE-BOTH-CASES
 15998             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15999                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 16000         ELSE
 16001             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 16002                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 16003
 16004     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 16005                                 TO W-WORK-CHAR (W-WC-NDX)
 16006                                    W-LAST-CHAR.
 16007
 16008     IF  W-LAST-CHAR EQUAL SPACES
 16009         SET W-LAST-WC-SPACE     TO W-WC-NDX.
 16010
 16011 7470-EXIT.
 16012     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 334
* EL689.cbl
 16014 7480-UPDATE-SQUEEZED-LINE.
 16015****************************************************************
 16016*    THIS SECTION CONTROLS THE MOVEMENT FROM THE WORK LINE TO *
 16017*    THE SQUEEZED LINE.  DURING THIS PROCESS ALL EXTRA SPACES  *
 16018*    (DEFINED AS TWO OR MORE SPACES NOT FOLLOWING A END OF     *
 16019*    SENTENCE INDICATOR) ARE REMOVED.  IF THE LAST CHARACTER   *
 16020*    IS NOT A SPACE OR PUNCTUATION MARK AN UNFINISHED WORD IS  *
 16021*    ASSUMED.  EVERYTHING TO THE PREVIOUS SPACE IS REMOVED     *
 16022****************************************************************
 16023
 16024     SET W-SQ-NDX UP BY +1.
 16025
 16026     IF  W-SQ-NDX GREATER THAN W-LAST-COLUMN
 16027         MOVE W-SQ-CHAR (W-LAST-COLUMN)
 16028                                 TO W-CHARACTER-TYPE
 16029         IF  W-PUNCTUATION
 16030                 OR
 16031             W-SPACE
 16032             PERFORM 7485-FIND-NEXT-CHARACTER THRU 7485-EXIT
 16033             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 16034             MOVE SPACES         TO W-SQUEEZED-LINE
 16035             SET W-SQ-NDX        TO W-START-COLUMN
 16036             SET W-SQ-NDX UP BY W-NEXT-INDENT
 16037             SET W-LAST-SQUEEZED-SPACE
 16038                                 TO W-SQ-NDX
 16039         ELSE
 16040             PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 16041             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 16042             MOVE SPACES         TO W-SQUEEZED-LINE
 16043             SET W-SQ-NDX        TO W-START-COLUMN
 16044             SET W-SQ-NDX UP BY W-NEXT-INDENT
 16045             SET W-LAST-SQUEEZED-SPACE
 16046                                 TO W-SQ-NDX.
 16047
 16048     IF  W-WC-NDX GREATER THAN +70
 16049         GO TO 7480-EXIT.
 16050
 16051     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 16052
 16053     IF  W-END-OF-SENTENCE
 16054         MOVE 'Y'                TO W-END-OF-SENTENCE-IND
 16055         SET W-WORK-NDX          TO W-SQ-NDX
 16056         COMPUTE W-DISPLAY-NDX = W-WORK-NDX - 1
 16057         IF  W-DISPLAY-NDX EQUAL W-LAST-SQUEEZED-SPACE
 16058             SET W-SQ-NDX        TO W-LAST-SQUEEZED-SPACE
 16059         ELSE
 16060             NEXT SENTENCE
 16061     ELSE
 16062         IF  W-PUNCTUATION
 16063                 AND
 16064             W-LAST-SQ-CHAR EQUAL SPACES
 16065             SET W-SQ-NDX DOWN BY +1
 16066             MOVE SPACES         TO W-END-OF-SENTENCE-IND
 16067         ELSE
 16068             IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 16069                 IF  W-LAST-SQ-CHAR EQUAL SPACES
 16070                     IF  W-END-OF-SENTENCE-WORKING
 16071                         MOVE SPACES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 335
* EL689.cbl
 16072                                 TO W-END-OF-SENTENCE-IND
 16073                         SET W-LAST-SQUEEZED-SPACE
 16074                                 TO W-SQ-NDX
 16075                     ELSE
 16076                         SET W-SQ-NDX DOWN BY +1
 16077                         GO TO 7480-EXIT
 16078                 ELSE
 16079                     SET W-LAST-SQUEEZED-SPACE
 16080                                 TO W-SQ-NDX
 16081             ELSE
 16082                 MOVE SPACES     TO W-END-OF-SENTENCE-IND.
 16083
 16084     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX)
 16085                                    W-LAST-SQ-CHAR.
 16086
 16087     IF  W-WC-NDX EQUAL +70
 16088             AND
 16089         W-WORK-CHAR (W-WC-NDX) GREATER THAN SPACES
 16090             AND
 16091         W-SQ-NDX NOT EQUAL W-LAST-COLUMN
 16092         SET W-SQ-NDX UP BY +1
 16093         SET W-LAST-SQUEEZED-SPACE
 16094                                 TO W-SQ-NDX
 16095         MOVE SPACES             TO W-SQ-CHAR (W-SQ-NDX)
 16096                                    W-LAST-SQ-CHAR.
 16097
 16098 7480-EXIT.
 16099     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 336
* EL689.cbl
 16101 7485-FIND-NEXT-CHARACTER.
 16102
 16103     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 16104
 16105     IF  W-PUNCTUATION
 16106         PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 16107     ELSE
 16108         SET W-WC-NDX            TO W-WC-NDX
 16109         SEARCH W-WORK-CHAR
 16110             VARYING W-WC-NDX
 16111             AT END
 16112                 GO TO 7485-EXIT
 16113             WHEN
 16114                 W-WORK-CHAR (W-WC-NDX) NOT EQUAL SPACES
 16115                 GO TO 7485-EXIT.
 16116
 16117 7485-EXIT.
 16118     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 337
* EL689.cbl
 16120 7490-REMOVE-LAST-WORD.
 16121
 16122*********  NOTE: W-WORK-LINE ALWAYS STARTS WITH A FULL WORD*******
 16123     IF  W-WC-NDX EQUAL +1
 16124         GO TO 7490-EXIT.
 16125
 16126     ADD +1                      TO W-LAST-SQUEEZED-SPACE.
 16127
 16128     PERFORM 7500-CLEAR-SQUEEZED-EXCESS THRU 7500-EXIT
 16129             VARYING
 16130         W-SQ-NDX FROM W-LAST-SQUEEZED-SPACE BY +1
 16131             UNTIL
 16132         W-SQ-NDX EQUAL W-TOO-FAR.
 16133
 16134     SET W-WORK-NDX              TO W-WC-NDX.
 16135     COMPUTE W-LAST-WC-SPACE
 16136         = W-WORK-NDX - W-TOO-FAR + W-LAST-SQUEEZED-SPACE.
 16137     SET W-WC-NDX                TO W-LAST-WC-SPACE.
 16138
 16139 7490-EXIT.
 16140     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 338
* EL689.cbl
 16142 7500-CLEAR-SQUEEZED-EXCESS.
 16143
 16144     MOVE SPACES                 TO W-SQ-CHAR (W-SQ-NDX).
 16145
 16146 7500-EXIT.
 16147     EXIT.
 16148
 16149 7505-MOVE-STRAIGHT.
 16150
 16151     SET W-SQ-NDX UP BY +1.
 16152
 16153     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX).
 16154
 16155 7505-EXIT.
 16156     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 339
* EL689.cbl
 16158 7510-MOVE-TO-TABLE.
 16159
 16160     IF  W-PRINT-CONTROL NOT NUMERIC
 16161         MOVE 00                 TO W-PRINT-CONTROL
 16162         ADD +1                  TO W-LINE-COUNT
 16163     ELSE
 16164         IF  W-PRINT-CONTROL EQUAL 99
 16165             PERFORM 7640-PAGING THRU 7640-EXIT
 16166             MOVE 00             TO W-PRINT-CONTROL
 16167             SET W-RG-NDX UP BY +1
 16168             MOVE W-TOP-FORM     TO W-RC-TEXT (W-RG-NDX)
 16169             MOVE +1             TO W-LINE-COUNT
 16170             SET W-RG-NDX UP BY W-TOP-MARGIN
 16171         ELSE
 16172           IF W-SQUEEZED-LINE (1:6) NOT EQUAL '&&&&&&'
 16173             COMPUTE W-LINE-COUNT
 16174                 = W-LINE-COUNT + W-PRINT-CONTROL + 1.
 16175
 16176     IF  W-LINE-COUNT GREATER THAN W-MAX-LINES-PER-PAGE
 16177         PERFORM 7640-PAGING THRU 7640-EXIT
 16178         MOVE 00                 TO W-PRINT-CONTROL
 16179         SET W-RG-NDX UP BY +1
 16180         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 16181         SET W-RG-NDX UP BY W-TOP-MARGIN
 16182         MOVE +1                 TO W-LINE-COUNT.
 16183
 16184     SET W-RG-NDX UP BY W-PRINT-CONTROL.
 16185     SET W-RG-NDX UP BY +1.
 16186     MOVE W-SQUEEZED-LINE        TO W-RC-TEXT (W-RG-NDX).
 16187     MOVE 00                     TO W-PRINT-CONTROL.
 16188
 16189     IF  W-FIRST-BAD-VARIABLE-FOUND
 16190             AND
 16191         W-FIRST-BAD-VARIABLE EQUAL ZEROS
 16192         SET W-FIRST-BAD-VARIABLE
 16193                                 TO W-RG-NDX.
 16194
 16195 7510-EXIT.
 16196     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 340
* EL689.cbl
 16198 7600-SET-PARA-INDENT.
 16199
 16200     IF  W-LINE-SQUEEZE-IND EQUAL 'P'
 16201         MOVE W-PARAGRAPH-INDENT TO W-WORK-INDENT
 16202     ELSE
 16203     IF  W-LINE-SQUEEZE-IND EQUAL 'Q'
 16204         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 16205         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16206     ELSE
 16207     IF  W-LINE-SQUEEZE-IND EQUAL 'R'
 16208         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 16209         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16210     ELSE
 16211     IF  W-LINE-SQUEEZE-IND EQUAL 'S'
 16212         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 16213         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16214     ELSE
 16215     IF  W-LINE-SQUEEZE-IND EQUAL 'T'
 16216         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 16217         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16218     ELSE
 16219     IF  W-LINE-SQUEEZE-IND EQUAL 'U'
 16220         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT
 16221         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT.
 16222
 16223     SET W-TG-NDX2               TO W-TG-NDX.
 16224     SET W-TG-NDX2 UP BY +1.
 16225
 16226     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 16227         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16228     ELSE
 16229         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 16230
 16231 7600-EXIT.
 16232     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 341
* EL689.cbl
 16234 7610-SET-CONP-INDENT.
 16235
 16236     IF  W-LINE-SQUEEZE-IND EQUAL 'C'
 16237         MOVE +0                 TO W-WORK-INDENT
 16238     ELSE
 16239     IF  W-LINE-SQUEEZE-IND EQUAL 'D'
 16240         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 16241     ELSE
 16242     IF  W-LINE-SQUEEZE-IND EQUAL 'E'
 16243         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 16244     ELSE
 16245     IF  W-LINE-SQUEEZE-IND EQUAL 'F'
 16246         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 16247     ELSE
 16248     IF  W-LINE-SQUEEZE-IND EQUAL 'G'
 16249         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 16250     ELSE
 16251     IF  W-LINE-SQUEEZE-IND EQUAL 'H'
 16252         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT.
 16253
 16254     SET W-TG-NDX2               TO W-TG-NDX.
 16255     SET W-TG-NDX2 UP BY +1.
 16256
 16257     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 16258         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16259     ELSE
 16260         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 16261
 16262 7610-EXIT.
 16263     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 342
* EL689.cbl
 16265 7630-NEXT-LINE.
 16266
 16267     IF  W-TX-SC (W-TG-NDX2) EQUAL ' '
 16268         MOVE ZEROS              TO W-NEXT-INDENT
 16269     ELSE
 16270     IF  W-TX-SC (W-TG-NDX2) EQUAL '1'
 16271         MOVE W-LINE-INDENT-1    TO W-NEXT-INDENT
 16272     ELSE
 16273     IF  W-TX-SC (W-TG-NDX2) EQUAL '2'
 16274         MOVE W-LINE-INDENT-2    TO W-NEXT-INDENT
 16275     ELSE
 16276     IF  W-TX-SC (W-TG-NDX2) EQUAL '3'
 16277         MOVE W-LINE-INDENT-3    TO W-NEXT-INDENT
 16278     ELSE
 16279     IF  W-TX-SC (W-TG-NDX2) EQUAL '4'
 16280         MOVE W-LINE-INDENT-4    TO W-NEXT-INDENT
 16281     ELSE
 16282     IF  W-TX-SC (W-TG-NDX2) EQUAL '5'
 16283         MOVE W-LINE-INDENT-5    TO W-NEXT-INDENT
 16284     ELSE
 16285         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16286         SUBTRACT W-PARAGRAPH-INDENT
 16287                                  FROM W-NEXT-INDENT.
 16288
 16289 7630-EXIT.
 16290     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 343
* EL689.cbl
 16292 7640-PAGING.
 16293
 16294     IF  NOT W-LC-CREATE-PAGES
 16295         GO TO 7640-EXIT.
 16296
 16297     IF  W-LINE-COUNT GREATER ZEROS
 16298             AND
 16299         W-RG-NDX GREATER THAN +1
 16300         ADD +1                  TO W-PAGE
 16301         MOVE W-PAGE             TO W-PAGE-NUMBER
 16302         COMPUTE W-PAGE-LINE
 16303             = W-MAX-LINES-PER-PAGE - W-LINE-COUNT + 3
 16304         IF  W-PAGE-LINE GREATER THAN +2
 16305             SET W-RG-NDX UP BY W-PAGE-LINE
 16306             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX)
 16307         ELSE
 16308             SET W-RG-NDX UP BY +2
 16309             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX).
 16310
 16311 7640-EXIT.
 16312     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 344
* EL689.cbl
 16314 7700-READ-TEXT-TS.
 16315**************************************************************
 16316*  THIS PARAGRAPH READS THE TEMPORARY STORAGE RECORDS THAT   *
 16317*  CONTAIN THE TEXT THAT IS PAST BETWEEN EL689, EL6892       *
 16318*  AND EL1042.                                               *
 16319**************************************************************
 16320
 16321
 16322* EXEC CICS HANDLE CONDITION
 16323*         QIDERR     (7700-TS-ERROR)
 16324*         ITEMERR    (7700-TS-ERROR)
 16325*    END-EXEC.
 16326*    MOVE '"$N<                  ! 9 #00015215' TO DFHEIV0
 16327     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 16328     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16329     MOVE X'3920233030303135323135' TO DFHEIV0(25:11)
 16330     CALL 'kxdfhei1' USING DFHEIV0
 16331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16332
 16333
 16334     SET W-TS-NDX                TO 1.
 16335     MOVE 1                      TO W-TS-ITEM.
 16336
 16337 7700-LOOP.
 16338
 16339     IF  W-TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS
 16340         IF  PI-TEMP-STOR-ITEMS GREATER THAN ZEROS
 16341             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 16342             GO TO 7700-EXIT
 16343         ELSE
 16344             GO TO 7700-EXIT.
 16345
 16346
 16347* EXEC CICS READQ TS
 16348*         INTO     (W-TS-WORK-AREA)
 16349*         QUEUE    (W-TS-NAME-TEXT)
 16350*         LENGTH   (W-TS-LENGTH)
 16351*         ITEM     (W-TS-ITEM)
 16352*    END-EXEC.
 16353*    MOVE '*$II   L              ''   #00015232' TO DFHEIV0
 16354     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 16355     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16356     MOVE X'2020233030303135323332' TO DFHEIV0(25:11)
 16357     CALL 'kxdfhei1' USING DFHEIV0,
 16358           W-TS-NAME-TEXT,
 16359           W-TS-WORK-AREA,
 16360           W-TS-LENGTH,
 16361           W-TS-ITEM,
 16362           DFHEIV99,
 16363           DFHEIV99
 16364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16365
 16366
 16367     MOVE W-TS-WORK-AREA         TO W-TS-GROUP (W-TS-NDX).
 16368     SET W-TS-NDX UP BY 1.
 16369     ADD 1                       TO W-TS-ITEM.
 16370     GO TO 7700-LOOP.
 16371
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 345
* EL689.cbl
 16372 7700-TS-ERROR.
 16373
 16374     IF  EIBTRNID = W-TRANSACTION OR 'EX14'
 16375         MOVE ER-0033            TO EMI-ERROR
 16376         MOVE -1                 TO MAINTL
 16377         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16378         GO TO 8200-SEND-DATAONLY.
 16379
 16380 7700-EXIT.
 16381      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 346
* EL689.cbl
 16383 7740-RESTORE-SCREEN.
 16384
 16385     MOVE 'C'                    TO MAINTI.
 16386     MOVE +1                     TO MAINTL.
 16387     MOVE AL-UANON               TO MAINTA.
 16388
 16389     MOVE PI-689-FORM-NUMBER     TO FORMI.
 16390     MOVE +4                     TO FORML.
 16391     MOVE AL-UANON               TO FORMA.
 16392
 16393*    IF  PI-689-PRINT-RESTRICTION GREATER THAN SPACES
 16394*        MOVE PI-689-PRINT-RESTRICTION
 16395*                                TO PRTRESTL
 16396*        MOVE +1                 TO PRTRESTL
 16397*        MOVE AL-UANON           TO PRTRESTA.
 16398
 16399     IF  PI-689-FOLLOW-UP-EDIT GREATER THAN SPACES
 16400         MOVE PI-689-FOLLOW-UP-EDIT
 16401                                 TO FOLLOWI
 16402         MOVE +8                 TO FOLLOWL
 16403         MOVE AL-UANON           TO FOLLOWA.
 16404
 16405     IF  PI-689-RESEND1-EDIT GREATER THAN SPACES
 16406         MOVE PI-689-RESEND1-EDIT
 16407                                 TO RESEND1I
 16408         MOVE +8                 TO RESEND1L
 16409         MOVE AL-UANON           TO RESEND1A.
 16410     IF  PI-689-ALT-PRINTER-ID GREATER THAN SPACES
 16411         MOVE PI-689-ALT-PRINTER-ID
 16412                                 TO PRINTERI
 16413         MOVE +1                 TO PRINTERL
 16414         MOVE AL-UANON           TO PRINTERA.
 16415
 16416     IF  PI-BYPASS-LABELS
 16417          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 16418          MOVE +1                TO ADDRLBLL
 16419          MOVE AL-UANON          TO ADDRLBLA
 16420     ELSE
 16421          IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 16422               MOVE PI-689-LBL-OVERRIDE
 16423                                 TO ADDRLBLI
 16424               MOVE +1           TO ADDRLBLL
 16425               MOVE AL-UANON     TO ADDRLBLA.
 16426
 16427     IF  PI-689-NUMBER-COPIES GREATER THAN ZEROS
 16428         MOVE PI-689-NUMBER-COPIES   TO COPIESI
 16429         MOVE +1                     TO COPIESL
 16430         MOVE AL-UNNON               TO COPIESA.
 16431
 16432     IF  PI-689-LABEL-SOURCE GREATER THAN SPACES
 16433         MOVE PI-689-LABEL-SOURCE
 16434                                 TO ADDRSI
 16435         MOVE +1                 TO ADDRSL
 16436         MOVE AL-UANON           TO ADDRSA.
 16437
 16438     MOVE PI-689-DATA-SOURCE     TO DATASORI.
 16439     MOVE +1                     TO DATASORL.
 16440     MOVE AL-UANON               TO DATASORA.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 347
* EL689.cbl
 16441
 16442     IF  PI-689-CARRIER GREATER THAN SPACES
 16443         MOVE PI-689-CARRIER     TO CARRIERI
 16444         MOVE +1                 TO CARRIERL
 16445         MOVE AL-UANON           TO CARRIERA.
 16446
 16447     IF  PI-689-GROUPING GREATER THAN SPACES
 16448         MOVE PI-689-GROUPING    TO GROUPI
 16449         MOVE +6                 TO GROUPL
 16450         MOVE AL-UANON           TO GROUPA.
 16451
 16452     IF  PI-689-STATE GREATER THAN SPACES
 16453         MOVE PI-689-STATE       TO STATEI
 16454         MOVE +2                 TO STATEL
 16455         MOVE AL-UANON           TO STATEA.
 16456
 16457     IF  PI-689-ACCOUNT GREATER THAN SPACES
 16458         MOVE PI-689-ACCOUNT     TO ACCTI
 16459         MOVE +10                TO ACCTL
 16460         MOVE AL-UANON           TO ACCTA.
 16461
 16462     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 16463         MOVE PI-689-CERT-PRIME  TO CERTI
 16464         MOVE +10                TO CERTL
 16465         MOVE AL-UANON           TO CERTA.
 16466
 16467     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 16468         MOVE PI-689-CERT-SFX    TO SFXI
 16469         MOVE +1                 TO SFXL
 16470         MOVE AL-UANON           TO SFXA.
 16471
 16472     IF  PI-689-TYPE GREATER THAN SPACES
 16473         MOVE PI-689-TYPE        TO TYPEI
 16474         MOVE +1                 TO TYPEL
 16475         MOVE AL-UANON           TO TYPEA.
 16476
 16477     IF  PI-689-RESP-PERSON GREATER THAN SPACES
 16478         MOVE PI-689-RESP-PERSON TO RPERSONI
 16479         MOVE +10                TO RPERSONL
 16480         MOVE AL-UANON           TO RPERSONA.
 16481
 16482     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 16483         MOVE PI-689-ENTRY-BATCH TO BENTRYI
 16484         MOVE +6                 TO BENTRYL
 16485         MOVE AL-UANON           TO BENTRYA.
 16486
 16487     IF  PI-689-SEQ-EDIT GREATER THAN SPACES
 16488         MOVE PI-689-SEQ-EDIT    TO SEQI
 16489         MOVE +8                 TO SEQL
 16490         MOVE AL-UNNON           TO SEQA.
 16491
 16492     IF  PI-689-BCSEQ-EDIT GREATER THAN SPACES
 16493         MOVE PI-689-BCSEQ-EDIT  TO BCSEQI
 16494         MOVE +4                 TO BCSEQL
 16495         MOVE AL-UNNON           TO BCSEQA.
 16496
 16497     IF  PI-689-DATE-EDIT GREATER THAN SPACES
 16498         MOVE PI-689-DATE-EDIT   TO DATEI
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 348
* EL689.cbl
 16499         MOVE +8                 TO DATEL
 16500         MOVE AL-UNNON           TO DATEA.
 16501
 16502     IF PI-CERT-FORM-ID GREATER THAN SPACES
 16503        MOVE PI-CERT-FORM-ID     TO CERTIDI
 16504        MOVE +5                  TO CERTIDL
 16505        MOVE AL-UNNON            TO CERTIDA
 16506     END-IF.
 16507
 16508     IF PI-PRINT-NOW GREATER THAN SPACES
 16509        MOVE PI-PRINT-NOW        TO PRTNOWI
 16510        MOVE +1                  TO PRTNOWL
 16511        MOVE AL-UNNON            TO PRTNOWA
 16512     END-IF.
 16513     IF PI-ENDT-ARCH-NO GREATER THAN ZERO
 16514        MOVE PI-ENDT-ARCH-NO     TO ENDARCHI
 16515        MOVE +8                  TO ENDARCHL
 16516        MOVE AL-UNNON            TO ENDARCHA
 16517     END-IF
 16518
 16519     MOVE PI-ENCLOSURE-CD        TO ENCI.
 16520     MOVE +3                     TO ENCL.
 16521     MOVE AL-UANON               TO ENCA.
 16522
 16523 7749-EXIT.
 16524     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 349
* EL689.cbl
 16526 7760-PUT-TEMP-STORAGE.
 16527**************************************************************
 16528*  THIS PARAGRAPH WRITES THE TEMPORARY STORAGE RECORDS THAT  *
 16529*  WILL CONTAIN THE CONTENTS OF THE TEXT TABLE FOR USE BY    *
 16530*  EL1042 AND EL6892.                                        *
 16531**************************************************************
 16532
 16533     SET W-TS-NDX                TO 1.
 16534     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16535
 16536     MOVE -1                     TO MAINTL.
 16537     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16538             VARYING
 16539         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16540             UNTIL
 16541         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16542
 16543 7760-EXIT.
 16544      EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 350
* EL689.cbl
 16546 7780-DELETE-TEMP-STOR-TEXT.
 16547
 16548
 16549* EXEC CICS HANDLE CONDITION
 16550*         QIDERR      (7780-EXIT)
 16551*    END-EXEC.
 16552*    MOVE '"$N                   ! : #00015420' TO DFHEIV0
 16553     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 16554     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16555     MOVE X'3A20233030303135343230' TO DFHEIV0(25:11)
 16556     CALL 'kxdfhei1' USING DFHEIV0
 16557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16558
 16559
 16560
 16561* EXEC CICS DELETEQ TS
 16562*         QUEUE       (W-TS-NAME-TEXT)
 16563*    END-EXEC.
 16564*    MOVE '*&                    #   #00015424' TO DFHEIV0
 16565     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 16566     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16567     MOVE X'2020233030303135343234' TO DFHEIV0(25:11)
 16568     CALL 'kxdfhei1' USING DFHEIV0,
 16569           W-TS-NAME-TEXT,
 16570           DFHEIV99
 16571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16572
 16573
 16574 7780-EXIT.
 16575     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 351
* EL689.cbl
 16577 7840-WRITE-TS.
 16578
 16579     MOVE W-TS-GROUP (W-TS-NDX)  TO W-TS-WORK-AREA.
 16580     SET W-TS-NDX UP BY 1.
 16581     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 16582
 16583
 16584* EXEC CICS WRITEQ TS
 16585*         FROM    (W-TS-WORK-AREA)
 16586*         QUEUE   (W-TS-NAME-TEXT)
 16587*         LENGTH  (W-TS-LENGTH)
 16588*         ITEM    (PI-TEMP-STOR-ITEMS)
 16589*    END-EXEC.
 16590*    MOVE '*" I   L              ''   #00015437' TO DFHEIV0
 16591     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 16592     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16593     MOVE X'2020233030303135343337' TO DFHEIV0(25:11)
 16594     CALL 'kxdfhei1' USING DFHEIV0,
 16595           W-TS-NAME-TEXT,
 16596           W-TS-WORK-AREA,
 16597           W-TS-LENGTH,
 16598           PI-TEMP-STOR-ITEMS,
 16599           DFHEIV99,
 16600           DFHEIV99
 16601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16602
 16603
 16604 7840-EXIT.
 16605     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 352
* EL689.cbl
 16607 7900-PRINT-LETTER-NOW.
 16608***************************************************************
 16609*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 16610*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 16611*     THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS.          *
 16612*     THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE.       *
 16613*     THE LETTER IS SAVED IN TEMP-STORAGE AND A START IS      *
 16614*     ISSUED FOR THE PRINT TRANSACTION.                       *
 16615***************************************************************
 16616
 16617*    IF (EIBAID = DFHPF4 OR DFHPF8)
 16618*            AND
 16619*        PI-SHOW-MODE
 16620*        IF  PRINTERL GREATER ZERO
 16621*            INSPECT PRINTERI CONVERTING W-LOWER-CASE TO
 16622*                                                    W-UPPER-CASE
 16623*            MOVE PRINTERI       TO PI-689-ALT-PRINTER-ID
 16624*                                   PI-ALT-DMD-PRT-ID.
 16625*
 16626*    IF  EIBAID EQUAL DFHPF8
 16627*            AND
 16628*        PI-SHOW-MODE
 16629*            AND
 16630*        LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
 16631*        MOVE ER-7247            TO EMI-ERROR
 16632*        MOVE -1                 TO MAINTL
 16633*        MOVE AL-UABON           TO MAINTA
 16634*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16635*        GO TO 8200-SEND-DATAONLY.
 16636
 16637     IF  PI-TOTAL-LINES EQUAL 0
 16638         MOVE ER-0187            TO EMI-ERROR
 16639         MOVE -1                 TO MAINTL
 16640         MOVE AL-UABON           TO MAINTA
 16641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16642         GO TO 8200-SEND-DATAONLY.
 16643
 16644     IF  EMI-ERROR NOT EQUAL ER-0191
 16645         IF  PI-689-CREATE-NO-SCREENS
 16646*                OR
 16647*            (EIBAID = DFHPF4 OR DFHPF8)
 16648             SET W-RG-NDX        TO +1
 16649         ELSE
 16650             PERFORM 4100-SET-NDX THRU 4100-EXIT
 16651             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16652                     VARYING
 16653                 W-SC-NDX FROM 1 BY 1
 16654                     UNTIL
 16655                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 16656
 16657     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 16658
 16659     IF EIBAID NOT = DFHPF4 AND DFHPF8
 16660         PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 16661                 VARYING
 16662             W-RVS-NDX FROM +1 BY +1
 16663                 UNTIL
 16664             W-RVS-NDX GREATER THAN +36500
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 353
* EL689.cbl
 16665                 OR
 16666             W-REMAINING-VAR-FOUND
 16667         IF  W-REMAINING-VAR-FOUND
 16668             GO TO 4000-ROLL-PAGE.
 16669
 16670*    IF EIBAID = DFHPF4 OR DFHPF8
 16671*       PERFORM 7700-READ-TEXT-TS
 16672*                                THRU 7700-EXIT
 16673*
 16674*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 16675*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16676*                VARYING
 16677*            W-SC-NDX FROM 1 BY 1
 16678*                UNTIL
 16679*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 16680*
 16681*       PERFORM 7760-PUT-TEMP-STORAGE
 16682*                                THRU 7760-EXIT
 16683*    END-IF
 16684     IF PI-689-ALT-PRINTER-ID NOT = SPACES AND LOW-VALUES
 16685         MOVE PI-689-ALT-PRINTER-ID
 16686                                 TO W-TS-TERM-TEXT
 16687     ELSE
 16688         IF PI-PROCESSOR-PRINTER NOT = SPACES AND LOW-VALUES
 16689             MOVE PI-PROCESSOR-PRINTER
 16690                                 TO W-TS-TERM-TEXT
 16691         ELSE
 16692             MOVE PI-COMPANY-ID  TO W-CNTL-COMPANY-ID
 16693             MOVE '1'            TO W-CNTL-RECORD-TYPE
 16694             MOVE SPACES         TO W-CNTL-GENL
 16695             MOVE ZEROS          TO W-CNTL-SEQ-NO
 16696
 16697* EXEC CICS HANDLE CONDITION
 16698*                 NOTOPEN    (8040-CNTL-NOT-OPEN)
 16699*                 NOTFND     (7945-NOT-FOUND)
 16700*            END-EXEC
 16701*    MOVE '"$JI                  ! ; #00015536' TO DFHEIV0
 16702     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 16703     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16704     MOVE X'3B20233030303135353336' TO DFHEIV0(25:11)
 16705     CALL 'kxdfhei1' USING DFHEIV0
 16706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16707
 16708* EXEC CICS READ
 16709*                 DATASET    (W-CNTL-FILE-ID)
 16710*                 SET        (ADDRESS OF CONTROL-FILE)
 16711*                 RIDFLD     (W-CNTL-KEY)
 16712*            END-EXEC
 16713*    MOVE '&"S        E          (   #00015540' TO DFHEIV0
 16714     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16715     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16716     MOVE X'2020233030303135353430' TO DFHEIV0(25:11)
 16717     CALL 'kxdfhei1' USING DFHEIV0,
 16718           W-CNTL-FILE-ID,
 16719           DFHEIV20,
 16720           DFHEIV99,
 16721           W-CNTL-KEY,
 16722           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 354
* EL689.cbl
 16723           DFHEIV99,
 16724           DFHEIV99
 16725     SET ADDRESS OF CONTROL-FILE TO
 16726         DFHEIV20
 16727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16728             MOVE CF-FORMS-PRINTER-ID
 16729                                 TO W-TS-TERM-TEXT.
 16730
 16731***********************************************************
 16732*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 16733*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 16734***********************************************************
 16735
 16736     SET W-TS-NDX                TO 1.
 16737     MOVE EIBTIME                TO W-TS-ID-TIME.
 16738     MOVE W-TS-NAME-TEXT         TO PI-689-TEMP-STOR-ID.
 16739     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16740
 16741     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16742             VARYING
 16743         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16744             UNTIL
 16745         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16746
 16747*    IF  EIBAID EQUAL DFHPF8
 16748*        MOVE '1'                TO PI-689-PRINT-SW
 16749*    ELSE
 16750         MOVE SPACES             TO PI-689-PRINT-SW.
 16751
 16752
 16753* EXEC CICS HANDLE CONDITION
 16754*         TERMIDERR  (7935-TERM-ERROR)
 16755*         TRANSIDERR (7940-TRAN-ERROR)
 16756*    END-EXEC.
 16757*    MOVE '"$[\                  ! < #00015569' TO DFHEIV0
 16758     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 16759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16760     MOVE X'3C20233030303135353639' TO DFHEIV0(25:11)
 16761     CALL 'kxdfhei1' USING DFHEIV0
 16762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16763
 16764
 16765
 16766* EXEC CICS START
 16767*             INTERVAL    (0)
 16768*             TRANSID     (W-PRINT-TRANS)
 16769*             FROM        (PROGRAM-INTERFACE-BLOCK)
 16770*             LENGTH      (PI-COMM-LENGTH)
 16771*             TERMID      (W-TS-TERM-TEXT)
 16772*    END-EXEC.
 16773     MOVE 0 TO DFHEIV10
 16774*    MOVE '0(ILFT                1   #00015574' TO DFHEIV0
 16775     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 16776     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
 16777     MOVE X'2020233030303135353734' TO DFHEIV0(25:11)
 16778     CALL 'kxdfhei1' USING DFHEIV0,
 16779           DFHEIV10,
 16780           W-PRINT-TRANS,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 355
* EL689.cbl
 16781           DFHEIV99,
 16782           PROGRAM-INTERFACE-BLOCK,
 16783           PI-COMM-LENGTH,
 16784           W-TS-TERM-TEXT,
 16785           DFHEIV99,
 16786           DFHEIV99,
 16787           DFHEIV99,
 16788           DFHEIV99,
 16789           DFHEIV99,
 16790           DFHEIV99,
 16791           DFHEIV99,
 16792           DFHEIV99,
 16793           DFHEIV99,
 16794           DFHEIV99
 16795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16796
 16797
 16798
 16799* EXEC CICS SYNCPOINT
 16800*    END-EXEC.
 16801*    MOVE '6"                    !   #00015582' TO DFHEIV0
 16802     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
 16803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16804     MOVE X'2020233030303135353832' TO DFHEIV0(25:11)
 16805     CALL 'kxdfhei1' USING DFHEIV0
 16806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16807
 16808
 16809     IF  PI-689-CREATE-NO-SCREENS
 16810         GO TO 7900-EXIT.
 16811
 16812*    IF  EIBAID EQUAL DFHPF8
 16813*            AND
 16814*        PI-SHOW-MODE
 16815*            AND
 16816*        LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
 16817*        PERFORM 7920-UPDATE-INITIAL-PRINT THRU 7920-EXIT.
 16818
 16819     MOVE ER-0189                TO EMI-ERROR.
 16820     MOVE -1                     TO MAINTL.
 16821
 16822     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16823     MOVE -1                     TO MAINTL
 16824     MOVE AL-UABON               TO MAINTA
 16825     MOVE '104A'                 TO W-TS-ID-TEXT
 16826     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 16827                                    W-TS-TERM-SCREEN
 16828     GO TO 8200-SEND-DATAONLY.
 16829
 16830 7900-EXIT.
 16831     EXIT.
 16832
 16833 7915-SEARCH-REMAINING-VARS.
 16834
 16835     IF  W-REC-CHAR (W-RVS-NDX) EQUAL '@'
 16836         SET W-RVS-NDX2          TO W-RVS-NDX
 16837         SET W-RVS-NDX2 UP BY +1
 16838         IF  W-REC-CHAR (W-RVS-NDX2) EQUAL '@'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 356
* EL689.cbl
 16839             SET W-RVS-NDX2 UP BY +1
 16840             IF  W-REC-CHAR (W-RVS-NDX2) NUMERIC
 16841                 SET PI-CURRENT-LINE  TO W-RVS-NDX
 16842                 COMPUTE PI-CURRENT-LINE
 16843                     = PI-CURRENT-LINE / 73
 16844                 MOVE 'Y'        TO W-REMAINING-VAR-SW
 16845                 MOVE +0         TO W-ROLL-COUNTER
 16846                 MOVE ER-0191    TO EMI-ERROR
 16847                 MOVE -1         TO MAINTL
 16848                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16849
 16850 7915-EXIT.
 16851     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 357
* EL689.cbl
 16853 7920-UPDATE-INITIAL-PRINT.
 16854
 16855
 16856* EXEC CICS HANDLE CONDITION
 16857*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 16858*         NOTFND     (1070-ARCH-NOT-FOUND)
 16859*         ENDFILE    (1070-ARCH-NOT-FOUND)
 16860*    END-EXEC.
 16861*    MOVE '"$JI''                 ! = #00015631' TO DFHEIV0
 16862     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 16863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16864     MOVE X'3D20233030303135363331' TO DFHEIV0(25:11)
 16865     CALL 'kxdfhei1' USING DFHEIV0
 16866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16867
 16868     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
 16869     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 16870
 16871* EXEC CICS READ
 16872*        DATASET (W-ARCH-FILE-ID)
 16873*        SET     (ADDRESS OF LETTER-ARCHIVE)
 16874*        RIDFLD  (W-ARCH-PARTIAL-KEY)
 16875*        UPDATE
 16876*    END-EXEC.
 16877*    MOVE '&"S        EU         (   #00015638' TO DFHEIV0
 16878     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16879     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16880     MOVE X'2020233030303135363338' TO DFHEIV0(25:11)
 16881     CALL 'kxdfhei1' USING DFHEIV0,
 16882           W-ARCH-FILE-ID,
 16883           DFHEIV20,
 16884           DFHEIV99,
 16885           W-ARCH-PARTIAL-KEY,
 16886           DFHEIV99,
 16887           DFHEIV99,
 16888           DFHEIV99
 16889     SET ADDRESS OF LETTER-ARCHIVE TO
 16890         DFHEIV20
 16891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16892
 16893
 16894     MOVE W-SAVE-BIN-DATE        TO LA-INITIAL-PRINT-DATE.
 16895
 16896     IF  LA-RESEND-DATE = LOW-VALUES
 16897         MOVE 'C'                TO LA-STATUS.
 16898
 16899
 16900* EXEC CICS REWRITE
 16901*         FROM      (LETTER-ARCHIVE)
 16902*         DATASET   (W-ARCH-FILE-ID)
 16903*    END-EXEC.
 16904     MOVE LENGTH OF
 16905      LETTER-ARCHIVE
 16906       TO DFHEIV11
 16907*    MOVE '&& L                  %   #00015650' TO DFHEIV0
 16908     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16909     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16910     MOVE X'2020233030303135363530' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 358
* EL689.cbl
 16911     CALL 'kxdfhei1' USING DFHEIV0,
 16912           W-ARCH-FILE-ID,
 16913           LETTER-ARCHIVE,
 16914           DFHEIV11,
 16915           DFHEIV99
 16916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16917
 16918
 16919 7920-EXIT.
 16920     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 359
* EL689.cbl
 16922 7935-TERM-ERROR.
 16923
 16924     MOVE ER-0412                TO EMI-ERROR.
 16925     MOVE SPACES                 TO PI-689-PRINT-SW.
 16926     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16927     MOVE -1                     TO MAINTL.
 16928     GO TO 8200-SEND-DATAONLY.
 16929
 16930 7940-TRAN-ERROR.
 16931
 16932     MOVE ER-0413                TO EMI-ERROR.
 16933     MOVE SPACES                 TO PI-689-PRINT-SW.
 16934     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16935     MOVE -1                     TO MAINTL.
 16936     GO TO 8200-SEND-DATAONLY.
 16937
 16938 7945-NOT-FOUND.
 16939
 16940     MOVE ER-0190                TO EMI-ERROR.
 16941     MOVE -1                     TO MAINTL.
 16942     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16943     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 360
* EL689.cbl
 16945 8010-ARCH-NOT-OPEN.
 16946
 16947     MOVE ER-7388                TO EMI-ERROR.
 16948     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16949     MOVE -1                     TO MAINTL.
 16950     GO TO 8200-SEND-DATAONLY.
 16951
 16952 8015-ARCT-NOT-OPEN.
 16953
 16954     MOVE ER-7373                TO EMI-ERROR.
 16955     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16956     MOVE -1                     TO MAINTL.
 16957     GO TO 8200-SEND-DATAONLY.
 16958
 16959 8020-ACCT-NOT-OPEN.
 16960
 16961     MOVE ER-0168 TO EMI-ERROR
 16962     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16963     MOVE -1                     TO MAINTL.
 16964     GO TO 8200-SEND-DATAONLY.
 16965
 16966 8030-CERT-NOT-OPEN.
 16967
 16968     MOVE ER-0169 TO EMI-ERROR.
 16969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16970     MOVE -1                     TO MAINTL.
 16971     GO TO 8200-SEND-DATAONLY.
 16972
 16973 8035-CERT-NOT-FOUND.
 16974
 16975     MOVE ER-2369 TO EMI-ERROR.
 16976     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16977     MOVE -1                     TO MAINTL.
 16978     GO TO 8200-SEND-DATAONLY.
 16979
 16980 8040-CNTL-NOT-OPEN.
 16981
 16982     MOVE ER-0042                TO EMI-ERROR.
 16983     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16984     MOVE -1                     TO MAINTL.
 16985     GO TO 8200-SEND-DATAONLY.
 16986
 16987 8045-CHEK-NOT-OPEN.
 16988
 16989     MOVE ER-3775                TO EMI-ERROR.
 16990     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16991     MOVE -1                     TO MAINTL.
 16992     GO TO 8200-SEND-DATAONLY.
 16993
 16994 8050-TEXT-NOT-OPEN.
 16995
 16996     MOVE ER-0013                TO EMI-ERROR.
 16997     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16998     MOVE -1                     TO MAINTL.
 16999     GO TO 8200-SEND-DATAONLY.
 17000
 17001 8060-PNDB-NOT-OPEN.
 17002
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 361
* EL689.cbl
 17003     MOVE ER-2216 TO EMI-ERROR.
 17004     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17005     MOVE -1                     TO MAINTL.
 17006     GO TO 8200-SEND-DATAONLY.
 17007
 17008 8070-PNDB-NOT-FOUND.
 17009
 17010     MOVE ER-7374 TO EMI-ERROR.
 17011     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17012     MOVE -1                     TO MAINTL.
 17013     GO TO 8200-SEND-DATAONLY.
 17014
 17015 8080-COMP-NOT-OPEN.
 17016
 17017     MOVE ER-2055 TO EMI-ERROR
 17018     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17019     MOVE -1                     TO MAINTL.
 17020     GO TO 8200-SEND-DATAONLY.
 17021
 17022 8085-PYAJ-NOT-OPEN.
 17023
 17024     MOVE ER-2232 TO EMI-ERROR
 17025     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17026     MOVE -1                     TO MAINTL.
 17027     GO TO 8200-SEND-DATAONLY.
 17028
 17029 8090-MAIL-NOT-OPEN.
 17030
 17031     MOVE ER-2999                TO EMI-ERROR.
 17032     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17033     MOVE -1                     TO MAINTL.
 17034     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 362
* EL689.cbl
 17036 8100-SEND-INITIAL-MAP.
 17037
 17038     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 17039     IF  PI-689-CREATE-NO-SCREENS
 17040         MOVE '9999'             TO PI-689-ERROR
 17041         GO TO 0620-RETURN-TO-CALLER.
 17042
 17043     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17044
 17045     IF  NOT EMI-NO-ERRORS
 17046         MOVE EMI-MESSAGE-AREA (1)
 17047                                 TO ERRMSGO
 17048     ELSE
 17049         MOVE SPACES             TO ERRMSGO.
 17050     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 17051                                 TO SYSO
 17052     MOVE WS-KIXHOST             TO HOSTO
 17053     IF PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR 'CAGB'
 17054        OR 'DLVA' OR 'ECCA' OR 'KRHA'
 17055        MOVE AL-SADOF            TO PF8HDA
 17056     END-IF
 17057     IF NOT PI-CREATE-LABELS
 17058         MOVE AL-PANON           TO ADDRLBLA.
 17059
 17060
 17061* EXEC CICS SEND
 17062*        MAP    (W-MAP)
 17063*        MAPSET (W-MAPSET)
 17064*        FROM   (EL689AO)
 17065*        ERASE
 17066*        CURSOR
 17067*    END-EXEC.
 17068     MOVE LENGTH OF
 17069      EL689AO
 17070       TO DFHEIV12
 17071     MOVE -1
 17072       TO DFHEIV11
 17073*    MOVE '8$     CT  E    H L F ,   #00015796' TO DFHEIV0
 17074     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17075     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17076     MOVE X'2020233030303135373936' TO DFHEIV0(25:11)
 17077     CALL 'kxdfhei1' USING DFHEIV0,
 17078           W-MAP,
 17079           EL689AO,
 17080           DFHEIV12,
 17081           W-MAPSET,
 17082           DFHEIV99,
 17083           DFHEIV99,
 17084           DFHEIV99,
 17085           DFHEIV11,
 17086           DFHEIV99,
 17087           DFHEIV99,
 17088           DFHEIV99
 17089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17090
 17091
 17092     GO TO 9000-RETURN-TRANS.
 17093
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 363
* EL689.cbl
 17094 8100-EXIT.
 17095     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 364
* EL689.cbl
 17097 8200-SEND-DATAONLY.
 17098
 17099     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 17100     IF  PI-689-CREATE-NO-SCREENS
 17101         MOVE '9999'             TO PI-689-ERROR
 17102         GO TO 0620-RETURN-TO-CALLER.
 17103
 17104     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17105
 17106     IF EMI-ERROR = ER-0715
 17107         DISPLAY 'ER 0715'
 17108         MOVE -1          TO CERTIDL
 17109         MOVE +0          TO MAINTL
 17110     END-IF
 17111
 17112     IF  NOT EMI-NO-ERRORS
 17113         MOVE EMI-MESSAGE-AREA (1)
 17114                                 TO ERRMSGO
 17115     ELSE
 17116         MOVE SPACES             TO ERRMSGO.
 17117
 17118
 17119* EXEC CICS SEND
 17120*        MAP    (W-MAP)
 17121*        MAPSET (W-MAPSET)
 17122*        FROM   (EL689AO)
 17123*        DATAONLY
 17124*        CURSOR
 17125*    END-EXEC.
 17126     MOVE LENGTH OF
 17127      EL689AO
 17128       TO DFHEIV12
 17129     MOVE -1
 17130       TO DFHEIV11
 17131*    MOVE '8$D    CT       H L F ,   #00015830' TO DFHEIV0
 17132     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 17133     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17134     MOVE X'2020233030303135383330' TO DFHEIV0(25:11)
 17135     CALL 'kxdfhei1' USING DFHEIV0,
 17136           W-MAP,
 17137           EL689AO,
 17138           DFHEIV12,
 17139           W-MAPSET,
 17140           DFHEIV99,
 17141           DFHEIV99,
 17142           DFHEIV99,
 17143           DFHEIV11,
 17144           DFHEIV99,
 17145           DFHEIV99,
 17146           DFHEIV99
 17147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17148
 17149
 17150     GO TO 9000-RETURN-TRANS.
 17151
 17152 8200-EXIT.
 17153     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 365
* EL689.cbl
 17155 8300-SEND-TEXT.
 17156
 17157     IF  PI-689-CREATE-NO-SCREENS
 17158         MOVE '9999'             TO PI-689-ERROR
 17159         GO TO 0620-RETURN-TO-CALLER.
 17160
 17161
 17162* EXEC CICS SEND TEXT
 17163*        FROM    (LOGOFF-TEXT)
 17164*        LENGTH  (LOGOFF-LENGTH)
 17165*        ERASE
 17166*        FREEKB
 17167*    END-EXEC.
 17168*    MOVE '8&      T  E F  H   F -   #00015849' TO DFHEIV0
 17169     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17170     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17171     MOVE X'2020233030303135383439' TO DFHEIV0(25:11)
 17172     CALL 'kxdfhei1' USING DFHEIV0,
 17173           LOGOFF-TEXT,
 17174           LOGOFF-LENGTH,
 17175           DFHEIV99,
 17176           DFHEIV99,
 17177           DFHEIV99,
 17178           DFHEIV99,
 17179           DFHEIV99,
 17180           DFHEIV99,
 17181           DFHEIV99,
 17182           DFHEIV99,
 17183           DFHEIV99,
 17184           DFHEIV99
 17185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17186
 17187
 17188     GO TO 9000-RETURN-TRANS.
 17189
 17190 8300-EXIT.
 17191     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 366
* EL689.cbl
 17193 8350-SEND-DATAONLY-ERASEAUP.
 17194
 17195     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 17196     PERFORM 7760-PUT-TEMP-STORAGE
 17197                                 THRU 7760-EXIT
 17198     IF  PI-689-CREATE-NO-SCREENS
 17199         MOVE '9999'             TO PI-689-ERROR
 17200         GO TO 0620-RETURN-TO-CALLER.
 17201
 17202     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17203
 17204     IF EMI-ERROR = ER-0715
 17205         DISPLAY 'ER 0715'
 17206         MOVE -1          TO CERTIDL
 17207         MOVE +0          TO MAINTL
 17208     END-IF
 17209
 17210     IF  NOT EMI-NO-ERRORS
 17211         MOVE EMI-MESSAGE-AREA (1)
 17212                                 TO ERRMSGO
 17213     ELSE
 17214         MOVE SPACES             TO ERRMSGO.
 17215
 17216
 17217* EXEC CICS SEND
 17218*        MAP      (W-MAP)
 17219*        MAPSET   (W-MAPSET)
 17220*        FROM     (EL689AO)
 17221*        DATAONLY
 17222*        ERASEAUP
 17223*        CURSOR
 17224*    END-EXEC.
 17225     MOVE LENGTH OF
 17226      EL689AO
 17227       TO DFHEIV12
 17228     MOVE -1
 17229       TO DFHEIV11
 17230*    MOVE '8$D    CT  A    H L F ,   #00015884' TO DFHEIV0
 17231     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 17232     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17233     MOVE X'2020233030303135383834' TO DFHEIV0(25:11)
 17234     CALL 'kxdfhei1' USING DFHEIV0,
 17235           W-MAP,
 17236           EL689AO,
 17237           DFHEIV12,
 17238           W-MAPSET,
 17239           DFHEIV99,
 17240           DFHEIV99,
 17241           DFHEIV99,
 17242           DFHEIV11,
 17243           DFHEIV99,
 17244           DFHEIV99,
 17245           DFHEIV99
 17246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17247
 17248
 17249     GO TO 9000-RETURN-TRANS.
 17250
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 367
* EL689.cbl
 17251 8350-EXIT.
 17252     EXIT.
 17253
 17254 8600-DEEDIT.
 17255
 17256
 17257* EXEC CICS BIF DEEDIT
 17258*         FIELD    (W-DEEDIT-FIELD)
 17259*         LENGTH   (15)
 17260*    END-EXEC.
 17261     MOVE 15
 17262       TO DFHEIV11
 17263*    MOVE '@"L                   #   #00015900' TO DFHEIV0
 17264     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17265     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17266     MOVE X'2020233030303135393030' TO DFHEIV0(25:11)
 17267     CALL 'kxdfhei1' USING DFHEIV0,
 17268           W-DEEDIT-FIELD,
 17269           DFHEIV11
 17270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17271
 17272
 17273 8600-EXIT.
 17274     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 368
* EL689.cbl
 17276 9000-RETURN-TRANS.
 17277
 17278     MOVE EMI-FATAL-CTR      TO PI-689-FATAL-CTR
 17279     MOVE EMI-FORCABLE-CTR   TO PI-689-FORCABLE-CTR
 17280     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 17281     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
 17282
 17283* EXEC CICS RETURN
 17284*        TRANSID    (W-TRANSACTION)
 17285*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 17286*        LENGTH     (PI-COMM-LENGTH)
 17287*    END-EXEC.
 17288*    MOVE '.(CT                  ''   #00015914' TO DFHEIV0
 17289     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17290     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17291     MOVE X'2020233030303135393134' TO DFHEIV0(25:11)
 17292     CALL 'kxdfhei1' USING DFHEIV0,
 17293           W-TRANSACTION,
 17294           PROGRAM-INTERFACE-BLOCK,
 17295           PI-COMM-LENGTH,
 17296           DFHEIV99,
 17297           DFHEIV99,
 17298           DFHEIV99
 17299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17300
 17301*    MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 17302*    MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 17303*    GO TO 0200-RECEIVE.
 17304
 17305 9000-EXIT.
 17306     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 369
* EL689.cbl
 17308 9200-PA.
 17309
 17310     MOVE ER-0008                TO EMI-ERROR.
 17311     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17312     MOVE -1                     TO MAINTL.
 17313     GO TO 8200-SEND-DATAONLY.
 17314
 17315 9200-EXIT.
 17316     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 370
* EL689.cbl
 17318 9300-DFHCLEAR.
 17319
 17320     IF PI-RETURN-TO-PROGRAM = 'EL689' OR 'EL690'
 17321         MOVE '2'                TO PI-ACTION.
 17322
 17323     IF  PI-CLEAR-MODE
 17324         MOVE PI-RETURN-TO-PROGRAM
 17325                                 TO W-CALL-PGM
 17326         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 17327         GO TO 9400-XCTL
 17328     ELSE
 17329         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 17330         MOVE LOW-VALUES         TO EL689AO
 17331                                    PI-1042-WA
 17332                                    PI-689-WORK-AREA
 17333         MOVE ZEROS              TO PI-CURRENT-LINE
 17334                                    PI-TEMP-STOR-ITEMS
 17335                                    PI-TOTAL-LINES
 17336                                    PI-UPDATE-SW
 17337                                    PI-689-NUMBER-LABEL-LINES
 17338         MOVE SPACES             TO PI-689-PRINT-SW
 17339                                    PI-689-ALT-PRINTER-ID
 17340                                    PI-COMM-CONTROL
 17341                                    PI-689-FORM-NUMBER
 17342                                    PI-689-TEMP-STOR-ID
 17343                                    PI-689-LABEL-SOURCE
 17344                                    PI-689-USE-SCREEN-IND
 17345         MOVE '2'                TO PI-ACTION
 17346         MOVE -1                 TO MAINTL
 17347         GO TO 8100-SEND-INITIAL-MAP.
 17348
 17349 9300-EXIT.
 17350     EXIT.
 17351
 17352 9400-XCTL.
 17353
 17354
 17355* EXEC CICS XCTL
 17356*        PROGRAM  (W-CALL-PGM)
 17357*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 17358*        LENGTH   (PI-COMM-LENGTH)
 17359*    END-EXEC.
 17360*    MOVE '.$C                   %   #00015972' TO DFHEIV0
 17361     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17362     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17363     MOVE X'2020233030303135393732' TO DFHEIV0(25:11)
 17364     CALL 'kxdfhei1' USING DFHEIV0,
 17365           W-CALL-PGM,
 17366           PROGRAM-INTERFACE-BLOCK,
 17367           PI-COMM-LENGTH,
 17368           DFHEIV99
 17369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17370
 17371
 17372 9400-EXIT.
 17373     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 371
* EL689.cbl
 17375 9500-LINK-DATE-CONVERT.
 17376
 17377     IF  DC-BIN-DATE-1 EQUAL HIGH-VALUES
 17378             AND
 17379         DC-OPTION-CODE EQUAL ' '
 17380         MOVE '99/99/99'         TO DC-GREG-DATE-1-EDIT
 17381         GO TO 9500-EXIT.
 17382
 17383
 17384* EXEC CICS LINK
 17385*        PROGRAM    ('ELDATCV')
 17386*        COMMAREA   (DATE-CONVERSION-DATA)
 17387*        LENGTH     (DC-COMM-LENGTH)
 17388*    END-EXEC.
 17389     MOVE 'ELDATCV' TO DFHEIV1
 17390*    MOVE '."C                   (   #00015989' TO DFHEIV0
 17391     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17392     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17393     MOVE X'2020233030303135393839' TO DFHEIV0(25:11)
 17394     CALL 'kxdfhei1' USING DFHEIV0,
 17395           DFHEIV1,
 17396           DATE-CONVERSION-DATA,
 17397           DC-COMM-LENGTH,
 17398           DFHEIV99,
 17399           DFHEIV99,
 17400           DFHEIV99,
 17401           DFHEIV99
 17402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17403
 17404
 17405     IF  NO-CONVERSION-ERROR
 17406             AND
 17407         PI-COMPANY-ID EQUAL 'AUK'
 17408             AND
 17409         W-REVERSE-DATE
 17410         MOVE DC-GREG-DATE-1-EDIT
 17411                                 TO W-EDIT-DATE-1
 17412         MOVE W-ED1-MM           TO W-ED2-MM
 17413         MOVE W-ED1-DD           TO W-ED2-DD
 17414         MOVE W-ED1-YY           TO W-ED2-YY
 17415         MOVE W-EDIT-DATE-2      TO DC-GREG-DATE-1-EDIT.
 17416
 17417 9500-EXIT.
 17418     EXIT.
 17419
 17420 9600-FORMAT-DATE-TIME.
 17421
 17422     MOVE W-SAVE-DATE            TO RUNDTEO.
 17423     MOVE EIBTIME                TO W-TIME-IN.
 17424     MOVE W-TIME-OUT             TO RUNTIMEO.
 17425     MOVE PI-COMPANY-ID          TO COMPANYO.
 17426     MOVE PI-PROCESSOR-ID        TO USERIDO.
 17427     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 17428
 17429 9600-EXIT.
 17430     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 372
* EL689.cbl
 17432 9700-PGMID-ERROR.
 17433
 17434     IF  PI-689-CREATE-NO-SCREENS
 17435         MOVE '9999'             TO PI-689-ERROR
 17436         GO TO 0620-RETURN-TO-CALLER.
 17437
 17438
 17439* EXEC CICS  HANDLE CONDITION
 17440*        PGMIDERR  (8300-SEND-TEXT)
 17441*    END-EXEC.
 17442*    MOVE '"$L                   ! > #00016028' TO DFHEIV0
 17443     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17444     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17445     MOVE X'3E20233030303136303238' TO DFHEIV0(25:11)
 17446     CALL 'kxdfhei1' USING DFHEIV0
 17447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17448
 17449
 17450     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
 17451     MOVE ' '                    TO PI-ENTRY-CD-1.
 17452     MOVE W-XCTL-005             TO W-CALL-PGM
 17453                                    LOGOFF-PGM.
 17454     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 17455
 17456     PERFORM 9400-XCTL THRU 9400-EXIT.
 17457
 17458 9700-EXIT.
 17459     EXIT.
 17460
 17461 9800-ABEND.
 17462
 17463     IF  PI-689-CREATE-NO-SCREENS
 17464         MOVE '9999'             TO PI-689-ERROR
 17465         GO TO 0620-RETURN-TO-CALLER.
 17466
 17467     MOVE W-LINK-004             TO W-CALL-PGM.
 17468     MOVE DFHEIBLK               TO EMI-LINE1
 17469
 17470
 17471* EXEC CICS  LINK
 17472*        PROGRAM   (W-CALL-PGM)
 17473*        COMMAREA  (EMI-LINE1)
 17474*        LENGTH    (72)
 17475*    END-EXEC.
 17476     MOVE 72
 17477       TO DFHEIV11
 17478*    MOVE '."C                   (   #00016052' TO DFHEIV0
 17479     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17480     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17481     MOVE X'2020233030303136303532' TO DFHEIV0(25:11)
 17482     CALL 'kxdfhei1' USING DFHEIV0,
 17483           W-CALL-PGM,
 17484           EMI-LINE1,
 17485           DFHEIV11,
 17486           DFHEIV99,
 17487           DFHEIV99,
 17488           DFHEIV99,
 17489           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 373
* EL689.cbl
 17490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17491
 17492
 17493     GO TO 8200-SEND-DATAONLY.
 17494
 17495 9800-EXIT.
 17496     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 374
* EL689.cbl
 17498 9900-ERROR-FORMAT.
 17499
 17500     IF  PI-689-CREATE-NO-SCREENS
 17501         MOVE EMI-ERROR          TO PI-689-ERROR
 17502         IF  PI-689-FATAL-ERROR
 17503             GO TO 0620-RETURN-TO-CALLER
 17504         ELSE
 17505             GO TO 9900-EXIT.
 17506
 17507     IF  EMI-ERROR EQUAL ER-9097
 17508         NEXT SENTENCE
 17509     ELSE
 17510         IF  EMI-ERRORS-COMPLETE
 17511                 OR
 17512             EMI-ERROR EQUAL W-LAST-ERROR
 17513             GO TO 9900-EXIT.
 17514
 17515     MOVE W-LINK-001             TO W-CALL-PGM.
 17516
 17517
 17518* EXEC CICS LINK
 17519*        PROGRAM    (W-CALL-PGM)
 17520*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17521*        LENGTH     (EMI-COMM-LENGTH)
 17522*    END-EXEC.
 17523*    MOVE '."C                   (   #00016082' TO DFHEIV0
 17524     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17525     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17526     MOVE X'2020233030303136303832' TO DFHEIV0(25:11)
 17527     CALL 'kxdfhei1' USING DFHEIV0,
 17528           W-CALL-PGM,
 17529           ERROR-MESSAGE-INTERFACE-BLOCK,
 17530           EMI-COMM-LENGTH,
 17531           DFHEIV99,
 17532           DFHEIV99,
 17533           DFHEIV99,
 17534           DFHEIV99
 17535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17536
 17537
 17538     IF  EMI-SEVERITY (2) EQUAL 'X'
 17539             AND
 17540         EMI-SEVERITY (1) NOT EQUAL 'X'
 17541         MOVE EMI-MESSAGE-AREA (2)
 17542                                 TO EMI-MESSAGE-AREA (1).
 17543
 17544     MOVE EMI-ERROR              TO W-LAST-ERROR.
 17545
 17546 9900-EXIT.
 17547     EXIT.
 17548
 17549 9905-INITIALIZE-SECURITY.
 17550******************************************************************
 17551*                                                                *
 17552*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
 17553*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
 17554*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
 17555*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 375
* EL689.cbl
 17556*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
 17557*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
 17558*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
 17559*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
 17560*                                                                *
 17561*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
 17562*       IS ALSO PROVIDED BY THIS LOGIC.                          *
 17563*                                                                *
 17564******************************************************************
 17565
 17566     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
 17567         MOVE 'Y'                TO PI-DISPLAY-CAP
 17568                                    PI-MODIFY-CAP
 17569     ELSE
 17570
 17571* EXEC CICS READQ TS
 17572*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
 17573*            INTO   (SECURITY-CONTROL)
 17574*            LENGTH (SC-COMM-LENGTH)
 17575*            ITEM   (1)
 17576*        END-EXEC
 17577     MOVE 1
 17578       TO DFHEIV11
 17579*    MOVE '*$II   L              ''   #00016120' TO DFHEIV0
 17580     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 17581     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17582     MOVE X'2020233030303136313230' TO DFHEIV0(25:11)
 17583     CALL 'kxdfhei1' USING DFHEIV0,
 17584           PI-SECURITY-TEMP-STORE-ID,
 17585           SECURITY-CONTROL,
 17586           SC-COMM-LENGTH,
 17587           DFHEIV11,
 17588           DFHEIV99,
 17589           DFHEIV99
 17590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17591         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
 17592                                 TO PI-DISPLAY-CAP
 17593         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
 17594                                 TO PI-MODIFY-CAP.
 17595
 17596 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 376
* EL689.cbl
 17598 9995-SECURITY-VIOLATION.
 17599
 17600     MOVE EIBDATE                TO SM-JUL-DATE.
 17601     MOVE EIBTRMID               TO SM-TERMID.
 17602     MOVE W-THIS-PGM             TO SM-PGM.
 17603     MOVE EIBTIME                TO W-TIME-IN.
 17604     MOVE W-TIME-OUT             TO SM-TIME.
 17605     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
 17606
 17607
 17608* EXEC CICS LINK
 17609*         PROGRAM  ('EL003')
 17610*         COMMAREA (SECURITY-MESSAGE)
 17611*         LENGTH   (80)
 17612*    END-EXEC.
 17613     MOVE 'EL003' TO DFHEIV1
 17614     MOVE 80
 17615       TO DFHEIV11
 17616*    MOVE '."C                   (   #00016142' TO DFHEIV0
 17617     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17618     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17619     MOVE X'2020233030303136313432' TO DFHEIV0(25:11)
 17620     CALL 'kxdfhei1' USING DFHEIV0,
 17621           DFHEIV1,
 17622           SECURITY-MESSAGE,
 17623           DFHEIV11,
 17624           DFHEIV99,
 17625           DFHEIV99,
 17626           DFHEIV99,
 17627           DFHEIV99
 17628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17629
 17630
 17631 9995-EXIT.
 17632     EXIT.
 17633
 17634 9999-GOBACK.
 17635
 17636
 17637* GOBACK.
 17638     MOVE '9%                    "   ' TO DFHEIV0
 17639     MOVE 'EL689' TO DFHEIV1
 17640     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17641     GOBACK.
 17642
 17643 9999-EXIT.
 17644     EXIT.
 17645
 17646 9999-DFHBACK SECTION.
 17647     MOVE '9%                    "   ' TO DFHEIV0
 17648     MOVE 'EL689' TO DFHEIV1
 17649     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17650     GOBACK.
 17651 9999-DFHEXIT.
 17652     IF DFHEIGDJ EQUAL 0001
 17653         NEXT SENTENCE
 17654     ELSE IF DFHEIGDJ EQUAL 2
 17655         GO TO 9300-DFHCLEAR,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 377
* EL689.cbl
 17656               9200-PA,
 17657               9200-PA,
 17658               9200-PA
 17659         DEPENDING ON DFHEIGDI
 17660     ELSE IF DFHEIGDJ EQUAL 3
 17661         GO TO 9700-PGMID-ERROR,
 17662               9800-ABEND,
 17663               0325-MAPFAIL
 17664         DEPENDING ON DFHEIGDI
 17665     ELSE IF DFHEIGDJ EQUAL 4
 17666         GO TO 8040-CNTL-NOT-OPEN,
 17667               7945-NOT-FOUND
 17668         DEPENDING ON DFHEIGDI
 17669     ELSE IF DFHEIGDJ EQUAL 5
 17670         GO TO 9700-PGMID-ERROR,
 17671               0325-MAPFAIL,
 17672               9800-ABEND
 17673         DEPENDING ON DFHEIGDI
 17674     ELSE IF DFHEIGDJ EQUAL 6
 17675         GO TO 0990-CARRIER-NOT-FOUND,
 17676               8040-CNTL-NOT-OPEN
 17677         DEPENDING ON DFHEIGDI
 17678     ELSE IF DFHEIGDJ EQUAL 7
 17679         GO TO 0994-STATE-NOT-FOUND,
 17680               8040-CNTL-NOT-OPEN
 17681         DEPENDING ON DFHEIGDI
 17682     ELSE IF DFHEIGDJ EQUAL 8
 17683         GO TO 8010-ARCH-NOT-OPEN,
 17684               1070-ARCH-NOT-FOUND,
 17685               1070-ARCH-NOT-FOUND
 17686         DEPENDING ON DFHEIGDI
 17687     ELSE IF DFHEIGDJ EQUAL 9
 17688         GO TO 2001-NOT-FOUND,
 17689               2001-NOT-FOUND,
 17690               8050-TEXT-NOT-OPEN
 17691         DEPENDING ON DFHEIGDI
 17692     ELSE IF DFHEIGDJ EQUAL 10
 17693         GO TO 2000-ENDBR
 17694         DEPENDING ON DFHEIGDI
 17695     ELSE IF DFHEIGDJ EQUAL 11
 17696         GO TO 8040-CNTL-NOT-OPEN,
 17697               6200-CNTL1-NOT-FOUND
 17698         DEPENDING ON DFHEIGDI
 17699     ELSE IF DFHEIGDJ EQUAL 12
 17700         GO TO 8040-CNTL-NOT-OPEN,
 17701               6250-CNTL2-NOT-FOUND
 17702         DEPENDING ON DFHEIGDI
 17703     ELSE IF DFHEIGDJ EQUAL 13
 17704         GO TO 8040-CNTL-NOT-OPEN,
 17705               6300-CNTL6-NOT-FOUND
 17706         DEPENDING ON DFHEIGDI
 17707     ELSE IF DFHEIGDJ EQUAL 14
 17708         GO TO 8040-CNTL-NOT-OPEN,
 17709               6350-CNTL2-NOT-FOUND
 17710         DEPENDING ON DFHEIGDI
 17711     ELSE IF DFHEIGDJ EQUAL 15
 17712         GO TO 8060-PNDB-NOT-OPEN,
 17713               8070-PNDB-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 378
* EL689.cbl
 17714         DEPENDING ON DFHEIGDI
 17715     ELSE IF DFHEIGDJ EQUAL 16
 17716         GO TO 8030-CERT-NOT-OPEN,
 17717               8035-CERT-NOT-FOUND
 17718         DEPENDING ON DFHEIGDI
 17719     ELSE IF DFHEIGDJ EQUAL 17
 17720         GO TO 8020-ACCT-NOT-OPEN,
 17721               6500-ACCT-NOT-FOUND,
 17722               6500-ONLY-STOP
 17723         DEPENDING ON DFHEIGDI
 17724     ELSE IF DFHEIGDJ EQUAL 18
 17725         GO TO 8080-COMP-NOT-OPEN,
 17726               6600-COMP-NOT-FOUND
 17727         DEPENDING ON DFHEIGDI
 17728     ELSE IF DFHEIGDJ EQUAL 19
 17729         GO TO 8040-CNTL-NOT-OPEN,
 17730               6630-CNTL2-NOT-FOUND
 17731         DEPENDING ON DFHEIGDI
 17732     ELSE IF DFHEIGDJ EQUAL 20
 17733         GO TO 8090-MAIL-NOT-OPEN,
 17734               6700-MAIL-NOT-FOUND
 17735         DEPENDING ON DFHEIGDI
 17736     ELSE IF DFHEIGDJ EQUAL 21
 17737         GO TO 8040-CNTL-NOT-OPEN,
 17738               6750-EXIT
 17739         DEPENDING ON DFHEIGDI
 17740     ELSE IF DFHEIGDJ EQUAL 22
 17741         GO TO 8040-CNTL-NOT-OPEN,
 17742               6800-EXIT
 17743         DEPENDING ON DFHEIGDI
 17744     ELSE IF DFHEIGDJ EQUAL 23
 17745         GO TO 8045-CHEK-NOT-OPEN,
 17746               6850-CHEK-NOT-FOUND
 17747         DEPENDING ON DFHEIGDI
 17748     ELSE IF DFHEIGDJ EQUAL 24
 17749         GO TO 8085-PYAJ-NOT-OPEN,
 17750               6900-PYAJ-NOT-FOUND
 17751         DEPENDING ON DFHEIGDI
 17752     ELSE IF DFHEIGDJ EQUAL 25
 17753         GO TO 7700-TS-ERROR,
 17754               7700-TS-ERROR
 17755         DEPENDING ON DFHEIGDI
 17756     ELSE IF DFHEIGDJ EQUAL 26
 17757         GO TO 7780-EXIT
 17758         DEPENDING ON DFHEIGDI
 17759     ELSE IF DFHEIGDJ EQUAL 27
 17760         GO TO 8040-CNTL-NOT-OPEN,
 17761               7945-NOT-FOUND
 17762         DEPENDING ON DFHEIGDI
 17763     ELSE IF DFHEIGDJ EQUAL 28
 17764         GO TO 7935-TERM-ERROR,
 17765               7940-TRAN-ERROR
 17766         DEPENDING ON DFHEIGDI
 17767     ELSE IF DFHEIGDJ EQUAL 29
 17768         GO TO 8010-ARCH-NOT-OPEN,
 17769               1070-ARCH-NOT-FOUND,
 17770               1070-ARCH-NOT-FOUND
 17771         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:28 Page 379
* EL689.cbl
 17772     ELSE IF DFHEIGDJ EQUAL 30
 17773         GO TO 8300-SEND-TEXT
 17774         DEPENDING ON DFHEIGDI.
 17775     MOVE '9%                    "   ' TO DFHEIV0
 17776     MOVE 'EL689' TO DFHEIV1
 17777     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17778     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      232716     Code:       60334
