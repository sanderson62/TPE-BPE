* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30******************************************************************
    31
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page   3
* EL131.cbl
    33 ENVIRONMENT DIVISION.
    34
    35 DATA DIVISION.
    36
    37 WORKING-STORAGE SECTION.
    38 01  DFH-START PIC X(04).
    39 01  LCP-TIME-OF-DAY-XX.
    40     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    41     05  FILLER                    PIC 99.
    42 01  LCP-CICS-TIME                 PIC 9(15).
    43
    44 77  FILLER  PIC X(32)  VALUE '********************************'.
    45 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    46 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    47
    48*                            COPY ELCSCTM.
    49******************************************************************
    50*                                                                *
    51*                                                                *
    52*                            ELCSCTM                             *
    53*                            VMOD=2.001                          *
    54*                                                                *
    55*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    56*                                                                *
    57******************************************************************
    58 01  SECURITY-MESSAGE.
    59     12  FILLER                          PIC X(30)
    60            VALUE '** LOGIC SECURITY VIOLATION -'.
    61     12  SM-READ                         PIC X(6).
    62     12  FILLER                          PIC X(5)
    63            VALUE ' PGM='.
    64     12  SM-PGM                          PIC X(6).
    65     12  FILLER                          PIC X(5)
    66            VALUE ' OPR='.
    67     12  SM-PROCESSOR-ID                 PIC X(4).
    68     12  FILLER                          PIC X(6)
    69            VALUE ' TERM='.
    70     12  SM-TERMID                       PIC X(4).
    71     12  FILLER                          PIC XX   VALUE SPACE.
    72     12  SM-JUL-DATE                     PIC 9(5).
    73     12  FILLER                          PIC X    VALUE SPACE.
    74     12  SM-TIME                         PIC 99.99.
    75
    76
    77*                            COPY ELCSCRTY.
    78******************************************************************
    79*                                                                *
    80*                                                                *
    81*                            ELCSCRTY                            *
    82*                            VMOD=2.001                          *
    83*                                                                *
    84*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    85*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    86*        SAVED IN PI-SECURITY-ADDRESS.                           *
    87*                                                                *
    88******************************************************************
    89 01  SECURITY-CONTROL.
    90     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page   4
* EL131.cbl
    91     12  FILLER                       PIC XX    VALUE 'SC'.
    92     12  SC-CREDIT-CODES.
    93         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    94             20  SC-CREDIT-DISPLAY    PIC X.
    95             20  SC-CREDIT-UPDATE     PIC X.
    96     12  SC-CLAIMS-CODES.
    97         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    98             20  SC-CLAIMS-DISPLAY    PIC X.
    99             20  SC-CLAIMS-UPDATE     PIC X.
   100
   101*                            COPY ELCNWA.
   102*****************************************************************
   103*                                                               *
   104*                                                               *
   105*                            ELCNWA.                            *
   106*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   107*                            VMOD=2.003                         *
   108*                                                               *
   109*            M O V E   N A M E   W O R K   A R E A.             *
   110*                                                               *
   111*****************************************************************.
   112
   113 01  WS-NAME-WORK-AREA.
   114     05  WS-INSURED-LAST-NAME        PIC X(15).
   115     05  WS-INSURED-1ST-NAME         PIC X(12).
   116     05  WS-INSURED-MID-INIT         PIC X.
   117
   118     05  WS-NAME-WORK.
   119         10  WS-NW                   PIC X
   120             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   121
   122     05  WS-NAME-WORK2.
   123         10  WS-NW2                  PIC X
   124             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   125                                        NWA-INDEX0.
   126
   127     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   128                                     COMP-3.
   129
   130
   131 01  WS-DATE-AREA.
   132     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   133     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   134     12  SAVE-DATE-CCYYMMDD.
   135         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   136         16  SAVE-DATE-YMD.
   137             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   138             20  FILLER         PIC X(4)    VALUE SPACES.
   139
   140 01  WS-BLANK                   PIC X       VALUE ' '.
   141
   142 01  CSO-WORK-FIELDS.
   143     05  WS-HOLD-CLAIM-STATUS    PIC X.
   144
   145 01  LITERALS-NUMBERS.
   146     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   147     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   148     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page   5
* EL131.cbl
   149     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   150     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   151     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   152     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   153
   154     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   155     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   156     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   157     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   158     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   159     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   160     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   161     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   162     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   163
   164     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   165
   166     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   167
   168     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   169     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   170     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   171     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   172     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   173     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   174     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   175     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   176     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   177     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   178     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   179
   180     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   181     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   182     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   183     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   184         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   185     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   186     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   187     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   188     12  WS-CLAIM-SEQU.
   189         16  FILLER              PIC X VALUE '('.
   190         16  WS-CURRENT-SEQU     PIC Z9.
   191         16  FILLER              PIC X(04) VALUE ' OF '.
   192         16  WS-OF-SEQU          PIC Z9.
   193         16  FILLER              PIC X VALUE ')'.
   194     12  WS-EDIT-BEN-CODE        PIC XX.
   195         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   196                                          '90' THRU '99'.
   197
   198     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   199     12  WS-EDIT-NUMBER          PIC ZZZ9.
   200
   201     12  WS-RESPONSE             PIC S9(8)   COMP.
   202         88  WS-RESP-NORMAL                  VALUE +00.
   203         88  WS-RESP-NOTFND                  VALUE +13.
   204
   205     12  WS-MOS-PAID             PIC 999.
   206     12  WS-ODD-DAYS             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page   6
* EL131.cbl
   207     12  WS-REM-MOS              PIC 999.
   208     12  WS-REM-DAYS             PIC 99.
   209     12  WS-TERM-IN-DAYS         PIC 9(4).
   210     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   211
   212     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   213     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   214     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   215     12  WS-RESET-SW             PIC X       VALUE 'N'.
   216     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   217     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   218     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   219
   220 01  DMD-DATE-YYYYMMDD.
   221     12  DMD-DECADE          PIC XX      VALUE SPACES.
   222     12  DMD-YYMMDD.
   223         16  DMD-YY          PIC XX      VALUE SPACES.
   224         16  DMD-MM          PIC XX      VALUE SPACES.
   225         16  DMD-DD          PIC XX      VALUE SPACES.
   226
   227 01  DMD-DATE-MMDDYYYY.
   228     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   229     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   230     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   231     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   232     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   233     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   234
   235 01  WS-MAIL-CODE.
   236     12  FILLER              PIC X.
   237     12  DMD-MAIL-CODE.
   238         16  WS-MAIL-4       PIC X(4).
   239         16  WS-MAIL-5       PIC X.
   240     12  FILLER              PIC X(4).
   241
   242     12  W-NAME-LAST             PIC  X(15).
   243     12  W-NAME-FIRST            PIC  X(15).
   244     12  W-NAME-MIDDLE.
   245         16  FILLER              PIC  X.
   246         16  W-NAME-MIDDLE-2     PIC  X.
   247         16  FILLER              PIC  X(13).
   248
   249*    COPY ELCDCTB.
   250******************************************************************
   251*                                                                *
   252*                                                                *
   253*                            ELCDCTB.                            *
   254*                            VMOD=2.002                          *
   255*                                                                *
   256*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   257*       COMMUNICATIONS AREA                                      *
   258*                                                                *
   259******************************************************************
   260 01  DCT-COMMUNICATION-AREA.
   261     12  DCT-BILLING-BANK-ID      PIC  X(05).
   262     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   263     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   264     12  DCT-PRODUCT-CODE         PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page   7
* EL131.cbl
   265     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   266     12  DCT-RETURN-CODE          PIC  X(02).
   267     12  DCT-MAIL-CODE            PIC  X(05).
   268     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   269     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page   8
* EL131.cbl
   271 01  ERROR-SWITCHES.
   272     12  ERROR-SWITCH            PIC X.
   273         88  SCREEN-ERROR                    VALUE 'X'.
   274     12  MSTR-KEY-SWITCH         PIC X.
   275         88  MSTR-KEY-CHANGED                VALUE 'X'.
   276     12  CERT-KEY-SWITCH         PIC X.
   277*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   278         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   279*********SET TO Y IF PRIMARY KEY WILL CHANGE
   280         88  CERT-KEY-CHANGED                VALUE 'Y'.
   281     12  MSTR-SWITCH             PIC X.
   282         88  MSTR-UPDATES                    VALUE 'X'.
   283     12  CERT-SWITCH             PIC X.
   284         88  CERT-UPDATES                    VALUE 'X'.
   285     12  UPDATE-SWITCH           PIC X.
   286         88  UPDATES-PRESENT                 VALUE 'X'.
   287     12  TRLR-SWITCH             PIC X.
   288         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   289         88  UPDATE-MADE                     VALUE 'Y'.
   290     12  NINETY-TRLR-SWITCH      PIC X.
   291         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   292     12  EARNINGS-CALC-SWITCH    PIC X.
   293         88  TEX-REG                         VALUE '4'.
   294         88  NET-PAY                         VALUE '5'.
   295     12  DLYACTV-SW              PIC X       VALUE 'N'.
   296         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page   9
* EL131.cbl
   298 01  EDIT-WORK-AREA.
   299     12  COUNT-2                 PIC 9.
   300     12  CALL-PGM                PIC X(8).
   301     12  TRANS-ID                PIC X(4).
   302     12  CHECK-PFKEYS            PIC 99.
   303     12  CHECK-MAINT             PIC X.
   304         88  ADD-ALPHA-RECORD                VALUE 'A'.
   305         88  CHANGE-CLAIM                    VALUE 'C'.
   306         88  DELETE-CLAIM                    VALUE 'D'.
   307         88  CHANGE-NAME                     VALUE 'N'.
   308         88  VALID-OPTIONS                   VALUE 'A' 'C'
   309                                                   'D' 'N'.
   310
   311     12  HOLD-BENEFIT            PIC XX.
   312     12  HOLD-FREQ               PIC XX.
   313     12  HOLD-REPORTED           PIC XX.
   314     12  HOLD-INCUR              PIC XX.
   315     12  HOLD-PDTHRU             PIC XX.
   316     12  HOLD-ADDON              PIC XX.
   317     12  HOLD-NODAYS             PIC 9(4).
   318     12  HOLD-NOPMTS             PIC 9(3).
   319     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   320     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   321     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   322     12  HOLD-BIRTH              PIC XX.
   323     12  HOLD-END                PIC XX.
   324     12  HOLD-EFF                PIC XX.
   325     12  HOLD-ENTRY              PIC XX.
   326     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   327     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   328     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   329     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   330     12  HOLD-LF-CV-CAN          PIC XX.
   331     12  HOLD-AH-CV-CAN          PIC XX.
   332     12  DIVIDE-QUOT             PIC 9(3).
   333     12  DIVIDE-REM              PIC 9(3).
   334
   335     12  WS-ALPHA-DATE.
   336         16  WS-ALPHA-YEAR.
   337             20  WS-ALPHA-YY-1   PIC 99.
   338             20  WS-ALPHA-YY-2   PIC 99.
   339         16  WS-ALPHA-MM         PIC 99.
   340         16  WS-ALPHA-DD         PIC 99.
   341
   342     12  BUILD-VALID-DATE.
   343         16  BUILD-MONTH         PIC 99.
   344         16  BUILD-DAY           PIC 99.
   345         16  BUILD-YEAR          PIC 99.
   346     12  DEEDIT-MMYY-INPUT.
   347         16  FILLER              PIC X.
   348         16  DEEDIT-MONTH        PIC XX.
   349         16  DEEDIT-YEAR         PIC XX.
   350     12  DEEDIT-BEN              PIC 9(9)V99.
   351     12  DEEDIT-DATE-INPUT.
   352         16  FILLER              PIC XX.
   353         16  DEEDIT-DATE         PIC X(6).
   354     12  WORK-DATE-MDY.
   355         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  10
* EL131.cbl
   356         16  FILLER              PIC X(4).
   357         16  YEAR-WORK           PIC XX.
   358     12  WORK-DATE-MY.
   359         16  WORK-MONTH          PIC XX.
   360         16  WORK-SLASH          PIC X       VALUE '/'.
   361         16  WORK-YEAR           PIC XX.
   362     12  HOLD-DATE.
   363         16  HOLD-MONTH          PIC 99.
   364         16  FILLER              PIC X(4).
   365         16  HOLD-YEAR           PIC 99.
   366     12  SPLIT-INFO-LINE-1.
   367         16  SPLIT-INFO-DESC     PIC X(15).
   368         16  FILLER              PIC X(5)    VALUE ' OLD='.
   369         16  SPLIT-INFO-OLD      PIC X(40).
   370     12  EFF-TERM-MO             PIC 9(4).
   371     12  CURR-MO                 PIC 9(4).
   372     12  WS-BIN-CURRENT-DT       PIC XX.
   373     12  WS-CALC-METHOD          PIC X.
   374     12  WS-INITIALS.
   375         16  WS-INIT-1           PIC X.
   376         16  WS-INIT-2           PIC X.
   377     12  WS-REIN-TABLE.
   378         16  WS-REIN-1           PIC X.
   379         16  WS-REIN-2           PIC X.
   380         16  WS-REIN-3           PIC X.
   381     12  PI-KEY.
   382         16  PI-TERM             PIC X(4).
   383         16  PI-QUAL             PIC X(4).
   384     12  CHECK-KEY               PIC X(20).
   385     12  SAVE-ACCT-KEY           PIC X(20).
   386     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   387     12  WS-SOC-SEC-NUMBER.
   388         16  WS-SOC-SEC-NO       PIC 9(9).
   389         16  WS-SOC-SEC-BLANK    PIC X(2).
   390     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   391         16  WS-SSN-1-3          PIC 9(3).
   392         16  WS-SSN-DASH1        PIC X(1).
   393         16  WS-SSN-4-5          PIC 9(2).
   394         16  WS-SSN-DASH2        PIC X(1).
   395         16  WS-SSN-6-9          PIC 9(4).
   396
   397 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   398     12  M                   PIC S9(7)V99           VALUE ZEROS.
   399     12  L                   PIC S9(7)V99           VALUE ZEROS.
   400     12  N                   PIC S9(3)              VALUE ZEROS.
   401     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   402     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   403     12  I                   PIC S99V9(5)           VALUE ZEROS.
   404     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   405     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   406     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   407     12  R                   PIC S9(3)              VALUE ZEROS.
   408     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   409     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   410     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   411     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   412     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   413     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  11
* EL131.cbl
   414     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   415     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   416     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   417
   418 01  TERM-CALC-WORK-AREA.
   419     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   420     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   421     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   422     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   423     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   424     12  V-EXPONENTS.
   425        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   426     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   427
   428 01  TIME-IN.
   429     12  UN-HOURS                PIC XX.
   430     12  UN-MINUTES              PIC XX.
   431     12  FILLER                  PIC XX.
   432
   433 01  TIME-OUT.
   434     12  FOR-HOURS               PIC XX.
   435     12  FILLER                  PIC X       VALUE '.'.
   436     12  FOR-MINUTES             PIC XX.
   437
   438 01  ERROR-NUMBERS.
   439     12  ER-0000                 PIC X(4)    VALUE '0000'.
   440     12  ER-0004                 PIC X(4)    VALUE '0004'.
   441     12  ER-0008                 PIC X(4)    VALUE '0008'.
   442     12  ER-0023                 PIC X(4)    VALUE '0023'.
   443     12  ER-0029                 PIC X(4)    VALUE '0029'.
   444     12  ER-0068                 PIC X(4)    VALUE '0068'.
   445     12  ER-0070                 PIC X(4)    VALUE '0070'.
   446     12  ER-0149                 PIC X(4)    VALUE '0149'.
   447     12  ER-0154                 PIC X(4)    VALUE '0154'.
   448     12  ER-0169                 PIC X(4)    VALUE '0169'.
   449     12  ER-0192                 PIC X(4)    VALUE '0192'.
   450     12  ER-0199                 PIC X(4)    VALUE '0199'.
   451     12  ER-0203                 PIC X(4)    VALUE '0203'.
   452     12  ER-0204                 PIC X(4)    VALUE '0204'.
   453     12  ER-0205                 PIC X(4)    VALUE '0205'.
   454     12  ER-0206                 PIC X(4)    VALUE '0206'.
   455     12  ER-0208                 PIC X(4)    VALUE '0208'.
   456     12  ER-0210                 PIC X(4)    VALUE '0210'.
   457     12  ER-0215                 PIC X(4)    VALUE '0215'.
   458     12  ER-0219                 PIC X(4)    VALUE '0219'.
   459     12  ER-0220                 PIC X(4)    VALUE '0220'.
   460     12  ER-0222                 PIC X(4)    VALUE '0222'.
   461     12  ER-0223                 PIC X(4)    VALUE '0223'.
   462     12  ER-0224                 PIC X(4)    VALUE '0224'.
   463     12  ER-0227                 PIC X(4)    VALUE '0227'.
   464     12  ER-0230                 PIC X(4)    VALUE '0230'.
   465     12  ER-0232                 PIC X(4)    VALUE '0232'.
   466     12  ER-0233                 PIC X(4)    VALUE '0233'.
   467     12  ER-0236                 PIC X(4)    VALUE '0236'.
   468     12  ER-0237                 PIC X(4)    VALUE '0237'.
   469     12  ER-0238                 PIC X(4)    VALUE '0238'.
   470     12  ER-0240                 PIC X(4)    VALUE '0240'.
   471     12  ER-0241                 PIC X(4)    VALUE '0241'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  12
* EL131.cbl
   472     12  ER-0243                 PIC X(4)    VALUE '0243'.
   473     12  ER-0244                 PIC X(4)    VALUE '0244'.
   474     12  ER-0246                 PIC X(4)    VALUE '0246'.
   475     12  ER-0247                 PIC X(4)    VALUE '0247'.
   476     12  ER-0248                 PIC X(4)    VALUE '0248'.
   477     12  ER-0250                 PIC X(4)    VALUE '0250'.
   478     12  ER-0251                 PIC X(4)    VALUE '0251'.
   479     12  ER-0253                 PIC X(4)    VALUE '0253'.
   480     12  ER-0256                 PIC X(4)    VALUE '0256'.
   481     12  ER-0257                 PIC X(4)    VALUE '0257'.
   482     12  ER-0258                 PIC X(4)    VALUE '0258'.
   483     12  ER-0259                 PIC X(4)    VALUE '0259'.
   484     12  ER-0260                 PIC X(4)    VALUE '0260'.
   485     12  ER-0261                 PIC X(4)    VALUE '0261'.
   486     12  ER-0262                 PIC X(4)    VALUE '0262'.
   487     12  ER-0263                 PIC X(4)    VALUE '0263'.
   488     12  ER-0273                 PIC X(4)    VALUE '0273'.
   489     12  ER-0274                 PIC X(4)    VALUE '0274'.
   490     12  ER-0276                 PIC X(4)    VALUE '0276'.
   491     12  ER-0282                 PIC X(4)    VALUE '0282'.
   492     12  ER-0283                 PIC X(4)    VALUE '0283'.
   493     12  ER-0309                 PIC X(4)    VALUE '0309'.
   494     12  ER-0310                 PIC X(4)    VALUE '0310'.
   495     12  ER-0311                 PIC X(4)    VALUE '0311'.
   496     12  ER-0333                 PIC X(4)    VALUE '0333'.
   497     12  ER-0360                 PIC X(4)    VALUE '0360'.
   498     12  ER-0377                 PIC X(4)    VALUE '0377'.
   499     12  ER-0402                 PIC X(4)    VALUE '0402'.
   500     12  ER-0416                 PIC X(4)    VALUE '0416'.
   501     12  ER-0426                 PIC X(4)    VALUE '0426'.
   502     12  ER-0427                 PIC X(4)    VALUE '0427'.
   503     12  ER-0428                 PIC X(4)    VALUE '0428'.
   504     12  ER-0429                 PIC X(4)    VALUE '0429'.
   505     12  ER-0430                 PIC X(4)    VALUE '0430'.
   506     12  ER-0475                 PIC X(4)    VALUE '0475'.
   507     12  ER-0491                 PIC X(4)    VALUE '0491'.
   508     12  ER-0509                 PIC X(4)    VALUE '0509'.
   509     12  ER-0510                 PIC X(4)    VALUE '0510'.
   510     12  ER-0519                 PIC X(4)    VALUE '0519'.
   511     12  ER-0520                 PIC X(4)    VALUE '0520'.
   512     12  ER-0521                 PIC X(4)    VALUE '0521'.
   513     12  ER-0547                 PIC X(4)    VALUE '0547'.
   514     12  ER-0548                 PIC X(4)    VALUE '0548'.
   515     12  ER-0549                 PIC X(4)    VALUE '0549'.
   516     12  ER-0565                 PIC X(4)    VALUE '0565'.
   517     12  ER-0598                 PIC X(4)    VALUE '0598'.
   518     12  ER-0639                 PIC X(4)    VALUE '0639'.
   519     12  ER-0797                 PIC X(4)    VALUE '0797'.
   520     12  ER-0802                 PIC X(4)    VALUE '0802'.
   521     12  ER-0803                 PIC X(4)    VALUE '0803'.
   522     12  ER-0849                 PIC X(4)    VALUE '0849'.
   523     12  ER-0885                 PIC X(4)    VALUE '0885'.
   524     12  ER-0887                 PIC X(4)    VALUE '0887'.
   525     12  ER-0919                 PIC X(4)    VALUE '0919'.
   526     12  ER-0921                 PIC X(4)    VALUE '0921'.
   527     12  ER-0938                 PIC X(4)    VALUE '0938'.
   528     12  ER-0946                 PIC X(4)    VALUE '0946'.
   529     12  ER-0947                 PIC X(4)    VALUE '0947'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  13
* EL131.cbl
   530     12  ER-0948                 PIC X(4)    VALUE '0948'.
   531     12  ER-0949                 PIC X(4)    VALUE '0949'.
   532     12  ER-0950                 PIC X(4)    VALUE '0950'.
   533     12  ER-0951                 PIC X(4)    VALUE '0951'.
   534     12  ER-0954                 PIC X(4)    VALUE '0954'.
   535     12  ER-0974                 PIC X(4)    VALUE '0974'.
   536     12  ER-0975                 PIC X(4)    VALUE '0975'.
   537     12  ER-2280                 PIC X(4)    VALUE '2280'.
   538     12  ER-2878                 PIC X(4)    VALUE '2878'.
   539     12  ER-7641                 PIC X(4)    VALUE '7641'.
   540     12  ER-7642                 PIC X(4)    VALUE '7642'.
   541     12  ER-7650                 PIC X(4)    VALUE '7650'.
   542     12  ER-7651                 PIC X(4)    VALUE '7651'.
   543     12  ER-7687                 PIC X(4)    VALUE '7687'.
   544     12  ER-7689                 PIC X(4)    VALUE '7689'.
   545     12  ER-7690                 PIC X(4)    VALUE '7690'.
   546     12  ER-7691                 PIC X(4)    VALUE '7691'.
   547     12  ER-8003                 PIC X(4)    VALUE '8003'.
   548     12  ER-8051                 PIC X(4)    VALUE '8051'.
   549     12  ER-8052                 PIC X(4)    VALUE '8052'.
   550     12  ER-8053                 PIC X(4)    VALUE '8053'.
   551     12  ER-8054                 PIC X(4)    VALUE '8054'.
   552     12  ER-8055                 PIC X(4)    VALUE '8055'.
   553     12  ER-8056                 PIC X(4)    VALUE '8056'.
   554     12  ER-8057                 PIC X(4)    VALUE '8057'.
   555     12  ER-8058                 PIC X(4)    VALUE '8058'.
   556     12  ER-8059                 PIC X(4)    VALUE '8059'.
   557     12  ER-8060                 PIC X(4)    VALUE '8060'.
   558     12  ER-8061                 PIC X(4)    VALUE '8061'.
   559     12  ER-8062                 PIC X(4)    VALUE '8062'.
   560     12  ER-8063                 PIC X(4)    VALUE '8063'.
   561     12  ER-8064                 PIC X(4)    VALUE '8064'.
   562     12  ER-8065                 PIC X(4)    VALUE '8065'.
   563     12  ER-8066                 PIC X(4)    VALUE '8066'.
   564     12  ER-8152                 PIC X(4)    VALUE '8152'.
   565     12  ER-8153                 PIC X(4)    VALUE '8153'.
   566     12  ER-8154                 PIC X(4)    VALUE '8154'.
   567     12  ER-8155                 PIC X(4)    VALUE '8155'.
   568
   569 01  MSTR-KEY.
   570     12  COMPANY-CODE            PIC X.
   571     12  CARRIER-CODE            PIC X.
   572     12  CLAIM-NO                PIC X(7).
   573     12  CERT-NO.
   574         16  CERT-NO-PRIME       PIC X(10).
   575         16  CERT-NO-SUFX        PIC X.
   576
   577 01  WS-SAVE-CLAIM-KEY.
   578     12  WS-SAVE-COMPANY-CD      PIC X.
   579     12  WS-SAVE-CARRIER         PIC X.
   580     12  WS-SAVE-CLAIM-NO        PIC X(7).
   581     12  WS-SAVE-CERT-NO.
   582         16  WS-CERT-NO-PRIME    PIC X(10).
   583         16  WS-CERT-NO-SUFX     PIC X.
   584
   585 01  CERT-KEY.
   586     12  CERT-COMPANY-CODE       PIC X.
   587     12  CERT-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  14
* EL131.cbl
   588     12  CERT-GROUP              PIC X(6).
   589     12  CERT-STATE              PIC XX.
   590     12  CERT-ACCOUNT            PIC X(10).
   591     12  CERT-DATE               PIC XX.
   592     12  CERT-CERT.
   593         16  CERT-CERT-PRIME     PIC X(10).
   594         16  CERT-CERT-SUFX      PIC X.
   595
   596 01  NOTE-KEY.
   597     12  NOTE-COMP-CD            PIC X.
   598     12  NOTE-CERT-KEY.
   599         16  NOTE-CARRIER        PIC X.
   600         16  NOTE-GROUP          PIC X(6).
   601         16  NOTE-STATE          PIC XX.
   602         16  NOTE-ACCOUNT        PIC X(10).
   603         16  NOTE-DATE           PIC XX.
   604         16  NOTE-CERT-NO        PIC X(11).
   605
   606 01  TRLR-KEY.
   607     12  TRLR-MAIN-KEY.
   608         16  TRLR-COMPANY-CD     PIC X.
   609         16  TRLR-CARRIER        PIC X.
   610         16  TRLR-CLAIM-NO       PIC X(07).
   611         16  TRLR-CERT-NO        PIC X(11).
   612     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   613
   614 01  BENEFIT-KEY.
   615     12  BEN-CO-ID               PIC X(3).
   616     12  BEN-REC-TYPE            PIC X.
   617     12  FILLER                  PIC XX.
   618     12  BEN-ACC-CD              PIC XX.
   619     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   620
   621 01  CNTL-KEY.
   622     12  CNTL-CO-ID              PIC X(3).
   623     12  CNTL-REC-TYPE           PIC X.
   624     12  CNTL-PROC-ID            PIC X(4).
   625     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   626         16  CNTL-STATE-NUMBER   PIC XX.
   627         16  FILLER              PIC XX.
   628     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   629         16  FILLER              PIC X(3).
   630         16  CNTL-CARRIER        PIC X.
   631     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   632
   633 01  ACTQ-KEY                    PIC X(20).
   634
   635 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   636
   637 01  CHKQ-KEY.
   638     12  CHKQ-COMPANY-CODE       PIC X.
   639     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   640     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   641
   642 01  ARCH-KEY.
   643     12  ARCH-COMPANY-CODE       PIC X.
   644     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   645     12  ARCH-RECORD-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  15
* EL131.cbl
   646     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   647
   648 01  ACCT-KEY.
   649     05  ACCT-PARTIAL-KEY.
   650         12  ACCT-COMPANY-CODE   PIC X.
   651         12  ACCT-CARRIER        PIC X.
   652         12  ACCT-GROUP          PIC X(6).
   653         12  ACCT-STATE          PIC XX.
   654         12  ACCT-ACCOUNT        PIC X(10).
   655     05  ACCT-DATE               PIC XX.
   656
   657 01  WS-ELBENE-KEY.
   658     12  WS-ELBENE-COMPANY-CD    PIC X.
   659     12  WS-ELBENE-RECORD-TYPE   PIC X.
   660     12  WS-ELBENE-ID            PIC X(10).
   661
   662 01  ELALPH-KEY.
   663     12  ELALPH-COMPANY-CD       PIC X.
   664     12  ELALPH-SOURCE           PIC X.
   665     12  ELALPH-NAME.
   666         16  ELALPH-LAST-NAME    PIC X(15).
   667         16  ELALPH-FIRST-NAME.
   668             20  ELALPH-FIRST-INIT   PIC X.
   669             20  FILLER              PIC X(11).
   670         16  ELALPH-MIDDLE-INIT  PIC X.
   671     12  ELALPH-DATE             PIC X(08).
   672     12  ELALPH-TIME             PIC S9(04)    COMP.
   673
   674 01  COMP-LENGTHS.
   675     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   676     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   677     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   678     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   679     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   680     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   681     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   682     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   683     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   684     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   685     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   686     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   687     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   688     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  16
* EL131.cbl
   690*                                COPY ELCLNKLT.
   691******************************************************************
   692*                                                                *
   693*                                                                *
   694*                           ELCLNKLT                             *
   695*                            VMOD=2.003                          *
   696*                                                                *
   697*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   698*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   699*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   700*                                                                *
   701*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   702*   COMPLETING THE REQUIRED FIELDS.                              *
   703*                                                                *
   704*   THE CALLING PROGRAM SHOULD CHECK:                            *
   705*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   706*                              9999 INDICATES AN UNKNOWN ABEND   *
   707*                                   WAS DETECTED.                *
   708*                              ALL OTHER VALUES ARE NORMAL ERROR *
   709*                              CODES FOUND IN THE ERROR FILE.    *
   710******************************************************************
   711 01  W-1523-LINKDATA.
   712     12  W-1523-COMMON-PI-DATA.
   713         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   714         16  FILLER              PIC  X(67).
   715         16  W-1523-COMPANY-CD   PIC  X(01).
   716         16  FILLER              PIC  X(10).
   717         16  W-1523-CONTROL-IN-PROGRESS.
   718             20  W-1523-CARRIER  PIC  X(01).
   719             20  W-1523-GROUPING PIC  X(06).
   720             20  W-1523-STATE    PIC  X(02).
   721             20  W-1523-ACCOUNT  PIC  X(10).
   722             20  W-1523-CLAIM-CERT-GRP.
   723                 24  W-1523-CLAIM-NO
   724                                 PIC  X(07).
   725                 24  W-1523-CERT-NO.
   726                     28  W-1523-CERT-PRIME
   727                                 PIC  X(10).
   728                     28  W-1523-CERT-SFX
   729                                 PIC  X(01).
   730                 24  W-1523-CERT-EFF-DT
   731                                 PIC  X(02).
   732         16  FILLER              PIC X(265).
   733
   734     12  W-1523-WORK-AREA.
   735         16  W-1523-FORM-NUMBER  PIC  X(04).
   736         16  W-1523-NUMBER-COPIES
   737                                 PIC  9(01).
   738         16  W-1523-ADDR-TYPE    PIC  X(02).
   739         16  W-1523-FOLLOW-UP-DATE
   740                                 PIC  X(02).
   741         16  W-1523-RESEND-DATE  PIC  X(02).
   742         16  W-1523-ERROR-CODE   PIC  9(04).
   743             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   744             88  W-1523-FATAL-ERROR
   745                                    VALUES  0006 0013 0042
   746                                            0154 0168 0169
   747                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  17
* EL131.cbl
   748                                            0179 0186 0281
   749                                            0332 2055 3697
   750                                            3698 3699 3770
   751                                            3771 3772 7675
   752                                            9106 9808 9883
   753                                            9887.
   754             88  W-1523-STOP-ERRORS
   755                                    VALUES  0013 0042 0154
   756                                            0168 0169 0172
   757                                            0281 0332 2055
   758                                            3698 3699 7675
   759                                            9106 9808 9883
   760                                            9999.
   761         16  W-1523-REASON       PIC  X(70).
   762         16  W-1523-ARCHIVE-NUMBER
   763                                 PIC  9(08).
   764     12  W-1523-POINTER-AREA.
   765         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   766         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   767         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   768         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   769         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  18
* EL131.cbl
   771*                                COPY ELCINTF.
   772******************************************************************
   773*                                                                *
   774*                                                                *
   775*                            ELCINTF.                            *
   776*                            VMOD=2.017                          *
   777*                                                                *
   778*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   779*                                                                *
   780*       LENGTH = 1024                                            *
   781*                                                                *
   782******************************************************************
   783*                   C H A N G E   L O G
   784*
   785* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   786*-----------------------------------------------------------------
   787*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   788* EFFECTIVE    NUMBER
   789*-----------------------------------------------------------------
   790* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   791******************************************************************
   792 01  PROGRAM-INTERFACE-BLOCK.
   793     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   794     12  PI-CALLING-PROGRAM              PIC X(8).
   795     12  PI-SAVED-PROGRAM-1              PIC X(8).
   796     12  PI-SAVED-PROGRAM-2              PIC X(8).
   797     12  PI-SAVED-PROGRAM-3              PIC X(8).
   798     12  PI-SAVED-PROGRAM-4              PIC X(8).
   799     12  PI-SAVED-PROGRAM-5              PIC X(8).
   800     12  PI-SAVED-PROGRAM-6              PIC X(8).
   801     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   802     12  PI-COMPANY-ID                   PIC XXX.
   803     12  PI-COMPANY-CD                   PIC X.
   804
   805     12  PI-COMPANY-PASSWORD             PIC X(8).
   806
   807     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   808
   809     12  PI-CONTROL-IN-PROGRESS.
   810         16  PI-CARRIER                  PIC X.
   811         16  PI-GROUPING                 PIC X(6).
   812         16  PI-STATE                    PIC XX.
   813         16  PI-ACCOUNT                  PIC X(10).
   814         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   815                                         PIC X(10).
   816         16  PI-CLAIM-CERT-GRP.
   817             20  PI-CLAIM-NO             PIC X(7).
   818             20  PI-CERT-NO.
   819                 25  PI-CERT-PRIME       PIC X(10).
   820                 25  PI-CERT-SFX         PIC X.
   821             20  PI-CERT-EFF-DT          PIC XX.
   822         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   823             20  PI-PLAN-CODE            PIC X(2).
   824             20  PI-REVISION-NUMBER      PIC X(3).
   825             20  PI-PLAN-EFF-DT          PIC X(2).
   826             20  PI-PLAN-EXP-DT          PIC X(2).
   827             20  FILLER                  PIC X(11).
   828         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  19
* EL131.cbl
   829             20  PI-OE-REFERENCE-1.
   830                 25  PI-OE-REF-1-PRIME   PIC X(18).
   831                 25  PI-OE-REF-1-SUFF    PIC XX.
   832
   833     12  PI-SESSION-IN-PROGRESS          PIC X.
   834         88  CLAIM-SESSION                   VALUE '1'.
   835         88  CREDIT-SESSION                  VALUE '2'.
   836         88  WARRANTY-SESSION                VALUE '3'.
   837         88  MORTGAGE-SESSION                VALUE '4'.
   838         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   839
   840
   841*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   842
   843     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   844     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   845
   846     12  PI-CREDIT-USER                  PIC X.
   847         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   848         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   849
   850     12  PI-CLAIM-USER                   PIC X.
   851         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   852         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   853
   854     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   855         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   856         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   857         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   858         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   859         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   860
   861     12  PI-PROCESSOR-ID                 PIC X(4).
   862
   863     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   864
   865     12  PI-MEMBER-CAPTION               PIC X(10).
   866
   867     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   868         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   869
   870     12  PI-LIFE-OVERRIDE-L1             PIC X.
   871     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   872     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   873     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   874
   875     12  PI-AH-OVERRIDE-L1               PIC X.
   876     12  PI-AH-OVERRIDE-L2               PIC XX.
   877     12  PI-AH-OVERRIDE-L6               PIC X(6).
   878     12  PI-AH-OVERRIDE-L12              PIC X(12).
   879
   880     12  PI-NEW-SYSTEM                   PIC X(2).
   881
   882     12  PI-PRIMARY-CERT-NO              PIC X(11).
   883     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   884         88  PI-USES-PAID-TO                 VALUE '1'.
   885     12  PI-CRDTCRD-SYSTEM.
   886         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  20
* EL131.cbl
   887             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   888             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   889         16  PI-CC-MONTH-END-DT          PIC XX.
   890     12  PI-PROCESSOR-PRINTER            PIC X(4).
   891
   892     12  PI-OE-REFERENCE-2.
   893         16  PI-OE-REF-2-PRIME           PIC X(10).
   894         16  PI-OE-REF-2-SUFF            PIC X.
   895
   896     12  PI-REM-TRM-CALC-OPTION          PIC X.
   897
   898     12  PI-LANGUAGE-TYPE                PIC X.
   899             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   900             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   901             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   902
   903     12  PI-POLICY-LINKAGE-IND           PIC X.
   904         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   905         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   906                                                   LOW-VALUES.
   907
   908     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   909     12  PI-CLAIM-PW-SESSION             PIC X(1).
   910         88  PI-CLAIM-CREDIT                 VALUE '1'.
   911         88  PI-CLAIM-CONVEN                 VALUE '2'.
   912
   913     12  PI-PROCESSOR-CSR-IND            PIC X.
   914         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   915         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   916
   917     12  FILLER                          PIC X(3).
   918
   919     12  PI-SYSTEM-LEVEL                 PIC X(145).
   920
   921     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   922         PI-SYSTEM-LEVEL.
   923
   924         16  PI-ENTRY-CODES.
   925             20  PI-ENTRY-CD-1           PIC X.
   926             20  PI-ENTRY-CD-2           PIC X.
   927
   928         16  PI-RETURN-CODES.
   929             20  PI-RETURN-CD-1          PIC X.
   930             20  PI-RETURN-CD-2          PIC X.
   931
   932         16  PI-UPDATE-STATUS-SAVE.
   933             20  PI-UPDATE-BY            PIC X(4).
   934             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   935
   936         16  PI-LOWER-CASE-LETTERS       PIC X.
   937             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   938
   939*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   940*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   941*            88  CARRIER-CLM-CNTL            VALUE '2'.
   942
   943         16  PI-CERT-ACCESS-CONTROL      PIC X.
   944             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  21
* EL131.cbl
   945             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   946             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   947             88  ACCNT-CNTL                  VALUE '3'.
   948             88  CARR-ACCNT-CNTL             VALUE '4'.
   949
   950         16  PI-PROCESSOR-CAP-LIST.
   951             20  PI-SYSTEM-CONTROLS.
   952                24 PI-SYSTEM-DISPLAY     PIC X.
   953                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   954                24 PI-SYSTEM-MODIFY      PIC X.
   955                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   956             20  FILLER                  PIC XX.
   957             20  PI-DISPLAY-CAP          PIC X.
   958                 88  DISPLAY-CAP             VALUE 'Y'.
   959             20  PI-MODIFY-CAP           PIC X.
   960                 88  MODIFY-CAP              VALUE 'Y'.
   961             20  PI-MSG-AT-LOGON-CAP     PIC X.
   962                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   963             20  PI-FORCE-CAP            PIC X.
   964                 88  FORCE-CAP               VALUE 'Y'.
   965
   966         16  PI-PROGRAM-CONTROLS.
   967             20  PI-PGM-PRINT-OPT        PIC X.
   968             20  PI-PGM-FORMAT-OPT       PIC X.
   969             20  PI-PGM-PROCESS-OPT      PIC X.
   970             20  PI-PGM-TOTALS-OPT       PIC X.
   971
   972         16  PI-HELP-INTERFACE.
   973             20  PI-LAST-ERROR-NO        PIC X(4).
   974             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   975
   976         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   977             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   978
   979         16  PI-CR-CONTROL-IN-PROGRESS.
   980             20  PI-CR-CARRIER           PIC X.
   981             20  PI-CR-GROUPING          PIC X(6).
   982             20  PI-CR-STATE             PIC XX.
   983             20  PI-CR-ACCOUNT           PIC X(10).
   984             20  PI-CR-FIN-RESP          PIC X(10).
   985             20  PI-CR-TYPE              PIC X.
   986
   987         16  PI-CR-BATCH-NUMBER          PIC X(6).
   988
   989         16  PI-CR-MONTH-END-DT          PIC XX.
   990
   991         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   992             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   993             88  PI-ZERO-CARRIER             VALUE '1'.
   994             88  PI-ZERO-GROUPING            VALUE '2'.
   995             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   996
   997         16  PI-CARRIER-SECURITY         PIC X.
   998             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   999
  1000         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1001             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1002             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  22
* EL131.cbl
  1003
  1004         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1005             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1006                                         INDEXED BY PI-ACCESS-NDX
  1007                                         PIC X.
  1008
  1009         16  PI-GA-BILLING-CONTROL       PIC X.
  1010             88  PI-GA-BILLING               VALUE '1'.
  1011
  1012         16  PI-MAIL-PROCESSING          PIC X.
  1013             88  PI-MAIL-YES                 VALUE 'Y'.
  1014
  1015         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1016
  1017         16  PI-AR-SYSTEM.
  1018             20  PI-AR-PROCESSING-CNTL   PIC X.
  1019                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1020             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1021             20  PI-AR-MONTH-END-DT      PIC XX.
  1022
  1023         16  PI-MP-SYSTEM.
  1024             20  PI-MORTGAGE-USER            PIC X.
  1025                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1026                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1027             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1028                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1029                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1030                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1031                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1032                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1033             20  PI-MP-MONTH-END-DT          PIC XX.
  1034             20  PI-MP-REFERENCE-NO.
  1035                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1036                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1037
  1038         16  PI-LABEL-CONTROL            PIC X(01).
  1039             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1040             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1041
  1042         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1043             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1044
  1045         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1046             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1047             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1048
  1049         16  FILLER                      PIC X(14).
  1050
  1051     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1052******************************************************************
  1053     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1054         16  PI-NO-PMTS                    PIC 9(4).
  1055         16  PI-CERT-SWITCH                PIC X.
  1056             88  CREATED-CERT              VALUE '2'.
  1057         16  PI-PREM-TYPE                  PIC X.
  1058         16  PI-SAVE-CERT-NO.
  1059             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1060             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  23
* EL131.cbl
  1061         16  FILLER                        PIC X(46).
  1062         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1063         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1064         16  PI-REC-FOUND-SW               PIC X.
  1065         16  PI-LETTER-SW                  PIC X.
  1066         16  PI-PREV-TRLR-KEY              PIC X(22).
  1067         16  FILLER                        PIC X(547).
  1068
  1069 01  SAVE-RECORD                 PIC X(450).
  1070
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  24
* EL131.cbl
  1072*                                COPY ELCLOGOF SUPPRESS.
  1073******************************************************************
  1074*                                                                *
  1075*                                                                *
  1076*                            ELCLOGOF.                           *
  1077*                            VMOD=2.001                          *
  1078*                                                                *
  1079*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1080*                                                                *
  1081******************************************************************
  1082 01  CLASIC-LOGOFF.
  1083     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1084     12  LOGOFF-TEXT.
  1085         16  FILLER          PIC X(5)    VALUE SPACES.
  1086         16  LOGOFF-MSG.
  1087             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1088             20  FILLER      PIC X       VALUE SPACES.
  1089             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1090         16  FILLER          PIC X(80)
  1091           VALUE '* YOU ARE NOW LOGGED OFF'.
  1092         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1093         16  FILLER          PIC X       VALUE QUOTE.
  1094         16  LOGOFF-SYS-MSG  PIC X(17)
  1095           VALUE 'S CLAS-IC SYSTEM '.
  1096     12  TEXT-MESSAGES.
  1097         16  UNACCESS-MSG    PIC X(29)
  1098             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1099         16  PGMIDERR-MSG    PIC X(17)
  1100             VALUE 'PROGRAM NOT FOUND'.
  1101
  1102*                                COPY ELCATTR SUPPRESS.
  1103******************************************************************
  1104*                                                                *
  1105*                            ELCATTR.                            *
  1106*                            VMOD=2.001                          *
  1107*                                                                *
  1108*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1109*                                                                *
  1110*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1111*                                                                *
  1112*                   POS 1   P=PROTECTED                          *
  1113*                           U=UNPROTECTED                        *
  1114*                           S=ASKIP                              *
  1115*                   POS 2   A=ALPHA/NUMERIC                      *
  1116*                           N=NUMERIC                            *
  1117*                   POS 3   N=NORMAL                             *
  1118*                           B=BRIGHT                             *
  1119*                           D=DARK                               *
  1120*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1121*                           OF=MODIFIED DATA TAG OFF             *
  1122*                                                                *
  1123*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1124******************************************************************
  1125 01  ATTRIBUTE-LIST.
  1126     12  AL-PABOF            PIC X       VALUE 'Y'.
  1127     12  AL-PABON            PIC X       VALUE 'Z'.
  1128     12  AL-PADOF            PIC X       VALUE '%'.
  1129     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  25
* EL131.cbl
  1130     12  AL-PANOF            PIC X       VALUE '-'.
  1131     12  AL-PANON            PIC X       VALUE '/'.
  1132     12  AL-SABOF            PIC X       VALUE '8'.
  1133     12  AL-SABON            PIC X       VALUE '9'.
  1134     12  AL-SADOF            PIC X       VALUE '@'.
  1135     12  AL-SADON            PIC X       VALUE QUOTE.
  1136     12  AL-SANOF            PIC X       VALUE '0'.
  1137     12  AL-SANON            PIC X       VALUE '1'.
  1138     12  AL-UABOF            PIC X       VALUE 'H'.
  1139     12  AL-UABON            PIC X       VALUE 'I'.
  1140     12  AL-UADOF            PIC X       VALUE '<'.
  1141     12  AL-UADON            PIC X       VALUE '('.
  1142     12  AL-UANOF            PIC X       VALUE ' '.
  1143     12  AL-UANON            PIC X       VALUE 'A'.
  1144     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1145     12  AL-UNBON            PIC X       VALUE 'R'.
  1146     12  AL-UNDOF            PIC X       VALUE '*'.
  1147     12  AL-UNDON            PIC X       VALUE ')'.
  1148     12  AL-UNNOF            PIC X       VALUE '&'.
  1149     12  AL-UNNON            PIC X       VALUE 'J'.
  1150
  1151*                                COPY ELCAID SUPPRESS.
  1152******************************************************************
  1153*                                                                *
  1154*                            ELCAID.                             *
  1155*                            VMOD=2.001                          *
  1156*                                                                *
  1157*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1158*                                                                *
  1159*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1160*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1161******************************************************************
  1162
  1163 01  DFHAID.
  1164   02  DFHNULL   PIC  X  VALUE  ' '.
  1165   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1166   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1167   02  DFHPEN    PIC  X  VALUE  '='.
  1168   02  DFHOPID   PIC  X  VALUE  'W'.
  1169   02  DFHPA1    PIC  X  VALUE  '%'.
  1170   02  DFHPA2    PIC  X  VALUE  '>'.
  1171   02  DFHPA3    PIC  X  VALUE  ','.
  1172   02  DFHPF1    PIC  X  VALUE  '1'.
  1173   02  DFHPF2    PIC  X  VALUE  '2'.
  1174   02  DFHPF3    PIC  X  VALUE  '3'.
  1175   02  DFHPF4    PIC  X  VALUE  '4'.
  1176   02  DFHPF5    PIC  X  VALUE  '5'.
  1177   02  DFHPF6    PIC  X  VALUE  '6'.
  1178   02  DFHPF7    PIC  X  VALUE  '7'.
  1179   02  DFHPF8    PIC  X  VALUE  '8'.
  1180   02  DFHPF9    PIC  X  VALUE  '9'.
  1181   02  DFHPF10   PIC  X  VALUE  ':'.
  1182   02  DFHPF11   PIC  X  VALUE  '#'.
  1183   02  DFHPF12   PIC  X  VALUE  '@'.
  1184   02  DFHPF13   PIC  X  VALUE  'A'.
  1185   02  DFHPF14   PIC  X  VALUE  'B'.
  1186   02  DFHPF15   PIC  X  VALUE  'C'.
  1187   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  26
* EL131.cbl
  1188   02  DFHPF17   PIC  X  VALUE  'E'.
  1189   02  DFHPF18   PIC  X  VALUE  'F'.
  1190   02  DFHPF19   PIC  X  VALUE  'G'.
  1191   02  DFHPF20   PIC  X  VALUE  'H'.
  1192   02  DFHPF21   PIC  X  VALUE  'I'.
  1193*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1194   02  DFHPF22   PIC  X  VALUE  '['.
  1195   02  DFHPF23   PIC  X  VALUE  '.'.
  1196   02  DFHPF24   PIC  X  VALUE  '<'.
  1197   02  DFHMSRE   PIC  X  VALUE  'X'.
  1198   02  DFHSTRF   PIC  X  VALUE  'h'.
  1199   02  DFHTRIG   PIC  X  VALUE  '"'.
  1200 01  FILLER REDEFINES DFHAID.
  1201     12  FILLER                  PIC X(8).
  1202     12  AID-KEYS OCCURS 24 TIMES.
  1203         16  FILLER              PIC X.
  1204
  1205*                                COPY EL131S.
  1206 01  EL131AI.
  1207     05  FILLER            PIC  X(0012).
  1208*    -------------------------------
  1209     05  DATEL PIC S9(0004) COMP.
  1210     05  DATEF PIC  X(0001).
  1211     05  FILLER REDEFINES DATEF.
  1212         10  DATEA PIC  X(0001).
  1213     05  DATEI PIC  X(0008).
  1214*    -------------------------------
  1215     05  TIMEL PIC S9(0004) COMP.
  1216     05  TIMEF PIC  X(0001).
  1217     05  FILLER REDEFINES TIMEF.
  1218         10  TIMEA PIC  X(0001).
  1219     05  TIMEI PIC  X(0005).
  1220*    -------------------------------
  1221     05  SEQUL PIC S9(0004) COMP.
  1222     05  SEQUF PIC  X(0001).
  1223     05  FILLER REDEFINES SEQUF.
  1224         10  SEQUA PIC  X(0001).
  1225     05  SEQUI PIC  X(0010).
  1226*    -------------------------------
  1227     05  COMPL PIC S9(0004) COMP.
  1228     05  COMPF PIC  X(0001).
  1229     05  FILLER REDEFINES COMPF.
  1230         10  COMPA PIC  X(0001).
  1231     05  COMPI PIC  X(0003).
  1232*    -------------------------------
  1233     05  USERIDL PIC S9(0004) COMP.
  1234     05  USERIDF PIC  X(0001).
  1235     05  FILLER REDEFINES USERIDF.
  1236         10  USERIDA PIC  X(0001).
  1237     05  USERIDI PIC  X(0004).
  1238*    -------------------------------
  1239     05  CCNOL PIC S9(0004) COMP.
  1240     05  CCNOF PIC  X(0001).
  1241     05  FILLER REDEFINES CCNOF.
  1242         10  CCNOA PIC  X(0001).
  1243     05  CCNOI PIC  X(0016).
  1244*    -------------------------------
  1245     05  MAINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  27
* EL131.cbl
  1246     05  MAINTF PIC  X(0001).
  1247     05  FILLER REDEFINES MAINTF.
  1248         10  MAINTA PIC  X(0001).
  1249     05  MAINTI PIC  X(0001).
  1250*    -------------------------------
  1251     05  CLAIML PIC S9(0004) COMP.
  1252     05  CLAIMF PIC  X(0001).
  1253     05  FILLER REDEFINES CLAIMF.
  1254         10  CLAIMA PIC  X(0001).
  1255     05  CLAIMI PIC  X(0007).
  1256*    -------------------------------
  1257     05  CARRL PIC S9(0004) COMP.
  1258     05  CARRF PIC  X(0001).
  1259     05  FILLER REDEFINES CARRF.
  1260         10  CARRA PIC  X(0001).
  1261     05  CARRI PIC  X(0001).
  1262*    -------------------------------
  1263     05  CERTL PIC S9(0004) COMP.
  1264     05  CERTF PIC  X(0001).
  1265     05  FILLER REDEFINES CERTF.
  1266         10  CERTA PIC  X(0001).
  1267     05  CERTI PIC  X(0010).
  1268*    -------------------------------
  1269     05  SUFXL PIC S9(0004) COMP.
  1270     05  SUFXF PIC  X(0001).
  1271     05  FILLER REDEFINES SUFXF.
  1272         10  SUFXA PIC  X(0001).
  1273     05  SUFXI PIC  X(0001).
  1274*    -------------------------------
  1275     05  TYPEL PIC S9(0004) COMP.
  1276     05  TYPEF PIC  X(0001).
  1277     05  FILLER REDEFINES TYPEF.
  1278         10  TYPEA PIC  X(0001).
  1279     05  TYPEI PIC  X(0001).
  1280*    -------------------------------
  1281     05  LABEL1L PIC S9(0004) COMP.
  1282     05  LABEL1F PIC  X(0001).
  1283     05  FILLER REDEFINES LABEL1F.
  1284         10  LABEL1A PIC  X(0001).
  1285     05  LABEL1I PIC  X(0011).
  1286*    -------------------------------
  1287     05  PCERTNOL PIC S9(0004) COMP.
  1288     05  PCERTNOF PIC  X(0001).
  1289     05  FILLER REDEFINES PCERTNOF.
  1290         10  PCERTNOA PIC  X(0001).
  1291     05  PCERTNOI PIC  X(0010).
  1292*    -------------------------------
  1293     05  PSUFXL PIC S9(0004) COMP.
  1294     05  PSUFXF PIC  X(0001).
  1295     05  FILLER REDEFINES PSUFXF.
  1296         10  PSUFXA PIC  X(0001).
  1297     05  PSUFXI PIC  X(0001).
  1298*    -------------------------------
  1299     05  STATUSL PIC S9(0004) COMP.
  1300     05  STATUSF PIC  X(0001).
  1301     05  FILLER REDEFINES STATUSF.
  1302         10  STATUSA PIC  X(0001).
  1303     05  STATUSI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  28
* EL131.cbl
  1304*    -------------------------------
  1305     05  INCL PIC S9(0004) COMP.
  1306     05  INCF PIC  X(0001).
  1307     05  FILLER REDEFINES INCF.
  1308         10  INCA PIC  X(0001).
  1309     05  INCI PIC  X(0008).
  1310*    -------------------------------
  1311     05  REPL PIC S9(0004) COMP.
  1312     05  REPF PIC  X(0001).
  1313     05  FILLER REDEFINES REPF.
  1314         10  REPA PIC  X(0001).
  1315     05  REPI PIC  X(0008).
  1316*    -------------------------------
  1317     05  CAUSEL PIC S9(0004) COMP.
  1318     05  CAUSEF PIC  X(0001).
  1319     05  FILLER REDEFINES CAUSEF.
  1320         10  CAUSEA PIC  X(0001).
  1321     05  CAUSEI PIC  X(0006).
  1322*    -------------------------------
  1323     05  ENDL PIC S9(0004) COMP.
  1324     05  ENDF PIC  X(0001).
  1325     05  FILLER REDEFINES ENDF.
  1326         10  ENDA PIC  X(0001).
  1327     05  ENDI PIC  X(0008).
  1328*    -------------------------------
  1329     05  DIAGL PIC S9(0004) COMP.
  1330     05  DIAGF PIC  X(0001).
  1331     05  FILLER REDEFINES DIAGF.
  1332         10  DIAGA PIC  X(0001).
  1333     05  DIAGI PIC  X(0060).
  1334*    -------------------------------
  1335     05  BENEL PIC S9(0004) COMP.
  1336     05  BENEF PIC  X(0001).
  1337     05  FILLER REDEFINES BENEF.
  1338         10  BENEA PIC  X(0001).
  1339     05  BENEI PIC  X(0010).
  1340*    -------------------------------
  1341     05  BIRTHL PIC S9(0004) COMP.
  1342     05  BIRTHF PIC  X(0001).
  1343     05  FILLER REDEFINES BIRTHF.
  1344         10  BIRTHA PIC  X(0001).
  1345     05  BIRTHI PIC  X(0008).
  1346*    -------------------------------
  1347     05  SOCIALL PIC S9(0004) COMP.
  1348     05  SOCIALF PIC  X(0001).
  1349     05  FILLER REDEFINES SOCIALF.
  1350         10  SOCIALA PIC  X(0001).
  1351     05  SOCIALI PIC  X(0011).
  1352*    -------------------------------
  1353     05  SEXL PIC S9(0004) COMP.
  1354     05  SEXF PIC  X(0001).
  1355     05  FILLER REDEFINES SEXF.
  1356         10  SEXA PIC  X(0001).
  1357     05  SEXI PIC  X(0001).
  1358*    -------------------------------
  1359     05  MLNAMEL PIC S9(0004) COMP.
  1360     05  MLNAMEF PIC  X(0001).
  1361     05  FILLER REDEFINES MLNAMEF.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  29
* EL131.cbl
  1362         10  MLNAMEA PIC  X(0001).
  1363     05  MLNAMEI PIC  X(0015).
  1364*    -------------------------------
  1365     05  MFNAMEL PIC S9(0004) COMP.
  1366     05  MFNAMEF PIC  X(0001).
  1367     05  FILLER REDEFINES MFNAMEF.
  1368         10  MFNAMEA PIC  X(0001).
  1369     05  MFNAMEI PIC  X(0012).
  1370*    -------------------------------
  1371     05  MMINITL PIC S9(0004) COMP.
  1372     05  MMINITF PIC  X(0001).
  1373     05  FILLER REDEFINES MMINITF.
  1374         10  MMINITA PIC  X(0001).
  1375     05  MMINITI PIC  X(0001).
  1376*    -------------------------------
  1377     05  LOANNOL PIC S9(0004) COMP.
  1378     05  LOANNOF PIC  X(0001).
  1379     05  FILLER REDEFINES LOANNOF.
  1380         10  LOANNOA PIC  X(0001).
  1381     05  LOANNOI PIC  X(0008).
  1382*    -------------------------------
  1383     05  CRTLNMEL PIC S9(0004) COMP.
  1384     05  CRTLNMEF PIC  X(0001).
  1385     05  FILLER REDEFINES CRTLNMEF.
  1386         10  CRTLNMEA PIC  X(0001).
  1387     05  CRTLNMEI PIC  X(0015).
  1388*    -------------------------------
  1389     05  CRTFNMEL PIC S9(0004) COMP.
  1390     05  CRTFNMEF PIC  X(0001).
  1391     05  FILLER REDEFINES CRTFNMEF.
  1392         10  CRTFNMEA PIC  X(0001).
  1393     05  CRTFNMEI PIC  X(0012).
  1394*    -------------------------------
  1395     05  CRTINITL PIC S9(0004) COMP.
  1396     05  CRTINITF PIC  X(0001).
  1397     05  FILLER REDEFINES CRTINITF.
  1398         10  CRTINITA PIC  X(0001).
  1399     05  CRTINITI PIC  X(0001).
  1400*    -------------------------------
  1401     05  LOANBALL PIC S9(0004) COMP.
  1402     05  LOANBALF PIC  X(0001).
  1403     05  FILLER REDEFINES LOANBALF.
  1404         10  LOANBALA PIC  X(0001).
  1405     05  LOANBALI PIC  9(7)V99.
  1406*    -------------------------------
  1407     05  PROCL PIC S9(0004) COMP.
  1408     05  PROCF PIC  X(0001).
  1409     05  FILLER REDEFINES PROCF.
  1410         10  PROCA PIC  X(0001).
  1411     05  PROCI PIC  X(0004).
  1412*    -------------------------------
  1413     05  SUPVL PIC S9(0004) COMP.
  1414     05  SUPVF PIC  X(0001).
  1415     05  FILLER REDEFINES SUPVF.
  1416         10  SUPVA PIC  X(0001).
  1417     05  SUPVI PIC  X(0001).
  1418*    -------------------------------
  1419     05  PRICDL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  30
* EL131.cbl
  1420     05  PRICDF PIC  X(0001).
  1421     05  FILLER REDEFINES PRICDF.
  1422         10  PRICDA PIC  X(0001).
  1423     05  PRICDI PIC  X(0001).
  1424*    -------------------------------
  1425     05  FILETOL PIC S9(0004) COMP.
  1426     05  FILETOF PIC  X(0001).
  1427     05  FILLER REDEFINES FILETOF.
  1428         10  FILETOA PIC  X(0001).
  1429     05  FILETOI PIC  X(0004).
  1430*    -------------------------------
  1431     05  PTHRHDGL PIC S9(0004) COMP.
  1432     05  PTHRHDGF PIC  X(0001).
  1433     05  FILLER REDEFINES PTHRHDGF.
  1434         10  PTHRHDGA PIC  X(0001).
  1435     05  PTHRHDGI PIC  X(0010).
  1436*    -------------------------------
  1437     05  PDTHRUL PIC S9(0004) COMP.
  1438     05  PDTHRUF PIC  X(0001).
  1439     05  FILLER REDEFINES PDTHRUF.
  1440         10  PDTHRUA PIC  X(0001).
  1441     05  PDTHRUI PIC  X(0008).
  1442*    -------------------------------
  1443     05  PDAMTL PIC S9(0004) COMP.
  1444     05  PDAMTF PIC  X(0001).
  1445     05  FILLER REDEFINES PDAMTF.
  1446         10  PDAMTA PIC  X(0001).
  1447     05  PDAMTI PIC  9(7)V99.
  1448*    -------------------------------
  1449     05  NODAYSL PIC S9(0004) COMP.
  1450     05  NODAYSF PIC  X(0001).
  1451     05  FILLER REDEFINES NODAYSF.
  1452         10  NODAYSA PIC  X(0001).
  1453     05  NODAYSI PIC  9(5).
  1454*    -------------------------------
  1455     05  NOPMTSL PIC S9(0004) COMP.
  1456     05  NOPMTSF PIC  X(0001).
  1457     05  FILLER REDEFINES NOPMTSF.
  1458         10  NOPMTSA PIC  X(0001).
  1459     05  NOPMTSI PIC  9(4).
  1460*    -------------------------------
  1461     05  FORMTYPL PIC S9(0004) COMP.
  1462     05  FORMTYPF PIC  X(0001).
  1463     05  FILLER REDEFINES FORMTYPF.
  1464         10  FORMTYPA PIC  X(0001).
  1465     05  FORMTYPI PIC  X(0001).
  1466*    -------------------------------
  1467     05  ESTL PIC S9(0004) COMP.
  1468     05  ESTF PIC  X(0001).
  1469     05  FILLER REDEFINES ESTF.
  1470         10  ESTA PIC  X(0001).
  1471     05  ESTI PIC  X(0008).
  1472*    -------------------------------
  1473     05  AUIDL PIC S9(0004) COMP.
  1474     05  AUIDF PIC  X(0001).
  1475     05  FILLER REDEFINES AUIDF.
  1476         10  AUIDA PIC  X(0001).
  1477     05  AUIDI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  31
* EL131.cbl
  1478*    -------------------------------
  1479     05  OCCL PIC S9(0004) COMP.
  1480     05  OCCF PIC  X(0001).
  1481     05  FILLER REDEFINES OCCF.
  1482         10  OCCA PIC  X(0001).
  1483     05  OCCI PIC  X(0006).
  1484*    -------------------------------
  1485     05  MNTDTL PIC S9(0004) COMP.
  1486     05  MNTDTF PIC  X(0001).
  1487     05  FILLER REDEFINES MNTDTF.
  1488         10  MNTDTA PIC  X(0001).
  1489     05  MNTDTI PIC  X(0008).
  1490*    -------------------------------
  1491     05  MNTTYPEL PIC S9(0004) COMP.
  1492     05  MNTTYPEF PIC  X(0001).
  1493     05  FILLER REDEFINES MNTTYPEF.
  1494         10  MNTTYPEA PIC  X(0001).
  1495     05  MNTTYPEI PIC  X(0006).
  1496*    -------------------------------
  1497     05  CERTCARL PIC S9(0004) COMP.
  1498     05  CERTCARF PIC  X(0001).
  1499     05  FILLER REDEFINES CERTCARF.
  1500         10  CERTCARA PIC  X(0001).
  1501     05  CERTCARI PIC  X(0001).
  1502*    -------------------------------
  1503     05  CERTGRPL PIC S9(0004) COMP.
  1504     05  CERTGRPF PIC  X(0001).
  1505     05  FILLER REDEFINES CERTGRPF.
  1506         10  CERTGRPA PIC  X(0001).
  1507     05  CERTGRPI PIC  X(0006).
  1508*    -------------------------------
  1509     05  CERTSTL PIC S9(0004) COMP.
  1510     05  CERTSTF PIC  X(0001).
  1511     05  FILLER REDEFINES CERTSTF.
  1512         10  CERTSTA PIC  X(0001).
  1513     05  CERTSTI PIC  X(0002).
  1514*    -------------------------------
  1515     05  CERTACTL PIC S9(0004) COMP.
  1516     05  CERTACTF PIC  X(0001).
  1517     05  FILLER REDEFINES CERTACTF.
  1518         10  CERTACTA PIC  X(0001).
  1519     05  CERTACTI PIC  X(0010).
  1520*    -------------------------------
  1521     05  CERTEFFL PIC S9(0004) COMP.
  1522     05  CERTEFFF PIC  X(0001).
  1523     05  FILLER REDEFINES CERTEFFF.
  1524         10  CERTEFFA PIC  X(0001).
  1525     05  CERTEFFI PIC  X(0008).
  1526*    -------------------------------
  1527     05  ISSAGEL PIC S9(0004) COMP.
  1528     05  ISSAGEF PIC  X(0001).
  1529     05  FILLER REDEFINES ISSAGEF.
  1530         10  ISSAGEA PIC  X(0001).
  1531     05  ISSAGEI PIC  X(0002).
  1532*    -------------------------------
  1533     05  APRL PIC S9(0004) COMP.
  1534     05  APRF PIC  X(0001).
  1535     05  FILLER REDEFINES APRF.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  32
* EL131.cbl
  1536         10  APRA PIC  X(0001).
  1537     05  APRI PIC  9(4)V9(4).
  1538*    -------------------------------
  1539     05  PMTFREQL PIC S9(0004) COMP.
  1540     05  PMTFREQF PIC  X(0001).
  1541     05  FILLER REDEFINES PMTFREQF.
  1542         10  PMTFREQA PIC  X(0001).
  1543     05  PMTFREQI PIC  99.
  1544*    -------------------------------
  1545     05  INDGRPL PIC S9(0004) COMP.
  1546     05  INDGRPF PIC  X(0001).
  1547     05  FILLER REDEFINES INDGRPF.
  1548         10  INDGRPA PIC  X(0001).
  1549     05  INDGRPI PIC  X(0001).
  1550*    -------------------------------
  1551     05  PREMTYPL PIC S9(0004) COMP.
  1552     05  PREMTYPF PIC  X(0001).
  1553     05  FILLER REDEFINES PREMTYPF.
  1554         10  PREMTYPA PIC  X(0001).
  1555     05  PREMTYPI PIC  X(0001).
  1556*    -------------------------------
  1557     05  REINCDL PIC S9(0004) COMP.
  1558     05  REINCDF PIC  X(0001).
  1559     05  FILLER REDEFINES REINCDF.
  1560         10  REINCDA PIC  X(0001).
  1561     05  REINCDI PIC  X(0001).
  1562*    -------------------------------
  1563     05  JNTLNMEL PIC S9(0004) COMP.
  1564     05  JNTLNMEF PIC  X(0001).
  1565     05  FILLER REDEFINES JNTLNMEF.
  1566         10  JNTLNMEA PIC  X(0001).
  1567     05  JNTLNMEI PIC  X(0015).
  1568*    -------------------------------
  1569     05  JNTFNMEL PIC S9(0004) COMP.
  1570     05  JNTFNMEF PIC  X(0001).
  1571     05  FILLER REDEFINES JNTFNMEF.
  1572         10  JNTFNMEA PIC  X(0001).
  1573     05  JNTFNMEI PIC  X(0012).
  1574*    -------------------------------
  1575     05  JNTINITL PIC S9(0004) COMP.
  1576     05  JNTINITF PIC  X(0001).
  1577     05  FILLER REDEFINES JNTINITF.
  1578         10  JNTINITA PIC  X(0001).
  1579     05  JNTINITI PIC  X(0001).
  1580*    -------------------------------
  1581     05  JNTAGEL PIC S9(0004) COMP.
  1582     05  JNTAGEF PIC  X(0001).
  1583     05  FILLER REDEFINES JNTAGEF.
  1584         10  JNTAGEA PIC  X(0001).
  1585     05  JNTAGEI PIC  X(0002).
  1586*    -------------------------------
  1587     05  ADDONDTL PIC S9(0004) COMP.
  1588     05  ADDONDTF PIC  X(0001).
  1589     05  FILLER REDEFINES ADDONDTF.
  1590         10  ADDONDTA PIC  X(0001).
  1591     05  ADDONDTI PIC  X(0008).
  1592*    -------------------------------
  1593     05  LCVDSCRL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  33
* EL131.cbl
  1594     05  LCVDSCRF PIC  X(0001).
  1595     05  FILLER REDEFINES LCVDSCRF.
  1596         10  LCVDSCRA PIC  X(0001).
  1597     05  LCVDSCRI PIC  X(0006).
  1598*    -------------------------------
  1599     05  LCVKINDL PIC S9(0004) COMP.
  1600     05  LCVKINDF PIC  X(0001).
  1601     05  FILLER REDEFINES LCVKINDF.
  1602         10  LCVKINDA PIC  X(0001).
  1603     05  LCVKINDI PIC  X(0003).
  1604*    -------------------------------
  1605     05  LCVCDL PIC S9(0004) COMP.
  1606     05  LCVCDF PIC  X(0001).
  1607     05  FILLER REDEFINES LCVCDF.
  1608         10  LCVCDA PIC  X(0001).
  1609     05  LCVCDI PIC  X(0002).
  1610*    -------------------------------
  1611     05  LCVOTRML PIC S9(0004) COMP.
  1612     05  LCVOTRMF PIC  X(0001).
  1613     05  FILLER REDEFINES LCVOTRMF.
  1614         10  LCVOTRMA PIC  X(0001).
  1615     05  LCVOTRMI PIC  999.
  1616*    -------------------------------
  1617     05  LCVRTRML PIC S9(0004) COMP.
  1618     05  LCVRTRMF PIC  X(0001).
  1619     05  FILLER REDEFINES LCVRTRMF.
  1620         10  LCVRTRMA PIC  X(0001).
  1621     05  LCVRTRMI PIC  X(0003).
  1622*    -------------------------------
  1623     05  LCVRATEL PIC S9(0004) COMP.
  1624     05  LCVRATEF PIC  X(0001).
  1625     05  FILLER REDEFINES LCVRATEF.
  1626         10  LCVRATEA PIC  X(0001).
  1627     05  LCVRATEI PIC  9999V99.
  1628*    -------------------------------
  1629     05  LCVBENEL PIC S9(0004) COMP.
  1630     05  LCVBENEF PIC  X(0001).
  1631     05  FILLER REDEFINES LCVBENEF.
  1632         10  LCVBENEA PIC  X(0001).
  1633     05  LCVBENEI PIC  9(9)V99.
  1634*    -------------------------------
  1635     05  LCVFORML PIC S9(0004) COMP.
  1636     05  LCVFORMF PIC  X(0001).
  1637     05  FILLER REDEFINES LCVFORMF.
  1638         10  LCVFORMA PIC  X(0001).
  1639     05  LCVFORMI PIC  X(0012).
  1640*    -------------------------------
  1641     05  LCVCNDTL PIC S9(0004) COMP.
  1642     05  LCVCNDTF PIC  X(0001).
  1643     05  FILLER REDEFINES LCVCNDTF.
  1644         10  LCVCNDTA PIC  X(0001).
  1645     05  LCVCNDTI PIC  X(0008).
  1646*    -------------------------------
  1647     05  LCVEXITL PIC S9(0004) COMP.
  1648     05  LCVEXITF PIC  X(0001).
  1649     05  FILLER REDEFINES LCVEXITF.
  1650         10  LCVEXITA PIC  X(0001).
  1651     05  LCVEXITI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  34
* EL131.cbl
  1652*    -------------------------------
  1653     05  LCVSTATL PIC S9(0004) COMP.
  1654     05  LCVSTATF PIC  X(0001).
  1655     05  FILLER REDEFINES LCVSTATF.
  1656         10  LCVSTATA PIC  X(0001).
  1657     05  LCVSTATI PIC  X(0006).
  1658*    -------------------------------
  1659     05  ACVDSCRL PIC S9(0004) COMP.
  1660     05  ACVDSCRF PIC  X(0001).
  1661     05  FILLER REDEFINES ACVDSCRF.
  1662         10  ACVDSCRA PIC  X(0001).
  1663     05  ACVDSCRI PIC  X(0006).
  1664*    -------------------------------
  1665     05  ACVKINDL PIC S9(0004) COMP.
  1666     05  ACVKINDF PIC  X(0001).
  1667     05  FILLER REDEFINES ACVKINDF.
  1668         10  ACVKINDA PIC  X(0001).
  1669     05  ACVKINDI PIC  X(0003).
  1670*    -------------------------------
  1671     05  ACVCDL PIC S9(0004) COMP.
  1672     05  ACVCDF PIC  X(0001).
  1673     05  FILLER REDEFINES ACVCDF.
  1674         10  ACVCDA PIC  X(0001).
  1675     05  ACVCDI PIC  X(0002).
  1676*    -------------------------------
  1677     05  ACVOTRML PIC S9(0004) COMP.
  1678     05  ACVOTRMF PIC  X(0001).
  1679     05  FILLER REDEFINES ACVOTRMF.
  1680         10  ACVOTRMA PIC  X(0001).
  1681     05  ACVOTRMI PIC  999.
  1682*    -------------------------------
  1683     05  ACVRTRML PIC S9(0004) COMP.
  1684     05  ACVRTRMF PIC  X(0001).
  1685     05  FILLER REDEFINES ACVRTRMF.
  1686         10  ACVRTRMA PIC  X(0001).
  1687     05  ACVRTRMI PIC  X(0003).
  1688*    -------------------------------
  1689     05  ACVRATEL PIC S9(0004) COMP.
  1690     05  ACVRATEF PIC  X(0001).
  1691     05  FILLER REDEFINES ACVRATEF.
  1692         10  ACVRATEA PIC  X(0001).
  1693     05  ACVRATEI PIC  9999V99.
  1694*    -------------------------------
  1695     05  ACVBENEL PIC S9(0004) COMP.
  1696     05  ACVBENEF PIC  X(0001).
  1697     05  FILLER REDEFINES ACVBENEF.
  1698         10  ACVBENEA PIC  X(0001).
  1699     05  ACVBENEI PIC  9(9)V99.
  1700*    -------------------------------
  1701     05  ACVFORML PIC S9(0004) COMP.
  1702     05  ACVFORMF PIC  X(0001).
  1703     05  FILLER REDEFINES ACVFORMF.
  1704         10  ACVFORMA PIC  X(0001).
  1705     05  ACVFORMI PIC  X(0012).
  1706*    -------------------------------
  1707     05  ACVCNDTL PIC S9(0004) COMP.
  1708     05  ACVCNDTF PIC  X(0001).
  1709     05  FILLER REDEFINES ACVCNDTF.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  35
* EL131.cbl
  1710         10  ACVCNDTA PIC  X(0001).
  1711     05  ACVCNDTI PIC  X(0008).
  1712*    -------------------------------
  1713     05  ACVEXITL PIC S9(0004) COMP.
  1714     05  ACVEXITF PIC  X(0001).
  1715     05  FILLER REDEFINES ACVEXITF.
  1716         10  ACVEXITA PIC  X(0001).
  1717     05  ACVEXITI PIC  X(0008).
  1718*    -------------------------------
  1719     05  ACVSTATL PIC S9(0004) COMP.
  1720     05  ACVSTATF PIC  X(0001).
  1721     05  FILLER REDEFINES ACVSTATF.
  1722         10  ACVSTATA PIC  X(0001).
  1723     05  ACVSTATI PIC  X(0006).
  1724*    -------------------------------
  1725     05  DAYSPL PIC S9(0004) COMP.
  1726     05  DAYSPF PIC  X(0001).
  1727     05  FILLER REDEFINES DAYSPF.
  1728         10  DAYSPA PIC  X(0001).
  1729     05  DAYSPI PIC  X(0003).
  1730*    -------------------------------
  1731     05  LABEL2L PIC S9(0004) COMP.
  1732     05  LABEL2F PIC  X(0001).
  1733     05  FILLER REDEFINES LABEL2F.
  1734         10  LABEL2A PIC  X(0001).
  1735     05  LABEL2I PIC  X(0014).
  1736*    -------------------------------
  1737     05  BCERT1L PIC S9(0004) COMP.
  1738     05  BCERT1F PIC  X(0001).
  1739     05  FILLER REDEFINES BCERT1F.
  1740         10  BCERT1A PIC  X(0001).
  1741     05  BCERT1I PIC  X(0010).
  1742*    -------------------------------
  1743     05  BSUFX1L PIC S9(0004) COMP.
  1744     05  BSUFX1F PIC  X(0001).
  1745     05  FILLER REDEFINES BSUFX1F.
  1746         10  BSUFX1A PIC  X(0001).
  1747     05  BSUFX1I PIC  X(0001).
  1748*    -------------------------------
  1749     05  BCERT2L PIC S9(0004) COMP.
  1750     05  BCERT2F PIC  X(0001).
  1751     05  FILLER REDEFINES BCERT2F.
  1752         10  BCERT2A PIC  X(0001).
  1753     05  BCERT2I PIC  X(0010).
  1754*    -------------------------------
  1755     05  BSUFX2L PIC S9(0004) COMP.
  1756     05  BSUFX2F PIC  X(0001).
  1757     05  FILLER REDEFINES BSUFX2F.
  1758         10  BSUFX2A PIC  X(0001).
  1759     05  BSUFX2I PIC  X(0001).
  1760*    -------------------------------
  1761     05  BCERT3L PIC S9(0004) COMP.
  1762     05  BCERT3F PIC  X(0001).
  1763     05  FILLER REDEFINES BCERT3F.
  1764         10  BCERT3A PIC  X(0001).
  1765     05  BCERT3I PIC  X(0010).
  1766*    -------------------------------
  1767     05  BSUFX3L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  36
* EL131.cbl
  1768     05  BSUFX3F PIC  X(0001).
  1769     05  FILLER REDEFINES BSUFX3F.
  1770         10  BSUFX3A PIC  X(0001).
  1771     05  BSUFX3I PIC  X(0001).
  1772*    -------------------------------
  1773     05  BCERT4L PIC S9(0004) COMP.
  1774     05  BCERT4F PIC  X(0001).
  1775     05  FILLER REDEFINES BCERT4F.
  1776         10  BCERT4A PIC  X(0001).
  1777     05  BCERT4I PIC  X(0010).
  1778*    -------------------------------
  1779     05  BSUFX4L PIC S9(0004) COMP.
  1780     05  BSUFX4F PIC  X(0001).
  1781     05  FILLER REDEFINES BSUFX4F.
  1782         10  BSUFX4A PIC  X(0001).
  1783     05  BSUFX4I PIC  X(0001).
  1784*    -------------------------------
  1785     05  BCERT5L PIC S9(0004) COMP.
  1786     05  BCERT5F PIC  X(0001).
  1787     05  FILLER REDEFINES BCERT5F.
  1788         10  BCERT5A PIC  X(0001).
  1789     05  BCERT5I PIC  X(0010).
  1790*    -------------------------------
  1791     05  BSUFX5L PIC S9(0004) COMP.
  1792     05  BSUFX5F PIC  X(0001).
  1793     05  FILLER REDEFINES BSUFX5F.
  1794         10  BSUFX5A PIC  X(0001).
  1795     05  BSUFX5I PIC  X(0001).
  1796*    -------------------------------
  1797     05  MSG1L PIC S9(0004) COMP.
  1798     05  MSG1F PIC  X(0001).
  1799     05  FILLER REDEFINES MSG1F.
  1800         10  MSG1A PIC  X(0001).
  1801     05  MSG1I PIC  X(0072).
  1802*    -------------------------------
  1803     05  PFKEYL PIC S9(0004) COMP.
  1804     05  PFKEYF PIC  X(0001).
  1805     05  FILLER REDEFINES PFKEYF.
  1806         10  PFKEYA PIC  X(0001).
  1807     05  PFKEYI PIC  99.
  1808*    -------------------------------
  1809     05  PFKEY6L PIC S9(0004) COMP.
  1810     05  PFKEY6F PIC  X(0001).
  1811     05  FILLER REDEFINES PFKEY6F.
  1812         10  PFKEY6A PIC  X(0001).
  1813     05  PFKEY6I PIC  X(0016).
  1814 01  EL131AO REDEFINES EL131AI.
  1815     05  FILLER            PIC  X(0012).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  DATEO PIC  X(0008).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  TIMEO PIC  99.99.
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  SEQUO PIC  X(0010).
  1825*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  37
* EL131.cbl
  1826     05  FILLER            PIC  X(0003).
  1827     05  COMPO PIC  X(0003).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  USERIDO PIC  X(0004).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  CCNOO PIC  X(0016).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  MAINTO PIC  X(0001).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  CLAIMO PIC  X(0007).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  CARRO PIC  X(0001).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  CERTO PIC  X(0010).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  SUFXO PIC  X(0001).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  TYPEO PIC  X(0001).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  LABEL1O PIC  X(0011).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  PCERTNOO PIC  X(0010).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  PSUFXO PIC  X(0001).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  STATUSO PIC  X(0006).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  INCO PIC  X(0008).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  REPO PIC  X(0008).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  CAUSEO PIC  X(0006).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  ENDO PIC  X(0008).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  DIAGO PIC  X(0060).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  BENEO PIC  X(0010).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  38
* EL131.cbl
  1884     05  BIRTHO PIC  X(0008).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  SOCIALO PIC  X(0011).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  SEXO PIC  X(0001).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  MLNAMEO PIC  X(0015).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  MFNAMEO PIC  X(0012).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  MMINITO PIC  X(0001).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  LOANNOO PIC  X(0008).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  CRTLNMEO PIC  X(0015).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  CRTFNMEO PIC  X(0012).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  CRTINITO PIC  X(0001).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  LOANBALO PIC  ZZZZZ9.99.
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  PROCO PIC  X(0004).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  SUPVO PIC  X(0001).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  PRICDO PIC  X(0001).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  FILETOO PIC  X(0004).
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  PTHRHDGO PIC  X(0010).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  PDTHRUO PIC  X(0008).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  PDAMTO PIC  Z(06).99.
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  NODAYSO PIC  ZZZ99.
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  NOPMTSO PIC  ZZ99.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  39
* EL131.cbl
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  FORMTYPO PIC  X(0001).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  ESTO PIC  X(0008).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  AUIDO PIC  X(0004).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  OCCO PIC  X(0006).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  MNTDTO PIC  X(0008).
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  MNTTYPEO PIC  X(0006).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  CERTCARO PIC  X(0001).
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  CERTGRPO PIC  X(0006).
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  CERTSTO PIC  X(0002).
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  CERTACTO PIC  X(0010).
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
  1974     05  CERTEFFO PIC  X(0008).
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  ISSAGEO PIC  X(0002).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  APRO PIC  9(3).9(4).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  PMTFREQO PIC  99.
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
  1986     05  INDGRPO PIC  X(0001).
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  PREMTYPO PIC  X(0001).
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  REINCDO PIC  X(0001).
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  JNTLNMEO PIC  X(0015).
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  JNTFNMEO PIC  X(0012).
  1999*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  40
* EL131.cbl
  2000     05  FILLER            PIC  X(0003).
  2001     05  JNTINITO PIC  X(0001).
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  JNTAGEO PIC  X(0002).
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  ADDONDTO PIC  X(0008).
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  LCVDSCRO PIC  X(0006).
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  LCVKINDO PIC  X(0003).
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  LCVCDO PIC  X(0002).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  LCVOTRMO PIC  999.
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  LCVRTRMO PIC  999.
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  LCVRATEO PIC  ZZZ.ZZ.
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  LCVFORMO PIC  X(0012).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  LCVCNDTO PIC  X(0008).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  LCVEXITO PIC  X(0008).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  LCVSTATO PIC  X(0006).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  ACVDSCRO PIC  X(0006).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  ACVKINDO PIC  X(0003).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  ACVCDO PIC  X(0002).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  ACVOTRMO PIC  999.
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  ACVRTRMO PIC  999.
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  41
* EL131.cbl
  2058     05  ACVRATEO PIC  ZZZ.ZZ.
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  ACVFORMO PIC  X(0012).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  ACVCNDTO PIC  X(0008).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  ACVEXITO PIC  X(0008).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  ACVSTATO PIC  X(0006).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  DAYSPO PIC  X(0003).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  LABEL2O PIC  X(0014).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  BCERT1O PIC  X(0010).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  BSUFX1O PIC  X(0001).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  BCERT2O PIC  X(0010).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  BSUFX2O PIC  X(0001).
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  BCERT3O PIC  X(0010).
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  BSUFX3O PIC  X(0001).
  2098*    -------------------------------
  2099     05  FILLER            PIC  X(0003).
  2100     05  BCERT4O PIC  X(0010).
  2101*    -------------------------------
  2102     05  FILLER            PIC  X(0003).
  2103     05  BSUFX4O PIC  X(0001).
  2104*    -------------------------------
  2105     05  FILLER            PIC  X(0003).
  2106     05  BCERT5O PIC  X(0010).
  2107*    -------------------------------
  2108     05  FILLER            PIC  X(0003).
  2109     05  BSUFX5O PIC  X(0001).
  2110*    -------------------------------
  2111     05  FILLER            PIC  X(0003).
  2112     05  MSG1O PIC  X(0072).
  2113*    -------------------------------
  2114     05  FILLER            PIC  X(0003).
  2115     05  PFKEYO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  42
* EL131.cbl
  2116*    -------------------------------
  2117     05  FILLER            PIC  X(0003).
  2118     05  PFKEY6O PIC  X(0016).
  2119*    -------------------------------
  2120
  2121*                                COPY ELCEMIB SUPPRESS.
  2122******************************************************************
  2123*                                                                *
  2124*                                                                *
  2125*                            ELCEMIB.                            *
  2126*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2127*                            VMOD=2.005                          *
  2128*                                                                *
  2129*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2130*                                                                *
  2131******************************************************************
  2132 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2133     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2134     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2135     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2136     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2137     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2138     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2139     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2140     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2141     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2142         88  EMI-NO-ERRORS                    VALUE '1'.
  2143         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2144         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2145     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2146         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2147     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2148         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2149         88  EMI-AREA1-FULL                   VALUE '2'.
  2150     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2151         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2152         88  EMI-AREA2-FULL                   VALUE '2'.
  2153     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2154         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2155         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2156         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2157         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2158         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2159     12  EMI-ERROR-LINES.
  2160         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2161         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2162         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2163         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2164             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2165                 24  EMI-ERR-NUM         PIC X(4).
  2166                 24  EMI-FILLER          PIC X.
  2167                 24  EMI-SEV             PIC X.
  2168                 24  FILLER              PIC X.
  2169             20  FILLER                  PIC X(02).
  2170     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2171         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2172             20  EMI-ERROR-NUMBER    PIC X(4).
  2173             20  EMI-FILL            PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  43
* EL131.cbl
  2174             20  EMI-SEVERITY        PIC X.
  2175             20  FILLER              PIC X.
  2176             20  EMI-ERROR-TEXT.
  2177                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2178                 24  FILLER          PIC X(55).
  2179     12  EMI-SEVERITY-SAVE           PIC X.
  2180         88  EMI-NOTE                    VALUE 'N'.
  2181         88  EMI-WARNING                 VALUE 'W'.
  2182         88  EMI-FORCABLE                VALUE 'F'.
  2183         88  EMI-FATAL                   VALUE 'X'.
  2184     12  EMI-MESSAGE-FLAG            PIC X.
  2185         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2186         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2187     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2188     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2189         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2190         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2191         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2192     12  FILLER                      PIC X(137)  VALUE SPACES.
  2193     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2194     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2195     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2196     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2197
  2198*                                COPY ELCJPFX SUPPRESS.
  2199******************************************************************
  2200*                                                                *
  2201*                                                                *
  2202*                            ELCJPFX.                            *
  2203*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2204*                            VMOD=2.002                          *
  2205*                                                                *
  2206*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2207*                                                                *
  2208*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2209*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2210*        ELCNTL - CONTROL FILE                                   *
  2211*        ELMSTR - CLAIM MASTERS                                  *
  2212*        ELTRLR - ACTIVITY TRAILERS                              *
  2213*        ELCHKQ - CHECK QUE                                      *
  2214******************************************************************
  2215 01  JOURNAL-RECORD.
  2216     12  JP-USER-ID                  PIC X(4).
  2217     12  JP-FILE-ID                  PIC X(8).
  2218     12  JP-PROGRAM-ID               PIC X(8).
  2219     12  JP-RECORD-TYPE              PIC X.
  2220         88 JP-ADD              VALUE 'A'.
  2221         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2222         88 JP-AFTER-CHANGE     VALUE 'C'.
  2223         88 JP-DELETE           VALUE 'D'.
  2224         88 JP-GENERIC-DELETE   VALUE 'G'.
  2225         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2226         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2227     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2228     12  JP-RECORD-AREA
  2229
  2230
  2231                                 PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  44
* EL131.cbl
  2232
  2233*                                COPY ELCCALC SUPPRESS.
  2234******************************************************************
  2235*                                                                *
  2236*                           ELCCALC.                            *
  2237*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2238*                            VMOD=2.025                          *
  2239*                                                                *
  2240*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2241*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2242*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2243*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2244*                                                                *
  2245*  PASSED TO ELRTRM                                              *
  2246*  -----------------                                             *
  2247*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2248*  ORIGINAL TERM                                                 *
  2249*  BEGINNING DATE                                                *
  2250*  ENDING DATE                                                   *
  2251*  COMPANY I.D.                                                  *
  2252*  ACCOUNT MASTER USER FIELD                                     *
  2253*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2254*  FREE LOOK DAYS                                                *
  2255*                                                                *
  2256*  RETURNED FROM ELRTRM                                          *
  2257*  ---------------------                                         *
  2258*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2259*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2260*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2261*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2262*----------------------------------------------------------------*
  2263*  PASSED TO ELRAMT                                              *
  2264*  ----------------                                              *
  2265*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2266*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2267*  ORIGINAL AMOUNT                                               *
  2268*  ALTERNATE BENEFIT (BALLON)                                    *
  2269*  A.P.R. - NET PAY ONLY                                         *
  2270*  METHOD
  2271*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2272*  COMPANY I.D.                                                  *
  2273*  BENEFIT TYPE                                                  *
  2274*                                                                *
  2275*  RETURNED FROM ELRAMT                                          *
  2276*  --------------------                                          *
  2277*  REMAINING AMOUNT 1 - CURRENT                                  *
  2278*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2279*  REMAINING AMOUNT FACTOR
  2280*----------------------------------------------------------------*
  2281*  PASSED TO ELRESV                                              *
  2282*  -----------------                                             *
  2283*  CERTIFICATE EFFECTIVE DATE                                    *
  2284*  VALUATION DATE                                                *
  2285*  PAID THRU DATE                                                *
  2286*  BENEFIT                                                       *
  2287*  INCURRED DATE                                                 *
  2288*  REPORTED DATE                                                 *
  2289*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  45
* EL131.cbl
  2290*  TERM                                                          *
  2291*  CDT PERCENT                                                   *
  2292*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2293* *CLAIM TYPE (LIFE, A/H)                                        *
  2294* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2295* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2296*                                                                *
  2297*  RETURNED FROM ELRESV                                          *
  2298*  --------------------                                          *
  2299*  CDT TABLE USED                                                *
  2300*  CDT FACTOR USED                                               *
  2301*  PAY TO CURRENT RESERVE                                        *
  2302*  I.B.N.R. - A/H ONLY                                           *
  2303*  FUTURE (ACCRUED) AH ONLY                                      *
  2304*----------------------------------------------------------------*
  2305*  PASSED TO ELRATE                                              *
  2306*  ----------------                                              *
  2307*  CERT ISSUE DATE                                               *
  2308*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2309*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2310*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2311*  STATE CODE (CLIENT DEFINED)                                   *
  2312*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2313*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2314*  DEVIATION CODE                                                *
  2315*  ISSUE AGE                                                     *
  2316*  ORIGINAL BENEFIT AMOUNT                                       *
  2317*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2318*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2319*  BENEFIT KIND (LIFE OR A/H)                                    *
  2320*  A.P.R.                                                        *
  2321*  METHOD
  2322*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2323*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2324*  COMPANY I.D. (3 CHARACTER)                                    *
  2325*  BENEFIT CODE                                                  *
  2326*  BENEFIT OVERRIDE CODE                                         *
  2327*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2328*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2329*  JOINT INDICATOR (CSL ONLY)                                    *
  2330*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2331*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2332*                                                                *
  2333*  RETURNED FROM ELRATE                                          *
  2334*  --------------------                                          *
  2335*  CALCULATED PREMIUM                                            *
  2336*  PREMIUM RATE                                                  *
  2337*  MORTALITY CODE                                                *
  2338*  MAX ATTAINED AGE                                              *
  2339*  MAX AGE                                                       *
  2340*  MAX TERM                                                      *
  2341*  MAX MONTHLY BENEFIT                                           *
  2342*  MAX TOTAL BENIFIT                                             *
  2343*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2344*----------------------------------------------------------------*
  2345*  PASSED TO ELRFND                                              *
  2346*  ----------------                                              *
  2347*  CERT ISSUE DATE                                               *
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  46
* EL131.cbl
  2348*  REFUND DATE                                                   *
  2349*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2350*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2351*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2352*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2353*  STATE CODE (CLIENT DEFINED)                                   *
  2354*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2355*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2356*  DEVIATION CODE                                                *
  2357*  ISSUE AGE                                                     *
  2358*  ORIGINAL BENEFIT AMOUNT                                       *
  2359*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2360*  PROCESS TYPE (CANCEL)                                         *
  2361*  BENEFIT KIND (LIFE OR A/H)                                    *
  2362*  A.P.R.                                                        *
  2363*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2364*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2365*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2366*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2367*  COMPANY I.D. (3 CHARACTER)                                    *
  2368*  BENEFIT CODE                                                  *
  2369*  BENEFIT OVERRIDE CODE                                         *
  2370*                                                                *
  2371*  RETURNED FROM ELRFND                                          *
  2372*  --------------------                                          *
  2373*  CALCULATED REFUND                                             *
  2374*----------------------------------------------------------------*
  2375*  PASSED TO ELEARN                                              *
  2376*  ----------------                                              *
  2377*  CERT ISSUE DATE                                               *
  2378*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2379*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2380*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2381*  STATE CODE (CLIENT DEFINED)                                   *
  2382*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2383*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2384*  DEVIATION CODE                                                *
  2385*  ISSUE AGE                                                     *
  2386*  ORIGINAL BENEFIT AMOUNT                                       *
  2387*  BENEFIT KIND (LIFE OR A/H)                                    *
  2388*  A.P.R.                                                        *
  2389*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2390*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2391*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2392*  COMPANY I.D. (3 CHARACTER)                                    *
  2393*  BENEFIT CODE                                                  *
  2394*  BENEFIT OVERRIDE CODE                                         *
  2395*                                                                *
  2396*  RETURNED FROM ELEARN                                          *
  2397*  --------------------                                          *
  2398*  INDICATED  EARNINGS                                           *
  2399*----------------------------------------------------------------*
  2400*                 LENGTH = 450                                   *
  2401*                                                                *
  2402******************************************************************
  2403******************************************************************
  2404*                   C H A N G E   L O G
  2405*
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  47
* EL131.cbl
  2406* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2407*-----------------------------------------------------------------
  2408*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2409* EFFECTIVE    NUMBER
  2410*-----------------------------------------------------------------
  2411* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2412* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2413* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2414* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2415* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2416* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2417* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2418* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2419* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2420******************************************************************
  2421
  2422 01  CALCULATION-PASS-AREA.
  2423     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2424                                     COMP.
  2425
  2426     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2427       88  NO-CP-ERROR                             VALUE ZERO.
  2428       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2429                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2430       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2431       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2432       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2433       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2434       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2435       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2436       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2437       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2438       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2439       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2440       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2441       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2442       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2443       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2444       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2445       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2446       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2447
  2448     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2449       88  NO-CP-ERROR-2                           VALUE ZERO.
  2450***********************  INPUT AREAS ****************************
  2451
  2452     12  CP-CALCULATION-AREA.
  2453         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2454         16  CP-CERT-EFF-DT        PIC XX.
  2455         16  CP-VALUATION-DT       PIC XX.
  2456         16  CP-PAID-THRU-DT       PIC XX.
  2457         16  CP-BENEFIT-TYPE       PIC X.
  2458           88  CP-AH                               VALUE 'A' 'D'
  2459                                                   'I' 'U'.
  2460           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2461           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2462         16  CP-INCURRED-DT        PIC XX.
  2463         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  48
* EL131.cbl
  2464         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2465         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2466         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2467                                     COMP-3.
  2468         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2469                                     COMP-3.
  2470         16  CP-CDT-METHOD         PIC X.
  2471           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2472           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2473           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2474         16  CP-CLAIM-TYPE         PIC X.
  2475           88  CP-AH-CLAIM                         VALUE 'A'.
  2476           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2477         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2478                                     COMP-3.
  2479         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2480                                     COMP-3.
  2481         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2482                                     COMP-3.
  2483         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2484                                     COMP-3.
  2485         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2486                                     COMP-3.
  2487         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2488                                     COMP-3.
  2489         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2490                                     COMP-3.
  2491         16  CP-REM-TERM-METHOD    PIC X.
  2492           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2493           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2494           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2495           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2496           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2497           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2498           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2499         16  CP-EARNING-METHOD     PIC X.
  2500           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2501           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2502           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2503           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2504           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2505           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2506           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2507           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2508           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2509           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2510           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2511           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2512           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2513           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2514         16  CP-PROCESS-TYPE       PIC X.
  2515           88  CP-CLAIM                            VALUE '1'.
  2516           88  CP-CANCEL                           VALUE '2'.
  2517           88  CP-ISSUE                            VALUE '3'.
  2518         16  CP-SPECIAL-CALC-CD    PIC X.
  2519           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2520           88  CP-1-MTH-INTEREST               VALUE ' '.
  2521           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  49
* EL131.cbl
  2522           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2523           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2524           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2525           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2526           88  CP-FARM-PLAN                    VALUE 'F'.
  2527           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2528           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2529           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2530           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2531           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2532           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2533           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2534           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2535           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2536           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2537                                                     'W' 'X'.
  2538           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2539           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2540           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2541           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2542           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2543           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2544           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2545           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2546           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2547           88  CP-CSL-METH-1                   VALUE '5'.
  2548           88  CP-CSL-METH-2                   VALUE '6'.
  2549           88  CP-CSL-METH-3                   VALUE '7'.
  2550           88  CP-CSL-METH-4                   VALUE '8'.
  2551
  2552         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2553                                     COMP-3.
  2554         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2555         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2556         16  CP-STATE              PIC XX          VALUE SPACE.
  2557         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2558         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2559           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2560               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2561         16  CP-R78-OPTION         PIC X.
  2562           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2563           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2564
  2565         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2566         16  CP-IBNR-RESERVE-SW    PIC X.
  2567         16  CP-CLAIM-STATUS       PIC X.
  2568         16  CP-RATE-FILE          PIC X.
  2569         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2570                                     COMP-3.
  2571
  2572         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2573         16  CP-AH-OVERRIDE-CODE   PIC X.
  2574
  2575         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2576                                     COMP-3.
  2577         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2578                                   PIC S9(5)V99 COMP-3.
  2579         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  50
* EL131.cbl
  2580                                     COMP-3.
  2581         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2582                                     COMP-3.
  2583         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2584                                     COMP-3.
  2585         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2586                                  PIC S9(7)V99 COMP-3.
  2587
  2588         16  CP-PAID-FROM-DATE     PIC X(02).
  2589         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2590         16  CP-EXT-DAYS-CALC      PIC X.
  2591           88  CP-EXT-NO-CHG                   VALUE ' '.
  2592           88  CP-EXT-CHG-LF                   VALUE '1'.
  2593           88  CP-EXT-CHG-AH                   VALUE '2'.
  2594           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2595         16  CP-DOMICILE-STATE     PIC XX.
  2596         16  CP-CARRIER            PIC X.
  2597         16  CP-REIN-FLAG          PIC X.
  2598         16  CP-REM-TRM-CALC-OPTION PIC X.
  2599           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2600                      '2' '3' '4' '5'.
  2601           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2602           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2603           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2604           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2605           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2606           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2607           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2608           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2609         16  CP-SIG-SWITCH         PIC X.
  2610         16  CP-RATING-METHOD      PIC X.
  2611           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2612           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2613           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2614           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2615           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2616           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2617           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2618           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2619           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2620         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2621                                     COMP-3.
  2622         16  CP-BEN-CATEGORY       PIC X.
  2623         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2624         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2625                                   PIC S99V9(5) COMP-3.
  2626         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2627         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2628                                   PIC S99V9(5) COMP-3.
  2629         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2630         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2631         16  CP-EXPIRE-DT          PIC XX.
  2632         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2633         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2634         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2635         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2636         16  CP-DDF-SPEC-CALC      PIC X.
  2637             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  51
* EL131.cbl
  2638             88  CP-CALC-CLP              VALUE 'C'.
  2639         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2640         16  CP-CANCEL-REASON      PIC X.
  2641         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2642         16  CP-PMT-MODE           PIC X.
  2643         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2644         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2645         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2646         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2647         16  FILLER                PIC X.
  2648
  2649***************    OUTPUT FROM ELRESV   ************************
  2650
  2651         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2652
  2653         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2654                                     COMP-3.
  2655         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2656                                     COMP-3.
  2657         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2658                                     COMP-3.
  2659         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2660                                     COMP-3.
  2661         16  FILLER                PIC X(09).
  2662***************    OUTPUT FROM ELRTRM   *************************
  2663
  2664         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2665                                     COMP-3.
  2666         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2667                                     COMP-3.
  2668         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2669                                     COMP-3.
  2670         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2671                                     COMP-3.
  2672         16  FILLER                PIC X(12).
  2673
  2674***************    OUTPUT FROM ELRAMT   *************************
  2675
  2676         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2677                                     COMP-3.
  2678         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2679                                     COMP-3.
  2680         16  FILLER                PIC X(12).
  2681
  2682***************    OUTPUT FROM ELRATE   *************************
  2683
  2684         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2685                                     COMP-3.
  2686         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2687                                     COMP-3.
  2688         16  CP-MORTALITY-CODE     PIC X(4).
  2689         16  CP-RATE-EDIT-FLAG     PIC X.
  2690             88  CP-RATES-NEED-APR                  VALUE '1'.
  2691         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2692                                     COMP-3.
  2693         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2694         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2695         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  52
* EL131.cbl
  2696                                   PIC S9(7)V99 COMP-3.
  2697         16  FILLER                PIC X(07).
  2698
  2699***************    OUTPUT FROM ELRFND   *************************
  2700
  2701         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2702                                     COMP-3.
  2703         16  CP-REFUND-TYPE-USED   PIC X.
  2704           88  CP-R-AS-R78                         VALUE '1'.
  2705           88  CP-R-AS-PRORATA                     VALUE '2'.
  2706           88  CP-R-AS-CALIF                       VALUE '3'.
  2707           88  CP-R-AS-TEXAS                       VALUE '4'.
  2708           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2709           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2710           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2711           88  CP-R-AS-MEAN                        VALUE '8'.
  2712           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2713           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2714           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2715           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2716           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2717           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2718         16  FILLER                PIC X(12).
  2719
  2720***************    OUTPUT FROM ELEARN   *************************
  2721
  2722         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2723                                     COMP-3.
  2724         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2725                                     COMP-3.
  2726         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2727                                     COMP-3.
  2728         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2729                                     COMP-3.
  2730         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2731                                     COMP-3.
  2732         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2733                                     COMP-3.
  2734         16  CP-EARNING-TYPE-USED  PIC X.
  2735           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2736           88  CP-E-AS-R78                         VALUE '1'.
  2737           88  CP-E-AS-PRORATA                     VALUE '2'.
  2738           88  CP-E-AS-TEXAS                       VALUE '4'.
  2739           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2740           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2741           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2742           88  CP-E-AS-MEAN                        VALUE '8'.
  2743           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2744         16  FILLER                PIC X(12).
  2745
  2746***************    OUTPUT FROM ELPMNT   *************************
  2747
  2748         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2749                                     COMP-3.
  2750         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2751                                     COMP-3.
  2752         16  FILLER                PIC X(12).
  2753
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  53
* EL131.cbl
  2754***************   MISC WORK AREAS    *****************************
  2755         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2756                                     COMP-3.
  2757         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2758                                     COMP-3.
  2759         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2760                                     COMP-3.
  2761         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2762                                     COMP-3.
  2763         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2764                                     COMP-3.
  2765         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2766                                     COMP-3.
  2767         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2768             88  OPEN-RATE-FILE                   VALUE 'O'.
  2769             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2770             88  IO-ERROR                         VALUE 'E'.
  2771
  2772         16  CP-FIRST-PAY-DATE     PIC XX.
  2773
  2774         16  CP-JOINT-INDICATOR    PIC X.
  2775
  2776         16  CP-RESERVE-REMAINING-TERM
  2777                                   PIC S9(4)V9    VALUE ZERO
  2778                                     COMP-3.
  2779
  2780         16  CP-INSURED-BIRTH-DT   PIC XX.
  2781
  2782         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2783                                     COMP-3.
  2784
  2785         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2786                                     COMP-3.
  2787
  2788         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2789                                     COMP-3.
  2790
  2791         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2792                                     COMP-3.
  2793
  2794         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2795                                     COMP-3.
  2796
  2797         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2798                                     COMP-3.
  2799
  2800         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2801                                     COMP-3.
  2802
  2803         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2804             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2805
  2806         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2807                                     COMP-3.
  2808         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2809                                     COMP-3.
  2810         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2811         16  FILLER                PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  54
* EL131.cbl
  2812******************************************************************
  2813
  2814*                                COPY ELCDATE SUPPRESS.
  2815******************************************************************
  2816*                                                                *
  2817*                                                                *
  2818*                            ELCDATE.                            *
  2819*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2820*                            VMOD=2.003
  2821*                                                                *
  2822*                                                                *
  2823*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2824*                 LENGTH = 200                                   *
  2825******************************************************************
  2826
  2827 01  DATE-CONVERSION-DATA.
  2828     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2829     12  DC-OPTION-CODE                PIC X.
  2830         88  BIN-TO-GREG                VALUE ' '.
  2831         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2832         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2833         88  YMD-GREG-TO-BIN            VALUE '3'.
  2834         88  MDY-GREG-TO-BIN            VALUE '4'.
  2835         88  JULIAN-TO-BIN              VALUE '5'.
  2836         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2837         88  FIND-CENTURY               VALUE '7'.
  2838         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2839         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2840         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2841         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2842         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2843         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2844         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2845         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2846         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2847         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2848         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2849         88  BIN-3-TO-GREG              VALUE 'I'.
  2850         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2851         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2852         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2853         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2854         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2855         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2856         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2857         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2858         88  THREE-CHARACTER-BIN
  2859                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2860         88  GREGORIAN-TO-BIN
  2861                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2862         88  BIN-TO-GREGORIAN
  2863                  VALUES ' ' '1' 'I' '8' 'G'.
  2864         88  JULIAN-TO-BINARY
  2865                  VALUES '5' 'C' 'E' 'F'.
  2866     12  DC-ERROR-CODE                 PIC X.
  2867         88  NO-CONVERSION-ERROR        VALUE ' '.
  2868         88  DATE-CONVERSION-ERROR
  2869                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  55
* EL131.cbl
  2870         88  DATE-IS-ZERO               VALUE '1'.
  2871         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2872         88  DATE-IS-INVALID            VALUE '3'.
  2873         88  DATE1-GREATER-DATE2        VALUE '4'.
  2874         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2875         88  DATE-INVALID-OPTION        VALUE '9'.
  2876         88  INVALID-CENTURY            VALUE 'A'.
  2877         88  ONLY-CENTURY               VALUE 'B'.
  2878         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2879         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2880     12  DC-END-OF-MONTH               PIC X.
  2881         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2882     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2883         88  USE-NORMAL-PROCESS         VALUE ' '.
  2884         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2885         88  ADJUST-UP-100-YRS          VALUE '2'.
  2886     12  FILLER                        PIC X.
  2887     12  DC-CONVERSION-DATES.
  2888         16  DC-BIN-DATE-1             PIC XX.
  2889         16  DC-BIN-DATE-2             PIC XX.
  2890         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2891         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2892                       DC-GREG-DATE-1-EDIT.
  2893             20  DC-EDIT1-MONTH        PIC 99.
  2894             20  SLASH1-1              PIC X.
  2895             20  DC-EDIT1-DAY          PIC 99.
  2896             20  SLASH1-2              PIC X.
  2897             20  DC-EDIT1-YEAR         PIC 99.
  2898         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2899         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2900                     DC-GREG-DATE-2-EDIT.
  2901             20  DC-EDIT2-MONTH        PIC 99.
  2902             20  SLASH2-1              PIC X.
  2903             20  DC-EDIT2-DAY          PIC 99.
  2904             20  SLASH2-2              PIC X.
  2905             20  DC-EDIT2-YEAR         PIC 99.
  2906         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2907         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2908                     DC-GREG-DATE-1-YMD.
  2909             20  DC-YMD-YEAR           PIC 99.
  2910             20  DC-YMD-MONTH          PIC 99.
  2911             20  DC-YMD-DAY            PIC 99.
  2912         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2913         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2914                      DC-GREG-DATE-1-MDY.
  2915             20  DC-MDY-MONTH          PIC 99.
  2916             20  DC-MDY-DAY            PIC 99.
  2917             20  DC-MDY-YEAR           PIC 99.
  2918         16  DC-GREG-DATE-1-ALPHA.
  2919             20  DC-ALPHA-MONTH        PIC X(10).
  2920             20  DC-ALPHA-DAY          PIC 99.
  2921             20  FILLER                PIC XX.
  2922             20  DC-ALPHA-CENTURY.
  2923                 24 DC-ALPHA-CEN-N     PIC 99.
  2924             20  DC-ALPHA-YEAR         PIC 99.
  2925         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2926         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2927         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  56
* EL131.cbl
  2928         16  DC-JULIAN-DATE            PIC 9(05).
  2929         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2930                                       PIC 9(05).
  2931         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2932             20  DC-JULIAN-YEAR        PIC 99.
  2933             20  DC-JULIAN-DAYS        PIC 999.
  2934         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2935         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2936         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2937     12  DATE-CONVERSION-VARIBLES.
  2938         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2939         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2940             20  FILLER                PIC 9(3).
  2941             20  HOLD-CEN-1-CCYY.
  2942                 24  HOLD-CEN-1-CC     PIC 99.
  2943                 24  HOLD-CEN-1-YY     PIC 99.
  2944             20  HOLD-CEN-1-MO         PIC 99.
  2945             20  HOLD-CEN-1-DA         PIC 99.
  2946         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2947             20  HOLD-CEN-1-R-MO       PIC 99.
  2948             20  HOLD-CEN-1-R-DA       PIC 99.
  2949             20  HOLD-CEN-1-R-CCYY.
  2950                 24  HOLD-CEN-1-R-CC   PIC 99.
  2951                 24  HOLD-CEN-1-R-YY   PIC 99.
  2952             20  FILLER                PIC 9(3).
  2953         16  HOLD-CENTURY-1-X.
  2954             20  FILLER                PIC X(3)  VALUE SPACES.
  2955             20  HOLD-CEN-1-X-CCYY.
  2956                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2957                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2958             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2959             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2960         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2961             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2962             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2963             20  HOLD-CEN-1-R-X-CCYY.
  2964                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2965                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2966             20  FILLER                PIC XXX.
  2967         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2968         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2969         16  DC-JULIAN-DATE-1          PIC 9(07).
  2970         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2971             20  DC-JULIAN-1-CCYY.
  2972                 24  DC-JULIAN-1-CC    PIC 99.
  2973                 24  DC-JULIAN-1-YR    PIC 99.
  2974             20  DC-JULIAN-DA-1        PIC 999.
  2975         16  DC-JULIAN-DATE-2          PIC 9(07).
  2976         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2977             20  DC-JULIAN-2-CCYY.
  2978                 24  DC-JULIAN-2-CC    PIC 99.
  2979                 24  DC-JULIAN-2-YR    PIC 99.
  2980             20  DC-JULIAN-DA-2        PIC 999.
  2981         16  DC-GREG-DATE-A-EDIT.
  2982             20  DC-EDITA-MONTH        PIC 99.
  2983             20  SLASHA-1              PIC X VALUE '/'.
  2984             20  DC-EDITA-DAY          PIC 99.
  2985             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  57
* EL131.cbl
  2986             20  DC-EDITA-CCYY.
  2987                 24  DC-EDITA-CENT     PIC 99.
  2988                 24  DC-EDITA-YEAR     PIC 99.
  2989         16  DC-GREG-DATE-B-EDIT.
  2990             20  DC-EDITB-MONTH        PIC 99.
  2991             20  SLASHB-1              PIC X VALUE '/'.
  2992             20  DC-EDITB-DAY          PIC 99.
  2993             20  SLASHB-2              PIC X VALUE '/'.
  2994             20  DC-EDITB-CCYY.
  2995                 24  DC-EDITB-CENT     PIC 99.
  2996                 24  DC-EDITB-YEAR     PIC 99.
  2997         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2998         16  DC-GREG-DATE-CYMD-R REDEFINES
  2999                              DC-GREG-DATE-CYMD.
  3000             20  DC-CYMD-CEN           PIC 99.
  3001             20  DC-CYMD-YEAR          PIC 99.
  3002             20  DC-CYMD-MONTH         PIC 99.
  3003             20  DC-CYMD-DAY           PIC 99.
  3004         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3005         16  DC-GREG-DATE-MDCY-R REDEFINES
  3006                              DC-GREG-DATE-MDCY.
  3007             20  DC-MDCY-MONTH         PIC 99.
  3008             20  DC-MDCY-DAY           PIC 99.
  3009             20  DC-MDCY-CEN           PIC 99.
  3010             20  DC-MDCY-YEAR          PIC 99.
  3011    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3012        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3013    12  DC-EL310-DATE                  PIC X(21).
  3014    12  FILLER                         PIC X(28).
  3015
  3016*                                COPY ELCDMO.
  3017******************************************************************
  3018*                                                                *
  3019*                                                                *
  3020*                            ELCDMO.                             *
  3021*                            VMOD=2.004                          *
  3022*                                                                *
  3023*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3024*        COMMUNICATION AREA                                      *
  3025*   FILE TYPE = NA                                               *
  3026*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3027*                                                                *
  3028******************************************************************
  3029 01  DMO-COMMUNICATION-AREA.
  3030     12  DM-RECORD-TYPE                  PIC  X(02).
  3031             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3032             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3033             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3034     12  DM-DIST-CODE                    PIC  X(04).
  3035     12  DM-MAIL-CODE                    PIC  X(05).
  3036     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3037     12  DM-INSURED-NAME                 PIC  X(30).
  3038     12  DM-CLAIM-NO                     PIC  X(07).
  3039     12  DM-CLAIM-TYPE                   PIC  X.
  3040
  3041     12  DM-STATUS-DATA-AREA.
  3042         16  DM-CLAIM-STATUS             PIC  X.
  3043             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  58
* EL131.cbl
  3044             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3045             88  DM-CLOSED                        VALUE '3'.
  3046             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3047             88  DM-DEFAULT                       VALUE '9'.
  3048         16  DM-STATUS-DATE              PIC  X(08).
  3049******YYYYMMDD
  3050         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3051             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3052             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3053             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3054             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3055             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3056             88  DM-RE-OPENED                     VALUE 'R'.
  3057             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3058             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3059             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3060         16  DM-STAT-CARRIER             PIC X.
  3061
  3062     12  DM-DRAFT-DATA-AREA.
  3063         16  DM-PAYMENT-TYPE             PIC  X.
  3064             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3065         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3066         16  DM-PAYMENT-DATE             PIC  X(08).
  3067******YYYYMMDD
  3068         16  DM-CERT-NO                  PIC  X(11).
  3069         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3070         16  DM-CARRIER                  PIC  X.
  3071
  3072     12  DM-RETURN-CODE                  PIC  XX.
  3073
  3074****************************************************************
  3075*
  3076* Copyright (c) 2007 by Clerity Solutions, Inc.
  3077* All rights reserved.
  3078*
  3079****************************************************************
  3080 01  DFHEIV.
  3081   02  DFHEIV0               PIC X(35).
  3082   02  DFHEIV1               PIC X(08).
  3083   02  DFHEIV2               PIC X(08).
  3084   02  DFHEIV3               PIC X(08).
  3085   02  DFHEIV4               PIC X(06).
  3086   02  DFHEIV5               PIC X(04).
  3087   02  DFHEIV6               PIC X(04).
  3088   02  DFHEIV7               PIC X(02).
  3089   02  DFHEIV8               PIC X(02).
  3090   02  DFHEIV9               PIC X(01).
  3091   02  DFHEIV10              PIC S9(7) COMP-3.
  3092   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3093   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3094   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3095   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3096   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3097   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3098   02  DFHEIV17              PIC X(04).
  3099   02  DFHEIV18              PIC X(04).
  3100   02  DFHEIV19              PIC X(04).
  3101   02  DFHEIV20              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  59
* EL131.cbl
  3102   02  DFHEIV21              USAGE IS POINTER.
  3103   02  DFHEIV22              USAGE IS POINTER.
  3104   02  DFHEIV23              USAGE IS POINTER.
  3105   02  DFHEIV24              USAGE IS POINTER.
  3106   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3107   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3108   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3109   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3110   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3111   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3112   02  FILLER                PIC X(02).
  3113   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3114   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3115   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3116   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3117   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3118 LINKAGE  SECTION.
  3119*****************************************************************
  3120*                                                               *
  3121* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3122* All rights reserved.                                          *
  3123*                                                               *
  3124*****************************************************************
  3125 01  dfheiblk.
  3126     02  eibtime          pic s9(7) comp-3.
  3127     02  eibdate          pic s9(7) comp-3.
  3128     02  eibtrnid         pic x(4).
  3129     02  eibtaskn         pic s9(7) comp-3.
  3130     02  eibtrmid         pic x(4).
  3131     02  dfheigdi         pic s9(4) comp.
  3132     02  eibcposn         pic s9(4) comp.
  3133     02  eibcalen         pic s9(4) comp.
  3134     02  eibaid           pic x(1).
  3135     02  eibfiller1       pic x(1).
  3136     02  eibfn            pic x(2).
  3137     02  eibfiller2       pic x(2).
  3138     02  eibrcode         pic x(6).
  3139     02  eibfiller3       pic x(2).
  3140     02  eibds            pic x(8).
  3141     02  eibreqid         pic x(8).
  3142     02  eibrsrce         pic x(8).
  3143     02  eibsync          pic x(1).
  3144     02  eibfree          pic x(1).
  3145     02  eibrecv          pic x(1).
  3146     02  eibsend          pic x(1).
  3147     02  eibatt           pic x(1).
  3148     02  eibeoc           pic x(1).
  3149     02  eibfmh           pic x(1).
  3150     02  eibcompl         pic x(1).
  3151     02  eibsig           pic x(1).
  3152     02  eibconf          pic x(1).
  3153     02  eiberr           pic x(1).
  3154     02  eibrldbk         pic x(1).
  3155     02  eiberrcd         pic x(4).
  3156     02  eibsynrb         pic x(1).
  3157     02  eibnodat         pic x(1).
  3158     02  eibfiller5       pic x(2).
  3159     02  eibresp          pic 9(09) comp.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  60
* EL131.cbl
  3160     02  eibresp2         pic 9(09) comp.
  3161     02  dfheigdj         pic s9(4) comp.
  3162     02  dfheigdk         pic s9(4) comp.
  3163 01  DFHCOMMAREA                 PIC X(1024).
  3164
  3165*                                COPY ELCMSTR.
  3166******************************************************************
  3167*                                                                *
  3168*                            ELCMSTR.                            *
  3169*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3170*                            VMOD=2.012                          *
  3171*                                                                *
  3172*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3173*                                                                *
  3174*   FILE TYPE = VSAM,KSDS                                        *
  3175*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3176*                                                                *
  3177*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3178*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3179*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3180*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3181*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3182*                                                 RKP=75,LEN=21  *
  3183*                                                                *
  3184*   **** NOTE ****                                               *
  3185*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3186*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3187*                                                                *
  3188*   LOG = YES                                                    *
  3189*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3190******************************************************************
  3191*                   C H A N G E   L O G
  3192*
  3193* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3194*-----------------------------------------------------------------
  3195*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3196* EFFECTIVE    NUMBER
  3197*-----------------------------------------------------------------
  3198* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3199* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3200******************************************************************
  3201 01  CLAIM-MASTER.
  3202     12  CL-RECORD-ID                PIC XX.
  3203         88  VALID-CL-ID         VALUE 'CL'.
  3204
  3205     12  CL-CONTROL-PRIMARY.
  3206         16  CL-COMPANY-CD           PIC X.
  3207         16  CL-CARRIER              PIC X.
  3208         16  CL-CLAIM-NO             PIC X(7).
  3209         16  CL-CERT-NO.
  3210             20  CL-CERT-PRIME       PIC X(10).
  3211             20  CL-CERT-SFX         PIC X.
  3212
  3213     12  CL-CONTROL-BY-NAME.
  3214         16  CL-COMPANY-CD-A1        PIC X.
  3215         16  CL-INSURED-LAST-NAME    PIC X(15).
  3216         16  CL-INSURED-NAME.
  3217             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  61
* EL131.cbl
  3218             20  CL-INSURED-MID-INIT PIC X.
  3219
  3220     12  CL-CONTROL-BY-SSN.
  3221         16  CL-COMPANY-CD-A2        PIC X.
  3222         16  CL-SOC-SEC-NO.
  3223             20  CL-SSN-STATE        PIC XX.
  3224             20  CL-SSN-ACCOUNT      PIC X(6).
  3225             20  CL-SSN-LN3          PIC X(3).
  3226
  3227     12  CL-CONTROL-BY-CERT-NO.
  3228         16  CL-COMPANY-CD-A4        PIC X.
  3229         16  CL-CERT-NO-A4.
  3230             20  CL-CERT-A4-PRIME    PIC X(10).
  3231             20  CL-CERT-A4-SFX      PIC X.
  3232
  3233     12  CL-CONTROL-BY-CCN.
  3234         16  CL-COMPANY-CD-A5        PIC X.
  3235         16  CL-CCN-A5.
  3236             20  CL-CCN.
  3237                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3238                 24  CL-CCN-PRIME-A5 PIC X(12).
  3239             20  CL-CCN-FILLER-A5    PIC X(4).
  3240
  3241     12  CL-INSURED-PROFILE-DATA.
  3242         16  CL-INSURED-BIRTH-DT     PIC XX.
  3243         16  CL-INSURED-SEX-CD       PIC X.
  3244             88  INSURED-IS-MALE        VALUE 'M'.
  3245             88  INSURED-IS-FEMALE      VALUE 'F'.
  3246             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3247         16  CL-INSURED-OCC-CD       PIC X(6).
  3248         16  FILLER                  PIC X(5).
  3249
  3250     12  CL-PROCESSING-INFO.
  3251         16  CL-PROCESSOR-ID         PIC X(4).
  3252         16  CL-CLAIM-STATUS         PIC X.
  3253             88  CLAIM-IS-OPEN          VALUE 'O'.
  3254             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3255         16  CL-CLAIM-TYPE           PIC X.
  3256*            88  AH-CLAIM               VALUE 'A'.
  3257*            88  LIFE-CLAIM             VALUE 'L'.
  3258*            88  PROPERTY-CLAIM         VALUE 'P'.
  3259*            88  IUI-CLAIM              VALUE 'I'.
  3260*            88  GAP-CLAIM              VALUE 'G'.
  3261         16  CL-CLAIM-PREM-TYPE      PIC X.
  3262             88  SINGLE-PREMIUM         VALUE '1'.
  3263             88  O-B-COVERAGE           VALUE '2'.
  3264             88  OPEN-END-COVERAGE      VALUE '3'.
  3265         16  CL-INCURRED-DT          PIC XX.
  3266         16  CL-REPORTED-DT          PIC XX.
  3267         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3268         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3269         16  CL-LAST-PMT-DT          PIC XX.
  3270         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3271         16  CL-PAID-THRU-DT         PIC XX.
  3272         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3273         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3274         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3275         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  62
* EL131.cbl
  3276             88  CL-360-DAY-YR          VALUE '1'.
  3277             88  CL-365-DAY-YR          VALUE '2'.
  3278             88  CL-FULL-MONTHS         VALUE '3'.
  3279         16  CL-CAUSE-CD             PIC X(6).
  3280
  3281         16  CL-PRIME-CERT-NO.
  3282             20  CL-PRIME-CERT-PRIME PIC X(10).
  3283             20  CL-PRIME-CERT-SFX   PIC X.
  3284
  3285         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3286             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3287             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3288
  3289         16  CL-MICROFILM-NO         PIC X(10).
  3290         16  CL-PROG-FORM-TYPE       PIC X.
  3291         16  CL-LAST-ADD-ON-DT       PIC XX.
  3292
  3293         16  CL-LAST-REOPEN-DT       PIC XX.
  3294         16  CL-LAST-CLOSE-DT        PIC XX.
  3295         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3296             88  FINAL-PAID             VALUE '1'.
  3297             88  CLAIM-DENIED           VALUE '2'.
  3298             88  AUTO-CLOSE             VALUE '3'.
  3299             88  MANUAL-CLOSE           VALUE '4'.
  3300             88  BENEFITS-CHANGED       VALUE 'C'.
  3301             88  SETUP-ERRORS           VALUE 'E'.
  3302         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3303         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3304         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3305             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3306         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3307         16  FILLER                  PIC X.
  3308
  3309     12  CL-CERTIFICATE-DATA.
  3310         16  CL-CERT-ORIGIN          PIC X.
  3311             88  CERT-WAS-ONLINE        VALUE '1'.
  3312             88  CERT-WAS-CREATED       VALUE '2'.
  3313             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3314         16  CL-CERT-KEY-DATA.
  3315             20  CL-CERT-CARRIER     PIC X.
  3316             20  CL-CERT-GROUPING    PIC X(6).
  3317             20  CL-CERT-STATE       PIC XX.
  3318             20  CL-CERT-ACCOUNT.
  3319                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3320                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3321             20  CL-CERT-EFF-DT      PIC XX.
  3322
  3323     12  CL-STATUS-CONTROLS.
  3324         16  CL-PRIORITY-CD          PIC X.
  3325             88  CONFIDENTIAL-DATA      VALUE '8'.
  3326             88  HIGHEST-PRIORITY       VALUE '9'.
  3327         16  CL-SUPV-ATTN-CD         PIC X.
  3328             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3329             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3330         16  CL-PURGED-DT            PIC XX.
  3331         16  CL-RESTORED-DT          PIC XX.
  3332         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3333         16  CL-NEXT-RESEND-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  63
* EL131.cbl
  3334         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3335         16  FILLER                  PIC XX.
  3336         16  CL-LAST-MAINT-DT        PIC XX.
  3337         16  CL-LAST-MAINT-USER      PIC X(4).
  3338         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3339         16  CL-LAST-MAINT-TYPE      PIC X.
  3340             88  CLAIM-SET-UP           VALUE ' '.
  3341             88  PAYMENT-MADE           VALUE '1'.
  3342             88  LETTER-SENT            VALUE '2'.
  3343             88  MASTER-WAS-ALTERED     VALUE '3'.
  3344             88  MASTER-WAS-RESTORED    VALUE '4'.
  3345             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3346             88  FILE-CONVERTED         VALUE '6'.
  3347             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3348             88  ERROR-CORRECTION       VALUE 'E'.
  3349         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3350         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3351         16  CL-BENEFICIARY          PIC X(10).
  3352         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3353         16  CL-DENIAL-TYPE          PIC X.
  3354             88  CL-TYPE-DENIAL          VALUE '1'.
  3355             88  CL-TYPE-RESCISSION      VALUE '2'.
  3356             88  CL-TYPE-REFORMATION     VALUE '3'.
  3357             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3358             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3359         16  FILLER                  PIC X(5).
  3360
  3361     12  CL-TRAILER-CONTROLS.
  3362         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3363             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3364             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3365             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3366         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3367         16  FILLER                  PIC XX.
  3368         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3369         16  CL-ADDRESS-TRAILER-CNT.
  3370             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3371                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3372             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3373                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3374             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3375                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3376             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3377                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3378             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3379                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3380             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3381                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3382             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3383                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3384
  3385     12  CL-CV-REFERENCE-NO.
  3386         16  CL-CV-REFNO-PRIME       PIC X(18).
  3387         16  CL-CV-REFNO-SFX         PIC XX.
  3388
  3389     12  CL-FILE-LOCATION            PIC X(4).
  3390
  3391     12  CL-PROCESS-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  64
* EL131.cbl
  3392         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3393             88  NO-FATAL-ERRORS        VALUE ZERO.
  3394         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3395             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3396
  3397     12  CL-PRODUCT-CD               PIC X.
  3398
  3399     12  CL-CURRENT-KEY-DATA.
  3400         16  CL-CURRENT-CARRIER      PIC X.
  3401         16  CL-CURRENT-GROUPING     PIC X(6).
  3402         16  CL-CURRENT-STATE        PIC XX.
  3403         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3404
  3405     12  CL-ASSOCIATES               PIC X.
  3406         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3407         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3408         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3409         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3410
  3411     12  CL-ACTIVITY-CODE            PIC 99.
  3412     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3413     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3414
  3415     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3416     12  CL-LAG-REPORT-CODE          PIC 9.
  3417     12  CL-LOAN-TYPE                PIC XX.
  3418     12  CL-LEGAL-STATE              PIC XX.
  3419
  3420*    12  FILLER                      PIC X(5).
  3421     12  CL-YESNOSW                  PIC X.
  3422     12  FILLER                      PIC X(4).
  3423
  3424*                                COPY ELCCERT.
  3425******************************************************************
  3426*                                                                *
  3427*                            ELCCERT.                            *
  3428*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3429*                            VMOD=2.013                          *
  3430*                                                                *
  3431*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3432*                                                                *
  3433*   FILE TYPE = VSAM,KSDS                                        *
  3434*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3435*                                                                *
  3436*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3437*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3438*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3439*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3440*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3441*                                                                *
  3442*   LOG = YES                                                    *
  3443*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3444******************************************************************
  3445*                   C H A N G E   L O G
  3446*
  3447* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3448*-----------------------------------------------------------------
  3449*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  65
* EL131.cbl
  3450* EFFECTIVE    NUMBER
  3451*-----------------------------------------------------------------
  3452* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3453* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3454* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3455* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3456* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3457* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3458* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3459* 032612  CR2011110200001  PEMA  AHL CHANGES
  3460******************************************************************
  3461
  3462 01  CERTIFICATE-MASTER.
  3463     12  CM-RECORD-ID                      PIC XX.
  3464         88  VALID-CM-ID                      VALUE 'CM'.
  3465
  3466     12  CM-CONTROL-PRIMARY.
  3467         16  CM-COMPANY-CD                 PIC X.
  3468         16  CM-CARRIER                    PIC X.
  3469         16  CM-GROUPING.
  3470             20  CM-GROUPING-PREFIX        PIC X(3).
  3471             20  CM-GROUPING-PRIME         PIC X(3).
  3472         16  CM-STATE                      PIC XX.
  3473         16  CM-ACCOUNT.
  3474             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3475             20  CM-ACCOUNT-PRIME          PIC X(6).
  3476         16  CM-CERT-EFF-DT                PIC XX.
  3477         16  CM-CERT-NO.
  3478             20  CM-CERT-PRIME             PIC X(10).
  3479             20  CM-CERT-SFX               PIC X.
  3480
  3481     12  CM-CONTROL-BY-NAME.
  3482         16  CM-COMPANY-CD-A1              PIC X.
  3483         16  CM-INSURED-LAST-NAME          PIC X(15).
  3484         16  CM-INSURED-INITIALS.
  3485             20  CM-INSURED-INITIAL1       PIC X.
  3486             20  CM-INSURED-INITIAL2       PIC X.
  3487
  3488     12  CM-CONTROL-BY-SSN.
  3489         16  CM-COMPANY-CD-A2              PIC X.
  3490         16  CM-SOC-SEC-NO.
  3491             20  CM-SSN-STATE              PIC XX.
  3492             20  CM-SSN-ACCOUNT            PIC X(6).
  3493             20  CM-SSN-LN3.
  3494                 25  CM-INSURED-INITIALS-A2.
  3495                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3496                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3497                 25 CM-PART-LAST-NAME-A2         PIC X.
  3498
  3499     12  CM-CONTROL-BY-CERT-NO.
  3500         16  CM-COMPANY-CD-A4              PIC X.
  3501         16  CM-CERT-NO-A4                 PIC X(11).
  3502
  3503     12  CM-CONTROL-BY-MEMB.
  3504         16  CM-COMPANY-CD-A5              PIC X.
  3505         16  CM-MEMBER-NO.
  3506             20  CM-MEMB-STATE             PIC XX.
  3507             20  CM-MEMB-ACCOUNT           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  66
* EL131.cbl
  3508             20  CM-MEMB-LN4.
  3509                 25  CM-INSURED-INITIALS-A5.
  3510                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3511                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3512                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3513
  3514     12  CM-INSURED-PROFILE-DATA.
  3515         16  CM-INSURED-FIRST-NAME.
  3516             20  CM-INSURED-1ST-INIT       PIC X.
  3517             20  FILLER                    PIC X(9).
  3518         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3519         16  CM-INSURED-SEX                PIC X.
  3520             88  CM-SEX-MALE                  VALUE 'M'.
  3521             88  CM-SEX-FEMAL                 VALUE 'F'.
  3522         16  CM-INSURED-JOINT-AGE          PIC 99.
  3523         16  CM-JOINT-INSURED-NAME.
  3524             20  CM-JT-LAST-NAME           PIC X(15).
  3525             20  CM-JT-FIRST-NAME.
  3526                 24  CM-JT-1ST-INIT        PIC X.
  3527                 24  FILLER                PIC X(9).
  3528             20  CM-JT-INITIAL             PIC X.
  3529
  3530     12  CM-LIFE-DATA.
  3531         16  CM-LF-BENEFIT-CD              PIC XX.
  3532         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3533         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3534         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3535         16  CM-LF-DEV-CODE                PIC XXX.
  3536         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3537         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3538         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3539         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3540         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3541         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3542         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3543         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3544         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3545         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3546         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3547         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3548         16  FILLER                        PIC XX.
  3549
  3550     12  CM-AH-DATA.
  3551         16  CM-AH-BENEFIT-CD              PIC XX.
  3552         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3553         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3554         16  CM-AH-DEV-CODE                PIC XXX.
  3555         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3556         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3557         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3558         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3559         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3560         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3561         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3562         16  CM-AH-PAID-THRU-DT            PIC XX.
  3563             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3564         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3565         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  67
* EL131.cbl
  3566         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3567         16  FILLER                        PIC X.
  3568
  3569     12  CM-LOAN-INFORMATION.
  3570         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3571         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3572                                           PIC S9(5)V99  COMP-3.
  3573         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3574         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3575         16  CM-PAY-FREQUENCY              PIC S99.
  3576         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3577         16  CM-RATE-CLASS                 PIC XX.
  3578         16  CM-BENEFICIARY                PIC X(25).
  3579         16  CM-POLICY-FORM-NO             PIC X(12).
  3580         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3581         16  CM-LAST-ADD-ON-DT             PIC XX.
  3582         16  CM-DEDUCTIBLE-AMOUNTS.
  3583             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3584             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3585         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3586             20  CM-RESIDENT-STATE         PIC XX.
  3587             20  CM-RATE-CODE              PIC X(4).
  3588             20  FILLER                    PIC XX.
  3589         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3590             20  CM-LOAN-OFFICER           PIC X(5).
  3591             20  FILLER                    PIC XXX.
  3592         16  CM-CSR-CODE                   PIC XXX.
  3593         16  CM-UNDERWRITING-CODE          PIC X.
  3594             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3595         16  CM-POST-CARD-IND              PIC X.
  3596         16  CM-NH-INTERFACE-SW            PIC X.
  3597         16  CM-PREMIUM-TYPE               PIC X.
  3598             88  CM-SING-PRM                  VALUE '1'.
  3599             88  CM-O-B-COVERAGE              VALUE '2'.
  3600             88  CM-OPEN-END                  VALUE '3'.
  3601         16  CM-IND-GRP-TYPE               PIC X.
  3602             88  CM-INDIVIDUAL                VALUE 'I'.
  3603             88  CM-GROUP                     VALUE 'G'.
  3604         16  CM-SKIP-CODE                  PIC X.
  3605             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3606             88  SKIP-JULY                    VALUE '1'.
  3607             88  SKIP-AUGUST                  VALUE '2'.
  3608             88  SKIP-SEPTEMBER               VALUE '3'.
  3609             88  SKIP-JULY-AUG                VALUE '4'.
  3610             88  SKIP-AUG-SEPT                VALUE '5'.
  3611             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3612             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3613             88  SKIP-JUNE                    VALUE '8'.
  3614             88  SKIP-JUNE-JULY               VALUE '9'.
  3615             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3616             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3617         16  CM-PAYMENT-MODE               PIC X.
  3618             88  PAY-MONTHLY                  VALUE SPACE.
  3619             88  PAY-WEEKLY                   VALUE '1'.
  3620             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3621             88  PAY-BI-WEEKLY                VALUE '3'.
  3622             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3623         16  CM-LOAN-NUMBER                PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  68
* EL131.cbl
  3624         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3625         16  CM-OLD-LOF                    PIC XXX.
  3626*        16  CM-LOAN-OFFICER               PIC XXX.
  3627         16  CM-REIN-TABLE                 PIC XXX.
  3628         16  CM-SPECIAL-REIN-CODE          PIC X.
  3629         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3630         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3631         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3632
  3633     12  CM-STATUS-DATA.
  3634         16  CM-ENTRY-STATUS               PIC X.
  3635         16  CM-ENTRY-DT                   PIC XX.
  3636
  3637         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3638         16  CM-LF-CANCEL-DT               PIC XX.
  3639         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3640
  3641         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3642         16  CM-LF-DEATH-DT                PIC XX.
  3643         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3644
  3645         16  CM-LF-CURRENT-STATUS          PIC X.
  3646             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3647                                                'M' '4' '5' '9'.
  3648             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3649             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3650             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3651             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  3652             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3653             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3654             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  3655             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3656             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  3657             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3658             88  CM-LF-DECLINED               VALUE 'D'.
  3659             88  CM-LF-VOIDED                 VALUE 'V'.
  3660
  3661         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3662         16  CM-AH-CANCEL-DT               PIC XX.
  3663         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3664
  3665         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3666         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3667         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3668
  3669         16  CM-AH-CURRENT-STATUS          PIC X.
  3670             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3671                                                'M' '4' '5' '9'.
  3672             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  3673             88  CM-AH-POLICY-PENDING         VALUE '2'.
  3674             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  3675             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  3676             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  3677             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3678             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  3679             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3680             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  3681             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  69
* EL131.cbl
  3682             88  CM-AH-DECLINED               VALUE 'D'.
  3683             88  CM-AH-VOIDED                 VALUE 'V'.
  3684
  3685         16  CM-CLAIM-INTERFACE-SW         PIC X.
  3686             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  3687             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  3688             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  3689         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  3690
  3691         16  CM-ENTRY-BATCH                PIC X(6).
  3692         16  CM-LF-EXIT-BATCH              PIC X(6).
  3693         16  CM-AH-EXIT-BATCH              PIC X(6).
  3694         16  CM-LAST-MONTH-END             PIC XX.
  3695
  3696     12  CM-NOTE-SW                        PIC X.
  3697         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  3698         88  CERT-NOTES-PRESENT               VALUE '1'.
  3699         88  BILLING-NOTES-PRESENT            VALUE '2'.
  3700         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  3701         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  3702         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  3703         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  3704         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  3705     12  CM-COMP-EXCP-SW                   PIC X.
  3706         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  3707         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  3708     12  CM-INSURED-ADDRESS-SW             PIC X.
  3709         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  3710         88  INSURED-ADDR-PRESENT             VALUE '1'.
  3711
  3712*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  3713     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  3714     12  FILLER                            PIC X.
  3715
  3716*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  3717     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  3718     12  FILLER                            PIC X.
  3719*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  3720     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  3721
  3722     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  3723         88  CERT-ADDED-BATCH                 VALUE ' '.
  3724         88  CERT-ADDED-ONLINE                VALUE '1'.
  3725         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  3726         88  CERT-PURGED-OFFLINE              VALUE '3'.
  3727         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  3728     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  3729         88  CERT-AS-LOADED                   VALUE ' '.
  3730         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  3731         88  CERT-CLAIM-ONLINE                VALUE '2'.
  3732         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  3733         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  3734         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  3735         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  3736         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  3737
  3738     12  CM-ACCOUNT-COMM-PCTS.
  3739         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  70
* EL131.cbl
  3740         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3741
  3742     12  CM-USER-FIELD                     PIC X.
  3743     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  3744     12  CM-CLP-STATE                      PIC XX.
  3745     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  3746     12  CM-USER-RESERVED                  PIC XXX.
  3747     12  FILLER REDEFINES CM-USER-RESERVED.
  3748         16  CM-AH-CLASS-CD                PIC XX.
  3749         16  F                             PIC X.
  3750******************************************************************
  3751
  3752*                                COPY ELCTRLR.
  3753******************************************************************
  3754*                                                                *
  3755*                            ELCTRLR.                            *
  3756*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3757*                            VMOD=2.014                          *
  3758*                                                                *
  3759*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  3760*                                                                *
  3761*   FILE TYPE = VSAM,KSDS                                        *
  3762*   RECORD SIZE = 200    RECFORM = FIXED                         *
  3763*                                                                *
  3764*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  3765*       ALTERNATE INDEX = NONE                                   *
  3766*                                                                *
  3767*   LOG = YES                                                    *
  3768*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3769******************************************************************
  3770*                   C H A N G E   L O G
  3771*
  3772* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3773*-----------------------------------------------------------------
  3774*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3775* EFFECTIVE    NUMBER
  3776*-----------------------------------------------------------------
  3777* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3778* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  3779* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  3780* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  3781* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  3782* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  3783* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  3784* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  3785* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  3786* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  3787* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  3788* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  3789* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  3790******************************************************************
  3791 01  ACTIVITY-TRAILERS.
  3792     12  AT-RECORD-ID                    PIC XX.
  3793         88  VALID-AT-ID                       VALUE 'AT'.
  3794
  3795     12  AT-CONTROL-PRIMARY.
  3796         16  AT-COMPANY-CD               PIC X.
  3797         16  AT-CARRIER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  71
* EL131.cbl
  3798         16  AT-CLAIM-NO                 PIC X(7).
  3799         16  AT-CERT-NO.
  3800             20  AT-CERT-PRIME           PIC X(10).
  3801             20  AT-CERT-SFX             PIC X.
  3802         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  3803             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  3804             88  AT-LAST-TRL-AVAIL            VALUE +100.
  3805             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  3806             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  3807             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  3808             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  3809             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  3810             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  3811             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  3812             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  3813             88  AT-DIAGNOSIS-TRL             VALUE +90.
  3814             88  AT-BENEFICIARY-TRL           VALUE +91.
  3815             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  3816             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  3817
  3818     12  AT-TRAILER-TYPE                 PIC X.
  3819         88  RESERVE-EXPENSE-TR               VALUE '1'.
  3820         88  PAYMENT-TR                       VALUE '2'.
  3821         88  AUTO-PAY-TR                      VALUE '3'.
  3822         88  CORRESPONDENCE-TR                VALUE '4'.
  3823         88  ADDRESS-TR                       VALUE '5'.
  3824         88  GENERAL-INFO-TR                  VALUE '6'.
  3825         88  AUTO-PROMPT-TR                   VALUE '7'.
  3826         88  DENIAL-TR                        VALUE '8'.
  3827         88  INCURRED-CHG-TR                  VALUE '9'.
  3828         88  FORM-CONTROL-TR                  VALUE 'A'.
  3829
  3830     12  AT-RECORDED-DT                  PIC XX.
  3831     12  AT-RECORDED-BY                  PIC X(4).
  3832     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  3833
  3834     12  AT-TRAILER-BODY                 PIC X(165).
  3835
  3836     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  3837         16  AT-RESERVE-CONTROLS.
  3838             20  AT-MANUAL-SW            PIC X.
  3839                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  3840             20  AT-FUTURE-SW            PIC X.
  3841                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  3842             20  AT-PTC-SW               PIC X.
  3843                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  3844             20  AT-IBNR-SW              PIC X.
  3845                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  3846             20  AT-PTC-LF-SW            PIC X.
  3847                 88  AT-LF-PTC-USED          VALUE '1'.
  3848             20  AT-CDT-ACCESS-METHOD    PIC X.
  3849                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  3850                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  3851                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  3852             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  3853         16  AT-LAST-COMPUTED-DT         PIC XX.
  3854         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  3855         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  72
* EL131.cbl
  3856         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  3857         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  3858         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  3859         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  3860         16  AT-EXPENSE-CONTROLS.
  3861             20  AT-EXPENSE-METHOD       PIC X.
  3862                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  3863                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  3864                 88  PERCENT-OF-PMT           VALUE '3'.
  3865                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  3866             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  3867             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  3868         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  3869         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  3870
  3871         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  3872         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  3873
  3874*        16  FILLER                      PIC X(53).
  3875         16  FILLER                      PIC X(47).
  3876
  3877         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  3878         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  3879
  3880         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  3881             20  AT-OPEN-CLOSE-DATE      PIC XX.
  3882             20  AT-OPEN-CLOSE-TYPE      PIC X.
  3883*                    C = CLOSED
  3884*                    O = OPEN
  3885             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  3886*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  3887
  3888     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  3889         16  AT-PAYMENT-TYPE             PIC X.
  3890             88  PARTIAL-PAYMENT                VALUE '1'.
  3891             88  FINAL-PAYMENT                  VALUE '2'.
  3892             88  LUMP-SUM-PAYMENT               VALUE '3'.
  3893             88  ADDITIONAL-PAYMENT             VALUE '4'.
  3894             88  CHARGEABLE-EXPENSE             VALUE '5'.
  3895             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  3896             88  VOIDED-PAYMENT                 VALUE '9'.
  3897             88  TRANSFER                       VALUE 'T'.
  3898             88  LIFE-INTEREST                  VALUE 'I'.
  3899
  3900         16  AT-CLAIM-TYPE               PIC X.
  3901             88  PAID-FOR-AH                    VALUE 'A'.
  3902             88  PAID-FOR-LIFE                  VALUE 'L'.
  3903             88  PAID-FOR-IUI                   VALUE 'I'.
  3904             88  PAID-FOR-GAP                   VALUE 'G'.
  3905         16  AT-CLAIM-PREM-TYPE          PIC X.
  3906             88  AT-SINGLE-PREMIUM              VALUE '1'.
  3907             88  AT-O-B-COVERAGE                VALUE '2'.
  3908             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  3909         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  3910         16  AT-CHECK-NO                 PIC X(7).
  3911         16  AT-PAID-FROM-DT             PIC XX.
  3912         16  AT-PAID-THRU-DT             PIC XX.
  3913         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  73
* EL131.cbl
  3914         16  FILLER                      PIC X.
  3915         16  AT-PAYEES-NAME              PIC X(30).
  3916         16  AT-PAYMENT-ORIGIN           PIC X.
  3917             88  ONLINE-MANUAL-PMT              VALUE '1'.
  3918             88  ONLINE-AUTO-PMT                VALUE '2'.
  3919             88  OFFLINE-PMT                    VALUE '3'.
  3920         16  AT-CHECK-WRITTEN-DT         PIC XX.
  3921         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  3922         16  AT-VOID-DATA.
  3923             20  AT-VOID-DT              PIC XX.
  3924*00144       20  AT-VOID-REASON          PIC X(30).
  3925             20  AT-VOID-REASON          PIC X(26).
  3926         16  AT-PMT-APPROVED-BY          PIC X(04).
  3927         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  3928         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  3929         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  3930                                         PIC S99V9(5)  COMP-3.
  3931         16  AT-CREDIT-INTERFACE.
  3932             20  AT-PMT-SELECT-DT        PIC XX.
  3933                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  3934             20  AT-PMT-ACCEPT-DT        PIC XX.
  3935                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  3936             20  AT-VOID-SELECT-DT       PIC XX.
  3937                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  3938             20  AT-VOID-ACCEPT-DT       PIC XX.
  3939                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  3940
  3941         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  3942                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3943                 88  CONVERSION-PAYMENT           VALUE +99999999.
  3944         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  3945
  3946         16  AT-FORCE-CONTROL            PIC X.
  3947             88  PAYMENT-WAS-FORCED           VALUE '1'.
  3948         16  AT-PREV-LAST-PMT-DT         PIC XX.
  3949         16  AT-PREV-PAID-THRU-DT        PIC XX.
  3950         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  3951         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  3952         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  3953         16  AT-BENEFIT-TYPE             PIC X.
  3954
  3955         16  AT-EXPENSE-TYPE             PIC X.
  3956         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  3957
  3958         16  AT-PAYEE-TYPE-CD.
  3959             20  AT-PAYEE-TYPE           PIC X.
  3960                 88  INSURED-PAID           VALUE 'I'.
  3961                 88  BENEFICIARY-PAID       VALUE 'B'.
  3962                 88  ACCOUNT-PAID           VALUE 'A'.
  3963                 88  OTHER-1-PAID           VALUE 'O'.
  3964                 88  OTHER-2-PAID           VALUE 'Q'.
  3965                 88  DOCTOR-PAID            VALUE 'P'.
  3966                 88  EMPLOYER-PAID          VALUE 'E'.
  3967             20  AT-PAYEE-SEQ            PIC X.
  3968
  3969         16  AT-CASH-PAYMENT             PIC X.
  3970         16  AT-GROUPED-PAYMENT          PIC X.
  3971         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  74
* EL131.cbl
  3972         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  3973         16  AT-APPROVED-LEVEL           PIC X.
  3974         16  AT-VOID-TYPE                PIC X.
  3975             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  3976             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  3977         16  AT-AIG-UNEMP-IND            PIC X.
  3978             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  3979         16  AT-ASSOCIATES               PIC X.
  3980             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  3981             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  3982
  3983         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  3984         16  AT-CV-PMT-CODE              PIC X.
  3985             88  FULL-DEATH-PAYMENT         VALUE '1'.
  3986             88  HALF-DEATH-PAYMENT         VALUE '2'.
  3987             88  FULL-ADD-PAYMENT           VALUE '3'.
  3988             88  HALF-ADD-PAYMENT           VALUE '4'.
  3989             88  FULL-RIDER-PAYMENT         VALUE '5'.
  3990             88  HALF-RIDER-PAYMENT         VALUE '6'.
  3991             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  3992             88  ADDL-PAYMENT               VALUE '8'.
  3993
  3994         16  AT-EOB-CODE1                PIC XXX.
  3995         16  AT-EOB-CODE2                PIC XXX.
  3996         16  AT-EOB-CODE3                PIC XXX.
  3997         16  AT-EOB-CODE4                PIC XXX.
  3998         16  FILLER REDEFINES AT-EOB-CODE4.
  3999             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4000             20  FILLER                  PIC X.
  4001         16  AT-EOB-CODE5                PIC XXX.
  4002         16  FILLER REDEFINES AT-EOB-CODE5.
  4003             20  AT-PMT-PROOF-DT         PIC XX.
  4004             20  FILLER                  PIC X.
  4005
  4006         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4007             88  AT-PRINT-EOB            VALUE 'Y'.
  4008
  4009         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4010         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4011
  4012     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4013         16  AT-SCHEDULE-START-DT        PIC XX.
  4014         16  AT-SCHEDULE-END-DT          PIC XX.
  4015         16  AT-TERMINATED-DT            PIC XX.
  4016         16  AT-LAST-PMT-TYPE            PIC X.
  4017             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4018             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4019         16  AT-FIRST-PMT-DATA.
  4020             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4021             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4022             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4023         16  AT-REGULAR-PMT-DATA.
  4024             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4025             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4026             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4027         16  AT-AUTO-PAYEE-CD.
  4028             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4029                 88  INSURED-PAID-AUTO      VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  75
* EL131.cbl
  4030                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4031                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4032                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4033                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4034             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4035         16  AT-AUTO-PAY-DAY             PIC 99.
  4036         16  AT-AUTO-CASH                PIC X.
  4037             88  AT-CASH                      VALUE 'Y'.
  4038             88  AT-NON-CASH                  VALUE 'N'.
  4039*        16  FILLER                      PIC X(129).
  4040         16  AT-AUTO-END-LETTER          PIC X(4).
  4041         16  FILLER                      PIC X(125).
  4042
  4043         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4044         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4045
  4046     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4047         16  AT-LETTER-SENT-DT           PIC XX.
  4048         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4049         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4050         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4051         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4052         16  AT-LETTER-ORIGIN            PIC X.
  4053             88  ONLINE-CREATION              VALUE '1' '3'.
  4054             88  OFFLINE-CREATION             VALUE '2' '4'.
  4055             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4056             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4057         16  AT-STD-LETTER-FORM          PIC X(4).
  4058         16  AT-REASON-TEXT              PIC X(70).
  4059         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4060         16  AT-ADDRESEE-TYPE            PIC X.
  4061              88  INSURED-ADDRESEE            VALUE 'I'.
  4062              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4063              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4064              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4065              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4066              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4067              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4068         16  AT-ADDRESSEE-NAME           PIC X(30).
  4069         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4070         16  AT-RESEND-PRINT-DATE        PIC XX.
  4071         16  AT-CORR-SOL-UNSOL           PIC X.
  4072         16  AT-LETTER-PURGED-DT         PIC XX.
  4073*
  4074*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4075*
  4076         16  AT-CSO-REDEFINITION.
  4077             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4078             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4079             20  AT-LETTER-TO-BENE       PIC X(1).
  4080             20  AT-STOP-LETTER-DT       PIC X(2).
  4081             20  FILLER                  PIC X(19).
  4082*             20  FILLER                  PIC X(27).
  4083             20  AT-CSO-LETTER-STATUS    PIC X.
  4084                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4085                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4086                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4087             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  76
* EL131.cbl
  4088             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4089*
  4090*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4091*
  4092*        16  FILLER                      PIC X(26).
  4093*
  4094*        16  AT-DMD-BSR-CODE             PIC X.
  4095*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4096*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4097*
  4098*        16  AT-DMD-LETTER-STATUS        PIC X.
  4099*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4100*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4101*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4102*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4103*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4104
  4105         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4106         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4107
  4108     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4109         16  AT-ADDRESS-TYPE             PIC X.
  4110             88  INSURED-ADDRESS               VALUE 'I'.
  4111             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4112             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4113             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4114             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4115             88  OTHER-ADDRESS-1               VALUE 'O'.
  4116             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4117         16  AT-MAIL-TO-NAME             PIC X(30).
  4118         16  AT-ADDRESS-LINE-1           PIC X(30).
  4119         16  AT-ADDRESS-LINE-2           PIC X(30).
  4120         16  AT-CITY-STATE.
  4121             20  AT-CITY                 PIC X(28).
  4122             20  AT-STATE                PIC XX.
  4123         16  AT-ZIP.
  4124             20  AT-ZIP-CODE.
  4125                 24  AT-ZIP-1ST          PIC X.
  4126                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4127                 24  FILLER              PIC X(4).
  4128             20  AT-ZIP-PLUS4            PIC X(4).
  4129         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4130             20  AT-CAN-POSTAL-1         PIC XXX.
  4131             20  AT-CAN-POSTAL-2         PIC XXX.
  4132             20  FILLER                  PIC XXX.
  4133         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4134*         16  FILLER                      PIC X(23).
  4135         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4136         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4137         16  FILLER                      PIC X(13).
  4138         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4139         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4140
  4141     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4142         16  AT-INFO-LINE-1              PIC X(60).
  4143         16  AT-INFO-LINE-2              PIC X(60).
  4144         16  AT-INFO-TRAILER-TYPE        PIC X.
  4145             88  AT-PAYMENT-NOTE         VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  77
* EL131.cbl
  4146             88  AT-CALL-NOTE            VALUE 'C'.
  4147             88  AT-MAINT-NOTE           VALUE 'M'.
  4148             88  AT-CERT-CHANGE          VALUE 'X'.
  4149             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4150             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4151         16  AT-CALL-TYPE                PIC X.
  4152             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4153             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4154         16  AT-NOTE-CONTINUATION        PIC X.
  4155             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4156         16  AT-EOB-CODES-EXIST          PIC X.
  4157             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4158         16  FILLER                      PIC X(35).
  4159         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4160         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4161
  4162     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4163         16  AT-PROMPT-LINE-1            PIC X(60).
  4164         16  AT-PROMPT-LINE-2            PIC X(60).
  4165         16  AT-PROMPT-START-DT          PIC XX.
  4166         16  AT-PROMPT-END-DT            PIC XX.
  4167         16  FILLER                      PIC X(35).
  4168         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4169         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4170
  4171     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4172         16  AT-DENIAL-INFO-1            PIC X(60).
  4173         16  AT-DENIAL-INFO-2            PIC X(60).
  4174         16  AT-DENIAL-DT                PIC XX.
  4175         16  AT-RETRACTION-DT            PIC XX.
  4176         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4177*         16  FILLER                      PIC X(31).
  4178         16  AT-DENIAL-PROOF-DT          PIC XX.
  4179         16  FILLER                      PIC X(29).
  4180         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4181         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4182
  4183     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4184         16  AT-OLD-INCURRED-DT          PIC XX.
  4185         16  AT-OLD-REPORTED-DT          PIC XX.
  4186         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4187         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4188         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4189         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4190         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4191         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4192         16  FILLER                      PIC X(26).
  4193         16  AT-OLD-DIAG-CODE            PIC X(6).
  4194         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4195         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4196         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4197         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4198         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4199         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4200         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4201         16  FILLER                      PIC X(25).
  4202         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4203
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  78
* EL131.cbl
  4204     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4205         16  AT-FORM-SEND-ON-DT          PIC XX.
  4206         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4207         16  AT-FORM-RE-SEND-DT          PIC XX.
  4208         16  AT-FORM-ANSWERED-DT         PIC XX.
  4209         16  AT-FORM-PRINTED-DT          PIC XX.
  4210         16  AT-FORM-REPRINT-DT          PIC XX.
  4211         16  AT-FORM-TYPE                PIC X.
  4212             88  INITIAL-FORM                  VALUE '1'.
  4213             88  PROGRESS-FORM                 VALUE '2'.
  4214         16  AT-INSTRUCT-LN-1            PIC X(28).
  4215         16  AT-INSTRUCT-LN-2            PIC X(28).
  4216         16  AT-INSTRUCT-LN-3            PIC X(28).
  4217         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4218         16  AT-FORM-ADDRESS             PIC X.
  4219             88  FORM-TO-INSURED              VALUE 'I'.
  4220             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4221             88  FORM-TO-OTHER-1              VALUE 'O'.
  4222             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4223         16  AT-RELATED-1.
  4224             20 AT-REL-CARR-1            PIC X.
  4225             20 AT-REL-CLAIM-1           PIC X(7).
  4226             20 AT-REL-CERT-1            PIC X(11).
  4227         16  AT-RELATED-2.
  4228             20 AT-REL-CARR-2            PIC X.
  4229             20 AT-REL-CLAIM-2           PIC X(7).
  4230             20 AT-REL-CERT-2            PIC X(11).
  4231         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4232         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4233         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4234         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4235         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4236         16  AT-STOP-FORM-DT             PIC X(2).
  4237
  4238         16  FILLER                      PIC X(09).
  4239         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4240         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4241******************************************************************
  4242
  4243*                                COPY ELCCNTL.
  4244******************************************************************
  4245*                                                                *
  4246*                                                                *
  4247*                            ELCCNTL.                            *
  4248*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4249*                            VMOD=2.059                          *
  4250*                                                                *
  4251*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4252*                                                                *
  4253*   FILE TYPE = VSAM,KSDS                                        *
  4254*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4255*                                                                *
  4256*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4257*       ALTERNATE INDEX = NONE                                   *
  4258*                                                                *
  4259*   LOG = YES                                                    *
  4260*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4261******************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  79
* EL131.cbl
  4262*                   C H A N G E   L O G
  4263*
  4264* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4265*-----------------------------------------------------------------
  4266*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4267* EFFECTIVE    NUMBER
  4268*-----------------------------------------------------------------
  4269* 082503                   PEMA  ADD BENEFIT GROUP
  4270* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4271* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4272* 092705    2005050300006  PEMA  ADD SPP LEASES
  4273* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4274* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4275* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4276* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4277* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4278* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4279* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4280******************************************************************
  4281*
  4282 01  CONTROL-FILE.
  4283     12  CF-RECORD-ID                       PIC XX.
  4284         88  VALID-CF-ID                        VALUE 'CF'.
  4285
  4286     12  CF-CONTROL-PRIMARY.
  4287         16  CF-COMPANY-ID                  PIC XXX.
  4288         16  CF-RECORD-TYPE                 PIC X.
  4289             88  CF-COMPANY-MASTER              VALUE '1'.
  4290             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4291             88  CF-STATE-MASTER                VALUE '3'.
  4292             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4293             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4294             88  CF-CARRIER-MASTER              VALUE '6'.
  4295             88  CF-MORTALITY-MASTER            VALUE '7'.
  4296             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4297             88  CF-TERMINAL-MASTER             VALUE '9'.
  4298             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4299             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4300             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4301             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4302             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4303             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4304             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4305             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4306             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4307         16  CF-ACCESS-CD-GENL              PIC X(4).
  4308         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4309             20  CF-PROCESSOR               PIC X(4).
  4310         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4311             20  CF-STATE-CODE              PIC XX.
  4312             20  FILLER                     PIC XX.
  4313         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4314             20  FILLER                     PIC XX.
  4315             20  CF-HI-BEN-IN-REC           PIC XX.
  4316         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4317             20  FILLER                     PIC XXX.
  4318             20  CF-CARRIER-CNTL            PIC X.
  4319         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  80
* EL131.cbl
  4320             20  FILLER                     PIC XX.
  4321             20  CF-HI-TYPE-IN-REC          PIC 99.
  4322         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4323             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4324                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4325             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4326             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4327         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4328             20  FILLER                     PIC X.
  4329             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4330         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4331             20  FILLER                     PIC XX.
  4332             20  CF-MORTGAGE-PLAN           PIC XX.
  4333         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4334
  4335     12  CF-LAST-MAINT-DT                   PIC XX.
  4336     12  CF-LAST-MAINT-BY                   PIC X(4).
  4337     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4338
  4339     12  CF-RECORD-BODY                     PIC X(728).
  4340
  4341
  4342****************************************************************
  4343*             COMPANY MASTER RECORD                            *
  4344****************************************************************
  4345
  4346     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4347         16  CF-COMPANY-ADDRESS.
  4348             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4349             20  CF-CL-IN-CARE-OF           PIC X(30).
  4350             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4351             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4352             20  CF-CL-CITY-STATE           PIC X(30).
  4353             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4354             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4355         16  CF-COMPANY-CD                  PIC X.
  4356         16  CF-COMPANY-PASSWORD            PIC X(8).
  4357         16  CF-SECURITY-OPTION             PIC X.
  4358             88  ALL-SECURITY                   VALUE '1'.
  4359             88  COMPANY-VERIFY                 VALUE '2'.
  4360             88  PROCESSOR-VERIFY               VALUE '3'.
  4361             88  NO-SECURITY                    VALUE '4'.
  4362             88  ALL-BUT-TERM                   VALUE '5'.
  4363         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4364             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4365         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4366             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4367         16  CF-INFORCE-LOCATION            PIC X.
  4368             88  CERTS-ARE-ONLINE               VALUE '1'.
  4369             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4370             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4371         16  CF-LOWER-CASE-LETTERS          PIC X.
  4372         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4373             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4374             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4375             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4376             88  CF-ACCNT-CNTL                  VALUE '3'.
  4377             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  81
* EL131.cbl
  4378
  4379         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4380         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4381
  4382         16  CF-LGX-CREDIT-USER             PIC X.
  4383             88  CO-IS-NOT-USER                 VALUE 'N'.
  4384             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4385
  4386         16 CF-CREDIT-CALC-CODES.
  4387             20  CF-CR-REM-TERM-CALC PIC X.
  4388               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4389               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4390               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4391               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4392               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4393               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4394               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4395             20  CF-CR-R78-METHOD           PIC X.
  4396               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4397               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4398
  4399         16  CF-CLAIM-CONTROL-COUNTS.
  4400             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4401                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4402
  4403             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4404                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4405
  4406             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4407                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4408
  4409             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4410                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4411
  4412         16  CF-CURRENT-MONTH-END           PIC XX.
  4413
  4414         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4415             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4416             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4417             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4418             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4419                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4420                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4421             20  CF-CO-PREM-REJECT-SW       PIC X.
  4422                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4423                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4424             20  CF-CO-REF-REJECT-SW        PIC X.
  4425                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4426                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4427
  4428         16  CF-CO-REPORTING-DT             PIC XX.
  4429         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4430         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4431           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4432           88  CF-CO-MONTH-END                  VALUE '1'.
  4433
  4434         16  CF-LGX-CLAIM-USER              PIC X.
  4435             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  82
* EL131.cbl
  4436             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4437
  4438         16  CF-CREDIT-EDIT-CONTROLS.
  4439             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4440             20  CF-MIN-AGE                 PIC 99.
  4441             20  CF-DEFAULT-AGE             PIC 99.
  4442             20  CF-MIN-TERM                PIC S999      COMP-3.
  4443             20  CF-MAX-TERM                PIC S999      COMP-3.
  4444             20  CF-DEFAULT-SEX             PIC X.
  4445             20  CF-JOINT-AGE-INPUT         PIC X.
  4446                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4447             20  CF-BIRTH-DATE-INPUT        PIC X.
  4448                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4449             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4450                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4451                 88  CF-ZERO-CARRIER            VALUE '1'.
  4452                 88  CF-ZERO-GROUPING           VALUE '2'.
  4453                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4454             20  CF-EDIT-SW                 PIC X.
  4455                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4456             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4457             20  CF-CR-PR-METHOD            PIC X.
  4458               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4459               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4460             20  FILLER                     PIC X.
  4461
  4462         16  CF-CREDIT-MISC-CONTROLS.
  4463             20  CF-REIN-TABLE-SW           PIC X.
  4464                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4465             20  CF-COMP-TABLE-SW           PIC X.
  4466                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4467             20  CF-EXPERIENCE-RETENTION-AGE
  4468                                            PIC S9        COMP-3.
  4469             20  CF-CONVERSION-DT           PIC XX.
  4470             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4471             20  CF-RUN-FREQUENCY-SW        PIC X.
  4472                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4473                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4474
  4475             20  CF-CR-CHECK-NO-CONTROL.
  4476                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4477                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4478                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4479                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4480                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4481                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4482
  4483                 24  CF-CR-CHECK-COUNT       REDEFINES
  4484                     CF-CR-CHECK-COUNTER      PIC X(4).
  4485
  4486                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4487                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4488
  4489                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4490                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4491                 24  CF-MAIL-PROCESSING       PIC X.
  4492                     88  MAIL-PROCESSING          VALUE 'Y'.
  4493
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  83
* EL131.cbl
  4494         16  CF-MISC-SYSTEM-CONTROL.
  4495             20  CF-SYSTEM-C                 PIC X.
  4496                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4497             20  CF-SYSTEM-D                 PIC X.
  4498                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4499             20  CF-SOC-SEC-NO-SW            PIC X.
  4500                 88  SOC-SEC-NO-USED             VALUE '1'.
  4501             20  CF-MEMBER-NO-SW             PIC X.
  4502                 88  MEMBER-NO-USED              VALUE '1'.
  4503             20  CF-TAX-ID-NUMBER            PIC X(11).
  4504             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4505             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4506                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4507                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4508                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4509                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4510             20  CF-SYSTEM-E                 PIC X.
  4511                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4512
  4513         16  CF-LGX-LIFE-USER               PIC X.
  4514             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4515             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4516
  4517         16  CF-CR-MONTH-END-DT             PIC XX.
  4518
  4519         16  CF-FILE-MAINT-DATES.
  4520             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4521                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4522             20  CF-LAST-BATCH       REDEFINES
  4523                 CF-LAST-BATCH-NO               PIC X(4).
  4524             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4525             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4526             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4527             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4528             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4529             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4530             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4531             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4532             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4533             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4534
  4535         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4536         16  FILLER                         PIC X.
  4537
  4538         16  CF-ALT-MORT-CODE               PIC X(4).
  4539         16  CF-MEMBER-CAPTION              PIC X(10).
  4540
  4541         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4542             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4543             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4544             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4545             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4546             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4547
  4548         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4549
  4550         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4551         16  CF-LIFE-OVERRIDE-L2            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  84
* EL131.cbl
  4552         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4553         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4554
  4555         16  CF-AH-OVERRIDE-L1              PIC X.
  4556         16  CF-AH-OVERRIDE-L2              PIC XX.
  4557         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4558         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4559
  4560         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4561         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4562
  4563         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4564         16  CF-AR-LAST-EL860-DT            PIC XX.
  4565         16  CF-MP-MONTH-END-DT             PIC XX.
  4566
  4567         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4568         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4569             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4570
  4571         16  CF-AR-MONTH-END-DT             PIC XX.
  4572
  4573         16  CF-CRDTCRD-USER                PIC X.
  4574             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4575             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4576
  4577         16  CF-CC-MONTH-END-DT             PIC XX.
  4578
  4579         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4580
  4581         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4582             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4583             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4584             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4585         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4586         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4587         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4588         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4589             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4590             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4591         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4592         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4593         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4594             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4595         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4596
  4597         16  CF-CL-ZIP-CODE.
  4598             20  CF-CL-ZIP-PRIME.
  4599                 24  CF-CL-ZIP-1ST          PIC X.
  4600                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4601                 24  FILLER                 PIC X(4).
  4602             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4603         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4604             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4605             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4606             20  FILLER                     PIC XXX.
  4607
  4608         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4609         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  85
* EL131.cbl
  4610         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4611         16  CF-CO-OPTION-START-DATE        PIC XX.
  4612         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4613           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4614                                                      '3' '4'.
  4615           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4616           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4617           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4618           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4619           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4620           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4621
  4622         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4623
  4624         16  CF-PAYMENT-APPROVAL-LEVELS.
  4625             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4626             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4627             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4628             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4629             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4630             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4631
  4632         16  CF-END-USER-REPORTING-USER     PIC X.
  4633             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4634             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4635
  4636         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4637             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4638             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4639
  4640         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4641
  4642         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4643         16  FILLER                         PIC X.
  4644
  4645         16  CF-CREDIT-ARCHIVE-CNTL.
  4646             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4647             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4648             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4649
  4650         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4651
  4652         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4653             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4654             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4655
  4656         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4657             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4658             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4659
  4660         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4661
  4662         16  CF-CO-ACH-ID-CODE              PIC  X.
  4663             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4664             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4665             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4666         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4667         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  86
* EL131.cbl
  4668         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4669         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4670         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4671         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4672         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4673         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4674         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4675                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4676         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4677                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4678
  4679         16  CF-CO-OVER-SHORT.
  4680             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4681             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4682
  4683*         16  FILLER                         PIC X(102).
  4684         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4685             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4686             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4687
  4688         16  CF-AH-APPROVAL-DAYS.
  4689             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4690             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4691             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4692             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4693
  4694         16  FILLER                         PIC X(82).
  4695****************************************************************
  4696*             PROCESSOR/USER RECORD                            *
  4697****************************************************************
  4698
  4699     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4700         16  CF-PROCESSOR-NAME              PIC X(30).
  4701         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4702         16  CF-PROCESSOR-TITLE             PIC X(26).
  4703         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4704                 88  MESSAGE-YES                VALUE 'Y'.
  4705                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4706
  4707*****************************************************
  4708****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4709****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4710****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4711****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4712*****************************************************
  4713
  4714         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4715             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4716             20  CF-APPLICATION-FORCE       PIC X.
  4717             20  CF-INDIVIDUAL-APP.
  4718                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4719                     28  CF-BROWSE-APP      PIC X.
  4720                     28  CF-UPDATE-APP      PIC X.
  4721
  4722         16  CF-CURRENT-TERM-ON             PIC X(4).
  4723         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4724             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4725             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  87
* EL131.cbl
  4726             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4727             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4728             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4729             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4730             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4731         16  CF-PROCESSOR-CARRIER           PIC X.
  4732             88  NO-CARRIER-SECURITY            VALUE ' '.
  4733         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4734             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4735         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4736             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4737         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4738             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4739
  4740         16  CF-PROC-SYS-ACCESS-SW.
  4741             20  CF-PROC-CREDIT-CLAIMS-SW.
  4742                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4743                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4744                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4745                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4746             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4747                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4748                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4749             20  CF-PROC-LIFE-GNRLDGR-SW.
  4750                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4751                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4752                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4753                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4754             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4755                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4756                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4757         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4758             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4759             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4760         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4761
  4762         16  CF-APPROVAL-LEVEL                  PIC X.
  4763             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4764             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4765             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4766             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4767
  4768         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4769
  4770         16  CF-LANGUAGE-TYPE                   PIC X.
  4771             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4772             88  CF-LANG-IS-FR                      VALUE 'F'.
  4773
  4774         16  CF-CSR-IND                         PIC X.
  4775         16  FILLER                             PIC X(239).
  4776
  4777****************************************************************
  4778*             PROCESSOR/REMINDERS RECORD                       *
  4779****************************************************************
  4780
  4781     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4782         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4783             20  CF-START-REMIND-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  88
* EL131.cbl
  4784             20  CF-END-REMIND-DT           PIC XX.
  4785             20  CF-REMINDER-TEXT           PIC X(50).
  4786         16  FILLER                         PIC X(296).
  4787
  4788
  4789****************************************************************
  4790*             STATE MASTER RECORD                              *
  4791****************************************************************
  4792
  4793     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4794         16  CF-STATE-ABBREVIATION          PIC XX.
  4795         16  CF-STATE-NAME                  PIC X(25).
  4796         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4797         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4798             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4799             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4800             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4801             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4802                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4803                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4804             20  CF-ST-PREM-REJECT-SW       PIC X.
  4805                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4806                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4807             20  CF-ST-REF-REJECT-SW        PIC X.
  4808                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4809                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4810         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4811         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4812         16  CF-ST-REFUND-RULES.
  4813             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4814             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4815             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4816         16  CF-ST-FST-PMT-EXTENSION.
  4817             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4818             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4819                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4820                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4821                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4822                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4823         16  CF-ST-STATE-CALL.
  4824             20  CF-ST-CALL-UNEARNED        PIC X.
  4825             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4826             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4827         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4828             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4829             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4830         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4831         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4832         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4833         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4834         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4835         16  FILLER                         PIC X.
  4836         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4837             20  CF-ST-BENEFIT-CD           PIC XX.
  4838             20  CF-ST-BENEFIT-KIND         PIC X.
  4839                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4840                 88  CF-ST-AH-KIND              VALUE 'A'.
  4841             20  CF-ST-REM-TERM-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  89
* EL131.cbl
  4842                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4843                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4844                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4845                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4846                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4847                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4848                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4849                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4850
  4851             20  CF-ST-REFUND-CALC          PIC X.
  4852                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4853                 88  ST-REFD-BY-R78             VALUE '1'.
  4854                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4855                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4856                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4857                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4858                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4859                 88  ST-REFD-UTAH               VALUE '7'.
  4860                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4861                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4862                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4863
  4864             20  CF-ST-EARNING-CALC         PIC X.
  4865                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4866                 88  ST-EARN-BY-R78             VALUE '1'.
  4867                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4868                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4869                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4870                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4871                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4872                 88  ST-EARN-MEAN               VALUE '8'.
  4873                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4874
  4875             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4876                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4877                 88  ST-OVRD-BY-R78             VALUE '1'.
  4878                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4879                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4880                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4881                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4882                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4883                 88  ST-OVRD-MEAN               VALUE '8'.
  4884                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4885             20  FILLER                     PIC X.
  4886
  4887         16  CF-ST-COMMISSION-CAPS.
  4888             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4889             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4890             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4891             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4892         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4893                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4894
  4895         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4896
  4897         16  CF-ST-STATUTORY-INTEREST.
  4898             20  CF-ST-STAT-DATE-FROM       PIC X.
  4899                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  90
* EL131.cbl
  4900                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4901             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4902             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4903             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4904             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4905             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4906
  4907         16  CF-ST-OVER-SHORT.
  4908             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4909             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4910
  4911         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4912
  4913         16  CF-ST-RT-CALC                  PIC X.
  4914
  4915         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4916         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4917         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4918         16  CF-ST-RF-LR-CALC               PIC X.
  4919         16  CF-ST-RF-LL-CALC               PIC X.
  4920         16  CF-ST-RF-LN-CALC               PIC X.
  4921         16  CF-ST-RF-AH-CALC               PIC X.
  4922         16  CF-ST-RF-CP-CALC               PIC X.
  4923*        16  FILLER                         PIC X(206).
  4924*CIDMOD         16  FILLER                         PIC X(192).
  4925         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4926             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4927         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4928         16  CF-ST-VFY-2ND-BENE             PIC X.
  4929         16  CF-ST-CAUSAL-STATE             PIC X.
  4930         16  FILLER                         PIC X(185).
  4931
  4932****************************************************************
  4933*             BENEFIT MASTER RECORD                            *
  4934****************************************************************
  4935
  4936     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4937         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4938             20  CF-BENEFIT-CODE            PIC XX.
  4939             20  CF-BENEFIT-NUMERIC  REDEFINES
  4940                 CF-BENEFIT-CODE            PIC XX.
  4941             20  CF-BENEFIT-ALPHA           PIC XXX.
  4942             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4943             20  CF-BENEFIT-COMMENT         PIC X(10).
  4944
  4945             20  CF-LF-COVERAGE-TYPE        PIC X.
  4946                 88  CF-REDUCING                VALUE 'R'.
  4947                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4948
  4949             20  CF-SPECIAL-CALC-CD         PIC X.
  4950                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4951                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4952                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4953                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4954                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4955                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4956                 88  CF-FARM-PLAN               VALUE 'F'.
  4957                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  91
* EL131.cbl
  4958                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4959                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4960                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4961                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4962                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4963                 88  CF-PRUDENTIAL              VALUE 'P'.
  4964                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4965                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4966                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4967                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4968                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4969                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4970
  4971             20  CF-JOINT-INDICATOR         PIC X.
  4972                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4973
  4974*            20  FILLER                     PIC X(12).
  4975             20  FILLER                     PIC X(11).
  4976             20  CF-BENEFIT-CATEGORY        PIC X.
  4977             20  CF-LOAN-TYPE               PIC X(8).
  4978
  4979             20  CF-CO-REM-TERM-CALC        PIC X.
  4980                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4981                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4982                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4983                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4984                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4985
  4986             20  CF-CO-EARNINGS-CALC        PIC X.
  4987                 88  CO-EARN-BY-R78             VALUE '1'.
  4988                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4989                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4990                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4991                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4992                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4993                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4994                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4995
  4996             20  CF-CO-REFUND-CALC          PIC X.
  4997                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4998                 88  CO-REFD-BY-R78             VALUE '1'.
  4999                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5000                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5001                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5002                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5003                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5004                 88  CO-REFD-MEAN               VALUE '8'.
  5005                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5006                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5007                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5008
  5009             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5010                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5011                 88  CO-OVRD-BY-R78             VALUE '1'.
  5012                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5013                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5014                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5015                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  92
* EL131.cbl
  5016                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5017                 88  CO-OVRD-MEAN               VALUE '8'.
  5018                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5019
  5020             20  CF-CO-BEN-I-G-CD           PIC X.
  5021                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5022                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5023                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5024
  5025         16  FILLER                         PIC X(304).
  5026
  5027
  5028****************************************************************
  5029*             CARRIER MASTER RECORD                            *
  5030****************************************************************
  5031
  5032     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5033         16  CF-ADDRESS-DATA.
  5034             20  CF-MAIL-TO-NAME            PIC X(30).
  5035             20  CF-IN-CARE-OF              PIC X(30).
  5036             20  CF-ADDRESS-LINE-1          PIC X(30).
  5037             20  CF-ADDRESS-LINE-2          PIC X(30).
  5038             20  CF-CITY-STATE              PIC X(30).
  5039             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5040             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5041
  5042         16  CF-CLAIM-NO-CONTROL.
  5043             20  CF-CLAIM-NO-METHOD         PIC X.
  5044                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5045                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5046                 88  CLAIM-NO-SEQ               VALUE '3'.
  5047                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5048             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5049                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5050                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5051                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5052
  5053         16  CF-CHECK-NO-CONTROL.
  5054             20  CF-CHECK-NO-METHOD         PIC X.
  5055                 88  CHECK-NO-MANUAL            VALUE '1'.
  5056                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5057                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5058                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5059             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5060                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5061
  5062         16  CF-DOMICILE-STATE              PIC XX.
  5063
  5064         16  CF-EXPENSE-CONTROLS.
  5065             20  CF-EXPENSE-METHOD          PIC X.
  5066                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5067                 88  DOLLARS-PER-PMT            VALUE '2'.
  5068                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5069                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5070             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5071             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5072
  5073         16  CF-CORRESPONDENCE-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  93
* EL131.cbl
  5074             20  CF-LETTER-RESEND-OPT       PIC X.
  5075                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5076                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5077             20  FILLER                     PIC X(4).
  5078
  5079         16  CF-RESERVE-CONTROLS.
  5080             20  CF-MANUAL-SW               PIC X.
  5081                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5082             20  CF-FUTURE-SW               PIC X.
  5083                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5084             20  CF-PTC-SW                  PIC X.
  5085                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5086             20  CF-IBNR-SW                 PIC X.
  5087                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5088             20  CF-PTC-LF-SW               PIC X.
  5089                 88  CF-LF-PTC-USED             VALUE '1'.
  5090             20  CF-CDT-ACCESS-METHOD       PIC X.
  5091                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5092                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5093                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5094             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5095
  5096         16  CF-CLAIM-CALC-METHOD           PIC X.
  5097             88  360-PLUS-MONTHS                VALUE '1'.
  5098             88  365-PLUS-MONTHS                VALUE '2'.
  5099             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5100             88  360-DAILY                      VALUE '4'.
  5101             88  365-DAILY                      VALUE '5'.
  5102
  5103         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5104         16  FILLER                         PIC X(11).
  5105
  5106         16  CF-LIMIT-AMOUNTS.
  5107             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5108             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5109             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5110             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5111             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5112             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5113             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5114             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5115             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5116             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5117
  5118         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5119         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5120         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5121
  5122         16  CF-ZIP-CODE.
  5123             20  CF-ZIP-PRIME.
  5124                 24  CF-ZIP-1ST             PIC X.
  5125                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5126                 24  FILLER                 PIC X(4).
  5127             20  CF-ZIP-PLUS4               PIC X(4).
  5128         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5129             20  CF-CAN-POSTAL-1            PIC XXX.
  5130             20  CF-CAN-POSTAL-2            PIC XXX.
  5131             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  94
* EL131.cbl
  5132
  5133         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5134         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5135         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5136
  5137         16  CF-RATING-SWITCH               PIC X.
  5138             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5139             88  CF-NO-RATING                   VALUE 'N'.
  5140
  5141         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5142
  5143         16  CF-CARRIER-OVER-SHORT.
  5144             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5145             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5146
  5147         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5148         16  CF-SECPAY-SWITCH               PIC X.
  5149             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5150             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5151         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5152         16  FILLER                         PIC X(448).
  5153*        16  FILLER                         PIC X(452).
  5154
  5155
  5156****************************************************************
  5157*             MORTALITY MASTER RECORD                          *
  5158****************************************************************
  5159
  5160     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5161         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5162                                INDEXED BY CF-MORT-NDX.
  5163             20  CF-MORT-TABLE              PIC X(5).
  5164             20  CF-MORT-TABLE-TYPE         PIC X.
  5165                 88  CF-MORT-JOINT              VALUE 'J'.
  5166                 88  CF-MORT-SINGLE             VALUE 'S'.
  5167                 88  CF-MORT-COMBINED           VALUE 'C'.
  5168                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5169                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5170             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5171             20  CF-MORT-AGE-METHOD         PIC XX.
  5172                 88  CF-AGE-LAST                VALUE 'AL'.
  5173                 88  CF-AGE-NEAR                VALUE 'AN'.
  5174             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5175             20  CF-MORT-ADJUSTMENT-DIRECTION
  5176                                            PIC X.
  5177                 88  CF-MINUS                   VALUE '-'.
  5178                 88  CF-PLUS                    VALUE '+'.
  5179             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5180             20  CF-MORT-JOINT-CODE         PIC X.
  5181                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5182             20  CF-MORT-PC-Q               PIC X.
  5183                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5184             20  CF-MORT-TABLE-CODE         PIC X(4).
  5185             20  CF-MORT-COMMENTS           PIC X(15).
  5186             20  FILLER                     PIC X(14).
  5187
  5188         16  FILLER                         PIC X(251).
  5189
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  95
* EL131.cbl
  5190
  5191****************************************************************
  5192*             BUSSINESS TYPE MASTER RECORD                     *
  5193****************************************************************
  5194
  5195     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5196* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5197* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5198* AND RECORD 05 IS TYPES 81-99
  5199         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5200             20  CF-BUSINESS-TITLE          PIC  X(19).
  5201             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5202                                            PIC S9V9(4) COMP-3.
  5203             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5204             20  FILLER                     PIC  X.
  5205         16  FILLER                         PIC  X(248).
  5206
  5207
  5208****************************************************************
  5209*             TERMINAL MASTER RECORD                           *
  5210****************************************************************
  5211
  5212     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5213
  5214         16  CF-COMPANY-TERMINALS.
  5215             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5216                                  PIC X(4).
  5217         16  FILLER               PIC X(248).
  5218
  5219
  5220****************************************************************
  5221*             LIFE EDIT MASTER RECORD                          *
  5222****************************************************************
  5223
  5224     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5225         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5226             20  CF-LIFE-CODE-IN            PIC XX.
  5227             20  CF-LIFE-CODE-OUT           PIC XX.
  5228         16  FILLER                         PIC X(248).
  5229
  5230
  5231****************************************************************
  5232*             AH EDIT MASTER RECORD                            *
  5233****************************************************************
  5234
  5235     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5236         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5237             20  CF-AH-CODE-IN              PIC XXX.
  5238             20  CF-AH-CODE-OUT             PIC XX.
  5239         16  FILLER                         PIC X(248).
  5240
  5241
  5242****************************************************************
  5243*             CREDIBILITY TABLES                               *
  5244****************************************************************
  5245
  5246     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5247         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  96
* EL131.cbl
  5248                             INDEXED BY CF-CRDB-NDX.
  5249             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5250             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5251             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5252         16  FILLER                         PIC  X(332).
  5253
  5254
  5255****************************************************************
  5256*             REPORT CUSTOMIZATION RECORD                      *
  5257****************************************************************
  5258
  5259     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5260         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5261             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5262             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5263             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5264**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5265****       A T-TRANSFER.                                   ****
  5266             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5267
  5268         16  FILLER                         PIC XX.
  5269
  5270         16  CF-CARRIER-CNTL-OPT.
  5271             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5272                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5273                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5274             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5275                                            PIC X.
  5276         16  CF-GROUP-CNTL-OPT.
  5277             20  CF-GROUP-OPT-SEQ           PIC 9.
  5278                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5279                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5280             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5281                                            PIC X(6).
  5282         16  CF-STATE-CNTL-OPT.
  5283             20  CF-STATE-OPT-SEQ           PIC 9.
  5284                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5285                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5286             20  CF-STATE-SELECT OCCURS 3 TIMES
  5287                                            PIC XX.
  5288         16  CF-ACCOUNT-CNTL-OPT.
  5289             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5290                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5291                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5292             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5293                                            PIC X(10).
  5294         16  CF-BUS-TYP-CNTL-OPT.
  5295             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5296                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5297                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5298             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5299                                            PIC XX.
  5300         16  CF-LF-TYP-CNTL-OPT.
  5301             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5302                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5303                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5304             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5305                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  97
* EL131.cbl
  5306         16  CF-AH-TYP-CNTL-OPT.
  5307             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5308                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5309                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5310             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5311                                            PIC XX.
  5312         16  CF-REPTCD1-CNTL-OPT.
  5313             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5314                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5315                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5316             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5317                                            PIC X(10).
  5318         16  CF-REPTCD2-CNTL-OPT.
  5319             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5320                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5321                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5322             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5323                                            PIC X(10).
  5324         16  CF-USER1-CNTL-OPT.
  5325             20  CF-USER1-OPT-SEQ           PIC 9.
  5326                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5327                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5328             20  CF-USER1-SELECT OCCURS 3 TIMES
  5329                                            PIC X(10).
  5330         16  CF-USER2-CNTL-OPT.
  5331             20  CF-USER2-OPT-SEQ           PIC 9.
  5332                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5333                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5334             20  CF-USER2-SELECT OCCURS 3 TIMES
  5335                                            PIC X(10).
  5336         16  CF-USER3-CNTL-OPT.
  5337             20  CF-USER3-OPT-SEQ           PIC 9.
  5338                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5339                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5340             20  CF-USER3-SELECT OCCURS 3 TIMES
  5341                                            PIC X(10).
  5342         16  CF-USER4-CNTL-OPT.
  5343             20  CF-USER4-OPT-SEQ           PIC 9.
  5344                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5345                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5346             20  CF-USER4-SELECT OCCURS 3 TIMES
  5347                                            PIC X(10).
  5348         16  CF-USER5-CNTL-OPT.
  5349             20  CF-USER5-OPT-SEQ           PIC 9.
  5350                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5351                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5352             20  CF-USER5-SELECT OCCURS 3 TIMES
  5353                                            PIC X(10).
  5354         16  CF-REINS-CNTL-OPT.
  5355             20  CF-REINS-OPT-SEQ           PIC 9.
  5356                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5357                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5358             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5359                 24  CF-REINS-PRIME         PIC XXX.
  5360                 24  CF-REINS-SUB           PIC XXX.
  5361
  5362         16  CF-AGENT-CNTL-OPT.
  5363             20  CF-AGENT-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  98
* EL131.cbl
  5364                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5365                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5366             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5367                                            PIC X(10).
  5368
  5369         16  FILLER                         PIC X(43).
  5370
  5371         16  CF-LOSS-RATIO-SELECT.
  5372             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5373             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5374         16  CF-ENTRY-DATE-SELECT.
  5375             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5376             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5377         16  CF-EFFECTIVE-DATE-SELECT.
  5378             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5379             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5380
  5381         16  CF-EXCEPTION-LIST-IND          PIC X.
  5382             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5383
  5384         16  FILLER                         PIC X(318).
  5385
  5386****************************************************************
  5387*                  EXCEPTION REPORTING RECORD                  *
  5388****************************************************************
  5389
  5390     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5391         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5392             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5393
  5394         16  CF-COMBINED-LIFE-AH-OPT.
  5395             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5396             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5397             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5398             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5399
  5400         16  CF-LIFE-OPT.
  5401             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5402             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5403             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5404             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5405             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5406             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5407             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5408             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5409             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5410             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5411
  5412         16  CF-AH-OPT.
  5413             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5414             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5415             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5416             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5417             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5418             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5419             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5420             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5421             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page  99
* EL131.cbl
  5422             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5423
  5424         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5425             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5426             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5427             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5428
  5429         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5430
  5431         16  FILLER                         PIC X(673).
  5432
  5433
  5434****************************************************************
  5435*             MORTGAGE SYSTEM PLAN RECORD                      *
  5436****************************************************************
  5437
  5438     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5439         16  CF-PLAN-TYPE                   PIC X.
  5440             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5441             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5442             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5443         16  CF-PLAN-ABBREV                 PIC XXX.
  5444         16  CF-PLAN-DESCRIPT               PIC X(10).
  5445         16  CF-PLAN-NOTES                  PIC X(20).
  5446         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5447         16  CF-PLAN-UNDERWRITING.
  5448             20  CF-PLAN-TERM-DATA.
  5449                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5450                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5451             20  CF-PLAN-AGE-DATA.
  5452                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5453                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5454                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5455             20  CF-PLAN-BENEFIT-DATA.
  5456                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5457                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5458                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5459                                            PIC S9(7)V99  COMP-3.
  5460         16  CF-PLAN-POLICY-FORMS.
  5461             20  CF-POLICY-FORM             PIC X(12).
  5462             20  CF-MASTER-APPLICATION      PIC X(12).
  5463             20  CF-MASTER-POLICY           PIC X(12).
  5464         16  CF-PLAN-RATING.
  5465             20  CF-RATE-CODE               PIC X(5).
  5466             20  CF-SEX-RATING              PIC X.
  5467                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5468                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5469             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5470             20  CF-SUB-STD-TYPE            PIC X.
  5471                 88  CF-PCT-OF-PREM            VALUE '1'.
  5472                 88  CF-PCT-OF-BENE            VALUE '2'.
  5473         16  CF-PLAN-PREM-TOLERANCES.
  5474             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5475             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5476         16  CF-PLAN-PYMT-TOLERANCES.
  5477             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5478             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5479         16  CF-PLAN-MISC-DATA.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 100
* EL131.cbl
  5480             20  FILLER                     PIC X.
  5481             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5482             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5483         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5484         16  CF-PLAN-IND-GRP                PIC X.
  5485             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5486                                                     '1'.
  5487             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5488                                                     '2'.
  5489         16  CF-MIB-SEARCH-SW               PIC X.
  5490             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5491             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5492             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5493             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5494         16  CF-ALPHA-SEARCH-SW             PIC X.
  5495             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5496             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5497             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5498             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5499             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5500             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5501             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5502             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5503             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5504             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5505                                                     'A' 'B' 'C'
  5506                                                     'X' 'Y' 'Z'.
  5507         16  CF-EFF-DT-RULE-SW              PIC X.
  5508             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5509             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5510             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5511             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5512             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5513         16  FILLER                         PIC X(4).
  5514         16  CF-HEALTH-QUESTIONS            PIC X.
  5515             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5516         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5517         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5518         16  CF-PLAN-SNGL-JNT               PIC X.
  5519             88  CF-COMBINED-PLAN              VALUE 'C'.
  5520             88  CF-JNT-PLAN                   VALUE 'J'.
  5521             88  CF-SNGL-PLAN                  VALUE 'S'.
  5522         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5523         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5524         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5525         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5526         16  CF-RERATE-CNTL                 PIC  X.
  5527             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5528             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5529             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5530             88  CF-AUTO-RECALC                 VALUE '4'.
  5531         16  CF-BENEFIT-TYPE                PIC  X.
  5532             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5533             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5534         16  CF-POLICY-FEE                  PIC S999V99
  5535                                                    COMP-3.
  5536         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5537         16  CF-2ND-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 101
* EL131.cbl
  5538         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5539         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5540         16  FILLER                         PIC  X(32).
  5541         16  CF-TERMINATION-FORM            PIC  X(04).
  5542         16  FILLER                         PIC  X(08).
  5543         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5544                                                       COMP-3.
  5545         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5546         16  CF-ISSUE-LETTER                PIC  X(4).
  5547         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5548         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5549             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5550             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5551         16  CF-MP-REFUND-CALC              PIC X.
  5552             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5553             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5554             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5555             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5556             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5557             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5558             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5559             88  CF-MP-REFD-MEAN                VALUE '8'.
  5560         16  CF-ALT-RATE-CODE               PIC  X(5).
  5561
  5562
  5563         16  FILLER                         PIC X(498).
  5564****************************************************************
  5565*             MORTGAGE COMPANY MASTER RECORD                   *
  5566****************************************************************
  5567
  5568     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5569         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5570         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5571             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5572             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5573             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5574             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5575             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5576
  5577         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5578         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5579         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5580         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5581         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5582
  5583         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5584             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5585         16  CF-MP-RECON-USE-IND            PIC X(1).
  5586             88  CF-MP-USE-RECON             VALUE 'Y'.
  5587         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5588             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5589         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5590             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5591             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5592         16  FILLER                         PIC X(1).
  5593         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5594             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5595         16  CF-MORTG-MIB-VERSION           PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 102
* EL131.cbl
  5596             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5597             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5598             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5599         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5600             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5601                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5602             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5603                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5604             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5605                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5606             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5607                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5608             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5609                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5610             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5611                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5612         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5613         16  FILLER                         PIC X(7).
  5614         16  CF-MORTG-DESTINATION-SYMBOL.
  5615             20  CF-MORTG-MIB-COMM          PIC X(5).
  5616             20  CF-MORTG-MIB-TERM          PIC X(5).
  5617         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5618             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5619         16  FILLER                         PIC X(03).
  5620         16  CF-MP-CHECK-NO-CONTROL.
  5621             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5622                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5623                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5624                                                ' ' LOW-VALUES.
  5625                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5626                                               VALUE '3'.
  5627         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5628         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5629         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5630             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5631                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5632             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5633                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5634             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5635                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5636             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5637                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5638             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5639                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5640             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5641                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5642         16  CF-MORTG-BILLING-AREA.
  5643             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5644                                            PIC X.
  5645         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5646         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5647         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5648         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5649             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5650             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5651         16  FILLER                         PIC X.
  5652         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5653             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 103
* EL131.cbl
  5654             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5655         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5656         16  FILLER                         PIC X(8).
  5657         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5658         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5659         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5660         16  CF-ACH-COMPANY-ID.
  5661             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5662                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5663                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5664                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5665             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5666         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5667             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5668         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5669             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5670             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5671         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5672         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5673         16  FILLER                         PIC X(536).
  5674
  5675****************************************************************
  5676*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5677****************************************************************
  5678
  5679     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5680         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5681             20  CF-FEMALE-HEIGHT.
  5682                 24  CF-FEMALE-FT           PIC 99.
  5683                 24  CF-FEMALE-IN           PIC 99.
  5684             20  CF-FEMALE-MIN-WT           PIC 999.
  5685             20  CF-FEMALE-MAX-WT           PIC 999.
  5686         16  FILLER                         PIC X(428).
  5687
  5688     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5689         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5690             20  CF-MALE-HEIGHT.
  5691                 24  CF-MALE-FT             PIC 99.
  5692                 24  CF-MALE-IN             PIC 99.
  5693             20  CF-MALE-MIN-WT             PIC 999.
  5694             20  CF-MALE-MAX-WT             PIC 999.
  5695         16  FILLER                         PIC X(428).
  5696******************************************************************
  5697*             AUTOMATIC ACTIVITY RECORD                          *
  5698******************************************************************
  5699     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5700         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5701             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5702             20  CF-SYS-LETTER-ID           PIC X(04).
  5703             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5704             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5705             20  CF-SYS-RESET-SW            PIC X(01).
  5706             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5707             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5708
  5709         16  FILLER                         PIC X(50).
  5710
  5711         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 104
* EL131.cbl
  5712             20  CF-USER-ACTIVE-SW          PIC X(01).
  5713             20  CF-USER-LETTER-ID          PIC X(04).
  5714             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5715             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5716             20  CF-USER-RESET-SW           PIC X(01).
  5717             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5718             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5719             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5720
  5721         16  FILLER                         PIC X(246).
  5722
  5723*                                COPY ELCACTQ.
  5724******************************************************************
  5725*                                                                *
  5726*                            ELCACTQ.                            *
  5727*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  5728*                            VMOD=2.004                          *
  5729*                                                                *
  5730*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  5731*                                                                *
  5732*   FILE TYPE = VSAM,KSDS                                        *
  5733*   RECORD SIZE = 60     RECFORM = FIXED                         *
  5734*                                                                *
  5735*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  5736*       ALTERNATE INDEX = NONE                                   *
  5737*                                                                *
  5738*   LOG = YES                                                    *
  5739*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5740*                                                                *
  5741*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  5742******************************************************************
  5743
  5744 01  ACTIVITY-QUE.
  5745     12  AQ-RECORD-ID                PIC XX.
  5746         88  VALID-AQ-ID                VALUE 'AQ'.
  5747
  5748     12  AQ-CONTROL-PRIMARY.
  5749         16  AQ-COMPANY-CD           PIC X.
  5750         16  AQ-CARRIER              PIC X.
  5751         16  AQ-CLAIM-NO             PIC X(7).
  5752         16  AQ-CERT-NO.
  5753             20  AQ-CERT-PRIME       PIC X(10).
  5754             20  AQ-CERT-SFX         PIC X.
  5755
  5756     12  AQ-PENDING-ACTIVITY-FLAGS.
  5757         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  5758         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  5759             88  PENDING-PAYMENTS       VALUE '1'.
  5760         16  AQ-PENDING-STATUS-FLAG  PIC X.
  5761             88  PENDING-FULL-PRINT     VALUE '1'.
  5762             88  PENDING-PART-PRINT     VALUE '2'.
  5763         16  AQ-PENDING-LETTER-FLAG  PIC X.
  5764             88  PENDING-LETTERS        VALUE '1'.
  5765         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  5766             88  PENDING-RESTORE        VALUE 'C'.
  5767             88  PENDING-RESTORE-LETTER VALUE 'L'.
  5768
  5769     12  FILLER                      PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 105
* EL131.cbl
  5770
  5771     12  AQ-RESEND-DATE              PIC XX.
  5772     12  AQ-FOLLOWUP-DATE            PIC XX.
  5773     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  5774     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  5775     12  AQ-AUTO-LETTER              PIC X(4).
  5776     12  FILLER                      PIC XX.
  5777     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  5778*****************************************************************
  5779
  5780*                                COPY ERCACCT.
  5781******************************************************************
  5782*                                                                *
  5783*                                                                *
  5784*                            ERCACCT                             *
  5785*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5786*                            VMOD=2.031                          *
  5787*                                                                *
  5788*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5789*                                                                *
  5790*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5791*   VSAM ACCOUNT MASTER FILES.                                   *
  5792*                                                                *
  5793*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5794*                                                                *
  5795*   FILE TYPE = VSAM,KSDS                                        *
  5796*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5797*                                                                *
  5798*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5799*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5800*                                                                *
  5801*   LOG = NO                                                     *
  5802*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5803*                                                                *
  5804*                                                                *
  5805******************************************************************
  5806*                   C H A N G E   L O G
  5807*
  5808* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5809*-----------------------------------------------------------------
  5810*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5811* EFFECTIVE    NUMBER
  5812*-----------------------------------------------------------------
  5813* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5814* 092705    2005050300006  PEMA  ADD SPP LEASES
  5815* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5816* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5817* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5818* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5819* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5820******************************************************************
  5821
  5822 01  ACCOUNT-MASTER.
  5823     12  AM-RECORD-ID                      PIC XX.
  5824         88  VALID-AM-ID                      VALUE 'AM'.
  5825
  5826     12  AM-CONTROL-PRIMARY.
  5827         16  AM-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 106
* EL131.cbl
  5828         16  AM-MSTR-CNTRL.
  5829             20  AM-CONTROL-A.
  5830                 24  AM-CARRIER            PIC X.
  5831                 24  AM-GROUPING.
  5832                     28 AM-GROUPING-PREFIX PIC XXX.
  5833                     28 AM-GROUPING-PRIME  PIC XXX.
  5834                 24  AM-STATE              PIC XX.
  5835                 24  AM-ACCOUNT.
  5836                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5837                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5838             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5839                                           PIC X(19).
  5840             20  AM-CNTRL-B.
  5841                 24  AM-EXPIRATION-DT      PIC XX.
  5842                 24  FILLER                PIC X(4).
  5843             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5844                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5845
  5846     12  AM-CONTROL-BY-VAR-GRP.
  5847         16  AM-COMPANY-CD-A1              PIC X.
  5848         16  AM-VG-CARRIER                 PIC X.
  5849         16  AM-VG-GROUPING                PIC X(6).
  5850         16  AM-VG-STATE                   PIC XX.
  5851         16  AM-VG-ACCOUNT                 PIC X(10).
  5852         16  AM-VG-DATE.
  5853             20  AM-VG-EXPIRATION-DT       PIC XX.
  5854             20  FILLER                    PIC X(4).
  5855         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5856                                           PIC 9(11)      COMP-3.
  5857     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5858         16  FILLER                        PIC X(10).
  5859         16  AM-VG-KEY3.
  5860             20  AM-VG3-ACCOUNT            PIC X(10).
  5861             20  AM-VG3-EXP-DT             PIC XX.
  5862         16  FILLER                        PIC X(4).
  5863     12  AM-MAINT-INFORMATION.
  5864         16  AM-LAST-MAINT-DT              PIC XX.
  5865         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5866         16  AM-LAST-MAINT-USER            PIC X(4).
  5867         16  FILLER                        PIC XX.
  5868
  5869     12  AM-EFFECTIVE-DT                   PIC XX.
  5870     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5871
  5872     12  AM-PREV-DATES  COMP-3.
  5873         16  AM-PREV-EXP-DT                PIC 9(11).
  5874         16  AM-PREV-EFF-DT                PIC 9(11).
  5875
  5876     12  AM-REPORT-CODE-1                  PIC X(10).
  5877     12  AM-REPORT-CODE-2                  PIC X(10).
  5878
  5879     12  AM-CITY-CODE                      PIC X(4).
  5880     12  AM-COUNTY-PARISH                  PIC X(6).
  5881
  5882     12  AM-NAME                           PIC X(30).
  5883     12  AM-PERSON                         PIC X(30).
  5884     12  AM-ADDRS                          PIC X(30).
  5885     12  AM-CITY.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 107
* EL131.cbl
  5886         16  AM-ADDR-CITY                  PIC X(28).
  5887         16  AM-ADDR-STATE                 PIC XX.
  5888     12  AM-ZIP.
  5889         16  AM-ZIP-PRIME.
  5890             20  AM-ZIP-PRI-1ST            PIC X.
  5891                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5892             20  FILLER                    PIC X(4).
  5893         16  AM-ZIP-PLUS4                  PIC X(4).
  5894     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5895         16  AM-CAN-POSTAL-1               PIC XXX.
  5896         16  AM-CAN-POSTAL-2               PIC XXX.
  5897         16  FILLER                        PIC XXX.
  5898     12  AM-TEL-NO.
  5899         16  AM-AREA-CODE                  PIC 999.
  5900         16  AM-TEL-PRE                    PIC 999.
  5901         16  AM-TEL-NBR                    PIC 9(4).
  5902     12  AM-TEL-LOC                        PIC X.
  5903         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5904         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5905
  5906     12  AM-COMM-STRUCTURE.
  5907         16  AM-DEFN-1.
  5908             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5909                 24  AM-AGT.
  5910                     28  AM-AGT-PREFIX     PIC X(4).
  5911                     28  AM-AGT-PRIME      PIC X(6).
  5912                 24  AM-COM-TYP            PIC X.
  5913                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5914                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5915                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5916                 24  AM-RECALC-LV-INDIC    PIC X.
  5917                 24  AM-RETRO-LV-INDIC     PIC X.
  5918                 24  AM-GL-CODES           PIC X.
  5919                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5920                 24  FILLER                PIC X(01).
  5921         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5922             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5923                 24  FILLER                PIC X(11).
  5924                 24  AM-L-COMA             PIC XXX.
  5925                 24  AM-J-COMA             PIC XXX.
  5926                 24  AM-A-COMA             PIC XXX.
  5927                 24  FILLER                PIC X(6).
  5928
  5929     12  AM-COMM-CHANGE-STATUS             PIC X.
  5930         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5931
  5932     12  AM-CSR-CODE                       PIC X(4).
  5933
  5934     12  AM-BILLING-STATUS                 PIC X.
  5935         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5936         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5937     12  AM-AUTO-REFUND-SW                 PIC X.
  5938         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5939         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5940     12  AM-GPCD                           PIC 99.
  5941     12  AM-IG                             PIC X.
  5942         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5943         88  AM-HAS-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 108
* EL131.cbl
  5944     12  AM-STATUS                         PIC X.
  5945         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5946         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5947         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5948         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5949         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5950         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5951     12  AM-REMIT-TO                       PIC 99.
  5952     12  AM-ID-NO                          PIC X(11).
  5953
  5954     12  AM-CAL-TABLE                      PIC XX.
  5955     12  AM-LF-DEVIATION                   PIC XXX.
  5956     12  AM-AH-DEVIATION                   PIC XXX.
  5957     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5958     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5959     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5960     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5961     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5962     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5963
  5964     12  AM-USER-FIELDS.
  5965         16  AM-FLD-1                      PIC XX.
  5966         16  AM-FLD-2                      PIC XX.
  5967         16  AM-FLD-3                      PIC XX.
  5968         16  AM-FLD-4                      PIC XX.
  5969         16  AM-FLD-5                      PIC XX.
  5970
  5971     12  AM-1ST-PROD-DATE.
  5972         16  AM-1ST-PROD-YR                PIC XX.
  5973         16  AM-1ST-PROD-MO                PIC XX.
  5974         16  AM-1ST-PROD-DA                PIC XX.
  5975     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5976     12  AM-CERTS-PURGED-DATE.
  5977         16  AM-PUR-YR                     PIC XX.
  5978         16  AM-PUR-MO                     PIC XX.
  5979         16  AM-PUR-DA                     PIC XX.
  5980     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5981     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5982     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5983     12  AM-INACTIVE-DATE.
  5984         16  AM-INA-MO                     PIC 99.
  5985         16  AM-INA-DA                     PIC 99.
  5986         16  AM-INA-YR                     PIC 99.
  5987     12  AM-AR-HI-CERT-DATE                PIC XX.
  5988
  5989     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5990     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5991
  5992     12  AM-OB-PAYMENT-MODE                PIC X.
  5993         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5994         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5995         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5996         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5997
  5998     12  AM-AH-ONLY-INDICATOR              PIC X.
  5999         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6000         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6001
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 109
* EL131.cbl
  6002     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6003
  6004     12  AM-OVER-SHORT.
  6005         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6006         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6007
  6008     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6009     12  AM-DCC-CLP-STATE                  PIC XX.
  6010
  6011     12  AM-RECALC-COMM                    PIC X.
  6012     12  AM-RECALC-REIN                    PIC X.
  6013
  6014     12  AM-REI-TABLE                      PIC XXX.
  6015     12  AM-REI-ET-LF                      PIC X.
  6016     12  AM-REI-ET-AH                      PIC X.
  6017     12  AM-REI-PE-LF                      PIC X.
  6018     12  AM-REI-PE-AH                      PIC X.
  6019     12  AM-REI-PRT-ST                     PIC X.
  6020     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6021     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6022     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6023     12  AM-REI-GROUP-A                    PIC X(6).
  6024     12  AM-REI-MORT                       PIC X(4).
  6025     12  AM-REI-PRT-OW                     PIC X.
  6026     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6027     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6028     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6029     12  AM-REI-GROUP-B                    PIC X(6).
  6030
  6031     12  AM-TRUST-TYPE                     PIC X(2).
  6032
  6033     12  AM-EMPLOYER-STMT-USED             PIC X.
  6034     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6035
  6036     12  AM-STD-AH-TYPE                    PIC XX.
  6037     12  AM-EARN-METHODS.
  6038         16  AM-EARN-METHOD-R              PIC X.
  6039             88 AM-REF-RL-R78                 VALUE 'R'.
  6040             88 AM-REF-RL-PR                  VALUE 'P'.
  6041             88 AM-REF-RL-MEAN                VALUE 'M'.
  6042             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6043         16  AM-EARN-METHOD-L              PIC X.
  6044             88 AM-REF-LL-R78                 VALUE 'R'.
  6045             88 AM-REF-LL-PR                  VALUE 'P'.
  6046             88 AM-REF-LL-MEAN                VALUE 'M'.
  6047             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6048         16  AM-EARN-METHOD-A              PIC X.
  6049             88 AM-REF-AH-R78                 VALUE 'R'.
  6050             88 AM-REF-AH-PR                  VALUE 'P'.
  6051             88 AM-REF-AH-MEAN                VALUE 'M'.
  6052             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6053             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6054             88 AM-REF-AH-NET                 VALUE 'N'.
  6055
  6056     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6057     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6058     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6059
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 110
* EL131.cbl
  6060     12  AM-RET-Y-N                        PIC X.
  6061     12  AM-RET-P-E                        PIC X.
  6062     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6063     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6064     12  AM-RET-GRP                        PIC X(6).
  6065     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6066         16  AM-POOL-PRIME                 PIC XXX.
  6067         16  AM-POOL-SUB                   PIC XXX.
  6068     12  AM-RETRO-EARNINGS.
  6069         16  AM-RET-EARN-R                 PIC X.
  6070         16  AM-RET-EARN-L                 PIC X.
  6071         16  AM-RET-EARN-A                 PIC X.
  6072     12  AM-RET-ST-TAX-USE                 PIC X.
  6073         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6074         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6075     12  AM-RETRO-BEG-EARNINGS.
  6076         16  AM-RET-BEG-EARN-R             PIC X.
  6077         16  AM-RET-BEG-EARN-L             PIC X.
  6078         16  AM-RET-BEG-EARN-A             PIC X.
  6079     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6080     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6081
  6082     12  AM-USER-SELECT-OPTIONS.
  6083         16  AM-USER-SELECT-1              PIC X(10).
  6084         16  AM-USER-SELECT-2              PIC X(10).
  6085         16  AM-USER-SELECT-3              PIC X(10).
  6086         16  AM-USER-SELECT-4              PIC X(10).
  6087         16  AM-USER-SELECT-5              PIC X(10).
  6088
  6089     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6090
  6091     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6092
  6093     12  AM-RPT045A-SWITCH                 PIC X.
  6094         88  RPT045A-OFF                   VALUE 'N'.
  6095
  6096     12  AM-INSURANCE-LIMITS.
  6097         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6098         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6099
  6100     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6101         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6102
  6103     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6104         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6105         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6106
  6107     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6108
  6109     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6110     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6111     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6112     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6113     12  AM-DCC-UEF-STATE                  PIC XX.
  6114     12  FILLER                            PIC XXX.
  6115     12  AM-REPORT-CODE-3                  PIC X(10).
  6116*    12  FILLER                            PIC X(22).
  6117
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 111
* EL131.cbl
  6118     12  AM-RESERVE-DATE.
  6119         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6120         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6121         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6122
  6123     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6124     12  AM-NOTIFICATION-TYPES.
  6125         16  AM-NOTIF-OF-LETTERS           PIC X.
  6126         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6127         16  AM-NOTIF-OF-REPORTS           PIC X.
  6128         16  AM-NOTIF-OF-STATUS            PIC X.
  6129
  6130     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6131         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6132         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6133         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6134         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6135
  6136     12  AM-BENEFIT-CONTROLS.
  6137         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6138             20  AM-BENEFIT-CODE           PIC XX.
  6139             20  AM-BENEFIT-TYPE           PIC X.
  6140             20  AM-BENEFIT-REVISION       PIC XXX.
  6141             20  AM-BENEFIT-REM-TERM       PIC X.
  6142             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6143             20  FILLER                    PIC XX.
  6144         16  FILLER                        PIC X(80).
  6145
  6146     12  AM-TRANSFER-DATA.
  6147         16  AM-TRANSFERRED-FROM.
  6148             20  AM-TRNFROM-CARRIER        PIC X.
  6149             20  AM-TRNFROM-GROUPING.
  6150                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6151                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6152             20  AM-TRNFROM-STATE          PIC XX.
  6153             20  AM-TRNFROM-ACCOUNT.
  6154                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6155                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6156             20  AM-TRNFROM-DTE            PIC XX.
  6157         16  AM-TRANSFERRED-TO.
  6158             20  AM-TRNTO-CARRIER          PIC X.
  6159             20  AM-TRNTO-GROUPING.
  6160                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6161                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6162             20  AM-TRNTO-STATE            PIC XX.
  6163             20  AM-TRNTO-ACCOUNT.
  6164                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6165                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6166             20  AM-TRNTO-DTE              PIC XX.
  6167         16  FILLER                        PIC X(10).
  6168
  6169     12  AM-SAVED-REMIT-TO                 PIC 99.
  6170
  6171     12  AM-COMM-STRUCTURE-SAVED.
  6172         16  AM-DEFN-1-SAVED.
  6173             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6174                 24  AM-AGT-SV             PIC X(10).
  6175                 24  AM-COM-TYP-SV         PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 112
* EL131.cbl
  6176                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6177                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6178                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6179                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6180                 24  FILLER                PIC X.
  6181                 24  AM-GL-CODES-SV        PIC X.
  6182                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6183                 24  FILLER                PIC X.
  6184         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6185             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6186                 24  FILLER                PIC X(11).
  6187                 24  AM-L-COMA-SV          PIC XXX.
  6188                 24  AM-J-COMA-SV          PIC XXX.
  6189                 24  AM-A-COMA-SV          PIC XXX.
  6190                 24  FILLER                PIC X(6).
  6191
  6192     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6193         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6194            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6195            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6196            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6197
  6198     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6199     12  FILLER                            PIC X(120).
  6200
  6201     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6202         16  AM-CONTROL-NAME               PIC X(30).
  6203         16  AM-EXECUTIVE-ONE.
  6204             20  AM-EXEC1-NAME             PIC X(15).
  6205             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6206                                                          COMP-3.
  6207             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6208                                                          COMP-3.
  6209         16  AM-EXECUTIVE-TWO.
  6210             20  AM-EXEC2-NAME             PIC X(15).
  6211             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6212                                                          COMP-3.
  6213             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6214                                                          COMP-3.
  6215
  6216     12  AM-RETRO-ADDITIONAL-DATA.
  6217         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6218         16  AM-RETRO-PREM-P-E             PIC X.
  6219         16  AM-RETRO-CLMS-P-I             PIC X.
  6220         16  AM-RETRO-RET-BRACKET-LF.
  6221             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6222                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6223                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6224             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6225                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6226                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6227             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6228                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6229                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6230         16  AM-RETRO-RET-BRACKET-AH.
  6231             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6232                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6233                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 113
* EL131.cbl
  6234                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6235             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6236                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6237                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6238             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6239                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6240                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6241
  6242     12  AM-COMMENTS.
  6243         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6244
  6245     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6246         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6247         16  AM-FLI-BILLING-CODE           PIC X.
  6248         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6249         16  AM-FLI-UNITED-IDENT           PIC X.
  6250         16  AM-FLI-INTEREST-LOST-DATA.
  6251             20  AM-FLI-BANK-NO            PIC X(5).
  6252             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6253             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6254             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6255         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6256             20  AM-FLI-AGT                PIC X(9).
  6257             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6258             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6259         16  FILLER                        PIC X(102).
  6260
  6261     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6262         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6263             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6264             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6265             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6266             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6267             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6268         16  FILLER                          PIC X(10).
  6269******************************************************************
  6270
  6271*                                COPY ELCCHKQ.
  6272******************************************************************
  6273*                                                                *
  6274*                                                                *
  6275*                            ELCCHKQ.                            *
  6276*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6277*                            VMOD=2.007                          *
  6278*                                                                *
  6279*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6280*                                                                *
  6281*   FILE TYPE = VSAM,KSDS                                        *
  6282*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6283*                                                                *
  6284*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6285*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6286*                                                                *
  6287*   LOG = YES                                                    *
  6288*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6289******************************************************************
  6290 01  CHECK-QUE.
  6291     12  CQ-RECORD-ID                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 114
* EL131.cbl
  6292         88  VALID-CQ-ID         VALUE 'CQ'.
  6293
  6294     12  CQ-CONTROL-PRIMARY.
  6295         16  CQ-COMPANY-CD           PIC X.
  6296         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6297         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6298
  6299     12  CQ-CONTROL-BY-PAYEE.
  6300         16  CQ-CONTROL-BY-NUMBER.
  6301             20  CQ-COMPANY-CD-A1     PIC X.
  6302             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6303         16  CQ-PAYEE-CARRIER        PIC X.
  6304         16  CQ-PAYEE-GROUPING       PIC X(6).
  6305         16  CQ-PAYEE-STATE          PIC XX.
  6306         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6307         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6308
  6309     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6310         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6311         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6312         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6313         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6314         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6315         16  FILLER                  PIC X(3).
  6316
  6317     12  CQ-ENTRY-TYPE               PIC X.
  6318             88  CHECK-ON-QUE           VALUE 'Q'.
  6319             88  ALIGNMENT-CHECK        VALUE 'A'.
  6320             88  SPOILED-CHECK          VALUE 'S'.
  6321             88  PAYMENT-ABORTED        VALUE 'X'.
  6322
  6323     12  CQ-CLAIM-MAST-CNTL.
  6324         16  CQ-CARRIER              PIC X.
  6325         16  CQ-CLAIM-NO             PIC X(7).
  6326         16  CQ-CERT-NO.
  6327             20  CQ-CERT-PRIME       PIC X(10).
  6328             20  CQ-CERT-SFX         PIC X.
  6329         16  CQ-CLAIM-TYPE           PIC X.
  6330             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6331             88  CQ-AH-CLAIM            VALUE 'A'.
  6332         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6333             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6334             88  CQ-O-B-COVERAGE        VALUE '2'.
  6335             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6336
  6337     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6338     12  CQ-CHECK-NUMBER             PIC X(7).
  6339     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6340     12  CQ-PAYMENT-TYPE             PIC X.
  6341             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6342             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6343             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6344             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6345             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6346             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6347             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6348             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6349     12  CQ-VOID-INDICATOR           PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 115
* EL131.cbl
  6350             88  CHECK-IS-STOPPED          VALUE 'S'.
  6351             88  CHECK-IS-VOID             VALUE 'V'.
  6352     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6353     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6354     12  CQ-CHECK-BY-USER            PIC X(4).
  6355     12  CQ-PRE-NUMBERING-SW         PIC X.
  6356       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6357       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6358
  6359     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6360     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6361     12  CQ-LEDGER-FLAG              PIC X(01).
  6362     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6363     12  CQ-LAST-UPDATED-DT          PIC XX.
  6364     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6365     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6366
  6367     12  FILLER                      PIC X(04).
  6368
  6369******************************************************************
  6370
  6371*                                COPY ELCARCH.
  6372******************************************************************
  6373*                                                                *
  6374*                            ELCARCH.                            *
  6375*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6376*                            VMOD=2.007                          *
  6377*                                                                *
  6378*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6379*                                                                *
  6380*   FILE TYPE = VSAM,KSDS                                        *
  6381*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6382*                                                                *
  6383*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6384*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6385*                                                                *
  6386*   LOG = NO                                                     *
  6387*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6388*                                                                *
  6389*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6390******************************************************************
  6391 01  LETTER-ARCHIVE.
  6392     12  LA-RECORD-ID                PIC XX.
  6393         88  VALID-LA-ID                VALUE 'LA'.
  6394
  6395     12  LA-CONTROL-PRIMARY.
  6396         16  LA-COMPANY-CD           PIC X.
  6397         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6398         16  LA-RECORD-TYPE          PIC X.
  6399             88  LA-HEADER-DATA         VALUE '1'.
  6400             88  LA-ADDRESS-DATA        VALUE '2'.
  6401             88  LA-TEXT-DATA           VALUE '3'.
  6402             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6403         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6404
  6405     12  LA-CONTROL-BY-TYPE.
  6406         16  LA-COMPANY-CD-A1        PIC X.
  6407         16  LA-RECORD-TYPE-A1       PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 116
* EL131.cbl
  6408         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6409         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6410
  6411     12  LA-TEXT-RECORD.
  6412         16  LA-SKIP-CONTROL         PIC XX.
  6413             88  NO-LINES-SKIPPED       VALUE SPACES.
  6414             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6415         16  LA-TEXT-LINE            PIC X(70).
  6416
  6417     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6418         16  FILLER                  PIC XX.
  6419         16  LA-ADDRESS-LINE         PIC X(30).
  6420         16  FILLER                  PIC X(40).
  6421
  6422     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6423         16  FILLER                  PIC XX.
  6424         16  LA-CARRIER              PIC X.
  6425         16  LA-CLAIM-NO             PIC X(7).
  6426         16  LA-CERT-NO.
  6427             20  LA-CERT-PRIME       PIC X(10).
  6428             20  LA-CERT-SFX         PIC X.
  6429         16  LA-NO-OF-COPIES         PIC S9.
  6430         16  LA-RESEND-DATE          PIC XX.
  6431         16  LA-PROCESSOR-CD         PIC X(4).
  6432         16  LA-CREATION-DT          PIC XX.
  6433         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6434         16  LA-RESEND-PRINT-DATE    PIC XX.
  6435         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6436         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6437*
  6438* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6439*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6440*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6441*   I        20  LA-DMD-RES-ST           PIC XX.
  6442*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6443*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6444*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6445*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6446*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6447*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6448*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6449*   I        20  LA-DMD-UND-CODE         PIC XX.
  6450*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6451*   V    16  FILLER                  PIC X(15).
  6452* -----
  6453*
  6454* REINSERTED  CSO  MODS
  6455*
  6456         16  FILLER.
  6457             20  FILLER                  PIC X(29).
  6458             20  LA-CSO-LETTER-STATUS    PIC X.
  6459                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6460                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6461                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6462             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6463             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6464*
  6465
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 117
* EL131.cbl
  6466     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6467         16  FILLER                  PIC XX.
  6468         16  LA4-CARRIER             PIC X.
  6469         16  LA4-CLAIM-NO            PIC X(7).
  6470         16  LA4-CERT-NO.
  6471             20  LA4-CERT-PRIME      PIC X(10).
  6472             20  LA4-CERT-SFX        PIC X.
  6473         16  LA4-NO-OF-COPIES        PIC S9.
  6474         16  LA4-RESEND-DATE         PIC XX.
  6475         16  LA4-PROCESSOR-CD        PIC X(4).
  6476         16  LA4-CREATION-DT         PIC XX.
  6477         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6478         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6479         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6480         16  LA4-FORM-TYPE           PIC X.
  6481             88  LA4-INITIAL-FORM    VALUE '1'.
  6482             88  LA4-PROGRESS-FORM   VALUE '2'.
  6483         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6484         16  LA4-STATE               PIC X(02).
  6485         16  FILLER                  PIC X(31).
  6486******************************************************************
  6487
  6488*                                COPY ELCBENE.
  6489******************************************************************
  6490*                                                                *
  6491*                            ELCBENE.                            *
  6492*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6493*                            VMOD=2.006                          *
  6494*                                                                *
  6495*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6496*                                                                *
  6497*   FILE TYPE = VSAM,KSDS                                        *
  6498*   RECORD SIZE = 500   RECFORM = FIX                            *
  6499*                                                                *
  6500*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6501*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6502*                                                                *
  6503*   LOG = YES                                                    *
  6504*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6505*                                                                *
  6506*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6507******************************************************************
  6508
  6509 01  BENEFICIARY-MASTER.
  6510     12  BE-RECORD-ID                PIC XX.
  6511         88  VALID-BE-ID                VALUE 'BE'.
  6512
  6513     12  BE-CONTROL-PRIMARY.
  6514         16  BE-COMPANY-CD           PIC X.
  6515         16  BE-RECORD-TYPE          PIC X.
  6516             88  BENEFICIARY-RECORD  VALUE 'B'.
  6517             88  ADJUSTOR-RECORD     VALUE 'A'.
  6518         16  BE-BENEFICIARY          PIC X(10).
  6519     12  BE-CONTROL-BY-NAME.
  6520         16  BE-COMPANY-CD-A1        PIC X.
  6521         16  BE-RECORD-TYPE-A1       PIC X.
  6522         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6523         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 118
* EL131.cbl
  6524
  6525     12  BE-LAST-MAINT-DT            PIC XX.
  6526     12  BE-LAST-MAINT-BY            PIC X(4).
  6527     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6528
  6529     12  BE-ADDRESS-DATA.
  6530         16  BE-MAIL-TO-NAME         PIC X(30).
  6531         16  BE-ADDRESS-LINE-1       PIC X(30).
  6532         16  BE-ADDRESS-LINE-2       PIC X(30).
  6533         16  BE-ADDRESS-LINE-3       PIC X(30).
  6534         16  BE-CITY-STATE.
  6535             20  BE-CITY             PIC X(28).
  6536             20  BE-STATE            PIC XX.
  6537         16  BE-ZIP-CODE.
  6538             20  BE-ZIP-PRIME.
  6539                 24  BE-ZIP-1ST      PIC X.
  6540                     88  BE-CANADIAN-POST-CODE
  6541                                         VALUE 'A' THRU 'Z'.
  6542                 24  FILLER          PIC X(4).
  6543             20  BE-ZIP-PLUS4        PIC X(4).
  6544         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6545             20  BE-CAN-POSTAL-1     PIC XXX.
  6546             20  BE-CAN-POSTAL-2     PIC XXX.
  6547             20  FILLER              PIC XXX.
  6548         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6549         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6550
  6551******************************************************************
  6552*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6553*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6554******************************************************************
  6555     12  BE-CARRIER                  PIC X.
  6556
  6557     12  BE-ADDRESS-DATA2.
  6558         16  BE-MAIL-TO-NAME2        PIC X(30).
  6559         16  BE-ADDRESS-LINE-12      PIC X(30).
  6560         16  BE-ADDRESS-LINE-22      PIC X(30).
  6561         16  BE-ADDRESS-LINE-32      PIC X(30).
  6562         16  BE-CITY-STATE2.
  6563             20  BE-CITY2            PIC X(28).
  6564             20  BE-STATE2           PIC XX.
  6565         16  BE-ZIP-CODE2.
  6566             20  BE-ZIP-PRIME2.
  6567                 24  BE-ZIP-1ST2     PIC X.
  6568                     88  BE-CANADIAN-POST-CODE2
  6569                                         VALUE 'A' THRU 'Z'.
  6570                 24  FILLER          PIC X(4).
  6571             20  BE-ZIP-PLUS42       PIC X(4).
  6572         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6573             20  BE-CAN-POSTAL-12    PIC XXX.
  6574             20  BE-CAN-POSTAL-22    PIC XXX.
  6575             20  FILLER              PIC XXX.
  6576         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6577         16  BE-BILLING-STMT-DATA.
  6578             20  BE-BSR              PIC X.
  6579                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6580                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6581             20  BE-BSR-FROM         PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 119
* EL131.cbl
  6582             20  BE-BSR-DEPT         PIC X(30).
  6583             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6584             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6585             20  BE-OUTPUT-TYPE      PIC X.
  6586                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6587                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6588
  6589     12  FILLER                      PIC X(28).
  6590******************************************************************
  6591
  6592*                                COPY ELCDAR.
  6593******************************************************************
  6594*                                                                *
  6595*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6596*   FILE TYPE = VSAM,KSDS                                        *
  6597*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6598*   BASE CLUSTER = DLYACTV                                       *
  6599*   LOG = YES                                                    *
  6600*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6601*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6602*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6603*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6604*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6605*               BY PROGRAM "LGINFCE".                            *
  6606*                                                                *
  6607******************************************************************
  6608 01  DAILY-ACTIVITY-RECORD.
  6609     05  DA-KEY.
  6610         10  DA-COMP-CD          PIC X.
  6611         10  DA-CARRIER          PIC X.
  6612         10  DA-CLAIM-NO         PIC X(7).
  6613         10  DA-CERT-NO.
  6614             15  DA-CERT-PRIME   PIC X(10).
  6615             15  DA-CERT-SFX     PIC X.
  6616     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6617     05  DA-RECORD-TYPE          PIC X.
  6618     05  FILLER                  PIC X(2).
  6619******************************************************************
  6620
  6621*                                COPY ELCALPH.
  6622******************************************************************
  6623*                                                                *
  6624*                            ELCALPH.                            *
  6625*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6626*                            VMOD=2.003                          *
  6627*                                                                *
  6628*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  6629*                                                                *
  6630*   FILE TYPE = VSAM,KSDS                                        *
  6631*   RECORD SIZE = 128  RECFORM = FIXED                           *
  6632*                                                                *
  6633*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  6634*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  6635*                                                                *
  6636*   LOG = YES                                                    *
  6637*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6638*                                                                *
  6639*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 120
* EL131.cbl
  6640******************************************************************
  6641
  6642 01  ALPHA-INDEX.
  6643     12  AI-RECORD-ID                         PIC XX.
  6644         88  VALID-AI-ID                  VALUE 'AI'.
  6645     12  AI-CONTROL-PRIMARY.
  6646         16  AI-COMPANY-CD                     PIC X.
  6647         16  AI-SOURCE                         PIC X.
  6648             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  6649             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  6650         16  AI-NAME.
  6651             20  AI-LAST-NAME                  PIC X(15).
  6652             20  AI-FIRST-NAME.
  6653                 24  AI-FIRST-INITIAL          PIC X.
  6654                 24  FILLER                    PIC X(11).
  6655             20  AI-MIDDLE-INIT                PIC X.
  6656         16  AI-DATE                           PIC X(8).
  6657         16  AI-TIME                           PIC S9(07) COMP-3.
  6658
  6659     12  AI-CONTROL-BY-ADMIN-KEY.
  6660         16  AI-CM-COMPANY-CD                  PIC X.
  6661         16  AI-CM-SOURCE                      PIC X.
  6662         16  AI-CM-CARRIER                     PIC X.
  6663         16  AI-CM-GROUPING.
  6664             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  6665             20  AI-CM-GROUPING-PRIME          PIC X(3).
  6666         16  AI-CM-STATE                       PIC XX.
  6667         16  AI-CM-PRODUCER.
  6668             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  6669             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  6670         16  AI-CM-CERT-EFF-DT                 PIC XX.
  6671         16  AI-CM-CERTIFICATE-NUMBER.
  6672             20  AI-CM-CERT-PRIME              PIC X(10).
  6673             20  AI-CM-CERT-SFX                PIC X.
  6674         16  AI-CM-DATE                        PIC X(8).
  6675         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  6676         16  FILLER                            PIC X(11).
  6677
  6678     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  6679         AI-CONTROL-BY-ADMIN-KEY.
  6680         16  AI-CL-COMPANY-CD                  PIC X.
  6681         16  AI-CL-SOURCE                      PIC X.
  6682         16  AI-CL-CARRIER                     PIC X.
  6683         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  6684         16  AI-CL-CERTIFICATE-NUMBER.
  6685             20  AI-CL-CERT-PRIME              PIC X(10).
  6686             20  AI-CL-CERT-SFX                PIC X.
  6687         16  AI-CL-DATE                        PIC X(8).
  6688         16  AI-CL-INCURRED-DATE               PIC XX.
  6689         16  AI-CL-CLOSE-DATE                  PIC XX.
  6690         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  6691         16  AI-CREDIT-CARD-NUMBER.
  6692             20  AI-CCN.
  6693                 24  AI-CCN-PREFIX             PIC X(4).
  6694                 24  AI-CCN-PRIME              PIC X(12).
  6695             20  AI-CCN-FILLER                 PIC X(4).
  6696
  6697     12  AI-MAINT-INFO.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 121
* EL131.cbl
  6698         16  AI-LAST-MAINT-BY                  PIC X(4).
  6699         16  AI-LAST-MAINT-DT                  PIC XX.
  6700         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6701
  6702     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  6703
  6704     12  FILLER                                PIC X(15).
  6705
  6706
  6707*                                COPY ERCDMDNT.
  6708******************************************************************
  6709*                                                                *
  6710*                            ERCDMDNT                            *
  6711*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6712*                            VMOD=2.005                          *
  6713*                                                                *
  6714*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  6715*                                                                *
  6716*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  6717*                                                                *
  6718*        FILE TYPE= VSAM,KSDS                                    *
  6719*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6720*                                                                *
  6721*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6722*                                                                *
  6723*        LOG = YES                                               *
  6724*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6725*                                                                *
  6726******************************************************************
  6727
  6728 01  CERTIFICATE-NOTE.
  6729     12  CN-RECORD-ID                     PIC  XX.
  6730         88  VALID-CN-ID                      VALUE 'CN'.
  6731
  6732     12  CN-CONTROL-PRIMARY.
  6733         16  CN-COMPANY-CD                PIC X.
  6734         16  CN-CERT-KEY.
  6735             20  CN-CARRIER               PIC X.
  6736             20  CN-GROUPING.
  6737                 24  CN-GROUPING-PREFIX   PIC XXX.
  6738                 24  CN-GROUPING-PRIME    PIC XXX.
  6739             20  CN-STATE                 PIC XX.
  6740             20  CN-ACCOUNT.
  6741                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  6742                 24  CN-ACCOUNT-PRIME     PIC X(6).
  6743             20  CN-CERT-EFF-DT           PIC XX.
  6744             20  CN-CERT-NO.
  6745                 24  CN-CERT-PRIME        PIC X(10).
  6746                 24  CN-CERT-SFX          PIC X.
  6747
  6748     12  CN-BILLING-START-LINE-NO         PIC 99.
  6749     12  CN-BILLING-END-LINE-NO           PIC 99.
  6750
  6751     12  CN-LINES.
  6752         16  CN-LINE                      PIC X(77)  OCCURS 10.
  6753
  6754     12  CN-CSI-NOTES REDEFINES CN-LINES.
  6755         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 122
* EL131.cbl
  6756         16  CN-CSI-GENERAL-DATA-AREA.
  6757             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  6758
  6759         16  CN-CSI-GENERAL-DATA-R REDEFINES
  6760             CN-CSI-GENERAL-DATA-AREA.
  6761             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  6762             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  6763             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  6764             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  6765             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  6766             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  6767             20  CN-CSI-GEN-INFRM-MI          PIC X.
  6768             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  6769             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  6770             20  FILLER                       PIC XX.
  6771             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  6772             20  FILLER                       PIC X(38).
  6773
  6774         16  CN-CSI-PRODUCT-DATA-AREA.
  6775             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  6776
  6777         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  6778             CN-CSI-PRODUCT-DATA-AREA.
  6779             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  6780             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  6781             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  6782             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  6783             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  6784             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  6785             20  FILLER                   PIC XX.
  6786             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  6787             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  6788             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  6789             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  6790             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  6791             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  6792             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  6793             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  6794             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  6795             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  6796             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  6797             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  6798             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  6799             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  6800             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  6801             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  6802             20  CN-CSI-CC-TERM-AGE       PIC 999.
  6803             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  6804             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  6805             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  6806             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  6807             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  6808             20  FILLER                   PIC X(25).
  6809
  6810         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  6811             CN-CSI-CREDIT-CARD-DATA.
  6812             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  6813             20  CN-CSI-FL-CANCEL-CD      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 123
* EL131.cbl
  6814             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  6815             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  6816             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  6817             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  6818             20  FILLER                   PIC XX.
  6819             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  6820             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  6821             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  6822             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  6823             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  6824             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  6825             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  6826             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  6827             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  6828             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  6829             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  6830             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  6831             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  6832             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  6833             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  6834             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  6835             20  CN-CSI-FL-TERM-AGE       PIC 999.
  6836             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  6837             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  6838             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  6839             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  6840             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  6841             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  6842             20  FILLER                   PIC X(17).
  6843
  6844         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  6845             CN-CSI-FAMILY-LEAVE-DATA.
  6846             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  6847             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  6848             20  CN-CSI-SL-BENE-REL       PIC X(8).
  6849             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  6850             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  6851             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  6852             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  6853             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  6854             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  6855             20  CN-CSI-SL-INT-ON-PROCEEDS
  6856                                          PIC S9(5)V99  COMP-3.
  6857             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  6858             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  6859             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  6860             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  6861             20  CN-CSI-SL-POLICY-BENEFITS
  6862                                          PIC S9(5)V99  COMP-3.
  6863             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  6864             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  6865             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  6866             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  6867             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  6868             20  CN-CSI-SL-PREM-MODE      PIC 99.
  6869             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  6870             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  6871             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 124
* EL131.cbl
  6872             20  CN-CSI-SL-STATE-NOT      PIC X.
  6873             20  FILLER                   PIC XX.
  6874
  6875         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  6876             CN-CSI-SENIOR-LIFE-DATA.
  6877             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  6878             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  6879             20  CN-CSI-PP-BEN-PAID-TO-DATE
  6880                                          PIC S9(5)V99  COMP-3.
  6881             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  6882             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  6883             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  6884             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  6885             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  6886             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  6887             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  6888             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  6889             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  6890             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  6891             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  6892             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  6893             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  6894             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  6895             20  CN-CSI-PP-REPAIR         PIC X.
  6896             20  CN-CSI-PP-REPLACE        PIC X.
  6897             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  6898             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  6899             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  6900             20  CN-CSI-PP-TERM-AGE       PIC 999.
  6901             20  FILLER                   PIC X(5).
  6902
  6903         16  CN-CSI-EXT-WARR-DATA REDEFINES
  6904             CN-CSI-PURCH-PROP-DATA.
  6905             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  6906             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  6907             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  6908             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  6909             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  6910             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  6911             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  6912             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  6913             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  6914             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  6915             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  6916             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  6917             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  6918             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  6919             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  6920             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  6921             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  6922             20  CN-CSI-EW-REPLACE        PIC X.
  6923             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  6924             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  6925             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  6926             20  CN-CSI-EW-TERM-AGE       PIC 999.
  6927             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  6928             20  FILLER                   PIC X(4).
  6929
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 125
* EL131.cbl
  6930     12  CN-LAST-MAINT-DT                 PIC XX.
  6931     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  6932     12  CN-LAST-MAINT-USER               PIC X(4).
  6933     12  FILLER                           PIC X(6).
  6934
  6935******************************************************************
  6936
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 126
* EL131.cbl
  6938 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  6939                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  6940                          CONTROL-FILE ACTIVITY-QUE
  6941                          ACCOUNT-MASTER CHECK-QUE
  6942                          LETTER-ARCHIVE BENEFICIARY-MASTER
  6943                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  6944                          CERTIFICATE-NOTE.
  6945 0000-DFHEXIT SECTION.
  6946     MOVE '9#                    $   ' TO DFHEIV0.
  6947     MOVE 'EL131' TO DFHEIV1.
  6948     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6949
  6950     IF EIBCALEN = ZERO
  6951         GO TO 8800-UNAUTHORIZED-ACCESS.
  6952
  6953     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6954     MOVE '5'                    TO DC-OPTION-CODE.
  6955     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  6956     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  6957     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  6958     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  6959
  6960     IF SAVE-DATE-YY GREATER 70
  6961         MOVE 19                 TO SAVE-DATE-CC
  6962      ELSE
  6963         MOVE 20                 TO SAVE-DATE-CC.
  6964
  6965
  6966* EXEC CICS HANDLE CONDITION
  6967*        PGMIDERR (8820-XCTL-ERROR)
  6968*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  6969*        ERROR    (9990-ABEND)
  6970*    END-EXEC.
  6971*    MOVE '"$LI.                 ! " #00006961' TO DFHEIV0
  6972     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  6973     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6974     MOVE X'2220233030303036393631' TO DFHEIV0(25:11)
  6975     CALL 'kxdfhei1' USING DFHEIV0
  6976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6977
  6978
  6979     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  6980     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  6981     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  6982
  6983     INITIALIZE    EDIT-WORK-AREA.
  6984     MOVE '/'                    TO WORK-SLASH.
  6985     MOVE SPACES                 TO ERROR-SWITCHES.
  6986
  6987     MOVE TRAN-ID                TO TRANS-ID.
  6988     MOVE EIBTRMID               TO PI-TERM.
  6989     MOVE MAP-ID                 TO PI-QUAL.
  6990
  6991     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  6992
  6993     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6994         MOVE LOW-VALUES         TO EL131AO
  6995         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 127
* EL131.cbl
  6996         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6997         MOVE -1                 TO MAINTL
  6998         GO TO 8110-SEND-DATA.
  6999
  7000     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7001         MOVE LOW-VALUES         TO EL131AO
  7002         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7003         MOVE 'X'                TO PI-RETURN-CD-1
  7004         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7005         MOVE -1                 TO MAINTL
  7006         GO TO 8100-SEND-MAP.
  7007
  7008     IF EIBAID = DFHCLEAR
  7009         GO TO 8200-RETURN-PRIOR.
  7010
  7011     IF PI-PROCESSOR-ID = 'LGXX'
  7012         NEXT SENTENCE
  7013     ELSE
  7014
  7015* EXEC CICS READQ TS
  7016*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7017*            INTO    (SECURITY-CONTROL)
  7018*            LENGTH  (SC-COMM-LENGTH)
  7019*            ITEM    (SC-ITEM)
  7020*        END-EXEC
  7021*    MOVE '*$II   L              ''   #00007002' TO DFHEIV0
  7022     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7023     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7024     MOVE X'2020233030303037303032' TO DFHEIV0(25:11)
  7025     CALL 'kxdfhei1' USING DFHEIV0,
  7026           PI-SECURITY-TEMP-STORE-ID,
  7027           SECURITY-CONTROL,
  7028           SC-COMM-LENGTH,
  7029           SC-ITEM,
  7030           DFHEIV99,
  7031           DFHEIV99
  7032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7033         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7034         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7035         IF NOT DISPLAY-CAP
  7036             MOVE 'READ'               TO  SM-READ
  7037             PERFORM 9995-SECURITY-VIOLATION
  7038             MOVE ER-0070              TO  EMI-ERROR
  7039             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7040             GO TO 8100-SEND-MAP.
  7041
  7042
  7043* EXEC CICS RECEIVE
  7044*        MAP    ('EL131A')
  7045*        MAPSET ('EL131S')
  7046*    END-EXEC.
  7047     MOVE 'EL131A' TO DFHEIV1
  7048     MOVE 'EL131S' TO DFHEIV2
  7049*    MOVE '8"T                   ''   #00007017' TO DFHEIV0
  7050     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7051     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7052     MOVE X'2020233030303037303137' TO DFHEIV0(25:11)
  7053     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 128
* EL131.cbl
  7054           DFHEIV1,
  7055           EL131AI,
  7056           DFHEIV99,
  7057           DFHEIV2,
  7058           DFHEIV99,
  7059           DFHEIV99
  7060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7061
  7062
  7063     IF PFKEYL GREATER THAN ZERO
  7064         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7065
  7066     IF SCREEN-ERROR
  7067         MOVE ER-0004 TO EMI-ERROR
  7068         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7069         MOVE -1 TO MAINTL
  7070         GO TO 8110-SEND-DATA.
  7071
  7072     IF EIBAID = DFHPF3
  7073         GO TO 8500-TRLR-MNT.
  7074
  7075     IF EIBAID = DFHPF4
  7076         GO TO 8600-ADDR-MNT.
  7077
  7078     IF EIBAID = DFHPF5
  7079         GO TO 8700-CERT-MNT.
  7080
  7081     IF PI-COMPANY-ID = 'DMD'
  7082       IF EIBAID = DFHPF6
  7083         GO TO 8750-DMD-CLM-FIX.
  7084
  7085     IF EIBAID = DFHPF7
  7086         GO TO 4000-FORCE-ERRORS.
  7087
  7088     IF EIBAID = DFHPF12
  7089         GO TO 8300-GET-HELP.
  7090
  7091     IF EIBAID = DFHPF23
  7092         GO TO 8810-PF23-ENTERED.
  7093
  7094     IF EIBAID = DFHPF24
  7095         GO TO 8400-RETURN-MASTER.
  7096
  7097     IF EIBAID NOT = DFHENTER
  7098         MOVE ER-0029            TO EMI-ERROR
  7099         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7100         MOVE -1                 TO MAINTL
  7101         GO TO 8110-SEND-DATA.
  7102
  7103     IF PI-RETURN-CD-1 =  'X'
  7104         MOVE ER-0311            TO EMI-ERROR
  7105         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7106         MOVE -1                 TO MAINTL
  7107         GO TO 8110-SEND-DATA.
  7108
  7109     IF MAINTI = 'A'
  7110         GO TO 0500-ADD-ALPHA-ONLY.
  7111
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 129
* EL131.cbl
  7112     IF MAINTI = 'N'
  7113         GO TO 0600-CHANGE-NAME.
  7114
  7115     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7116
  7117     IF SCREEN-ERROR
  7118         GO TO 8110-SEND-DATA.
  7119
  7120     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7121         MOVE ER-0276            TO EMI-ERROR
  7122         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7123         MOVE -1                 TO MAINTL
  7124         GO TO 8110-SEND-DATA.
  7125
  7126     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7127
  7128     IF SCREEN-ERROR
  7129         GO TO 8110-SEND-DATA.
  7130
  7131     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7132
  7133     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7134
  7135     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7136         GO TO 8110-SEND-DATA.
  7137
  7138     IF EMI-FATAL-CTR GREATER THAN ZERO
  7139         GO TO 8110-SEND-DATA.
  7140
  7141     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7142
  7143     IF WS-OPEN-CLOSE-SW = 'Y'
  7144         IF PI-LETTER-SW = 'Y'
  7145             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7146             MOVE 'T'            TO  CNTL-REC-TYPE
  7147             MOVE SPACES         TO  CNTL-PROC-ID
  7148             MOVE +0             TO  CNTL-SEQ-NO
  7149
  7150* EXEC CICS READ
  7151*                DATASET   (CNTL-FILE-ID)
  7152*                RIDFLD    (CNTL-KEY)
  7153*                SET       (ADDRESS OF CONTROL-FILE)
  7154*            END-EXEC
  7155*    MOVE '&"S        E          (   #00007108' TO DFHEIV0
  7156     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7157     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7158     MOVE X'2020233030303037313038' TO DFHEIV0(25:11)
  7159     CALL 'kxdfhei1' USING DFHEIV0,
  7160           CNTL-FILE-ID,
  7161           DFHEIV20,
  7162           DFHEIV99,
  7163           CNTL-KEY,
  7164           DFHEIV99,
  7165           DFHEIV99,
  7166           DFHEIV99
  7167     SET ADDRESS OF CONTROL-FILE TO
  7168         DFHEIV20
  7169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 130
* EL131.cbl
  7170             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7171
  7172     MOVE ER-0000                TO EMI-ERROR.
  7173     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7174
  7175     MOVE SPACE                  TO MAINTO.
  7176     MOVE -1                     TO MAINTL.
  7177     GO TO 8100-SEND-MAP.
  7178
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 131
* EL131.cbl
  7180 0100-UPDATE-PI.
  7181     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7182         GO TO 0110-UPDATE-UP.
  7183
  7184     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7185     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7186     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7187     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7188     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7189     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7190     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7191     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7192     GO TO 0120-UPDATE-PI-EXIT.
  7193
  7194 0110-UPDATE-UP.
  7195     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7196     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7197     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7198     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7199     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7200     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7201     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7202     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7203
  7204
  7205* EXEC CICS HANDLE CONDITION
  7206*         QIDERR    (0130-TS-ERROR)
  7207*         ITEMERR   (0130-TS-ERROR)
  7208*    END-EXEC.
  7209*    MOVE '"$N<                  ! # #00007147' TO DFHEIV0
  7210     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7211     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7212     MOVE X'2320233030303037313437' TO DFHEIV0(25:11)
  7213     CALL 'kxdfhei1' USING DFHEIV0
  7214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7215
  7216
  7217
  7218* EXEC CICS READQ TS
  7219*         QUEUE    (PI-KEY)
  7220*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7221*         LENGTH   (PI-COMM-LENGTH)
  7222*    END-EXEC.
  7223*    MOVE '*$I    L              ''   #00007152' TO DFHEIV0
  7224     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7225     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7226     MOVE X'2020233030303037313532' TO DFHEIV0(25:11)
  7227     CALL 'kxdfhei1' USING DFHEIV0,
  7228           PI-KEY,
  7229           PROGRAM-INTERFACE-BLOCK,
  7230           PI-COMM-LENGTH,
  7231           DFHEIV99,
  7232           DFHEIV99,
  7233           DFHEIV99
  7234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7235
  7236
  7237
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 132
* EL131.cbl
  7238* EXEC CICS DELETEQ TS
  7239*         QUEUE    (PI-KEY)
  7240*    END-EXEC.
  7241*    MOVE '*&                    #   #00007158' TO DFHEIV0
  7242     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7243     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7244     MOVE X'2020233030303037313538' TO DFHEIV0(25:11)
  7245     CALL 'kxdfhei1' USING DFHEIV0,
  7246           PI-KEY,
  7247           DFHEIV99
  7248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7249
  7250
  7251 0120-UPDATE-PI-EXIT.
  7252     EXIT.
  7253
  7254 0130-TS-ERROR.
  7255     MOVE LOW-VALUES             TO EL131AO.
  7256     MOVE ER-0192                TO EMI-ERROR.
  7257
  7258     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7259
  7260     GO TO 8100-SEND-MAP.
  7261
  7262 0200-TRANS-PF.
  7263     IF EIBAID NOT = DFHENTER
  7264         MOVE 'X'                TO ERROR-SWITCH
  7265         GO TO 0210-EXIT.
  7266
  7267     IF PFKEYI NOT NUMERIC
  7268         MOVE 'X'                TO ERROR-SWITCH
  7269         GO TO 0210-EXIT.
  7270
  7271     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7272
  7273     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7274         MOVE 'X' TO ERROR-SWITCH
  7275         GO TO 0210-EXIT.
  7276
  7277     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7278
  7279 0210-EXIT.
  7280     EXIT.
  7281
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 133
* EL131.cbl
  7283 0500-ADD-ALPHA-ONLY.
  7284******************************************************************
  7285*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7286*    RECORD.                                                     *
  7287******************************************************************
  7288
  7289     IF MLNAMEL = +0 AND
  7290        MFNAMEL = +0 AND
  7291        MMINITL = +0
  7292         MOVE ER-0797                TO  EMI-ERROR
  7293         MOVE -1                     TO  MAINTL
  7294         MOVE AL-UABON               TO  MAINTA
  7295         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7296         GO TO 8110-SEND-DATA.
  7297
  7298     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7299     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7300     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7301     MOVE PI-CERT-NO                 TO  CERT-NO.
  7302
  7303
  7304* EXEC CICS READ
  7305*        DATASET   (CLMS-FILE-ID)
  7306*        RIDFLD    (MSTR-KEY)
  7307*        SET       (ADDRESS OF CLAIM-MASTER)
  7308*    END-EXEC.
  7309*    MOVE '&"S        E          (   #00007214' TO DFHEIV0
  7310     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7311     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7312     MOVE X'2020233030303037323134' TO DFHEIV0(25:11)
  7313     CALL 'kxdfhei1' USING DFHEIV0,
  7314           CLMS-FILE-ID,
  7315           DFHEIV20,
  7316           DFHEIV99,
  7317           MSTR-KEY,
  7318           DFHEIV99,
  7319           DFHEIV99,
  7320           DFHEIV99
  7321     SET ADDRESS OF CLAIM-MASTER TO
  7322         DFHEIV20
  7323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7324
  7325
  7326
  7327* EXEC CICS GETMAIN
  7328*        SET       (ADDRESS OF ALPHA-INDEX)
  7329*        LENGTH    (ALPH-LENGTH)
  7330*        INITIMG   (GETMAIN-SPACE)
  7331*    END-EXEC.
  7332*    MOVE ',"IL                  $   #00007220' TO DFHEIV0
  7333     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7334     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7335     MOVE X'2020233030303037323230' TO DFHEIV0(25:11)
  7336     CALL 'kxdfhei1' USING DFHEIV0,
  7337           DFHEIV20,
  7338           ALPH-LENGTH,
  7339           GETMAIN-SPACE
  7340     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 134
* EL131.cbl
  7341         DFHEIV20
  7342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7343
  7344
  7345     MOVE 'AI'                       TO  AI-RECORD-ID.
  7346     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7347                                         AI-CL-COMPANY-CD.
  7348     MOVE 'C'                        TO  AI-SOURCE
  7349                                         AI-CL-SOURCE.
  7350
  7351     IF MLNAMEL IS GREATER THAN +0
  7352         MOVE MLNAMEI                TO  AI-LAST-NAME
  7353     ELSE
  7354         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7355
  7356     IF MFNAMEL IS GREATER THAN +0
  7357         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7358     ELSE
  7359         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7360
  7361     IF MMINITL IS GREATER THAN +0
  7362         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7363     ELSE
  7364         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7365
  7366     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7367     MOVE '5'                        TO  DC-OPTION-CODE.
  7368     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7369     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7370     IF BUILD-YEAR IS GREATER THAN 50
  7371         MOVE '19'                   TO  WS-ALPHA-YY-1
  7372         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7373         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7374         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7375     ELSE
  7376         MOVE '20'                   TO  WS-ALPHA-YY-1
  7377         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7378         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7379         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7380
  7381     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7382                                         AI-CL-DATE.
  7383
  7384     MOVE EIBTIME                    TO  AI-TIME
  7385                                         AI-CL-TIME.
  7386
  7387     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7388     MOVE 'C'                        TO  AI-CL-SOURCE.
  7389     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7390     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7391     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7392     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7393     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7394
  7395     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7396     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7397     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7398
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 135
* EL131.cbl
  7399
  7400* EXEC CICS WRITE
  7401*        DATASET   (ALPH-FILE-ID)
  7402*        RIDFLD    (AI-CONTROL-PRIMARY)
  7403*        FROM      (ALPHA-INDEX)
  7404*    END-EXEC.
  7405     MOVE LENGTH OF
  7406      ALPHA-INDEX
  7407       TO DFHEIV11
  7408*    MOVE '&$ L                  ''   #00007280' TO DFHEIV0
  7409     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7410     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7411     MOVE X'2020233030303037323830' TO DFHEIV0(25:11)
  7412     CALL 'kxdfhei1' USING DFHEIV0,
  7413           ALPH-FILE-ID,
  7414           ALPHA-INDEX,
  7415           DFHEIV11,
  7416           AI-CONTROL-PRIMARY,
  7417           DFHEIV99,
  7418           DFHEIV99
  7419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7420
  7421
  7422     MOVE LOW-VALUES                 TO  EL131AO.
  7423     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7424     MOVE ER-0000                    TO  EMI-ERROR.
  7425     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7426     MOVE -1                         TO  MAINTL.
  7427     GO TO 8100-SEND-MAP.
  7428
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 136
* EL131.cbl
  7430 0600-CHANGE-NAME.
  7431******************************************************************
  7432*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7433*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7434******************************************************************
  7435
  7436     IF MLNAMEL = +0 AND
  7437        MFNAMEL = +0 AND
  7438        MMINITL = +0
  7439         MOVE ER-0276                TO  EMI-ERROR
  7440         MOVE -1                     TO  MAINTL
  7441         MOVE AL-UABON               TO  MAINTA
  7442         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7443         GO TO 8110-SEND-DATA.
  7444
  7445     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7446     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7447     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7448     MOVE PI-CERT-NO                 TO  CERT-NO.
  7449
  7450
  7451* EXEC CICS READ
  7452*        DATASET   (CLMS-FILE-ID)
  7453*        RIDFLD    (MSTR-KEY)
  7454*        SET       (ADDRESS OF CLAIM-MASTER)
  7455*    END-EXEC.
  7456*    MOVE '&"S        E          (   #00007314' TO DFHEIV0
  7457     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7458     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7459     MOVE X'2020233030303037333134' TO DFHEIV0(25:11)
  7460     CALL 'kxdfhei1' USING DFHEIV0,
  7461           CLMS-FILE-ID,
  7462           DFHEIV20,
  7463           DFHEIV99,
  7464           MSTR-KEY,
  7465           DFHEIV99,
  7466           DFHEIV99,
  7467           DFHEIV99
  7468     SET ADDRESS OF CLAIM-MASTER TO
  7469         DFHEIV20
  7470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7471
  7472
  7473
  7474* EXEC CICS GETMAIN
  7475*        SET       (ADDRESS OF ALPHA-INDEX)
  7476*        LENGTH    (ALPH-LENGTH)
  7477*        INITIMG   (GETMAIN-SPACE)
  7478*    END-EXEC.
  7479*    MOVE ',"IL                  $   #00007320' TO DFHEIV0
  7480     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7481     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7482     MOVE X'2020233030303037333230' TO DFHEIV0(25:11)
  7483     CALL 'kxdfhei1' USING DFHEIV0,
  7484           DFHEIV20,
  7485           ALPH-LENGTH,
  7486           GETMAIN-SPACE
  7487     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 137
* EL131.cbl
  7488         DFHEIV20
  7489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7490
  7491
  7492     MOVE 'AI'                       TO  AI-RECORD-ID.
  7493     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7494                                         AI-CL-COMPANY-CD.
  7495     MOVE 'C'                        TO  AI-SOURCE
  7496                                         AI-CL-SOURCE.
  7497
  7498     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7499     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7500     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7501
  7502     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7503     MOVE '5'                        TO  DC-OPTION-CODE.
  7504     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7505     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7506     IF BUILD-YEAR IS GREATER THAN 50
  7507         MOVE '19'                   TO  WS-ALPHA-YY-1
  7508         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7509         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7510         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7511     ELSE
  7512         MOVE '20'                   TO  WS-ALPHA-YY-1
  7513         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7514         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7515         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7516
  7517     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7518                                         AI-CL-DATE.
  7519
  7520     MOVE EIBTIME                    TO  AI-TIME
  7521                                         AI-CL-TIME.
  7522
  7523     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7524     MOVE 'C'                        TO  AI-CL-SOURCE.
  7525     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7526     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7527     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7528     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7529     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7530
  7531     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7532     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7533     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7534
  7535     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7536         MOVE 'Y'                TO CL-YESNOSW
  7537     END-IF.
  7538
  7539
  7540* EXEC CICS WRITE
  7541*        DATASET   (ALPH-FILE-ID)
  7542*        RIDFLD    (AI-CONTROL-PRIMARY)
  7543*        FROM      (ALPHA-INDEX)
  7544*    END-EXEC.
  7545     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 138
* EL131.cbl
  7546      ALPHA-INDEX
  7547       TO DFHEIV11
  7548*    MOVE '&$ L                  ''   #00007373' TO DFHEIV0
  7549     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7550     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7551     MOVE X'2020233030303037333733' TO DFHEIV0(25:11)
  7552     CALL 'kxdfhei1' USING DFHEIV0,
  7553           ALPH-FILE-ID,
  7554           ALPHA-INDEX,
  7555           DFHEIV11,
  7556           AI-CONTROL-PRIMARY,
  7557           DFHEIV99,
  7558           DFHEIV99
  7559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7560
  7561
  7562
  7563* EXEC CICS READ
  7564*        DATASET   (CLMS-FILE-ID)
  7565*        RIDFLD    (MSTR-KEY)
  7566*        SET       (ADDRESS OF CLAIM-MASTER)
  7567*        UPDATE
  7568*    END-EXEC.
  7569*    MOVE '&"S        EU         (   #00007379' TO DFHEIV0
  7570     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7571     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7572     MOVE X'2020233030303037333739' TO DFHEIV0(25:11)
  7573     CALL 'kxdfhei1' USING DFHEIV0,
  7574           CLMS-FILE-ID,
  7575           DFHEIV20,
  7576           DFHEIV99,
  7577           MSTR-KEY,
  7578           DFHEIV99,
  7579           DFHEIV99,
  7580           DFHEIV99
  7581     SET ADDRESS OF CLAIM-MASTER TO
  7582         DFHEIV20
  7583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7584
  7585
  7586     if (cl-priority-cd = '8')
  7587        and (pi-processor-id not = 'PEMA'and 'JMS '
  7588             AND 'AMWA')
  7589        MOVE ER-8003             TO EMI-ERROR
  7590        PERFORM 9900-ERROR-FORMAT
  7591                                 THRU 9900-EXIT
  7592        MOVE -1                  TO MAINTL
  7593        GO TO 8110-SEND-DATA
  7594     end-if
  7595
  7596     IF MLNAMEL IS GREATER THAN +0
  7597         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  7598
  7599     IF MFNAMEL IS GREATER THAN +0
  7600         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  7601
  7602     IF MMINITL IS GREATER THAN +0
  7603         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 139
* EL131.cbl
  7604
  7605     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  7606     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  7607     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  7608     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  7609
  7610     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7611         MOVE 'Y'                TO CL-YESNOSW
  7612     END-IF.
  7613
  7614
  7615* EXEC CICS HANDLE CONDITION
  7616*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  7617*    END-EXEC.
  7618*    MOVE '"$$                   ! $ #00007414' TO DFHEIV0
  7619     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  7620     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7621     MOVE X'2420233030303037343134' TO DFHEIV0(25:11)
  7622     CALL 'kxdfhei1' USING DFHEIV0
  7623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7624
  7625
  7626
  7627* EXEC CICS REWRITE
  7628*        DATASET   (CLMS-FILE-ID)
  7629*        FROM      (CLAIM-MASTER)
  7630*    END-EXEC.
  7631     MOVE LENGTH OF
  7632      CLAIM-MASTER
  7633       TO DFHEIV11
  7634*    MOVE '&& L                  %   #00007418' TO DFHEIV0
  7635     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7636     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7637     MOVE X'2020233030303037343138' TO DFHEIV0(25:11)
  7638     CALL 'kxdfhei1' USING DFHEIV0,
  7639           CLMS-FILE-ID,
  7640           CLAIM-MASTER,
  7641           DFHEIV11,
  7642           DFHEIV99
  7643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7644
  7645
  7646 0600-CONTINUE-NAME-UPDATE.
  7647
  7648     MOVE LOW-VALUES                 TO  EL131AO.
  7649     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7650     MOVE ER-0000                    TO  EMI-ERROR.
  7651     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7652     MOVE -1                         TO  MAINTL.
  7653     GO TO 8100-SEND-MAP.
  7654
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 140
* EL131.cbl
  7656 1000-EDIT-SCREEN.
  7657
  7658     MOVE MAINTI                 TO CHECK-MAINT.
  7659
  7660     IF NOT VALID-OPTIONS
  7661         MOVE 'X'                TO ERROR-SWITCH
  7662         MOVE -1                 TO MAINTL
  7663         MOVE AL-UABON           TO MAINTA
  7664         MOVE ER-0023            TO EMI-ERROR
  7665         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7666         GO TO 1010-EXIT.
  7667
  7668     IF NOT MODIFY-CAP
  7669         MOVE 'UPDATE'           TO  SM-READ
  7670         PERFORM 9995-SECURITY-VIOLATION
  7671         MOVE ER-0070               TO  EMI-ERROR
  7672         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7673         GO TO 8100-SEND-MAP.
  7674
  7675     IF DELETE-CLAIM
  7676         MOVE AL-UANON TO MAINTA
  7677         GO TO 1010-EXIT.
  7678
  7679     MOVE AL-UANON               TO MAINTA.
  7680
  7681     IF CCNOI GREATER THAN LOW-VALUES
  7682         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  7683
  7684     IF PI-COMPANY-ID = 'CSL'
  7685        CONTINUE
  7686     ELSE
  7687        IF TYPEL > ZERO
  7688           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  7689              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7690                    PI-LIFE-OVERRIDE-L1))
  7691                       OR
  7692              ((PI-COMPANY-ID = 'DCC')
  7693              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7694                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G'))
  7695              MOVE AL-UANON      TO TYPEA
  7696              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  7697           ELSE
  7698              MOVE ER-0199       TO EMI-ERROR
  7699              PERFORM 9900-ERROR-FORMAT
  7700                                 THRU 9900-EXIT
  7701              MOVE AL-UABON      TO TYPEA
  7702              MOVE -1            TO TYPEL
  7703              MOVE 'X'           TO ERROR-SWITCH
  7704           END-IF
  7705        ELSE
  7706           MOVE AL-UANOF         TO TYPEA
  7707        END-IF
  7708     END-IF
  7709     IF STATUSI GREATER THAN LOW-VALUES
  7710         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  7711             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  7712             MOVE AL-UANON       TO STATUSA
  7713             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 141
* EL131.cbl
  7714             MOVE 'Y'            TO DLYACTV-SW
  7715         ELSE
  7716             MOVE ER-0333        TO EMI-ERROR
  7717             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7718             MOVE AL-UABON       TO STATUSA
  7719             MOVE -1             TO STATUSL
  7720             MOVE 'X'            TO ERROR-SWITCH
  7721         END-IF
  7722     ELSE
  7723         MOVE SPACE              TO TRLR-SWITCH
  7724         MOVE 'N'                TO DLYACTV-SW
  7725         MOVE AL-UANOF           TO STATUSA.
  7726
  7727     IF PROCI GREATER THAN LOW-VALUES
  7728         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  7729     ELSE
  7730         MOVE AL-UANOF TO PROCA.
  7731
  7732     IF SEXI GREATER THAN LOW-VALUES
  7733         IF SEXI = 'F' OR 'M'
  7734             MOVE AL-UANON       TO SEXA
  7735             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7736           ELSE
  7737             MOVE ER-0219        TO EMI-ERROR
  7738             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7739             MOVE AL-UABON       TO SEXA
  7740             MOVE -1             TO SEXL
  7741             MOVE 'X'            TO ERROR-SWITCH
  7742       ELSE
  7743         MOVE AL-UANOF           TO SEXA.
  7744
  7745     IF BIRTHL = +0
  7746         MOVE LOW-VALUES         TO  HOLD-BIRTH
  7747         MOVE AL-UANOF           TO  BIRTHA
  7748         GO TO 1000-CONTINUE-EDITS.
  7749
  7750     IF BIRTHI = SPACES
  7751         MOVE LOW-VALUES         TO  HOLD-BIRTH
  7752         MOVE 'X'                TO  UPDATE-SWITCH
  7753                                     MSTR-SWITCH
  7754         GO TO 1000-CONTINUE-EDITS.
  7755
  7756     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  7757     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  7758     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  7759     MOVE '4'                    TO  DC-OPTION-CODE.
  7760     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7761     IF DATE-CONVERSION-ERROR
  7762         MOVE ER-0220            TO  EMI-ERROR
  7763         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7764         MOVE AL-UABON           TO  BIRTHA
  7765         MOVE -1                 TO  BIRTHL
  7766         MOVE 'X'                TO  ERROR-SWITCH
  7767         GO TO 1000-CONTINUE-EDITS.
  7768
  7769******************************************************************
  7770**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  7771**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 142
* EL131.cbl
  7772**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  7773******************************************************************
  7774     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  7775         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  7776         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  7777         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  7778         MOVE '4'                TO  DC-OPTION-CODE
  7779         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  7780         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7781                                     DC-ELAPSED-DAYS
  7782         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7783         IF DATE-CONVERSION-ERROR
  7784             MOVE ER-0220        TO  EMI-ERROR
  7785             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7786             MOVE AL-UABON       TO  BIRTHA
  7787             MOVE -1             TO  BIRTHL
  7788             MOVE 'X'            TO  ERROR-SWITCH
  7789             GO TO 1000-CONTINUE-EDITS.
  7790
  7791     MOVE AL-UANON               TO  BIRTHA.
  7792     MOVE 'X'                    TO  UPDATE-SWITCH
  7793                                     MSTR-SWITCH.
  7794     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  7795     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  7796     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  7797
  7798 1000-CONTINUE-EDITS.
  7799
  7800     IF SOCIALI GREATER THAN LOW-VALUES
  7801         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  7802         IF WS-SOC-SEC-NO NUMERIC AND
  7803           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  7804             NEXT SENTENCE
  7805         ELSE
  7806            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  7807               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  7808               WS-SSN-DASH2 = '-'
  7809                 NEXT SENTENCE
  7810            ELSE
  7811                 MOVE ER-0887        TO  EMI-ERROR
  7812                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7813                 MOVE AL-UABON       TO  SOCIALA
  7814                 MOVE -1             TO  SOCIALL
  7815                 MOVE 'X'            TO  ERROR-SWITCH
  7816            END-IF
  7817        END-IF
  7818     END-IF.
  7819
  7820     IF SOCIALI GREATER THAN LOW-VALUES
  7821         MOVE AL-UANON           TO SOCIALA
  7822         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  7823     ELSE
  7824         MOVE AL-UANOF           TO SOCIALA.
  7825
  7826     IF OCCI GREATER THAN LOW-VALUES
  7827         MOVE AL-UANON           TO OCCA
  7828         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  7829     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 143
* EL131.cbl
  7830         MOVE AL-UANOF           TO OCCA.
  7831
  7832     IF BENEL NOT GREATER THAN ZERO
  7833            GO TO 1005-CONTINUE-EDITS.
  7834
  7835     IF BENEI = SPACES
  7836        MOVE 'X'                 TO UPDATE-SWITCH MSTR-SWITCH
  7837        GO TO 1005-CONTINUE-EDITS.
  7838
  7839
  7840* EXEC CICS HANDLE CONDITION
  7841*        NOTFND (1004-BENE-NOT-FOUND)
  7842*    END-EXEC.
  7843*    MOVE '"$I                   ! % #00007616' TO DFHEIV0
  7844     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7845     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7846     MOVE X'2520233030303037363136' TO DFHEIV0(25:11)
  7847     CALL 'kxdfhei1' USING DFHEIV0
  7848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7849
  7850
  7851     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  7852     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  7853     MOVE BENEI                  TO  WS-ELBENE-ID.
  7854
  7855
  7856* EXEC CICS READ
  7857*        DATASET ('ELBENE')
  7858*        RIDFLD  (WS-ELBENE-KEY)
  7859*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  7860*    END-EXEC.
  7861     MOVE 'ELBENE' TO DFHEIV1
  7862*    MOVE '&"S        E          (   #00007624' TO DFHEIV0
  7863     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7864     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7865     MOVE X'2020233030303037363234' TO DFHEIV0(25:11)
  7866     CALL 'kxdfhei1' USING DFHEIV0,
  7867           DFHEIV1,
  7868           DFHEIV20,
  7869           DFHEIV99,
  7870           WS-ELBENE-KEY,
  7871           DFHEIV99,
  7872           DFHEIV99,
  7873           DFHEIV99
  7874     SET ADDRESS OF BENEFICIARY-MASTER TO
  7875         DFHEIV20
  7876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7877
  7878
  7879     MOVE AL-UANON               TO  BENEA.
  7880     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  7881
  7882     GO TO 1005-CONTINUE-EDITS.
  7883
  7884 1004-BENE-NOT-FOUND.
  7885     MOVE ER-0565                TO  EMI-ERROR.
  7886
  7887     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 144
* EL131.cbl
  7888     MOVE 'X'                    TO ERROR-SWITCH.
  7889     MOVE AL-UABON               TO BENEA.
  7890     MOVE -1                     TO BENEL.
  7891
  7892 1005-CONTINUE-EDITS.
  7893
  7894     IF DIAGI GREATER THAN LOW-VALUES
  7895         MOVE AL-UANON           TO DIAGA
  7896         MOVE 'X'                TO UPDATE-SWITCH
  7897                                    NINETY-TRLR-SWITCH
  7898     ELSE
  7899         MOVE AL-UANOF           TO DIAGA.
  7900
  7901     IF CAUSEI GREATER THAN LOW-VALUES
  7902         MOVE AL-UANON           TO CAUSEA
  7903         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  7904     ELSE
  7905         MOVE AL-UANOF           TO CAUSEA.
  7906
  7907     IF ENDL GREATER THAN ZERO
  7908         MOVE LOW-VALUES         TO HOLD-END
  7909         IF ENDI = SPACES
  7910             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7911         ELSE
  7912             MOVE ENDI           TO DEEDIT-DATE-INPUT
  7913
  7914* EXEC CICS BIF DEEDIT
  7915*                FIELD    (DEEDIT-DATE-INPUT)
  7916*                LENGTH   (DATE-LENGTH)
  7917*            END-EXEC
  7918*    MOVE '@"L                   #   #00007664' TO DFHEIV0
  7919     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7920     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7921     MOVE X'2020233030303037363634' TO DFHEIV0(25:11)
  7922     CALL 'kxdfhei1' USING DFHEIV0,
  7923           DEEDIT-DATE-INPUT,
  7924           DATE-LENGTH
  7925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7926             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  7927             MOVE '4'            TO DC-OPTION-CODE
  7928             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7929             IF NOT DATE-CONVERSION-ERROR
  7930                 MOVE DC-BIN-DATE-1      TO HOLD-END
  7931                 MOVE AL-UANON   TO ENDA
  7932                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  7933                 MOVE DC-GREG-DATE-1-EDIT TO ENDO
  7934             ELSE
  7935                 MOVE ER-0224    TO EMI-ERROR
  7936                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7937                 MOVE AL-UABON   TO ENDA
  7938                 MOVE -1         TO ENDL
  7939                 MOVE 'X'        TO ERROR-SWITCH
  7940       ELSE
  7941           MOVE AL-UANOF         TO ENDA.
  7942
  7943     IF INCL GREATER THAN ZERO
  7944         MOVE LOW-VALUES         TO HOLD-INCUR
  7945         IF INCI = SPACES
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 145
* EL131.cbl
  7946             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7947         ELSE
  7948             MOVE INCI           TO DEEDIT-DATE-INPUT
  7949
  7950* EXEC CICS BIF DEEDIT
  7951*                FIELD    (DEEDIT-DATE-INPUT)
  7952*                LENGTH   (DATE-LENGTH)
  7953*            END-EXEC
  7954*    MOVE '@"L                   #   #00007691' TO DFHEIV0
  7955     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7956     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7957     MOVE X'2020233030303037363931' TO DFHEIV0(25:11)
  7958     CALL 'kxdfhei1' USING DFHEIV0,
  7959           DEEDIT-DATE-INPUT,
  7960           DATE-LENGTH
  7961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7962             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  7963             MOVE '4'            TO DC-OPTION-CODE
  7964             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7965             IF NOT DATE-CONVERSION-ERROR
  7966                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  7967                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  7968                 MOVE AL-UANON           TO INCA
  7969                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  7970             ELSE
  7971                 MOVE ER-0222    TO EMI-ERROR
  7972                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7973                 MOVE AL-UABON   TO INCA
  7974                 MOVE -1         TO INCL
  7975                 MOVE 'X'        TO ERROR-SWITCH
  7976       ELSE
  7977           IF PI-NO-PMTS = ZEROS
  7978               MOVE AL-UANOF     TO INCA.
  7979
  7980     IF REPL GREATER THAN ZERO
  7981         MOVE LOW-VALUES         TO HOLD-REPORTED
  7982         IF REPI = SPACES
  7983             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7984         ELSE
  7985             MOVE REPI           TO DEEDIT-DATE-INPUT
  7986
  7987* EXEC CICS BIF DEEDIT
  7988*                FIELD    (DEEDIT-DATE-INPUT)
  7989*                LENGTH   (DATE-LENGTH)
  7990*            END-EXEC
  7991*    MOVE '@"L                   #   #00007719' TO DFHEIV0
  7992     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7993     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7994     MOVE X'2020233030303037373139' TO DFHEIV0(25:11)
  7995     CALL 'kxdfhei1' USING DFHEIV0,
  7996           DEEDIT-DATE-INPUT,
  7997           DATE-LENGTH
  7998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7999             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8000             MOVE '4'            TO DC-OPTION-CODE
  8001             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8002             IF NOT DATE-CONVERSION-ERROR
  8003                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 146
* EL131.cbl
  8004                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8005                 MOVE AL-UANON   TO REPA
  8006                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8007             ELSE
  8008                 MOVE ER-0223    TO EMI-ERROR
  8009                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8010                 MOVE AL-UABON   TO REPA
  8011                 MOVE -1         TO REPL
  8012                 MOVE 'X'        TO ERROR-SWITCH
  8013       ELSE
  8014         MOVE AL-UANOF TO REPA.
  8015
  8016     IF PDTHRUI GREATER THAN LOW-VALUES
  8017        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8018        IF PDTHRUI = SPACES
  8019           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8020        ELSE
  8021           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8022
  8023* EXEC CICS BIF DEEDIT
  8024*               FIELD    (DEEDIT-DATE-INPUT)
  8025*               LENGTH   (DATE-LENGTH)
  8026*          END-EXEC
  8027*    MOVE '@"L                   #   #00007746' TO DFHEIV0
  8028     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8029     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8030     MOVE X'2020233030303037373436' TO DFHEIV0(25:11)
  8031     CALL 'kxdfhei1' USING DFHEIV0,
  8032           DEEDIT-DATE-INPUT,
  8033           DATE-LENGTH
  8034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8035           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8036           MOVE '4'            TO DC-OPTION-CODE
  8037           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8038           IF NOT DATE-CONVERSION-ERROR
  8039              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8040              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8041              MOVE AL-UANON   TO PDTHRUA
  8042              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8043              IF PI-USES-PAID-TO
  8044                 MOVE '6'            TO DC-OPTION-CODE
  8045                 MOVE -1             TO DC-ELAPSED-DAYS
  8046                 MOVE +0             TO DC-ELAPSED-MONTHS
  8047                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8048                 IF NO-CONVERSION-ERROR
  8049                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8050                 ELSE
  8051                    NEXT SENTENCE
  8052              ELSE
  8053                 NEXT SENTENCE
  8054           ELSE
  8055              MOVE ER-0475    TO EMI-ERROR
  8056              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8057              MOVE AL-UABON   TO PDTHRUA
  8058              MOVE -1         TO PDTHRUL
  8059              MOVE 'X'        TO ERROR-SWITCH
  8060     ELSE
  8061        IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 147
* EL131.cbl
  8062           MOVE AL-UANOF        TO PDTHRUA.
  8063
  8064     IF PDAMTL GREATER THAN +0
  8065         MOVE ZEROS              TO HOLD-PDAMT
  8066
  8067* EXEC CICS BIF DEEDIT
  8068*            FIELD    (PDAMTI)
  8069*            LENGTH   (9)
  8070*        END-EXEC
  8071     MOVE 9
  8072       TO DFHEIV11
  8073*    MOVE '@"L                   #   #00007781' TO DFHEIV0
  8074     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8075     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8076     MOVE X'2020233030303037373831' TO DFHEIV0(25:11)
  8077     CALL 'kxdfhei1' USING DFHEIV0,
  8078           PDAMTI,
  8079           DFHEIV11
  8080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8081         IF PDAMTI NUMERIC
  8082             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8083             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8084             MOVE AL-UNNON       TO PDAMTA
  8085         ELSE
  8086             MOVE ER-0547        TO EMI-ERROR
  8087             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8088             MOVE AL-UNBON       TO PDAMTA
  8089             MOVE -1             TO PDAMTL
  8090             MOVE 'X'            TO ERROR-SWITCH
  8091     ELSE
  8092         IF MODIFY-CAP
  8093            MOVE AL-UNNOF        TO PDAMTA.
  8094
  8095     IF NODAYSI GREATER THAN LOW-VALUES
  8096         MOVE ZEROS              TO HOLD-NODAYS
  8097
  8098* EXEC CICS BIF DEEDIT
  8099*            FIELD (NODAYSI)
  8100*            LENGTH (5)
  8101*        END-EXEC
  8102     MOVE 5
  8103       TO DFHEIV11
  8104*    MOVE '@"L                   #   #00007801' TO DFHEIV0
  8105     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8106     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8107     MOVE X'2020233030303037383031' TO DFHEIV0(25:11)
  8108     CALL 'kxdfhei1' USING DFHEIV0,
  8109           NODAYSI,
  8110           DFHEIV11
  8111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8112         IF NODAYSI NUMERIC
  8113             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8114             MOVE AL-UNNON       TO NODAYSA
  8115             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8116         ELSE
  8117             MOVE ER-0491        TO EMI-ERROR
  8118             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8119             MOVE AL-UNBON       TO NODAYSA
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 148
* EL131.cbl
  8120             MOVE -1             TO NODAYSL
  8121             MOVE 'X'            TO ERROR-SWITCH
  8122     ELSE
  8123         IF MODIFY-CAP
  8124            MOVE AL-UNNOF        TO NODAYSA.
  8125
  8126     IF NOPMTSI GREATER THAN LOW-VALUES
  8127         MOVE ZEROS              TO HOLD-NOPMTS
  8128
  8129* EXEC CICS BIF DEEDIT
  8130*            FIELD (NOPMTSI)
  8131*            LENGTH (4)
  8132*        END-EXEC
  8133     MOVE 4
  8134       TO DFHEIV11
  8135*    MOVE '@"L                   #   #00007821' TO DFHEIV0
  8136     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8137     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8138     MOVE X'2020233030303037383231' TO DFHEIV0(25:11)
  8139     CALL 'kxdfhei1' USING DFHEIV0,
  8140           NOPMTSI,
  8141           DFHEIV11
  8142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8143         IF NOPMTSI NUMERIC
  8144             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8145             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8146             MOVE AL-UNNON       TO NOPMTSA
  8147           ELSE
  8148             MOVE ER-0548        TO EMI-ERROR
  8149             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8150             MOVE AL-UNBON       TO NOPMTSA
  8151             MOVE -1             TO NOPMTSL
  8152             MOVE 'X'            TO ERROR-SWITCH
  8153       ELSE
  8154         IF MODIFY-CAP
  8155            MOVE AL-UNNOF        TO NOPMTSA.
  8156
  8157     IF FORMTYPI GREATER THAN LOW-VALUES
  8158         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8159             MOVE AL-UANON       TO FORMTYPA
  8160             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8161           ELSE
  8162             MOVE ER-7650        TO EMI-ERROR
  8163             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8164             MOVE AL-UABON       TO FORMTYPA
  8165             MOVE -1             TO FORMTYPL
  8166             MOVE 'X'            TO ERROR-SWITCH
  8167       ELSE
  8168         MOVE AL-UANOF           TO FORMTYPA.
  8169
  8170     IF PRICDL GREATER THAN ZERO
  8171         IF (PRICDI = ' ') OR
  8172            (PRICDI GREATER THAN ZERO   AND
  8173             PRICDI NOT GREATER THAN '9')
  8174             MOVE AL-UANON       TO PRICDA
  8175             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8176         ELSE
  8177             MOVE ER-0274        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 149
* EL131.cbl
  8178             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8179             MOVE AL-UABON       TO PRICDA
  8180             MOVE -1             TO PRICDL
  8181             MOVE 'X'            TO ERROR-SWITCH
  8182     ELSE
  8183         MOVE AL-UANOF TO PRICDA.
  8184
  8185     IF PI-COMPANY-ID = 'DMD'
  8186     IF PRICDL GREATER THAN ZERO
  8187       IF SYSTEM-MODIFY-CAP  OR
  8188          PI-PROCESSOR-ID = 'LGXX'
  8189             NEXT SENTENCE
  8190           ELSE
  8191            IF CL-PRIORITY-CD = '9'  OR
  8192               PRICDI         = '9'
  8193                  MOVE ER-0938        TO EMI-ERROR
  8194                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8195                  MOVE AL-UABON       TO PRICDA
  8196                  MOVE -1             TO PRICDL
  8197                  MOVE 'X'            TO ERROR-SWITCH.
  8198
  8199     IF FILETOL GREATER THAN ZERO
  8200         MOVE AL-UANON           TO FILETOA
  8201         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8202     ELSE
  8203         MOVE AL-UANOF TO FILETOA.
  8204
  8205     IF SUPVL GREATER THAN ZERO
  8206         IF SUPVI = 'Y' OR 'N' OR SPACE
  8207             MOVE AL-UANON       TO SUPVA
  8208             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8209         ELSE
  8210             MOVE ER-0230        TO EMI-ERROR
  8211             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8212             MOVE AL-UABON       TO SUPVA
  8213             MOVE -1             TO SUPVL
  8214             MOVE 'X'            TO ERROR-SWITCH
  8215     ELSE
  8216         MOVE AL-UANOF           TO SUPVA.
  8217
  8218     IF MLNAMEL GREATER THAN ZERO
  8219         IF MLNAMEI GREATER THAN SPACES
  8220            MOVE AL-UANON        TO MLNAMEA
  8221            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8222                                     MSTR-KEY-SWITCH
  8223         ELSE
  8224            MOVE ER-0236         TO EMI-ERROR
  8225            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8226            MOVE AL-UABON        TO MLNAMEA
  8227            MOVE -1              TO MLNAMEL
  8228            MOVE 'X'             TO ERROR-SWITCH
  8229     ELSE
  8230         MOVE AL-UANOF           TO MLNAMEA.
  8231
  8232     IF MFNAMEI GREATER THAN LOW-VALUES
  8233         MOVE AL-UANON           TO MFNAMEA
  8234         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8235     ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 150
* EL131.cbl
  8236         MOVE AL-UANOF           TO MFNAMEA.
  8237
  8238     IF MMINITI GREATER THAN LOW-VALUES
  8239         MOVE AL-UANON           TO MMINITA
  8240         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8241     ELSE
  8242         MOVE AL-UANOF           TO MMINITA.
  8243
  8244     IF CRTLNMEI GREATER THAN LOW-VALUES
  8245         IF CRTLNMEI NOT = SPACES
  8246            MOVE AL-UANON        TO CRTLNMEA
  8247            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8248                                     CERT-KEY-SWITCH
  8249        ELSE
  8250            MOVE ER-0236         TO EMI-ERROR
  8251            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8252            MOVE AL-UABON        TO CRTLNMEA
  8253            MOVE -1              TO CRTLNMEL
  8254            MOVE 'X'             TO ERROR-SWITCH
  8255     ELSE
  8256         MOVE AL-UANOF           TO CRTLNMEA.
  8257
  8258     IF CRTFNMEI GREATER THAN LOW-VALUES
  8259         MOVE AL-UANON           TO CRTFNMEA
  8260         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8261     ELSE
  8262         MOVE AL-UANOF           TO CRTFNMEA.
  8263
  8264     IF CRTINITI GREATER THAN LOW-VALUES
  8265         MOVE AL-UANON           TO CRTINITA
  8266         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
  8267     ELSE
  8268         MOVE AL-UANOF           TO CRTINITA.
  8269
  8270     IF ISSAGEL GREATER THAN ZERO
  8271         IF ISSAGEI NUMERIC
  8272            MOVE AL-UANON        TO ISSAGEA
  8273            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8274         ELSE
  8275            MOVE ER-0237         TO EMI-ERROR
  8276            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8277            MOVE AL-UABON        TO ISSAGEA
  8278            MOVE -1              TO ISSAGEL
  8279            MOVE 'X'             TO ERROR-SWITCH
  8280     ELSE
  8281         MOVE AL-UANOF           TO ISSAGEA.
  8282
  8283     IF JNTFNMEI GREATER THAN LOW-VALUES
  8284         MOVE AL-UANON           TO JNTFNMEA
  8285         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8286     ELSE
  8287         MOVE AL-UANOF           TO JNTFNMEA.
  8288
  8289     IF JNTLNMEI GREATER THAN LOW-VALUES
  8290         MOVE AL-UANON           TO JNTLNMEA
  8291         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8292     ELSE
  8293         MOVE AL-UANOF           TO JNTLNMEA.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 151
* EL131.cbl
  8294
  8295     IF JNTINITI GREATER THAN LOW-VALUES
  8296         MOVE AL-UANON           TO JNTINITA
  8297         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8298     ELSE
  8299         MOVE AL-UANOF           TO JNTINITA.
  8300
  8301     IF JNTAGEL GREATER THAN ZERO
  8302         IF JNTAGEI NUMERIC
  8303            MOVE AL-UANON        TO JNTAGEA
  8304            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8305         ELSE
  8306            MOVE ER-0238         TO EMI-ERROR
  8307            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8308            MOVE AL-UABON        TO JNTAGEA
  8309            MOVE -1              TO JNTAGEL
  8310            MOVE 'X'             TO ERROR-SWITCH
  8311     ELSE
  8312         MOVE AL-UANOF           TO JNTAGEA.
  8313
  8314     IF ADDONDTI GREATER THAN LOW-VALUES
  8315         MOVE LOW-VALUES         TO HOLD-ADDON
  8316         IF ADDONDTI = SPACES
  8317             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8318         ELSE
  8319             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8320
  8321* EXEC CICS BIF DEEDIT
  8322*                FIELD    (DEEDIT-DATE-INPUT)
  8323*                LENGTH   (DATE-LENGTH)
  8324*            END-EXEC
  8325*    MOVE '@"L                   #   #00008002' TO DFHEIV0
  8326     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8327     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8328     MOVE X'2020233030303038303032' TO DFHEIV0(25:11)
  8329     CALL 'kxdfhei1' USING DFHEIV0,
  8330           DEEDIT-DATE-INPUT,
  8331           DATE-LENGTH
  8332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8333             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8334             MOVE '4'            TO DC-OPTION-CODE
  8335             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8336             IF NOT DATE-CONVERSION-ERROR
  8337                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  8338                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8339                                                  CERT-SWITCH
  8340                 MOVE AL-UANON   TO ADDONDTA
  8341                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8342             ELSE
  8343                 MOVE ER-7651    TO EMI-ERROR
  8344                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8345                 MOVE AL-UABON   TO ADDONDTA
  8346                 MOVE -1         TO ADDONDTL
  8347                 MOVE 'X'        TO ERROR-SWITCH
  8348       ELSE
  8349         MOVE AL-UANOF TO ADDONDTA.
  8350
  8351     IF LCVCDI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 152
* EL131.cbl
  8352         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8353         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8354     ELSE
  8355         MOVE AL-UANOF           TO LCVCDA.
  8356
  8357     IF ACVCDI GREATER THAN LOW-VALUES
  8358         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8359         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8360     ELSE
  8361         MOVE AL-UANOF           TO ACVCDA.
  8362
  8363     IF LCVOTRMI GREATER THAN LOW-VALUES
  8364
  8365* EXEC CICS BIF DEEDIT
  8366*            FIELD (LCVOTRMI)
  8367*            LENGTH(3)
  8368*        END-EXEC
  8369     MOVE 3
  8370       TO DFHEIV11
  8371*    MOVE '@"L                   #   #00008037' TO DFHEIV0
  8372     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8373     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8374     MOVE X'2020233030303038303337' TO DFHEIV0(25:11)
  8375     CALL 'kxdfhei1' USING DFHEIV0,
  8376           LCVOTRMI,
  8377           DFHEIV11
  8378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8379         IF LCVOTRMI IS NUMERIC
  8380             MOVE LCVOTRMI       TO LCVOTRMO
  8381             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8382             MOVE AL-UANON       TO LCVOTRMA
  8383         ELSE
  8384             MOVE ER-0241        TO EMI-ERROR
  8385             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8386             MOVE AL-UNBON       TO LCVOTRMA
  8387             MOVE 'X'            TO ERROR-SWITCH
  8388             MOVE -1             TO LCVOTRML
  8389     ELSE
  8390         MOVE AL-UANOF           TO LCVOTRMA.
  8391
  8392     IF ACVOTRMI GREATER THAN LOW-VALUES
  8393
  8394* EXEC CICS BIF DEEDIT
  8395*            FIELD (ACVOTRMI)
  8396*            LENGTH(3)
  8397*        END-EXEC
  8398     MOVE 3
  8399       TO DFHEIV11
  8400*    MOVE '@"L                   #   #00008055' TO DFHEIV0
  8401     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8402     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8403     MOVE X'2020233030303038303535' TO DFHEIV0(25:11)
  8404     CALL 'kxdfhei1' USING DFHEIV0,
  8405           ACVOTRMI,
  8406           DFHEIV11
  8407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8408         IF ACVOTRMI IS NUMERIC
  8409             MOVE ACVOTRMI       TO ACVOTRMO
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 153
* EL131.cbl
  8410             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8411             MOVE AL-UANON       TO ACVOTRMA
  8412         ELSE
  8413             MOVE ER-0241        TO EMI-ERROR
  8414             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8415             MOVE AL-UNBON       TO ACVOTRMA
  8416             MOVE 'X'            TO ERROR-SWITCH
  8417             MOVE -1             TO ACVOTRML
  8418     ELSE
  8419         MOVE AL-UANOF           TO ACVOTRMA.
  8420
  8421     IF LCVRATEL GREATER THAN +0
  8422
  8423* EXEC CICS BIF DEEDIT
  8424*            FIELD (LCVRATEI)
  8425*            LENGTH(6)
  8426*        END-EXEC
  8427     MOVE 6
  8428       TO DFHEIV11
  8429*    MOVE '@"L                   #   #00008073' TO DFHEIV0
  8430     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8431     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8432     MOVE X'2020233030303038303733' TO DFHEIV0(25:11)
  8433     CALL 'kxdfhei1' USING DFHEIV0,
  8434           LCVRATEI,
  8435           DFHEIV11
  8436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8437         IF LCVRATEI IS NUMERIC
  8438             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  8439             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8440             MOVE AL-UNNON       TO LCVRATEA
  8441         ELSE
  8442             MOVE ER-2280        TO EMI-ERROR
  8443             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8444             MOVE AL-UNBON       TO LCVRATEA
  8445             MOVE 'X'            TO ERROR-SWITCH
  8446             MOVE -1             TO LCVRATEL
  8447     ELSE
  8448         MOVE AL-UNNOF           TO LCVRATEA.
  8449
  8450     IF ACVRATEL GREATER THAN +0
  8451
  8452* EXEC CICS BIF DEEDIT
  8453*            FIELD (ACVRATEI)
  8454*            LENGTH(6)
  8455*        END-EXEC
  8456     MOVE 6
  8457       TO DFHEIV11
  8458*    MOVE '@"L                   #   #00008091' TO DFHEIV0
  8459     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8460     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8461     MOVE X'2020233030303038303931' TO DFHEIV0(25:11)
  8462     CALL 'kxdfhei1' USING DFHEIV0,
  8463           ACVRATEI,
  8464           DFHEIV11
  8465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8466         IF ACVRATEI IS NUMERIC
  8467             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 154
* EL131.cbl
  8468             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8469             MOVE AL-UNNON       TO ACVRATEA
  8470         ELSE
  8471             MOVE ER-2280        TO EMI-ERROR
  8472             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8473             MOVE AL-UNBON       TO ACVRATEA
  8474             MOVE 'X'            TO ERROR-SWITCH
  8475             MOVE -1             TO ACVRATEL
  8476     ELSE
  8477         MOVE AL-UNNOF           TO ACVRATEA.
  8478
  8479     IF LCVBENEL GREATER THAN ZERO
  8480
  8481* EXEC CICS BIF DEEDIT
  8482*            FIELD (LCVBENEI)
  8483*            LENGTH (11)
  8484*        END-EXEC
  8485     MOVE 11
  8486       TO DFHEIV11
  8487*    MOVE '@"L                   #   #00008109' TO DFHEIV0
  8488     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8489     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8490     MOVE X'2020233030303038313039' TO DFHEIV0(25:11)
  8491     CALL 'kxdfhei1' USING DFHEIV0,
  8492           LCVBENEI,
  8493           DFHEIV11
  8494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8495         IF LCVBENEI IS NUMERIC
  8496            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  8497            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8498            MOVE AL-UNNON        TO LCVBENEA
  8499         ELSE
  8500            MOVE ER-0243         TO EMI-ERROR
  8501            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8502            MOVE AL-UNBON        TO LCVBENEA
  8503            MOVE -1              TO LCVBENEL
  8504            MOVE 'X'             TO ERROR-SWITCH
  8505     ELSE
  8506         MOVE AL-UANOF           TO LCVBENEA.
  8507
  8508     IF ACVBENEL GREATER THAN ZERO
  8509
  8510* EXEC CICS BIF DEEDIT
  8511*            FIELD (ACVBENEI)
  8512*            LENGTH (11)
  8513*        END-EXEC
  8514     MOVE 11
  8515       TO DFHEIV11
  8516*    MOVE '@"L                   #   #00008127' TO DFHEIV0
  8517     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8518     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8519     MOVE X'2020233030303038313237' TO DFHEIV0(25:11)
  8520     CALL 'kxdfhei1' USING DFHEIV0,
  8521           ACVBENEI,
  8522           DFHEIV11
  8523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8524         IF ACVBENEI IS NUMERIC
  8525            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 155
* EL131.cbl
  8526            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8527            MOVE AL-UNNON        TO ACVBENEA
  8528         ELSE
  8529            MOVE ER-0243         TO EMI-ERROR
  8530            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8531            MOVE AL-UNBON        TO ACVBENEA
  8532            MOVE -1              TO ACVBENEL
  8533            MOVE 'X'             TO ERROR-SWITCH
  8534     ELSE
  8535         MOVE AL-UANOF           TO ACVBENEA.
  8536
  8537     IF LCVFORMI GREATER THAN LOW-VALUES
  8538        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8539        MOVE AL-UANON            TO LCVFORMA
  8540     ELSE
  8541        MOVE AL-UANOF            TO LCVFORMA.
  8542
  8543     IF ACVFORMI GREATER THAN LOW-VALUES
  8544        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8545        MOVE AL-UANON            TO ACVFORMA
  8546     ELSE
  8547        MOVE AL-UANOF            TO ACVFORMA.
  8548
  8549     IF LCVCNDTL GREATER THAN ZERO
  8550         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8551         IF LCVCNDTI = SPACES
  8552             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8553         ELSE
  8554             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  8555             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8556             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8557             MOVE '4'            TO DC-OPTION-CODE
  8558             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8559             IF NOT DATE-CONVERSION-ERROR
  8560                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  8561                 MOVE AL-UANON   TO LCVCNDTA
  8562                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8563                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  8564             ELSE
  8565                 MOVE ER-0246    TO EMI-ERROR
  8566                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8567                 MOVE AL-UABON   TO LCVCNDTA
  8568                 MOVE -1         TO LCVCNDTL
  8569                 MOVE 'X'        TO ERROR-SWITCH
  8570     ELSE
  8571         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8572         MOVE AL-UANOF           TO LCVCNDTA.
  8573
  8574     IF ACVCNDTL GREATER THAN ZERO
  8575         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8576         IF ACVCNDTI = SPACES
  8577             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8578         ELSE
  8579             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  8580             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8581             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8582             MOVE '4'            TO DC-OPTION-CODE
  8583             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 156
* EL131.cbl
  8584             IF NOT DATE-CONVERSION-ERROR
  8585                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  8586                 MOVE AL-UANON   TO ACVCNDTA
  8587                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8588                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  8589             ELSE
  8590                 MOVE ER-0246    TO EMI-ERROR
  8591                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8592                 MOVE AL-UABON   TO ACVCNDTA
  8593                 MOVE -1         TO ACVCNDTL
  8594                 MOVE 'X'        TO ERROR-SWITCH
  8595     ELSE
  8596         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8597         MOVE AL-UANOF           TO ACVCNDTA.
  8598
  8599     IF APRL GREATER THAN +0
  8600
  8601* EXEC CICS BIF DEEDIT
  8602*            FIELD    (APRI)
  8603*            LENGTH   (8)
  8604*        END-EXEC
  8605     MOVE 8
  8606       TO DFHEIV11
  8607*    MOVE '@"L                   #   #00008207' TO DFHEIV0
  8608     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8609     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8610     MOVE X'2020233030303038323037' TO DFHEIV0(25:11)
  8611     CALL 'kxdfhei1' USING DFHEIV0,
  8612           APRI,
  8613           DFHEIV11
  8614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8615         IF APRI NUMERIC
  8616            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8617            MOVE APRI            TO HOLD-APR APRO
  8618            MOVE AL-UANON        TO APRA
  8619          ELSE
  8620            MOVE ER-0259         TO EMI-ERROR
  8621            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8622            MOVE AL-UABON        TO APRA
  8623            MOVE -1              TO APRL
  8624            MOVE 'X'             TO ERROR-SWITCH
  8625     ELSE
  8626         MOVE AL-UANOF           TO APRA.
  8627
  8628     IF PMTFREQL GREATER THAN ZERO
  8629
  8630* EXEC CICS BIF DEEDIT
  8631*            FIELD    (PMTFREQI)
  8632*            LENGTH   (2)
  8633*        END-EXEC
  8634     MOVE 2
  8635       TO DFHEIV11
  8636*    MOVE '@"L                   #   #00008225' TO DFHEIV0
  8637     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8638     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8639     MOVE X'2020233030303038323235' TO DFHEIV0(25:11)
  8640     CALL 'kxdfhei1' USING DFHEIV0,
  8641           PMTFREQI,
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 157
* EL131.cbl
  8642           DFHEIV11
  8643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8644         IF PMTFREQI NUMERIC
  8645            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  8646            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8647            MOVE AL-UANON        TO PMTFREQA
  8648          ELSE
  8649            MOVE ER-0427         TO EMI-ERROR
  8650            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8651            MOVE AL-UABON        TO PMTFREQA
  8652            MOVE -1              TO PMTFREQL
  8653            MOVE 'X'             TO ERROR-SWITCH
  8654     ELSE
  8655         MOVE AL-UANOF           TO PMTFREQA.
  8656
  8657     IF INDGRPL GREATER THAN ZERO
  8658         IF INDGRPI = 'I' OR 'G' OR SPACE
  8659             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8660             MOVE AL-UANON       TO INDGRPA
  8661          ELSE
  8662             MOVE ER-0260        TO EMI-ERROR
  8663             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8664             MOVE AL-UABON       TO INDGRPA
  8665             MOVE -1             TO INDGRPL
  8666             MOVE 'X'            TO ERROR-SWITCH
  8667     ELSE
  8668         MOVE AL-UANOF           TO INDGRPA.
  8669
  8670     IF PREMTYPL GREATER THAN ZERO
  8671         IF PREMTYPI = '1' OR '2' OR '3'
  8672            MOVE PREMTYPI        TO PI-PREM-TYPE
  8673            MOVE AL-UNNON        TO PREMTYPA
  8674            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8675          ELSE
  8676            MOVE ER-0227         TO EMI-ERROR
  8677            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8678            MOVE AL-UNBON        TO PREMTYPA
  8679            MOVE -1              TO PREMTYPL
  8680            MOVE 'X'             TO ERROR-SWITCH
  8681     ELSE
  8682         MOVE AL-UANOF           TO PREMTYPA.
  8683
  8684     IF LOANBALL GREATER THAN ZERO
  8685
  8686* EXEC CICS BIF DEEDIT
  8687*             FIELD    (LOANBALI)
  8688*             LENGTH   (9)
  8689*        END-EXEC
  8690     MOVE 9
  8691       TO DFHEIV11
  8692*    MOVE '@"L                   #   #00008270' TO DFHEIV0
  8693     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8694     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8695     MOVE X'2020233030303038323730' TO DFHEIV0(25:11)
  8696     CALL 'kxdfhei1' USING DFHEIV0,
  8697           LOANBALI,
  8698           DFHEIV11
  8699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 158
* EL131.cbl
  8700         IF LOANBALI NUMERIC
  8701             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  8702             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  8703             MOVE AL-UNNON TO LOANBALA
  8704         ELSE
  8705             MOVE ER-0639        TO EMI-ERROR
  8706             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8707             MOVE AL-UNBON       TO LOANBALA
  8708             MOVE -1             TO LOANBALL
  8709             MOVE 'X'            TO ERROR-SWITCH
  8710     ELSE
  8711         MOVE AL-UNNOF           TO LOANBALA.
  8712
  8713     IF LOANNOL GREATER THAN ZERO
  8714        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8715        MOVE AL-UANON            TO LOANNOA
  8716     ELSE
  8717        MOVE AL-UANOF            TO LOANNOA.
  8718
  8719     IF REINCDI GREATER THAN LOW-VALUES
  8720        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8721        MOVE AL-UANON            TO REINCDA
  8722     ELSE
  8723        MOVE AL-UANOF            TO REINCDA.
  8724
  8725     IF CERTI GREATER THAN LOW-VALUES
  8726         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  8727     ELSE
  8728         MOVE AL-UANOF           TO CERTA.
  8729
  8730     IF CERTEFFI GREATER THAN LOW-VALUES
  8731         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  8732     ELSE
  8733         MOVE AL-UANOF           TO CERTEFFA.
  8734
  8735     IF CERTACTI GREATER THAN LOW-VALUES
  8736         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  8737     ELSE
  8738         MOVE AL-UANOF           TO CERTACTA.
  8739
  8740     IF CERTSTI GREATER THAN LOW-VALUES
  8741         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  8742     ELSE
  8743         MOVE AL-UANOF           TO CERTSTA.
  8744
  8745     IF CERTCARI GREATER THAN LOW-VALUES
  8746         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  8747     ELSE
  8748         MOVE AL-UANOF           TO CERTCARA.
  8749
  8750     IF DLYACTV-RECORD-NEEDED
  8751         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  8752                 1150-EXIT
  8753     END-IF.
  8754
  8755     IF CERTEFFI GREATER LOW-VALUES OR
  8756        CERTACTI GREATER LOW-VALUES OR
  8757        CERTSTI  GREATER LOW-VALUES OR
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 159
* EL131.cbl
  8758        CERTCARI GREATER LOW-VALUES OR
  8759        CERTGRPI GREATER LOW-VALUES
  8760        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  8761
  8762*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  8763*      IF PI-PREM-TYPE NOT = '1'  AND
  8764*         PI-NO-PMTS = ZEROS
  8765*          IF LOANBALL GREATER +0 OR
  8766*             ACVBENEL GREATER +0
  8767*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  8768
  8769     IF CERTL = ZEROS AND
  8770        SUFXL = ZEROS
  8771          GO TO 1010-EXIT.
  8772
  8773     IF CERTL GREATER THAN ZEROS
  8774         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  8775             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  8776             MOVE 'Y'            TO SKIP-ATTRIBUTE
  8777             MOVE 'X'            TO ERROR-SWITCH
  8778             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  8779
  8780     IF SUFXL GREATER THAN ZEROS
  8781         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  8782             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  8783             MOVE 'Y'            TO SKIP-ATTRIBUTE
  8784             MOVE 'X'            TO ERROR-SWITCH
  8785             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  8786
  8787 1010-EXIT.
  8788     EXIT.
  8789
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 160
* EL131.cbl
  8791 1120-EDIT-PROC.
  8792     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  8793     MOVE '2'                    TO CNTL-REC-TYPE.
  8794     MOVE PROCI                  TO CNTL-PROC-ID.
  8795     MOVE ZERO                   TO CNTL-SEQ-NO.
  8796
  8797
  8798* EXEC CICS HANDLE CONDITION
  8799*         NOTFND    (1120-CNTL-NOTFND)
  8800*    END-EXEC.
  8801*    MOVE '"$I                   ! & #00008371' TO DFHEIV0
  8802     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8804     MOVE X'2620233030303038333731' TO DFHEIV0(25:11)
  8805     CALL 'kxdfhei1' USING DFHEIV0
  8806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8807
  8808
  8809
  8810* EXEC CICS READ
  8811*         SET      (ADDRESS OF CONTROL-FILE)
  8812*         DATASET  (CNTL-FILE-ID)
  8813*         RIDFLD   (CNTL-KEY)
  8814*    END-EXEC.
  8815*    MOVE '&"S        E          (   #00008375' TO DFHEIV0
  8816     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8817     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8818     MOVE X'2020233030303038333735' TO DFHEIV0(25:11)
  8819     CALL 'kxdfhei1' USING DFHEIV0,
  8820           CNTL-FILE-ID,
  8821           DFHEIV20,
  8822           DFHEIV99,
  8823           CNTL-KEY,
  8824           DFHEIV99,
  8825           DFHEIV99,
  8826           DFHEIV99
  8827     SET ADDRESS OF CONTROL-FILE TO
  8828         DFHEIV20
  8829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8830
  8831
  8832     MOVE AL-UANON               TO PROCA.
  8833     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  8834     GO TO 1120-EXIT.
  8835
  8836 1120-CNTL-NOTFND.
  8837     MOVE ER-0273                TO EMI-ERROR.
  8838     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8839     MOVE AL-UABON               TO PROCA.
  8840     MOVE -1                     TO PROCL.
  8841     MOVE 'X'                    TO ERROR-SWITCH.
  8842
  8843 1120-EXIT.
  8844     EXIT.
  8845
  8846*************************************************************
  8847*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  8848*************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 161
* EL131.cbl
  8849
  8850 1150-OUTPUT-ACTIVITY-RECORD.
  8851
  8852
  8853* EXEC CICS GETMAIN
  8854*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  8855*        LENGTH (25)
  8856*        INITIMG (WS-BLANK)
  8857*    END-EXEC.
  8858     MOVE 25
  8859       TO DFHEIV11
  8860*    MOVE ',"IL                  $   #00008401' TO DFHEIV0
  8861     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8862     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8863     MOVE X'2020233030303038343031' TO DFHEIV0(25:11)
  8864     CALL 'kxdfhei1' USING DFHEIV0,
  8865           DFHEIV20,
  8866           DFHEIV11,
  8867           WS-BLANK
  8868     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  8869         DFHEIV20
  8870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8871
  8872
  8873     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  8874     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  8875     MOVE PI-CARRIER             TO DA-CARRIER.
  8876     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  8877     MOVE PI-CERT-NO             TO DA-CERT-NO.
  8878     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  8879     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  8880
  8881
  8882* EXEC CICS HANDLE CONDITION
  8883*        NOTOPEN (1150-NOTOPEN-ERROR)
  8884*        DUPREC (1150-EXIT)
  8885*    END-EXEC.
  8886*    MOVE '"$J%                  ! '' #00008415' TO DFHEIV0
  8887     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  8888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8889     MOVE X'2720233030303038343135' TO DFHEIV0(25:11)
  8890     CALL 'kxdfhei1' USING DFHEIV0
  8891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8892
  8893     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  8894     MOVE 'DLYACTV'              TO JP-FILE-ID.
  8895     MOVE 'A'                    TO JP-RECORD-TYPE.
  8896     MOVE +48                    TO JOURNAL-LENGTH.
  8897
  8898
  8899* EXEC CICS WRITE
  8900*        DATASET ('DLYACTV')
  8901*        RIDFLD (DA-KEY)
  8902*        FROM (DAILY-ACTIVITY-RECORD)
  8903*        LENGTH (25)
  8904*    END-EXEC.
  8905     MOVE 'DLYACTV' TO DFHEIV1
  8906     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 162
* EL131.cbl
  8907       TO DFHEIV11
  8908*    MOVE '&$ L                  ''   #00008424' TO DFHEIV0
  8909     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8910     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8911     MOVE X'2020233030303038343234' TO DFHEIV0(25:11)
  8912     CALL 'kxdfhei1' USING DFHEIV0,
  8913           DFHEIV1,
  8914           DAILY-ACTIVITY-RECORD,
  8915           DFHEIV11,
  8916           DA-KEY,
  8917           DFHEIV99,
  8918           DFHEIV99
  8919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8920
  8921
  8922     GO TO 1150-EXIT.
  8923
  8924 1150-NOTOPEN-ERROR.
  8925
  8926     MOVE '2955'                 TO EMI-ERROR.
  8927     MOVE -1                     TO MAINTL.
  8928     MOVE AL-UANON               TO MAINTA.
  8929     MOVE 'X'                    TO ERROR-SWITCH.
  8930     PERFORM 9900-ERROR-FORMAT THRU
  8931             9900-EXIT.
  8932
  8933 1150-EXIT.
  8934     EXIT.
  8935
  8936*************************************************************
  8937*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  8938*************************************************************
  8939
  8940 1240-EDIT-LIFE-CODE.
  8941
  8942     IF INVALID-BENEFIT-CODE
  8943         GO TO 1240-SET-ERROR.
  8944
  8945     MOVE SPACES                 TO BENEFIT-KEY.
  8946     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  8947     MOVE '4'                    TO BEN-REC-TYPE.
  8948     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  8949     MOVE ZERO                   TO BEN-SEQ-NO.
  8950
  8951
  8952* EXEC CICS READ GTEQ
  8953*         DATASET  (CNTL-FILE-ID)
  8954*         RIDFLD   (BENEFIT-KEY)
  8955*         SET      (ADDRESS OF CONTROL-FILE)
  8956*    END-EXEC.
  8957*    MOVE '&"S        G          (   #00008460' TO DFHEIV0
  8958     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8959     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8960     MOVE X'2020233030303038343630' TO DFHEIV0(25:11)
  8961     CALL 'kxdfhei1' USING DFHEIV0,
  8962           CNTL-FILE-ID,
  8963           DFHEIV20,
  8964           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 163
* EL131.cbl
  8965           BENEFIT-KEY,
  8966           DFHEIV99,
  8967           DFHEIV99,
  8968           DFHEIV99
  8969     SET ADDRESS OF CONTROL-FILE TO
  8970         DFHEIV20
  8971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8972
  8973
  8974     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  8975        CF-RECORD-TYPE NOT = '4'
  8976         GO TO 1240-SET-ERROR.
  8977
  8978     MOVE ZERO                   TO COUNT-2.
  8979     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  8980
  8981     IF SCREEN-ERROR
  8982         GO TO 1240-SET-ERROR.
  8983
  8984 1240-SET-CODE-SWITCHES.
  8985     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  8986     MOVE AL-UANON               TO LCVCDA.
  8987     GO TO 1240-EXIT.
  8988
  8989 1240-SET-ERROR.
  8990     MOVE ER-0240                TO EMI-ERROR.
  8991     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8992     MOVE 'X'                    TO ERROR-SWITCH.
  8993     MOVE AL-UABON               TO LCVCDA.
  8994     MOVE -1                     TO LCVCDL.
  8995
  8996 1240-EXIT.
  8997     EXIT.
  8998
  8999 1310-EDIT-AH-CODE.
  9000     IF INVALID-BENEFIT-CODE
  9001         GO TO 1310-SET-ERROR.
  9002
  9003     MOVE SPACES                 TO BENEFIT-KEY.
  9004     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9005     MOVE '5'                    TO BEN-REC-TYPE.
  9006     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9007     MOVE ZERO                   TO BEN-SEQ-NO.
  9008
  9009
  9010* EXEC CICS READ GTEQ
  9011*         DATASET  (CNTL-FILE-ID)
  9012*         RIDFLD   (BENEFIT-KEY)
  9013*         SET      (ADDRESS OF CONTROL-FILE)
  9014*    END-EXEC.
  9015*    MOVE '&"S        G          (   #00008501' TO DFHEIV0
  9016     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9017     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9018     MOVE X'2020233030303038353031' TO DFHEIV0(25:11)
  9019     CALL 'kxdfhei1' USING DFHEIV0,
  9020           CNTL-FILE-ID,
  9021           DFHEIV20,
  9022           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 164
* EL131.cbl
  9023           BENEFIT-KEY,
  9024           DFHEIV99,
  9025           DFHEIV99,
  9026           DFHEIV99
  9027     SET ADDRESS OF CONTROL-FILE TO
  9028         DFHEIV20
  9029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9030
  9031
  9032     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9033        CF-RECORD-TYPE NOT = '5'
  9034         GO TO 1310-SET-ERROR.
  9035
  9036     MOVE ZERO                   TO COUNT-2.
  9037     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9038     IF SCREEN-ERROR
  9039         GO TO 1310-SET-ERROR.
  9040
  9041 1310-SET-CODE-SWITCHES.
  9042     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9043     MOVE AL-UANON               TO ACVCDA.
  9044     GO TO 1310-EXIT.
  9045
  9046 1310-SET-ERROR.
  9047     MOVE ER-0250                TO EMI-ERROR.
  9048     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9049     MOVE AL-UABON               TO ACVCDA.
  9050     MOVE 'X'                    TO ERROR-SWITCH.
  9051     MOVE -1                     TO ACVCDL.
  9052
  9053 1310-EXIT.
  9054     EXIT.
  9055
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 165
* EL131.cbl
  9057 1460-EDIT-CERT-NO.
  9058     MOVE CERTI                  TO WS-CERT-NO-PRIME.
  9059     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
  9060
  9061     IF WS-SAVE-CERT-NO = SPACES
  9062         MOVE ER-0203            TO EMI-ERROR
  9063         GO TO 1460-CERT-NO-ERROR.
  9064
  9065     IF WS-CERT-NO-PRIME = SPACES AND
  9066        WS-CERT-NO-SUFX GREATER THAN SPACE
  9067            MOVE ER-0210         TO EMI-ERROR
  9068            GO TO 1460-CERT-NO-ERROR.
  9069
  9070     MOVE 'X'                    TO UPDATE-SWITCH.
  9071     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9072     MOVE AL-UANON               TO CERTA.
  9073
  9074     IF SUFXL IS GREATER THAN 0
  9075         MOVE AL-UANON           TO SUFXA.
  9076
  9077     GO TO 1460-EXIT.
  9078
  9079 1460-CERT-NO-ERROR.
  9080     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9081     MOVE AL-UABON               TO SUFXA.
  9082     MOVE AL-UABON               TO CERTA.
  9083     MOVE -1                     TO CERTL.
  9084     MOVE 'X'                    TO ERROR-SWITCH.
  9085
  9086 1460-EXIT.
  9087     EXIT.
  9088
  9089 1470-EDIT-EFF.
  9090     IF CERTEFFI = SPACES
  9091         GO TO 1470-DATE-ERROR.
  9092
  9093     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
  9094     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  9095     IF DEEDIT-DATE = ZERO
  9096         GO TO 1470-DATE-ERROR.
  9097
  9098     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
  9099     MOVE '4'                    TO DC-OPTION-CODE.
  9100     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  9101     IF NOT DATE-CONVERSION-ERROR
  9102         MOVE DC-BIN-DATE-1      TO HOLD-EFF
  9103         MOVE AL-UANON           TO CERTEFFA
  9104         MOVE 'X'                TO UPDATE-SWITCH
  9105         MOVE 'Y'                TO CERT-KEY-SWITCH
  9106         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
  9107         GO TO 1470-EXIT.
  9108
  9109 1470-DATE-ERROR.
  9110     MOVE ER-0215                TO EMI-ERROR.
  9111     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9112     MOVE AL-UABON               TO CERTEFFA.
  9113     MOVE -1                     TO CERTEFFL.
  9114     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 166
* EL131.cbl
  9115
  9116 1470-EXIT.
  9117     EXIT.
  9118
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 167
* EL131.cbl
  9120 1480-EDIT-ACCT.
  9121     IF CERTACTI = SPACES
  9122         MOVE ER-0232            TO EMI-ERROR
  9123         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9124         MOVE AL-UABON           TO CERTACTA
  9125         MOVE -1                 TO CERTACTL
  9126         MOVE 'X'                TO ERROR-SWITCH
  9127     ELSE
  9128         MOVE 'X'                TO UPDATE-SWITCH
  9129         MOVE 'Y'                TO CERT-KEY-SWITCH.
  9130
  9131 1480-EXIT.
  9132     EXIT.
  9133
  9134 1490-EDIT-STATE.
  9135     IF CERTSTI = SPACES
  9136         MOVE ER-0233            TO EMI-ERROR
  9137         GO TO 1490-STATE-ERROR.
  9138
  9139     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9140     MOVE '3'                    TO CNTL-REC-TYPE.
  9141     MOVE SPACES                 TO CNTL-STATE-ACCESS.
  9142     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
  9143     MOVE ZERO                   TO CNTL-SEQ-NO.
  9144
  9145
  9146* EXEC CICS HANDLE CONDITION
  9147*         NOTFND (1490-STATE-NOTFND)
  9148*    END-EXEC.
  9149*    MOVE '"$I                   ! ( #00008620' TO DFHEIV0
  9150     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9151     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9152     MOVE X'2820233030303038363230' TO DFHEIV0(25:11)
  9153     CALL 'kxdfhei1' USING DFHEIV0
  9154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9155
  9156
  9157
  9158* EXEC CICS READ
  9159*         SET        (ADDRESS OF CONTROL-FILE)
  9160*         DATASET    ('ELCNTL')
  9161*         RIDFLD     (CNTL-KEY)
  9162*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9163*         GENERIC
  9164*    END-EXEC.
  9165     MOVE 'ELCNTL' TO DFHEIV1
  9166*    MOVE '&"S  KG    E          (   #00008624' TO DFHEIV0
  9167     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9168     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9169     MOVE X'2020233030303038363234' TO DFHEIV0(25:11)
  9170     CALL 'kxdfhei1' USING DFHEIV0,
  9171           DFHEIV1,
  9172           DFHEIV20,
  9173           DFHEIV99,
  9174           CNTL-KEY,
  9175           CNTL-GENERIC-LENGTH,
  9176           DFHEIV99,
  9177           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 168
* EL131.cbl
  9178     SET ADDRESS OF CONTROL-FILE TO
  9179         DFHEIV20
  9180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9181
  9182
  9183     MOVE AL-UANON               TO CERTSTA.
  9184     MOVE 'X'                    TO UPDATE-SWITCH.
  9185     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9186     GO TO 1490-EXIT.
  9187
  9188 1490-STATE-NOTFND.
  9189     MOVE ER-0149                TO EMI-ERROR.
  9190
  9191 1490-STATE-ERROR.
  9192     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9193     MOVE AL-UABON               TO CERTSTA.
  9194     MOVE -1                     TO CERTSTL.
  9195     MOVE 'X'                    TO ERROR-SWITCH.
  9196
  9197 1490-EXIT.
  9198     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 169
* EL131.cbl
  9200 1500-EDIT-CARR.
  9201     IF CERTCARI = SPACES
  9202         GO TO 1500-CARR-NOTFND.
  9203
  9204     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9205     MOVE '6'                    TO CNTL-REC-TYPE.
  9206     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
  9207     MOVE CERTCARI               TO CNTL-CARRIER.
  9208     MOVE ZERO                   TO CNTL-SEQ-NO.
  9209
  9210
  9211* EXEC CICS HANDLE CONDITION
  9212*         NOTFND   (1500-CARR-NOTFND)
  9213*    END-EXEC.
  9214*    MOVE '"$I                   ! ) #00008659' TO DFHEIV0
  9215     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9216     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9217     MOVE X'2920233030303038363539' TO DFHEIV0(25:11)
  9218     CALL 'kxdfhei1' USING DFHEIV0
  9219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9220
  9221
  9222
  9223* EXEC CICS READ
  9224*         SET        (ADDRESS OF CONTROL-FILE)
  9225*         DATASET    ('ELCNTL')
  9226*         RIDFLD     (CNTL-KEY)
  9227*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9228*         GENERIC
  9229*    END-EXEC.
  9230     MOVE 'ELCNTL' TO DFHEIV1
  9231*    MOVE '&"S  KG    E          (   #00008663' TO DFHEIV0
  9232     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9233     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9234     MOVE X'2020233030303038363633' TO DFHEIV0(25:11)
  9235     CALL 'kxdfhei1' USING DFHEIV0,
  9236           DFHEIV1,
  9237           DFHEIV20,
  9238           DFHEIV99,
  9239           CNTL-KEY,
  9240           CNTL-GENERIC-LENGTH,
  9241           DFHEIV99,
  9242           DFHEIV99
  9243     SET ADDRESS OF CONTROL-FILE TO
  9244         DFHEIV20
  9245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9246
  9247
  9248     MOVE AL-UANON               TO CERTCARA.
  9249     MOVE 'X'                    TO UPDATE-SWITCH.
  9250     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9251     GO TO 1500-EXIT.
  9252
  9253 1500-CARR-NOTFND.
  9254     MOVE ER-0360                TO EMI-ERROR.
  9255     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9256     MOVE AL-UABON               TO CERTCARA.
  9257     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 170
* EL131.cbl
  9258     MOVE 'X'                    TO ERROR-SWITCH.
  9259
  9260 1500-EXIT.
  9261     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 171
* EL131.cbl
  9263 1510-DEEDIT-DATE.
  9264
  9265* EXEC CICS BIF DEEDIT
  9266*         FIELD    (DEEDIT-DATE-INPUT)
  9267*         LENGTH   (DATE-LENGTH)
  9268*    END-EXEC.
  9269*    MOVE '@"L                   #   #00008687' TO DFHEIV0
  9270     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9271     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9272     MOVE X'2020233030303038363837' TO DFHEIV0(25:11)
  9273     CALL 'kxdfhei1' USING DFHEIV0,
  9274           DEEDIT-DATE-INPUT,
  9275           DATE-LENGTH
  9276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9277
  9278
  9279 1510-EXIT.
  9280     EXIT.
  9281
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 172
* EL131.cbl
  9283 1620-VERIFY-ACCT.
  9284
  9285     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
  9286     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9287     MOVE PI-GROUPING            TO ACCT-GROUP.
  9288     MOVE PI-STATE               TO ACCT-STATE.
  9289     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9290
  9291     IF CERTEFFI GREATER THAN LOW-VALUES
  9292         MOVE HOLD-EFF           TO ACCT-DATE
  9293     ELSE
  9294         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
  9295
  9296     IF CERTACTI GREATER THAN LOW-VALUES
  9297         MOVE CERTACTI           TO  ACCT-ACCOUNT.
  9298     IF CERTSTI GREATER THAN LOW-VALUES
  9299         MOVE CERTSTI            TO  ACCT-STATE.
  9300     IF CERTCARI GREATER THAN LOW-VALUES
  9301         MOVE CERTCARI           TO  ACCT-CARRIER.
  9302     IF CERTGRPI GREATER THAN LOW-VALUES
  9303         MOVE CERTGRPI           TO ACCT-GROUP.
  9304
  9305     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
  9306
  9307
  9308* EXEC CICS HANDLE CONDITION
  9309*         NOTFND  (1620-ACCT-NOTFND)
  9310*    END-EXEC.
  9311*    MOVE '"$I                   ! * #00008720' TO DFHEIV0
  9312     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9313     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9314     MOVE X'2A20233030303038373230' TO DFHEIV0(25:11)
  9315     CALL 'kxdfhei1' USING DFHEIV0
  9316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9317
  9318
  9319
  9320* EXEC CICS STARTBR
  9321*         DATASET   (ACCT-FILE-ID)
  9322*         RIDFLD    (ACCT-KEY)
  9323*    END-EXEC.
  9324     MOVE 0
  9325       TO DFHEIV11
  9326*    MOVE '&,         G          &   #00008724' TO DFHEIV0
  9327     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9328     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9329     MOVE X'2020233030303038373234' TO DFHEIV0(25:11)
  9330     CALL 'kxdfhei1' USING DFHEIV0,
  9331           ACCT-FILE-ID,
  9332           ACCT-KEY,
  9333           DFHEIV99,
  9334           DFHEIV11,
  9335           DFHEIV99
  9336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9337
  9338
  9339 1620-ACCT-LOOP.
  9340
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 173
* EL131.cbl
  9341
  9342* EXEC CICS READNEXT
  9343*         DATASET  (ACCT-FILE-ID)
  9344*         RIDFLD   (ACCT-KEY)
  9345*         SET      (ADDRESS OF ACCOUNT-MASTER)
  9346*    END-EXEC.
  9347     MOVE 0
  9348       TO DFHEIV11
  9349*    MOVE '&.S                   )   #00008731' TO DFHEIV0
  9350     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9351     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9352     MOVE X'2020233030303038373331' TO DFHEIV0(25:11)
  9353     CALL 'kxdfhei1' USING DFHEIV0,
  9354           ACCT-FILE-ID,
  9355           DFHEIV20,
  9356           DFHEIV99,
  9357           ACCT-KEY,
  9358           DFHEIV99,
  9359           DFHEIV11,
  9360           DFHEIV99,
  9361           DFHEIV99
  9362     SET ADDRESS OF ACCOUNT-MASTER TO
  9363         DFHEIV20
  9364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9365
  9366
  9367     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
  9368         GO TO 1620-ACCT-NOTFND.
  9369
  9370     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
  9371        HOLD-EFF     LESS AM-EXPIRATION-DT
  9372         NEXT SENTENCE
  9373     ELSE
  9374         GO TO 1620-ACCT-LOOP.
  9375
  9376     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
  9377         GO TO 1620-ACCT-END-BROWSE.
  9378
  9379     IF LOANBALL GREATER THAN +0
  9380         IF AM-MAX-TOT-BEN NUMERIC  AND
  9381            AM-MAX-TOT-BEN GREATER THAN ZERO
  9382             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
  9383                 MOVE AL-UNBON     TO LOANBALA
  9384                 MOVE -1           TO LOANBALL
  9385                 MOVE 'X'          TO ERROR-SWITCH
  9386                 MOVE ER-7641      TO EMI-ERROR
  9387                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9388
  9389     IF ACVBENEL GREATER THAN +0
  9390         IF AM-MAX-MON-BEN NUMERIC  AND
  9391            AM-MAX-MON-BEN GREATER THAN ZERO
  9392             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
  9393                 MOVE AL-UNBON     TO ACVBENEA
  9394                 MOVE -1           TO ACVBENEL
  9395                 MOVE 'X'          TO ERROR-SWITCH
  9396                 MOVE ER-7642      TO EMI-ERROR
  9397                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9398
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 174
* EL131.cbl
  9399 1620-ACCT-END-BROWSE.
  9400
  9401
  9402* EXEC CICS ENDBR
  9403*         DATASET (ACCT-FILE-ID)
  9404*    END-EXEC.
  9405     MOVE 0
  9406       TO DFHEIV11
  9407*    MOVE '&2                    $   #00008771' TO DFHEIV0
  9408     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9409     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9410     MOVE X'2020233030303038373731' TO DFHEIV0(25:11)
  9411     CALL 'kxdfhei1' USING DFHEIV0,
  9412           ACCT-FILE-ID,
  9413           DFHEIV11,
  9414           DFHEIV99
  9415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9416
  9417
  9418     GO TO 1620-EXIT.
  9419
  9420 1620-ACCT-NOTFND.
  9421
  9422     MOVE -1                     TO MAINTL.
  9423     MOVE 'X'                    TO ERROR-SWITCH.
  9424     MOVE ER-0426                TO EMI-ERROR.
  9425     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9426
  9427 1620-EXIT.
  9428     EXIT.
  9429
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 175
* EL131.cbl
  9431 2000-UPDATE-CLAIM.
  9432
  9433     MOVE SPACES                 TO ERROR-SWITCH.
  9434     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
  9435     MOVE PI-CARRIER             TO CARRIER-CODE.
  9436     MOVE PI-CLAIM-NO            TO CLAIM-NO.
  9437     MOVE PI-CERT-NO             TO CERT-NO.
  9438
  9439     IF DELETE-CLAIM
  9440         GO TO 3000-DELETE-CLAIM.
  9441
  9442     IF  NOT MODIFY-CAP
  9443         MOVE ER-0070            TO EMI-ERROR
  9444         MOVE 'X'                TO ERROR-SWITCH
  9445         MOVE -1                 TO MAINTL
  9446         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9447         GO TO 2000-EXIT.
  9448
  9449     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
  9450     MOVE ZERO                   TO TRLR-SEQ-NO.
  9451
  9452
  9453* EXEC CICS READ UPDATE
  9454*         SET       (ADDRESS OF CLAIM-MASTER)
  9455*         DATASET   (CLMS-FILE-ID)
  9456*         RIDFLD    (MSTR-KEY)
  9457*    END-EXEC.
  9458*    MOVE '&"S        EU         (   #00008809' TO DFHEIV0
  9459     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9460     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9461     MOVE X'2020233030303038383039' TO DFHEIV0(25:11)
  9462     CALL 'kxdfhei1' USING DFHEIV0,
  9463           CLMS-FILE-ID,
  9464           DFHEIV20,
  9465           DFHEIV99,
  9466           MSTR-KEY,
  9467           DFHEIV99,
  9468           DFHEIV99,
  9469           DFHEIV99
  9470     SET ADDRESS OF CLAIM-MASTER TO
  9471         DFHEIV20
  9472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9473
  9474
  9475     if (cl-priority-cd = '8')
  9476        and (pi-processor-id not = 'PEMA' and 'JMS '
  9477             AND 'AMWA')
  9478        MOVE ER-8003             TO EMI-ERROR
  9479        PERFORM 9900-ERROR-FORMAT
  9480                                 THRU 9900-EXIT
  9481        MOVE -1                  TO MAINTL
  9482        GO TO 8110-SEND-DATA
  9483     end-if
  9484
  9485     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
  9486         MOVE ER-0068            TO EMI-ERROR
  9487         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9488         GO TO 2000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 176
* EL131.cbl
  9489
  9490     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
  9491         MOVE ER-0068            TO EMI-ERROR
  9492         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9493         GO TO 2000-EXIT.
  9494
  9495     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  9496         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
  9497
  9498     IF CL-PURGED-DT NOT = LOW-VALUES
  9499         MOVE ER-7691            TO EMI-ERROR
  9500         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9501         GO TO 2000-EXIT.
  9502
  9503     IF CERT-KEY-CHANGED
  9504         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
  9505
  9506     IF SCREEN-ERROR
  9507         MOVE ER-0068            TO EMI-ERROR
  9508         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9509         GO TO 2000-EXIT.
  9510
  9511     IF NINETY-TRLR-UPDATED
  9512         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
  9513
  9514     IF MSTR-KEY-CHANGED
  9515         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
  9516        ELSE
  9517         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
  9518
  9519     IF TRLR-UPDATE-REQUIRED
  9520         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
  9521
  9522 2000-CHECK-CERT.
  9523     IF NOT CERT-UPDATES
  9524         GO TO 2000-EXIT.
  9525
  9526     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9527     MOVE PI-CARRIER             TO CERT-CARRIER.
  9528     MOVE PI-GROUPING            TO CERT-GROUP.
  9529     MOVE PI-STATE               TO CERT-STATE.
  9530     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9531     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9532     MOVE PI-CERT-NO             TO CERT-CERT.
  9533
  9534     IF CERT-ALT-KEY-CHANGED
  9535         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
  9536     ELSE
  9537         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
  9538
  9539 2000-EXIT.
  9540     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 177
* EL131.cbl
  9542 2010-RELEASE-REC.
  9543
  9544* EXEC CICS UNLOCK
  9545*         DATASET  (CLMS-FILE-ID)
  9546*    END-EXEC
  9547*    MOVE '&*                    #   #00008883' TO DFHEIV0
  9548     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9549     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9550     MOVE X'2020233030303038383833' TO DFHEIV0(25:11)
  9551     CALL 'kxdfhei1' USING DFHEIV0,
  9552           CLMS-FILE-ID,
  9553           DFHEIV99
  9554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9555
  9556     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9557     MOVE 'X'                    TO ERROR-SWITCH.
  9558
  9559 2010-EXIT.
  9560     EXIT.
  9561
  9562 2020-NORMAL-UPDATE.
  9563     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9564
  9565     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9566
  9567     IF WS-OPEN-CLOSE-SW = 'Y'
  9568       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9569       IF PI-REC-FOUND-SW = 'Y'
  9570         IF CL-ACTIVITY-CODE = 09
  9571           NEXT SENTENCE
  9572         ELSE
  9573           IF WS-RESET-SW = 'Y'
  9574             IF CL-CLAIM-STATUS = 'C'
  9575               MOVE 07               TO  CL-ACTIVITY-CODE
  9576               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9577               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
  9578             ELSE
  9579               MOVE 08               TO  CL-ACTIVITY-CODE
  9580               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9581               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
  9582
  9583     IF PI-COMPANY-ID = 'CID' or 'AHL'
  9584         MOVE 'Y'                TO CL-YESNOSW
  9585     END-IF.
  9586
  9587
  9588* EXEC CICS HANDLE CONDITION
  9589*         DUPKEY   (2020-EXIT)
  9590*    END-EXEC.
  9591*    MOVE '"$$                   ! + #00008918' TO DFHEIV0
  9592     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9593     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9594     MOVE X'2B20233030303038393138' TO DFHEIV0(25:11)
  9595     CALL 'kxdfhei1' USING DFHEIV0
  9596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9597
  9598
  9599
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 178
* EL131.cbl
  9600* EXEC CICS REWRITE
  9601*         DATASET   (CLMS-FILE-ID)
  9602*         FROM      (CLAIM-MASTER)
  9603*    END-EXEC.
  9604     MOVE LENGTH OF
  9605      CLAIM-MASTER
  9606       TO DFHEIV11
  9607*    MOVE '&& L                  %   #00008922' TO DFHEIV0
  9608     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9609     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9610     MOVE X'2020233030303038393232' TO DFHEIV0(25:11)
  9611     CALL 'kxdfhei1' USING DFHEIV0,
  9612           CLMS-FILE-ID,
  9613           CLAIM-MASTER,
  9614           DFHEIV11,
  9615           DFHEIV99
  9616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9617
  9618
  9619 2020-EXIT.
  9620     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 179
* EL131.cbl
  9622 2030-KEY-UPDATE.
  9623     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
  9624
  9625
  9626* EXEC CICS DELETE
  9627*        DATASET  (CLMS-FILE-ID)
  9628*    END-EXEC.
  9629*    MOVE '&(                    &   #00008933' TO DFHEIV0
  9630     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9631     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9632     MOVE X'2020233030303038393333' TO DFHEIV0(25:11)
  9633     CALL 'kxdfhei1' USING DFHEIV0,
  9634           CLMS-FILE-ID,
  9635           DFHEIV99,
  9636           DFHEIV99,
  9637           DFHEIV99,
  9638           DFHEIV99
  9639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9640
  9641
  9642
  9643* EXEC CICS GETMAIN
  9644*         SET      (ADDRESS OF CLAIM-MASTER)
  9645*         LENGTH   (MSTR-LENGTH)
  9646*         INITIMG  (GETMAIN-SPACE)
  9647*    END-EXEC.
  9648*    MOVE ',"IL                  $   #00008937' TO DFHEIV0
  9649     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9650     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9651     MOVE X'2020233030303038393337' TO DFHEIV0(25:11)
  9652     CALL 'kxdfhei1' USING DFHEIV0,
  9653           DFHEIV20,
  9654           MSTR-LENGTH,
  9655           GETMAIN-SPACE
  9656     SET ADDRESS OF CLAIM-MASTER TO
  9657         DFHEIV20
  9658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9659
  9660
  9661     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
  9662
  9663     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9664
  9665     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9666
  9667     IF WS-OPEN-CLOSE-SW = 'Y'
  9668       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9669         IF PI-REC-FOUND-SW = 'Y'
  9670           IF CL-ACTIVITY-CODE = 09
  9671             NEXT SENTENCE
  9672           ELSE
  9673             IF WS-RESET-SW = 'Y'
  9674               IF CL-CLAIM-STATUS = 'C'
  9675                 MOVE 07             TO  CL-ACTIVITY-CODE
  9676                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
  9677                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
  9678               ELSE
  9679                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 180
* EL131.cbl
  9680                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
  9681                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
  9682
  9683
  9684* EXEC CICS HANDLE CONDITION
  9685*         DUPKEY    (2030-EXIT)
  9686*    END-EXEC.
  9687*    MOVE '"$$                   ! , #00008965' TO DFHEIV0
  9688     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9689     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9690     MOVE X'2C20233030303038393635' TO DFHEIV0(25:11)
  9691     CALL 'kxdfhei1' USING DFHEIV0
  9692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9693
  9694
  9695** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
  9696*    MOVE CL-CERT-NO             TO CL-CCN-A5.
  9697
  9698     IF PI-COMPANY-ID = 'CID' OR 'AHL'
  9699         MOVE 'Y'                TO CL-YESNOSW
  9700     END-IF.
  9701
  9702
  9703* EXEC CICS WRITE
  9704*         DATASET   (CLMS-FILE-ID)
  9705*         RIDFLD    (MSTR-KEY)
  9706*         FROM      (CLAIM-MASTER)
  9707*    END-EXEC.
  9708     MOVE LENGTH OF
  9709      CLAIM-MASTER
  9710       TO DFHEIV11
  9711*    MOVE '&$ L                  ''   #00008976' TO DFHEIV0
  9712     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9713     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9714     MOVE X'2020233030303038393736' TO DFHEIV0(25:11)
  9715     CALL 'kxdfhei1' USING DFHEIV0,
  9716           CLMS-FILE-ID,
  9717           CLAIM-MASTER,
  9718           DFHEIV11,
  9719           MSTR-KEY,
  9720           DFHEIV99,
  9721           DFHEIV99
  9722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9723
  9724
  9725 2030-EXIT.
  9726     EXIT.
  9727
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 181
* EL131.cbl
  9729 2040-NORMAL-UPDATE.
  9730
  9731* EXEC CICS READ UPDATE
  9732*         DATASET  (CERT-FILE-ID)
  9733*         RIDFLD   (CERT-KEY)
  9734*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9735*    END-EXEC.
  9736*    MOVE '&"S        EU         (   #00008987' TO DFHEIV0
  9737     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9738     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9739     MOVE X'2020233030303038393837' TO DFHEIV0(25:11)
  9740     CALL 'kxdfhei1' USING DFHEIV0,
  9741           CERT-FILE-ID,
  9742           DFHEIV20,
  9743           DFHEIV99,
  9744           CERT-KEY,
  9745           DFHEIV99,
  9746           DFHEIV99,
  9747           DFHEIV99
  9748     SET ADDRESS OF CERTIFICATE-MASTER TO
  9749         DFHEIV20
  9750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9751
  9752
  9753     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
  9754
  9755
  9756* EXEC CICS HANDLE CONDITION
  9757*         DUPKEY   (2040-EXIT)
  9758*    END-EXEC.
  9759*    MOVE '"$$                   ! - #00008995' TO DFHEIV0
  9760     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9761     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9762     MOVE X'2D20233030303038393935' TO DFHEIV0(25:11)
  9763     CALL 'kxdfhei1' USING DFHEIV0
  9764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9765
  9766
  9767
  9768* EXEC CICS REWRITE
  9769*         DATASET  (CERT-FILE-ID)
  9770*         FROM     (CERTIFICATE-MASTER)
  9771*    END-EXEC.
  9772     MOVE LENGTH OF
  9773      CERTIFICATE-MASTER
  9774       TO DFHEIV11
  9775*    MOVE '&& L                  %   #00008999' TO DFHEIV0
  9776     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9777     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9778     MOVE X'2020233030303038393939' TO DFHEIV0(25:11)
  9779     CALL 'kxdfhei1' USING DFHEIV0,
  9780           CERT-FILE-ID,
  9781           CERTIFICATE-MASTER,
  9782           DFHEIV11,
  9783           DFHEIV99
  9784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9785
  9786
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 182
* EL131.cbl
  9787 2040-EXIT.
  9788     EXIT.
  9789
  9790 2050-KEY-UPDATE.
  9791
  9792* EXEC CICS READ UPDATE
  9793*         DATASET  (CERT-FILE-ID)
  9794*         RIDFLD   (CERT-KEY)
  9795*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9796*    END-EXEC.
  9797*    MOVE '&"S        EU         (   #00009008' TO DFHEIV0
  9798     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9799     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9800     MOVE X'2020233030303039303038' TO DFHEIV0(25:11)
  9801     CALL 'kxdfhei1' USING DFHEIV0,
  9802           CERT-FILE-ID,
  9803           DFHEIV20,
  9804           DFHEIV99,
  9805           CERT-KEY,
  9806           DFHEIV99,
  9807           DFHEIV99,
  9808           DFHEIV99
  9809     SET ADDRESS OF CERTIFICATE-MASTER TO
  9810         DFHEIV20
  9811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9812
  9813
  9814     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
  9815
  9816
  9817* EXEC CICS DELETE
  9818*         DATASET   (CERT-FILE-ID)
  9819*    END-EXEC.
  9820*    MOVE '&(                    &   #00009016' TO DFHEIV0
  9821     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9822     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9823     MOVE X'2020233030303039303136' TO DFHEIV0(25:11)
  9824     CALL 'kxdfhei1' USING DFHEIV0,
  9825           CERT-FILE-ID,
  9826           DFHEIV99,
  9827           DFHEIV99,
  9828           DFHEIV99,
  9829           DFHEIV99
  9830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9831
  9832
  9833
  9834* EXEC CICS GETMAIN
  9835*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9836*         LENGTH    (CERT-LENGTH)
  9837*         INITIMG   (GETMAIN-SPACE)
  9838*    END-EXEC.
  9839*    MOVE ',"IL                  $   #00009020' TO DFHEIV0
  9840     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9841     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9842     MOVE X'2020233030303039303230' TO DFHEIV0(25:11)
  9843     CALL 'kxdfhei1' USING DFHEIV0,
  9844           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 183
* EL131.cbl
  9845           CERT-LENGTH,
  9846           GETMAIN-SPACE
  9847     SET ADDRESS OF CERTIFICATE-MASTER TO
  9848         DFHEIV20
  9849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9850
  9851
  9852     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
  9853
  9854     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
  9855
  9856
  9857* EXEC CICS HANDLE CONDITION
  9858*         DUPKEY (2050-EXIT)
  9859*    END-EXEC.
  9860*    MOVE '"$$                   ! . #00009030' TO DFHEIV0
  9861     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9862     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9863     MOVE X'2E20233030303039303330' TO DFHEIV0(25:11)
  9864     CALL 'kxdfhei1' USING DFHEIV0
  9865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9866
  9867
  9868
  9869* EXEC CICS WRITE
  9870*         DATASET  (CERT-FILE-ID)
  9871*         RIDFLD   (CERT-KEY)
  9872*         FROM     (CERTIFICATE-MASTER)
  9873*    END-EXEC.
  9874     MOVE LENGTH OF
  9875      CERTIFICATE-MASTER
  9876       TO DFHEIV11
  9877*    MOVE '&$ L                  ''   #00009034' TO DFHEIV0
  9878     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9879     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9880     MOVE X'2020233030303039303334' TO DFHEIV0(25:11)
  9881     CALL 'kxdfhei1' USING DFHEIV0,
  9882           CERT-FILE-ID,
  9883           CERTIFICATE-MASTER,
  9884           DFHEIV11,
  9885           CERT-KEY,
  9886           DFHEIV99,
  9887           DFHEIV99
  9888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9889
  9890
  9891 2050-EXIT.
  9892     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 184
* EL131.cbl
  9894 2060-CHANGE-CERT.
  9895     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9896     MOVE PI-CARRIER             TO CERT-CARRIER.
  9897     MOVE PI-GROUPING            TO CERT-GROUP.
  9898     MOVE PI-STATE               TO CERT-STATE.
  9899     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9900     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9901     MOVE PI-CERT-NO             TO CERT-CERT.
  9902     IF CERTEFFI GREATER THAN LOW-VALUES
  9903         MOVE HOLD-EFF           TO CERT-DATE.
  9904     IF CERTACTI GREATER THAN LOW-VALUES
  9905         MOVE CERTACTI           TO CERT-ACCOUNT.
  9906     IF CERTSTI GREATER THAN LOW-VALUES
  9907         MOVE CERTSTI            TO CERT-STATE.
  9908     IF CERTCARI GREATER THAN LOW-VALUES
  9909         MOVE CERTCARI           TO CERT-CARRIER.
  9910     IF CERTGRPI GREATER THAN LOW-VALUES
  9911         MOVE CERTGRPI           TO CERT-GROUP.
  9912     IF CERTI GREATER THAN LOW-VALUES
  9913         MOVE CERTI              TO CERT-CERT-PRIME.
  9914     IF SUFXI GREATER THAN LOW-VALUES
  9915         MOVE SUFXI              TO CERT-CERT-SUFX.
  9916
  9917
  9918* EXEC CICS HANDLE CONDITION
  9919*         NOTFND   (2060-CERT-NOTFND)
  9920*    END-EXEC.
  9921*    MOVE '"$I                   ! / #00009066' TO DFHEIV0
  9922     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9923     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9924     MOVE X'2F20233030303039303636' TO DFHEIV0(25:11)
  9925     CALL 'kxdfhei1' USING DFHEIV0
  9926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9927
  9928
  9929
  9930* EXEC CICS READ UPDATE
  9931*         DATASET  (CERT-FILE-ID)
  9932*         RIDFLD   (CERT-KEY)
  9933*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9934*    END-EXEC.
  9935*    MOVE '&"S        EU         (   #00009070' TO DFHEIV0
  9936     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9937     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9938     MOVE X'2020233030303039303730' TO DFHEIV0(25:11)
  9939     CALL 'kxdfhei1' USING DFHEIV0,
  9940           CERT-FILE-ID,
  9941           DFHEIV20,
  9942           DFHEIV99,
  9943           CERT-KEY,
  9944           DFHEIV99,
  9945           DFHEIV99,
  9946           DFHEIV99
  9947     SET ADDRESS OF CERTIFICATE-MASTER TO
  9948         DFHEIV20
  9949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9950
  9951
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 185
* EL131.cbl
  9952     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
  9953
  9954     IF CM-CLAIM-INTERFACE-SW = SPACES
  9955        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
  9956
  9957
  9958* EXEC CICS HANDLE CONDITION
  9959*         DUPKEY   (2060-DUPKEY)
  9960*    END-EXEC.
  9961*    MOVE '"$$                   ! 0 #00009081' TO DFHEIV0
  9962     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9963     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9964     MOVE X'3020233030303039303831' TO DFHEIV0(25:11)
  9965     CALL 'kxdfhei1' USING DFHEIV0
  9966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9967
  9968
  9969
  9970* EXEC CICS REWRITE
  9971*         DATASET  (CERT-FILE-ID)
  9972*         FROM     (CERTIFICATE-MASTER)
  9973*    END-EXEC.
  9974     MOVE LENGTH OF
  9975      CERTIFICATE-MASTER
  9976       TO DFHEIV11
  9977*    MOVE '&& L                  %   #00009085' TO DFHEIV0
  9978     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9979     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9980     MOVE X'2020233030303039303835' TO DFHEIV0(25:11)
  9981     CALL 'kxdfhei1' USING DFHEIV0,
  9982           CERT-FILE-ID,
  9983           CERTIFICATE-MASTER,
  9984           DFHEIV11,
  9985           DFHEIV99
  9986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9987
  9988
  9989 2060-DUPKEY.
  9990
  9991     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
  9992
  9993 2060-CHANGE-TRLR-ACTQ.
  9994     IF SCREEN-ERROR
  9995         GO TO 2060-EXIT.
  9996
  9997     IF CERTI    GREATER LOW-VALUES OR
  9998        SUFXI    GREATER LOW-VALUES OR
  9999        CERTCARI GREATER LOW-VALUES
 10000         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 10001         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 10002
 10003     MOVE SPACES                 TO CERT-KEY-SWITCH
 10004                                    CERT-SWITCH
 10005                                    TRLR-SWITCH
 10006                                    NINETY-TRLR-SWITCH.
 10007     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 10008     GO TO 2060-EXIT.
 10009
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 186
* EL131.cbl
 10010 2060-CERT-NOTFND.
 10011     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10012
 10013     IF WS-REC-FOUND-SW = 'N'
 10014         MOVE ER-0206            TO  EMI-ERROR
 10015         MOVE -1                 TO  MAINTL
 10016         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10017
 10018* EXEC CICS UNLOCK
 10019*            DATASET   (CLMS-FILE-ID)
 10020*        END-EXEC
 10021*    MOVE '&*                    #   #00009118' TO DFHEIV0
 10022     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10023     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10024     MOVE X'2020233030303039313138' TO DFHEIV0(25:11)
 10025     CALL 'kxdfhei1' USING DFHEIV0,
 10026           CLMS-FILE-ID,
 10027           DFHEIV99
 10028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10029         GO TO 8110-SEND-DATA.
 10030
 10031     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 10032
 10033     GO TO 2060-CHANGE-TRLR-ACTQ.
 10034
 10035 2060-EXIT.
 10036     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 187
* EL131.cbl
 10038 2070-CHECK-OLD.
 10039
 10040
 10041* EXEC CICS HANDLE CONDITION
 10042*        NOTFND   (2070-NOT-FOUND)
 10043*    END-EXEC.
 10044*    MOVE '"$I                   ! 1 #00009132' TO DFHEIV0
 10045     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10046     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10047     MOVE X'3120233030303039313332' TO DFHEIV0(25:11)
 10048     CALL 'kxdfhei1' USING DFHEIV0
 10049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10050
 10051
 10052     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10053     MOVE PI-CARRIER             TO CERT-CARRIER.
 10054     MOVE PI-GROUPING            TO CERT-GROUP.
 10055     MOVE PI-STATE               TO CERT-STATE.
 10056     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10057     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10058     MOVE PI-CERT-NO             TO CERT-CERT.
 10059
 10060
 10061* EXEC CICS READ UPDATE
 10062*         DATASET  (CERT-FILE-ID)
 10063*         RIDFLD   (CERT-KEY)
 10064*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10065*    END-EXEC.
 10066*    MOVE '&"S        EU         (   #00009144' TO DFHEIV0
 10067     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10068     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10069     MOVE X'2020233030303039313434' TO DFHEIV0(25:11)
 10070     CALL 'kxdfhei1' USING DFHEIV0,
 10071           CERT-FILE-ID,
 10072           DFHEIV20,
 10073           DFHEIV99,
 10074           CERT-KEY,
 10075           DFHEIV99,
 10076           DFHEIV99,
 10077           DFHEIV99
 10078     SET ADDRESS OF CERTIFICATE-MASTER TO
 10079         DFHEIV20
 10080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10081
 10082
 10083     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 10084     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 10085     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 10086
 10087     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 10088         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 10089
 10090     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10091       AND
 10092        CERT-WAS-CREATED-FOR-CLAIM
 10093         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 10094
 10095* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 188
* EL131.cbl
 10096*             DATASET   (CERT-FILE-ID)
 10097*        END-EXEC
 10098*    MOVE '&(                    &   #00009161' TO DFHEIV0
 10099     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10100     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10101     MOVE X'2020233030303039313631' TO DFHEIV0(25:11)
 10102     CALL 'kxdfhei1' USING DFHEIV0,
 10103           CERT-FILE-ID,
 10104           DFHEIV99,
 10105           DFHEIV99,
 10106           DFHEIV99,
 10107           DFHEIV99
 10108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10109         GO TO 2070-EXIT.
 10110
 10111     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10112         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10113
 10114
 10115* EXEC CICS HANDLE CONDITION
 10116*         DUPKEY   (2070-EXIT)
 10117*    END-EXEC.
 10118*    MOVE '"$$                   ! 2 #00009169' TO DFHEIV0
 10119     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10120     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10121     MOVE X'3220233030303039313639' TO DFHEIV0(25:11)
 10122     CALL 'kxdfhei1' USING DFHEIV0
 10123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10124
 10125
 10126
 10127* EXEC CICS REWRITE
 10128*         DATASET  (CERT-FILE-ID)
 10129*         FROM     (CERTIFICATE-MASTER)
 10130*    END-EXEC.
 10131     MOVE LENGTH OF
 10132      CERTIFICATE-MASTER
 10133       TO DFHEIV11
 10134*    MOVE '&& L                  %   #00009173' TO DFHEIV0
 10135     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10136     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10137     MOVE X'2020233030303039313733' TO DFHEIV0(25:11)
 10138     CALL 'kxdfhei1' USING DFHEIV0,
 10139           CERT-FILE-ID,
 10140           CERTIFICATE-MASTER,
 10141           DFHEIV11,
 10142           DFHEIV99
 10143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10144
 10145
 10146     GO TO 2070-EXIT.
 10147
 10148 2070-NOT-FOUND.
 10149     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 10150
 10151 2070-EXIT.
 10152     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 189
* EL131.cbl
 10154 2080-CREATE-CERT.
 10155
 10156* EXEC CICS GETMAIN
 10157*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10158*         LENGTH    (CERT-LENGTH)
 10159*         INITIMG   (GETMAIN-SPACE)
 10160*    END-EXEC.
 10161*    MOVE ',"IL                  $   #00009187' TO DFHEIV0
 10162     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10163     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10164     MOVE X'2020233030303039313837' TO DFHEIV0(25:11)
 10165     CALL 'kxdfhei1' USING DFHEIV0,
 10166           DFHEIV20,
 10167           CERT-LENGTH,
 10168           GETMAIN-SPACE
 10169     SET ADDRESS OF CERTIFICATE-MASTER TO
 10170         DFHEIV20
 10171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10172
 10173
 10174     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 10175
 10176     IF CERTEFFI GREATER THAN LOW-VALUES
 10177         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 10178                                    DC-BIN-DATE-1
 10179         MOVE '6'                TO DC-OPTION-CODE
 10180         MOVE +1                 TO DC-ELAPSED-MONTHS
 10181         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10182         IF NO-CONVERSION-ERROR
 10183             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 10184
 10185     IF CERTACTI GREATER THAN LOW-VALUES
 10186         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 10187     IF CERTSTI GREATER THAN LOW-VALUES
 10188         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 10189     IF CERTCARI GREATER THAN LOW-VALUES
 10190         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 10191     IF CERTGRPI GREATER THAN LOW-VALUES
 10192         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 10193     IF CERTI GREATER THAN LOW-VALUES
 10194         MOVE CERTI              TO CERT-CERT-PRIME
 10195                                    CM-CERT-PRIME
 10196         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10197
 10198     IF SUFXI GREATER THAN LOW-VALUES
 10199         MOVE SUFXI              TO CERT-CERT-SUFX
 10200                                    CM-CERT-SFX
 10201         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10202
 10203     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10204
 10205     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10206
 10207     MOVE SPACES                 TO CM-ENTRY-BATCH
 10208                                    CM-LF-EXIT-BATCH
 10209                                    CM-AH-EXIT-BATCH
 10210                                    CM-CREDIT-INTERFACE-SW-1
 10211                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 190
* EL131.cbl
 10212
 10213     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10214                               '9' OR 'D' OR 'V'
 10215         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10216
 10217     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10218                               '9' OR 'D' OR 'V'
 10219         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10220
 10221     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 10222                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 10223     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 10224
 10225
 10226* EXEC CICS HANDLE CONDITION
 10227*         DUPKEY (2080-EXIT)
 10228*    END-EXEC.
 10229*    MOVE '"$$                   ! 3 #00009244' TO DFHEIV0
 10230     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10231     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10232     MOVE X'3320233030303039323434' TO DFHEIV0(25:11)
 10233     CALL 'kxdfhei1' USING DFHEIV0
 10234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10235
 10236
 10237
 10238* EXEC CICS WRITE
 10239*         DATASET  (CERT-FILE-ID)
 10240*         RIDFLD   (CERT-KEY)
 10241*         FROM     (CERTIFICATE-MASTER)
 10242*    END-EXEC.
 10243     MOVE LENGTH OF
 10244      CERTIFICATE-MASTER
 10245       TO DFHEIV11
 10246*    MOVE '&$ L                  ''   #00009248' TO DFHEIV0
 10247     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10248     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10249     MOVE X'2020233030303039323438' TO DFHEIV0(25:11)
 10250     CALL 'kxdfhei1' USING DFHEIV0,
 10251           CERT-FILE-ID,
 10252           CERTIFICATE-MASTER,
 10253           DFHEIV11,
 10254           CERT-KEY,
 10255           DFHEIV99,
 10256           DFHEIV99
 10257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10258
 10259
 10260 2080-EXIT.
 10261     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 191
* EL131.cbl
 10263 2100-MOVE-MSTR.
 10264     IF TYPEI GREATER THAN LOW-VALUES
 10265         MOVE TYPEI              TO CL-CLAIM-TYPE.
 10266
 10267     IF STATUSI = LOW-VALUES
 10268         GO TO 2100-NO-STATUS-CHANGE.
 10269
 10270     IF STATUSI = 'OPEN' OR 'O'
 10271         IF CL-CLAIM-STATUS = 'O'
 10272             MOVE SPACES         TO TRLR-SWITCH
 10273                 GO TO 2100-NO-STATUS-CHANGE.
 10274
 10275     IF STATUSI = 'CLOSED' OR 'C'
 10276         IF CL-CLAIM-STATUS = 'C'
 10277             MOVE SPACES         TO TRLR-SWITCH
 10278                 GO TO 2100-NO-STATUS-CHANGE.
 10279
 10280     IF PI-COMPANY-ID = 'DMD'
 10281        IF STATUSI = 'OPEN' OR 'O'
 10282           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 10283              MOVE ZERO       TO STATUSL
 10284              MOVE LOW-VALUES TO STATUSI
 10285              GO TO 2100-NO-STATUS-CHANGE.
 10286
 10287     IF PI-COMPANY-ID = 'DMD'
 10288         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 10289
 10290     MOVE STATUSI                TO CL-CLAIM-STATUS.
 10291
 10292 2100-NO-STATUS-CHANGE.
 10293
 10294     IF CCNOI GREATER THAN LOW-VALUES
 10295         MOVE CCNOI              TO CL-CCN.
 10296
 10297     IF PROCI GREATER THAN LOW-VALUES
 10298         MOVE PROCI              TO CL-PROCESSOR-ID.
 10299
 10300     IF SEXI GREATER THAN LOW-VALUES
 10301         MOVE SEXI               TO CL-INSURED-SEX-CD.
 10302
 10303     IF BIRTHI GREATER THAN LOW-VALUES
 10304         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 10305
 10306     IF SOCIALI GREATER THAN LOW-VALUES
 10307       AND
 10308        SOCIALI = SPACES
 10309         MOVE CL-CERT-STATE      TO CL-SSN-STATE
 10310         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 10311         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 10312     ELSE
 10313         IF SOCIALI GREATER THAN LOW-VALUES
 10314             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 10315
 10316     IF OCCI GREATER THAN LOW-VALUES
 10317         MOVE OCCI               TO CL-INSURED-OCC-CD.
 10318
 10319     IF BENEL GREATER THAN ZERO
 10320         MOVE BENEI              TO CL-BENEFICIARY.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 192
* EL131.cbl
 10321
 10322     IF DIAGI GREATER THAN LOW-VALUES
 10323         MOVE DIAGI              TO WS-DIAGNOSIS.
 10324
 10325     IF PREMTYPI GREATER THAN LOW-VALUES
 10326         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 10327
 10328     IF CAUSEI GREATER THAN LOW-VALUES
 10329         MOVE CAUSEI             TO CL-CAUSE-CD.
 10330
 10331     IF ENDI GREATER THAN LOW-VALUES
 10332         MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 10333
 10334     IF PDTHRUI GREATER THAN LOW-VALUES
 10335        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 10336
 10337     IF PDAMTL GREATER THAN +0
 10338        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 10339
 10340     IF NODAYSI GREATER THAN LOW-VALUES
 10341        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 10342
 10343     IF NOPMTSI GREATER THAN LOW-VALUES
 10344        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 10345
 10346     IF FORMTYPI GREATER THAN LOW-VALUES
 10347        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 10348
 10349     IF INCI GREATER THAN LOW-VALUES
 10350        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 10351
 10352     IF REPI GREATER THAN LOW-VALUES
 10353        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 10354
 10355     IF ADDONDTI GREATER THAN LOW-VALUES
 10356        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 10357
 10358     IF PRICDI GREATER THAN LOW-VALUES
 10359         MOVE PRICDI             TO CL-PRIORITY-CD.
 10360
 10361     IF FILETOI GREATER THAN LOW-VALUES
 10362         MOVE FILETOI            TO CL-FILE-LOCATION.
 10363
 10364     IF SUPVI GREATER THAN LOW-VALUES
 10365         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 10366
 10367     IF MLNAMEI GREATER THAN LOW-VALUES
 10368         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 10369
 10370     IF MFNAMEI GREATER THAN LOW-VALUES
 10371         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 10372
 10373     IF MMINITI GREATER THAN LOW-VALUES
 10374         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 10375
 10376     IF CERTEFFI GREATER THAN LOW-VALUES
 10377         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 10378
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 193
* EL131.cbl
 10379     IF CERTACTI GREATER THAN LOW-VALUES
 10380         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 10381
 10382     IF CERTSTI GREATER THAN LOW-VALUES
 10383         MOVE CERTSTI            TO CL-CERT-STATE.
 10384
 10385     IF CERTCARI GREATER THAN LOW-VALUES
 10386         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 10387                                    CL-CARRIER.
 10388
 10389     IF CERTGRPI GREATER THAN LOW-VALUES
 10390         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 10391
 10392     IF CERTI GREATER THAN LOW-VALUES
 10393         MOVE CERTI              TO CERT-NO-PRIME.
 10394
 10395     IF SUFXI GREATER THAN LOW-VALUES
 10396         MOVE SUFXI              TO CERT-NO-SUFX.
 10397
 10398     MOVE CERT-NO                TO CL-CERT-NO
 10399                                    CL-CERT-NO-A4.
 10400
 10401     IF PI-COMPANY-ID = 'FLA'
 10402          NEXT SENTENCE
 10403     ELSE
 10404         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 10405         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 10406         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 10407         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 10408
 10409     IF TRLR-UPDATE-REQUIRED
 10410        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 10411        MOVE ZEROS              TO TRLR-SEQ-NO
 10412
 10413* EXEC CICS READ
 10414*            DATASET   (TRLR-FILE-ID)
 10415*            RIDFLD    (TRLR-KEY)
 10416*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10417*       END-EXEC
 10418*    MOVE '&"S        E          (   #00009406' TO DFHEIV0
 10419     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10421     MOVE X'2020233030303039343036' TO DFHEIV0(25:11)
 10422     CALL 'kxdfhei1' USING DFHEIV0,
 10423           TRLR-FILE-ID,
 10424           DFHEIV20,
 10425           DFHEIV99,
 10426           TRLR-KEY,
 10427           DFHEIV99,
 10428           DFHEIV99,
 10429           DFHEIV99
 10430     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10431         DFHEIV20
 10432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10433        IF AT-TRAILER-TYPE = '1'
 10434           MOVE +1 TO MISC-SUB
 10435           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 10436           MISC-SUB GREATER THAN +6 OR
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 194
* EL131.cbl
 10437           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 10438           IF MISC-SUB GREATER THAN +1
 10439              SUBTRACT +1 FROM MISC-SUB
 10440              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10441                 GO TO 2100-BYPASS-LAST-UPDATE.
 10442
 10443     IF TRLR-UPDATE-REQUIRED AND
 10444        CLAIM-IS-OPEN
 10445         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 10446     ELSE
 10447         IF TRLR-UPDATE-REQUIRED AND
 10448            CLAIM-IS-CLOSED
 10449             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 10450             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 10451
 10452 2100-BYPASS-LAST-UPDATE.
 10453     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10454     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 10455
 10456     GO TO 2100-EXIT.
 10457
 10458 2100-BUMP-OPEN-CLOSE-HIST.
 10459     ADD +1                      TO MISC-SUB.
 10460
 10461 2100-EXIT.
 10462     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 195
* EL131.cbl
 10464 2200-MOVE-CERT.
 10465     IF CRTLNMEI GREATER THAN LOW-VALUES
 10466         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 10467
 10468     IF CRTFNMEI GREATER THAN LOW-VALUES
 10469         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 10470         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 10471
 10472     IF CRTINITI GREATER THAN LOW-VALUES
 10473         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 10474
 10475     IF CM-INSURED-INITIALS = SPACES
 10476         MOVE '**'               TO CM-INSURED-INITIALS.
 10477
 10478     IF ISSAGEI GREATER THAN LOW-VALUES
 10479         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 10480
 10481     IF JNTFNMEI GREATER THAN LOW-VALUES
 10482         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 10483
 10484     IF JNTLNMEI GREATER THAN LOW-VALUES
 10485         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 10486
 10487     IF JNTINITI GREATER THAN LOW-VALUES
 10488         MOVE JNTINITI           TO CM-JT-INITIAL.
 10489
 10490     IF JNTAGEI GREATER THAN LOW-VALUES
 10491         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 10492
 10493     IF ADDONDTI GREATER THAN LOW-VALUES
 10494        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 10495
 10496     IF LCVCDI GREATER THAN LOW-VALUES
 10497        IF LCVCDI = SPACES OR ZEROS
 10498           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 10499        ELSE
 10500           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 10501
 10502     IF LCVOTRMI GREATER THAN LOW-VALUES
 10503         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 10504
 10505     IF LCVRATEL GREATER THAN +0
 10506         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 10507
 10508     IF LCVBENEL GREATER THAN +0
 10509         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 10510
 10511     IF LCVFORMI GREATER THAN LOW-VALUES
 10512         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 10513
 10514     IF LCVCNDTI = LOW-VALUES
 10515        GO TO 2210-SET-STATUS.
 10516
 10517     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 10518        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10519        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 10520        GO TO 2210-SET-STATUS.
 10521
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 196
* EL131.cbl
 10522     IF CM-LF-CURRENT-STATUS = '7'
 10523        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 10524        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10525        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10526                                    CM-LF-DEATH-DT
 10527        GO TO 2210-SET-STATUS.
 10528
 10529     IF CM-LF-CURRENT-STATUS = '8'
 10530        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10531        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10532                                    CM-LF-CANCEL-DT.
 10533
 10534 2210-SET-STATUS.
 10535
 10536     IF CM-LF-CURRENT-STATUS = SPACES
 10537         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10538
 10539     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 10540         MOVE '6'                TO DC-OPTION-CODE
 10541         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 10542         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 10543         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10544         IF NO-CONVERSION-ERROR
 10545             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 10546         ELSE
 10547             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 10548     ELSE
 10549         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 10550
 10551 2215-PROCESS-AH-SIDE.
 10552
 10553     IF ACVCDI GREATER THAN LOW-VALUES
 10554        IF ACVCDI = SPACES OR ZEROS
 10555           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 10556        ELSE
 10557           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 10558
 10559     IF ACVOTRMI GREATER THAN LOW-VALUES
 10560         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 10561
 10562     IF ACVRATEL GREATER THAN +0
 10563         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 10564
 10565     IF ACVBENEL GREATER THAN +0
 10566         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
 10567                                    PI-PAYMENT-AMT.
 10568
 10569     IF ACVFORMI GREATER THAN LOW-VALUES
 10570         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 10571
 10572     IF ACVCNDTI = LOW-VALUES
 10573        GO TO 2220-SET-STATUS.
 10574
 10575     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 10576        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10577        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 10578        GO TO 2220-SET-STATUS.
 10579
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 197
* EL131.cbl
 10580     IF CM-AH-CURRENT-STATUS = '6'
 10581        MOVE CM-AH-STATUS-AT-SETTLEMENT
 10582                                 TO CM-AH-CURRENT-STATUS
 10583        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10584        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10585                                    CM-AH-SETTLEMENT-DT
 10586        GO TO 2220-SET-STATUS.
 10587
 10588     IF CM-AH-CURRENT-STATUS = '8'
 10589        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10590        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10591                                    CM-AH-CANCEL-DT.
 10592
 10593 2220-SET-STATUS.
 10594     IF CM-AH-CURRENT-STATUS = SPACES
 10595         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10596
 10597     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 10598         MOVE '6'                TO DC-OPTION-CODE
 10599         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 10600         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 10601         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10602         IF NO-CONVERSION-ERROR
 10603             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 10604         ELSE
 10605             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 10606     ELSE
 10607         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 10608
 10609 2225-FINISH-CERT.
 10610     IF APRL GREATER THAN +0
 10611         MOVE HOLD-APR           TO CM-LOAN-APR.
 10612
 10613     IF PMTFREQI GREATER THAN LOW-VALUES
 10614         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 10615
 10616     IF INDGRPI GREATER THAN LOW-VALUES
 10617         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 10618
 10619     IF LOANNOI GREATER THAN LOW-VALUES
 10620        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 10621
 10622     IF LOANBALL GREATER THAN +0
 10623        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 10624
 10625     IF PREMTYPI GREATER THAN LOW-VALUES
 10626         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 10627
 10628     IF REINCDI GREATER THAN LOW-VALUES
 10629         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10630                                    WS-REIN-1
 10631                                    WS-REIN-2
 10632                                    WS-REIN-3
 10633         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 10634
 10635     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 10636
 10637     MOVE ZEROS                  TO CM-LOAN-TERM
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 198
* EL131.cbl
 10638                                    CM-LIFE-COMM-PCT
 10639                                    CM-AH-COMM-PCT.
 10640
 10641*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 10642*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 10643*         PI-NO-PMTS = ZEROS
 10644*          IF LOANBALL GREATER THAN +0          OR
 10645*             ACVBENEL GREATER THAN +0          OR
 10646*             APRL     GREATER THAN +0          OR
 10647*             LCVRATEL GREATER THAN +0          OR
 10648*             ACVRATEL GREATER THAN +0
 10649*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 10650
 10651 2200-EXIT.
 10652     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 199
* EL131.cbl
 10654 2300-UPDATE-TRLR.
 10655
 10656
 10657* EXEC CICS READ UPDATE
 10658*         DATASET  (TRLR-FILE-ID)
 10659*         RIDFLD   (TRLR-KEY)
 10660*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10661*    END-EXEC.
 10662*    MOVE '&"S        EU         (   #00009634' TO DFHEIV0
 10663     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10664     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10665     MOVE X'2020233030303039363334' TO DFHEIV0(25:11)
 10666     CALL 'kxdfhei1' USING DFHEIV0,
 10667           TRLR-FILE-ID,
 10668           DFHEIV20,
 10669           DFHEIV99,
 10670           TRLR-KEY,
 10671           DFHEIV99,
 10672           DFHEIV99,
 10673           DFHEIV99
 10674     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10675         DFHEIV20
 10676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10677
 10678
 10679     MOVE ZERO                   TO COUNT-2.
 10680
 10681     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 10682         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 10683
 10684     IF NOT UPDATE-MADE
 10685         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 10686
 10687
 10688* EXEC CICS REWRITE
 10689*         DATASET  (TRLR-FILE-ID)
 10690*         FROM     (ACTIVITY-TRAILERS)
 10691*    END-EXEC.
 10692     MOVE LENGTH OF
 10693      ACTIVITY-TRAILERS
 10694       TO DFHEIV11
 10695*    MOVE '&& L                  %   #00009648' TO DFHEIV0
 10696     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10697     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10698     MOVE X'2020233030303039363438' TO DFHEIV0(25:11)
 10699     CALL 'kxdfhei1' USING DFHEIV0,
 10700           TRLR-FILE-ID,
 10701           ACTIVITY-TRAILERS,
 10702           DFHEIV11,
 10703           DFHEIV99
 10704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10705
 10706
 10707 2300-EXIT.
 10708     EXIT.
 10709
 10710 2310-INS-STATUS.
 10711     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 200
* EL131.cbl
 10712     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 10713         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 10714         MOVE 'Y'                TO TRLR-SWITCH.
 10715
 10716 2310-EXIT.
 10717     EXIT.
 10718
 10719 2320-SHIFT-STATUS.
 10720     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 10721        MOVE 6                   TO COUNT-2
 10722        GO TO 2320-EXIT.
 10723
 10724     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 10725     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 10726     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 10727     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 10728     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 10729     MOVE 6       TO COUNT-2.
 10730     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 10731
 10732 2320-EXIT.
 10733     EXIT.
 10734
 10735 2330-ADD-UPDATE.
 10736
 10737     IF COUNT-2 GREATER THAN 1
 10738        COMPUTE MISC-SUB = (COUNT-2 - 1)
 10739        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10740           GO TO 2330-EXIT.
 10741
 10742     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 10743                                   AT-RESERVES-LAST-MAINT-DT
 10744
 10745     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 10746     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 10747     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 10748     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 10749
 10750 2330-EXIT.
 10751     EXIT.
 10752
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 201
* EL131.cbl
 10754 2400-UPDATE-TRLR.
 10755
 10756* EXEC CICS HANDLE CONDITION
 10757*         NOTFND    (2400-TRLR-NOTFND)
 10758*         ENDFILE   (2410-EXIT)
 10759*    END-EXEC.
 10760*    MOVE '"$I''                  ! 4 #00009701' TO DFHEIV0
 10761     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10762     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10763     MOVE X'3420233030303039373031' TO DFHEIV0(25:11)
 10764     CALL 'kxdfhei1' USING DFHEIV0
 10765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10766
 10767
 10768
 10769* EXEC CICS STARTBR
 10770*        DATASET (TRLR-FILE-ID)
 10771*        RIDFLD  (TRLR-KEY)
 10772*    END-EXEC.
 10773     MOVE 0
 10774       TO DFHEIV11
 10775*    MOVE '&,         G          &   #00009706' TO DFHEIV0
 10776     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10777     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10778     MOVE X'2020233030303039373036' TO DFHEIV0(25:11)
 10779     CALL 'kxdfhei1' USING DFHEIV0,
 10780           TRLR-FILE-ID,
 10781           TRLR-KEY,
 10782           DFHEIV99,
 10783           DFHEIV11,
 10784           DFHEIV99
 10785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10786
 10787
 10788
 10789* EXEC CICS GETMAIN
 10790*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10791*         LENGTH    (TRLR-LENGTH)
 10792*         INITIMG   (GETMAIN-SPACE)
 10793*    END-EXEC.
 10794*    MOVE ',"IL                  $   #00009711' TO DFHEIV0
 10795     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10796     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10797     MOVE X'2020233030303039373131' TO DFHEIV0(25:11)
 10798     CALL 'kxdfhei1' USING DFHEIV0,
 10799           DFHEIV20,
 10800           TRLR-LENGTH,
 10801           GETMAIN-SPACE
 10802     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10803         DFHEIV20
 10804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10805
 10806
 10807     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 10808
 10809
 10810* EXEC CICS ENDBR
 10811*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 202
* EL131.cbl
 10812*    END-EXEC.
 10813     MOVE 0
 10814       TO DFHEIV11
 10815*    MOVE '&2                    $   #00009719' TO DFHEIV0
 10816     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10817     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10818     MOVE X'2020233030303039373139' TO DFHEIV0(25:11)
 10819     CALL 'kxdfhei1' USING DFHEIV0,
 10820           TRLR-FILE-ID,
 10821           DFHEIV11,
 10822           DFHEIV99
 10823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10824
 10825
 10826     GO TO 2400-EXIT.
 10827
 10828 2400-TRLR-NOTFND.
 10829     MOVE ER-0205                TO EMI-ERROR.
 10830     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10831     MOVE 'X'                    TO ERROR-SWITCH.
 10832
 10833 2400-EXIT.
 10834     EXIT.
 10835
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 203
* EL131.cbl
 10837 2410-CHANGE-TRLR.
 10838
 10839* EXEC CICS READNEXT
 10840*        DATASET (TRLR-FILE-ID)
 10841*        RIDFLD  (TRLR-KEY)
 10842*        INTO    (ACTIVITY-TRAILERS)
 10843*    END-EXEC.
 10844     MOVE LENGTH OF
 10845      ACTIVITY-TRAILERS
 10846       TO DFHEIV12
 10847     MOVE 0
 10848       TO DFHEIV11
 10849*    MOVE '&.IL                  )   #00009735' TO DFHEIV0
 10850     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 10851     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10852     MOVE X'2020233030303039373335' TO DFHEIV0(25:11)
 10853     CALL 'kxdfhei1' USING DFHEIV0,
 10854           TRLR-FILE-ID,
 10855           ACTIVITY-TRAILERS,
 10856           DFHEIV12,
 10857           TRLR-KEY,
 10858           DFHEIV99,
 10859           DFHEIV11,
 10860           DFHEIV99,
 10861           DFHEIV99
 10862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10863
 10864
 10865     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 10866        GO TO 2410-CHANGE-TRLR.
 10867
 10868     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 10869                                    CHECK-KEY.
 10870
 10871     IF CHECK-KEY NOT = MSTR-KEY
 10872         GO TO 2410-EXIT.
 10873
 10874
 10875* EXEC CICS ENDBR
 10876*        DATASET (TRLR-FILE-ID)
 10877*    END-EXEC.
 10878     MOVE 0
 10879       TO DFHEIV11
 10880*    MOVE '&2                    $   #00009750' TO DFHEIV0
 10881     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10882     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10883     MOVE X'2020233030303039373530' TO DFHEIV0(25:11)
 10884     CALL 'kxdfhei1' USING DFHEIV0,
 10885           TRLR-FILE-ID,
 10886           DFHEIV11,
 10887           DFHEIV99
 10888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10889
 10890
 10891
 10892* EXEC CICS READ UPDATE
 10893*        DATASET (TRLR-FILE-ID)
 10894*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 204
* EL131.cbl
 10895*        INTO    (ACTIVITY-TRAILERS)
 10896*    END-EXEC.
 10897     MOVE LENGTH OF
 10898      ACTIVITY-TRAILERS
 10899       TO DFHEIV11
 10900*    MOVE '&"IL       EU         (   #00009754' TO DFHEIV0
 10901     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10902     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10903     MOVE X'2020233030303039373534' TO DFHEIV0(25:11)
 10904     CALL 'kxdfhei1' USING DFHEIV0,
 10905           TRLR-FILE-ID,
 10906           ACTIVITY-TRAILERS,
 10907           DFHEIV11,
 10908           TRLR-KEY,
 10909           DFHEIV99,
 10910           DFHEIV99,
 10911           DFHEIV99
 10912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10913
 10914
 10915
 10916* EXEC CICS DELETE
 10917*        DATASET (TRLR-FILE-ID)
 10918*    END-EXEC.
 10919*    MOVE '&(                    &   #00009760' TO DFHEIV0
 10920     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10921     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10922     MOVE X'2020233030303039373630' TO DFHEIV0(25:11)
 10923     CALL 'kxdfhei1' USING DFHEIV0,
 10924           TRLR-FILE-ID,
 10925           DFHEIV99,
 10926           DFHEIV99,
 10927           DFHEIV99,
 10928           DFHEIV99
 10929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10930
 10931
 10932     IF AT-SEQUENCE-NO = ZERO AND
 10933        TRLR-UPDATE-REQUIRED
 10934         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 10935
 10936     IF CERTI GREATER THAN LOW-VALUES
 10937        MOVE CERTI               TO AT-CERT-PRIME.
 10938
 10939     IF SUFXI GREATER THAN LOW-VALUES
 10940        MOVE SUFXI               TO AT-CERT-SFX.
 10941
 10942     IF CERTCARI GREATER THAN LOW-VALUES
 10943        MOVE CERTCARI            TO AT-CARRIER.
 10944
 10945     IF PAYMENT-TR
 10946        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 10947           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 10948              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 10949
 10950     IF CORRESPONDENCE-TR
 10951        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 10952           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 205
* EL131.cbl
 10953
 10954
 10955* EXEC CICS WRITE
 10956*         DATASET  (TRLR-FILE-ID)
 10957*         RIDFLD   (AT-CONTROL-PRIMARY)
 10958*         FROM     (ACTIVITY-TRAILERS)
 10959*    END-EXEC.
 10960     MOVE LENGTH OF
 10961      ACTIVITY-TRAILERS
 10962       TO DFHEIV11
 10963*    MOVE '&$ L                  ''   #00009786' TO DFHEIV0
 10964     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10965     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10966     MOVE X'2020233030303039373836' TO DFHEIV0(25:11)
 10967     CALL 'kxdfhei1' USING DFHEIV0,
 10968           TRLR-FILE-ID,
 10969           ACTIVITY-TRAILERS,
 10970           DFHEIV11,
 10971           AT-CONTROL-PRIMARY,
 10972           DFHEIV99,
 10973           DFHEIV99
 10974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10975
 10976
 10977
 10978* EXEC CICS STARTBR
 10979*         DATASET  (TRLR-FILE-ID)
 10980*         RIDFLD   (TRLR-KEY)
 10981*    END-EXEC.
 10982     MOVE 0
 10983       TO DFHEIV11
 10984*    MOVE '&,         G          &   #00009792' TO DFHEIV0
 10985     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10986     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10987     MOVE X'2020233030303039373932' TO DFHEIV0(25:11)
 10988     CALL 'kxdfhei1' USING DFHEIV0,
 10989           TRLR-FILE-ID,
 10990           TRLR-KEY,
 10991           DFHEIV99,
 10992           DFHEIV11,
 10993           DFHEIV99
 10994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10995
 10996
 10997     GO TO 2410-CHANGE-TRLR.
 10998
 10999 2410-EXIT.
 11000     EXIT.
 11001
 11002 2420-UPDATE-TRLR.
 11003     MOVE ZERO TO COUNT-2.
 11004     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11005         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11006
 11007     IF NOT UPDATE-MADE
 11008         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11009
 11010 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 206
* EL131.cbl
 11011     EXIT.
 11012
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 207
* EL131.cbl
 11014 2425-UPDATE-NINETY-TRLR.
 11015
 11016     MOVE +90                    TO TRLR-SEQ-NO.
 11017
 11018
 11019* EXEC CICS HANDLE CONDITION
 11020*         NOTFND    (2425-NINETY-NOTFND)
 11021*         ENDFILE   (2425-NINETY-NOTFND)
 11022*    END-EXEC.
 11023*    MOVE '"$I''                  ! 5 #00009818' TO DFHEIV0
 11024     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11025     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11026     MOVE X'3520233030303039383138' TO DFHEIV0(25:11)
 11027     CALL 'kxdfhei1' USING DFHEIV0
 11028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11029
 11030
 11031
 11032* EXEC CICS READ UPDATE
 11033*        DATASET (TRLR-FILE-ID)
 11034*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11035*        RIDFLD  (TRLR-KEY)
 11036*    END-EXEC.
 11037*    MOVE '&"S        EU         (   #00009823' TO DFHEIV0
 11038     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11039     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11040     MOVE X'2020233030303039383233' TO DFHEIV0(25:11)
 11041     CALL 'kxdfhei1' USING DFHEIV0,
 11042           TRLR-FILE-ID,
 11043           DFHEIV20,
 11044           DFHEIV99,
 11045           TRLR-KEY,
 11046           DFHEIV99,
 11047           DFHEIV99,
 11048           DFHEIV99
 11049     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11050         DFHEIV20
 11051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11052
 11053
 11054     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
 11055
 11056     MOVE DIAGI                 TO AT-INFO-LINE-1.
 11057
 11058
 11059* EXEC CICS REWRITE
 11060*        DATASET (TRLR-FILE-ID)
 11061*        FROM    (ACTIVITY-TRAILERS)
 11062*    END-EXEC.
 11063     MOVE LENGTH OF
 11064      ACTIVITY-TRAILERS
 11065       TO DFHEIV11
 11066*    MOVE '&& L                  %   #00009833' TO DFHEIV0
 11067     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11068     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11069     MOVE X'2020233030303039383333' TO DFHEIV0(25:11)
 11070     CALL 'kxdfhei1' USING DFHEIV0,
 11071           TRLR-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 208
* EL131.cbl
 11072           ACTIVITY-TRAILERS,
 11073           DFHEIV11,
 11074           DFHEIV99
 11075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11076
 11077
 11078     IF DIAGI NOT = WS-DIAGNOSIS
 11079         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 11080         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 11081         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11082
 11083     GO TO 2425-EXIT.
 11084
 11085 2425-NINETY-NOTFND.
 11086
 11087
 11088* EXEC CICS GETMAIN
 11089*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11090*         LENGTH    (TRLR-LENGTH)
 11091*         INITIMG   (GETMAIN-SPACE)
 11092*    END-EXEC.
 11093*    MOVE ',"IL                  $   #00009847' TO DFHEIV0
 11094     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11095     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11096     MOVE X'2020233030303039383437' TO DFHEIV0(25:11)
 11097     CALL 'kxdfhei1' USING DFHEIV0,
 11098           DFHEIV20,
 11099           TRLR-LENGTH,
 11100           GETMAIN-SPACE
 11101     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11102         DFHEIV20
 11103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11104
 11105
 11106     MOVE +90                  TO TRLR-SEQ-NO.
 11107     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 11108
 11109     MOVE 'AT'                 TO AT-RECORD-ID
 11110     MOVE '6'                  TO AT-TRAILER-TYPE
 11111     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 11112                                  AT-GEN-INFO-LAST-MAINT-DT
 11113     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 11114                                  AT-GEN-INFO-LAST-UPDATED-BY
 11115     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 11116     MOVE DIAGI                TO AT-INFO-LINE-1.
 11117
 11118
 11119* EXEC CICS WRITE
 11120*        DATASET (TRLR-FILE-ID)
 11121*        FROM    (ACTIVITY-TRAILERS)
 11122*        RIDFLD  (TRLR-KEY)
 11123*    END-EXEC.
 11124     MOVE LENGTH OF
 11125      ACTIVITY-TRAILERS
 11126       TO DFHEIV11
 11127*    MOVE '&$ L                  ''   #00009865' TO DFHEIV0
 11128     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11129     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 209
* EL131.cbl
 11130     MOVE X'2020233030303039383635' TO DFHEIV0(25:11)
 11131     CALL 'kxdfhei1' USING DFHEIV0,
 11132           TRLR-FILE-ID,
 11133           ACTIVITY-TRAILERS,
 11134           DFHEIV11,
 11135           TRLR-KEY,
 11136           DFHEIV99,
 11137           DFHEIV99
 11138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11139
 11140
 11141 2425-EXIT.
 11142     EXIT.
 11143
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 210
* EL131.cbl
 11145 2430-UPDATE-ACTQ.
 11146
 11147* EXEC CICS HANDLE CONDITION
 11148*         NOTFND    (2430-EXIT)
 11149*         ENDFILE   (2440-EXIT)
 11150*    END-EXEC.
 11151*    MOVE '"$I''                  ! 6 #00009876' TO DFHEIV0
 11152     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11154     MOVE X'3620233030303039383736' TO DFHEIV0(25:11)
 11155     CALL 'kxdfhei1' USING DFHEIV0
 11156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11157
 11158
 11159
 11160* EXEC CICS STARTBR
 11161*         DATASET  (ACTQ-FILE-ID)
 11162*         RIDFLD   (ACTQ-KEY)
 11163*    END-EXEC.
 11164     MOVE 0
 11165       TO DFHEIV11
 11166*    MOVE '&,         G          &   #00009881' TO DFHEIV0
 11167     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11168     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11169     MOVE X'2020233030303039383831' TO DFHEIV0(25:11)
 11170     CALL 'kxdfhei1' USING DFHEIV0,
 11171           ACTQ-FILE-ID,
 11172           ACTQ-KEY,
 11173           DFHEIV99,
 11174           DFHEIV11,
 11175           DFHEIV99
 11176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11177
 11178
 11179
 11180* EXEC CICS GETMAIN
 11181*         SET      (ADDRESS OF ACTIVITY-QUE)
 11182*         LENGTH   (ACTQ-LENGTH)
 11183*         INITIMG  (GETMAIN-SPACE)
 11184*    END-EXEC.
 11185*    MOVE ',"IL                  $   #00009886' TO DFHEIV0
 11186     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11187     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11188     MOVE X'2020233030303039383836' TO DFHEIV0(25:11)
 11189     CALL 'kxdfhei1' USING DFHEIV0,
 11190           DFHEIV20,
 11191           ACTQ-LENGTH,
 11192           GETMAIN-SPACE
 11193     SET ADDRESS OF ACTIVITY-QUE TO
 11194         DFHEIV20
 11195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11196
 11197
 11198     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 11199
 11200 2430-EXIT.
 11201     EXIT.
 11202
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 211
* EL131.cbl
 11203 2440-CHANGE-ACTQ.
 11204
 11205
 11206* EXEC CICS READNEXT
 11207*         DATASET  (ACTQ-FILE-ID)
 11208*         RIDFLD   (ACTQ-KEY)
 11209*         INTO     (ACTIVITY-QUE)
 11210*    END-EXEC.
 11211     MOVE LENGTH OF
 11212      ACTIVITY-QUE
 11213       TO DFHEIV12
 11214     MOVE 0
 11215       TO DFHEIV11
 11216*    MOVE '&.IL                  )   #00009899' TO DFHEIV0
 11217     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11218     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11219     MOVE X'2020233030303039383939' TO DFHEIV0(25:11)
 11220     CALL 'kxdfhei1' USING DFHEIV0,
 11221           ACTQ-FILE-ID,
 11222           ACTIVITY-QUE,
 11223           DFHEIV12,
 11224           ACTQ-KEY,
 11225           DFHEIV99,
 11226           DFHEIV11,
 11227           DFHEIV99,
 11228           DFHEIV99
 11229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11230
 11231
 11232
 11233* EXEC CICS ENDBR
 11234*         DATASET (ACTQ-FILE-ID)
 11235*    END-EXEC.
 11236     MOVE 0
 11237       TO DFHEIV11
 11238*    MOVE '&2                    $   #00009905' TO DFHEIV0
 11239     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11240     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11241     MOVE X'2020233030303039393035' TO DFHEIV0(25:11)
 11242     CALL 'kxdfhei1' USING DFHEIV0,
 11243           ACTQ-FILE-ID,
 11244           DFHEIV11,
 11245           DFHEIV99
 11246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11247
 11248
 11249     IF ACTQ-KEY NOT = MSTR-KEY
 11250         GO TO 2440-EXIT.
 11251
 11252
 11253* EXEC CICS READ UPDATE
 11254*         DATASET  (ACTQ-FILE-ID)
 11255*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11256*         SET      (ADDRESS OF ACTIVITY-QUE)
 11257*    END-EXEC.
 11258*    MOVE '&"S        EU         (   #00009912' TO DFHEIV0
 11259     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11260     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 212
* EL131.cbl
 11261     MOVE X'2020233030303039393132' TO DFHEIV0(25:11)
 11262     CALL 'kxdfhei1' USING DFHEIV0,
 11263           ACTQ-FILE-ID,
 11264           DFHEIV20,
 11265           DFHEIV99,
 11266           AQ-CONTROL-PRIMARY,
 11267           DFHEIV99,
 11268           DFHEIV99,
 11269           DFHEIV99
 11270     SET ADDRESS OF ACTIVITY-QUE TO
 11271         DFHEIV20
 11272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11273
 11274
 11275     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 11276
 11277
 11278* EXEC CICS DELETE
 11279*         DATASET (ACTQ-FILE-ID)
 11280*    END-EXEC.
 11281*    MOVE '&(                    &   #00009920' TO DFHEIV0
 11282     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11283     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11284     MOVE X'2020233030303039393230' TO DFHEIV0(25:11)
 11285     CALL 'kxdfhei1' USING DFHEIV0,
 11286           ACTQ-FILE-ID,
 11287           DFHEIV99,
 11288           DFHEIV99,
 11289           DFHEIV99,
 11290           DFHEIV99
 11291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11292
 11293
 11294     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 11295     IF CERTI GREATER THAN LOW-VALUES
 11296        MOVE CERTI               TO AQ-CERT-PRIME.
 11297     IF SUFXI GREATER THAN LOW-VALUES
 11298        MOVE SUFXI               TO AQ-CERT-SFX.
 11299     IF CERTCARI GREATER THAN LOW-VALUES
 11300        MOVE CERTCARI            TO AQ-CARRIER.
 11301
 11302
 11303* EXEC CICS HANDLE CONDITION
 11304*         DUPREC   (2440-EXIT)
 11305*    END-EXEC.
 11306*    MOVE '"$%                   ! 7 #00009932' TO DFHEIV0
 11307     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11308     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11309     MOVE X'3720233030303039393332' TO DFHEIV0(25:11)
 11310     CALL 'kxdfhei1' USING DFHEIV0
 11311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11312
 11313
 11314
 11315* EXEC CICS WRITE
 11316*         DATASET  (ACTQ-FILE-ID)
 11317*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11318*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 213
* EL131.cbl
 11319*    END-EXEC.
 11320     MOVE LENGTH OF
 11321      ACTIVITY-QUE
 11322       TO DFHEIV11
 11323*    MOVE '&$ L                  ''   #00009936' TO DFHEIV0
 11324     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11325     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11326     MOVE X'2020233030303039393336' TO DFHEIV0(25:11)
 11327     CALL 'kxdfhei1' USING DFHEIV0,
 11328           ACTQ-FILE-ID,
 11329           ACTIVITY-QUE,
 11330           DFHEIV11,
 11331           AQ-CONTROL-PRIMARY,
 11332           DFHEIV99,
 11333           DFHEIV99
 11334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11335
 11336
 11337 2440-EXIT.
 11338     EXIT.
 11339
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 214
* EL131.cbl
 11341 2460-UPDATE-CHECKQ.
 11342
 11343* EXEC CICS HANDLE CONDITION
 11344*         NOTFND   (2460-EXIT)
 11345*    END-EXEC.
 11346*    MOVE '"$I                   ! 8 #00009947' TO DFHEIV0
 11347     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11348     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11349     MOVE X'3820233030303039393437' TO DFHEIV0(25:11)
 11350     CALL 'kxdfhei1' USING DFHEIV0
 11351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11352
 11353
 11354     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 11355     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 11356     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 11357
 11358
 11359* EXEC CICS READ UPDATE
 11360*         DATASET   (CHKQ-FILE-ID)
 11361*         RIDFLD    (CHKQ-KEY)
 11362*         SET       (ADDRESS OF CHECK-QUE)
 11363*    END-EXEC.
 11364*    MOVE '&"S        EU         (   #00009955' TO DFHEIV0
 11365     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11366     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11367     MOVE X'2020233030303039393535' TO DFHEIV0(25:11)
 11368     CALL 'kxdfhei1' USING DFHEIV0,
 11369           CHKQ-FILE-ID,
 11370           DFHEIV20,
 11371           DFHEIV99,
 11372           CHKQ-KEY,
 11373           DFHEIV99,
 11374           DFHEIV99,
 11375           DFHEIV99
 11376     SET ADDRESS OF CHECK-QUE TO
 11377         DFHEIV20
 11378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11379
 11380
 11381     IF CERTI GREATER THAN LOW-VALUES
 11382        MOVE CERTI               TO CQ-CERT-PRIME.
 11383     IF SUFXI GREATER THAN LOW-VALUES
 11384        MOVE SUFXI               TO CQ-CERT-SFX.
 11385     IF CERTCARI GREATER THAN LOW-VALUES
 11386        MOVE CERTCARI            TO CQ-CARRIER.
 11387
 11388
 11389* EXEC CICS REWRITE
 11390*         DATASET  (CHKQ-FILE-ID)
 11391*         FROM     (CHECK-QUE)
 11392*    END-EXEC.
 11393     MOVE LENGTH OF
 11394      CHECK-QUE
 11395       TO DFHEIV11
 11396*    MOVE '&& L                  %   #00009968' TO DFHEIV0
 11397     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11398     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 215
* EL131.cbl
 11399     MOVE X'2020233030303039393638' TO DFHEIV0(25:11)
 11400     CALL 'kxdfhei1' USING DFHEIV0,
 11401           CHKQ-FILE-ID,
 11402           CHECK-QUE,
 11403           DFHEIV11,
 11404           DFHEIV99
 11405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11406
 11407
 11408 2460-EXIT.
 11409     EXIT.
 11410
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 216
* EL131.cbl
 11412 2475-UPDATE-LETTER.
 11413
 11414* EXEC CICS HANDLE CONDITION
 11415*         NOTFND   (2475-EXIT)
 11416*    END-EXEC.
 11417*    MOVE '"$I                   ! 9 #00009978' TO DFHEIV0
 11418     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11419     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11420     MOVE X'3920233030303039393738' TO DFHEIV0(25:11)
 11421     CALL 'kxdfhei1' USING DFHEIV0
 11422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11423
 11424
 11425     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 11426     MOVE '1'                    TO ARCH-RECORD-TYPE.
 11427     MOVE ZEROS                  TO ARCH-SEQ-NO.
 11428     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 11429
 11430
 11431* EXEC CICS READ UPDATE
 11432*         DATASET   (ARCH-FILE-ID)
 11433*         RIDFLD    (ARCH-KEY)
 11434*         SET       (ADDRESS OF LETTER-ARCHIVE)
 11435*    END-EXEC.
 11436*    MOVE '&"S        EU         (   #00009987' TO DFHEIV0
 11437     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11438     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11439     MOVE X'2020233030303039393837' TO DFHEIV0(25:11)
 11440     CALL 'kxdfhei1' USING DFHEIV0,
 11441           ARCH-FILE-ID,
 11442           DFHEIV20,
 11443           DFHEIV99,
 11444           ARCH-KEY,
 11445           DFHEIV99,
 11446           DFHEIV99,
 11447           DFHEIV99
 11448     SET ADDRESS OF LETTER-ARCHIVE TO
 11449         DFHEIV20
 11450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11451
 11452
 11453* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 11454* TO THIS MASTER-KEY INFORMATION.
 11455
 11456     IF LA-CARRIER  = CARRIER-CODE AND
 11457        LA-CLAIM-NO = CLAIM-NO     AND
 11458        LA-CERT-NO  = CERT-NO
 11459        NEXT SENTENCE
 11460     ELSE
 11461        GO TO 2475-UNLOCK.
 11462
 11463     IF CERTI GREATER THAN LOW-VALUES
 11464        MOVE CERTI               TO LA-CERT-PRIME.
 11465     IF SUFXI GREATER THAN LOW-VALUES
 11466        MOVE SUFXI               TO LA-CERT-SFX.
 11467     IF CERTCARI GREATER THAN LOW-VALUES
 11468        MOVE CERTCARI            TO LA-CARRIER.
 11469
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 217
* EL131.cbl
 11470
 11471* EXEC CICS REWRITE
 11472*         DATASET  (ARCH-FILE-ID)
 11473*         FROM     (LETTER-ARCHIVE)
 11474*    END-EXEC.
 11475     MOVE LENGTH OF
 11476      LETTER-ARCHIVE
 11477       TO DFHEIV11
 11478*    MOVE '&& L                  %   #00010010' TO DFHEIV0
 11479     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11480     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11481     MOVE X'2020233030303130303130' TO DFHEIV0(25:11)
 11482     CALL 'kxdfhei1' USING DFHEIV0,
 11483           ARCH-FILE-ID,
 11484           LETTER-ARCHIVE,
 11485           DFHEIV11,
 11486           DFHEIV99
 11487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11488
 11489
 11490     GO TO 2475-EXIT.
 11491
 11492 2475-UNLOCK.
 11493
 11494* EXEC CICS UNLOCK
 11495*         DATASET  (ARCH-FILE-ID)
 11496*    END-EXEC.
 11497*    MOVE '&*                    #   #00010018' TO DFHEIV0
 11498     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11499     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11500     MOVE X'2020233030303130303138' TO DFHEIV0(25:11)
 11501     CALL 'kxdfhei1' USING DFHEIV0,
 11502           ARCH-FILE-ID,
 11503           DFHEIV99
 11504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11505
 11506
 11507 2475-EXIT.
 11508     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 218
* EL131.cbl
 11510 2600-CREATE-MAINT-NOTE.
 11511     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 11512     MOVE '1'                    TO CNTL-REC-TYPE.
 11513     MOVE SPACES                 TO CNTL-PROC-ID.
 11514     MOVE ZERO                   TO CNTL-SEQ-NO.
 11515
 11516
 11517* EXEC CICS READ
 11518*         SET        (ADDRESS OF CONTROL-FILE)
 11519*         DATASET    ('ELCNTL')
 11520*         RIDFLD     (CNTL-KEY)
 11521*    END-EXEC.
 11522     MOVE 'ELCNTL' TO DFHEIV1
 11523*    MOVE '&"S        E          (   #00010031' TO DFHEIV0
 11524     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11525     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11526     MOVE X'2020233030303130303331' TO DFHEIV0(25:11)
 11527     CALL 'kxdfhei1' USING DFHEIV0,
 11528           DFHEIV1,
 11529           DFHEIV20,
 11530           DFHEIV99,
 11531           CNTL-KEY,
 11532           DFHEIV99,
 11533           DFHEIV99,
 11534           DFHEIV99
 11535     SET ADDRESS OF CONTROL-FILE TO
 11536         DFHEIV20
 11537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11538
 11539
 11540     IF CO-NO-USE-AUDIT-CHANGES
 11541         GO TO 2600-EXIT.
 11542
 11543     IF PROCL GREATER ZERO
 11544     IF PROCI NOT = LOW-VALUES
 11545     IF PROCI NOT = CL-PROCESSOR-ID
 11546         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 11547         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 11548         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11549
 11550     IF SEXL GREATER ZERO
 11551     IF SEXI NOT = LOW-VALUES
 11552     IF SEXI NOT = CL-INSURED-SEX-CD
 11553         MOVE 'SEX'                TO SPLIT-INFO-DESC
 11554         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 11555         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11556
 11557     IF BIRTHL GREATER ZERO
 11558     IF HOLD-BIRTH NOT = LOW-VALUES
 11559     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 11560         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 11561         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 11562         MOVE SPACES               TO DC-OPTION-CODE
 11563         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11564         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11565         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11566
 11567     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 219
* EL131.cbl
 11568     IF SOCIALI NOT = LOW-VALUES
 11569     IF SOCIALI NOT = CL-SOC-SEC-NO
 11570         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 11571         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 11572         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11573
 11574     IF OCCL GREATER ZERO
 11575     IF OCCI NOT = LOW-VALUES
 11576     IF OCCI NOT = CL-INSURED-OCC-CD
 11577         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 11578         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 11579         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11580
 11581     IF BENEL GREATER ZERO
 11582     IF BENEI NOT = LOW-VALUES
 11583     IF BENEI NOT = CL-BENEFICIARY
 11584         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 11585         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 11586         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11587
 11588     IF PREMTYPL GREATER ZERO
 11589     IF PREMTYPI NOT = LOW-VALUES
 11590     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 11591         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 11592         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 11593         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11594
 11595     IF CAUSEL GREATER ZERO
 11596     IF CAUSEI NOT = LOW-VALUES
 11597     IF CAUSEI NOT = CL-CAUSE-CD
 11598         MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 11599         MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 11600         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11601
 11602     IF ENDL GREATER ZERO
 11603     IF HOLD-END NOT = LOW-VALUES
 11604     IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 11605         MOVE 'END DT'             TO SPLIT-INFO-DESC
 11606         MOVE CL-EST-END-OF-DISAB-DT
 11607                                   TO DC-BIN-DATE-1
 11608         MOVE SPACES               TO DC-OPTION-CODE
 11609         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11610         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11611         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11612
 11613     IF PDTHRUL GREATER ZERO
 11614     IF HOLD-PDTHRU NOT = LOW-VALUES
 11615     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 11616         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 11617         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 11618         MOVE SPACES               TO DC-OPTION-CODE
 11619         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11620         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11621         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11622
 11623     IF PDAMTL GREATER ZERO
 11624     IF HOLD-PDAMT NOT = ZEROS
 11625     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 220
* EL131.cbl
 11626         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 11627         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 11628         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 11629         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11630
 11631     IF NODAYSL GREATER ZERO
 11632     IF HOLD-NODAYS NOT = ZEROS
 11633     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 11634         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 11635         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 11636         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 11637         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11638
 11639     IF NOPMTSL GREATER ZERO
 11640     IF HOLD-NOPMTS NOT = ZEROS
 11641     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 11642         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 11643         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 11644         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 11645         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11646
 11647     IF FORMTYPL GREATER ZERO
 11648     IF FORMTYPI NOT = LOW-VALUES
 11649     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 11650         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 11651         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 11652         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11653
 11654     IF REPL GREATER ZERO
 11655     IF HOLD-REPORTED NOT = LOW-VALUES
 11656     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 11657         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 11658         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 11659         MOVE SPACES               TO DC-OPTION-CODE
 11660         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11661         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11662         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11663
 11664     IF ADDONDTL GREATER ZERO
 11665     IF HOLD-ADDON NOT = LOW-VALUES
 11666     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 11667         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 11668         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 11669         MOVE SPACES               TO DC-OPTION-CODE
 11670         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11671         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11672         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11673
 11674     IF PRICDL GREATER ZERO
 11675     IF PRICDI NOT = LOW-VALUES
 11676     IF PRICDI NOT = CL-PRIORITY-CD
 11677         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 11678         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 11679         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11680
 11681     IF FILETOL GREATER ZERO
 11682     IF FILETOI NOT = LOW-VALUES
 11683     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 221
* EL131.cbl
 11684         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 11685         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 11686         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11687
 11688     IF SUPVL GREATER ZERO
 11689     IF SUPVI NOT = LOW-VALUES
 11690     IF SUPVI NOT = CL-SUPV-ATTN-CD
 11691         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 11692         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 11693         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11694
 11695     IF MLNAMEL GREATER ZERO
 11696     IF MLNAMEI NOT = LOW-VALUES
 11697     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 11698         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 11699         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 11700         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11701
 11702     IF MFNAMEL GREATER ZERO
 11703     IF MFNAMEI NOT = LOW-VALUES
 11704     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 11705         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 11706         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 11707         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11708
 11709     IF MMINITL GREATER ZERO
 11710     IF MMINITI NOT = LOW-VALUES
 11711     IF MMINITI NOT = CL-INSURED-MID-INIT
 11712         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 11713         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 11714         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11715
 11716     IF CERTEFFL GREATER ZERO
 11717     IF HOLD-EFF NOT = LOW-VALUES
 11718     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 11719         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 11720         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 11721         MOVE SPACES               TO DC-OPTION-CODE
 11722         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11723         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11724         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11725
 11726     IF CERTACTL GREATER ZERO
 11727     IF CERTACTI NOT = LOW-VALUES
 11728     IF CERTACTI NOT = CL-CERT-ACCOUNT
 11729         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 11730         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 11731         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11732
 11733     IF CERTSTL GREATER ZERO
 11734     IF CERTSTI NOT = LOW-VALUES
 11735     IF CERTSTI NOT = CL-CERT-STATE
 11736         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 11737         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 11738         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11739
 11740     IF CERTCARL GREATER ZERO
 11741     IF CERTCARI NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 222
* EL131.cbl
 11742     IF CERTCARI NOT = CL-CERT-CARRIER
 11743         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 11744         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 11745         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11746
 11747     IF CERTGRPL GREATER ZERO
 11748     IF CERTGRPI NOT = LOW-VALUES
 11749     IF CERTGRPI NOT = CL-CERT-GROUPING
 11750         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 11751         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 11752         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11753
 11754     IF CERTL GREATER ZERO OR
 11755        SUFXL GREATER ZERO
 11756     IF (CERTI NOT = LOW-VALUES AND
 11757                     CL-CERT-PRIME)
 11758                OR
 11759        (SUFXI NOT = LOW-VALUES AND
 11760                     CL-CERT-SFX)
 11761         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 11762         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 11763         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11764
 11765 2600-EXIT.
 11766      EXIT.
 11767
 11768 2650-WRITE-MAINT-NOTE.
 11769
 11770* EXEC CICS GETMAIN
 11771*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11772*         LENGTH   (TRLR-LENGTH)
 11773*         INITIMG  (GETMAIN-SPACE)
 11774*    END-EXEC.
 11775*    MOVE ',"IL                  $   #00010266' TO DFHEIV0
 11776     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11777     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11778     MOVE X'2020233030303130323636' TO DFHEIV0(25:11)
 11779     CALL 'kxdfhei1' USING DFHEIV0,
 11780           DFHEIV20,
 11781           TRLR-LENGTH,
 11782           GETMAIN-SPACE
 11783     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11784         DFHEIV20
 11785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11786
 11787
 11788
 11789* EXEC CICS HANDLE CONDITION
 11790*         DUPREC   (2650-EXIT)
 11791*    END-EXEC.
 11792*    MOVE '"$%                   ! : #00010272' TO DFHEIV0
 11793     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11794     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11795     MOVE X'3A20233030303130323732' TO DFHEIV0(25:11)
 11796     CALL 'kxdfhei1' USING DFHEIV0
 11797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11798
 11799
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 223
* EL131.cbl
 11800     MOVE SPACES             TO ACTIVITY-TRAILERS.
 11801
 11802     IF CERTL GREATER ZERO
 11803         MOVE CERTI          TO CL-CERT-PRIME.
 11804
 11805     IF SUFXL GREATER ZERO
 11806         MOVE SUFXI          TO CL-CERT-SFX.
 11807
 11808     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 11809
 11810     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 11811     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 11812
 11813     MOVE 'AT'               TO AT-RECORD-ID.
 11814
 11815     MOVE '6'                TO AT-TRAILER-TYPE.
 11816     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 11817                                AT-GEN-INFO-LAST-MAINT-DT.
 11818     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 11819                                AT-GEN-INFO-LAST-UPDATED-BY.
 11820     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 11821     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 11822     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 11823
 11824
 11825* EXEC CICS WRITE
 11826*         DATASET  (TRLR-FILE-ID)
 11827*         RIDFLD   (AT-CONTROL-PRIMARY)
 11828*         FROM     (ACTIVITY-TRAILERS)
 11829*    END-EXEC.
 11830     MOVE LENGTH OF
 11831      ACTIVITY-TRAILERS
 11832       TO DFHEIV11
 11833*    MOVE '&$ L                  ''   #00010300' TO DFHEIV0
 11834     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11835     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11836     MOVE X'2020233030303130333030' TO DFHEIV0(25:11)
 11837     CALL 'kxdfhei1' USING DFHEIV0,
 11838           TRLR-FILE-ID,
 11839           ACTIVITY-TRAILERS,
 11840           DFHEIV11,
 11841           AT-CONTROL-PRIMARY,
 11842           DFHEIV99,
 11843           DFHEIV99
 11844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11845
 11846
 11847 2650-EXIT.
 11848      EXIT.
 11849
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 224
* EL131.cbl
 11851 3000-DELETE-CLAIM.
 11852     IF  NOT MODIFY-CAP
 11853         MOVE ER-0070            TO EMI-ERROR
 11854         MOVE -1                 TO MAINTL
 11855         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11856         GO TO 8110-SEND-DATA.
 11857
 11858
 11859* EXEC CICS READ
 11860*         SET      (ADDRESS OF CLAIM-MASTER)
 11861*         DATASET  (CLMS-FILE-ID)
 11862*         RIDFLD   (MSTR-KEY)
 11863*    END-EXEC.
 11864*    MOVE '&"S        E          (   #00010317' TO DFHEIV0
 11865     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11866     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11867     MOVE X'2020233030303130333137' TO DFHEIV0(25:11)
 11868     CALL 'kxdfhei1' USING DFHEIV0,
 11869           CLMS-FILE-ID,
 11870           DFHEIV20,
 11871           DFHEIV99,
 11872           MSTR-KEY,
 11873           DFHEIV99,
 11874           DFHEIV99,
 11875           DFHEIV99
 11876     SET ADDRESS OF CLAIM-MASTER TO
 11877         DFHEIV20
 11878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11879
 11880
 11881     IF CL-1ST-TRL-AVAIL
 11882         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 11883     ELSE
 11884        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 11885        MOVE 0                   TO TRLR-SEQ-NO
 11886
 11887* EXEC CICS STARTBR
 11888*            DATASET (TRLR-FILE-ID)
 11889*            RIDFLD  (TRLR-KEY)
 11890*        END-EXEC
 11891     MOVE 0
 11892       TO DFHEIV11
 11893*    MOVE '&,         G          &   #00010328' TO DFHEIV0
 11894     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11895     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11896     MOVE X'2020233030303130333238' TO DFHEIV0(25:11)
 11897     CALL 'kxdfhei1' USING DFHEIV0,
 11898           TRLR-FILE-ID,
 11899           TRLR-KEY,
 11900           DFHEIV99,
 11901           DFHEIV11,
 11902           DFHEIV99
 11903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11904         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 11905
 11906* EXEC CICS ENDBR
 11907*            DATASET (TRLR-FILE-ID)
 11908*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 225
* EL131.cbl
 11909     MOVE 0
 11910       TO DFHEIV11
 11911*    MOVE '&2                    $   #00010333' TO DFHEIV0
 11912     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11913     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11914     MOVE X'2020233030303130333333' TO DFHEIV0(25:11)
 11915     CALL 'kxdfhei1' USING DFHEIV0,
 11916           TRLR-FILE-ID,
 11917           DFHEIV11,
 11918           DFHEIV99
 11919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11920        IF SCREEN-ERROR
 11921            MOVE ER-0208         TO EMI-ERROR
 11922            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11923            MOVE -1              TO MAINTL
 11924            GO TO 8110-SEND-DATA
 11925        ELSE
 11926            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 11927
 11928     IF SCREEN-ERROR
 11929         MOVE -1                 TO MAINTL
 11930         GO TO 8110-SEND-DATA.
 11931
 11932     MOVE -1                     TO ONE-OR-MIN1.
 11933     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 11934
 11935     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 11936         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 11937                                    WS-SAVE-CLAIM-KEY
 11938         MOVE +1                 TO ONE-OR-MIN1
 11939         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 11940
 11941     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 11942
 11943     MOVE LOW-VALUES             TO EL131AO.
 11944     MOVE ER-0000                TO EMI-ERROR.
 11945     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11946     MOVE 'X'                    TO PI-RETURN-CD-1.
 11947     MOVE -1                     TO MAINTL.
 11948     GO TO 8100-SEND-MAP.
 11949
 11950 3010-DEL-MSTR-TRLR.
 11951
 11952* EXEC CICS READ UPDATE
 11953*         SET       (ADDRESS OF CLAIM-MASTER)
 11954*         DATASET   (CLMS-FILE-ID)
 11955*         RIDFLD    (MSTR-KEY)
 11956*    END-EXEC.
 11957*    MOVE '&"S        EU         (   #00010367' TO DFHEIV0
 11958     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11959     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11960     MOVE X'2020233030303130333637' TO DFHEIV0(25:11)
 11961     CALL 'kxdfhei1' USING DFHEIV0,
 11962           CLMS-FILE-ID,
 11963           DFHEIV20,
 11964           DFHEIV99,
 11965           MSTR-KEY,
 11966           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 226
* EL131.cbl
 11967           DFHEIV99,
 11968           DFHEIV99
 11969     SET ADDRESS OF CLAIM-MASTER TO
 11970         DFHEIV20
 11971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11972
 11973
 11974     if (cl-priority-cd = '8')
 11975        and (pi-processor-id not = 'PEMA' and 'JMS '
 11976             AND 'AMWA')
 11977        MOVE ER-8003             TO EMI-ERROR
 11978        PERFORM 9900-ERROR-FORMAT
 11979                                 THRU 9900-EXIT
 11980        MOVE -1                  TO MAINTL
 11981        GO TO 8110-SEND-DATA
 11982     end-if
 11983
 11984     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 11985     MOVE ZERO                   TO TRLR-SEQ-NO.
 11986
 11987
 11988* EXEC CICS HANDLE CONDITION
 11989*         NOTFND    (3010-DEL-ACTQ)
 11990*         ENDFILE   (3040-EXIT)
 11991*    END-EXEC.
 11992*    MOVE '"$I''                  ! ; #00010386' TO DFHEIV0
 11993     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11994     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11995     MOVE X'3B20233030303130333836' TO DFHEIV0(25:11)
 11996     CALL 'kxdfhei1' USING DFHEIV0
 11997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11998
 11999
 12000     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 12001
 12002 3010-DEL-ACTQ.
 12003
 12004
 12005* EXEC CICS HANDLE CONDITION
 12006*         NOTFND    (3010-NO-ACTIVITY)
 12007*         ENDFILE   (3050-EXIT)
 12008*    END-EXEC.
 12009*    MOVE '"$I''                  ! < #00010395' TO DFHEIV0
 12010     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12011     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12012     MOVE X'3C20233030303130333935' TO DFHEIV0(25:11)
 12013     CALL 'kxdfhei1' USING DFHEIV0
 12014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12015
 12016
 12017
 12018* EXEC CICS STARTBR
 12019*         DATASET  (ACTQ-FILE-ID)
 12020*         RIDFLD   (ACTQ-KEY)
 12021*    END-EXEC.
 12022     MOVE 0
 12023       TO DFHEIV11
 12024*    MOVE '&,         G          &   #00010400' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 227
* EL131.cbl
 12025     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12026     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12027     MOVE X'2020233030303130343030' TO DFHEIV0(25:11)
 12028     CALL 'kxdfhei1' USING DFHEIV0,
 12029           ACTQ-FILE-ID,
 12030           ACTQ-KEY,
 12031           DFHEIV99,
 12032           DFHEIV11,
 12033           DFHEIV99
 12034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12035
 12036
 12037
 12038* EXEC CICS GETMAIN
 12039*         SET      (ADDRESS OF ACTIVITY-QUE)
 12040*         LENGTH   (ACTQ-LENGTH)
 12041*         INITIMG  (GETMAIN-SPACE)
 12042*    END-EXEC.
 12043*    MOVE ',"IL                  $   #00010405' TO DFHEIV0
 12044     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12045     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12046     MOVE X'2020233030303130343035' TO DFHEIV0(25:11)
 12047     CALL 'kxdfhei1' USING DFHEIV0,
 12048           DFHEIV20,
 12049           ACTQ-LENGTH,
 12050           GETMAIN-SPACE
 12051     SET ADDRESS OF ACTIVITY-QUE TO
 12052         DFHEIV20
 12053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12054
 12055
 12056     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 12057
 12058
 12059* EXEC CICS ENDBR
 12060*         DATASET (ACTQ-FILE-ID)
 12061*    END-EXEC.
 12062     MOVE 0
 12063       TO DFHEIV11
 12064*    MOVE '&2                    $   #00010413' TO DFHEIV0
 12065     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12066     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12067     MOVE X'2020233030303130343133' TO DFHEIV0(25:11)
 12068     CALL 'kxdfhei1' USING DFHEIV0,
 12069           ACTQ-FILE-ID,
 12070           DFHEIV11,
 12071           DFHEIV99
 12072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12073
 12074
 12075 3010-NO-ACTIVITY.
 12076
 12077
 12078* EXEC CICS HANDLE CONDITION
 12079*        NOTFND   (3010-CERT-NOT-FOUND)
 12080*    END-EXEC.
 12081*    MOVE '"$I                   ! = #00010419' TO DFHEIV0
 12082     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 228
* EL131.cbl
 12083     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12084     MOVE X'3D20233030303130343139' TO DFHEIV0(25:11)
 12085     CALL 'kxdfhei1' USING DFHEIV0
 12086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12087
 12088
 12089     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 12090     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12091     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 12092     MOVE CL-CERT-STATE          TO CERT-STATE.
 12093     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12094     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 12095     MOVE CL-CERT-NO             TO CERT-CERT.
 12096
 12097
 12098* EXEC CICS READ
 12099*        DATASET   (CERT-FILE-ID)
 12100*        RIDFLD    (CERT-KEY)
 12101*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 12102*    END-EXEC.
 12103*    MOVE '&"S        E          (   #00010431' TO DFHEIV0
 12104     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12105     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12106     MOVE X'2020233030303130343331' TO DFHEIV0(25:11)
 12107     CALL 'kxdfhei1' USING DFHEIV0,
 12108           CERT-FILE-ID,
 12109           DFHEIV20,
 12110           DFHEIV99,
 12111           CERT-KEY,
 12112           DFHEIV99,
 12113           DFHEIV99,
 12114           DFHEIV99
 12115     SET ADDRESS OF CERTIFICATE-MASTER TO
 12116         DFHEIV20
 12117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12118
 12119
 12120     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 12121       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 12122         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 12123     ELSE
 12124         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 12125
 12126 3010-CERT-NOT-FOUND.
 12127
 12128
 12129* EXEC CICS DELETE
 12130*        DATASET  (CLMS-FILE-ID)
 12131*    END-EXEC.
 12132*    MOVE '&(                    &   #00010445' TO DFHEIV0
 12133     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12134     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12135     MOVE X'2020233030303130343435' TO DFHEIV0(25:11)
 12136     CALL 'kxdfhei1' USING DFHEIV0,
 12137           CLMS-FILE-ID,
 12138           DFHEIV99,
 12139           DFHEIV99,
 12140           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 229
* EL131.cbl
 12141           DFHEIV99
 12142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12143
 12144
 12145 3010-EXIT.
 12146      EXIT.
 12147
 12148 3020-UPDATE-CERT.
 12149
 12150* EXEC CICS READ UPDATE
 12151*         DATASET  (CERT-FILE-ID)
 12152*         RIDFLD   (CERT-KEY)
 12153*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12154*    END-EXEC.
 12155*    MOVE '&"S        EU         (   #00010453' TO DFHEIV0
 12156     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12157     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12158     MOVE X'2020233030303130343533' TO DFHEIV0(25:11)
 12159     CALL 'kxdfhei1' USING DFHEIV0,
 12160           CERT-FILE-ID,
 12161           DFHEIV20,
 12162           DFHEIV99,
 12163           CERT-KEY,
 12164           DFHEIV99,
 12165           DFHEIV99,
 12166           DFHEIV99
 12167     SET ADDRESS OF CERTIFICATE-MASTER TO
 12168         DFHEIV20
 12169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12170
 12171
 12172     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 12173
 12174
 12175* EXEC CICS HANDLE CONDITION
 12176*         DUPKEY   (3020-EXIT)
 12177*    END-EXEC.
 12178*    MOVE '"$$                   ! > #00010461' TO DFHEIV0
 12179     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12180     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12181     MOVE X'3E20233030303130343631' TO DFHEIV0(25:11)
 12182     CALL 'kxdfhei1' USING DFHEIV0
 12183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12184
 12185
 12186
 12187* EXEC CICS REWRITE
 12188*         DATASET  (CERT-FILE-ID)
 12189*         FROM     (CERTIFICATE-MASTER)
 12190*    END-EXEC.
 12191     MOVE LENGTH OF
 12192      CERTIFICATE-MASTER
 12193       TO DFHEIV11
 12194*    MOVE '&& L                  %   #00010465' TO DFHEIV0
 12195     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12196     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12197     MOVE X'2020233030303130343635' TO DFHEIV0(25:11)
 12198     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 230
* EL131.cbl
 12199           CERT-FILE-ID,
 12200           CERTIFICATE-MASTER,
 12201           DFHEIV11,
 12202           DFHEIV99
 12203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12204
 12205
 12206 3020-EXIT.
 12207     EXIT.
 12208
 12209 3030-DELETE-CERT.
 12210
 12211* EXEC CICS READ UPDATE
 12212*         DATASET  (CERT-FILE-ID)
 12213*         RIDFLD   (CERT-KEY)
 12214*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12215*    END-EXEC.
 12216*    MOVE '&"S        EU         (   #00010474' TO DFHEIV0
 12217     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12218     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12219     MOVE X'2020233030303130343734' TO DFHEIV0(25:11)
 12220     CALL 'kxdfhei1' USING DFHEIV0,
 12221           CERT-FILE-ID,
 12222           DFHEIV20,
 12223           DFHEIV99,
 12224           CERT-KEY,
 12225           DFHEIV99,
 12226           DFHEIV99,
 12227           DFHEIV99
 12228     SET ADDRESS OF CERTIFICATE-MASTER TO
 12229         DFHEIV20
 12230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12231
 12232
 12233
 12234* EXEC CICS DELETE
 12235*         DATASET   (CERT-FILE-ID)
 12236*    END-EXEC.
 12237*    MOVE '&(                    &   #00010480' TO DFHEIV0
 12238     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12239     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12240     MOVE X'2020233030303130343830' TO DFHEIV0(25:11)
 12241     CALL 'kxdfhei1' USING DFHEIV0,
 12242           CERT-FILE-ID,
 12243           DFHEIV99,
 12244           DFHEIV99,
 12245           DFHEIV99,
 12246           DFHEIV99
 12247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12248
 12249
 12250 3030-EXIT.
 12251     EXIT.
 12252
 12253 3040-DELETE-TRLR.
 12254
 12255* EXEC CICS READ
 12256*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 231
* EL131.cbl
 12257*         DATASET  (TRLR-FILE-ID)
 12258*         RIDFLD   (TRLR-KEY)
 12259*         GTEQ
 12260*    END-EXEC.
 12261*    MOVE '&"S        G          (   #00010488' TO DFHEIV0
 12262     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12263     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12264     MOVE X'2020233030303130343838' TO DFHEIV0(25:11)
 12265     CALL 'kxdfhei1' USING DFHEIV0,
 12266           TRLR-FILE-ID,
 12267           DFHEIV20,
 12268           DFHEIV99,
 12269           TRLR-KEY,
 12270           DFHEIV99,
 12271           DFHEIV99,
 12272           DFHEIV99
 12273     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12274         DFHEIV20
 12275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12276
 12277
 12278     IF PI-COMPANY-CD = AT-COMPANY-CD
 12279        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 12280        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 12281           GO TO 3040-EXIT
 12282        ELSE
 12283           NEXT SENTENCE
 12284     ELSE
 12285        GO TO 3040-EXIT.
 12286
 12287
 12288* EXEC CICS DELETE
 12289*         DATASET  (TRLR-FILE-ID)
 12290*         RIDFLD   (TRLR-KEY)
 12291*    END-EXEC.
 12292*    MOVE '&(  R                 &   #00010504' TO DFHEIV0
 12293     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12294     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12295     MOVE X'2020233030303130353034' TO DFHEIV0(25:11)
 12296     CALL 'kxdfhei1' USING DFHEIV0,
 12297           TRLR-FILE-ID,
 12298           TRLR-KEY,
 12299           DFHEIV99,
 12300           DFHEIV99,
 12301           DFHEIV99
 12302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12303
 12304
 12305     GO TO 3040-DELETE-TRLR.
 12306
 12307 3040-EXIT.
 12308     EXIT.
 12309
 12310 3050-DELETE-ACTQ.
 12311
 12312* EXEC CICS READNEXT
 12313*         DATASET  (ACTQ-FILE-ID)
 12314*         RIDFLD   (ACTQ-KEY)
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 232
* EL131.cbl
 12315*         INTO     (ACTIVITY-QUE)
 12316*    END-EXEC.
 12317     MOVE LENGTH OF
 12318      ACTIVITY-QUE
 12319       TO DFHEIV12
 12320     MOVE 0
 12321       TO DFHEIV11
 12322*    MOVE '&.IL                  )   #00010515' TO DFHEIV0
 12323     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12324     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12325     MOVE X'2020233030303130353135' TO DFHEIV0(25:11)
 12326     CALL 'kxdfhei1' USING DFHEIV0,
 12327           ACTQ-FILE-ID,
 12328           ACTIVITY-QUE,
 12329           DFHEIV12,
 12330           ACTQ-KEY,
 12331           DFHEIV99,
 12332           DFHEIV11,
 12333           DFHEIV99,
 12334           DFHEIV99
 12335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12336
 12337
 12338     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 12339         GO TO 3050-EXIT.
 12340
 12341
 12342* EXEC CICS ENDBR
 12343*         DATASET  (ACTQ-FILE-ID)
 12344*    END-EXEC.
 12345     MOVE 0
 12346       TO DFHEIV11
 12347*    MOVE '&2                    $   #00010524' TO DFHEIV0
 12348     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12349     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12350     MOVE X'2020233030303130353234' TO DFHEIV0(25:11)
 12351     CALL 'kxdfhei1' USING DFHEIV0,
 12352           ACTQ-FILE-ID,
 12353           DFHEIV11,
 12354           DFHEIV99
 12355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12356
 12357
 12358
 12359* EXEC CICS DELETE
 12360*         DATASET   (ACTQ-FILE-ID)
 12361*         RIDFLD    (ACTQ-KEY)
 12362*    END-EXEC.
 12363*    MOVE '&(  R                 &   #00010528' TO DFHEIV0
 12364     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12365     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12366     MOVE X'2020233030303130353238' TO DFHEIV0(25:11)
 12367     CALL 'kxdfhei1' USING DFHEIV0,
 12368           ACTQ-FILE-ID,
 12369           ACTQ-KEY,
 12370           DFHEIV99,
 12371           DFHEIV99,
 12372           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 233
* EL131.cbl
 12373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12374
 12375
 12376
 12377* EXEC CICS STARTBR
 12378*         DATASET   (ACTQ-FILE-ID)
 12379*         RIDFLD    (ACTQ-KEY)
 12380*    END-EXEC.
 12381     MOVE 0
 12382       TO DFHEIV11
 12383*    MOVE '&,         G          &   #00010533' TO DFHEIV0
 12384     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12385     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12386     MOVE X'2020233030303130353333' TO DFHEIV0(25:11)
 12387     CALL 'kxdfhei1' USING DFHEIV0,
 12388           ACTQ-FILE-ID,
 12389           ACTQ-KEY,
 12390           DFHEIV99,
 12391           DFHEIV11,
 12392           DFHEIV99
 12393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12394
 12395
 12396     GO TO 3050-DELETE-ACTQ.
 12397
 12398 3050-EXIT.
 12399     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 234
* EL131.cbl
 12401 3060-READ-TRLR.
 12402
 12403* EXEC CICS HANDLE CONDITION
 12404*         NOTFND    (3060-EXIT)
 12405*         ENDFILE   (3060-EXIT)
 12406*    END-EXEC.
 12407*    MOVE '"$I''                  ! ? #00010544' TO DFHEIV0
 12408     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12409     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12410     MOVE X'3F20233030303130353434' TO DFHEIV0(25:11)
 12411     CALL 'kxdfhei1' USING DFHEIV0
 12412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12413
 12414
 12415 3060-LOOP.
 12416
 12417* EXEC CICS READNEXT
 12418*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12419*         DATASET  (TRLR-FILE-ID)
 12420*         RIDFLD   (TRLR-KEY)
 12421*    END-EXEC.
 12422     MOVE 0
 12423       TO DFHEIV11
 12424*    MOVE '&.S                   )   #00010550' TO DFHEIV0
 12425     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12426     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12427     MOVE X'2020233030303130353530' TO DFHEIV0(25:11)
 12428     CALL 'kxdfhei1' USING DFHEIV0,
 12429           TRLR-FILE-ID,
 12430           DFHEIV20,
 12431           DFHEIV99,
 12432           TRLR-KEY,
 12433           DFHEIV99,
 12434           DFHEIV11,
 12435           DFHEIV99,
 12436           DFHEIV99
 12437     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12438         DFHEIV20
 12439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12440
 12441
 12442     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 12443         GO TO 3060-EXIT.
 12444
 12445     IF FORM-CONTROL-TR
 12446         IF AT-RECORDED-DT = SAVE-BIN-DATE
 12447             NEXT SENTENCE
 12448         ELSE
 12449             MOVE 'X'            TO ERROR-SWITCH
 12450             GO TO 3060-EXIT
 12451     ELSE
 12452         IF PAYMENT-TR OR CORRESPONDENCE-TR
 12453            MOVE 'X'                 TO ERROR-SWITCH
 12454            GO TO 3060-EXIT.
 12455
 12456     GO TO 3060-LOOP.
 12457
 12458 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 235
* EL131.cbl
 12459     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 236
* EL131.cbl
 12461 4000-FORCE-ERRORS.
 12462     IF PI-RETURN-CD-1 = 'X'
 12463         MOVE ER-0311            TO EMI-ERROR
 12464         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12465         MOVE -1                 TO MAINTL
 12466         GO TO 8110-SEND-DATA.
 12467
 12468     IF NOT FORCE-CAP
 12469         MOVE ER-0416            TO EMI-ERROR
 12470         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12471         MOVE -1                 TO MAINTL
 12472         GO TO 8110-SEND-DATA.
 12473
 12474     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 12475     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 12476     IF EMI-FATAL-CTR GREATER THAN ZERO
 12477         GO TO 4000-FATAL-ERRORS.
 12478
 12479     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 12480
 12481     IF EMI-FATAL-CTR GREATER THAN ZERO
 12482         GO TO 4000-FATAL-ERRORS.
 12483
 12484     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 12485
 12486     IF EMI-FATAL-CTR GREATER THAN ZERO
 12487         GO TO 4000-FATAL-ERRORS.
 12488
 12489     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 12490     MOVE AL-UANOF               TO CERTA.
 12491     MOVE ER-0000 TO EMI-ERROR.
 12492     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12493
 12494 4000-FATAL-ERRORS.
 12495     MOVE -1                     TO MAINTL.
 12496     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 237
* EL131.cbl
 12498 5000-BUILD-MAP.
 12499     IF PI-RETURN-CD-1 = SPACE
 12500         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 12501
 12502     MOVE SPACE                  TO PI-RETURN-CD-1.
 12503
 12504     MOVE LOW-VALUES             TO EL131AI.
 12505
 12506     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 12507     MOVE PI-CARRIER             TO CARRIER-CODE.
 12508     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 12509     MOVE PI-CERT-NO             TO CERT-NO.
 12510
 12511 5000-READ-CLAIM-MASTER.
 12512
 12513
 12514* EXEC CICS READ
 12515*         SET      (ADDRESS OF CLAIM-MASTER)
 12516*         DATASET  (CLMS-FILE-ID)
 12517*         RIDFLD   (MSTR-KEY)
 12518*    END-EXEC.
 12519*    MOVE '&"S        E          (   #00010627' TO DFHEIV0
 12520     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12521     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12522     MOVE X'2020233030303130363237' TO DFHEIV0(25:11)
 12523     CALL 'kxdfhei1' USING DFHEIV0,
 12524           CLMS-FILE-ID,
 12525           DFHEIV20,
 12526           DFHEIV99,
 12527           MSTR-KEY,
 12528           DFHEIV99,
 12529           DFHEIV99,
 12530           DFHEIV99
 12531     SET ADDRESS OF CLAIM-MASTER TO
 12532         DFHEIV20
 12533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12534
 12535
 12536     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 12537
 12538 5000-READ-DIAGNOSIS-TRAILER.
 12539
 12540
 12541* EXEC CICS HANDLE CONDITION
 12542*         NOTFND (5000-TRLR-NOT-FOUND)
 12543*    END-EXEC.
 12544*    MOVE '"$I                   ! @ #00010637' TO DFHEIV0
 12545     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12546     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12547     MOVE X'4020233030303130363337' TO DFHEIV0(25:11)
 12548     CALL 'kxdfhei1' USING DFHEIV0
 12549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12550
 12551
 12552     MOVE MSTR-KEY               TO TRLR-KEY.
 12553     MOVE NINETY                 TO TRLR-SEQ-NO.
 12554
 12555
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 238
* EL131.cbl
 12556* EXEC CICS READ
 12557*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12558*         DATASET  (TRLR-FILE-ID)
 12559*         RIDFLD   (TRLR-KEY)
 12560*    END-EXEC.
 12561*    MOVE '&"S        E          (   #00010644' TO DFHEIV0
 12562     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12564     MOVE X'2020233030303130363434' TO DFHEIV0(25:11)
 12565     CALL 'kxdfhei1' USING DFHEIV0,
 12566           TRLR-FILE-ID,
 12567           DFHEIV20,
 12568           DFHEIV99,
 12569           TRLR-KEY,
 12570           DFHEIV99,
 12571           DFHEIV99,
 12572           DFHEIV99
 12573     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12574         DFHEIV20
 12575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12576
 12577
 12578     MOVE AT-INFO-LINE-1         TO DIAGO.
 12579
 12580 5000-READ-CERTIFICATE-MASTER.
 12581
 12582     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 12583     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 12584     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 12585     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 12586     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 12587     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 12588     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 12589
 12590
 12591* EXEC CICS HANDLE CONDITION
 12592*         NOTFND (5000-CERT-NOT-FOUND)
 12593*    END-EXEC.
 12594*    MOVE '"$I                   ! A #00010662' TO DFHEIV0
 12595     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12596     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12597     MOVE X'4120233030303130363632' TO DFHEIV0(25:11)
 12598     CALL 'kxdfhei1' USING DFHEIV0
 12599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12600
 12601
 12602
 12603* EXEC CICS READ
 12604*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12605*         DATASET  (CERT-FILE-ID)
 12606*         RIDFLD   (CERT-KEY)
 12607*    END-EXEC.
 12608*    MOVE '&"S        E          (   #00010666' TO DFHEIV0
 12609     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12610     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12611     MOVE X'2020233030303130363636' TO DFHEIV0(25:11)
 12612     CALL 'kxdfhei1' USING DFHEIV0,
 12613           CERT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 239
* EL131.cbl
 12614           DFHEIV20,
 12615           DFHEIV99,
 12616           CERT-KEY,
 12617           DFHEIV99,
 12618           DFHEIV99,
 12619           DFHEIV99
 12620     SET ADDRESS OF CERTIFICATE-MASTER TO
 12621         DFHEIV20
 12622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12623
 12624
 12625     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 12626     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 12627
 12628     GO TO 5000-EXIT.
 12629
 12630 5000-TRLR-NOT-FOUND.
 12631     MOVE ER-7687                TO EMI-ERROR.
 12632     MOVE -1                     TO DIAGL.
 12633     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12634     GO TO 5000-EXIT.
 12635
 12636 5000-CERT-NOT-FOUND.
 12637     MOVE ER-0206                TO EMI-ERROR.
 12638     MOVE -1                     TO CERTL.
 12639     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12640
 12641 5000-EXIT.
 12642     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 240
* EL131.cbl
 12644 5010-RESET-PI-AREA.
 12645     IF CERTI GREATER THAN LOW-VALUES
 12646         MOVE CERTI              TO PI-CERT-PRIME.
 12647
 12648     IF SUFXI GREATER THAN LOW-VALUES
 12649         MOVE SUFXI              TO PI-CERT-SFX.
 12650
 12651     IF CERTEFFI GREATER THAN LOW-VALUES
 12652         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 12653
 12654     IF CERTACTI GREATER THAN LOW-VALUES
 12655         MOVE CERTACTI           TO PI-ACCOUNT.
 12656
 12657     IF CERTSTI GREATER THAN LOW-VALUES
 12658         MOVE CERTSTI            TO PI-STATE.
 12659
 12660     IF CERTCARI GREATER THAN LOW-VALUES
 12661         MOVE CERTCARI           TO PI-CARRIER.
 12662
 12663     IF CERTGRPI GREATER THAN LOW-VALUES
 12664         MOVE CERTGRPI           TO PI-GROUPING.
 12665
 12666 5010-EXIT.
 12667     EXIT.
 12668
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 241
* EL131.cbl
 12670 5020-MOVE-MSTR.
 12671
 12672     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 12673     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 12674     MOVE WS-CLAIM-SEQU          TO SEQUO.
 12675     MOVE AL-SABON               TO SEQUA.
 12676     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 12677     MOVE CL-CLAIM-TYPE          TO TYPEO.
 12678
 12679     IF CL-TOTAL-PAID-AMT  = +0 AND
 12680        CL-LAST-PMT-AMT    = +0 AND
 12681        CL-NO-OF-PMTS-MADE = +0
 12682          MOVE AL-UANON          TO TYPEA.
 12683
 12684     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 12685     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 12686     MOVE CL-CERT-PRIME          TO CERTO.
 12687     MOVE CL-CERT-SFX            TO SUFXO.
 12688     MOVE CL-CERT-CARRIER        TO CARRO.
 12689
 12690     IF CL-CLAIM-STATUS = 'C'
 12691         MOVE 'CLOSED'           TO STATUSO
 12692     ELSE
 12693         MOVE 'OPEN  '           TO STATUSO.
 12694
 12695     MOVE CL-PROCESSOR-ID        TO PROCO.
 12696
 12697     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 12698     MOVE CL-CCN                 TO CCNOO.
 12699
 12700     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 12701     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 12702     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 12703     MOVE CL-INSURED-SEX-CD      TO SEXO.
 12704
 12705     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 12706         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 12707         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12708         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12709         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 12710     ELSE
 12711         MOVE SPACES             TO BIRTHO.
 12712
 12713     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 12714        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 12715         NEXT SENTENCE
 12716       ELSE
 12717         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 12718
 12719     IF PI-COMPANY-ID = 'DMD'
 12720       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
 12721          IF SOCIALO = SPACES OR LOW-VALUES
 12722            MOVE ER-0885         TO EMI-ERROR
 12723            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12724
 12725     MOVE CL-INSURED-OCC-CD      TO OCCO.
 12726     MOVE CL-CAUSE-CD            TO CAUSEO.
 12727
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 242
* EL131.cbl
 12728     IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 12729         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 12730         MOVE SPACES                 TO DC-OPTION-CODE
 12731         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12732         MOVE DC-GREG-DATE-1-EDIT TO ENDO
 12733     ELSE
 12734         MOVE SPACES             TO ENDO.
 12735
 12736     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 12737        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 12738        MOVE SPACES             TO DC-OPTION-CODE
 12739        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12740        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 12741        IF PI-USES-PAID-TO
 12742           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 12743           MOVE '6'                TO DC-OPTION-CODE
 12744           MOVE +1                 TO DC-ELAPSED-DAYS
 12745           MOVE +0                 TO DC-ELAPSED-MONTHS
 12746           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12747           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 12748        ELSE
 12749           NEXT SENTENCE
 12750     ELSE
 12751        MOVE SPACES             TO PDTHRUO.
 12752
 12753     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 12754     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 12755     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 12756     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 12757
 12758     IF MODIFY-CAP
 12759        MOVE AL-UNNOF            TO PDAMTA
 12760                                    NODAYSA
 12761                                    NOPMTSA
 12762        MOVE AL-UANOF            TO PDTHRUA.
 12763
 12764     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 12765         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 12766         MOVE SPACES             TO DC-OPTION-CODE
 12767         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12768         MOVE DC-GREG-DATE-1-EDIT TO INCO
 12769     ELSE
 12770         MOVE SPACES             TO INCO.
 12771
 12772     IF CL-NO-OF-PMTS-MADE = ZEROS
 12773        MOVE AL-UANOF            TO INCA.
 12774
 12775     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 12776
 12777     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 12778         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 12779         MOVE SPACES             TO DC-OPTION-CODE
 12780         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12781         MOVE DC-GREG-DATE-1-EDIT TO REPO
 12782     ELSE
 12783         MOVE SPACES             TO REPO.
 12784
 12785     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 243
* EL131.cbl
 12786         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 12787         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12788         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12789         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 12790     ELSE
 12791         MOVE SPACES             TO ESTO.
 12792
 12793     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 12794         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 12795         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12796         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12797         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 12798     ELSE
 12799         MOVE SPACES             TO MNTDTO.
 12800
 12801
 12802     IF CL-LAST-MAINT-TYPE = SPACE
 12803         MOVE 'SET-UP'           TO MNTTYPEO
 12804     ELSE
 12805     IF CL-LAST-MAINT-TYPE = '1'
 12806         MOVE 'PAYMNT'           TO MNTTYPEO
 12807     ELSE
 12808     IF CL-LAST-MAINT-TYPE = '2'
 12809         MOVE 'LETTER'           TO MNTTYPEO
 12810     ELSE
 12811     IF CL-LAST-MAINT-TYPE = '3'
 12812         MOVE 'UPDATE'           TO MNTTYPEO
 12813     ELSE
 12814     IF CL-LAST-MAINT-TYPE = '4'
 12815         MOVE 'RESTOR'           TO MNTTYPEO
 12816     ELSE
 12817     IF CL-LAST-MAINT-TYPE = '5'
 12818         MOVE 'INC DT'           TO MNTTYPEO
 12819     ELSE
 12820     IF CL-LAST-MAINT-TYPE = '6'
 12821         MOVE ' CONV'            TO MNTTYPEO
 12822     ELSE
 12823     IF CL-LAST-MAINT-TYPE = 'C'
 12824         MOVE 'CHGBEN'           TO MNTTYPEO
 12825     ELSE
 12826     IF CL-LAST-MAINT-TYPE = 'E'
 12827         MOVE 'ERRCOR'           TO MNTTYPEO
 12828     ELSE
 12829         MOVE SPACES             TO MNTTYPEO.
 12830
 12831     MOVE CL-BENEFICIARY         TO BENEO.
 12832     MOVE CL-FILE-LOCATION       TO FILETOO.
 12833     MOVE CL-PRIORITY-CD         TO PRICDO.
 12834     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 12835     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 12836     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 12837
 12838 5020-EXIT.
 12839     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 244
* EL131.cbl
 12841 5030-MOVE-CERT.
 12842
 12843     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 12844         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12845         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12846         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12847         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 12848       ELSE
 12849         MOVE SPACES             TO CERTEFFO
 12850         MOVE ZERO               TO HOLD-DATE.
 12851
 12852     MOVE CM-ACCOUNT             TO CERTACTO.
 12853     MOVE CM-STATE               TO CERTSTO PI-STATE.
 12854     MOVE CM-GROUPING            TO CERTGRPO.
 12855     MOVE CM-CARRIER             TO CERTCARO.
 12856     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 12857     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 12858     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 12859     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 12860     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 12861     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 12862     MOVE CM-JT-INITIAL          TO JNTINITO.
 12863     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 12864
 12865*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 12866     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12867     MOVE '3'                    TO CNTL-REC-TYPE.
 12868     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 12869     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 12870     MOVE ZERO                   TO CNTL-SEQ-NO.
 12871
 12872
 12873* EXEC CICS READ
 12874*         SET        (ADDRESS OF CONTROL-FILE)
 12875*         DATASET    ('ELCNTL')
 12876*         RIDFLD     (CNTL-KEY)
 12877*         RESP       (WS-RESPONSE)
 12878*    END-EXEC.
 12879     MOVE 'ELCNTL' TO DFHEIV1
 12880*    MOVE '&"S        E          (  N#00010919' TO DFHEIV0
 12881     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12882     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12883     MOVE X'204E233030303130393139' TO DFHEIV0(25:11)
 12884     CALL 'kxdfhei1' USING DFHEIV0,
 12885           DFHEIV1,
 12886           DFHEIV20,
 12887           DFHEIV99,
 12888           CNTL-KEY,
 12889           DFHEIV99,
 12890           DFHEIV99,
 12891           DFHEIV99
 12892     SET ADDRESS OF CONTROL-FILE TO
 12893         DFHEIV20
 12894     MOVE EIBRESP  TO WS-RESPONSE
 12895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12896
 12897
 12898     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 245
* EL131.cbl
 12899        MOVE ZERO                TO CP-FREE-LOOK
 12900     ELSE
 12901        MOVE CF-ST-FREE-LOOK-PERIOD
 12902                                 TO CP-FREE-LOOK.
 12903
 12904     IF CM-LF-BENEFIT-CD = '00'
 12905        GO TO 5030-MOVE-CERT-AH.
 12906
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 246
* EL131.cbl
 12908     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 12909     MOVE '5'                    TO DC-OPTION-CODE
 12910     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12911     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 12912     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 12913     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 12914     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 12915     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 12916     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12917     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 12918     MOVE '4'                    TO CP-REM-TERM-METHOD
 12919     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 12920     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12921     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 12922
 12923     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 12924     IF CM-LF-PREMIUM-RATE NUMERIC
 12925         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 12926     ELSE
 12927         MOVE ZEROS              TO LCVRATEO.
 12928
 12929     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 12930         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 12931
 12932     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 12933
 12934     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 12935
 12936     IF CM-LF-CURRENT-STATUS = '8'
 12937        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 12938            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 12939            MOVE ' '             TO DC-OPTION-CODE
 12940            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12941            IF NOT DATE-CONVERSION-ERROR
 12942                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 12943
 12944     IF CM-LF-CURRENT-STATUS = '7'
 12945        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 12946            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 12947            MOVE ' '             TO DC-OPTION-CODE
 12948            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12949            IF NOT DATE-CONVERSION-ERROR
 12950                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 12951
 12952     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 12953         MOVE ' '                TO DC-OPTION-CODE
 12954         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 12955         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12956         IF NOT DATE-CONVERSION-ERROR
 12957             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 12958             MOVE HOLD-MONTH     TO WORK-MONTH
 12959             MOVE HOLD-YEAR      TO WORK-YEAR
 12960             MOVE WORK-DATE-MY   TO LCVEXITO.
 12961
 12962     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 12963        IF CP-REMAINING-TERM-3 = ZEROS
 12964           MOVE 'EXPIRED'        TO LCVSTATO
 12965        ELSE
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 247
* EL131.cbl
 12966           MOVE 'ACTIVE'         TO LCVSTATO.
 12967
 12968     IF CM-LF-CURRENT-STATUS = '2'
 12969        MOVE 'PEND   '           TO LCVSTATO.
 12970     IF CM-LF-CURRENT-STATUS = '3'
 12971        MOVE 'RESTORE'           TO LCVSTATO.
 12972     IF CM-LF-CURRENT-STATUS = '5'
 12973        MOVE 'REISSUE'           TO LCVSTATO.
 12974     IF CM-LF-CURRENT-STATUS = '6'
 12975        MOVE 'LMP DIS'           TO LCVSTATO.
 12976     IF CM-LF-CURRENT-STATUS = '7'
 12977        MOVE 'DEATH  '           TO LCVSTATO.
 12978     IF CM-LF-CURRENT-STATUS = '8'
 12979        MOVE 'CANCEL '           TO LCVSTATO.
 12980     IF CM-LF-CURRENT-STATUS = '9'
 12981        MOVE 'RE-ONLY'           TO LCVSTATO.
 12982     IF CM-LF-CURRENT-STATUS = 'V'
 12983        MOVE 'VOID   '           TO LCVSTATO.
 12984     IF CM-LF-CURRENT-STATUS = 'D'
 12985        MOVE 'DECLINE'           TO LCVSTATO.
 12986
 12987     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 12988     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 12989     MOVE '4'                    TO BEN-REC-TYPE.
 12990     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 12991     MOVE ZERO                   TO BEN-SEQ-NO.
 12992
 12993
 12994* EXEC CICS READ GTEQ
 12995*         DATASET  (CNTL-FILE-ID)
 12996*         RIDFLD   (BENEFIT-KEY)
 12997*         SET      (ADDRESS OF CONTROL-FILE)
 12998*    END-EXEC.
 12999*    MOVE '&"S        G          (   #00011021' TO DFHEIV0
 13000     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13001     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13002     MOVE X'2020233030303131303231' TO DFHEIV0(25:11)
 13003     CALL 'kxdfhei1' USING DFHEIV0,
 13004           CNTL-FILE-ID,
 13005           DFHEIV20,
 13006           DFHEIV99,
 13007           BENEFIT-KEY,
 13008           DFHEIV99,
 13009           DFHEIV99,
 13010           DFHEIV99
 13011     SET ADDRESS OF CONTROL-FILE TO
 13012         DFHEIV20
 13013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13014
 13015
 13016     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 13017        CF-RECORD-TYPE NOT = '4'
 13018         MOVE ER-0240            TO EMI-ERROR
 13019         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13020         GO TO 5030-MOVE-CERT-FINISH.
 13021
 13022     MOVE ZERO                   TO COUNT-2.
 13023     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 248
* EL131.cbl
 13024
 13025     IF SCREEN-ERROR
 13026         MOVE ER-0282            TO EMI-ERROR
 13027         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13028        ELSE
 13029         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 13030
 13031 5030-MOVE-CERT-AH.
 13032
 13033     IF CM-LF-BENEFIT-CD = '00'
 13034         IF CM-AH-BENEFIT-CD = '00'
 13035             GO TO 5030-MOVE-CERT-FINISH.
 13036
 13037     IF CM-AH-BENEFIT-CD = '00'
 13038        MOVE SPACES             TO ACVKINDO
 13039        COMPUTE PI-PAYMENT-AMT =
 13040                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 13041        GO TO 5030-MOVE-CERT-FINISH.
 13042
 13043     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 13044     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 13045     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 13046     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 13047     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 13048     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13049     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13050     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 13051
 13052**DMD **********************************************
 13053     IF PI-COMPANY-ID = 'DMD'
 13054         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 13055                                   CM-PMT-EXTENSION-DAYS
 13056         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 13057                                      CL-NO-OF-DAYS-PAID
 13058         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 13059             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 13060         MOVE WS-REM-MOS         TO ACVRTRMO
 13061                                    CP-REMAINING-TERM-3
 13062         MOVE WS-REM-DAYS        TO DAYSPO
 13063         GO TO 5030-SKIP-RTRM.
 13064**DMD **********************************************
 13065
 13066     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13067     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13068     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 13069     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 13070
 13071 5030-SKIP-RTRM.
 13072     IF CM-AH-PREMIUM-RATE NUMERIC
 13073         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 13074     ELSE
 13075         MOVE ZEROS              TO ACVRATEO.
 13076
 13077     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 13078     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 13079
 13080     IF CM-AH-CURRENT-STATUS = '8'
 13081        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 249
* EL131.cbl
 13082            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 13083            MOVE ' '             TO DC-OPTION-CODE
 13084            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13085            IF NOT DATE-CONVERSION-ERROR
 13086                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 13087
 13088     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 13089        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 13090            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 13091            MOVE ' '             TO DC-OPTION-CODE
 13092            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13093            IF NOT DATE-CONVERSION-ERROR
 13094                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 13095
 13096     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 13097        IF CP-REMAINING-TERM-3 = ZEROS
 13098           MOVE 'EXPIRED'        TO ACVSTATO
 13099        ELSE
 13100           MOVE 'ACTIVE'         TO ACVSTATO.
 13101
 13102     IF CM-AH-CURRENT-STATUS = '2'
 13103        MOVE 'PEND   '           TO ACVSTATO.
 13104     IF CM-AH-CURRENT-STATUS = '3'
 13105        MOVE 'RESTORE'           TO ACVSTATO.
 13106     IF CM-AH-CURRENT-STATUS = '5'
 13107        MOVE 'REISSUE'           TO ACVSTATO.
 13108     IF CM-AH-CURRENT-STATUS = '6'
 13109        MOVE 'LMP DIS'           TO ACVSTATO.
 13110     IF CM-AH-CURRENT-STATUS = '7'
 13111        MOVE 'DEATH  '           TO ACVSTATO.
 13112     IF CM-AH-CURRENT-STATUS = '8'
 13113        MOVE 'CANCEL '           TO ACVSTATO.
 13114     IF CM-AH-CURRENT-STATUS = '9'
 13115        MOVE 'RE-ONLY'           TO ACVSTATO.
 13116     IF CM-AH-CURRENT-STATUS = 'V'
 13117        MOVE 'VOID   '           TO ACVSTATO.
 13118     IF CM-AH-CURRENT-STATUS = '9'
 13119        MOVE 'DECLINE'           TO ACVSTATO.
 13120
 13121     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 13122         MOVE ' '                TO DC-OPTION-CODE
 13123         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 13124         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13125         IF NOT DATE-CONVERSION-ERROR
 13126             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 13127             MOVE HOLD-MONTH     TO WORK-MONTH
 13128             MOVE HOLD-YEAR      TO WORK-YEAR
 13129             MOVE WORK-DATE-MY   TO ACVEXITO.
 13130
 13131     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 13132
 13133     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 13134     MOVE '5'                    TO BEN-REC-TYPE.
 13135     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 13136     MOVE ZERO                   TO BEN-SEQ-NO.
 13137
 13138
 13139* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 250
* EL131.cbl
 13140*         DATASET  (CNTL-FILE-ID)
 13141*         RIDFLD   (BENEFIT-KEY)
 13142*         SET      (ADDRESS OF CONTROL-FILE)
 13143*    END-EXEC.
 13144*    MOVE '&"S        G          (   #00011149' TO DFHEIV0
 13145     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13146     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13147     MOVE X'2020233030303131313439' TO DFHEIV0(25:11)
 13148     CALL 'kxdfhei1' USING DFHEIV0,
 13149           CNTL-FILE-ID,
 13150           DFHEIV20,
 13151           DFHEIV99,
 13152           BENEFIT-KEY,
 13153           DFHEIV99,
 13154           DFHEIV99,
 13155           DFHEIV99
 13156     SET ADDRESS OF CONTROL-FILE TO
 13157         DFHEIV20
 13158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13159
 13160
 13161     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 13162        CF-RECORD-TYPE NOT = '5'
 13163         MOVE ER-0250            TO EMI-ERROR
 13164         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13165         GO TO 5030-MOVE-CERT-FINISH.
 13166
 13167     MOVE ZERO                   TO COUNT-2.
 13168     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 13169
 13170     IF SCREEN-ERROR
 13171         MOVE ER-0283            TO EMI-ERROR
 13172         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13173       ELSE
 13174         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 13175
 13176 5030-MOVE-CERT-FINISH.
 13177
 13178     MOVE CM-LOAN-APR            TO APRO.
 13179     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 13180     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 13181     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 13182     MOVE CM-LOAN-NUMBER         TO LOANNOO
 13183     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 13184     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 13185
 13186     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 13187         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 13188         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13189         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13190         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 13191     ELSE
 13192         MOVE SPACES               TO ADDONDTO.
 13193
 13194     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 13195
 13196 5030-EXIT.
 13197     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 251
* EL131.cbl
 13199 5040-FIND-BENEFIT.
 13200     ADD 1                       TO COUNT-2.
 13201     IF COUNT-2 GREATER THAN 8
 13202         GO TO 5050-BENEFIT-NOTFND.
 13203
 13204     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 13205         GO TO 5060-EXIT.
 13206
 13207     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 13208         GO TO 5050-BENEFIT-NOTFND.
 13209
 13210     GO TO 5040-FIND-BENEFIT.
 13211
 13212 5050-BENEFIT-NOTFND.
 13213     MOVE 'X'                    TO ERROR-SWITCH.
 13214
 13215 5060-EXIT.
 13216     EXIT.
 13217
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 252
* EL131.cbl
 13219 6000-CALCULATE-CERT-TERM.
 13220
 13221     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 13222         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 13223     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 13224         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 13225     IF CM-LOAN-APR NOT NUMERIC
 13226         MOVE ZEROS              TO CM-LOAN-APR.
 13227
 13228*    IF WS-CALC-METHOD  = 'G'
 13229         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 13230*     ELSE
 13231*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 13232
 13233     IF N GREATER 120
 13234         MOVE 120                TO N.
 13235
 13236     MOVE '6'                    TO DC-OPTION-CODE.
 13237     MOVE N                      TO DC-ELAPSED-MONTHS.
 13238     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13239     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 13240
 13241     IF CM-LF-BENEFIT-CD NOT = ZERO
 13242         MOVE N                  TO CM-LF-ORIG-TERM
 13243         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 13244         IF NO-CONVERSION-ERROR
 13245             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 13246
 13247     IF CM-AH-BENEFIT-CD NOT = ZERO
 13248         MOVE N                  TO CM-AH-ORIG-TERM
 13249         IF NO-CONVERSION-ERROR
 13250             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 13251
 13252 6000-EXIT.
 13253      EXIT.
 13254
 13255 6100-CALC-GROSS-TERM.
 13256     MOVE CM-LOAN-BALANCE         TO L.
 13257     MOVE PI-PAYMENT-AMT          TO M.
 13258
 13259     COMPUTE N = L / M.
 13260     IF N LESS 1
 13261         MOVE 1  TO N.
 13262
 13263     IF CM-LF-BENEFIT-CD NOT = ZERO
 13264         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 13265     ELSE
 13266         MOVE ZEROS               TO WS-LF-RATE.
 13267
 13268     IF CM-AH-BENEFIT-CD NOT = ZERO
 13269         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 13270     ELSE
 13271         MOVE ZEROS               TO WS-AH-RATE.
 13272
 13273     COMPUTE I = CM-LOAN-APR / +1200.
 13274
 13275 6105-LOOP.
 13276     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 253
* EL131.cbl
 13277         GO TO 6200-EXIT.
 13278     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 13279     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 13280         ADD 1 TO N
 13281         GO TO 6105-LOOP.
 13282
 13283 6200-EXIT.
 13284      EXIT.
 13285
 13286 6210-CALC-LEFT-RIGHTONE.
 13287      MOVE L         TO LEFT-TOT-1.
 13288      SUBTRACT 1 FROM N.
 13289      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 13290      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 13291      ADD 1 TO N.
 13292 6211-CALC-TERM1.
 13293      MOVE N         TO TERM1.
 13294      MULTIPLY M BY TERM1.
 13295 6212-LOOP.
 13296      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 13297      ADD 1 TO A-N.
 13298      MULTIPLY A-N BY TERM1.
 13299      SUBTRACT 1 FROM A-N.
 13300      ADD TERM1 TO LEFT-TOT-1.
 13301 6213-CALC-TERM2.
 13302      MOVE M         TO TERM2.
 13303      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 13304      MULTIPLY IA-N BY TERM2.
 13305      SUBTRACT TERM2 FROM LEFT-TOT-1.
 13306 6215-CALC-RIGHTONE.
 13307      MOVE M         TO RIGHT-TOT-1.
 13308      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 13309      MULTIPLY A-N BY RIGHT-TOT-1.
 13310 6220-EXIT.
 13311      EXIT.
 13312
 13313 6300-CALC-A-N.
 13314     IF N LESS 1
 13315         MOVE 0     TO A-N
 13316         GO TO 6300-EXIT.
 13317     IF I = 0
 13318         MOVE .00001 TO I.
 13319     ADD 1 TO I.
 13320     DIVIDE I INTO 1 GIVING V.
 13321     SUBTRACT 1 FROM I.
 13322     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 13323     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 13324     DIVIDE I INTO TERM3 GIVING A-N.
 13325 6300-EXIT.
 13326      EXIT.
 13327
 13328 6350-CALC-IA-N.
 13329     IF N LESS 1
 13330         MOVE 0      TO IA-N
 13331         GO TO 6400-EXIT.
 13332     ADD 1 TO N.
 13333     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 13334     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 254
* EL131.cbl
 13335     MULTIPLY N BY V-EX-N GIVING TERM3.
 13336     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 13337     SUBTRACT V FROM 1 GIVING TERM4.
 13338     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 13339 6400-EXIT.
 13340      EXIT.
 13341
 13342 6450-CALC-V-EX-N.
 13343     IF N LESS 1
 13344         MOVE 1    TO V-EX-N
 13345         GO TO 6490-EXIT.
 13346     MOVE N        TO NV-STORE.
 13347     IF V-EX-ONETIME = 1  OR
 13348        V NOT = V-EXPONENT (1)
 13349          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 13350 6460-LOOP.
 13351     IF N GREATER 248
 13352         MOVE 248 TO N.
 13353     IF N = 1
 13354         MOVE V               TO V-EX-N
 13355      ELSE
 13356         MOVE V-EXPONENT (N)  TO V-EX-N.
 13357     GO TO 6490-EXIT.
 13358
 13359 6470-BUILD-V-EX-TABLE.
 13360     MOVE 2      TO N.
 13361     MOVE V      TO V-EXPONENT (1)
 13362                    V-EX-N.
 13363 6471-LOOP.
 13364     MULTIPLY V BY V-EX-N.
 13365     MOVE V-EX-N   TO V-EXPONENT (N).
 13366     ADD 1 TO N.
 13367     IF N LESS 248
 13368         GO TO 6471-LOOP.
 13369     MOVE NV-STORE     TO N.
 13370     MOVE 0            TO V-EX-ONETIME.
 13371 6480-EXIT.
 13372      EXIT.
 13373
 13374 6490-EXIT.
 13375      EXIT.
 13376
 13377 6500-CALC-NET-TERM.
 13378     MOVE CM-LOAN-BALANCE         TO L.
 13379     MOVE PI-PAYMENT-AMT          TO M.
 13380
 13381     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 13382     IF WS-REMAIN GREATER ZERO
 13383         ADD 1 TO N.
 13384     IF N = 0
 13385         MOVE 1 TO N.
 13386
 13387 6700-EXIT.
 13388      EXIT.
 13389
 13390 6999-CALC-TERM-EXIT.
 13391     EXIT.
 13392
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 255
* EL131.cbl
 13394 7000-RESET-ATTRIBUTE.
 13395
 13396     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 13397                                    CERTSTA   CERTCARA
 13398                                    CERTGRPA.
 13399     MOVE -1                     TO CERTCARL.
 13400
 13401 7000-EXIT.
 13402     EXIT.
 13403
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 256
* EL131.cbl
 13405 7600-BROWSE-CLAIM.
 13406
 13407
 13408* EXEC CICS READ
 13409*        DATASET(CLMS-FILE-ID)
 13410*        SET    (ADDRESS OF CLAIM-MASTER)
 13411*        RIDFLD (MSTR-KEY)
 13412*        GENERIC
 13413*        EQUAL
 13414*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 13415*    END-EXEC.
 13416*    MOVE '&"S  KG    E          (   #00011401' TO DFHEIV0
 13417     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 13418     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13419     MOVE X'2020233030303131343031' TO DFHEIV0(25:11)
 13420     CALL 'kxdfhei1' USING DFHEIV0,
 13421           CLMS-FILE-ID,
 13422           DFHEIV20,
 13423           DFHEIV99,
 13424           MSTR-KEY,
 13425           ELMSTR-GENERIC-LENGTH,
 13426           DFHEIV99,
 13427           DFHEIV99
 13428     SET ADDRESS OF CLAIM-MASTER TO
 13429         DFHEIV20
 13430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13431
 13432
 13433     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 13434
 13435     if cl-assoc-cert-total = 0
 13436        move 1 to cl-assoc-cert-total
 13437     end-if
 13438     IF CL-ASSOC-CERT-SEQU = 0
 13439        MOVE 1 TO CL-ASSOC-CERT-SEQU
 13440     END-IF
 13441
 13442     IF CL-ASSOC-CERT-TOTAL = 1
 13443         MOVE AL-SADOF           TO BCERT1A
 13444                                    BSUFX1A
 13445                                    BCERT2A
 13446                                    BSUFX2A
 13447                                    BCERT3A
 13448                                    BSUFX3A
 13449                                    BCERT4A
 13450                                    BSUFX4A
 13451                                    BCERT5A
 13452                                    BSUFX5A
 13453                                    PCERTNOA
 13454                                    PSUFXA
 13455                                    LABEL1A
 13456                                    LABEL2A
 13457         GO TO 7699-EXIT.
 13458
 13459 7610-BROWSE-CLAIM-LOOP.
 13460
 13461     MOVE LOW-VALUES             TO BCERT1O
 13462                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 257
* EL131.cbl
 13463                                    BCERT2O
 13464                                    BSUFX2O
 13465                                    BCERT3O
 13466                                    BSUFX3O
 13467                                    BCERT4O
 13468                                    BSUFX4O
 13469                                    BCERT5O
 13470                                    BSUFX5O.
 13471
 13472
 13473* EXEC CICS HANDLE CONDITION
 13474*        ENDFILE  (7630-END-BROWSE)
 13475*    END-EXEC.
 13476*    MOVE '"$''                   ! B #00011449' TO DFHEIV0
 13477     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 13478     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13479     MOVE X'4220233030303131343439' TO DFHEIV0(25:11)
 13480     CALL 'kxdfhei1' USING DFHEIV0
 13481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13482
 13483
 13484
 13485* EXEC CICS STARTBR
 13486*        DATASET    (CLMS-FILE-ID)
 13487*        RIDFLD     (MSTR-KEY)
 13488*    END-EXEC.
 13489     MOVE 0
 13490       TO DFHEIV11
 13491*    MOVE '&,         G          &   #00011453' TO DFHEIV0
 13492     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13493     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13494     MOVE X'2020233030303131343533' TO DFHEIV0(25:11)
 13495     CALL 'kxdfhei1' USING DFHEIV0,
 13496           CLMS-FILE-ID,
 13497           MSTR-KEY,
 13498           DFHEIV99,
 13499           DFHEIV11,
 13500           DFHEIV99
 13501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13502
 13503
 13504     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 13505
 13506 7620-READ-CLAIM-LOOP.
 13507
 13508
 13509* EXEC CICS READNEXT
 13510*        DATASET   (CLMS-FILE-ID)
 13511*        SET       (ADDRESS OF CLAIM-MASTER)
 13512*        RIDFLD    (MSTR-KEY)
 13513*    END-EXEC.
 13514     MOVE 0
 13515       TO DFHEIV11
 13516*    MOVE '&.S                   )   #00011462' TO DFHEIV0
 13517     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13518     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13519     MOVE X'2020233030303131343632' TO DFHEIV0(25:11)
 13520     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 258
* EL131.cbl
 13521           CLMS-FILE-ID,
 13522           DFHEIV20,
 13523           DFHEIV99,
 13524           MSTR-KEY,
 13525           DFHEIV99,
 13526           DFHEIV11,
 13527           DFHEIV99,
 13528           DFHEIV99
 13529     SET ADDRESS OF CLAIM-MASTER TO
 13530         DFHEIV20
 13531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13532
 13533
 13534     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 13535        CL-CARRIER     NOT = CARRI           OR
 13536        CL-CLAIM-NO    NOT = CLAIMI
 13537        GO TO 7630-END-BROWSE.
 13538
 13539     IF WS-ASSOCIATED-CERTS = 1
 13540         MOVE CL-CERT-PRIME      TO BCERT1O
 13541         MOVE CL-CERT-SFX        TO BSUFX1O.
 13542
 13543     IF WS-ASSOCIATED-CERTS = 2
 13544         MOVE CL-CERT-PRIME      TO BCERT2O
 13545         MOVE CL-CERT-SFX        TO BSUFX2O.
 13546
 13547     IF WS-ASSOCIATED-CERTS = 3
 13548         MOVE CL-CERT-PRIME      TO BCERT3O
 13549         MOVE CL-CERT-SFX        TO BSUFX3O.
 13550
 13551     IF WS-ASSOCIATED-CERTS = 4
 13552         MOVE CL-CERT-PRIME      TO BCERT4O
 13553         MOVE CL-CERT-SFX        TO BSUFX4O.
 13554
 13555     IF WS-ASSOCIATED-CERTS = 5
 13556         MOVE CL-CERT-PRIME      TO BCERT5O
 13557         MOVE CL-CERT-SFX        TO BSUFX5O
 13558     ELSE
 13559         ADD +1                  TO WS-ASSOCIATED-CERTS
 13560         GO TO 7620-READ-CLAIM-LOOP.
 13561
 13562 7630-END-BROWSE.
 13563
 13564
 13565* EXEC CICS ENDBR
 13566*        DATASET   (CLMS-FILE-ID)
 13567*    END-EXEC.
 13568     MOVE 0
 13569       TO DFHEIV11
 13570*    MOVE '&2                    $   #00011498' TO DFHEIV0
 13571     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13572     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13573     MOVE X'2020233030303131343938' TO DFHEIV0(25:11)
 13574     CALL 'kxdfhei1' USING DFHEIV0,
 13575           CLMS-FILE-ID,
 13576           DFHEIV11,
 13577           DFHEIV99
 13578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 259
* EL131.cbl
 13579
 13580
 13581 7640-HIGHLIGHT-CERT-DISPLAYED.
 13582
 13583     MOVE AL-SANON               TO BCERT1A
 13584                                    BSUFX1A
 13585                                    BCERT2A
 13586                                    BSUFX2A
 13587                                    BCERT3A
 13588                                    BSUFX3A
 13589                                    BCERT4A
 13590                                    BSUFX4A
 13591                                    BCERT5A
 13592                                    BSUFX5A.
 13593
 13594     IF BCERT1O = CERTI AND
 13595        BSUFX1O = SUFXI
 13596            MOVE AL-SABON        TO BCERT1A
 13597                                    BSUFX1A.
 13598
 13599     IF BCERT2O = CERTI AND
 13600        BSUFX2O = SUFXI
 13601            MOVE AL-SABON        TO BCERT2A
 13602                                    BSUFX2A.
 13603
 13604     IF BCERT3O = CERTI AND
 13605        BSUFX3O = SUFXI
 13606            MOVE AL-SABON        TO BCERT3A
 13607                                    BSUFX3A.
 13608
 13609     IF BCERT4O = CERTI AND
 13610        BSUFX4O = SUFXI
 13611            MOVE AL-SABON        TO BCERT4A
 13612                                    BSUFX4A.
 13613
 13614     IF BCERT5O = CERTI AND
 13615        BSUFX5O = SUFXI
 13616            MOVE AL-SABON        TO BCERT5A
 13617                                    BSUFX5A.
 13618
 13619 7699-EXIT.
 13620     EXIT.
 13621
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 260
* EL131.cbl
 13623 7700-CHECK-SEQUENCE.
 13624
 13625
 13626* EXEC CICS HANDLE CONDITION
 13627*        ENDFILE  (7799-EXIT)
 13628*        NOTFND   (7799-EXIT)
 13629*    END-EXEC.
 13630*    MOVE '"$''I                  ! C #00011546' TO DFHEIV0
 13631     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 13632     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13633     MOVE X'4320233030303131353436' TO DFHEIV0(25:11)
 13634     CALL 'kxdfhei1' USING DFHEIV0
 13635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13636
 13637
 13638
 13639* EXEC CICS READ
 13640*        DATASET(CLMS-FILE-ID)
 13641*        SET    (ADDRESS OF CLAIM-MASTER)
 13642*        RIDFLD (MSTR-KEY)
 13643*        GENERIC
 13644*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 13645*    END-EXEC.
 13646*    MOVE '&"S  KG    E          (   #00011551' TO DFHEIV0
 13647     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 13648     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13649     MOVE X'2020233030303131353531' TO DFHEIV0(25:11)
 13650     CALL 'kxdfhei1' USING DFHEIV0,
 13651           CLMS-FILE-ID,
 13652           DFHEIV20,
 13653           DFHEIV99,
 13654           MSTR-KEY,
 13655           ELMSTR-GENERIC-LENGTH,
 13656           DFHEIV99,
 13657           DFHEIV99
 13658     SET ADDRESS OF CLAIM-MASTER TO
 13659         DFHEIV20
 13660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13661
 13662
 13663     COMPUTE WS-ASSOC-CERT-TOTAL =
 13664             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 13665
 13666     GO TO 7799-EXIT.
 13667
 13668 7710-RESEQUENCE-CLAIMS.
 13669
 13670
 13671* EXEC CICS HANDLE CONDITION
 13672*        ENDFILE  (7799-EXIT)
 13673*    END-EXEC.
 13674*    MOVE '"$''                   ! D #00011566' TO DFHEIV0
 13675     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 13676     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13677     MOVE X'4420233030303131353636' TO DFHEIV0(25:11)
 13678     CALL 'kxdfhei1' USING DFHEIV0
 13679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13680
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 261
* EL131.cbl
 13681
 13682
 13683* EXEC CICS STARTBR
 13684*        DATASET(CLMS-FILE-ID)
 13685*        RIDFLD (MSTR-KEY)
 13686*    END-EXEC.
 13687     MOVE 0
 13688       TO DFHEIV11
 13689*    MOVE '&,         G          &   #00011570' TO DFHEIV0
 13690     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13691     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13692     MOVE X'2020233030303131353730' TO DFHEIV0(25:11)
 13693     CALL 'kxdfhei1' USING DFHEIV0,
 13694           CLMS-FILE-ID,
 13695           MSTR-KEY,
 13696           DFHEIV99,
 13697           DFHEIV11,
 13698           DFHEIV99
 13699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13700
 13701
 13702     COMPUTE WS-ASSOC-CERT-SEQU =
 13703             WS-ASSOC-CERT-SEQU + 1.
 13704
 13705     COMPUTE WS-READNEXT-SWITCH =
 13706             WS-READNEXT-SWITCH + 1.
 13707
 13708 7720-READ-CLAIM-LOOP.
 13709
 13710
 13711* EXEC CICS READNEXT
 13712*        DATASET(CLMS-FILE-ID)
 13713*        SET    (ADDRESS OF CLAIM-MASTER)
 13714*        RIDFLD (MSTR-KEY)
 13715*    END-EXEC.
 13716     MOVE 0
 13717       TO DFHEIV11
 13718*    MOVE '&.S                   )   #00011583' TO DFHEIV0
 13719     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13720     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13721     MOVE X'2020233030303131353833' TO DFHEIV0(25:11)
 13722     CALL 'kxdfhei1' USING DFHEIV0,
 13723           CLMS-FILE-ID,
 13724           DFHEIV20,
 13725           DFHEIV99,
 13726           MSTR-KEY,
 13727           DFHEIV99,
 13728           DFHEIV11,
 13729           DFHEIV99,
 13730           DFHEIV99
 13731     SET ADDRESS OF CLAIM-MASTER TO
 13732         DFHEIV20
 13733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13734
 13735
 13736     IF WS-READNEXT-SWITCH = 1
 13737         ADD 1                   TO WS-READNEXT-SWITCH
 13738         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 262
* EL131.cbl
 13739
 13740 7730-END-BROWSE.
 13741
 13742
 13743* EXEC CICS ENDBR
 13744*        DATASET(CLMS-FILE-ID)
 13745*    END-EXEC.
 13746     MOVE 0
 13747       TO DFHEIV11
 13748*    MOVE '&2                    $   #00011595' TO DFHEIV0
 13749     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13750     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13751     MOVE X'2020233030303131353935' TO DFHEIV0(25:11)
 13752     CALL 'kxdfhei1' USING DFHEIV0,
 13753           CLMS-FILE-ID,
 13754           DFHEIV11,
 13755           DFHEIV99
 13756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13757
 13758
 13759 7740-READ-CLAIM-UPDATE.
 13760
 13761     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 13762        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 13763        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 13764        GO TO 7799-EXIT
 13765     ELSE
 13766        MOVE ZERO                TO WS-READNEXT-SWITCH.
 13767
 13768
 13769* EXEC CICS READ
 13770*        DATASET(CLMS-FILE-ID)
 13771*        SET    (ADDRESS OF CLAIM-MASTER)
 13772*        RIDFLD (MSTR-KEY)
 13773*        UPDATE
 13774*    END-EXEC.
 13775*    MOVE '&"S        EU         (   #00011608' TO DFHEIV0
 13776     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13777     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13778     MOVE X'2020233030303131363038' TO DFHEIV0(25:11)
 13779     CALL 'kxdfhei1' USING DFHEIV0,
 13780           CLMS-FILE-ID,
 13781           DFHEIV20,
 13782           DFHEIV99,
 13783           MSTR-KEY,
 13784           DFHEIV99,
 13785           DFHEIV99,
 13786           DFHEIV99
 13787     SET ADDRESS OF CLAIM-MASTER TO
 13788         DFHEIV20
 13789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13790
 13791
 13792     if (cl-priority-cd = '8')
 13793        and (pi-processor-id not = 'PEMA' and 'JMS '
 13794             AND 'AMWA')
 13795        MOVE ER-8003             TO EMI-ERROR
 13796        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 263
* EL131.cbl
 13797                                 THRU 9900-EXIT
 13798        MOVE -1                  TO MAINTL
 13799        GO TO 8110-SEND-DATA
 13800     end-if
 13801
 13802     IF PI-COMPANY-ID = 'CID' or 'AHL'
 13803         MOVE 'Y'                TO CL-YESNOSW
 13804     END-IF.
 13805
 13806     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 13807     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 13808
 13809
 13810* EXEC CICS REWRITE
 13811*         DATASET(CLMS-FILE-ID)
 13812*         FROM   (CLAIM-MASTER)
 13813*    END-EXEC.
 13814     MOVE LENGTH OF
 13815      CLAIM-MASTER
 13816       TO DFHEIV11
 13817*    MOVE '&& L                  %   #00011632' TO DFHEIV0
 13818     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13819     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13820     MOVE X'2020233030303131363332' TO DFHEIV0(25:11)
 13821     CALL 'kxdfhei1' USING DFHEIV0,
 13822           CLMS-FILE-ID,
 13823           CLAIM-MASTER,
 13824           DFHEIV11,
 13825           DFHEIV99
 13826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13827
 13828
 13829     GO TO 7710-RESEQUENCE-CLAIMS.
 13830
 13831 7799-EXIT.
 13832     EXIT.
 13833
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 264
* EL131.cbl
 13835 7800-CHECK-AUTO-ACTIVITY.
 13836
 13837
 13838* EXEC CICS HANDLE CONDITION
 13839*        NOTFND   (7800-NOT-FOUND)
 13840*    END-EXEC.
 13841*    MOVE '"$I                   ! E #00011645' TO DFHEIV0
 13842     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13844     MOVE X'4520233030303131363435' TO DFHEIV0(25:11)
 13845     CALL 'kxdfhei1' USING DFHEIV0
 13846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13847
 13848
 13849     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 13850     MOVE 'T'                        TO  CNTL-REC-TYPE.
 13851     MOVE SPACES                     TO  CNTL-PROC-ID.
 13852     MOVE +0                         TO  CNTL-SEQ-NO.
 13853
 13854
 13855* EXEC CICS READ
 13856*        DATASET   (CNTL-FILE-ID)
 13857*        RIDFLD    (CNTL-KEY)
 13858*        SET       (ADDRESS OF CONTROL-FILE)
 13859*    END-EXEC.
 13860*    MOVE '&"S        E          (   #00011654' TO DFHEIV0
 13861     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13862     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13863     MOVE X'2020233030303131363534' TO DFHEIV0(25:11)
 13864     CALL 'kxdfhei1' USING DFHEIV0,
 13865           CNTL-FILE-ID,
 13866           DFHEIV20,
 13867           DFHEIV99,
 13868           CNTL-KEY,
 13869           DFHEIV99,
 13870           DFHEIV99,
 13871           DFHEIV99
 13872     SET ADDRESS OF CONTROL-FILE TO
 13873         DFHEIV20
 13874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13875
 13876
 13877     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 13878         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 13879
 13880     IF CL-ACTIVITY-CODE NOT = ZEROS
 13881         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 13882         IF MISC-SUB IS GREATER THAN +9
 13883             SUBTRACT +9 FROM MISC-SUB
 13884             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 13885         ELSE
 13886             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 13887     ELSE
 13888         MOVE 'Y'                              TO  WS-RESET-SW.
 13889
 13890     IF STATUSI = 'C' OR 'CLOSED'
 13891         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 13892             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 265
* EL131.cbl
 13893                                         PI-LETTER-SW
 13894             GO TO 7800-EXIT.
 13895
 13896     IF STATUSI = 'C' OR 'CLOSED'
 13897         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 13898             MOVE 'N'                TO  PI-LETTER-SW
 13899         ELSE
 13900             MOVE 'Y'                TO  PI-LETTER-SW.
 13901
 13902     IF STATUSI = 'O' OR 'OPEN'
 13903         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 13904             MOVE 'N'                TO  PI-REC-FOUND-SW
 13905                                         PI-LETTER-SW
 13906             GO TO 7800-EXIT.
 13907
 13908     IF STATUSI = 'O' OR 'OPEN'
 13909         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 13910             MOVE 'N'                TO  PI-LETTER-SW
 13911         ELSE
 13912             MOVE 'Y'                TO  PI-LETTER-SW.
 13913
 13914     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 13915     GO TO 7800-EXIT.
 13916
 13917 7800-NOT-FOUND.
 13918
 13919     MOVE 'N'                        TO  PI-REC-FOUND-SW
 13920                                         PI-LETTER-SW.
 13921
 13922 7800-EXIT.
 13923     EXIT.
 13924
 13925 7850-AUTO-LETTER-WRITER.
 13926
 13927     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 13928     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 13929
 13930     IF STATUSI = 'C' OR 'CLOSED'
 13931         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 13932     ELSE
 13933         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 13934
 13935     IF STATUSI = 'C' OR 'CLOSED'
 13936         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 13937             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13938             MOVE '6'                TO  DC-OPTION-CODE
 13939             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 13940             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13941             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13942             IF NO-CONVERSION-ERROR
 13943                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 13944             ELSE
 13945                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 13946
 13947     IF STATUSI = 'C' OR 'CLOSED'
 13948         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 13949             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13950             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 266
* EL131.cbl
 13951             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 13952             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13953             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13954             IF NO-CONVERSION-ERROR
 13955                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 13956             ELSE
 13957                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 13958
 13959     IF STATUSI = 'O' OR 'OPEN'
 13960         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 13961             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13962             MOVE '6'                TO  DC-OPTION-CODE
 13963             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 13964             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13965             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13966             IF NO-CONVERSION-ERROR
 13967                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 13968             ELSE
 13969                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 13970
 13971     IF STATUSI = 'O' OR 'OPEN'
 13972         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 13973             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13974             MOVE '6'                TO  DC-OPTION-CODE
 13975             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 13976             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13977             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13978             IF NO-CONVERSION-ERROR
 13979                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 13980             ELSE
 13981                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 13982
 13983
 13984* EXEC CICS LINK
 13985*        PROGRAM    (LINK-1523)
 13986*        COMMAREA   (W-1523-LINKDATA)
 13987*        LENGTH     (W-1523-COMM-LENGTH)
 13988*    END-EXEC.
 13989*    MOVE '."C                   (   #00011766' TO DFHEIV0
 13990     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13991     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13992     MOVE X'2020233030303131373636' TO DFHEIV0(25:11)
 13993     CALL 'kxdfhei1' USING DFHEIV0,
 13994           LINK-1523,
 13995           W-1523-LINKDATA,
 13996           W-1523-COMM-LENGTH,
 13997           DFHEIV99,
 13998           DFHEIV99,
 13999           DFHEIV99,
 14000           DFHEIV99
 14001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14002
 14003
 14004     IF W-1523-ERROR-CODE = ZEROS
 14005         GO TO 7850-EXIT.
 14006
 14007     IF W-1523-FATAL-ERROR
 14008         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 267
* EL131.cbl
 14009         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14010
 14011     IF W-1523-ERROR-CODE = 0191
 14012         MOVE ER-0803                TO  EMI-ERROR
 14013         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14014
 14015 7850-EXIT.
 14016     EXIT.
 14017
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 268
* EL131.cbl
 14019 8000-CREATE-DMO-REC.
 14020     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 14021     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 14022     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 14023
 14024
 14025* EXEC CICS HANDLE CONDITION
 14026*         NOTFND   (8000-NOTE-NOT-FOUND)
 14027*    END-EXEC.
 14028*    MOVE '"$I                   ! F #00011792' TO DFHEIV0
 14029     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14030     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14031     MOVE X'4620233030303131373932' TO DFHEIV0(25:11)
 14032     CALL 'kxdfhei1' USING DFHEIV0
 14033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14034
 14035
 14036
 14037* EXEC CICS READ
 14038*         DATASET(NOTE-FILE-ID)
 14039*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14040*         RIDFLD (NOTE-KEY)
 14041*    END-EXEC.
 14042*    MOVE '&"S        E          (   #00011796' TO DFHEIV0
 14043     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14044     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14045     MOVE X'2020233030303131373936' TO DFHEIV0(25:11)
 14046     CALL 'kxdfhei1' USING DFHEIV0,
 14047           NOTE-FILE-ID,
 14048           DFHEIV20,
 14049           DFHEIV99,
 14050           NOTE-KEY,
 14051           DFHEIV99,
 14052           DFHEIV99,
 14053           DFHEIV99
 14054     SET ADDRESS OF CERTIFICATE-NOTE TO
 14055         DFHEIV20
 14056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14057
 14058
 14059     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14060     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14061     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14062
 14063     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 14064         MOVE 'CC'               TO DCT-PRODUCT-CODE
 14065     ELSE
 14066         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14067
 14068     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14069     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14070
 14071
 14072* EXEC CICS LINK
 14073*        PROGRAM    ('DLO006')
 14074*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14075*        LENGTH     (WS-DCT-LENGTH)
 14076*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 269
* EL131.cbl
 14077     MOVE 'DLO006' TO DFHEIV1
 14078*    MOVE '."C                   (   #00011814' TO DFHEIV0
 14079     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14081     MOVE X'2020233030303131383134' TO DFHEIV0(25:11)
 14082     CALL 'kxdfhei1' USING DFHEIV0,
 14083           DFHEIV1,
 14084           DCT-COMMUNICATION-AREA,
 14085           WS-DCT-LENGTH,
 14086           DFHEIV99,
 14087           DFHEIV99,
 14088           DFHEIV99,
 14089           DFHEIV99
 14090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14091
 14092
 14093     IF  DCT-RETURN-CODE = 'OK'
 14094         GO TO 8000-CONT.
 14095
 14096     IF DCT-RETURN-CODE = '01' OR '02'
 14097         GO TO 8000-EXIT.
 14098
 14099     IF DCT-RETURN-CODE = '03'
 14100         MOVE ER-0951            TO EMI-ERROR
 14101         MOVE -1                 TO MAINTL
 14102         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14103         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14104         GO TO 8110-SEND-DATA.
 14105
 14106     IF DCT-RETURN-CODE = '04'
 14107         MOVE ER-0946            TO EMI-ERROR
 14108         MOVE -1                 TO MAINTL
 14109         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14110         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14111         GO TO 8110-SEND-DATA.
 14112
 14113     IF DCT-RETURN-CODE = '05'
 14114         MOVE ER-0947            TO EMI-ERROR
 14115         MOVE -1                 TO MAINTL
 14116         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14117         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14118         GO TO 8110-SEND-DATA.
 14119
 14120     IF DCT-RETURN-CODE = '06'
 14121         MOVE ER-0921            TO EMI-ERROR
 14122         MOVE -1                 TO MAINTL
 14123         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14124         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14125         GO TO 8110-SEND-DATA.
 14126
 14127     IF DCT-RETURN-CODE = '07'
 14128         MOVE ER-0919            TO EMI-ERROR
 14129         MOVE -1                 TO MAINTL
 14130         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14131         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14132         GO TO 8110-SEND-DATA.
 14133
 14134     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 270
* EL131.cbl
 14135         MOVE ER-0948            TO EMI-ERROR
 14136         MOVE -1                 TO MAINTL
 14137         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14138         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14139         GO TO 8110-SEND-DATA.
 14140
 14141     IF DCT-RETURN-CODE = 'N1'
 14142         MOVE ER-0950            TO EMI-ERROR
 14143         MOVE -1                 TO MAINTL
 14144         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14145         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14146         GO TO 8110-SEND-DATA.
 14147
 14148     IF DCT-RETURN-CODE = 'E1'
 14149         MOVE ER-0974            TO EMI-ERROR
 14150         MOVE -1                 TO MAINTL
 14151         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14152         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14153         GO TO 8110-SEND-DATA.
 14154
 14155     IF DCT-RETURN-CODE = 'E2'
 14156         MOVE ER-0975            TO EMI-ERROR
 14157         MOVE -1                 TO MAINTL
 14158         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14159         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14160         GO TO 8110-SEND-DATA.
 14161
 14162     IF DCT-RETURN-CODE NOT = 'OK'
 14163         MOVE ER-0949            TO EMI-ERROR
 14164         MOVE -1                 TO MAINTL
 14165         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14166         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14167         GO TO 8110-SEND-DATA.
 14168
 14169 8000-CONT.
 14170
 14171     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14172     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14173     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14174     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14175     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14176     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14177     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14178     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14179
 14180     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14181     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14182     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14183     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 14184     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14185
 14186     IF STATUSI = 'OPEN' OR 'O'
 14187         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 14188      ELSE
 14189         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 14190
 14191     IF STATUSI = 'OPEN' OR 'O'
 14192        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 271
* EL131.cbl
 14193         MOVE '1'                TO DM-CLAIM-STATUS
 14194      ELSE
 14195         MOVE '2'                TO DM-CLAIM-STATUS.
 14196
 14197     IF STATUSI = 'CLOSED' OR 'C'
 14198        IF NOT FINAL-PAID
 14199         MOVE '3'                TO DM-CLAIM-STATUS
 14200      ELSE
 14201         MOVE '4'                TO DM-CLAIM-STATUS.
 14202
 14203     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14204
 14205
 14206* EXEC CICS LINK
 14207*        PROGRAM    ('DLO025')
 14208*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14209*        LENGTH     (WS-DMO-LENGTH)
 14210*    END-EXEC.
 14211     MOVE 'DLO025' TO DFHEIV1
 14212*    MOVE '."C                   (   #00011932' TO DFHEIV0
 14213     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14214     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14215     MOVE X'2020233030303131393332' TO DFHEIV0(25:11)
 14216     CALL 'kxdfhei1' USING DFHEIV0,
 14217           DFHEIV1,
 14218           DMO-COMMUNICATION-AREA,
 14219           WS-DMO-LENGTH,
 14220           DFHEIV99,
 14221           DFHEIV99,
 14222           DFHEIV99,
 14223           DFHEIV99
 14224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14225
 14226
 14227     IF  DM-RETURN-CODE = 'OK'
 14228         GO TO 8000-EXIT.
 14229
 14230     IF DM-RETURN-CODE = '01'
 14231         MOVE ER-8051            TO EMI-ERROR
 14232         MOVE -1                 TO MAINTL
 14233         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14234         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14235         GO TO 8110-SEND-DATA.
 14236
 14237     IF DM-RETURN-CODE = '02'
 14238         MOVE ER-8052            TO EMI-ERROR
 14239         MOVE -1                 TO MAINTL
 14240         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14241         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14242         GO TO 8110-SEND-DATA.
 14243
 14244     IF DM-RETURN-CODE = '03'
 14245         MOVE ER-8053            TO EMI-ERROR
 14246         MOVE -1                 TO MAINTL
 14247         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14248         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14249         GO TO 8110-SEND-DATA.
 14250
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 272
* EL131.cbl
 14251     IF DM-RETURN-CODE = '04'
 14252         MOVE ER-8054            TO EMI-ERROR
 14253         MOVE -1                 TO MAINTL
 14254         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14255         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14256         GO TO 8110-SEND-DATA.
 14257
 14258     IF DM-RETURN-CODE = '05'
 14259         MOVE ER-8055            TO EMI-ERROR
 14260         MOVE -1                 TO MAINTL
 14261         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14262         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14263         GO TO 8110-SEND-DATA.
 14264
 14265     IF DM-RETURN-CODE = '06'
 14266         MOVE ER-8056            TO EMI-ERROR
 14267         MOVE -1                 TO MAINTL
 14268         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14269         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14270         GO TO 8110-SEND-DATA.
 14271
 14272     IF DM-RETURN-CODE = '07'
 14273         MOVE ER-8057            TO EMI-ERROR
 14274         MOVE -1                 TO MAINTL
 14275         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14276         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14277         GO TO 8110-SEND-DATA.
 14278
 14279     IF DM-RETURN-CODE = '08'
 14280         MOVE ER-8058            TO EMI-ERROR
 14281         MOVE -1                 TO MAINTL
 14282         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14283         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14284         GO TO 8110-SEND-DATA.
 14285
 14286     IF DM-RETURN-CODE = '09'
 14287         MOVE ER-8059            TO EMI-ERROR
 14288         MOVE -1                 TO MAINTL
 14289         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14290         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14291         GO TO 8110-SEND-DATA.
 14292
 14293     IF DM-RETURN-CODE = '10'
 14294         MOVE ER-8060            TO EMI-ERROR
 14295         MOVE -1                 TO MAINTL
 14296         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14297         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14298         GO TO 8110-SEND-DATA.
 14299
 14300     IF DM-RETURN-CODE = '11'
 14301         MOVE ER-8061            TO EMI-ERROR
 14302         MOVE -1                 TO MAINTL
 14303         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14304         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14305         GO TO 8110-SEND-DATA.
 14306
 14307     IF DM-RETURN-CODE = '12'
 14308         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 273
* EL131.cbl
 14309         MOVE -1                 TO MAINTL
 14310         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14311         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14312         GO TO 8110-SEND-DATA.
 14313
 14314     IF DM-RETURN-CODE = '13'
 14315         MOVE ER-8063            TO EMI-ERROR
 14316         MOVE -1                 TO MAINTL
 14317         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14318         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14319         GO TO 8110-SEND-DATA.
 14320
 14321     IF DM-RETURN-CODE = '14'
 14322         MOVE ER-8064            TO EMI-ERROR
 14323         MOVE -1                 TO MAINTL
 14324         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14325         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14326         GO TO 8110-SEND-DATA.
 14327
 14328     IF DM-RETURN-CODE = '15'
 14329         MOVE ER-8065            TO EMI-ERROR
 14330         MOVE -1                 TO MAINTL
 14331         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14332         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14333         GO TO 8110-SEND-DATA.
 14334
 14335     IF DM-RETURN-CODE = '16'
 14336         MOVE ER-8154            TO EMI-ERROR
 14337         MOVE -1                 TO MAINTL
 14338         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14339         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14340         GO TO 8110-SEND-DATA.
 14341
 14342     IF DM-RETURN-CODE = '17'
 14343         MOVE ER-8155            TO EMI-ERROR
 14344         MOVE -1                 TO MAINTL
 14345         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14346         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14347         GO TO 8110-SEND-DATA.
 14348
 14349     IF DM-RETURN-CODE = 'N1'
 14350         MOVE ER-8152            TO EMI-ERROR
 14351         MOVE -1                 TO MAINTL
 14352         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14353         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14354         GO TO 8110-SEND-DATA.
 14355
 14356     IF DM-RETURN-CODE = 'E1'
 14357         MOVE ER-8153            TO EMI-ERROR
 14358         MOVE -1                 TO MAINTL
 14359         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14360         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14361         GO TO 8110-SEND-DATA.
 14362
 14363     MOVE ER-8066                TO EMI-ERROR.
 14364     MOVE -1                     TO MAINTL.
 14365     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14366     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 274
* EL131.cbl
 14367     GO TO 8110-SEND-DATA.
 14368
 14369 8000-NOTE-NOT-FOUND.
 14370
 14371* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14372*    MOVE '6"R                   !   #00012081' TO DFHEIV0
 14373     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14375     MOVE X'2020233030303132303831' TO DFHEIV0(25:11)
 14376     CALL 'kxdfhei1' USING DFHEIV0
 14377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14378
 14379     MOVE ER-0954                TO EMI-ERROR.
 14380     MOVE -1                     TO MAINTL.
 14381     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14382     GO TO 8110-SEND-DATA.
 14383
 14384 8000-EXIT.
 14385     EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 275
* EL131.cbl
 14387 8050-FORMAT-LAST-NAME-1ST.
 14388*****************************************************************
 14389*             M O V E   N A M E   R O U T I N E                 *
 14390*                                                               *
 14391*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14392*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14393*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 14394*                                                               *
 14395*                  FIELD               VALUE                    *
 14396*                  -----               -----                    *
 14397*           W-NAME-LAST    (CL15)      SMITH                    *
 14398*           W-NAME-FIRST   (CL15)      JOHN                     *
 14399*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 14400*                                                               *
 14401*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 14402*                SMITH, JOHN ALLEN                              *
 14403*                     OR                                        *
 14404*                SMITH, JOHN A.                                 *
 14405*                                                               *
 14406*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 14407*     COPYBOOK, ELCNWA.                                         *
 14408*****************************************************************.
 14409
 14410     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 14411     MOVE ZERO                   TO WS-NAME-SW.
 14412     SET NWA-INDEX               TO +1.
 14413
 14414     IF W-NAME-LAST   = SPACES  AND
 14415        W-NAME-MIDDLE = SPACES
 14416          MOVE +1                TO WS-NAME-SW.
 14417
 14418     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14419     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 14420
 14421     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14422     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 14423
 14424     SET NWA-INDEX UP BY +1.
 14425
 14426     IF W-NAME-MIDDLE NOT = SPACES
 14427         IF W-NAME-MIDDLE-2 = SPACES
 14428             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14429             SET NWA-INDEX UP BY +1
 14430             MOVE '.'            TO WS-NW (NWA-INDEX)
 14431             SET NWA-INDEX UP BY +2
 14432         ELSE
 14433             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14434             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 14435
 14436 8050-EXIT.
 14437     EXIT.
 14438
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 276
* EL131.cbl
 14440 8060-MOVE-NAME.
 14441     IF WS-NAME-SW GREATER THAN +1
 14442         GO TO 8060-EXIT.
 14443
 14444     IF WS-NAME-WORK2 = SPACES
 14445         GO TO 8060-EXIT.
 14446
 14447     SET NWA-INDEX2            TO +1.
 14448     SET NWA-INDEX3            TO +2.
 14449
 14450 8060-MOVE-NAME-CYCLE.
 14451     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 14452
 14453     IF NWA-INDEX LESS THAN +30
 14454         SET NWA-INDEX UP BY +1
 14455     ELSE
 14456         ADD +2 TO  WS-NAME-SW
 14457         GO TO 8060-EXIT.
 14458
 14459     IF NWA-INDEX2 LESS THAN +20
 14460         SET NWA-INDEX3 UP BY +1
 14461         SET NWA-INDEX2 UP BY +1.
 14462
 14463     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 14464        WS-NW2 (NWA-INDEX3) = SPACES
 14465         IF WS-NAME-SW = ZERO
 14466             MOVE ','            TO WS-NW (NWA-INDEX)
 14467             SET NWA-INDEX UP BY +2
 14468             MOVE +1             TO WS-NAME-SW
 14469             GO TO 8060-EXIT
 14470         ELSE
 14471             GO TO 8060-EXIT.
 14472
 14473     GO TO 8060-MOVE-NAME-CYCLE.
 14474
 14475 8060-EXIT.
 14476     EXIT.
 14477
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 277
* EL131.cbl
 14479
 14480 8070-UNLOCK-CLAIM-MSTR.
 14481
 14482* EXEC CICS UNLOCK
 14483*        DATASET   (CLMS-FILE-ID)
 14484*    END-EXEC.
 14485*    MOVE '&*                    #   #00012184' TO DFHEIV0
 14486     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 14487     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14488     MOVE X'2020233030303132313834' TO DFHEIV0(25:11)
 14489     CALL 'kxdfhei1' USING DFHEIV0,
 14490           CLMS-FILE-ID,
 14491           DFHEIV99
 14492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14493
 14494
 14495 8070-EXIT.
 14496      EXIT.
 14497
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 278
* EL131.cbl
 14499 8100-SEND-MAP.
 14500     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 14501
 14502     IF NOT PI-NO-CARRIER-SECURITY
 14503        MOVE AL-SANOF            TO CERTCARA.
 14504     IF NOT PI-NO-ACCOUNT-SECURITY
 14505        MOVE AL-SANOF            TO CERTACTA.
 14506
 14507     IF PI-PROCESSOR-ID = 'LGXX'
 14508        MOVE AL-UANON            TO CCNOA.
 14509
 14510     IF PI-COMPANY-ID = 'DMD'
 14511        NEXT SENTENCE
 14512     ELSE
 14513        MOVE AL-SADOF            TO PFKEY6A.
 14514
 14515     IF PI-USES-PAID-TO
 14516        MOVE 'PAID TO  :' TO PTHRHDGO.
 14517
 14518
 14519* EXEC CICS SEND
 14520*         MAP     ('EL131A')
 14521*         MAPSET  ('EL131S')
 14522*         ERASE
 14523*         FREEKB
 14524*         CURSOR
 14525*    END-EXEC.
 14526     MOVE 'EL131A' TO DFHEIV1
 14527     MOVE -1
 14528       TO DFHEIV11
 14529     MOVE 'EL131S' TO DFHEIV2
 14530*    MOVE '8$     CT  E F  H     ,   #00012211' TO DFHEIV0
 14531     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 14532     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 14533     MOVE X'2020233030303132323131' TO DFHEIV0(25:11)
 14534     CALL 'kxdfhei1' USING DFHEIV0,
 14535           DFHEIV1,
 14536           EL131AO,
 14537           DFHEIV99,
 14538           DFHEIV2,
 14539           DFHEIV99,
 14540           DFHEIV99,
 14541           DFHEIV99,
 14542           DFHEIV11,
 14543           DFHEIV99,
 14544           DFHEIV99,
 14545           DFHEIV99
 14546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14547
 14548
 14549     GO TO 9000-RETURN-TRANS.
 14550
 14551 8110-SEND-DATA.
 14552     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 14553
 14554     IF PI-USES-PAID-TO
 14555        MOVE 'PAID TO  :' TO PTHRHDGO.
 14556
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 279
* EL131.cbl
 14557     IF PI-PROCESSOR-ID = 'LGXX'
 14558        MOVE AL-UANON            TO CCNOA.
 14559
 14560     IF PI-COMPANY-ID = 'DMD'
 14561        NEXT SENTENCE
 14562     ELSE
 14563        MOVE AL-SADOF            TO PFKEY6A.
 14564
 14565
 14566* EXEC CICS SEND
 14567*         MAP      ('EL131A')
 14568*         MAPSET   ('EL131S')
 14569*         DATAONLY
 14570*         FREEKB
 14571*         CURSOR
 14572*    END-EXEC.
 14573     MOVE 'EL131A' TO DFHEIV1
 14574     MOVE -1
 14575       TO DFHEIV11
 14576     MOVE 'EL131S' TO DFHEIV2
 14577*    MOVE '8$D    CT    F  H     ,   #00012235' TO DFHEIV0
 14578     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 14579     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 14580     MOVE X'2020233030303132323335' TO DFHEIV0(25:11)
 14581     CALL 'kxdfhei1' USING DFHEIV0,
 14582           DFHEIV1,
 14583           EL131AO,
 14584           DFHEIV99,
 14585           DFHEIV2,
 14586           DFHEIV99,
 14587           DFHEIV99,
 14588           DFHEIV99,
 14589           DFHEIV11,
 14590           DFHEIV99,
 14591           DFHEIV99,
 14592           DFHEIV99
 14593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14594
 14595
 14596     GO TO 9000-RETURN-TRANS.
 14597
 14598 8120-FORMAT-TIME-DATE.
 14599
 14600     IF SKIP-ATTRIBUTE = 'Y'
 14601        MOVE SPACES              TO SKIP-ATTRIBUTE
 14602        MOVE ER-0598             TO EMI-ERROR
 14603        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14604        GO TO 8125-SKIP-ATTRIBUTE.
 14605
 14606*     IF PI-COMPANY-ID = 'DMD'
 14607      IF PI-PROCESSOR-ID <> 'EMER'
 14608         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 14609                                    CERTCARA  CERTGRPA CERTA SUFXA
 14610
 14611     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 14612                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 14613                                    JNTINITA  JNTAGEA   APRA
 14614                                    LCVCDA    LCVOTRMA  LCVRTRMA
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 280
* EL131.cbl
 14615                                    LCVBENEA  LCVFORMA  LCVCNDTA
 14616                                    LCVEXITA  LCVSTATA  LCVKINDA
 14617                                    ACVCDA    ACVOTRMA  ACVRTRMA
 14618                                    ACVBENEA  ACVFORMA  ACVCNDTA
 14619                                    ACVEXITA  ACVSTATA  ACVKINDA
 14620                                    PMTFREQA  INDGRPA   PREMTYPA
 14621                                    REINCDA   LCVRATEA  ACVRATEA
 14622                                    ADDONDTA.
 14623
 14624*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 14625*       IF PI-COMPANY-ID = 'DMD'
 14626*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 14627*                                   SUFXA
 14628*                                   PDAMTA    NODAYSA   NOPMTSA
 14629*                                   INCA      OCCA
 14630*          IF NOT SYSTEM-MODIFY-CAP
 14631*              MOVE AL-SANOF         TO PDTHRUA.
 14632
 14633     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 14634         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 14635
 14636 8125-SKIP-ATTRIBUTE.
 14637
 14638     MOVE SAVE-DATE              TO DATEO.
 14639
 14640* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 14641*    END-EXEC
 14642*    MOVE '0"A                   "   #00012286' TO DFHEIV0
 14643     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 14644     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 14645     MOVE X'2020233030303132323836' TO DFHEIV0(25:11)
 14646     CALL 'kxdfhei1' USING DFHEIV0,
 14647           LCP-CICS-TIME
 14648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14649
 14650* EXEC CICS FORMATTIME
 14651*              ABSTIME(LCP-CICS-TIME)
 14652*              TIME(LCP-TIME-OF-DAY-XX)
 14653*    END-EXEC
 14654*    MOVE 'j$(     (             #   #00012288' TO DFHEIV0
 14655     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 14656     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14657     MOVE X'2020233030303132323838' TO DFHEIV0(25:11)
 14658     CALL 'kxdfhei1' USING DFHEIV0,
 14659           LCP-CICS-TIME,
 14660           LCP-TIME-OF-DAY-XX
 14661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14662     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 14663     MOVE UN-HOURS               TO FOR-HOURS.
 14664     MOVE UN-MINUTES             TO FOR-MINUTES.
 14665     MOVE TIME-OUT               TO TIMEO.
 14666     MOVE PI-COMPANY-ID          TO COMPO.
 14667     MOVE PI-PROCESSOR-ID        TO USERIDO.
 14668     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 14669     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 14670     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 14671
 14672 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 281
* EL131.cbl
 14673     EXIT.
 14674
 14675 8150-ENTERED-CLAIM-NOTFOUND.
 14676
 14677     MOVE ER-0204                TO EMI-ERROR.
 14678     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14679     MOVE -1                     TO MAINTL.
 14680     GO TO 8100-SEND-MAP.
 14681
 14682 8200-RETURN-PRIOR.
 14683     MOVE SPACE                  TO PI-RETURN-CD-1.
 14684     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 14685     GO TO 9200-XCTL.
 14686
 14687 8300-GET-HELP.
 14688     MOVE XCTL-EL010             TO CALL-PGM.
 14689     GO TO 9200-XCTL.
 14690
 14691 8400-RETURN-MASTER.
 14692     MOVE SPACE                  TO PI-RETURN-CD-1.
 14693     MOVE XCTL-EL126             TO CALL-PGM.
 14694     GO TO 9200-XCTL.
 14695
 14696 8500-TRLR-MNT.
 14697     IF PI-RETURN-CD-1 = 'X'
 14698         MOVE ER-0311            TO EMI-ERROR
 14699         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14700         MOVE -1                 TO MAINTL
 14701         GO TO 8110-SEND-DATA.
 14702
 14703
 14704* EXEC CICS WRITEQ TS
 14705*         QUEUE     (PI-KEY)
 14706*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14707*         LENGTH    (PI-COMM-LENGTH)
 14708*    END-EXEC.
 14709*    MOVE '*"                    ''   #00012333' TO DFHEIV0
 14710     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14711     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14712     MOVE X'2020233030303132333333' TO DFHEIV0(25:11)
 14713     CALL 'kxdfhei1' USING DFHEIV0,
 14714           PI-KEY,
 14715           PROGRAM-INTERFACE-BLOCK,
 14716           PI-COMM-LENGTH,
 14717           DFHEIV99,
 14718           DFHEIV99,
 14719           DFHEIV99
 14720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14721
 14722
 14723     MOVE XCTL-EL142             TO CALL-PGM.
 14724     GO TO 9200-XCTL.
 14725
 14726 8600-ADDR-MNT.
 14727     IF PI-RETURN-CD-1 = 'X'
 14728         MOVE ER-0311            TO EMI-ERROR
 14729         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14730         MOVE -1                 TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 282
* EL131.cbl
 14731         GO TO 8110-SEND-DATA.
 14732
 14733
 14734* EXEC CICS WRITEQ TS
 14735*         QUEUE     (PI-KEY)
 14736*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14737*         LENGTH    (PI-COMM-LENGTH)
 14738*    END-EXEC.
 14739*    MOVE '*"                    ''   #00012349' TO DFHEIV0
 14740     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14741     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14742     MOVE X'2020233030303132333439' TO DFHEIV0(25:11)
 14743     CALL 'kxdfhei1' USING DFHEIV0,
 14744           PI-KEY,
 14745           PROGRAM-INTERFACE-BLOCK,
 14746           PI-COMM-LENGTH,
 14747           DFHEIV99,
 14748           DFHEIV99,
 14749           DFHEIV99
 14750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14751
 14752
 14753     MOVE XCTL-EL141             TO CALL-PGM.
 14754     GO TO 9200-XCTL.
 14755
 14756 8700-CERT-MNT.
 14757     IF PI-RETURN-CD-1 = 'X'
 14758         MOVE ER-7690            TO EMI-ERROR
 14759         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14760         MOVE -1                 TO MAINTL
 14761         GO TO 8110-SEND-DATA.
 14762
 14763
 14764* EXEC CICS WRITEQ TS
 14765*         QUEUE     (PI-KEY)
 14766*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14767*         LENGTH    (PI-COMM-LENGTH)
 14768*    END-EXEC.
 14769*    MOVE '*"                    ''   #00012365' TO DFHEIV0
 14770     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14771     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14772     MOVE X'2020233030303132333635' TO DFHEIV0(25:11)
 14773     CALL 'kxdfhei1' USING DFHEIV0,
 14774           PI-KEY,
 14775           PROGRAM-INTERFACE-BLOCK,
 14776           PI-COMM-LENGTH,
 14777           DFHEIV99,
 14778           DFHEIV99,
 14779           DFHEIV99
 14780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14781
 14782
 14783     MOVE XCTL-EL1273            TO CALL-PGM.
 14784     GO TO 9200-XCTL.
 14785
 14786 8750-DMD-CLM-FIX.
 14787
 14788* EXEC CICS WRITEQ TS
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 283
* EL131.cbl
 14789*         QUEUE     (PI-KEY)
 14790*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14791*         LENGTH    (PI-COMM-LENGTH)
 14792*    END-EXEC.
 14793*    MOVE '*"                    ''   #00012375' TO DFHEIV0
 14794     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14795     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14796     MOVE X'2020233030303132333735' TO DFHEIV0(25:11)
 14797     CALL 'kxdfhei1' USING DFHEIV0,
 14798           PI-KEY,
 14799           PROGRAM-INTERFACE-BLOCK,
 14800           PI-COMM-LENGTH,
 14801           DFHEIV99,
 14802           DFHEIV99,
 14803           DFHEIV99
 14804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14805
 14806
 14807     MOVE XCTL-EL400DMD          TO CALL-PGM.
 14808     GO TO 9200-XCTL.
 14809
 14810 8800-UNAUTHORIZED-ACCESS.
 14811     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 14812     GO TO 8990-SEND-TEXT.
 14813
 14814 8810-PF23-ENTERED.
 14815     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 14816     MOVE XCTL-EL005             TO CALL-PGM.
 14817     GO TO 9200-XCTL.
 14818
 14819 8820-XCTL-ERROR.
 14820
 14821* EXEC CICS HANDLE CONDITION
 14822*        PGMIDERR (8990-SEND-TEXT)
 14823*    END-EXEC.
 14824*    MOVE '"$L                   ! G #00012394' TO DFHEIV0
 14825     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 14826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14827     MOVE X'4720233030303132333934' TO DFHEIV0(25:11)
 14828     CALL 'kxdfhei1' USING DFHEIV0
 14829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14830
 14831
 14832     MOVE SPACE                 TO PI-ENTRY-CD-1.
 14833     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 14834     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 14835     MOVE XCTL-EL005            TO CALL-PGM.
 14836     GO TO 9200-XCTL.
 14837
 14838 8990-SEND-TEXT.
 14839
 14840* EXEC CICS SEND TEXT
 14841*         FROM      (LOGOFF-TEXT)
 14842*         LENGTH    (LOGOFF-LENGTH)
 14843*         ERASE
 14844*         FREEKB
 14845*    END-EXEC.
 14846*    MOVE '8&      T  E F  H   F -   #00012405' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 284
* EL131.cbl
 14847     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 14848     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 14849     MOVE X'2020233030303132343035' TO DFHEIV0(25:11)
 14850     CALL 'kxdfhei1' USING DFHEIV0,
 14851           LOGOFF-TEXT,
 14852           LOGOFF-LENGTH,
 14853           DFHEIV99,
 14854           DFHEIV99,
 14855           DFHEIV99,
 14856           DFHEIV99,
 14857           DFHEIV99,
 14858           DFHEIV99,
 14859           DFHEIV99,
 14860           DFHEIV99,
 14861           DFHEIV99,
 14862           DFHEIV99
 14863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14864
 14865
 14866     GO TO 9100-RETURN-CICS.
 14867
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 285
* EL131.cbl
 14869 9000-RETURN-TRANS.
 14870
 14871* EXEC CICS RETURN
 14872*         TRANSID   (TRANS-ID)
 14873*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 14874*         LENGTH    (PI-COMM-LENGTH)
 14875*    END-EXEC.
 14876*    MOVE '.(CT                  ''   #00012416' TO DFHEIV0
 14877     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 14878     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14879     MOVE X'2020233030303132343136' TO DFHEIV0(25:11)
 14880     CALL 'kxdfhei1' USING DFHEIV0,
 14881           TRANS-ID,
 14882           PROGRAM-INTERFACE-BLOCK,
 14883           PI-COMM-LENGTH,
 14884           DFHEIV99,
 14885           DFHEIV99,
 14886           DFHEIV99
 14887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14888
 14889
 14890
 14891* GOBACK.
 14892     MOVE '9%                    "   ' TO DFHEIV0
 14893     MOVE 'EL131' TO DFHEIV1
 14894     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 14895     GOBACK.
 14896
 14897 9100-RETURN-CICS.
 14898
 14899* EXEC CICS RETURN
 14900*    END-EXEC.
 14901*    MOVE '.(                    ''   #00012425' TO DFHEIV0
 14902     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 14903     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14904     MOVE X'2020233030303132343235' TO DFHEIV0(25:11)
 14905     CALL 'kxdfhei1' USING DFHEIV0,
 14906           DFHEIV99,
 14907           DFHEIV99,
 14908           DFHEIV99,
 14909           DFHEIV99,
 14910           DFHEIV99,
 14911           DFHEIV99
 14912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14913
 14914
 14915
 14916* GOBACK.
 14917     MOVE '9%                    "   ' TO DFHEIV0
 14918     MOVE 'EL131' TO DFHEIV1
 14919     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 14920     GOBACK.
 14921
 14922 9200-XCTL.
 14923
 14924* EXEC CICS XCTL
 14925*         PROGRAM    (CALL-PGM)
 14926*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 286
* EL131.cbl
 14927*         LENGTH     (PI-COMM-LENGTH)
 14928*    END-EXEC.
 14929*    MOVE '.$C                   %   #00012431' TO DFHEIV0
 14930     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 14931     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14932     MOVE X'2020233030303132343331' TO DFHEIV0(25:11)
 14933     CALL 'kxdfhei1' USING DFHEIV0,
 14934           CALL-PGM,
 14935           PROGRAM-INTERFACE-BLOCK,
 14936           PI-COMM-LENGTH,
 14937           DFHEIV99
 14938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14939
 14940
 14941 9700-LINK-RTRM-FILE-ID.
 14942
 14943* EXEC CICS LINK
 14944*        PROGRAM  (RTRM-FILE-ID)
 14945*        COMMAREA (CALCULATION-PASS-AREA)
 14946*        LENGTH   (CP-COMM-LENGTH)
 14947*    END-EXEC.
 14948*    MOVE '."C                   (   #00012438' TO DFHEIV0
 14949     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14950     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14951     MOVE X'2020233030303132343338' TO DFHEIV0(25:11)
 14952     CALL 'kxdfhei1' USING DFHEIV0,
 14953           RTRM-FILE-ID,
 14954           CALCULATION-PASS-AREA,
 14955           CP-COMM-LENGTH,
 14956           DFHEIV99,
 14957           DFHEIV99,
 14958           DFHEIV99,
 14959           DFHEIV99
 14960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14961
 14962
 14963 9700-EXIT.
 14964      EXIT.
 14965
 14966 9800-CONVERT-DATE.
 14967     MOVE SPACES TO DC-ERROR-CODE.
 14968
 14969* EXEC CICS LINK
 14970*         PROGRAM    (DATE-CONV)
 14971*         COMMAREA   (DATE-CONVERSION-DATA)
 14972*         LENGTH     (DC-COMM-LENGTH)
 14973*    END-EXEC.
 14974*    MOVE '."C                   (   #00012449' TO DFHEIV0
 14975     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14976     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14977     MOVE X'2020233030303132343439' TO DFHEIV0(25:11)
 14978     CALL 'kxdfhei1' USING DFHEIV0,
 14979           DATE-CONV,
 14980           DATE-CONVERSION-DATA,
 14981           DC-COMM-LENGTH,
 14982           DFHEIV99,
 14983           DFHEIV99,
 14984           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 287
* EL131.cbl
 14985           DFHEIV99
 14986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14987
 14988
 14989 9800-EXIT.
 14990     EXIT.
 14991
 14992 9900-ERROR-FORMAT.
 14993
 14994* EXEC CICS LINK
 14995*         PROGRAM    (XCTL-EL001)
 14996*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 14997*         LENGTH     (EMI-COMM-LENGTH)
 14998*    END-EXEC.
 14999*    MOVE '."C                   (   #00012459' TO DFHEIV0
 15000     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15001     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15002     MOVE X'2020233030303132343539' TO DFHEIV0(25:11)
 15003     CALL 'kxdfhei1' USING DFHEIV0,
 15004           XCTL-EL001,
 15005           ERROR-MESSAGE-INTERFACE-BLOCK,
 15006           EMI-COMM-LENGTH,
 15007           DFHEIV99,
 15008           DFHEIV99,
 15009           DFHEIV99,
 15010           DFHEIV99
 15011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15012
 15013
 15014 9900-EXIT.
 15015     EXIT.
 15016
 15017 9990-ABEND.
 15018     MOVE DFHEIBLK               TO EMI-LINE1.
 15019
 15020* EXEC CICS LINK
 15021*         PROGRAM   (XCTL-EL004)
 15022*         COMMAREA  (EMI-LINE1)
 15023*         LENGTH    (72)
 15024*     END-EXEC.
 15025     MOVE 72
 15026       TO DFHEIV11
 15027*    MOVE '."C                   (   #00012470' TO DFHEIV0
 15028     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15029     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15030     MOVE X'2020233030303132343730' TO DFHEIV0(25:11)
 15031     CALL 'kxdfhei1' USING DFHEIV0,
 15032           XCTL-EL004,
 15033           EMI-LINE1,
 15034           DFHEIV11,
 15035           DFHEIV99,
 15036           DFHEIV99,
 15037           DFHEIV99,
 15038           DFHEIV99
 15039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15040
 15041
 15042     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 288
* EL131.cbl
 15043
 15044     GO TO 8110-SEND-DATA.
 15045
 15046 9995-SECURITY-VIOLATION.
 15047*           COPY ELCSCTP.
 15048******************************************************************
 15049*                                                                *
 15050*                            ELCSCTP                             *
 15051*                            VMOD=2.001                          *
 15052*                                                                *
 15053*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 15054******************************************************************
 15055
 15056
 15057     MOVE EIBDATE          TO SM-JUL-DATE.
 15058     MOVE EIBTRMID         TO SM-TERMID.
 15059     MOVE THIS-PGM         TO SM-PGM.
 15060     MOVE EIBTIME          TO TIME-IN.
 15061     MOVE TIME-OUT         TO SM-TIME.
 15062     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 15063
 15064
 15065* EXEC CICS LINK
 15066*         PROGRAM  ('EL003')
 15067*         COMMAREA (SECURITY-MESSAGE)
 15068*         LENGTH   (80)
 15069*    END-EXEC.
 15070     MOVE 'EL003' TO DFHEIV1
 15071     MOVE 80
 15072       TO DFHEIV11
 15073*    MOVE '."C                   (   #00012498' TO DFHEIV0
 15074     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15075     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15076     MOVE X'2020233030303132343938' TO DFHEIV0(25:11)
 15077     CALL 'kxdfhei1' USING DFHEIV0,
 15078           DFHEIV1,
 15079           SECURITY-MESSAGE,
 15080           DFHEIV11,
 15081           DFHEIV99,
 15082           DFHEIV99,
 15083           DFHEIV99,
 15084           DFHEIV99
 15085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15086
 15087
 15088******************************************************************
 15089
 15090
 15091
 15092 9999-DFHBACK SECTION.
 15093     MOVE '9%                    "   ' TO DFHEIV0
 15094     MOVE 'EL131' TO DFHEIV1
 15095     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15096     GOBACK.
 15097 9999-DFHEXIT.
 15098     IF DFHEIGDJ EQUAL 0001
 15099         NEXT SENTENCE
 15100     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 289
* EL131.cbl
 15101         GO TO 8820-XCTL-ERROR,
 15102               8150-ENTERED-CLAIM-NOTFOUND,
 15103               9990-ABEND
 15104         DEPENDING ON DFHEIGDI
 15105     ELSE IF DFHEIGDJ EQUAL 3
 15106         GO TO 0130-TS-ERROR,
 15107               0130-TS-ERROR
 15108         DEPENDING ON DFHEIGDI
 15109     ELSE IF DFHEIGDJ EQUAL 4
 15110         GO TO 0600-CONTINUE-NAME-UPDATE
 15111         DEPENDING ON DFHEIGDI
 15112     ELSE IF DFHEIGDJ EQUAL 5
 15113         GO TO 1004-BENE-NOT-FOUND
 15114         DEPENDING ON DFHEIGDI
 15115     ELSE IF DFHEIGDJ EQUAL 6
 15116         GO TO 1120-CNTL-NOTFND
 15117         DEPENDING ON DFHEIGDI
 15118     ELSE IF DFHEIGDJ EQUAL 7
 15119         GO TO 1150-NOTOPEN-ERROR,
 15120               1150-EXIT
 15121         DEPENDING ON DFHEIGDI
 15122     ELSE IF DFHEIGDJ EQUAL 8
 15123         GO TO 1490-STATE-NOTFND
 15124         DEPENDING ON DFHEIGDI
 15125     ELSE IF DFHEIGDJ EQUAL 9
 15126         GO TO 1500-CARR-NOTFND
 15127         DEPENDING ON DFHEIGDI
 15128     ELSE IF DFHEIGDJ EQUAL 10
 15129         GO TO 1620-ACCT-NOTFND
 15130         DEPENDING ON DFHEIGDI
 15131     ELSE IF DFHEIGDJ EQUAL 11
 15132         GO TO 2020-EXIT
 15133         DEPENDING ON DFHEIGDI
 15134     ELSE IF DFHEIGDJ EQUAL 12
 15135         GO TO 2030-EXIT
 15136         DEPENDING ON DFHEIGDI
 15137     ELSE IF DFHEIGDJ EQUAL 13
 15138         GO TO 2040-EXIT
 15139         DEPENDING ON DFHEIGDI
 15140     ELSE IF DFHEIGDJ EQUAL 14
 15141         GO TO 2050-EXIT
 15142         DEPENDING ON DFHEIGDI
 15143     ELSE IF DFHEIGDJ EQUAL 15
 15144         GO TO 2060-CERT-NOTFND
 15145         DEPENDING ON DFHEIGDI
 15146     ELSE IF DFHEIGDJ EQUAL 16
 15147         GO TO 2060-DUPKEY
 15148         DEPENDING ON DFHEIGDI
 15149     ELSE IF DFHEIGDJ EQUAL 17
 15150         GO TO 2070-NOT-FOUND
 15151         DEPENDING ON DFHEIGDI
 15152     ELSE IF DFHEIGDJ EQUAL 18
 15153         GO TO 2070-EXIT
 15154         DEPENDING ON DFHEIGDI
 15155     ELSE IF DFHEIGDJ EQUAL 19
 15156         GO TO 2080-EXIT
 15157         DEPENDING ON DFHEIGDI
 15158     ELSE IF DFHEIGDJ EQUAL 20
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 290
* EL131.cbl
 15159         GO TO 2400-TRLR-NOTFND,
 15160               2410-EXIT
 15161         DEPENDING ON DFHEIGDI
 15162     ELSE IF DFHEIGDJ EQUAL 21
 15163         GO TO 2425-NINETY-NOTFND,
 15164               2425-NINETY-NOTFND
 15165         DEPENDING ON DFHEIGDI
 15166     ELSE IF DFHEIGDJ EQUAL 22
 15167         GO TO 2430-EXIT,
 15168               2440-EXIT
 15169         DEPENDING ON DFHEIGDI
 15170     ELSE IF DFHEIGDJ EQUAL 23
 15171         GO TO 2440-EXIT
 15172         DEPENDING ON DFHEIGDI
 15173     ELSE IF DFHEIGDJ EQUAL 24
 15174         GO TO 2460-EXIT
 15175         DEPENDING ON DFHEIGDI
 15176     ELSE IF DFHEIGDJ EQUAL 25
 15177         GO TO 2475-EXIT
 15178         DEPENDING ON DFHEIGDI
 15179     ELSE IF DFHEIGDJ EQUAL 26
 15180         GO TO 2650-EXIT
 15181         DEPENDING ON DFHEIGDI
 15182     ELSE IF DFHEIGDJ EQUAL 27
 15183         GO TO 3010-DEL-ACTQ,
 15184               3040-EXIT
 15185         DEPENDING ON DFHEIGDI
 15186     ELSE IF DFHEIGDJ EQUAL 28
 15187         GO TO 3010-NO-ACTIVITY,
 15188               3050-EXIT
 15189         DEPENDING ON DFHEIGDI
 15190     ELSE IF DFHEIGDJ EQUAL 29
 15191         GO TO 3010-CERT-NOT-FOUND
 15192         DEPENDING ON DFHEIGDI
 15193     ELSE IF DFHEIGDJ EQUAL 30
 15194         GO TO 3020-EXIT
 15195         DEPENDING ON DFHEIGDI
 15196     ELSE IF DFHEIGDJ EQUAL 31
 15197         GO TO 3060-EXIT,
 15198               3060-EXIT
 15199         DEPENDING ON DFHEIGDI
 15200     ELSE IF DFHEIGDJ EQUAL 32
 15201         GO TO 5000-TRLR-NOT-FOUND
 15202         DEPENDING ON DFHEIGDI
 15203     ELSE IF DFHEIGDJ EQUAL 33
 15204         GO TO 5000-CERT-NOT-FOUND
 15205         DEPENDING ON DFHEIGDI
 15206     ELSE IF DFHEIGDJ EQUAL 34
 15207         GO TO 7630-END-BROWSE
 15208         DEPENDING ON DFHEIGDI
 15209     ELSE IF DFHEIGDJ EQUAL 35
 15210         GO TO 7799-EXIT,
 15211               7799-EXIT
 15212         DEPENDING ON DFHEIGDI
 15213     ELSE IF DFHEIGDJ EQUAL 36
 15214         GO TO 7799-EXIT
 15215         DEPENDING ON DFHEIGDI
 15216     ELSE IF DFHEIGDJ EQUAL 37
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 13:56 Page 291
* EL131.cbl
 15217         GO TO 7800-NOT-FOUND
 15218         DEPENDING ON DFHEIGDI
 15219     ELSE IF DFHEIGDJ EQUAL 38
 15220         GO TO 8000-NOTE-NOT-FOUND
 15221         DEPENDING ON DFHEIGDI
 15222     ELSE IF DFHEIGDJ EQUAL 39
 15223         GO TO 8990-SEND-TEXT
 15224         DEPENDING ON DFHEIGDI.
 15225     MOVE '9%                    "   ' TO DFHEIV0
 15226     MOVE 'EL131' TO DFHEIV1
 15227     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15228     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       10884     Code:       50518
