* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44* 010213  CR2011083000005  PEMA  ADD SPECIAL DCC SPP DDF REFUND
    45******************************************************************
    46 environment division.
    47 data division.
    48 working-storage section.
    49 01  DFH-START PIC X(04).
    50*
    51* program buffers
    52*
    53 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    54     88  ALREADY-SENT              VALUE 'Y'.
    55 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    56 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    57     88  ELCERT-FINISHED            VALUE 'Y'.
    58 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    59 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    60     88  ERACCT-FOUND               VALUE 'Y'.
    61 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    62 77 ws-send-msg-size           pic s9(8) comp value 4096.
    63 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    64 77 ws-recv-buf                pic x(4096).
    65 77 ws-send-buf                pic x(4096) VALUE SPACES.
    66 77 ws-recv-total              pic s9(8) comp value 0.
    67 77 ws-recv-left               pic s9(8) comp value 0.
    68 77 ws-seq-num                 pic s9(8) comp value 0.
    69 77 ws-flags                   pic s9(8) comp value 0.
    70 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    71 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page   3
* SOCK03.cbl
    72 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    73 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    74 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    75 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    76 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    77 77  ws-cancel-reason            pic x   value spaces.
    78 77  P1                          PIC S999 COMP-3 VALUE +0.
    79 77  P2                          PIC S999 COMP-3 VALUE +0.
    80 77  C0                          PIC S999 COMP-3 VALUE +0.
    81 77  C1                          PIC S999 COMP-3 VALUE +0.
    82 77  C2                          PIC S999 COMP-3 VALUE +0.
    83 77  C3                          PIC S999 COMP-3 VALUE +0.
    84 77 S1                           PIC S999 COMP-3 VALUE +0.
    85 77 S2                           PIC S999 COMP-3 VALUE +0.
    86 77 L1                           PIC S999 COMP-3 VALUE +0.
    87 77 L2                           PIC S999 COMP-3 VALUE +0.
    88 77 F1                           PIC S999 COMP-3 VALUE +0.
    89 77 WS-BUILD-SW                  PIC X.
    90    88  TIME-TO-BUILD               VALUE 'Y'.
    91 77 WS-SAVE-ERACCT               PIC X(2000).
    92 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    93 77 WS-STOP-SW                   PIC X  VALUE ' '.
    94    88  TOLD-TO-STOP               VALUE 'Y'.
    95 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    96    88  GET-RATES                    VALUE 'R'.
    97    88  GET-ACT-ACCTS                VALUE 'A'.
    98 77 ws-bin-1st-pay-dt            pic xx  value low-values.
    99 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
   100 77 ws-disp-rate                 pic z9.99999.
   101 77  WS-ERCTBL-SW                PIC X VALUE ' '.
   102     88  END-OF-ERCTBL                 VALUE 'Y'.
   103 77  WS-STATUS                   PIC X.
   104 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
   105 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
   106 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
   107 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   108 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   109 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   110 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   111 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   112 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   113 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   114 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
   115 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
   116     88  WS-ELCERT-FULL             VALUE '1'.
   117     88  WS-ELCERT-NAME             VALUE '2'.
   118     88  WS-ELCERT-CERT-NO          VALUE '3'.
   119     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   120 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   121 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   122     88  I-SAY-TO-STOP      VALUE 'Y'.
   123 77  WS-HEX-0A                   PIC X.
   124 77  WS-CALL-TYPE                PIC X(6).
   125 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   126 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   127 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   128 77  DD-IU-SW                    PIC X   VALUE ' '.
   129     88  DD-IU-PRESENT                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page   4
* SOCK03.cbl
   130 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   131 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   132 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   133 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   134 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   135 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   136 77  ws-ah-rfnd-clp              pic s9(7)v99 comp-3 value +0.
   137 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   138 77  WS-PDEF-RECORD-SW           PIC X           VALUE ' '.
   139     88  PDEF-FOUND                              VALUE 'Y'.
   140 01  WS-STRING-DATA.
   141     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   142     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   143     05  WS-CARRIER              PIC X        VALUE SPACES.
   144     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   145     05  WS-STATE                PIC XX       VALUE SPACES.
   146     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   147     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   148     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   149     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   150     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   151     05  WS-MID-INIT             PIC X        VALUE SPACES.
   152     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   153     05  WS-LF-COVERAGE-TYPE     PIC X        VALUE SPACES.
   154     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   155     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   156     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   157     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   158     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   159     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   160     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   161     05  WS-LF-METHOD            PIC X(10)    VALUE SPACES.
   162     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   163     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   164     05  WS-AH-COVERAGE-TYPE     PIC X        VALUE SPACES.
   165     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   166     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   167     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   168     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   169     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   170     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   171     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   172     05  WS-AH-METHOD            PIC X(10)    VALUE SPACES.
   173     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   174     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   175     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   176     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   177     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   178     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   179     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   180     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   181     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   182     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   183     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   184     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   185     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   186     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   187     05  WS-MID-JINIT            PIC X        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page   5
* SOCK03.cbl
   188     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   189     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   190     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   191 01  ws-work-date.
   192     05  ws-work-ccyy            pic x(4).
   193     05  ws-work-mm              pic xx.
   194     05  ws-work-dd              pic xx.
   195 01  ws-work-date-num redefines ws-work-date
   196                                 pic 9(8).
   197 01  FILLER.
   198     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   199     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   200     12  WS-STATE-ABBREVIATION   PIC XX.
   201     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   202     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   203     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   204     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   205     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   206     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   207     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   208     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   209     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   210     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   211     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   212     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   213     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   214     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   215     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   216     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   217     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   218     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   219     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   220     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   221     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   222     12  WS-LF-OVERRIDE-L1       PIC  X(01).
   223     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   224     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   225     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   226     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   227         88  WS-REDUCING                         VALUE 'R'.
   228         88  WS-LEVEL                            VALUE 'L'  'P'.
   229 01  ELMSTR-KEY.
   230     12  ELMSTR-COMP-CD          PIC X.
   231     12  ELMSTR-CERT-NO          PIC X(11).
   232 01  CTBL-KEY-SAVE               PIC X(5).
   233 01  CTBL-KEY.
   234     05  CTBL-COMPANY-CD         PIC X.
   235     05  CTBL-TABLE              PIC XXX.
   236     05  CTBL-BEN-TYPE           PIC X.
   237     05  CTBL-BEN-CODE           PIC XX.
   238 01  ERPDEF-KEY-SAVE             PIC X(18).
   239 01  ERPDEF-KEY.
   240     12  ERPDEF-COMPANY-CD       PIC X.
   241     12  ERPDEF-STATE            PIC XX.
   242     12  ERPDEF-PROD-CD          PIC XXX.
   243     12  F                       PIC X(7).
   244     12  ERPDEF-BEN-TYPE         PIC X.
   245     12  ERPDEF-BEN-CODE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page   6
* SOCK03.cbl
   246     12  ERPDEF-EXP-DT           PIC XX.
   247 01  WS-AM3-KEY.
   248     12  WS-AM3-ACCOUNT          PIC X(10).
   249     12  WS-AM3-EXP-DT           PIC XX.
   250 01  WS-AM-KEY.
   251     12  WS-AM-COMPANY-CD        PIC X.
   252     12  WS-AM-CARRIER           PIC X.
   253     12  WS-AM-GROUPING          PIC X(6).
   254     12  WS-AM-STATE             PIC XX.
   255     12  WS-AM-ACCOUNT           PIC X(10).
   256     12  WS-AM-EXPIRATION-DT     PIC XX.
   257     12  WS-AM-FILLER            PIC XXXX.
   258 01  WS-CO-DATA.
   259     05  WS-CO-NUM               PIC X(10).
   260     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   261     05  WS-CO-NAME              PIC X(30).
   262     05  WS-CO-MAIL-NAME         PIC X(30).
   263     05  WS-CO-ADDR1             PIC X(30).
   264     05  WS-CO-ADDR2             PIC X(30).
   265     05  WS-CO-ADDR3             PIC X(30).
   266     05  WS-CO-ZIP               PIC X(9).
   267     05  WS-CO-PHONE             PIC X(10).
   268 01  WS-CF-KEY.
   269     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   270     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   271*        88  COMPANY-MASTER                      VALUE '1'.
   272*        88  STATE-MASTER                        VALUE '3'.
   273*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   274*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   275     12  WS-CF-ACCESS.
   276         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   277         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   278             20  FILLER          PIC  X(01).
   279             20  WS-CF-CARRIER   PIC  X(01).
   280     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   281 01  WS-CM-KEY.
   282     05  WS-CM-COMPANY-CD        PIC X.
   283     05  WS-CM-CARRIER           PIC X.
   284     05  WS-CM-GROUP             PIC X(6).
   285     05  WS-CM-STATE             PIC XX.
   286     05  WS-CM-ACCOUNT           PIC X(10).
   287     05  WS-CM-EFF-DT            PIC XX.
   288     05  WS-CM-CERT-NO           PIC X(11).
   289 01  WS-CM-KEY-A1.
   290     05  WS-CM-COMPANY-CD-A1     PIC X.
   291     05  WS-CM-LAST-NAME         PIC X(15).
   292     05  WS-CM-INITIALS          PIC XX.
   293 01  WS-CM-KEY-A4.
   294     05  WS-CM-COMPANY-CD-A4     PIC X.
   295     05  WS-CM-CERT-NO-A4        PIC X(11).
   296 01  WS-CID-NO                   PIC X(8).
   297 01  WS-DISP-RESP                PIC 9(5).
   298 01  WS-RESPONSE                 PIC S9(8)   COMP.
   299     88  RESP-NORMAL                  VALUE +00.
   300     88  RESP-NOTFND                  VALUE +13.
   301     88  RESP-DUPKEY                  VALUE +15.
   302     88  RESP-NOTOPEN                 VALUE +19.
   303     88  RESP-ENDFILE                 VALUE +20.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page   7
* SOCK03.cbl
   304*                                 COPY ELCCERT.
   305******************************************************************
   306*                                                                *
   307*                            ELCCERT.                            *
   308*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   309*                            VMOD=2.013                          *
   310*                                                                *
   311*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   312*                                                                *
   313*   FILE TYPE = VSAM,KSDS                                        *
   314*   RECORD SIZE = 450  RECFORM = FIXED                           *
   315*                                                                *
   316*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   317*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   318*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   319*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   320*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   321*                                                                *
   322*   LOG = YES                                                    *
   323*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   324******************************************************************
   325*                   C H A N G E   L O G
   326*
   327* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   328*-----------------------------------------------------------------
   329*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   330* EFFECTIVE    NUMBER
   331*-----------------------------------------------------------------
   332* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   333* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   334* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   335* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   336* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   337* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   338* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   339* 032612  CR2011110200001  PEMA  AHL CHANGES
   340******************************************************************
   341
   342 01  CERTIFICATE-MASTER.
   343     12  CM-RECORD-ID                      PIC XX.
   344         88  VALID-CM-ID                      VALUE 'CM'.
   345
   346     12  CM-CONTROL-PRIMARY.
   347         16  CM-COMPANY-CD                 PIC X.
   348         16  CM-CARRIER                    PIC X.
   349         16  CM-GROUPING.
   350             20  CM-GROUPING-PREFIX        PIC X(3).
   351             20  CM-GROUPING-PRIME         PIC X(3).
   352         16  CM-STATE                      PIC XX.
   353         16  CM-ACCOUNT.
   354             20  CM-ACCOUNT-PREFIX         PIC X(4).
   355             20  CM-ACCOUNT-PRIME          PIC X(6).
   356         16  CM-CERT-EFF-DT                PIC XX.
   357         16  CM-CERT-NO.
   358             20  CM-CERT-PRIME             PIC X(10).
   359             20  CM-CERT-SFX               PIC X.
   360
   361     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page   8
* SOCK03.cbl
   362         16  CM-COMPANY-CD-A1              PIC X.
   363         16  CM-INSURED-LAST-NAME          PIC X(15).
   364         16  CM-INSURED-INITIALS.
   365             20  CM-INSURED-INITIAL1       PIC X.
   366             20  CM-INSURED-INITIAL2       PIC X.
   367
   368     12  CM-CONTROL-BY-SSN.
   369         16  CM-COMPANY-CD-A2              PIC X.
   370         16  CM-SOC-SEC-NO.
   371             20  CM-SSN-STATE              PIC XX.
   372             20  CM-SSN-ACCOUNT            PIC X(6).
   373             20  CM-SSN-LN3.
   374                 25  CM-INSURED-INITIALS-A2.
   375                     30 CM-INSURED-INITIAL1-A2   PIC X.
   376                     30 CM-INSURED-INITIAL2-A2   PIC X.
   377                 25 CM-PART-LAST-NAME-A2         PIC X.
   378
   379     12  CM-CONTROL-BY-CERT-NO.
   380         16  CM-COMPANY-CD-A4              PIC X.
   381         16  CM-CERT-NO-A4                 PIC X(11).
   382
   383     12  CM-CONTROL-BY-MEMB.
   384         16  CM-COMPANY-CD-A5              PIC X.
   385         16  CM-MEMBER-NO.
   386             20  CM-MEMB-STATE             PIC XX.
   387             20  CM-MEMB-ACCOUNT           PIC X(6).
   388             20  CM-MEMB-LN4.
   389                 25  CM-INSURED-INITIALS-A5.
   390                     30 CM-INSURED-INITIAL1-A5   PIC X.
   391                     30 CM-INSURED-INITIAL2-A5   PIC X.
   392                 25 CM-PART-LAST-NAME-A5         PIC XX.
   393
   394     12  CM-INSURED-PROFILE-DATA.
   395         16  CM-INSURED-FIRST-NAME.
   396             20  CM-INSURED-1ST-INIT       PIC X.
   397             20  FILLER                    PIC X(9).
   398         16  CM-INSURED-ISSUE-AGE          PIC 99.
   399         16  CM-INSURED-SEX                PIC X.
   400             88  CM-SEX-MALE                  VALUE 'M'.
   401             88  CM-SEX-FEMAL                 VALUE 'F'.
   402         16  CM-INSURED-JOINT-AGE          PIC 99.
   403         16  CM-JOINT-INSURED-NAME.
   404             20  CM-JT-LAST-NAME           PIC X(15).
   405             20  CM-JT-FIRST-NAME.
   406                 24  CM-JT-1ST-INIT        PIC X.
   407                 24  FILLER                PIC X(9).
   408             20  CM-JT-INITIAL             PIC X.
   409
   410     12  CM-LIFE-DATA.
   411         16  CM-LF-BENEFIT-CD              PIC XX.
   412         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   413         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   414         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   415         16  CM-LF-DEV-CODE                PIC XXX.
   416         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   417         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   418         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   419         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page   9
* SOCK03.cbl
   420         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   421         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   422         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   423         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   424         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   425         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   426         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   427         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   428         16  FILLER                        PIC XX.
   429
   430     12  CM-AH-DATA.
   431         16  CM-AH-BENEFIT-CD              PIC XX.
   432         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   433         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   434         16  CM-AH-DEV-CODE                PIC XXX.
   435         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   436         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   437         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   438         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   439         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   440         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   441         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   442         16  CM-AH-PAID-THRU-DT            PIC XX.
   443             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   444         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   445         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
   446         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   447         16  FILLER                        PIC X.
   448
   449     12  CM-LOAN-INFORMATION.
   450         16  CM-LIVES                      PIC S9(7)     COMP-3.
   451         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   452                                           PIC S9(5)V99  COMP-3.
   453         16  CM-BILLED                     PIC S9(7)     COMP-3.
   454         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   455         16  CM-PAY-FREQUENCY              PIC S99.
   456         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   457         16  CM-RATE-CLASS                 PIC XX.
   458         16  CM-BENEFICIARY                PIC X(25).
   459         16  CM-POLICY-FORM-NO             PIC X(12).
   460         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   461         16  CM-LAST-ADD-ON-DT             PIC XX.
   462         16  CM-DEDUCTIBLE-AMOUNTS.
   463             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   464             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   465         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   466             20  CM-RESIDENT-STATE         PIC XX.
   467             20  CM-RATE-CODE              PIC X(4).
   468             20  FILLER                    PIC XX.
   469         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   470             20  CM-LOAN-OFFICER           PIC X(5).
   471             20  FILLER                    PIC XXX.
   472         16  CM-CSR-CODE                   PIC XXX.
   473         16  CM-UNDERWRITING-CODE          PIC X.
   474             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   475         16  CM-POST-CARD-IND              PIC X.
   476         16  CM-NH-INTERFACE-SW            PIC X.
   477         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  10
* SOCK03.cbl
   478             88  CM-SING-PRM                  VALUE '1'.
   479             88  CM-O-B-COVERAGE              VALUE '2'.
   480             88  CM-OPEN-END                  VALUE '3'.
   481         16  CM-IND-GRP-TYPE               PIC X.
   482             88  CM-INDIVIDUAL                VALUE 'I'.
   483             88  CM-GROUP                     VALUE 'G'.
   484         16  CM-SKIP-CODE                  PIC X.
   485             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   486             88  SKIP-JULY                    VALUE '1'.
   487             88  SKIP-AUGUST                  VALUE '2'.
   488             88  SKIP-SEPTEMBER               VALUE '3'.
   489             88  SKIP-JULY-AUG                VALUE '4'.
   490             88  SKIP-AUG-SEPT                VALUE '5'.
   491             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   492             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   493             88  SKIP-JUNE                    VALUE '8'.
   494             88  SKIP-JUNE-JULY               VALUE '9'.
   495             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   496             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   497         16  CM-PAYMENT-MODE               PIC X.
   498             88  PAY-MONTHLY                  VALUE SPACE.
   499             88  PAY-WEEKLY                   VALUE '1'.
   500             88  PAY-SEMI-MONTHLY             VALUE '2'.
   501             88  PAY-BI-WEEKLY                VALUE '3'.
   502             88  PAY-SEMI-ANUALLY             VALUE '4'.
   503         16  CM-LOAN-NUMBER                PIC X(8).
   504         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   505         16  CM-OLD-LOF                    PIC XXX.
   506*        16  CM-LOAN-OFFICER               PIC XXX.
   507         16  CM-REIN-TABLE                 PIC XXX.
   508         16  CM-SPECIAL-REIN-CODE          PIC X.
   509         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   510         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   511         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   512
   513     12  CM-STATUS-DATA.
   514         16  CM-ENTRY-STATUS               PIC X.
   515         16  CM-ENTRY-DT                   PIC XX.
   516
   517         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   518         16  CM-LF-CANCEL-DT               PIC XX.
   519         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   520
   521         16  CM-LF-STATUS-AT-DEATH         PIC X.
   522         16  CM-LF-DEATH-DT                PIC XX.
   523         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   524
   525         16  CM-LF-CURRENT-STATUS          PIC X.
   526             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   527                                                'M' '4' '5' '9'.
   528             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   529             88  CM-LF-POLICY-PENDING         VALUE '2'.
   530             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   531             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   532             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   533             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   534             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   535             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  11
* SOCK03.cbl
   536             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   537             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   538             88  CM-LF-DECLINED               VALUE 'D'.
   539             88  CM-LF-VOIDED                 VALUE 'V'.
   540
   541         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   542         16  CM-AH-CANCEL-DT               PIC XX.
   543         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   544
   545         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   546         16  CM-AH-SETTLEMENT-DT           PIC XX.
   547         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   548
   549         16  CM-AH-CURRENT-STATUS          PIC X.
   550             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   551                                                'M' '4' '5' '9'.
   552             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   553             88  CM-AH-POLICY-PENDING         VALUE '2'.
   554             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   555             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   556             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   557             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   558             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   559             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   560             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   561             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   562             88  CM-AH-DECLINED               VALUE 'D'.
   563             88  CM-AH-VOIDED                 VALUE 'V'.
   564
   565         16  CM-CLAIM-INTERFACE-SW         PIC X.
   566             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   567             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   568             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   569         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   570
   571         16  CM-ENTRY-BATCH                PIC X(6).
   572         16  CM-LF-EXIT-BATCH              PIC X(6).
   573         16  CM-AH-EXIT-BATCH              PIC X(6).
   574         16  CM-LAST-MONTH-END             PIC XX.
   575
   576     12  CM-NOTE-SW                        PIC X.
   577         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   578         88  CERT-NOTES-PRESENT               VALUE '1'.
   579         88  BILLING-NOTES-PRESENT            VALUE '2'.
   580         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   581         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   582         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   583         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   584         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   585     12  CM-COMP-EXCP-SW                   PIC X.
   586         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   587         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   588     12  CM-INSURED-ADDRESS-SW             PIC X.
   589         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   590         88  INSURED-ADDR-PRESENT             VALUE '1'.
   591
   592*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   593     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  12
* SOCK03.cbl
   594     12  FILLER                            PIC X.
   595
   596*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   597     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   598     12  FILLER                            PIC X.
   599*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   600     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
   601
   602     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   603         88  CERT-ADDED-BATCH                 VALUE ' '.
   604         88  CERT-ADDED-ONLINE                VALUE '1'.
   605         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   606         88  CERT-PURGED-OFFLINE              VALUE '3'.
   607         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   608     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   609         88  CERT-AS-LOADED                   VALUE ' '.
   610         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   611         88  CERT-CLAIM-ONLINE                VALUE '2'.
   612         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   613         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   614         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   615         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   616         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   617
   618     12  CM-ACCOUNT-COMM-PCTS.
   619         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   620         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   621
   622     12  CM-USER-FIELD                     PIC X.
   623     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   624     12  CM-CLP-STATE                      PIC XX.
   625     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   626     12  CM-USER-RESERVED                  PIC XXX.
   627     12  FILLER REDEFINES CM-USER-RESERVED.
   628         16  CM-AH-CLASS-CD                PIC XX.
   629         16  F                             PIC X.
   630******************************************************************
   631*                                 COPY ELCMSTR.
   632******************************************************************
   633*                                                                *
   634*                            ELCMSTR.                            *
   635*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   636*                            VMOD=2.012                          *
   637*                                                                *
   638*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   639*                                                                *
   640*   FILE TYPE = VSAM,KSDS                                        *
   641*   RECORD SIZE = 350  RECFORM = FIXED                           *
   642*                                                                *
   643*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   644*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   645*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   646*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   647*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   648*                                                 RKP=75,LEN=21  *
   649*                                                                *
   650*   **** NOTE ****                                               *
   651*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  13
* SOCK03.cbl
   652*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   653*                                                                *
   654*   LOG = YES                                                    *
   655*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   656******************************************************************
   657*                   C H A N G E   L O G
   658*
   659* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   660*-----------------------------------------------------------------
   661*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   662* EFFECTIVE    NUMBER
   663*-----------------------------------------------------------------
   664* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   665* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   666******************************************************************
   667 01  CLAIM-MASTER.
   668     12  CL-RECORD-ID                PIC XX.
   669         88  VALID-CL-ID         VALUE 'CL'.
   670
   671     12  CL-CONTROL-PRIMARY.
   672         16  CL-COMPANY-CD           PIC X.
   673         16  CL-CARRIER              PIC X.
   674         16  CL-CLAIM-NO             PIC X(7).
   675         16  CL-CERT-NO.
   676             20  CL-CERT-PRIME       PIC X(10).
   677             20  CL-CERT-SFX         PIC X.
   678
   679     12  CL-CONTROL-BY-NAME.
   680         16  CL-COMPANY-CD-A1        PIC X.
   681         16  CL-INSURED-LAST-NAME    PIC X(15).
   682         16  CL-INSURED-NAME.
   683             20  CL-INSURED-1ST-NAME PIC X(12).
   684             20  CL-INSURED-MID-INIT PIC X.
   685
   686     12  CL-CONTROL-BY-SSN.
   687         16  CL-COMPANY-CD-A2        PIC X.
   688         16  CL-SOC-SEC-NO.
   689             20  CL-SSN-STATE        PIC XX.
   690             20  CL-SSN-ACCOUNT      PIC X(6).
   691             20  CL-SSN-LN3          PIC X(3).
   692
   693     12  CL-CONTROL-BY-CERT-NO.
   694         16  CL-COMPANY-CD-A4        PIC X.
   695         16  CL-CERT-NO-A4.
   696             20  CL-CERT-A4-PRIME    PIC X(10).
   697             20  CL-CERT-A4-SFX      PIC X.
   698
   699     12  CL-CONTROL-BY-CCN.
   700         16  CL-COMPANY-CD-A5        PIC X.
   701         16  CL-CCN-A5.
   702             20  CL-CCN.
   703                 24  CL-CCN-PREFIX-A5 PIC X(4).
   704                 24  CL-CCN-PRIME-A5 PIC X(12).
   705             20  CL-CCN-FILLER-A5    PIC X(4).
   706
   707     12  CL-INSURED-PROFILE-DATA.
   708         16  CL-INSURED-BIRTH-DT     PIC XX.
   709         16  CL-INSURED-SEX-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  14
* SOCK03.cbl
   710             88  INSURED-IS-MALE        VALUE 'M'.
   711             88  INSURED-IS-FEMALE      VALUE 'F'.
   712             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   713         16  CL-INSURED-OCC-CD       PIC X(6).
   714         16  FILLER                  PIC X(5).
   715
   716     12  CL-PROCESSING-INFO.
   717         16  CL-PROCESSOR-ID         PIC X(4).
   718         16  CL-CLAIM-STATUS         PIC X.
   719             88  CLAIM-IS-OPEN          VALUE 'O'.
   720             88  CLAIM-IS-CLOSED        VALUE 'C'.
   721         16  CL-CLAIM-TYPE           PIC X.
   722*            88  AH-CLAIM               VALUE 'A'.
   723*            88  LIFE-CLAIM             VALUE 'L'.
   724*            88  PROPERTY-CLAIM         VALUE 'P'.
   725*            88  IUI-CLAIM              VALUE 'I'.
   726*            88  GAP-CLAIM              VALUE 'G'.
   727         16  CL-CLAIM-PREM-TYPE      PIC X.
   728             88  SINGLE-PREMIUM         VALUE '1'.
   729             88  O-B-COVERAGE           VALUE '2'.
   730             88  OPEN-END-COVERAGE      VALUE '3'.
   731         16  CL-INCURRED-DT          PIC XX.
   732         16  CL-REPORTED-DT          PIC XX.
   733         16  CL-FILE-ESTABLISH-DT    PIC XX.
   734         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   735         16  CL-LAST-PMT-DT          PIC XX.
   736         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   737         16  CL-PAID-THRU-DT         PIC XX.
   738         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   739         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   740         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   741         16  CL-PMT-CALC-METHOD      PIC X.
   742             88  CL-360-DAY-YR          VALUE '1'.
   743             88  CL-365-DAY-YR          VALUE '2'.
   744             88  CL-FULL-MONTHS         VALUE '3'.
   745         16  CL-CAUSE-CD             PIC X(6).
   746
   747         16  CL-PRIME-CERT-NO.
   748             20  CL-PRIME-CERT-PRIME PIC X(10).
   749             20  CL-PRIME-CERT-SFX   PIC X.
   750
   751         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   752             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   753             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   754
   755         16  CL-MICROFILM-NO         PIC X(10).
   756         16  CL-PROG-FORM-TYPE       PIC X.
   757         16  CL-LAST-ADD-ON-DT       PIC XX.
   758
   759         16  CL-LAST-REOPEN-DT       PIC XX.
   760         16  CL-LAST-CLOSE-DT        PIC XX.
   761         16  CL-LAST-CLOSE-REASON    PIC X(01).
   762             88  FINAL-PAID             VALUE '1'.
   763             88  CLAIM-DENIED           VALUE '2'.
   764             88  AUTO-CLOSE             VALUE '3'.
   765             88  MANUAL-CLOSE           VALUE '4'.
   766             88  BENEFITS-CHANGED       VALUE 'C'.
   767             88  SETUP-ERRORS           VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  15
* SOCK03.cbl
   768         16  CL-ASSOC-CERT-SEQU      PIC S99.
   769         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   770         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   771             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   772         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   773         16  FILLER                  PIC X.
   774
   775     12  CL-CERTIFICATE-DATA.
   776         16  CL-CERT-ORIGIN          PIC X.
   777             88  CERT-WAS-ONLINE        VALUE '1'.
   778             88  CERT-WAS-CREATED       VALUE '2'.
   779             88  COVERAGE-WAS-ADDED     VALUE '3'.
   780         16  CL-CERT-KEY-DATA.
   781             20  CL-CERT-CARRIER     PIC X.
   782             20  CL-CERT-GROUPING    PIC X(6).
   783             20  CL-CERT-STATE       PIC XX.
   784             20  CL-CERT-ACCOUNT.
   785                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   786                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   787             20  CL-CERT-EFF-DT      PIC XX.
   788
   789     12  CL-STATUS-CONTROLS.
   790         16  CL-PRIORITY-CD          PIC X.
   791             88  CONFIDENTIAL-DATA      VALUE '8'.
   792             88  HIGHEST-PRIORITY       VALUE '9'.
   793         16  CL-SUPV-ATTN-CD         PIC X.
   794             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   795             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   796         16  CL-PURGED-DT            PIC XX.
   797         16  CL-RESTORED-DT          PIC XX.
   798         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   799         16  CL-NEXT-RESEND-DT       PIC XX.
   800         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   801         16  FILLER                  PIC XX.
   802         16  CL-LAST-MAINT-DT        PIC XX.
   803         16  CL-LAST-MAINT-USER      PIC X(4).
   804         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   805         16  CL-LAST-MAINT-TYPE      PIC X.
   806             88  CLAIM-SET-UP           VALUE ' '.
   807             88  PAYMENT-MADE           VALUE '1'.
   808             88  LETTER-SENT            VALUE '2'.
   809             88  MASTER-WAS-ALTERED     VALUE '3'.
   810             88  MASTER-WAS-RESTORED    VALUE '4'.
   811             88  INCURRED-DATE-CHANGED  VALUE '5'.
   812             88  FILE-CONVERTED         VALUE '6'.
   813             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   814             88  ERROR-CORRECTION       VALUE 'E'.
   815         16  CL-RELATED-CLAIM-NO     PIC X(7).
   816         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   817         16  CL-BENEFICIARY          PIC X(10).
   818         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   819         16  CL-DENIAL-TYPE          PIC X.
   820             88  CL-TYPE-DENIAL          VALUE '1'.
   821             88  CL-TYPE-RESCISSION      VALUE '2'.
   822             88  CL-TYPE-REFORMATION     VALUE '3'.
   823             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   824             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   825         16  FILLER                  PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  16
* SOCK03.cbl
   826
   827     12  CL-TRAILER-CONTROLS.
   828         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   829             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   830             88  CL-LAST-TRL-AVAIL      VALUE +100.
   831             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   832         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   833         16  FILLER                  PIC XX.
   834         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   835         16  CL-ADDRESS-TRAILER-CNT.
   836             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   837                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   838             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   839                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   840             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   841                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   842             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   843                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   844             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   845                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   846             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   847                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   848             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   849                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   850
   851     12  CL-CV-REFERENCE-NO.
   852         16  CL-CV-REFNO-PRIME       PIC X(18).
   853         16  CL-CV-REFNO-SFX         PIC XX.
   854
   855     12  CL-FILE-LOCATION            PIC X(4).
   856
   857     12  CL-PROCESS-ERRORS.
   858         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   859             88  NO-FATAL-ERRORS        VALUE ZERO.
   860         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   861             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   862
   863     12  CL-PRODUCT-CD               PIC X.
   864
   865     12  CL-CURRENT-KEY-DATA.
   866         16  CL-CURRENT-CARRIER      PIC X.
   867         16  CL-CURRENT-GROUPING     PIC X(6).
   868         16  CL-CURRENT-STATE        PIC XX.
   869         16  CL-CURRENT-ACCOUNT      PIC X(10).
   870
   871     12  CL-ASSOCIATES               PIC X.
   872         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   873         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   874         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   875         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   876
   877     12  CL-ACTIVITY-CODE            PIC 99.
   878     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   879     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   880
   881     12  CL-LAPSE-REPORT-CODE        PIC 9.
   882     12  CL-LAG-REPORT-CODE          PIC 9.
   883     12  CL-LOAN-TYPE                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  17
* SOCK03.cbl
   884     12  CL-LEGAL-STATE              PIC XX.
   885
   886*    12  FILLER                      PIC X(5).
   887     12  CL-YESNOSW                  PIC X.
   888     12  FILLER                      PIC X(4).
   889*                                 COPY ERCPDEF.
   890******************************************************************
   891*                                                                *
   892*                                                                *
   893*                            ERCPDEF.                            *
   894*                                                                *
   895*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   896*                                                                *
   897*    FILE TYPE = VSAM,KSDS                                       *
   898*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   899*                                                                *
   900*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   901*                                                                *
   902*    LOG = YES                                                   *
   903*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   904******************************************************************
   905 01  PRODUCT-MASTER.
   906    12  PD-RECORD-ID                 PIC X(02).
   907        88  VALID-PD-ID                  VALUE 'PD'.
   908    12  PD-CONTROL-PRIMARY.
   909        16  PD-COMPANY-CD            PIC X.
   910        16  PD-STATE                 PIC XX.
   911        16  PD-PRODUCT-CD            PIC XXX.
   912        16  PD-FILLER                PIC X(7).
   913        16  PD-BEN-TYPE              PIC X.
   914        16  PD-BEN-CODE              PIC XX.
   915        16  PD-PROD-EXP-DT           PIC XX.
   916    12  FILLER                       PIC X(50).
   917    12  PD-PRODUCT-DATA OCCURS 8.
   918        16  PD-PROD-CODE             PIC X.
   919            88  PD-PROD-LIFE           VALUE 'L'.
   920            88  PD-PROD-PROP           VALUE 'P'.
   921            88  PD-PROD-AH             VALUE 'A'.
   922            88  PD-PROD-IU             VALUE 'I'.
   923            88  PD-PROD-GAP            VALUE 'G'.
   924        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   925        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   926        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   927        16  PD-MAX-TERM              PIC S999        COMP-3.
   928        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   929        16  FILLER                   PIC X.
   930        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   931        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   932        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   933        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   934        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   935        16  PD-REC-CRIT-PERIOD       PIC X.
   936        16  PD-RTW-MOS               PIC 99.
   937        16  FILLER                   PIC X(5).
   938    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   939    12  PD-TERM-LIMITS OCCURS 15.
   940        16  PD-LOW-TERM              PIC S999        COMP-3.
   941        16  PD-HI-TERM               PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  18
* SOCK03.cbl
   942*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   943    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   944        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   945        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   946    12  PD-EARN-FACTORS.
   947        16  FILLER OCCURS 15.
   948            20  FILLER OCCURS 15.
   949                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   950    12  PD-PRODUCT-DESC              PIC X(80).
   951    12  PD-TRUNCATED                 PIC X.
   952    12  FILLER                       PIC X(59).
   953    12  PD-MAINT-INFORMATION.
   954        16  PD-LAST-MAINT-DT         PIC X(02).
   955        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   956        16  PD-LAST-MAINT-BY         PIC X(04).
   957*                                 COPY ERCCTBL.
   958******************************************************************
   959*                                                                *
   960*                                                                *
   961*                            ERCCTBL                             *
   962*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   963*                            VMOD=2.003
   964*                                                                *
   965*   ONLINE CREDIT SYSTEM                                         *
   966*                                                                *
   967*   FILE DESCRIPTION = COMPENSATION TABLE                        *
   968*                                                                *
   969*   FILE TYPE = VSAM,KSDS                                        *
   970*   RECORD SIZE = 200   RECFORM = FIXED                          *
   971*                                                                *
   972*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
   973*       ALTERNATE PATH = NONE                                    *
   974*                                                                *
   975*   LOG = NO                                                     *
   976*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   977*                                                                *
   978*                                                                *
   979******************************************************************
   980
   981 01  COMM-TABLE-RECORD.
   982     12  CT-RECORD-ID                      PIC XX.
   983         88  VALID-CT-ID                      VALUE 'CT'.
   984
   985     12  CT-CONTROL-PRIMARY.
   986         16  CT-COMPANY-CD                 PIC X.
   987         16  CT-TABLE                      PIC XXX.
   988         16  CT-CNTRL-2.
   989             20  CT-BEN-TYPE               PIC X.
   990             20  CT-BEN-CODE               PIC XX.
   991
   992     12  CT-MAINT-INFORMATION.
   993         16  CT-LAST-MAINT-DT              PIC XX.
   994         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   995         16  CT-LAST-MAINT-USER            PIC X(4).
   996         16  FILLER                        PIC X(31).
   997
   998     12  CT-LIMITS.
   999         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  19
* SOCK03.cbl
  1000
  1001         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1002
  1003         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1004
  1005     12  CT-RATES.
  1006         16  CT-RTX          OCCURS 27 TIMES.
  1007             20  CT-RT                     PIC SV9(5)     COMP-3.
  1008             20  CT-RT-R   REDEFINES
  1009                 CT-RT                     PIC XXX.
  1010
  1011     12  FILLER                            PIC  X(42).
  1012
  1013******************************************************************
  1014*                                 COPY ELCCNTL.
  1015******************************************************************
  1016*                                                                *
  1017*                                                                *
  1018*                            ELCCNTL.                            *
  1019*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1020*                            VMOD=2.059                          *
  1021*                                                                *
  1022*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1023*                                                                *
  1024*   FILE TYPE = VSAM,KSDS                                        *
  1025*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1026*                                                                *
  1027*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1028*       ALTERNATE INDEX = NONE                                   *
  1029*                                                                *
  1030*   LOG = YES                                                    *
  1031*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1032******************************************************************
  1033*                   C H A N G E   L O G
  1034*
  1035* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1036*-----------------------------------------------------------------
  1037*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1038* EFFECTIVE    NUMBER
  1039*-----------------------------------------------------------------
  1040* 082503                   PEMA  ADD BENEFIT GROUP
  1041* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1042* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1043* 092705    2005050300006  PEMA  ADD SPP LEASES
  1044* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1045* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1046* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1047* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1048* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1049* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1050******************************************************************
  1051*
  1052 01  CONTROL-FILE.
  1053     12  CF-RECORD-ID                       PIC XX.
  1054         88  VALID-CF-ID                        VALUE 'CF'.
  1055
  1056     12  CF-CONTROL-PRIMARY.
  1057         16  CF-COMPANY-ID                  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  20
* SOCK03.cbl
  1058         16  CF-RECORD-TYPE                 PIC X.
  1059             88  CF-COMPANY-MASTER              VALUE '1'.
  1060             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1061             88  CF-STATE-MASTER                VALUE '3'.
  1062             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1063             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1064             88  CF-CARRIER-MASTER              VALUE '6'.
  1065             88  CF-MORTALITY-MASTER            VALUE '7'.
  1066             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1067             88  CF-TERMINAL-MASTER             VALUE '9'.
  1068             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1069             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1070             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1071             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1072             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1073             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1074             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1075             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1076             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1077         16  CF-ACCESS-CD-GENL              PIC X(4).
  1078         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1079             20  CF-PROCESSOR               PIC X(4).
  1080         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1081             20  CF-STATE-CODE              PIC XX.
  1082             20  FILLER                     PIC XX.
  1083         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1084             20  FILLER                     PIC XX.
  1085             20  CF-HI-BEN-IN-REC           PIC XX.
  1086         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1087             20  FILLER                     PIC XXX.
  1088             20  CF-CARRIER-CNTL            PIC X.
  1089         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1090             20  FILLER                     PIC XX.
  1091             20  CF-HI-TYPE-IN-REC          PIC 99.
  1092         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1093             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1094                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1095             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1096             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1097         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1098             20  FILLER                     PIC X.
  1099             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1100         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1101             20  FILLER                     PIC XX.
  1102             20  CF-MORTGAGE-PLAN           PIC XX.
  1103         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1104
  1105     12  CF-LAST-MAINT-DT                   PIC XX.
  1106     12  CF-LAST-MAINT-BY                   PIC X(4).
  1107     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1108
  1109     12  CF-RECORD-BODY                     PIC X(728).
  1110
  1111
  1112****************************************************************
  1113*             COMPANY MASTER RECORD                            *
  1114****************************************************************
  1115
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  21
* SOCK03.cbl
  1116     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1117         16  CF-COMPANY-ADDRESS.
  1118             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1119             20  CF-CL-IN-CARE-OF           PIC X(30).
  1120             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1121             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1122             20  CF-CL-CITY-STATE           PIC X(30).
  1123             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1124             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1125         16  CF-COMPANY-CD                  PIC X.
  1126         16  CF-COMPANY-PASSWORD            PIC X(8).
  1127         16  CF-SECURITY-OPTION             PIC X.
  1128             88  ALL-SECURITY                   VALUE '1'.
  1129             88  COMPANY-VERIFY                 VALUE '2'.
  1130             88  PROCESSOR-VERIFY               VALUE '3'.
  1131             88  NO-SECURITY                    VALUE '4'.
  1132             88  ALL-BUT-TERM                   VALUE '5'.
  1133         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1134             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1135         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1136             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1137         16  CF-INFORCE-LOCATION            PIC X.
  1138             88  CERTS-ARE-ONLINE               VALUE '1'.
  1139             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1140             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1141         16  CF-LOWER-CASE-LETTERS          PIC X.
  1142         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1143             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1144             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1145             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1146             88  CF-ACCNT-CNTL                  VALUE '3'.
  1147             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1148
  1149         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1150         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1151
  1152         16  CF-LGX-CREDIT-USER             PIC X.
  1153             88  CO-IS-NOT-USER                 VALUE 'N'.
  1154             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1155
  1156         16 CF-CREDIT-CALC-CODES.
  1157             20  CF-CR-REM-TERM-CALC PIC X.
  1158               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1159               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1160               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1161               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1162               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1163               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1164               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1165             20  CF-CR-R78-METHOD           PIC X.
  1166               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1167               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1168
  1169         16  CF-CLAIM-CONTROL-COUNTS.
  1170             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1171                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1172
  1173             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  22
* SOCK03.cbl
  1174                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1175
  1176             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1177                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1178
  1179             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1180                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1181
  1182         16  CF-CURRENT-MONTH-END           PIC XX.
  1183
  1184         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1185             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1186             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1187             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1188             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1189                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1190                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1191             20  CF-CO-PREM-REJECT-SW       PIC X.
  1192                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1193                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1194             20  CF-CO-REF-REJECT-SW        PIC X.
  1195                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1196                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1197
  1198         16  CF-CO-REPORTING-DT             PIC XX.
  1199         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1200         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1201           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1202           88  CF-CO-MONTH-END                  VALUE '1'.
  1203
  1204         16  CF-LGX-CLAIM-USER              PIC X.
  1205             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1206             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1207
  1208         16  CF-CREDIT-EDIT-CONTROLS.
  1209             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1210             20  CF-MIN-AGE                 PIC 99.
  1211             20  CF-DEFAULT-AGE             PIC 99.
  1212             20  CF-MIN-TERM                PIC S999      COMP-3.
  1213             20  CF-MAX-TERM                PIC S999      COMP-3.
  1214             20  CF-DEFAULT-SEX             PIC X.
  1215             20  CF-JOINT-AGE-INPUT         PIC X.
  1216                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1217             20  CF-BIRTH-DATE-INPUT        PIC X.
  1218                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1219             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1220                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1221                 88  CF-ZERO-CARRIER            VALUE '1'.
  1222                 88  CF-ZERO-GROUPING           VALUE '2'.
  1223                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1224             20  CF-EDIT-SW                 PIC X.
  1225                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1226             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1227             20  CF-CR-PR-METHOD            PIC X.
  1228               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1229               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1230             20  FILLER                     PIC X.
  1231
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  23
* SOCK03.cbl
  1232         16  CF-CREDIT-MISC-CONTROLS.
  1233             20  CF-REIN-TABLE-SW           PIC X.
  1234                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1235             20  CF-COMP-TABLE-SW           PIC X.
  1236                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1237             20  CF-EXPERIENCE-RETENTION-AGE
  1238                                            PIC S9        COMP-3.
  1239             20  CF-CONVERSION-DT           PIC XX.
  1240             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1241             20  CF-RUN-FREQUENCY-SW        PIC X.
  1242                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1243                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1244
  1245             20  CF-CR-CHECK-NO-CONTROL.
  1246                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1247                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1248                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1249                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1250                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1251                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1252
  1253                 24  CF-CR-CHECK-COUNT       REDEFINES
  1254                     CF-CR-CHECK-COUNTER      PIC X(4).
  1255
  1256                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1257                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1258
  1259                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1260                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1261                 24  CF-MAIL-PROCESSING       PIC X.
  1262                     88  MAIL-PROCESSING          VALUE 'Y'.
  1263
  1264         16  CF-MISC-SYSTEM-CONTROL.
  1265             20  CF-SYSTEM-C                 PIC X.
  1266                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1267             20  CF-SYSTEM-D                 PIC X.
  1268                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1269             20  CF-SOC-SEC-NO-SW            PIC X.
  1270                 88  SOC-SEC-NO-USED             VALUE '1'.
  1271             20  CF-MEMBER-NO-SW             PIC X.
  1272                 88  MEMBER-NO-USED              VALUE '1'.
  1273             20  CF-TAX-ID-NUMBER            PIC X(11).
  1274             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1275             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1276                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1277                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1278                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1279                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1280             20  CF-SYSTEM-E                 PIC X.
  1281                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1282
  1283         16  CF-LGX-LIFE-USER               PIC X.
  1284             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1285             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1286
  1287         16  CF-CR-MONTH-END-DT             PIC XX.
  1288
  1289         16  CF-FILE-MAINT-DATES.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  24
* SOCK03.cbl
  1290             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1291                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1292             20  CF-LAST-BATCH       REDEFINES
  1293                 CF-LAST-BATCH-NO               PIC X(4).
  1294             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1295             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1296             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1297             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1298             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1299             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1300             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1301             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1302             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1303             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1304
  1305         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1306         16  FILLER                         PIC X.
  1307
  1308         16  CF-ALT-MORT-CODE               PIC X(4).
  1309         16  CF-MEMBER-CAPTION              PIC X(10).
  1310
  1311         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1312             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1313             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1314             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1315             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1316             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1317
  1318         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1319
  1320         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1321         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1322         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1323         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1324
  1325         16  CF-AH-OVERRIDE-L1              PIC X.
  1326         16  CF-AH-OVERRIDE-L2              PIC XX.
  1327         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1328         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1329
  1330         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1331         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1332
  1333         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1334         16  CF-AR-LAST-EL860-DT            PIC XX.
  1335         16  CF-MP-MONTH-END-DT             PIC XX.
  1336
  1337         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1338         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1339             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1340
  1341         16  CF-AR-MONTH-END-DT             PIC XX.
  1342
  1343         16  CF-CRDTCRD-USER                PIC X.
  1344             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1345             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1346
  1347         16  CF-CC-MONTH-END-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  25
* SOCK03.cbl
  1348
  1349         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1350
  1351         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1352             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1353             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1354             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1355         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1356         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1357         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1358         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1359             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1360             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1361         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1362         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1363         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1364             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1365         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1366
  1367         16  CF-CL-ZIP-CODE.
  1368             20  CF-CL-ZIP-PRIME.
  1369                 24  CF-CL-ZIP-1ST          PIC X.
  1370                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1371                 24  FILLER                 PIC X(4).
  1372             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1373         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1374             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1375             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1376             20  FILLER                     PIC XXX.
  1377
  1378         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1379         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1380         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1381         16  CF-CO-OPTION-START-DATE        PIC XX.
  1382         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1383           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1384                                                      '3' '4'.
  1385           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1386           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1387           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1388           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1389           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1390           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1391
  1392         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1393
  1394         16  CF-PAYMENT-APPROVAL-LEVELS.
  1395             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1396             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1397             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1398             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1399             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1400             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1401
  1402         16  CF-END-USER-REPORTING-USER     PIC X.
  1403             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1404             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1405
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  26
* SOCK03.cbl
  1406         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1407             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1408             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1409
  1410         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1411
  1412         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1413         16  FILLER                         PIC X.
  1414
  1415         16  CF-CREDIT-ARCHIVE-CNTL.
  1416             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1417             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1418             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1419
  1420         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1421
  1422         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1423             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1424             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1425
  1426         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1427             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1428             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1429
  1430         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1431
  1432         16  CF-CO-ACH-ID-CODE              PIC  X.
  1433             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1434             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1435             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1436         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1437         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1438         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1439         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1440         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1441         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1442         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1443         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1444         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1445                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1446         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1447                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1448
  1449         16  CF-CO-OVER-SHORT.
  1450             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1451             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1452
  1453*         16  FILLER                         PIC X(102).
  1454         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1455             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1456             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1457
  1458         16  CF-AH-APPROVAL-DAYS.
  1459             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1460             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1461             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1462             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1463
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  27
* SOCK03.cbl
  1464         16  FILLER                         PIC X(82).
  1465****************************************************************
  1466*             PROCESSOR/USER RECORD                            *
  1467****************************************************************
  1468
  1469     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1470         16  CF-PROCESSOR-NAME              PIC X(30).
  1471         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1472         16  CF-PROCESSOR-TITLE             PIC X(26).
  1473         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1474                 88  MESSAGE-YES                VALUE 'Y'.
  1475                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1476
  1477*****************************************************
  1478****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1479****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1480****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1481****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1482*****************************************************
  1483
  1484         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1485             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1486             20  CF-APPLICATION-FORCE       PIC X.
  1487             20  CF-INDIVIDUAL-APP.
  1488                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1489                     28  CF-BROWSE-APP      PIC X.
  1490                     28  CF-UPDATE-APP      PIC X.
  1491
  1492         16  CF-CURRENT-TERM-ON             PIC X(4).
  1493         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1494             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1495             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1496             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1497             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1498             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1499             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1500             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1501         16  CF-PROCESSOR-CARRIER           PIC X.
  1502             88  NO-CARRIER-SECURITY            VALUE ' '.
  1503         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1504             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1505         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1506             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1507         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1508             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1509
  1510         16  CF-PROC-SYS-ACCESS-SW.
  1511             20  CF-PROC-CREDIT-CLAIMS-SW.
  1512                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1513                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1514                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1515                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1516             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1517                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1518                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1519             20  CF-PROC-LIFE-GNRLDGR-SW.
  1520                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1521                     88  ACCESS-TO-LIFE             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  28
* SOCK03.cbl
  1522                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1523                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1524             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1525                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1526                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1527         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1528             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1529             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1530         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1531
  1532         16  CF-APPROVAL-LEVEL                  PIC X.
  1533             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1534             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1535             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1536             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1537
  1538         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1539
  1540         16  CF-LANGUAGE-TYPE                   PIC X.
  1541             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1542             88  CF-LANG-IS-FR                      VALUE 'F'.
  1543
  1544         16  CF-CSR-IND                         PIC X.
  1545         16  FILLER                             PIC X(239).
  1546
  1547****************************************************************
  1548*             PROCESSOR/REMINDERS RECORD                       *
  1549****************************************************************
  1550
  1551     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1552         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1553             20  CF-START-REMIND-DT         PIC XX.
  1554             20  CF-END-REMIND-DT           PIC XX.
  1555             20  CF-REMINDER-TEXT           PIC X(50).
  1556         16  FILLER                         PIC X(296).
  1557
  1558
  1559****************************************************************
  1560*             STATE MASTER RECORD                              *
  1561****************************************************************
  1562
  1563     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1564         16  CF-STATE-ABBREVIATION          PIC XX.
  1565         16  CF-STATE-NAME                  PIC X(25).
  1566         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1567         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1568             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1569             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1570             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1571             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1572                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1573                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1574             20  CF-ST-PREM-REJECT-SW       PIC X.
  1575                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1576                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1577             20  CF-ST-REF-REJECT-SW        PIC X.
  1578                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1579                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  29
* SOCK03.cbl
  1580         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1581         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1582         16  CF-ST-REFUND-RULES.
  1583             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1584             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1585             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1586         16  CF-ST-FST-PMT-EXTENSION.
  1587             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1588             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1589                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1590                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1591                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1592                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1593         16  CF-ST-STATE-CALL.
  1594             20  CF-ST-CALL-UNEARNED        PIC X.
  1595             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1596             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1597         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1598             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1599             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1600         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1601         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1602         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1603         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1604         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1605         16  FILLER                         PIC X.
  1606         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1607             20  CF-ST-BENEFIT-CD           PIC XX.
  1608             20  CF-ST-BENEFIT-KIND         PIC X.
  1609                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1610                 88  CF-ST-AH-KIND              VALUE 'A'.
  1611             20  CF-ST-REM-TERM-CALC        PIC X.
  1612                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1613                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1614                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1615                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1616                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1617                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1618                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1619                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1620
  1621             20  CF-ST-REFUND-CALC          PIC X.
  1622                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1623                 88  ST-REFD-BY-R78             VALUE '1'.
  1624                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1625                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1626                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1627                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1628                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1629                 88  ST-REFD-UTAH               VALUE '7'.
  1630                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1631                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1632                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1633
  1634             20  CF-ST-EARNING-CALC         PIC X.
  1635                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1636                 88  ST-EARN-BY-R78             VALUE '1'.
  1637                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  30
* SOCK03.cbl
  1638                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1639                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1640                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1641                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1642                 88  ST-EARN-MEAN               VALUE '8'.
  1643                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1644
  1645             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1646                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1647                 88  ST-OVRD-BY-R78             VALUE '1'.
  1648                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1649                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1650                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1651                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1652                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1653                 88  ST-OVRD-MEAN               VALUE '8'.
  1654                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1655             20  FILLER                     PIC X.
  1656
  1657         16  CF-ST-COMMISSION-CAPS.
  1658             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1659             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1660             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1661             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1662         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1663                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1664
  1665         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1666
  1667         16  CF-ST-STATUTORY-INTEREST.
  1668             20  CF-ST-STAT-DATE-FROM       PIC X.
  1669                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1670                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1671             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1672             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1673             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1674             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1675             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1676
  1677         16  CF-ST-OVER-SHORT.
  1678             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1679             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1680
  1681         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1682
  1683         16  CF-ST-RT-CALC                  PIC X.
  1684
  1685         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1686         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1687         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1688         16  CF-ST-RF-LR-CALC               PIC X.
  1689         16  CF-ST-RF-LL-CALC               PIC X.
  1690         16  CF-ST-RF-LN-CALC               PIC X.
  1691         16  CF-ST-RF-AH-CALC               PIC X.
  1692         16  CF-ST-RF-CP-CALC               PIC X.
  1693*        16  FILLER                         PIC X(206).
  1694*CIDMOD         16  FILLER                         PIC X(192).
  1695         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  31
* SOCK03.cbl
  1696             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1697         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1698         16  CF-ST-VFY-2ND-BENE             PIC X.
  1699         16  FILLER                         PIC X(186).
  1700
  1701****************************************************************
  1702*             BENEFIT MASTER RECORD                            *
  1703****************************************************************
  1704
  1705     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1706         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1707             20  CF-BENEFIT-CODE            PIC XX.
  1708             20  CF-BENEFIT-NUMERIC  REDEFINES
  1709                 CF-BENEFIT-CODE            PIC XX.
  1710             20  CF-BENEFIT-ALPHA           PIC XXX.
  1711             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1712             20  CF-BENEFIT-COMMENT         PIC X(10).
  1713
  1714             20  CF-LF-COVERAGE-TYPE        PIC X.
  1715                 88  CF-REDUCING                VALUE 'R'.
  1716                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1717
  1718             20  CF-SPECIAL-CALC-CD         PIC X.
  1719                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1720                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1721                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1722                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1723                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1724                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1725                 88  CF-FARM-PLAN               VALUE 'F'.
  1726                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1727                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1728                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1729                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1730                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1731                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1732                 88  CF-PRUDENTIAL              VALUE 'P'.
  1733                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1734                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1735                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1736                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1737                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1738                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1739
  1740             20  CF-JOINT-INDICATOR         PIC X.
  1741                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1742
  1743*            20  FILLER                     PIC X(12).
  1744             20  FILLER                     PIC X(11).
  1745             20  CF-BENEFIT-CATEGORY        PIC X.
  1746             20  CF-LOAN-TYPE               PIC X(8).
  1747
  1748             20  CF-CO-REM-TERM-CALC        PIC X.
  1749                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1750                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1751                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1752                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1753                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  32
* SOCK03.cbl
  1754
  1755             20  CF-CO-EARNINGS-CALC        PIC X.
  1756                 88  CO-EARN-BY-R78             VALUE '1'.
  1757                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1758                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1759                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1760                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1761                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1762                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1763                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1764
  1765             20  CF-CO-REFUND-CALC          PIC X.
  1766                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1767                 88  CO-REFD-BY-R78             VALUE '1'.
  1768                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1769                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1770                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1771                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1772                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1773                 88  CO-REFD-MEAN               VALUE '8'.
  1774                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1775                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1776                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1777
  1778             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1779                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1780                 88  CO-OVRD-BY-R78             VALUE '1'.
  1781                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1782                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1783                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1784                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1785                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1786                 88  CO-OVRD-MEAN               VALUE '8'.
  1787                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1788
  1789             20  CF-CO-BEN-I-G-CD           PIC X.
  1790                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1791                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1792                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1793
  1794         16  FILLER                         PIC X(304).
  1795
  1796
  1797****************************************************************
  1798*             CARRIER MASTER RECORD                            *
  1799****************************************************************
  1800
  1801     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1802         16  CF-ADDRESS-DATA.
  1803             20  CF-MAIL-TO-NAME            PIC X(30).
  1804             20  CF-IN-CARE-OF              PIC X(30).
  1805             20  CF-ADDRESS-LINE-1          PIC X(30).
  1806             20  CF-ADDRESS-LINE-2          PIC X(30).
  1807             20  CF-CITY-STATE              PIC X(30).
  1808             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1809             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1810
  1811         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  33
* SOCK03.cbl
  1812             20  CF-CLAIM-NO-METHOD         PIC X.
  1813                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1814                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1815                 88  CLAIM-NO-SEQ               VALUE '3'.
  1816                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1817             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1818                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1819                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1820                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1821
  1822         16  CF-CHECK-NO-CONTROL.
  1823             20  CF-CHECK-NO-METHOD         PIC X.
  1824                 88  CHECK-NO-MANUAL            VALUE '1'.
  1825                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1826                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1827                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1828             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1829                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1830
  1831         16  CF-DOMICILE-STATE              PIC XX.
  1832
  1833         16  CF-EXPENSE-CONTROLS.
  1834             20  CF-EXPENSE-METHOD          PIC X.
  1835                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1836                 88  DOLLARS-PER-PMT            VALUE '2'.
  1837                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1838                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1839             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1840             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1841
  1842         16  CF-CORRESPONDENCE-CONTROL.
  1843             20  CF-LETTER-RESEND-OPT       PIC X.
  1844                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1845                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1846             20  FILLER                     PIC X(4).
  1847
  1848         16  CF-RESERVE-CONTROLS.
  1849             20  CF-MANUAL-SW               PIC X.
  1850                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1851             20  CF-FUTURE-SW               PIC X.
  1852                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1853             20  CF-PTC-SW                  PIC X.
  1854                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1855             20  CF-IBNR-SW                 PIC X.
  1856                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1857             20  CF-PTC-LF-SW               PIC X.
  1858                 88  CF-LF-PTC-USED             VALUE '1'.
  1859             20  CF-CDT-ACCESS-METHOD       PIC X.
  1860                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1861                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1862                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1863             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1864
  1865         16  CF-CLAIM-CALC-METHOD           PIC X.
  1866             88  360-PLUS-MONTHS                VALUE '1'.
  1867             88  365-PLUS-MONTHS                VALUE '2'.
  1868             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1869             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  34
* SOCK03.cbl
  1870             88  365-DAILY                      VALUE '5'.
  1871
  1872         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1873         16  FILLER                         PIC X(11).
  1874
  1875         16  CF-LIMIT-AMOUNTS.
  1876             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1877             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1878             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1879             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1880             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1881             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1882             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1883             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1884             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1885             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1886
  1887         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1888         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1889         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1890
  1891         16  CF-ZIP-CODE.
  1892             20  CF-ZIP-PRIME.
  1893                 24  CF-ZIP-1ST             PIC X.
  1894                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1895                 24  FILLER                 PIC X(4).
  1896             20  CF-ZIP-PLUS4               PIC X(4).
  1897         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1898             20  CF-CAN-POSTAL-1            PIC XXX.
  1899             20  CF-CAN-POSTAL-2            PIC XXX.
  1900             20  FILLER                     PIC XXX.
  1901
  1902         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1903         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1904         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1905
  1906         16  CF-RATING-SWITCH               PIC X.
  1907             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1908             88  CF-NO-RATING                   VALUE 'N'.
  1909
  1910         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1911
  1912         16  CF-CARRIER-OVER-SHORT.
  1913             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1914             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1915
  1916         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1917         16  CF-SECPAY-SWITCH               PIC X.
  1918             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1919             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1920         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1921         16  FILLER                         PIC X(448).
  1922*        16  FILLER                         PIC X(452).
  1923
  1924
  1925****************************************************************
  1926*             MORTALITY MASTER RECORD                          *
  1927****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  35
* SOCK03.cbl
  1928
  1929     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1930         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1931                                INDEXED BY CF-MORT-NDX.
  1932             20  CF-MORT-TABLE              PIC X(5).
  1933             20  CF-MORT-TABLE-TYPE         PIC X.
  1934                 88  CF-MORT-JOINT              VALUE 'J'.
  1935                 88  CF-MORT-SINGLE             VALUE 'S'.
  1936                 88  CF-MORT-COMBINED           VALUE 'C'.
  1937                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1938                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1939             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1940             20  CF-MORT-AGE-METHOD         PIC XX.
  1941                 88  CF-AGE-LAST                VALUE 'AL'.
  1942                 88  CF-AGE-NEAR                VALUE 'AN'.
  1943             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1944             20  CF-MORT-ADJUSTMENT-DIRECTION
  1945                                            PIC X.
  1946                 88  CF-MINUS                   VALUE '-'.
  1947                 88  CF-PLUS                    VALUE '+'.
  1948             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1949             20  CF-MORT-JOINT-CODE         PIC X.
  1950                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1951             20  CF-MORT-PC-Q               PIC X.
  1952                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1953             20  CF-MORT-TABLE-CODE         PIC X(4).
  1954             20  CF-MORT-COMMENTS           PIC X(15).
  1955             20  FILLER                     PIC X(14).
  1956
  1957         16  FILLER                         PIC X(251).
  1958
  1959
  1960****************************************************************
  1961*             BUSSINESS TYPE MASTER RECORD                     *
  1962****************************************************************
  1963
  1964     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1965* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1966* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1967* AND RECORD 05 IS TYPES 81-99
  1968         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1969             20  CF-BUSINESS-TITLE          PIC  X(19).
  1970             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1971                                            PIC S9V9(4) COMP-3.
  1972             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1973             20  FILLER                     PIC  X.
  1974         16  FILLER                         PIC  X(248).
  1975
  1976
  1977****************************************************************
  1978*             TERMINAL MASTER RECORD                           *
  1979****************************************************************
  1980
  1981     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1982
  1983         16  CF-COMPANY-TERMINALS.
  1984             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1985                                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  36
* SOCK03.cbl
  1986         16  FILLER               PIC X(248).
  1987
  1988
  1989****************************************************************
  1990*             LIFE EDIT MASTER RECORD                          *
  1991****************************************************************
  1992
  1993     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1994         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1995             20  CF-LIFE-CODE-IN            PIC XX.
  1996             20  CF-LIFE-CODE-OUT           PIC XX.
  1997         16  FILLER                         PIC X(248).
  1998
  1999
  2000****************************************************************
  2001*             AH EDIT MASTER RECORD                            *
  2002****************************************************************
  2003
  2004     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2005         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2006             20  CF-AH-CODE-IN              PIC XXX.
  2007             20  CF-AH-CODE-OUT             PIC XX.
  2008         16  FILLER                         PIC X(248).
  2009
  2010
  2011****************************************************************
  2012*             CREDIBILITY TABLES                               *
  2013****************************************************************
  2014
  2015     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2016         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2017                             INDEXED BY CF-CRDB-NDX.
  2018             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2019             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2020             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2021         16  FILLER                         PIC  X(332).
  2022
  2023
  2024****************************************************************
  2025*             REPORT CUSTOMIZATION RECORD                      *
  2026****************************************************************
  2027
  2028     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2029         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2030             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2031             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2032             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2033**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2034****       A T-TRANSFER.                                   ****
  2035             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2036
  2037         16  FILLER                         PIC XX.
  2038
  2039         16  CF-CARRIER-CNTL-OPT.
  2040             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2041                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2042                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2043             20  CF-CARRIER-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  37
* SOCK03.cbl
  2044                                            PIC X.
  2045         16  CF-GROUP-CNTL-OPT.
  2046             20  CF-GROUP-OPT-SEQ           PIC 9.
  2047                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2048                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2049             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2050                                            PIC X(6).
  2051         16  CF-STATE-CNTL-OPT.
  2052             20  CF-STATE-OPT-SEQ           PIC 9.
  2053                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2054                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2055             20  CF-STATE-SELECT OCCURS 3 TIMES
  2056                                            PIC XX.
  2057         16  CF-ACCOUNT-CNTL-OPT.
  2058             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2059                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2060                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2061             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2062                                            PIC X(10).
  2063         16  CF-BUS-TYP-CNTL-OPT.
  2064             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2065                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2066                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2067             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2068                                            PIC XX.
  2069         16  CF-LF-TYP-CNTL-OPT.
  2070             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2071                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2072                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2073             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2074                                            PIC XX.
  2075         16  CF-AH-TYP-CNTL-OPT.
  2076             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2077                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2078                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2079             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2080                                            PIC XX.
  2081         16  CF-REPTCD1-CNTL-OPT.
  2082             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2083                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2084                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2085             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2086                                            PIC X(10).
  2087         16  CF-REPTCD2-CNTL-OPT.
  2088             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2089                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2090                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2091             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2092                                            PIC X(10).
  2093         16  CF-USER1-CNTL-OPT.
  2094             20  CF-USER1-OPT-SEQ           PIC 9.
  2095                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2096                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2097             20  CF-USER1-SELECT OCCURS 3 TIMES
  2098                                            PIC X(10).
  2099         16  CF-USER2-CNTL-OPT.
  2100             20  CF-USER2-OPT-SEQ           PIC 9.
  2101                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  38
* SOCK03.cbl
  2102                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2103             20  CF-USER2-SELECT OCCURS 3 TIMES
  2104                                            PIC X(10).
  2105         16  CF-USER3-CNTL-OPT.
  2106             20  CF-USER3-OPT-SEQ           PIC 9.
  2107                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2108                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2109             20  CF-USER3-SELECT OCCURS 3 TIMES
  2110                                            PIC X(10).
  2111         16  CF-USER4-CNTL-OPT.
  2112             20  CF-USER4-OPT-SEQ           PIC 9.
  2113                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2114                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2115             20  CF-USER4-SELECT OCCURS 3 TIMES
  2116                                            PIC X(10).
  2117         16  CF-USER5-CNTL-OPT.
  2118             20  CF-USER5-OPT-SEQ           PIC 9.
  2119                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2120                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2121             20  CF-USER5-SELECT OCCURS 3 TIMES
  2122                                            PIC X(10).
  2123         16  CF-REINS-CNTL-OPT.
  2124             20  CF-REINS-OPT-SEQ           PIC 9.
  2125                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2126                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2127             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2128                 24  CF-REINS-PRIME         PIC XXX.
  2129                 24  CF-REINS-SUB           PIC XXX.
  2130
  2131         16  CF-AGENT-CNTL-OPT.
  2132             20  CF-AGENT-OPT-SEQ           PIC 9.
  2133                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2134                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2135             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2136                                            PIC X(10).
  2137
  2138         16  FILLER                         PIC X(43).
  2139
  2140         16  CF-LOSS-RATIO-SELECT.
  2141             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2142             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2143         16  CF-ENTRY-DATE-SELECT.
  2144             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2145             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2146         16  CF-EFFECTIVE-DATE-SELECT.
  2147             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2148             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2149
  2150         16  CF-EXCEPTION-LIST-IND          PIC X.
  2151             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2152
  2153         16  FILLER                         PIC X(318).
  2154
  2155****************************************************************
  2156*                  EXCEPTION REPORTING RECORD                  *
  2157****************************************************************
  2158
  2159     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  39
* SOCK03.cbl
  2160         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2161             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2162
  2163         16  CF-COMBINED-LIFE-AH-OPT.
  2164             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2165             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2166             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2167             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2168
  2169         16  CF-LIFE-OPT.
  2170             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2171             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2172             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2173             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2174             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2175             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2176             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2177             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2178             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2179             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2180
  2181         16  CF-AH-OPT.
  2182             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2183             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2184             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2185             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2186             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2187             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2188             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2189             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2190             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2191             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2192
  2193         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2194             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2195             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2196             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2197
  2198         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2199
  2200         16  FILLER                         PIC X(673).
  2201
  2202
  2203****************************************************************
  2204*             MORTGAGE SYSTEM PLAN RECORD                      *
  2205****************************************************************
  2206
  2207     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2208         16  CF-PLAN-TYPE                   PIC X.
  2209             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2210             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2211             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2212         16  CF-PLAN-ABBREV                 PIC XXX.
  2213         16  CF-PLAN-DESCRIPT               PIC X(10).
  2214         16  CF-PLAN-NOTES                  PIC X(20).
  2215         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2216         16  CF-PLAN-UNDERWRITING.
  2217             20  CF-PLAN-TERM-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  40
* SOCK03.cbl
  2218                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2219                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2220             20  CF-PLAN-AGE-DATA.
  2221                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2222                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2223                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2224             20  CF-PLAN-BENEFIT-DATA.
  2225                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2226                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2227                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2228                                            PIC S9(7)V99  COMP-3.
  2229         16  CF-PLAN-POLICY-FORMS.
  2230             20  CF-POLICY-FORM             PIC X(12).
  2231             20  CF-MASTER-APPLICATION      PIC X(12).
  2232             20  CF-MASTER-POLICY           PIC X(12).
  2233         16  CF-PLAN-RATING.
  2234             20  CF-RATE-CODE               PIC X(5).
  2235             20  CF-SEX-RATING              PIC X.
  2236                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2237                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2238             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2239             20  CF-SUB-STD-TYPE            PIC X.
  2240                 88  CF-PCT-OF-PREM            VALUE '1'.
  2241                 88  CF-PCT-OF-BENE            VALUE '2'.
  2242         16  CF-PLAN-PREM-TOLERANCES.
  2243             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2244             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2245         16  CF-PLAN-PYMT-TOLERANCES.
  2246             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2247             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2248         16  CF-PLAN-MISC-DATA.
  2249             20  FILLER                     PIC X.
  2250             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2251             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2252         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2253         16  CF-PLAN-IND-GRP                PIC X.
  2254             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2255                                                     '1'.
  2256             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2257                                                     '2'.
  2258         16  CF-MIB-SEARCH-SW               PIC X.
  2259             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2260             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2261             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2262             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2263         16  CF-ALPHA-SEARCH-SW             PIC X.
  2264             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2265             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2266             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2267             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2268             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2269             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2270             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2271             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2272             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2273             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2274                                                     'A' 'B' 'C'
  2275                                                     'X' 'Y' 'Z'.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  41
* SOCK03.cbl
  2276         16  CF-EFF-DT-RULE-SW              PIC X.
  2277             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2278             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2279             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2280             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2281             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2282         16  FILLER                         PIC X(4).
  2283         16  CF-HEALTH-QUESTIONS            PIC X.
  2284             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2285         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2286         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2287         16  CF-PLAN-SNGL-JNT               PIC X.
  2288             88  CF-COMBINED-PLAN              VALUE 'C'.
  2289             88  CF-JNT-PLAN                   VALUE 'J'.
  2290             88  CF-SNGL-PLAN                  VALUE 'S'.
  2291         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2292         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2293         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2294         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2295         16  CF-RERATE-CNTL                 PIC  X.
  2296             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2297             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2298             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2299             88  CF-AUTO-RECALC                 VALUE '4'.
  2300         16  CF-BENEFIT-TYPE                PIC  X.
  2301             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2302             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2303         16  CF-POLICY-FEE                  PIC S999V99
  2304                                                    COMP-3.
  2305         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2306         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2307         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2308         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2309         16  FILLER                         PIC  X(32).
  2310         16  CF-TERMINATION-FORM            PIC  X(04).
  2311         16  FILLER                         PIC  X(08).
  2312         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2313                                                       COMP-3.
  2314         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2315         16  CF-ISSUE-LETTER                PIC  X(4).
  2316         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2317         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2318             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2319             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2320         16  CF-MP-REFUND-CALC              PIC X.
  2321             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2322             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2323             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2324             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2325             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2326             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2327             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2328             88  CF-MP-REFD-MEAN                VALUE '8'.
  2329         16  CF-ALT-RATE-CODE               PIC  X(5).
  2330
  2331
  2332         16  FILLER                         PIC X(498).
  2333****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  42
* SOCK03.cbl
  2334*             MORTGAGE COMPANY MASTER RECORD                   *
  2335****************************************************************
  2336
  2337     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2338         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2339         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2340             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2341             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2342             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2343             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2344             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2345
  2346         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2347         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2348         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2349         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2350         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2351
  2352         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2353             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2354         16  CF-MP-RECON-USE-IND            PIC X(1).
  2355             88  CF-MP-USE-RECON             VALUE 'Y'.
  2356         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2357             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2358         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2359             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2360             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2361         16  FILLER                         PIC X(1).
  2362         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2363             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2364         16  CF-MORTG-MIB-VERSION           PIC X.
  2365             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2366             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2367             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2368         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2369             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2370                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2371             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2372                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2373             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2374                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2375             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2376                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2377             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2378                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2379             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2380                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2381         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2382         16  FILLER                         PIC X(7).
  2383         16  CF-MORTG-DESTINATION-SYMBOL.
  2384             20  CF-MORTG-MIB-COMM          PIC X(5).
  2385             20  CF-MORTG-MIB-TERM          PIC X(5).
  2386         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2387             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2388         16  FILLER                         PIC X(03).
  2389         16  CF-MP-CHECK-NO-CONTROL.
  2390             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2391                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  43
* SOCK03.cbl
  2392                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2393                                                ' ' LOW-VALUES.
  2394                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2395                                               VALUE '3'.
  2396         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2397         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2398         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2399             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2400                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2401             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2402                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2403             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2404                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2405             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2406                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2407             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2408                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2409             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2410                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2411         16  CF-MORTG-BILLING-AREA.
  2412             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2413                                            PIC X.
  2414         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2415         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2416         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2417         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2418             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2419             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2420         16  FILLER                         PIC X.
  2421         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2422             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2423             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2424         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2425         16  FILLER                         PIC X(8).
  2426         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2427         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2428         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2429         16  CF-ACH-COMPANY-ID.
  2430             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2431                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2432                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2433                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2434             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2435         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2436             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2437         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2438             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2439             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2440         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2441         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2442         16  FILLER                         PIC X(536).
  2443
  2444****************************************************************
  2445*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2446****************************************************************
  2447
  2448     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2449         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  44
* SOCK03.cbl
  2450             20  CF-FEMALE-HEIGHT.
  2451                 24  CF-FEMALE-FT           PIC 99.
  2452                 24  CF-FEMALE-IN           PIC 99.
  2453             20  CF-FEMALE-MIN-WT           PIC 999.
  2454             20  CF-FEMALE-MAX-WT           PIC 999.
  2455         16  FILLER                         PIC X(428).
  2456
  2457     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2458         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2459             20  CF-MALE-HEIGHT.
  2460                 24  CF-MALE-FT             PIC 99.
  2461                 24  CF-MALE-IN             PIC 99.
  2462             20  CF-MALE-MIN-WT             PIC 999.
  2463             20  CF-MALE-MAX-WT             PIC 999.
  2464         16  FILLER                         PIC X(428).
  2465******************************************************************
  2466*             AUTOMATIC ACTIVITY RECORD                          *
  2467******************************************************************
  2468     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2469         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2470             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2471             20  CF-SYS-LETTER-ID           PIC X(04).
  2472             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2473             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2474             20  CF-SYS-RESET-SW            PIC X(01).
  2475             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2476             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2477
  2478         16  FILLER                         PIC X(50).
  2479
  2480         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2481             20  CF-USER-ACTIVE-SW          PIC X(01).
  2482             20  CF-USER-LETTER-ID          PIC X(04).
  2483             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2484             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2485             20  CF-USER-RESET-SW           PIC X(01).
  2486             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2487             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2488             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2489
  2490         16  FILLER                         PIC X(246).
  2491*                                 COPY ERCACCT.
  2492******************************************************************
  2493*                                                                *
  2494*                                                                *
  2495*                            ERCACCT                             *
  2496*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2497*                            VMOD=2.031                          *
  2498*                                                                *
  2499*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2500*                                                                *
  2501*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2502*   VSAM ACCOUNT MASTER FILES.                                   *
  2503*                                                                *
  2504*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2505*                                                                *
  2506*   FILE TYPE = VSAM,KSDS                                        *
  2507*   RECORD SIZE = 2000  RECFORM = FIX                            *
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  45
* SOCK03.cbl
  2508*                                                                *
  2509*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2510*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2511*                                                                *
  2512*   LOG = NO                                                     *
  2513*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2514*                                                                *
  2515*                                                                *
  2516******************************************************************
  2517*                   C H A N G E   L O G
  2518*
  2519* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2520*-----------------------------------------------------------------
  2521*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2522* EFFECTIVE    NUMBER
  2523*-----------------------------------------------------------------
  2524* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2525* 092705    2005050300006  PEMA  ADD SPP LEASES
  2526* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2527* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2528* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2529* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2530* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2531******************************************************************
  2532
  2533 01  ACCOUNT-MASTER.
  2534     12  AM-RECORD-ID                      PIC XX.
  2535         88  VALID-AM-ID                      VALUE 'AM'.
  2536
  2537     12  AM-CONTROL-PRIMARY.
  2538         16  AM-COMPANY-CD                 PIC X.
  2539         16  AM-MSTR-CNTRL.
  2540             20  AM-CONTROL-A.
  2541                 24  AM-CARRIER            PIC X.
  2542                 24  AM-GROUPING.
  2543                     28 AM-GROUPING-PREFIX PIC XXX.
  2544                     28 AM-GROUPING-PRIME  PIC XXX.
  2545                 24  AM-STATE              PIC XX.
  2546                 24  AM-ACCOUNT.
  2547                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2548                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2549             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2550                                           PIC X(19).
  2551             20  AM-CNTRL-B.
  2552                 24  AM-EXPIRATION-DT      PIC XX.
  2553                 24  FILLER                PIC X(4).
  2554             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2555                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2556
  2557     12  AM-CONTROL-BY-VAR-GRP.
  2558         16  AM-COMPANY-CD-A1              PIC X.
  2559         16  AM-VG-CARRIER                 PIC X.
  2560         16  AM-VG-GROUPING                PIC X(6).
  2561         16  AM-VG-STATE                   PIC XX.
  2562         16  AM-VG-ACCOUNT                 PIC X(10).
  2563         16  AM-VG-DATE.
  2564             20  AM-VG-EXPIRATION-DT       PIC XX.
  2565             20  FILLER                    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  46
* SOCK03.cbl
  2566         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2567                                           PIC 9(11)      COMP-3.
  2568     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2569         16  FILLER                        PIC X(10).
  2570         16  AM-VG-KEY3.
  2571             20  AM-VG3-ACCOUNT            PIC X(10).
  2572             20  AM-VG3-EXP-DT             PIC XX.
  2573         16  FILLER                        PIC X(4).
  2574     12  AM-MAINT-INFORMATION.
  2575         16  AM-LAST-MAINT-DT              PIC XX.
  2576         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2577         16  AM-LAST-MAINT-USER            PIC X(4).
  2578         16  FILLER                        PIC XX.
  2579
  2580     12  AM-EFFECTIVE-DT                   PIC XX.
  2581     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2582
  2583     12  AM-PREV-DATES  COMP-3.
  2584         16  AM-PREV-EXP-DT                PIC 9(11).
  2585         16  AM-PREV-EFF-DT                PIC 9(11).
  2586
  2587     12  AM-REPORT-CODE-1                  PIC X(10).
  2588     12  AM-REPORT-CODE-2                  PIC X(10).
  2589
  2590     12  AM-CITY-CODE                      PIC X(4).
  2591     12  AM-COUNTY-PARISH                  PIC X(6).
  2592
  2593     12  AM-NAME                           PIC X(30).
  2594     12  AM-PERSON                         PIC X(30).
  2595     12  AM-ADDRS                          PIC X(30).
  2596     12  AM-CITY.
  2597         16  AM-ADDR-CITY                  PIC X(28).
  2598         16  AM-ADDR-STATE                 PIC XX.
  2599     12  AM-ZIP.
  2600         16  AM-ZIP-PRIME.
  2601             20  AM-ZIP-PRI-1ST            PIC X.
  2602                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2603             20  FILLER                    PIC X(4).
  2604         16  AM-ZIP-PLUS4                  PIC X(4).
  2605     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2606         16  AM-CAN-POSTAL-1               PIC XXX.
  2607         16  AM-CAN-POSTAL-2               PIC XXX.
  2608         16  FILLER                        PIC XXX.
  2609     12  AM-TEL-NO.
  2610         16  AM-AREA-CODE                  PIC 999.
  2611         16  AM-TEL-PRE                    PIC 999.
  2612         16  AM-TEL-NBR                    PIC 9(4).
  2613     12  AM-TEL-LOC                        PIC X.
  2614         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2615         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2616
  2617     12  AM-COMM-STRUCTURE.
  2618         16  AM-DEFN-1.
  2619             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2620                 24  AM-AGT.
  2621                     28  AM-AGT-PREFIX     PIC X(4).
  2622                     28  AM-AGT-PRIME      PIC X(6).
  2623                 24  AM-COM-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  47
* SOCK03.cbl
  2624                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2625                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2626                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2627                 24  AM-RECALC-LV-INDIC    PIC X.
  2628                 24  AM-RETRO-LV-INDIC     PIC X.
  2629                 24  AM-GL-CODES           PIC X.
  2630                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2631                 24  FILLER                PIC X(01).
  2632         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2633             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2634                 24  FILLER                PIC X(11).
  2635                 24  AM-L-COMA             PIC XXX.
  2636                 24  AM-J-COMA             PIC XXX.
  2637                 24  AM-A-COMA             PIC XXX.
  2638                 24  FILLER                PIC X(6).
  2639
  2640     12  AM-COMM-CHANGE-STATUS             PIC X.
  2641         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2642
  2643     12  AM-CSR-CODE                       PIC X(4).
  2644
  2645     12  AM-BILLING-STATUS                 PIC X.
  2646         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2647         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2648     12  AM-AUTO-REFUND-SW                 PIC X.
  2649         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2650         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2651     12  AM-GPCD                           PIC 99.
  2652     12  AM-IG                             PIC X.
  2653         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2654         88  AM-HAS-GROUP                     VALUE '2'.
  2655     12  AM-STATUS                         PIC X.
  2656         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2657         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2658         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2659         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2660         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2661         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2662     12  AM-REMIT-TO                       PIC 99.
  2663     12  AM-ID-NO                          PIC X(11).
  2664
  2665     12  AM-CAL-TABLE                      PIC XX.
  2666     12  AM-LF-DEVIATION                   PIC XXX.
  2667     12  AM-AH-DEVIATION                   PIC XXX.
  2668     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2669     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2670     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2671     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2672     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2673     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2674
  2675     12  AM-USER-FIELDS.
  2676         16  AM-FLD-1                      PIC XX.
  2677         16  AM-FLD-2                      PIC XX.
  2678         16  AM-FLD-3                      PIC XX.
  2679         16  AM-FLD-4                      PIC XX.
  2680         16  AM-FLD-5                      PIC XX.
  2681
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  48
* SOCK03.cbl
  2682     12  AM-1ST-PROD-DATE.
  2683         16  AM-1ST-PROD-YR                PIC XX.
  2684         16  AM-1ST-PROD-MO                PIC XX.
  2685         16  AM-1ST-PROD-DA                PIC XX.
  2686     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2687     12  AM-CERTS-PURGED-DATE.
  2688         16  AM-PUR-YR                     PIC XX.
  2689         16  AM-PUR-MO                     PIC XX.
  2690         16  AM-PUR-DA                     PIC XX.
  2691     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2692     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2693     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2694     12  AM-INACTIVE-DATE.
  2695         16  AM-INA-MO                     PIC 99.
  2696         16  AM-INA-DA                     PIC 99.
  2697         16  AM-INA-YR                     PIC 99.
  2698     12  AM-AR-HI-CERT-DATE                PIC XX.
  2699
  2700     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2701     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2702
  2703     12  AM-OB-PAYMENT-MODE                PIC X.
  2704         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2705         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2706         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2707         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2708
  2709     12  AM-AH-ONLY-INDICATOR              PIC X.
  2710         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2711         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2712
  2713     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2714
  2715     12  AM-OVER-SHORT.
  2716         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2717         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2718
  2719     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2720     12  AM-DCC-CLP-STATE                  PIC XX.
  2721
  2722     12  AM-RECALC-COMM                    PIC X.
  2723     12  AM-RECALC-REIN                    PIC X.
  2724
  2725     12  AM-REI-TABLE                      PIC XXX.
  2726     12  AM-REI-ET-LF                      PIC X.
  2727     12  AM-REI-ET-AH                      PIC X.
  2728     12  AM-REI-PE-LF                      PIC X.
  2729     12  AM-REI-PE-AH                      PIC X.
  2730     12  AM-REI-PRT-ST                     PIC X.
  2731     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2732     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2733     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2734     12  AM-REI-GROUP-A                    PIC X(6).
  2735     12  AM-REI-MORT                       PIC X(4).
  2736     12  AM-REI-PRT-OW                     PIC X.
  2737     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2738     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2739     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  49
* SOCK03.cbl
  2740     12  AM-REI-GROUP-B                    PIC X(6).
  2741
  2742     12  AM-TRUST-TYPE                     PIC X(2).
  2743
  2744     12  AM-EMPLOYER-STMT-USED             PIC X.
  2745     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2746
  2747     12  AM-STD-AH-TYPE                    PIC XX.
  2748     12  AM-EARN-METHODS.
  2749         16  AM-EARN-METHOD-R              PIC X.
  2750             88 AM-REF-RL-R78                 VALUE 'R'.
  2751             88 AM-REF-RL-PR                  VALUE 'P'.
  2752             88 AM-REF-RL-MEAN                VALUE 'M'.
  2753             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2754         16  AM-EARN-METHOD-L              PIC X.
  2755             88 AM-REF-LL-R78                 VALUE 'R'.
  2756             88 AM-REF-LL-PR                  VALUE 'P'.
  2757             88 AM-REF-LL-MEAN                VALUE 'M'.
  2758             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2759         16  AM-EARN-METHOD-A              PIC X.
  2760             88 AM-REF-AH-R78                 VALUE 'R'.
  2761             88 AM-REF-AH-PR                  VALUE 'P'.
  2762             88 AM-REF-AH-MEAN                VALUE 'M'.
  2763             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2764             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2765             88 AM-REF-AH-NET                 VALUE 'N'.
  2766
  2767     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2768     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2769     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2770
  2771     12  AM-RET-Y-N                        PIC X.
  2772     12  AM-RET-P-E                        PIC X.
  2773     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2774     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2775     12  AM-RET-GRP                        PIC X(6).
  2776     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2777         16  AM-POOL-PRIME                 PIC XXX.
  2778         16  AM-POOL-SUB                   PIC XXX.
  2779     12  AM-RETRO-EARNINGS.
  2780         16  AM-RET-EARN-R                 PIC X.
  2781         16  AM-RET-EARN-L                 PIC X.
  2782         16  AM-RET-EARN-A                 PIC X.
  2783     12  AM-RET-ST-TAX-USE                 PIC X.
  2784         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2785         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2786     12  AM-RETRO-BEG-EARNINGS.
  2787         16  AM-RET-BEG-EARN-R             PIC X.
  2788         16  AM-RET-BEG-EARN-L             PIC X.
  2789         16  AM-RET-BEG-EARN-A             PIC X.
  2790     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2791     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2792
  2793     12  AM-USER-SELECT-OPTIONS.
  2794         16  AM-USER-SELECT-1              PIC X(10).
  2795         16  AM-USER-SELECT-2              PIC X(10).
  2796         16  AM-USER-SELECT-3              PIC X(10).
  2797         16  AM-USER-SELECT-4              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  50
* SOCK03.cbl
  2798         16  AM-USER-SELECT-5              PIC X(10).
  2799
  2800     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2801
  2802     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2803
  2804     12  AM-RPT045A-SWITCH                 PIC X.
  2805         88  RPT045A-OFF                   VALUE 'N'.
  2806
  2807     12  AM-INSURANCE-LIMITS.
  2808         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2809         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2810
  2811     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2812         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2813
  2814     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2815         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2816         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2817
  2818     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2819
  2820     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2821     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2822     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2823     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2824     12  AM-DCC-UEF-STATE                  PIC XX.
  2825     12  FILLER                            PIC XXX.
  2826     12  AM-REPORT-CODE-3                  PIC X(10).
  2827*    12  FILLER                            PIC X(22).
  2828
  2829     12  AM-RESERVE-DATE.
  2830         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2831         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2832         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2833
  2834     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2835     12  AM-NOTIFICATION-TYPES.
  2836         16  AM-NOTIF-OF-LETTERS           PIC X.
  2837         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2838         16  AM-NOTIF-OF-REPORTS           PIC X.
  2839         16  AM-NOTIF-OF-STATUS            PIC X.
  2840
  2841     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2842         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2843         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2844         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2845         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2846
  2847     12  AM-BENEFIT-CONTROLS.
  2848         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2849             20  AM-BENEFIT-CODE           PIC XX.
  2850             20  AM-BENEFIT-TYPE           PIC X.
  2851             20  AM-BENEFIT-REVISION       PIC XXX.
  2852             20  AM-BENEFIT-REM-TERM       PIC X.
  2853             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2854             20  FILLER                    PIC XX.
  2855         16  FILLER                        PIC X(80).
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  51
* SOCK03.cbl
  2856
  2857     12  AM-TRANSFER-DATA.
  2858         16  AM-TRANSFERRED-FROM.
  2859             20  AM-TRNFROM-CARRIER        PIC X.
  2860             20  AM-TRNFROM-GROUPING.
  2861                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2862                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2863             20  AM-TRNFROM-STATE          PIC XX.
  2864             20  AM-TRNFROM-ACCOUNT.
  2865                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2866                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2867             20  AM-TRNFROM-DTE            PIC XX.
  2868         16  AM-TRANSFERRED-TO.
  2869             20  AM-TRNTO-CARRIER          PIC X.
  2870             20  AM-TRNTO-GROUPING.
  2871                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2872                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2873             20  AM-TRNTO-STATE            PIC XX.
  2874             20  AM-TRNTO-ACCOUNT.
  2875                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2876                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2877             20  AM-TRNTO-DTE              PIC XX.
  2878         16  FILLER                        PIC X(10).
  2879
  2880     12  AM-SAVED-REMIT-TO                 PIC 99.
  2881
  2882     12  AM-COMM-STRUCTURE-SAVED.
  2883         16  AM-DEFN-1-SAVED.
  2884             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2885                 24  AM-AGT-SV             PIC X(10).
  2886                 24  AM-COM-TYP-SV         PIC X.
  2887                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2888                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2889                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2890                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2891                 24  FILLER                PIC X.
  2892                 24  AM-GL-CODES-SV        PIC X.
  2893                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2894                 24  FILLER                PIC X.
  2895         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2896             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2897                 24  FILLER                PIC X(11).
  2898                 24  AM-L-COMA-SV          PIC XXX.
  2899                 24  AM-J-COMA-SV          PIC XXX.
  2900                 24  AM-A-COMA-SV          PIC XXX.
  2901                 24  FILLER                PIC X(6).
  2902
  2903     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2904         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2905            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2906            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2907            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2908
  2909     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2910     12  FILLER                            PIC X(120).
  2911
  2912     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2913         16  AM-CONTROL-NAME               PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  52
* SOCK03.cbl
  2914         16  AM-EXECUTIVE-ONE.
  2915             20  AM-EXEC1-NAME             PIC X(15).
  2916             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2917                                                          COMP-3.
  2918             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2919                                                          COMP-3.
  2920         16  AM-EXECUTIVE-TWO.
  2921             20  AM-EXEC2-NAME             PIC X(15).
  2922             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2923                                                          COMP-3.
  2924             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2925                                                          COMP-3.
  2926
  2927     12  AM-RETRO-ADDITIONAL-DATA.
  2928         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2929         16  AM-RETRO-PREM-P-E             PIC X.
  2930         16  AM-RETRO-CLMS-P-I             PIC X.
  2931         16  AM-RETRO-RET-BRACKET-LF.
  2932             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2933                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2934                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2935             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2936                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2937                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2938             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2939                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2940                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2941         16  AM-RETRO-RET-BRACKET-AH.
  2942             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2943                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2944                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2945                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2946             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2947                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2948                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2949             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2950                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2951                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2952
  2953     12  AM-COMMENTS.
  2954         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2955
  2956     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2957         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2958         16  AM-FLI-BILLING-CODE           PIC X.
  2959         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2960         16  AM-FLI-UNITED-IDENT           PIC X.
  2961         16  AM-FLI-INTEREST-LOST-DATA.
  2962             20  AM-FLI-BANK-NO            PIC X(5).
  2963             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2964             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2965             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2966         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2967             20  AM-FLI-AGT                PIC X(9).
  2968             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2969             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2970         16  FILLER                        PIC X(102).
  2971
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  53
* SOCK03.cbl
  2972     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2973         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2974             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2975             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2976             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2977             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2978             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2979         16  FILLER                          PIC X(10).
  2980******************************************************************
  2981*                                 COPY ELCDATE.
  2982******************************************************************
  2983*                                                                *
  2984*                                                                *
  2985*                            ELCDATE.                            *
  2986*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2987*                            VMOD=2.003
  2988*                                                                *
  2989*                                                                *
  2990*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2991*                 LENGTH = 200                                   *
  2992******************************************************************
  2993
  2994 01  DATE-CONVERSION-DATA.
  2995     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2996     12  DC-OPTION-CODE                PIC X.
  2997         88  BIN-TO-GREG                VALUE ' '.
  2998         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2999         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3000         88  YMD-GREG-TO-BIN            VALUE '3'.
  3001         88  MDY-GREG-TO-BIN            VALUE '4'.
  3002         88  JULIAN-TO-BIN              VALUE '5'.
  3003         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3004         88  FIND-CENTURY               VALUE '7'.
  3005         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3006         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3007         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3008         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3009         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3010         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3011         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3012         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3013         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3014         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3015         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3016         88  BIN-3-TO-GREG              VALUE 'I'.
  3017         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3018         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3019         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3020         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3021         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3022         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3023         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3024         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3025         88  THREE-CHARACTER-BIN
  3026                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3027         88  GREGORIAN-TO-BIN
  3028                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3029         88  BIN-TO-GREGORIAN
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  54
* SOCK03.cbl
  3030                  VALUES ' ' '1' 'I' '8' 'G'.
  3031         88  JULIAN-TO-BINARY
  3032                  VALUES '5' 'C' 'E' 'F'.
  3033     12  DC-ERROR-CODE                 PIC X.
  3034         88  NO-CONVERSION-ERROR        VALUE ' '.
  3035         88  DATE-CONVERSION-ERROR
  3036                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3037         88  DATE-IS-ZERO               VALUE '1'.
  3038         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3039         88  DATE-IS-INVALID            VALUE '3'.
  3040         88  DATE1-GREATER-DATE2        VALUE '4'.
  3041         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3042         88  DATE-INVALID-OPTION        VALUE '9'.
  3043         88  INVALID-CENTURY            VALUE 'A'.
  3044         88  ONLY-CENTURY               VALUE 'B'.
  3045         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3046         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3047     12  DC-END-OF-MONTH               PIC X.
  3048         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3049     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3050         88  USE-NORMAL-PROCESS         VALUE ' '.
  3051         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3052         88  ADJUST-UP-100-YRS          VALUE '2'.
  3053     12  FILLER                        PIC X.
  3054     12  DC-CONVERSION-DATES.
  3055         16  DC-BIN-DATE-1             PIC XX.
  3056         16  DC-BIN-DATE-2             PIC XX.
  3057         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3058         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3059                       DC-GREG-DATE-1-EDIT.
  3060             20  DC-EDIT1-MONTH        PIC 99.
  3061             20  SLASH1-1              PIC X.
  3062             20  DC-EDIT1-DAY          PIC 99.
  3063             20  SLASH1-2              PIC X.
  3064             20  DC-EDIT1-YEAR         PIC 99.
  3065         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3066         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3067                     DC-GREG-DATE-2-EDIT.
  3068             20  DC-EDIT2-MONTH        PIC 99.
  3069             20  SLASH2-1              PIC X.
  3070             20  DC-EDIT2-DAY          PIC 99.
  3071             20  SLASH2-2              PIC X.
  3072             20  DC-EDIT2-YEAR         PIC 99.
  3073         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3074         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3075                     DC-GREG-DATE-1-YMD.
  3076             20  DC-YMD-YEAR           PIC 99.
  3077             20  DC-YMD-MONTH          PIC 99.
  3078             20  DC-YMD-DAY            PIC 99.
  3079         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3080         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3081                      DC-GREG-DATE-1-MDY.
  3082             20  DC-MDY-MONTH          PIC 99.
  3083             20  DC-MDY-DAY            PIC 99.
  3084             20  DC-MDY-YEAR           PIC 99.
  3085         16  DC-GREG-DATE-1-ALPHA.
  3086             20  DC-ALPHA-MONTH        PIC X(10).
  3087             20  DC-ALPHA-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  55
* SOCK03.cbl
  3088             20  FILLER                PIC XX.
  3089             20  DC-ALPHA-CENTURY.
  3090                 24 DC-ALPHA-CEN-N     PIC 99.
  3091             20  DC-ALPHA-YEAR         PIC 99.
  3092         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3093         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3094         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3095         16  DC-JULIAN-DATE            PIC 9(05).
  3096         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3097                                       PIC 9(05).
  3098         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3099             20  DC-JULIAN-YEAR        PIC 99.
  3100             20  DC-JULIAN-DAYS        PIC 999.
  3101         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3102         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3103         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3104     12  DATE-CONVERSION-VARIBLES.
  3105         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3106         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3107             20  FILLER                PIC 9(3).
  3108             20  HOLD-CEN-1-CCYY.
  3109                 24  HOLD-CEN-1-CC     PIC 99.
  3110                 24  HOLD-CEN-1-YY     PIC 99.
  3111             20  HOLD-CEN-1-MO         PIC 99.
  3112             20  HOLD-CEN-1-DA         PIC 99.
  3113         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3114             20  HOLD-CEN-1-R-MO       PIC 99.
  3115             20  HOLD-CEN-1-R-DA       PIC 99.
  3116             20  HOLD-CEN-1-R-CCYY.
  3117                 24  HOLD-CEN-1-R-CC   PIC 99.
  3118                 24  HOLD-CEN-1-R-YY   PIC 99.
  3119             20  FILLER                PIC 9(3).
  3120         16  HOLD-CENTURY-1-X.
  3121             20  FILLER                PIC X(3)  VALUE SPACES.
  3122             20  HOLD-CEN-1-X-CCYY.
  3123                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3124                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3125             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3126             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3127         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3128             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3129             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3130             20  HOLD-CEN-1-R-X-CCYY.
  3131                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3132                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3133             20  FILLER                PIC XXX.
  3134         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3135         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3136         16  DC-JULIAN-DATE-1          PIC 9(07).
  3137         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3138             20  DC-JULIAN-1-CCYY.
  3139                 24  DC-JULIAN-1-CC    PIC 99.
  3140                 24  DC-JULIAN-1-YR    PIC 99.
  3141             20  DC-JULIAN-DA-1        PIC 999.
  3142         16  DC-JULIAN-DATE-2          PIC 9(07).
  3143         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3144             20  DC-JULIAN-2-CCYY.
  3145                 24  DC-JULIAN-2-CC    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  56
* SOCK03.cbl
  3146                 24  DC-JULIAN-2-YR    PIC 99.
  3147             20  DC-JULIAN-DA-2        PIC 999.
  3148         16  DC-GREG-DATE-A-EDIT.
  3149             20  DC-EDITA-MONTH        PIC 99.
  3150             20  SLASHA-1              PIC X VALUE '/'.
  3151             20  DC-EDITA-DAY          PIC 99.
  3152             20  SLASHA-2              PIC X VALUE '/'.
  3153             20  DC-EDITA-CCYY.
  3154                 24  DC-EDITA-CENT     PIC 99.
  3155                 24  DC-EDITA-YEAR     PIC 99.
  3156         16  DC-GREG-DATE-B-EDIT.
  3157             20  DC-EDITB-MONTH        PIC 99.
  3158             20  SLASHB-1              PIC X VALUE '/'.
  3159             20  DC-EDITB-DAY          PIC 99.
  3160             20  SLASHB-2              PIC X VALUE '/'.
  3161             20  DC-EDITB-CCYY.
  3162                 24  DC-EDITB-CENT     PIC 99.
  3163                 24  DC-EDITB-YEAR     PIC 99.
  3164         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3165         16  DC-GREG-DATE-CYMD-R REDEFINES
  3166                              DC-GREG-DATE-CYMD.
  3167             20  DC-CYMD-CEN           PIC 99.
  3168             20  DC-CYMD-YEAR          PIC 99.
  3169             20  DC-CYMD-MONTH         PIC 99.
  3170             20  DC-CYMD-DAY           PIC 99.
  3171         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3172         16  DC-GREG-DATE-MDCY-R REDEFINES
  3173                              DC-GREG-DATE-MDCY.
  3174             20  DC-MDCY-MONTH         PIC 99.
  3175             20  DC-MDCY-DAY           PIC 99.
  3176             20  DC-MDCY-CEN           PIC 99.
  3177             20  DC-MDCY-YEAR          PIC 99.
  3178    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3179        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3180    12  DC-EL310-DATE                  PIC X(21).
  3181    12  FILLER                         PIC X(28).
  3182*                                 COPY ELCCALC.
  3183******************************************************************
  3184*                                                                *
  3185*                           ELCCALC.                            *
  3186*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3187*                            VMOD=2.025                          *
  3188*                                                                *
  3189*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3190*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3191*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3192*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3193*                                                                *
  3194*  PASSED TO ELRTRM                                              *
  3195*  -----------------                                             *
  3196*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3197*  ORIGINAL TERM                                                 *
  3198*  BEGINNING DATE                                                *
  3199*  ENDING DATE                                                   *
  3200*  COMPANY I.D.                                                  *
  3201*  ACCOUNT MASTER USER FIELD                                     *
  3202*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3203*  FREE LOOK DAYS                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  57
* SOCK03.cbl
  3204*                                                                *
  3205*  RETURNED FROM ELRTRM                                          *
  3206*  ---------------------                                         *
  3207*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3208*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3209*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3210*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3211*----------------------------------------------------------------*
  3212*  PASSED TO ELRAMT                                              *
  3213*  ----------------                                              *
  3214*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3215*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3216*  ORIGINAL AMOUNT                                               *
  3217*  ALTERNATE BENEFIT (BALLON)                                    *
  3218*  A.P.R. - NET PAY ONLY                                         *
  3219*  METHOD
  3220*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3221*  COMPANY I.D.                                                  *
  3222*  BENEFIT TYPE                                                  *
  3223*                                                                *
  3224*  RETURNED FROM ELRAMT                                          *
  3225*  --------------------                                          *
  3226*  REMAINING AMOUNT 1 - CURRENT                                  *
  3227*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3228*  REMAINING AMOUNT FACTOR
  3229*----------------------------------------------------------------*
  3230*  PASSED TO ELRESV                                              *
  3231*  -----------------                                             *
  3232*  CERTIFICATE EFFECTIVE DATE                                    *
  3233*  VALUATION DATE                                                *
  3234*  PAID THRU DATE                                                *
  3235*  BENEFIT                                                       *
  3236*  INCURRED DATE                                                 *
  3237*  REPORTED DATE                                                 *
  3238*  ISSUE AGE                                                     *
  3239*  TERM                                                          *
  3240*  CDT PERCENT                                                   *
  3241*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3242* *CLAIM TYPE (LIFE, A/H)                                        *
  3243* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3244* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3245*                                                                *
  3246*  RETURNED FROM ELRESV                                          *
  3247*  --------------------                                          *
  3248*  CDT TABLE USED                                                *
  3249*  CDT FACTOR USED                                               *
  3250*  PAY TO CURRENT RESERVE                                        *
  3251*  I.B.N.R. - A/H ONLY                                           *
  3252*  FUTURE (ACCRUED) AH ONLY                                      *
  3253*----------------------------------------------------------------*
  3254*  PASSED TO ELRATE                                              *
  3255*  ----------------                                              *
  3256*  CERT ISSUE DATE                                               *
  3257*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3258*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3259*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3260*  STATE CODE (CLIENT DEFINED)                                   *
  3261*  STATE CODE (STANDARD P.O. ABBRV)                              *
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  58
* SOCK03.cbl
  3262*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3263*  DEVIATION CODE                                                *
  3264*  ISSUE AGE                                                     *
  3265*  ORIGINAL BENEFIT AMOUNT                                       *
  3266*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3267*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3268*  BENEFIT KIND (LIFE OR A/H)                                    *
  3269*  A.P.R.                                                        *
  3270*  METHOD
  3271*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3272*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3273*  COMPANY I.D. (3 CHARACTER)                                    *
  3274*  BENEFIT CODE                                                  *
  3275*  BENEFIT OVERRIDE CODE                                         *
  3276*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3277*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3278*  JOINT INDICATOR (CSL ONLY)                                    *
  3279*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3280*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3281*                                                                *
  3282*  RETURNED FROM ELRATE                                          *
  3283*  --------------------                                          *
  3284*  CALCULATED PREMIUM                                            *
  3285*  PREMIUM RATE                                                  *
  3286*  MORTALITY CODE                                                *
  3287*  MAX ATTAINED AGE                                              *
  3288*  MAX AGE                                                       *
  3289*  MAX TERM                                                      *
  3290*  MAX MONTHLY BENEFIT                                           *
  3291*  MAX TOTAL BENIFIT                                             *
  3292*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3293*----------------------------------------------------------------*
  3294*  PASSED TO ELRFND                                              *
  3295*  ----------------                                              *
  3296*  CERT ISSUE DATE                                               *
  3297*  REFUND DATE                                                   *
  3298*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3299*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3300*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3301*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3302*  STATE CODE (CLIENT DEFINED)                                   *
  3303*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3304*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3305*  DEVIATION CODE                                                *
  3306*  ISSUE AGE                                                     *
  3307*  ORIGINAL BENEFIT AMOUNT                                       *
  3308*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3309*  PROCESS TYPE (CANCEL)                                         *
  3310*  BENEFIT KIND (LIFE OR A/H)                                    *
  3311*  A.P.R.                                                        *
  3312*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3313*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3314*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3315*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3316*  COMPANY I.D. (3 CHARACTER)                                    *
  3317*  BENEFIT CODE                                                  *
  3318*  BENEFIT OVERRIDE CODE                                         *
  3319*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  59
* SOCK03.cbl
  3320*  RETURNED FROM ELRFND                                          *
  3321*  --------------------                                          *
  3322*  CALCULATED REFUND                                             *
  3323*----------------------------------------------------------------*
  3324*  PASSED TO ELEARN                                              *
  3325*  ----------------                                              *
  3326*  CERT ISSUE DATE                                               *
  3327*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3328*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3329*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3330*  STATE CODE (CLIENT DEFINED)                                   *
  3331*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3332*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3333*  DEVIATION CODE                                                *
  3334*  ISSUE AGE                                                     *
  3335*  ORIGINAL BENEFIT AMOUNT                                       *
  3336*  BENEFIT KIND (LIFE OR A/H)                                    *
  3337*  A.P.R.                                                        *
  3338*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3339*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3340*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3341*  COMPANY I.D. (3 CHARACTER)                                    *
  3342*  BENEFIT CODE                                                  *
  3343*  BENEFIT OVERRIDE CODE                                         *
  3344*                                                                *
  3345*  RETURNED FROM ELEARN                                          *
  3346*  --------------------                                          *
  3347*  INDICATED  EARNINGS                                           *
  3348*----------------------------------------------------------------*
  3349*                 LENGTH = 450                                   *
  3350*                                                                *
  3351******************************************************************
  3352******************************************************************
  3353*                   C H A N G E   L O G
  3354*
  3355* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3356*-----------------------------------------------------------------
  3357*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3358* EFFECTIVE    NUMBER
  3359*-----------------------------------------------------------------
  3360* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3361* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3362* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3363* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3364* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3365* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3366* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3367* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3368* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3369******************************************************************
  3370
  3371 01  CALCULATION-PASS-AREA.
  3372     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3373                                     COMP.
  3374
  3375     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3376       88  NO-CP-ERROR                             VALUE ZERO.
  3377       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  60
* SOCK03.cbl
  3378                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3379       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3380       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3381       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3382       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3383       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3384       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3385       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3386       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3387       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3388       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3389       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3390       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3391       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3392       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3393       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3394       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3395       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3396
  3397     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3398       88  NO-CP-ERROR-2                           VALUE ZERO.
  3399***********************  INPUT AREAS ****************************
  3400
  3401     12  CP-CALCULATION-AREA.
  3402         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3403         16  CP-CERT-EFF-DT        PIC XX.
  3404         16  CP-VALUATION-DT       PIC XX.
  3405         16  CP-PAID-THRU-DT       PIC XX.
  3406         16  CP-BENEFIT-TYPE       PIC X.
  3407           88  CP-AH                               VALUE 'A' 'D'
  3408                                                   'I' 'U'.
  3409           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3410           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3411         16  CP-INCURRED-DT        PIC XX.
  3412         16  CP-REPORTED-DT        PIC XX.
  3413         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3414         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3415         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3416                                     COMP-3.
  3417         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3418                                     COMP-3.
  3419         16  CP-CDT-METHOD         PIC X.
  3420           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3421           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3422           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3423         16  CP-CLAIM-TYPE         PIC X.
  3424           88  CP-AH-CLAIM                         VALUE 'A'.
  3425           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3426         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3427                                     COMP-3.
  3428         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3429                                     COMP-3.
  3430         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3431                                     COMP-3.
  3432         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3433                                     COMP-3.
  3434         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3435                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  61
* SOCK03.cbl
  3436         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3437                                     COMP-3.
  3438         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3439                                     COMP-3.
  3440         16  CP-REM-TERM-METHOD    PIC X.
  3441           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3442           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3443           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3444           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3445           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3446           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3447           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3448         16  CP-EARNING-METHOD     PIC X.
  3449           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3450           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3451           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3452           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3453           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3454           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3455           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3456           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3457           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3458           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3459           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3460           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3461           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3462           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3463         16  CP-PROCESS-TYPE       PIC X.
  3464           88  CP-CLAIM                            VALUE '1'.
  3465           88  CP-CANCEL                           VALUE '2'.
  3466           88  CP-ISSUE                            VALUE '3'.
  3467         16  CP-SPECIAL-CALC-CD    PIC X.
  3468           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3469           88  CP-1-MTH-INTEREST               VALUE ' '.
  3470           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3471           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3472           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3473           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3474           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3475           88  CP-FARM-PLAN                    VALUE 'F'.
  3476           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3477           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3478           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3479           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3480           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3481           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3482           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3483           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3484           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3485           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3486                                                     'W' 'X'.
  3487           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3488           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3489           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3490           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3491           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3492           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3493           88  CP-PROPERTY-BENEFIT             VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  62
* SOCK03.cbl
  3494           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3495           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3496           88  CP-CSL-METH-1                   VALUE '5'.
  3497           88  CP-CSL-METH-2                   VALUE '6'.
  3498           88  CP-CSL-METH-3                   VALUE '7'.
  3499           88  CP-CSL-METH-4                   VALUE '8'.
  3500
  3501         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3502                                     COMP-3.
  3503         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3504         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3505         16  CP-STATE              PIC XX          VALUE SPACE.
  3506         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3507         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3508           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3509               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3510         16  CP-R78-OPTION         PIC X.
  3511           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3512           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3513
  3514         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3515         16  CP-IBNR-RESERVE-SW    PIC X.
  3516         16  CP-CLAIM-STATUS       PIC X.
  3517         16  CP-RATE-FILE          PIC X.
  3518         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3519                                     COMP-3.
  3520
  3521         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3522         16  CP-AH-OVERRIDE-CODE   PIC X.
  3523
  3524         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3525                                     COMP-3.
  3526         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3527                                   PIC S9(5)V99 COMP-3.
  3528         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3529                                     COMP-3.
  3530         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3531                                     COMP-3.
  3532         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3533                                     COMP-3.
  3534         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3535                                  PIC S9(7)V99 COMP-3.
  3536
  3537         16  CP-PAID-FROM-DATE     PIC X(02).
  3538         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3539         16  CP-EXT-DAYS-CALC      PIC X.
  3540           88  CP-EXT-NO-CHG                   VALUE ' '.
  3541           88  CP-EXT-CHG-LF                   VALUE '1'.
  3542           88  CP-EXT-CHG-AH                   VALUE '2'.
  3543           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3544         16  CP-DOMICILE-STATE     PIC XX.
  3545         16  CP-CARRIER            PIC X.
  3546         16  CP-REIN-FLAG          PIC X.
  3547         16  CP-REM-TRM-CALC-OPTION PIC X.
  3548           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3549                      '2' '3' '4' '5'.
  3550           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3551           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  63
* SOCK03.cbl
  3552           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3553           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3554           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3555           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3556           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3557           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3558         16  CP-SIG-SWITCH         PIC X.
  3559         16  CP-RATING-METHOD      PIC X.
  3560           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3561           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3562           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3563           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3564           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3565           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3566           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3567           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3568           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3569         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3570                                     COMP-3.
  3571         16  CP-BEN-CATEGORY       PIC X.
  3572         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3573         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3574                                   PIC S99V9(5) COMP-3.
  3575         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3576         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3577                                   PIC S99V9(5) COMP-3.
  3578         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3579         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3580         16  CP-EXPIRE-DT          PIC XX.
  3581         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3582         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3583         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3584         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3585         16  CP-DDF-SPEC-CALC      PIC X.
  3586             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3587             88  CP-CALC-CLP              VALUE 'C'.
  3588         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3589         16  CP-CANCEL-REASON      PIC X.
  3590         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3591         16  CP-PMT-MODE           PIC X.
  3592         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3593         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3594         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3595         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3596         16  FILLER                PIC X.
  3597
  3598***************    OUTPUT FROM ELRESV   ************************
  3599
  3600         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3601
  3602         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3603                                     COMP-3.
  3604         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3605                                     COMP-3.
  3606         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3607                                     COMP-3.
  3608         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3609                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  64
* SOCK03.cbl
  3610         16  FILLER                PIC X(09).
  3611***************    OUTPUT FROM ELRTRM   *************************
  3612
  3613         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3614                                     COMP-3.
  3615         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3616                                     COMP-3.
  3617         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3618                                     COMP-3.
  3619         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3620                                     COMP-3.
  3621         16  FILLER                PIC X(12).
  3622
  3623***************    OUTPUT FROM ELRAMT   *************************
  3624
  3625         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3626                                     COMP-3.
  3627         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3628                                     COMP-3.
  3629         16  FILLER                PIC X(12).
  3630
  3631***************    OUTPUT FROM ELRATE   *************************
  3632
  3633         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3634                                     COMP-3.
  3635         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3636                                     COMP-3.
  3637         16  CP-MORTALITY-CODE     PIC X(4).
  3638         16  CP-RATE-EDIT-FLAG     PIC X.
  3639             88  CP-RATES-NEED-APR                  VALUE '1'.
  3640         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3641                                     COMP-3.
  3642         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3643         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3644         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3645                                   PIC S9(7)V99 COMP-3.
  3646         16  FILLER                PIC X(07).
  3647
  3648***************    OUTPUT FROM ELRFND   *************************
  3649
  3650         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3651                                     COMP-3.
  3652         16  CP-REFUND-TYPE-USED   PIC X.
  3653           88  CP-R-AS-R78                         VALUE '1'.
  3654           88  CP-R-AS-PRORATA                     VALUE '2'.
  3655           88  CP-R-AS-CALIF                       VALUE '3'.
  3656           88  CP-R-AS-TEXAS                       VALUE '4'.
  3657           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3658           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3659           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3660           88  CP-R-AS-MEAN                        VALUE '8'.
  3661           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3662           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3663           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3664           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3665           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3666           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3667         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  65
* SOCK03.cbl
  3668
  3669***************    OUTPUT FROM ELEARN   *************************
  3670
  3671         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3672                                     COMP-3.
  3673         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3674                                     COMP-3.
  3675         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3678                                     COMP-3.
  3679         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3680                                     COMP-3.
  3681         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3682                                     COMP-3.
  3683         16  CP-EARNING-TYPE-USED  PIC X.
  3684           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3685           88  CP-E-AS-R78                         VALUE '1'.
  3686           88  CP-E-AS-PRORATA                     VALUE '2'.
  3687           88  CP-E-AS-TEXAS                       VALUE '4'.
  3688           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3689           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3690           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3691           88  CP-E-AS-MEAN                        VALUE '8'.
  3692           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3693         16  FILLER                PIC X(12).
  3694
  3695***************    OUTPUT FROM ELPMNT   *************************
  3696
  3697         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3698                                     COMP-3.
  3699         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3700                                     COMP-3.
  3701         16  FILLER                PIC X(12).
  3702
  3703***************   MISC WORK AREAS    *****************************
  3704         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3705                                     COMP-3.
  3706         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3707                                     COMP-3.
  3708         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3709                                     COMP-3.
  3710         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3711                                     COMP-3.
  3712         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3713                                     COMP-3.
  3714         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3715                                     COMP-3.
  3716         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3717             88  OPEN-RATE-FILE                   VALUE 'O'.
  3718             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3719             88  IO-ERROR                         VALUE 'E'.
  3720
  3721         16  CP-FIRST-PAY-DATE     PIC XX.
  3722
  3723         16  CP-JOINT-INDICATOR    PIC X.
  3724
  3725         16  CP-RESERVE-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  66
* SOCK03.cbl
  3726                                   PIC S9(4)V9    VALUE ZERO
  3727                                     COMP-3.
  3728
  3729         16  CP-INSURED-BIRTH-DT   PIC XX.
  3730
  3731         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3732                                     COMP-3.
  3733
  3734         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3735                                     COMP-3.
  3736
  3737         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3738                                     COMP-3.
  3739
  3740         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3741                                     COMP-3.
  3742
  3743         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3744                                     COMP-3.
  3745
  3746         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3747                                     COMP-3.
  3748
  3749         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3750                                     COMP-3.
  3751
  3752         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3753             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3754
  3755         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3756                                     COMP-3.
  3757         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3758                                     COMP-3.
  3759         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3760         16  FILLER                PIC X(15).
  3761******************************************************************
  3762****************************************************************
  3763*
  3764* Copyright (c) 2007 by Clerity Solutions, Inc.
  3765* All rights reserved.
  3766*
  3767****************************************************************
  3768 01  DFHEIV.
  3769   02  DFHEIV0               PIC X(35).
  3770   02  DFHEIV1               PIC X(08).
  3771   02  DFHEIV2               PIC X(08).
  3772   02  DFHEIV3               PIC X(08).
  3773   02  DFHEIV4               PIC X(06).
  3774   02  DFHEIV5               PIC X(04).
  3775   02  DFHEIV6               PIC X(04).
  3776   02  DFHEIV7               PIC X(02).
  3777   02  DFHEIV8               PIC X(02).
  3778   02  DFHEIV9               PIC X(01).
  3779   02  DFHEIV10              PIC S9(7) COMP-3.
  3780   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3781   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3782   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3783   02  DFHEIV14              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  67
* SOCK03.cbl
  3784   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3785   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3786   02  DFHEIV17              PIC X(04).
  3787   02  DFHEIV18              PIC X(04).
  3788   02  DFHEIV19              PIC X(04).
  3789   02  DFHEIV20              USAGE IS POINTER.
  3790   02  DFHEIV21              USAGE IS POINTER.
  3791   02  DFHEIV22              USAGE IS POINTER.
  3792   02  DFHEIV23              USAGE IS POINTER.
  3793   02  DFHEIV24              USAGE IS POINTER.
  3794   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3795   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3796   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3797   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3798   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3799   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3800   02  FILLER                PIC X(02).
  3801   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3802   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3803   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3804   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3805   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3806 LINKAGE  SECTION.
  3807*****************************************************************
  3808*                                                               *
  3809* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3810* All rights reserved.                                          *
  3811*                                                               *
  3812*****************************************************************
  3813 01  dfheiblk.
  3814     02  eibtime          pic s9(7) comp-3.
  3815     02  eibdate          pic s9(7) comp-3.
  3816     02  eibtrnid         pic x(4).
  3817     02  eibtaskn         pic s9(7) comp-3.
  3818     02  eibtrmid         pic x(4).
  3819     02  dfheigdi         pic s9(4) comp.
  3820     02  eibcposn         pic s9(4) comp.
  3821     02  eibcalen         pic s9(4) comp.
  3822     02  eibaid           pic x(1).
  3823     02  eibfiller1       pic x(1).
  3824     02  eibfn            pic x(2).
  3825     02  eibfiller2       pic x(2).
  3826     02  eibrcode         pic x(6).
  3827     02  eibfiller3       pic x(2).
  3828     02  eibds            pic x(8).
  3829     02  eibreqid         pic x(8).
  3830     02  eibrsrce         pic x(8).
  3831     02  eibsync          pic x(1).
  3832     02  eibfree          pic x(1).
  3833     02  eibrecv          pic x(1).
  3834     02  eibsend          pic x(1).
  3835     02  eibatt           pic x(1).
  3836     02  eibeoc           pic x(1).
  3837     02  eibfmh           pic x(1).
  3838     02  eibcompl         pic x(1).
  3839     02  eibsig           pic x(1).
  3840     02  eibconf          pic x(1).
  3841     02  eiberr           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  68
* SOCK03.cbl
  3842     02  eibrldbk         pic x(1).
  3843     02  eiberrcd         pic x(4).
  3844     02  eibsynrb         pic x(1).
  3845     02  eibnodat         pic x(1).
  3846     02  eibfiller5       pic x(2).
  3847     02  eibresp          pic 9(09) comp.
  3848     02  eibresp2         pic 9(09) comp.
  3849     02  dfheigdj         pic s9(4) comp.
  3850     02  dfheigdk         pic s9(4) comp.
  3851 01  DFHCOMMAREA.
  3852   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3853   05 LSTN-NAME                PIC X(8).
  3854   05 LSTN-SUBNAME             PIC X(8).
  3855   05 CLIENT-IN-DATA.
  3856      15  CLIENT-CAR           PIC X.
  3857      15  CLIENT-GRP           PIC X(6).
  3858      15  CLIENT-STATE         PIC XX.
  3859      15  CLIENT-ACCOUNT       PIC X(10).
  3860*  DATES ARE IN FORMAT CCYYMMDD  ie. 20090330
  3861      15  CLIENT-EFF-DT        PIC X(8).
  3862      15  CLIENT-CERT-NO       PIC X(11).
  3863      15  CLIENT-LAST-NAME     PIC X(15).
  3864      15  CLIENT-FIRST-NAME    PIC X(10).
  3865      15  CLIENT-VAL-DT        PIC X(8).
  3866      15  CLIENT-CAN-REASON    PIC X.
  3867   05 SOCKADDR-IN-PARM.
  3868     15 SIN-FAMILY             PIC 9(4) COMP.
  3869     15 SIN-PORT               PIC 9(4) COMP.
  3870     15 SIN-ADDRESS            PIC 9(8) COMP.
  3871     15 SIN-ZERO               PIC X(8).
  3872 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3873 0000-DFHEXIT SECTION.
  3874     MOVE '9#                    $   ' TO DFHEIV0.
  3875     MOVE 'SOCK03' TO DFHEIV1.
  3876     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3877     display '  BEGIN SOCK03 '
  3878     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  3879     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  3880     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  3881        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  3882        IF CLIENT-IN-DATA (8:3) = 'AHL'
  3883           MOVE X'06'            TO WS-COMP-CD
  3884           MOVE 'AHL'            TO WS-SEND-BUF (5:3)
  3885                                    WS-COMP-ID
  3886        ELSE
  3887           IF CLIENT-IN-DATA (8:3) = 'DCC'
  3888              MOVE X'05'         TO WS-COMP-CD
  3889              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  3890                                    WS-COMP-ID
  3891           ELSE
  3892              MOVE X'04'         TO WS-COMP-CD
  3893              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  3894                                    WS-COMP-ID
  3895           END-IF
  3896        END-IF
  3897        move 'CSO'               to ws-send-buf (1:3)
  3898        move +25                 to ws-send-msg-size
  3899     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  69
* SOCK03.cbl
  3900     display 'SOCK03:sequence number  =', ws-seq-num.
  3901     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  3902     call "send" using by value GIVE-TAKE-SOCKET,
  3903         by reference ws-send-buf,
  3904         by value ws-send-msg-size,
  3905         by value ws-flags.
  3906     if return-code <= zero
  3907         display 'SOCK03:send error ',
  3908         go to socket-error.
  3909     move low-values to ws-recv-buf.
  3910     set ws-recv-total to zero.
  3911     compute ws-recv-left = ws-recv-msg-size.
  3912     display 'SOCK03:About to recv '
  3913     call "recv" using by value GIVE-TAKE-SOCKET,
  3914         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3915         by value ws-recv-left,
  3916         by value ws-flags.
  3917     if return-code < zero
  3918        display 'SOCK03:recv error ',
  3919        go to socket-error.
  3920     if return-code = zero
  3921        display 'SOCK03:client disconnected',
  3922        go to socket-error.
  3923*
  3924     display 'SOCK03:Good recv  '
  3925     display 'SOCK03:return code      = ', return-code
  3926     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:75)
  3927     move +4096                  to ws-send-msg-size
  3928*    move +750                   to ws-send-msg-size
  3929     move ws-recv-buf (1:72)     to client-in-data
  3930     MOVE SPACES                 TO WS-ELCERT-SW
  3931     MOVE X'0A'                  TO WS-HEX-0A
  3932     EVALUATE TRUE
  3933        WHEN (CLIENT-CAR NOT = SPACES)
  3934           AND (CLIENT-STATE NOT = SPACES)
  3935           AND (CLIENT-ACCOUNT NOT = SPACES)
  3936           AND (CLIENT-EFF-DT NOT = SPACES)
  3937           AND (CLIENT-CERT-NO NOT = SPACES)
  3938           SET WS-ELCERT-FULL    TO TRUE
  3939           DISPLAY ' SETTING FULL '
  3940        WHEN (CLIENT-CERT-NO NOT = SPACES)
  3941           SET WS-ELCERT-CERT-NO TO TRUE
  3942           DISPLAY ' SETTING CERT NO '
  3943*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  3944*          AND (CLIENT-LAST-NAME NOT = SPACES)
  3945        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  3946           AND (CLIENT-LAST-NAME NOT = SPACES)
  3947           SET WS-ELCERT-ACT-NAME TO TRUE
  3948        WHEN CLIENT-LAST-NAME NOT = SPACES
  3949           SET WS-ELCERT-NAME    TO TRUE
  3950           DISPLAY ' SETTING NAME '
  3951        WHEN OTHER
  3952           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  3953           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  3954           MOVE ZEROS            TO WS-RESP
  3955           PERFORM 0030-BUILD-BUFFER
  3956                                 THRU 0030-EXIT
  3957           PERFORM 0020-SEND-BUFFER
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  70
* SOCK03.cbl
  3958                                 THRU 0020-EXIT
  3959           PERFORM 0025-CLOSE-SOCKET
  3960                                 THRU 0025-EXIT
  3961           GO TO 0010-RETURN
  3962     END-EVALUATE
  3963     IF CLIENT-CAN-REASON = 'R'
  3964        MOVE 'R'                 TO WS-CANCEL-REASON
  3965     ELSE
  3966        MOVE ' '                 TO WS-CANCEL-REASON
  3967     END-IF
  3968     IF WS-ELCERT-KEY-SW NOT = SPACES
  3969        PERFORM 0050-BEGIN-REFUND-PROCESS
  3970                                 THRU 0050-EXIT
  3971     END-IF
  3972     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  3973     .
  3974 0010-RETURN.
  3975
  3976* exec cics return end-exec.
  3977*    MOVE '.(                    ''   #00003971' TO DFHEIV0
  3978     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3979     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3980     MOVE X'2020233030303033393731' TO DFHEIV0(25:11)
  3981     CALL 'kxdfhei1' USING DFHEIV0,
  3982           DFHEIV99,
  3983           DFHEIV99,
  3984           DFHEIV99,
  3985           DFHEIV99,
  3986           DFHEIV99,
  3987           DFHEIV99
  3988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3989
  3990
  3991* goback.
  3992     MOVE '9%                    "   ' TO DFHEIV0
  3993     MOVE 'SOCK03' TO DFHEIV1
  3994     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3995     goback.
  3996*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  3997     .
  3998 0020-SEND-BUFFER.
  3999     display 'SOCK03:About to send      '
  4000     display 'SOCK03:sequence number  =', ws-seq-num.
  4001     display 'SOCK03:send buffer      =', ws-send-buf(1:300).
  4002     call "send" using by value GIVE-TAKE-SOCKET,
  4003         by reference ws-send-buf,
  4004         by value ws-send-msg-size,
  4005         by value ws-flags.
  4006     if return-code <= zero
  4007         display 'SOCK03:send error ' return-code,
  4008         go to socket-error.
  4009 0020-EXIT.
  4010     EXIT.
  4011 0025-CLOSE-SOCKET.
  4012     display 'SOCK03:closing socket'.
  4013     call "close" using by value GIVE-TAKE-SOCKET .
  4014     display 'SOCK03:done'.
  4015     .
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  71
* SOCK03.cbl
  4016 0025-EXIT.
  4017     EXIT.
  4018*
  4019* set up the receive buffer
  4020*
  4021     move low-values to ws-recv-buf.
  4022     set ws-recv-total to zero.
  4023     compute ws-recv-left = ws-recv-msg-size.
  4024*
  4025* receive data
  4026*
  4027 recv-1.
  4028     call "recv" using by value GIVE-TAKE-SOCKET,
  4029         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4030         by value ws-recv-left,
  4031         by value ws-flags.
  4032*
  4033* test what was received and decide what we should do
  4034*
  4035     if return-code < zero
  4036        display 'SOCK03:recv error ',
  4037        go to socket-error.
  4038     if return-code = zero
  4039        display 'SOCK03:client disconnected',
  4040        go to socket-error.
  4041*
  4042* have we received all the data yet?
  4043*
  4044     compute ws-recv-total = ws-recv-total + return-code.
  4045     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  4046*
  4047* not yet
  4048*
  4049     if ws-recv-left > 0 go to recv-1.
  4050*
  4051* received all the data
  4052*
  4053     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  4054*
  4055* make sure what we received was what we sent
  4056*
  4057*    if ws-recv-buf <> ws-send-buf
  4058*        display "SOCK03:data doesn't match",
  4059*        go to socket-error.
  4060*
  4061* end of pass
  4062*
  4063*loop-end.
  4064*    if ws-seq-num = 5 go to socket-error.
  4065*    go to loop-1.
  4066*
  4067* program end
  4068*
  4069 socket-error.
  4070     if ws-seq-num <> 0
  4071         display "SOCK03:did not complete".
  4072*
  4073* flush the send buffer and deallocate
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  72
* SOCK03.cbl
  4074*
  4075*    display 'SOCK03:closing socket'.
  4076*    call "close" using by value GIVE-TAKE-SOCKET .
  4077*
  4078* finised return to cics
  4079*
  4080 socket-fin.
  4081     display 'SOCK03:closing socket'.
  4082     call "close" using by value GIVE-TAKE-SOCKET .
  4083     display 'SOCK03:done'.
  4084
  4085* exec cics return end-exec.
  4086*    MOVE '.(                    ''   #00004061' TO DFHEIV0
  4087     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4088     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4089     MOVE X'2020233030303034303631' TO DFHEIV0(25:11)
  4090     CALL 'kxdfhei1' USING DFHEIV0,
  4091           DFHEIV99,
  4092           DFHEIV99,
  4093           DFHEIV99,
  4094           DFHEIV99,
  4095           DFHEIV99,
  4096           DFHEIV99
  4097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4098
  4099
  4100* goback.
  4101     MOVE '9%                    "   ' TO DFHEIV0
  4102     MOVE 'SOCK03' TO DFHEIV1
  4103     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4104     goback.
  4105 0030-BUILD-BUFFER.
  4106     MOVE SPACES                 TO WS-SEND-BUF
  4107     IF WS-CALL-TYPE = 'NEWBUS'
  4108        STRING
  4109           WS-COMMENT            ';'
  4110           WS-RESP               ';'
  4111           WS-CARRIER            ';'
  4112           WS-GROUPING           ';'
  4113           WS-STATE              ';'
  4114           WS-ACCOUNT            ';'
  4115           WS-CERT-EFF-DATE      ';'
  4116           WS-CERT-NO            ';'
  4117           WS-LAST-NAME          ';'
  4118           WS-FIRST-NAME         ';'
  4119           WS-MID-INIT           ';'
  4120           WS-LAST-JNAME         ';'
  4121           WS-FIRST-JNAME        ';'
  4122           WS-MID-JINIT          ';'
  4123           WS-POST-CARD-SW       ';'
  4124           ws-lf-coverage-type   ';'
  4125           WS-LF-STATUS          ';'
  4126           WS-LF-BEN-CODE        ';'
  4127           WS-LF-BEN-CODE-DESC   ';'
  4128           WS-LF-TERM            ';'
  4129           WS-LF-REM-TERM        ';'
  4130           WS-LF-PREM            ';'
  4131           WS-LF-REFUND          ';'
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  73
* SOCK03.cbl
  4132           WS-LF-METHOD          ';'
  4133           WS-LF-ORIG-BENEFIT    ';'
  4134           WS-LF-REM-BEN         ';'
  4135           WS-LF-EXPIRE-DATE     ';'
  4136           WS-LF-COMM            ';'
  4137           WS-LF-UEC             ';'
  4138           WS-AH-COVERAGE-TYPE   ';'
  4139           WS-AH-STATUS          ';'
  4140           WS-AH-BEN-CODE        ';'
  4141           WS-AH-BEN-CODE-DESC   ';'
  4142           WS-AH-TERM            ';'
  4143           WS-AH-REM-TERM        ';'
  4144           WS-AH-PREM            ';'
  4145           WS-AH-REFUND          ';'
  4146           WS-AH-METHOD          ';'
  4147           WS-AH-ORIG-BENEFIT    ';'
  4148           WS-AH-REM-BEN         ';'
  4149           WS-AH-EXPIRE-DATE     ';'
  4150           WS-AH-COMM            ';'
  4151           WS-AH-UEC             ';'
  4152           WS-ACCOUNT-NAME       ';'
  4153           WS-REPORT-CODE-1      ';'
  4154           WS-REPORT-CODE-2      ';'
  4155           WS-REPORT-CODE-3      ';'
  4156           WS-CLM-PAID-THRU-DT   ';'
  4157           WS-HEX-0A
  4158            DELIMITED BY '  ' INTO WS-SEND-BUF
  4159        END-STRING
  4160     ELSE
  4161        STRING
  4162           WS-COMMENT            ';'
  4163           WS-RESP               ';'
  4164           WS-CARRIER            ';'
  4165           WS-GROUPING           ';'
  4166           WS-STATE              ';'
  4167           WS-ACCOUNT            ';'
  4168           WS-CERT-EFF-DATE      ';'
  4169           WS-CERT-NO            ';'
  4170           WS-LAST-NAME          ';'
  4171           WS-FIRST-NAME         ';'
  4172           WS-MID-INIT           ';'
  4173           WS-LAST-JNAME         ';'
  4174           WS-FIRST-JNAME        ';'
  4175           WS-MID-JINIT          ';'
  4176           WS-POST-CARD-SW       ';'
  4177           WS-LF-STATUS          ';'
  4178           WS-LF-BEN-CODE        ';'
  4179           WS-LF-BEN-CODE-DESC   ';'
  4180           WS-LF-TERM            ';'
  4181           WS-LF-REM-TERM        ';'
  4182           WS-LF-PREM            ';'
  4183           WS-LF-REFUND          ';'
  4184           WS-LF-METHOD          ';'
  4185           WS-LF-ORIG-BENEFIT    ';'
  4186           WS-LF-REM-BEN         ';'
  4187           WS-LF-EXPIRE-DATE     ';'
  4188           WS-LF-COMM            ';'
  4189           WS-LF-UEC             ';'
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  74
* SOCK03.cbl
  4190           WS-AH-STATUS          ';'
  4191           WS-AH-BEN-CODE        ';'
  4192           WS-AH-BEN-CODE-DESC   ';'
  4193           WS-AH-TERM            ';'
  4194           WS-AH-REM-TERM        ';'
  4195           WS-AH-PREM            ';'
  4196           WS-AH-REFUND          ';'
  4197           WS-AH-METHOD          ';'
  4198           WS-AH-ORIG-BENEFIT    ';'
  4199           WS-AH-REM-BEN         ';'
  4200           WS-AH-EXPIRE-DATE     ';'
  4201           WS-AH-COMM            ';'
  4202           WS-AH-UEC             ';'
  4203           WS-ACCOUNT-NAME       ';'
  4204           WS-REPORT-CODE-1      ';'
  4205           WS-REPORT-CODE-2      ';'
  4206           WS-REPORT-CODE-3      ';'
  4207           WS-CLM-PAID-THRU-DT   ';'
  4208           'E'                   ';'
  4209            DELIMITED BY '  ' INTO WS-SEND-BUF
  4210        END-STRING
  4211     END-IF
  4212     .
  4213 0030-EXIT.
  4214     EXIT.
  4215 0050-BEGIN-REFUND-PROCESS.
  4216     IF WS-ELCERT-ACT-NAME
  4217        PERFORM 0060-FIND-FULL-KEY
  4218                                 THRU 0060-EXIT
  4219        MOVE AM-CARRIER          TO CLIENT-CAR
  4220        MOVE AM-GROUPING         TO CLIENT-GRP
  4221        MOVE AM-STATE            TO CLIENT-STATE
  4222     END-IF
  4223     PERFORM 0100-START-ELCERT     THRU 0100-EXIT
  4224     IF NOT RESP-NORMAL
  4225        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4226        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4227        MOVE WS-RESPONSE         TO WS-RESP
  4228        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4229        PERFORM 0020-SEND-BUFFER
  4230                                 THRU 0020-EXIT
  4231        PERFORM 0025-CLOSE-SOCKET
  4232                                 THRU 0025-EXIT
  4233        GO TO 0010-RETURN
  4234     END-IF
  4235     PERFORM 0150-READ-NEXT-ELCERT
  4236                                 THRU 0150-EXIT
  4237*    display ' came back from 0150 ' ws-response
  4238     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4239        DISPLAY ' CERT NOT FOUND '
  4240        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4241        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4242        MOVE WS-RESPONSE         TO WS-RESP
  4243        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4244        PERFORM 0020-SEND-BUFFER
  4245                                 THRU 0020-EXIT
  4246        PERFORM 0025-CLOSE-SOCKET
  4247                                 THRU 0025-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  75
* SOCK03.cbl
  4248        GO TO 0010-RETURN
  4249     END-IF
  4250     PERFORM 0200-BEGIN-REFUND-PROCESS
  4251                                 THRU 0200-EXIT UNTIL
  4252        ELCERT-FINISHED
  4253     .
  4254 0050-EXIT.
  4255     EXIT.
  4256 0060-FIND-FULL-KEY.
  4257     MOVE ' ' TO WS-STOP-SW
  4258     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4259     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4260
  4261* EXEC CICS STARTBR
  4262*       DATASET  ('ERACCT3')
  4263*       RIDFLD   (WS-AM3-KEY)
  4264*       GTEQ
  4265*       RESP (WS-RESPONSE)
  4266*    END-EXEC
  4267     MOVE 'ERACCT3' TO DFHEIV1
  4268     MOVE 0
  4269       TO DFHEIV11
  4270*    MOVE '&,         G          &  N#00004218' TO DFHEIV0
  4271     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4272     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4273     MOVE X'204E233030303034323138' TO DFHEIV0(25:11)
  4274     CALL 'kxdfhei1' USING DFHEIV0,
  4275           DFHEIV1,
  4276           WS-AM3-KEY,
  4277           DFHEIV99,
  4278           DFHEIV11,
  4279           DFHEIV99
  4280     MOVE EIBRESP  TO WS-RESPONSE
  4281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4282     IF RESP-NORMAL
  4283        PERFORM UNTIL TOLD-TO-STOP
  4284
  4285* EXEC CICS READNEXT
  4286*             DATASET  ('ERACCT3')
  4287*             INTO     (ACCOUNT-MASTER)
  4288*             RIDFLD   (WS-AM3-KEY)
  4289*          END-EXEC
  4290     MOVE LENGTH OF
  4291      ACCOUNT-MASTER
  4292       TO DFHEIV12
  4293     MOVE 'ERACCT3' TO DFHEIV1
  4294     MOVE 0
  4295       TO DFHEIV11
  4296*    MOVE '&.IL                  )   #00004226' TO DFHEIV0
  4297     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4298     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4299     MOVE X'2020233030303034323236' TO DFHEIV0(25:11)
  4300     CALL 'kxdfhei1' USING DFHEIV0,
  4301           DFHEIV1,
  4302           ACCOUNT-MASTER,
  4303           DFHEIV12,
  4304           WS-AM3-KEY,
  4305           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  76
* SOCK03.cbl
  4306           DFHEIV11,
  4307           DFHEIV99,
  4308           DFHEIV99
  4309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4310           EVALUATE TRUE
  4311              WHEN (RESP-NORMAL)
  4312                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4313                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4314                 SET TOLD-TO-STOP TO TRUE
  4315              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4316                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4317                 CONTINUE
  4318              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4319                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4320                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4321                 MOVE ZEROS      TO WS-RESP
  4322                 PERFORM 0030-BUILD-BUFFER
  4323                                 THRU 0030-EXIT
  4324                 PERFORM 0020-SEND-BUFFER
  4325                                 THRU 0020-EXIT
  4326                 PERFORM 0025-CLOSE-SOCKET
  4327                                 THRU 0025-EXIT
  4328                 GO TO 0010-RETURN
  4329           END-EVALUATE
  4330        END-PERFORM
  4331
  4332* EXEC CICS ENDBR
  4333*          DATASET   ('ERACCT3')
  4334*       END-EXEC
  4335     MOVE 'ERACCT3' TO DFHEIV1
  4336     MOVE 0
  4337       TO DFHEIV11
  4338*    MOVE '&2                    $   #00004252' TO DFHEIV0
  4339     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4340     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4341     MOVE X'2020233030303034323532' TO DFHEIV0(25:11)
  4342     CALL 'kxdfhei1' USING DFHEIV0,
  4343           DFHEIV1,
  4344           DFHEIV11,
  4345           DFHEIV99
  4346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4347     ELSE
  4348        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4349        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4350        MOVE ZEROS      TO WS-RESP
  4351        PERFORM 0030-BUILD-BUFFER
  4352                                 THRU 0030-EXIT
  4353        PERFORM 0020-SEND-BUFFER
  4354                                 THRU 0020-EXIT
  4355        PERFORM 0025-CLOSE-SOCKET
  4356                                 THRU 0025-EXIT
  4357        GO TO 0010-RETURN
  4358     END-IF
  4359     .
  4360 0060-EXIT.
  4361     EXIT.
  4362 0100-START-ELCERT.
  4363*    DISPLAY ' MADE 0100 START '
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  77
* SOCK03.cbl
  4364     MOVE SPACES                 TO WS-SEND-BUF
  4365     INITIALIZE WS-STRING-DATA
  4366     MOVE LOW-VALUES             TO WS-CM-KEY
  4367                                    WS-CM-KEY-A1
  4368                                    WS-CM-KEY-A4
  4369     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4370                                    WS-CM-COMPANY-CD-A1
  4371                                    WS-CM-COMPANY-CD-A4
  4372     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4373     MOVE 'L'                    TO DC-OPTION-CODE
  4374     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4375     IF NO-CONVERSION-ERROR
  4376        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4377     ELSE
  4378        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4379        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4380        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4381        PERFORM 0020-SEND-BUFFER
  4382                                 THRU 0020-EXIT
  4383        PERFORM 0025-CLOSE-SOCKET
  4384                                 THRU 0025-EXIT
  4385        GO TO 0010-RETURN
  4386     END-IF
  4387     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4388        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4389        MOVE 'L'                 TO DC-OPTION-CODE
  4390        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4391        IF NO-CONVERSION-ERROR
  4392           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4393        ELSE
  4394           MOVE 'BAD EFF DT CONVERT '
  4395                                 TO WS-COMMENT
  4396           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4397           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4398           PERFORM 0020-SEND-BUFFER
  4399                                 THRU 0020-EXIT
  4400           PERFORM 0025-CLOSE-SOCKET
  4401                                 THRU 0025-EXIT
  4402           GO TO 0010-RETURN
  4403        END-IF
  4404     END-IF
  4405     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4406        (F1 > +10)
  4407        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4408     END-PERFORM
  4409     IF F1 > +1
  4410        SUBTRACT +1 FROM F1
  4411     END-IF
  4412     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4413        (L1 > +15)
  4414        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4415     END-PERFORM
  4416     IF L1 > +1
  4417        SUBTRACT +1 FROM L1
  4418     END-IF
  4419     EVALUATE TRUE
  4420        WHEN WS-ELCERT-FULL
  4421           MOVE CLIENT-CAR          TO WS-CM-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  78
* SOCK03.cbl
  4422           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4423           MOVE CLIENT-STATE        TO WS-CM-STATE
  4424           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4425           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4426           MOVE CLIENT-CERT-NO (1:10)
  4427                                    TO WS-CM-CERT-NO
  4428
  4429* EXEC CICS READ
  4430*             INTO    (CERTIFICATE-MASTER)
  4431*             DATASET ('ELCERT')
  4432*             RIDFLD  (WS-CM-KEY)
  4433*             RESP    (WS-RESPONSE)
  4434*          END-EXEC
  4435     MOVE LENGTH OF
  4436      CERTIFICATE-MASTER
  4437       TO DFHEIV11
  4438     MOVE 'ELCERT' TO DFHEIV1
  4439*    MOVE '&"IL       E          (  N#00004336' TO DFHEIV0
  4440     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4441     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4442     MOVE X'204E233030303034333336' TO DFHEIV0(25:11)
  4443     CALL 'kxdfhei1' USING DFHEIV0,
  4444           DFHEIV1,
  4445           CERTIFICATE-MASTER,
  4446           DFHEIV11,
  4447           WS-CM-KEY,
  4448           DFHEIV99,
  4449           DFHEIV99,
  4450           DFHEIV99
  4451     MOVE EIBRESP  TO WS-RESPONSE
  4452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4453        WHEN WS-ELCERT-ACT-NAME
  4454           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4455           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4456           MOVE CLIENT-STATE        TO WS-CM-STATE
  4457           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4458           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4459           MOVE ZEROS               TO WS-CM-CERT-NO
  4460
  4461* EXEC CICS STARTBR
  4462*             DATASET ('ELCERT')
  4463*             RIDFLD  (WS-CM-KEY)
  4464*             RESP    (WS-RESPONSE)
  4465*          END-EXEC
  4466     MOVE 'ELCERT' TO DFHEIV1
  4467     MOVE 0
  4468       TO DFHEIV11
  4469*    MOVE '&,         G          &  N#00004349' TO DFHEIV0
  4470     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4471     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4472     MOVE X'204E233030303034333439' TO DFHEIV0(25:11)
  4473     CALL 'kxdfhei1' USING DFHEIV0,
  4474           DFHEIV1,
  4475           WS-CM-KEY,
  4476           DFHEIV99,
  4477           DFHEIV11,
  4478           DFHEIV99
  4479     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  79
* SOCK03.cbl
  4480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4481        WHEN WS-ELCERT-NAME
  4482           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4483           MOVE SPACES           TO WS-CM-INITIALS
  4484           COMPUTE WS-LENGTH = L1 + +1
  4485
  4486* EXEC CICS STARTBR
  4487*             DATASET   ('ELCERT2')
  4488*             RIDFLD    (WS-CM-KEY-A1)
  4489*             GENERIC
  4490*             KEYLENGTH (WS-LENGTH)
  4491*             GTEQ
  4492*             RESP      (WS-RESPONSE)
  4493*          END-EXEC
  4494     MOVE 'ELCERT2' TO DFHEIV1
  4495     MOVE 0
  4496       TO DFHEIV11
  4497*    MOVE '&,   KG    G          &  N#00004358' TO DFHEIV0
  4498     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4499     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4500     MOVE X'204E233030303034333538' TO DFHEIV0(25:11)
  4501     CALL 'kxdfhei1' USING DFHEIV0,
  4502           DFHEIV1,
  4503           WS-CM-KEY-A1,
  4504           WS-LENGTH,
  4505           DFHEIV11,
  4506           DFHEIV99
  4507     MOVE EIBRESP  TO WS-RESPONSE
  4508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4509*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4510*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4511        WHEN WS-ELCERT-CERT-NO
  4512* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4513           MOVE +11 TO WS-LENGTH
  4514           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4515
  4516* EXEC CICS STARTBR
  4517*             DATASET   ('ELCERT5')
  4518*             RIDFLD    (WS-CM-KEY-A4)
  4519*             GENERIC
  4520*             KEYLENGTH (WS-LENGTH)
  4521*             GTEQ
  4522*             RESP      (WS-RESPONSE)
  4523*          END-EXEC
  4524     MOVE 'ELCERT5' TO DFHEIV1
  4525     MOVE 0
  4526       TO DFHEIV11
  4527*    MOVE '&,   KG    G          &  N#00004372' TO DFHEIV0
  4528     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4529     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4530     MOVE X'204E233030303034333732' TO DFHEIV0(25:11)
  4531     CALL 'kxdfhei1' USING DFHEIV0,
  4532           DFHEIV1,
  4533           WS-CM-KEY-A4,
  4534           WS-LENGTH,
  4535           DFHEIV11,
  4536           DFHEIV99
  4537     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  80
* SOCK03.cbl
  4538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4539     END-EVALUATE
  4540     .
  4541 0100-EXIT.
  4542     EXIT.
  4543 0150-READ-NEXT-ELCERT.
  4544*    DISPLAY ' MADE 0150 NEXT '
  4545     EVALUATE TRUE
  4546        WHEN WS-ELCERT-ACT-NAME
  4547*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  4548
  4549* EXEC CICS READNEXT
  4550*             DATASET   ('ELCERT')
  4551*             RIDFLD    (WS-CM-KEY)
  4552*             INTO      (CERTIFICATE-MASTER)
  4553*             RESP      (WS-RESPONSE)
  4554*          END-EXEC
  4555     MOVE LENGTH OF
  4556      CERTIFICATE-MASTER
  4557       TO DFHEIV12
  4558     MOVE 'ELCERT' TO DFHEIV1
  4559     MOVE 0
  4560       TO DFHEIV11
  4561*    MOVE '&.IL                  )  N#00004389' TO DFHEIV0
  4562     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4563     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4564     MOVE X'204E233030303034333839' TO DFHEIV0(25:11)
  4565     CALL 'kxdfhei1' USING DFHEIV0,
  4566           DFHEIV1,
  4567           CERTIFICATE-MASTER,
  4568           DFHEIV12,
  4569           WS-CM-KEY,
  4570           DFHEIV99,
  4571           DFHEIV11,
  4572           DFHEIV99,
  4573           DFHEIV99
  4574     MOVE EIBRESP  TO WS-RESPONSE
  4575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4576        WHEN WS-ELCERT-NAME
  4577*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  4578
  4579* EXEC CICS READNEXT
  4580*             DATASET   ('ELCERT2')
  4581*             RIDFLD    (WS-CM-KEY-A1)
  4582*             INTO      (CERTIFICATE-MASTER)
  4583*             RESP      (WS-RESPONSE)
  4584*          END-EXEC
  4585     MOVE LENGTH OF
  4586      CERTIFICATE-MASTER
  4587       TO DFHEIV12
  4588     MOVE 'ELCERT2' TO DFHEIV1
  4589     MOVE 0
  4590       TO DFHEIV11
  4591*    MOVE '&.IL                  )  N#00004397' TO DFHEIV0
  4592     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4593     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4594     MOVE X'204E233030303034333937' TO DFHEIV0(25:11)
  4595     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  81
* SOCK03.cbl
  4596           DFHEIV1,
  4597           CERTIFICATE-MASTER,
  4598           DFHEIV12,
  4599           WS-CM-KEY-A1,
  4600           DFHEIV99,
  4601           DFHEIV11,
  4602           DFHEIV99,
  4603           DFHEIV99
  4604     MOVE EIBRESP  TO WS-RESPONSE
  4605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4606        WHEN WS-ELCERT-CERT-NO
  4607
  4608* EXEC CICS READNEXT
  4609*             DATASET   ('ELCERT5')
  4610*             RIDFLD    (WS-CM-KEY-A4)
  4611*             INTO      (CERTIFICATE-MASTER)
  4612*             RESP      (WS-RESPONSE)
  4613*          END-EXEC
  4614     MOVE LENGTH OF
  4615      CERTIFICATE-MASTER
  4616       TO DFHEIV12
  4617     MOVE 'ELCERT5' TO DFHEIV1
  4618     MOVE 0
  4619       TO DFHEIV11
  4620*    MOVE '&.IL                  )  N#00004404' TO DFHEIV0
  4621     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4622     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4623     MOVE X'204E233030303034343034' TO DFHEIV0(25:11)
  4624     CALL 'kxdfhei1' USING DFHEIV0,
  4625           DFHEIV1,
  4626           CERTIFICATE-MASTER,
  4627           DFHEIV12,
  4628           WS-CM-KEY-A4,
  4629           DFHEIV99,
  4630           DFHEIV11,
  4631           DFHEIV99,
  4632           DFHEIV99
  4633     MOVE EIBRESP  TO WS-RESPONSE
  4634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4635     END-EVALUATE
  4636     .
  4637 0150-EXIT.
  4638     EXIT.
  4639 0200-BEGIN-REFUND-PROCESS.
  4640*    DISPLAY ' MADE 0200 BEGIN '
  4641     MOVE SPACES                 TO WS-BUFF-SENT-SW
  4642                                    WS-ERACCT-SW
  4643     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  4644                                    WS-NCB-DIFF-ODD-DAYS
  4645     INITIALIZE WS-STRING-DATA
  4646     IF RESP-NORMAL OR RESP-DUPKEY
  4647        EVALUATE TRUE
  4648           WHEN WS-ELCERT-ACT-NAME
  4649              EVALUATE TRUE
  4650                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  4651                    OR (CM-CARRIER NOT = CLIENT-CAR)
  4652                    OR (CM-GROUPING NOT = CLIENT-GRP)
  4653                    OR (CM-STATE NOT = CLIENT-STATE)
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  82
* SOCK03.cbl
  4654                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  4655                    SET ELCERT-FINISHED TO TRUE
  4656                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  4657                    CLIENT-LAST-NAME (1:L1))
  4658                    GO TO 0200-CONTINUE
  4659                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  4660                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4661                    GO TO 0200-CONTINUE
  4662                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  4663                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4664                     CLIENT-FIRST-NAME (1:F1)))
  4665                    GO TO 0200-CONTINUE
  4666                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  4667                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4668                    GO TO 0200-CONTINUE
  4669              END-EVALUATE
  4670           WHEN WS-ELCERT-CERT-NO
  4671              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4672                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  4673                 SET ELCERT-FINISHED TO TRUE
  4674              ELSE
  4675                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4676                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4677                              OR
  4678                    ((CLIENT-LAST-NAME NOT = SPACES)
  4679                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  4680                        CLIENT-LAST-NAME (1:L1)))
  4681                              OR
  4682                    ((CLIENT-FIRST-NAME NOT = SPACES)
  4683                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4684                        CLIENT-FIRST-NAME (1:F1)))
  4685                              OR
  4686                    ((CLIENT-ACCOUNT NOT = SPACES)
  4687                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4688                     GO TO 0200-CONTINUE
  4689                 END-IF
  4690              END-IF
  4691           WHEN WS-ELCERT-NAME
  4692              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4693                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  4694                    CLIENT-LAST-NAME (1:L1))
  4695                  SET ELCERT-FINISHED TO TRUE
  4696              ELSE
  4697                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4698                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4699                           OR
  4700                 ((CLIENT-FIRST-NAME NOT = SPACES)
  4701                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4702                     CLIENT-FIRST-NAME (1:F1)))
  4703                           OR
  4704                 ((CLIENT-ACCOUNT NOT = SPACES)
  4705                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4706                  GO TO 0200-CONTINUE
  4707                 END-IF
  4708              END-IF
  4709           WHEN OTHER
  4710              SET ELCERT-FINISHED   TO TRUE
  4711        END-EVALUATE
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  83
* SOCK03.cbl
  4712     ELSE
  4713        SET ELCERT-FINISHED TO TRUE
  4714     END-IF
  4715*       IF WS-ELCERT-CERT-NO
  4716*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4717*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  4718*                          OR
  4719*                ((CLIENT-EFF-DT NOT = SPACES)
  4720*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4721*                          OR
  4722*                ((CLIENT-LAST-NAME NOT = SPACES)
  4723*                 AND (CM-INSURED-LAST-NAME NOT =
  4724*                    CLIENT-LAST-NAME))
  4725*                 SET ELCERT-FINISHED TO TRUE
  4726*          END-IF
  4727*          IF WS-ELCERT-NAME
  4728*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4729*                OR (CM-INSURED-LAST-NAME NOT =
  4730*                   CLIENT-LAST-NAME)
  4731*                            OR
  4732*                ((CLIENT-EFF-DT NOT = SPACES)
  4733*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4734*                 SET ELCERT-FINISHED TO TRUE
  4735*             END-IF
  4736*          ELSE
  4737*             SET ELCERT-FINISHED   TO TRUE
  4738*          END-IF
  4739     IF NOT WS-ELCERT-FULL
  4740        IF ELCERT-FINISHED
  4741           GO TO 0200-EXIT
  4742        END-IF
  4743     END-IF
  4744     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  4745        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  4746        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4747        PERFORM 0030-BUILD-BUFFER
  4748                                 THRU 0030-EXIT
  4749        PERFORM 0020-SEND-BUFFER
  4750                                 THRU 0020-EXIT
  4751        GO TO 0200-CONTINUE
  4752     END-IF
  4753     PERFORM 0300-GET-ELCNTL-RECORDS
  4754                                 THRU 0300-EXIT
  4755     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  4756     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  4757     MOVE +0                     TO DC-ELAPSED-MONTHS
  4758                                    DC-ELAPSED-DAYS
  4759     MOVE '1'                    TO DC-OPTION-CODE
  4760     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4761     IF NO-CONVERSION-ERROR
  4762        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  4763        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  4764     END-IF
  4765     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  4766     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  4767     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4768     IF NOT ALREADY-SENT
  4769        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  84
* SOCK03.cbl
  4770     END-IF
  4771     .
  4772 0200-CONTINUE.
  4773     PERFORM 0150-READ-NEXT-ELCERT
  4774                                 THRU 0150-EXIT
  4775     .
  4776 0200-EXIT.
  4777     EXIT.
  4778 0300-GET-ELCNTL-RECORDS.
  4779     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  4780     IF NOT RESP-NORMAL
  4781        MOVE ' COMPANY RECORD NOT FOUND '
  4782                                 TO WS-COMMENT
  4783        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4784        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4785        PERFORM 0020-SEND-BUFFER
  4786                                 THRU 0020-EXIT
  4787        PERFORM 0025-CLOSE-SOCKET
  4788                                 THRU 0025-EXIT
  4789        GO TO 0010-RETURN
  4790     END-IF
  4791     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  4792        PERFORM 0320-GET-LIFE-RECORD
  4793                                 THRU 0320-EXIT
  4794        IF NOT RESP-NORMAL
  4795           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  4796                                 TO WS-COMMENT
  4797           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4798           PERFORM 0030-BUILD-BUFFER
  4799                                 THRU 0030-EXIT
  4800           PERFORM 0020-SEND-BUFFER
  4801                                 THRU 0020-EXIT
  4802           PERFORM 0025-CLOSE-SOCKET
  4803                                 THRU 0025-EXIT
  4804           GO TO 0010-RETURN
  4805        END-IF
  4806     END-IF
  4807     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  4808        PERFORM 0330-GET-AH-RECORD
  4809                                 THRU 0330-EXIT
  4810        IF NOT RESP-NORMAL
  4811           MOVE ' AH BENEFIT RECORD NOT FOUND '
  4812                                 TO WS-COMMENT
  4813           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4814           PERFORM 0030-BUILD-BUFFER
  4815                                 THRU 0030-EXIT
  4816           PERFORM 0020-SEND-BUFFER
  4817                                 THRU 0020-EXIT
  4818           PERFORM 0025-CLOSE-SOCKET
  4819                                 THRU 0025-EXIT
  4820           GO TO 0010-RETURN
  4821        END-IF
  4822     END-IF
  4823     PERFORM 0340-GET-STATE-RECORD
  4824                                 THRU 0340-EXIT
  4825     IF NOT RESP-NORMAL
  4826        MOVE ' STATE RECORD NOT FOUND '
  4827                                 TO WS-COMMENT
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  85
* SOCK03.cbl
  4828        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4829        PERFORM 0030-BUILD-BUFFER
  4830                                 THRU 0030-EXIT
  4831        PERFORM 0020-SEND-BUFFER
  4832                                 THRU 0020-EXIT
  4833        PERFORM 0025-CLOSE-SOCKET
  4834                                 THRU 0025-EXIT
  4835        GO TO 0010-RETURN
  4836     END-IF
  4837     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  4838     IF NOT ERACCT-FOUND
  4839        MOVE ' ACCOUNT NOT FOUND '
  4840                                 TO WS-COMMENT
  4841        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4842        PERFORM 0030-BUILD-BUFFER
  4843                                 THRU 0030-EXIT
  4844        PERFORM 0020-SEND-BUFFER
  4845                                 THRU 0020-EXIT
  4846        PERFORM 0025-CLOSE-SOCKET
  4847                                 THRU 0025-EXIT
  4848        GO TO 0010-RETURN
  4849     ELSE
  4850        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  4851        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  4852        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  4853        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  4854     END-IF
  4855     .
  4856 0300-EXIT.
  4857     EXIT.
  4858 0310-GET-COMPANY.
  4859     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  4860     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  4861     MOVE SPACES                 TO  WS-CF-ACCESS
  4862     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  4863
  4864* EXEC CICS READ
  4865*       INTO    (CONTROL-FILE)
  4866*       DATASET ('ELCNTL')
  4867*       RIDFLD  (WS-CF-KEY)
  4868*       RESP    (WS-RESPONSE)
  4869*    END-EXEC
  4870     MOVE LENGTH OF
  4871      CONTROL-FILE
  4872       TO DFHEIV11
  4873     MOVE 'ELCNTL' TO DFHEIV1
  4874*    MOVE '&"IL       E          (  N#00004638' TO DFHEIV0
  4875     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4876     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4877     MOVE X'204E233030303034363338' TO DFHEIV0(25:11)
  4878     CALL 'kxdfhei1' USING DFHEIV0,
  4879           DFHEIV1,
  4880           CONTROL-FILE,
  4881           DFHEIV11,
  4882           WS-CF-KEY,
  4883           DFHEIV99,
  4884           DFHEIV99,
  4885           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  86
* SOCK03.cbl
  4886     MOVE EIBRESP  TO WS-RESPONSE
  4887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4888     IF (RESP-NORMAL)
  4889        AND (CF-COMPANY-ID = WS-COMP-ID)
  4890        AND (CF-RECORD-TYPE = '1')
  4891        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  4892        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  4893        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  4894        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  4895        IF CF-DEFAULT-APR NUMERIC
  4896           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  4897        ELSE
  4898           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  4899        END-IF
  4900        IF CF-VALID-REM-TRM-OPTION
  4901           MOVE CF-REM-TRM-CALC-OPTION
  4902                                 TO WS-CF-REM-TRM-CALC-OPTION
  4903        ELSE
  4904           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  4905        END-IF
  4906     END-IF
  4907     .
  4908 0310-EXIT.
  4909     EXIT.
  4910 0320-GET-LIFE-RECORD.
  4911     MOVE '4'                    TO WS-CF-RECORD-TYPE
  4912     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  4913                                    WS-LF-BEN-CODE
  4914     MOVE +0                     TO WS-CF-SEQUENCE-NO
  4915
  4916* EXEC CICS READ
  4917*       INTO    (CONTROL-FILE)
  4918*       DATASET ('ELCNTL')
  4919*       RIDFLD  (WS-CF-KEY)
  4920*       GTEQ
  4921*       RESP    (WS-RESPONSE)
  4922*    END-EXEC
  4923     MOVE LENGTH OF
  4924      CONTROL-FILE
  4925       TO DFHEIV11
  4926     MOVE 'ELCNTL' TO DFHEIV1
  4927*    MOVE '&"IL       G          (  N#00004671' TO DFHEIV0
  4928     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4929     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4930     MOVE X'204E233030303034363731' TO DFHEIV0(25:11)
  4931     CALL 'kxdfhei1' USING DFHEIV0,
  4932           DFHEIV1,
  4933           CONTROL-FILE,
  4934           DFHEIV11,
  4935           WS-CF-KEY,
  4936           DFHEIV99,
  4937           DFHEIV99,
  4938           DFHEIV99
  4939     MOVE EIBRESP  TO WS-RESPONSE
  4940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4941     IF RESP-NORMAL
  4942        AND (CF-COMPANY-ID  = WS-COMP-ID)
  4943        AND (CF-RECORD-TYPE = '4')
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  87
* SOCK03.cbl
  4944        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4945           (S1 > +8)
  4946           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  4947        END-PERFORM
  4948        IF S1 > +8
  4949           CONTINUE
  4950        ELSE
  4951           MOVE CF-BENEFIT-DESCRIP (S1)
  4952                                 TO WS-LF-BEN-CODE-DESC
  4953           MOVE CF-LF-COVERAGE-TYPE (S1)
  4954                                 TO WS-CF-LF-COVERAGE-TYPE
  4955           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  4956              MOVE 'S'           TO WS-LF-COVERAGE-TYPE
  4957           ELSE
  4958              MOVE 'J'           TO WS-LF-COVERAGE-TYPE
  4959           END-IF
  4960           IF CF-CO-REM-TERM-CALC (S1) > '0'
  4961               MOVE CF-CO-REM-TERM-CALC (S1)
  4962                                 TO WS-LF-CO-REM-TERM-CALC
  4963           END-IF
  4964           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  4965               MOVE CF-CO-EARNINGS-CALC (S1)
  4966                                 TO WS-LF-CO-EARNINGS-CALC
  4967                                    WS-LF-CO-REFUND-CALC
  4968           END-IF
  4969           IF CF-SPECIAL-CALC-CD (S1) > ' '
  4970               MOVE CF-SPECIAL-CALC-CD (S1)
  4971                                 TO WS-LF-SPECIAL-CALC-CD
  4972           END-IF
  4973           IF CF-CO-REFUND-CALC (S1) > '0'
  4974               MOVE CF-CO-REFUND-CALC (S1)
  4975                                 TO WS-LF-CO-REFUND-CALC
  4976        END-IF
  4977     END-IF
  4978     .
  4979 0320-EXIT.
  4980     EXIT.
  4981 0330-GET-AH-RECORD.
  4982     MOVE '5'                    TO WS-CF-RECORD-TYPE
  4983     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  4984     MOVE +0                     TO WS-CF-SEQUENCE-NO
  4985
  4986* EXEC CICS READ
  4987*       INTO    (CONTROL-FILE)
  4988*       DATASET ('ELCNTL')
  4989*       RIDFLD  (WS-CF-KEY)
  4990*       GTEQ
  4991*       RESP    (WS-RESPONSE)
  4992*    END-EXEC
  4993     MOVE LENGTH OF
  4994      CONTROL-FILE
  4995       TO DFHEIV11
  4996     MOVE 'ELCNTL' TO DFHEIV1
  4997*    MOVE '&"IL       G          (  N#00004722' TO DFHEIV0
  4998     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4999     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5000     MOVE X'204E233030303034373232' TO DFHEIV0(25:11)
  5001     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  88
* SOCK03.cbl
  5002           DFHEIV1,
  5003           CONTROL-FILE,
  5004           DFHEIV11,
  5005           WS-CF-KEY,
  5006           DFHEIV99,
  5007           DFHEIV99,
  5008           DFHEIV99
  5009     MOVE EIBRESP  TO WS-RESPONSE
  5010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5011     IF RESP-NORMAL
  5012        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5013        AND (CF-RECORD-TYPE = '5')
  5014        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5015           (S1 > +8)
  5016           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5017        END-PERFORM
  5018        IF S1 > +8
  5019           CONTINUE
  5020        ELSE
  5021           MOVE CF-BENEFIT-DESCRIP (S1)
  5022                                 TO WS-AH-BEN-CODE-DESC
  5023           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5024              MOVE 'S'           TO WS-AH-COVERAGE-TYPE
  5025           ELSE
  5026              MOVE 'J'           TO WS-AH-COVERAGE-TYPE
  5027           END-IF
  5028           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5029              MOVE CF-CO-REM-TERM-CALC (S1)
  5030                                 TO WS-AH-CO-REM-TERM-CALC
  5031           END-IF
  5032           IF CF-CO-EARNINGS-CALC (S1) > ' '
  5033              MOVE CF-CO-EARNINGS-CALC (S1)
  5034                                 TO WS-AH-CO-EARNINGS-CALC
  5035                                    WS-AH-CO-REFUND-CALC
  5036           END-IF
  5037           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  5038              MOVE CF-SPECIAL-CALC-CD (S1)
  5039                                 TO WS-AH-SPECIAL-CALC-CD
  5040           END-IF
  5041           IF CF-CO-REFUND-CALC (S1) > '0'
  5042              MOVE CF-CO-REFUND-CALC (S1)
  5043                                 TO WS-AH-CO-REFUND-CALC
  5044           END-IF
  5045           IF CF-BENEFIT-CATEGORY (S1) > ' '
  5046              MOVE CF-BENEFIT-CATEGORY (S1)
  5047                                 TO WS-AH-BEN-CATEGORY
  5048           END-IF
  5049        END-IF
  5050     END-IF
  5051     .
  5052 0330-EXIT.
  5053     EXIT.
  5054 0340-GET-STATE-RECORD.
  5055     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  5056     MOVE '3'                    TO WS-CF-RECORD-TYPE
  5057     MOVE CM-STATE               TO WS-CF-ACCESS
  5058     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5059
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  89
* SOCK03.cbl
  5060* EXEC CICS READ
  5061*       INTO    (CONTROL-FILE)
  5062*       DATASET ('ELCNTL')
  5063*       RIDFLD  (WS-CF-KEY)
  5064*       RESP    (WS-RESPONSE)
  5065*    END-EXEC
  5066     MOVE LENGTH OF
  5067      CONTROL-FILE
  5068       TO DFHEIV11
  5069     MOVE 'ELCNTL' TO DFHEIV1
  5070*    MOVE '&"IL       E          (  N#00004777' TO DFHEIV0
  5071     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5073     MOVE X'204E233030303034373737' TO DFHEIV0(25:11)
  5074     CALL 'kxdfhei1' USING DFHEIV0,
  5075           DFHEIV1,
  5076           CONTROL-FILE,
  5077           DFHEIV11,
  5078           WS-CF-KEY,
  5079           DFHEIV99,
  5080           DFHEIV99,
  5081           DFHEIV99
  5082     MOVE EIBRESP  TO WS-RESPONSE
  5083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5084     IF (RESP-NORMAL)
  5085        AND (CF-COMPANY-ID = WS-COMP-ID)
  5086        AND (CF-RECORD-TYPE = '3')
  5087        AND (CF-STATE-CODE = CM-STATE)
  5088        MOVE CF-ST-FREE-LOOK-PERIOD
  5089                                 TO WS-FREE-LOOK
  5090        MOVE CF-STATE-ABBREVIATION
  5091                                 TO WS-STATE-ABBREVIATION
  5092        MOVE CF-ST-FST-PMT-DAYS-CHG
  5093                                 TO  WS-STATE-EXT-DAYS-CHG
  5094        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  5095           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  5096           IF CF-ST-RT-CALC NOT = SPACES
  5097              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  5098           END-IF
  5099           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5100              IF CF-ST-RF-LR-CALC > '0'
  5101                 MOVE CF-ST-RF-LR-CALC
  5102                                 TO WS-LF-ST-REFUND-CALC
  5103              END-IF
  5104              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5105                 IF CF-ST-RF-LN-CALC > '0'
  5106                    MOVE CF-ST-RF-LN-CALC
  5107                                 TO WS-LF-ST-REFUND-CALC
  5108                 END-IF
  5109              END-IF
  5110           ELSE
  5111              IF CF-ST-RF-LL-CALC > '0'
  5112                 MOVE CF-ST-RF-LL-CALC
  5113                                 TO WS-LF-ST-REFUND-CALC
  5114              END-IF
  5115           END-IF
  5116           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5117              (S1 > 50)
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  90
* SOCK03.cbl
  5118              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5119                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  5120           END-PERFORM
  5121           IF S1 < +51
  5122              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5123                 MOVE CF-ST-REM-TERM-CALC (S1)
  5124                                 TO WS-LF-ST-REM-TERM-CALC
  5125              END-IF
  5126              IF CF-ST-REFUND-CALC (S1) > '0'
  5127                 MOVE CF-ST-REFUND-CALC (S1)
  5128                                 TO WS-LF-ST-REFUND-CALC
  5129              END-IF
  5130           END-IF
  5131        END-IF
  5132        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  5133           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  5134           IF CF-ST-RT-CALC NOT = SPACES
  5135              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  5136           END-IF
  5137           IF CF-ST-RF-AH-CALC > '0'
  5138              MOVE CF-ST-RF-AH-CALC
  5139                                 TO WS-AH-ST-REFUND-CALC
  5140           END-IF
  5141           IF WS-AH-SPECIAL-CALC-CD = 'C'
  5142              IF CF-ST-RF-CP-CALC > '0'
  5143                 MOVE CF-ST-RF-CP-CALC
  5144                                 TO WS-AH-ST-REFUND-CALC
  5145              END-IF
  5146           END-IF
  5147           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5148              (S1 > 50)
  5149              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5150                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  5151           END-PERFORM
  5152           IF S1 < +51
  5153              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5154                 MOVE CF-ST-REM-TERM-CALC (S1)
  5155                                 TO WS-AH-ST-REM-TERM-CALC
  5156              END-IF
  5157              IF CF-ST-REFUND-CALC (S1) > '0'
  5158                 MOVE CF-ST-REFUND-CALC (S1)
  5159                                 TO WS-AH-ST-REFUND-CALC
  5160              END-IF
  5161           END-IF
  5162        END-IF
  5163     END-IF
  5164     .
  5165 0340-EXIT.
  5166     EXIT.
  5167 0350-GET-ERACCT.
  5168     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  5169                                    WS-AM-EARN-METHOD-R
  5170                                    WS-AM-EARN-METHOD-A
  5171                                    WS-LF-AM-REM-TERM-CALC
  5172                                    WS-AH-AM-REM-TERM-CALC
  5173     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  5174     MOVE CM-CARRIER             TO WS-AM-CARRIER
  5175     MOVE CM-GROUPING            TO WS-AM-GROUPING
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  91
* SOCK03.cbl
  5176     MOVE CM-STATE               TO WS-AM-STATE
  5177     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  5178     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  5179     MOVE LOW-VALUES             TO WS-AM-FILLER
  5180     MOVE ' '                    TO WS-STOP-SW
  5181
  5182* EXEC CICS STARTBR
  5183*       DATASET  ('ERACCT')
  5184*       RIDFLD   (WS-AM-KEY)
  5185*       GTEQ
  5186*       RESP (WS-RESPONSE)
  5187*    END-EXEC
  5188     MOVE 'ERACCT' TO DFHEIV1
  5189     MOVE 0
  5190       TO DFHEIV11
  5191*    MOVE '&,         G          &  N#00004880' TO DFHEIV0
  5192     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5193     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5194     MOVE X'204E233030303034383830' TO DFHEIV0(25:11)
  5195     CALL 'kxdfhei1' USING DFHEIV0,
  5196           DFHEIV1,
  5197           WS-AM-KEY,
  5198           DFHEIV99,
  5199           DFHEIV11,
  5200           DFHEIV99
  5201     MOVE EIBRESP  TO WS-RESPONSE
  5202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5203     IF RESP-NORMAL
  5204        PERFORM UNTIL TOLD-TO-STOP
  5205
  5206* EXEC CICS READNEXT
  5207*             DATASET  ('ERACCT')
  5208*             INTO     (ACCOUNT-MASTER)
  5209*             RIDFLD   (WS-AM-KEY)
  5210*          END-EXEC
  5211     MOVE LENGTH OF
  5212      ACCOUNT-MASTER
  5213       TO DFHEIV12
  5214     MOVE 'ERACCT' TO DFHEIV1
  5215     MOVE 0
  5216       TO DFHEIV11
  5217*    MOVE '&.IL                  )   #00004888' TO DFHEIV0
  5218     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5219     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5220     MOVE X'2020233030303034383838' TO DFHEIV0(25:11)
  5221     CALL 'kxdfhei1' USING DFHEIV0,
  5222           DFHEIV1,
  5223           ACCOUNT-MASTER,
  5224           DFHEIV12,
  5225           WS-AM-KEY,
  5226           DFHEIV99,
  5227           DFHEIV11,
  5228           DFHEIV99,
  5229           DFHEIV99
  5230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5231           IF RESP-NORMAL
  5232              EVALUATE TRUE
  5233                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  92
* SOCK03.cbl
  5234                    CM-CONTROL-PRIMARY (1:20)
  5235                    SET TOLD-TO-STOP TO TRUE
  5236                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5237                    CM-CONTROL-PRIMARY (1:20))
  5238                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5239                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5240                    SET ERACCT-FOUND      TO TRUE
  5241                    SET TOLD-TO-STOP TO TRUE
  5242              END-EVALUATE
  5243           ELSE
  5244              SET TOLD-TO-STOP TO TRUE
  5245           END-IF
  5246        END-PERFORM
  5247
  5248* EXEC CICS ENDBR
  5249*          DATASET   ('ERACCT')
  5250*       END-EXEC
  5251     MOVE 'ERACCT' TO DFHEIV1
  5252     MOVE 0
  5253       TO DFHEIV11
  5254*    MOVE '&2                    $   #00004909' TO DFHEIV0
  5255     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5256     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5257     MOVE X'2020233030303034393039' TO DFHEIV0(25:11)
  5258     CALL 'kxdfhei1' USING DFHEIV0,
  5259           DFHEIV1,
  5260           DFHEIV11,
  5261           DFHEIV99
  5262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5263     END-IF
  5264     .
  5265 0350-EXIT.
  5266     EXIT.
  5267 0400-PROCESS-LIFE.
  5268     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5269     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5270     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5271     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5272     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5273     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5274     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5275     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5276     MOVE CM-CARRIER             TO WS-CARRIER
  5277     MOVE CM-GROUPING            TO WS-GROUPING
  5278     MOVE CM-STATE               TO WS-STATE
  5279     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5280     MOVE CM-CERT-NO             TO WS-CERT-NO
  5281     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5282     MOVE ' '                    TO  DC-OPTION-CODE.
  5283     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5284     IF NO-CONVERSION-ERROR
  5285        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5286     ELSE
  5287        MOVE 99999999            TO WS-CERT-EFF-DATE
  5288     END-IF
  5289     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5290        GO TO 0400-EXIT
  5291     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  93
* SOCK03.cbl
  5292     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5293                                    WS-TOT-LF-PREM
  5294                                    WS-TOT-LF-COMM
  5295     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5296     MOVE ' '                    TO  DC-OPTION-CODE
  5297     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5298     IF NO-CONVERSION-ERROR
  5299        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5300     ELSE
  5301        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5302     END-IF
  5303     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5304     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5305     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5306     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5307     MOVE CM-STATE               TO CP-STATE
  5308     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5309     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5310     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5311     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5312     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5313     MOVE '2'                    TO CP-PROCESS-TYPE
  5314     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5315     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5316     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5317     MOVE WS-CF-REM-TRM-CALC-OPTION
  5318                                 TO CP-REM-TRM-CALC-OPTION
  5319     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5320     IF WS-LF-CO-REM-TERM-CALC > '0'
  5321        MOVE WS-LF-CO-REM-TERM-CALC
  5322                                 TO CP-REM-TERM-METHOD
  5323     END-IF
  5324     IF WS-LF-ST-REM-TERM-CALC > '0'
  5325         MOVE WS-LF-ST-REM-TERM-CALC
  5326                                 TO  CP-REM-TERM-METHOD.
  5327     IF WS-LF-AM-REM-TERM-CALC > '0'
  5328         MOVE WS-LF-AM-REM-TERM-CALC
  5329                                 TO  CP-REM-TERM-METHOD.
  5330     IF (WS-COMP-ID = 'CID')
  5331        AND (CP-STATE-STD-ABBRV = 'WI')
  5332        MOVE '7'                 TO CP-REM-TERM-METHOD
  5333        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5334     END-IF
  5335     IF (WS-COMP-ID = 'CID')
  5336        AND (CP-STATE-STD-ABBRV = 'MO')
  5337        AND (CM-CERT-EFF-DT >= X'9B41')
  5338        AND (CM-CERT-EFF-DT <= X'A2FB')
  5339        MOVE '7'                 TO CP-REM-TERM-METHOD
  5340        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5341     END-IF
  5342     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5343                                    CP-LOAN-TERM
  5344                                    WS-LF-TERM
  5345     IF CP-TRUNCATED-LIFE
  5346         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5347     IF CP-TERM-IS-DAYS
  5348        IF CM-LF-TERM-IN-DAYS NUMERIC
  5349           MOVE CM-LF-TERM-IN-DAYS
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  94
* SOCK03.cbl
  5350                                 TO CP-TERM-OR-EXT-DAYS
  5351        ELSE
  5352           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5353        END-IF
  5354     ELSE
  5355        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5356           MOVE CM-PMT-EXTENSION-DAYS
  5357                                 TO CP-TERM-OR-EXT-DAYS
  5358        ELSE
  5359           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5360        END-IF
  5361     END-IF
  5362     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5363     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5364        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5365        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5366     END-IF
  5367     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5368     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5369     MOVE ' '                    TO WS-CLM-STOP-SW
  5370     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5371     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5372
  5373* EXEC CICS STARTBR
  5374*       DATASET     ('ELMSTR5')
  5375*       RIDFLD      (ELMSTR-KEY)
  5376*       RESP        (WS-RESPONSE)
  5377*    END-EXEC
  5378     MOVE 'ELMSTR5' TO DFHEIV1
  5379     MOVE 0
  5380       TO DFHEIV11
  5381*    MOVE '&,         G          &  N#00005021' TO DFHEIV0
  5382     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5383     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5384     MOVE X'204E233030303035303231' TO DFHEIV0(25:11)
  5385     CALL 'kxdfhei1' USING DFHEIV0,
  5386           DFHEIV1,
  5387           ELMSTR-KEY,
  5388           DFHEIV99,
  5389           DFHEIV11,
  5390           DFHEIV99
  5391     MOVE EIBRESP  TO WS-RESPONSE
  5392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5393     DISPLAY ' AFTER START ' WS-RESPONSE
  5394     IF RESP-NORMAL
  5395        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5396
  5397* EXEC CICS READNEXT
  5398*             DATASET   ('ELMSTR5')
  5399*             RIDFLD    (ELMSTR-KEY)
  5400*             INTO      (CLAIM-MASTER)
  5401*             RESP      (WS-RESPONSE)
  5402*          END-EXEC
  5403     MOVE LENGTH OF
  5404      CLAIM-MASTER
  5405       TO DFHEIV12
  5406     MOVE 'ELMSTR5' TO DFHEIV1
  5407     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  95
* SOCK03.cbl
  5408       TO DFHEIV11
  5409*    MOVE '&.IL                  )  N#00005029' TO DFHEIV0
  5410     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5411     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5412     MOVE X'204E233030303035303239' TO DFHEIV0(25:11)
  5413     CALL 'kxdfhei1' USING DFHEIV0,
  5414           DFHEIV1,
  5415           CLAIM-MASTER,
  5416           DFHEIV12,
  5417           ELMSTR-KEY,
  5418           DFHEIV99,
  5419           DFHEIV11,
  5420           DFHEIV99,
  5421           DFHEIV99
  5422     MOVE EIBRESP  TO WS-RESPONSE
  5423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5424        IF (RESP-NORMAL OR RESP-DUPKEY)
  5425           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5426           AND (CM-CERT-NO = CL-CERT-NO)
  5427           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5428              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5429              IF CL-CLAIM-TYPE = 'L'
  5430                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5431                    MOVE 'D'     TO WS-AH-STATUS
  5432                 END-IF
  5433                 IF CLAIM-IS-OPEN
  5434                    MOVE ' OPEN LIFE CLAIM '
  5435                                 TO WS-COMMENT
  5436                    MOVE 'L'     TO WS-LF-STATUS
  5437                    GO TO 0400-EXIT
  5438                 ELSE
  5439                    MOVE ' DEATH CLAIM APPLIED '
  5440                                 TO WS-COMMENT
  5441                    MOVE 'D'     TO WS-LF-STATUS
  5442*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  5443*                      MOVE CL-PAID-THRU-DT
  5444*                                TO WS-LF-BIN-PAID-THRU-DT
  5445*                   END-IF
  5446                 END-IF
  5447              END-IF
  5448           END-IF
  5449        ELSE
  5450           SET I-SAY-TO-STOP TO TRUE
  5451        END-IF
  5452        END-PERFORM
  5453
  5454* EXEC CICS ENDBR
  5455*          DATASET   ('ELMSTR5')
  5456*       END-EXEC
  5457     MOVE 'ELMSTR5' TO DFHEIV1
  5458     MOVE 0
  5459       TO DFHEIV11
  5460*    MOVE '&2                    $   #00005064' TO DFHEIV0
  5461     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5462     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5463     MOVE X'2020233030303035303634' TO DFHEIV0(25:11)
  5464     CALL 'kxdfhei1' USING DFHEIV0,
  5465           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  96
* SOCK03.cbl
  5466           DFHEIV11,
  5467           DFHEIV99
  5468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5469     END-IF
  5470     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5471*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  5472        MOVE WS-LF-BIN-PAID-THRU-DT
  5473                                 TO DC-BIN-DATE-1
  5474        MOVE ' '                 TO DC-OPTION-CODE
  5475        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5476        IF NO-CONVERSION-ERROR
  5477           MOVE DC-GREG-DATE-CYMD
  5478                                 TO WS-CLM-PAID-THRU-DT
  5479        ELSE
  5480           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5481        END-IF
  5482*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  5483*          MOVE 'CAN DT =< CLM PD THRU DT'
  5484*                                TO WS-COMMENT
  5485*          MOVE 'P'              TO WS-LF-STATUS
  5486*          GO TO 0400-EXIT
  5487*       END-IF
  5488        GO TO 0400-EXIT
  5489     END-IF
  5490     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5491     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5492        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5493        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  5494        COMPUTE CP-REMAINING-TERM-1 =
  5495                CP-REMAINING-TERM-1 - +1
  5496        COMPUTE CP-REMAINING-TERM-2 =
  5497                CP-REMAINING-TERM-2 - +1
  5498     END-IF
  5499     IF CP-REMAINING-TERM-1 NEGATIVE
  5500        MOVE ZEROS               TO CP-REMAINING-TERM-1
  5501     END-IF
  5502     IF CP-REMAINING-TERM-2 NEGATIVE
  5503        MOVE ZEROS               TO CP-REMAINING-TERM-2
  5504     END-IF
  5505     IF CM-LIFE-COMM-PCT NOT NUMERIC
  5506        MOVE ZERO                TO CM-LIFE-COMM-PCT
  5507     END-IF
  5508     IF CM-LIFE-COMM-PCT > ZEROS
  5509        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  5510           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  5511     END-IF
  5512     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  5513     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  5514     IF CM-LF-CURRENT-STATUS = '8'
  5515        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5516           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  5517                                 TO WS-COMMENT
  5518           MOVE 'C'              TO WS-LF-STATUS
  5519*          PERFORM 0030-BUILD-BUFFER
  5520*                                THRU 0030-EXIT
  5521*          PERFORM 0020-SEND-BUFFER
  5522*                                THRU 0020-EXIT
  5523*          SET ALREADY-SENT      TO TRUE
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  97
* SOCK03.cbl
  5524*          MOVE SPACES           TO WS-COMMENT
  5525           GO TO 0400-EXIT
  5526*          PERFORM 0025-CLOSE-SOCKET
  5527*                                THRU 0025-EXIT
  5528*          GO TO 0010-RETURN
  5529        END-IF
  5530     END-IF
  5531     IF CM-LF-CURRENT-STATUS = '7'
  5532        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5533           MOVE ' DEATH CLAIM APPLIED '
  5534                                 TO WS-COMMENT
  5535           MOVE 'D'              TO WS-LF-STATUS
  5536*          PERFORM 0030-BUILD-BUFFER
  5537*                                THRU 0030-EXIT
  5538*          IF NOT ALREADY-SENT
  5539*             PERFORM 0020-SEND-BUFFER
  5540*                                THRU 0020-EXIT
  5541*             SET ALREADY-SENT   TO TRUE
  5542*          END-IF
  5543           GO TO 0400-EXIT
  5544*          PERFORM 0025-CLOSE-SOCKET
  5545*                                THRU 0025-EXIT
  5546*          GO TO 0010-RETURN
  5547        END-IF
  5548     END-IF
  5549     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  5550        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  5551        MOVE 'LF COVERAGE EXPIRED '
  5552                                 TO WS-COMMENT
  5553        MOVE 'E'                 TO WS-LF-STATUS
  5554        GO TO 0400-EXIT
  5555     END-IF
  5556     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5557        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5558        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5559     ELSE
  5560        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  5561     END-IF
  5562     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  5563     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  5564*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  5565     if ws-comp-id = 'AHL'
  5566        move cm-lf-class-cd      to cp-class-code
  5567        if cp-class-code = spaces
  5568           move zeros            to cp-class-code
  5569        end-if
  5570     else
  5571        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5572     end-if
  5573     IF (ws-comp-id = 'DCC')
  5574        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  5575        MOVE ' '                 TO WS-PDEF-RECORD-SW
  5576        PERFORM 0730-GET-DDF-FACTORS
  5577                                 THRU 0730-EXIT
  5578        IF PDEF-FOUND
  5579           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  5580              (P1 > +8)
  5581              OR (PD-PROD-CODE (P1) = 'L')
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  98
* SOCK03.cbl
  5582           END-PERFORM
  5583           IF P1 < +9
  5584              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  5585           END-IF
  5586        END-IF
  5587     END-IF
  5588     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  5589*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
  5590     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  5591        CM-LF-ALT-BENEFIT-AMT
  5592*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  5593     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  5594                                    WS-LF-REM-BEN
  5595     move cm-lf-premium-amt      to ws-tot-lf-prem
  5596     if ws-lf-co-earnings-calc = 'B'
  5597        COMPUTE WS-TOT-LF-PREM = ws-tot-lf-prem
  5598           + CM-LF-ALT-PREMIUM-AMT
  5599     end-if
  5600     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  5601     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5602        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5603        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5604     ELSE
  5605        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  5606     END-IF
  5607     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  5608     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  5609     IF WS-LF-ST-REFUND-CALC > ZERO
  5610         MOVE WS-LF-ST-REFUND-CALC
  5611                                 TO  CP-EARNING-METHOD.
  5612     IF WS-LF-FO-REFUND-CALC > ZERO
  5613         MOVE WS-LF-FO-REFUND-CALC
  5614                                 TO  CP-EARNING-METHOD.
  5615     IF CP-RATING-METHOD = '4'
  5616        MOVE '4'                 TO CP-EARNING-METHOD
  5617     END-IF
  5618*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  5619     if ws-comp-id = 'AHL'
  5620        move cm-lf-class-cd      to cp-class-code
  5621        if cp-class-code = spaces
  5622           move zeros            to cp-class-code
  5623        end-if
  5624     else
  5625        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5626     end-if
  5627     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  5628     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  5629                                     CP-RATING-BENEFIT-AMT.
  5630     IF CP-STATE-STD-ABBRV = 'OR'
  5631         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5632                                         CM-LF-ALT-BENEFIT-AMT.
  5633****   N O T E   ****
  5634*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  5635*      THE OH HARD CODING IN ELCRFNDP
  5636     IF WS-COMP-ID = 'CID'
  5637        IF CP-STATE-STD-ABBRV = 'OH'
  5638           MOVE WS-LF-CO-EARNINGS-CALC
  5639                                 TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page  99
* SOCK03.cbl
  5640        END-IF
  5641     END-IF
  5642****   N O T E   ****
  5643     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  5644     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  5645     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  5646     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  5647     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  5648     IF CP-EARN-AS-NET-PAY
  5649        IF CP-LOAN-APR <= ZEROS
  5650           IF WS-CF-DEFAULT-APR > ZEROS
  5651              MOVE WS-CF-DEFAULT-APR
  5652                                 TO  CP-LOAN-APR
  5653           END-IF
  5654        END-IF
  5655     END-IF
  5656*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  5657*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  5658*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  5659*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  5660*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  5661*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  5662*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  5663*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  5664*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  5665*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  5666*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  5667*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  5668*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  5669*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  5670*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  5671*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  5672*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  5673     MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  5674     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  5675     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  5676     DISPLAY ' MADE IT BACK FROM ELRFND '
  5677     IF (CP-ERROR-RATE-IS-ZERO)
  5678        OR (CP-ERROR-RATE-NOT-FOUND)
  5679        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5680        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  5681          DELIMITED BY SIZE INTO WS-COMMENT
  5682        END-STRING
  5683        MOVE 'X'                 TO WS-LF-STATUS
  5684        GO TO 0400-EXIT
  5685*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5686*       IF NOT ALREADY-SENT
  5687*          PERFORM 0020-SEND-BUFFER
  5688*                                THRU 0020-EXIT
  5689*          SET ALREADY-SENT      TO TRUE
  5690*       END-IF
  5691*       PERFORM 0025-CLOSE-SOCKET
  5692*                                THRU 0025-EXIT
  5693*       GO TO 0010-RETURN
  5694     END-IF
  5695     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  5696                                    WS-TOT-LF-RFND
  5697     IF (WS-LF-STATUS = SPACES)
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 100
* SOCK03.cbl
  5698        OR (CP-CALC-REFUND > ZEROS)
  5699        MOVE 'A'                 TO WS-LF-STATUS
  5700     END-IF
  5701     EVALUATE TRUE
  5702        WHEN CP-R-AS-R78
  5703           MOVE 'RULE 78'          TO  WS-LF-METHOD
  5704        WHEN  CP-R-AS-PRORATA
  5705           MOVE 'PRO RATA'         TO  WS-LF-METHOD
  5706        WHEN CP-R-AS-CALIF
  5707           MOVE 'CALIF'            TO  WS-LF-METHOD
  5708        WHEN CP-R-AS-TEXAS
  5709           MOVE 'IRREG'            TO  WS-LF-METHOD
  5710        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  5711           MOVE 'UTAH'             TO  WS-LF-METHOD
  5712        WHEN CP-R-AS-FARM-PLAN
  5713           MOVE 'FARM PLAN'        TO  WS-LF-METHOD
  5714        WHEN CP-R-AS-NET-PAY
  5715           MOVE 'NET PAY'          TO  WS-LF-METHOD
  5716        WHEN CP-R-AS-ANTICIPATION
  5717           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  5718        WHEN CP-R-AS-MEAN
  5719           MOVE 'MEAN'             TO  WS-LF-METHOD
  5720        WHEN CP-R-AS-SUM-OF-DIGITS
  5721           MOVE 'SUM OF DIGIT'     TO  WS-LF-METHOD
  5722     END-EVALUATE
  5723     IF WS-TOT-LF-RFND > ZEROS
  5724        COMPUTE WS-WORK-FACTOR ROUNDED =
  5725           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  5726        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  5727           WS-TOT-LF-COMM
  5728     END-IF
  5729     IF ERACCT-FOUND
  5730        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  5731           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  5732        END-IF
  5733        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5734           IF (AM-COMM-CHARGEBACK (1) = 99)
  5735                     OR
  5736              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5737                     OR
  5738              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5739              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5740              MOVE ZEROS         TO WS-LF-UEC
  5741           END-IF
  5742        END-IF
  5743     END-IF
  5744     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  5745        GO TO 0400-EXIT
  5746     END-IF
  5747     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  5748     MOVE '2'                    TO  CP-EARNING-METHOD
  5749                                     CP-RATING-METHOD.
  5750     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  5751                                     CP-REMAINING-BENEFIT
  5752                                     CP-RATING-BENEFIT-AMT.
  5753     IF CP-STATE-STD-ABBRV = 'OR'
  5754         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5755                                         CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 101
* SOCK03.cbl
  5756     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  5757     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  5758     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  5759     IF (CP-ERROR-RATE-IS-ZERO)
  5760        OR (CP-ERROR-RATE-NOT-FOUND)
  5761        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5762        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  5763          DELIMITED BY SIZE INTO WS-COMMENT
  5764        END-STRING
  5765        MOVE 'X'              TO WS-LF-STATUS
  5766        GO TO 0400-EXIT
  5767*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5768*       IF NOT ALREADY-SENT
  5769*          PERFORM 0020-SEND-BUFFER
  5770*                                THRU 0020-EXIT
  5771*          SET ALREADY-SENT      TO TRUE
  5772*       END-IF
  5773*       PERFORM 0025-CLOSE-SOCKET
  5774*                                THRU 0025-EXIT
  5775*       GO TO 0010-RETURN
  5776     END-IF
  5777     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  5778     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  5779     IF WS-TOT-LF-RFND > ZEROS
  5780        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  5781           WS-TOT-LF-COMM
  5782     END-IF
  5783     IF ERACCT-FOUND
  5784        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5785           IF (AM-COMM-CHARGEBACK (1) = 99)
  5786                     OR
  5787              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5788                     OR
  5789              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5790              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5791              MOVE ZEROS         TO WS-LF-UEC
  5792           END-IF
  5793        END-IF
  5794     END-IF
  5795     .
  5796 0400-EXIT.
  5797     EXIT.
  5798 0500-PROCESS-AH.
  5799     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  5800        GO TO 0500-EXIT
  5801     END-IF
  5802     MOVE ZEROS                  TO WS-TOT-AH-RFND
  5803                                    WS-TOT-AH-PREM
  5804                                    WS-TOT-AH-COMM
  5805     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5806     MOVE ' '                    TO  DC-OPTION-CODE
  5807     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5808     IF NO-CONVERSION-ERROR
  5809        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  5810     ELSE
  5811        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  5812     END-IF
  5813     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 102
* SOCK03.cbl
  5814     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  5815     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  5816     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  5817     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  5818     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  5819     MOVE CM-STATE               TO  CP-STATE.
  5820     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  5821     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  5822     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  5823     MOVE '2'                    TO  CP-PROCESS-TYPE.
  5824     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  5825     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  5826     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  5827     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  5828     MOVE WS-CF-CR-REM-TERM-CALC
  5829                                 TO  CP-REM-TERM-METHOD.
  5830     IF WS-AH-CO-REM-TERM-CALC > '0'
  5831         MOVE WS-AH-CO-REM-TERM-CALC
  5832                                 TO  CP-REM-TERM-METHOD.
  5833     IF WS-AH-ST-REM-TERM-CALC > '0'
  5834         MOVE WS-AH-ST-REM-TERM-CALC
  5835                                 TO  CP-REM-TERM-METHOD.
  5836     IF WS-AH-AM-REM-TERM-CALC > '0'
  5837         MOVE WS-AH-AM-REM-TERM-CALC
  5838                                 TO  CP-REM-TERM-METHOD.
  5839     IF (WS-COMP-ID = 'CID')
  5840        AND (CP-STATE-STD-ABBRV = 'WI')
  5841        MOVE '7'                 TO CP-REM-TERM-METHOD
  5842        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5843     END-IF
  5844     IF (WS-COMP-ID = 'CID')
  5845        AND (CP-STATE-STD-ABBRV = 'MO')
  5846        AND (CM-CERT-EFF-DT >= X'9B41')
  5847        AND (CM-CERT-EFF-DT <= X'A2FB')
  5848        MOVE '7'                 TO CP-REM-TERM-METHOD
  5849        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5850     END-IF
  5851     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  5852                                     CP-LOAN-TERM.
  5853     IF  NOT  CP-TERM-IS-DAYS
  5854         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  5855             MOVE CM-PMT-EXTENSION-DAYS
  5856                                 TO  CP-TERM-OR-EXT-DAYS
  5857         ELSE
  5858             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  5859     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5860     IF CM-AH-COMM-PCT > ZEROS
  5861        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  5862           CM-AH-PREMIUM-AMT
  5863     END-IF
  5864     IF (ws-comp-id = 'DCC')
  5865        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  5866        compute ws-tot-ah-comm = cm-ah-premium-amt -
  5867           (cm-ah-clp + cm-addl-clp)
  5868     end-if
  5869     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  5870     IF WS-AH-STATUS = 'D'
  5871        GO TO 0500-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 103
* SOCK03.cbl
  5872     END-IF
  5873     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  5874     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  5875     MOVE ' '                    TO WS-CLM-STOP-SW
  5876     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5877     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5878
  5879* EXEC CICS STARTBR
  5880*       DATASET     ('ELMSTR5')
  5881*       RIDFLD      (ELMSTR-KEY)
  5882*       RESP        (WS-RESPONSE)
  5883*    END-EXEC
  5884     MOVE 'ELMSTR5' TO DFHEIV1
  5885     MOVE 0
  5886       TO DFHEIV11
  5887*    MOVE '&,         G          &  N#00005476' TO DFHEIV0
  5888     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5889     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5890     MOVE X'204E233030303035343736' TO DFHEIV0(25:11)
  5891     CALL 'kxdfhei1' USING DFHEIV0,
  5892           DFHEIV1,
  5893           ELMSTR-KEY,
  5894           DFHEIV99,
  5895           DFHEIV11,
  5896           DFHEIV99
  5897     MOVE EIBRESP  TO WS-RESPONSE
  5898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5899     DISPLAY ' AFTER START ' WS-RESPONSE
  5900     IF RESP-NORMAL
  5901        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5902           DISPLAY ' AH READNEXT '
  5903
  5904* EXEC CICS READNEXT
  5905*             DATASET   ('ELMSTR5')
  5906*             RIDFLD    (ELMSTR-KEY)
  5907*             INTO      (CLAIM-MASTER)
  5908*             RESP      (WS-RESPONSE)
  5909*          END-EXEC
  5910     MOVE LENGTH OF
  5911      CLAIM-MASTER
  5912       TO DFHEIV12
  5913     MOVE 'ELMSTR5' TO DFHEIV1
  5914     MOVE 0
  5915       TO DFHEIV11
  5916*    MOVE '&.IL                  )  N#00005485' TO DFHEIV0
  5917     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5918     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5919     MOVE X'204E233030303035343835' TO DFHEIV0(25:11)
  5920     CALL 'kxdfhei1' USING DFHEIV0,
  5921           DFHEIV1,
  5922           CLAIM-MASTER,
  5923           DFHEIV12,
  5924           ELMSTR-KEY,
  5925           DFHEIV99,
  5926           DFHEIV11,
  5927           DFHEIV99,
  5928           DFHEIV99
  5929     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 104
* SOCK03.cbl
  5930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5931        IF (RESP-NORMAL OR RESP-DUPKEY)
  5932           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5933           AND (CM-CERT-NO = CL-CERT-NO)
  5934           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5935              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5936              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G')
  5937                 IF CLAIM-IS-OPEN
  5938                    DISPLAY ' FOUND OPEN AH CLAIM '
  5939                    MOVE ' OPEN HEALTH CLAIM '
  5940                                 TO WS-COMMENT
  5941                    MOVE 'H'     TO WS-AH-STATUS
  5942                 ELSE
  5943                    DISPLAY ' FOUND CLOSED AH CLAIM '
  5944                    MOVE ' CLOSED HEALTH CLAIM '
  5945                                 TO WS-COMMENT
  5946                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  5947                       MOVE CL-PAID-THRU-DT
  5948                                 TO WS-AH-BIN-PAID-THRU-DT
  5949                    END-IF
  5950                 END-IF
  5951              END-IF
  5952           END-IF
  5953        ELSE
  5954           SET I-SAY-TO-STOP TO TRUE
  5955        END-IF
  5956        END-PERFORM
  5957
  5958* EXEC CICS ENDBR
  5959*          DATASET   ('ELMSTR5')
  5960*       END-EXEC
  5961     MOVE 'ELMSTR5' TO DFHEIV1
  5962     MOVE 0
  5963       TO DFHEIV11
  5964*    MOVE '&2                    $   #00005517' TO DFHEIV0
  5965     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5966     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5967     MOVE X'2020233030303035353137' TO DFHEIV0(25:11)
  5968     CALL 'kxdfhei1' USING DFHEIV0,
  5969           DFHEIV1,
  5970           DFHEIV11,
  5971           DFHEIV99
  5972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5973     END-IF
  5974     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5975*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  5976        MOVE WS-AH-BIN-PAID-THRU-DT
  5977                                 TO DC-BIN-DATE-1
  5978        MOVE ' '                 TO DC-OPTION-CODE
  5979        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5980        IF NO-CONVERSION-ERROR
  5981           MOVE DC-GREG-DATE-CYMD
  5982                                 TO WS-CLM-PAID-THRU-DT
  5983        ELSE
  5984           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5985        END-IF
  5986        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  5987           MOVE 'CAN DT NOT > CLM CLOSE DT '
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 105
* SOCK03.cbl
  5988                                 TO WS-COMMENT
  5989           MOVE 'P'              TO WS-AH-STATUS
  5990           GO TO 0500-EXIT
  5991        END-IF
  5992     END-IF
  5993     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5994     IF CM-AH-CURRENT-STATUS = '8'
  5995        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  5996           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  5997                                 TO WS-COMMENT
  5998           MOVE 'C'              TO WS-AH-STATUS
  5999           GO TO 0500-EXIT
  6000        END-IF
  6001     END-IF
  6002     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  6003        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  6004           MOVE ' SETTLEMENT CLAIM APPLIED '
  6005                                 TO WS-COMMENT
  6006           MOVE 'S'              TO WS-AH-STATUS
  6007*          PERFORM 0030-BUILD-BUFFER
  6008*                                THRU 0030-EXIT
  6009*          IF NOT ALREADY-SENT
  6010*             PERFORM 0020-SEND-BUFFER
  6011*                                THRU 0020-EXIT
  6012*             SET ALREADY-SENT   TO TRUE
  6013*          END-IF
  6014           GO TO 0500-EXIT
  6015*          PERFORM 0025-CLOSE-SOCKET
  6016*                                THRU 0025-EXIT
  6017*          GO TO 0010-RETURN
  6018        END-IF
  6019     END-IF
  6020     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6021        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  6022        MOVE 'AH COVERAGE EXPIRED '
  6023                                 TO WS-COMMENT
  6024        MOVE 'E'                 TO WS-AH-STATUS
  6025        GO TO 0500-EXIT
  6026     END-IF
  6027     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  6028                                    WS-AH-PREM
  6029     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  6030     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  6031        * CP-REMAINING-TERM-1
  6032     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  6033                                     WS-AH-REM-TERM
  6034     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6035     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6036     IF WS-AH-ST-REFUND-CALC > ZERO
  6037         MOVE WS-AH-ST-REFUND-CALC
  6038                                 TO  CP-EARNING-METHOD.
  6039     IF WS-AH-FO-REFUND-CALC > ZERO
  6040         MOVE WS-AH-FO-REFUND-CALC
  6041                                 TO  CP-EARNING-METHOD.
  6042*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6043     if ws-comp-id = 'AHL'
  6044        move cm-ah-class-cd      to cp-class-code
  6045        if cp-class-code = spaces
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 106
* SOCK03.cbl
  6046           move zeros            to cp-class-code
  6047        end-if
  6048     else
  6049        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6050     end-if
  6051     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6052     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6053                                     CP-RATING-BENEFIT-AMT.
  6054     IF CP-STATE-STD-ABBRV = 'OR'
  6055         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6056                                         CM-AH-ORIG-TERM.
  6057     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6058     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6059     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6060     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6061     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6062     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6063     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6064     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6065     MOVE ' '                    TO  DC-OPTION-CODE.
  6066     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6067     IF CP-STATE-STD-ABBRV = 'OH'
  6068        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6069         IF (CP-ORIGINAL-TERM > 60)
  6070           AND (DC-GREG-DATE-1-YMD > '831101')
  6071           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6072             MOVE '6'            TO  CP-EARNING-METHOD
  6073         END-IF
  6074        END-IF
  6075        IF WS-COMP-ID = 'CID'
  6076           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6077                           LOW-VALUES)
  6078              IF CP-CRITICAL-PERIOD
  6079                 MOVE '2'       TO CP-EARNING-METHOD
  6080              ELSE
  6081                 MOVE '6'       TO CP-EARNING-METHOD
  6082              END-IF
  6083           ELSE
  6084              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6085                 MOVE '2'       TO CP-EARNING-METHOD
  6086              ELSE
  6087                 IF ((CM-LF-ORIG-TERM > 60) AND
  6088                    (CM-RATE-CLASS NOT = 'L '))
  6089                               OR
  6090                    (WS-LF-CO-EARNINGS-CALC = '5')
  6091                    IF CP-CRITICAL-PERIOD
  6092                       MOVE '2'  TO CP-EARNING-METHOD
  6093                    ELSE
  6094                       MOVE '6'  TO CP-EARNING-METHOD
  6095                    END-IF
  6096                 ELSE
  6097                    MOVE '1'     TO CP-EARNING-METHOD
  6098                 END-IF
  6099              END-IF
  6100           END-IF
  6101        END-IF
  6102     END-IF
  6103     IF CP-STATE-STD-ABBRV = 'VA'
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 107
* SOCK03.cbl
  6104       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6105         IF DC-GREG-DATE-1-YMD > '921231'
  6106            IF CP-ORIGINAL-TERM > 61
  6107                MOVE '6'            TO  CP-EARNING-METHOD
  6108            ELSE
  6109                MOVE '1'            TO  CP-EARNING-METHOD.
  6110     IF CP-EARN-AS-NET-PAY
  6111        IF CP-LOAN-APR <= ZEROS
  6112           IF WS-CF-DEFAULT-APR > ZEROS
  6113              MOVE WS-CF-DEFAULT-APR
  6114                                 TO  CP-LOAN-APR
  6115           END-IF
  6116        END-IF
  6117     END-IF
  6118     IF WS-COMP-ID = 'DCC'
  6119        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6120           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  6121           MOVE 'S'              TO CP-EARNING-METHOD
  6122        END-IF
  6123     END-IF
  6124     MOVE WS-CANCEL-REASON       TO CP-CANCEL-REASON
  6125     IF (WS-COMP-ID = 'DCC')
  6126        AND (CP-EARNING-METHOD = 'D')
  6127        MOVE +0                  TO WS-DDF-ADMIN-FEES
  6128                                    WS-DDF-CSO-ADMIN-FEE
  6129                                    WS-DDF-1ST-YR-TOT-EXP
  6130                                    WS-DDF-COMM-AND-MFEE
  6131        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  6132           S1 > +10
  6133           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  6134              IF (AM-A-COM (S1) NUMERIC)
  6135                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  6136                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  6137              ELSE
  6138                 MOVE +0         TO WS-COMM-PCT C0
  6139                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  6140                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  6141              END-IF
  6142              IF AM-COM-TYP (S1) = 'L' OR 'N'
  6143                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  6144                    + WS-COMM-PCT
  6145              END-IF
  6146              IF AM-COM-TYP (S1) = 'N'
  6147                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  6148                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  6149              END-IF
  6150              IF AM-COM-TYP (S1) = 'J' OR 'L'
  6151                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  6152                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  6153              END-IF
  6154              IF AM-COM-TYP (S1) = 'I'
  6155                 COMPUTE WS-DDF-COMM-AND-MFEE
  6156                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  6157              END-IF
  6158           END-IF
  6159        END-PERFORM
  6160        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  6161        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 108
* SOCK03.cbl
  6162        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  6163           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  6164     END-IF
  6165     IF (WS-COMP-ID = 'DCC')
  6166        AND (CP-EARNING-METHOD = 'D')
  6167        AND (ws-CANCEL-REASON NOT = 'R')
  6168        PERFORM 0730-GET-DDF-FACTORS
  6169                                 THRU 0730-EXIT
  6170        IF NOT PDEF-FOUND
  6171           MOVE ' DDF UE FACTORS  NOT FOUND '
  6172                                 TO WS-COMMENT
  6173           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  6174           PERFORM 0030-BUILD-BUFFER
  6175                                 THRU 0030-EXIT
  6176           PERFORM 0020-SEND-BUFFER
  6177                                 THRU 0020-EXIT
  6178           PERFORM 0025-CLOSE-SOCKET
  6179                                 THRU 0025-EXIT
  6180           GO TO 0010-RETURN
  6181        END-IF
  6182*       IF NOT PDEF-FOUND
  6183*          MOVE ER-9999          TO EMI-ERROR
  6184*          PERFORM 9700-ERROR-FORMAT
  6185*                                THRU 9799-EXIT
  6186*          GO TO 8200-SEND-DATAONLY
  6187*       END-IF
  6188        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  6189                                 TO CP-DDF-LO-FACT
  6190        MOVE PD-UEP-FACTOR (P1 P2)
  6191                                 TO CP-DDF-HI-FACT
  6192        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  6193        MOVE CM-AH-CLP           TO CP-DDF-CLP
  6194        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  6195        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  6196           + PD-1ST-YR-ADMIN-ALLOW
  6197        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  6198*       IF PI-CLP-YN = 'Y'
  6199*          MOVE 'C'              TO CP-DDF-SPEC-CALC
  6200*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  6201*                                   CP-DDF-CLP
  6202*          MOVE ZEROS            TO CP-1ST-YR-ALLOW
  6203*       END-IF
  6204        IF DD-IU-PRESENT
  6205           MOVE 'I'              TO CP-EARNING-METHOD
  6206        END-IF
  6207        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6208                                    CP-CLP-RATE-UP
  6209        IF (CP-CALC-GROSS-FEE)
  6210           AND (CP-IU-RATE-UP NOT = ZEROS)
  6211           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  6212              / CP-ORIGINAL-PREMIUM)
  6213           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  6214              / (1 - TEX-FACT-8)
  6215        END-IF
  6216     END-IF
  6217     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6218     IF (CP-ERROR-RATE-IS-ZERO)
  6219        OR (CP-ERROR-RATE-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 109
* SOCK03.cbl
  6220        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6221        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  6222          DELIMITED BY SIZE INTO WS-COMMENT
  6223        END-STRING
  6224        IF WS-AH-STATUS NOT = 'H'
  6225           MOVE 'X'                 TO WS-AH-STATUS
  6226        END-IF
  6227        GO TO 0500-EXIT
  6228*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6229*       IF NOT ALREADY-SENT
  6230*          PERFORM 0020-SEND-BUFFER
  6231*                                THRU 0020-EXIT
  6232*          SET ALREADY-SENT      TO TRUE
  6233*       END-IF
  6234*       PERFORM 0025-CLOSE-SOCKET
  6235*                                THRU 0025-EXIT
  6236*       GO TO 0010-RETURN
  6237     END-IF
  6238     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  6239                                    WS-TOT-AH-RFND
  6240     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  6241     IF ((WS-AH-STATUS = SPACES)
  6242        OR (CP-CALC-REFUND > ZEROS))
  6243                  AND
  6244          (WS-AH-STATUS NOT = 'H')
  6245        MOVE 'A'                 TO WS-AH-STATUS
  6246     END-IF
  6247     IF WS-COMP-ID = 'DCC'
  6248        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6249        AND (CP-EARNING-METHOD = 'D' OR 'I')
  6250        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6251        MOVE 'C'                 TO CP-DDF-SPEC-CALC
  6252        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
  6253        MOVE ZEROS               TO CP-1ST-YR-ALLOW
  6254        PERFORM 0720-LINK-REFUND THRU  0720-EXIT
  6255        MOVE CP-CALC-REFUND      TO ws-ah-rfnd-clp
  6256        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
  6257     END-IF
  6258     EVALUATE TRUE
  6259        WHEN CP-R-AS-R78
  6260           MOVE 'RULE 78'          TO  WS-AH-METHOD
  6261        WHEN CP-R-AS-PRORATA
  6262           MOVE 'PRO RATA'         TO  WS-AH-METHOD
  6263        WHEN CP-REFUND-TYPE-USED = '3'
  6264           MOVE 'CALIF'            TO  WS-AH-METHOD
  6265        WHEN CP-R-AS-TEXAS
  6266           MOVE 'IRREG'            TO  WS-AH-METHOD
  6267        WHEN CP-R-AS-FARM-PLAN
  6268           MOVE 'FARM PLAN'        TO  WS-AH-METHOD
  6269        WHEN CP-R-AS-NET-PAY
  6270           MOVE 'NET PAY'          TO  WS-AH-METHOD
  6271        WHEN CP-R-AS-ANTICIPATION
  6272           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  6273        WHEN CP-R-AS-MEAN
  6274           MOVE 'MEAN'             TO  WS-AH-METHOD
  6275        WHEN CP-R-AS-SUM-OF-DIGITS
  6276           MOVE 'SUM OF DIGIT'     TO  WS-AH-METHOD
  6277        WHEN CP-GAP-ACTUARIAL
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 110
* SOCK03.cbl
  6278           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  6279     END-EVALUATE
  6280     IF WS-TOT-AH-RFND > ZEROS
  6281        IF (ws-comp-id = 'DCC')
  6282           AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6283           compute ws-work-factor rounded =
  6284              ws-ah-rfnd-clp / cm-ah-clp
  6285        else
  6286           COMPUTE WS-WORK-FACTOR ROUNDED =
  6287              WS-TOT-AH-RFND / WS-TOT-AH-PREM
  6288        end-if
  6289        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  6290           WS-TOT-AH-COMM
  6291     END-IF
  6292     IF ERACCT-FOUND
  6293        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6294           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6295        END-IF
  6296        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6297           IF (AM-COMM-CHARGEBACK (1) = 99)
  6298                     OR
  6299              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6300                     OR
  6301              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6302              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6303              MOVE ZEROS         TO WS-AH-UEC
  6304           END-IF
  6305        END-IF
  6306     END-IF
  6307     .
  6308 0500-EXIT.
  6309     EXIT.
  6310 0700-LINK-REM-TERM.
  6311
  6312* EXEC CICS LINK
  6313*        PROGRAM   ('ELRTRM')
  6314*        COMMAREA  (CALCULATION-PASS-AREA)
  6315*        LENGTH    (CP-COMM-LENGTH)
  6316*    END-EXEC.
  6317     MOVE 'ELRTRM' TO DFHEIV1
  6318*    MOVE '."C                   (   #00005858' TO DFHEIV0
  6319     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6320     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6321     MOVE X'2020233030303035383538' TO DFHEIV0(25:11)
  6322     CALL 'kxdfhei1' USING DFHEIV0,
  6323           DFHEIV1,
  6324           CALCULATION-PASS-AREA,
  6325           CP-COMM-LENGTH,
  6326           DFHEIV99,
  6327           DFHEIV99,
  6328           DFHEIV99,
  6329           DFHEIV99
  6330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6331
  6332 0700-EXIT.
  6333     EXIT.
  6334 0710-LINK-REM-AMOUNT.
  6335
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 111
* SOCK03.cbl
  6336* EXEC CICS LINK
  6337*        PROGRAM   ('ELRAMT')
  6338*        COMMAREA  (CALCULATION-PASS-AREA)
  6339*        LENGTH    (CP-COMM-LENGTH)
  6340*    END-EXEC
  6341     MOVE 'ELRAMT' TO DFHEIV1
  6342*    MOVE '."C                   (   #00005866' TO DFHEIV0
  6343     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6344     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6345     MOVE X'2020233030303035383636' TO DFHEIV0(25:11)
  6346     CALL 'kxdfhei1' USING DFHEIV0,
  6347           DFHEIV1,
  6348           CALCULATION-PASS-AREA,
  6349           CP-COMM-LENGTH,
  6350           DFHEIV99,
  6351           DFHEIV99,
  6352           DFHEIV99,
  6353           DFHEIV99
  6354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6355     .
  6356 0710-EXIT.
  6357     EXIT.
  6358 0720-LINK-REFUND.
  6359
  6360* EXEC CICS LINK
  6361*        PROGRAM   ('ELRFND')
  6362*        COMMAREA  (CALCULATION-PASS-AREA)
  6363*        LENGTH    (CP-COMM-LENGTH)
  6364*    END-EXEC
  6365     MOVE 'ELRFND' TO DFHEIV1
  6366*    MOVE '."C                   (   #00005875' TO DFHEIV0
  6367     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6368     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6369     MOVE X'2020233030303035383735' TO DFHEIV0(25:11)
  6370     CALL 'kxdfhei1' USING DFHEIV0,
  6371           DFHEIV1,
  6372           CALCULATION-PASS-AREA,
  6373           CP-COMM-LENGTH,
  6374           DFHEIV99,
  6375           DFHEIV99,
  6376           DFHEIV99,
  6377           DFHEIV99
  6378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6379     .
  6380 0720-EXIT.
  6381     EXIT.
  6382 0730-GET-DDF-FACTORS.
  6383     MOVE ' '                    TO WS-PDEF-RECORD-SW
  6384     MOVE WS-COMP-CD             TO ERPDEF-KEY
  6385     MOVE CM-STATE               TO ERPDEF-STATE
  6386     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6387     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  6388     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  6389     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6390     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  6391
  6392* EXEC CICS STARTBR
  6393*        DATASET  ('ERPDEF')
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 112
* SOCK03.cbl
  6394*        RIDFLD   (ERPDEF-KEY)
  6395*        GTEQ
  6396*        RESP     (WS-RESPONSE)
  6397*    END-EXEC
  6398     MOVE 'ERPDEF' TO DFHEIV1
  6399     MOVE 0
  6400       TO DFHEIV11
  6401*    MOVE '&,         G          &  N#00005892' TO DFHEIV0
  6402     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6403     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6404     MOVE X'204E233030303035383932' TO DFHEIV0(25:11)
  6405     CALL 'kxdfhei1' USING DFHEIV0,
  6406           DFHEIV1,
  6407           ERPDEF-KEY,
  6408           DFHEIV99,
  6409           DFHEIV11,
  6410           DFHEIV99
  6411     MOVE EIBRESP  TO WS-RESPONSE
  6412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6413     IF NOT RESP-NORMAL
  6414        GO TO 0730-EXIT
  6415     END-IF
  6416     .
  6417 0730-READNEXT.
  6418
  6419* EXEC CICS READNEXT
  6420*       DATASET  ('ERPDEF')
  6421*       INTO     (PRODUCT-MASTER)
  6422*       RIDFLD   (ERPDEF-KEY)
  6423*       RESP     (WS-RESPONSE)
  6424*    END-EXEC
  6425     MOVE LENGTH OF
  6426      PRODUCT-MASTER
  6427       TO DFHEIV12
  6428     MOVE 'ERPDEF' TO DFHEIV1
  6429     MOVE 0
  6430       TO DFHEIV11
  6431*    MOVE '&.IL                  )  N#00005903' TO DFHEIV0
  6432     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6433     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6434     MOVE X'204E233030303035393033' TO DFHEIV0(25:11)
  6435     CALL 'kxdfhei1' USING DFHEIV0,
  6436           DFHEIV1,
  6437           PRODUCT-MASTER,
  6438           DFHEIV12,
  6439           ERPDEF-KEY,
  6440           DFHEIV99,
  6441           DFHEIV11,
  6442           DFHEIV99,
  6443           DFHEIV99
  6444     MOVE EIBRESP  TO WS-RESPONSE
  6445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6446     IF NOT RESP-NORMAL
  6447        GO TO 0730-ENDBR
  6448     END-IF
  6449     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  6450        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  6451           MOVE 'Y'              TO WS-PDEF-RECORD-SW
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 113
* SOCK03.cbl
  6452        ELSE
  6453           GO TO 0730-READNEXT
  6454        END-IF
  6455     ELSE
  6456        GO TO 0730-ENDBR
  6457     END-IF
  6458     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  6459        (P1 > +8)
  6460        OR (PD-PROD-CODE (P1) = 'I')
  6461     END-PERFORM
  6462     IF P1 < +9
  6463        SET DD-IU-PRESENT        TO TRUE
  6464     END-IF
  6465     IF CM-LOAN-TERM = ZEROS
  6466        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  6467     END-IF
  6468     IF PD-TRUNCATED = 'Y'
  6469        MOVE CM-LOAN-TERM        TO WS-TERM
  6470     ELSE
  6471        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  6472     END-IF
  6473     EVALUATE TRUE
  6474        WHEN WS-TERM > +168
  6475           MOVE 15               TO P1
  6476        WHEN WS-TERM > +156
  6477           MOVE 14               TO P1
  6478        WHEN WS-TERM > +144
  6479           MOVE 13               TO P1
  6480        WHEN WS-TERM > +132
  6481           MOVE 12               TO P1
  6482        WHEN WS-TERM > +120
  6483           MOVE 11               TO P1
  6484        WHEN WS-TERM > +108
  6485           MOVE 10               TO P1
  6486        WHEN WS-TERM > +96
  6487           MOVE 9                TO P1
  6488        WHEN WS-TERM > +84
  6489           MOVE 8                TO P1
  6490        WHEN WS-TERM > +72
  6491           MOVE 7                TO P1
  6492        WHEN WS-TERM > +60
  6493           MOVE 6                TO P1
  6494        WHEN WS-TERM > +48
  6495           MOVE 5                TO P1
  6496        WHEN WS-TERM > +36
  6497           MOVE 4                TO P1
  6498        WHEN WS-TERM > +24
  6499           MOVE 3                TO P1
  6500        WHEN WS-TERM > +12
  6501           MOVE 2                TO P1
  6502        WHEN OTHER
  6503           MOVE 1                TO P1
  6504     END-EVALUATE
  6505     EVALUATE TRUE
  6506*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  6507*          AND (DD-IU-PRESENT)
  6508*          MOVE 2                TO P2
  6509*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 114
* SOCK03.cbl
  6510*          MOVE 1                TO P2
  6511        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  6512           MOVE 2                TO P2
  6513        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  6514           MOVE 3                TO P2
  6515        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  6516           MOVE 4                TO P2
  6517        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  6518           MOVE 5                TO P2
  6519        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  6520           MOVE 6                TO P2
  6521        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  6522           MOVE 7                TO P2
  6523        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  6524           MOVE 8                TO P2
  6525        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  6526           MOVE 9                TO P2
  6527        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  6528           MOVE 10               TO P2
  6529        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  6530           MOVE 11               TO P2
  6531        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  6532           MOVE 12               TO P2
  6533        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  6534           MOVE 13               TO P2
  6535        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  6536           MOVE 14               TO P2
  6537        WHEN OTHER
  6538           MOVE 15               TO P2
  6539     END-EVALUATE
  6540     .
  6541 0730-ENDBR.
  6542
  6543* EXEC CICS ENDBR
  6544*       DATASET  ('ERPDEF')
  6545*    END-EXEC
  6546     MOVE 'ERPDEF' TO DFHEIV1
  6547     MOVE 0
  6548       TO DFHEIV11
  6549*    MOVE '&2                    $   #00006005' TO DFHEIV0
  6550     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6551     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6552     MOVE X'2020233030303036303035' TO DFHEIV0(25:11)
  6553     CALL 'kxdfhei1' USING DFHEIV0,
  6554           DFHEIV1,
  6555           DFHEIV11,
  6556           DFHEIV99
  6557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6558     .
  6559 0730-EXIT.
  6560     EXIT.
  6561 0740-GET-ERCTBL.
  6562     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  6563     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  6564     MOVE 'A'                    TO CTBL-BEN-TYPE
  6565     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  6566     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  6567     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 115
* SOCK03.cbl
  6568     IF RESP-NORMAL
  6569        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  6570     ELSE
  6571        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  6572        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  6573        MOVE 'A'                    TO CTBL-BEN-TYPE
  6574        MOVE 'AA'                   TO CTBL-BEN-CODE
  6575        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  6576        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  6577        IF RESP-NORMAL
  6578           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  6579        END-IF
  6580     END-IF
  6581     .
  6582 0740-EXIT.
  6583     EXIT.
  6584 0750-READ-ERCTBL.
  6585
  6586* EXEC CICS READ
  6587*         INTO    (COMM-TABLE-RECORD)
  6588*         DATASET ('ERCTBL')
  6589*         RIDFLD  (CTBL-KEY)
  6590*         RESP    (WS-RESPONSE)
  6591*    END-EXEC
  6592     MOVE LENGTH OF
  6593      COMM-TABLE-RECORD
  6594       TO DFHEIV11
  6595     MOVE 'ERCTBL' TO DFHEIV1
  6596*    MOVE '&"IL       E          (  N#00006035' TO DFHEIV0
  6597     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6598     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6599     MOVE X'204E233030303036303335' TO DFHEIV0(25:11)
  6600     CALL 'kxdfhei1' USING DFHEIV0,
  6601           DFHEIV1,
  6602           COMM-TABLE-RECORD,
  6603           DFHEIV11,
  6604           CTBL-KEY,
  6605           DFHEIV99,
  6606           DFHEIV99,
  6607           DFHEIV99
  6608     MOVE EIBRESP  TO WS-RESPONSE
  6609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6610     .
  6611 0750-EXIT.
  6612     EXIT.
  6613 0760-FIND-COMM.
  6614     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  6615        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  6616        OR (C1 > +3)
  6617     END-PERFORM
  6618     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  6619        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  6620        OR (C2 > +3)
  6621     END-PERFORM
  6622     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  6623        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  6624        OR (C3 > +3)
  6625     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 116
* SOCK03.cbl
  6626     IF C1 > +3
  6627        MOVE +1                  TO C1
  6628     END-IF
  6629     IF C2 > +3
  6630        MOVE +1                  TO C2
  6631     END-IF
  6632     IF C3 > +3
  6633        MOVE +1                  TO C3
  6634     END-IF
  6635     IF C1 = +3
  6636        MOVE +18                 TO C0
  6637     ELSE
  6638        IF C1 = +2
  6639           MOVE +9               TO C0
  6640        END-IF
  6641     END-IF
  6642     IF C2 = +3
  6643        ADD +6                   TO C0
  6644     ELSE
  6645        IF C2 = +2
  6646           ADD +3                TO C0
  6647        END-IF
  6648     END-IF
  6649     ADD C3                      TO C0
  6650     MOVE CT-RT (C0)             TO WS-COMM-PCT
  6651     .
  6652 0760-EXIT.
  6653     EXIT.
  6654 9700-DATE-LINK.
  6655
  6656* EXEC CICS LINK
  6657*         PROGRAM  ('ELDATCV')
  6658*         COMMAREA (DATE-CONVERSION-DATA)
  6659*         LENGTH   (DC-COMM-LENGTH)
  6660*    END-EXEC.
  6661     MOVE 'ELDATCV' TO DFHEIV1
  6662*    MOVE '."C                   (   #00006086' TO DFHEIV0
  6663     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6664     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6665     MOVE X'2020233030303036303836' TO DFHEIV0(25:11)
  6666     CALL 'kxdfhei1' USING DFHEIV0,
  6667           DFHEIV1,
  6668           DATE-CONVERSION-DATA,
  6669           DC-COMM-LENGTH,
  6670           DFHEIV99,
  6671           DFHEIV99,
  6672           DFHEIV99,
  6673           DFHEIV99
  6674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6675
  6676 9700-EXIT.
  6677      EXIT.
  6678
  6679 9999-DFHBACK SECTION.
  6680     MOVE '9%                    "   ' TO DFHEIV0
  6681     MOVE 'SOCK03' TO DFHEIV1
  6682     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6683     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 02-Jan-13 11:42 Page 117
* SOCK03.cbl
  6684 9999-DFHEXIT.
  6685     IF DFHEIGDJ EQUAL 0001
  6686         NEXT SENTENCE.
  6687     MOVE '9%                    "   ' TO DFHEIV0
  6688     MOVE 'SOCK03' TO DFHEIV1
  6689     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6690     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       18408     Code:       28370
