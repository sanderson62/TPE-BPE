* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page   1
* ELRFND.cbl
* Options: int("ELRFND.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRFND.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRFND.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRFND.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRFND.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:23:50.
     7*                            VMOD=2.011
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page   2
* ELRFND.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM REFUNDS      *
    28*            *****************************************************
    29
    30
    31******************************************************************
    32*                                                                *
    33*              INPUT FIELDS USED                                 *
    34*                                                                *
    35******************************************************************
    36*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    37*  REFUND DATE      - CP-VALUATION-DT                            *
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM                           *
    39*  LOAN TERM        - CP-LOAN-TERM                               *
    40*  REMAINING TERM   - CP-REMAINING-TERM                          *
    41*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    42*  STATE CODE       - CP-STATE                                   *
    43*  STATE CODE       - CP-STATE-STD-ABBV                          *
    44*  CLASS CODE       - CP-CLASS-CODE                              *
    45*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    46*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    47*  PROCESS TYPE     - CP-PROCESS-TYPE                            *
    48*  BENEFIT KIND     - CP-BENEFIT-TYPE                            *
    49*  A.P.R.           - CP-LOAN-APR                                *
    50*  METHOD           - CP-EARNING-METHOD                          *
    51*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  COMPANY I.D.     - CP-COMPANY-ID                              *
    54*  BENEFIT CODE     - CP-BENEFIT-CD                              *
    55*  INSURED AGE      - CP-ISSUE-AGE                               *
    56******************************************************************
    57 ENVIRONMENT DIVISION.
    58
    59 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page   3
* ELRFND.cbl
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63 77  FILLER   PIC X(32) VALUE '********************************'.
    64 77  FILLER   PIC X(32) VALUE '**  ELRFND  WORKING STORAGE   **'.
    65 77  FILLER   PIC X(32) VALUE '********VMOD=2.011 *************'.
    66 77  WS-UE-CLP                   PIC S9(5)V99 COMP-3 VALUE +0.
    67 77  WS-GFR3                     PIC S9(5)V99 COMP-3 VALUE +0.
    68 77  WS-MONTH                    PIC S999     COMP-3 VALUE +0.
    69
    70 01  WS-WORK-MISC.
    71     12  WS-REMAINING-TERM   PIC S9(4)V9      COMP-3.
    72     12  WS-TEMP-RESULT      PIC S9(7)V9(6)   COMP-3.
    73     12  WS-REMAINING-AMT    PIC S9(7)V9(6)   COMP-3.
    74     12  WS-ORIG-PREM        PIC S9(7)V9(6)   COMP-3.
    75     12  WS-REMAIN-PREM      PIC S9(7)V9(6)   COMP-3.
    76     12  WS-NP-REF-FACTOR    PIC S9(4)V9(11)  COMP-3.
    77     12  WS-SAVE-TERM        PIC S9(3)        COMP-3.
    78     12  WS-SAVE-LOAN-TERM   PIC S9(3)        COMP-3.
    79     12  WS-SAVE-BENEFIT     PIC S9(9)V99     COMP-3.
    80     12  WS-SAVE-EARN-METHOD PIC X.
    81     12  ws-save-ext-days    pic s9(5)        comp-3.
    82     12  CAL-RFND            PIC S9(5)V99     COMP-3.
    83     12  FACTOR-1            PIC S9(4)V9(11)  COMP-3.
    84     12  FACTOR-2            PIC S9(4)V9(11)  COMP-3.
    85     12  FACTOR-3            PIC S9(4)V9(11)  COMP-3.
    86     12  FACTOR-4            PIC S9(4)V9(11)  COMP-3.
    87     12  FACTOR-5            PIC S9(7)        COMP-3.
    88     12  FACTOR-6            PIC S9(7)        COMP-3.
    89     12  RATE-FACTOR-1       PIC S9V99        COMP-3.
    90     12  RATE-FACTOR-2       PIC S999         COMP-3.
    91     12  R78-FACTOR          PIC S9(4)V9(11)  COMP-3.
    92     12  PR-FACTOR           PIC S9(4)V9(11)  COMP-3.
    93     12  RSUM-FACTOR         PIC S9(4)V9(11)  COMP-3.
    94     12  RSUM-REMAINING-TERM PIC S9(3)V99     COMP-3.
    95
    96 01  TEXAS-REG-WORK-AREAS.
    97     12  TEX-FACT-1          PIC S9(7)V9(2)  COMP-3.
    98     12  TEX-FACT-2          PIC S9(3)       COMP-3.
    99     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   100     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   101     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   102     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   103     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   104     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   105     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   106
   107 01  NET-PAY-INTERFACE.
   108     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   109     12  N-P-ORIG            PIC S9(3)       COMP-3.
   110     12  N-P-REM             PIC S9(3)       COMP-3.
   111     12  N-P-OPT             PIC X.
   112     12  N-P-LOAN            PIC S9(3)       COMP-3.
   113     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   114
   115*                        COPY ERCNETWS.
   116*****************************************************************
   117*                                                               *
   118*                                                               *
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page   4
* ELRFND.cbl
   119*                            ERCNETWS                           *
   120*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   121*                            VMOD=2.014                         *
   122*                                                               *
   123*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   124*                                                               *
   125*****************************************************************.
   126*                   C H A N G E   L O G
   127*
   128* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   129*-----------------------------------------------------------------
   130*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   131* EFFECTIVE    NUMBER
   132*-----------------------------------------------------------------
   133* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   134* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   135* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   136* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   137* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   138******************************************************************
   139
   140 01  NET-PAY-WORK-AREA.
   141     12  OPTION-SW               PIC X   VALUE 'X'.
   142        88  NPO-STD         VALUE SPACE.
   143        88  NPO-ALT         VALUE 'A'.
   144        88  NPO-SIMPLE      VALUE 'S'.
   145        88  NPO-2MO         VALUE 'I'.
   146        88  NPO-3MO         VALUE 'J'.
   147        88  NPO-4MO         VALUE 'K'.
   148        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   149        88  NPO-TRUNC-0     VALUE 'T'.
   150        88  NPO-TRUNC-1     VALUE 'U'.
   151        88  NPO-TRUNC-2     VALUE 'V'.
   152        88  NPO-TRUNC-3     VALUE 'W'.
   153        88  NPO-TRUNC-4     VALUE 'X'.
   154        88  NPO-REFUND      VALUE 'R'.
   155        88  NPO-PRUDENTIAL  VALUE 'P'.
   156
   157     12  TYPE-SW             PIC X   VALUE 'N'.
   158        88  NET-STD             VALUE 'N'.
   159        88  NET-SMP             VALUE 'S'.
   160
   161     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   162        88  NP-RATING           VALUE '1'.
   163        88  NP-REFUND           VALUE '2'.
   164        88  NP-REMAIN-AMT       VALUE '3'.
   165
   166     12  COMP-3-WORK-AREA         COMP-3.
   167         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   168         16  V               PIC SV9(13)       VALUE +.0.
   169         16  J               PIC SV9(9)        VALUE +0.
   170         16  K               PIC SV9(9)        VALUE +0.
   171         16  I               PIC SV9(10)       VALUE +.0.
   172         16  D               PIC S9(5)         VALUE +.0.
   173         16  APR100          PIC SV9(9)        VALUE +.0.
   174         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   175         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   176         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page   5
* ELRFND.cbl
   177         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   178         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   179         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   180         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   181         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   182         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   183         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   184         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   185         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   186         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   187         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   188         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   189         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   190         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   191         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   192         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   193         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   194         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   195         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   196         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   197         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   198         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   199         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   200         16  K1              PIC S999          VALUE +1.
   201         16  K12             PIC S999          VALUE +12.
   202         16  K100            PIC S999          VALUE +100.
   203         16  K1000           PIC S9(7)         VALUE +1000.
   204         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   205         16  Y REDEFINES NC-LR
   206                             PIC S99V9(5).
   207         16  TI              PIC S999V9(5)     VALUE +0.
   208         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   209         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   210         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   211         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   212         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   213         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   214         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   215         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   216
   217         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   218         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   219         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   220         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   221         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   222         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   223         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
   224         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   225         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   226         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   227         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   228         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   229         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   230
   231         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
   232
   233         16  ORIGINAL-TERM   PIC S999.
   234         16  M              REDEFINES ORIGINAL-TERM
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page   6
* ELRFND.cbl
   235                             PIC S999.
   236
   237         16  REMAINING-TERM  PIC S999.
   238         16  R              REDEFINES REMAINING-TERM
   239                             PIC S999.
   240
   241         16  LOAN-TERM       PIC S999.
   242         16  N              REDEFINES LOAN-TERM
   243                             PIC S999.
   244
   245         16  EXPIRED-TERM    PIC S999.
   246         16  E              REDEFINES EXPIRED-TERM
   247                             PIC S999.
   248
   249         16  PRUDENTIAL-WORK-AMT
   250                             PIC S9(7)V9(8).
   251         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   252                             PIC S9(7)V9(8).
   253
   254         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   255         16  VX              PIC S9V9(13)      VALUE +0.0.
   256         16  SV              PIC S9V9(13)      VALUE +0.0.
   257         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   258         16  SX              PIC S9V9(13)      VALUE +0.0.
   259         16  SE              PIC S9V9(10)      VALUE +0.0.
   260         16  N2              PIC S9(7)         VALUE +0.
   261         16  N3              PIC S9(7)         VALUE +0.
   262         16  K-I             PIC S9V9(8)       VALUE +0.0.
   263
   264     12  BINARY-WORK-AREA        COMP.
   265         16  X1              PIC S999        VALUE +0.
   266         16  X2              PIC S999        VALUE +0.
   267         16  MAX-X           PIC S9(5)       VALUE +0.
   268         16  B1              PIC S9(5)       VALUE +1.
   269         16  LINDX           PIC S999        VALUE ZEROS.
   270         16  AHNDX           PIC S999        VALUE ZEROS.
   271
   272     12  CSO-RATE-WORK-AREAS.
   273         16  C-PMTS-PER-YEAR     PIC S999 COMP-3 VALUE ZEROS.
   274         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   275         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   276     12  WS-WORK-MISC.
   277         16  ws-extra-pmts       pic s999         comp-3.
   278         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   279         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   280*        16  WS-AGE              PIC 99           VALUE ZEROS.
   281         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   282         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   283         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   284         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   285         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   286         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   287         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   288         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   289         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   290         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
   291         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   292         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page   7
* ELRFND.cbl
   293******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page   8
* ELRFND.cbl
   295*                        COPY ELCDATE.
   296******************************************************************
   297*                                                                *
   298*                                                                *
   299*                            ELCDATE.                            *
   300*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   301*                            VMOD=2.003
   302*                                                                *
   303*                                                                *
   304*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   305*                 LENGTH = 200                                   *
   306******************************************************************
   307
   308 01  DATE-CONVERSION-DATA.
   309     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   310     12  DC-OPTION-CODE                PIC X.
   311         88  BIN-TO-GREG                VALUE ' '.
   312         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   313         88  EDIT-GREG-TO-BIN           VALUE '2'.
   314         88  YMD-GREG-TO-BIN            VALUE '3'.
   315         88  MDY-GREG-TO-BIN            VALUE '4'.
   316         88  JULIAN-TO-BIN              VALUE '5'.
   317         88  BIN-PLUS-ELAPSED           VALUE '6'.
   318         88  FIND-CENTURY               VALUE '7'.
   319         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   320         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   321         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   322         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   323         88  JULIAN-TO-BIN-3            VALUE 'C'.
   324         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   325         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   326         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   327         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   328         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   329         88  CHECK-LEAP-YEAR            VALUE 'H'.
   330         88  BIN-3-TO-GREG              VALUE 'I'.
   331         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   332         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   333         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   334         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   335         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   336         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   337         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   338         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   339         88  THREE-CHARACTER-BIN
   340                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   341         88  GREGORIAN-TO-BIN
   342                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   343         88  BIN-TO-GREGORIAN
   344                  VALUES ' ' '1' 'I' '8' 'G'.
   345         88  JULIAN-TO-BINARY
   346                  VALUES '5' 'C' 'E' 'F'.
   347     12  DC-ERROR-CODE                 PIC X.
   348         88  NO-CONVERSION-ERROR        VALUE ' '.
   349         88  DATE-CONVERSION-ERROR
   350                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   351         88  DATE-IS-ZERO               VALUE '1'.
   352         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page   9
* ELRFND.cbl
   353         88  DATE-IS-INVALID            VALUE '3'.
   354         88  DATE1-GREATER-DATE2        VALUE '4'.
   355         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   356         88  DATE-INVALID-OPTION        VALUE '9'.
   357         88  INVALID-CENTURY            VALUE 'A'.
   358         88  ONLY-CENTURY               VALUE 'B'.
   359         88  ONLY-LEAP-YEAR             VALUE 'C'.
   360         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   361     12  DC-END-OF-MONTH               PIC X.
   362         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   363     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   364         88  USE-NORMAL-PROCESS         VALUE ' '.
   365         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   366         88  ADJUST-UP-100-YRS          VALUE '2'.
   367     12  FILLER                        PIC X.
   368     12  DC-CONVERSION-DATES.
   369         16  DC-BIN-DATE-1             PIC XX.
   370         16  DC-BIN-DATE-2             PIC XX.
   371         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   372         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   373                       DC-GREG-DATE-1-EDIT.
   374             20  DC-EDIT1-MONTH        PIC 99.
   375             20  SLASH1-1              PIC X.
   376             20  DC-EDIT1-DAY          PIC 99.
   377             20  SLASH1-2              PIC X.
   378             20  DC-EDIT1-YEAR         PIC 99.
   379         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   380         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   381                     DC-GREG-DATE-2-EDIT.
   382             20  DC-EDIT2-MONTH        PIC 99.
   383             20  SLASH2-1              PIC X.
   384             20  DC-EDIT2-DAY          PIC 99.
   385             20  SLASH2-2              PIC X.
   386             20  DC-EDIT2-YEAR         PIC 99.
   387         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   388         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   389                     DC-GREG-DATE-1-YMD.
   390             20  DC-YMD-YEAR           PIC 99.
   391             20  DC-YMD-MONTH          PIC 99.
   392             20  DC-YMD-DAY            PIC 99.
   393         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   394         16  DC-GREG-DATE-1-MDY-R REDEFINES
   395                      DC-GREG-DATE-1-MDY.
   396             20  DC-MDY-MONTH          PIC 99.
   397             20  DC-MDY-DAY            PIC 99.
   398             20  DC-MDY-YEAR           PIC 99.
   399         16  DC-GREG-DATE-1-ALPHA.
   400             20  DC-ALPHA-MONTH        PIC X(10).
   401             20  DC-ALPHA-DAY          PIC 99.
   402             20  FILLER                PIC XX.
   403             20  DC-ALPHA-CENTURY.
   404                 24 DC-ALPHA-CEN-N     PIC 99.
   405             20  DC-ALPHA-YEAR         PIC 99.
   406         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   407         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   408         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   409         16  DC-JULIAN-DATE            PIC 9(05).
   410         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  10
* ELRFND.cbl
   411                                       PIC 9(05).
   412         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   413             20  DC-JULIAN-YEAR        PIC 99.
   414             20  DC-JULIAN-DAYS        PIC 999.
   415         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   416         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   417         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   418     12  DATE-CONVERSION-VARIBLES.
   419         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   420         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   421             20  FILLER                PIC 9(3).
   422             20  HOLD-CEN-1-CCYY.
   423                 24  HOLD-CEN-1-CC     PIC 99.
   424                 24  HOLD-CEN-1-YY     PIC 99.
   425             20  HOLD-CEN-1-MO         PIC 99.
   426             20  HOLD-CEN-1-DA         PIC 99.
   427         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   428             20  HOLD-CEN-1-R-MO       PIC 99.
   429             20  HOLD-CEN-1-R-DA       PIC 99.
   430             20  HOLD-CEN-1-R-CCYY.
   431                 24  HOLD-CEN-1-R-CC   PIC 99.
   432                 24  HOLD-CEN-1-R-YY   PIC 99.
   433             20  FILLER                PIC 9(3).
   434         16  HOLD-CENTURY-1-X.
   435             20  FILLER                PIC X(3)  VALUE SPACES.
   436             20  HOLD-CEN-1-X-CCYY.
   437                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   438                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   439             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   440             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   441         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   442             20  HOLD-CEN-1-R-X-MO     PIC XX.
   443             20  HOLD-CEN-1-R-X-DA     PIC XX.
   444             20  HOLD-CEN-1-R-X-CCYY.
   445                 24  HOLD-CEN-1-R-X-CC PIC XX.
   446                 24  HOLD-CEN-1-R-X-YY PIC XX.
   447             20  FILLER                PIC XXX.
   448         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   449         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   450         16  DC-JULIAN-DATE-1          PIC 9(07).
   451         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   452             20  DC-JULIAN-1-CCYY.
   453                 24  DC-JULIAN-1-CC    PIC 99.
   454                 24  DC-JULIAN-1-YR    PIC 99.
   455             20  DC-JULIAN-DA-1        PIC 999.
   456         16  DC-JULIAN-DATE-2          PIC 9(07).
   457         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   458             20  DC-JULIAN-2-CCYY.
   459                 24  DC-JULIAN-2-CC    PIC 99.
   460                 24  DC-JULIAN-2-YR    PIC 99.
   461             20  DC-JULIAN-DA-2        PIC 999.
   462         16  DC-GREG-DATE-A-EDIT.
   463             20  DC-EDITA-MONTH        PIC 99.
   464             20  SLASHA-1              PIC X VALUE '/'.
   465             20  DC-EDITA-DAY          PIC 99.
   466             20  SLASHA-2              PIC X VALUE '/'.
   467             20  DC-EDITA-CCYY.
   468                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  11
* ELRFND.cbl
   469                 24  DC-EDITA-YEAR     PIC 99.
   470         16  DC-GREG-DATE-B-EDIT.
   471             20  DC-EDITB-MONTH        PIC 99.
   472             20  SLASHB-1              PIC X VALUE '/'.
   473             20  DC-EDITB-DAY          PIC 99.
   474             20  SLASHB-2              PIC X VALUE '/'.
   475             20  DC-EDITB-CCYY.
   476                 24  DC-EDITB-CENT     PIC 99.
   477                 24  DC-EDITB-YEAR     PIC 99.
   478         16  DC-GREG-DATE-CYMD         PIC 9(08).
   479         16  DC-GREG-DATE-CYMD-R REDEFINES
   480                              DC-GREG-DATE-CYMD.
   481             20  DC-CYMD-CEN           PIC 99.
   482             20  DC-CYMD-YEAR          PIC 99.
   483             20  DC-CYMD-MONTH         PIC 99.
   484             20  DC-CYMD-DAY           PIC 99.
   485         16  DC-GREG-DATE-MDCY         PIC 9(08).
   486         16  DC-GREG-DATE-MDCY-R REDEFINES
   487                              DC-GREG-DATE-MDCY.
   488             20  DC-MDCY-MONTH         PIC 99.
   489             20  DC-MDCY-DAY           PIC 99.
   490             20  DC-MDCY-CEN           PIC 99.
   491             20  DC-MDCY-YEAR          PIC 99.
   492    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   493        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   494    12  DC-EL310-DATE                  PIC X(21).
   495    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  12
* ELRFND.cbl
   497*                        COPY ELCCALC.
   498******************************************************************
   499*                                                                *
   500*                           ELCCALC.                            *
   501*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   502*                            VMOD=2.025                          *
   503*                                                                *
   504*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   505*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   506*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   507*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   508*                                                                *
   509*  PASSED TO ELRTRM                                              *
   510*  -----------------                                             *
   511*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   512*  ORIGINAL TERM                                                 *
   513*  BEGINNING DATE                                                *
   514*  ENDING DATE                                                   *
   515*  COMPANY I.D.                                                  *
   516*  ACCOUNT MASTER USER FIELD                                     *
   517*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   518*  FREE LOOK DAYS                                                *
   519*                                                                *
   520*  RETURNED FROM ELRTRM                                          *
   521*  ---------------------                                         *
   522*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   523*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   524*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   525*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   526*----------------------------------------------------------------*
   527*  PASSED TO ELRAMT                                              *
   528*  ----------------                                              *
   529*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   530*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   531*  ORIGINAL AMOUNT                                               *
   532*  ALTERNATE BENEFIT (BALLON)                                    *
   533*  A.P.R. - NET PAY ONLY                                         *
   534*  METHOD
   535*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   536*  COMPANY I.D.                                                  *
   537*  BENEFIT TYPE                                                  *
   538*                                                                *
   539*  RETURNED FROM ELRAMT                                          *
   540*  --------------------                                          *
   541*  REMAINING AMOUNT 1 - CURRENT                                  *
   542*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   543*  REMAINING AMOUNT FACTOR
   544*----------------------------------------------------------------*
   545*  PASSED TO ELRESV                                              *
   546*  -----------------                                             *
   547*  CERTIFICATE EFFECTIVE DATE                                    *
   548*  VALUATION DATE                                                *
   549*  PAID THRU DATE                                                *
   550*  BENEFIT                                                       *
   551*  INCURRED DATE                                                 *
   552*  REPORTED DATE                                                 *
   553*  ISSUE AGE                                                     *
   554*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  13
* ELRFND.cbl
   555*  CDT PERCENT                                                   *
   556*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   557* *CLAIM TYPE (LIFE, A/H)                                        *
   558* *REMAINING BENEFIT (FROM ELRAMT)                               *
   559* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   560*                                                                *
   561*  RETURNED FROM ELRESV                                          *
   562*  --------------------                                          *
   563*  CDT TABLE USED                                                *
   564*  CDT FACTOR USED                                               *
   565*  PAY TO CURRENT RESERVE                                        *
   566*  I.B.N.R. - A/H ONLY                                           *
   567*  FUTURE (ACCRUED) AH ONLY                                      *
   568*----------------------------------------------------------------*
   569*  PASSED TO ELRATE                                              *
   570*  ----------------                                              *
   571*  CERT ISSUE DATE                                               *
   572*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   573*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   574*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   575*  STATE CODE (CLIENT DEFINED)                                   *
   576*  STATE CODE (STANDARD P.O. ABBRV)                              *
   577*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   578*  DEVIATION CODE                                                *
   579*  ISSUE AGE                                                     *
   580*  ORIGINAL BENEFIT AMOUNT                                       *
   581*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   582*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   583*  BENEFIT KIND (LIFE OR A/H)                                    *
   584*  A.P.R.                                                        *
   585*  METHOD
   586*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   587*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   588*  COMPANY I.D. (3 CHARACTER)                                    *
   589*  BENEFIT CODE                                                  *
   590*  BENEFIT OVERRIDE CODE                                         *
   591*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   592*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   593*  JOINT INDICATOR (CSL ONLY)                                    *
   594*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   595*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   596*                                                                *
   597*  RETURNED FROM ELRATE                                          *
   598*  --------------------                                          *
   599*  CALCULATED PREMIUM                                            *
   600*  PREMIUM RATE                                                  *
   601*  MORTALITY CODE                                                *
   602*  MAX ATTAINED AGE                                              *
   603*  MAX AGE                                                       *
   604*  MAX TERM                                                      *
   605*  MAX MONTHLY BENEFIT                                           *
   606*  MAX TOTAL BENIFIT                                             *
   607*  COMPOSITE RATE (OPEN-END ONLY)                                *
   608*----------------------------------------------------------------*
   609*  PASSED TO ELRFND                                              *
   610*  ----------------                                              *
   611*  CERT ISSUE DATE                                               *
   612*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  14
* ELRFND.cbl
   613*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   614*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   615*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   616*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   617*  STATE CODE (CLIENT DEFINED)                                   *
   618*  STATE CODE (STANDARD P.O. ABBRV)                              *
   619*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   620*  DEVIATION CODE                                                *
   621*  ISSUE AGE                                                     *
   622*  ORIGINAL BENEFIT AMOUNT                                       *
   623*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   624*  PROCESS TYPE (CANCEL)                                         *
   625*  BENEFIT KIND (LIFE OR A/H)                                    *
   626*  A.P.R.                                                        *
   627*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   628*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   629*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   630*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   631*  COMPANY I.D. (3 CHARACTER)                                    *
   632*  BENEFIT CODE                                                  *
   633*  BENEFIT OVERRIDE CODE                                         *
   634*                                                                *
   635*  RETURNED FROM ELRFND                                          *
   636*  --------------------                                          *
   637*  CALCULATED REFUND                                             *
   638*----------------------------------------------------------------*
   639*  PASSED TO ELEARN                                              *
   640*  ----------------                                              *
   641*  CERT ISSUE DATE                                               *
   642*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   643*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   644*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   645*  STATE CODE (CLIENT DEFINED)                                   *
   646*  STATE CODE (STANDARD P.O. ABBRV)                              *
   647*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   648*  DEVIATION CODE                                                *
   649*  ISSUE AGE                                                     *
   650*  ORIGINAL BENEFIT AMOUNT                                       *
   651*  BENEFIT KIND (LIFE OR A/H)                                    *
   652*  A.P.R.                                                        *
   653*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   654*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   655*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   656*  COMPANY I.D. (3 CHARACTER)                                    *
   657*  BENEFIT CODE                                                  *
   658*  BENEFIT OVERRIDE CODE                                         *
   659*                                                                *
   660*  RETURNED FROM ELEARN                                          *
   661*  --------------------                                          *
   662*  INDICATED  EARNINGS                                           *
   663*----------------------------------------------------------------*
   664*                 LENGTH = 450                                   *
   665*                                                                *
   666******************************************************************
   667******************************************************************
   668*                   C H A N G E   L O G
   669*
   670* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  15
* ELRFND.cbl
   671*-----------------------------------------------------------------
   672*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   673* EFFECTIVE    NUMBER
   674*-----------------------------------------------------------------
   675* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   676* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   677* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   678* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   679* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   680* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   681* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   682* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   683* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   684******************************************************************
   685
   686 01  CALCULATION-PASS-AREA.
   687     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   688                                     COMP.
   689
   690     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   691       88  NO-CP-ERROR                             VALUE ZERO.
   692       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   693                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   694       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   695       88  CP-ERROR-IN-DATES                       VALUE '2'.
   696       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   697       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   698       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   699       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   700       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   701       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   702       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   703       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   704       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   705       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   706       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   707       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   708       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   709       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   710       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   711
   712     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   713       88  NO-CP-ERROR-2                           VALUE ZERO.
   714***********************  INPUT AREAS ****************************
   715
   716     12  CP-CALCULATION-AREA.
   717         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   718         16  CP-CERT-EFF-DT        PIC XX.
   719         16  CP-VALUATION-DT       PIC XX.
   720         16  CP-PAID-THRU-DT       PIC XX.
   721         16  CP-BENEFIT-TYPE       PIC X.
   722           88  CP-AH                               VALUE 'A' 'D'
   723                                                   'I' 'U'.
   724           88  CP-REDUCING-LIFE                    VALUE 'R'.
   725           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   726         16  CP-INCURRED-DT        PIC XX.
   727         16  CP-REPORTED-DT        PIC XX.
   728         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  16
* ELRFND.cbl
   729         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   730         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   731                                     COMP-3.
   732         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   733                                     COMP-3.
   734         16  CP-CDT-METHOD         PIC X.
   735           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   736           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   737           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   738         16  CP-CLAIM-TYPE         PIC X.
   739           88  CP-AH-CLAIM                         VALUE 'A'.
   740           88  CP-LIFE-CLAIM                       VALUE 'L'.
   741         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   742                                     COMP-3.
   743         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   744                                     COMP-3.
   745         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   746                                     COMP-3.
   747         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   748                                     COMP-3.
   749         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   750                                     COMP-3.
   751         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   752                                     COMP-3.
   753         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   754                                     COMP-3.
   755         16  CP-REM-TERM-METHOD    PIC X.
   756           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   757           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   758           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   759           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   760           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   761           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   762           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   763         16  CP-EARNING-METHOD     PIC X.
   764           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   765           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   766           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   767           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   768           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   769           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   770           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   771           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   772           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   773           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   774           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   775           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   776           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   777           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   778         16  CP-PROCESS-TYPE       PIC X.
   779           88  CP-CLAIM                            VALUE '1'.
   780           88  CP-CANCEL                           VALUE '2'.
   781           88  CP-ISSUE                            VALUE '3'.
   782         16  CP-SPECIAL-CALC-CD    PIC X.
   783           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   784           88  CP-1-MTH-INTEREST               VALUE ' '.
   785           88  CP-0-MTH-INTEREST               VALUE 'A'.
   786           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  17
* ELRFND.cbl
   787           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   788           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   789           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   790           88  CP-FARM-PLAN                    VALUE 'F'.
   791           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   792           88  CP-2-MTH-INTEREST               VALUE 'I'.
   793           88  CP-3-MTH-INTEREST               VALUE 'J'.
   794           88  CP-4-MTH-INTEREST               VALUE 'K'.
   795           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   796           88  CP-MORTGAGE-REC                 VALUE 'M'.
   797           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   798           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   799           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   800           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   801                                                     'W' 'X'.
   802           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   803           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   804           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   805           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   806           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   807           88  CP-SUMMARY-REC                  VALUE 'Z'.
   808           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   809           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   810           88  CP-AD-D-BENEFIT                 VALUE '4'.
   811           88  CP-CSL-METH-1                   VALUE '5'.
   812           88  CP-CSL-METH-2                   VALUE '6'.
   813           88  CP-CSL-METH-3                   VALUE '7'.
   814           88  CP-CSL-METH-4                   VALUE '8'.
   815
   816         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   817                                     COMP-3.
   818         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   819         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   820         16  CP-STATE              PIC XX          VALUE SPACE.
   821         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   822         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   823           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   824               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   825         16  CP-R78-OPTION         PIC X.
   826           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   827           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   828
   829         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   830         16  CP-IBNR-RESERVE-SW    PIC X.
   831         16  CP-CLAIM-STATUS       PIC X.
   832         16  CP-RATE-FILE          PIC X.
   833         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   834                                     COMP-3.
   835
   836         16  CP-LIFE-OVERRIDE-CODE PIC X.
   837         16  CP-AH-OVERRIDE-CODE   PIC X.
   838
   839         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   840                                     COMP-3.
   841         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   842                                   PIC S9(5)V99 COMP-3.
   843         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   844                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  18
* ELRFND.cbl
   845         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   846                                     COMP-3.
   847         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   848                                     COMP-3.
   849         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   850                                  PIC S9(7)V99 COMP-3.
   851
   852         16  CP-PAID-FROM-DATE     PIC X(02).
   853         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   854         16  CP-EXT-DAYS-CALC      PIC X.
   855           88  CP-EXT-NO-CHG                   VALUE ' '.
   856           88  CP-EXT-CHG-LF                   VALUE '1'.
   857           88  CP-EXT-CHG-AH                   VALUE '2'.
   858           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   859         16  CP-DOMICILE-STATE     PIC XX.
   860         16  CP-CARRIER            PIC X.
   861         16  CP-REIN-FLAG          PIC X.
   862         16  CP-REM-TRM-CALC-OPTION PIC X.
   863           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   864                      '2' '3' '4' '5'.
   865           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   866           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   867           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   868           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   869           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   870           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   871           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   872           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   873         16  CP-SIG-SWITCH         PIC X.
   874         16  CP-RATING-METHOD      PIC X.
   875           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   876           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   877           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   878           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   879           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   880           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   881           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   882           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   883           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   884         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   885                                     COMP-3.
   886         16  CP-BEN-CATEGORY       PIC X.
   887         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   888         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   889                                   PIC S99V9(5) COMP-3.
   890         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   891         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   892                                   PIC S99V9(5) COMP-3.
   893         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   894         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   895         16  CP-EXPIRE-DT          PIC XX.
   896         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   897         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   898         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   899         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   900         16  CP-DDF-SPEC-CALC      PIC X.
   901             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   902             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  19
* ELRFND.cbl
   903         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   904         16  CP-CANCEL-REASON      PIC X.
   905         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   906         16  CP-PMT-MODE           PIC X.
   907         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   908         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   909         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   910         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   911         16  FILLER                PIC X.
   912
   913***************    OUTPUT FROM ELRESV   ************************
   914
   915         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   916
   917         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   918                                     COMP-3.
   919         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   920                                     COMP-3.
   921         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   922                                     COMP-3.
   923         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   924                                     COMP-3.
   925         16  FILLER                PIC X(09).
   926***************    OUTPUT FROM ELRTRM   *************************
   927
   928         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   929                                     COMP-3.
   930         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   931                                     COMP-3.
   932         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   933                                     COMP-3.
   934         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   935                                     COMP-3.
   936         16  FILLER                PIC X(12).
   937
   938***************    OUTPUT FROM ELRAMT   *************************
   939
   940         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   941                                     COMP-3.
   942         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   943                                     COMP-3.
   944         16  FILLER                PIC X(12).
   945
   946***************    OUTPUT FROM ELRATE   *************************
   947
   948         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   949                                     COMP-3.
   950         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   951                                     COMP-3.
   952         16  CP-MORTALITY-CODE     PIC X(4).
   953         16  CP-RATE-EDIT-FLAG     PIC X.
   954             88  CP-RATES-NEED-APR                  VALUE '1'.
   955         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   956                                     COMP-3.
   957         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   958         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   959         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   960                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  20
* ELRFND.cbl
   961         16  FILLER                PIC X(07).
   962
   963***************    OUTPUT FROM ELRFND   *************************
   964
   965         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   966                                     COMP-3.
   967         16  CP-REFUND-TYPE-USED   PIC X.
   968           88  CP-R-AS-R78                         VALUE '1'.
   969           88  CP-R-AS-PRORATA                     VALUE '2'.
   970           88  CP-R-AS-CALIF                       VALUE '3'.
   971           88  CP-R-AS-TEXAS                       VALUE '4'.
   972           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   973           88  CP-R-AS-NET-PAY                     VALUE '5'.
   974           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   975           88  CP-R-AS-MEAN                        VALUE '8'.
   976           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   977           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   978           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   979           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   980           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   981           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   982         16  FILLER                PIC X(12).
   983
   984***************    OUTPUT FROM ELEARN   *************************
   985
   986         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   987                                     COMP-3.
   988         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   989                                     COMP-3.
   990         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   991                                     COMP-3.
   992         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   993                                     COMP-3.
   994         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   995                                     COMP-3.
   996         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   997                                     COMP-3.
   998         16  CP-EARNING-TYPE-USED  PIC X.
   999           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1000           88  CP-E-AS-R78                         VALUE '1'.
  1001           88  CP-E-AS-PRORATA                     VALUE '2'.
  1002           88  CP-E-AS-TEXAS                       VALUE '4'.
  1003           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1004           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1005           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1006           88  CP-E-AS-MEAN                        VALUE '8'.
  1007           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1008         16  FILLER                PIC X(12).
  1009
  1010***************    OUTPUT FROM ELPMNT   *************************
  1011
  1012         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1013                                     COMP-3.
  1014         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1015                                     COMP-3.
  1016         16  FILLER                PIC X(12).
  1017
  1018***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  21
* ELRFND.cbl
  1019         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1020                                     COMP-3.
  1021         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1022                                     COMP-3.
  1023         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1024                                     COMP-3.
  1025         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1026                                     COMP-3.
  1027         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1028                                     COMP-3.
  1029         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1030                                     COMP-3.
  1031         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1032             88  OPEN-RATE-FILE                   VALUE 'O'.
  1033             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1034             88  IO-ERROR                         VALUE 'E'.
  1035
  1036         16  CP-FIRST-PAY-DATE     PIC XX.
  1037
  1038         16  CP-JOINT-INDICATOR    PIC X.
  1039
  1040         16  CP-RESERVE-REMAINING-TERM
  1041                                   PIC S9(4)V9    VALUE ZERO
  1042                                     COMP-3.
  1043
  1044         16  CP-INSURED-BIRTH-DT   PIC XX.
  1045
  1046         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1047                                     COMP-3.
  1048
  1049         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1050                                     COMP-3.
  1051
  1052         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1053                                     COMP-3.
  1054
  1055         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1056                                     COMP-3.
  1057
  1058         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1059                                     COMP-3.
  1060
  1061         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1062                                     COMP-3.
  1063
  1064         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1065                                     COMP-3.
  1066
  1067         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1068             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1069
  1070         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1071                                     COMP-3.
  1072         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1073                                     COMP-3.
  1074         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1075         16  FILLER                PIC X(15).
  1076******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  22
* ELRFND.cbl
  1077
  1078
  1079****************************************************************
  1080*
  1081* Copyright (c) 2007 by Clerity Solutions, Inc.
  1082* All rights reserved.
  1083*
  1084****************************************************************
  1085 01  DFHEIV.
  1086   02  DFHEIV0               PIC X(35).
  1087   02  DFHEIV1               PIC X(08).
  1088   02  DFHEIV2               PIC X(08).
  1089   02  DFHEIV3               PIC X(08).
  1090   02  DFHEIV4               PIC X(06).
  1091   02  DFHEIV5               PIC X(04).
  1092   02  DFHEIV6               PIC X(04).
  1093   02  DFHEIV7               PIC X(02).
  1094   02  DFHEIV8               PIC X(02).
  1095   02  DFHEIV9               PIC X(01).
  1096   02  DFHEIV10              PIC S9(7) COMP-3.
  1097   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1098   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1099   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1100   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1101   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1102   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1103   02  DFHEIV17              PIC X(04).
  1104   02  DFHEIV18              PIC X(04).
  1105   02  DFHEIV19              PIC X(04).
  1106   02  DFHEIV20              USAGE IS POINTER.
  1107   02  DFHEIV21              USAGE IS POINTER.
  1108   02  DFHEIV22              USAGE IS POINTER.
  1109   02  DFHEIV23              USAGE IS POINTER.
  1110   02  DFHEIV24              USAGE IS POINTER.
  1111   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1112   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1113   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1114   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1115   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1116   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1117   02  FILLER                PIC X(02).
  1118   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1119   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1120   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1121   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1122   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1123 LINKAGE  SECTION.
  1124*****************************************************************
  1125*                                                               *
  1126* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1127* All rights reserved.                                          *
  1128*                                                               *
  1129*****************************************************************
  1130 01  dfheiblk.
  1131     02  eibtime          pic s9(7) comp-3.
  1132     02  eibdate          pic s9(7) comp-3.
  1133     02  eibtrnid         pic x(4).
  1134     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  23
* ELRFND.cbl
  1135     02  eibtrmid         pic x(4).
  1136     02  dfheigdi         pic s9(4) comp.
  1137     02  eibcposn         pic s9(4) comp.
  1138     02  eibcalen         pic s9(4) comp.
  1139     02  eibaid           pic x(1).
  1140     02  eibfiller1       pic x(1).
  1141     02  eibfn            pic x(2).
  1142     02  eibfiller2       pic x(2).
  1143     02  eibrcode         pic x(6).
  1144     02  eibfiller3       pic x(2).
  1145     02  eibds            pic x(8).
  1146     02  eibreqid         pic x(8).
  1147     02  eibrsrce         pic x(8).
  1148     02  eibsync          pic x(1).
  1149     02  eibfree          pic x(1).
  1150     02  eibrecv          pic x(1).
  1151     02  eibsend          pic x(1).
  1152     02  eibatt           pic x(1).
  1153     02  eibeoc           pic x(1).
  1154     02  eibfmh           pic x(1).
  1155     02  eibcompl         pic x(1).
  1156     02  eibsig           pic x(1).
  1157     02  eibconf          pic x(1).
  1158     02  eiberr           pic x(1).
  1159     02  eibrldbk         pic x(1).
  1160     02  eiberrcd         pic x(4).
  1161     02  eibsynrb         pic x(1).
  1162     02  eibnodat         pic x(1).
  1163     02  eibfiller5       pic x(2).
  1164     02  eibresp          pic 9(09) comp.
  1165     02  eibresp2         pic 9(09) comp.
  1166     02  dfheigdj         pic s9(4) comp.
  1167     02  dfheigdk         pic s9(4) comp.
  1168 01  DFHCOMMAREA                PIC X(450).
  1169
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  24
* ELRFND.cbl
  1171 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1172 0000-DFHEXIT SECTION.
  1173     MOVE '9#                    $   ' TO DFHEIV0.
  1174     MOVE 'ELRFND' TO DFHEIV1.
  1175     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1176     MOVE DFHCOMMAREA    TO  CALCULATION-PASS-AREA.
  1177
  1178 000-START-REFUND-CALC.
  1179*                      COPY ELCRFNDP.
  1180****************************************************************
  1181*                                                              *
  1182*                            ELCRFNDP.                         *
  1183*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1184*                            VMOD=2.028                        *
  1185*                                                              *
  1186****************************************************************.
  1187*                   C H A N G E   L O G
  1188*
  1189* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1190*-----------------------------------------------------------------
  1191*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1192* EFFECTIVE    NUMBER
  1193*-----------------------------------------------------------------
  1194* 042203                   PEMA ADD SPECIAL IN CALC FOR CID
  1195* 033104    2003080800002  PEMA ADD GAP NON REFUNDABLE OPTION
  1196* 042904    2003080800002  PEMA ADD ACTUARIAL EARNING METHOD
  1197* 110609  CR2009092300002  PEMA CHANGE MN REFUNDS
  1198* 000000  CR2008042200001  PEMA ADD 0 APR PROCESSING
  1199* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  1200* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1201* 032612  CR2011110200001  PEMA AHL CHANGES
  1202* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  1203******************************************************************
  1204
  1205     MOVE ZERO                   TO  CP-RETURN-CODE
  1206                                     CP-CALC-REFUND.
  1207     MOVE SPACE                  TO  CP-REFUND-TYPE-USED.
  1208
  1209 0001-GET-CANCEL-TYPE.
  1210     IF CP-CERT-EFF-DT = CP-VALUATION-DT
  1211        MOVE CP-ORIGINAL-PREMIUM TO CP-CALC-REFUND
  1212        GO TO 1999-CALC-REF-AMT-X.
  1213
  1214     IF CP-CANCEL-REASON = 'R'
  1215        IF CP-CALC-CLP
  1216           MOVE CP-ORIGINAL-PREMIUM
  1217                                 TO CP-CALC-REFUND
  1218        ELSE
  1219           COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM -
  1220              CP-DDF-ADMIN-FEES
  1221        END-IF
  1222        MOVE 'R'                 TO CP-REFUND-TYPE-USED
  1223        GO TO 1999-CALC-REF-AMT-X
  1224     END-IF
  1225     IF CP-REMAINING-TERM = ZERO   OR
  1226        CP-REMAINING-TERM NEGATIVE
  1227          MOVE ZERO TO CP-CALC-REFUND
  1228          GO TO 1999-CALC-REF-AMT-X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  25
* ELRFND.cbl
  1229
  1230     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1231     MOVE SPACE              TO DC-OPTION-CODE.
  1232     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1233
  1234     IF DATE-CONVERSION-ERROR
  1235         MOVE '2' TO CP-RETURN-CODE
  1236         GO TO 1999-CALC-REF-AMT-X.
  1237
  1238     IF CP-AH
  1239        GO TO 1030-GET-AH-REFUND.
  1240
  1241********************    LIFE REFUNDS    **************************
  1242
  1243     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1244         MOVE +0                TO CP-TERM-OR-EXT-DAYS.
  1245
  1246     IF CP-LOAN-TERM NOT NUMERIC
  1247         MOVE +0                TO CP-LOAN-TERM.
  1248
  1249     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1250
  1251     COMPUTE R78-FACTOR =
  1252            (CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1253              (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1254************************************************************
  1255***       ADDED IF CONDITION FOR TESTING PURPOSES.       ***
  1256***---------------------------------------------------------
  1257     IF CP-TRUNCATED-LIFE
  1258        MOVE  CP-LOAN-TERM         TO  WS-RATE-TERM
  1259     ELSE
  1260        MOVE  CP-ORIGINAL-TERM     TO  WS-RATE-TERM.
  1261***
  1262************************************************************
  1263**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1264**** FOLLOWING.
  1265****       FOR NC. LIFE..
  1266****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1267****  TRUNCATED NET COVERAGE --- TERM > 60 USE RULE OF ANTIC.
  1268****                             TERM <= 60 USE SUM OF DIGITS.
  1269****  DECREASING COVERAGE    --- EFF DATE > 093081 AND
  1270****                             TERM > 60 USE RULE OF ANTIC
  1271****                             OTHERWISE USE RULE OF 78.
  1272****
  1273****
  1274
  1275     IF (CP-COMPANY-ID = 'NCL') AND
  1276        (CP-STATE-STD-ABBRV = 'NC')
  1277        IF CP-LEVEL-LIFE
  1278           GO TO 1023-REF-PR
  1279        ELSE
  1280        IF CP-EARN-AS-NET-PAY AND
  1281           CP-TRUNCATED-LIFE
  1282           IF CP-ORIGINAL-TERM GREATER THAN 60
  1283              GO TO 1021-ANTICIPATION-REF
  1284           ELSE
  1285              GO TO 1026-REF-R78
  1286        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  26
* ELRFND.cbl
  1287        IF CP-REDUCING-LIFE
  1288           IF (DC-GREG-DATE-CYMD  GREATER 19810930 AND
  1289              CP-ORIGINAL-TERM GREATER THAN 60)
  1290              GO TO 1021-ANTICIPATION-REF
  1291           ELSE
  1292              GO TO 1075-SUM-OF-DIGITS.
  1293
  1294****
  1295**** THE FOLLOWING IF STATEMENT FOR CID ONLY SHOULD DO THE
  1296**** FOLLOWING.
  1297****       FOR OH. LIFE..
  1298****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1299****  NET/NET TRUNCATED      --- TERM > 60 USE RULE OF ANTIC.
  1300****  GROSS DECREASING       --- RULE OF 78
  1301****
  1302****
  1303
  1304     IF (CP-COMPANY-ID = 'CID') AND
  1305        (CP-STATE-STD-ABBRV = 'OH') AND
  1306        (CP-CLASS-CODE NOT = 'L ')
  1307        IF CP-LEVEL-LIFE
  1308           GO TO 1023-REF-PR
  1309        ELSE
  1310           IF (CP-ORIGINAL-TERM > 60) OR
  1311              (CP-EARN-AS-NET-PAY)
  1312              GO TO 1028-NET-PAY-REFUND
  1313           ELSE
  1314              GO TO 1026-REF-R78
  1315           END-IF
  1316        END-IF
  1317     END-IF
  1318
  1319**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1320**** FOLLOWING.
  1321****       FOR VA. LIFE..
  1322****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1323****           NET COVERAGES --- USE RULE OF ANTIC.
  1324****  DECREASING COVERAGE    --- EFF DATE < 010193 USE R78.
  1325****                         --- EFF DATE > 123194 USE ANTIC.
  1326****                         --- EFF DATE BETWEEN 010193 AND 12319
  1327****                             WITH TERM > 61 USE RULE OF ANTIC
  1328****                             OTHERWISE USE RULE OF 78.
  1329****
  1330****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1331****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1332****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1333****            WILL FOLLOW.
  1334****
  1335****
  1336****
  1337
  1338     IF (CP-COMPANY-ID = 'NCL') AND
  1339        (CP-STATE-STD-ABBRV = 'VA')
  1340        IF CP-LEVEL-LIFE
  1341           GO TO 1023-REF-PR
  1342        ELSE
  1343        IF CP-EARN-AS-NET-PAY
  1344           GO TO 1021-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  27
* ELRFND.cbl
  1345        ELSE
  1346        IF CP-REDUCING-LIFE
  1347           IF DC-GREG-DATE-CYMD LESS THAN 19930101
  1348              GO TO 1026-REF-R78
  1349           ELSE
  1350           IF DC-GREG-DATE-CYMD GREATER THAN 19941231
  1351              GO TO 1021-ANTICIPATION-REF
  1352           ELSE
  1353           IF CP-ORIGINAL-TERM GREATER THAN 61
  1354              GO TO 1021-ANTICIPATION-REF
  1355           ELSE
  1356              GO TO 1026-REF-R78.
  1357
  1358     IF (CP-COMPANY-ID = 'CID')
  1359        AND (CP-STATE-STD-ABBRV = 'IN')
  1360        AND (DC-GREG-DATE-CYMD < 20030401)
  1361        IF CP-REDUCING-LIFE
  1362           GO TO 1026-REF-R78
  1363        ELSE
  1364           IF CP-LEVEL-LIFE
  1365              GO TO 1023-REF-PR
  1366           END-IF
  1367        END-IF
  1368     END-IF
  1369
  1370     IF (CP-COMPANY-ID = 'CID')
  1371        AND (CP-STATE-STD-ABBRV = 'FL')
  1372        AND (DC-GREG-DATE-CYMD > 20030630)
  1373        IF CP-RATE-AS-NET-PAY
  1374           GO TO 1028-NET-PAY-REFUND
  1375        END-IF
  1376     END-IF
  1377
  1378     IF (CP-COMPANY-ID = 'CID')
  1379        AND (CP-STATE-STD-ABBRV = 'MN')
  1380        AND (CP-EARN-AS-NET-PAY)
  1381        AND (CP-RATE-AS-REG-BALLOON)
  1382        AND (DC-GREG-DATE-CYMD > 20091231)
  1383        GO TO 1028-NET-PAY-REFUND
  1384     END-IF
  1385     IF (CP-COMPANY-ID = 'CID')
  1386        AND (CP-STATE-STD-ABBRV = 'MN')
  1387        AND (DC-GREG-DATE-CYMD > 20091231)
  1388        AND (CP-RATE-AS-NET-PAY)
  1389        GO TO 1021-ANTICIPATION-REF
  1390     END-IF
  1391     IF (CP-COMPANY-ID = 'CID')
  1392        AND (CP-STATE-STD-ABBRV = 'MO')
  1393        AND (DC-GREG-DATE-CYMD > 20030630)
  1394        AND (CP-LOAN-TERM < +121)
  1395        IF CP-RATE-AS-NET-PAY
  1396           GO TO 1028-NET-PAY-REFUND
  1397        END-IF
  1398     END-IF
  1399
  1400     IF (CP-COMPANY-ID = 'CID')
  1401        AND (CP-STATE-STD-ABBRV = 'ND')
  1402        AND (DC-GREG-DATE-CYMD > 20011231)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  28
* ELRFND.cbl
  1403        AND (CP-REDUCING-LIFE)
  1404        GO TO 1021-ANTICIPATION-REF
  1405     END-IF
  1406
  1407     IF CP-CRITICAL-PERIOD
  1408        IF CP-COMPANY-ID = 'NCL'
  1409           NEXT SENTENCE
  1410        ELSE
  1411           GO TO 1022-REF-CRITICAL-PERIOD-LF.
  1412
  1413     IF CP-TERM-IS-DAYS  AND
  1414        CP-TERM-OR-EXT-DAYS GREATER ZERO
  1415         GO TO 1024-REF-PR-DAYS.
  1416
  1417     IF CP-STATE-STD-ABBRV = 'NM'
  1418       IF CP-REDUCING-LIFE
  1419*        IF DC-GREG-DATE-1-YMD LESS THAN '980901'
  1420         IF DC-GREG-DATE-CYMD LESS THAN 19980901
  1421             GO TO 1026-REF-R78.
  1422
  1423     IF CP-EARN-ANTICIPATION
  1424         GO TO 1021-ANTICIPATION-REF.
  1425
  1426     IF CP-STATE-STD-ABBRV = 'ME'
  1427         IF CP-COMPANY-ID = 'NCL' OR 'CVL'
  1428            NEXT SENTENCE
  1429         ELSE
  1430            IF CP-REDUCING-LIFE
  1431               GO TO 1021-ANTICIPATION-REF.
  1432
  1433     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1434        IF CP-STATE-STD-ABBRV = 'TX'
  1435            GO TO SKIP-CSO-TEXAS-LIFE-PROCESSING
  1436        END-IF
  1437     END-IF.
  1438
  1439     IF CP-STATE-STD-ABBRV = 'TX'
  1440       IF CP-COMPANY-ID EQUAL 'HER' OR 'NCL'
  1441          NEXT SENTENCE
  1442       END-IF
  1443        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1444           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1445           GO TO 1021-ANTICIPATION-REF.
  1446
  1447 SKIP-CSO-TEXAS-LIFE-PROCESSING.
  1448
  1449     IF CP-EARN-BY-PRORATA
  1450         GO TO 1023-REF-PR.
  1451
  1452     IF CP-EARN-AS-MEAN
  1453         GO TO 1025-REF-MEAN.
  1454
  1455     IF CP-EARN-AS-TEXAS
  1456         GO TO 1027-TEXAS-REFUND.
  1457
  1458     IF CP-EARN-AS-NET-PAY
  1459         GO TO 1028-NET-PAY-REFUND.
  1460
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  29
* ELRFND.cbl
  1461     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  1462         GO TO 1000-NO-NET-PAY.
  1463
  1464     IF  CP-COMPANY-ID IS EQUAL TO 'CID' OR 'CSO'
  1465       IF CP-STATE-STD-ABBRV = 'NC'
  1466         IF CP-REDUCING-LIFE
  1467           IF CP-ORIGINAL-TERM GREATER 60  AND
  1468              DC-GREG-DATE-CYMD GREATER 19810930
  1469                GO TO 1028-NET-PAY-REFUND
  1470           ELSE
  1471              GO TO 1026-REF-R78.
  1472
  1473
  1474     IF CP-STATE-STD-ABBRV = 'NC'
  1475       IF CP-COMPANY-ID EQUAL 'NCL'
  1476          NEXT SENTENCE
  1477       END-IF
  1478       IF CP-REDUCING-LIFE
  1479         IF CP-ORIGINAL-TERM GREATER 60  AND
  1480            DC-GREG-DATE-CYMD GREATER 19810930
  1481             GO TO 1021-ANTICIPATION-REF
  1482         ELSE
  1483             GO TO 1026-REF-R78.
  1484
  1485     IF CP-STATE-STD-ABBRV = 'UT'
  1486       IF CP-COMPANY-ID EQUAL 'NCL'
  1487          NEXT SENTENCE
  1488       END-IF
  1489         IF CP-ORIGINAL-TERM GREATER 62         AND
  1490            CP-LOAN-APR GREATER ZERO            AND
  1491            DC-GREG-DATE-CYMD GREATER 19810831 AND
  1492            DC-GREG-DATE-CYMD LESS    19830901
  1493             GO TO 1028-NET-PAY-REFUND
  1494         ELSE
  1495             GO TO 1026-REF-R78.
  1496
  1497     IF CP-STATE-STD-ABBRV = 'OH'
  1498       IF CP-COMPANY-ID EQUAL 'NCL' OR 'HER'
  1499          NEXT SENTENCE
  1500       END-IF
  1501           IF CP-ORIGINAL-TERM GREATER 60         AND
  1502              CP-CLASS-CODE NOT = 'L '            AND
  1503              CP-LOAN-APR GREATER ZERO            AND
  1504              DC-GREG-DATE-CYMD GREATER 19831031
  1505              GO TO 1028-NET-PAY-REFUND
  1506           ELSE
  1507              GO TO 1026-REF-R78.
  1508
  1509     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1510       IF CP-STATE-STD-ABBRV = 'MT'
  1511         GO TO SKIP-CSO-MT-LF-PROCESSING.
  1512
  1513
  1514     IF CP-STATE-STD-ABBRV = 'MT'
  1515       IF CP-COMPANY-ID EQUAL 'NCL'
  1516          NEXT SENTENCE
  1517       END-IF
  1518         IF CP-ORIGINAL-TERM GREATER 61         AND
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  30
* ELRFND.cbl
  1519            CP-LOAN-APR GREATER ZERO            AND
  1520            DC-GREG-DATE-CYMD GREATER 19830318
  1521             GO TO 1028-NET-PAY-REFUND
  1522         ELSE
  1523             GO TO 1026-REF-R78.
  1524
  1525 SKIP-CSO-MT-LF-PROCESSING.
  1526
  1527     IF CP-STATE-STD-ABBRV = 'RI'
  1528       IF CP-COMPANY-ID EQUAL 'NCL'
  1529          NEXT SENTENCE
  1530       END-IF
  1531         IF CP-ORIGINAL-TERM GREATER 60         AND
  1532            CP-LOAN-APR GREATER ZERO            AND
  1533            DC-GREG-DATE-CYMD GREATER 19831231
  1534             GO TO 1028-NET-PAY-REFUND
  1535         ELSE
  1536             GO TO 1026-REF-R78.
  1537
  1538
  1539 1000-NO-NET-PAY.
  1540
  1541     IF CP-STATE-STD-ABBRV = 'WY'
  1542       IF CP-COMPANY-ID EQUAL 'NCL'
  1543          NEXT SENTENCE
  1544       END-IF
  1545        IF CP-COMPANY-ID = 'TMS'
  1546           GO TO 1026-REF-R78
  1547        ELSE
  1548           GO TO 1023-REF-PR.
  1549
  1550     IF CP-EARN-BY-R78
  1551         GO TO 1026-REF-R78.
  1552
  1553     IF CP-EARN-AS-SUM-OF-DIGITS
  1554         GO TO 1075-SUM-OF-DIGITS.
  1555
  1556     IF CP-LEVEL-LIFE
  1557         GO TO 1023-REF-PR
  1558     ELSE
  1559         GO TO 1026-REF-R78.
  1560
  1561*-----------------------------------------------------------------
  1562 1021-ANTICIPATION-REF.
  1563     MOVE '6'                  TO CP-REFUND-TYPE-USED.
  1564
  1565     MOVE CP-LOAN-TERM         TO WS-SAVE-LOAN-TERM.
  1566     IF CP-LOAN-TERM = ZEROS
  1567        MOVE CP-ORIGINAL-TERM TO CP-LOAN-TERM
  1568     END-IF
  1569     COMPUTE CP-LOAN-TERM = CP-LOAN-TERM - CP-ORIGINAL-TERM +
  1570                            CP-REMAINING-TERM.
  1571
  1572     MOVE CP-ORIGINAL-BENEFIT  TO WS-SAVE-BENEFIT.
  1573     MOVE CP-ORIGINAL-TERM     TO WS-SAVE-TERM.
  1574     MOVE CP-EARNING-METHOD    TO WS-SAVE-EARN-METHOD.
  1575     move cp-term-or-ext-days  to ws-save-ext-days
  1576
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  31
* ELRFND.cbl
  1577     MOVE CP-REMAINING-BENEFIT TO CP-ORIGINAL-BENEFIT.
  1578     MOVE CP-REMAINING-TERM    TO CP-ORIGINAL-TERM.
  1579     MOVE CP-RATING-METHOD     TO CP-EARNING-METHOD.
  1580
  1581     IF CP-REMAINING-TERM = WS-SAVE-TERM
  1582         MOVE 'N'              TO CP-ROA-REFUND
  1583     ELSE
  1584         MOVE 'Y'              TO CP-ROA-REFUND.
  1585
  1586******    TO COMPUTE PREMIUM AT REFUND DATE
  1587     PERFORM 2500-GET-RATE.
  1588
  1589     MOVE 'N'                  TO CP-ROA-REFUND.
  1590     MOVE WS-SAVE-BENEFIT      TO CP-ORIGINAL-BENEFIT.
  1591     MOVE WS-SAVE-TERM         TO CP-ORIGINAL-TERM.
  1592     MOVE WS-SAVE-LOAN-TERM    TO CP-LOAN-TERM.
  1593     move ws-save-ext-days     to cp-term-or-ext-days
  1594
  1595     IF CP-PREMIUM-RATE = ZEROS
  1596        MOVE '7'                 TO CP-RETURN-CODE
  1597        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1598        GO TO 1999-CALC-REF-AMT-X.
  1599
  1600     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1601
  1602******    TO COMPUTE PREMIUM AT ORIGINAL ISSUE DATE
  1603     PERFORM 2500-GET-RATE.
  1604
  1605     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1606
  1607     IF CP-PREMIUM-RATE = ZEROS
  1608        MOVE '7'            TO CP-RETURN-CODE
  1609        GO TO 1999-CALC-REF-AMT-X.
  1610
  1611     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1612
  1613     IF  WS-ORIG-PREM = ZEROS
  1614         MOVE ZEROS TO WS-NP-REF-FACTOR
  1615        ELSE
  1616         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1617                                            WS-ORIG-PREM.
  1618
  1619     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1620                                        CP-ORIGINAL-PREMIUM.
  1621
  1622     GO TO 1999-CALC-REF-AMT-X.
  1623
  1624*---------------------------------------------------------------
  1625 1022-REF-CRITICAL-PERIOD-LF.
  1626     GO TO 1023-REF-PR.
  1627
  1628*---------------------------------------------------------------
  1629 1023-REF-PR.
  1630     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1631     COMPUTE CP-CALC-REFUND ROUNDED =
  1632            CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1633
  1634     GO TO 1999-CALC-REF-AMT-X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  32
* ELRFND.cbl
  1635
  1636*---------------------------------------------------------------
  1637 1024-REF-PR-DAYS.
  1638     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1639     MOVE CP-VALUATION-DT    TO DC-BIN-DATE-2.
  1640     MOVE '1'                TO DC-OPTION-CODE.
  1641     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1642
  1643     IF DATE-CONVERSION-ERROR
  1644         MOVE '2' TO CP-RETURN-CODE
  1645         GO TO 1999-CALC-REF-AMT-X.
  1646
  1647     COMPUTE CP-CALC-REFUND ROUNDED =
  1648         (CP-ORIGINAL-PREMIUM / CP-TERM-OR-EXT-DAYS) *
  1649                 (CP-TERM-OR-EXT-DAYS - DC-ELAPSED-DAYS).
  1650
  1651     GO TO 1999-CALC-REF-AMT-X.
  1652
  1653*---------------------------------------------------------------
  1654 1025-REF-MEAN.
  1655     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1656     COMPUTE CP-CALC-REFUND ROUNDED =
  1657          ((CP-ORIGINAL-PREMIUM * PR-FACTOR) +
  1658           (CP-ORIGINAL-PREMIUM * R78-FACTOR)) * +.5.
  1659
  1660     GO TO 1999-CALC-REF-AMT-X.
  1661
  1662*---------------------------------------------------------------
  1663 1026-REF-R78.
  1664     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1665*    IF CP-TERM-TIMES-TERM
  1666*        COMPUTE R78-FACTOR =
  1667*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1668*               (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1669*
  1670     COMPUTE CP-CALC-REFUND ROUNDED =
  1671        CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1672
  1673     GO TO 1999-CALC-REF-AMT-X.
  1674
  1675*---------------------------------------------------------------
  1676 1027-TEXAS-REFUND.
  1677     MOVE '4'               TO CP-REFUND-TYPE-USED.
  1678     IF CP-PAY-FREQUENCY = ZERO
  1679        MOVE ZERO TO CP-CALC-REFUND
  1680        MOVE '5'  TO CP-RETURN-CODE
  1681        GO TO 1999-CALC-REF-AMT-X.
  1682
  1683     COMPUTE TEX-FACT-4 = (CP-ORIGINAL-TERM * CP-ORIGINAL-TERM) +
  1684         (CP-PAY-FREQUENCY * CP-ORIGINAL-TERM).
  1685
  1686     DIVIDE CP-REMAINING-TERM BY CP-PAY-FREQUENCY
  1687         GIVING TEX-FACT-5
  1688             REMAINDER TEX-FACT-6.
  1689
  1690     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CP-PAY-FREQUENCY.
  1691
  1692     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  33
* ELRFND.cbl
  1693         (TEX-FACT-5 * CP-PAY-FREQUENCY) +
  1694         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CP-PAY-FREQUENCY))).
  1695
  1696     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  1697
  1698     COMPUTE CP-CALC-REFUND ROUNDED = CP-ORIGINAL-PREMIUM
  1699                                        * TEX-FACT-8.
  1700
  1701     GO TO 1999-CALC-REF-AMT-X.
  1702
  1703*---------------------------------------------------------------
  1704 1028-NET-PAY-REFUND.
  1705     MOVE '5'               TO CP-REFUND-TYPE-USED.
  1706     IF CP-LOAN-APR = ZERO
  1707        move '1'                 to cp-refund-type-used
  1708        compute cp-calc-refund rounded =
  1709           cp-original-premium * r78-factor
  1710        go to 1999-calc-ref-amt-x
  1711     end-if
  1712*       MOVE ZERO TO CP-CALC-REFUND
  1713*       MOVE '1'  TO CP-RETURN-CODE
  1714*       GO TO 1999-CALC-REF-AMT-X.
  1715
  1716     MOVE CP-LOAN-APR           TO N-P-APR.
  1717     MOVE CP-ORIGINAL-TERM      TO N-P-ORIG  N-P-LOAN.
  1718     MOVE CP-REMAINING-TERM     TO N-P-REM.
  1719
  1720     IF CP-TRUNCATED-LIFE
  1721        MOVE CP-LOAN-TERM     TO N-P-LOAN.
  1722
  1723     MOVE 'R'                   TO N-P-OPT.
  1724
  1725     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1726
  1727     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  1728                                        CP-ORIGINAL-PREMIUM.
  1729
  1730 1029-UTAH-REFUND.
  1731*
  1732*---------------------------------------------------------------
  1733* FOLLOWING IS FOR TRISH - 10/26/98  (FOR UTAH ONLY).
  1734*---------------------------------------------------------------
  1735*
  1736     GO TO 1999-CALC-REF-AMT-X.
  1737*
  1738*---------------------------------------------------------------
  1739     IF (CP-STATE-STD-ABBRV NOT = 'UT')
  1740                      OR
  1741        (CP-COMPANY-ID EQUAL 'NCL')
  1742         GO TO 1999-CALC-REF-AMT-X.
  1743     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1744
  1745     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1746        GREATER ZERO AND LESS 13
  1747         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1748                 (CP-CALC-REFUND * .05).
  1749
  1750     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  34
* ELRFND.cbl
  1751        GREATER 12 AND LESS 25
  1752         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1753                 (CP-CALC-REFUND * .025).
  1754
  1755     GO TO 1999-CALC-REF-AMT-X.
  1756*---------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  35
* ELRFND.cbl
  1758*---------------------------------------------------------------
  1759 1030-GET-AH-REFUND.
  1760     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1761
  1762     COMPUTE R78-FACTOR =
  1763            ((CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1764                (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1))).
  1765
  1766*    IF CP-TERM-TIMES-TERM
  1767*        COMPUTE R78-FACTOR =
  1768*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1769*            (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1770*
  1771
  1772**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1773**** FOLLOWING.
  1774****       FOR VA. DISABILITY
  1775****                         --- EFF DATE > 123192 AND
  1776****                             TERM > 61 USE RULE OF ANTIC
  1777****                             OTHERWISE USE RULE OF 78.
  1778****
  1779****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1780****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1781****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1782****            WILL FOLLOW.
  1783****
  1784****
  1785****
  1786     IF CP-COMPANY-ID = 'NCL' or 'AHL'
  1787        IF CP-STATE-STD-ABBRV = 'VA'
  1788           IF (DC-GREG-DATE-CYMD GREATER 19921231) AND
  1789              (CP-ORIGINAL-TERM GREATER THAN 61)
  1790               MOVE '6'        TO CP-EARNING-METHOD
  1791               GO TO 1060-ANTICIPATION-REF
  1792            ELSE
  1793               MOVE '1'        TO CP-EARNING-METHOD
  1794               GO TO 1050-R78-REF.
  1795
  1796     IF CP-STATE-STD-ABBRV = 'WY'
  1797        IF CP-COMPANY-ID = 'TMS'
  1798           GO TO 1050-R78-REF.
  1799
  1800     IF CP-COMPANY-ID = 'NCL' OR 'WDS' OR 'CID' OR 'DCC' OR 'AHL'
  1801         NEXT SENTENCE
  1802     ELSE
  1803         IF CP-CRITICAL-PERIOD
  1804             GO TO 1035-REF-AH-CRITICAL-PERIOD.
  1805
  1806*      THE FOLLOWING HAPPENS WHEN THE REFUND METHOD FOR THE
  1807*    BENEFIT CODE IS A NON REFUNDABLE METHOD
  1808*    I AM CHECKING THE TERM AND REM TERM BECAUSE OF THE 30
  1809*    DAY FREE LOOK PERIOD. ALSO, 55 AND 56 ARE THE BIU CODES
  1810     IF (CP-GAP-NON-REFUNDABLE)
  1811        IF (CP-ORIGINAL-TERM NOT = CP-REMAINING-TERM)
  1812           OR (CP-BENEFIT-CD = '55' OR '56')
  1813           MOVE ZEROS            TO CP-CALC-REFUND
  1814           MOVE 'G'              TO CP-REFUND-TYPE-USED
  1815           GO TO 1999-CALC-REF-AMT-X
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  36
* ELRFND.cbl
  1816        END-IF
  1817     END-IF
  1818     IF CP-GAP-ACTUARIAL
  1819         GO TO 1070-NET-PAY-REFUND
  1820     END-IF
  1821     IF (CP-COMPANY-ID = 'CID')
  1822        AND (CP-STATE-STD-ABBRV = 'MN')
  1823        AND (DC-GREG-DATE-CYMD > 20091231)
  1824        IF (CP-CRITICAL-PERIOD)
  1825           GO TO 1040-PR-REF
  1826        ELSE
  1827           GO TO 1055-MEAN-REF
  1828     END-IF
  1829     IF CP-COMPANY-ID EQUAL 'CID' OR 'DCC'
  1830        IF CP-STATE-STD-ABBRV = 'NC'
  1831           GO TO SKIP-CSO-NC-AH-PROCESSING.
  1832
  1833     IF (CP-COMPANY-ID = 'CID')
  1834        AND (CP-STATE-STD-ABBRV = 'IN')
  1835        AND (DC-GREG-DATE-CYMD < 20030401)
  1836        GO TO 1026-REF-R78
  1837     END-IF
  1838
  1839     IF (CP-COMPANY-ID = 'CID')
  1840        AND (CP-STATE-STD-ABBRV = 'FL')
  1841        AND (DC-GREG-DATE-CYMD > 20030630)
  1842        AND (CP-CRITICAL-PERIOD)
  1843        GO TO 1040-PR-REF
  1844     END-IF
  1845
  1846     IF (CP-COMPANY-ID = 'CID')
  1847        AND (CP-STATE-STD-ABBRV = 'MO')
  1848        AND (DC-GREG-DATE-CYMD > 20030630)
  1849        AND (CP-CRITICAL-PERIOD)
  1850        GO TO 1040-PR-REF
  1851     END-IF
  1852
  1853     IF (CP-COMPANY-ID = 'CID')
  1854        AND (CP-STATE-STD-ABBRV = 'ND')
  1855        AND (CP-CRITICAL-PERIOD)
  1856        AND (DC-GREG-DATE-CYMD > 20011231)
  1857        GO TO 1040-PR-REF
  1858     END-IF
  1859
  1860     IF (CP-COMPANY-ID = 'CID')
  1861        AND (CP-STATE-STD-ABBRV = 'ND')
  1862        AND (DC-GREG-DATE-CYMD > 20011231)
  1863        GO TO 1060-ANTICIPATION-REF
  1864     END-IF
  1865
  1866     IF CP-STATE-STD-ABBRV = 'NC'
  1867       IF CP-COMPANY-ID = 'NCL' OR 'NCB'
  1868          NEXT SENTENCE
  1869       END-IF
  1870         IF DC-GREG-DATE-CYMD GREATER 19810930
  1871            IF CP-EARN-ANTICIPATION
  1872                GO TO 1060-ANTICIPATION-REF
  1873            ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  37
* ELRFND.cbl
  1874                GO TO 1055-MEAN-REF.
  1875
  1876 SKIP-CSO-NC-AH-PROCESSING.
  1877
  1878     IF CP-STATE-STD-ABBRV = 'NM'
  1879       IF CP-COMPANY-ID = 'NCL' OR 'DCC' OR 'AHL'
  1880          NEXT SENTENCE
  1881       END-IF
  1882         IF DC-GREG-DATE-CYMD GREATER THAN 19871231
  1883            IF CP-COMPANY-ID = 'MON'
  1884              MOVE '6'             TO CP-EARNING-METHOD
  1885              GO TO 1060-ANTICIPATION-REF
  1886             ELSE
  1887              GO TO 1055-MEAN-REF.
  1888
  1889     IF CP-STATE-STD-ABBRV = 'CT'
  1890       IF CP-COMPANY-ID EQUAL 'NCL' OR 'DCC'
  1891          NEXT SENTENCE
  1892       END-IF
  1893          MOVE '6'              TO CP-EARNING-METHOD
  1894          GO TO 1060-ANTICIPATION-REF.
  1895
  1896     IF CP-STATE-STD-ABBRV = 'ME'
  1897       IF CP-COMPANY-ID = 'NCL' OR 'CVL' OR 'DCC'
  1898          NEXT SENTENCE
  1899       END-IF
  1900           IF CP-EARN-BY-PRORATA
  1901              GO TO 1040-PR-REF
  1902           ELSE
  1903              MOVE '6'           TO CP-EARNING-METHOD
  1904              GO TO 1060-ANTICIPATION-REF.
  1905
  1906
  1907     IF CP-COMPANY-ID = 'CID' OR 'DCC'
  1908        IF CP-STATE-STD-ABBRV = 'TX' OR 'VA'
  1909            GO TO SKIP-CSO-TX-VA-AH-PROCESSING.
  1910
  1911     IF CP-STATE-STD-ABBRV = 'TX'
  1912       IF CP-COMPANY-ID = 'NCL' OR 'HER'
  1913          NEXT SENTENCE
  1914       END-IF
  1915        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1916           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1917           MOVE '6'              TO CP-EARNING-METHOD
  1918           GO TO 1060-ANTICIPATION-REF.
  1919
  1920     IF CP-STATE-STD-ABBRV = 'VA'
  1921       IF CP-COMPANY-ID EQUAL 'NCL'
  1922          NEXT SENTENCE
  1923       END-IF
  1924       IF CP-COMPANY-ID = 'NCB'
  1925           MOVE '6'                TO CP-EARNING-METHOD
  1926           GO TO 1060-ANTICIPATION-REF
  1927       ELSE
  1928           IF DC-GREG-DATE-CYMD GREATER 19921231
  1929               IF CP-ORIGINAL-TERM GREATER THAN 61
  1930                   MOVE '6'        TO CP-EARNING-METHOD
  1931                   GO TO 1060-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  38
* ELRFND.cbl
  1932               ELSE
  1933                   MOVE '1'        TO CP-EARNING-METHOD
  1934                   GO TO 1050-R78-REF.
  1935
  1936 SKIP-CSO-TX-VA-AH-PROCESSING.
  1937
  1938     IF CP-EARN-BY-PRORATA
  1939         GO TO 1040-PR-REF.
  1940
  1941     IF CP-EARN-BY-R78
  1942         GO TO 1050-R78-REF.
  1943
  1944     IF CP-EARN-AS-MEAN
  1945        GO TO 1055-MEAN-REF.
  1946
  1947     IF CP-EARN-AS-SUM-OF-DIGITS
  1948         GO TO 1075-SUM-OF-DIGITS.
  1949     IF CP-DCC-SPP-DDF
  1950        GO TO 1080-DCC-DDF-SPECIAL
  1951     END-IF
  1952     IF CP-EARN-AS-CALIF
  1953         GO TO 1060-ANTICIPATION-REF.
  1954
  1955     IF CP-EARN-ANTICIPATION
  1956         GO TO 1060-ANTICIPATION-REF.
  1957
  1958     IF CP-EARN-AS-NET-PAY
  1959         GO TO 1070-NET-PAY-REFUND.
  1960
  1961     GO TO 1050-R78-REF.
  1962
  1963*---------------------------------------------------------------
  1964 1035-REF-AH-CRITICAL-PERIOD.
  1965     IF CP-REMAINING-TERM GREATER +6
  1966        COMPUTE CP-CALC-REFUND ROUNDED =
  1967          CP-ORIGINAL-PREMIUM * (((CP-REMAINING-TERM * +2) - +5) /
  1968                       ((CP-ORIGINAL-TERM * +2) - + 5))
  1969      ELSE
  1970        COMPUTE CP-CALC-REFUND ROUNDED =
  1971          CP-ORIGINAL-PREMIUM * ((CP-REMAINING-TERM *
  1972                                           CP-REMAINING-TERM + 1)
  1973                              /  (+12 * CP-ORIGINAL-TERM) - +30).
  1974
  1975     IF CP-CALC-REFUND LESS ZERO
  1976         MOVE ZERO TO CP-CALC-REFUND.
  1977
  1978     GO TO 1999-CALC-REF-AMT-X.
  1979
  1980*---------------------------------------------------------------
  1981 1040-PR-REF.
  1982     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1983     COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1984
  1985     GO TO 1999-CALC-REF-AMT-X.
  1986
  1987*---------------------------------------------------------------
  1988 1050-R78-REF.
  1989     MOVE '1'               TO CP-REFUND-TYPE-USED.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  39
* ELRFND.cbl
  1990     COMPUTE CP-CALC-REFUND ROUNDED =
  1991           CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1992
  1993     GO TO 1999-CALC-REF-AMT-X.
  1994
  1995*---------------------------------------------------------------
  1996 1055-MEAN-REF.
  1997     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1998     COMPUTE CP-CALC-REFUND ROUNDED =
  1999         ((CP-ORIGINAL-PREMIUM * R78-FACTOR) +
  2000          (CP-ORIGINAL-PREMIUM * PR-FACTOR)) * .5.
  2001
  2002     GO TO 1999-CALC-REF-AMT-X.
  2003
  2004*---------------------------------------------------------------
  2005 1060-ANTICIPATION-REF.
  2006     MOVE '6'               TO CP-REFUND-TYPE-USED.
  2007
  2008     MOVE CP-ORIGINAL-TERM  TO WS-SAVE-TERM.
  2009     MOVE CP-LOAN-TERM      TO WS-SAVE-LOAN-TERM.
  2010     MOVE CP-EARNING-METHOD TO WS-SAVE-EARN-METHOD.
  2011
  2012     MOVE CP-REMAINING-TERM TO CP-ORIGINAL-TERM
  2013                               CP-LOAN-TERM.
  2014     MOVE CP-RATING-METHOD  TO CP-EARNING-METHOD.
  2015
  2016     PERFORM 2500-GET-RATE.
  2017
  2018     MOVE WS-SAVE-TERM      TO CP-ORIGINAL-TERM.
  2019     MOVE WS-SAVE-LOAN-TERM TO CP-LOAN-TERM.
  2020
  2021     IF CP-PREMIUM-RATE = ZEROS
  2022        MOVE '7'                 TO CP-RETURN-CODE
  2023        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  2024        GO TO 1999-CALC-REF-AMT-X.
  2025
  2026     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  2027
  2028     PERFORM 2500-GET-RATE.
  2029
  2030     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  2031
  2032     IF CP-PREMIUM-RATE = ZEROS
  2033        MOVE '7'            TO CP-RETURN-CODE
  2034        GO TO 1999-CALC-REF-AMT-X.
  2035
  2036     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  2037
  2038     IF  WS-ORIG-PREM = ZERO
  2039         MOVE ZERO                TO WS-NP-REF-FACTOR
  2040        ELSE
  2041         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  2042                                            WS-ORIG-PREM.
  2043
  2044     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  2045                                        CP-ORIGINAL-PREMIUM.
  2046
  2047     IF NOT CP-EARN-AS-CALIF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  40
* ELRFND.cbl
  2048         GO TO 1999-CALC-REF-AMT-X.
  2049
  2050*---------------------------------------------------------------
  2051 1065-CALIF-REGS.
  2052     MOVE '3'               TO CP-REFUND-TYPE-USED.
  2053     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  2054         GIVING FACTOR-5.
  2055
  2056     IF FACTOR-5 NOT GREATER +6  AND
  2057        CP-CLASS-CODE = 'A '
  2058         GO TO 1050-R78-REF.
  2059
  2060     IF FACTOR-5 = ZERO
  2061         MOVE CP-ORIGINAL-PREMIUM   TO CP-CALC-REFUND
  2062         GO TO 1999-CALC-REF-AMT-X.
  2063
  2064     IF CP-ORIGINAL-TERM LESS +014
  2065         GO TO 1999-CALC-REF-AMT-X.
  2066
  2067     MULTIPLY CP-ORIGINAL-TERM BY CP-ORIGINAL-TERM
  2068                                   GIVING FACTOR-5 ROUNDED.
  2069
  2070     MULTIPLY FACTOR-5 BY +0.0000045573 GIVING FACTOR-1 ROUNDED.
  2071
  2072     MULTIPLY +0.001125 BY CP-ORIGINAL-TERM
  2073                                   GIVING FACTOR-2 ROUNDED.
  2074
  2075     SUBTRACT FACTOR-2 FROM FACTOR-1.
  2076     ADD +0.099375 TO FACTOR-1.
  2077
  2078     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  2079                                   GIVING FACTOR-5 ROUNDED.
  2080
  2081     SUBTRACT +1.00 FROM FACTOR-5.
  2082
  2083     IF CP-ORIGINAL-TERM LESS +049
  2084         SUBTRACT +013 FROM CP-ORIGINAL-TERM
  2085                                   GIVING FACTOR-6 ROUNDED
  2086     ELSE
  2087         MOVE +035 TO FACTOR-6.
  2088
  2089     MOVE +001 TO FACTOR-2.
  2090
  2091     DIVIDE FACTOR-5 BY FACTOR-6 GIVING FACTOR-4 ROUNDED.
  2092     SUBTRACT FACTOR-4 FROM FACTOR-2.
  2093     MULTIPLY FACTOR-1 BY FACTOR-2 GIVING FACTOR-3 ROUNDED.
  2094     MOVE +001 TO FACTOR-2.
  2095     SUBTRACT FACTOR-3 FROM FACTOR-2 GIVING FACTOR-1 ROUNDED.
  2096
  2097     MULTIPLY FACTOR-1 BY CP-CALC-REFUND
  2098         GIVING CAL-RFND ROUNDED.
  2099
  2100     IF CAL-RFND LESS +0.01
  2101         MOVE ZEROS TO CAL-RFND.
  2102
  2103     IF CAL-RFND LESS CP-CALC-REFUND
  2104         MOVE CAL-RFND TO CP-CALC-REFUND.
  2105
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  41
* ELRFND.cbl
  2106     GO TO 1999-CALC-REF-AMT-X.
  2107
  2108*-----------------------------------------------------------------
  2109 1070-NET-PAY-REFUND.
  2110     MOVE '5'                    TO  CP-REFUND-TYPE-USED.
  2111     IF CP-LOAN-APR = ZERO
  2112         MOVE ZEROS              TO  CP-CALC-REFUND
  2113         MOVE '1'                TO  CP-RETURN-CODE
  2114         GO TO 1999-CALC-REF-AMT-X.
  2115
  2116     MOVE CP-LOAN-APR            TO  N-P-APR.
  2117     MOVE CP-ORIGINAL-TERM       TO  N-P-ORIG  N-P-LOAN.
  2118     MOVE CP-REMAINING-TERM      TO  N-P-REM.
  2119
  2120     MOVE 'R'                    TO  N-P-OPT.
  2121
  2122     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2123
  2124     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  2125                                        CP-ORIGINAL-PREMIUM.
  2126
  2127     GO TO 1999-CALC-REF-AMT-X.
  2128*---------------------------------------------------------------
  2129
  2130 1075-SUM-OF-DIGITS.
  2131
  2132     MOVE '9'               TO CP-REFUND-TYPE-USED.
  2133
  2134     COMPUTE RSUM-REMAINING-TERM =
  2135             CP-LOAN-TERM -
  2136                  (CP-ORIGINAL-TERM - (CP-REMAINING-TERM + 1))
  2137
  2138     COMPUTE RSUM-FACTOR =
  2139        ((RSUM-REMAINING-TERM * (RSUM-REMAINING-TERM + 1)) -
  2140               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2141                 (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1)))   /
  2142            ((CP-LOAN-TERM * (CP-LOAN-TERM + 1))           -
  2143               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2144                 (CP-LOAN-TERM - CP-ORIGINAL-TERM  + 1))).
  2145
  2146     COMPUTE CP-CALC-REFUND ROUNDED =
  2147           CP-ORIGINAL-PREMIUM * RSUM-FACTOR.
  2148
  2149     GO TO 1999-CALC-REF-AMT-X
  2150     .
  2151 1080-DCC-DDF-SPECIAL.
  2152     COMPUTE CP-MONTH =
  2153        FUNCTION REM(CP-ORIGINAL-TERM - CP-REMAINING-TERM, 12)
  2154*    DISPLAY ' BEGIN ELCRFNDP ************** '
  2155*    DISPLAY ' SPEC       ' CP-DDF-SPEC-CALC
  2156*    DISPLAY ' MONTH      ' CP-MONTH
  2157*    DISPLAY ' ORIG TERM  ' CP-ORIGINAL-TERM
  2158*    DISPLAY ' REM TERM   ' CP-REMAINING-TERM
  2159*    DISPLAY ' ORIG PREM  ' CP-ORIGINAL-PREMIUM
  2160*    DISPLAY ' 1YR EXP AL ' CP-1ST-YR-ALLOW
  2161*    DISPLAY ' HI FACT    ' CP-DDF-HI-FACT
  2162*    DISPLAY ' LO FACT    ' CP-DDF-LO-FACT
  2163*    DISPLAY ' RATE UP    ' CP-IU-RATE-UP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  42
* ELRFND.cbl
  2164*    DISPLAY ' CLP RAT UP ' CP-CLP-RATE-UP
  2165*    DISPLAY ' EARM METH  ' CP-EARNING-METHOD
  2166*    DISPLAY '   END ELCRFNDP ************** '
  2167     IF CP-MONTH = 0
  2168        MOVE 12                  TO CP-MONTH
  2169     END-IF
  2170     MOVE CP-MONTH               TO WS-MONTH
  2171     MOVE 'D'                    TO CP-REFUND-TYPE-USED
  2172     IF CP-DCC-SPP-DDF-IU
  2173        GO TO 1090-DCC-DDF-IU
  2174     END-IF
  2175     IF CP-CALC-CLP
  2176        GO TO 1085-DCC-DDF-SPECIAL-CLP
  2177     END-IF
  2178     EVALUATE TRUE
  2179        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2180           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2181           MOVE CP-ORIGINAL-PREMIUM
  2182                                 TO CP-CALC-REFUND
  2183        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2184           MOVE CP-MONTH         TO WS-MONTH
  2185           PERFORM 1150-UE-GROSS-LT-4
  2186           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2187        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2188           MOVE CP-MONTH         TO WS-MONTH
  2189           PERFORM 1160-UE-GROSS-LT-13
  2190           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2191        WHEN OTHER
  2192           MOVE CP-MONTH         TO WS-MONTH
  2193           PERFORM 1170-UE-GROSS-GT-12
  2194           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2195     END-EVALUATE
  2196     GO TO 1999-CALC-REF-AMT-X
  2197     .
  2198 1085-DCC-DDF-SPECIAL-CLP.
  2199     EVALUATE TRUE
  2200        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2201           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2202           MOVE CP-ORIGINAL-PREMIUM
  2203                                 TO CP-CALC-REFUND
  2204        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2205           MOVE CP-MONTH         TO WS-MONTH
  2206           PERFORM 1100-UE-CLP-LT-4
  2207           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2208        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2209           MOVE CP-MONTH         TO WS-MONTH
  2210           PERFORM 1110-UE-CLP-LT-13
  2211           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2212        WHEN OTHER
  2213           MOVE CP-MONTH         TO WS-MONTH
  2214           PERFORM 1120-UE-CLP-GT-12
  2215           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2216     END-EVALUATE
  2217     GO TO 1999-CALC-REF-AMT-X
  2218     .
  2219 1090-DCC-DDF-IU.
  2220     MOVE 'I'                    TO CP-REFUND-TYPE-USED
  2221     IF CP-CALC-CLP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  43
* ELRFND.cbl
  2222        GO TO 1095-DCC-DDF-IU-SPECIAL-CLP
  2223     END-IF
  2224     EVALUATE TRUE
  2225        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2226           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2227           MOVE CP-ORIGINAL-PREMIUM
  2228                                 TO CP-CALC-REFUND
  2229        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2230           MOVE CP-MONTH         TO WS-MONTH
  2231           PERFORM 1250-IU-UE-GROSS-LT-4
  2232           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2233        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2234           MOVE CP-MONTH         TO WS-MONTH
  2235           PERFORM 1260-IU-UE-GROSS-LT-13
  2236           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2237        WHEN OTHER
  2238           MOVE CP-MONTH         TO WS-MONTH
  2239           PERFORM 1270-IU-UE-GROSS-GT-12
  2240           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2241     END-EVALUATE
  2242     GO TO 1999-CALC-REF-AMT-X
  2243     .
  2244 1095-DCC-DDF-IU-SPECIAL-CLP.
  2245     EVALUATE TRUE
  2246        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2247           OR (CP-DDF-CLP = ZEROS)
  2248           MOVE CP-DDF-CLP       TO CP-CALC-REFUND
  2249        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2250           MOVE CP-MONTH         TO WS-MONTH
  2251           PERFORM 1200-IU-UE-CLP-LT-4
  2252           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2253        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2254           MOVE CP-MONTH         TO WS-MONTH
  2255           PERFORM 1210-IU-UE-CLP-LT-13
  2256           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2257        WHEN OTHER
  2258           MOVE CP-MONTH         TO WS-MONTH
  2259           PERFORM 1220-IU-UE-CLP-GT-12
  2260           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2261     END-EVALUATE
  2262     GO TO 1999-CALC-REF-AMT-X
  2263     .
  2264 1100-UE-CLP-LT-4.
  2265*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*mo/12}
  2266     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2267        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2268        / CP-DDF-CLP - CP-DDF-HI-FACT)
  2269        * WS-MONTH / 12)
  2270     .
  2271 1110-UE-CLP-LT-13.
  2272*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12}
  2273*****  -[(CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12
  2274*****  -CLP*UEF1}*(mo-3)/9]
  2275     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2276        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2277        / CP-DDF-CLP - CP-DDF-HI-FACT) * 3 / 12)
  2278        -  ((CP-DDF-CLP - 0) - CP-DDF-CLP
  2279        * (((CP-DDF-CLP - 0) / CP-DDF-CLP
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  44
* ELRFND.cbl
  2280        - CP-DDF-HI-FACT) * 3 / 12) - CP-DDF-CLP
  2281        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2282     .
  2283 1120-UE-CLP-GT-12.
  2284*****  CLP * {UEF1 - (UEF1 -UEF2)*mo/12}
  2285     COMPUTE WS-TEMP-RESULT ROUNDED = CP-DDF-CLP *
  2286        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2287        * WS-MONTH / 12)
  2288     .
  2289 1150-UE-GROSS-LT-4.
  2290     COMPUTE CP-1ST-YR-ALLOW = CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2291     COMPUTE WS-TEMP-RESULT ROUNDED =
  2292        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2293        * WS-MONTH / 3) - (CP-ORIGINAL-PREMIUM -
  2294        CP-1ST-YR-ALLOW - CP-DDF-YR1AF) * (1 - CP-DDF-HI-FACT)
  2295        * WS-MONTH / 12
  2296     .
  2297 1160-UE-GROSS-LT-13.
  2298     MOVE 3                      TO WS-MONTH
  2299     PERFORM 1150-UE-GROSS-LT-4
  2300     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2301     MOVE CP-MONTH               TO WS-MONTH
  2302     COMPUTE WS-TEMP-RESULT ROUNDED = WS-GFR3 - (WS-GFR3
  2303        - (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF)
  2304        * (CP-DDF-HI-FACT)) * ((WS-MONTH - 3) / 9)
  2305     .
  2306 1170-UE-GROSS-GT-12.
  2307*****  (GF-Yr1 Texp) * {UEF1 - (UEF1 -UEF2)*mo/12}
  2308     COMPUTE WS-TEMP-RESULT ROUNDED =
  2309        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW)
  2310        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2311        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2312     .
  2313 1200-IU-UE-CLP-LT-4.
  2314*****  no changes with < 4  pema 08/03/11
  2315*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*mo/12)
  2316     COMPUTE WS-TEMP-RESULT ROUNDED =
  2317        (CP-DDF-CLP - 0)
  2318        - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2319        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2320        * WS-MONTH / 12
  2321     .
  2322 1210-IU-UE-CLP-LT-13.
  2323*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2324*****  -[(CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2325*****  - CLP*UEF1]*(mo-3)/9
  2326     MOVE 3                      TO WS-MONTH
  2327     PERFORM 1200-IU-UE-CLP-LT-4
  2328     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2329     MOVE CP-MONTH               TO WS-MONTH
  2330     COMPUTE WS-TEMP-RESULT ROUNDED =
  2331        WS-UE-CLP - (WS-UE-CLP - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2332          * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2333     .
  2334 1220-IU-UE-CLP-GT-12.
  2335*****  CLP*{UEF1 - (UEF1 -UEF2)*mo/12}
  2336     COMPUTE WS-TEMP-RESULT ROUNDED =
  2337        (CP-DDF-CLP - CP-CLP-RATE-UP)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  45
* ELRFND.cbl
  2338        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2339        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2340     .
  2341 1250-IU-UE-GROSS-LT-4.
  2342*****  (Comm+MngtFee)*UECLPmo/CLPCounty+CLPCounty+AdminFee-
  2343*****  Yr1 AF*(mo/3)-[CLP*(UEF1-UEF2)+(AdminFee-Yr1AF)*
  2344*****  (1-UEF1)]*mo/12
  2345     PERFORM 1200-IU-UE-CLP-LT-4
  2346     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2347     COMPUTE WS-TEMP-RESULT = CP-DDF-COMM-AND-MFEE *
  2348        WS-UE-CLP / CP-DDF-CLP + CP-DDF-CLP +
  2349        CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF *
  2350        WS-MONTH / 3 - ((CP-DDF-CLP - CP-CLP-RATE-UP)
  2351        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2352        + (CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF)
  2353        * (1 - CP-DDF-HI-FACT)) * WS-MONTH / 12
  2354     .
  2355 1260-IU-UE-GROSS-LT-13.
  2356***** uegf3-(uegf3-(gf - 1st yr - clprateu)*hi))*(mo-3)/9
  2357     MOVE 3                      TO WS-MONTH
  2358     PERFORM 1250-IU-UE-GROSS-LT-4
  2359     move cp-month               to ws-month
  2360     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2361     COMPUTE WS-TEMP-RESULT ROUNDED =
  2362        WS-GFR3 - (WS-GFR3 - ((CP-ORIGINAL-PREMIUM
  2363        - CP-1ST-YR-ALLOW - cp-clp-rate-up))
  2364        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2365     .
  2366 1270-IU-UE-GROSS-GT-12.
  2367***** (gf - 1st yr - clprateu)*(hi-(hi-lo)*mo/12)
  2368     COMPUTE WS-TEMP-RESULT ROUNDED =
  2369        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW
  2370        - CP-CLP-RATE-UP) *
  2371        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2372        * WS-MONTH / 12)
  2373     .
  2374 1299-END-DDF-CALCS.
  2375     .
  2376 1999-CALC-REF-AMT-X.
  2377
  2378     MOVE CALCULATION-PASS-AREA TO DFHCOMMAREA.
  2379
  2380
  2381* EXEC CICS RETURN
  2382*    END-EXEC.
  2383*    MOVE '.(                    ''   #00002376' TO DFHEIV0
  2384     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2385     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2386     MOVE X'2020233030303032333736' TO DFHEIV0(25:11)
  2387     CALL 'kxdfhei1' USING DFHEIV0,
  2388           DFHEIV99,
  2389           DFHEIV99,
  2390           DFHEIV99,
  2391           DFHEIV99,
  2392           DFHEIV99,
  2393           DFHEIV99
  2394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2395
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  46
* ELRFND.cbl
  2396
  2397* GOBACK.
  2398     MOVE '9%                    "   ' TO DFHEIV0
  2399     MOVE 'ELRFND' TO DFHEIV1
  2400     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2401     GOBACK.
  2402
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  47
* ELRFND.cbl
  2404  2500-GET-RATE.
  2405
  2406* EXEC CICS LINK
  2407*        PROGRAM    ('ELRATE')
  2408*        COMMAREA   (CALCULATION-PASS-AREA)
  2409*        LENGTH     (CP-COMM-LENGTH)
  2410*        END-EXEC.
  2411     MOVE 'ELRATE' TO DFHEIV1
  2412*    MOVE '."C                   (   #00002382' TO DFHEIV0
  2413     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2415     MOVE X'2020233030303032333832' TO DFHEIV0(25:11)
  2416     CALL 'kxdfhei1' USING DFHEIV0,
  2417           DFHEIV1,
  2418           CALCULATION-PASS-AREA,
  2419           CP-COMM-LENGTH,
  2420           DFHEIV99,
  2421           DFHEIV99,
  2422           DFHEIV99,
  2423           DFHEIV99
  2424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2425
  2426
  2427  2500-EXIT.
  2428       EXIT.
  2429
  2430  9100-CONVERT-DATE.
  2431
  2432* EXEC CICS LINK
  2433*         PROGRAM   ('ELDATCV')
  2434*         COMMAREA  (DATE-CONVERSION-DATA)
  2435*         LENGTH    (DC-COMM-LENGTH)
  2436*    END-EXEC.
  2437     MOVE 'ELDATCV' TO DFHEIV1
  2438*    MOVE '."C                   (   #00002392' TO DFHEIV0
  2439     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2440     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2441     MOVE X'2020233030303032333932' TO DFHEIV0(25:11)
  2442     CALL 'kxdfhei1' USING DFHEIV0,
  2443           DFHEIV1,
  2444           DATE-CONVERSION-DATA,
  2445           DC-COMM-LENGTH,
  2446           DFHEIV99,
  2447           DFHEIV99,
  2448           DFHEIV99,
  2449           DFHEIV99
  2450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2451
  2452
  2453  9100-EXIT.
  2454       EXIT.
  2455
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  48
* ELRFND.cbl
  2457  10000-NET-TERM  SECTION.
  2458*                      COPY ERCNETP.
  2459*****************************************************************
  2460*                                                               *
  2461*                            ERCNETP                            *
  2462*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2463*                            VMOD=2.029                         *
  2464*                                                               *
  2465*****************************************************************.
  2466*
  2467*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  2468*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  2469*                                   ORIGINAL TERM (S999)
  2470*                                   REMAINING TERM (S999)
  2471*                                   NET PAY OPTION (X)
  2472*                                   LOAN TERM (S999)
  2473*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  2474*
  2475*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  2476*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  2477*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  2478*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  2479*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  2480*    CHARGED.
  2481*
  2482*    OPTIONS - S = NET SIMPLE
  2483*          SPACE = NET PAY  (1 MO. INTEREST)
  2484*              A = NET PAY  (0 MO. INTEREST)
  2485*              I = NET PAY  (2 MO. INTEREST)
  2486*              J = NET PAY  (3 MO. INTEREST)
  2487*              K = NET PAY  (4 MO. INTEREST)
  2488*              T = TRUNCATED  (0 MO. INTEREST)
  2489*              U = TRUNCATED  (1 MO. INTEREST)
  2490*              V = TRUNCATED  (2 MO. INTEREST)
  2491*              W = TRUNCATED  (3 MO. INTEREST)
  2492*              X = TRUNCATED  (4 MO. INTEREST)
  2493*              R = REFUNDS (REGULAR OR TRUNCATED)
  2494******************************************************************
  2495*                   C H A N G E   L O G
  2496*
  2497* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2498*-----------------------------------------------------------------
  2499*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2500* EFFECTIVE    NUMBER
  2501*-----------------------------------------------------------------
  2502* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  2503* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  2504* 120403                   PEMA  ADD SPECIAL TX CALC
  2505* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2506* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2507* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  2508* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  2509* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  2510* 021207                   PEMA  ADD PA NP
  2511* 022107                   PEMA  ADD NH NP AND NP TRUNC
  2512* 032807                   PEMA  ADD VT NP PLUS 2
  2513* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  2514* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  49
* ELRFND.cbl
  2515* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  2516* 110207      TO 'AL' NET PAY CALC
  2517* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  2518* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  2519* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  2520* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  2521* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  2522* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  2523* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  2524* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2525* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  2526* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2527* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  2528* 032612  CR2011110200001  PEMA  AHL CHANGES
  2529* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  2530* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  2531* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  2532******************************************************************
  2533
  2534     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  2535     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  2536     MOVE N-P-LOAN    TO LOAN-TERM.
  2537     MOVE N-P-REM     TO REMAINING-TERM.
  2538     MOVE N-P-OPT     TO OPTION-SW.
  2539
  2540     MOVE +0 TO FACTOR.
  2541     if cp-company-id = 'CID'
  2542        if annual-int-rate = +99.9999
  2543           go to 99000-error
  2544        end-if
  2545     else
  2546        if annual-int-rate = zero
  2547           go to 99000-error
  2548        end-if
  2549     end-if
  2550     IF ORIGINAL-TERM = ZERO
  2551         GO TO 99999-RETURN.
  2552     IF REMAINING-TERM = ZERO
  2553         GO TO 99999-RETURN.
  2554     IF REMAINING-TERM GREATER ORIGINAL-TERM
  2555         GO TO 99000-ERROR.
  2556     IF LOAN-TERM = ZERO
  2557         GO TO 99999-RETURN.
  2558     IF LOAN-TERM LESS ORIGINAL-TERM
  2559         GO TO 99000-ERROR.
  2560
  2561*    IF ANNUAL-INT-RATE LESS +2
  2562*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2563*    IF ANNUAL-INT-RATE LESS +2
  2564*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2565*    IF ANNUAL-INT-RATE LESS +2
  2566*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2567
  2568     IF NPO-REFUND
  2569         MOVE '2' TO NP-PROCESS-SW
  2570       ELSE
  2571         IF ORIGINAL-TERM = REMAINING-TERM
  2572            MOVE '1'   TO NP-PROCESS-SW
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  50
* ELRFND.cbl
  2573           ELSE
  2574            MOVE '3'   TO NP-PROCESS-SW.
  2575
  2576     IF NPO-SIMPLE
  2577         MOVE 'S' TO TYPE-SW
  2578     ELSE
  2579         MOVE 'N' TO TYPE-SW.
  2580
  2581     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  2582     if i = zeros
  2583        move .0000000001         to i
  2584     end-if
  2585
  2586     COMPUTE V ROUNDED = K1 / (K1 + I).
  2587
  2588     MOVE V     TO VX
  2589                   SV.
  2590
  2591     MOVE +1    TO X1
  2592                   SX.
  2593
  2594     MOVE LOAN-TERM TO MAX-X.
  2595
  2596     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  2597
  2598     IF MAX-X = +1
  2599        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  2600
  2601     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  2602
  2603     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  2604         OR 'DCC'        OR 'NCL') AND
  2605        (NOT NP-REFUND)
  2606        NEXT SENTENCE
  2607     ELSE
  2608     IF LOAN-TERM NOT = ORIGINAL-TERM
  2609        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  2610
  2611     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  2612
  2613 10500-VX-LOOP.
  2614
  2615***  VX = AMORT. LOAN TERM.
  2616***  SV = AMORT. INSURANCE TERM.
  2617***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  2618***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  2619***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  2620
  2621     IF X2 = 1
  2622        MOVE V         TO SX
  2623     END-IF
  2624     COMPUTE VX ROUNDED = VX * V.
  2625
  2626     ADD B1 TO X1.
  2627
  2628     IF X1 = REMAINING-TERM
  2629          MOVE VX    TO SV.
  2630
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  51
* ELRFND.cbl
  2631     IF X1 EQUAL SV-MINUS-ONE
  2632        MOVE VX      TO SV-MINUS-ONE.
  2633
  2634     IF X1 = X2
  2635          MOVE VX    TO SX.
  2636
  2637     IF X1 NOT = MAX-X
  2638          GO TO 10500-VX-LOOP.
  2639
  2640 10700-COMPUTE-REMAINING-FACTOR.
  2641*****  WK1 = LOAN TERM AMORT
  2642     COMPUTE WK1 = K1 - VX.
  2643*****  WK2 = INS TERM AMORT
  2644     COMPUTE WK2 = K1 - SV.
  2645*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  2646     COMPUTE WK5 = K1 - SX.
  2647*****  WK6 = INS TERM - 1
  2648     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  2649
  2650     IF NP-RATING
  2651         GO TO 12000-PREMIUM-RATE.
  2652
  2653     IF NP-REFUND
  2654         GO TO 11000-REFUND-CALC.
  2655
  2656     IF NET-STD
  2657         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  2658
  2659     IF NET-SMP
  2660         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  2661         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  2662         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  2663         COMPUTE WK3 ROUNDED = WK3 * 1000.
  2664
  2665     IF REMAINING-TERM LESS THAN X2
  2666         MOVE +0 TO WK3.
  2667
  2668     MOVE WK3 TO FACTOR.
  2669
  2670     GO TO 99999-RETURN.
  2671
  2672 11000-REFUND-CALC.
  2673     IF REMAINING-TERM NOT LESS MAX-X
  2674        MOVE +1 TO FACTOR
  2675        GO TO 99999-RETURN.
  2676
  2677     IF REMAINING-TERM LESS +1
  2678        MOVE 0 TO FACTOR
  2679        GO TO 99999-RETURN.
  2680
  2681     COMPUTE WK2 ROUNDED = WK2 / I.
  2682     COMPUTE WK5 ROUNDED = WK5 / I.
  2683     COMPUTE WK1 ROUNDED = WK1 / I.
  2684
  2685     IF (CP-COMPANY-ID EQUAL 'CID')
  2686        AND (CP-STATE-STD-ABBRV = 'MN')
  2687        AND (CP-CERT-EFF-DT > X'A4FF')
  2688        AND (CP-RATE-AS-REG-BALLOON)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  52
* ELRFND.cbl
  2689        AND (CP-EARN-AS-NET-PAY)
  2690        AND (CP-DEVIATION-CODE NOT = 'LEV')
  2691        CONTINUE
  2692     ELSE
  2693        GO TO 11000-CHECK-MN-LEV-BALLOON
  2694     END-IF
  2695
  2696     COMPUTE R = M - E
  2697     COMPUTE FACTOR = (R - WK2 + WK5) /
  2698        (M - WK1 + WK5)
  2699
  2700     GO TO 99999-RETURN
  2701
  2702      .
  2703 11000-CHECK-MN-LEV-BALLOON.
  2704
  2705     IF (CP-COMPANY-ID EQUAL 'CID')
  2706        AND (CP-STATE-STD-ABBRV = 'MN')
  2707        AND (CP-CERT-EFF-DT > X'A4FF')
  2708        AND (CP-RATE-AS-REG-BALLOON)
  2709        AND (CP-EARN-AS-NET-PAY)
  2710        AND (CP-DEVIATION-CODE = 'LEV')
  2711        CONTINUE
  2712     ELSE
  2713        GO TO 11000-CONTINUE-REFUND
  2714     END-IF
  2715
  2716     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  2717     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  2718        ** (M - E)) / I
  2719
  2720     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  2721
  2722     GO TO 99999-RETURN
  2723
  2724     .
  2725 11000-CONTINUE-REFUND.
  2726*    IF CP-GAP-ACTUARIAL
  2727*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  2728*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2729*       COMPUTE WK3 = WK2 / ANGLEN
  2730*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  2731     IF CP-GAP-ACTUARIAL
  2732        COMPUTE ANGLEN = WK1 / ((1 + I) **
  2733           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2734        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  2735     ELSE
  2736        COMPUTE WK3 ROUNDED =
  2737          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  2738     END-IF
  2739
  2740     MOVE WK3  TO FACTOR.
  2741
  2742     GO TO 99999-RETURN.
  2743
  2744 12000-PREMIUM-RATE.
  2745*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  2746*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  53
* ELRFND.cbl
  2747*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  2748*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  2749*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  2750*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  2751
  2752     COMPUTE K-I = K1 + I.
  2753     MOVE K-I TO ONE-PLUS-I.
  2754
  2755     IF NPO-ALT OR NPO-TRUNC-0
  2756         MOVE K1 TO K-I.
  2757
  2758     IF NPO-2MO OR NPO-TRUNC-2
  2759         COMPUTE K-I = K1 + (2 * I).
  2760
  2761     IF NPO-3MO OR NPO-TRUNC-3
  2762         COMPUTE K-I = K1 + (3 * I).
  2763
  2764     IF NPO-4MO OR NPO-TRUNC-4
  2765         COMPUTE K-I = K1 + (4 * I).
  2766
  2767     COMPUTE RA ROUNDED = 1 -
  2768             ((X2 * (X2 + 1)) /
  2769              (N *  (N  + 1))).
  2770
  2771     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2772        (CP-CSL-VALID-NP-BENEFIT-CD)
  2773        NEXT SENTENCE
  2774     ELSE
  2775        GO TO XXXX-CHECK-DISCOUNT-5.
  2776
  2777     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2778     MOVE ' ' TO DC-OPTION-CODE.
  2779     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2780
  2781     IF DATE-CONVERSION-ERROR
  2782        MOVE '2'                 TO CP-RETURN-CODE
  2783        MOVE ZEROS               TO FACTOR
  2784                                    CP-CALC-PREMIUM
  2785         GO TO 99999-RETURN.
  2786
  2787     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  2788     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  2789     MOVE ' ' TO DC-OPTION-CODE
  2790     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2791
  2792     IF DATE-CONVERSION-ERROR
  2793        MOVE '2'                 TO CP-RETURN-CODE
  2794        MOVE ZEROS               TO FACTOR
  2795                                    CP-CALC-PREMIUM
  2796         GO TO 99999-RETURN.
  2797
  2798     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  2799
  2800     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  2801
  2802     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  2803        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  2804        CP-PAY-FREQUENCY / 365) * I
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  54
* ELRFND.cbl
  2805     ELSE
  2806        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  2807        CP-PAY-FREQUENCY / 365) * I.
  2808
  2809     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  2810     13).
  2811
  2812     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  2813     (N - ( ANGLEN-1 / WK3)).
  2814
  2815     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  2816
  2817     COMPUTE WS-CALC-FREQ-RATE EQUAL
  2818       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  2819
  2820     COMPUTE WS-Y-X-FACTOR EQUAL
  2821       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  2822       WS-CALC-FREQ-RATE).
  2823
  2824     COMPUTE WS-ODD-DAY-UNITS EQUAL
  2825       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  2826
  2827     COMPUTE WS-X-Y-FACTOR EQUAL
  2828       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  2829
  2830     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  2831       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  2832       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  2833
  2834     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  2835
  2836     GO TO 99999-RETURN.
  2837
  2838 XXXX-CHECK-DISCOUNT-5.
  2839
  2840     IF WS-DISCOUNT-OPTION EQUAL '5'
  2841        NEXT SENTENCE
  2842     ELSE
  2843        GO TO 12000-CHECK-CLIENT.
  2844
  2845      COMPUTE ANGLEN EQUAL WK1 / I.
  2846
  2847      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  2848
  2849      COMPUTE WK3 EQUAL
  2850        (12 *
  2851        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  2852        CP-ORIGINAL-BENEFIT)) /
  2853        APR100.
  2854
  2855     COMPUTE WK3 EQUAL
  2856        (WK3 * CP-PREMIUM-RATE) / +1000.
  2857
  2858     COMPUTE WK3 EQUAL
  2859        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  2860
  2861      MOVE WK3 TO CP-CALC-PREMIUM.
  2862
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  55
* ELRFND.cbl
  2863     GO TO 99999-RETURN.
  2864
  2865 12000-CHECK-CLIENT.
  2866
  2867     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2868        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2869        (CP-TRUNCATED-LIFE)
  2870        NEXT SENTENCE
  2871     ELSE
  2872        GO TO 12000-CHECK-NEXT.
  2873
  2874     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  2875
  2876     COMPUTE ANGLEN EQUAL WK1 / I.
  2877     COMPUTE ANGLEM EQUAL WK2 / I.
  2878
  2879     COMPUTE FM EQUAL
  2880                    (((ONE-PLUS-I ** M) * I * M) /
  2881                    ((ONE-PLUS-I ** M) - 1))
  2882                    - 1.
  2883
  2884     COMPUTE FN EQUAL
  2885                    (((ONE-PLUS-I ** N) * I * N) /
  2886                    ((ONE-PLUS-I ** N) - 1))
  2887                    - 1.
  2888
  2889     COMPUTE FNM EQUAL
  2890                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  2891                    ((ONE-PLUS-I ** (N - M)) - 1))
  2892                    - 1.
  2893
  2894     COMPUTE GR EQUAL
  2895                    (WS-WORK-RATE * ANGLEM * I) /
  2896                    (M - ANGLEM).
  2897
  2898     COMPUTE ODF EQUAL
  2899                     (1 +
  2900                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  2901                     360)) /
  2902                     ONE-PLUS-I.
  2903
  2904     COMPUTE OD EQUAL
  2905                    (1 + (ODF * (FN / I - 1))) +
  2906                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  2907
  2908     COMPUTE WK3 EQUAL
  2909*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  2910                    ((1 + FN) * ODF *
  2911                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  2912                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  2913                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  2914
  2915     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  2916     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  2917
  2918     COMPUTE WK3 EQUAL
  2919                    (WK3 / (ODF * (1 + FN))) -
  2920*                   CP-ORIGINAL-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  56
* ELRFND.cbl
  2921                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  2922
  2923      MOVE WK3 TO CP-CALC-PREMIUM.
  2924
  2925     GO TO 99999-RETURN.
  2926
  2927 12000-CHECK-NEXT.
  2928
  2929     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  2930        NEXT SENTENCE
  2931     ELSE
  2932        GO TO 12000-CHECK-PA-TRUNC.
  2933
  2934      IF WS-WORK-DIS-RATE EQUAL +0
  2935         MOVE '7'                TO CP-RETURN-CODE
  2936         MOVE ZEROS              TO FACTOR
  2937                                    CP-CALC-PREMIUM
  2938         GO TO 99999-RETURN.
  2939
  2940      COMPUTE ANGLEN EQUAL WK1 / I.
  2941
  2942      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  2943
  2944      IF WS-WORK-DIS-RATE EQUAL APR100
  2945         ADD .00001 TO APR100.
  2946
  2947      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  2948      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  2949
  2950     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  2951        / (1 + I)
  2952     COMPUTE ANGLEN-1 = ANGLEN / Y
  2953      IF CP-COMPANY-ID EQUAL 'CDL'
  2954         COMPUTE WK3 EQUAL
  2955
  2956          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  2957          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  2958
  2959          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  2960
  2961          ((WK8 ** N) /
  2962          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  2963
  2964          ((WK9 ** N) /
  2965          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  2966
  2967      ELSE
  2968         COMPUTE WK3 EQUAL
  2969
  2970          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  2971          (12 + WS-WORK-DIS-RATE) * 12) *
  2972
  2973          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  2974
  2975          ((WK8 ** N) /
  2976          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  2977
  2978          ((WK9 ** N) /
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  57
* ELRFND.cbl
  2979          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  2980
  2981      COMPUTE WK3 EQUAL
  2982          (WK3 * CP-PREMIUM-RATE) / +1000.
  2983
  2984      MOVE WK3 TO CP-CALC-PREMIUM.
  2985
  2986     GO TO 99999-RETURN.
  2987
  2988 12000-CHECK-PA-TRUNC.
  2989
  2990     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2991        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  2992        (CP-EARN-AS-NET-PAY) AND
  2993        (CP-TRUNCATED-LIFE)
  2994        NEXT SENTENCE
  2995     ELSE
  2996        GO TO 12000-CHECK-MD-TRUNC.
  2997
  2998     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  2999
  3000     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3001     COMPUTE ANGLEN EQUAL WK1 / I.
  3002
  3003     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3004
  3005     COMPUTE WK3 EQUAL
  3006        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  3007        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  3008
  3009     MOVE WK3 TO CP-CALC-PREMIUM.
  3010
  3011     GO TO 99999-RETURN.
  3012
  3013 12000-CHECK-MD-TRUNC.
  3014
  3015     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3016        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3017        (CP-EARN-AS-NET-PAY) AND
  3018        (CP-TRUNCATED-LIFE)
  3019        NEXT SENTENCE
  3020     ELSE
  3021        GO TO 12000-CHECK-MD.
  3022
  3023     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3024
  3025     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3026     COMPUTE ANGLEM EQUAL WK2 / I.
  3027     COMPUTE ANGLEN EQUAL WK1 / I.
  3028
  3029     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3030
  3031     COMPUTE WK3 EQUAL
  3032        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3033        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  3034        (ANGLEN-1 * (M - ANGLEM))).
  3035
  3036     MOVE WK3 TO CP-CALC-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  58
* ELRFND.cbl
  3037
  3038     GO TO 99999-RETURN.
  3039
  3040 12000-CHECK-MD.
  3041
  3042     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3043        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3044        (CP-EARN-AS-NET-PAY)
  3045        NEXT SENTENCE
  3046     ELSE
  3047        GO TO 12000-CHECK-ME-TRUNC.
  3048
  3049     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3050
  3051     COMPUTE WK3 EQUAL
  3052        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  3053
  3054     MOVE WK3 TO CP-CALC-PREMIUM.
  3055
  3056     GO TO 99999-RETURN.
  3057
  3058 12000-CHECK-ME-TRUNC.
  3059
  3060     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3061        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3062        AND (CP-EARN-AS-NET-PAY)
  3063        AND (CP-TRUNCATED-LIFE)
  3064        CONTINUE
  3065     ELSE
  3066        GO TO 12000-CHECK-CID-WA-FARMPLAN
  3067     END-IF
  3068
  3069     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3070     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3071     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3072     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3073     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3074     COMPUTE ANGLEN-1 = ANGLEN / Y
  3075     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3076     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3077     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3078     COMPUTE WK3
  3079        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3080        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3081            * (1 / (1.0635 ** (M / 12))))
  3082*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  3083*    COMPUTE WK9 EQUAL
  3084*       1 / (1 + (.045 * (N - M) / 24))
  3085*    COMPUTE WK7 EQUAL
  3086*       WS-WORK-RATE * 20 / (M + 1).
  3087*    COMPUTE WK3 EQUAL
  3088*       ((( N - ANGLEN) * WK7 * WK8) /
  3089*       (10 * ANGLEN-1 * I)) -
  3090*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  3091*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  3092*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3093*
  3094     MOVE WK3 TO CP-CALC-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  59
* ELRFND.cbl
  3095
  3096     GO TO 99999-RETURN
  3097      .
  3098 12000-CHECK-CID-WA-FARMPLAN.
  3099
  3100     IF (CP-COMPANY-ID EQUAL 'CID')
  3101        AND (CP-STATE-STD-ABBRV = 'WA')
  3102        AND (CP-FARM-PLAN)
  3103        CONTINUE
  3104     ELSE
  3105        GO TO 12000-CHECK-CID-FARMPLAN
  3106     END-IF
  3107
  3108     move cp-original-term       to n
  3109     move cp-no-of-pmts          TO C-TOT-PMTS
  3110     compute c-pmts-per-year = 12 / cp-pay-frequency
  3111     move cp-pay-frequency       to m
  3112     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  3113     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3114     if i = zeros
  3115        move .0000000001         to i
  3116     end-if
  3117     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  3118
  3119     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  3120        (m * 30))) / (1 + I)
  3121     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3122        ** CP-PAY-FREQUENCY) - 1
  3123     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  3124     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3125        ** TI) / WS-WORK-DIS-RATE
  3126     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  3127     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  3128     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3129        ** m) / WS-WORK-DIS-RATE
  3130     COMPUTE WK2 = WK2 * (1 + J)
  3131     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3132     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3133     COMPUTE WK3 = WK3 * (1 + J)
  3134     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  3135        ** (c-tot-pmts - 1))) / J
  3136     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3137        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  3138        (CP-PREMIUM-RATE / 1000)
  3139     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  3140     COMPUTE WK6 = (WK7 * GR)
  3141
  3142     MOVE WK6 TO CP-CALC-PREMIUM
  3143
  3144     GO TO 99999-RETURN
  3145
  3146     .
  3147 12000-CHECK-CID-FARMPLAN.
  3148     IF (CP-COMPANY-ID EQUAL 'CID')
  3149        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  3150           OR 'IN' OR 'AZ')
  3151        AND (CP-FARM-PLAN)
  3152        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  60
* ELRFND.cbl
  3153     ELSE
  3154        GO TO 12000-CHECK-SC-CID
  3155     END-IF
  3156     COMPUTE N = M / CP-PAY-FREQUENCY
  3157     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3158     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3159        ** CP-PAY-FREQUENCY) - 1
  3160     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  3161     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3162        ** TI) / WS-WORK-DIS-RATE
  3163     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  3164     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  3165     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3166        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  3167     COMPUTE WK2 = WK2 * (1 + J)
  3168     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3169     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3170     COMPUTE WK3 = WK3 * (1 + J)
  3171     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  3172        ** (N - 1))) / J
  3173     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3174        ((N * WK2) - WK5)) + (N * WK1)) *
  3175        (CP-PREMIUM-RATE / 1000)
  3176     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  3177     COMPUTE WK6 = (WK7 * GR)
  3178     MOVE WK6 TO CP-CALC-PREMIUM
  3179     GO TO 99999-RETURN
  3180     .
  3181 12000-CHECK-SC-CID.
  3182     IF (CP-COMPANY-ID = 'CID')
  3183        AND (CP-STATE-STD-ABBRV = 'SC')
  3184        AND (CP-EARN-AS-NET-PAY)
  3185        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  3186        move 6                   to ws-extra-pmts
  3187     ELSE
  3188        GO TO 12000-CHECK-AL-CID
  3189     END-IF
  3190     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3191     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3192     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3193        / 12)) / ((M + 1) / 2)
  3194
  3195     if i = .0000000001
  3196        compute wk4 = cp-original-benefit / n
  3197        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  3198            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  3199        display ' hit sc wo apr - wk2 ' wk2
  3200     else
  3201        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  3202        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3203        COMPUTE ANGLEN-1 = ANGLEN / Y
  3204        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3205        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3206           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  3207     end-if
  3208*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3209*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3210*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  61
* ELRFND.cbl
  3211*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3212*    COMPUTE ANGLEN-1 = ANGLEN / Y
  3213*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3214*       / 12)) / ((M + 1) / 2)
  3215*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3216*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3217*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  3218     MOVE WK3 TO CP-CALC-PREMIUM
  3219     GO TO 99999-RETURN
  3220     .
  3221 12000-CHECK-AL-CID.
  3222     IF (CP-COMPANY-ID EQUAL 'CID')
  3223        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  3224        AND (CP-EARN-AS-NET-PAY)
  3225        CONTINUE
  3226     ELSE
  3227        GO TO 12000-CHECK-NH-CID
  3228     END-IF
  3229     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3230     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3231     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3232     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3233                   / (1 + I)
  3234     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3235     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3236     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  3237        (CP-PREMIUM-RATE / 1000)
  3238     MOVE WK3 TO CP-CALC-PREMIUM
  3239     GO TO 99999-RETURN
  3240     .
  3241 12000-CHECK-NH-CID.
  3242     IF (CP-COMPANY-ID EQUAL 'CID')
  3243        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  3244        AND (CP-EARN-AS-NET-PAY)
  3245        CONTINUE
  3246     ELSE
  3247        GO TO 12000-CHECK-PA-CID
  3248     END-IF
  3249     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3250     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3251     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3252                   / (1 + I)
  3253     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3254     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3255     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3256        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  3257     MOVE WK3 TO CP-CALC-PREMIUM
  3258     GO TO 99999-RETURN
  3259     .
  3260 12000-CHECK-PA-CID.
  3261     IF (CP-COMPANY-ID EQUAL 'CID')
  3262        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  3263        AND (CP-EARN-AS-NET-PAY)
  3264        CONTINUE
  3265     ELSE
  3266        GO TO 12000-CHECK-ME-CID
  3267     END-IF
  3268
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  62
* ELRFND.cbl
  3269     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3270     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3271     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3272     COMPUTE ANGLEN-1 = ANGLEN / Y
  3273     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  3274     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3275     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  3276     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3277        * WK5
  3278     MOVE WK3 TO CP-CALC-PREMIUM
  3279     GO TO 99999-RETURN
  3280     .
  3281 12000-CHECK-ME-CID.
  3282     IF (CP-COMPANY-ID EQUAL 'CID')
  3283        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3284        AND (CP-EARN-AS-NET-PAY)
  3285        CONTINUE
  3286     ELSE
  3287        GO TO 12000-CHECK-VT-TRUNC
  3288     END-IF
  3289     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3290     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3291     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3292     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3293     COMPUTE ANGLEN-1 = ANGLEN / Y
  3294     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3295     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3296     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3297        * WK5
  3298     MOVE WK3 TO CP-CALC-PREMIUM
  3299     GO TO 99999-RETURN
  3300     .
  3301 12000-CHECK-VT-TRUNC.
  3302
  3303     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3304        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  3305        (CP-EARN-AS-NET-PAY) AND
  3306        (CP-TRUNCATED-LIFE)
  3307        NEXT SENTENCE
  3308     ELSE
  3309        GO TO 12000-CHECK-VT.
  3310
  3311      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  3312
  3313      COMPUTE ANGLEN EQUAL WK1 / I.
  3314
  3315      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3316
  3317      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  3318      COMPUTE WK9 EQUAL
  3319        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  3320        ((.0054 - I) / (1 + I)).
  3321      COMPUTE WK7 EQUAL
  3322        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  3323      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3324        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  3325
  3326      MOVE WK3 TO CP-CALC-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  63
* ELRFND.cbl
  3327
  3328     GO TO 99999-RETURN.
  3329
  3330 12000-CHECK-VT.
  3331
  3332     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3333        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  3334        (CP-EARN-AS-NET-PAY)
  3335        NEXT SENTENCE
  3336     ELSE
  3337        GO TO 12000-CHECK-MINN-WDS.
  3338
  3339      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  3340
  3341      COMPUTE ANGLEN EQUAL WK1 / I.
  3342
  3343      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3344
  3345      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  3346                        (ANGLEN-1 * I)) *
  3347
  3348                        (((1.0054 ** N - 1) /
  3349                        (1.0054 ** (N - 1) * .0054)) -
  3350
  3351                        ((V * (1 - 1.0054 ** N * VX)) /
  3352                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  3353
  3354      MOVE WK3 TO CP-CALC-PREMIUM.
  3355
  3356     GO TO 99999-RETURN.
  3357
  3358 12000-CHECK-MINN-WDS.
  3359
  3360     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3361        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3362        (CP-EARN-AS-NET-PAY)
  3363        NEXT SENTENCE
  3364     ELSE
  3365        GO TO 12000-CHECK-MINN-BALL-LEV.
  3366
  3367     COMPUTE ANGLEN EQUAL WK1 / I.
  3368     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  3369              (N / +12) * (2 / (N + 1)).
  3370     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  3371         WK3 * ((N - ANGLEN) / I).
  3372
  3373      MOVE WK3 TO CP-CALC-PREMIUM.
  3374
  3375     GO TO 99999-RETURN.
  3376
  3377 12000-CHECK-MINN-BALL-LEV.
  3378
  3379     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3380        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3381        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  3382        (CP-EARN-AS-REG-BALLOON)
  3383        NEXT SENTENCE
  3384     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  64
* ELRFND.cbl
  3385        GO TO 12000-CHECK-MINN-BALL.
  3386
  3387     COMPUTE ANGLEN EQUAL WK1 / I.
  3388
  3389     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  3390
  3391     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  3392        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  3393
  3394     MOVE WK3 TO CP-CALC-PREMIUM.
  3395
  3396     GO TO 99999-RETURN.
  3397
  3398 12000-CHECK-MINN-BALL.
  3399
  3400     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3401        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3402        (CP-EARN-AS-REG-BALLOON)
  3403        NEXT SENTENCE
  3404     ELSE
  3405        GO TO 12000-CHECK-CID-MN-BALL.
  3406
  3407     COMPUTE ANGLEN EQUAL WK1 / I.
  3408     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  3409
  3410     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  3411     / +100 * (N - 1) / 12 * 2 / N *
  3412     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  3413
  3414      MOVE WK3 TO CP-CALC-PREMIUM.
  3415
  3416     GO TO 99999-RETURN.
  3417
  3418 12000-CHECK-CID-MN-BALL.
  3419     IF (CP-COMPANY-ID EQUAL 'CID')
  3420        AND (CP-STATE-STD-ABBRV = 'MN')
  3421        AND (CP-CERT-EFF-DT > X'A4FF')
  3422        AND (CP-EARN-AS-REG-BALLOON)
  3423        CONTINUE
  3424     ELSE
  3425        GO TO 12000-CHECK-CID-MN-FARM
  3426     END-IF
  3427     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3428     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3429     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  3430     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3431     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3432     COMPUTE V = 1 / (1 + I)
  3433     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3434     COMPUTE Y = (1 + (D * I) / +30)
  3435        / (1 + I)
  3436     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  3437        * CP-PREMIUM-RATE / 1000
  3438*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  3439*       MOVE CP-MONTHLY-PAYMENT  TO GR
  3440*    ELSE
  3441*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  3442*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  65
* ELRFND.cbl
  3443*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  3444*       DISPLAY ' BALLOON TOP ' WK6
  3445*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  3446*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  3447*          / 100
  3448*       DISPLAY ' BALLOON BOTTOM ' WK7
  3449*       COMPUTE GR = WK6 / WK7
  3450*       DISPLAY ' BALLOON PAYMENT ' GR
  3451*    END-IF
  3452     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  3453     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  3454        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  3455     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  3456     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  3457        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  3458           (CP-ALTERNATE-BENEFIT * (M + 1)))
  3459           * CP-PREMIUM-RATE / 1000
  3460     MOVE WK3                    TO CP-CALC-PREMIUM
  3461     GO TO 99999-RETURN.
  3462     .
  3463 12000-CHECK-CID-MN-FARM.
  3464
  3465     IF (CP-COMPANY-ID EQUAL 'CID')
  3466        AND (CP-STATE-STD-ABBRV = 'MN')
  3467        AND (CP-CERT-EFF-DT > X'A4FF')
  3468        AND (CP-EARN-AS-FARM-PLAN)
  3469        CONTINUE
  3470     ELSE
  3471        GO TO 12000-CHECK-NC-WDS
  3472     END-IF
  3473
  3474     EVALUATE CP-PMT-MODE
  3475        WHEN 'B'
  3476           MOVE +14              TO C-DAYS-IN-PMT-PER
  3477           MOVE +26              TO C-PMTS-PER-YEAR
  3478           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3479        WHEN 'S'
  3480           MOVE +15              TO C-DAYS-IN-PMT-PER
  3481           MOVE +24              TO C-PMTS-PER-YEAR
  3482           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3483        WHEN 'T'
  3484           MOVE +360             TO C-DAYS-IN-PMT-PER
  3485           MOVE +1               TO C-PMTS-PER-YEAR
  3486           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3487        WHEN 'W'
  3488           MOVE +7               TO C-DAYS-IN-PMT-PER
  3489           MOVE +52              TO C-PMTS-PER-YEAR
  3490           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3491        WHEN 'B'
  3492           MOVE +14              TO C-DAYS-IN-PMT-PER
  3493           MOVE +26              TO C-PMTS-PER-YEAR
  3494           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3495        WHEN OTHER
  3496           move cp-no-of-pmts    to c-tot-pmts
  3497           if cp-pay-frequency > zeros
  3498              compute c-pmts-per-year =
  3499                 12 / cp-pay-frequency
  3500              compute c-days-in-pmt-per = 360 / c-pmts-per-year
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  66
* ELRFND.cbl
  3501           else
  3502              MOVE +30           TO C-DAYS-IN-PMT-PER
  3503              MOVE +12           TO C-PMTS-PER-YEAR
  3504              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  3505           end-if
  3506     END-EVALUATE
  3507
  3508     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3509     if i = zeros
  3510        move .0000000001         to i
  3511     end-if
  3512
  3513     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3514        C-DAYS-IN-PMT-PER)) / (1 + I)
  3515
  3516     compute cp-premium-rate =
  3517        cp-premium-rate * 12 / c-pmts-per-year
  3518     move c-tot-pmts to n m
  3519     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3520     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3521     COMPUTE ANGLEN-1 = ANGLEN / Y
  3522     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3523
  3524     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  3525        (cp-premium-rate / 100)
  3526
  3527
  3528     MOVE WK3                    TO CP-CALC-PREMIUM
  3529
  3530     GO TO 99999-RETURN.
  3531
  3532     .
  3533 12000-CHECK-NC-WDS.
  3534
  3535     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3536        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3537        (CP-EARN-AS-NET-PAY)
  3538        NEXT SENTENCE
  3539     ELSE
  3540        GO TO 12000-CHECK-NC-BALL-LEV.
  3541
  3542     COMPUTE WK4 EQUAL N * (1 + I * 2).
  3543     COMPUTE ANGLEN EQUAL WK1 / I.
  3544     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  3545              CP-PREMIUM-RATE / +100 *
  3546              N / +12 * 2 / (N + 1) *
  3547              (WK4 - ANGLEN) / (I * ANGLEN).
  3548
  3549      MOVE WK3 TO CP-CALC-PREMIUM.
  3550
  3551     GO TO 99999-RETURN.
  3552
  3553 12000-CHECK-NC-BALL-LEV.
  3554
  3555     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3556        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3557        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  3558        (CP-EARN-AS-REG-BALLOON)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  67
* ELRFND.cbl
  3559        NEXT SENTENCE
  3560     ELSE
  3561        GO TO 12000-CHECK-NC-BALL.
  3562
  3563     COMPUTE ANGLEN EQUAL WK1 / I.
  3564
  3565**** VX = 1 / (1 + I)**N.
  3566
  3567     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  3568        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  3569
  3570     MOVE WK3 TO CP-CALC-PREMIUM.
  3571
  3572     GO TO 99999-RETURN.
  3573
  3574 12000-CHECK-NC-BALL.
  3575
  3576     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3577        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3578        (CP-EARN-AS-REG-BALLOON)
  3579        NEXT SENTENCE
  3580     ELSE
  3581        GO TO 12000-CHECK-MINN-TRUNC.
  3582
  3583     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  3584     COMPUTE ANGLEN EQUAL WK1 / I.
  3585     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  3586**** VX = 1 / (1 + I)**N.
  3587
  3588     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  3589     / +100 * (N - 1) / 12 * 2 / N *
  3590     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  3591
  3592      MOVE WK3 TO CP-CALC-PREMIUM.
  3593
  3594     GO TO 99999-RETURN.
  3595
  3596 12000-CHECK-MINN-TRUNC.
  3597
  3598     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3599        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3600        (M GREATER THAN +63) AND
  3601        (CP-EARN-AS-NET-PAY) AND
  3602        (CP-TRUNCATED-LIFE)
  3603        NEXT SENTENCE
  3604     ELSE
  3605        GO TO 12000-CHECK-MINN.
  3606
  3607      COMPUTE ANGLEN EQUAL WK1 / I.
  3608      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3609
  3610      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3611
  3612      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3613       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3614       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  3615
  3616      MOVE WK3 TO CP-CALC-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  68
* ELRFND.cbl
  3617
  3618     GO TO 99999-RETURN.
  3619
  3620 12000-CHECK-MINN.
  3621
  3622     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3623        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3624        (M GREATER THAN +63) AND
  3625        (CP-EARN-AS-NET-PAY)
  3626        NEXT SENTENCE
  3627     ELSE
  3628        GO TO 12000-CHECK-MONTANA-TRUNC.
  3629
  3630      COMPUTE ANGLEN EQUAL WK1 / I.
  3631
  3632      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3633
  3634      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3635       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3636       (((N - ANGLEN) / I) + (2 * N)).
  3637
  3638      MOVE WK3 TO CP-CALC-PREMIUM.
  3639
  3640     GO TO 99999-RETURN.
  3641
  3642 12000-CHECK-MONTANA-TRUNC.
  3643
  3644     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3645        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  3646        (M GREATER THAN +63) AND
  3647        (CP-EARN-AS-NET-PAY) AND
  3648        (CP-TRUNCATED-LIFE)
  3649        NEXT SENTENCE
  3650     ELSE
  3651        GO TO 12000-CHECK-MONTANA.
  3652
  3653      COMPUTE ANGLEN EQUAL WK1 / I.
  3654      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3655
  3656      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3657
  3658      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  3659      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3660       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  3661
  3662      MOVE WK3 TO CP-CALC-PREMIUM.
  3663
  3664     GO TO 99999-RETURN.
  3665
  3666 12000-CHECK-MONTANA.
  3667
  3668     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3669        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  3670        (M GREATER THAN +63) AND
  3671        (CP-EARN-AS-NET-PAY)
  3672        NEXT SENTENCE
  3673     ELSE
  3674        GO TO 12001-CONTINUE-NCL-TRUNC.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  69
* ELRFND.cbl
  3675
  3676      COMPUTE ANGLEN EQUAL WK1 / I.
  3677
  3678      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3679
  3680      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3681       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3682       (((N - ANGLEN) / I) + (4 * N)).
  3683
  3684      MOVE WK3 TO CP-CALC-PREMIUM.
  3685
  3686     GO TO 99999-RETURN.
  3687
  3688 12001-CONTINUE-NCL-TRUNC.
  3689
  3690     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3691        (CP-EARN-AS-NET-PAY) AND
  3692        (CP-TRUNCATED-LIFE)
  3693        NEXT SENTENCE
  3694     ELSE
  3695        GO TO 12001-CONTINUE-NCL.
  3696
  3697      COMPUTE ANGLEN EQUAL WK1 / I.
  3698      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3699
  3700      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3701
  3702      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  3703      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  3704      (ANGLEN-1 * (N + 1) * I).
  3705
  3706      MOVE WK3 TO CP-CALC-PREMIUM.
  3707
  3708     GO TO 99999-RETURN.
  3709
  3710 12001-CONTINUE-NCL.
  3711
  3712     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3713        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3714        (CP-EARN-AS-NET-PAY)
  3715        GO TO 12001-CHECK-NC-NET-PLUS3.
  3716
  3717     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3718        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  3719        (CP-EARN-AS-NET-PAY)
  3720        GO TO 12001-CHECK-CA.
  3721
  3722     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3723        (CP-EARN-AS-NET-PAY)
  3724        NEXT SENTENCE
  3725     ELSE
  3726        GO TO 12000-CONTINUE-NET.
  3727
  3728      COMPUTE ANGLEN EQUAL WK1 / I.
  3729      MOVE ANGLEN                TO ANGLEN-1.
  3730
  3731      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3732
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  70
* ELRFND.cbl
  3733      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3734       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3735       ((N - ANGLEN) / I).
  3736
  3737      MOVE WK3 TO CP-CALC-PREMIUM.
  3738
  3739     GO TO 99999-RETURN.
  3740
  3741 12000-CONTINUE-NET.
  3742
  3743     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  3744        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  3745        (CP-EARN-AS-NET-PAY)
  3746        NEXT SENTENCE
  3747     ELSE
  3748        GO TO 12001-CONTINUE-MINN.
  3749
  3750      COMPUTE ANGLEN EQUAL WK6 / I.
  3751      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  3752
  3753      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  3754      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  3755      COMPUTE WK3 EQUAL (WK3 / I) *
  3756       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  3757
  3758      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  3759         MOVE +0 TO CP-R-MAX-TOT-BEN.
  3760
  3761      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  3762
  3763      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  3764         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  3765         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  3766
  3767      MOVE WK3 TO CP-CALC-PREMIUM.
  3768
  3769     GO TO 99999-RETURN.
  3770
  3771 12001-CONTINUE-MINN.
  3772
  3773     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3774        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  3775        (CP-TRUNCATED-LIFE)
  3776        NEXT SENTENCE
  3777     ELSE
  3778        GO TO 12001-CHECK-RI-GTL.
  3779
  3780      COMPUTE ANGLEN EQUAL WK1 / I.
  3781      COMPUTE ANGLEM EQUAL WK2 / I.
  3782
  3783      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  3784       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  3785       * M / 2400) * 1000 + .5) / 1000000.
  3786
  3787      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  3788       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  3789
  3790     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  71
* ELRFND.cbl
  3791
  3792 12001-CHECK-RI-GTL.
  3793
  3794     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3795        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  3796        (CP-EARN-AS-NET-PAY)
  3797        NEXT SENTENCE
  3798     ELSE
  3799        GO TO 12001-CHECK-RI-LEASE-GTL.
  3800
  3801      COMPUTE ANGLEN EQUAL WK1 / I.
  3802*     COMPUTE ANGLEM EQUAL WK2 / I.
  3803
  3804      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  3805               (1 + WS-WORK-DIS-RATE * N).
  3806      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  3807         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  3808
  3809
  3810     GO TO 99999-RETURN.
  3811
  3812 12001-CHECK-RI-LEASE-GTL.
  3813
  3814     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3815        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  3816        (CP-SPECIAL-CALC-CD EQUAL 'H')
  3817        NEXT SENTENCE
  3818     ELSE
  3819        GO TO 12001-CHECK-OR-GTL.
  3820
  3821     COMPUTE ANGLEN EQUAL WK1 / I.
  3822
  3823     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  3824        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  3825                        /
  3826        (1000 * I * (1 + .0021 * N)).
  3827     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  3828       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  3829                            /
  3830       (1000 * (1 + .0027 * (N + 1))).
  3831
  3832     GO TO 99999-RETURN.
  3833
  3834 12001-CHECK-OR-GTL.
  3835
  3836     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3837        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  3838        (CP-EARN-AS-NET-PAY)
  3839        NEXT SENTENCE
  3840     ELSE
  3841        GO TO 12001-CHECK-GA-GTL.
  3842
  3843     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3844     COMPUTE ANGLEN EQUAL WK1 / I.
  3845
  3846     IF M LESS THAN +64
  3847        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  3848         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  72
* ELRFND.cbl
  3849                   /
  3850         (I * ANGLEN * (N - (N - M) + 1) * 600)
  3851        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  3852     ELSE
  3853        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  3854        CP-PREMIUM-RATE * (1 + I))
  3855                  /
  3856        (+1000 * I * ANGLEN)
  3857        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3858*    MOVE WK3 TO CP-CALC-PREMIUM.
  3859     GO TO 99999-RETURN.
  3860
  3861 12001-CHECK-GA-GTL.
  3862
  3863     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3864        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  3865        (CP-EARN-AS-NET-PAY)
  3866*       (CP-TRUNCATED-LIFE)
  3867        NEXT SENTENCE
  3868     ELSE
  3869        GO TO 12001-CHECK-MA-GTL.
  3870
  3871     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3872     COMPUTE ANGLEN EQUAL WK1 / I.
  3873
  3874     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  3875     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  3876      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  3877     MOVE WK3 TO CP-CALC-PREMIUM.
  3878
  3879     GO TO 99999-RETURN.
  3880
  3881 12001-CHECK-MA-GTL.
  3882
  3883     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3884        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  3885        (CP-EARN-AS-NET-PAY) AND
  3886        (CP-SPECIAL-CALC-CD EQUAL 'H')
  3887        NEXT SENTENCE
  3888     ELSE
  3889        GO TO 12001-CHECK-NV-NET.
  3890
  3891     COMPUTE ANGLEN EQUAL WK1 / I.
  3892
  3893     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  3894      CP-ALTERNATE-BENEFIT * N.
  3895
  3896     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  3897     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  3898
  3899     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  3900     WK7 * (N - ANGLEN) / I.
  3901     MOVE WK3 TO CP-CALC-PREMIUM.
  3902
  3903     GO TO 99999-RETURN.
  3904
  3905 12001-CHECK-NV-NET.
  3906     IF (CP-COMPANY-ID EQUAL 'CID')
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  73
* ELRFND.cbl
  3907        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  3908        AND (CP-EARN-AS-NET-PAY)
  3909        CONTINUE
  3910     ELSE
  3911        GO TO 12001-CHECK-MN-NET
  3912     END-IF
  3913     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3914     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3915     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3916                   / (1 + I)
  3917     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3918     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3919     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3920        (CP-PREMIUM-RATE * K-I / 1000)
  3921     MOVE WK3                    TO CP-CALC-PREMIUM
  3922     GO TO 99999-RETURN
  3923      .
  3924 12001-CHECK-MN-NET.
  3925     IF (CP-COMPANY-ID EQUAL 'CID')
  3926        AND (CP-STATE-STD-ABBRV = 'MN')
  3927        AND (CP-EARN-AS-NET-PAY)
  3928        AND (NOT CP-LEVEL-LIFE)
  3929        AND (WS-DISCOUNT-OPTION = '1')
  3930        CONTINUE
  3931     ELSE
  3932        GO TO 12001-CHECK-NC-NET
  3933     END-IF
  3934     if i = .0000000001
  3935        compute wk4 = cp-original-benefit / n
  3936        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  3937           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  3938        move wk3 to cp-calc-premium
  3939        go to 99999-return
  3940     end-if
  3941     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3942     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3943     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3944                   / (1 + I)
  3945     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3946     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3947     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3948        (CP-PREMIUM-RATE / 1000) * (1 + I)
  3949     MOVE WK3                    TO CP-CALC-PREMIUM
  3950     GO TO 99999-RETURN
  3951      .
  3952 12001-CHECK-NC-NET.
  3953
  3954     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  3955        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3956        (CP-EARN-AS-NET-PAY)
  3957        NEXT SENTENCE
  3958     ELSE
  3959        GO TO 12001-CHECK-NC-NET-PLUS3.
  3960
  3961      COMPUTE ANGLEN EQUAL WK1 / I.
  3962      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3963
  3964      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  74
* ELRFND.cbl
  3965          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  3966          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  3967          N * (CP-PREMIUM-RATE / 1000)).
  3968
  3969      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  3970          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  3971
  3972      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  3973          ((N - ANGLEN) / I + 3) / ANGLEN) /
  3974          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  3975          (ANGLEN * 2))
  3976
  3977      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  3978
  3979      IF ANGLEN IS NOT LESS THAN WK7
  3980          COMPUTE CP-PREMIUM-RATE ROUNDED =
  3981              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  3982          COMPUTE WK3 ROUNDED =
  3983              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  3984
  3985     MOVE WK3 TO CP-CALC-PREMIUM.
  3986
  3987     GO TO 99999-RETURN.
  3988
  3989 12001-CHECK-NC-NET-PLUS3.
  3990
  3991     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3992        (CP-EARN-AS-NET-PAY) AND
  3993        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL')
  3994        NEXT SENTENCE
  3995     ELSE
  3996        GO TO 12001-CHECK-CA.
  3997
  3998     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3999     MOVE ' ' TO DC-OPTION-CODE.
  4000     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  4001
  4002     IF DATE-CONVERSION-ERROR
  4003        MOVE '2'                 TO CP-RETURN-CODE
  4004        MOVE ZEROS               TO FACTOR
  4005                                    CP-CALC-PREMIUM
  4006         GO TO 99999-RETURN.
  4007
  4008     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  4009        NEXT SENTENCE
  4010     ELSE
  4011        GO TO 12001-CONTINUE-NET.
  4012
  4013     COMPUTE ANGLEN EQUAL WK1 / I.
  4014     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4015
  4016     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  4017
  4018     COMPUTE NC-R = 20 *
  4019                    ((NC-LR * ORIGINAL-TERM) / 12)
  4020                          / (ORIGINAL-TERM + 1).
  4021
  4022     COMPUTE NC-OB = NC-R / 1000.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  75
* ELRFND.cbl
  4023
  4024     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  4025                    (NC-OB * ORIGINAL-TERM * 3).
  4026
  4027     IF CP-EXT-CHG-LF
  4028         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  4029     ELSE
  4030         MOVE 30                 TO  NC-BIG-D.
  4031
  4032     COMPUTE NC-LITTLE-D = (1 + I) /
  4033             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  4034
  4035     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  4036             (ANGLEN * NC-LITTLE-D ).
  4037
  4038     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  4039
  4040     GO TO 99999-RETURN.
  4041
  4042 12001-CHECK-CA.
  4043
  4044     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4045        (WS-DISCOUNT-OPTION = '6')
  4046        NEXT SENTENCE
  4047     ELSE
  4048        GO TO 12001-CHECK-GTL-IA.
  4049
  4050     COMPUTE CA-J = CA-DISCOUNT / 12.
  4051     COMPUTE ANGLEN EQUAL WK1 / I.
  4052     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  4053     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  4054     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  4055     COMPUTE CA-VI = (1 + I)** -1.
  4056     COMPUTE CP-CALC-PREMIUM =
  4057         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  4058         ((1 + CA-J) / I) *
  4059         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  4060         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  4061         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  4062
  4063     GO TO 99999-RETURN.
  4064
  4065 12001-CHECK-GTL-IA.
  4066
  4067     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  4068        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  4069        (CP-EARN-AS-NET-PAY)
  4070        NEXT SENTENCE
  4071     ELSE
  4072        GO TO 12001-CHECK-CID-TRN-VA.
  4073
  4074***************************************************************
  4075
  4076     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  4077
  4078     IF GTL-IA-ODD-DAYS = ZEROS
  4079         MOVE ZERO               TO  GTL-IA-SGN
  4080     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  76
* ELRFND.cbl
  4081         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  4082             MOVE +1             TO  GTL-IA-SGN
  4083         ELSE
  4084             MOVE -1             TO  GTL-IA-SGN.
  4085
  4086     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  4087     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  4088
  4089     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  4090                          GTL-IA-SGN.
  4091
  4092     COMPUTE ANGLEN EQUAL WK1 / I.
  4093     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4094
  4095     IF GTL-IA-ODF NOT = ZERO
  4096         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  4097         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  4098
  4099     COMPUTE GTL-IA-DIVIDEND =
  4100           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  4101                             (ANGLEN - ANGLEN-M))) *
  4102           ((K1 + I) * CP-PREMIUM-RATE *
  4103                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  4104
  4105     COMPUTE GTL-IA-DIVISOR =
  4106      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  4107
  4108     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  4109
  4110     COMPUTE CP-CALC-PREMIUM =
  4111                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  4112     GO TO 99999-RETURN.
  4113
  4114
  4115 12001-CHECK-CID-TRN-VA.
  4116
  4117     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4118        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  4119        (CP-EARN-AS-NET-PAY) AND
  4120        (CP-TRUNCATED-LIFE) AND
  4121        (CP-STATE-STD-ABBRV = CP-STATE)
  4122        CONTINUE
  4123     ELSE
  4124        GO TO 12001-CHECK-CID-TX
  4125     END-IF
  4126
  4127     COMPUTE ANGLEN EQUAL WK1 / I
  4128     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4129     IF WS-WORK-DIS-RATE = ZEROS
  4130        CONTINUE
  4131     ELSE
  4132        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4133        COMPUTE WK7 = (1 / I) *
  4134              (((WK4 ** M - 1) / (WK4 - 1)) -
  4135              ((WK4 ** M * SX - VX) /
  4136              (WK4 * (1 + I) - 1))) *
  4137              (CP-PREMIUM-RATE / 1000)
  4138        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  77
* ELRFND.cbl
  4139        COMPUTE WK8 = WK7 * 100 / ANGLEN
  4140        COMPUTE CP-CALC-PREMIUM =
  4141           WK8 *  ((WK4 * ANGLEN) / 100)
  4142     END-IF
  4143
  4144     GO TO 99999-RETURN
  4145
  4146     .
  4147
  4148 12001-CHECK-CID-TX.
  4149     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4150        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  4151        (CP-EARN-AS-NET-PAY) AND
  4152        (WS-WORK-DIS-RATE > ZEROS) AND
  4153        (CP-STATE-STD-ABBRV = CP-STATE)
  4154        CONTINUE
  4155     ELSE
  4156        GO TO 12001-CHECK-CID-LEV-MN-NEW
  4157     END-IF
  4158* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  4159     COMPUTE K-I = 1 + (1 * I)
  4160     COMPUTE ANGLEN EQUAL WK1 / I
  4161     COMPUTE ANGLEM EQUAL WK2 / I
  4162     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4163     IF WS-WORK-DIS-RATE = ZEROS
  4164        CONTINUE
  4165     ELSE
  4166        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4167        COMPUTE WK7 = (K-I / I) *
  4168              (((WK4 ** M - 1) / (WK4 - 1)) -
  4169*             ((WK4 ** M * SX - VX) /
  4170              ((WK4 ** M * SX) - VX) /
  4171*             (WK4 * (1 + I) - 1))) *
  4172              (WK4 * (1 + I) - 1)) *
  4173              (CP-PREMIUM-RATE / 1000)
  4174        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4175        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  4176        COMPUTE CP-CALC-PREMIUM =
  4177           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  4178     END-IF
  4179
  4180     GO TO 99999-RETURN
  4181     .
  4182 12001-CHECK-CID-LEV-MN-NEW.
  4183*    IF (CP-COMPANY-ID EQUAL 'CID')
  4184*       AND (CP-STATE-STD-ABBRV = 'MN')
  4185*       AND (CP-EARN-AS-NET-PAY)
  4186*       AND (CP-LEVEL-LIFE)
  4187*       AND (CP-CERT-EFF-DT > X'A4FF')
  4188*       CONTINUE
  4189*    ELSE
  4190*       GO TO 12001-CHECK-CID-LEV-MN
  4191*    END-IF
  4192*
  4193*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4194*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4195*    MOVE '1'                    TO DC-OPTION-CODE
  4196*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  78
* ELRFND.cbl
  4197*
  4198*    IF DATE-CONVERSION-ERROR
  4199*       MOVE '2'                 TO CP-RETURN-CODE
  4200*       MOVE ZEROS               TO FACTOR
  4201*                                   CP-CALC-PREMIUM
  4202*       GO TO 99999-RETURN
  4203*    END-IF
  4204*
  4205*    COMPUTE I = CP-LOAN-APR / 100
  4206*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4207*
  4208*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4209*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4210*      * 12 / 360 * D)
  4211*
  4212*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4213*       * 12 / 360 * D
  4214*
  4215*    GO TO 99999-RETURN
  4216      .
  4217 12001-CHECK-CID-LEV-MN.
  4218
  4219     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4220        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4221        (CP-EARN-AS-NET-PAY) AND
  4222        (CP-LEVEL-LIFE) AND
  4223        (CP-STATE-STD-ABBRV = CP-STATE)
  4224        CONTINUE
  4225     ELSE
  4226        GO TO 12001-CHECK-CID-LEV-CA
  4227     END-IF
  4228
  4229     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4230         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4231         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4232
  4233     GO TO 99999-RETURN
  4234
  4235      .
  4236 12001-CHECK-CID-LEV-CA.
  4237
  4238     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4239        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4240        (CP-EARN-AS-NET-PAY) AND
  4241        (CP-LEVEL-LIFE) AND
  4242        (CP-STATE-STD-ABBRV = CP-STATE)
  4243        CONTINUE
  4244     ELSE
  4245        GO TO 12001-CHECK-CID-TRN-CA
  4246     END-IF
  4247
  4248     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4249     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4250     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4251     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4252     COMPUTE CP-CALC-PREMIUM =
  4253          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4254          (CP-PREMIUM-RATE / 1000)) /
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  79
* ELRFND.cbl
  4255          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4256
  4257     GO TO 99999-RETURN
  4258
  4259      .
  4260 12001-CHECK-CID-TRN-CA.
  4261
  4262     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4263        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4264        (CP-EARN-AS-NET-PAY) AND
  4265        (CP-TRUNCATED-LIFE) AND
  4266        (CP-STATE-STD-ABBRV = CP-STATE) AND
  4267        (WS-DISCOUNT-OPTION NOT = ' ')
  4268        CONTINUE
  4269     ELSE
  4270        GO TO 12001-CHECK-CID-TRN-MT
  4271     END-IF
  4272
  4273     COMPUTE ANGLEN EQUAL WK1 / I
  4274     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4275     IF WS-WORK-DIS-RATE = ZEROS
  4276        CONTINUE
  4277     ELSE
  4278        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4279        COMPUTE WK7 = (1 / I) *
  4280              (((WK4 ** M - 1) / (WK4 - 1)) -
  4281              ((WK4 ** M * SX - VX) /
  4282              (WK4 * (1 + I) - 1))) *
  4283              (CP-PREMIUM-RATE / 1000)
  4284        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4285        COMPUTE CP-CALC-PREMIUM =
  4286           WK4 *  WK7
  4287     END-IF
  4288
  4289     GO TO 99999-RETURN
  4290
  4291      .
  4292 12001-CHECK-CID-TRN-MT.
  4293
  4294     IF (CP-COMPANY-ID EQUAL 'CID') AND
  4295        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  4296                   OR
  4297        ((CP-STATE-STD-ABBRV = 'IN') AND
  4298        (CP-CERT-EFF-DT > X'9A7F'))
  4299                   OR
  4300        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4301        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4302        (CP-EARN-AS-NET-PAY) AND
  4303        (CP-TRUNCATED-LIFE) AND
  4304        (CP-STATE-STD-ABBRV = CP-STATE)
  4305        CONTINUE
  4306     ELSE
  4307        GO TO 12001-CHECK-CID-MT
  4308     END-IF
  4309
  4310* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4311     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4312        MOVE 0                   TO K-I
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  80
* ELRFND.cbl
  4313     ELSE
  4314        MOVE 2                   TO K-I
  4315     END-IF
  4316     COMPUTE CP-TERM-OR-EXT-DAYS =
  4317           CP-TERM-OR-EXT-DAYS + 30
  4318
  4319     COMPUTE ANGLEN EQUAL WK1 / I
  4320     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4321     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4322                   / (1 + I)
  4323     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4324     IF WS-WORK-DIS-RATE = ZEROS
  4325        CONTINUE
  4326     ELSE
  4327        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4328*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4329        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4330              (((WK4 ** M - 1) / (WK4 - 1)) -
  4331              ((WK4 ** M * SX - VX) /
  4332              (WK4 * (1 + I) - 1))) *
  4333              (CP-PREMIUM-RATE / 1000)
  4334        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4335*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4336        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4337        COMPUTE CP-CALC-PREMIUM =
  4338           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4339*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4340     END-IF
  4341
  4342     GO TO 99999-RETURN
  4343
  4344     .
  4345 12001-CHECK-CID-MT.
  4346
  4347     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4348        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  4349                                OR 'VT')
  4350                   OR
  4351        ((CP-STATE-STD-ABBRV = 'IN') AND
  4352        (CP-CERT-EFF-DT > X'9A7F'))
  4353                   OR
  4354        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4355        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4356        (CP-EARN-AS-NET-PAY) AND
  4357        (CP-STATE-STD-ABBRV = CP-STATE)
  4358        CONTINUE
  4359     ELSE
  4360        GO TO 12001-CHECK-DCC-DD
  4361     END-IF
  4362
  4363     COMPUTE CP-TERM-OR-EXT-DAYS =
  4364           CP-TERM-OR-EXT-DAYS + 30
  4365
  4366* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4367     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4368        MOVE 0                   TO K-I
  4369     ELSE
  4370        IF CP-STATE-STD-ABBRV = 'NJ'
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  81
* ELRFND.cbl
  4371           MOVE 1                TO K-I
  4372        ELSE
  4373           MOVE 2                TO K-I
  4374        END-IF
  4375     END-IF
  4376     COMPUTE ANGLEN EQUAL WK1 / I
  4377     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4378     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4379                   / (1 + I)
  4380     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4381     IF WS-WORK-DIS-RATE = ZEROS
  4382        CONTINUE
  4383     ELSE
  4384        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4385*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4386        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4387              (((WK4 ** N - 1) / (WK4 - 1)) -
  4388              ((WK4 ** N - SV) /
  4389              (WK4 * (1 + I) - 1))) *
  4390              (CP-PREMIUM-RATE / 1000)
  4391        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4392*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4393        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4394        COMPUTE CP-CALC-PREMIUM =
  4395           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4396*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4397     END-IF
  4398
  4399     GO TO 99999-RETURN
  4400
  4401     .
  4402 12001-CHECK-DCC-DD.
  4403     IF (CP-COMPANY-ID EQUAL 'DCC')
  4404        AND (CP-EARN-AS-NET-PAY)
  4405        AND (CP-BEN-CATEGORY = 'D')
  4406        CONTINUE
  4407     ELSE
  4408        GO TO 12001-CHECK-DCC-NET
  4409     END-IF
  4410
  4411     COMPUTE CP-TERM-OR-EXT-DAYS =
  4412           CP-TERM-OR-EXT-DAYS + 30
  4413
  4414     COMPUTE ANGLEN EQUAL WK1 / I.
  4415     COMPUTE ANGLEM EQUAL WK2 / I.
  4416     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4417
  4418     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4419           / (1 + I)
  4420     COMPUTE GR     = ANGLEN / ODF
  4421*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  4422*      CP-RATE-DEV-PCT
  4423     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4424     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4425       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  4426     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4427     MOVE WK3                    TO CP-CALC-PREMIUM
  4428
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  82
* ELRFND.cbl
  4429     GO TO 99999-RETURN
  4430
  4431     .
  4432 12001-CHECK-DCC-NET.
  4433
  4434     IF (CP-COMPANY-ID EQUAL 'DCC')
  4435        AND (CP-EARN-AS-NET-PAY)
  4436        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  4437             AND 'H' AND 'S' AND 'P')
  4438        CONTINUE
  4439     ELSE
  4440        GO TO 12001-CHECK-DCC-PNET
  4441     END-IF
  4442
  4443     COMPUTE CP-TERM-OR-EXT-DAYS =
  4444           CP-TERM-OR-EXT-DAYS + 30
  4445
  4446     COMPUTE ANGLEN EQUAL WK1 / I.
  4447     COMPUTE ANGLEM EQUAL WK2 / I.
  4448     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4449
  4450     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4451           / (1 + I)
  4452     COMPUTE GR     = ANGLEN / ODF
  4453     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  4454     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  4455       CP-RATE-DEV-PCT
  4456     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  4457*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  4458
  4459     COMPUTE WK8 = CP-PREMIUM-RATE *
  4460        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  4461     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  4462     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4463     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4464       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  4465     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4466     MOVE WK3                    TO CP-CALC-PREMIUM
  4467
  4468     GO TO 99999-RETURN
  4469
  4470     .
  4471 12001-CHECK-DCC-PNET.
  4472     IF (CP-COMPANY-ID EQUAL 'DCC')
  4473        AND (CP-EARN-AS-NET-PAY)
  4474        AND (CP-BENEFIT-CD (1:1) = 'P')
  4475        CONTINUE
  4476     ELSE
  4477        GO TO 12001-CHECK-DCC-MNET
  4478     END-IF
  4479     IF CP-NO-OF-PMTS NOT NUMERIC
  4480        MOVE +0                  TO CP-NO-OF-PMTS
  4481     END-IF
  4482     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  4483        AND ' ' AND 'M'
  4484        MOVE ' '                 TO CP-PMT-MODE
  4485     END-IF
  4486******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  83
* ELRFND.cbl
  4487***   Default is monthly, use loan term for rate and amort     ***
  4488******************************************************************
  4489     move cp-loan-term         to c-tot-pmts
  4490     MOVE +30                  TO C-DAYS-IN-PMT-PER
  4491     MOVE +12                  TO C-PMTS-PER-YEAR
  4492******************************************************************
  4493
  4494     evaluate true
  4495        when cp-pmt-mode = 'W'
  4496           MOVE +52              TO C-PMTS-PER-YEAR
  4497           compute c-tot-pmts = cp-loan-term /
  4498              12 * c-pmts-per-year
  4499           MOVE +7               TO C-DAYS-IN-PMT-PER
  4500        when cp-pmt-mode = 'B'
  4501           MOVE +26              TO C-PMTS-PER-YEAR
  4502           compute c-tot-pmts = cp-loan-term /
  4503              12 * c-pmts-per-year
  4504           MOVE +14              TO C-DAYS-IN-PMT-PER
  4505     end-evaluate
  4506     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4507     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4508        C-DAYS-IN-PMT-PER)) / (1 + I)
  4509     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  4510*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  4511     COMPUTE ANGLEN-1 = ANGLEN / Y
  4512     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4513     IF CP-RATE-DEV-PCT NOT = ZEROS
  4514        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4515           CP-PREMIUM-RATE
  4516     END-IF
  4517     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  4518     GO TO 99999-RETURN
  4519     .
  4520 12001-CHECK-DCC-MNET.
  4521
  4522     IF (CP-COMPANY-ID EQUAL 'DCC')
  4523        AND (CP-EARN-AS-NET-PAY)
  4524        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  4525        CONTINUE
  4526     ELSE
  4527        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  4528     END-IF
  4529
  4530*    COMPUTE ANGLEN EQUAL WK1 / I.
  4531*    COMPUTE ANGLEM EQUAL WK2 / I.
  4532*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  4533
  4534     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  4535     MOVE WK3                    TO CP-CALC-PREMIUM
  4536
  4537     GO TO 99999-RETURN
  4538
  4539     .
  4540 12001-CHECK-DCC-MNET-LF-BAL.
  4541
  4542     IF (CP-COMPANY-ID EQUAL 'DCC')
  4543        AND (CP-EARN-AS-NET-PAY)
  4544        AND (CP-BENEFIT-CD (1:1) = 'N')
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  84
* ELRFND.cbl
  4545        AND (CP-BEN-CATEGORY NOT = 'N')
  4546        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4547        CONTINUE
  4548     ELSE
  4549        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  4550     END-IF
  4551
  4552     IF CP-RATE-DEV-PCT NOT = ZEROS
  4553        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4554           CP-PREMIUM-RATE
  4555     END-IF
  4556*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4557     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4558        / (1 + I)
  4559     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4560     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4561     COMPUTE WK2 = (1 + J) ** (M * -1)
  4562     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4563     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4564          ** ((M - 1) * -1))) / J)
  4565     COMPUTE ANGLEM = ((1 - ((1 + J)
  4566          ** (M * -1))) / J) / OD
  4567     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4568        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  4569        / ANGLEM-1
  4570     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4571          ** ((N - M) * -1))) / I)
  4572     MOVE +0                     TO WK3
  4573     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4574        (WS-COUNTER > M)
  4575        COMPUTE ANGLEM = (1 - ((1 + J)
  4576          ** ((M - WS-COUNTER) * -1))) / J
  4577        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4578        COMPUTE WK5-CSL = (RA * ANGLEM)
  4579        + (CP-ALTERNATE-BENEFIT * WK2)
  4580        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4581     END-PERFORM
  4582     MOVE WK3                    TO CP-CALC-PREMIUM
  4583
  4584     GO TO 99999-RETURN
  4585
  4586     .
  4587 12001-CHECK-DCC-MNET-LFSUM-BAL.
  4588
  4589     IF (CP-COMPANY-ID EQUAL 'DCC')
  4590        AND (CP-EARN-AS-NET-PAY)
  4591        AND (CP-BENEFIT-CD (1:1) = 'S')
  4592        AND (CP-BEN-CATEGORY NOT = 'N')
  4593        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4594        CONTINUE
  4595     ELSE
  4596        GO TO 12001-CHECK-DCC-MNET-LF
  4597     END-IF
  4598
  4599     IF CP-RATE-DEV-PCT NOT = ZEROS
  4600        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4601           CP-PREMIUM-RATE
  4602     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  85
* ELRFND.cbl
  4603     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4604     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4605          ** ((M - 1) * -1))) / K)
  4606     COMPUTE ANGLEM = ((1 - ((1 + K)
  4607          ** (M * -1))) / K)
  4608     MOVE CP-MONTHLY-PAYMENT     TO RA
  4609     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4610        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  4611        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4612        CP-PREMIUM-RATE / 1000
  4613     MOVE WK3                    TO CP-CALC-PREMIUM
  4614
  4615     GO TO 99999-RETURN
  4616
  4617     .
  4618 12001-CHECK-DCC-MNET-LF.
  4619
  4620     IF (CP-COMPANY-ID EQUAL 'DCC')
  4621        AND (CP-EARN-AS-NET-PAY)
  4622        AND (CP-BENEFIT-CD (1:1) = 'N')
  4623        AND (CP-BEN-CATEGORY NOT = 'N')
  4624        CONTINUE
  4625     ELSE
  4626        GO TO 12001-CHECK-DCC-MNET-SUMLF
  4627     END-IF
  4628
  4629     IF CP-RATE-DEV-PCT NOT = ZEROS
  4630        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4631           CP-PREMIUM-RATE
  4632     END-IF
  4633*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4634     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4635        / (1 + I)
  4636     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4637     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4638     COMPUTE WK2 = (1 + J) ** (M * -1)
  4639     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4640     COMPUTE ANGLEM = ((1 - ((1 + J)
  4641          ** (M * -1))) / J) / OD
  4642     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4643     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4644          ** ((N - M) * -1))) / I)
  4645     MOVE +0                     TO WK3
  4646     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4647        (WS-COUNTER > M)
  4648        COMPUTE ANGLEM = (1 - ((1 + J)
  4649          ** ((M - WS-COUNTER + 1) * -1))) / J
  4650        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4651        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4652        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4653     END-PERFORM
  4654     MOVE WK3                    TO CP-CALC-PREMIUM
  4655
  4656     GO TO 99999-RETURN
  4657
  4658     .
  4659 12001-CHECK-DCC-MNET-SUMLF.
  4660
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  86
* ELRFND.cbl
  4661     IF (CP-COMPANY-ID EQUAL 'DCC')
  4662        AND (CP-EARN-AS-NET-PAY)
  4663        AND (CP-BENEFIT-CD (1:1) = 'S')
  4664        AND (CP-BEN-CATEGORY NOT = 'N')
  4665        CONTINUE
  4666     ELSE
  4667        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  4668     END-IF
  4669
  4670     IF CP-RATE-DEV-PCT NOT = ZEROS
  4671        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4672           CP-PREMIUM-RATE
  4673     END-IF
  4674     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4675     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4676        / (1 + K)
  4677     COMPUTE ANGLEN-M = (WK5 / I)
  4678     COMPUTE WK2 = (1 + K) ** (M * -1)
  4679     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4680     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4681     COMPUTE ANGLEM = ((1 - ((1 + K)
  4682          ** (M * -1))) / K) / Y
  4683     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4684     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  4685        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4686        - 1)) / K) * RA
  4687     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4688        + (CP-DAYS-TO-1ST-PMT - +30)
  4689        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4690        +0 / 1000 * 12 / 12)
  4691     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  4692        * (12 / 12)
  4693     MOVE WK3                    TO CP-CALC-PREMIUM
  4694
  4695     GO TO 99999-RETURN
  4696
  4697     .
  4698 12001-CHECK-DCC-MNET-TOT-BAL-N.
  4699
  4700     IF (CP-COMPANY-ID EQUAL 'DCC')
  4701        AND (CP-EARN-AS-NET-PAY)
  4702        AND (CP-BENEFIT-CD (1:1) = 'N')
  4703        AND (CP-BEN-CATEGORY = 'N')
  4704        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4705        CONTINUE
  4706     ELSE
  4707        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  4708     END-IF
  4709
  4710*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4711     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4712        / (1 + I)
  4713     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4714     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  4715     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4716     COMPUTE WK2 = (1 + J) ** (M * -1)
  4717     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4718     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  87
* ELRFND.cbl
  4719          ** ((M - 1) * -1))) / J)
  4720     COMPUTE ANGLEM = ((1 - ((1 + J)
  4721          ** (M * -1))) / J) / OD
  4722     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4723        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  4724        / ANGLEM-1
  4725     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4726          ** ((N - M) * -1))) / I)
  4727     MOVE +0                     TO WK3
  4728     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4729        (WS-COUNTER > M)
  4730        COMPUTE ANGLEM = (1 - ((1 + J)
  4731          ** ((M - WS-COUNTER) * -1))) / J
  4732        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  4733        COMPUTE WK5-CSL = (RA * ANGLEM)
  4734        + (CP-ALTERNATE-BENEFIT * WK2)
  4735        COMPUTE WK3 = WK3 +
  4736         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  4737        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  4738          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  4739          (CP-DCC-AH-RATE / 1000)
  4740     END-PERFORM
  4741     MOVE WK3                    TO CP-CALC-PREMIUM
  4742
  4743     GO TO 99999-RETURN
  4744
  4745     .
  4746 12001-CHECK-DCC-MNET-TOT-BAL-S.
  4747
  4748     IF (CP-COMPANY-ID EQUAL 'DCC')
  4749        AND (CP-EARN-AS-NET-PAY)
  4750        AND (CP-BENEFIT-CD (1:1) = 'S')
  4751        AND (CP-BEN-CATEGORY = 'N')
  4752        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4753        CONTINUE
  4754     ELSE
  4755        GO TO 12001-CHECK-DCC-MNET-TOT-N
  4756     END-IF
  4757
  4758     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4759     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4760          ** ((M - 1) * -1))) / K)
  4761     COMPUTE ANGLEM = ((1 - ((1 + K)
  4762          ** (M * -1))) / K)
  4763     MOVE CP-MONTHLY-PAYMENT     TO RA
  4764     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4765        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  4766        * CP-DCC-AH-RATE / 1000))
  4767        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4768        CP-DCC-LF-RATE / 1000
  4769     MOVE WK3                    TO CP-LF-PREM
  4770     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  4771        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  4772        * CP-DCC-AH-RATE / 1000
  4773     COMPUTE WK3 = WK3 + WK5-CSL
  4774     MOVE WK3                    TO CP-CALC-PREMIUM
  4775
  4776     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  88
* ELRFND.cbl
  4777      .
  4778 12001-CHECK-DCC-MNET-TOT-N.
  4779
  4780     IF (CP-COMPANY-ID EQUAL 'DCC')
  4781        AND (CP-EARN-AS-NET-PAY)
  4782        AND (CP-BENEFIT-CD (1:1) = 'N')
  4783        AND (CP-BEN-CATEGORY = 'N')
  4784        CONTINUE
  4785     ELSE
  4786        GO TO 12001-CHECK-DCC-MNET-TOT-S
  4787     END-IF
  4788
  4789*    I = APR/1200
  4790*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  4791*    RA = PAYMENT AMOUNT
  4792*    WK5-CSL = THE BALANCE (PAY OFF )
  4793*    WK3 = THE ACCUMULATED PREMIUM
  4794*    WK2 = (1 + I) ^ (m * -1)
  4795*    OD  = GAMMA
  4796*
  4797*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4798     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4799        / (1 + I)
  4800     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4801     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  4802        (CP-DCC-AH-RATE / +1000)
  4803     COMPUTE WK2 = (1 + J) ** (M * -1)
  4804     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4805     COMPUTE ANGLEM = ((1 - ((1 + J)
  4806          ** (M * -1))) / J) / OD
  4807     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4808     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4809          ** ((N - M) * -1))) / I)
  4810     MOVE +0                     TO WK3
  4811     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4812        (WS-COUNTER > M)
  4813        COMPUTE ANGLEM = (1 - ((1 + J)
  4814          ** ((M - WS-COUNTER + 1) * -1))) / J
  4815        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4816        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4817        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  4818           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  4819     END-PERFORM
  4820     MOVE WK3                    TO CP-CALC-PREMIUM
  4821
  4822     GO TO 99999-RETURN
  4823
  4824     .
  4825 12001-CHECK-DCC-MNET-TOT-S.
  4826
  4827     IF (CP-COMPANY-ID EQUAL 'DCC')
  4828        AND (CP-EARN-AS-NET-PAY)
  4829        AND (CP-BENEFIT-CD (1:1) = 'S')
  4830        AND (CP-BEN-CATEGORY = 'N')
  4831        CONTINUE
  4832     ELSE
  4833        GO TO 12001-CONTINUE-NET
  4834     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  89
* ELRFND.cbl
  4835
  4836*    I = APR/1200
  4837*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  4838*    RA = PAYMENT AMOUNT
  4839*    WK5-CSL = THE BALANCE (PAY OFF )
  4840*    WK3 = THE ACCUMULATED PREMIUM
  4841*    WK2 = (1 + I) ^ (m * -1)
  4842*    OD  = GAMMA
  4843*
  4844     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  4845     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  4846        / (1 + J)
  4847     COMPUTE ANGLEM = ((1 - ((1 + J)
  4848          ** (M * -1))) / J) / OD
  4849     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4850          ** ((N - M) * -1))) / I)
  4851          * (1 + J) ** (-1 * M)
  4852     COMPUTE ANGLEN-M = ANGLEN-M / OD
  4853     MOVE CP-MONTHLY-PAYMENT     TO RA
  4854     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  4855        / +30)
  4856     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  4857        ** (WK1) - 1)) / J) * RA
  4858     COMPUTE WK5 = (((((M * (M + 1) / 2)
  4859        + (CP-DAYS-TO-1ST-PMT - +30)
  4860        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  4861        CP-DCC-AH-RATE / +1000 * 12 / 12)
  4862     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  4863        (12 / 12)
  4864     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  4865        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  4866        (CP-DCC-AH-RATE / +1000) * 12 / 12
  4867     COMPUTE WK3 = WK3 + WK5-CSL
  4868     MOVE WK3                    TO CP-CALC-PREMIUM
  4869     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4870     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4871        / (1 + K)
  4872     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4873          ** ((N - M) * -1))) / I)
  4874     COMPUTE WK2 = (1 + K) ** (M * -1)
  4875     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4876     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4877     COMPUTE ANGLEM = ((1 - ((1 + K)
  4878          ** (M * -1))) / K) / Y
  4879*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4880     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  4881        ((1 + K) ** (M + 1 / Y
  4882        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4883        - 1)) / K) * RA
  4884     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4885        + (CP-DAYS-TO-1ST-PMT - +30)
  4886        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4887        CP-DCC-AH-RATE / 1000 * 12 / 12)
  4888     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  4889        * (12 / 12)
  4890     MOVE WK3                    TO CP-LF-PREM
  4891
  4892     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  90
* ELRFND.cbl
  4893
  4894     .
  4895 12001-CONTINUE-NET.
  4896
  4897     IF NET-STD
  4898        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  4899*          OR 'DCC'
  4900         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  4901         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  4902         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  4903         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  4904                               * ((1 + N) / (1 + M))
  4905         if (i = .0000000001)
  4906            and (wk3 = zeros)
  4907            move 1               to wk3
  4908         end-if
  4909        ELSE
  4910         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  4911         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  4912         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  4913         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  4914
  4915     IF NET-SMP
  4916         COMPUTE N2 = N * N
  4917         COMPUTE N3 = N2 * N
  4918         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  4919         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  4920         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  4921         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  4922         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  4923
  4924     IF NPO-PRUDENTIAL
  4925       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  4926           VARYING WS-COUNTER FROM 1 BY 1
  4927               UNTIL WS-COUNTER = N
  4928       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  4929       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  4930
  4931     MOVE WK3 TO FACTOR.
  4932
  4933     GO TO 99999-RETURN.
  4934
  4935 12100-PRU-CALC.
  4936     IF WS-COUNTER = 1
  4937         COMPUTE PWK = (I + 1)
  4938     ELSE
  4939         COMPUTE PWK = PWK * (I + 1).
  4940
  4941 12199-EXIT.
  4942      EXIT.
  4943
  4944 99000-ERROR.
  4945     MOVE +9999.999999999 TO N-P-FACTOR.
  4946     MOVE '4'             TO CP-RETURN-CODE.
  4947
  4948     GO TO 99999-EXIT.
  4949
  4950 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-13 11:20 Page  91
* ELRFND.cbl
  4951     MOVE FACTOR          TO N-P-FACTOR.
  4952
  4953 99999-EXIT.
  4954      EXIT.
  4955
  4956 9999-DFHBACK SECTION.
  4957     MOVE '9%                    "   ' TO DFHEIV0
  4958     MOVE 'ELRFND' TO DFHEIV1
  4959     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4960     GOBACK.
  4961 9999-DFHEXIT.
  4962     IF DFHEIGDJ EQUAL 0001
  4963         NEXT SENTENCE.
  4964     MOVE '9%                    "   ' TO DFHEIV0
  4965     MOVE 'ELRFND' TO DFHEIV1
  4966     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4967     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2488     Code:       41379
