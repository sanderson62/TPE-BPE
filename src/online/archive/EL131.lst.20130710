* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    31******************************************************************
    32
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page   3
* EL131.cbl
    34 ENVIRONMENT DIVISION.
    35
    36 DATA DIVISION.
    37
    38 WORKING-STORAGE SECTION.
    39 01  DFH-START PIC X(04).
    40 01  LCP-TIME-OF-DAY-XX.
    41     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    42     05  FILLER                    PIC 99.
    43 01  LCP-CICS-TIME                 PIC 9(15).
    44
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    47 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    48
    49*                            COPY ELCSCTM.
    50******************************************************************
    51*                                                                *
    52*                                                                *
    53*                            ELCSCTM                             *
    54*                            VMOD=2.001                          *
    55*                                                                *
    56*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    57*                                                                *
    58******************************************************************
    59 01  SECURITY-MESSAGE.
    60     12  FILLER                          PIC X(30)
    61            VALUE '** LOGIC SECURITY VIOLATION -'.
    62     12  SM-READ                         PIC X(6).
    63     12  FILLER                          PIC X(5)
    64            VALUE ' PGM='.
    65     12  SM-PGM                          PIC X(6).
    66     12  FILLER                          PIC X(5)
    67            VALUE ' OPR='.
    68     12  SM-PROCESSOR-ID                 PIC X(4).
    69     12  FILLER                          PIC X(6)
    70            VALUE ' TERM='.
    71     12  SM-TERMID                       PIC X(4).
    72     12  FILLER                          PIC XX   VALUE SPACE.
    73     12  SM-JUL-DATE                     PIC 9(5).
    74     12  FILLER                          PIC X    VALUE SPACE.
    75     12  SM-TIME                         PIC 99.99.
    76
    77
    78*                            COPY ELCSCRTY.
    79******************************************************************
    80*                                                                *
    81*                                                                *
    82*                            ELCSCRTY                            *
    83*                            VMOD=2.001                          *
    84*                                                                *
    85*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    86*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    87*        SAVED IN PI-SECURITY-ADDRESS.                           *
    88*                                                                *
    89******************************************************************
    90 01  SECURITY-CONTROL.
    91     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page   4
* EL131.cbl
    92     12  FILLER                       PIC XX    VALUE 'SC'.
    93     12  SC-CREDIT-CODES.
    94         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    95             20  SC-CREDIT-DISPLAY    PIC X.
    96             20  SC-CREDIT-UPDATE     PIC X.
    97     12  SC-CLAIMS-CODES.
    98         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    99             20  SC-CLAIMS-DISPLAY    PIC X.
   100             20  SC-CLAIMS-UPDATE     PIC X.
   101
   102*                            COPY ELCNWA.
   103*****************************************************************
   104*                                                               *
   105*                                                               *
   106*                            ELCNWA.                            *
   107*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   108*                            VMOD=2.003                         *
   109*                                                               *
   110*            M O V E   N A M E   W O R K   A R E A.             *
   111*                                                               *
   112*****************************************************************.
   113
   114 01  WS-NAME-WORK-AREA.
   115     05  WS-INSURED-LAST-NAME        PIC X(15).
   116     05  WS-INSURED-1ST-NAME         PIC X(12).
   117     05  WS-INSURED-MID-INIT         PIC X.
   118
   119     05  WS-NAME-WORK.
   120         10  WS-NW                   PIC X
   121             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   122
   123     05  WS-NAME-WORK2.
   124         10  WS-NW2                  PIC X
   125             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   126                                        NWA-INDEX0.
   127
   128     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   129                                     COMP-3.
   130
   131
   132 01  WS-DATE-AREA.
   133     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   134     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   135     12  SAVE-DATE-CCYYMMDD.
   136         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   137         16  SAVE-DATE-YMD.
   138             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   139             20  FILLER         PIC X(4)    VALUE SPACES.
   140
   141 01  WS-BLANK                   PIC X       VALUE ' '.
   142
   143 01  CSO-WORK-FIELDS.
   144     05  WS-HOLD-CLAIM-STATUS    PIC X.
   145
   146 01  LITERALS-NUMBERS.
   147     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   148     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   149     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page   5
* EL131.cbl
   150     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   151     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   152     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   153     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   154
   155     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   156     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   157     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   158     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   159     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   160     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   161     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   162     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   163     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   164
   165     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   166
   167     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   168
   169     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   170     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   171     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   172     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   173     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   174     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   175     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   176     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   177     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   178     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   179     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   180
   181     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   182     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   183     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   184     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   185         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   186     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   187     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   188     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   189     12  WS-CLAIM-SEQU.
   190         16  FILLER              PIC X VALUE '('.
   191         16  WS-CURRENT-SEQU     PIC Z9.
   192         16  FILLER              PIC X(04) VALUE ' OF '.
   193         16  WS-OF-SEQU          PIC Z9.
   194         16  FILLER              PIC X VALUE ')'.
   195     12  WS-EDIT-BEN-CODE        PIC XX.
   196         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   197                                          '90' THRU '99'.
   198
   199     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   200     12  WS-EDIT-NUMBER          PIC ZZZ9.
   201
   202     12  WS-RESPONSE             PIC S9(8)   COMP.
   203         88  WS-RESP-NORMAL                  VALUE +00.
   204         88  WS-RESP-NOTFND                  VALUE +13.
   205
   206     12  WS-MOS-PAID             PIC 999.
   207     12  WS-ODD-DAYS             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page   6
* EL131.cbl
   208     12  WS-REM-MOS              PIC 999.
   209     12  WS-REM-DAYS             PIC 99.
   210     12  WS-TERM-IN-DAYS         PIC 9(4).
   211     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   212
   213     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   214     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   215     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   216     12  WS-RESET-SW             PIC X       VALUE 'N'.
   217     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   218     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   219     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   220
   221 01  DMD-DATE-YYYYMMDD.
   222     12  DMD-DECADE          PIC XX      VALUE SPACES.
   223     12  DMD-YYMMDD.
   224         16  DMD-YY          PIC XX      VALUE SPACES.
   225         16  DMD-MM          PIC XX      VALUE SPACES.
   226         16  DMD-DD          PIC XX      VALUE SPACES.
   227
   228 01  DMD-DATE-MMDDYYYY.
   229     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   230     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   231     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   232     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   233     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   234     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   235
   236 01  WS-MAIL-CODE.
   237     12  FILLER              PIC X.
   238     12  DMD-MAIL-CODE.
   239         16  WS-MAIL-4       PIC X(4).
   240         16  WS-MAIL-5       PIC X.
   241     12  FILLER              PIC X(4).
   242
   243     12  W-NAME-LAST             PIC  X(15).
   244     12  W-NAME-FIRST            PIC  X(15).
   245     12  W-NAME-MIDDLE.
   246         16  FILLER              PIC  X.
   247         16  W-NAME-MIDDLE-2     PIC  X.
   248         16  FILLER              PIC  X(13).
   249
   250*    COPY ELCDCTB.
   251******************************************************************
   252*                                                                *
   253*                                                                *
   254*                            ELCDCTB.                            *
   255*                            VMOD=2.002                          *
   256*                                                                *
   257*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   258*       COMMUNICATIONS AREA                                      *
   259*                                                                *
   260******************************************************************
   261 01  DCT-COMMUNICATION-AREA.
   262     12  DCT-BILLING-BANK-ID      PIC  X(05).
   263     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   264     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   265     12  DCT-PRODUCT-CODE         PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page   7
* EL131.cbl
   266     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   267     12  DCT-RETURN-CODE          PIC  X(02).
   268     12  DCT-MAIL-CODE            PIC  X(05).
   269     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   270     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page   8
* EL131.cbl
   272 01  ERROR-SWITCHES.
   273     12  ERROR-SWITCH            PIC X.
   274         88  SCREEN-ERROR                    VALUE 'X'.
   275     12  MSTR-KEY-SWITCH         PIC X.
   276         88  MSTR-KEY-CHANGED                VALUE 'X'.
   277     12  CERT-KEY-SWITCH         PIC X.
   278*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   279         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   280*********SET TO Y IF PRIMARY KEY WILL CHANGE
   281         88  CERT-KEY-CHANGED                VALUE 'Y'.
   282     12  MSTR-SWITCH             PIC X.
   283         88  MSTR-UPDATES                    VALUE 'X'.
   284     12  CERT-SWITCH             PIC X.
   285         88  CERT-UPDATES                    VALUE 'X'.
   286     12  UPDATE-SWITCH           PIC X.
   287         88  UPDATES-PRESENT                 VALUE 'X'.
   288     12  TRLR-SWITCH             PIC X.
   289         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   290         88  UPDATE-MADE                     VALUE 'Y'.
   291     12  NINETY-TRLR-SWITCH      PIC X.
   292         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   293     12  EARNINGS-CALC-SWITCH    PIC X.
   294         88  TEX-REG                         VALUE '4'.
   295         88  NET-PAY                         VALUE '5'.
   296     12  DLYACTV-SW              PIC X       VALUE 'N'.
   297         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page   9
* EL131.cbl
   299 01  EDIT-WORK-AREA.
   300     12  COUNT-2                 PIC 9.
   301     12  CALL-PGM                PIC X(8).
   302     12  TRANS-ID                PIC X(4).
   303     12  CHECK-PFKEYS            PIC 99.
   304     12  CHECK-MAINT             PIC X.
   305         88  ADD-ALPHA-RECORD                VALUE 'A'.
   306         88  CHANGE-CLAIM                    VALUE 'C'.
   307         88  DELETE-CLAIM                    VALUE 'D'.
   308         88  CHANGE-NAME                     VALUE 'N'.
   309         88  VALID-OPTIONS                   VALUE 'A' 'C'
   310                                                   'D' 'N'.
   311
   312     12  HOLD-BENEFIT            PIC XX.
   313     12  HOLD-FREQ               PIC XX.
   314     12  HOLD-REPORTED           PIC XX.
   315     12  HOLD-INCUR              PIC XX.
   316     12  HOLD-PDTHRU             PIC XX.
   317     12  HOLD-ADDON              PIC XX.
   318     12  HOLD-NODAYS             PIC 9(4).
   319     12  HOLD-NOPMTS             PIC 9(3).
   320     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   321     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   322     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   323     12  HOLD-BIRTH              PIC XX.
   324     12  HOLD-END                PIC XX.
   325     12  HOLD-EFF                PIC XX.
   326     12  HOLD-ENTRY              PIC XX.
   327     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   328     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   329     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   330     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   331     12  HOLD-LF-CV-CAN          PIC XX.
   332     12  HOLD-AH-CV-CAN          PIC XX.
   333     12  DIVIDE-QUOT             PIC 9(3).
   334     12  DIVIDE-REM              PIC 9(3).
   335
   336     12  WS-ALPHA-DATE.
   337         16  WS-ALPHA-YEAR.
   338             20  WS-ALPHA-YY-1   PIC 99.
   339             20  WS-ALPHA-YY-2   PIC 99.
   340         16  WS-ALPHA-MM         PIC 99.
   341         16  WS-ALPHA-DD         PIC 99.
   342
   343     12  BUILD-VALID-DATE.
   344         16  BUILD-MONTH         PIC 99.
   345         16  BUILD-DAY           PIC 99.
   346         16  BUILD-YEAR          PIC 99.
   347     12  DEEDIT-MMYY-INPUT.
   348         16  FILLER              PIC X.
   349         16  DEEDIT-MONTH        PIC XX.
   350         16  DEEDIT-YEAR         PIC XX.
   351     12  DEEDIT-BEN              PIC 9(9)V99.
   352     12  DEEDIT-DATE-INPUT.
   353         16  FILLER              PIC XX.
   354         16  DEEDIT-DATE         PIC X(6).
   355     12  WORK-DATE-MDY.
   356         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  10
* EL131.cbl
   357         16  FILLER              PIC X(4).
   358         16  YEAR-WORK           PIC XX.
   359     12  WORK-DATE-MY.
   360         16  WORK-MONTH          PIC XX.
   361         16  WORK-SLASH          PIC X       VALUE '/'.
   362         16  WORK-YEAR           PIC XX.
   363     12  HOLD-DATE.
   364         16  HOLD-MONTH          PIC 99.
   365         16  FILLER              PIC X(4).
   366         16  HOLD-YEAR           PIC 99.
   367     12  SPLIT-INFO-LINE-1.
   368         16  SPLIT-INFO-DESC     PIC X(15).
   369         16  FILLER              PIC X(5)    VALUE ' OLD='.
   370         16  SPLIT-INFO-OLD      PIC X(40).
   371     12  EFF-TERM-MO             PIC 9(4).
   372     12  CURR-MO                 PIC 9(4).
   373     12  WS-BIN-CURRENT-DT       PIC XX.
   374     12  WS-CALC-METHOD          PIC X.
   375     12  WS-INITIALS.
   376         16  WS-INIT-1           PIC X.
   377         16  WS-INIT-2           PIC X.
   378     12  WS-REIN-TABLE.
   379         16  WS-REIN-1           PIC X.
   380         16  WS-REIN-2           PIC X.
   381         16  WS-REIN-3           PIC X.
   382     12  PI-KEY.
   383         16  PI-TERM             PIC X(4).
   384         16  PI-QUAL             PIC X(4).
   385     12  CHECK-KEY               PIC X(20).
   386     12  SAVE-ACCT-KEY           PIC X(20).
   387     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   388     12  WS-SOC-SEC-NUMBER.
   389         16  WS-SOC-SEC-NO       PIC 9(9).
   390         16  WS-SOC-SEC-BLANK    PIC X(2).
   391     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   392         16  WS-SSN-1-3          PIC 9(3).
   393         16  WS-SSN-DASH1        PIC X(1).
   394         16  WS-SSN-4-5          PIC 9(2).
   395         16  WS-SSN-DASH2        PIC X(1).
   396         16  WS-SSN-6-9          PIC 9(4).
   397     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   398
   399 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   400     12  M                   PIC S9(7)V99           VALUE ZEROS.
   401     12  L                   PIC S9(7)V99           VALUE ZEROS.
   402     12  N                   PIC S9(3)              VALUE ZEROS.
   403     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   404     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   405     12  I                   PIC S99V9(5)           VALUE ZEROS.
   406     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   407     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   408     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   409     12  R                   PIC S9(3)              VALUE ZEROS.
   410     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   411     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   412     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   413     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   414     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  11
* EL131.cbl
   415     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   416     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   417     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   418     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   419
   420 01  TERM-CALC-WORK-AREA.
   421     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   422     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   423     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   424     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   425     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   426     12  V-EXPONENTS.
   427        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   428     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   429
   430 01  TIME-IN.
   431     12  UN-HOURS                PIC XX.
   432     12  UN-MINUTES              PIC XX.
   433     12  FILLER                  PIC XX.
   434
   435 01  TIME-OUT.
   436     12  FOR-HOURS               PIC XX.
   437     12  FILLER                  PIC X       VALUE '.'.
   438     12  FOR-MINUTES             PIC XX.
   439
   440 01  ERROR-NUMBERS.
   441     12  ER-0000                 PIC X(4)    VALUE '0000'.
   442     12  ER-0004                 PIC X(4)    VALUE '0004'.
   443     12  ER-0008                 PIC X(4)    VALUE '0008'.
   444     12  ER-0023                 PIC X(4)    VALUE '0023'.
   445     12  ER-0029                 PIC X(4)    VALUE '0029'.
   446     12  ER-0068                 PIC X(4)    VALUE '0068'.
   447     12  ER-0070                 PIC X(4)    VALUE '0070'.
   448     12  ER-0149                 PIC X(4)    VALUE '0149'.
   449     12  ER-0154                 PIC X(4)    VALUE '0154'.
   450     12  ER-0169                 PIC X(4)    VALUE '0169'.
   451     12  ER-0192                 PIC X(4)    VALUE '0192'.
   452     12  ER-0199                 PIC X(4)    VALUE '0199'.
   453     12  ER-0203                 PIC X(4)    VALUE '0203'.
   454     12  ER-0204                 PIC X(4)    VALUE '0204'.
   455     12  ER-0205                 PIC X(4)    VALUE '0205'.
   456     12  ER-0206                 PIC X(4)    VALUE '0206'.
   457     12  ER-0208                 PIC X(4)    VALUE '0208'.
   458     12  ER-0210                 PIC X(4)    VALUE '0210'.
   459     12  ER-0215                 PIC X(4)    VALUE '0215'.
   460     12  ER-0219                 PIC X(4)    VALUE '0219'.
   461     12  ER-0220                 PIC X(4)    VALUE '0220'.
   462     12  ER-0222                 PIC X(4)    VALUE '0222'.
   463     12  ER-0223                 PIC X(4)    VALUE '0223'.
   464     12  ER-0224                 PIC X(4)    VALUE '0224'.
   465     12  ER-0227                 PIC X(4)    VALUE '0227'.
   466     12  ER-0230                 PIC X(4)    VALUE '0230'.
   467     12  ER-0232                 PIC X(4)    VALUE '0232'.
   468     12  ER-0233                 PIC X(4)    VALUE '0233'.
   469     12  ER-0236                 PIC X(4)    VALUE '0236'.
   470     12  ER-0237                 PIC X(4)    VALUE '0237'.
   471     12  ER-0238                 PIC X(4)    VALUE '0238'.
   472     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  12
* EL131.cbl
   473     12  ER-0241                 PIC X(4)    VALUE '0241'.
   474     12  ER-0243                 PIC X(4)    VALUE '0243'.
   475     12  ER-0244                 PIC X(4)    VALUE '0244'.
   476     12  ER-0246                 PIC X(4)    VALUE '0246'.
   477     12  ER-0247                 PIC X(4)    VALUE '0247'.
   478     12  ER-0248                 PIC X(4)    VALUE '0248'.
   479     12  ER-0250                 PIC X(4)    VALUE '0250'.
   480     12  ER-0251                 PIC X(4)    VALUE '0251'.
   481     12  ER-0253                 PIC X(4)    VALUE '0253'.
   482     12  ER-0256                 PIC X(4)    VALUE '0256'.
   483     12  ER-0257                 PIC X(4)    VALUE '0257'.
   484     12  ER-0258                 PIC X(4)    VALUE '0258'.
   485     12  ER-0259                 PIC X(4)    VALUE '0259'.
   486     12  ER-0260                 PIC X(4)    VALUE '0260'.
   487     12  ER-0261                 PIC X(4)    VALUE '0261'.
   488     12  ER-0262                 PIC X(4)    VALUE '0262'.
   489     12  ER-0263                 PIC X(4)    VALUE '0263'.
   490     12  ER-0273                 PIC X(4)    VALUE '0273'.
   491     12  ER-0274                 PIC X(4)    VALUE '0274'.
   492     12  ER-0276                 PIC X(4)    VALUE '0276'.
   493     12  ER-0282                 PIC X(4)    VALUE '0282'.
   494     12  ER-0283                 PIC X(4)    VALUE '0283'.
   495     12  ER-0309                 PIC X(4)    VALUE '0309'.
   496     12  ER-0310                 PIC X(4)    VALUE '0310'.
   497     12  ER-0311                 PIC X(4)    VALUE '0311'.
   498     12  ER-0333                 PIC X(4)    VALUE '0333'.
   499     12  ER-0360                 PIC X(4)    VALUE '0360'.
   500     12  ER-0377                 PIC X(4)    VALUE '0377'.
   501     12  ER-0402                 PIC X(4)    VALUE '0402'.
   502     12  ER-0416                 PIC X(4)    VALUE '0416'.
   503     12  ER-0426                 PIC X(4)    VALUE '0426'.
   504     12  ER-0427                 PIC X(4)    VALUE '0427'.
   505     12  ER-0428                 PIC X(4)    VALUE '0428'.
   506     12  ER-0429                 PIC X(4)    VALUE '0429'.
   507     12  ER-0430                 PIC X(4)    VALUE '0430'.
   508     12  ER-0475                 PIC X(4)    VALUE '0475'.
   509     12  ER-0491                 PIC X(4)    VALUE '0491'.
   510     12  ER-0509                 PIC X(4)    VALUE '0509'.
   511     12  ER-0510                 PIC X(4)    VALUE '0510'.
   512     12  ER-0519                 PIC X(4)    VALUE '0519'.
   513     12  ER-0520                 PIC X(4)    VALUE '0520'.
   514     12  ER-0521                 PIC X(4)    VALUE '0521'.
   515     12  ER-0547                 PIC X(4)    VALUE '0547'.
   516     12  ER-0548                 PIC X(4)    VALUE '0548'.
   517     12  ER-0549                 PIC X(4)    VALUE '0549'.
   518     12  ER-0565                 PIC X(4)    VALUE '0565'.
   519     12  ER-0598                 PIC X(4)    VALUE '0598'.
   520     12  ER-0639                 PIC X(4)    VALUE '0639'.
   521     12  ER-0797                 PIC X(4)    VALUE '0797'.
   522     12  ER-0802                 PIC X(4)    VALUE '0802'.
   523     12  ER-0803                 PIC X(4)    VALUE '0803'.
   524     12  ER-0849                 PIC X(4)    VALUE '0849'.
   525     12  ER-0885                 PIC X(4)    VALUE '0885'.
   526     12  ER-0887                 PIC X(4)    VALUE '0887'.
   527     12  ER-0919                 PIC X(4)    VALUE '0919'.
   528     12  ER-0921                 PIC X(4)    VALUE '0921'.
   529     12  ER-0938                 PIC X(4)    VALUE '0938'.
   530     12  ER-0946                 PIC X(4)    VALUE '0946'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  13
* EL131.cbl
   531     12  ER-0947                 PIC X(4)    VALUE '0947'.
   532     12  ER-0948                 PIC X(4)    VALUE '0948'.
   533     12  ER-0949                 PIC X(4)    VALUE '0949'.
   534     12  ER-0950                 PIC X(4)    VALUE '0950'.
   535     12  ER-0951                 PIC X(4)    VALUE '0951'.
   536     12  ER-0954                 PIC X(4)    VALUE '0954'.
   537     12  ER-0974                 PIC X(4)    VALUE '0974'.
   538     12  ER-0975                 PIC X(4)    VALUE '0975'.
   539     12  ER-1773                 PIC X(4)    VALUE '1773'.
   540     12  ER-2280                 PIC X(4)    VALUE '2280'.
   541     12  ER-2878                 PIC X(4)    VALUE '2878'.
   542     12  ER-7641                 PIC X(4)    VALUE '7641'.
   543     12  ER-7642                 PIC X(4)    VALUE '7642'.
   544     12  ER-7650                 PIC X(4)    VALUE '7650'.
   545     12  ER-7651                 PIC X(4)    VALUE '7651'.
   546     12  ER-7687                 PIC X(4)    VALUE '7687'.
   547     12  ER-7689                 PIC X(4)    VALUE '7689'.
   548     12  ER-7690                 PIC X(4)    VALUE '7690'.
   549     12  ER-7691                 PIC X(4)    VALUE '7691'.
   550     12  ER-8003                 PIC X(4)    VALUE '8003'.
   551     12  ER-8051                 PIC X(4)    VALUE '8051'.
   552     12  ER-8052                 PIC X(4)    VALUE '8052'.
   553     12  ER-8053                 PIC X(4)    VALUE '8053'.
   554     12  ER-8054                 PIC X(4)    VALUE '8054'.
   555     12  ER-8055                 PIC X(4)    VALUE '8055'.
   556     12  ER-8056                 PIC X(4)    VALUE '8056'.
   557     12  ER-8057                 PIC X(4)    VALUE '8057'.
   558     12  ER-8058                 PIC X(4)    VALUE '8058'.
   559     12  ER-8059                 PIC X(4)    VALUE '8059'.
   560     12  ER-8060                 PIC X(4)    VALUE '8060'.
   561     12  ER-8061                 PIC X(4)    VALUE '8061'.
   562     12  ER-8062                 PIC X(4)    VALUE '8062'.
   563     12  ER-8063                 PIC X(4)    VALUE '8063'.
   564     12  ER-8064                 PIC X(4)    VALUE '8064'.
   565     12  ER-8065                 PIC X(4)    VALUE '8065'.
   566     12  ER-8066                 PIC X(4)    VALUE '8066'.
   567     12  ER-8152                 PIC X(4)    VALUE '8152'.
   568     12  ER-8153                 PIC X(4)    VALUE '8153'.
   569     12  ER-8154                 PIC X(4)    VALUE '8154'.
   570     12  ER-8155                 PIC X(4)    VALUE '8155'.
   571
   572 01  MSTR-KEY.
   573     12  COMPANY-CODE            PIC X.
   574     12  CARRIER-CODE            PIC X.
   575     12  CLAIM-NO                PIC X(7).
   576     12  CERT-NO.
   577         16  CERT-NO-PRIME       PIC X(10).
   578         16  CERT-NO-SUFX        PIC X.
   579
   580 01  WS-SAVE-CLAIM-KEY.
   581     12  WS-SAVE-COMPANY-CD      PIC X.
   582     12  WS-SAVE-CARRIER         PIC X.
   583     12  WS-SAVE-CLAIM-NO        PIC X(7).
   584     12  WS-SAVE-CERT-NO.
   585         16  WS-CERT-NO-PRIME    PIC X(10).
   586         16  WS-CERT-NO-SUFX     PIC X.
   587
   588 01  CERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  14
* EL131.cbl
   589     12  CERT-COMPANY-CODE       PIC X.
   590     12  CERT-CARRIER            PIC X.
   591     12  CERT-GROUP              PIC X(6).
   592     12  CERT-STATE              PIC XX.
   593     12  CERT-ACCOUNT            PIC X(10).
   594     12  CERT-DATE               PIC XX.
   595     12  CERT-CERT.
   596         16  CERT-CERT-PRIME     PIC X(10).
   597         16  CERT-CERT-SUFX      PIC X.
   598
   599 01  NOTE-KEY.
   600     12  NOTE-COMP-CD            PIC X.
   601     12  NOTE-CERT-KEY.
   602         16  NOTE-CARRIER        PIC X.
   603         16  NOTE-GROUP          PIC X(6).
   604         16  NOTE-STATE          PIC XX.
   605         16  NOTE-ACCOUNT        PIC X(10).
   606         16  NOTE-DATE           PIC XX.
   607         16  NOTE-CERT-NO        PIC X(11).
   608
   609 01  TRLR-KEY.
   610     12  TRLR-MAIN-KEY.
   611         16  TRLR-COMPANY-CD     PIC X.
   612         16  TRLR-CARRIER        PIC X.
   613         16  TRLR-CLAIM-NO       PIC X(07).
   614         16  TRLR-CERT-NO        PIC X(11).
   615     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   616
   617 01  BENEFIT-KEY.
   618     12  BEN-CO-ID               PIC X(3).
   619     12  BEN-REC-TYPE            PIC X.
   620     12  FILLER                  PIC XX.
   621     12  BEN-ACC-CD              PIC XX.
   622     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   623
   624 01  CNTL-KEY.
   625     12  CNTL-CO-ID              PIC X(3).
   626     12  CNTL-REC-TYPE           PIC X.
   627     12  CNTL-PROC-ID            PIC X(4).
   628     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   629         16  CNTL-STATE-NUMBER   PIC XX.
   630         16  FILLER              PIC XX.
   631     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   632         16  FILLER              PIC X(3).
   633         16  CNTL-CARRIER        PIC X.
   634     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   635
   636 01  ACTQ-KEY                    PIC X(20).
   637
   638 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   639
   640 01  CHKQ-KEY.
   641     12  CHKQ-COMPANY-CODE       PIC X.
   642     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   643     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   644
   645 01  ARCH-KEY.
   646     12  ARCH-COMPANY-CODE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  15
* EL131.cbl
   647     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   648     12  ARCH-RECORD-TYPE        PIC X.
   649     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   650
   651 01  ACCT-KEY.
   652     05  ACCT-PARTIAL-KEY.
   653         12  ACCT-COMPANY-CODE   PIC X.
   654         12  ACCT-CARRIER        PIC X.
   655         12  ACCT-GROUP          PIC X(6).
   656         12  ACCT-STATE          PIC XX.
   657         12  ACCT-ACCOUNT        PIC X(10).
   658     05  ACCT-DATE               PIC XX.
   659
   660 01  WS-ELBENE-KEY.
   661     12  WS-ELBENE-COMPANY-CD    PIC X.
   662     12  WS-ELBENE-RECORD-TYPE   PIC X.
   663     12  WS-ELBENE-ID            PIC X(10).
   664
   665 01  ELALPH-KEY.
   666     12  ELALPH-COMPANY-CD       PIC X.
   667     12  ELALPH-SOURCE           PIC X.
   668     12  ELALPH-NAME.
   669         16  ELALPH-LAST-NAME    PIC X(15).
   670         16  ELALPH-FIRST-NAME.
   671             20  ELALPH-FIRST-INIT   PIC X.
   672             20  FILLER              PIC X(11).
   673         16  ELALPH-MIDDLE-INIT  PIC X.
   674     12  ELALPH-DATE             PIC X(08).
   675     12  ELALPH-TIME             PIC S9(04)    COMP.
   676
   677 01  COMP-LENGTHS.
   678     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   679     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   680     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   681     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   682     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   683     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   684     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   685     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   686     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   687     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   688     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   689     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   690     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   691     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  16
* EL131.cbl
   693*                                COPY ELCLNKLT.
   694******************************************************************
   695*                                                                *
   696*                                                                *
   697*                           ELCLNKLT                             *
   698*                            VMOD=2.003                          *
   699*                                                                *
   700*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   701*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   702*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   703*                                                                *
   704*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   705*   COMPLETING THE REQUIRED FIELDS.                              *
   706*                                                                *
   707*   THE CALLING PROGRAM SHOULD CHECK:                            *
   708*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   709*                              9999 INDICATES AN UNKNOWN ABEND   *
   710*                                   WAS DETECTED.                *
   711*                              ALL OTHER VALUES ARE NORMAL ERROR *
   712*                              CODES FOUND IN THE ERROR FILE.    *
   713******************************************************************
   714 01  W-1523-LINKDATA.
   715     12  W-1523-COMMON-PI-DATA.
   716         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   717         16  FILLER              PIC  X(67).
   718         16  W-1523-COMPANY-CD   PIC  X(01).
   719         16  FILLER              PIC  X(10).
   720         16  W-1523-CONTROL-IN-PROGRESS.
   721             20  W-1523-CARRIER  PIC  X(01).
   722             20  W-1523-GROUPING PIC  X(06).
   723             20  W-1523-STATE    PIC  X(02).
   724             20  W-1523-ACCOUNT  PIC  X(10).
   725             20  W-1523-CLAIM-CERT-GRP.
   726                 24  W-1523-CLAIM-NO
   727                                 PIC  X(07).
   728                 24  W-1523-CERT-NO.
   729                     28  W-1523-CERT-PRIME
   730                                 PIC  X(10).
   731                     28  W-1523-CERT-SFX
   732                                 PIC  X(01).
   733                 24  W-1523-CERT-EFF-DT
   734                                 PIC  X(02).
   735         16  FILLER              PIC X(265).
   736
   737     12  W-1523-WORK-AREA.
   738         16  W-1523-FORM-NUMBER  PIC  X(04).
   739         16  W-1523-NUMBER-COPIES
   740                                 PIC  9(01).
   741         16  W-1523-ADDR-TYPE    PIC  X(02).
   742         16  W-1523-FOLLOW-UP-DATE
   743                                 PIC  X(02).
   744         16  W-1523-RESEND-DATE  PIC  X(02).
   745         16  W-1523-ERROR-CODE   PIC  9(04).
   746             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   747             88  W-1523-FATAL-ERROR
   748                                    VALUES  0006 0013 0042
   749                                            0154 0168 0169
   750                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  17
* EL131.cbl
   751                                            0179 0186 0281
   752                                            0332 2055 3697
   753                                            3698 3699 3770
   754                                            3771 3772 7675
   755                                            9106 9808 9883
   756                                            9887.
   757             88  W-1523-STOP-ERRORS
   758                                    VALUES  0013 0042 0154
   759                                            0168 0169 0172
   760                                            0281 0332 2055
   761                                            3698 3699 7675
   762                                            9106 9808 9883
   763                                            9999.
   764         16  W-1523-REASON       PIC  X(70).
   765         16  W-1523-ARCHIVE-NUMBER
   766                                 PIC  9(08).
   767     12  W-1523-POINTER-AREA.
   768         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   769         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   770         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   771         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   772         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  18
* EL131.cbl
   774*                                COPY ELCINTF.
   775******************************************************************
   776*                                                                *
   777*                                                                *
   778*                            ELCINTF.                            *
   779*                            VMOD=2.017                          *
   780*                                                                *
   781*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   782*                                                                *
   783*       LENGTH = 1024                                            *
   784*                                                                *
   785******************************************************************
   786*                   C H A N G E   L O G
   787*
   788* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   789*-----------------------------------------------------------------
   790*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   791* EFFECTIVE    NUMBER
   792*-----------------------------------------------------------------
   793* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   794******************************************************************
   795 01  PROGRAM-INTERFACE-BLOCK.
   796     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   797     12  PI-CALLING-PROGRAM              PIC X(8).
   798     12  PI-SAVED-PROGRAM-1              PIC X(8).
   799     12  PI-SAVED-PROGRAM-2              PIC X(8).
   800     12  PI-SAVED-PROGRAM-3              PIC X(8).
   801     12  PI-SAVED-PROGRAM-4              PIC X(8).
   802     12  PI-SAVED-PROGRAM-5              PIC X(8).
   803     12  PI-SAVED-PROGRAM-6              PIC X(8).
   804     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   805     12  PI-COMPANY-ID                   PIC XXX.
   806     12  PI-COMPANY-CD                   PIC X.
   807
   808     12  PI-COMPANY-PASSWORD             PIC X(8).
   809
   810     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   811
   812     12  PI-CONTROL-IN-PROGRESS.
   813         16  PI-CARRIER                  PIC X.
   814         16  PI-GROUPING                 PIC X(6).
   815         16  PI-STATE                    PIC XX.
   816         16  PI-ACCOUNT                  PIC X(10).
   817         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   818                                         PIC X(10).
   819         16  PI-CLAIM-CERT-GRP.
   820             20  PI-CLAIM-NO             PIC X(7).
   821             20  PI-CERT-NO.
   822                 25  PI-CERT-PRIME       PIC X(10).
   823                 25  PI-CERT-SFX         PIC X.
   824             20  PI-CERT-EFF-DT          PIC XX.
   825         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   826             20  PI-PLAN-CODE            PIC X(2).
   827             20  PI-REVISION-NUMBER      PIC X(3).
   828             20  PI-PLAN-EFF-DT          PIC X(2).
   829             20  PI-PLAN-EXP-DT          PIC X(2).
   830             20  FILLER                  PIC X(11).
   831         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  19
* EL131.cbl
   832             20  PI-OE-REFERENCE-1.
   833                 25  PI-OE-REF-1-PRIME   PIC X(18).
   834                 25  PI-OE-REF-1-SUFF    PIC XX.
   835
   836     12  PI-SESSION-IN-PROGRESS          PIC X.
   837         88  CLAIM-SESSION                   VALUE '1'.
   838         88  CREDIT-SESSION                  VALUE '2'.
   839         88  WARRANTY-SESSION                VALUE '3'.
   840         88  MORTGAGE-SESSION                VALUE '4'.
   841         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   842
   843
   844*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   845
   846     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   847     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   848
   849     12  PI-CREDIT-USER                  PIC X.
   850         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   851         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   852
   853     12  PI-CLAIM-USER                   PIC X.
   854         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   855         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   856
   857     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   858         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   859         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   860         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   861         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   862         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   863
   864     12  PI-PROCESSOR-ID                 PIC X(4).
   865
   866     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   867
   868     12  PI-MEMBER-CAPTION               PIC X(10).
   869
   870     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   871         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   872
   873     12  PI-LIFE-OVERRIDE-L1             PIC X.
   874     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   875     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   876     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   877
   878     12  PI-AH-OVERRIDE-L1               PIC X.
   879     12  PI-AH-OVERRIDE-L2               PIC XX.
   880     12  PI-AH-OVERRIDE-L6               PIC X(6).
   881     12  PI-AH-OVERRIDE-L12              PIC X(12).
   882
   883     12  PI-NEW-SYSTEM                   PIC X(2).
   884
   885     12  PI-PRIMARY-CERT-NO              PIC X(11).
   886     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   887         88  PI-USES-PAID-TO                 VALUE '1'.
   888     12  PI-CRDTCRD-SYSTEM.
   889         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  20
* EL131.cbl
   890             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   891             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   892         16  PI-CC-MONTH-END-DT          PIC XX.
   893     12  PI-PROCESSOR-PRINTER            PIC X(4).
   894
   895     12  PI-OE-REFERENCE-2.
   896         16  PI-OE-REF-2-PRIME           PIC X(10).
   897         16  PI-OE-REF-2-SUFF            PIC X.
   898
   899     12  PI-REM-TRM-CALC-OPTION          PIC X.
   900
   901     12  PI-LANGUAGE-TYPE                PIC X.
   902             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   903             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   904             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   905
   906     12  PI-POLICY-LINKAGE-IND           PIC X.
   907         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   908         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   909                                                   LOW-VALUES.
   910
   911     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   912     12  PI-CLAIM-PW-SESSION             PIC X(1).
   913         88  PI-CLAIM-CREDIT                 VALUE '1'.
   914         88  PI-CLAIM-CONVEN                 VALUE '2'.
   915
   916     12  PI-PROCESSOR-CSR-IND            PIC X.
   917         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   918         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   919
   920     12  FILLER                          PIC X(3).
   921
   922     12  PI-SYSTEM-LEVEL                 PIC X(145).
   923
   924     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   925         PI-SYSTEM-LEVEL.
   926
   927         16  PI-ENTRY-CODES.
   928             20  PI-ENTRY-CD-1           PIC X.
   929             20  PI-ENTRY-CD-2           PIC X.
   930
   931         16  PI-RETURN-CODES.
   932             20  PI-RETURN-CD-1          PIC X.
   933             20  PI-RETURN-CD-2          PIC X.
   934
   935         16  PI-UPDATE-STATUS-SAVE.
   936             20  PI-UPDATE-BY            PIC X(4).
   937             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   938
   939         16  PI-LOWER-CASE-LETTERS       PIC X.
   940             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   941
   942*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   943*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   944*            88  CARRIER-CLM-CNTL            VALUE '2'.
   945
   946         16  PI-CERT-ACCESS-CONTROL      PIC X.
   947             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  21
* EL131.cbl
   948             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   949             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   950             88  ACCNT-CNTL                  VALUE '3'.
   951             88  CARR-ACCNT-CNTL             VALUE '4'.
   952
   953         16  PI-PROCESSOR-CAP-LIST.
   954             20  PI-SYSTEM-CONTROLS.
   955                24 PI-SYSTEM-DISPLAY     PIC X.
   956                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   957                24 PI-SYSTEM-MODIFY      PIC X.
   958                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   959             20  FILLER                  PIC XX.
   960             20  PI-DISPLAY-CAP          PIC X.
   961                 88  DISPLAY-CAP             VALUE 'Y'.
   962             20  PI-MODIFY-CAP           PIC X.
   963                 88  MODIFY-CAP              VALUE 'Y'.
   964             20  PI-MSG-AT-LOGON-CAP     PIC X.
   965                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   966             20  PI-FORCE-CAP            PIC X.
   967                 88  FORCE-CAP               VALUE 'Y'.
   968
   969         16  PI-PROGRAM-CONTROLS.
   970             20  PI-PGM-PRINT-OPT        PIC X.
   971             20  PI-PGM-FORMAT-OPT       PIC X.
   972             20  PI-PGM-PROCESS-OPT      PIC X.
   973             20  PI-PGM-TOTALS-OPT       PIC X.
   974
   975         16  PI-HELP-INTERFACE.
   976             20  PI-LAST-ERROR-NO        PIC X(4).
   977             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   978
   979         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   980             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   981
   982         16  PI-CR-CONTROL-IN-PROGRESS.
   983             20  PI-CR-CARRIER           PIC X.
   984             20  PI-CR-GROUPING          PIC X(6).
   985             20  PI-CR-STATE             PIC XX.
   986             20  PI-CR-ACCOUNT           PIC X(10).
   987             20  PI-CR-FIN-RESP          PIC X(10).
   988             20  PI-CR-TYPE              PIC X.
   989
   990         16  PI-CR-BATCH-NUMBER          PIC X(6).
   991
   992         16  PI-CR-MONTH-END-DT          PIC XX.
   993
   994         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   995             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   996             88  PI-ZERO-CARRIER             VALUE '1'.
   997             88  PI-ZERO-GROUPING            VALUE '2'.
   998             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   999
  1000         16  PI-CARRIER-SECURITY         PIC X.
  1001             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1002
  1003         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1004             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1005             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  22
* EL131.cbl
  1006
  1007         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1008             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1009                                         INDEXED BY PI-ACCESS-NDX
  1010                                         PIC X.
  1011
  1012         16  PI-GA-BILLING-CONTROL       PIC X.
  1013             88  PI-GA-BILLING               VALUE '1'.
  1014
  1015         16  PI-MAIL-PROCESSING          PIC X.
  1016             88  PI-MAIL-YES                 VALUE 'Y'.
  1017
  1018         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1019
  1020         16  PI-AR-SYSTEM.
  1021             20  PI-AR-PROCESSING-CNTL   PIC X.
  1022                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1023             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1024             20  PI-AR-MONTH-END-DT      PIC XX.
  1025
  1026         16  PI-MP-SYSTEM.
  1027             20  PI-MORTGAGE-USER            PIC X.
  1028                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1029                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1030             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1031                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1032                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1033                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1034                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1035                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1036             20  PI-MP-MONTH-END-DT          PIC XX.
  1037             20  PI-MP-REFERENCE-NO.
  1038                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1039                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1040
  1041         16  PI-LABEL-CONTROL            PIC X(01).
  1042             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1043             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1044
  1045         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1046             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1047
  1048         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1049             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1050             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1051
  1052         16  FILLER                      PIC X(14).
  1053
  1054     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1055******************************************************************
  1056     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1057         16  PI-NO-PMTS                    PIC 9(4).
  1058         16  PI-CERT-SWITCH                PIC X.
  1059             88  CREATED-CERT              VALUE '2'.
  1060         16  PI-PREM-TYPE                  PIC X.
  1061         16  PI-SAVE-CERT-NO.
  1062             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1063             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  23
* EL131.cbl
  1064         16  FILLER                        PIC X(46).
  1065         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1066         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1067         16  PI-REC-FOUND-SW               PIC X.
  1068         16  PI-LETTER-SW                  PIC X.
  1069         16  PI-PREV-TRLR-KEY              PIC X(22).
  1070         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1071         16  FILLER                        PIC X(545).
  1072
  1073 01  SAVE-RECORD                 PIC X(450).
  1074
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  24
* EL131.cbl
  1076*                                COPY ELCLOGOF SUPPRESS.
  1077******************************************************************
  1078*                                                                *
  1079*                                                                *
  1080*                            ELCLOGOF.                           *
  1081*                            VMOD=2.001                          *
  1082*                                                                *
  1083*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1084*                                                                *
  1085******************************************************************
  1086 01  CLASIC-LOGOFF.
  1087     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1088     12  LOGOFF-TEXT.
  1089         16  FILLER          PIC X(5)    VALUE SPACES.
  1090         16  LOGOFF-MSG.
  1091             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1092             20  FILLER      PIC X       VALUE SPACES.
  1093             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1094         16  FILLER          PIC X(80)
  1095           VALUE '* YOU ARE NOW LOGGED OFF'.
  1096         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1097         16  FILLER          PIC X       VALUE QUOTE.
  1098         16  LOGOFF-SYS-MSG  PIC X(17)
  1099           VALUE 'S CLAS-IC SYSTEM '.
  1100     12  TEXT-MESSAGES.
  1101         16  UNACCESS-MSG    PIC X(29)
  1102             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1103         16  PGMIDERR-MSG    PIC X(17)
  1104             VALUE 'PROGRAM NOT FOUND'.
  1105
  1106*                                COPY ELCATTR SUPPRESS.
  1107******************************************************************
  1108*                                                                *
  1109*                            ELCATTR.                            *
  1110*                            VMOD=2.001                          *
  1111*                                                                *
  1112*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1113*                                                                *
  1114*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1115*                                                                *
  1116*                   POS 1   P=PROTECTED                          *
  1117*                           U=UNPROTECTED                        *
  1118*                           S=ASKIP                              *
  1119*                   POS 2   A=ALPHA/NUMERIC                      *
  1120*                           N=NUMERIC                            *
  1121*                   POS 3   N=NORMAL                             *
  1122*                           B=BRIGHT                             *
  1123*                           D=DARK                               *
  1124*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1125*                           OF=MODIFIED DATA TAG OFF             *
  1126*                                                                *
  1127*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1128******************************************************************
  1129 01  ATTRIBUTE-LIST.
  1130     12  AL-PABOF            PIC X       VALUE 'Y'.
  1131     12  AL-PABON            PIC X       VALUE 'Z'.
  1132     12  AL-PADOF            PIC X       VALUE '%'.
  1133     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  25
* EL131.cbl
  1134     12  AL-PANOF            PIC X       VALUE '-'.
  1135     12  AL-PANON            PIC X       VALUE '/'.
  1136     12  AL-SABOF            PIC X       VALUE '8'.
  1137     12  AL-SABON            PIC X       VALUE '9'.
  1138     12  AL-SADOF            PIC X       VALUE '@'.
  1139     12  AL-SADON            PIC X       VALUE QUOTE.
  1140     12  AL-SANOF            PIC X       VALUE '0'.
  1141     12  AL-SANON            PIC X       VALUE '1'.
  1142     12  AL-UABOF            PIC X       VALUE 'H'.
  1143     12  AL-UABON            PIC X       VALUE 'I'.
  1144     12  AL-UADOF            PIC X       VALUE '<'.
  1145     12  AL-UADON            PIC X       VALUE '('.
  1146     12  AL-UANOF            PIC X       VALUE ' '.
  1147     12  AL-UANON            PIC X       VALUE 'A'.
  1148     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1149     12  AL-UNBON            PIC X       VALUE 'R'.
  1150     12  AL-UNDOF            PIC X       VALUE '*'.
  1151     12  AL-UNDON            PIC X       VALUE ')'.
  1152     12  AL-UNNOF            PIC X       VALUE '&'.
  1153     12  AL-UNNON            PIC X       VALUE 'J'.
  1154
  1155*                                COPY ELCAID SUPPRESS.
  1156******************************************************************
  1157*                                                                *
  1158*                            ELCAID.                             *
  1159*                            VMOD=2.001                          *
  1160*                                                                *
  1161*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1162*                                                                *
  1163*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1164*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1165******************************************************************
  1166
  1167 01  DFHAID.
  1168   02  DFHNULL   PIC  X  VALUE  ' '.
  1169   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1170   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1171   02  DFHPEN    PIC  X  VALUE  '='.
  1172   02  DFHOPID   PIC  X  VALUE  'W'.
  1173   02  DFHPA1    PIC  X  VALUE  '%'.
  1174   02  DFHPA2    PIC  X  VALUE  '>'.
  1175   02  DFHPA3    PIC  X  VALUE  ','.
  1176   02  DFHPF1    PIC  X  VALUE  '1'.
  1177   02  DFHPF2    PIC  X  VALUE  '2'.
  1178   02  DFHPF3    PIC  X  VALUE  '3'.
  1179   02  DFHPF4    PIC  X  VALUE  '4'.
  1180   02  DFHPF5    PIC  X  VALUE  '5'.
  1181   02  DFHPF6    PIC  X  VALUE  '6'.
  1182   02  DFHPF7    PIC  X  VALUE  '7'.
  1183   02  DFHPF8    PIC  X  VALUE  '8'.
  1184   02  DFHPF9    PIC  X  VALUE  '9'.
  1185   02  DFHPF10   PIC  X  VALUE  ':'.
  1186   02  DFHPF11   PIC  X  VALUE  '#'.
  1187   02  DFHPF12   PIC  X  VALUE  '@'.
  1188   02  DFHPF13   PIC  X  VALUE  'A'.
  1189   02  DFHPF14   PIC  X  VALUE  'B'.
  1190   02  DFHPF15   PIC  X  VALUE  'C'.
  1191   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  26
* EL131.cbl
  1192   02  DFHPF17   PIC  X  VALUE  'E'.
  1193   02  DFHPF18   PIC  X  VALUE  'F'.
  1194   02  DFHPF19   PIC  X  VALUE  'G'.
  1195   02  DFHPF20   PIC  X  VALUE  'H'.
  1196   02  DFHPF21   PIC  X  VALUE  'I'.
  1197*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1198   02  DFHPF22   PIC  X  VALUE  '['.
  1199   02  DFHPF23   PIC  X  VALUE  '.'.
  1200   02  DFHPF24   PIC  X  VALUE  '<'.
  1201   02  DFHMSRE   PIC  X  VALUE  'X'.
  1202   02  DFHSTRF   PIC  X  VALUE  'h'.
  1203   02  DFHTRIG   PIC  X  VALUE  '"'.
  1204 01  FILLER REDEFINES DFHAID.
  1205     12  FILLER                  PIC X(8).
  1206     12  AID-KEYS OCCURS 24 TIMES.
  1207         16  FILLER              PIC X.
  1208
  1209*                                COPY EL131S.
  1210 01  EL131AI.
  1211     05  FILLER            PIC  X(0012).
  1212*    -------------------------------
  1213     05  DATEL PIC S9(0004) COMP.
  1214     05  DATEF PIC  X(0001).
  1215     05  FILLER REDEFINES DATEF.
  1216         10  DATEA PIC  X(0001).
  1217     05  DATEI PIC  X(0008).
  1218*    -------------------------------
  1219     05  TIMEL PIC S9(0004) COMP.
  1220     05  TIMEF PIC  X(0001).
  1221     05  FILLER REDEFINES TIMEF.
  1222         10  TIMEA PIC  X(0001).
  1223     05  TIMEI PIC  X(0005).
  1224*    -------------------------------
  1225     05  SEQUL PIC S9(0004) COMP.
  1226     05  SEQUF PIC  X(0001).
  1227     05  FILLER REDEFINES SEQUF.
  1228         10  SEQUA PIC  X(0001).
  1229     05  SEQUI PIC  X(0010).
  1230*    -------------------------------
  1231     05  COMPL PIC S9(0004) COMP.
  1232     05  COMPF PIC  X(0001).
  1233     05  FILLER REDEFINES COMPF.
  1234         10  COMPA PIC  X(0001).
  1235     05  COMPI PIC  X(0003).
  1236*    -------------------------------
  1237     05  USERIDL PIC S9(0004) COMP.
  1238     05  USERIDF PIC  X(0001).
  1239     05  FILLER REDEFINES USERIDF.
  1240         10  USERIDA PIC  X(0001).
  1241     05  USERIDI PIC  X(0004).
  1242*    -------------------------------
  1243     05  CCNOL PIC S9(0004) COMP.
  1244     05  CCNOF PIC  X(0001).
  1245     05  FILLER REDEFINES CCNOF.
  1246         10  CCNOA PIC  X(0001).
  1247     05  CCNOI PIC  X(0016).
  1248*    -------------------------------
  1249     05  MAINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  27
* EL131.cbl
  1250     05  MAINTF PIC  X(0001).
  1251     05  FILLER REDEFINES MAINTF.
  1252         10  MAINTA PIC  X(0001).
  1253     05  MAINTI PIC  X(0001).
  1254*    -------------------------------
  1255     05  CLAIML PIC S9(0004) COMP.
  1256     05  CLAIMF PIC  X(0001).
  1257     05  FILLER REDEFINES CLAIMF.
  1258         10  CLAIMA PIC  X(0001).
  1259     05  CLAIMI PIC  X(0007).
  1260*    -------------------------------
  1261     05  CARRL PIC S9(0004) COMP.
  1262     05  CARRF PIC  X(0001).
  1263     05  FILLER REDEFINES CARRF.
  1264         10  CARRA PIC  X(0001).
  1265     05  CARRI PIC  X(0001).
  1266*    -------------------------------
  1267     05  CERTL PIC S9(0004) COMP.
  1268     05  CERTF PIC  X(0001).
  1269     05  FILLER REDEFINES CERTF.
  1270         10  CERTA PIC  X(0001).
  1271     05  CERTI PIC  X(0010).
  1272*    -------------------------------
  1273     05  SUFXL PIC S9(0004) COMP.
  1274     05  SUFXF PIC  X(0001).
  1275     05  FILLER REDEFINES SUFXF.
  1276         10  SUFXA PIC  X(0001).
  1277     05  SUFXI PIC  X(0001).
  1278*    -------------------------------
  1279     05  TYPEL PIC S9(0004) COMP.
  1280     05  TYPEF PIC  X(0001).
  1281     05  FILLER REDEFINES TYPEF.
  1282         10  TYPEA PIC  X(0001).
  1283     05  TYPEI PIC  X(0001).
  1284*    -------------------------------
  1285     05  LABEL1L PIC S9(0004) COMP.
  1286     05  LABEL1F PIC  X(0001).
  1287     05  FILLER REDEFINES LABEL1F.
  1288         10  LABEL1A PIC  X(0001).
  1289     05  LABEL1I PIC  X(0011).
  1290*    -------------------------------
  1291     05  PCERTNOL PIC S9(0004) COMP.
  1292     05  PCERTNOF PIC  X(0001).
  1293     05  FILLER REDEFINES PCERTNOF.
  1294         10  PCERTNOA PIC  X(0001).
  1295     05  PCERTNOI PIC  X(0010).
  1296*    -------------------------------
  1297     05  PSUFXL PIC S9(0004) COMP.
  1298     05  PSUFXF PIC  X(0001).
  1299     05  FILLER REDEFINES PSUFXF.
  1300         10  PSUFXA PIC  X(0001).
  1301     05  PSUFXI PIC  X(0001).
  1302*    -------------------------------
  1303     05  STATUSL PIC S9(0004) COMP.
  1304     05  STATUSF PIC  X(0001).
  1305     05  FILLER REDEFINES STATUSF.
  1306         10  STATUSA PIC  X(0001).
  1307     05  STATUSI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  28
* EL131.cbl
  1308*    -------------------------------
  1309     05  INCL PIC S9(0004) COMP.
  1310     05  INCF PIC  X(0001).
  1311     05  FILLER REDEFINES INCF.
  1312         10  INCA PIC  X(0001).
  1313     05  INCI PIC  X(0008).
  1314*    -------------------------------
  1315     05  REPL PIC S9(0004) COMP.
  1316     05  REPF PIC  X(0001).
  1317     05  FILLER REDEFINES REPF.
  1318         10  REPA PIC  X(0001).
  1319     05  REPI PIC  X(0008).
  1320*    -------------------------------
  1321     05  CAUSEL PIC S9(0004) COMP.
  1322     05  CAUSEF PIC  X(0001).
  1323     05  FILLER REDEFINES CAUSEF.
  1324         10  CAUSEA PIC  X(0001).
  1325     05  CAUSEI PIC  X(0006).
  1326*    -------------------------------
  1327     05  ENDL PIC S9(0004) COMP.
  1328     05  ENDF PIC  X(0001).
  1329     05  FILLER REDEFINES ENDF.
  1330         10  ENDA PIC  X(0001).
  1331     05  ENDI PIC  X(0008).
  1332*    -------------------------------
  1333     05  DIAGL PIC S9(0004) COMP.
  1334     05  DIAGF PIC  X(0001).
  1335     05  FILLER REDEFINES DIAGF.
  1336         10  DIAGA PIC  X(0001).
  1337     05  DIAGI PIC  X(0060).
  1338*    -------------------------------
  1339     05  BENEL PIC S9(0004) COMP.
  1340     05  BENEF PIC  X(0001).
  1341     05  FILLER REDEFINES BENEF.
  1342         10  BENEA PIC  X(0001).
  1343     05  BENEI PIC  X(0010).
  1344*    -------------------------------
  1345     05  BIRTHL PIC S9(0004) COMP.
  1346     05  BIRTHF PIC  X(0001).
  1347     05  FILLER REDEFINES BIRTHF.
  1348         10  BIRTHA PIC  X(0001).
  1349     05  BIRTHI PIC  X(0008).
  1350*    -------------------------------
  1351     05  SOCIALL PIC S9(0004) COMP.
  1352     05  SOCIALF PIC  X(0001).
  1353     05  FILLER REDEFINES SOCIALF.
  1354         10  SOCIALA PIC  X(0001).
  1355     05  SOCIALI PIC  X(0011).
  1356*    -------------------------------
  1357     05  SEXL PIC S9(0004) COMP.
  1358     05  SEXF PIC  X(0001).
  1359     05  FILLER REDEFINES SEXF.
  1360         10  SEXA PIC  X(0001).
  1361     05  SEXI PIC  X(0001).
  1362*    -------------------------------
  1363     05  MLNAMEL PIC S9(0004) COMP.
  1364     05  MLNAMEF PIC  X(0001).
  1365     05  FILLER REDEFINES MLNAMEF.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  29
* EL131.cbl
  1366         10  MLNAMEA PIC  X(0001).
  1367     05  MLNAMEI PIC  X(0015).
  1368*    -------------------------------
  1369     05  MFNAMEL PIC S9(0004) COMP.
  1370     05  MFNAMEF PIC  X(0001).
  1371     05  FILLER REDEFINES MFNAMEF.
  1372         10  MFNAMEA PIC  X(0001).
  1373     05  MFNAMEI PIC  X(0012).
  1374*    -------------------------------
  1375     05  MMINITL PIC S9(0004) COMP.
  1376     05  MMINITF PIC  X(0001).
  1377     05  FILLER REDEFINES MMINITF.
  1378         10  MMINITA PIC  X(0001).
  1379     05  MMINITI PIC  X(0001).
  1380*    -------------------------------
  1381     05  LOANNOL PIC S9(0004) COMP.
  1382     05  LOANNOF PIC  X(0001).
  1383     05  FILLER REDEFINES LOANNOF.
  1384         10  LOANNOA PIC  X(0001).
  1385     05  LOANNOI PIC  X(0008).
  1386*    -------------------------------
  1387     05  CRTLNMEL PIC S9(0004) COMP.
  1388     05  CRTLNMEF PIC  X(0001).
  1389     05  FILLER REDEFINES CRTLNMEF.
  1390         10  CRTLNMEA PIC  X(0001).
  1391     05  CRTLNMEI PIC  X(0015).
  1392*    -------------------------------
  1393     05  CRTFNMEL PIC S9(0004) COMP.
  1394     05  CRTFNMEF PIC  X(0001).
  1395     05  FILLER REDEFINES CRTFNMEF.
  1396         10  CRTFNMEA PIC  X(0001).
  1397     05  CRTFNMEI PIC  X(0012).
  1398*    -------------------------------
  1399     05  CRTINITL PIC S9(0004) COMP.
  1400     05  CRTINITF PIC  X(0001).
  1401     05  FILLER REDEFINES CRTINITF.
  1402         10  CRTINITA PIC  X(0001).
  1403     05  CRTINITI PIC  X(0001).
  1404*    -------------------------------
  1405     05  LOANBALL PIC S9(0004) COMP.
  1406     05  LOANBALF PIC  X(0001).
  1407     05  FILLER REDEFINES LOANBALF.
  1408         10  LOANBALA PIC  X(0001).
  1409     05  LOANBALI PIC  9(7)V99.
  1410*    -------------------------------
  1411     05  PROCL PIC S9(0004) COMP.
  1412     05  PROCF PIC  X(0001).
  1413     05  FILLER REDEFINES PROCF.
  1414         10  PROCA PIC  X(0001).
  1415     05  PROCI PIC  X(0004).
  1416*    -------------------------------
  1417     05  SUPVL PIC S9(0004) COMP.
  1418     05  SUPVF PIC  X(0001).
  1419     05  FILLER REDEFINES SUPVF.
  1420         10  SUPVA PIC  X(0001).
  1421     05  SUPVI PIC  X(0001).
  1422*    -------------------------------
  1423     05  PRICDL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  30
* EL131.cbl
  1424     05  PRICDF PIC  X(0001).
  1425     05  FILLER REDEFINES PRICDF.
  1426         10  PRICDA PIC  X(0001).
  1427     05  PRICDI PIC  X(0001).
  1428*    -------------------------------
  1429     05  FILETOL PIC S9(0004) COMP.
  1430     05  FILETOF PIC  X(0001).
  1431     05  FILLER REDEFINES FILETOF.
  1432         10  FILETOA PIC  X(0001).
  1433     05  FILETOI PIC  X(0004).
  1434*    -------------------------------
  1435     05  PTHRHDGL PIC S9(0004) COMP.
  1436     05  PTHRHDGF PIC  X(0001).
  1437     05  FILLER REDEFINES PTHRHDGF.
  1438         10  PTHRHDGA PIC  X(0001).
  1439     05  PTHRHDGI PIC  X(0010).
  1440*    -------------------------------
  1441     05  PDTHRUL PIC S9(0004) COMP.
  1442     05  PDTHRUF PIC  X(0001).
  1443     05  FILLER REDEFINES PDTHRUF.
  1444         10  PDTHRUA PIC  X(0001).
  1445     05  PDTHRUI PIC  X(0008).
  1446*    -------------------------------
  1447     05  PDAMTL PIC S9(0004) COMP.
  1448     05  PDAMTF PIC  X(0001).
  1449     05  FILLER REDEFINES PDAMTF.
  1450         10  PDAMTA PIC  X(0001).
  1451     05  PDAMTI PIC  9(7)V99.
  1452*    -------------------------------
  1453     05  NODAYSL PIC S9(0004) COMP.
  1454     05  NODAYSF PIC  X(0001).
  1455     05  FILLER REDEFINES NODAYSF.
  1456         10  NODAYSA PIC  X(0001).
  1457     05  NODAYSI PIC  9(5).
  1458*    -------------------------------
  1459     05  NOPMTSL PIC S9(0004) COMP.
  1460     05  NOPMTSF PIC  X(0001).
  1461     05  FILLER REDEFINES NOPMTSF.
  1462         10  NOPMTSA PIC  X(0001).
  1463     05  NOPMTSI PIC  9(4).
  1464*    -------------------------------
  1465     05  FORMTYPL PIC S9(0004) COMP.
  1466     05  FORMTYPF PIC  X(0001).
  1467     05  FILLER REDEFINES FORMTYPF.
  1468         10  FORMTYPA PIC  X(0001).
  1469     05  FORMTYPI PIC  X(0001).
  1470*    -------------------------------
  1471     05  ESTL PIC S9(0004) COMP.
  1472     05  ESTF PIC  X(0001).
  1473     05  FILLER REDEFINES ESTF.
  1474         10  ESTA PIC  X(0001).
  1475     05  ESTI PIC  X(0008).
  1476*    -------------------------------
  1477     05  AUIDL PIC S9(0004) COMP.
  1478     05  AUIDF PIC  X(0001).
  1479     05  FILLER REDEFINES AUIDF.
  1480         10  AUIDA PIC  X(0001).
  1481     05  AUIDI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  31
* EL131.cbl
  1482*    -------------------------------
  1483     05  OCCL PIC S9(0004) COMP.
  1484     05  OCCF PIC  X(0001).
  1485     05  FILLER REDEFINES OCCF.
  1486         10  OCCA PIC  X(0001).
  1487     05  OCCI PIC  X(0006).
  1488*    -------------------------------
  1489     05  MNTDTL PIC S9(0004) COMP.
  1490     05  MNTDTF PIC  X(0001).
  1491     05  FILLER REDEFINES MNTDTF.
  1492         10  MNTDTA PIC  X(0001).
  1493     05  MNTDTI PIC  X(0008).
  1494*    -------------------------------
  1495     05  MNTTYPEL PIC S9(0004) COMP.
  1496     05  MNTTYPEF PIC  X(0001).
  1497     05  FILLER REDEFINES MNTTYPEF.
  1498         10  MNTTYPEA PIC  X(0001).
  1499     05  MNTTYPEI PIC  X(0006).
  1500*    -------------------------------
  1501     05  CERTCARL PIC S9(0004) COMP.
  1502     05  CERTCARF PIC  X(0001).
  1503     05  FILLER REDEFINES CERTCARF.
  1504         10  CERTCARA PIC  X(0001).
  1505     05  CERTCARI PIC  X(0001).
  1506*    -------------------------------
  1507     05  CERTGRPL PIC S9(0004) COMP.
  1508     05  CERTGRPF PIC  X(0001).
  1509     05  FILLER REDEFINES CERTGRPF.
  1510         10  CERTGRPA PIC  X(0001).
  1511     05  CERTGRPI PIC  X(0006).
  1512*    -------------------------------
  1513     05  CERTSTL PIC S9(0004) COMP.
  1514     05  CERTSTF PIC  X(0001).
  1515     05  FILLER REDEFINES CERTSTF.
  1516         10  CERTSTA PIC  X(0001).
  1517     05  CERTSTI PIC  X(0002).
  1518*    -------------------------------
  1519     05  CERTACTL PIC S9(0004) COMP.
  1520     05  CERTACTF PIC  X(0001).
  1521     05  FILLER REDEFINES CERTACTF.
  1522         10  CERTACTA PIC  X(0001).
  1523     05  CERTACTI PIC  X(0010).
  1524*    -------------------------------
  1525     05  CERTEFFL PIC S9(0004) COMP.
  1526     05  CERTEFFF PIC  X(0001).
  1527     05  FILLER REDEFINES CERTEFFF.
  1528         10  CERTEFFA PIC  X(0001).
  1529     05  CERTEFFI PIC  X(0008).
  1530*    -------------------------------
  1531     05  ISSAGEL PIC S9(0004) COMP.
  1532     05  ISSAGEF PIC  X(0001).
  1533     05  FILLER REDEFINES ISSAGEF.
  1534         10  ISSAGEA PIC  X(0001).
  1535     05  ISSAGEI PIC  X(0002).
  1536*    -------------------------------
  1537     05  APRL PIC S9(0004) COMP.
  1538     05  APRF PIC  X(0001).
  1539     05  FILLER REDEFINES APRF.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  32
* EL131.cbl
  1540         10  APRA PIC  X(0001).
  1541     05  APRI PIC  9(4)V9(4).
  1542*    -------------------------------
  1543     05  PMTFREQL PIC S9(0004) COMP.
  1544     05  PMTFREQF PIC  X(0001).
  1545     05  FILLER REDEFINES PMTFREQF.
  1546         10  PMTFREQA PIC  X(0001).
  1547     05  PMTFREQI PIC  99.
  1548*    -------------------------------
  1549     05  INDGRPL PIC S9(0004) COMP.
  1550     05  INDGRPF PIC  X(0001).
  1551     05  FILLER REDEFINES INDGRPF.
  1552         10  INDGRPA PIC  X(0001).
  1553     05  INDGRPI PIC  X(0001).
  1554*    -------------------------------
  1555     05  PREMTYPL PIC S9(0004) COMP.
  1556     05  PREMTYPF PIC  X(0001).
  1557     05  FILLER REDEFINES PREMTYPF.
  1558         10  PREMTYPA PIC  X(0001).
  1559     05  PREMTYPI PIC  X(0001).
  1560*    -------------------------------
  1561     05  REINCDL PIC S9(0004) COMP.
  1562     05  REINCDF PIC  X(0001).
  1563     05  FILLER REDEFINES REINCDF.
  1564         10  REINCDA PIC  X(0001).
  1565     05  REINCDI PIC  X(0001).
  1566*    -------------------------------
  1567     05  JNTLNMEL PIC S9(0004) COMP.
  1568     05  JNTLNMEF PIC  X(0001).
  1569     05  FILLER REDEFINES JNTLNMEF.
  1570         10  JNTLNMEA PIC  X(0001).
  1571     05  JNTLNMEI PIC  X(0015).
  1572*    -------------------------------
  1573     05  JNTFNMEL PIC S9(0004) COMP.
  1574     05  JNTFNMEF PIC  X(0001).
  1575     05  FILLER REDEFINES JNTFNMEF.
  1576         10  JNTFNMEA PIC  X(0001).
  1577     05  JNTFNMEI PIC  X(0012).
  1578*    -------------------------------
  1579     05  JNTINITL PIC S9(0004) COMP.
  1580     05  JNTINITF PIC  X(0001).
  1581     05  FILLER REDEFINES JNTINITF.
  1582         10  JNTINITA PIC  X(0001).
  1583     05  JNTINITI PIC  X(0001).
  1584*    -------------------------------
  1585     05  JNTAGEL PIC S9(0004) COMP.
  1586     05  JNTAGEF PIC  X(0001).
  1587     05  FILLER REDEFINES JNTAGEF.
  1588         10  JNTAGEA PIC  X(0001).
  1589     05  JNTAGEI PIC  X(0002).
  1590*    -------------------------------
  1591     05  ADDONDTL PIC S9(0004) COMP.
  1592     05  ADDONDTF PIC  X(0001).
  1593     05  FILLER REDEFINES ADDONDTF.
  1594         10  ADDONDTA PIC  X(0001).
  1595     05  ADDONDTI PIC  X(0008).
  1596*    -------------------------------
  1597     05  LCVDSCRL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  33
* EL131.cbl
  1598     05  LCVDSCRF PIC  X(0001).
  1599     05  FILLER REDEFINES LCVDSCRF.
  1600         10  LCVDSCRA PIC  X(0001).
  1601     05  LCVDSCRI PIC  X(0006).
  1602*    -------------------------------
  1603     05  LCVKINDL PIC S9(0004) COMP.
  1604     05  LCVKINDF PIC  X(0001).
  1605     05  FILLER REDEFINES LCVKINDF.
  1606         10  LCVKINDA PIC  X(0001).
  1607     05  LCVKINDI PIC  X(0003).
  1608*    -------------------------------
  1609     05  LCVCDL PIC S9(0004) COMP.
  1610     05  LCVCDF PIC  X(0001).
  1611     05  FILLER REDEFINES LCVCDF.
  1612         10  LCVCDA PIC  X(0001).
  1613     05  LCVCDI PIC  X(0002).
  1614*    -------------------------------
  1615     05  LCVOTRML PIC S9(0004) COMP.
  1616     05  LCVOTRMF PIC  X(0001).
  1617     05  FILLER REDEFINES LCVOTRMF.
  1618         10  LCVOTRMA PIC  X(0001).
  1619     05  LCVOTRMI PIC  999.
  1620*    -------------------------------
  1621     05  LCVRTRML PIC S9(0004) COMP.
  1622     05  LCVRTRMF PIC  X(0001).
  1623     05  FILLER REDEFINES LCVRTRMF.
  1624         10  LCVRTRMA PIC  X(0001).
  1625     05  LCVRTRMI PIC  X(0003).
  1626*    -------------------------------
  1627     05  LCVRATEL PIC S9(0004) COMP.
  1628     05  LCVRATEF PIC  X(0001).
  1629     05  FILLER REDEFINES LCVRATEF.
  1630         10  LCVRATEA PIC  X(0001).
  1631     05  LCVRATEI PIC  9999V99.
  1632*    -------------------------------
  1633     05  LCVBENEL PIC S9(0004) COMP.
  1634     05  LCVBENEF PIC  X(0001).
  1635     05  FILLER REDEFINES LCVBENEF.
  1636         10  LCVBENEA PIC  X(0001).
  1637     05  LCVBENEI PIC  9(9)V99.
  1638*    -------------------------------
  1639     05  LCVFORML PIC S9(0004) COMP.
  1640     05  LCVFORMF PIC  X(0001).
  1641     05  FILLER REDEFINES LCVFORMF.
  1642         10  LCVFORMA PIC  X(0001).
  1643     05  LCVFORMI PIC  X(0012).
  1644*    -------------------------------
  1645     05  LCVCNDTL PIC S9(0004) COMP.
  1646     05  LCVCNDTF PIC  X(0001).
  1647     05  FILLER REDEFINES LCVCNDTF.
  1648         10  LCVCNDTA PIC  X(0001).
  1649     05  LCVCNDTI PIC  X(0008).
  1650*    -------------------------------
  1651     05  LCVEXITL PIC S9(0004) COMP.
  1652     05  LCVEXITF PIC  X(0001).
  1653     05  FILLER REDEFINES LCVEXITF.
  1654         10  LCVEXITA PIC  X(0001).
  1655     05  LCVEXITI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  34
* EL131.cbl
  1656*    -------------------------------
  1657     05  LCVSTATL PIC S9(0004) COMP.
  1658     05  LCVSTATF PIC  X(0001).
  1659     05  FILLER REDEFINES LCVSTATF.
  1660         10  LCVSTATA PIC  X(0001).
  1661     05  LCVSTATI PIC  X(0006).
  1662*    -------------------------------
  1663     05  ACVDSCRL PIC S9(0004) COMP.
  1664     05  ACVDSCRF PIC  X(0001).
  1665     05  FILLER REDEFINES ACVDSCRF.
  1666         10  ACVDSCRA PIC  X(0001).
  1667     05  ACVDSCRI PIC  X(0006).
  1668*    -------------------------------
  1669     05  ACVKINDL PIC S9(0004) COMP.
  1670     05  ACVKINDF PIC  X(0001).
  1671     05  FILLER REDEFINES ACVKINDF.
  1672         10  ACVKINDA PIC  X(0001).
  1673     05  ACVKINDI PIC  X(0003).
  1674*    -------------------------------
  1675     05  ACVCDL PIC S9(0004) COMP.
  1676     05  ACVCDF PIC  X(0001).
  1677     05  FILLER REDEFINES ACVCDF.
  1678         10  ACVCDA PIC  X(0001).
  1679     05  ACVCDI PIC  X(0002).
  1680*    -------------------------------
  1681     05  ACVOTRML PIC S9(0004) COMP.
  1682     05  ACVOTRMF PIC  X(0001).
  1683     05  FILLER REDEFINES ACVOTRMF.
  1684         10  ACVOTRMA PIC  X(0001).
  1685     05  ACVOTRMI PIC  999.
  1686*    -------------------------------
  1687     05  ACVRTRML PIC S9(0004) COMP.
  1688     05  ACVRTRMF PIC  X(0001).
  1689     05  FILLER REDEFINES ACVRTRMF.
  1690         10  ACVRTRMA PIC  X(0001).
  1691     05  ACVRTRMI PIC  X(0003).
  1692*    -------------------------------
  1693     05  ACVRATEL PIC S9(0004) COMP.
  1694     05  ACVRATEF PIC  X(0001).
  1695     05  FILLER REDEFINES ACVRATEF.
  1696         10  ACVRATEA PIC  X(0001).
  1697     05  ACVRATEI PIC  9999V99.
  1698*    -------------------------------
  1699     05  ACVBENEL PIC S9(0004) COMP.
  1700     05  ACVBENEF PIC  X(0001).
  1701     05  FILLER REDEFINES ACVBENEF.
  1702         10  ACVBENEA PIC  X(0001).
  1703     05  ACVBENEI PIC  9(9)V99.
  1704*    -------------------------------
  1705     05  ACVFORML PIC S9(0004) COMP.
  1706     05  ACVFORMF PIC  X(0001).
  1707     05  FILLER REDEFINES ACVFORMF.
  1708         10  ACVFORMA PIC  X(0001).
  1709     05  ACVFORMI PIC  X(0012).
  1710*    -------------------------------
  1711     05  ACVCNDTL PIC S9(0004) COMP.
  1712     05  ACVCNDTF PIC  X(0001).
  1713     05  FILLER REDEFINES ACVCNDTF.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  35
* EL131.cbl
  1714         10  ACVCNDTA PIC  X(0001).
  1715     05  ACVCNDTI PIC  X(0008).
  1716*    -------------------------------
  1717     05  ACVEXITL PIC S9(0004) COMP.
  1718     05  ACVEXITF PIC  X(0001).
  1719     05  FILLER REDEFINES ACVEXITF.
  1720         10  ACVEXITA PIC  X(0001).
  1721     05  ACVEXITI PIC  X(0008).
  1722*    -------------------------------
  1723     05  ACVSTATL PIC S9(0004) COMP.
  1724     05  ACVSTATF PIC  X(0001).
  1725     05  FILLER REDEFINES ACVSTATF.
  1726         10  ACVSTATA PIC  X(0001).
  1727     05  ACVSTATI PIC  X(0006).
  1728*    -------------------------------
  1729     05  DAYSPL PIC S9(0004) COMP.
  1730     05  DAYSPF PIC  X(0001).
  1731     05  FILLER REDEFINES DAYSPF.
  1732         10  DAYSPA PIC  X(0001).
  1733     05  DAYSPI PIC  X(0003).
  1734*    -------------------------------
  1735     05  LABEL2L PIC S9(0004) COMP.
  1736     05  LABEL2F PIC  X(0001).
  1737     05  FILLER REDEFINES LABEL2F.
  1738         10  LABEL2A PIC  X(0001).
  1739     05  LABEL2I PIC  X(0014).
  1740*    -------------------------------
  1741     05  BCERT1L PIC S9(0004) COMP.
  1742     05  BCERT1F PIC  X(0001).
  1743     05  FILLER REDEFINES BCERT1F.
  1744         10  BCERT1A PIC  X(0001).
  1745     05  BCERT1I PIC  X(0010).
  1746*    -------------------------------
  1747     05  BSUFX1L PIC S9(0004) COMP.
  1748     05  BSUFX1F PIC  X(0001).
  1749     05  FILLER REDEFINES BSUFX1F.
  1750         10  BSUFX1A PIC  X(0001).
  1751     05  BSUFX1I PIC  X(0001).
  1752*    -------------------------------
  1753     05  BCERT2L PIC S9(0004) COMP.
  1754     05  BCERT2F PIC  X(0001).
  1755     05  FILLER REDEFINES BCERT2F.
  1756         10  BCERT2A PIC  X(0001).
  1757     05  BCERT2I PIC  X(0010).
  1758*    -------------------------------
  1759     05  BSUFX2L PIC S9(0004) COMP.
  1760     05  BSUFX2F PIC  X(0001).
  1761     05  FILLER REDEFINES BSUFX2F.
  1762         10  BSUFX2A PIC  X(0001).
  1763     05  BSUFX2I PIC  X(0001).
  1764*    -------------------------------
  1765     05  BCERT3L PIC S9(0004) COMP.
  1766     05  BCERT3F PIC  X(0001).
  1767     05  FILLER REDEFINES BCERT3F.
  1768         10  BCERT3A PIC  X(0001).
  1769     05  BCERT3I PIC  X(0010).
  1770*    -------------------------------
  1771     05  BSUFX3L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  36
* EL131.cbl
  1772     05  BSUFX3F PIC  X(0001).
  1773     05  FILLER REDEFINES BSUFX3F.
  1774         10  BSUFX3A PIC  X(0001).
  1775     05  BSUFX3I PIC  X(0001).
  1776*    -------------------------------
  1777     05  BCERT4L PIC S9(0004) COMP.
  1778     05  BCERT4F PIC  X(0001).
  1779     05  FILLER REDEFINES BCERT4F.
  1780         10  BCERT4A PIC  X(0001).
  1781     05  BCERT4I PIC  X(0010).
  1782*    -------------------------------
  1783     05  BSUFX4L PIC S9(0004) COMP.
  1784     05  BSUFX4F PIC  X(0001).
  1785     05  FILLER REDEFINES BSUFX4F.
  1786         10  BSUFX4A PIC  X(0001).
  1787     05  BSUFX4I PIC  X(0001).
  1788*    -------------------------------
  1789     05  BCERT5L PIC S9(0004) COMP.
  1790     05  BCERT5F PIC  X(0001).
  1791     05  FILLER REDEFINES BCERT5F.
  1792         10  BCERT5A PIC  X(0001).
  1793     05  BCERT5I PIC  X(0010).
  1794*    -------------------------------
  1795     05  BSUFX5L PIC S9(0004) COMP.
  1796     05  BSUFX5F PIC  X(0001).
  1797     05  FILLER REDEFINES BSUFX5F.
  1798         10  BSUFX5A PIC  X(0001).
  1799     05  BSUFX5I PIC  X(0001).
  1800*    -------------------------------
  1801     05  MSG1L PIC S9(0004) COMP.
  1802     05  MSG1F PIC  X(0001).
  1803     05  FILLER REDEFINES MSG1F.
  1804         10  MSG1A PIC  X(0001).
  1805     05  MSG1I PIC  X(0072).
  1806*    -------------------------------
  1807     05  PFKEYL PIC S9(0004) COMP.
  1808     05  PFKEYF PIC  X(0001).
  1809     05  FILLER REDEFINES PFKEYF.
  1810         10  PFKEYA PIC  X(0001).
  1811     05  PFKEYI PIC  99.
  1812*    -------------------------------
  1813     05  PFKEY6L PIC S9(0004) COMP.
  1814     05  PFKEY6F PIC  X(0001).
  1815     05  FILLER REDEFINES PFKEY6F.
  1816         10  PFKEY6A PIC  X(0001).
  1817     05  PFKEY6I PIC  X(0016).
  1818 01  EL131AO REDEFINES EL131AI.
  1819     05  FILLER            PIC  X(0012).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  DATEO PIC  X(0008).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  TIMEO PIC  99.99.
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  SEQUO PIC  X(0010).
  1829*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  37
* EL131.cbl
  1830     05  FILLER            PIC  X(0003).
  1831     05  COMPO PIC  X(0003).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  USERIDO PIC  X(0004).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  CCNOO PIC  X(0016).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  MAINTO PIC  X(0001).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  CLAIMO PIC  X(0007).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  CARRO PIC  X(0001).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  CERTO PIC  X(0010).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  SUFXO PIC  X(0001).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  TYPEO PIC  X(0001).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  LABEL1O PIC  X(0011).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  PCERTNOO PIC  X(0010).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  PSUFXO PIC  X(0001).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  STATUSO PIC  X(0006).
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  INCO PIC  X(0008).
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  REPO PIC  X(0008).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  CAUSEO PIC  X(0006).
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  ENDO PIC  X(0008).
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  DIAGO PIC  X(0060).
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  BENEO PIC  X(0010).
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  38
* EL131.cbl
  1888     05  BIRTHO PIC  X(0008).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  SOCIALO PIC  X(0011).
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  SEXO PIC  X(0001).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  MLNAMEO PIC  X(0015).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  MFNAMEO PIC  X(0012).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  MMINITO PIC  X(0001).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  LOANNOO PIC  X(0008).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  CRTLNMEO PIC  X(0015).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  CRTFNMEO PIC  X(0012).
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  CRTINITO PIC  X(0001).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  LOANBALO PIC  ZZZZZ9.99.
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  PROCO PIC  X(0004).
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  SUPVO PIC  X(0001).
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  PRICDO PIC  X(0001).
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  FILETOO PIC  X(0004).
  1931*    -------------------------------
  1932     05  FILLER            PIC  X(0003).
  1933     05  PTHRHDGO PIC  X(0010).
  1934*    -------------------------------
  1935     05  FILLER            PIC  X(0003).
  1936     05  PDTHRUO PIC  X(0008).
  1937*    -------------------------------
  1938     05  FILLER            PIC  X(0003).
  1939     05  PDAMTO PIC  Z(06).99.
  1940*    -------------------------------
  1941     05  FILLER            PIC  X(0003).
  1942     05  NODAYSO PIC  ZZZ99.
  1943*    -------------------------------
  1944     05  FILLER            PIC  X(0003).
  1945     05  NOPMTSO PIC  ZZ99.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  39
* EL131.cbl
  1946*    -------------------------------
  1947     05  FILLER            PIC  X(0003).
  1948     05  FORMTYPO PIC  X(0001).
  1949*    -------------------------------
  1950     05  FILLER            PIC  X(0003).
  1951     05  ESTO PIC  X(0008).
  1952*    -------------------------------
  1953     05  FILLER            PIC  X(0003).
  1954     05  AUIDO PIC  X(0004).
  1955*    -------------------------------
  1956     05  FILLER            PIC  X(0003).
  1957     05  OCCO PIC  X(0006).
  1958*    -------------------------------
  1959     05  FILLER            PIC  X(0003).
  1960     05  MNTDTO PIC  X(0008).
  1961*    -------------------------------
  1962     05  FILLER            PIC  X(0003).
  1963     05  MNTTYPEO PIC  X(0006).
  1964*    -------------------------------
  1965     05  FILLER            PIC  X(0003).
  1966     05  CERTCARO PIC  X(0001).
  1967*    -------------------------------
  1968     05  FILLER            PIC  X(0003).
  1969     05  CERTGRPO PIC  X(0006).
  1970*    -------------------------------
  1971     05  FILLER            PIC  X(0003).
  1972     05  CERTSTO PIC  X(0002).
  1973*    -------------------------------
  1974     05  FILLER            PIC  X(0003).
  1975     05  CERTACTO PIC  X(0010).
  1976*    -------------------------------
  1977     05  FILLER            PIC  X(0003).
  1978     05  CERTEFFO PIC  X(0008).
  1979*    -------------------------------
  1980     05  FILLER            PIC  X(0003).
  1981     05  ISSAGEO PIC  X(0002).
  1982*    -------------------------------
  1983     05  FILLER            PIC  X(0003).
  1984     05  APRO PIC  9(3).9(4).
  1985*    -------------------------------
  1986     05  FILLER            PIC  X(0003).
  1987     05  PMTFREQO PIC  99.
  1988*    -------------------------------
  1989     05  FILLER            PIC  X(0003).
  1990     05  INDGRPO PIC  X(0001).
  1991*    -------------------------------
  1992     05  FILLER            PIC  X(0003).
  1993     05  PREMTYPO PIC  X(0001).
  1994*    -------------------------------
  1995     05  FILLER            PIC  X(0003).
  1996     05  REINCDO PIC  X(0001).
  1997*    -------------------------------
  1998     05  FILLER            PIC  X(0003).
  1999     05  JNTLNMEO PIC  X(0015).
  2000*    -------------------------------
  2001     05  FILLER            PIC  X(0003).
  2002     05  JNTFNMEO PIC  X(0012).
  2003*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  40
* EL131.cbl
  2004     05  FILLER            PIC  X(0003).
  2005     05  JNTINITO PIC  X(0001).
  2006*    -------------------------------
  2007     05  FILLER            PIC  X(0003).
  2008     05  JNTAGEO PIC  X(0002).
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  ADDONDTO PIC  X(0008).
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  LCVDSCRO PIC  X(0006).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  LCVKINDO PIC  X(0003).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  LCVCDO PIC  X(0002).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  LCVOTRMO PIC  999.
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  LCVRTRMO PIC  999.
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  LCVRATEO PIC  ZZZ.ZZ.
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  LCVFORMO PIC  X(0012).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  LCVCNDTO PIC  X(0008).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  LCVEXITO PIC  X(0008).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  LCVSTATO PIC  X(0006).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  ACVDSCRO PIC  X(0006).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  ACVKINDO PIC  X(0003).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  ACVCDO PIC  X(0002).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  ACVOTRMO PIC  999.
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  ACVRTRMO PIC  999.
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  41
* EL131.cbl
  2062     05  ACVRATEO PIC  ZZZ.ZZ.
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  ACVFORMO PIC  X(0012).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  ACVCNDTO PIC  X(0008).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  ACVEXITO PIC  X(0008).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  ACVSTATO PIC  X(0006).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  DAYSPO PIC  X(0003).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  LABEL2O PIC  X(0014).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  BCERT1O PIC  X(0010).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  BSUFX1O PIC  X(0001).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  BCERT2O PIC  X(0010).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  BSUFX2O PIC  X(0001).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  BCERT3O PIC  X(0010).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  BSUFX3O PIC  X(0001).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  BCERT4O PIC  X(0010).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  BSUFX4O PIC  X(0001).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  BCERT5O PIC  X(0010).
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  BSUFX5O PIC  X(0001).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  MSG1O PIC  X(0072).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  PFKEYO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  42
* EL131.cbl
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  PFKEY6O PIC  X(0016).
  2123*    -------------------------------
  2124
  2125*                                COPY ELCEMIB SUPPRESS.
  2126******************************************************************
  2127*                                                                *
  2128*                                                                *
  2129*                            ELCEMIB.                            *
  2130*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2131*                            VMOD=2.005                          *
  2132*                                                                *
  2133*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2134*                                                                *
  2135******************************************************************
  2136 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2137     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2138     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2139     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2140     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2141     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2142     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2143     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2144     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2145     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2146         88  EMI-NO-ERRORS                    VALUE '1'.
  2147         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2148         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2149     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2150         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2151     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2152         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2153         88  EMI-AREA1-FULL                   VALUE '2'.
  2154     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2155         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2156         88  EMI-AREA2-FULL                   VALUE '2'.
  2157     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2158         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2159         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2160         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2161         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2162         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2163     12  EMI-ERROR-LINES.
  2164         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2165         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2166         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2167         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2168             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2169                 24  EMI-ERR-NUM         PIC X(4).
  2170                 24  EMI-FILLER          PIC X.
  2171                 24  EMI-SEV             PIC X.
  2172                 24  FILLER              PIC X.
  2173             20  FILLER                  PIC X(02).
  2174     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2175         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2176             20  EMI-ERROR-NUMBER    PIC X(4).
  2177             20  EMI-FILL            PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  43
* EL131.cbl
  2178             20  EMI-SEVERITY        PIC X.
  2179             20  FILLER              PIC X.
  2180             20  EMI-ERROR-TEXT.
  2181                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2182                 24  FILLER          PIC X(55).
  2183     12  EMI-SEVERITY-SAVE           PIC X.
  2184         88  EMI-NOTE                    VALUE 'N'.
  2185         88  EMI-WARNING                 VALUE 'W'.
  2186         88  EMI-FORCABLE                VALUE 'F'.
  2187         88  EMI-FATAL                   VALUE 'X'.
  2188     12  EMI-MESSAGE-FLAG            PIC X.
  2189         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2190         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2191     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2192     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2193         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2194         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2195         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2196     12  FILLER                      PIC X(137)  VALUE SPACES.
  2197     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2198     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2199     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2200     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2201
  2202*                                COPY ELCJPFX SUPPRESS.
  2203******************************************************************
  2204*                                                                *
  2205*                                                                *
  2206*                            ELCJPFX.                            *
  2207*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2208*                            VMOD=2.002                          *
  2209*                                                                *
  2210*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2211*                                                                *
  2212*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2213*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2214*        ELCNTL - CONTROL FILE                                   *
  2215*        ELMSTR - CLAIM MASTERS                                  *
  2216*        ELTRLR - ACTIVITY TRAILERS                              *
  2217*        ELCHKQ - CHECK QUE                                      *
  2218******************************************************************
  2219 01  JOURNAL-RECORD.
  2220     12  JP-USER-ID                  PIC X(4).
  2221     12  JP-FILE-ID                  PIC X(8).
  2222     12  JP-PROGRAM-ID               PIC X(8).
  2223     12  JP-RECORD-TYPE              PIC X.
  2224         88 JP-ADD              VALUE 'A'.
  2225         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2226         88 JP-AFTER-CHANGE     VALUE 'C'.
  2227         88 JP-DELETE           VALUE 'D'.
  2228         88 JP-GENERIC-DELETE   VALUE 'G'.
  2229         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2230         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2231     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2232     12  JP-RECORD-AREA
  2233
  2234
  2235                                 PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  44
* EL131.cbl
  2236
  2237*                                COPY ELCCALC SUPPRESS.
  2238******************************************************************
  2239*                                                                *
  2240*                           ELCCALC.                            *
  2241*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2242*                            VMOD=2.025                          *
  2243*                                                                *
  2244*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2245*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2246*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2247*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2248*                                                                *
  2249*  PASSED TO ELRTRM                                              *
  2250*  -----------------                                             *
  2251*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2252*  ORIGINAL TERM                                                 *
  2253*  BEGINNING DATE                                                *
  2254*  ENDING DATE                                                   *
  2255*  COMPANY I.D.                                                  *
  2256*  ACCOUNT MASTER USER FIELD                                     *
  2257*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2258*  FREE LOOK DAYS                                                *
  2259*                                                                *
  2260*  RETURNED FROM ELRTRM                                          *
  2261*  ---------------------                                         *
  2262*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2263*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2264*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2265*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2266*----------------------------------------------------------------*
  2267*  PASSED TO ELRAMT                                              *
  2268*  ----------------                                              *
  2269*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2270*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2271*  ORIGINAL AMOUNT                                               *
  2272*  ALTERNATE BENEFIT (BALLON)                                    *
  2273*  A.P.R. - NET PAY ONLY                                         *
  2274*  METHOD
  2275*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2276*  COMPANY I.D.                                                  *
  2277*  BENEFIT TYPE                                                  *
  2278*                                                                *
  2279*  RETURNED FROM ELRAMT                                          *
  2280*  --------------------                                          *
  2281*  REMAINING AMOUNT 1 - CURRENT                                  *
  2282*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2283*  REMAINING AMOUNT FACTOR
  2284*----------------------------------------------------------------*
  2285*  PASSED TO ELRESV                                              *
  2286*  -----------------                                             *
  2287*  CERTIFICATE EFFECTIVE DATE                                    *
  2288*  VALUATION DATE                                                *
  2289*  PAID THRU DATE                                                *
  2290*  BENEFIT                                                       *
  2291*  INCURRED DATE                                                 *
  2292*  REPORTED DATE                                                 *
  2293*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  45
* EL131.cbl
  2294*  TERM                                                          *
  2295*  CDT PERCENT                                                   *
  2296*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2297* *CLAIM TYPE (LIFE, A/H)                                        *
  2298* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2299* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2300*                                                                *
  2301*  RETURNED FROM ELRESV                                          *
  2302*  --------------------                                          *
  2303*  CDT TABLE USED                                                *
  2304*  CDT FACTOR USED                                               *
  2305*  PAY TO CURRENT RESERVE                                        *
  2306*  I.B.N.R. - A/H ONLY                                           *
  2307*  FUTURE (ACCRUED) AH ONLY                                      *
  2308*----------------------------------------------------------------*
  2309*  PASSED TO ELRATE                                              *
  2310*  ----------------                                              *
  2311*  CERT ISSUE DATE                                               *
  2312*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2313*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2314*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2315*  STATE CODE (CLIENT DEFINED)                                   *
  2316*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2317*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2318*  DEVIATION CODE                                                *
  2319*  ISSUE AGE                                                     *
  2320*  ORIGINAL BENEFIT AMOUNT                                       *
  2321*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2322*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2323*  BENEFIT KIND (LIFE OR A/H)                                    *
  2324*  A.P.R.                                                        *
  2325*  METHOD
  2326*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2327*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2328*  COMPANY I.D. (3 CHARACTER)                                    *
  2329*  BENEFIT CODE                                                  *
  2330*  BENEFIT OVERRIDE CODE                                         *
  2331*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2332*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2333*  JOINT INDICATOR (CSL ONLY)                                    *
  2334*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2335*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2336*                                                                *
  2337*  RETURNED FROM ELRATE                                          *
  2338*  --------------------                                          *
  2339*  CALCULATED PREMIUM                                            *
  2340*  PREMIUM RATE                                                  *
  2341*  MORTALITY CODE                                                *
  2342*  MAX ATTAINED AGE                                              *
  2343*  MAX AGE                                                       *
  2344*  MAX TERM                                                      *
  2345*  MAX MONTHLY BENEFIT                                           *
  2346*  MAX TOTAL BENIFIT                                             *
  2347*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2348*----------------------------------------------------------------*
  2349*  PASSED TO ELRFND                                              *
  2350*  ----------------                                              *
  2351*  CERT ISSUE DATE                                               *
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  46
* EL131.cbl
  2352*  REFUND DATE                                                   *
  2353*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2354*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2355*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2356*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2357*  STATE CODE (CLIENT DEFINED)                                   *
  2358*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2359*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2360*  DEVIATION CODE                                                *
  2361*  ISSUE AGE                                                     *
  2362*  ORIGINAL BENEFIT AMOUNT                                       *
  2363*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2364*  PROCESS TYPE (CANCEL)                                         *
  2365*  BENEFIT KIND (LIFE OR A/H)                                    *
  2366*  A.P.R.                                                        *
  2367*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2368*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2369*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2370*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2371*  COMPANY I.D. (3 CHARACTER)                                    *
  2372*  BENEFIT CODE                                                  *
  2373*  BENEFIT OVERRIDE CODE                                         *
  2374*                                                                *
  2375*  RETURNED FROM ELRFND                                          *
  2376*  --------------------                                          *
  2377*  CALCULATED REFUND                                             *
  2378*----------------------------------------------------------------*
  2379*  PASSED TO ELEARN                                              *
  2380*  ----------------                                              *
  2381*  CERT ISSUE DATE                                               *
  2382*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2383*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2384*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2385*  STATE CODE (CLIENT DEFINED)                                   *
  2386*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2387*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2388*  DEVIATION CODE                                                *
  2389*  ISSUE AGE                                                     *
  2390*  ORIGINAL BENEFIT AMOUNT                                       *
  2391*  BENEFIT KIND (LIFE OR A/H)                                    *
  2392*  A.P.R.                                                        *
  2393*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2394*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2395*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2396*  COMPANY I.D. (3 CHARACTER)                                    *
  2397*  BENEFIT CODE                                                  *
  2398*  BENEFIT OVERRIDE CODE                                         *
  2399*                                                                *
  2400*  RETURNED FROM ELEARN                                          *
  2401*  --------------------                                          *
  2402*  INDICATED  EARNINGS                                           *
  2403*----------------------------------------------------------------*
  2404*                 LENGTH = 450                                   *
  2405*                                                                *
  2406******************************************************************
  2407******************************************************************
  2408*                   C H A N G E   L O G
  2409*
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  47
* EL131.cbl
  2410* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2411*-----------------------------------------------------------------
  2412*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2413* EFFECTIVE    NUMBER
  2414*-----------------------------------------------------------------
  2415* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2416* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2417* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2418* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2419* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2420* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2421* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2422* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2423* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2424******************************************************************
  2425
  2426 01  CALCULATION-PASS-AREA.
  2427     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2428                                     COMP.
  2429
  2430     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2431       88  NO-CP-ERROR                             VALUE ZERO.
  2432       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2433                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2434       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2435       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2436       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2437       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2438       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2439       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2440       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2441       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2442       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2443       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2444       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2445       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2446       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2447       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2448       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2449       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2450       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2451
  2452     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2453       88  NO-CP-ERROR-2                           VALUE ZERO.
  2454***********************  INPUT AREAS ****************************
  2455
  2456     12  CP-CALCULATION-AREA.
  2457         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2458         16  CP-CERT-EFF-DT        PIC XX.
  2459         16  CP-VALUATION-DT       PIC XX.
  2460         16  CP-PAID-THRU-DT       PIC XX.
  2461         16  CP-BENEFIT-TYPE       PIC X.
  2462           88  CP-AH                               VALUE 'A' 'D'
  2463                                                   'I' 'U'.
  2464           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2465           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2466         16  CP-INCURRED-DT        PIC XX.
  2467         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  48
* EL131.cbl
  2468         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2469         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2470         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2471                                     COMP-3.
  2472         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2473                                     COMP-3.
  2474         16  CP-CDT-METHOD         PIC X.
  2475           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2476           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2477           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2478         16  CP-CLAIM-TYPE         PIC X.
  2479           88  CP-AH-CLAIM                         VALUE 'A'.
  2480           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2481         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2482                                     COMP-3.
  2483         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2484                                     COMP-3.
  2485         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2486                                     COMP-3.
  2487         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2488                                     COMP-3.
  2489         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2490                                     COMP-3.
  2491         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2492                                     COMP-3.
  2493         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2494                                     COMP-3.
  2495         16  CP-REM-TERM-METHOD    PIC X.
  2496           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2497           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2498           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2499           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2500           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2501           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2502           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2503         16  CP-EARNING-METHOD     PIC X.
  2504           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2505           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2506           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2507           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2508           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2509           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2510           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2511           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2512           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2513           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2514           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2515           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2516           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2517           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2518         16  CP-PROCESS-TYPE       PIC X.
  2519           88  CP-CLAIM                            VALUE '1'.
  2520           88  CP-CANCEL                           VALUE '2'.
  2521           88  CP-ISSUE                            VALUE '3'.
  2522         16  CP-SPECIAL-CALC-CD    PIC X.
  2523           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2524           88  CP-1-MTH-INTEREST               VALUE ' '.
  2525           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  49
* EL131.cbl
  2526           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2527           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2528           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2529           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2530           88  CP-FARM-PLAN                    VALUE 'F'.
  2531           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2532           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2533           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2534           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2535           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2536           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2537           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2538           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2539           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2540           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2541                                                     'W' 'X'.
  2542           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2543           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2544           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2545           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2546           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2547           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2548           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2549           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2550           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2551           88  CP-CSL-METH-1                   VALUE '5'.
  2552           88  CP-CSL-METH-2                   VALUE '6'.
  2553           88  CP-CSL-METH-3                   VALUE '7'.
  2554           88  CP-CSL-METH-4                   VALUE '8'.
  2555
  2556         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2557                                     COMP-3.
  2558         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2559         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2560         16  CP-STATE              PIC XX          VALUE SPACE.
  2561         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2562         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2563           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2564               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2565         16  CP-R78-OPTION         PIC X.
  2566           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2567           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2568
  2569         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2570         16  CP-IBNR-RESERVE-SW    PIC X.
  2571         16  CP-CLAIM-STATUS       PIC X.
  2572         16  CP-RATE-FILE          PIC X.
  2573         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2574                                     COMP-3.
  2575
  2576         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2577         16  CP-AH-OVERRIDE-CODE   PIC X.
  2578
  2579         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2580                                     COMP-3.
  2581         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2582                                   PIC S9(5)V99 COMP-3.
  2583         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  50
* EL131.cbl
  2584                                     COMP-3.
  2585         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2586                                     COMP-3.
  2587         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2588                                     COMP-3.
  2589         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2590                                  PIC S9(7)V99 COMP-3.
  2591
  2592         16  CP-PAID-FROM-DATE     PIC X(02).
  2593         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2594         16  CP-EXT-DAYS-CALC      PIC X.
  2595           88  CP-EXT-NO-CHG                   VALUE ' '.
  2596           88  CP-EXT-CHG-LF                   VALUE '1'.
  2597           88  CP-EXT-CHG-AH                   VALUE '2'.
  2598           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2599         16  CP-DOMICILE-STATE     PIC XX.
  2600         16  CP-CARRIER            PIC X.
  2601         16  CP-REIN-FLAG          PIC X.
  2602         16  CP-REM-TRM-CALC-OPTION PIC X.
  2603           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2604                      '2' '3' '4' '5'.
  2605           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2606           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2607           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2608           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2609           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2610           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2611           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2612           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2613         16  CP-SIG-SWITCH         PIC X.
  2614         16  CP-RATING-METHOD      PIC X.
  2615           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2616           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2617           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2618           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2619           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2620           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2621           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2622           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2623           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2624         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2625                                     COMP-3.
  2626         16  CP-BEN-CATEGORY       PIC X.
  2627         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2628         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2629                                   PIC S99V9(5) COMP-3.
  2630         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2631         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2632                                   PIC S99V9(5) COMP-3.
  2633         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2634         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2635         16  CP-EXPIRE-DT          PIC XX.
  2636         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2637         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2638         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2639         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2640         16  CP-DDF-SPEC-CALC      PIC X.
  2641             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  51
* EL131.cbl
  2642             88  CP-CALC-CLP              VALUE 'C'.
  2643         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2644         16  CP-CANCEL-REASON      PIC X.
  2645         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2646         16  CP-PMT-MODE           PIC X.
  2647         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2648         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2649         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2650         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2651         16  FILLER                PIC X.
  2652
  2653***************    OUTPUT FROM ELRESV   ************************
  2654
  2655         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2656
  2657         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2658                                     COMP-3.
  2659         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2660                                     COMP-3.
  2661         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2662                                     COMP-3.
  2663         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2664                                     COMP-3.
  2665         16  FILLER                PIC X(09).
  2666***************    OUTPUT FROM ELRTRM   *************************
  2667
  2668         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2669                                     COMP-3.
  2670         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2671                                     COMP-3.
  2672         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2673                                     COMP-3.
  2674         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2675                                     COMP-3.
  2676         16  FILLER                PIC X(12).
  2677
  2678***************    OUTPUT FROM ELRAMT   *************************
  2679
  2680         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2681                                     COMP-3.
  2682         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2683                                     COMP-3.
  2684         16  FILLER                PIC X(12).
  2685
  2686***************    OUTPUT FROM ELRATE   *************************
  2687
  2688         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2689                                     COMP-3.
  2690         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2691                                     COMP-3.
  2692         16  CP-MORTALITY-CODE     PIC X(4).
  2693         16  CP-RATE-EDIT-FLAG     PIC X.
  2694             88  CP-RATES-NEED-APR                  VALUE '1'.
  2695         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2696                                     COMP-3.
  2697         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2698         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2699         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  52
* EL131.cbl
  2700                                   PIC S9(7)V99 COMP-3.
  2701         16  FILLER                PIC X(07).
  2702
  2703***************    OUTPUT FROM ELRFND   *************************
  2704
  2705         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2706                                     COMP-3.
  2707         16  CP-REFUND-TYPE-USED   PIC X.
  2708           88  CP-R-AS-R78                         VALUE '1'.
  2709           88  CP-R-AS-PRORATA                     VALUE '2'.
  2710           88  CP-R-AS-CALIF                       VALUE '3'.
  2711           88  CP-R-AS-TEXAS                       VALUE '4'.
  2712           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2713           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2714           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2715           88  CP-R-AS-MEAN                        VALUE '8'.
  2716           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2717           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2718           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2719           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2720           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2721           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2722         16  FILLER                PIC X(12).
  2723
  2724***************    OUTPUT FROM ELEARN   *************************
  2725
  2726         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2727                                     COMP-3.
  2728         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2729                                     COMP-3.
  2730         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2731                                     COMP-3.
  2732         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2733                                     COMP-3.
  2734         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2735                                     COMP-3.
  2736         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2737                                     COMP-3.
  2738         16  CP-EARNING-TYPE-USED  PIC X.
  2739           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2740           88  CP-E-AS-R78                         VALUE '1'.
  2741           88  CP-E-AS-PRORATA                     VALUE '2'.
  2742           88  CP-E-AS-TEXAS                       VALUE '4'.
  2743           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2744           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2745           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2746           88  CP-E-AS-MEAN                        VALUE '8'.
  2747           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2748         16  FILLER                PIC X(12).
  2749
  2750***************    OUTPUT FROM ELPMNT   *************************
  2751
  2752         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2753                                     COMP-3.
  2754         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2755                                     COMP-3.
  2756         16  FILLER                PIC X(12).
  2757
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  53
* EL131.cbl
  2758***************   MISC WORK AREAS    *****************************
  2759         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2760                                     COMP-3.
  2761         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2762                                     COMP-3.
  2763         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2764                                     COMP-3.
  2765         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2766                                     COMP-3.
  2767         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2768                                     COMP-3.
  2769         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2770                                     COMP-3.
  2771         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2772             88  OPEN-RATE-FILE                   VALUE 'O'.
  2773             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2774             88  IO-ERROR                         VALUE 'E'.
  2775
  2776         16  CP-FIRST-PAY-DATE     PIC XX.
  2777
  2778         16  CP-JOINT-INDICATOR    PIC X.
  2779
  2780         16  CP-RESERVE-REMAINING-TERM
  2781                                   PIC S9(4)V9    VALUE ZERO
  2782                                     COMP-3.
  2783
  2784         16  CP-INSURED-BIRTH-DT   PIC XX.
  2785
  2786         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2787                                     COMP-3.
  2788
  2789         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2790                                     COMP-3.
  2791
  2792         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2793                                     COMP-3.
  2794
  2795         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2796                                     COMP-3.
  2797
  2798         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2799                                     COMP-3.
  2800
  2801         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2802                                     COMP-3.
  2803
  2804         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2805                                     COMP-3.
  2806
  2807         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2808             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2809
  2810         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2811                                     COMP-3.
  2812         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2813                                     COMP-3.
  2814         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2815         16  FILLER                PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  54
* EL131.cbl
  2816******************************************************************
  2817
  2818*                                COPY ELCDATE SUPPRESS.
  2819******************************************************************
  2820*                                                                *
  2821*                                                                *
  2822*                            ELCDATE.                            *
  2823*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2824*                            VMOD=2.003
  2825*                                                                *
  2826*                                                                *
  2827*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2828*                 LENGTH = 200                                   *
  2829******************************************************************
  2830
  2831 01  DATE-CONVERSION-DATA.
  2832     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2833     12  DC-OPTION-CODE                PIC X.
  2834         88  BIN-TO-GREG                VALUE ' '.
  2835         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2836         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2837         88  YMD-GREG-TO-BIN            VALUE '3'.
  2838         88  MDY-GREG-TO-BIN            VALUE '4'.
  2839         88  JULIAN-TO-BIN              VALUE '5'.
  2840         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2841         88  FIND-CENTURY               VALUE '7'.
  2842         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2843         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2844         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2845         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2846         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2847         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2848         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2849         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2850         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2851         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2852         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2853         88  BIN-3-TO-GREG              VALUE 'I'.
  2854         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2855         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2856         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2857         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2858         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2859         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2860         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2861         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2862         88  THREE-CHARACTER-BIN
  2863                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2864         88  GREGORIAN-TO-BIN
  2865                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2866         88  BIN-TO-GREGORIAN
  2867                  VALUES ' ' '1' 'I' '8' 'G'.
  2868         88  JULIAN-TO-BINARY
  2869                  VALUES '5' 'C' 'E' 'F'.
  2870     12  DC-ERROR-CODE                 PIC X.
  2871         88  NO-CONVERSION-ERROR        VALUE ' '.
  2872         88  DATE-CONVERSION-ERROR
  2873                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  55
* EL131.cbl
  2874         88  DATE-IS-ZERO               VALUE '1'.
  2875         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2876         88  DATE-IS-INVALID            VALUE '3'.
  2877         88  DATE1-GREATER-DATE2        VALUE '4'.
  2878         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2879         88  DATE-INVALID-OPTION        VALUE '9'.
  2880         88  INVALID-CENTURY            VALUE 'A'.
  2881         88  ONLY-CENTURY               VALUE 'B'.
  2882         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2883         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2884     12  DC-END-OF-MONTH               PIC X.
  2885         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2886     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2887         88  USE-NORMAL-PROCESS         VALUE ' '.
  2888         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2889         88  ADJUST-UP-100-YRS          VALUE '2'.
  2890     12  FILLER                        PIC X.
  2891     12  DC-CONVERSION-DATES.
  2892         16  DC-BIN-DATE-1             PIC XX.
  2893         16  DC-BIN-DATE-2             PIC XX.
  2894         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2895         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2896                       DC-GREG-DATE-1-EDIT.
  2897             20  DC-EDIT1-MONTH        PIC 99.
  2898             20  SLASH1-1              PIC X.
  2899             20  DC-EDIT1-DAY          PIC 99.
  2900             20  SLASH1-2              PIC X.
  2901             20  DC-EDIT1-YEAR         PIC 99.
  2902         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2903         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2904                     DC-GREG-DATE-2-EDIT.
  2905             20  DC-EDIT2-MONTH        PIC 99.
  2906             20  SLASH2-1              PIC X.
  2907             20  DC-EDIT2-DAY          PIC 99.
  2908             20  SLASH2-2              PIC X.
  2909             20  DC-EDIT2-YEAR         PIC 99.
  2910         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2911         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2912                     DC-GREG-DATE-1-YMD.
  2913             20  DC-YMD-YEAR           PIC 99.
  2914             20  DC-YMD-MONTH          PIC 99.
  2915             20  DC-YMD-DAY            PIC 99.
  2916         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2917         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2918                      DC-GREG-DATE-1-MDY.
  2919             20  DC-MDY-MONTH          PIC 99.
  2920             20  DC-MDY-DAY            PIC 99.
  2921             20  DC-MDY-YEAR           PIC 99.
  2922         16  DC-GREG-DATE-1-ALPHA.
  2923             20  DC-ALPHA-MONTH        PIC X(10).
  2924             20  DC-ALPHA-DAY          PIC 99.
  2925             20  FILLER                PIC XX.
  2926             20  DC-ALPHA-CENTURY.
  2927                 24 DC-ALPHA-CEN-N     PIC 99.
  2928             20  DC-ALPHA-YEAR         PIC 99.
  2929         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2930         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2931         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  56
* EL131.cbl
  2932         16  DC-JULIAN-DATE            PIC 9(05).
  2933         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2934                                       PIC 9(05).
  2935         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2936             20  DC-JULIAN-YEAR        PIC 99.
  2937             20  DC-JULIAN-DAYS        PIC 999.
  2938         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2939         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2940         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2941     12  DATE-CONVERSION-VARIBLES.
  2942         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2943         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2944             20  FILLER                PIC 9(3).
  2945             20  HOLD-CEN-1-CCYY.
  2946                 24  HOLD-CEN-1-CC     PIC 99.
  2947                 24  HOLD-CEN-1-YY     PIC 99.
  2948             20  HOLD-CEN-1-MO         PIC 99.
  2949             20  HOLD-CEN-1-DA         PIC 99.
  2950         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2951             20  HOLD-CEN-1-R-MO       PIC 99.
  2952             20  HOLD-CEN-1-R-DA       PIC 99.
  2953             20  HOLD-CEN-1-R-CCYY.
  2954                 24  HOLD-CEN-1-R-CC   PIC 99.
  2955                 24  HOLD-CEN-1-R-YY   PIC 99.
  2956             20  FILLER                PIC 9(3).
  2957         16  HOLD-CENTURY-1-X.
  2958             20  FILLER                PIC X(3)  VALUE SPACES.
  2959             20  HOLD-CEN-1-X-CCYY.
  2960                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2961                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2962             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2963             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2964         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2965             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2966             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2967             20  HOLD-CEN-1-R-X-CCYY.
  2968                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2969                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2970             20  FILLER                PIC XXX.
  2971         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2972         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2973         16  DC-JULIAN-DATE-1          PIC 9(07).
  2974         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2975             20  DC-JULIAN-1-CCYY.
  2976                 24  DC-JULIAN-1-CC    PIC 99.
  2977                 24  DC-JULIAN-1-YR    PIC 99.
  2978             20  DC-JULIAN-DA-1        PIC 999.
  2979         16  DC-JULIAN-DATE-2          PIC 9(07).
  2980         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2981             20  DC-JULIAN-2-CCYY.
  2982                 24  DC-JULIAN-2-CC    PIC 99.
  2983                 24  DC-JULIAN-2-YR    PIC 99.
  2984             20  DC-JULIAN-DA-2        PIC 999.
  2985         16  DC-GREG-DATE-A-EDIT.
  2986             20  DC-EDITA-MONTH        PIC 99.
  2987             20  SLASHA-1              PIC X VALUE '/'.
  2988             20  DC-EDITA-DAY          PIC 99.
  2989             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  57
* EL131.cbl
  2990             20  DC-EDITA-CCYY.
  2991                 24  DC-EDITA-CENT     PIC 99.
  2992                 24  DC-EDITA-YEAR     PIC 99.
  2993         16  DC-GREG-DATE-B-EDIT.
  2994             20  DC-EDITB-MONTH        PIC 99.
  2995             20  SLASHB-1              PIC X VALUE '/'.
  2996             20  DC-EDITB-DAY          PIC 99.
  2997             20  SLASHB-2              PIC X VALUE '/'.
  2998             20  DC-EDITB-CCYY.
  2999                 24  DC-EDITB-CENT     PIC 99.
  3000                 24  DC-EDITB-YEAR     PIC 99.
  3001         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3002         16  DC-GREG-DATE-CYMD-R REDEFINES
  3003                              DC-GREG-DATE-CYMD.
  3004             20  DC-CYMD-CEN           PIC 99.
  3005             20  DC-CYMD-YEAR          PIC 99.
  3006             20  DC-CYMD-MONTH         PIC 99.
  3007             20  DC-CYMD-DAY           PIC 99.
  3008         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3009         16  DC-GREG-DATE-MDCY-R REDEFINES
  3010                              DC-GREG-DATE-MDCY.
  3011             20  DC-MDCY-MONTH         PIC 99.
  3012             20  DC-MDCY-DAY           PIC 99.
  3013             20  DC-MDCY-CEN           PIC 99.
  3014             20  DC-MDCY-YEAR          PIC 99.
  3015    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3016        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3017    12  DC-EL310-DATE                  PIC X(21).
  3018    12  FILLER                         PIC X(28).
  3019
  3020*                                COPY ELCDMO.
  3021******************************************************************
  3022*                                                                *
  3023*                                                                *
  3024*                            ELCDMO.                             *
  3025*                            VMOD=2.004                          *
  3026*                                                                *
  3027*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3028*        COMMUNICATION AREA                                      *
  3029*   FILE TYPE = NA                                               *
  3030*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3031*                                                                *
  3032******************************************************************
  3033 01  DMO-COMMUNICATION-AREA.
  3034     12  DM-RECORD-TYPE                  PIC  X(02).
  3035             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3036             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3037             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3038     12  DM-DIST-CODE                    PIC  X(04).
  3039     12  DM-MAIL-CODE                    PIC  X(05).
  3040     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3041     12  DM-INSURED-NAME                 PIC  X(30).
  3042     12  DM-CLAIM-NO                     PIC  X(07).
  3043     12  DM-CLAIM-TYPE                   PIC  X.
  3044
  3045     12  DM-STATUS-DATA-AREA.
  3046         16  DM-CLAIM-STATUS             PIC  X.
  3047             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  58
* EL131.cbl
  3048             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3049             88  DM-CLOSED                        VALUE '3'.
  3050             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3051             88  DM-DEFAULT                       VALUE '9'.
  3052         16  DM-STATUS-DATE              PIC  X(08).
  3053******YYYYMMDD
  3054         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3055             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3056             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3057             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3058             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3059             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3060             88  DM-RE-OPENED                     VALUE 'R'.
  3061             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3062             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3063             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3064         16  DM-STAT-CARRIER             PIC X.
  3065
  3066     12  DM-DRAFT-DATA-AREA.
  3067         16  DM-PAYMENT-TYPE             PIC  X.
  3068             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3069         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3070         16  DM-PAYMENT-DATE             PIC  X(08).
  3071******YYYYMMDD
  3072         16  DM-CERT-NO                  PIC  X(11).
  3073         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3074         16  DM-CARRIER                  PIC  X.
  3075
  3076     12  DM-RETURN-CODE                  PIC  XX.
  3077
  3078****************************************************************
  3079*
  3080* Copyright (c) 2007 by Clerity Solutions, Inc.
  3081* All rights reserved.
  3082*
  3083****************************************************************
  3084 01  DFHEIV.
  3085   02  DFHEIV0               PIC X(35).
  3086   02  DFHEIV1               PIC X(08).
  3087   02  DFHEIV2               PIC X(08).
  3088   02  DFHEIV3               PIC X(08).
  3089   02  DFHEIV4               PIC X(06).
  3090   02  DFHEIV5               PIC X(04).
  3091   02  DFHEIV6               PIC X(04).
  3092   02  DFHEIV7               PIC X(02).
  3093   02  DFHEIV8               PIC X(02).
  3094   02  DFHEIV9               PIC X(01).
  3095   02  DFHEIV10              PIC S9(7) COMP-3.
  3096   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3097   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3098   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3099   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3100   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3101   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3102   02  DFHEIV17              PIC X(04).
  3103   02  DFHEIV18              PIC X(04).
  3104   02  DFHEIV19              PIC X(04).
  3105   02  DFHEIV20              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  59
* EL131.cbl
  3106   02  DFHEIV21              USAGE IS POINTER.
  3107   02  DFHEIV22              USAGE IS POINTER.
  3108   02  DFHEIV23              USAGE IS POINTER.
  3109   02  DFHEIV24              USAGE IS POINTER.
  3110   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3111   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3112   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3113   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3114   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3115   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3116   02  FILLER                PIC X(02).
  3117   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3118   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3119   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3120   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3121   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3122 LINKAGE  SECTION.
  3123*****************************************************************
  3124*                                                               *
  3125* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3126* All rights reserved.                                          *
  3127*                                                               *
  3128*****************************************************************
  3129 01  dfheiblk.
  3130     02  eibtime          pic s9(7) comp-3.
  3131     02  eibdate          pic s9(7) comp-3.
  3132     02  eibtrnid         pic x(4).
  3133     02  eibtaskn         pic s9(7) comp-3.
  3134     02  eibtrmid         pic x(4).
  3135     02  dfheigdi         pic s9(4) comp.
  3136     02  eibcposn         pic s9(4) comp.
  3137     02  eibcalen         pic s9(4) comp.
  3138     02  eibaid           pic x(1).
  3139     02  eibfiller1       pic x(1).
  3140     02  eibfn            pic x(2).
  3141     02  eibfiller2       pic x(2).
  3142     02  eibrcode         pic x(6).
  3143     02  eibfiller3       pic x(2).
  3144     02  eibds            pic x(8).
  3145     02  eibreqid         pic x(8).
  3146     02  eibrsrce         pic x(8).
  3147     02  eibsync          pic x(1).
  3148     02  eibfree          pic x(1).
  3149     02  eibrecv          pic x(1).
  3150     02  eibsend          pic x(1).
  3151     02  eibatt           pic x(1).
  3152     02  eibeoc           pic x(1).
  3153     02  eibfmh           pic x(1).
  3154     02  eibcompl         pic x(1).
  3155     02  eibsig           pic x(1).
  3156     02  eibconf          pic x(1).
  3157     02  eiberr           pic x(1).
  3158     02  eibrldbk         pic x(1).
  3159     02  eiberrcd         pic x(4).
  3160     02  eibsynrb         pic x(1).
  3161     02  eibnodat         pic x(1).
  3162     02  eibfiller5       pic x(2).
  3163     02  eibresp          pic 9(09) comp.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  60
* EL131.cbl
  3164     02  eibresp2         pic 9(09) comp.
  3165     02  dfheigdj         pic s9(4) comp.
  3166     02  dfheigdk         pic s9(4) comp.
  3167 01  DFHCOMMAREA                 PIC X(1024).
  3168
  3169*                                COPY ELCMSTR.
  3170******************************************************************
  3171*                                                                *
  3172*                            ELCMSTR.                            *
  3173*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3174*                            VMOD=2.012                          *
  3175*                                                                *
  3176*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3177*                                                                *
  3178*   FILE TYPE = VSAM,KSDS                                        *
  3179*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3180*                                                                *
  3181*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3182*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3183*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3184*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3185*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3186*                                                 RKP=75,LEN=21  *
  3187*                                                                *
  3188*   **** NOTE ****                                               *
  3189*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3190*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3191*                                                                *
  3192*   LOG = YES                                                    *
  3193*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3194******************************************************************
  3195*                   C H A N G E   L O G
  3196*
  3197* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3198*-----------------------------------------------------------------
  3199*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3200* EFFECTIVE    NUMBER
  3201*-----------------------------------------------------------------
  3202* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3203* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3204******************************************************************
  3205 01  CLAIM-MASTER.
  3206     12  CL-RECORD-ID                PIC XX.
  3207         88  VALID-CL-ID         VALUE 'CL'.
  3208
  3209     12  CL-CONTROL-PRIMARY.
  3210         16  CL-COMPANY-CD           PIC X.
  3211         16  CL-CARRIER              PIC X.
  3212         16  CL-CLAIM-NO             PIC X(7).
  3213         16  CL-CERT-NO.
  3214             20  CL-CERT-PRIME       PIC X(10).
  3215             20  CL-CERT-SFX         PIC X.
  3216
  3217     12  CL-CONTROL-BY-NAME.
  3218         16  CL-COMPANY-CD-A1        PIC X.
  3219         16  CL-INSURED-LAST-NAME    PIC X(15).
  3220         16  CL-INSURED-NAME.
  3221             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  61
* EL131.cbl
  3222             20  CL-INSURED-MID-INIT PIC X.
  3223
  3224     12  CL-CONTROL-BY-SSN.
  3225         16  CL-COMPANY-CD-A2        PIC X.
  3226         16  CL-SOC-SEC-NO.
  3227             20  CL-SSN-STATE        PIC XX.
  3228             20  CL-SSN-ACCOUNT      PIC X(6).
  3229             20  CL-SSN-LN3          PIC X(3).
  3230
  3231     12  CL-CONTROL-BY-CERT-NO.
  3232         16  CL-COMPANY-CD-A4        PIC X.
  3233         16  CL-CERT-NO-A4.
  3234             20  CL-CERT-A4-PRIME    PIC X(10).
  3235             20  CL-CERT-A4-SFX      PIC X.
  3236
  3237     12  CL-CONTROL-BY-CCN.
  3238         16  CL-COMPANY-CD-A5        PIC X.
  3239         16  CL-CCN-A5.
  3240             20  CL-CCN.
  3241                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3242                 24  CL-CCN-PRIME-A5 PIC X(12).
  3243             20  CL-CCN-FILLER-A5    PIC X(4).
  3244
  3245     12  CL-INSURED-PROFILE-DATA.
  3246         16  CL-INSURED-BIRTH-DT     PIC XX.
  3247         16  CL-INSURED-SEX-CD       PIC X.
  3248             88  INSURED-IS-MALE        VALUE 'M'.
  3249             88  INSURED-IS-FEMALE      VALUE 'F'.
  3250             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3251         16  CL-INSURED-OCC-CD       PIC X(6).
  3252         16  FILLER                  PIC X(5).
  3253
  3254     12  CL-PROCESSING-INFO.
  3255         16  CL-PROCESSOR-ID         PIC X(4).
  3256         16  CL-CLAIM-STATUS         PIC X.
  3257             88  CLAIM-IS-OPEN          VALUE 'O'.
  3258             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3259         16  CL-CLAIM-TYPE           PIC X.
  3260*            88  AH-CLAIM               VALUE 'A'.
  3261*            88  LIFE-CLAIM             VALUE 'L'.
  3262*            88  PROPERTY-CLAIM         VALUE 'P'.
  3263*            88  IUI-CLAIM              VALUE 'I'.
  3264*            88  GAP-CLAIM              VALUE 'G'.
  3265         16  CL-CLAIM-PREM-TYPE      PIC X.
  3266             88  SINGLE-PREMIUM         VALUE '1'.
  3267             88  O-B-COVERAGE           VALUE '2'.
  3268             88  OPEN-END-COVERAGE      VALUE '3'.
  3269         16  CL-INCURRED-DT          PIC XX.
  3270         16  CL-REPORTED-DT          PIC XX.
  3271         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3272         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3273         16  CL-LAST-PMT-DT          PIC XX.
  3274         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3275         16  CL-PAID-THRU-DT         PIC XX.
  3276         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3277         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3278         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3279         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  62
* EL131.cbl
  3280             88  CL-360-DAY-YR          VALUE '1'.
  3281             88  CL-365-DAY-YR          VALUE '2'.
  3282             88  CL-FULL-MONTHS         VALUE '3'.
  3283         16  CL-CAUSE-CD             PIC X(6).
  3284
  3285         16  CL-PRIME-CERT-NO.
  3286             20  CL-PRIME-CERT-PRIME PIC X(10).
  3287             20  CL-PRIME-CERT-SFX   PIC X.
  3288
  3289         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3290             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3291             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3292
  3293         16  CL-MICROFILM-NO         PIC X(10).
  3294         16  CL-PROG-FORM-TYPE       PIC X.
  3295         16  CL-LAST-ADD-ON-DT       PIC XX.
  3296
  3297         16  CL-LAST-REOPEN-DT       PIC XX.
  3298         16  CL-LAST-CLOSE-DT        PIC XX.
  3299         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3300             88  FINAL-PAID             VALUE '1'.
  3301             88  CLAIM-DENIED           VALUE '2'.
  3302             88  AUTO-CLOSE             VALUE '3'.
  3303             88  MANUAL-CLOSE           VALUE '4'.
  3304             88  BENEFITS-CHANGED       VALUE 'C'.
  3305             88  SETUP-ERRORS           VALUE 'E'.
  3306         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3307         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3308         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3309             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3310         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3311         16  FILLER                  PIC X.
  3312
  3313     12  CL-CERTIFICATE-DATA.
  3314         16  CL-CERT-ORIGIN          PIC X.
  3315             88  CERT-WAS-ONLINE        VALUE '1'.
  3316             88  CERT-WAS-CREATED       VALUE '2'.
  3317             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3318         16  CL-CERT-KEY-DATA.
  3319             20  CL-CERT-CARRIER     PIC X.
  3320             20  CL-CERT-GROUPING    PIC X(6).
  3321             20  CL-CERT-STATE       PIC XX.
  3322             20  CL-CERT-ACCOUNT.
  3323                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3324                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3325             20  CL-CERT-EFF-DT      PIC XX.
  3326
  3327     12  CL-STATUS-CONTROLS.
  3328         16  CL-PRIORITY-CD          PIC X.
  3329             88  CONFIDENTIAL-DATA      VALUE '8'.
  3330             88  HIGHEST-PRIORITY       VALUE '9'.
  3331         16  CL-SUPV-ATTN-CD         PIC X.
  3332             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3333             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3334         16  CL-PURGED-DT            PIC XX.
  3335         16  CL-RESTORED-DT          PIC XX.
  3336         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3337         16  CL-NEXT-RESEND-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  63
* EL131.cbl
  3338         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3339         16  FILLER                  PIC XX.
  3340         16  CL-LAST-MAINT-DT        PIC XX.
  3341         16  CL-LAST-MAINT-USER      PIC X(4).
  3342         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3343         16  CL-LAST-MAINT-TYPE      PIC X.
  3344             88  CLAIM-SET-UP           VALUE ' '.
  3345             88  PAYMENT-MADE           VALUE '1'.
  3346             88  LETTER-SENT            VALUE '2'.
  3347             88  MASTER-WAS-ALTERED     VALUE '3'.
  3348             88  MASTER-WAS-RESTORED    VALUE '4'.
  3349             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3350             88  FILE-CONVERTED         VALUE '6'.
  3351             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3352             88  ERROR-CORRECTION       VALUE 'E'.
  3353         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3354         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3355         16  CL-BENEFICIARY          PIC X(10).
  3356         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3357         16  CL-DENIAL-TYPE          PIC X.
  3358             88  CL-TYPE-DENIAL          VALUE '1'.
  3359             88  CL-TYPE-RESCISSION      VALUE '2'.
  3360             88  CL-TYPE-REFORMATION     VALUE '3'.
  3361             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3362             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3363         16  FILLER                  PIC X(5).
  3364
  3365     12  CL-TRAILER-CONTROLS.
  3366         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3367             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3368             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3369             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3370         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3371         16  FILLER                  PIC XX.
  3372         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3373         16  CL-ADDRESS-TRAILER-CNT.
  3374             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3375                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3376             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3377                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3378             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3379                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3380             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3381                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3382             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3383                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3384             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3385                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3386             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3387                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3388
  3389     12  CL-CV-REFERENCE-NO.
  3390         16  CL-CV-REFNO-PRIME       PIC X(18).
  3391         16  CL-CV-REFNO-SFX         PIC XX.
  3392
  3393     12  CL-FILE-LOCATION            PIC X(4).
  3394
  3395     12  CL-PROCESS-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  64
* EL131.cbl
  3396         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3397             88  NO-FATAL-ERRORS        VALUE ZERO.
  3398         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3399             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3400
  3401     12  CL-PRODUCT-CD               PIC X.
  3402
  3403     12  CL-CURRENT-KEY-DATA.
  3404         16  CL-CURRENT-CARRIER      PIC X.
  3405         16  CL-CURRENT-GROUPING     PIC X(6).
  3406         16  CL-CURRENT-STATE        PIC XX.
  3407         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3408
  3409     12  CL-ASSOCIATES               PIC X.
  3410         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3411         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3412         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3413         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3414
  3415     12  CL-ACTIVITY-CODE            PIC 99.
  3416     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3417     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3418
  3419     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3420     12  CL-LAG-REPORT-CODE          PIC 9.
  3421     12  CL-LOAN-TYPE                PIC XX.
  3422     12  CL-LEGAL-STATE              PIC XX.
  3423
  3424*    12  FILLER                      PIC X(5).
  3425     12  CL-YESNOSW                  PIC X.
  3426     12  FILLER                      PIC X(4).
  3427
  3428*                                COPY ELCCERT.
  3429******************************************************************
  3430*                                                                *
  3431*                            ELCCERT.                            *
  3432*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3433*                            VMOD=2.013                          *
  3434*                                                                *
  3435*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3436*                                                                *
  3437*   FILE TYPE = VSAM,KSDS                                        *
  3438*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3439*                                                                *
  3440*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3441*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3442*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3443*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3444*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3445*                                                                *
  3446*   LOG = YES                                                    *
  3447*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3448******************************************************************
  3449*                   C H A N G E   L O G
  3450*
  3451* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3452*-----------------------------------------------------------------
  3453*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  65
* EL131.cbl
  3454* EFFECTIVE    NUMBER
  3455*-----------------------------------------------------------------
  3456* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3457* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3458* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3459* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3460* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3461* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3462* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3463* 032612  CR2011110200001  PEMA  AHL CHANGES
  3464******************************************************************
  3465
  3466 01  CERTIFICATE-MASTER.
  3467     12  CM-RECORD-ID                      PIC XX.
  3468         88  VALID-CM-ID                      VALUE 'CM'.
  3469
  3470     12  CM-CONTROL-PRIMARY.
  3471         16  CM-COMPANY-CD                 PIC X.
  3472         16  CM-CARRIER                    PIC X.
  3473         16  CM-GROUPING.
  3474             20  CM-GROUPING-PREFIX        PIC X(3).
  3475             20  CM-GROUPING-PRIME         PIC X(3).
  3476         16  CM-STATE                      PIC XX.
  3477         16  CM-ACCOUNT.
  3478             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3479             20  CM-ACCOUNT-PRIME          PIC X(6).
  3480         16  CM-CERT-EFF-DT                PIC XX.
  3481         16  CM-CERT-NO.
  3482             20  CM-CERT-PRIME             PIC X(10).
  3483             20  CM-CERT-SFX               PIC X.
  3484
  3485     12  CM-CONTROL-BY-NAME.
  3486         16  CM-COMPANY-CD-A1              PIC X.
  3487         16  CM-INSURED-LAST-NAME          PIC X(15).
  3488         16  CM-INSURED-INITIALS.
  3489             20  CM-INSURED-INITIAL1       PIC X.
  3490             20  CM-INSURED-INITIAL2       PIC X.
  3491
  3492     12  CM-CONTROL-BY-SSN.
  3493         16  CM-COMPANY-CD-A2              PIC X.
  3494         16  CM-SOC-SEC-NO.
  3495             20  CM-SSN-STATE              PIC XX.
  3496             20  CM-SSN-ACCOUNT            PIC X(6).
  3497             20  CM-SSN-LN3.
  3498                 25  CM-INSURED-INITIALS-A2.
  3499                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3500                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3501                 25 CM-PART-LAST-NAME-A2         PIC X.
  3502
  3503     12  CM-CONTROL-BY-CERT-NO.
  3504         16  CM-COMPANY-CD-A4              PIC X.
  3505         16  CM-CERT-NO-A4                 PIC X(11).
  3506
  3507     12  CM-CONTROL-BY-MEMB.
  3508         16  CM-COMPANY-CD-A5              PIC X.
  3509         16  CM-MEMBER-NO.
  3510             20  CM-MEMB-STATE             PIC XX.
  3511             20  CM-MEMB-ACCOUNT           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  66
* EL131.cbl
  3512             20  CM-MEMB-LN4.
  3513                 25  CM-INSURED-INITIALS-A5.
  3514                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3515                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3516                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3517
  3518     12  CM-INSURED-PROFILE-DATA.
  3519         16  CM-INSURED-FIRST-NAME.
  3520             20  CM-INSURED-1ST-INIT       PIC X.
  3521             20  FILLER                    PIC X(9).
  3522         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3523         16  CM-INSURED-SEX                PIC X.
  3524             88  CM-SEX-MALE                  VALUE 'M'.
  3525             88  CM-SEX-FEMAL                 VALUE 'F'.
  3526         16  CM-INSURED-JOINT-AGE          PIC 99.
  3527         16  CM-JOINT-INSURED-NAME.
  3528             20  CM-JT-LAST-NAME           PIC X(15).
  3529             20  CM-JT-FIRST-NAME.
  3530                 24  CM-JT-1ST-INIT        PIC X.
  3531                 24  FILLER                PIC X(9).
  3532             20  CM-JT-INITIAL             PIC X.
  3533
  3534     12  CM-LIFE-DATA.
  3535         16  CM-LF-BENEFIT-CD              PIC XX.
  3536         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3537         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3538         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3539         16  CM-LF-DEV-CODE                PIC XXX.
  3540         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3541         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3542         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3543         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3544         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3545         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3546         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3547         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3548         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3549         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3550         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3551         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3552         16  FILLER                        PIC XX.
  3553
  3554     12  CM-AH-DATA.
  3555         16  CM-AH-BENEFIT-CD              PIC XX.
  3556         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3557         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3558         16  CM-AH-DEV-CODE                PIC XXX.
  3559         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3560         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3561         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3562         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3563         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3564         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3565         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3566         16  CM-AH-PAID-THRU-DT            PIC XX.
  3567             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3568         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3569         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  67
* EL131.cbl
  3570         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3571         16  FILLER                        PIC X.
  3572
  3573     12  CM-LOAN-INFORMATION.
  3574         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3575         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3576                                           PIC S9(5)V99  COMP-3.
  3577         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3578         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3579         16  CM-PAY-FREQUENCY              PIC S99.
  3580         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3581         16  CM-RATE-CLASS                 PIC XX.
  3582         16  CM-BENEFICIARY                PIC X(25).
  3583         16  CM-POLICY-FORM-NO             PIC X(12).
  3584         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3585         16  CM-LAST-ADD-ON-DT             PIC XX.
  3586         16  CM-DEDUCTIBLE-AMOUNTS.
  3587             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3588             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3589         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3590             20  CM-RESIDENT-STATE         PIC XX.
  3591             20  CM-RATE-CODE              PIC X(4).
  3592             20  FILLER                    PIC XX.
  3593         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3594             20  CM-LOAN-OFFICER           PIC X(5).
  3595             20  FILLER                    PIC XXX.
  3596         16  CM-CSR-CODE                   PIC XXX.
  3597         16  CM-UNDERWRITING-CODE          PIC X.
  3598             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3599         16  CM-POST-CARD-IND              PIC X.
  3600         16  CM-NH-INTERFACE-SW            PIC X.
  3601         16  CM-PREMIUM-TYPE               PIC X.
  3602             88  CM-SING-PRM                  VALUE '1'.
  3603             88  CM-O-B-COVERAGE              VALUE '2'.
  3604             88  CM-OPEN-END                  VALUE '3'.
  3605         16  CM-IND-GRP-TYPE               PIC X.
  3606             88  CM-INDIVIDUAL                VALUE 'I'.
  3607             88  CM-GROUP                     VALUE 'G'.
  3608         16  CM-SKIP-CODE                  PIC X.
  3609             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3610             88  SKIP-JULY                    VALUE '1'.
  3611             88  SKIP-AUGUST                  VALUE '2'.
  3612             88  SKIP-SEPTEMBER               VALUE '3'.
  3613             88  SKIP-JULY-AUG                VALUE '4'.
  3614             88  SKIP-AUG-SEPT                VALUE '5'.
  3615             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3616             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3617             88  SKIP-JUNE                    VALUE '8'.
  3618             88  SKIP-JUNE-JULY               VALUE '9'.
  3619             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3620             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3621         16  CM-PAYMENT-MODE               PIC X.
  3622             88  PAY-MONTHLY                  VALUE SPACE.
  3623             88  PAY-WEEKLY                   VALUE '1'.
  3624             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3625             88  PAY-BI-WEEKLY                VALUE '3'.
  3626             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3627         16  CM-LOAN-NUMBER                PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  68
* EL131.cbl
  3628         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3629         16  CM-OLD-LOF                    PIC XXX.
  3630*        16  CM-LOAN-OFFICER               PIC XXX.
  3631         16  CM-REIN-TABLE                 PIC XXX.
  3632         16  CM-SPECIAL-REIN-CODE          PIC X.
  3633         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3634         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3635         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3636
  3637     12  CM-STATUS-DATA.
  3638         16  CM-ENTRY-STATUS               PIC X.
  3639         16  CM-ENTRY-DT                   PIC XX.
  3640
  3641         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3642         16  CM-LF-CANCEL-DT               PIC XX.
  3643         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3644
  3645         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3646         16  CM-LF-DEATH-DT                PIC XX.
  3647         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3648
  3649         16  CM-LF-CURRENT-STATUS          PIC X.
  3650             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3651                                                'M' '4' '5' '9'.
  3652             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3653             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3654             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3655             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  3656             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3657             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3658             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  3659             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3660             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  3661             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3662             88  CM-LF-DECLINED               VALUE 'D'.
  3663             88  CM-LF-VOIDED                 VALUE 'V'.
  3664
  3665         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3666         16  CM-AH-CANCEL-DT               PIC XX.
  3667         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3668
  3669         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3670         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3671         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3672
  3673         16  CM-AH-CURRENT-STATUS          PIC X.
  3674             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3675                                                'M' '4' '5' '9'.
  3676             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  3677             88  CM-AH-POLICY-PENDING         VALUE '2'.
  3678             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  3679             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  3680             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  3681             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3682             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  3683             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3684             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  3685             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  69
* EL131.cbl
  3686             88  CM-AH-DECLINED               VALUE 'D'.
  3687             88  CM-AH-VOIDED                 VALUE 'V'.
  3688
  3689         16  CM-CLAIM-INTERFACE-SW         PIC X.
  3690             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  3691             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  3692             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  3693         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  3694
  3695         16  CM-ENTRY-BATCH                PIC X(6).
  3696         16  CM-LF-EXIT-BATCH              PIC X(6).
  3697         16  CM-AH-EXIT-BATCH              PIC X(6).
  3698         16  CM-LAST-MONTH-END             PIC XX.
  3699
  3700     12  CM-NOTE-SW                        PIC X.
  3701         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  3702         88  CERT-NOTES-PRESENT               VALUE '1'.
  3703         88  BILLING-NOTES-PRESENT            VALUE '2'.
  3704         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  3705         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  3706         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  3707         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  3708         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  3709     12  CM-COMP-EXCP-SW                   PIC X.
  3710         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  3711         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  3712     12  CM-INSURED-ADDRESS-SW             PIC X.
  3713         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  3714         88  INSURED-ADDR-PRESENT             VALUE '1'.
  3715
  3716*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  3717     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  3718     12  FILLER                            PIC X.
  3719
  3720*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  3721     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  3722     12  FILLER                            PIC X.
  3723*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  3724     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  3725
  3726     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  3727         88  CERT-ADDED-BATCH                 VALUE ' '.
  3728         88  CERT-ADDED-ONLINE                VALUE '1'.
  3729         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  3730         88  CERT-PURGED-OFFLINE              VALUE '3'.
  3731         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  3732     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  3733         88  CERT-AS-LOADED                   VALUE ' '.
  3734         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  3735         88  CERT-CLAIM-ONLINE                VALUE '2'.
  3736         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  3737         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  3738         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  3739         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  3740         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  3741
  3742     12  CM-ACCOUNT-COMM-PCTS.
  3743         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  70
* EL131.cbl
  3744         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3745
  3746     12  CM-USER-FIELD                     PIC X.
  3747     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  3748     12  CM-CLP-STATE                      PIC XX.
  3749     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  3750     12  CM-USER-RESERVED                  PIC XXX.
  3751     12  FILLER REDEFINES CM-USER-RESERVED.
  3752         16  CM-AH-CLASS-CD                PIC XX.
  3753         16  F                             PIC X.
  3754******************************************************************
  3755
  3756*                                COPY ELCTRLR.
  3757******************************************************************
  3758*                                                                *
  3759*                            ELCTRLR.                            *
  3760*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3761*                            VMOD=2.014                          *
  3762*                                                                *
  3763*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  3764*                                                                *
  3765*   FILE TYPE = VSAM,KSDS                                        *
  3766*   RECORD SIZE = 200    RECFORM = FIXED                         *
  3767*                                                                *
  3768*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  3769*       ALTERNATE INDEX = NONE                                   *
  3770*                                                                *
  3771*   LOG = YES                                                    *
  3772*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3773******************************************************************
  3774*                   C H A N G E   L O G
  3775*
  3776* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3777*-----------------------------------------------------------------
  3778*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3779* EFFECTIVE    NUMBER
  3780*-----------------------------------------------------------------
  3781* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3782* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  3783* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  3784* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  3785* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  3786* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  3787* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  3788* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  3789* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  3790* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  3791* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  3792* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  3793* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  3794* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  3795* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  3796******************************************************************
  3797 01  ACTIVITY-TRAILERS.
  3798     12  AT-RECORD-ID                    PIC XX.
  3799         88  VALID-AT-ID                       VALUE 'AT'.
  3800
  3801     12  AT-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  71
* EL131.cbl
  3802         16  AT-COMPANY-CD               PIC X.
  3803         16  AT-CARRIER                  PIC X.
  3804         16  AT-CLAIM-NO                 PIC X(7).
  3805         16  AT-CERT-NO.
  3806             20  AT-CERT-PRIME           PIC X(10).
  3807             20  AT-CERT-SFX             PIC X.
  3808         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  3809             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  3810             88  AT-LAST-TRL-AVAIL            VALUE +100.
  3811             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  3812             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  3813             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  3814             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  3815             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  3816             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  3817             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  3818             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  3819             88  AT-DIAGNOSIS-TRL             VALUE +90.
  3820             88  AT-BENEFICIARY-TRL           VALUE +91.
  3821             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  3822             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  3823             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  3824
  3825     12  AT-TRAILER-TYPE                 PIC X.
  3826         88  RESERVE-EXPENSE-TR               VALUE '1'.
  3827         88  PAYMENT-TR                       VALUE '2'.
  3828         88  AUTO-PAY-TR                      VALUE '3'.
  3829         88  CORRESPONDENCE-TR                VALUE '4'.
  3830         88  ADDRESS-TR                       VALUE '5'.
  3831         88  GENERAL-INFO-TR                  VALUE '6'.
  3832         88  AUTO-PROMPT-TR                   VALUE '7'.
  3833         88  DENIAL-TR                        VALUE '8'.
  3834         88  INCURRED-CHG-TR                  VALUE '9'.
  3835         88  FORM-CONTROL-TR                  VALUE 'A'.
  3836
  3837     12  AT-RECORDED-DT                  PIC XX.
  3838     12  AT-RECORDED-BY                  PIC X(4).
  3839     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  3840
  3841     12  AT-TRAILER-BODY                 PIC X(165).
  3842
  3843     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  3844         16  AT-RESERVE-CONTROLS.
  3845             20  AT-MANUAL-SW            PIC X.
  3846                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  3847             20  AT-FUTURE-SW            PIC X.
  3848                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  3849             20  AT-PTC-SW               PIC X.
  3850                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  3851             20  AT-IBNR-SW              PIC X.
  3852                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  3853             20  AT-PTC-LF-SW            PIC X.
  3854                 88  AT-LF-PTC-USED          VALUE '1'.
  3855             20  AT-CDT-ACCESS-METHOD    PIC X.
  3856                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  3857                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  3858                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  3859             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  72
* EL131.cbl
  3860         16  AT-LAST-COMPUTED-DT         PIC XX.
  3861         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  3862         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  3863         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  3864         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  3865         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  3866         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  3867         16  AT-EXPENSE-CONTROLS.
  3868             20  AT-EXPENSE-METHOD       PIC X.
  3869                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  3870                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  3871                 88  PERCENT-OF-PMT           VALUE '3'.
  3872                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  3873             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  3874             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  3875         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  3876         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  3877
  3878         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  3879         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  3880
  3881*        16  FILLER                      PIC X(53).
  3882         16  FILLER                      PIC X(47).
  3883
  3884         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  3885         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  3886
  3887         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  3888             20  AT-OPEN-CLOSE-DATE      PIC XX.
  3889             20  AT-OPEN-CLOSE-TYPE      PIC X.
  3890*                    C = CLOSED
  3891*                    O = OPEN
  3892             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  3893*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  3894
  3895     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  3896         16  AT-PAYMENT-TYPE             PIC X.
  3897             88  PARTIAL-PAYMENT                VALUE '1'.
  3898             88  FINAL-PAYMENT                  VALUE '2'.
  3899             88  LUMP-SUM-PAYMENT               VALUE '3'.
  3900             88  ADDITIONAL-PAYMENT             VALUE '4'.
  3901             88  CHARGEABLE-EXPENSE             VALUE '5'.
  3902             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  3903             88  VOIDED-PAYMENT                 VALUE '9'.
  3904             88  TRANSFER                       VALUE 'T'.
  3905             88  LIFE-INTEREST                  VALUE 'I'.
  3906
  3907         16  AT-CLAIM-TYPE               PIC X.
  3908             88  PAID-FOR-AH                    VALUE 'A'.
  3909             88  PAID-FOR-LIFE                  VALUE 'L'.
  3910             88  PAID-FOR-IUI                   VALUE 'I'.
  3911             88  PAID-FOR-GAP                   VALUE 'G'.
  3912         16  AT-CLAIM-PREM-TYPE          PIC X.
  3913             88  AT-SINGLE-PREMIUM              VALUE '1'.
  3914             88  AT-O-B-COVERAGE                VALUE '2'.
  3915             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  3916         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  3917         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  73
* EL131.cbl
  3918         16  AT-PAID-FROM-DT             PIC XX.
  3919         16  AT-PAID-THRU-DT             PIC XX.
  3920         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  3921         16  FILLER                      PIC X.
  3922         16  AT-PAYEES-NAME              PIC X(30).
  3923         16  AT-PAYMENT-ORIGIN           PIC X.
  3924             88  ONLINE-MANUAL-PMT              VALUE '1'.
  3925             88  ONLINE-AUTO-PMT                VALUE '2'.
  3926             88  OFFLINE-PMT                    VALUE '3'.
  3927         16  AT-CHECK-WRITTEN-DT         PIC XX.
  3928         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  3929         16  AT-VOID-DATA.
  3930             20  AT-VOID-DT              PIC XX.
  3931*00144       20  AT-VOID-REASON          PIC X(30).
  3932             20  AT-VOID-REASON          PIC X(26).
  3933         16  AT-PMT-APPROVED-BY          PIC X(04).
  3934         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  3935         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  3936         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  3937                                         PIC S99V9(5)  COMP-3.
  3938         16  AT-CREDIT-INTERFACE.
  3939             20  AT-PMT-SELECT-DT        PIC XX.
  3940                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  3941             20  AT-PMT-ACCEPT-DT        PIC XX.
  3942                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  3943             20  AT-VOID-SELECT-DT       PIC XX.
  3944                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  3945             20  AT-VOID-ACCEPT-DT       PIC XX.
  3946                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  3947
  3948         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  3949                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3950                 88  CONVERSION-PAYMENT           VALUE +99999999.
  3951         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  3952
  3953         16  AT-FORCE-CONTROL            PIC X.
  3954             88  PAYMENT-WAS-FORCED           VALUE '1'.
  3955         16  AT-PREV-LAST-PMT-DT         PIC XX.
  3956         16  AT-PREV-PAID-THRU-DT        PIC XX.
  3957         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  3958         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  3959         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  3960         16  AT-BENEFIT-TYPE             PIC X.
  3961
  3962         16  AT-EXPENSE-TYPE             PIC X.
  3963         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  3964
  3965         16  AT-PAYEE-TYPE-CD.
  3966             20  AT-PAYEE-TYPE           PIC X.
  3967                 88  INSURED-PAID           VALUE 'I'.
  3968                 88  BENEFICIARY-PAID       VALUE 'B'.
  3969                 88  ACCOUNT-PAID           VALUE 'A'.
  3970                 88  OTHER-1-PAID           VALUE 'O'.
  3971                 88  OTHER-2-PAID           VALUE 'Q'.
  3972                 88  DOCTOR-PAID            VALUE 'P'.
  3973                 88  EMPLOYER-PAID          VALUE 'E'.
  3974             20  AT-PAYEE-SEQ            PIC X.
  3975
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  74
* EL131.cbl
  3976         16  AT-CASH-PAYMENT             PIC X.
  3977         16  AT-GROUPED-PAYMENT          PIC X.
  3978         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  3979         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  3980         16  AT-APPROVED-LEVEL           PIC X.
  3981         16  AT-VOID-TYPE                PIC X.
  3982             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  3983             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  3984         16  AT-AIG-UNEMP-IND            PIC X.
  3985             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  3986         16  AT-ASSOCIATES               PIC X.
  3987             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  3988             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  3989
  3990         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  3991         16  AT-CV-PMT-CODE              PIC X.
  3992             88  FULL-DEATH-PAYMENT         VALUE '1'.
  3993             88  HALF-DEATH-PAYMENT         VALUE '2'.
  3994             88  FULL-ADD-PAYMENT           VALUE '3'.
  3995             88  HALF-ADD-PAYMENT           VALUE '4'.
  3996             88  FULL-RIDER-PAYMENT         VALUE '5'.
  3997             88  HALF-RIDER-PAYMENT         VALUE '6'.
  3998             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  3999             88  ADDL-PAYMENT               VALUE '8'.
  4000
  4001         16  AT-EOB-CODE1                PIC XXX.
  4002         16  AT-EOB-CODE2                PIC XXX.
  4003         16  AT-EOB-CODE3                PIC XXX.
  4004         16  FILLER REDEFINES AT-EOB-CODE3.
  4005             20  AT-PRINT-CLM-FORM       PIC X.
  4006             20  AT-PRINT-SURVEY         PIC X.
  4007             20  FILLER                  PIC X.
  4008         16  AT-EOB-CODE4                PIC XXX.
  4009         16  FILLER REDEFINES AT-EOB-CODE4.
  4010             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4011             20  FILLER                  PIC X.
  4012         16  AT-EOB-CODE5                PIC XXX.
  4013         16  FILLER REDEFINES AT-EOB-CODE5.
  4014             20  AT-PMT-PROOF-DT         PIC XX.
  4015             20  FILLER                  PIC X.
  4016
  4017         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4018             88  AT-PRINT-EOB            VALUE 'Y'.
  4019
  4020         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4021         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4022
  4023     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4024         16  AT-SCHEDULE-START-DT        PIC XX.
  4025         16  AT-SCHEDULE-END-DT          PIC XX.
  4026         16  AT-TERMINATED-DT            PIC XX.
  4027         16  AT-LAST-PMT-TYPE            PIC X.
  4028             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4029             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4030         16  AT-FIRST-PMT-DATA.
  4031             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4032             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4033             20  AT-1ST-PAY-THRU-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  75
* EL131.cbl
  4034         16  AT-REGULAR-PMT-DATA.
  4035             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4036             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4037             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4038         16  AT-AUTO-PAYEE-CD.
  4039             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4040                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4041                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4042                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4043                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4044                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4045             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4046         16  AT-AUTO-PAY-DAY             PIC 99.
  4047         16  AT-AUTO-CASH                PIC X.
  4048             88  AT-CASH                      VALUE 'Y'.
  4049             88  AT-NON-CASH                  VALUE 'N'.
  4050*        16  FILLER                      PIC X(129).
  4051         16  AT-AUTO-END-LETTER          PIC X(4).
  4052         16  FILLER                      PIC X(125).
  4053
  4054         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4055         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4056
  4057     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4058         16  AT-LETTER-SENT-DT           PIC XX.
  4059         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4060         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4061         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4062         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4063         16  AT-LETTER-ORIGIN            PIC X.
  4064             88  ONLINE-CREATION              VALUE '1' '3'.
  4065             88  OFFLINE-CREATION             VALUE '2' '4'.
  4066             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4067             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4068         16  AT-STD-LETTER-FORM          PIC X(4).
  4069         16  AT-REASON-TEXT              PIC X(70).
  4070         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4071         16  AT-ADDRESEE-TYPE            PIC X.
  4072              88  INSURED-ADDRESEE            VALUE 'I'.
  4073              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4074              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4075              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4076              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4077              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4078              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4079         16  AT-ADDRESSEE-NAME           PIC X(30).
  4080         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4081         16  AT-RESEND-PRINT-DATE        PIC XX.
  4082         16  AT-CORR-SOL-UNSOL           PIC X.
  4083         16  AT-LETTER-PURGED-DT         PIC XX.
  4084*
  4085*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4086*
  4087         16  AT-CSO-REDEFINITION.
  4088             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4089             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4090             20  AT-LETTER-TO-BENE       PIC X(1).
  4091             20  AT-STOP-LETTER-DT       PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  76
* EL131.cbl
  4092             20  FILLER                  PIC X(19).
  4093*             20  FILLER                  PIC X(27).
  4094             20  AT-CSO-LETTER-STATUS    PIC X.
  4095                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4096                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4097                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4098             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4099             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4100*
  4101*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4102*
  4103*        16  FILLER                      PIC X(26).
  4104*
  4105*        16  AT-DMD-BSR-CODE             PIC X.
  4106*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4107*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4108*
  4109*        16  AT-DMD-LETTER-STATUS        PIC X.
  4110*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4111*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4112*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4113*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4114*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4115
  4116         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4117         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4118
  4119     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4120         16  AT-ADDRESS-TYPE             PIC X.
  4121             88  INSURED-ADDRESS               VALUE 'I'.
  4122             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4123             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4124             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4125             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4126             88  OTHER-ADDRESS-1               VALUE 'O'.
  4127             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4128         16  AT-MAIL-TO-NAME             PIC X(30).
  4129         16  AT-ADDRESS-LINE-1           PIC X(30).
  4130         16  AT-ADDRESS-LINE-2           PIC X(30).
  4131         16  AT-CITY-STATE.
  4132             20  AT-CITY                 PIC X(28).
  4133             20  AT-STATE                PIC XX.
  4134         16  AT-ZIP.
  4135             20  AT-ZIP-CODE.
  4136                 24  AT-ZIP-1ST          PIC X.
  4137                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4138                 24  FILLER              PIC X(4).
  4139             20  AT-ZIP-PLUS4            PIC X(4).
  4140         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4141             20  AT-CAN-POSTAL-1         PIC XXX.
  4142             20  AT-CAN-POSTAL-2         PIC XXX.
  4143             20  FILLER                  PIC XXX.
  4144         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4145*         16  FILLER                      PIC X(23).
  4146         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4147         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4148         16  FILLER                      PIC X(13).
  4149         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  77
* EL131.cbl
  4150         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4151
  4152     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4153         16  AT-INFO-LINE-1              PIC X(60).
  4154         16  AT-INFO-LINE-2              PIC X(60).
  4155         16  AT-INFO-TRAILER-TYPE        PIC X.
  4156             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4157             88  AT-CALL-NOTE            VALUE 'C'.
  4158             88  AT-MAINT-NOTE           VALUE 'M'.
  4159             88  AT-CERT-CHANGE          VALUE 'X'.
  4160             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4161             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4162         16  AT-CALL-TYPE                PIC X.
  4163             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4164             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4165         16  AT-NOTE-CONTINUATION        PIC X.
  4166             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4167         16  AT-EOB-CODES-EXIST          PIC X.
  4168             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4169         16  FILLER                      PIC X(35).
  4170         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4171         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4172
  4173     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4174         16  AT-PROMPT-LINE-1            PIC X(60).
  4175         16  AT-PROMPT-LINE-2            PIC X(60).
  4176         16  AT-PROMPT-START-DT          PIC XX.
  4177         16  AT-PROMPT-END-DT            PIC XX.
  4178         16  FILLER                      PIC X(35).
  4179         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4180         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4181
  4182     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4183         16  AT-DENIAL-INFO-1            PIC X(60).
  4184         16  AT-DENIAL-INFO-2            PIC X(60).
  4185         16  AT-DENIAL-DT                PIC XX.
  4186         16  AT-RETRACTION-DT            PIC XX.
  4187         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4188*         16  FILLER                      PIC X(31).
  4189         16  AT-DENIAL-PROOF-DT          PIC XX.
  4190         16  FILLER                      PIC X(29).
  4191         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4192         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4193
  4194     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4195         16  AT-OLD-INCURRED-DT          PIC XX.
  4196         16  AT-OLD-REPORTED-DT          PIC XX.
  4197         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4198         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4199         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4200         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4201         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4202         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4203         16  FILLER                      PIC X(26).
  4204         16  AT-OLD-DIAG-CODE            PIC X(6).
  4205         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4206         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4207         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  78
* EL131.cbl
  4208         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4209         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4210         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4211         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4212         16  FILLER                      PIC X(25).
  4213         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4214
  4215     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4216         16  AT-FORM-SEND-ON-DT          PIC XX.
  4217         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4218         16  AT-FORM-RE-SEND-DT          PIC XX.
  4219         16  AT-FORM-ANSWERED-DT         PIC XX.
  4220         16  AT-FORM-PRINTED-DT          PIC XX.
  4221         16  AT-FORM-REPRINT-DT          PIC XX.
  4222         16  AT-FORM-TYPE                PIC X.
  4223             88  INITIAL-FORM                  VALUE '1'.
  4224             88  PROGRESS-FORM                 VALUE '2'.
  4225         16  AT-INSTRUCT-LN-1            PIC X(28).
  4226         16  AT-INSTRUCT-LN-2            PIC X(28).
  4227         16  AT-INSTRUCT-LN-3            PIC X(28).
  4228         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4229         16  AT-FORM-ADDRESS             PIC X.
  4230             88  FORM-TO-INSURED              VALUE 'I'.
  4231             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4232             88  FORM-TO-OTHER-1              VALUE 'O'.
  4233             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4234         16  AT-RELATED-1.
  4235             20 AT-REL-CARR-1            PIC X.
  4236             20 AT-REL-CLAIM-1           PIC X(7).
  4237             20 AT-REL-CERT-1            PIC X(11).
  4238         16  AT-RELATED-2.
  4239             20 AT-REL-CARR-2            PIC X.
  4240             20 AT-REL-CLAIM-2           PIC X(7).
  4241             20 AT-REL-CERT-2            PIC X(11).
  4242         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4243         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4244         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4245         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4246         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4247         16  AT-STOP-FORM-DT             PIC X(2).
  4248
  4249         16  FILLER                      PIC X(09).
  4250         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4251         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4252******************************************************************
  4253
  4254*                                COPY ELCCNTL.
  4255******************************************************************
  4256*                                                                *
  4257*                                                                *
  4258*                            ELCCNTL.                            *
  4259*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4260*                            VMOD=2.059                          *
  4261*                                                                *
  4262*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4263*                                                                *
  4264*   FILE TYPE = VSAM,KSDS                                        *
  4265*   RECORD SIZE = 750  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  79
* EL131.cbl
  4266*                                                                *
  4267*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4268*       ALTERNATE INDEX = NONE                                   *
  4269*                                                                *
  4270*   LOG = YES                                                    *
  4271*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4272******************************************************************
  4273*                   C H A N G E   L O G
  4274*
  4275* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4276*-----------------------------------------------------------------
  4277*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4278* EFFECTIVE    NUMBER
  4279*-----------------------------------------------------------------
  4280* 082503                   PEMA  ADD BENEFIT GROUP
  4281* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4282* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4283* 092705    2005050300006  PEMA  ADD SPP LEASES
  4284* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4285* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4286* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4287* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4288* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4289* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4290* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4291* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4292******************************************************************
  4293*
  4294 01  CONTROL-FILE.
  4295     12  CF-RECORD-ID                       PIC XX.
  4296         88  VALID-CF-ID                        VALUE 'CF'.
  4297
  4298     12  CF-CONTROL-PRIMARY.
  4299         16  CF-COMPANY-ID                  PIC XXX.
  4300         16  CF-RECORD-TYPE                 PIC X.
  4301             88  CF-COMPANY-MASTER              VALUE '1'.
  4302             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4303             88  CF-STATE-MASTER                VALUE '3'.
  4304             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4305             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4306             88  CF-CARRIER-MASTER              VALUE '6'.
  4307             88  CF-MORTALITY-MASTER            VALUE '7'.
  4308             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4309             88  CF-TERMINAL-MASTER             VALUE '9'.
  4310             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4311             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4312             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4313             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4314             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4315             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4316             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4317             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4318             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4319         16  CF-ACCESS-CD-GENL              PIC X(4).
  4320         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4321             20  CF-PROCESSOR               PIC X(4).
  4322         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4323             20  CF-STATE-CODE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  80
* EL131.cbl
  4324             20  FILLER                     PIC XX.
  4325         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4326             20  FILLER                     PIC XX.
  4327             20  CF-HI-BEN-IN-REC           PIC XX.
  4328         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4329             20  FILLER                     PIC XXX.
  4330             20  CF-CARRIER-CNTL            PIC X.
  4331         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4332             20  FILLER                     PIC XX.
  4333             20  CF-HI-TYPE-IN-REC          PIC 99.
  4334         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4335             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4336                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4337             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4338             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4339         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4340             20  FILLER                     PIC X.
  4341             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4342         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4343             20  FILLER                     PIC XX.
  4344             20  CF-MORTGAGE-PLAN           PIC XX.
  4345         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4346
  4347     12  CF-LAST-MAINT-DT                   PIC XX.
  4348     12  CF-LAST-MAINT-BY                   PIC X(4).
  4349     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4350
  4351     12  CF-RECORD-BODY                     PIC X(728).
  4352
  4353
  4354****************************************************************
  4355*             COMPANY MASTER RECORD                            *
  4356****************************************************************
  4357
  4358     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4359         16  CF-COMPANY-ADDRESS.
  4360             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4361             20  CF-CL-IN-CARE-OF           PIC X(30).
  4362             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4363             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4364             20  CF-CL-CITY-STATE           PIC X(30).
  4365             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4366             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4367         16  CF-COMPANY-CD                  PIC X.
  4368         16  CF-COMPANY-PASSWORD            PIC X(8).
  4369         16  CF-SECURITY-OPTION             PIC X.
  4370             88  ALL-SECURITY                   VALUE '1'.
  4371             88  COMPANY-VERIFY                 VALUE '2'.
  4372             88  PROCESSOR-VERIFY               VALUE '3'.
  4373             88  NO-SECURITY                    VALUE '4'.
  4374             88  ALL-BUT-TERM                   VALUE '5'.
  4375         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4376             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4377         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4378             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4379         16  CF-INFORCE-LOCATION            PIC X.
  4380             88  CERTS-ARE-ONLINE               VALUE '1'.
  4381             88  CERTS-ARE-OFFLINE              VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  81
* EL131.cbl
  4382             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4383         16  CF-LOWER-CASE-LETTERS          PIC X.
  4384         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4385             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4386             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4387             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4388             88  CF-ACCNT-CNTL                  VALUE '3'.
  4389             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4390
  4391         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4392         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4393
  4394         16  CF-LGX-CREDIT-USER             PIC X.
  4395             88  CO-IS-NOT-USER                 VALUE 'N'.
  4396             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4397
  4398         16 CF-CREDIT-CALC-CODES.
  4399             20  CF-CR-REM-TERM-CALC PIC X.
  4400               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4401               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4402               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4403               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4404               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4405               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4406               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4407             20  CF-CR-R78-METHOD           PIC X.
  4408               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4409               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4410
  4411         16  CF-CLAIM-CONTROL-COUNTS.
  4412             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4413                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4414
  4415             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4416                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4417
  4418             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4419                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4420
  4421             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4422                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4423
  4424         16  CF-CURRENT-MONTH-END           PIC XX.
  4425
  4426         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4427             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4428             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4429             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4430             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4431                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4432                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4433             20  CF-CO-PREM-REJECT-SW       PIC X.
  4434                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4435                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4436             20  CF-CO-REF-REJECT-SW        PIC X.
  4437                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4438                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4439
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  82
* EL131.cbl
  4440         16  CF-CO-REPORTING-DT             PIC XX.
  4441         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4442         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4443           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4444           88  CF-CO-MONTH-END                  VALUE '1'.
  4445
  4446         16  CF-LGX-CLAIM-USER              PIC X.
  4447             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4448             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4449
  4450         16  CF-CREDIT-EDIT-CONTROLS.
  4451             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4452             20  CF-MIN-AGE                 PIC 99.
  4453             20  CF-DEFAULT-AGE             PIC 99.
  4454             20  CF-MIN-TERM                PIC S999      COMP-3.
  4455             20  CF-MAX-TERM                PIC S999      COMP-3.
  4456             20  CF-DEFAULT-SEX             PIC X.
  4457             20  CF-JOINT-AGE-INPUT         PIC X.
  4458                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4459             20  CF-BIRTH-DATE-INPUT        PIC X.
  4460                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4461             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4462                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4463                 88  CF-ZERO-CARRIER            VALUE '1'.
  4464                 88  CF-ZERO-GROUPING           VALUE '2'.
  4465                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4466             20  CF-EDIT-SW                 PIC X.
  4467                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4468             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4469             20  CF-CR-PR-METHOD            PIC X.
  4470               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4471               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4472             20  FILLER                     PIC X.
  4473
  4474         16  CF-CREDIT-MISC-CONTROLS.
  4475             20  CF-REIN-TABLE-SW           PIC X.
  4476                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4477             20  CF-COMP-TABLE-SW           PIC X.
  4478                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4479             20  CF-EXPERIENCE-RETENTION-AGE
  4480                                            PIC S9        COMP-3.
  4481             20  CF-CONVERSION-DT           PIC XX.
  4482             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4483             20  CF-RUN-FREQUENCY-SW        PIC X.
  4484                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4485                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4486
  4487             20  CF-CR-CHECK-NO-CONTROL.
  4488                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4489                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4490                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4491                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4492                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4493                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4494
  4495                 24  CF-CR-CHECK-COUNT       REDEFINES
  4496                     CF-CR-CHECK-COUNTER      PIC X(4).
  4497
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  83
* EL131.cbl
  4498                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4499                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4500
  4501                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4502                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4503                 24  CF-MAIL-PROCESSING       PIC X.
  4504                     88  MAIL-PROCESSING          VALUE 'Y'.
  4505
  4506         16  CF-MISC-SYSTEM-CONTROL.
  4507             20  CF-SYSTEM-C                 PIC X.
  4508                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4509             20  CF-SYSTEM-D                 PIC X.
  4510                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4511             20  CF-SOC-SEC-NO-SW            PIC X.
  4512                 88  SOC-SEC-NO-USED             VALUE '1'.
  4513             20  CF-MEMBER-NO-SW             PIC X.
  4514                 88  MEMBER-NO-USED              VALUE '1'.
  4515             20  CF-TAX-ID-NUMBER            PIC X(11).
  4516             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4517             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4518                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4519                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4520                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4521                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4522             20  CF-SYSTEM-E                 PIC X.
  4523                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4524
  4525         16  CF-LGX-LIFE-USER               PIC X.
  4526             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4527             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4528
  4529         16  CF-CR-MONTH-END-DT             PIC XX.
  4530
  4531         16  CF-FILE-MAINT-DATES.
  4532             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4533                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4534             20  CF-LAST-BATCH       REDEFINES
  4535                 CF-LAST-BATCH-NO               PIC X(4).
  4536             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4537             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4538             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4539             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4540             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4541             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4542             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4543             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4544             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4545             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4546
  4547         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4548         16  FILLER                         PIC X.
  4549
  4550         16  CF-ALT-MORT-CODE               PIC X(4).
  4551         16  CF-MEMBER-CAPTION              PIC X(10).
  4552
  4553         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4554             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4555             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  84
* EL131.cbl
  4556             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4557             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4558             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4559
  4560         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4561
  4562         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4563         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4564         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4565         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4566
  4567         16  CF-AH-OVERRIDE-L1              PIC X.
  4568         16  CF-AH-OVERRIDE-L2              PIC XX.
  4569         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4570         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4571
  4572         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4573         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4574
  4575         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4576         16  CF-AR-LAST-EL860-DT            PIC XX.
  4577         16  CF-MP-MONTH-END-DT             PIC XX.
  4578
  4579         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4580         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4581             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4582
  4583         16  CF-AR-MONTH-END-DT             PIC XX.
  4584
  4585         16  CF-CRDTCRD-USER                PIC X.
  4586             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4587             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4588
  4589         16  CF-CC-MONTH-END-DT             PIC XX.
  4590
  4591         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4592
  4593         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4594             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4595             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4596             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4597         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4598         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4599         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4600         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4601             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4602             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4603         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4604         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4605         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4606             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4607         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4608
  4609         16  CF-CL-ZIP-CODE.
  4610             20  CF-CL-ZIP-PRIME.
  4611                 24  CF-CL-ZIP-1ST          PIC X.
  4612                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4613                 24  FILLER                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  85
* EL131.cbl
  4614             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4615         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4616             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4617             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4618             20  FILLER                     PIC XXX.
  4619
  4620         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4621         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4622         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4623         16  CF-CO-OPTION-START-DATE        PIC XX.
  4624         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4625           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4626                                                      '3' '4'.
  4627           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4628           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4629           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4630           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4631           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4632           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4633
  4634         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4635
  4636         16  CF-PAYMENT-APPROVAL-LEVELS.
  4637             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4638             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4639             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4640             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4641             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4642             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4643
  4644         16  CF-END-USER-REPORTING-USER     PIC X.
  4645             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4646             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4647
  4648         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4649             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4650             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4651
  4652         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4653
  4654         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4655         16  FILLER                         PIC X.
  4656
  4657         16  CF-CREDIT-ARCHIVE-CNTL.
  4658             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4659             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4660             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4661
  4662         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4663
  4664         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4665             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4666             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4667
  4668         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4669             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4670             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4671
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  86
* EL131.cbl
  4672         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4673
  4674         16  CF-CO-ACH-ID-CODE              PIC  X.
  4675             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4676             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4677             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4678         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4679         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4680         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4681         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4682         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4683         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4684         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4685         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4686         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4687                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4688         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4689                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4690
  4691         16  CF-CO-OVER-SHORT.
  4692             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4693             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4694
  4695*         16  FILLER                         PIC X(102).
  4696         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4697             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4698             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4699
  4700         16  CF-AH-APPROVAL-DAYS.
  4701             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4702             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4703             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4704             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4705
  4706         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4707
  4708         16  FILLER                         PIC X(79).
  4709****************************************************************
  4710*             PROCESSOR/USER RECORD                            *
  4711****************************************************************
  4712
  4713     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4714         16  CF-PROCESSOR-NAME              PIC X(30).
  4715         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4716         16  CF-PROCESSOR-TITLE             PIC X(26).
  4717         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4718                 88  MESSAGE-YES                VALUE 'Y'.
  4719                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4720
  4721*****************************************************
  4722****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4723****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4724****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4725****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4726*****************************************************
  4727
  4728         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4729             20  CF-ADMINISTRATION-CONTROLS PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  87
* EL131.cbl
  4730             20  CF-APPLICATION-FORCE       PIC X.
  4731             20  CF-INDIVIDUAL-APP.
  4732                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4733                     28  CF-BROWSE-APP      PIC X.
  4734                     28  CF-UPDATE-APP      PIC X.
  4735
  4736         16  CF-CURRENT-TERM-ON             PIC X(4).
  4737         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4738             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4739             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4740             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4741             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4742             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4743             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4744             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4745         16  CF-PROCESSOR-CARRIER           PIC X.
  4746             88  NO-CARRIER-SECURITY            VALUE ' '.
  4747         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4748             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4749         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4750             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4751         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4752             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4753
  4754         16  CF-PROC-SYS-ACCESS-SW.
  4755             20  CF-PROC-CREDIT-CLAIMS-SW.
  4756                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4757                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4758                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4759                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4760             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4761                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4762                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4763             20  CF-PROC-LIFE-GNRLDGR-SW.
  4764                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4765                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4766                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4767                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4768             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4769                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4770                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4771         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4772             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4773             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4774         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4775
  4776         16  CF-APPROVAL-LEVEL                  PIC X.
  4777             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4778             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4779             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4780             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4781
  4782         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4783
  4784         16  CF-LANGUAGE-TYPE                   PIC X.
  4785             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4786             88  CF-LANG-IS-FR                      VALUE 'F'.
  4787
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  88
* EL131.cbl
  4788         16  CF-CSR-IND                         PIC X.
  4789         16  FILLER                             PIC X(239).
  4790
  4791****************************************************************
  4792*             PROCESSOR/REMINDERS RECORD                       *
  4793****************************************************************
  4794
  4795     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4796         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4797             20  CF-START-REMIND-DT         PIC XX.
  4798             20  CF-END-REMIND-DT           PIC XX.
  4799             20  CF-REMINDER-TEXT           PIC X(50).
  4800         16  FILLER                         PIC X(296).
  4801
  4802
  4803****************************************************************
  4804*             STATE MASTER RECORD                              *
  4805****************************************************************
  4806
  4807     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4808         16  CF-STATE-ABBREVIATION          PIC XX.
  4809         16  CF-STATE-NAME                  PIC X(25).
  4810         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4811         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4812             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4813             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4814             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4815             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4816                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4817                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4818             20  CF-ST-PREM-REJECT-SW       PIC X.
  4819                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4820                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4821             20  CF-ST-REF-REJECT-SW        PIC X.
  4822                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4823                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4824         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4825         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4826         16  CF-ST-REFUND-RULES.
  4827             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4828             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4829             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4830         16  CF-ST-FST-PMT-EXTENSION.
  4831             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4832             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4833                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4834                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4835                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4836                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4837         16  CF-ST-STATE-CALL.
  4838             20  CF-ST-CALL-UNEARNED        PIC X.
  4839             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4840             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4841         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4842             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4843             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4844         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4845         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  89
* EL131.cbl
  4846         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4847         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4848         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4849         16  FILLER                         PIC X.
  4850         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4851             20  CF-ST-BENEFIT-CD           PIC XX.
  4852             20  CF-ST-BENEFIT-KIND         PIC X.
  4853                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4854                 88  CF-ST-AH-KIND              VALUE 'A'.
  4855             20  CF-ST-REM-TERM-CALC        PIC X.
  4856                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4857                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4858                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4859                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4860                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4861                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4862                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4863                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4864
  4865             20  CF-ST-REFUND-CALC          PIC X.
  4866                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4867                 88  ST-REFD-BY-R78             VALUE '1'.
  4868                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4869                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4870                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4871                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4872                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4873                 88  ST-REFD-UTAH               VALUE '7'.
  4874                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4875                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4876                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4877
  4878             20  CF-ST-EARNING-CALC         PIC X.
  4879                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4880                 88  ST-EARN-BY-R78             VALUE '1'.
  4881                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4882                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4883                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4884                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4885                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4886                 88  ST-EARN-MEAN               VALUE '8'.
  4887                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4888
  4889             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4890                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4891                 88  ST-OVRD-BY-R78             VALUE '1'.
  4892                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4893                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4894                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4895                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4896                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4897                 88  ST-OVRD-MEAN               VALUE '8'.
  4898                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4899             20  FILLER                     PIC X.
  4900
  4901         16  CF-ST-COMMISSION-CAPS.
  4902             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4903             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  90
* EL131.cbl
  4904             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4905             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4906         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4907                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4908
  4909         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4910
  4911         16  CF-ST-STATUTORY-INTEREST.
  4912             20  CF-ST-STAT-DATE-FROM       PIC X.
  4913                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4914                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4915             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4916             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4917             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4918             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4919             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4920
  4921         16  CF-ST-OVER-SHORT.
  4922             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4923             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4924
  4925         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4926
  4927         16  CF-ST-RT-CALC                  PIC X.
  4928
  4929         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4930         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4931         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4932         16  CF-ST-RF-LR-CALC               PIC X.
  4933         16  CF-ST-RF-LL-CALC               PIC X.
  4934         16  CF-ST-RF-LN-CALC               PIC X.
  4935         16  CF-ST-RF-AH-CALC               PIC X.
  4936         16  CF-ST-RF-CP-CALC               PIC X.
  4937*        16  FILLER                         PIC X(206).
  4938*CIDMOD         16  FILLER                         PIC X(192).
  4939         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4940             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4941         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4942         16  CF-ST-VFY-2ND-BENE             PIC X.
  4943         16  CF-ST-CAUSAL-STATE             PIC X.
  4944         16  FILLER                         PIC X(185).
  4945
  4946****************************************************************
  4947*             BENEFIT MASTER RECORD                            *
  4948****************************************************************
  4949
  4950     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4951         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4952             20  CF-BENEFIT-CODE            PIC XX.
  4953             20  CF-BENEFIT-NUMERIC  REDEFINES
  4954                 CF-BENEFIT-CODE            PIC XX.
  4955             20  CF-BENEFIT-ALPHA           PIC XXX.
  4956             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4957             20  CF-BENEFIT-COMMENT         PIC X(10).
  4958
  4959             20  CF-LF-COVERAGE-TYPE        PIC X.
  4960                 88  CF-REDUCING                VALUE 'R'.
  4961                 88  CF-LEVEL                   VALUE 'L' 'P'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  91
* EL131.cbl
  4962
  4963             20  CF-SPECIAL-CALC-CD         PIC X.
  4964                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4965                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4966                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4967                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4968                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4969                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4970                 88  CF-FARM-PLAN               VALUE 'F'.
  4971                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4972                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4973                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4974                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4975                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4976                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4977                 88  CF-PRUDENTIAL              VALUE 'P'.
  4978                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4979                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4980                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4981                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4982                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4983                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4984
  4985             20  CF-JOINT-INDICATOR         PIC X.
  4986                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4987
  4988*            20  FILLER                     PIC X(12).
  4989             20  FILLER                     PIC X(11).
  4990             20  CF-BENEFIT-CATEGORY        PIC X.
  4991             20  CF-LOAN-TYPE               PIC X(8).
  4992
  4993             20  CF-CO-REM-TERM-CALC        PIC X.
  4994                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4995                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4996                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4997                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4998                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4999
  5000             20  CF-CO-EARNINGS-CALC        PIC X.
  5001                 88  CO-EARN-BY-R78             VALUE '1'.
  5002                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5003                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5004                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5005                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5006                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5007                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5008                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5009
  5010             20  CF-CO-REFUND-CALC          PIC X.
  5011                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5012                 88  CO-REFD-BY-R78             VALUE '1'.
  5013                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5014                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5015                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5016                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5017                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5018                 88  CO-REFD-MEAN               VALUE '8'.
  5019                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  92
* EL131.cbl
  5020                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5021                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5022
  5023             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5024                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5025                 88  CO-OVRD-BY-R78             VALUE '1'.
  5026                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5027                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5028                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5029                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5030                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5031                 88  CO-OVRD-MEAN               VALUE '8'.
  5032                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5033
  5034             20  CF-CO-BEN-I-G-CD           PIC X.
  5035                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5036                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5037                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5038
  5039         16  FILLER                         PIC X(304).
  5040
  5041
  5042****************************************************************
  5043*             CARRIER MASTER RECORD                            *
  5044****************************************************************
  5045
  5046     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5047         16  CF-ADDRESS-DATA.
  5048             20  CF-MAIL-TO-NAME            PIC X(30).
  5049             20  CF-IN-CARE-OF              PIC X(30).
  5050             20  CF-ADDRESS-LINE-1          PIC X(30).
  5051             20  CF-ADDRESS-LINE-2          PIC X(30).
  5052             20  CF-CITY-STATE              PIC X(30).
  5053             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5054             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5055
  5056         16  CF-CLAIM-NO-CONTROL.
  5057             20  CF-CLAIM-NO-METHOD         PIC X.
  5058                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5059                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5060                 88  CLAIM-NO-SEQ               VALUE '3'.
  5061                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5062             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5063                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5064                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5065                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5066
  5067         16  CF-CHECK-NO-CONTROL.
  5068             20  CF-CHECK-NO-METHOD         PIC X.
  5069                 88  CHECK-NO-MANUAL            VALUE '1'.
  5070                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5071                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5072                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5073             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5074                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5075
  5076         16  CF-DOMICILE-STATE              PIC XX.
  5077
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  93
* EL131.cbl
  5078         16  CF-EXPENSE-CONTROLS.
  5079             20  CF-EXPENSE-METHOD          PIC X.
  5080                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5081                 88  DOLLARS-PER-PMT            VALUE '2'.
  5082                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5083                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5084             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5085             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5086
  5087         16  CF-CORRESPONDENCE-CONTROL.
  5088             20  CF-LETTER-RESEND-OPT       PIC X.
  5089                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5090                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5091             20  FILLER                     PIC X(4).
  5092
  5093         16  CF-RESERVE-CONTROLS.
  5094             20  CF-MANUAL-SW               PIC X.
  5095                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5096             20  CF-FUTURE-SW               PIC X.
  5097                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5098             20  CF-PTC-SW                  PIC X.
  5099                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5100             20  CF-IBNR-SW                 PIC X.
  5101                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5102             20  CF-PTC-LF-SW               PIC X.
  5103                 88  CF-LF-PTC-USED             VALUE '1'.
  5104             20  CF-CDT-ACCESS-METHOD       PIC X.
  5105                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5106                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5107                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5108             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5109
  5110         16  CF-CLAIM-CALC-METHOD           PIC X.
  5111             88  360-PLUS-MONTHS                VALUE '1'.
  5112             88  365-PLUS-MONTHS                VALUE '2'.
  5113             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5114             88  360-DAILY                      VALUE '4'.
  5115             88  365-DAILY                      VALUE '5'.
  5116
  5117         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5118         16  FILLER                         PIC X(11).
  5119
  5120         16  CF-LIMIT-AMOUNTS.
  5121             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5122             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5123             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5124             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5125             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5126             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5127             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5128             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5129             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5130             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5131
  5132         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5133         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5134         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5135
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  94
* EL131.cbl
  5136         16  CF-ZIP-CODE.
  5137             20  CF-ZIP-PRIME.
  5138                 24  CF-ZIP-1ST             PIC X.
  5139                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5140                 24  FILLER                 PIC X(4).
  5141             20  CF-ZIP-PLUS4               PIC X(4).
  5142         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5143             20  CF-CAN-POSTAL-1            PIC XXX.
  5144             20  CF-CAN-POSTAL-2            PIC XXX.
  5145             20  FILLER                     PIC XXX.
  5146
  5147         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5148         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5149         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5150
  5151         16  CF-RATING-SWITCH               PIC X.
  5152             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5153             88  CF-NO-RATING                   VALUE 'N'.
  5154
  5155         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5156
  5157         16  CF-CARRIER-OVER-SHORT.
  5158             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5159             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5160
  5161         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5162         16  CF-SECPAY-SWITCH               PIC X.
  5163             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5164             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5165         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5166         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5167         16  FILLER                         PIC X(444).
  5168*        16  FILLER                         PIC X(452).
  5169
  5170
  5171****************************************************************
  5172*             MORTALITY MASTER RECORD                          *
  5173****************************************************************
  5174
  5175     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5176         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5177                                INDEXED BY CF-MORT-NDX.
  5178             20  CF-MORT-TABLE              PIC X(5).
  5179             20  CF-MORT-TABLE-TYPE         PIC X.
  5180                 88  CF-MORT-JOINT              VALUE 'J'.
  5181                 88  CF-MORT-SINGLE             VALUE 'S'.
  5182                 88  CF-MORT-COMBINED           VALUE 'C'.
  5183                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5184                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5185             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5186             20  CF-MORT-AGE-METHOD         PIC XX.
  5187                 88  CF-AGE-LAST                VALUE 'AL'.
  5188                 88  CF-AGE-NEAR                VALUE 'AN'.
  5189             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5190             20  CF-MORT-ADJUSTMENT-DIRECTION
  5191                                            PIC X.
  5192                 88  CF-MINUS                   VALUE '-'.
  5193                 88  CF-PLUS                    VALUE '+'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  95
* EL131.cbl
  5194             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5195             20  CF-MORT-JOINT-CODE         PIC X.
  5196                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5197             20  CF-MORT-PC-Q               PIC X.
  5198                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5199             20  CF-MORT-TABLE-CODE         PIC X(4).
  5200             20  CF-MORT-COMMENTS           PIC X(15).
  5201             20  FILLER                     PIC X(14).
  5202
  5203         16  FILLER                         PIC X(251).
  5204
  5205
  5206****************************************************************
  5207*             BUSSINESS TYPE MASTER RECORD                     *
  5208****************************************************************
  5209
  5210     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5211* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5212* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5213* AND RECORD 05 IS TYPES 81-99
  5214         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5215             20  CF-BUSINESS-TITLE          PIC  X(19).
  5216             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5217                                            PIC S9V9(4) COMP-3.
  5218             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5219             20  FILLER                     PIC  X.
  5220         16  FILLER                         PIC  X(248).
  5221
  5222
  5223****************************************************************
  5224*             TERMINAL MASTER RECORD                           *
  5225****************************************************************
  5226
  5227     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5228
  5229         16  CF-COMPANY-TERMINALS.
  5230             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5231                                  PIC X(4).
  5232         16  FILLER               PIC X(248).
  5233
  5234
  5235****************************************************************
  5236*             LIFE EDIT MASTER RECORD                          *
  5237****************************************************************
  5238
  5239     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5240         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5241             20  CF-LIFE-CODE-IN            PIC XX.
  5242             20  CF-LIFE-CODE-OUT           PIC XX.
  5243         16  FILLER                         PIC X(248).
  5244
  5245
  5246****************************************************************
  5247*             AH EDIT MASTER RECORD                            *
  5248****************************************************************
  5249
  5250     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5251         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  96
* EL131.cbl
  5252             20  CF-AH-CODE-IN              PIC XXX.
  5253             20  CF-AH-CODE-OUT             PIC XX.
  5254         16  FILLER                         PIC X(248).
  5255
  5256
  5257****************************************************************
  5258*             CREDIBILITY TABLES                               *
  5259****************************************************************
  5260
  5261     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5262         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5263                             INDEXED BY CF-CRDB-NDX.
  5264             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5265             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5266             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5267         16  FILLER                         PIC  X(332).
  5268
  5269
  5270****************************************************************
  5271*             REPORT CUSTOMIZATION RECORD                      *
  5272****************************************************************
  5273
  5274     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5275         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5276             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5277             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5278             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5279**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5280****       A T-TRANSFER.                                   ****
  5281             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5282
  5283         16  FILLER                         PIC XX.
  5284
  5285         16  CF-CARRIER-CNTL-OPT.
  5286             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5287                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5288                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5289             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5290                                            PIC X.
  5291         16  CF-GROUP-CNTL-OPT.
  5292             20  CF-GROUP-OPT-SEQ           PIC 9.
  5293                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5294                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5295             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5296                                            PIC X(6).
  5297         16  CF-STATE-CNTL-OPT.
  5298             20  CF-STATE-OPT-SEQ           PIC 9.
  5299                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5300                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5301             20  CF-STATE-SELECT OCCURS 3 TIMES
  5302                                            PIC XX.
  5303         16  CF-ACCOUNT-CNTL-OPT.
  5304             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5305                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5306                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5307             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5308                                            PIC X(10).
  5309         16  CF-BUS-TYP-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  97
* EL131.cbl
  5310             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5311                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5312                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5313             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5314                                            PIC XX.
  5315         16  CF-LF-TYP-CNTL-OPT.
  5316             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5317                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5318                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5319             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5320                                            PIC XX.
  5321         16  CF-AH-TYP-CNTL-OPT.
  5322             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5323                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5324                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5325             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5326                                            PIC XX.
  5327         16  CF-REPTCD1-CNTL-OPT.
  5328             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5329                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5330                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5331             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5332                                            PIC X(10).
  5333         16  CF-REPTCD2-CNTL-OPT.
  5334             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5335                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5336                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5337             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5338                                            PIC X(10).
  5339         16  CF-USER1-CNTL-OPT.
  5340             20  CF-USER1-OPT-SEQ           PIC 9.
  5341                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5342                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5343             20  CF-USER1-SELECT OCCURS 3 TIMES
  5344                                            PIC X(10).
  5345         16  CF-USER2-CNTL-OPT.
  5346             20  CF-USER2-OPT-SEQ           PIC 9.
  5347                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5348                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5349             20  CF-USER2-SELECT OCCURS 3 TIMES
  5350                                            PIC X(10).
  5351         16  CF-USER3-CNTL-OPT.
  5352             20  CF-USER3-OPT-SEQ           PIC 9.
  5353                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5354                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5355             20  CF-USER3-SELECT OCCURS 3 TIMES
  5356                                            PIC X(10).
  5357         16  CF-USER4-CNTL-OPT.
  5358             20  CF-USER4-OPT-SEQ           PIC 9.
  5359                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5360                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5361             20  CF-USER4-SELECT OCCURS 3 TIMES
  5362                                            PIC X(10).
  5363         16  CF-USER5-CNTL-OPT.
  5364             20  CF-USER5-OPT-SEQ           PIC 9.
  5365                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5366                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5367             20  CF-USER5-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  98
* EL131.cbl
  5368                                            PIC X(10).
  5369         16  CF-REINS-CNTL-OPT.
  5370             20  CF-REINS-OPT-SEQ           PIC 9.
  5371                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5372                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5373             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5374                 24  CF-REINS-PRIME         PIC XXX.
  5375                 24  CF-REINS-SUB           PIC XXX.
  5376
  5377         16  CF-AGENT-CNTL-OPT.
  5378             20  CF-AGENT-OPT-SEQ           PIC 9.
  5379                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5380                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5381             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5382                                            PIC X(10).
  5383
  5384         16  FILLER                         PIC X(43).
  5385
  5386         16  CF-LOSS-RATIO-SELECT.
  5387             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5388             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5389         16  CF-ENTRY-DATE-SELECT.
  5390             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5391             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5392         16  CF-EFFECTIVE-DATE-SELECT.
  5393             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5394             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5395
  5396         16  CF-EXCEPTION-LIST-IND          PIC X.
  5397             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5398
  5399         16  FILLER                         PIC X(318).
  5400
  5401****************************************************************
  5402*                  EXCEPTION REPORTING RECORD                  *
  5403****************************************************************
  5404
  5405     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5406         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5407             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5408
  5409         16  CF-COMBINED-LIFE-AH-OPT.
  5410             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5411             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5412             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5413             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5414
  5415         16  CF-LIFE-OPT.
  5416             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5417             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5418             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5419             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5420             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5421             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5422             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5423             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5424             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5425             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page  99
* EL131.cbl
  5426
  5427         16  CF-AH-OPT.
  5428             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5429             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5430             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5431             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5432             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5433             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5434             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5435             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5436             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5437             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5438
  5439         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5440             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5441             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5442             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5443
  5444         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5445
  5446         16  FILLER                         PIC X(673).
  5447
  5448
  5449****************************************************************
  5450*             MORTGAGE SYSTEM PLAN RECORD                      *
  5451****************************************************************
  5452
  5453     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5454         16  CF-PLAN-TYPE                   PIC X.
  5455             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5456             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5457             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5458         16  CF-PLAN-ABBREV                 PIC XXX.
  5459         16  CF-PLAN-DESCRIPT               PIC X(10).
  5460         16  CF-PLAN-NOTES                  PIC X(20).
  5461         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5462         16  CF-PLAN-UNDERWRITING.
  5463             20  CF-PLAN-TERM-DATA.
  5464                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5465                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5466             20  CF-PLAN-AGE-DATA.
  5467                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5468                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5469                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5470             20  CF-PLAN-BENEFIT-DATA.
  5471                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5472                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5473                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5474                                            PIC S9(7)V99  COMP-3.
  5475         16  CF-PLAN-POLICY-FORMS.
  5476             20  CF-POLICY-FORM             PIC X(12).
  5477             20  CF-MASTER-APPLICATION      PIC X(12).
  5478             20  CF-MASTER-POLICY           PIC X(12).
  5479         16  CF-PLAN-RATING.
  5480             20  CF-RATE-CODE               PIC X(5).
  5481             20  CF-SEX-RATING              PIC X.
  5482                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5483                 88  CF-PLAN-SEX-RATED         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 100
* EL131.cbl
  5484             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5485             20  CF-SUB-STD-TYPE            PIC X.
  5486                 88  CF-PCT-OF-PREM            VALUE '1'.
  5487                 88  CF-PCT-OF-BENE            VALUE '2'.
  5488         16  CF-PLAN-PREM-TOLERANCES.
  5489             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5490             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5491         16  CF-PLAN-PYMT-TOLERANCES.
  5492             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5493             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5494         16  CF-PLAN-MISC-DATA.
  5495             20  FILLER                     PIC X.
  5496             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5497             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5498         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5499         16  CF-PLAN-IND-GRP                PIC X.
  5500             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5501                                                     '1'.
  5502             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5503                                                     '2'.
  5504         16  CF-MIB-SEARCH-SW               PIC X.
  5505             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5506             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5507             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5508             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5509         16  CF-ALPHA-SEARCH-SW             PIC X.
  5510             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5511             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5512             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5513             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5514             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5515             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5516             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5517             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5518             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5519             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5520                                                     'A' 'B' 'C'
  5521                                                     'X' 'Y' 'Z'.
  5522         16  CF-EFF-DT-RULE-SW              PIC X.
  5523             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5524             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5525             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5526             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5527             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5528         16  FILLER                         PIC X(4).
  5529         16  CF-HEALTH-QUESTIONS            PIC X.
  5530             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5531         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5532         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5533         16  CF-PLAN-SNGL-JNT               PIC X.
  5534             88  CF-COMBINED-PLAN              VALUE 'C'.
  5535             88  CF-JNT-PLAN                   VALUE 'J'.
  5536             88  CF-SNGL-PLAN                  VALUE 'S'.
  5537         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5538         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5539         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5540         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5541         16  CF-RERATE-CNTL                 PIC  X.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 101
* EL131.cbl
  5542             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5543             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5544             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5545             88  CF-AUTO-RECALC                 VALUE '4'.
  5546         16  CF-BENEFIT-TYPE                PIC  X.
  5547             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5548             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5549         16  CF-POLICY-FEE                  PIC S999V99
  5550                                                    COMP-3.
  5551         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5552         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5553         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5554         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5555         16  FILLER                         PIC  X(32).
  5556         16  CF-TERMINATION-FORM            PIC  X(04).
  5557         16  FILLER                         PIC  X(08).
  5558         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5559                                                       COMP-3.
  5560         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5561         16  CF-ISSUE-LETTER                PIC  X(4).
  5562         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5563         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5564             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5565             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5566         16  CF-MP-REFUND-CALC              PIC X.
  5567             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5568             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5569             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5570             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5571             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5572             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5573             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5574             88  CF-MP-REFD-MEAN                VALUE '8'.
  5575         16  CF-ALT-RATE-CODE               PIC  X(5).
  5576
  5577
  5578         16  FILLER                         PIC X(498).
  5579****************************************************************
  5580*             MORTGAGE COMPANY MASTER RECORD                   *
  5581****************************************************************
  5582
  5583     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5584         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5585         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5586             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5587             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5588             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5589             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5590             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5591
  5592         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5593         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5594         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5595         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5596         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5597
  5598         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5599             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 102
* EL131.cbl
  5600         16  CF-MP-RECON-USE-IND            PIC X(1).
  5601             88  CF-MP-USE-RECON             VALUE 'Y'.
  5602         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5603             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5604         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5605             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5606             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5607         16  FILLER                         PIC X(1).
  5608         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5609             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5610         16  CF-MORTG-MIB-VERSION           PIC X.
  5611             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5612             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5613             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5614         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5615             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5616                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5617             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5618                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5619             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5620                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5621             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5622                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5623             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5624                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5625             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5626                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5627         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5628         16  FILLER                         PIC X(7).
  5629         16  CF-MORTG-DESTINATION-SYMBOL.
  5630             20  CF-MORTG-MIB-COMM          PIC X(5).
  5631             20  CF-MORTG-MIB-TERM          PIC X(5).
  5632         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5633             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5634         16  FILLER                         PIC X(03).
  5635         16  CF-MP-CHECK-NO-CONTROL.
  5636             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5637                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5638                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5639                                                ' ' LOW-VALUES.
  5640                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5641                                               VALUE '3'.
  5642         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5643         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5644         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5645             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5646                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5647             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5648                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5649             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5650                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5651             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5652                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5653             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5654                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5655             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5656                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5657         16  CF-MORTG-BILLING-AREA.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 103
* EL131.cbl
  5658             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5659                                            PIC X.
  5660         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5661         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5662         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5663         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5664             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5665             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5666         16  FILLER                         PIC X.
  5667         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5668             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5669             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5670         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5671         16  FILLER                         PIC X(8).
  5672         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5673         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5674         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5675         16  CF-ACH-COMPANY-ID.
  5676             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5677                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5678                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5679                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5680             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5681         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5682             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5683         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5684             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5685             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5686         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5687         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5688         16  FILLER                         PIC X(536).
  5689
  5690****************************************************************
  5691*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5692****************************************************************
  5693
  5694     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5695         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5696             20  CF-FEMALE-HEIGHT.
  5697                 24  CF-FEMALE-FT           PIC 99.
  5698                 24  CF-FEMALE-IN           PIC 99.
  5699             20  CF-FEMALE-MIN-WT           PIC 999.
  5700             20  CF-FEMALE-MAX-WT           PIC 999.
  5701         16  FILLER                         PIC X(428).
  5702
  5703     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5704         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5705             20  CF-MALE-HEIGHT.
  5706                 24  CF-MALE-FT             PIC 99.
  5707                 24  CF-MALE-IN             PIC 99.
  5708             20  CF-MALE-MIN-WT             PIC 999.
  5709             20  CF-MALE-MAX-WT             PIC 999.
  5710         16  FILLER                         PIC X(428).
  5711******************************************************************
  5712*             AUTOMATIC ACTIVITY RECORD                          *
  5713******************************************************************
  5714     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5715         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 104
* EL131.cbl
  5716             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5717             20  CF-SYS-LETTER-ID           PIC X(04).
  5718             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5719             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5720             20  CF-SYS-RESET-SW            PIC X(01).
  5721             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5722             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5723
  5724         16  FILLER                         PIC X(50).
  5725
  5726         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5727             20  CF-USER-ACTIVE-SW          PIC X(01).
  5728             20  CF-USER-LETTER-ID          PIC X(04).
  5729             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5730             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5731             20  CF-USER-RESET-SW           PIC X(01).
  5732             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5733             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5734             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5735
  5736         16  FILLER                         PIC X(246).
  5737
  5738*                                COPY ELCACTQ.
  5739******************************************************************
  5740*                                                                *
  5741*                            ELCACTQ.                            *
  5742*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  5743*                            VMOD=2.004                          *
  5744*                                                                *
  5745*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  5746*                                                                *
  5747*   FILE TYPE = VSAM,KSDS                                        *
  5748*   RECORD SIZE = 60     RECFORM = FIXED                         *
  5749*                                                                *
  5750*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  5751*       ALTERNATE INDEX = NONE                                   *
  5752*                                                                *
  5753*   LOG = YES                                                    *
  5754*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5755*                                                                *
  5756*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  5757******************************************************************
  5758
  5759 01  ACTIVITY-QUE.
  5760     12  AQ-RECORD-ID                PIC XX.
  5761         88  VALID-AQ-ID                VALUE 'AQ'.
  5762
  5763     12  AQ-CONTROL-PRIMARY.
  5764         16  AQ-COMPANY-CD           PIC X.
  5765         16  AQ-CARRIER              PIC X.
  5766         16  AQ-CLAIM-NO             PIC X(7).
  5767         16  AQ-CERT-NO.
  5768             20  AQ-CERT-PRIME       PIC X(10).
  5769             20  AQ-CERT-SFX         PIC X.
  5770
  5771     12  AQ-PENDING-ACTIVITY-FLAGS.
  5772         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  5773         16  AQ-PENDING-PAYMENT-FLAG PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 105
* EL131.cbl
  5774             88  PENDING-PAYMENTS       VALUE '1'.
  5775         16  AQ-PENDING-STATUS-FLAG  PIC X.
  5776             88  PENDING-FULL-PRINT     VALUE '1'.
  5777             88  PENDING-PART-PRINT     VALUE '2'.
  5778         16  AQ-PENDING-LETTER-FLAG  PIC X.
  5779             88  PENDING-LETTERS        VALUE '1'.
  5780         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  5781             88  PENDING-RESTORE        VALUE 'C'.
  5782             88  PENDING-RESTORE-LETTER VALUE 'L'.
  5783
  5784     12  FILLER                      PIC X(20).
  5785
  5786     12  AQ-RESEND-DATE              PIC XX.
  5787     12  AQ-FOLLOWUP-DATE            PIC XX.
  5788     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  5789     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  5790     12  AQ-AUTO-LETTER              PIC X(4).
  5791     12  FILLER                      PIC XX.
  5792     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  5793*****************************************************************
  5794
  5795*                                COPY ERCACCT.
  5796******************************************************************
  5797*                                                                *
  5798*                                                                *
  5799*                            ERCACCT                             *
  5800*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5801*                            VMOD=2.031                          *
  5802*                                                                *
  5803*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5804*                                                                *
  5805*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5806*   VSAM ACCOUNT MASTER FILES.                                   *
  5807*                                                                *
  5808*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5809*                                                                *
  5810*   FILE TYPE = VSAM,KSDS                                        *
  5811*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5812*                                                                *
  5813*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5814*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5815*                                                                *
  5816*   LOG = NO                                                     *
  5817*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5818*                                                                *
  5819*                                                                *
  5820******************************************************************
  5821*                   C H A N G E   L O G
  5822*
  5823* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5824*-----------------------------------------------------------------
  5825*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5826* EFFECTIVE    NUMBER
  5827*-----------------------------------------------------------------
  5828* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5829* 092705    2005050300006  PEMA  ADD SPP LEASES
  5830* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5831* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 106
* EL131.cbl
  5832* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5833* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5834* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5835******************************************************************
  5836
  5837 01  ACCOUNT-MASTER.
  5838     12  AM-RECORD-ID                      PIC XX.
  5839         88  VALID-AM-ID                      VALUE 'AM'.
  5840
  5841     12  AM-CONTROL-PRIMARY.
  5842         16  AM-COMPANY-CD                 PIC X.
  5843         16  AM-MSTR-CNTRL.
  5844             20  AM-CONTROL-A.
  5845                 24  AM-CARRIER            PIC X.
  5846                 24  AM-GROUPING.
  5847                     28 AM-GROUPING-PREFIX PIC XXX.
  5848                     28 AM-GROUPING-PRIME  PIC XXX.
  5849                 24  AM-STATE              PIC XX.
  5850                 24  AM-ACCOUNT.
  5851                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5852                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5853             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5854                                           PIC X(19).
  5855             20  AM-CNTRL-B.
  5856                 24  AM-EXPIRATION-DT      PIC XX.
  5857                 24  FILLER                PIC X(4).
  5858             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5859                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5860
  5861     12  AM-CONTROL-BY-VAR-GRP.
  5862         16  AM-COMPANY-CD-A1              PIC X.
  5863         16  AM-VG-CARRIER                 PIC X.
  5864         16  AM-VG-GROUPING                PIC X(6).
  5865         16  AM-VG-STATE                   PIC XX.
  5866         16  AM-VG-ACCOUNT                 PIC X(10).
  5867         16  AM-VG-DATE.
  5868             20  AM-VG-EXPIRATION-DT       PIC XX.
  5869             20  FILLER                    PIC X(4).
  5870         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5871                                           PIC 9(11)      COMP-3.
  5872     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5873         16  FILLER                        PIC X(10).
  5874         16  AM-VG-KEY3.
  5875             20  AM-VG3-ACCOUNT            PIC X(10).
  5876             20  AM-VG3-EXP-DT             PIC XX.
  5877         16  FILLER                        PIC X(4).
  5878     12  AM-MAINT-INFORMATION.
  5879         16  AM-LAST-MAINT-DT              PIC XX.
  5880         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5881         16  AM-LAST-MAINT-USER            PIC X(4).
  5882         16  FILLER                        PIC XX.
  5883
  5884     12  AM-EFFECTIVE-DT                   PIC XX.
  5885     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5886
  5887     12  AM-PREV-DATES  COMP-3.
  5888         16  AM-PREV-EXP-DT                PIC 9(11).
  5889         16  AM-PREV-EFF-DT                PIC 9(11).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 107
* EL131.cbl
  5890
  5891     12  AM-REPORT-CODE-1                  PIC X(10).
  5892     12  AM-REPORT-CODE-2                  PIC X(10).
  5893
  5894     12  AM-CITY-CODE                      PIC X(4).
  5895     12  AM-COUNTY-PARISH                  PIC X(6).
  5896
  5897     12  AM-NAME                           PIC X(30).
  5898     12  AM-PERSON                         PIC X(30).
  5899     12  AM-ADDRS                          PIC X(30).
  5900     12  AM-CITY.
  5901         16  AM-ADDR-CITY                  PIC X(28).
  5902         16  AM-ADDR-STATE                 PIC XX.
  5903     12  AM-ZIP.
  5904         16  AM-ZIP-PRIME.
  5905             20  AM-ZIP-PRI-1ST            PIC X.
  5906                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5907             20  FILLER                    PIC X(4).
  5908         16  AM-ZIP-PLUS4                  PIC X(4).
  5909     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5910         16  AM-CAN-POSTAL-1               PIC XXX.
  5911         16  AM-CAN-POSTAL-2               PIC XXX.
  5912         16  FILLER                        PIC XXX.
  5913     12  AM-TEL-NO.
  5914         16  AM-AREA-CODE                  PIC 999.
  5915         16  AM-TEL-PRE                    PIC 999.
  5916         16  AM-TEL-NBR                    PIC 9(4).
  5917     12  AM-TEL-LOC                        PIC X.
  5918         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5919         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5920
  5921     12  AM-COMM-STRUCTURE.
  5922         16  AM-DEFN-1.
  5923             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5924                 24  AM-AGT.
  5925                     28  AM-AGT-PREFIX     PIC X(4).
  5926                     28  AM-AGT-PRIME      PIC X(6).
  5927                 24  AM-COM-TYP            PIC X.
  5928                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5929                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5930                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5931                 24  AM-RECALC-LV-INDIC    PIC X.
  5932                 24  AM-RETRO-LV-INDIC     PIC X.
  5933                 24  AM-GL-CODES           PIC X.
  5934                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5935                 24  FILLER                PIC X(01).
  5936         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5937             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5938                 24  FILLER                PIC X(11).
  5939                 24  AM-L-COMA             PIC XXX.
  5940                 24  AM-J-COMA             PIC XXX.
  5941                 24  AM-A-COMA             PIC XXX.
  5942                 24  FILLER                PIC X(6).
  5943
  5944     12  AM-COMM-CHANGE-STATUS             PIC X.
  5945         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5946
  5947     12  AM-CSR-CODE                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 108
* EL131.cbl
  5948
  5949     12  AM-BILLING-STATUS                 PIC X.
  5950         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5951         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5952     12  AM-AUTO-REFUND-SW                 PIC X.
  5953         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5954         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5955     12  AM-GPCD                           PIC 99.
  5956     12  AM-IG                             PIC X.
  5957         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5958         88  AM-HAS-GROUP                     VALUE '2'.
  5959     12  AM-STATUS                         PIC X.
  5960         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5961         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5962         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5963         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5964         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5965         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5966     12  AM-REMIT-TO                       PIC 99.
  5967     12  AM-ID-NO                          PIC X(11).
  5968
  5969     12  AM-CAL-TABLE                      PIC XX.
  5970     12  AM-LF-DEVIATION                   PIC XXX.
  5971     12  AM-AH-DEVIATION                   PIC XXX.
  5972     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5973     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5974     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5975     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5976     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5977     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5978
  5979     12  AM-USER-FIELDS.
  5980         16  AM-FLD-1                      PIC XX.
  5981         16  AM-FLD-2                      PIC XX.
  5982         16  AM-FLD-3                      PIC XX.
  5983         16  AM-FLD-4                      PIC XX.
  5984         16  AM-FLD-5                      PIC XX.
  5985
  5986     12  AM-1ST-PROD-DATE.
  5987         16  AM-1ST-PROD-YR                PIC XX.
  5988         16  AM-1ST-PROD-MO                PIC XX.
  5989         16  AM-1ST-PROD-DA                PIC XX.
  5990     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5991     12  AM-CERTS-PURGED-DATE.
  5992         16  AM-PUR-YR                     PIC XX.
  5993         16  AM-PUR-MO                     PIC XX.
  5994         16  AM-PUR-DA                     PIC XX.
  5995     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5996     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5997     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5998     12  AM-INACTIVE-DATE.
  5999         16  AM-INA-MO                     PIC 99.
  6000         16  AM-INA-DA                     PIC 99.
  6001         16  AM-INA-YR                     PIC 99.
  6002     12  AM-AR-HI-CERT-DATE                PIC XX.
  6003
  6004     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6005     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 109
* EL131.cbl
  6006
  6007     12  AM-OB-PAYMENT-MODE                PIC X.
  6008         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6009         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6010         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6011         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6012
  6013     12  AM-AH-ONLY-INDICATOR              PIC X.
  6014         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6015         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6016
  6017     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6018
  6019     12  AM-OVER-SHORT.
  6020         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6021         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6022
  6023     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6024     12  AM-DCC-CLP-STATE                  PIC XX.
  6025
  6026     12  AM-RECALC-COMM                    PIC X.
  6027     12  AM-RECALC-REIN                    PIC X.
  6028
  6029     12  AM-REI-TABLE                      PIC XXX.
  6030     12  AM-REI-ET-LF                      PIC X.
  6031     12  AM-REI-ET-AH                      PIC X.
  6032     12  AM-REI-PE-LF                      PIC X.
  6033     12  AM-REI-PE-AH                      PIC X.
  6034     12  AM-REI-PRT-ST                     PIC X.
  6035     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6036     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6037     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6038     12  AM-REI-GROUP-A                    PIC X(6).
  6039     12  AM-REI-MORT                       PIC X(4).
  6040     12  AM-REI-PRT-OW                     PIC X.
  6041     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6042     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6043     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6044     12  AM-REI-GROUP-B                    PIC X(6).
  6045
  6046     12  AM-TRUST-TYPE                     PIC X(2).
  6047
  6048     12  AM-EMPLOYER-STMT-USED             PIC X.
  6049     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6050
  6051     12  AM-STD-AH-TYPE                    PIC XX.
  6052     12  AM-EARN-METHODS.
  6053         16  AM-EARN-METHOD-R              PIC X.
  6054             88 AM-REF-RL-R78                 VALUE 'R'.
  6055             88 AM-REF-RL-PR                  VALUE 'P'.
  6056             88 AM-REF-RL-MEAN                VALUE 'M'.
  6057             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6058         16  AM-EARN-METHOD-L              PIC X.
  6059             88 AM-REF-LL-R78                 VALUE 'R'.
  6060             88 AM-REF-LL-PR                  VALUE 'P'.
  6061             88 AM-REF-LL-MEAN                VALUE 'M'.
  6062             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6063         16  AM-EARN-METHOD-A              PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 110
* EL131.cbl
  6064             88 AM-REF-AH-R78                 VALUE 'R'.
  6065             88 AM-REF-AH-PR                  VALUE 'P'.
  6066             88 AM-REF-AH-MEAN                VALUE 'M'.
  6067             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6068             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6069             88 AM-REF-AH-NET                 VALUE 'N'.
  6070
  6071     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6072     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6073     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6074
  6075     12  AM-RET-Y-N                        PIC X.
  6076     12  AM-RET-P-E                        PIC X.
  6077     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6078     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6079     12  AM-RET-GRP                        PIC X(6).
  6080     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6081         16  AM-POOL-PRIME                 PIC XXX.
  6082         16  AM-POOL-SUB                   PIC XXX.
  6083     12  AM-RETRO-EARNINGS.
  6084         16  AM-RET-EARN-R                 PIC X.
  6085         16  AM-RET-EARN-L                 PIC X.
  6086         16  AM-RET-EARN-A                 PIC X.
  6087     12  AM-RET-ST-TAX-USE                 PIC X.
  6088         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6089         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6090     12  AM-RETRO-BEG-EARNINGS.
  6091         16  AM-RET-BEG-EARN-R             PIC X.
  6092         16  AM-RET-BEG-EARN-L             PIC X.
  6093         16  AM-RET-BEG-EARN-A             PIC X.
  6094     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6095     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6096
  6097     12  AM-USER-SELECT-OPTIONS.
  6098         16  AM-USER-SELECT-1              PIC X(10).
  6099         16  AM-USER-SELECT-2              PIC X(10).
  6100         16  AM-USER-SELECT-3              PIC X(10).
  6101         16  AM-USER-SELECT-4              PIC X(10).
  6102         16  AM-USER-SELECT-5              PIC X(10).
  6103
  6104     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6105
  6106     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6107
  6108     12  AM-RPT045A-SWITCH                 PIC X.
  6109         88  RPT045A-OFF                   VALUE 'N'.
  6110
  6111     12  AM-INSURANCE-LIMITS.
  6112         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6113         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6114
  6115     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6116         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6117
  6118     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6119         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6120         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6121
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 111
* EL131.cbl
  6122     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6123
  6124     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6125     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6126     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6127     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6128     12  AM-DCC-UEF-STATE                  PIC XX.
  6129     12  FILLER                            PIC XXX.
  6130     12  AM-REPORT-CODE-3                  PIC X(10).
  6131*    12  FILLER                            PIC X(22).
  6132
  6133     12  AM-RESERVE-DATE.
  6134         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6135         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6136         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6137
  6138     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6139     12  AM-NOTIFICATION-TYPES.
  6140         16  AM-NOTIF-OF-LETTERS           PIC X.
  6141         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6142         16  AM-NOTIF-OF-REPORTS           PIC X.
  6143         16  AM-NOTIF-OF-STATUS            PIC X.
  6144
  6145     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6146         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6147         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6148         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6149         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6150
  6151     12  AM-BENEFIT-CONTROLS.
  6152         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6153             20  AM-BENEFIT-CODE           PIC XX.
  6154             20  AM-BENEFIT-TYPE           PIC X.
  6155             20  AM-BENEFIT-REVISION       PIC XXX.
  6156             20  AM-BENEFIT-REM-TERM       PIC X.
  6157             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6158             20  FILLER                    PIC XX.
  6159         16  FILLER                        PIC X(80).
  6160
  6161     12  AM-TRANSFER-DATA.
  6162         16  AM-TRANSFERRED-FROM.
  6163             20  AM-TRNFROM-CARRIER        PIC X.
  6164             20  AM-TRNFROM-GROUPING.
  6165                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6166                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6167             20  AM-TRNFROM-STATE          PIC XX.
  6168             20  AM-TRNFROM-ACCOUNT.
  6169                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6170                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6171             20  AM-TRNFROM-DTE            PIC XX.
  6172         16  AM-TRANSFERRED-TO.
  6173             20  AM-TRNTO-CARRIER          PIC X.
  6174             20  AM-TRNTO-GROUPING.
  6175                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6176                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6177             20  AM-TRNTO-STATE            PIC XX.
  6178             20  AM-TRNTO-ACCOUNT.
  6179                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 112
* EL131.cbl
  6180                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6181             20  AM-TRNTO-DTE              PIC XX.
  6182         16  FILLER                        PIC X(10).
  6183
  6184     12  AM-SAVED-REMIT-TO                 PIC 99.
  6185
  6186     12  AM-COMM-STRUCTURE-SAVED.
  6187         16  AM-DEFN-1-SAVED.
  6188             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6189                 24  AM-AGT-SV             PIC X(10).
  6190                 24  AM-COM-TYP-SV         PIC X.
  6191                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6192                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6193                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6194                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6195                 24  FILLER                PIC X.
  6196                 24  AM-GL-CODES-SV        PIC X.
  6197                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6198                 24  FILLER                PIC X.
  6199         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6200             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6201                 24  FILLER                PIC X(11).
  6202                 24  AM-L-COMA-SV          PIC XXX.
  6203                 24  AM-J-COMA-SV          PIC XXX.
  6204                 24  AM-A-COMA-SV          PIC XXX.
  6205                 24  FILLER                PIC X(6).
  6206
  6207     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6208         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6209            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6210            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6211            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6212
  6213     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6214     12  FILLER                            PIC X(120).
  6215
  6216     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6217         16  AM-CONTROL-NAME               PIC X(30).
  6218         16  AM-EXECUTIVE-ONE.
  6219             20  AM-EXEC1-NAME             PIC X(15).
  6220             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6221                                                          COMP-3.
  6222             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6223                                                          COMP-3.
  6224         16  AM-EXECUTIVE-TWO.
  6225             20  AM-EXEC2-NAME             PIC X(15).
  6226             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6227                                                          COMP-3.
  6228             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6229                                                          COMP-3.
  6230
  6231     12  AM-RETRO-ADDITIONAL-DATA.
  6232         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6233         16  AM-RETRO-PREM-P-E             PIC X.
  6234         16  AM-RETRO-CLMS-P-I             PIC X.
  6235         16  AM-RETRO-RET-BRACKET-LF.
  6236             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6237                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 113
* EL131.cbl
  6238                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6239             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6240                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6241                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6242             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6243                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6244                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6245         16  AM-RETRO-RET-BRACKET-AH.
  6246             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6247                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6248                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6249                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6250             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6251                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6252                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6253             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6254                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6255                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6256
  6257     12  AM-COMMENTS.
  6258         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6259
  6260     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6261         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6262         16  AM-FLI-BILLING-CODE           PIC X.
  6263         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6264         16  AM-FLI-UNITED-IDENT           PIC X.
  6265         16  AM-FLI-INTEREST-LOST-DATA.
  6266             20  AM-FLI-BANK-NO            PIC X(5).
  6267             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6268             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6269             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6270         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6271             20  AM-FLI-AGT                PIC X(9).
  6272             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6273             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6274         16  FILLER                        PIC X(102).
  6275
  6276     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6277         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6278             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6279             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6280             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6281             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6282             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6283         16  FILLER                          PIC X(10).
  6284******************************************************************
  6285
  6286*                                COPY ELCCHKQ.
  6287******************************************************************
  6288*                                                                *
  6289*                                                                *
  6290*                            ELCCHKQ.                            *
  6291*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6292*                            VMOD=2.007                          *
  6293*                                                                *
  6294*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6295*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 114
* EL131.cbl
  6296*   FILE TYPE = VSAM,KSDS                                        *
  6297*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6298*                                                                *
  6299*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6300*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6301*                                                                *
  6302*   LOG = YES                                                    *
  6303*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6304******************************************************************
  6305 01  CHECK-QUE.
  6306     12  CQ-RECORD-ID                PIC XX.
  6307         88  VALID-CQ-ID         VALUE 'CQ'.
  6308
  6309     12  CQ-CONTROL-PRIMARY.
  6310         16  CQ-COMPANY-CD           PIC X.
  6311         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6312         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6313
  6314     12  CQ-CONTROL-BY-PAYEE.
  6315         16  CQ-CONTROL-BY-NUMBER.
  6316             20  CQ-COMPANY-CD-A1     PIC X.
  6317             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6318         16  CQ-PAYEE-CARRIER        PIC X.
  6319         16  CQ-PAYEE-GROUPING       PIC X(6).
  6320         16  CQ-PAYEE-STATE          PIC XX.
  6321         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6322         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6323
  6324     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6325         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6326         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6327         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6328         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6329         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6330         16  FILLER                  PIC X(3).
  6331
  6332     12  CQ-ENTRY-TYPE               PIC X.
  6333             88  CHECK-ON-QUE           VALUE 'Q'.
  6334             88  ALIGNMENT-CHECK        VALUE 'A'.
  6335             88  SPOILED-CHECK          VALUE 'S'.
  6336             88  PAYMENT-ABORTED        VALUE 'X'.
  6337
  6338     12  CQ-CLAIM-MAST-CNTL.
  6339         16  CQ-CARRIER              PIC X.
  6340         16  CQ-CLAIM-NO             PIC X(7).
  6341         16  CQ-CERT-NO.
  6342             20  CQ-CERT-PRIME       PIC X(10).
  6343             20  CQ-CERT-SFX         PIC X.
  6344         16  CQ-CLAIM-TYPE           PIC X.
  6345             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6346             88  CQ-AH-CLAIM            VALUE 'A'.
  6347         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6348             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6349             88  CQ-O-B-COVERAGE        VALUE '2'.
  6350             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6351
  6352     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6353     12  CQ-CHECK-NUMBER             PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 115
* EL131.cbl
  6354     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6355     12  CQ-PAYMENT-TYPE             PIC X.
  6356             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6357             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6358             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6359             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6360             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6361             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6362             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6363             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6364     12  CQ-VOID-INDICATOR           PIC X.
  6365             88  CHECK-IS-STOPPED          VALUE 'S'.
  6366             88  CHECK-IS-VOID             VALUE 'V'.
  6367     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6368     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6369     12  CQ-CHECK-BY-USER            PIC X(4).
  6370     12  CQ-PRE-NUMBERING-SW         PIC X.
  6371       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6372       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6373
  6374     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6375     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6376     12  CQ-LEDGER-FLAG              PIC X(01).
  6377     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6378     12  CQ-LAST-UPDATED-DT          PIC XX.
  6379     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6380     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6381
  6382     12  FILLER                      PIC X(04).
  6383
  6384******************************************************************
  6385
  6386*                                COPY ELCARCH.
  6387******************************************************************
  6388*                                                                *
  6389*                            ELCARCH.                            *
  6390*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6391*                            VMOD=2.007                          *
  6392*                                                                *
  6393*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6394*                                                                *
  6395*   FILE TYPE = VSAM,KSDS                                        *
  6396*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6397*                                                                *
  6398*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6399*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6400*                                                                *
  6401*   LOG = NO                                                     *
  6402*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6403*                                                                *
  6404*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6405******************************************************************
  6406 01  LETTER-ARCHIVE.
  6407     12  LA-RECORD-ID                PIC XX.
  6408         88  VALID-LA-ID                VALUE 'LA'.
  6409
  6410     12  LA-CONTROL-PRIMARY.
  6411         16  LA-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 116
* EL131.cbl
  6412         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6413         16  LA-RECORD-TYPE          PIC X.
  6414             88  LA-HEADER-DATA         VALUE '1'.
  6415             88  LA-ADDRESS-DATA        VALUE '2'.
  6416             88  LA-TEXT-DATA           VALUE '3'.
  6417             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6418         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6419
  6420     12  LA-CONTROL-BY-TYPE.
  6421         16  LA-COMPANY-CD-A1        PIC X.
  6422         16  LA-RECORD-TYPE-A1       PIC X.
  6423         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6424         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6425
  6426     12  LA-TEXT-RECORD.
  6427         16  LA-SKIP-CONTROL         PIC XX.
  6428             88  NO-LINES-SKIPPED       VALUE SPACES.
  6429             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6430         16  LA-TEXT-LINE            PIC X(70).
  6431
  6432     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6433         16  FILLER                  PIC XX.
  6434         16  LA-ADDRESS-LINE         PIC X(30).
  6435         16  FILLER                  PIC X(40).
  6436
  6437     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6438         16  FILLER                  PIC XX.
  6439         16  LA-CARRIER              PIC X.
  6440         16  LA-CLAIM-NO             PIC X(7).
  6441         16  LA-CERT-NO.
  6442             20  LA-CERT-PRIME       PIC X(10).
  6443             20  LA-CERT-SFX         PIC X.
  6444         16  LA-NO-OF-COPIES         PIC S9.
  6445         16  LA-RESEND-DATE          PIC XX.
  6446         16  LA-PROCESSOR-CD         PIC X(4).
  6447         16  LA-CREATION-DT          PIC XX.
  6448         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6449         16  LA-RESEND-PRINT-DATE    PIC XX.
  6450         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6451         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6452*
  6453* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6454*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6455*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6456*   I        20  LA-DMD-RES-ST           PIC XX.
  6457*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6458*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6459*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6460*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6461*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6462*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6463*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6464*   I        20  LA-DMD-UND-CODE         PIC XX.
  6465*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6466*   V    16  FILLER                  PIC X(15).
  6467* -----
  6468*
  6469* REINSERTED  CSO  MODS
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 117
* EL131.cbl
  6470*
  6471         16  FILLER.
  6472             20  FILLER                  PIC X(29).
  6473             20  LA-CSO-LETTER-STATUS    PIC X.
  6474                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6475                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6476                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6477             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6478             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6479*
  6480
  6481     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6482         16  FILLER                  PIC XX.
  6483         16  LA4-CARRIER             PIC X.
  6484         16  LA4-CLAIM-NO            PIC X(7).
  6485         16  LA4-CERT-NO.
  6486             20  LA4-CERT-PRIME      PIC X(10).
  6487             20  LA4-CERT-SFX        PIC X.
  6488         16  LA4-NO-OF-COPIES        PIC S9.
  6489         16  LA4-RESEND-DATE         PIC XX.
  6490         16  LA4-PROCESSOR-CD        PIC X(4).
  6491         16  LA4-CREATION-DT         PIC XX.
  6492         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6493         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6494         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6495         16  LA4-FORM-TYPE           PIC X.
  6496             88  LA4-INITIAL-FORM    VALUE '1'.
  6497             88  LA4-PROGRESS-FORM   VALUE '2'.
  6498         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6499         16  LA4-STATE               PIC X(02).
  6500         16  FILLER                  PIC X(31).
  6501******************************************************************
  6502
  6503*                                COPY ELCBENE.
  6504******************************************************************
  6505*                                                                *
  6506*                            ELCBENE.                            *
  6507*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6508*                            VMOD=2.006                          *
  6509*                                                                *
  6510*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6511*                                                                *
  6512*   FILE TYPE = VSAM,KSDS                                        *
  6513*   RECORD SIZE = 500   RECFORM = FIX                            *
  6514*                                                                *
  6515*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6516*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6517*                                                                *
  6518*   LOG = YES                                                    *
  6519*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6520*                                                                *
  6521*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6522******************************************************************
  6523
  6524 01  BENEFICIARY-MASTER.
  6525     12  BE-RECORD-ID                PIC XX.
  6526         88  VALID-BE-ID                VALUE 'BE'.
  6527
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 118
* EL131.cbl
  6528     12  BE-CONTROL-PRIMARY.
  6529         16  BE-COMPANY-CD           PIC X.
  6530         16  BE-RECORD-TYPE          PIC X.
  6531             88  BENEFICIARY-RECORD  VALUE 'B'.
  6532             88  ADJUSTOR-RECORD     VALUE 'A'.
  6533         16  BE-BENEFICIARY          PIC X(10).
  6534     12  BE-CONTROL-BY-NAME.
  6535         16  BE-COMPANY-CD-A1        PIC X.
  6536         16  BE-RECORD-TYPE-A1       PIC X.
  6537         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6538         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6539
  6540     12  BE-LAST-MAINT-DT            PIC XX.
  6541     12  BE-LAST-MAINT-BY            PIC X(4).
  6542     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6543
  6544     12  BE-ADDRESS-DATA.
  6545         16  BE-MAIL-TO-NAME         PIC X(30).
  6546         16  BE-ADDRESS-LINE-1       PIC X(30).
  6547         16  BE-ADDRESS-LINE-2       PIC X(30).
  6548         16  BE-ADDRESS-LINE-3       PIC X(30).
  6549         16  BE-CITY-STATE.
  6550             20  BE-CITY             PIC X(28).
  6551             20  BE-STATE            PIC XX.
  6552         16  BE-ZIP-CODE.
  6553             20  BE-ZIP-PRIME.
  6554                 24  BE-ZIP-1ST      PIC X.
  6555                     88  BE-CANADIAN-POST-CODE
  6556                                         VALUE 'A' THRU 'Z'.
  6557                 24  FILLER          PIC X(4).
  6558             20  BE-ZIP-PLUS4        PIC X(4).
  6559         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6560             20  BE-CAN-POSTAL-1     PIC XXX.
  6561             20  BE-CAN-POSTAL-2     PIC XXX.
  6562             20  FILLER              PIC XXX.
  6563         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6564         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6565
  6566******************************************************************
  6567*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6568*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6569******************************************************************
  6570     12  BE-CARRIER                  PIC X.
  6571
  6572     12  BE-ADDRESS-DATA2.
  6573         16  BE-MAIL-TO-NAME2        PIC X(30).
  6574         16  BE-ADDRESS-LINE-12      PIC X(30).
  6575         16  BE-ADDRESS-LINE-22      PIC X(30).
  6576         16  BE-ADDRESS-LINE-32      PIC X(30).
  6577         16  BE-CITY-STATE2.
  6578             20  BE-CITY2            PIC X(28).
  6579             20  BE-STATE2           PIC XX.
  6580         16  BE-ZIP-CODE2.
  6581             20  BE-ZIP-PRIME2.
  6582                 24  BE-ZIP-1ST2     PIC X.
  6583                     88  BE-CANADIAN-POST-CODE2
  6584                                         VALUE 'A' THRU 'Z'.
  6585                 24  FILLER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 119
* EL131.cbl
  6586             20  BE-ZIP-PLUS42       PIC X(4).
  6587         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6588             20  BE-CAN-POSTAL-12    PIC XXX.
  6589             20  BE-CAN-POSTAL-22    PIC XXX.
  6590             20  FILLER              PIC XXX.
  6591         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6592         16  BE-BILLING-STMT-DATA.
  6593             20  BE-BSR              PIC X.
  6594                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6595                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6596             20  BE-BSR-FROM         PIC X(30).
  6597             20  BE-BSR-DEPT         PIC X(30).
  6598             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6599             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6600             20  BE-OUTPUT-TYPE      PIC X.
  6601                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6602                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6603
  6604     12  FILLER                      PIC X(28).
  6605******************************************************************
  6606
  6607*                                COPY ELCDAR.
  6608******************************************************************
  6609*                                                                *
  6610*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6611*   FILE TYPE = VSAM,KSDS                                        *
  6612*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6613*   BASE CLUSTER = DLYACTV                                       *
  6614*   LOG = YES                                                    *
  6615*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6616*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6617*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6618*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6619*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6620*               BY PROGRAM "LGINFCE".                            *
  6621*                                                                *
  6622******************************************************************
  6623 01  DAILY-ACTIVITY-RECORD.
  6624     05  DA-KEY.
  6625         10  DA-COMP-CD          PIC X.
  6626         10  DA-CARRIER          PIC X.
  6627         10  DA-CLAIM-NO         PIC X(7).
  6628         10  DA-CERT-NO.
  6629             15  DA-CERT-PRIME   PIC X(10).
  6630             15  DA-CERT-SFX     PIC X.
  6631     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6632     05  DA-RECORD-TYPE          PIC X.
  6633     05  FILLER                  PIC X(2).
  6634******************************************************************
  6635
  6636*                                COPY ELCALPH.
  6637******************************************************************
  6638*                                                                *
  6639*                            ELCALPH.                            *
  6640*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6641*                            VMOD=2.003                          *
  6642*                                                                *
  6643*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 120
* EL131.cbl
  6644*                                                                *
  6645*   FILE TYPE = VSAM,KSDS                                        *
  6646*   RECORD SIZE = 128  RECFORM = FIXED                           *
  6647*                                                                *
  6648*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  6649*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  6650*                                                                *
  6651*   LOG = YES                                                    *
  6652*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6653*                                                                *
  6654*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  6655******************************************************************
  6656
  6657 01  ALPHA-INDEX.
  6658     12  AI-RECORD-ID                         PIC XX.
  6659         88  VALID-AI-ID                  VALUE 'AI'.
  6660     12  AI-CONTROL-PRIMARY.
  6661         16  AI-COMPANY-CD                     PIC X.
  6662         16  AI-SOURCE                         PIC X.
  6663             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  6664             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  6665         16  AI-NAME.
  6666             20  AI-LAST-NAME                  PIC X(15).
  6667             20  AI-FIRST-NAME.
  6668                 24  AI-FIRST-INITIAL          PIC X.
  6669                 24  FILLER                    PIC X(11).
  6670             20  AI-MIDDLE-INIT                PIC X.
  6671         16  AI-DATE                           PIC X(8).
  6672         16  AI-TIME                           PIC S9(07) COMP-3.
  6673
  6674     12  AI-CONTROL-BY-ADMIN-KEY.
  6675         16  AI-CM-COMPANY-CD                  PIC X.
  6676         16  AI-CM-SOURCE                      PIC X.
  6677         16  AI-CM-CARRIER                     PIC X.
  6678         16  AI-CM-GROUPING.
  6679             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  6680             20  AI-CM-GROUPING-PRIME          PIC X(3).
  6681         16  AI-CM-STATE                       PIC XX.
  6682         16  AI-CM-PRODUCER.
  6683             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  6684             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  6685         16  AI-CM-CERT-EFF-DT                 PIC XX.
  6686         16  AI-CM-CERTIFICATE-NUMBER.
  6687             20  AI-CM-CERT-PRIME              PIC X(10).
  6688             20  AI-CM-CERT-SFX                PIC X.
  6689         16  AI-CM-DATE                        PIC X(8).
  6690         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  6691         16  FILLER                            PIC X(11).
  6692
  6693     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  6694         AI-CONTROL-BY-ADMIN-KEY.
  6695         16  AI-CL-COMPANY-CD                  PIC X.
  6696         16  AI-CL-SOURCE                      PIC X.
  6697         16  AI-CL-CARRIER                     PIC X.
  6698         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  6699         16  AI-CL-CERTIFICATE-NUMBER.
  6700             20  AI-CL-CERT-PRIME              PIC X(10).
  6701             20  AI-CL-CERT-SFX                PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 121
* EL131.cbl
  6702         16  AI-CL-DATE                        PIC X(8).
  6703         16  AI-CL-INCURRED-DATE               PIC XX.
  6704         16  AI-CL-CLOSE-DATE                  PIC XX.
  6705         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  6706         16  AI-CREDIT-CARD-NUMBER.
  6707             20  AI-CCN.
  6708                 24  AI-CCN-PREFIX             PIC X(4).
  6709                 24  AI-CCN-PRIME              PIC X(12).
  6710             20  AI-CCN-FILLER                 PIC X(4).
  6711
  6712     12  AI-MAINT-INFO.
  6713         16  AI-LAST-MAINT-BY                  PIC X(4).
  6714         16  AI-LAST-MAINT-DT                  PIC XX.
  6715         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6716
  6717     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  6718
  6719     12  FILLER                                PIC X(15).
  6720
  6721
  6722*                                COPY ERCDMDNT.
  6723******************************************************************
  6724*                                                                *
  6725*                            ERCDMDNT                            *
  6726*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6727*                            VMOD=2.005                          *
  6728*                                                                *
  6729*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  6730*                                                                *
  6731*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  6732*                                                                *
  6733*        FILE TYPE= VSAM,KSDS                                    *
  6734*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6735*                                                                *
  6736*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6737*                                                                *
  6738*        LOG = YES                                               *
  6739*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6740*                                                                *
  6741******************************************************************
  6742
  6743 01  CERTIFICATE-NOTE.
  6744     12  CN-RECORD-ID                     PIC  XX.
  6745         88  VALID-CN-ID                      VALUE 'CN'.
  6746
  6747     12  CN-CONTROL-PRIMARY.
  6748         16  CN-COMPANY-CD                PIC X.
  6749         16  CN-CERT-KEY.
  6750             20  CN-CARRIER               PIC X.
  6751             20  CN-GROUPING.
  6752                 24  CN-GROUPING-PREFIX   PIC XXX.
  6753                 24  CN-GROUPING-PRIME    PIC XXX.
  6754             20  CN-STATE                 PIC XX.
  6755             20  CN-ACCOUNT.
  6756                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  6757                 24  CN-ACCOUNT-PRIME     PIC X(6).
  6758             20  CN-CERT-EFF-DT           PIC XX.
  6759             20  CN-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 122
* EL131.cbl
  6760                 24  CN-CERT-PRIME        PIC X(10).
  6761                 24  CN-CERT-SFX          PIC X.
  6762
  6763     12  CN-BILLING-START-LINE-NO         PIC 99.
  6764     12  CN-BILLING-END-LINE-NO           PIC 99.
  6765
  6766     12  CN-LINES.
  6767         16  CN-LINE                      PIC X(77)  OCCURS 10.
  6768
  6769     12  CN-CSI-NOTES REDEFINES CN-LINES.
  6770         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  6771         16  CN-CSI-GENERAL-DATA-AREA.
  6772             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  6773
  6774         16  CN-CSI-GENERAL-DATA-R REDEFINES
  6775             CN-CSI-GENERAL-DATA-AREA.
  6776             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  6777             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  6778             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  6779             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  6780             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  6781             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  6782             20  CN-CSI-GEN-INFRM-MI          PIC X.
  6783             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  6784             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  6785             20  FILLER                       PIC XX.
  6786             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  6787             20  FILLER                       PIC X(38).
  6788
  6789         16  CN-CSI-PRODUCT-DATA-AREA.
  6790             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  6791
  6792         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  6793             CN-CSI-PRODUCT-DATA-AREA.
  6794             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  6795             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  6796             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  6797             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  6798             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  6799             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  6800             20  FILLER                   PIC XX.
  6801             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  6802             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  6803             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  6804             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  6805             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  6806             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  6807             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  6808             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  6809             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  6810             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  6811             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  6812             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  6813             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  6814             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  6815             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  6816             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  6817             20  CN-CSI-CC-TERM-AGE       PIC 999.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 123
* EL131.cbl
  6818             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  6819             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  6820             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  6821             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  6822             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  6823             20  FILLER                   PIC X(25).
  6824
  6825         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  6826             CN-CSI-CREDIT-CARD-DATA.
  6827             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  6828             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  6829             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  6830             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  6831             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  6832             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  6833             20  FILLER                   PIC XX.
  6834             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  6835             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  6836             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  6837             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  6838             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  6839             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  6840             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  6841             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  6842             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  6843             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  6844             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  6845             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  6846             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  6847             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  6848             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  6849             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  6850             20  CN-CSI-FL-TERM-AGE       PIC 999.
  6851             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  6852             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  6853             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  6854             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  6855             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  6856             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  6857             20  FILLER                   PIC X(17).
  6858
  6859         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  6860             CN-CSI-FAMILY-LEAVE-DATA.
  6861             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  6862             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  6863             20  CN-CSI-SL-BENE-REL       PIC X(8).
  6864             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  6865             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  6866             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  6867             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  6868             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  6869             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  6870             20  CN-CSI-SL-INT-ON-PROCEEDS
  6871                                          PIC S9(5)V99  COMP-3.
  6872             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  6873             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  6874             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  6875             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 124
* EL131.cbl
  6876             20  CN-CSI-SL-POLICY-BENEFITS
  6877                                          PIC S9(5)V99  COMP-3.
  6878             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  6879             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  6880             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  6881             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  6882             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  6883             20  CN-CSI-SL-PREM-MODE      PIC 99.
  6884             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  6885             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  6886             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  6887             20  CN-CSI-SL-STATE-NOT      PIC X.
  6888             20  FILLER                   PIC XX.
  6889
  6890         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  6891             CN-CSI-SENIOR-LIFE-DATA.
  6892             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  6893             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  6894             20  CN-CSI-PP-BEN-PAID-TO-DATE
  6895                                          PIC S9(5)V99  COMP-3.
  6896             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  6897             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  6898             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  6899             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  6900             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  6901             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  6902             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  6903             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  6904             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  6905             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  6906             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  6907             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  6908             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  6909             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  6910             20  CN-CSI-PP-REPAIR         PIC X.
  6911             20  CN-CSI-PP-REPLACE        PIC X.
  6912             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  6913             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  6914             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  6915             20  CN-CSI-PP-TERM-AGE       PIC 999.
  6916             20  FILLER                   PIC X(5).
  6917
  6918         16  CN-CSI-EXT-WARR-DATA REDEFINES
  6919             CN-CSI-PURCH-PROP-DATA.
  6920             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  6921             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  6922             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  6923             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  6924             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  6925             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  6926             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  6927             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  6928             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  6929             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  6930             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  6931             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  6932             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  6933             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 125
* EL131.cbl
  6934             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  6935             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  6936             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  6937             20  CN-CSI-EW-REPLACE        PIC X.
  6938             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  6939             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  6940             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  6941             20  CN-CSI-EW-TERM-AGE       PIC 999.
  6942             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  6943             20  FILLER                   PIC X(4).
  6944
  6945     12  CN-LAST-MAINT-DT                 PIC XX.
  6946     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  6947     12  CN-LAST-MAINT-USER               PIC X(4).
  6948     12  FILLER                           PIC X(6).
  6949
  6950******************************************************************
  6951
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 126
* EL131.cbl
  6953 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  6954                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  6955                          CONTROL-FILE ACTIVITY-QUE
  6956                          ACCOUNT-MASTER CHECK-QUE
  6957                          LETTER-ARCHIVE BENEFICIARY-MASTER
  6958                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  6959                          CERTIFICATE-NOTE.
  6960 0000-DFHEXIT SECTION.
  6961     MOVE '9#                    $   ' TO DFHEIV0.
  6962     MOVE 'EL131' TO DFHEIV1.
  6963     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6964
  6965     IF EIBCALEN = ZERO
  6966         GO TO 8800-UNAUTHORIZED-ACCESS.
  6967
  6968     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6969     MOVE '5'                    TO DC-OPTION-CODE.
  6970     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  6971     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  6972     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  6973     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  6974
  6975     IF SAVE-DATE-YY GREATER 70
  6976         MOVE 19                 TO SAVE-DATE-CC
  6977      ELSE
  6978         MOVE 20                 TO SAVE-DATE-CC.
  6979
  6980
  6981* EXEC CICS HANDLE CONDITION
  6982*        PGMIDERR (8820-XCTL-ERROR)
  6983*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  6984*        ERROR    (9990-ABEND)
  6985*    END-EXEC.
  6986*    MOVE '"$LI.                 ! " #00006976' TO DFHEIV0
  6987     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  6988     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6989     MOVE X'2220233030303036393736' TO DFHEIV0(25:11)
  6990     CALL 'kxdfhei1' USING DFHEIV0
  6991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6992
  6993
  6994     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  6995     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  6996     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  6997
  6998     INITIALIZE    EDIT-WORK-AREA.
  6999     MOVE '/'                    TO WORK-SLASH.
  7000     MOVE SPACES                 TO ERROR-SWITCHES.
  7001
  7002     MOVE TRAN-ID                TO TRANS-ID.
  7003     MOVE EIBTRMID               TO PI-TERM.
  7004     MOVE MAP-ID                 TO PI-QUAL.
  7005
  7006     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7007
  7008     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7009         MOVE LOW-VALUES         TO EL131AO
  7010         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 127
* EL131.cbl
  7011         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7012         MOVE -1                 TO MAINTL
  7013         GO TO 8110-SEND-DATA.
  7014
  7015     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7016         MOVE LOW-VALUES         TO EL131AO
  7017         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7018         MOVE 'X'                TO PI-RETURN-CD-1
  7019         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7020         MOVE -1                 TO MAINTL
  7021         GO TO 8100-SEND-MAP.
  7022
  7023     IF EIBAID = DFHCLEAR
  7024         GO TO 8200-RETURN-PRIOR.
  7025
  7026     IF PI-PROCESSOR-ID = 'LGXX'
  7027         NEXT SENTENCE
  7028     ELSE
  7029
  7030* EXEC CICS READQ TS
  7031*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7032*            INTO    (SECURITY-CONTROL)
  7033*            LENGTH  (SC-COMM-LENGTH)
  7034*            ITEM    (SC-ITEM)
  7035*        END-EXEC
  7036*    MOVE '*$II   L              ''   #00007017' TO DFHEIV0
  7037     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7038     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7039     MOVE X'2020233030303037303137' TO DFHEIV0(25:11)
  7040     CALL 'kxdfhei1' USING DFHEIV0,
  7041           PI-SECURITY-TEMP-STORE-ID,
  7042           SECURITY-CONTROL,
  7043           SC-COMM-LENGTH,
  7044           SC-ITEM,
  7045           DFHEIV99,
  7046           DFHEIV99
  7047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7048         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7049         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7050         IF NOT DISPLAY-CAP
  7051             MOVE 'READ'               TO  SM-READ
  7052             PERFORM 9995-SECURITY-VIOLATION
  7053             MOVE ER-0070              TO  EMI-ERROR
  7054             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7055             GO TO 8100-SEND-MAP.
  7056
  7057
  7058* EXEC CICS RECEIVE
  7059*        MAP    ('EL131A')
  7060*        MAPSET ('EL131S')
  7061*    END-EXEC.
  7062     MOVE 'EL131A' TO DFHEIV1
  7063     MOVE 'EL131S' TO DFHEIV2
  7064*    MOVE '8"T                   ''   #00007032' TO DFHEIV0
  7065     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7066     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7067     MOVE X'2020233030303037303332' TO DFHEIV0(25:11)
  7068     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 128
* EL131.cbl
  7069           DFHEIV1,
  7070           EL131AI,
  7071           DFHEIV99,
  7072           DFHEIV2,
  7073           DFHEIV99,
  7074           DFHEIV99
  7075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7076
  7077
  7078     IF PFKEYL GREATER THAN ZERO
  7079         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7080
  7081     IF SCREEN-ERROR
  7082         MOVE ER-0004 TO EMI-ERROR
  7083         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7084         MOVE -1 TO MAINTL
  7085         GO TO 8110-SEND-DATA.
  7086
  7087     IF EIBAID = DFHPF3
  7088         GO TO 8500-TRLR-MNT.
  7089
  7090     IF EIBAID = DFHPF4
  7091         GO TO 8600-ADDR-MNT.
  7092
  7093     IF EIBAID = DFHPF5
  7094         GO TO 8700-CERT-MNT.
  7095
  7096     IF PI-COMPANY-ID = 'DMD'
  7097       IF EIBAID = DFHPF6
  7098         GO TO 8750-DMD-CLM-FIX.
  7099
  7100     IF EIBAID = DFHPF7
  7101         GO TO 4000-FORCE-ERRORS.
  7102
  7103     IF EIBAID = DFHPF12
  7104         GO TO 8300-GET-HELP.
  7105
  7106     IF EIBAID = DFHPF23
  7107         GO TO 8810-PF23-ENTERED.
  7108
  7109     IF EIBAID = DFHPF24
  7110         GO TO 8400-RETURN-MASTER.
  7111
  7112     IF EIBAID NOT = DFHENTER
  7113         MOVE ER-0029            TO EMI-ERROR
  7114         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7115         MOVE -1                 TO MAINTL
  7116         GO TO 8110-SEND-DATA.
  7117
  7118     IF PI-RETURN-CD-1 =  'X'
  7119         MOVE ER-0311            TO EMI-ERROR
  7120         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7121         MOVE -1                 TO MAINTL
  7122         GO TO 8110-SEND-DATA.
  7123
  7124     IF MAINTI = 'A'
  7125         GO TO 0500-ADD-ALPHA-ONLY.
  7126
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 129
* EL131.cbl
  7127     IF MAINTI = 'N'
  7128         GO TO 0600-CHANGE-NAME.
  7129
  7130     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7131
  7132     IF SCREEN-ERROR
  7133         GO TO 8110-SEND-DATA.
  7134
  7135     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7136         MOVE ER-0276            TO EMI-ERROR
  7137         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7138         MOVE -1                 TO MAINTL
  7139         GO TO 8110-SEND-DATA.
  7140
  7141     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7142
  7143     IF SCREEN-ERROR
  7144         GO TO 8110-SEND-DATA.
  7145
  7146     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7147
  7148     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7149
  7150     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7151         GO TO 8110-SEND-DATA.
  7152
  7153     IF EMI-FATAL-CTR GREATER THAN ZERO
  7154         GO TO 8110-SEND-DATA.
  7155
  7156     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7157
  7158     IF WS-OPEN-CLOSE-SW = 'Y'
  7159         IF PI-LETTER-SW = 'Y'
  7160             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7161             MOVE 'T'            TO  CNTL-REC-TYPE
  7162             MOVE SPACES         TO  CNTL-PROC-ID
  7163             MOVE +0             TO  CNTL-SEQ-NO
  7164
  7165* EXEC CICS READ
  7166*                DATASET   (CNTL-FILE-ID)
  7167*                RIDFLD    (CNTL-KEY)
  7168*                SET       (ADDRESS OF CONTROL-FILE)
  7169*            END-EXEC
  7170*    MOVE '&"S        E          (   #00007123' TO DFHEIV0
  7171     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7172     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7173     MOVE X'2020233030303037313233' TO DFHEIV0(25:11)
  7174     CALL 'kxdfhei1' USING DFHEIV0,
  7175           CNTL-FILE-ID,
  7176           DFHEIV20,
  7177           DFHEIV99,
  7178           CNTL-KEY,
  7179           DFHEIV99,
  7180           DFHEIV99,
  7181           DFHEIV99
  7182     SET ADDRESS OF CONTROL-FILE TO
  7183         DFHEIV20
  7184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 130
* EL131.cbl
  7185             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7186
  7187     MOVE ER-0000                TO EMI-ERROR.
  7188     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7189
  7190     MOVE SPACE                  TO MAINTO.
  7191     MOVE -1                     TO MAINTL.
  7192     GO TO 8100-SEND-MAP.
  7193
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 131
* EL131.cbl
  7195 0100-UPDATE-PI.
  7196     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7197         GO TO 0110-UPDATE-UP.
  7198
  7199     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7200     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7201     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7202     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7203     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7204     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7205     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7206     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7207     GO TO 0120-UPDATE-PI-EXIT.
  7208
  7209 0110-UPDATE-UP.
  7210     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7211     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7212     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7213     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7214     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7215     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7216     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7217     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7218
  7219
  7220* EXEC CICS HANDLE CONDITION
  7221*         QIDERR    (0130-TS-ERROR)
  7222*         ITEMERR   (0130-TS-ERROR)
  7223*    END-EXEC.
  7224*    MOVE '"$N<                  ! # #00007162' TO DFHEIV0
  7225     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7227     MOVE X'2320233030303037313632' TO DFHEIV0(25:11)
  7228     CALL 'kxdfhei1' USING DFHEIV0
  7229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7230
  7231
  7232
  7233* EXEC CICS READQ TS
  7234*         QUEUE    (PI-KEY)
  7235*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7236*         LENGTH   (PI-COMM-LENGTH)
  7237*    END-EXEC.
  7238*    MOVE '*$I    L              ''   #00007167' TO DFHEIV0
  7239     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7240     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7241     MOVE X'2020233030303037313637' TO DFHEIV0(25:11)
  7242     CALL 'kxdfhei1' USING DFHEIV0,
  7243           PI-KEY,
  7244           PROGRAM-INTERFACE-BLOCK,
  7245           PI-COMM-LENGTH,
  7246           DFHEIV99,
  7247           DFHEIV99,
  7248           DFHEIV99
  7249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7250
  7251
  7252
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 132
* EL131.cbl
  7253* EXEC CICS DELETEQ TS
  7254*         QUEUE    (PI-KEY)
  7255*    END-EXEC.
  7256*    MOVE '*&                    #   #00007173' TO DFHEIV0
  7257     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7258     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7259     MOVE X'2020233030303037313733' TO DFHEIV0(25:11)
  7260     CALL 'kxdfhei1' USING DFHEIV0,
  7261           PI-KEY,
  7262           DFHEIV99
  7263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7264
  7265
  7266 0120-UPDATE-PI-EXIT.
  7267     EXIT.
  7268
  7269 0130-TS-ERROR.
  7270     MOVE LOW-VALUES             TO EL131AO.
  7271     MOVE ER-0192                TO EMI-ERROR.
  7272
  7273     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7274
  7275     GO TO 8100-SEND-MAP.
  7276
  7277 0200-TRANS-PF.
  7278     IF EIBAID NOT = DFHENTER
  7279         MOVE 'X'                TO ERROR-SWITCH
  7280         GO TO 0210-EXIT.
  7281
  7282     IF PFKEYI NOT NUMERIC
  7283         MOVE 'X'                TO ERROR-SWITCH
  7284         GO TO 0210-EXIT.
  7285
  7286     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7287
  7288     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7289         MOVE 'X' TO ERROR-SWITCH
  7290         GO TO 0210-EXIT.
  7291
  7292     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7293
  7294 0210-EXIT.
  7295     EXIT.
  7296
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 133
* EL131.cbl
  7298 0500-ADD-ALPHA-ONLY.
  7299******************************************************************
  7300*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7301*    RECORD.                                                     *
  7302******************************************************************
  7303
  7304     IF MLNAMEL = +0 AND
  7305        MFNAMEL = +0 AND
  7306        MMINITL = +0
  7307         MOVE ER-0797                TO  EMI-ERROR
  7308         MOVE -1                     TO  MAINTL
  7309         MOVE AL-UABON               TO  MAINTA
  7310         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7311         GO TO 8110-SEND-DATA.
  7312
  7313     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7314     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7315     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7316     MOVE PI-CERT-NO                 TO  CERT-NO.
  7317
  7318
  7319* EXEC CICS READ
  7320*        DATASET   (CLMS-FILE-ID)
  7321*        RIDFLD    (MSTR-KEY)
  7322*        SET       (ADDRESS OF CLAIM-MASTER)
  7323*    END-EXEC.
  7324*    MOVE '&"S        E          (   #00007229' TO DFHEIV0
  7325     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7326     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7327     MOVE X'2020233030303037323239' TO DFHEIV0(25:11)
  7328     CALL 'kxdfhei1' USING DFHEIV0,
  7329           CLMS-FILE-ID,
  7330           DFHEIV20,
  7331           DFHEIV99,
  7332           MSTR-KEY,
  7333           DFHEIV99,
  7334           DFHEIV99,
  7335           DFHEIV99
  7336     SET ADDRESS OF CLAIM-MASTER TO
  7337         DFHEIV20
  7338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7339
  7340
  7341
  7342* EXEC CICS GETMAIN
  7343*        SET       (ADDRESS OF ALPHA-INDEX)
  7344*        LENGTH    (ALPH-LENGTH)
  7345*        INITIMG   (GETMAIN-SPACE)
  7346*    END-EXEC.
  7347*    MOVE ',"IL                  $   #00007235' TO DFHEIV0
  7348     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7349     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7350     MOVE X'2020233030303037323335' TO DFHEIV0(25:11)
  7351     CALL 'kxdfhei1' USING DFHEIV0,
  7352           DFHEIV20,
  7353           ALPH-LENGTH,
  7354           GETMAIN-SPACE
  7355     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 134
* EL131.cbl
  7356         DFHEIV20
  7357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7358
  7359
  7360     MOVE 'AI'                       TO  AI-RECORD-ID.
  7361     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7362                                         AI-CL-COMPANY-CD.
  7363     MOVE 'C'                        TO  AI-SOURCE
  7364                                         AI-CL-SOURCE.
  7365
  7366     IF MLNAMEL IS GREATER THAN +0
  7367         MOVE MLNAMEI                TO  AI-LAST-NAME
  7368     ELSE
  7369         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7370
  7371     IF MFNAMEL IS GREATER THAN +0
  7372         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7373     ELSE
  7374         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7375
  7376     IF MMINITL IS GREATER THAN +0
  7377         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7378     ELSE
  7379         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7380
  7381     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7382     MOVE '5'                        TO  DC-OPTION-CODE.
  7383     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7384     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7385     IF BUILD-YEAR IS GREATER THAN 50
  7386         MOVE '19'                   TO  WS-ALPHA-YY-1
  7387         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7388         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7389         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7390     ELSE
  7391         MOVE '20'                   TO  WS-ALPHA-YY-1
  7392         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7393         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7394         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7395
  7396     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7397                                         AI-CL-DATE.
  7398
  7399     MOVE EIBTIME                    TO  AI-TIME
  7400                                         AI-CL-TIME.
  7401
  7402     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7403     MOVE 'C'                        TO  AI-CL-SOURCE.
  7404     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7405     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7406     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7407     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7408     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7409
  7410     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7411     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7412     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7413
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 135
* EL131.cbl
  7414
  7415* EXEC CICS WRITE
  7416*        DATASET   (ALPH-FILE-ID)
  7417*        RIDFLD    (AI-CONTROL-PRIMARY)
  7418*        FROM      (ALPHA-INDEX)
  7419*    END-EXEC.
  7420     MOVE LENGTH OF
  7421      ALPHA-INDEX
  7422       TO DFHEIV11
  7423*    MOVE '&$ L                  ''   #00007295' TO DFHEIV0
  7424     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7425     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7426     MOVE X'2020233030303037323935' TO DFHEIV0(25:11)
  7427     CALL 'kxdfhei1' USING DFHEIV0,
  7428           ALPH-FILE-ID,
  7429           ALPHA-INDEX,
  7430           DFHEIV11,
  7431           AI-CONTROL-PRIMARY,
  7432           DFHEIV99,
  7433           DFHEIV99
  7434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7435
  7436
  7437     MOVE LOW-VALUES                 TO  EL131AO.
  7438     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7439     MOVE ER-0000                    TO  EMI-ERROR.
  7440     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7441     MOVE -1                         TO  MAINTL.
  7442     GO TO 8100-SEND-MAP.
  7443
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 136
* EL131.cbl
  7445 0600-CHANGE-NAME.
  7446******************************************************************
  7447*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7448*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7449******************************************************************
  7450
  7451     IF MLNAMEL = +0 AND
  7452        MFNAMEL = +0 AND
  7453        MMINITL = +0
  7454         MOVE ER-0276                TO  EMI-ERROR
  7455         MOVE -1                     TO  MAINTL
  7456         MOVE AL-UABON               TO  MAINTA
  7457         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7458         GO TO 8110-SEND-DATA.
  7459
  7460     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7461     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7462     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7463     MOVE PI-CERT-NO                 TO  CERT-NO.
  7464
  7465
  7466* EXEC CICS READ
  7467*        DATASET   (CLMS-FILE-ID)
  7468*        RIDFLD    (MSTR-KEY)
  7469*        SET       (ADDRESS OF CLAIM-MASTER)
  7470*    END-EXEC.
  7471*    MOVE '&"S        E          (   #00007329' TO DFHEIV0
  7472     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7473     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7474     MOVE X'2020233030303037333239' TO DFHEIV0(25:11)
  7475     CALL 'kxdfhei1' USING DFHEIV0,
  7476           CLMS-FILE-ID,
  7477           DFHEIV20,
  7478           DFHEIV99,
  7479           MSTR-KEY,
  7480           DFHEIV99,
  7481           DFHEIV99,
  7482           DFHEIV99
  7483     SET ADDRESS OF CLAIM-MASTER TO
  7484         DFHEIV20
  7485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7486
  7487
  7488
  7489* EXEC CICS GETMAIN
  7490*        SET       (ADDRESS OF ALPHA-INDEX)
  7491*        LENGTH    (ALPH-LENGTH)
  7492*        INITIMG   (GETMAIN-SPACE)
  7493*    END-EXEC.
  7494*    MOVE ',"IL                  $   #00007335' TO DFHEIV0
  7495     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7496     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7497     MOVE X'2020233030303037333335' TO DFHEIV0(25:11)
  7498     CALL 'kxdfhei1' USING DFHEIV0,
  7499           DFHEIV20,
  7500           ALPH-LENGTH,
  7501           GETMAIN-SPACE
  7502     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 137
* EL131.cbl
  7503         DFHEIV20
  7504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7505
  7506
  7507     MOVE 'AI'                       TO  AI-RECORD-ID.
  7508     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7509                                         AI-CL-COMPANY-CD.
  7510     MOVE 'C'                        TO  AI-SOURCE
  7511                                         AI-CL-SOURCE.
  7512
  7513     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7514     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7515     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7516
  7517     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7518     MOVE '5'                        TO  DC-OPTION-CODE.
  7519     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7520     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7521     IF BUILD-YEAR IS GREATER THAN 50
  7522         MOVE '19'                   TO  WS-ALPHA-YY-1
  7523         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7524         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7525         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7526     ELSE
  7527         MOVE '20'                   TO  WS-ALPHA-YY-1
  7528         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7529         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7530         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7531
  7532     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7533                                         AI-CL-DATE.
  7534
  7535     MOVE EIBTIME                    TO  AI-TIME
  7536                                         AI-CL-TIME.
  7537
  7538     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7539     MOVE 'C'                        TO  AI-CL-SOURCE.
  7540     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7541     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7542     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7543     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7544     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7545
  7546     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7547     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7548     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7549
  7550     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7551         MOVE 'Y'                TO CL-YESNOSW
  7552     END-IF.
  7553
  7554
  7555* EXEC CICS WRITE
  7556*        DATASET   (ALPH-FILE-ID)
  7557*        RIDFLD    (AI-CONTROL-PRIMARY)
  7558*        FROM      (ALPHA-INDEX)
  7559*    END-EXEC.
  7560     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 138
* EL131.cbl
  7561      ALPHA-INDEX
  7562       TO DFHEIV11
  7563*    MOVE '&$ L                  ''   #00007388' TO DFHEIV0
  7564     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7565     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7566     MOVE X'2020233030303037333838' TO DFHEIV0(25:11)
  7567     CALL 'kxdfhei1' USING DFHEIV0,
  7568           ALPH-FILE-ID,
  7569           ALPHA-INDEX,
  7570           DFHEIV11,
  7571           AI-CONTROL-PRIMARY,
  7572           DFHEIV99,
  7573           DFHEIV99
  7574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7575
  7576
  7577
  7578* EXEC CICS READ
  7579*        DATASET   (CLMS-FILE-ID)
  7580*        RIDFLD    (MSTR-KEY)
  7581*        SET       (ADDRESS OF CLAIM-MASTER)
  7582*        UPDATE
  7583*    END-EXEC.
  7584*    MOVE '&"S        EU         (   #00007394' TO DFHEIV0
  7585     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7586     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7587     MOVE X'2020233030303037333934' TO DFHEIV0(25:11)
  7588     CALL 'kxdfhei1' USING DFHEIV0,
  7589           CLMS-FILE-ID,
  7590           DFHEIV20,
  7591           DFHEIV99,
  7592           MSTR-KEY,
  7593           DFHEIV99,
  7594           DFHEIV99,
  7595           DFHEIV99
  7596     SET ADDRESS OF CLAIM-MASTER TO
  7597         DFHEIV20
  7598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7599
  7600
  7601     if (cl-priority-cd = '8')
  7602        and (pi-processor-id not = 'PEMA'and 'JMS '
  7603             AND 'AMWA')
  7604        MOVE ER-8003             TO EMI-ERROR
  7605        PERFORM 9900-ERROR-FORMAT
  7606                                 THRU 9900-EXIT
  7607        MOVE -1                  TO MAINTL
  7608        GO TO 8110-SEND-DATA
  7609     end-if
  7610
  7611     IF MLNAMEL IS GREATER THAN +0
  7612         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  7613
  7614     IF MFNAMEL IS GREATER THAN +0
  7615         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  7616
  7617     IF MMINITL IS GREATER THAN +0
  7618         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 139
* EL131.cbl
  7619
  7620     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  7621     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  7622     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  7623     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  7624
  7625     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7626         MOVE 'Y'                TO CL-YESNOSW
  7627     END-IF.
  7628
  7629
  7630* EXEC CICS HANDLE CONDITION
  7631*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  7632*    END-EXEC.
  7633*    MOVE '"$$                   ! $ #00007429' TO DFHEIV0
  7634     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  7635     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7636     MOVE X'2420233030303037343239' TO DFHEIV0(25:11)
  7637     CALL 'kxdfhei1' USING DFHEIV0
  7638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7639
  7640
  7641
  7642* EXEC CICS REWRITE
  7643*        DATASET   (CLMS-FILE-ID)
  7644*        FROM      (CLAIM-MASTER)
  7645*    END-EXEC.
  7646     MOVE LENGTH OF
  7647      CLAIM-MASTER
  7648       TO DFHEIV11
  7649*    MOVE '&& L                  %   #00007433' TO DFHEIV0
  7650     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7651     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7652     MOVE X'2020233030303037343333' TO DFHEIV0(25:11)
  7653     CALL 'kxdfhei1' USING DFHEIV0,
  7654           CLMS-FILE-ID,
  7655           CLAIM-MASTER,
  7656           DFHEIV11,
  7657           DFHEIV99
  7658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7659
  7660
  7661 0600-CONTINUE-NAME-UPDATE.
  7662
  7663     MOVE LOW-VALUES                 TO  EL131AO.
  7664     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7665     MOVE ER-0000                    TO  EMI-ERROR.
  7666     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7667     MOVE -1                         TO  MAINTL.
  7668     GO TO 8100-SEND-MAP.
  7669
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 140
* EL131.cbl
  7671 1000-EDIT-SCREEN.
  7672
  7673     MOVE MAINTI                 TO CHECK-MAINT.
  7674
  7675     IF NOT VALID-OPTIONS
  7676         MOVE 'X'                TO ERROR-SWITCH
  7677         MOVE -1                 TO MAINTL
  7678         MOVE AL-UABON           TO MAINTA
  7679         MOVE ER-0023            TO EMI-ERROR
  7680         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7681         GO TO 1010-EXIT.
  7682
  7683     IF NOT MODIFY-CAP
  7684         MOVE 'UPDATE'           TO  SM-READ
  7685         PERFORM 9995-SECURITY-VIOLATION
  7686         MOVE ER-0070               TO  EMI-ERROR
  7687         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7688         GO TO 8100-SEND-MAP.
  7689
  7690     IF DELETE-CLAIM
  7691         MOVE AL-UANON TO MAINTA
  7692         GO TO 1010-EXIT.
  7693
  7694     MOVE AL-UANON               TO MAINTA.
  7695
  7696     IF CCNOI GREATER THAN LOW-VALUES
  7697         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  7698
  7699     IF PI-COMPANY-ID = 'CSL'
  7700        CONTINUE
  7701     ELSE
  7702        IF TYPEL > ZERO
  7703           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  7704              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7705                    PI-LIFE-OVERRIDE-L1))
  7706                       OR
  7707              ((PI-COMPANY-ID = 'DCC')
  7708              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7709                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G'))
  7710              MOVE AL-UANON      TO TYPEA
  7711              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  7712           ELSE
  7713              MOVE ER-0199       TO EMI-ERROR
  7714              PERFORM 9900-ERROR-FORMAT
  7715                                 THRU 9900-EXIT
  7716              MOVE AL-UABON      TO TYPEA
  7717              MOVE -1            TO TYPEL
  7718              MOVE 'X'           TO ERROR-SWITCH
  7719           END-IF
  7720        ELSE
  7721           MOVE AL-UANOF         TO TYPEA
  7722        END-IF
  7723     END-IF
  7724     IF STATUSI GREATER THAN LOW-VALUES
  7725         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  7726             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  7727             MOVE AL-UANON       TO STATUSA
  7728             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 141
* EL131.cbl
  7729             MOVE 'Y'            TO DLYACTV-SW
  7730         ELSE
  7731             MOVE ER-0333        TO EMI-ERROR
  7732             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7733             MOVE AL-UABON       TO STATUSA
  7734             MOVE -1             TO STATUSL
  7735             MOVE 'X'            TO ERROR-SWITCH
  7736         END-IF
  7737     ELSE
  7738         MOVE SPACE              TO TRLR-SWITCH
  7739         MOVE 'N'                TO DLYACTV-SW
  7740         MOVE AL-UANOF           TO STATUSA.
  7741
  7742     IF PROCI GREATER THAN LOW-VALUES
  7743         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  7744     ELSE
  7745         MOVE AL-UANOF TO PROCA.
  7746
  7747     IF SEXI GREATER THAN LOW-VALUES
  7748         IF SEXI = 'F' OR 'M'
  7749             MOVE AL-UANON       TO SEXA
  7750             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7751           ELSE
  7752             MOVE ER-0219        TO EMI-ERROR
  7753             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7754             MOVE AL-UABON       TO SEXA
  7755             MOVE -1             TO SEXL
  7756             MOVE 'X'            TO ERROR-SWITCH
  7757       ELSE
  7758         MOVE AL-UANOF           TO SEXA.
  7759
  7760     IF BIRTHL = +0
  7761         MOVE LOW-VALUES         TO  HOLD-BIRTH
  7762         MOVE AL-UANOF           TO  BIRTHA
  7763         GO TO 1000-CONTINUE-EDITS.
  7764
  7765     IF BIRTHI = SPACES
  7766         MOVE LOW-VALUES         TO  HOLD-BIRTH
  7767         MOVE 'X'                TO  UPDATE-SWITCH
  7768                                     MSTR-SWITCH
  7769         GO TO 1000-CONTINUE-EDITS.
  7770
  7771     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  7772     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  7773     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  7774     MOVE '4'                    TO  DC-OPTION-CODE.
  7775     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7776     IF DATE-CONVERSION-ERROR
  7777         MOVE ER-0220            TO  EMI-ERROR
  7778         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7779         MOVE AL-UABON           TO  BIRTHA
  7780         MOVE -1                 TO  BIRTHL
  7781         MOVE 'X'                TO  ERROR-SWITCH
  7782         GO TO 1000-CONTINUE-EDITS.
  7783
  7784******************************************************************
  7785**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  7786**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 142
* EL131.cbl
  7787**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  7788******************************************************************
  7789     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  7790         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  7791         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  7792         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  7793         MOVE '4'                TO  DC-OPTION-CODE
  7794         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  7795         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7796                                     DC-ELAPSED-DAYS
  7797         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7798         IF DATE-CONVERSION-ERROR
  7799             MOVE ER-0220        TO  EMI-ERROR
  7800             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7801             MOVE AL-UABON       TO  BIRTHA
  7802             MOVE -1             TO  BIRTHL
  7803             MOVE 'X'            TO  ERROR-SWITCH
  7804             GO TO 1000-CONTINUE-EDITS.
  7805
  7806     MOVE AL-UANON               TO  BIRTHA.
  7807     MOVE 'X'                    TO  UPDATE-SWITCH
  7808                                     MSTR-SWITCH.
  7809     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  7810     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  7811     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  7812
  7813 1000-CONTINUE-EDITS.
  7814
  7815     IF SOCIALI GREATER THAN LOW-VALUES
  7816         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  7817         IF WS-SOC-SEC-NO NUMERIC AND
  7818           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  7819             NEXT SENTENCE
  7820         ELSE
  7821            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  7822               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  7823               WS-SSN-DASH2 = '-'
  7824                 NEXT SENTENCE
  7825            ELSE
  7826                 MOVE ER-0887        TO  EMI-ERROR
  7827                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7828                 MOVE AL-UABON       TO  SOCIALA
  7829                 MOVE -1             TO  SOCIALL
  7830                 MOVE 'X'            TO  ERROR-SWITCH
  7831            END-IF
  7832        END-IF
  7833     END-IF.
  7834
  7835     IF SOCIALI GREATER THAN LOW-VALUES
  7836         MOVE AL-UANON           TO SOCIALA
  7837         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  7838     ELSE
  7839         MOVE AL-UANOF           TO SOCIALA.
  7840
  7841     IF OCCI GREATER THAN LOW-VALUES
  7842         MOVE AL-UANON           TO OCCA
  7843         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  7844     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 143
* EL131.cbl
  7845         MOVE AL-UANOF           TO OCCA.
  7846
  7847     IF BENEL NOT GREATER THAN ZERO
  7848            GO TO 1005-CONTINUE-EDITS.
  7849
  7850     IF BENEI = SPACES
  7851        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  7852           MOVE 'N'             TO AUTO-PAY-TO-BENE
  7853           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  7854           IF AUTO-PAY-TO-BENE = 'Y'
  7855               MOVE ER-1773      TO  EMI-ERROR
  7856               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7857               MOVE 'X'          TO ERROR-SWITCH
  7858               MOVE AL-UABON     TO BENEA
  7859               MOVE -1           TO BENEL
  7860           ELSE
  7861               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  7862           END-IF
  7863        ELSE
  7864           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  7865        END-IF
  7866        GO TO 1005-CONTINUE-EDITS.
  7867
  7868
  7869* EXEC CICS HANDLE CONDITION
  7870*        NOTFND (1004-BENE-NOT-FOUND)
  7871*    END-EXEC.
  7872*    MOVE '"$I                   ! % #00007645' TO DFHEIV0
  7873     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7874     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7875     MOVE X'2520233030303037363435' TO DFHEIV0(25:11)
  7876     CALL 'kxdfhei1' USING DFHEIV0
  7877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7878
  7879
  7880     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  7881     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  7882     MOVE BENEI                  TO  WS-ELBENE-ID.
  7883
  7884
  7885* EXEC CICS READ
  7886*        DATASET ('ELBENE')
  7887*        RIDFLD  (WS-ELBENE-KEY)
  7888*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  7889*    END-EXEC.
  7890     MOVE 'ELBENE' TO DFHEIV1
  7891*    MOVE '&"S        E          (   #00007653' TO DFHEIV0
  7892     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7893     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7894     MOVE X'2020233030303037363533' TO DFHEIV0(25:11)
  7895     CALL 'kxdfhei1' USING DFHEIV0,
  7896           DFHEIV1,
  7897           DFHEIV20,
  7898           DFHEIV99,
  7899           WS-ELBENE-KEY,
  7900           DFHEIV99,
  7901           DFHEIV99,
  7902           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 144
* EL131.cbl
  7903     SET ADDRESS OF BENEFICIARY-MASTER TO
  7904         DFHEIV20
  7905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7906
  7907
  7908     MOVE AL-UANON               TO  BENEA.
  7909     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  7910
  7911     GO TO 1005-CONTINUE-EDITS.
  7912
  7913 1004-BENE-NOT-FOUND.
  7914     MOVE ER-0565                TO  EMI-ERROR.
  7915
  7916     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7917     MOVE 'X'                    TO ERROR-SWITCH.
  7918     MOVE AL-UABON               TO BENEA.
  7919     MOVE -1                     TO BENEL.
  7920
  7921 1005-CONTINUE-EDITS.
  7922
  7923     IF DIAGI GREATER THAN LOW-VALUES
  7924         MOVE AL-UANON           TO DIAGA
  7925         MOVE 'X'                TO UPDATE-SWITCH
  7926                                    NINETY-TRLR-SWITCH
  7927     ELSE
  7928         MOVE AL-UANOF           TO DIAGA.
  7929
  7930     IF CAUSEI GREATER THAN LOW-VALUES
  7931         MOVE AL-UANON           TO CAUSEA
  7932         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  7933     ELSE
  7934         MOVE AL-UANOF           TO CAUSEA.
  7935
  7936     IF ENDL GREATER THAN ZERO
  7937         MOVE LOW-VALUES         TO HOLD-END
  7938         IF ENDI = SPACES
  7939             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7940         ELSE
  7941             MOVE ENDI           TO DEEDIT-DATE-INPUT
  7942
  7943* EXEC CICS BIF DEEDIT
  7944*                FIELD    (DEEDIT-DATE-INPUT)
  7945*                LENGTH   (DATE-LENGTH)
  7946*            END-EXEC
  7947*    MOVE '@"L                   #   #00007693' TO DFHEIV0
  7948     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7949     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7950     MOVE X'2020233030303037363933' TO DFHEIV0(25:11)
  7951     CALL 'kxdfhei1' USING DFHEIV0,
  7952           DEEDIT-DATE-INPUT,
  7953           DATE-LENGTH
  7954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7955             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  7956             MOVE '4'            TO DC-OPTION-CODE
  7957             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7958             IF NOT DATE-CONVERSION-ERROR
  7959                 MOVE DC-BIN-DATE-1      TO HOLD-END
  7960                 MOVE AL-UANON   TO ENDA
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 145
* EL131.cbl
  7961                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  7962                 MOVE DC-GREG-DATE-1-EDIT TO ENDO
  7963             ELSE
  7964                 MOVE ER-0224    TO EMI-ERROR
  7965                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7966                 MOVE AL-UABON   TO ENDA
  7967                 MOVE -1         TO ENDL
  7968                 MOVE 'X'        TO ERROR-SWITCH
  7969       ELSE
  7970           MOVE AL-UANOF         TO ENDA.
  7971
  7972     IF INCL GREATER THAN ZERO
  7973         MOVE LOW-VALUES         TO HOLD-INCUR
  7974         IF INCI = SPACES
  7975             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7976         ELSE
  7977             MOVE INCI           TO DEEDIT-DATE-INPUT
  7978
  7979* EXEC CICS BIF DEEDIT
  7980*                FIELD    (DEEDIT-DATE-INPUT)
  7981*                LENGTH   (DATE-LENGTH)
  7982*            END-EXEC
  7983*    MOVE '@"L                   #   #00007720' TO DFHEIV0
  7984     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7985     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7986     MOVE X'2020233030303037373230' TO DFHEIV0(25:11)
  7987     CALL 'kxdfhei1' USING DFHEIV0,
  7988           DEEDIT-DATE-INPUT,
  7989           DATE-LENGTH
  7990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7991             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  7992             MOVE '4'            TO DC-OPTION-CODE
  7993             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7994             IF NOT DATE-CONVERSION-ERROR
  7995                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  7996                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  7997                 MOVE AL-UANON           TO INCA
  7998                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  7999             ELSE
  8000                 MOVE ER-0222    TO EMI-ERROR
  8001                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8002                 MOVE AL-UABON   TO INCA
  8003                 MOVE -1         TO INCL
  8004                 MOVE 'X'        TO ERROR-SWITCH
  8005       ELSE
  8006           IF PI-NO-PMTS = ZEROS
  8007               MOVE AL-UANOF     TO INCA.
  8008
  8009     IF REPL GREATER THAN ZERO
  8010         MOVE LOW-VALUES         TO HOLD-REPORTED
  8011         IF REPI = SPACES
  8012             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8013         ELSE
  8014             MOVE REPI           TO DEEDIT-DATE-INPUT
  8015
  8016* EXEC CICS BIF DEEDIT
  8017*                FIELD    (DEEDIT-DATE-INPUT)
  8018*                LENGTH   (DATE-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 146
* EL131.cbl
  8019*            END-EXEC
  8020*    MOVE '@"L                   #   #00007748' TO DFHEIV0
  8021     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8022     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8023     MOVE X'2020233030303037373438' TO DFHEIV0(25:11)
  8024     CALL 'kxdfhei1' USING DFHEIV0,
  8025           DEEDIT-DATE-INPUT,
  8026           DATE-LENGTH
  8027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8028             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8029             MOVE '4'            TO DC-OPTION-CODE
  8030             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8031             IF NOT DATE-CONVERSION-ERROR
  8032                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8033                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8034                 MOVE AL-UANON   TO REPA
  8035                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8036             ELSE
  8037                 MOVE ER-0223    TO EMI-ERROR
  8038                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8039                 MOVE AL-UABON   TO REPA
  8040                 MOVE -1         TO REPL
  8041                 MOVE 'X'        TO ERROR-SWITCH
  8042       ELSE
  8043         MOVE AL-UANOF TO REPA.
  8044
  8045     IF PDTHRUI GREATER THAN LOW-VALUES
  8046        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8047        IF PDTHRUI = SPACES
  8048           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8049        ELSE
  8050           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8051
  8052* EXEC CICS BIF DEEDIT
  8053*               FIELD    (DEEDIT-DATE-INPUT)
  8054*               LENGTH   (DATE-LENGTH)
  8055*          END-EXEC
  8056*    MOVE '@"L                   #   #00007775' TO DFHEIV0
  8057     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8058     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8059     MOVE X'2020233030303037373735' TO DFHEIV0(25:11)
  8060     CALL 'kxdfhei1' USING DFHEIV0,
  8061           DEEDIT-DATE-INPUT,
  8062           DATE-LENGTH
  8063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8064           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8065           MOVE '4'            TO DC-OPTION-CODE
  8066           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8067           IF NOT DATE-CONVERSION-ERROR
  8068              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8069              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8070              MOVE AL-UANON   TO PDTHRUA
  8071              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8072              IF PI-USES-PAID-TO
  8073                 MOVE '6'            TO DC-OPTION-CODE
  8074                 MOVE -1             TO DC-ELAPSED-DAYS
  8075                 MOVE +0             TO DC-ELAPSED-MONTHS
  8076                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 147
* EL131.cbl
  8077                 IF NO-CONVERSION-ERROR
  8078                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8079                 ELSE
  8080                    NEXT SENTENCE
  8081              ELSE
  8082                 NEXT SENTENCE
  8083           ELSE
  8084              MOVE ER-0475    TO EMI-ERROR
  8085              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8086              MOVE AL-UABON   TO PDTHRUA
  8087              MOVE -1         TO PDTHRUL
  8088              MOVE 'X'        TO ERROR-SWITCH
  8089     ELSE
  8090        IF MODIFY-CAP
  8091           MOVE AL-UANOF        TO PDTHRUA.
  8092
  8093     IF PDAMTL GREATER THAN +0
  8094         MOVE ZEROS              TO HOLD-PDAMT
  8095
  8096* EXEC CICS BIF DEEDIT
  8097*            FIELD    (PDAMTI)
  8098*            LENGTH   (9)
  8099*        END-EXEC
  8100     MOVE 9
  8101       TO DFHEIV11
  8102*    MOVE '@"L                   #   #00007810' TO DFHEIV0
  8103     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8104     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8105     MOVE X'2020233030303037383130' TO DFHEIV0(25:11)
  8106     CALL 'kxdfhei1' USING DFHEIV0,
  8107           PDAMTI,
  8108           DFHEIV11
  8109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8110         IF PDAMTI NUMERIC
  8111             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8112             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8113             MOVE AL-UNNON       TO PDAMTA
  8114         ELSE
  8115             MOVE ER-0547        TO EMI-ERROR
  8116             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8117             MOVE AL-UNBON       TO PDAMTA
  8118             MOVE -1             TO PDAMTL
  8119             MOVE 'X'            TO ERROR-SWITCH
  8120     ELSE
  8121         IF MODIFY-CAP
  8122            MOVE AL-UNNOF        TO PDAMTA.
  8123
  8124     IF NODAYSI GREATER THAN LOW-VALUES
  8125         MOVE ZEROS              TO HOLD-NODAYS
  8126
  8127* EXEC CICS BIF DEEDIT
  8128*            FIELD (NODAYSI)
  8129*            LENGTH (5)
  8130*        END-EXEC
  8131     MOVE 5
  8132       TO DFHEIV11
  8133*    MOVE '@"L                   #   #00007830' TO DFHEIV0
  8134     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 148
* EL131.cbl
  8135     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8136     MOVE X'2020233030303037383330' TO DFHEIV0(25:11)
  8137     CALL 'kxdfhei1' USING DFHEIV0,
  8138           NODAYSI,
  8139           DFHEIV11
  8140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8141         IF NODAYSI NUMERIC
  8142             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8143             MOVE AL-UNNON       TO NODAYSA
  8144             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8145         ELSE
  8146             MOVE ER-0491        TO EMI-ERROR
  8147             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8148             MOVE AL-UNBON       TO NODAYSA
  8149             MOVE -1             TO NODAYSL
  8150             MOVE 'X'            TO ERROR-SWITCH
  8151     ELSE
  8152         IF MODIFY-CAP
  8153            MOVE AL-UNNOF        TO NODAYSA.
  8154
  8155     IF NOPMTSI GREATER THAN LOW-VALUES
  8156         MOVE ZEROS              TO HOLD-NOPMTS
  8157
  8158* EXEC CICS BIF DEEDIT
  8159*            FIELD (NOPMTSI)
  8160*            LENGTH (4)
  8161*        END-EXEC
  8162     MOVE 4
  8163       TO DFHEIV11
  8164*    MOVE '@"L                   #   #00007850' TO DFHEIV0
  8165     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8166     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8167     MOVE X'2020233030303037383530' TO DFHEIV0(25:11)
  8168     CALL 'kxdfhei1' USING DFHEIV0,
  8169           NOPMTSI,
  8170           DFHEIV11
  8171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8172         IF NOPMTSI NUMERIC
  8173             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8174             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8175             MOVE AL-UNNON       TO NOPMTSA
  8176           ELSE
  8177             MOVE ER-0548        TO EMI-ERROR
  8178             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8179             MOVE AL-UNBON       TO NOPMTSA
  8180             MOVE -1             TO NOPMTSL
  8181             MOVE 'X'            TO ERROR-SWITCH
  8182       ELSE
  8183         IF MODIFY-CAP
  8184            MOVE AL-UNNOF        TO NOPMTSA.
  8185
  8186     IF FORMTYPI GREATER THAN LOW-VALUES
  8187         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8188             MOVE AL-UANON       TO FORMTYPA
  8189             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8190           ELSE
  8191             MOVE ER-7650        TO EMI-ERROR
  8192             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 149
* EL131.cbl
  8193             MOVE AL-UABON       TO FORMTYPA
  8194             MOVE -1             TO FORMTYPL
  8195             MOVE 'X'            TO ERROR-SWITCH
  8196       ELSE
  8197         MOVE AL-UANOF           TO FORMTYPA.
  8198
  8199     IF PRICDL GREATER THAN ZERO
  8200         IF (PRICDI = ' ') OR
  8201            (PRICDI GREATER THAN ZERO   AND
  8202             PRICDI NOT GREATER THAN '9')
  8203             MOVE AL-UANON       TO PRICDA
  8204             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8205         ELSE
  8206             MOVE ER-0274        TO EMI-ERROR
  8207             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8208             MOVE AL-UABON       TO PRICDA
  8209             MOVE -1             TO PRICDL
  8210             MOVE 'X'            TO ERROR-SWITCH
  8211     ELSE
  8212         MOVE AL-UANOF TO PRICDA.
  8213
  8214     IF PI-COMPANY-ID = 'DMD'
  8215     IF PRICDL GREATER THAN ZERO
  8216       IF SYSTEM-MODIFY-CAP  OR
  8217          PI-PROCESSOR-ID = 'LGXX'
  8218             NEXT SENTENCE
  8219           ELSE
  8220            IF CL-PRIORITY-CD = '9'  OR
  8221               PRICDI         = '9'
  8222                  MOVE ER-0938        TO EMI-ERROR
  8223                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8224                  MOVE AL-UABON       TO PRICDA
  8225                  MOVE -1             TO PRICDL
  8226                  MOVE 'X'            TO ERROR-SWITCH.
  8227
  8228     IF FILETOL GREATER THAN ZERO
  8229         MOVE AL-UANON           TO FILETOA
  8230         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8231     ELSE
  8232         MOVE AL-UANOF TO FILETOA.
  8233
  8234     IF SUPVL GREATER THAN ZERO
  8235         IF SUPVI = 'Y' OR 'N' OR SPACE
  8236             MOVE AL-UANON       TO SUPVA
  8237             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8238         ELSE
  8239             MOVE ER-0230        TO EMI-ERROR
  8240             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8241             MOVE AL-UABON       TO SUPVA
  8242             MOVE -1             TO SUPVL
  8243             MOVE 'X'            TO ERROR-SWITCH
  8244     ELSE
  8245         MOVE AL-UANOF           TO SUPVA.
  8246
  8247     IF MLNAMEL GREATER THAN ZERO
  8248         IF MLNAMEI GREATER THAN SPACES
  8249            MOVE AL-UANON        TO MLNAMEA
  8250            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 150
* EL131.cbl
  8251                                     MSTR-KEY-SWITCH
  8252         ELSE
  8253            MOVE ER-0236         TO EMI-ERROR
  8254            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8255            MOVE AL-UABON        TO MLNAMEA
  8256            MOVE -1              TO MLNAMEL
  8257            MOVE 'X'             TO ERROR-SWITCH
  8258     ELSE
  8259         MOVE AL-UANOF           TO MLNAMEA.
  8260
  8261     IF MFNAMEI GREATER THAN LOW-VALUES
  8262         MOVE AL-UANON           TO MFNAMEA
  8263         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8264     ELSE
  8265         MOVE AL-UANOF           TO MFNAMEA.
  8266
  8267     IF MMINITI GREATER THAN LOW-VALUES
  8268         MOVE AL-UANON           TO MMINITA
  8269         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8270     ELSE
  8271         MOVE AL-UANOF           TO MMINITA.
  8272
  8273     IF CRTLNMEI GREATER THAN LOW-VALUES
  8274         IF CRTLNMEI NOT = SPACES
  8275            MOVE AL-UANON        TO CRTLNMEA
  8276            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8277                                     CERT-KEY-SWITCH
  8278        ELSE
  8279            MOVE ER-0236         TO EMI-ERROR
  8280            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8281            MOVE AL-UABON        TO CRTLNMEA
  8282            MOVE -1              TO CRTLNMEL
  8283            MOVE 'X'             TO ERROR-SWITCH
  8284     ELSE
  8285         MOVE AL-UANOF           TO CRTLNMEA.
  8286
  8287     IF CRTFNMEI GREATER THAN LOW-VALUES
  8288         MOVE AL-UANON           TO CRTFNMEA
  8289         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8290     ELSE
  8291         MOVE AL-UANOF           TO CRTFNMEA.
  8292
  8293     IF CRTINITI GREATER THAN LOW-VALUES
  8294         MOVE AL-UANON           TO CRTINITA
  8295         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
  8296     ELSE
  8297         MOVE AL-UANOF           TO CRTINITA.
  8298
  8299     IF ISSAGEL GREATER THAN ZERO
  8300         IF ISSAGEI NUMERIC
  8301            MOVE AL-UANON        TO ISSAGEA
  8302            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8303         ELSE
  8304            MOVE ER-0237         TO EMI-ERROR
  8305            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8306            MOVE AL-UABON        TO ISSAGEA
  8307            MOVE -1              TO ISSAGEL
  8308            MOVE 'X'             TO ERROR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 151
* EL131.cbl
  8309     ELSE
  8310         MOVE AL-UANOF           TO ISSAGEA.
  8311
  8312     IF JNTFNMEI GREATER THAN LOW-VALUES
  8313         MOVE AL-UANON           TO JNTFNMEA
  8314         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8315     ELSE
  8316         MOVE AL-UANOF           TO JNTFNMEA.
  8317
  8318     IF JNTLNMEI GREATER THAN LOW-VALUES
  8319         MOVE AL-UANON           TO JNTLNMEA
  8320         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8321     ELSE
  8322         MOVE AL-UANOF           TO JNTLNMEA.
  8323
  8324     IF JNTINITI GREATER THAN LOW-VALUES
  8325         MOVE AL-UANON           TO JNTINITA
  8326         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8327     ELSE
  8328         MOVE AL-UANOF           TO JNTINITA.
  8329
  8330     IF JNTAGEL GREATER THAN ZERO
  8331         IF JNTAGEI NUMERIC
  8332            MOVE AL-UANON        TO JNTAGEA
  8333            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8334         ELSE
  8335            MOVE ER-0238         TO EMI-ERROR
  8336            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8337            MOVE AL-UABON        TO JNTAGEA
  8338            MOVE -1              TO JNTAGEL
  8339            MOVE 'X'             TO ERROR-SWITCH
  8340     ELSE
  8341         MOVE AL-UANOF           TO JNTAGEA.
  8342
  8343     IF ADDONDTI GREATER THAN LOW-VALUES
  8344         MOVE LOW-VALUES         TO HOLD-ADDON
  8345         IF ADDONDTI = SPACES
  8346             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8347         ELSE
  8348             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8349
  8350* EXEC CICS BIF DEEDIT
  8351*                FIELD    (DEEDIT-DATE-INPUT)
  8352*                LENGTH   (DATE-LENGTH)
  8353*            END-EXEC
  8354*    MOVE '@"L                   #   #00008031' TO DFHEIV0
  8355     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8356     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8357     MOVE X'2020233030303038303331' TO DFHEIV0(25:11)
  8358     CALL 'kxdfhei1' USING DFHEIV0,
  8359           DEEDIT-DATE-INPUT,
  8360           DATE-LENGTH
  8361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8362             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8363             MOVE '4'            TO DC-OPTION-CODE
  8364             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8365             IF NOT DATE-CONVERSION-ERROR
  8366                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 152
* EL131.cbl
  8367                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8368                                                  CERT-SWITCH
  8369                 MOVE AL-UANON   TO ADDONDTA
  8370                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8371             ELSE
  8372                 MOVE ER-7651    TO EMI-ERROR
  8373                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8374                 MOVE AL-UABON   TO ADDONDTA
  8375                 MOVE -1         TO ADDONDTL
  8376                 MOVE 'X'        TO ERROR-SWITCH
  8377       ELSE
  8378         MOVE AL-UANOF TO ADDONDTA.
  8379
  8380     IF LCVCDI GREATER THAN LOW-VALUES
  8381         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8382         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8383     ELSE
  8384         MOVE AL-UANOF           TO LCVCDA.
  8385
  8386     IF ACVCDI GREATER THAN LOW-VALUES
  8387         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8388         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8389     ELSE
  8390         MOVE AL-UANOF           TO ACVCDA.
  8391
  8392     IF LCVOTRMI GREATER THAN LOW-VALUES
  8393
  8394* EXEC CICS BIF DEEDIT
  8395*            FIELD (LCVOTRMI)
  8396*            LENGTH(3)
  8397*        END-EXEC
  8398     MOVE 3
  8399       TO DFHEIV11
  8400*    MOVE '@"L                   #   #00008066' TO DFHEIV0
  8401     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8402     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8403     MOVE X'2020233030303038303636' TO DFHEIV0(25:11)
  8404     CALL 'kxdfhei1' USING DFHEIV0,
  8405           LCVOTRMI,
  8406           DFHEIV11
  8407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8408         IF LCVOTRMI IS NUMERIC
  8409             MOVE LCVOTRMI       TO LCVOTRMO
  8410             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8411             MOVE AL-UANON       TO LCVOTRMA
  8412         ELSE
  8413             MOVE ER-0241        TO EMI-ERROR
  8414             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8415             MOVE AL-UNBON       TO LCVOTRMA
  8416             MOVE 'X'            TO ERROR-SWITCH
  8417             MOVE -1             TO LCVOTRML
  8418     ELSE
  8419         MOVE AL-UANOF           TO LCVOTRMA.
  8420
  8421     IF ACVOTRMI GREATER THAN LOW-VALUES
  8422
  8423* EXEC CICS BIF DEEDIT
  8424*            FIELD (ACVOTRMI)
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 153
* EL131.cbl
  8425*            LENGTH(3)
  8426*        END-EXEC
  8427     MOVE 3
  8428       TO DFHEIV11
  8429*    MOVE '@"L                   #   #00008084' TO DFHEIV0
  8430     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8431     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8432     MOVE X'2020233030303038303834' TO DFHEIV0(25:11)
  8433     CALL 'kxdfhei1' USING DFHEIV0,
  8434           ACVOTRMI,
  8435           DFHEIV11
  8436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8437         IF ACVOTRMI IS NUMERIC
  8438             MOVE ACVOTRMI       TO ACVOTRMO
  8439             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8440             MOVE AL-UANON       TO ACVOTRMA
  8441         ELSE
  8442             MOVE ER-0241        TO EMI-ERROR
  8443             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8444             MOVE AL-UNBON       TO ACVOTRMA
  8445             MOVE 'X'            TO ERROR-SWITCH
  8446             MOVE -1             TO ACVOTRML
  8447     ELSE
  8448         MOVE AL-UANOF           TO ACVOTRMA.
  8449
  8450     IF LCVRATEL GREATER THAN +0
  8451
  8452* EXEC CICS BIF DEEDIT
  8453*            FIELD (LCVRATEI)
  8454*            LENGTH(6)
  8455*        END-EXEC
  8456     MOVE 6
  8457       TO DFHEIV11
  8458*    MOVE '@"L                   #   #00008102' TO DFHEIV0
  8459     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8460     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8461     MOVE X'2020233030303038313032' TO DFHEIV0(25:11)
  8462     CALL 'kxdfhei1' USING DFHEIV0,
  8463           LCVRATEI,
  8464           DFHEIV11
  8465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8466         IF LCVRATEI IS NUMERIC
  8467             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  8468             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8469             MOVE AL-UNNON       TO LCVRATEA
  8470         ELSE
  8471             MOVE ER-2280        TO EMI-ERROR
  8472             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8473             MOVE AL-UNBON       TO LCVRATEA
  8474             MOVE 'X'            TO ERROR-SWITCH
  8475             MOVE -1             TO LCVRATEL
  8476     ELSE
  8477         MOVE AL-UNNOF           TO LCVRATEA.
  8478
  8479     IF ACVRATEL GREATER THAN +0
  8480
  8481* EXEC CICS BIF DEEDIT
  8482*            FIELD (ACVRATEI)
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 154
* EL131.cbl
  8483*            LENGTH(6)
  8484*        END-EXEC
  8485     MOVE 6
  8486       TO DFHEIV11
  8487*    MOVE '@"L                   #   #00008120' TO DFHEIV0
  8488     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8489     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8490     MOVE X'2020233030303038313230' TO DFHEIV0(25:11)
  8491     CALL 'kxdfhei1' USING DFHEIV0,
  8492           ACVRATEI,
  8493           DFHEIV11
  8494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8495         IF ACVRATEI IS NUMERIC
  8496             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  8497             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8498             MOVE AL-UNNON       TO ACVRATEA
  8499         ELSE
  8500             MOVE ER-2280        TO EMI-ERROR
  8501             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8502             MOVE AL-UNBON       TO ACVRATEA
  8503             MOVE 'X'            TO ERROR-SWITCH
  8504             MOVE -1             TO ACVRATEL
  8505     ELSE
  8506         MOVE AL-UNNOF           TO ACVRATEA.
  8507
  8508     IF LCVBENEL GREATER THAN ZERO
  8509
  8510* EXEC CICS BIF DEEDIT
  8511*            FIELD (LCVBENEI)
  8512*            LENGTH (11)
  8513*        END-EXEC
  8514     MOVE 11
  8515       TO DFHEIV11
  8516*    MOVE '@"L                   #   #00008138' TO DFHEIV0
  8517     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8518     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8519     MOVE X'2020233030303038313338' TO DFHEIV0(25:11)
  8520     CALL 'kxdfhei1' USING DFHEIV0,
  8521           LCVBENEI,
  8522           DFHEIV11
  8523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8524         IF LCVBENEI IS NUMERIC
  8525            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  8526            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8527            MOVE AL-UNNON        TO LCVBENEA
  8528         ELSE
  8529            MOVE ER-0243         TO EMI-ERROR
  8530            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8531            MOVE AL-UNBON        TO LCVBENEA
  8532            MOVE -1              TO LCVBENEL
  8533            MOVE 'X'             TO ERROR-SWITCH
  8534     ELSE
  8535         MOVE AL-UANOF           TO LCVBENEA.
  8536
  8537     IF ACVBENEL GREATER THAN ZERO
  8538
  8539* EXEC CICS BIF DEEDIT
  8540*            FIELD (ACVBENEI)
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 155
* EL131.cbl
  8541*            LENGTH (11)
  8542*        END-EXEC
  8543     MOVE 11
  8544       TO DFHEIV11
  8545*    MOVE '@"L                   #   #00008156' TO DFHEIV0
  8546     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8547     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8548     MOVE X'2020233030303038313536' TO DFHEIV0(25:11)
  8549     CALL 'kxdfhei1' USING DFHEIV0,
  8550           ACVBENEI,
  8551           DFHEIV11
  8552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8553         IF ACVBENEI IS NUMERIC
  8554            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  8555            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8556            MOVE AL-UNNON        TO ACVBENEA
  8557         ELSE
  8558            MOVE ER-0243         TO EMI-ERROR
  8559            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8560            MOVE AL-UNBON        TO ACVBENEA
  8561            MOVE -1              TO ACVBENEL
  8562            MOVE 'X'             TO ERROR-SWITCH
  8563     ELSE
  8564         MOVE AL-UANOF           TO ACVBENEA.
  8565
  8566     IF LCVFORMI GREATER THAN LOW-VALUES
  8567        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8568        MOVE AL-UANON            TO LCVFORMA
  8569     ELSE
  8570        MOVE AL-UANOF            TO LCVFORMA.
  8571
  8572     IF ACVFORMI GREATER THAN LOW-VALUES
  8573        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8574        MOVE AL-UANON            TO ACVFORMA
  8575     ELSE
  8576        MOVE AL-UANOF            TO ACVFORMA.
  8577
  8578     IF LCVCNDTL GREATER THAN ZERO
  8579         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8580         IF LCVCNDTI = SPACES
  8581             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8582         ELSE
  8583             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  8584             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8585             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8586             MOVE '4'            TO DC-OPTION-CODE
  8587             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8588             IF NOT DATE-CONVERSION-ERROR
  8589                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  8590                 MOVE AL-UANON   TO LCVCNDTA
  8591                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8592                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  8593             ELSE
  8594                 MOVE ER-0246    TO EMI-ERROR
  8595                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8596                 MOVE AL-UABON   TO LCVCNDTA
  8597                 MOVE -1         TO LCVCNDTL
  8598                 MOVE 'X'        TO ERROR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 156
* EL131.cbl
  8599     ELSE
  8600         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8601         MOVE AL-UANOF           TO LCVCNDTA.
  8602
  8603     IF ACVCNDTL GREATER THAN ZERO
  8604         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8605         IF ACVCNDTI = SPACES
  8606             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8607         ELSE
  8608             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  8609             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8610             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8611             MOVE '4'            TO DC-OPTION-CODE
  8612             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8613             IF NOT DATE-CONVERSION-ERROR
  8614                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  8615                 MOVE AL-UANON   TO ACVCNDTA
  8616                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8617                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  8618             ELSE
  8619                 MOVE ER-0246    TO EMI-ERROR
  8620                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8621                 MOVE AL-UABON   TO ACVCNDTA
  8622                 MOVE -1         TO ACVCNDTL
  8623                 MOVE 'X'        TO ERROR-SWITCH
  8624     ELSE
  8625         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8626         MOVE AL-UANOF           TO ACVCNDTA.
  8627
  8628     IF APRL GREATER THAN +0
  8629
  8630* EXEC CICS BIF DEEDIT
  8631*            FIELD    (APRI)
  8632*            LENGTH   (8)
  8633*        END-EXEC
  8634     MOVE 8
  8635       TO DFHEIV11
  8636*    MOVE '@"L                   #   #00008236' TO DFHEIV0
  8637     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8638     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8639     MOVE X'2020233030303038323336' TO DFHEIV0(25:11)
  8640     CALL 'kxdfhei1' USING DFHEIV0,
  8641           APRI,
  8642           DFHEIV11
  8643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8644         IF APRI NUMERIC
  8645            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8646            MOVE APRI            TO HOLD-APR APRO
  8647            MOVE AL-UANON        TO APRA
  8648          ELSE
  8649            MOVE ER-0259         TO EMI-ERROR
  8650            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8651            MOVE AL-UABON        TO APRA
  8652            MOVE -1              TO APRL
  8653            MOVE 'X'             TO ERROR-SWITCH
  8654     ELSE
  8655         MOVE AL-UANOF           TO APRA.
  8656
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 157
* EL131.cbl
  8657     IF PMTFREQL GREATER THAN ZERO
  8658
  8659* EXEC CICS BIF DEEDIT
  8660*            FIELD    (PMTFREQI)
  8661*            LENGTH   (2)
  8662*        END-EXEC
  8663     MOVE 2
  8664       TO DFHEIV11
  8665*    MOVE '@"L                   #   #00008254' TO DFHEIV0
  8666     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8667     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8668     MOVE X'2020233030303038323534' TO DFHEIV0(25:11)
  8669     CALL 'kxdfhei1' USING DFHEIV0,
  8670           PMTFREQI,
  8671           DFHEIV11
  8672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8673         IF PMTFREQI NUMERIC
  8674            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  8675            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8676            MOVE AL-UANON        TO PMTFREQA
  8677          ELSE
  8678            MOVE ER-0427         TO EMI-ERROR
  8679            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8680            MOVE AL-UABON        TO PMTFREQA
  8681            MOVE -1              TO PMTFREQL
  8682            MOVE 'X'             TO ERROR-SWITCH
  8683     ELSE
  8684         MOVE AL-UANOF           TO PMTFREQA.
  8685
  8686     IF INDGRPL GREATER THAN ZERO
  8687         IF INDGRPI = 'I' OR 'G' OR SPACE
  8688             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8689             MOVE AL-UANON       TO INDGRPA
  8690          ELSE
  8691             MOVE ER-0260        TO EMI-ERROR
  8692             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8693             MOVE AL-UABON       TO INDGRPA
  8694             MOVE -1             TO INDGRPL
  8695             MOVE 'X'            TO ERROR-SWITCH
  8696     ELSE
  8697         MOVE AL-UANOF           TO INDGRPA.
  8698
  8699     IF PREMTYPL GREATER THAN ZERO
  8700         IF PREMTYPI = '1' OR '2' OR '3'
  8701            MOVE PREMTYPI        TO PI-PREM-TYPE
  8702            MOVE AL-UNNON        TO PREMTYPA
  8703            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8704          ELSE
  8705            MOVE ER-0227         TO EMI-ERROR
  8706            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8707            MOVE AL-UNBON        TO PREMTYPA
  8708            MOVE -1              TO PREMTYPL
  8709            MOVE 'X'             TO ERROR-SWITCH
  8710     ELSE
  8711         MOVE AL-UANOF           TO PREMTYPA.
  8712
  8713     IF LOANBALL GREATER THAN ZERO
  8714
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 158
* EL131.cbl
  8715* EXEC CICS BIF DEEDIT
  8716*             FIELD    (LOANBALI)
  8717*             LENGTH   (9)
  8718*        END-EXEC
  8719     MOVE 9
  8720       TO DFHEIV11
  8721*    MOVE '@"L                   #   #00008299' TO DFHEIV0
  8722     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8723     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8724     MOVE X'2020233030303038323939' TO DFHEIV0(25:11)
  8725     CALL 'kxdfhei1' USING DFHEIV0,
  8726           LOANBALI,
  8727           DFHEIV11
  8728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8729         IF LOANBALI NUMERIC
  8730             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  8731             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  8732             MOVE AL-UNNON TO LOANBALA
  8733         ELSE
  8734             MOVE ER-0639        TO EMI-ERROR
  8735             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8736             MOVE AL-UNBON       TO LOANBALA
  8737             MOVE -1             TO LOANBALL
  8738             MOVE 'X'            TO ERROR-SWITCH
  8739     ELSE
  8740         MOVE AL-UNNOF           TO LOANBALA.
  8741
  8742     IF LOANNOL GREATER THAN ZERO
  8743        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8744        MOVE AL-UANON            TO LOANNOA
  8745     ELSE
  8746        MOVE AL-UANOF            TO LOANNOA.
  8747
  8748     IF REINCDI GREATER THAN LOW-VALUES
  8749        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8750        MOVE AL-UANON            TO REINCDA
  8751     ELSE
  8752        MOVE AL-UANOF            TO REINCDA.
  8753
  8754     IF CERTI GREATER THAN LOW-VALUES
  8755         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  8756     ELSE
  8757         MOVE AL-UANOF           TO CERTA.
  8758
  8759     IF CERTEFFI GREATER THAN LOW-VALUES
  8760         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  8761     ELSE
  8762         MOVE AL-UANOF           TO CERTEFFA.
  8763
  8764     IF CERTACTI GREATER THAN LOW-VALUES
  8765         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  8766     ELSE
  8767         MOVE AL-UANOF           TO CERTACTA.
  8768
  8769     IF CERTSTI GREATER THAN LOW-VALUES
  8770         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  8771     ELSE
  8772         MOVE AL-UANOF           TO CERTSTA.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 159
* EL131.cbl
  8773
  8774     IF CERTCARI GREATER THAN LOW-VALUES
  8775         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  8776     ELSE
  8777         MOVE AL-UANOF           TO CERTCARA.
  8778
  8779     IF DLYACTV-RECORD-NEEDED
  8780         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  8781                 1150-EXIT
  8782     END-IF.
  8783
  8784     IF CERTEFFI GREATER LOW-VALUES OR
  8785        CERTACTI GREATER LOW-VALUES OR
  8786        CERTSTI  GREATER LOW-VALUES OR
  8787        CERTCARI GREATER LOW-VALUES OR
  8788        CERTGRPI GREATER LOW-VALUES
  8789        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  8790
  8791*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  8792*      IF PI-PREM-TYPE NOT = '1'  AND
  8793*         PI-NO-PMTS = ZEROS
  8794*          IF LOANBALL GREATER +0 OR
  8795*             ACVBENEL GREATER +0
  8796*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  8797
  8798     IF CERTL = ZEROS AND
  8799        SUFXL = ZEROS
  8800          GO TO 1010-EXIT.
  8801
  8802     IF CERTL GREATER THAN ZEROS
  8803         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  8804             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  8805             MOVE 'Y'            TO SKIP-ATTRIBUTE
  8806             MOVE 'X'            TO ERROR-SWITCH
  8807             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  8808
  8809     IF SUFXL GREATER THAN ZEROS
  8810         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  8811             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  8812             MOVE 'Y'            TO SKIP-ATTRIBUTE
  8813             MOVE 'X'            TO ERROR-SWITCH
  8814             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  8815
  8816 1010-EXIT.
  8817     EXIT.
  8818
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 160
* EL131.cbl
  8820 1120-EDIT-PROC.
  8821     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  8822     MOVE '2'                    TO CNTL-REC-TYPE.
  8823     MOVE PROCI                  TO CNTL-PROC-ID.
  8824     MOVE ZERO                   TO CNTL-SEQ-NO.
  8825
  8826
  8827* EXEC CICS HANDLE CONDITION
  8828*         NOTFND    (1120-CNTL-NOTFND)
  8829*    END-EXEC.
  8830*    MOVE '"$I                   ! & #00008400' TO DFHEIV0
  8831     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8832     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8833     MOVE X'2620233030303038343030' TO DFHEIV0(25:11)
  8834     CALL 'kxdfhei1' USING DFHEIV0
  8835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8836
  8837
  8838
  8839* EXEC CICS READ
  8840*         SET      (ADDRESS OF CONTROL-FILE)
  8841*         DATASET  (CNTL-FILE-ID)
  8842*         RIDFLD   (CNTL-KEY)
  8843*    END-EXEC.
  8844*    MOVE '&"S        E          (   #00008404' TO DFHEIV0
  8845     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8846     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8847     MOVE X'2020233030303038343034' TO DFHEIV0(25:11)
  8848     CALL 'kxdfhei1' USING DFHEIV0,
  8849           CNTL-FILE-ID,
  8850           DFHEIV20,
  8851           DFHEIV99,
  8852           CNTL-KEY,
  8853           DFHEIV99,
  8854           DFHEIV99,
  8855           DFHEIV99
  8856     SET ADDRESS OF CONTROL-FILE TO
  8857         DFHEIV20
  8858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8859
  8860
  8861     MOVE AL-UANON               TO PROCA.
  8862     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  8863     GO TO 1120-EXIT.
  8864
  8865 1120-CNTL-NOTFND.
  8866     MOVE ER-0273                TO EMI-ERROR.
  8867     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8868     MOVE AL-UABON               TO PROCA.
  8869     MOVE -1                     TO PROCL.
  8870     MOVE 'X'                    TO ERROR-SWITCH.
  8871
  8872 1120-EXIT.
  8873     EXIT.
  8874
  8875*************************************************************
  8876*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  8877*************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 161
* EL131.cbl
  8878
  8879 1150-OUTPUT-ACTIVITY-RECORD.
  8880
  8881
  8882* EXEC CICS GETMAIN
  8883*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  8884*        LENGTH (25)
  8885*        INITIMG (WS-BLANK)
  8886*    END-EXEC.
  8887     MOVE 25
  8888       TO DFHEIV11
  8889*    MOVE ',"IL                  $   #00008430' TO DFHEIV0
  8890     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8891     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8892     MOVE X'2020233030303038343330' TO DFHEIV0(25:11)
  8893     CALL 'kxdfhei1' USING DFHEIV0,
  8894           DFHEIV20,
  8895           DFHEIV11,
  8896           WS-BLANK
  8897     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  8898         DFHEIV20
  8899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8900
  8901
  8902     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  8903     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  8904     MOVE PI-CARRIER             TO DA-CARRIER.
  8905     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  8906     MOVE PI-CERT-NO             TO DA-CERT-NO.
  8907     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  8908     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  8909
  8910
  8911* EXEC CICS HANDLE CONDITION
  8912*        NOTOPEN (1150-NOTOPEN-ERROR)
  8913*        DUPREC (1150-EXIT)
  8914*    END-EXEC.
  8915*    MOVE '"$J%                  ! '' #00008444' TO DFHEIV0
  8916     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  8917     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8918     MOVE X'2720233030303038343434' TO DFHEIV0(25:11)
  8919     CALL 'kxdfhei1' USING DFHEIV0
  8920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8921
  8922     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  8923     MOVE 'DLYACTV'              TO JP-FILE-ID.
  8924     MOVE 'A'                    TO JP-RECORD-TYPE.
  8925     MOVE +48                    TO JOURNAL-LENGTH.
  8926
  8927
  8928* EXEC CICS WRITE
  8929*        DATASET ('DLYACTV')
  8930*        RIDFLD (DA-KEY)
  8931*        FROM (DAILY-ACTIVITY-RECORD)
  8932*        LENGTH (25)
  8933*    END-EXEC.
  8934     MOVE 'DLYACTV' TO DFHEIV1
  8935     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 162
* EL131.cbl
  8936       TO DFHEIV11
  8937*    MOVE '&$ L                  ''   #00008453' TO DFHEIV0
  8938     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8939     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8940     MOVE X'2020233030303038343533' TO DFHEIV0(25:11)
  8941     CALL 'kxdfhei1' USING DFHEIV0,
  8942           DFHEIV1,
  8943           DAILY-ACTIVITY-RECORD,
  8944           DFHEIV11,
  8945           DA-KEY,
  8946           DFHEIV99,
  8947           DFHEIV99
  8948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8949
  8950
  8951     GO TO 1150-EXIT.
  8952
  8953 1150-NOTOPEN-ERROR.
  8954
  8955     MOVE '2955'                 TO EMI-ERROR.
  8956     MOVE -1                     TO MAINTL.
  8957     MOVE AL-UANON               TO MAINTA.
  8958     MOVE 'X'                    TO ERROR-SWITCH.
  8959     PERFORM 9900-ERROR-FORMAT THRU
  8960             9900-EXIT.
  8961
  8962 1150-EXIT.
  8963     EXIT.
  8964
  8965*************************************************************
  8966*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  8967*************************************************************
  8968
  8969 1240-EDIT-LIFE-CODE.
  8970
  8971     IF INVALID-BENEFIT-CODE
  8972         GO TO 1240-SET-ERROR.
  8973
  8974     MOVE SPACES                 TO BENEFIT-KEY.
  8975     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  8976     MOVE '4'                    TO BEN-REC-TYPE.
  8977     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  8978     MOVE ZERO                   TO BEN-SEQ-NO.
  8979
  8980
  8981* EXEC CICS READ GTEQ
  8982*         DATASET  (CNTL-FILE-ID)
  8983*         RIDFLD   (BENEFIT-KEY)
  8984*         SET      (ADDRESS OF CONTROL-FILE)
  8985*    END-EXEC.
  8986*    MOVE '&"S        G          (   #00008489' TO DFHEIV0
  8987     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8988     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8989     MOVE X'2020233030303038343839' TO DFHEIV0(25:11)
  8990     CALL 'kxdfhei1' USING DFHEIV0,
  8991           CNTL-FILE-ID,
  8992           DFHEIV20,
  8993           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 163
* EL131.cbl
  8994           BENEFIT-KEY,
  8995           DFHEIV99,
  8996           DFHEIV99,
  8997           DFHEIV99
  8998     SET ADDRESS OF CONTROL-FILE TO
  8999         DFHEIV20
  9000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9001
  9002
  9003     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9004        CF-RECORD-TYPE NOT = '4'
  9005         GO TO 1240-SET-ERROR.
  9006
  9007     MOVE ZERO                   TO COUNT-2.
  9008     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9009
  9010     IF SCREEN-ERROR
  9011         GO TO 1240-SET-ERROR.
  9012
  9013 1240-SET-CODE-SWITCHES.
  9014     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9015     MOVE AL-UANON               TO LCVCDA.
  9016     GO TO 1240-EXIT.
  9017
  9018 1240-SET-ERROR.
  9019     MOVE ER-0240                TO EMI-ERROR.
  9020     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9021     MOVE 'X'                    TO ERROR-SWITCH.
  9022     MOVE AL-UABON               TO LCVCDA.
  9023     MOVE -1                     TO LCVCDL.
  9024
  9025 1240-EXIT.
  9026     EXIT.
  9027
  9028 1310-EDIT-AH-CODE.
  9029     IF INVALID-BENEFIT-CODE
  9030         GO TO 1310-SET-ERROR.
  9031
  9032     MOVE SPACES                 TO BENEFIT-KEY.
  9033     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9034     MOVE '5'                    TO BEN-REC-TYPE.
  9035     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9036     MOVE ZERO                   TO BEN-SEQ-NO.
  9037
  9038
  9039* EXEC CICS READ GTEQ
  9040*         DATASET  (CNTL-FILE-ID)
  9041*         RIDFLD   (BENEFIT-KEY)
  9042*         SET      (ADDRESS OF CONTROL-FILE)
  9043*    END-EXEC.
  9044*    MOVE '&"S        G          (   #00008530' TO DFHEIV0
  9045     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9046     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9047     MOVE X'2020233030303038353330' TO DFHEIV0(25:11)
  9048     CALL 'kxdfhei1' USING DFHEIV0,
  9049           CNTL-FILE-ID,
  9050           DFHEIV20,
  9051           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 164
* EL131.cbl
  9052           BENEFIT-KEY,
  9053           DFHEIV99,
  9054           DFHEIV99,
  9055           DFHEIV99
  9056     SET ADDRESS OF CONTROL-FILE TO
  9057         DFHEIV20
  9058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9059
  9060
  9061     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9062        CF-RECORD-TYPE NOT = '5'
  9063         GO TO 1310-SET-ERROR.
  9064
  9065     MOVE ZERO                   TO COUNT-2.
  9066     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9067     IF SCREEN-ERROR
  9068         GO TO 1310-SET-ERROR.
  9069
  9070 1310-SET-CODE-SWITCHES.
  9071     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9072     MOVE AL-UANON               TO ACVCDA.
  9073     GO TO 1310-EXIT.
  9074
  9075 1310-SET-ERROR.
  9076     MOVE ER-0250                TO EMI-ERROR.
  9077     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9078     MOVE AL-UABON               TO ACVCDA.
  9079     MOVE 'X'                    TO ERROR-SWITCH.
  9080     MOVE -1                     TO ACVCDL.
  9081
  9082 1310-EXIT.
  9083     EXIT.
  9084
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 165
* EL131.cbl
  9086 1460-EDIT-CERT-NO.
  9087     MOVE CERTI                  TO WS-CERT-NO-PRIME.
  9088     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
  9089
  9090     IF WS-SAVE-CERT-NO = SPACES
  9091         MOVE ER-0203            TO EMI-ERROR
  9092         GO TO 1460-CERT-NO-ERROR.
  9093
  9094     IF WS-CERT-NO-PRIME = SPACES AND
  9095        WS-CERT-NO-SUFX GREATER THAN SPACE
  9096            MOVE ER-0210         TO EMI-ERROR
  9097            GO TO 1460-CERT-NO-ERROR.
  9098
  9099     MOVE 'X'                    TO UPDATE-SWITCH.
  9100     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9101     MOVE AL-UANON               TO CERTA.
  9102
  9103     IF SUFXL IS GREATER THAN 0
  9104         MOVE AL-UANON           TO SUFXA.
  9105
  9106     GO TO 1460-EXIT.
  9107
  9108 1460-CERT-NO-ERROR.
  9109     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9110     MOVE AL-UABON               TO SUFXA.
  9111     MOVE AL-UABON               TO CERTA.
  9112     MOVE -1                     TO CERTL.
  9113     MOVE 'X'                    TO ERROR-SWITCH.
  9114
  9115 1460-EXIT.
  9116     EXIT.
  9117
  9118 1470-EDIT-EFF.
  9119     IF CERTEFFI = SPACES
  9120         GO TO 1470-DATE-ERROR.
  9121
  9122     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
  9123     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  9124     IF DEEDIT-DATE = ZERO
  9125         GO TO 1470-DATE-ERROR.
  9126
  9127     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
  9128     MOVE '4'                    TO DC-OPTION-CODE.
  9129     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  9130     IF NOT DATE-CONVERSION-ERROR
  9131         MOVE DC-BIN-DATE-1      TO HOLD-EFF
  9132         MOVE AL-UANON           TO CERTEFFA
  9133         MOVE 'X'                TO UPDATE-SWITCH
  9134         MOVE 'Y'                TO CERT-KEY-SWITCH
  9135         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
  9136         GO TO 1470-EXIT.
  9137
  9138 1470-DATE-ERROR.
  9139     MOVE ER-0215                TO EMI-ERROR.
  9140     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9141     MOVE AL-UABON               TO CERTEFFA.
  9142     MOVE -1                     TO CERTEFFL.
  9143     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 166
* EL131.cbl
  9144
  9145 1470-EXIT.
  9146     EXIT.
  9147
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 167
* EL131.cbl
  9149 1480-EDIT-ACCT.
  9150     IF CERTACTI = SPACES
  9151         MOVE ER-0232            TO EMI-ERROR
  9152         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9153         MOVE AL-UABON           TO CERTACTA
  9154         MOVE -1                 TO CERTACTL
  9155         MOVE 'X'                TO ERROR-SWITCH
  9156     ELSE
  9157         MOVE 'X'                TO UPDATE-SWITCH
  9158         MOVE 'Y'                TO CERT-KEY-SWITCH.
  9159
  9160 1480-EXIT.
  9161     EXIT.
  9162
  9163 1490-EDIT-STATE.
  9164     IF CERTSTI = SPACES
  9165         MOVE ER-0233            TO EMI-ERROR
  9166         GO TO 1490-STATE-ERROR.
  9167
  9168     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9169     MOVE '3'                    TO CNTL-REC-TYPE.
  9170     MOVE SPACES                 TO CNTL-STATE-ACCESS.
  9171     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
  9172     MOVE ZERO                   TO CNTL-SEQ-NO.
  9173
  9174
  9175* EXEC CICS HANDLE CONDITION
  9176*         NOTFND (1490-STATE-NOTFND)
  9177*    END-EXEC.
  9178*    MOVE '"$I                   ! ( #00008649' TO DFHEIV0
  9179     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9180     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9181     MOVE X'2820233030303038363439' TO DFHEIV0(25:11)
  9182     CALL 'kxdfhei1' USING DFHEIV0
  9183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9184
  9185
  9186
  9187* EXEC CICS READ
  9188*         SET        (ADDRESS OF CONTROL-FILE)
  9189*         DATASET    ('ELCNTL')
  9190*         RIDFLD     (CNTL-KEY)
  9191*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9192*         GENERIC
  9193*    END-EXEC.
  9194     MOVE 'ELCNTL' TO DFHEIV1
  9195*    MOVE '&"S  KG    E          (   #00008653' TO DFHEIV0
  9196     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9197     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9198     MOVE X'2020233030303038363533' TO DFHEIV0(25:11)
  9199     CALL 'kxdfhei1' USING DFHEIV0,
  9200           DFHEIV1,
  9201           DFHEIV20,
  9202           DFHEIV99,
  9203           CNTL-KEY,
  9204           CNTL-GENERIC-LENGTH,
  9205           DFHEIV99,
  9206           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 168
* EL131.cbl
  9207     SET ADDRESS OF CONTROL-FILE TO
  9208         DFHEIV20
  9209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9210
  9211
  9212     MOVE AL-UANON               TO CERTSTA.
  9213     MOVE 'X'                    TO UPDATE-SWITCH.
  9214     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9215     GO TO 1490-EXIT.
  9216
  9217 1490-STATE-NOTFND.
  9218     MOVE ER-0149                TO EMI-ERROR.
  9219
  9220 1490-STATE-ERROR.
  9221     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9222     MOVE AL-UABON               TO CERTSTA.
  9223     MOVE -1                     TO CERTSTL.
  9224     MOVE 'X'                    TO ERROR-SWITCH.
  9225
  9226 1490-EXIT.
  9227     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 169
* EL131.cbl
  9229 1500-EDIT-CARR.
  9230     IF CERTCARI = SPACES
  9231         GO TO 1500-CARR-NOTFND.
  9232
  9233     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9234     MOVE '6'                    TO CNTL-REC-TYPE.
  9235     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
  9236     MOVE CERTCARI               TO CNTL-CARRIER.
  9237     MOVE ZERO                   TO CNTL-SEQ-NO.
  9238
  9239
  9240* EXEC CICS HANDLE CONDITION
  9241*         NOTFND   (1500-CARR-NOTFND)
  9242*    END-EXEC.
  9243*    MOVE '"$I                   ! ) #00008688' TO DFHEIV0
  9244     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9245     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9246     MOVE X'2920233030303038363838' TO DFHEIV0(25:11)
  9247     CALL 'kxdfhei1' USING DFHEIV0
  9248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9249
  9250
  9251
  9252* EXEC CICS READ
  9253*         SET        (ADDRESS OF CONTROL-FILE)
  9254*         DATASET    ('ELCNTL')
  9255*         RIDFLD     (CNTL-KEY)
  9256*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9257*         GENERIC
  9258*    END-EXEC.
  9259     MOVE 'ELCNTL' TO DFHEIV1
  9260*    MOVE '&"S  KG    E          (   #00008692' TO DFHEIV0
  9261     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9262     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9263     MOVE X'2020233030303038363932' TO DFHEIV0(25:11)
  9264     CALL 'kxdfhei1' USING DFHEIV0,
  9265           DFHEIV1,
  9266           DFHEIV20,
  9267           DFHEIV99,
  9268           CNTL-KEY,
  9269           CNTL-GENERIC-LENGTH,
  9270           DFHEIV99,
  9271           DFHEIV99
  9272     SET ADDRESS OF CONTROL-FILE TO
  9273         DFHEIV20
  9274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9275
  9276
  9277     MOVE AL-UANON               TO CERTCARA.
  9278     MOVE 'X'                    TO UPDATE-SWITCH.
  9279     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9280     GO TO 1500-EXIT.
  9281
  9282 1500-CARR-NOTFND.
  9283     MOVE ER-0360                TO EMI-ERROR.
  9284     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9285     MOVE AL-UABON               TO CERTCARA.
  9286     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 170
* EL131.cbl
  9287     MOVE 'X'                    TO ERROR-SWITCH.
  9288
  9289 1500-EXIT.
  9290     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 171
* EL131.cbl
  9292 1510-DEEDIT-DATE.
  9293
  9294* EXEC CICS BIF DEEDIT
  9295*         FIELD    (DEEDIT-DATE-INPUT)
  9296*         LENGTH   (DATE-LENGTH)
  9297*    END-EXEC.
  9298*    MOVE '@"L                   #   #00008716' TO DFHEIV0
  9299     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9300     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9301     MOVE X'2020233030303038373136' TO DFHEIV0(25:11)
  9302     CALL 'kxdfhei1' USING DFHEIV0,
  9303           DEEDIT-DATE-INPUT,
  9304           DATE-LENGTH
  9305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9306
  9307
  9308 1510-EXIT.
  9309     EXIT.
  9310
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 172
* EL131.cbl
  9312 1620-VERIFY-ACCT.
  9313
  9314     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
  9315     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9316     MOVE PI-GROUPING            TO ACCT-GROUP.
  9317     MOVE PI-STATE               TO ACCT-STATE.
  9318     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9319
  9320     IF CERTEFFI GREATER THAN LOW-VALUES
  9321         MOVE HOLD-EFF           TO ACCT-DATE
  9322     ELSE
  9323         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
  9324
  9325     IF CERTACTI GREATER THAN LOW-VALUES
  9326         MOVE CERTACTI           TO  ACCT-ACCOUNT.
  9327     IF CERTSTI GREATER THAN LOW-VALUES
  9328         MOVE CERTSTI            TO  ACCT-STATE.
  9329     IF CERTCARI GREATER THAN LOW-VALUES
  9330         MOVE CERTCARI           TO  ACCT-CARRIER.
  9331     IF CERTGRPI GREATER THAN LOW-VALUES
  9332         MOVE CERTGRPI           TO ACCT-GROUP.
  9333
  9334     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
  9335
  9336
  9337* EXEC CICS HANDLE CONDITION
  9338*         NOTFND  (1620-ACCT-NOTFND)
  9339*    END-EXEC.
  9340*    MOVE '"$I                   ! * #00008749' TO DFHEIV0
  9341     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9342     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9343     MOVE X'2A20233030303038373439' TO DFHEIV0(25:11)
  9344     CALL 'kxdfhei1' USING DFHEIV0
  9345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9346
  9347
  9348
  9349* EXEC CICS STARTBR
  9350*         DATASET   (ACCT-FILE-ID)
  9351*         RIDFLD    (ACCT-KEY)
  9352*    END-EXEC.
  9353     MOVE 0
  9354       TO DFHEIV11
  9355*    MOVE '&,         G          &   #00008753' TO DFHEIV0
  9356     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9357     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9358     MOVE X'2020233030303038373533' TO DFHEIV0(25:11)
  9359     CALL 'kxdfhei1' USING DFHEIV0,
  9360           ACCT-FILE-ID,
  9361           ACCT-KEY,
  9362           DFHEIV99,
  9363           DFHEIV11,
  9364           DFHEIV99
  9365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9366
  9367
  9368 1620-ACCT-LOOP.
  9369
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 173
* EL131.cbl
  9370
  9371* EXEC CICS READNEXT
  9372*         DATASET  (ACCT-FILE-ID)
  9373*         RIDFLD   (ACCT-KEY)
  9374*         SET      (ADDRESS OF ACCOUNT-MASTER)
  9375*    END-EXEC.
  9376     MOVE 0
  9377       TO DFHEIV11
  9378*    MOVE '&.S                   )   #00008760' TO DFHEIV0
  9379     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9380     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9381     MOVE X'2020233030303038373630' TO DFHEIV0(25:11)
  9382     CALL 'kxdfhei1' USING DFHEIV0,
  9383           ACCT-FILE-ID,
  9384           DFHEIV20,
  9385           DFHEIV99,
  9386           ACCT-KEY,
  9387           DFHEIV99,
  9388           DFHEIV11,
  9389           DFHEIV99,
  9390           DFHEIV99
  9391     SET ADDRESS OF ACCOUNT-MASTER TO
  9392         DFHEIV20
  9393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9394
  9395
  9396     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
  9397         GO TO 1620-ACCT-NOTFND.
  9398
  9399     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
  9400        HOLD-EFF     LESS AM-EXPIRATION-DT
  9401         NEXT SENTENCE
  9402     ELSE
  9403         GO TO 1620-ACCT-LOOP.
  9404
  9405     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
  9406         GO TO 1620-ACCT-END-BROWSE.
  9407
  9408     IF LOANBALL GREATER THAN +0
  9409         IF AM-MAX-TOT-BEN NUMERIC  AND
  9410            AM-MAX-TOT-BEN GREATER THAN ZERO
  9411             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
  9412                 MOVE AL-UNBON     TO LOANBALA
  9413                 MOVE -1           TO LOANBALL
  9414                 MOVE 'X'          TO ERROR-SWITCH
  9415                 MOVE ER-7641      TO EMI-ERROR
  9416                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9417
  9418     IF ACVBENEL GREATER THAN +0
  9419         IF AM-MAX-MON-BEN NUMERIC  AND
  9420            AM-MAX-MON-BEN GREATER THAN ZERO
  9421             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
  9422                 MOVE AL-UNBON     TO ACVBENEA
  9423                 MOVE -1           TO ACVBENEL
  9424                 MOVE 'X'          TO ERROR-SWITCH
  9425                 MOVE ER-7642      TO EMI-ERROR
  9426                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9427
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 174
* EL131.cbl
  9428 1620-ACCT-END-BROWSE.
  9429
  9430
  9431* EXEC CICS ENDBR
  9432*         DATASET (ACCT-FILE-ID)
  9433*    END-EXEC.
  9434     MOVE 0
  9435       TO DFHEIV11
  9436*    MOVE '&2                    $   #00008800' TO DFHEIV0
  9437     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9438     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9439     MOVE X'2020233030303038383030' TO DFHEIV0(25:11)
  9440     CALL 'kxdfhei1' USING DFHEIV0,
  9441           ACCT-FILE-ID,
  9442           DFHEIV11,
  9443           DFHEIV99
  9444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9445
  9446
  9447     GO TO 1620-EXIT.
  9448
  9449 1620-ACCT-NOTFND.
  9450
  9451     MOVE -1                     TO MAINTL.
  9452     MOVE 'X'                    TO ERROR-SWITCH.
  9453     MOVE ER-0426                TO EMI-ERROR.
  9454     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9455
  9456 1620-EXIT.
  9457     EXIT.
  9458
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 175
* EL131.cbl
  9460 2000-UPDATE-CLAIM.
  9461
  9462     MOVE SPACES                 TO ERROR-SWITCH.
  9463     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
  9464     MOVE PI-CARRIER             TO CARRIER-CODE.
  9465     MOVE PI-CLAIM-NO            TO CLAIM-NO.
  9466     MOVE PI-CERT-NO             TO CERT-NO.
  9467
  9468     IF DELETE-CLAIM
  9469         GO TO 3000-DELETE-CLAIM.
  9470
  9471     IF  NOT MODIFY-CAP
  9472         MOVE ER-0070            TO EMI-ERROR
  9473         MOVE 'X'                TO ERROR-SWITCH
  9474         MOVE -1                 TO MAINTL
  9475         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9476         GO TO 2000-EXIT.
  9477
  9478     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
  9479     MOVE ZERO                   TO TRLR-SEQ-NO.
  9480
  9481
  9482* EXEC CICS READ UPDATE
  9483*         SET       (ADDRESS OF CLAIM-MASTER)
  9484*         DATASET   (CLMS-FILE-ID)
  9485*         RIDFLD    (MSTR-KEY)
  9486*    END-EXEC.
  9487*    MOVE '&"S        EU         (   #00008838' TO DFHEIV0
  9488     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9489     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9490     MOVE X'2020233030303038383338' TO DFHEIV0(25:11)
  9491     CALL 'kxdfhei1' USING DFHEIV0,
  9492           CLMS-FILE-ID,
  9493           DFHEIV20,
  9494           DFHEIV99,
  9495           MSTR-KEY,
  9496           DFHEIV99,
  9497           DFHEIV99,
  9498           DFHEIV99
  9499     SET ADDRESS OF CLAIM-MASTER TO
  9500         DFHEIV20
  9501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9502
  9503
  9504     if (cl-priority-cd = '8')
  9505        and (pi-processor-id not = 'PEMA' and 'JMS '
  9506             AND 'AMWA')
  9507        MOVE ER-8003             TO EMI-ERROR
  9508        PERFORM 9900-ERROR-FORMAT
  9509                                 THRU 9900-EXIT
  9510        MOVE -1                  TO MAINTL
  9511        GO TO 8110-SEND-DATA
  9512     end-if
  9513
  9514     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
  9515         MOVE ER-0068            TO EMI-ERROR
  9516         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9517         GO TO 2000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 176
* EL131.cbl
  9518
  9519     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
  9520         MOVE ER-0068            TO EMI-ERROR
  9521         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9522         GO TO 2000-EXIT.
  9523
  9524     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  9525         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
  9526
  9527     IF CL-PURGED-DT NOT = LOW-VALUES
  9528         MOVE ER-7691            TO EMI-ERROR
  9529         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9530         GO TO 2000-EXIT.
  9531
  9532     IF CERT-KEY-CHANGED
  9533         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
  9534
  9535     IF SCREEN-ERROR
  9536         MOVE ER-0068            TO EMI-ERROR
  9537         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9538         GO TO 2000-EXIT.
  9539
  9540     IF NINETY-TRLR-UPDATED
  9541         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
  9542
  9543     IF MSTR-KEY-CHANGED
  9544         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
  9545        ELSE
  9546         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
  9547
  9548     IF TRLR-UPDATE-REQUIRED
  9549         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
  9550
  9551 2000-CHECK-CERT.
  9552     IF NOT CERT-UPDATES
  9553         GO TO 2000-EXIT.
  9554
  9555     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9556     MOVE PI-CARRIER             TO CERT-CARRIER.
  9557     MOVE PI-GROUPING            TO CERT-GROUP.
  9558     MOVE PI-STATE               TO CERT-STATE.
  9559     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9560     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9561     MOVE PI-CERT-NO             TO CERT-CERT.
  9562
  9563     IF CERT-ALT-KEY-CHANGED
  9564         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
  9565     ELSE
  9566         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
  9567
  9568 2000-EXIT.
  9569     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 177
* EL131.cbl
  9571 2010-RELEASE-REC.
  9572
  9573* EXEC CICS UNLOCK
  9574*         DATASET  (CLMS-FILE-ID)
  9575*    END-EXEC
  9576*    MOVE '&*                    #   #00008912' TO DFHEIV0
  9577     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9578     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9579     MOVE X'2020233030303038393132' TO DFHEIV0(25:11)
  9580     CALL 'kxdfhei1' USING DFHEIV0,
  9581           CLMS-FILE-ID,
  9582           DFHEIV99
  9583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9584
  9585     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9586     MOVE 'X'                    TO ERROR-SWITCH.
  9587
  9588 2010-EXIT.
  9589     EXIT.
  9590
  9591 2020-NORMAL-UPDATE.
  9592     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9593
  9594     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9595
  9596     IF WS-OPEN-CLOSE-SW = 'Y'
  9597       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9598       IF PI-REC-FOUND-SW = 'Y'
  9599         IF CL-ACTIVITY-CODE = 09
  9600           NEXT SENTENCE
  9601         ELSE
  9602           IF WS-RESET-SW = 'Y'
  9603             IF CL-CLAIM-STATUS = 'C'
  9604               MOVE 07               TO  CL-ACTIVITY-CODE
  9605               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9606               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
  9607             ELSE
  9608               MOVE 08               TO  CL-ACTIVITY-CODE
  9609               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9610               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
  9611
  9612     IF PI-COMPANY-ID = 'CID' or 'AHL'
  9613         MOVE 'Y'                TO CL-YESNOSW
  9614     END-IF.
  9615
  9616
  9617* EXEC CICS HANDLE CONDITION
  9618*         DUPKEY   (2020-EXIT)
  9619*    END-EXEC.
  9620*    MOVE '"$$                   ! + #00008947' TO DFHEIV0
  9621     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9622     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9623     MOVE X'2B20233030303038393437' TO DFHEIV0(25:11)
  9624     CALL 'kxdfhei1' USING DFHEIV0
  9625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9626
  9627
  9628
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 178
* EL131.cbl
  9629* EXEC CICS REWRITE
  9630*         DATASET   (CLMS-FILE-ID)
  9631*         FROM      (CLAIM-MASTER)
  9632*    END-EXEC.
  9633     MOVE LENGTH OF
  9634      CLAIM-MASTER
  9635       TO DFHEIV11
  9636*    MOVE '&& L                  %   #00008951' TO DFHEIV0
  9637     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9638     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9639     MOVE X'2020233030303038393531' TO DFHEIV0(25:11)
  9640     CALL 'kxdfhei1' USING DFHEIV0,
  9641           CLMS-FILE-ID,
  9642           CLAIM-MASTER,
  9643           DFHEIV11,
  9644           DFHEIV99
  9645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9646
  9647
  9648 2020-EXIT.
  9649     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 179
* EL131.cbl
  9651 2030-KEY-UPDATE.
  9652     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
  9653
  9654
  9655* EXEC CICS DELETE
  9656*        DATASET  (CLMS-FILE-ID)
  9657*    END-EXEC.
  9658*    MOVE '&(                    &   #00008962' TO DFHEIV0
  9659     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9660     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9661     MOVE X'2020233030303038393632' TO DFHEIV0(25:11)
  9662     CALL 'kxdfhei1' USING DFHEIV0,
  9663           CLMS-FILE-ID,
  9664           DFHEIV99,
  9665           DFHEIV99,
  9666           DFHEIV99,
  9667           DFHEIV99
  9668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9669
  9670
  9671
  9672* EXEC CICS GETMAIN
  9673*         SET      (ADDRESS OF CLAIM-MASTER)
  9674*         LENGTH   (MSTR-LENGTH)
  9675*         INITIMG  (GETMAIN-SPACE)
  9676*    END-EXEC.
  9677*    MOVE ',"IL                  $   #00008966' TO DFHEIV0
  9678     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9679     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9680     MOVE X'2020233030303038393636' TO DFHEIV0(25:11)
  9681     CALL 'kxdfhei1' USING DFHEIV0,
  9682           DFHEIV20,
  9683           MSTR-LENGTH,
  9684           GETMAIN-SPACE
  9685     SET ADDRESS OF CLAIM-MASTER TO
  9686         DFHEIV20
  9687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9688
  9689
  9690     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
  9691
  9692     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9693
  9694     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9695
  9696     IF WS-OPEN-CLOSE-SW = 'Y'
  9697       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9698         IF PI-REC-FOUND-SW = 'Y'
  9699           IF CL-ACTIVITY-CODE = 09
  9700             NEXT SENTENCE
  9701           ELSE
  9702             IF WS-RESET-SW = 'Y'
  9703               IF CL-CLAIM-STATUS = 'C'
  9704                 MOVE 07             TO  CL-ACTIVITY-CODE
  9705                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
  9706                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
  9707               ELSE
  9708                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 180
* EL131.cbl
  9709                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
  9710                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
  9711
  9712
  9713* EXEC CICS HANDLE CONDITION
  9714*         DUPKEY    (2030-EXIT)
  9715*    END-EXEC.
  9716*    MOVE '"$$                   ! , #00008994' TO DFHEIV0
  9717     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9718     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9719     MOVE X'2C20233030303038393934' TO DFHEIV0(25:11)
  9720     CALL 'kxdfhei1' USING DFHEIV0
  9721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9722
  9723
  9724** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
  9725*    MOVE CL-CERT-NO             TO CL-CCN-A5.
  9726
  9727     IF PI-COMPANY-ID = 'CID' OR 'AHL'
  9728         MOVE 'Y'                TO CL-YESNOSW
  9729     END-IF.
  9730
  9731
  9732* EXEC CICS WRITE
  9733*         DATASET   (CLMS-FILE-ID)
  9734*         RIDFLD    (MSTR-KEY)
  9735*         FROM      (CLAIM-MASTER)
  9736*    END-EXEC.
  9737     MOVE LENGTH OF
  9738      CLAIM-MASTER
  9739       TO DFHEIV11
  9740*    MOVE '&$ L                  ''   #00009005' TO DFHEIV0
  9741     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9742     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9743     MOVE X'2020233030303039303035' TO DFHEIV0(25:11)
  9744     CALL 'kxdfhei1' USING DFHEIV0,
  9745           CLMS-FILE-ID,
  9746           CLAIM-MASTER,
  9747           DFHEIV11,
  9748           MSTR-KEY,
  9749           DFHEIV99,
  9750           DFHEIV99
  9751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9752
  9753
  9754 2030-EXIT.
  9755     EXIT.
  9756
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 181
* EL131.cbl
  9758 2040-NORMAL-UPDATE.
  9759
  9760* EXEC CICS READ UPDATE
  9761*         DATASET  (CERT-FILE-ID)
  9762*         RIDFLD   (CERT-KEY)
  9763*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9764*    END-EXEC.
  9765*    MOVE '&"S        EU         (   #00009016' TO DFHEIV0
  9766     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9767     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9768     MOVE X'2020233030303039303136' TO DFHEIV0(25:11)
  9769     CALL 'kxdfhei1' USING DFHEIV0,
  9770           CERT-FILE-ID,
  9771           DFHEIV20,
  9772           DFHEIV99,
  9773           CERT-KEY,
  9774           DFHEIV99,
  9775           DFHEIV99,
  9776           DFHEIV99
  9777     SET ADDRESS OF CERTIFICATE-MASTER TO
  9778         DFHEIV20
  9779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9780
  9781
  9782     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
  9783
  9784
  9785* EXEC CICS HANDLE CONDITION
  9786*         DUPKEY   (2040-EXIT)
  9787*    END-EXEC.
  9788*    MOVE '"$$                   ! - #00009024' TO DFHEIV0
  9789     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9790     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9791     MOVE X'2D20233030303039303234' TO DFHEIV0(25:11)
  9792     CALL 'kxdfhei1' USING DFHEIV0
  9793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9794
  9795
  9796
  9797* EXEC CICS REWRITE
  9798*         DATASET  (CERT-FILE-ID)
  9799*         FROM     (CERTIFICATE-MASTER)
  9800*    END-EXEC.
  9801     MOVE LENGTH OF
  9802      CERTIFICATE-MASTER
  9803       TO DFHEIV11
  9804*    MOVE '&& L                  %   #00009028' TO DFHEIV0
  9805     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9806     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9807     MOVE X'2020233030303039303238' TO DFHEIV0(25:11)
  9808     CALL 'kxdfhei1' USING DFHEIV0,
  9809           CERT-FILE-ID,
  9810           CERTIFICATE-MASTER,
  9811           DFHEIV11,
  9812           DFHEIV99
  9813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9814
  9815
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 182
* EL131.cbl
  9816 2040-EXIT.
  9817     EXIT.
  9818
  9819 2050-KEY-UPDATE.
  9820
  9821* EXEC CICS READ UPDATE
  9822*         DATASET  (CERT-FILE-ID)
  9823*         RIDFLD   (CERT-KEY)
  9824*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9825*    END-EXEC.
  9826*    MOVE '&"S        EU         (   #00009037' TO DFHEIV0
  9827     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9828     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9829     MOVE X'2020233030303039303337' TO DFHEIV0(25:11)
  9830     CALL 'kxdfhei1' USING DFHEIV0,
  9831           CERT-FILE-ID,
  9832           DFHEIV20,
  9833           DFHEIV99,
  9834           CERT-KEY,
  9835           DFHEIV99,
  9836           DFHEIV99,
  9837           DFHEIV99
  9838     SET ADDRESS OF CERTIFICATE-MASTER TO
  9839         DFHEIV20
  9840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9841
  9842
  9843     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
  9844
  9845
  9846* EXEC CICS DELETE
  9847*         DATASET   (CERT-FILE-ID)
  9848*    END-EXEC.
  9849*    MOVE '&(                    &   #00009045' TO DFHEIV0
  9850     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9851     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9852     MOVE X'2020233030303039303435' TO DFHEIV0(25:11)
  9853     CALL 'kxdfhei1' USING DFHEIV0,
  9854           CERT-FILE-ID,
  9855           DFHEIV99,
  9856           DFHEIV99,
  9857           DFHEIV99,
  9858           DFHEIV99
  9859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9860
  9861
  9862
  9863* EXEC CICS GETMAIN
  9864*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9865*         LENGTH    (CERT-LENGTH)
  9866*         INITIMG   (GETMAIN-SPACE)
  9867*    END-EXEC.
  9868*    MOVE ',"IL                  $   #00009049' TO DFHEIV0
  9869     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9870     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9871     MOVE X'2020233030303039303439' TO DFHEIV0(25:11)
  9872     CALL 'kxdfhei1' USING DFHEIV0,
  9873           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 183
* EL131.cbl
  9874           CERT-LENGTH,
  9875           GETMAIN-SPACE
  9876     SET ADDRESS OF CERTIFICATE-MASTER TO
  9877         DFHEIV20
  9878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9879
  9880
  9881     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
  9882
  9883     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
  9884
  9885
  9886* EXEC CICS HANDLE CONDITION
  9887*         DUPKEY (2050-EXIT)
  9888*    END-EXEC.
  9889*    MOVE '"$$                   ! . #00009059' TO DFHEIV0
  9890     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9891     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9892     MOVE X'2E20233030303039303539' TO DFHEIV0(25:11)
  9893     CALL 'kxdfhei1' USING DFHEIV0
  9894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9895
  9896
  9897
  9898* EXEC CICS WRITE
  9899*         DATASET  (CERT-FILE-ID)
  9900*         RIDFLD   (CERT-KEY)
  9901*         FROM     (CERTIFICATE-MASTER)
  9902*    END-EXEC.
  9903     MOVE LENGTH OF
  9904      CERTIFICATE-MASTER
  9905       TO DFHEIV11
  9906*    MOVE '&$ L                  ''   #00009063' TO DFHEIV0
  9907     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9908     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9909     MOVE X'2020233030303039303633' TO DFHEIV0(25:11)
  9910     CALL 'kxdfhei1' USING DFHEIV0,
  9911           CERT-FILE-ID,
  9912           CERTIFICATE-MASTER,
  9913           DFHEIV11,
  9914           CERT-KEY,
  9915           DFHEIV99,
  9916           DFHEIV99
  9917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9918
  9919
  9920 2050-EXIT.
  9921     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 184
* EL131.cbl
  9923 2060-CHANGE-CERT.
  9924     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9925     MOVE PI-CARRIER             TO CERT-CARRIER.
  9926     MOVE PI-GROUPING            TO CERT-GROUP.
  9927     MOVE PI-STATE               TO CERT-STATE.
  9928     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9929     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9930     MOVE PI-CERT-NO             TO CERT-CERT.
  9931     IF CERTEFFI GREATER THAN LOW-VALUES
  9932         MOVE HOLD-EFF           TO CERT-DATE.
  9933     IF CERTACTI GREATER THAN LOW-VALUES
  9934         MOVE CERTACTI           TO CERT-ACCOUNT.
  9935     IF CERTSTI GREATER THAN LOW-VALUES
  9936         MOVE CERTSTI            TO CERT-STATE.
  9937     IF CERTCARI GREATER THAN LOW-VALUES
  9938         MOVE CERTCARI           TO CERT-CARRIER.
  9939     IF CERTGRPI GREATER THAN LOW-VALUES
  9940         MOVE CERTGRPI           TO CERT-GROUP.
  9941     IF CERTI GREATER THAN LOW-VALUES
  9942         MOVE CERTI              TO CERT-CERT-PRIME.
  9943     IF SUFXI GREATER THAN LOW-VALUES
  9944         MOVE SUFXI              TO CERT-CERT-SUFX.
  9945
  9946
  9947* EXEC CICS HANDLE CONDITION
  9948*         NOTFND   (2060-CERT-NOTFND)
  9949*    END-EXEC.
  9950*    MOVE '"$I                   ! / #00009095' TO DFHEIV0
  9951     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9952     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9953     MOVE X'2F20233030303039303935' TO DFHEIV0(25:11)
  9954     CALL 'kxdfhei1' USING DFHEIV0
  9955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9956
  9957
  9958
  9959* EXEC CICS READ UPDATE
  9960*         DATASET  (CERT-FILE-ID)
  9961*         RIDFLD   (CERT-KEY)
  9962*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9963*    END-EXEC.
  9964*    MOVE '&"S        EU         (   #00009099' TO DFHEIV0
  9965     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9966     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9967     MOVE X'2020233030303039303939' TO DFHEIV0(25:11)
  9968     CALL 'kxdfhei1' USING DFHEIV0,
  9969           CERT-FILE-ID,
  9970           DFHEIV20,
  9971           DFHEIV99,
  9972           CERT-KEY,
  9973           DFHEIV99,
  9974           DFHEIV99,
  9975           DFHEIV99
  9976     SET ADDRESS OF CERTIFICATE-MASTER TO
  9977         DFHEIV20
  9978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9979
  9980
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 185
* EL131.cbl
  9981     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
  9982
  9983     IF CM-CLAIM-INTERFACE-SW = SPACES
  9984        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
  9985
  9986
  9987* EXEC CICS HANDLE CONDITION
  9988*         DUPKEY   (2060-DUPKEY)
  9989*    END-EXEC.
  9990*    MOVE '"$$                   ! 0 #00009110' TO DFHEIV0
  9991     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9992     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9993     MOVE X'3020233030303039313130' TO DFHEIV0(25:11)
  9994     CALL 'kxdfhei1' USING DFHEIV0
  9995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9996
  9997
  9998
  9999* EXEC CICS REWRITE
 10000*         DATASET  (CERT-FILE-ID)
 10001*         FROM     (CERTIFICATE-MASTER)
 10002*    END-EXEC.
 10003     MOVE LENGTH OF
 10004      CERTIFICATE-MASTER
 10005       TO DFHEIV11
 10006*    MOVE '&& L                  %   #00009114' TO DFHEIV0
 10007     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10008     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10009     MOVE X'2020233030303039313134' TO DFHEIV0(25:11)
 10010     CALL 'kxdfhei1' USING DFHEIV0,
 10011           CERT-FILE-ID,
 10012           CERTIFICATE-MASTER,
 10013           DFHEIV11,
 10014           DFHEIV99
 10015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10016
 10017
 10018 2060-DUPKEY.
 10019
 10020     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10021
 10022 2060-CHANGE-TRLR-ACTQ.
 10023     IF SCREEN-ERROR
 10024         GO TO 2060-EXIT.
 10025
 10026     IF CERTI    GREATER LOW-VALUES OR
 10027        SUFXI    GREATER LOW-VALUES OR
 10028        CERTCARI GREATER LOW-VALUES
 10029         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 10030         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 10031
 10032     MOVE SPACES                 TO CERT-KEY-SWITCH
 10033                                    CERT-SWITCH
 10034                                    TRLR-SWITCH
 10035                                    NINETY-TRLR-SWITCH.
 10036     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 10037     GO TO 2060-EXIT.
 10038
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 186
* EL131.cbl
 10039 2060-CERT-NOTFND.
 10040     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10041
 10042     IF WS-REC-FOUND-SW = 'N'
 10043         MOVE ER-0206            TO  EMI-ERROR
 10044         MOVE -1                 TO  MAINTL
 10045         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10046
 10047* EXEC CICS UNLOCK
 10048*            DATASET   (CLMS-FILE-ID)
 10049*        END-EXEC
 10050*    MOVE '&*                    #   #00009147' TO DFHEIV0
 10051     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10052     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10053     MOVE X'2020233030303039313437' TO DFHEIV0(25:11)
 10054     CALL 'kxdfhei1' USING DFHEIV0,
 10055           CLMS-FILE-ID,
 10056           DFHEIV99
 10057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10058         GO TO 8110-SEND-DATA.
 10059
 10060     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 10061
 10062     GO TO 2060-CHANGE-TRLR-ACTQ.
 10063
 10064 2060-EXIT.
 10065     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 187
* EL131.cbl
 10067 2070-CHECK-OLD.
 10068
 10069
 10070* EXEC CICS HANDLE CONDITION
 10071*        NOTFND   (2070-NOT-FOUND)
 10072*    END-EXEC.
 10073*    MOVE '"$I                   ! 1 #00009161' TO DFHEIV0
 10074     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10075     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10076     MOVE X'3120233030303039313631' TO DFHEIV0(25:11)
 10077     CALL 'kxdfhei1' USING DFHEIV0
 10078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10079
 10080
 10081     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10082     MOVE PI-CARRIER             TO CERT-CARRIER.
 10083     MOVE PI-GROUPING            TO CERT-GROUP.
 10084     MOVE PI-STATE               TO CERT-STATE.
 10085     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10086     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10087     MOVE PI-CERT-NO             TO CERT-CERT.
 10088
 10089
 10090* EXEC CICS READ UPDATE
 10091*         DATASET  (CERT-FILE-ID)
 10092*         RIDFLD   (CERT-KEY)
 10093*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10094*    END-EXEC.
 10095*    MOVE '&"S        EU         (   #00009173' TO DFHEIV0
 10096     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10097     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10098     MOVE X'2020233030303039313733' TO DFHEIV0(25:11)
 10099     CALL 'kxdfhei1' USING DFHEIV0,
 10100           CERT-FILE-ID,
 10101           DFHEIV20,
 10102           DFHEIV99,
 10103           CERT-KEY,
 10104           DFHEIV99,
 10105           DFHEIV99,
 10106           DFHEIV99
 10107     SET ADDRESS OF CERTIFICATE-MASTER TO
 10108         DFHEIV20
 10109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10110
 10111
 10112     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 10113     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 10114     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 10115
 10116     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 10117         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 10118
 10119     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10120       AND
 10121        CERT-WAS-CREATED-FOR-CLAIM
 10122         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 10123
 10124* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 188
* EL131.cbl
 10125*             DATASET   (CERT-FILE-ID)
 10126*        END-EXEC
 10127*    MOVE '&(                    &   #00009190' TO DFHEIV0
 10128     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10129     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10130     MOVE X'2020233030303039313930' TO DFHEIV0(25:11)
 10131     CALL 'kxdfhei1' USING DFHEIV0,
 10132           CERT-FILE-ID,
 10133           DFHEIV99,
 10134           DFHEIV99,
 10135           DFHEIV99,
 10136           DFHEIV99
 10137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10138         GO TO 2070-EXIT.
 10139
 10140     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10141         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10142
 10143
 10144* EXEC CICS HANDLE CONDITION
 10145*         DUPKEY   (2070-EXIT)
 10146*    END-EXEC.
 10147*    MOVE '"$$                   ! 2 #00009198' TO DFHEIV0
 10148     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10149     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10150     MOVE X'3220233030303039313938' TO DFHEIV0(25:11)
 10151     CALL 'kxdfhei1' USING DFHEIV0
 10152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10153
 10154
 10155
 10156* EXEC CICS REWRITE
 10157*         DATASET  (CERT-FILE-ID)
 10158*         FROM     (CERTIFICATE-MASTER)
 10159*    END-EXEC.
 10160     MOVE LENGTH OF
 10161      CERTIFICATE-MASTER
 10162       TO DFHEIV11
 10163*    MOVE '&& L                  %   #00009202' TO DFHEIV0
 10164     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10165     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10166     MOVE X'2020233030303039323032' TO DFHEIV0(25:11)
 10167     CALL 'kxdfhei1' USING DFHEIV0,
 10168           CERT-FILE-ID,
 10169           CERTIFICATE-MASTER,
 10170           DFHEIV11,
 10171           DFHEIV99
 10172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10173
 10174
 10175     GO TO 2070-EXIT.
 10176
 10177 2070-NOT-FOUND.
 10178     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 10179
 10180 2070-EXIT.
 10181     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 189
* EL131.cbl
 10183 2080-CREATE-CERT.
 10184
 10185* EXEC CICS GETMAIN
 10186*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10187*         LENGTH    (CERT-LENGTH)
 10188*         INITIMG   (GETMAIN-SPACE)
 10189*    END-EXEC.
 10190*    MOVE ',"IL                  $   #00009216' TO DFHEIV0
 10191     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10192     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10193     MOVE X'2020233030303039323136' TO DFHEIV0(25:11)
 10194     CALL 'kxdfhei1' USING DFHEIV0,
 10195           DFHEIV20,
 10196           CERT-LENGTH,
 10197           GETMAIN-SPACE
 10198     SET ADDRESS OF CERTIFICATE-MASTER TO
 10199         DFHEIV20
 10200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10201
 10202
 10203     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 10204
 10205     IF CERTEFFI GREATER THAN LOW-VALUES
 10206         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 10207                                    DC-BIN-DATE-1
 10208         MOVE '6'                TO DC-OPTION-CODE
 10209         MOVE +1                 TO DC-ELAPSED-MONTHS
 10210         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10211         IF NO-CONVERSION-ERROR
 10212             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 10213
 10214     IF CERTACTI GREATER THAN LOW-VALUES
 10215         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 10216     IF CERTSTI GREATER THAN LOW-VALUES
 10217         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 10218     IF CERTCARI GREATER THAN LOW-VALUES
 10219         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 10220     IF CERTGRPI GREATER THAN LOW-VALUES
 10221         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 10222     IF CERTI GREATER THAN LOW-VALUES
 10223         MOVE CERTI              TO CERT-CERT-PRIME
 10224                                    CM-CERT-PRIME
 10225         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10226
 10227     IF SUFXI GREATER THAN LOW-VALUES
 10228         MOVE SUFXI              TO CERT-CERT-SUFX
 10229                                    CM-CERT-SFX
 10230         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10231
 10232     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10233
 10234     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10235
 10236     MOVE SPACES                 TO CM-ENTRY-BATCH
 10237                                    CM-LF-EXIT-BATCH
 10238                                    CM-AH-EXIT-BATCH
 10239                                    CM-CREDIT-INTERFACE-SW-1
 10240                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 190
* EL131.cbl
 10241
 10242     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10243                               '9' OR 'D' OR 'V'
 10244         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10245
 10246     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10247                               '9' OR 'D' OR 'V'
 10248         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10249
 10250     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 10251                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 10252     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 10253
 10254
 10255* EXEC CICS HANDLE CONDITION
 10256*         DUPKEY (2080-EXIT)
 10257*    END-EXEC.
 10258*    MOVE '"$$                   ! 3 #00009273' TO DFHEIV0
 10259     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10260     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10261     MOVE X'3320233030303039323733' TO DFHEIV0(25:11)
 10262     CALL 'kxdfhei1' USING DFHEIV0
 10263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10264
 10265
 10266
 10267* EXEC CICS WRITE
 10268*         DATASET  (CERT-FILE-ID)
 10269*         RIDFLD   (CERT-KEY)
 10270*         FROM     (CERTIFICATE-MASTER)
 10271*    END-EXEC.
 10272     MOVE LENGTH OF
 10273      CERTIFICATE-MASTER
 10274       TO DFHEIV11
 10275*    MOVE '&$ L                  ''   #00009277' TO DFHEIV0
 10276     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10277     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10278     MOVE X'2020233030303039323737' TO DFHEIV0(25:11)
 10279     CALL 'kxdfhei1' USING DFHEIV0,
 10280           CERT-FILE-ID,
 10281           CERTIFICATE-MASTER,
 10282           DFHEIV11,
 10283           CERT-KEY,
 10284           DFHEIV99,
 10285           DFHEIV99
 10286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10287
 10288
 10289 2080-EXIT.
 10290     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 191
* EL131.cbl
 10292 2100-MOVE-MSTR.
 10293     IF TYPEI GREATER THAN LOW-VALUES
 10294         MOVE TYPEI              TO CL-CLAIM-TYPE.
 10295
 10296     IF STATUSI = LOW-VALUES
 10297         GO TO 2100-NO-STATUS-CHANGE.
 10298
 10299     IF STATUSI = 'OPEN' OR 'O'
 10300         IF CL-CLAIM-STATUS = 'O'
 10301             MOVE SPACES         TO TRLR-SWITCH
 10302                 GO TO 2100-NO-STATUS-CHANGE.
 10303
 10304     IF STATUSI = 'CLOSED' OR 'C'
 10305         IF CL-CLAIM-STATUS = 'C'
 10306             MOVE SPACES         TO TRLR-SWITCH
 10307                 GO TO 2100-NO-STATUS-CHANGE.
 10308
 10309     IF PI-COMPANY-ID = 'DMD'
 10310        IF STATUSI = 'OPEN' OR 'O'
 10311           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 10312              MOVE ZERO       TO STATUSL
 10313              MOVE LOW-VALUES TO STATUSI
 10314              GO TO 2100-NO-STATUS-CHANGE.
 10315
 10316     IF PI-COMPANY-ID = 'DMD'
 10317         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 10318
 10319     MOVE STATUSI                TO CL-CLAIM-STATUS.
 10320
 10321 2100-NO-STATUS-CHANGE.
 10322
 10323     IF CCNOI GREATER THAN LOW-VALUES
 10324         MOVE CCNOI              TO CL-CCN.
 10325
 10326     IF PROCI GREATER THAN LOW-VALUES
 10327         MOVE PROCI              TO CL-PROCESSOR-ID.
 10328
 10329     IF SEXI GREATER THAN LOW-VALUES
 10330         MOVE SEXI               TO CL-INSURED-SEX-CD.
 10331
 10332     IF BIRTHI GREATER THAN LOW-VALUES
 10333         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 10334
 10335     IF SOCIALI GREATER THAN LOW-VALUES
 10336       AND
 10337        SOCIALI = SPACES
 10338         MOVE CL-CERT-STATE      TO CL-SSN-STATE
 10339         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 10340         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 10341     ELSE
 10342         IF SOCIALI GREATER THAN LOW-VALUES
 10343             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 10344
 10345     IF OCCI GREATER THAN LOW-VALUES
 10346         MOVE OCCI               TO CL-INSURED-OCC-CD.
 10347
 10348     IF BENEL GREATER THAN ZERO
 10349         MOVE BENEI              TO CL-BENEFICIARY.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 192
* EL131.cbl
 10350
 10351     IF DIAGI GREATER THAN LOW-VALUES
 10352         MOVE DIAGI              TO WS-DIAGNOSIS.
 10353
 10354     IF PREMTYPI GREATER THAN LOW-VALUES
 10355         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 10356
 10357     IF CAUSEI GREATER THAN LOW-VALUES
 10358         MOVE CAUSEI             TO CL-CAUSE-CD.
 10359
 10360     IF ENDI GREATER THAN LOW-VALUES
 10361         MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 10362
 10363     IF PDTHRUI GREATER THAN LOW-VALUES
 10364        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 10365
 10366     IF PDAMTL GREATER THAN +0
 10367        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 10368
 10369     IF NODAYSI GREATER THAN LOW-VALUES
 10370        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 10371
 10372     IF NOPMTSI GREATER THAN LOW-VALUES
 10373        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 10374
 10375     IF FORMTYPI GREATER THAN LOW-VALUES
 10376        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 10377
 10378     IF INCI GREATER THAN LOW-VALUES
 10379        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 10380
 10381     IF REPI GREATER THAN LOW-VALUES
 10382        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 10383
 10384     IF ADDONDTI GREATER THAN LOW-VALUES
 10385        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 10386
 10387     IF PRICDI GREATER THAN LOW-VALUES
 10388         MOVE PRICDI             TO CL-PRIORITY-CD.
 10389
 10390     IF FILETOI GREATER THAN LOW-VALUES
 10391         MOVE FILETOI            TO CL-FILE-LOCATION.
 10392
 10393     IF SUPVI GREATER THAN LOW-VALUES
 10394         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 10395
 10396     IF MLNAMEI GREATER THAN LOW-VALUES
 10397         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 10398
 10399     IF MFNAMEI GREATER THAN LOW-VALUES
 10400         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 10401
 10402     IF MMINITI GREATER THAN LOW-VALUES
 10403         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 10404
 10405     IF CERTEFFI GREATER THAN LOW-VALUES
 10406         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 10407
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 193
* EL131.cbl
 10408     IF CERTACTI GREATER THAN LOW-VALUES
 10409         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 10410
 10411     IF CERTSTI GREATER THAN LOW-VALUES
 10412         MOVE CERTSTI            TO CL-CERT-STATE.
 10413
 10414     IF CERTCARI GREATER THAN LOW-VALUES
 10415         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 10416                                    CL-CARRIER.
 10417
 10418     IF CERTGRPI GREATER THAN LOW-VALUES
 10419         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 10420
 10421     IF CERTI GREATER THAN LOW-VALUES
 10422         MOVE CERTI              TO CERT-NO-PRIME.
 10423
 10424     IF SUFXI GREATER THAN LOW-VALUES
 10425         MOVE SUFXI              TO CERT-NO-SUFX.
 10426
 10427     MOVE CERT-NO                TO CL-CERT-NO
 10428                                    CL-CERT-NO-A4.
 10429
 10430     IF PI-COMPANY-ID = 'FLA'
 10431          NEXT SENTENCE
 10432     ELSE
 10433         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 10434         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 10435         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 10436         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 10437
 10438     IF TRLR-UPDATE-REQUIRED
 10439        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 10440        MOVE ZEROS              TO TRLR-SEQ-NO
 10441
 10442* EXEC CICS READ
 10443*            DATASET   (TRLR-FILE-ID)
 10444*            RIDFLD    (TRLR-KEY)
 10445*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10446*       END-EXEC
 10447*    MOVE '&"S        E          (   #00009435' TO DFHEIV0
 10448     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10449     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10450     MOVE X'2020233030303039343335' TO DFHEIV0(25:11)
 10451     CALL 'kxdfhei1' USING DFHEIV0,
 10452           TRLR-FILE-ID,
 10453           DFHEIV20,
 10454           DFHEIV99,
 10455           TRLR-KEY,
 10456           DFHEIV99,
 10457           DFHEIV99,
 10458           DFHEIV99
 10459     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10460         DFHEIV20
 10461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10462        IF AT-TRAILER-TYPE = '1'
 10463           MOVE +1 TO MISC-SUB
 10464           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 10465           MISC-SUB GREATER THAN +6 OR
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 194
* EL131.cbl
 10466           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 10467           IF MISC-SUB GREATER THAN +1
 10468              SUBTRACT +1 FROM MISC-SUB
 10469              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10470                 GO TO 2100-BYPASS-LAST-UPDATE.
 10471
 10472     IF TRLR-UPDATE-REQUIRED AND
 10473        CLAIM-IS-OPEN
 10474         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 10475     ELSE
 10476         IF TRLR-UPDATE-REQUIRED AND
 10477            CLAIM-IS-CLOSED
 10478             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 10479             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 10480
 10481 2100-BYPASS-LAST-UPDATE.
 10482     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10483     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 10484
 10485     GO TO 2100-EXIT.
 10486
 10487 2100-BUMP-OPEN-CLOSE-HIST.
 10488     ADD +1                      TO MISC-SUB.
 10489
 10490 2100-EXIT.
 10491     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 195
* EL131.cbl
 10493 2200-MOVE-CERT.
 10494     IF CRTLNMEI GREATER THAN LOW-VALUES
 10495         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 10496
 10497     IF CRTFNMEI GREATER THAN LOW-VALUES
 10498         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 10499         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 10500
 10501     IF CRTINITI GREATER THAN LOW-VALUES
 10502         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 10503
 10504     IF CM-INSURED-INITIALS = SPACES
 10505         MOVE '**'               TO CM-INSURED-INITIALS.
 10506
 10507     IF ISSAGEI GREATER THAN LOW-VALUES
 10508         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 10509
 10510     IF JNTFNMEI GREATER THAN LOW-VALUES
 10511         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 10512
 10513     IF JNTLNMEI GREATER THAN LOW-VALUES
 10514         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 10515
 10516     IF JNTINITI GREATER THAN LOW-VALUES
 10517         MOVE JNTINITI           TO CM-JT-INITIAL.
 10518
 10519     IF JNTAGEI GREATER THAN LOW-VALUES
 10520         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 10521
 10522     IF ADDONDTI GREATER THAN LOW-VALUES
 10523        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 10524
 10525     IF LCVCDI GREATER THAN LOW-VALUES
 10526        IF LCVCDI = SPACES OR ZEROS
 10527           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 10528        ELSE
 10529           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 10530
 10531     IF LCVOTRMI GREATER THAN LOW-VALUES
 10532         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 10533
 10534     IF LCVRATEL GREATER THAN +0
 10535         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 10536
 10537     IF LCVBENEL GREATER THAN +0
 10538         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 10539
 10540     IF LCVFORMI GREATER THAN LOW-VALUES
 10541         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 10542
 10543     IF LCVCNDTI = LOW-VALUES
 10544        GO TO 2210-SET-STATUS.
 10545
 10546     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 10547        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10548        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 10549        GO TO 2210-SET-STATUS.
 10550
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 196
* EL131.cbl
 10551     IF CM-LF-CURRENT-STATUS = '7'
 10552        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 10553        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10554        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10555                                    CM-LF-DEATH-DT
 10556        GO TO 2210-SET-STATUS.
 10557
 10558     IF CM-LF-CURRENT-STATUS = '8'
 10559        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10560        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10561                                    CM-LF-CANCEL-DT.
 10562
 10563 2210-SET-STATUS.
 10564
 10565     IF CM-LF-CURRENT-STATUS = SPACES
 10566         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10567
 10568     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 10569         MOVE '6'                TO DC-OPTION-CODE
 10570         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 10571         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 10572         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10573         IF NO-CONVERSION-ERROR
 10574             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 10575         ELSE
 10576             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 10577     ELSE
 10578         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 10579
 10580 2215-PROCESS-AH-SIDE.
 10581
 10582     IF ACVCDI GREATER THAN LOW-VALUES
 10583        IF ACVCDI = SPACES OR ZEROS
 10584           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 10585        ELSE
 10586           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 10587
 10588     IF ACVOTRMI GREATER THAN LOW-VALUES
 10589         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 10590
 10591     IF ACVRATEL GREATER THAN +0
 10592         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 10593
 10594     IF ACVBENEL GREATER THAN +0
 10595         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
 10596                                    PI-PAYMENT-AMT.
 10597
 10598     IF ACVFORMI GREATER THAN LOW-VALUES
 10599         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 10600
 10601     IF ACVCNDTI = LOW-VALUES
 10602        GO TO 2220-SET-STATUS.
 10603
 10604     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 10605        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10606        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 10607        GO TO 2220-SET-STATUS.
 10608
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 197
* EL131.cbl
 10609     IF CM-AH-CURRENT-STATUS = '6'
 10610        MOVE CM-AH-STATUS-AT-SETTLEMENT
 10611                                 TO CM-AH-CURRENT-STATUS
 10612        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10613        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10614                                    CM-AH-SETTLEMENT-DT
 10615        GO TO 2220-SET-STATUS.
 10616
 10617     IF CM-AH-CURRENT-STATUS = '8'
 10618        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10619        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10620                                    CM-AH-CANCEL-DT.
 10621
 10622 2220-SET-STATUS.
 10623     IF CM-AH-CURRENT-STATUS = SPACES
 10624         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10625
 10626     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 10627         MOVE '6'                TO DC-OPTION-CODE
 10628         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 10629         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 10630         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10631         IF NO-CONVERSION-ERROR
 10632             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 10633         ELSE
 10634             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 10635     ELSE
 10636         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 10637
 10638 2225-FINISH-CERT.
 10639     IF APRL GREATER THAN +0
 10640         MOVE HOLD-APR           TO CM-LOAN-APR.
 10641
 10642     IF PMTFREQI GREATER THAN LOW-VALUES
 10643         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 10644
 10645     IF INDGRPI GREATER THAN LOW-VALUES
 10646         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 10647
 10648     IF LOANNOI GREATER THAN LOW-VALUES
 10649        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 10650
 10651     IF LOANBALL GREATER THAN +0
 10652        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 10653
 10654     IF PREMTYPI GREATER THAN LOW-VALUES
 10655         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 10656
 10657     IF REINCDI GREATER THAN LOW-VALUES
 10658         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10659                                    WS-REIN-1
 10660                                    WS-REIN-2
 10661                                    WS-REIN-3
 10662         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 10663
 10664     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 10665
 10666     MOVE ZEROS                  TO CM-LOAN-TERM
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 198
* EL131.cbl
 10667                                    CM-LIFE-COMM-PCT
 10668                                    CM-AH-COMM-PCT.
 10669
 10670*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 10671*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 10672*         PI-NO-PMTS = ZEROS
 10673*          IF LOANBALL GREATER THAN +0          OR
 10674*             ACVBENEL GREATER THAN +0          OR
 10675*             APRL     GREATER THAN +0          OR
 10676*             LCVRATEL GREATER THAN +0          OR
 10677*             ACVRATEL GREATER THAN +0
 10678*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 10679
 10680 2200-EXIT.
 10681     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 199
* EL131.cbl
 10683 2300-UPDATE-TRLR.
 10684
 10685
 10686* EXEC CICS READ UPDATE
 10687*         DATASET  (TRLR-FILE-ID)
 10688*         RIDFLD   (TRLR-KEY)
 10689*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10690*    END-EXEC.
 10691*    MOVE '&"S        EU         (   #00009663' TO DFHEIV0
 10692     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10693     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10694     MOVE X'2020233030303039363633' TO DFHEIV0(25:11)
 10695     CALL 'kxdfhei1' USING DFHEIV0,
 10696           TRLR-FILE-ID,
 10697           DFHEIV20,
 10698           DFHEIV99,
 10699           TRLR-KEY,
 10700           DFHEIV99,
 10701           DFHEIV99,
 10702           DFHEIV99
 10703     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10704         DFHEIV20
 10705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10706
 10707
 10708     MOVE ZERO                   TO COUNT-2.
 10709
 10710     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 10711         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 10712
 10713     IF NOT UPDATE-MADE
 10714         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 10715
 10716
 10717* EXEC CICS REWRITE
 10718*         DATASET  (TRLR-FILE-ID)
 10719*         FROM     (ACTIVITY-TRAILERS)
 10720*    END-EXEC.
 10721     MOVE LENGTH OF
 10722      ACTIVITY-TRAILERS
 10723       TO DFHEIV11
 10724*    MOVE '&& L                  %   #00009677' TO DFHEIV0
 10725     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10726     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10727     MOVE X'2020233030303039363737' TO DFHEIV0(25:11)
 10728     CALL 'kxdfhei1' USING DFHEIV0,
 10729           TRLR-FILE-ID,
 10730           ACTIVITY-TRAILERS,
 10731           DFHEIV11,
 10732           DFHEIV99
 10733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10734
 10735
 10736 2300-EXIT.
 10737     EXIT.
 10738
 10739 2310-INS-STATUS.
 10740     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 200
* EL131.cbl
 10741     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 10742         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 10743         MOVE 'Y'                TO TRLR-SWITCH.
 10744
 10745 2310-EXIT.
 10746     EXIT.
 10747
 10748 2320-SHIFT-STATUS.
 10749     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 10750        MOVE 6                   TO COUNT-2
 10751        GO TO 2320-EXIT.
 10752
 10753     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 10754     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 10755     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 10756     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 10757     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 10758     MOVE 6       TO COUNT-2.
 10759     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 10760
 10761 2320-EXIT.
 10762     EXIT.
 10763
 10764 2330-ADD-UPDATE.
 10765
 10766     IF COUNT-2 GREATER THAN 1
 10767        COMPUTE MISC-SUB = (COUNT-2 - 1)
 10768        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10769           GO TO 2330-EXIT.
 10770
 10771     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 10772                                   AT-RESERVES-LAST-MAINT-DT
 10773
 10774     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 10775     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 10776     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 10777     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 10778
 10779 2330-EXIT.
 10780     EXIT.
 10781
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 201
* EL131.cbl
 10783 2400-UPDATE-TRLR.
 10784
 10785* EXEC CICS HANDLE CONDITION
 10786*         NOTFND    (2400-TRLR-NOTFND)
 10787*         ENDFILE   (2410-EXIT)
 10788*    END-EXEC.
 10789*    MOVE '"$I''                  ! 4 #00009730' TO DFHEIV0
 10790     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10792     MOVE X'3420233030303039373330' TO DFHEIV0(25:11)
 10793     CALL 'kxdfhei1' USING DFHEIV0
 10794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10795
 10796
 10797
 10798* EXEC CICS STARTBR
 10799*        DATASET (TRLR-FILE-ID)
 10800*        RIDFLD  (TRLR-KEY)
 10801*    END-EXEC.
 10802     MOVE 0
 10803       TO DFHEIV11
 10804*    MOVE '&,         G          &   #00009735' TO DFHEIV0
 10805     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10806     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10807     MOVE X'2020233030303039373335' TO DFHEIV0(25:11)
 10808     CALL 'kxdfhei1' USING DFHEIV0,
 10809           TRLR-FILE-ID,
 10810           TRLR-KEY,
 10811           DFHEIV99,
 10812           DFHEIV11,
 10813           DFHEIV99
 10814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10815
 10816
 10817
 10818* EXEC CICS GETMAIN
 10819*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10820*         LENGTH    (TRLR-LENGTH)
 10821*         INITIMG   (GETMAIN-SPACE)
 10822*    END-EXEC.
 10823*    MOVE ',"IL                  $   #00009740' TO DFHEIV0
 10824     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10825     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10826     MOVE X'2020233030303039373430' TO DFHEIV0(25:11)
 10827     CALL 'kxdfhei1' USING DFHEIV0,
 10828           DFHEIV20,
 10829           TRLR-LENGTH,
 10830           GETMAIN-SPACE
 10831     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10832         DFHEIV20
 10833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10834
 10835
 10836     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 10837
 10838
 10839* EXEC CICS ENDBR
 10840*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 202
* EL131.cbl
 10841*    END-EXEC.
 10842     MOVE 0
 10843       TO DFHEIV11
 10844*    MOVE '&2                    $   #00009748' TO DFHEIV0
 10845     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10846     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10847     MOVE X'2020233030303039373438' TO DFHEIV0(25:11)
 10848     CALL 'kxdfhei1' USING DFHEIV0,
 10849           TRLR-FILE-ID,
 10850           DFHEIV11,
 10851           DFHEIV99
 10852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10853
 10854
 10855     GO TO 2400-EXIT.
 10856
 10857 2400-TRLR-NOTFND.
 10858     MOVE ER-0205                TO EMI-ERROR.
 10859     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10860     MOVE 'X'                    TO ERROR-SWITCH.
 10861
 10862 2400-EXIT.
 10863     EXIT.
 10864
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 203
* EL131.cbl
 10866 2410-CHANGE-TRLR.
 10867
 10868* EXEC CICS READNEXT
 10869*        DATASET (TRLR-FILE-ID)
 10870*        RIDFLD  (TRLR-KEY)
 10871*        INTO    (ACTIVITY-TRAILERS)
 10872*    END-EXEC.
 10873     MOVE LENGTH OF
 10874      ACTIVITY-TRAILERS
 10875       TO DFHEIV12
 10876     MOVE 0
 10877       TO DFHEIV11
 10878*    MOVE '&.IL                  )   #00009764' TO DFHEIV0
 10879     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 10880     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10881     MOVE X'2020233030303039373634' TO DFHEIV0(25:11)
 10882     CALL 'kxdfhei1' USING DFHEIV0,
 10883           TRLR-FILE-ID,
 10884           ACTIVITY-TRAILERS,
 10885           DFHEIV12,
 10886           TRLR-KEY,
 10887           DFHEIV99,
 10888           DFHEIV11,
 10889           DFHEIV99,
 10890           DFHEIV99
 10891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10892
 10893
 10894     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 10895        GO TO 2410-CHANGE-TRLR.
 10896
 10897     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 10898                                    CHECK-KEY.
 10899
 10900     IF CHECK-KEY NOT = MSTR-KEY
 10901         GO TO 2410-EXIT.
 10902
 10903
 10904* EXEC CICS ENDBR
 10905*        DATASET (TRLR-FILE-ID)
 10906*    END-EXEC.
 10907     MOVE 0
 10908       TO DFHEIV11
 10909*    MOVE '&2                    $   #00009779' TO DFHEIV0
 10910     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10911     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10912     MOVE X'2020233030303039373739' TO DFHEIV0(25:11)
 10913     CALL 'kxdfhei1' USING DFHEIV0,
 10914           TRLR-FILE-ID,
 10915           DFHEIV11,
 10916           DFHEIV99
 10917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10918
 10919
 10920
 10921* EXEC CICS READ UPDATE
 10922*        DATASET (TRLR-FILE-ID)
 10923*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 204
* EL131.cbl
 10924*        INTO    (ACTIVITY-TRAILERS)
 10925*    END-EXEC.
 10926     MOVE LENGTH OF
 10927      ACTIVITY-TRAILERS
 10928       TO DFHEIV11
 10929*    MOVE '&"IL       EU         (   #00009783' TO DFHEIV0
 10930     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10931     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10932     MOVE X'2020233030303039373833' TO DFHEIV0(25:11)
 10933     CALL 'kxdfhei1' USING DFHEIV0,
 10934           TRLR-FILE-ID,
 10935           ACTIVITY-TRAILERS,
 10936           DFHEIV11,
 10937           TRLR-KEY,
 10938           DFHEIV99,
 10939           DFHEIV99,
 10940           DFHEIV99
 10941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10942
 10943
 10944
 10945* EXEC CICS DELETE
 10946*        DATASET (TRLR-FILE-ID)
 10947*    END-EXEC.
 10948*    MOVE '&(                    &   #00009789' TO DFHEIV0
 10949     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10950     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10951     MOVE X'2020233030303039373839' TO DFHEIV0(25:11)
 10952     CALL 'kxdfhei1' USING DFHEIV0,
 10953           TRLR-FILE-ID,
 10954           DFHEIV99,
 10955           DFHEIV99,
 10956           DFHEIV99,
 10957           DFHEIV99
 10958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10959
 10960
 10961     IF AT-SEQUENCE-NO = ZERO AND
 10962        TRLR-UPDATE-REQUIRED
 10963         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 10964
 10965     IF CERTI GREATER THAN LOW-VALUES
 10966        MOVE CERTI               TO AT-CERT-PRIME.
 10967
 10968     IF SUFXI GREATER THAN LOW-VALUES
 10969        MOVE SUFXI               TO AT-CERT-SFX.
 10970
 10971     IF CERTCARI GREATER THAN LOW-VALUES
 10972        MOVE CERTCARI            TO AT-CARRIER.
 10973
 10974     IF PAYMENT-TR
 10975        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 10976           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 10977              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 10978
 10979     IF CORRESPONDENCE-TR
 10980        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 10981           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 205
* EL131.cbl
 10982
 10983
 10984* EXEC CICS WRITE
 10985*         DATASET  (TRLR-FILE-ID)
 10986*         RIDFLD   (AT-CONTROL-PRIMARY)
 10987*         FROM     (ACTIVITY-TRAILERS)
 10988*    END-EXEC.
 10989     MOVE LENGTH OF
 10990      ACTIVITY-TRAILERS
 10991       TO DFHEIV11
 10992*    MOVE '&$ L                  ''   #00009815' TO DFHEIV0
 10993     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10994     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10995     MOVE X'2020233030303039383135' TO DFHEIV0(25:11)
 10996     CALL 'kxdfhei1' USING DFHEIV0,
 10997           TRLR-FILE-ID,
 10998           ACTIVITY-TRAILERS,
 10999           DFHEIV11,
 11000           AT-CONTROL-PRIMARY,
 11001           DFHEIV99,
 11002           DFHEIV99
 11003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11004
 11005
 11006
 11007* EXEC CICS STARTBR
 11008*         DATASET  (TRLR-FILE-ID)
 11009*         RIDFLD   (TRLR-KEY)
 11010*    END-EXEC.
 11011     MOVE 0
 11012       TO DFHEIV11
 11013*    MOVE '&,         G          &   #00009821' TO DFHEIV0
 11014     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11015     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11016     MOVE X'2020233030303039383231' TO DFHEIV0(25:11)
 11017     CALL 'kxdfhei1' USING DFHEIV0,
 11018           TRLR-FILE-ID,
 11019           TRLR-KEY,
 11020           DFHEIV99,
 11021           DFHEIV11,
 11022           DFHEIV99
 11023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11024
 11025
 11026     GO TO 2410-CHANGE-TRLR.
 11027
 11028 2410-EXIT.
 11029     EXIT.
 11030
 11031 2420-UPDATE-TRLR.
 11032     MOVE ZERO TO COUNT-2.
 11033     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11034         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11035
 11036     IF NOT UPDATE-MADE
 11037         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11038
 11039 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 206
* EL131.cbl
 11040     EXIT.
 11041
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 207
* EL131.cbl
 11043 2425-UPDATE-NINETY-TRLR.
 11044
 11045     MOVE +90                    TO TRLR-SEQ-NO.
 11046
 11047
 11048* EXEC CICS HANDLE CONDITION
 11049*         NOTFND    (2425-NINETY-NOTFND)
 11050*         ENDFILE   (2425-NINETY-NOTFND)
 11051*    END-EXEC.
 11052*    MOVE '"$I''                  ! 5 #00009847' TO DFHEIV0
 11053     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11054     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11055     MOVE X'3520233030303039383437' TO DFHEIV0(25:11)
 11056     CALL 'kxdfhei1' USING DFHEIV0
 11057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11058
 11059
 11060
 11061* EXEC CICS READ UPDATE
 11062*        DATASET (TRLR-FILE-ID)
 11063*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11064*        RIDFLD  (TRLR-KEY)
 11065*    END-EXEC.
 11066*    MOVE '&"S        EU         (   #00009852' TO DFHEIV0
 11067     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11068     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11069     MOVE X'2020233030303039383532' TO DFHEIV0(25:11)
 11070     CALL 'kxdfhei1' USING DFHEIV0,
 11071           TRLR-FILE-ID,
 11072           DFHEIV20,
 11073           DFHEIV99,
 11074           TRLR-KEY,
 11075           DFHEIV99,
 11076           DFHEIV99,
 11077           DFHEIV99
 11078     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11079         DFHEIV20
 11080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11081
 11082
 11083     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
 11084
 11085     MOVE DIAGI                 TO AT-INFO-LINE-1.
 11086
 11087
 11088* EXEC CICS REWRITE
 11089*        DATASET (TRLR-FILE-ID)
 11090*        FROM    (ACTIVITY-TRAILERS)
 11091*    END-EXEC.
 11092     MOVE LENGTH OF
 11093      ACTIVITY-TRAILERS
 11094       TO DFHEIV11
 11095*    MOVE '&& L                  %   #00009862' TO DFHEIV0
 11096     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11097     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11098     MOVE X'2020233030303039383632' TO DFHEIV0(25:11)
 11099     CALL 'kxdfhei1' USING DFHEIV0,
 11100           TRLR-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 208
* EL131.cbl
 11101           ACTIVITY-TRAILERS,
 11102           DFHEIV11,
 11103           DFHEIV99
 11104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11105
 11106
 11107     IF DIAGI NOT = WS-DIAGNOSIS
 11108         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 11109         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 11110         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11111
 11112     GO TO 2425-EXIT.
 11113
 11114 2425-NINETY-NOTFND.
 11115
 11116
 11117* EXEC CICS GETMAIN
 11118*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11119*         LENGTH    (TRLR-LENGTH)
 11120*         INITIMG   (GETMAIN-SPACE)
 11121*    END-EXEC.
 11122*    MOVE ',"IL                  $   #00009876' TO DFHEIV0
 11123     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11124     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11125     MOVE X'2020233030303039383736' TO DFHEIV0(25:11)
 11126     CALL 'kxdfhei1' USING DFHEIV0,
 11127           DFHEIV20,
 11128           TRLR-LENGTH,
 11129           GETMAIN-SPACE
 11130     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11131         DFHEIV20
 11132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11133
 11134
 11135     MOVE +90                  TO TRLR-SEQ-NO.
 11136     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 11137
 11138     MOVE 'AT'                 TO AT-RECORD-ID
 11139     MOVE '6'                  TO AT-TRAILER-TYPE
 11140     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 11141                                  AT-GEN-INFO-LAST-MAINT-DT
 11142     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 11143                                  AT-GEN-INFO-LAST-UPDATED-BY
 11144     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 11145     MOVE DIAGI                TO AT-INFO-LINE-1.
 11146
 11147
 11148* EXEC CICS WRITE
 11149*        DATASET (TRLR-FILE-ID)
 11150*        FROM    (ACTIVITY-TRAILERS)
 11151*        RIDFLD  (TRLR-KEY)
 11152*    END-EXEC.
 11153     MOVE LENGTH OF
 11154      ACTIVITY-TRAILERS
 11155       TO DFHEIV11
 11156*    MOVE '&$ L                  ''   #00009894' TO DFHEIV0
 11157     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11158     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 209
* EL131.cbl
 11159     MOVE X'2020233030303039383934' TO DFHEIV0(25:11)
 11160     CALL 'kxdfhei1' USING DFHEIV0,
 11161           TRLR-FILE-ID,
 11162           ACTIVITY-TRAILERS,
 11163           DFHEIV11,
 11164           TRLR-KEY,
 11165           DFHEIV99,
 11166           DFHEIV99
 11167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11168
 11169
 11170 2425-EXIT.
 11171     EXIT.
 11172
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 210
* EL131.cbl
 11174 2430-UPDATE-ACTQ.
 11175
 11176* EXEC CICS HANDLE CONDITION
 11177*         NOTFND    (2430-EXIT)
 11178*         ENDFILE   (2440-EXIT)
 11179*    END-EXEC.
 11180*    MOVE '"$I''                  ! 6 #00009905' TO DFHEIV0
 11181     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11183     MOVE X'3620233030303039393035' TO DFHEIV0(25:11)
 11184     CALL 'kxdfhei1' USING DFHEIV0
 11185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11186
 11187
 11188
 11189* EXEC CICS STARTBR
 11190*         DATASET  (ACTQ-FILE-ID)
 11191*         RIDFLD   (ACTQ-KEY)
 11192*    END-EXEC.
 11193     MOVE 0
 11194       TO DFHEIV11
 11195*    MOVE '&,         G          &   #00009910' TO DFHEIV0
 11196     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11197     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11198     MOVE X'2020233030303039393130' TO DFHEIV0(25:11)
 11199     CALL 'kxdfhei1' USING DFHEIV0,
 11200           ACTQ-FILE-ID,
 11201           ACTQ-KEY,
 11202           DFHEIV99,
 11203           DFHEIV11,
 11204           DFHEIV99
 11205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11206
 11207
 11208
 11209* EXEC CICS GETMAIN
 11210*         SET      (ADDRESS OF ACTIVITY-QUE)
 11211*         LENGTH   (ACTQ-LENGTH)
 11212*         INITIMG  (GETMAIN-SPACE)
 11213*    END-EXEC.
 11214*    MOVE ',"IL                  $   #00009915' TO DFHEIV0
 11215     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11216     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11217     MOVE X'2020233030303039393135' TO DFHEIV0(25:11)
 11218     CALL 'kxdfhei1' USING DFHEIV0,
 11219           DFHEIV20,
 11220           ACTQ-LENGTH,
 11221           GETMAIN-SPACE
 11222     SET ADDRESS OF ACTIVITY-QUE TO
 11223         DFHEIV20
 11224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11225
 11226
 11227     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 11228
 11229 2430-EXIT.
 11230     EXIT.
 11231
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 211
* EL131.cbl
 11232 2440-CHANGE-ACTQ.
 11233
 11234
 11235* EXEC CICS READNEXT
 11236*         DATASET  (ACTQ-FILE-ID)
 11237*         RIDFLD   (ACTQ-KEY)
 11238*         INTO     (ACTIVITY-QUE)
 11239*    END-EXEC.
 11240     MOVE LENGTH OF
 11241      ACTIVITY-QUE
 11242       TO DFHEIV12
 11243     MOVE 0
 11244       TO DFHEIV11
 11245*    MOVE '&.IL                  )   #00009928' TO DFHEIV0
 11246     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11247     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11248     MOVE X'2020233030303039393238' TO DFHEIV0(25:11)
 11249     CALL 'kxdfhei1' USING DFHEIV0,
 11250           ACTQ-FILE-ID,
 11251           ACTIVITY-QUE,
 11252           DFHEIV12,
 11253           ACTQ-KEY,
 11254           DFHEIV99,
 11255           DFHEIV11,
 11256           DFHEIV99,
 11257           DFHEIV99
 11258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11259
 11260
 11261
 11262* EXEC CICS ENDBR
 11263*         DATASET (ACTQ-FILE-ID)
 11264*    END-EXEC.
 11265     MOVE 0
 11266       TO DFHEIV11
 11267*    MOVE '&2                    $   #00009934' TO DFHEIV0
 11268     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11269     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11270     MOVE X'2020233030303039393334' TO DFHEIV0(25:11)
 11271     CALL 'kxdfhei1' USING DFHEIV0,
 11272           ACTQ-FILE-ID,
 11273           DFHEIV11,
 11274           DFHEIV99
 11275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11276
 11277
 11278     IF ACTQ-KEY NOT = MSTR-KEY
 11279         GO TO 2440-EXIT.
 11280
 11281
 11282* EXEC CICS READ UPDATE
 11283*         DATASET  (ACTQ-FILE-ID)
 11284*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11285*         SET      (ADDRESS OF ACTIVITY-QUE)
 11286*    END-EXEC.
 11287*    MOVE '&"S        EU         (   #00009941' TO DFHEIV0
 11288     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11289     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 212
* EL131.cbl
 11290     MOVE X'2020233030303039393431' TO DFHEIV0(25:11)
 11291     CALL 'kxdfhei1' USING DFHEIV0,
 11292           ACTQ-FILE-ID,
 11293           DFHEIV20,
 11294           DFHEIV99,
 11295           AQ-CONTROL-PRIMARY,
 11296           DFHEIV99,
 11297           DFHEIV99,
 11298           DFHEIV99
 11299     SET ADDRESS OF ACTIVITY-QUE TO
 11300         DFHEIV20
 11301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11302
 11303
 11304     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 11305
 11306
 11307* EXEC CICS DELETE
 11308*         DATASET (ACTQ-FILE-ID)
 11309*    END-EXEC.
 11310*    MOVE '&(                    &   #00009949' TO DFHEIV0
 11311     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11312     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11313     MOVE X'2020233030303039393439' TO DFHEIV0(25:11)
 11314     CALL 'kxdfhei1' USING DFHEIV0,
 11315           ACTQ-FILE-ID,
 11316           DFHEIV99,
 11317           DFHEIV99,
 11318           DFHEIV99,
 11319           DFHEIV99
 11320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11321
 11322
 11323     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 11324     IF CERTI GREATER THAN LOW-VALUES
 11325        MOVE CERTI               TO AQ-CERT-PRIME.
 11326     IF SUFXI GREATER THAN LOW-VALUES
 11327        MOVE SUFXI               TO AQ-CERT-SFX.
 11328     IF CERTCARI GREATER THAN LOW-VALUES
 11329        MOVE CERTCARI            TO AQ-CARRIER.
 11330
 11331
 11332* EXEC CICS HANDLE CONDITION
 11333*         DUPREC   (2440-EXIT)
 11334*    END-EXEC.
 11335*    MOVE '"$%                   ! 7 #00009961' TO DFHEIV0
 11336     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11337     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11338     MOVE X'3720233030303039393631' TO DFHEIV0(25:11)
 11339     CALL 'kxdfhei1' USING DFHEIV0
 11340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11341
 11342
 11343
 11344* EXEC CICS WRITE
 11345*         DATASET  (ACTQ-FILE-ID)
 11346*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11347*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 213
* EL131.cbl
 11348*    END-EXEC.
 11349     MOVE LENGTH OF
 11350      ACTIVITY-QUE
 11351       TO DFHEIV11
 11352*    MOVE '&$ L                  ''   #00009965' TO DFHEIV0
 11353     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11354     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11355     MOVE X'2020233030303039393635' TO DFHEIV0(25:11)
 11356     CALL 'kxdfhei1' USING DFHEIV0,
 11357           ACTQ-FILE-ID,
 11358           ACTIVITY-QUE,
 11359           DFHEIV11,
 11360           AQ-CONTROL-PRIMARY,
 11361           DFHEIV99,
 11362           DFHEIV99
 11363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11364
 11365
 11366 2440-EXIT.
 11367     EXIT.
 11368
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 214
* EL131.cbl
 11370 2460-UPDATE-CHECKQ.
 11371
 11372* EXEC CICS HANDLE CONDITION
 11373*         NOTFND   (2460-EXIT)
 11374*    END-EXEC.
 11375*    MOVE '"$I                   ! 8 #00009976' TO DFHEIV0
 11376     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11377     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11378     MOVE X'3820233030303039393736' TO DFHEIV0(25:11)
 11379     CALL 'kxdfhei1' USING DFHEIV0
 11380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11381
 11382
 11383     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 11384     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 11385     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 11386
 11387
 11388* EXEC CICS READ UPDATE
 11389*         DATASET   (CHKQ-FILE-ID)
 11390*         RIDFLD    (CHKQ-KEY)
 11391*         SET       (ADDRESS OF CHECK-QUE)
 11392*    END-EXEC.
 11393*    MOVE '&"S        EU         (   #00009984' TO DFHEIV0
 11394     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11395     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11396     MOVE X'2020233030303039393834' TO DFHEIV0(25:11)
 11397     CALL 'kxdfhei1' USING DFHEIV0,
 11398           CHKQ-FILE-ID,
 11399           DFHEIV20,
 11400           DFHEIV99,
 11401           CHKQ-KEY,
 11402           DFHEIV99,
 11403           DFHEIV99,
 11404           DFHEIV99
 11405     SET ADDRESS OF CHECK-QUE TO
 11406         DFHEIV20
 11407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11408
 11409
 11410     IF CERTI GREATER THAN LOW-VALUES
 11411        MOVE CERTI               TO CQ-CERT-PRIME.
 11412     IF SUFXI GREATER THAN LOW-VALUES
 11413        MOVE SUFXI               TO CQ-CERT-SFX.
 11414     IF CERTCARI GREATER THAN LOW-VALUES
 11415        MOVE CERTCARI            TO CQ-CARRIER.
 11416
 11417
 11418* EXEC CICS REWRITE
 11419*         DATASET  (CHKQ-FILE-ID)
 11420*         FROM     (CHECK-QUE)
 11421*    END-EXEC.
 11422     MOVE LENGTH OF
 11423      CHECK-QUE
 11424       TO DFHEIV11
 11425*    MOVE '&& L                  %   #00009997' TO DFHEIV0
 11426     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11427     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 215
* EL131.cbl
 11428     MOVE X'2020233030303039393937' TO DFHEIV0(25:11)
 11429     CALL 'kxdfhei1' USING DFHEIV0,
 11430           CHKQ-FILE-ID,
 11431           CHECK-QUE,
 11432           DFHEIV11,
 11433           DFHEIV99
 11434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11435
 11436
 11437 2460-EXIT.
 11438     EXIT.
 11439
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 216
* EL131.cbl
 11441 2475-UPDATE-LETTER.
 11442
 11443* EXEC CICS HANDLE CONDITION
 11444*         NOTFND   (2475-EXIT)
 11445*    END-EXEC.
 11446*    MOVE '"$I                   ! 9 #00010007' TO DFHEIV0
 11447     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11449     MOVE X'3920233030303130303037' TO DFHEIV0(25:11)
 11450     CALL 'kxdfhei1' USING DFHEIV0
 11451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11452
 11453
 11454     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 11455     MOVE '1'                    TO ARCH-RECORD-TYPE.
 11456     MOVE ZEROS                  TO ARCH-SEQ-NO.
 11457     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 11458
 11459
 11460* EXEC CICS READ UPDATE
 11461*         DATASET   (ARCH-FILE-ID)
 11462*         RIDFLD    (ARCH-KEY)
 11463*         SET       (ADDRESS OF LETTER-ARCHIVE)
 11464*    END-EXEC.
 11465*    MOVE '&"S        EU         (   #00010016' TO DFHEIV0
 11466     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11467     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11468     MOVE X'2020233030303130303136' TO DFHEIV0(25:11)
 11469     CALL 'kxdfhei1' USING DFHEIV0,
 11470           ARCH-FILE-ID,
 11471           DFHEIV20,
 11472           DFHEIV99,
 11473           ARCH-KEY,
 11474           DFHEIV99,
 11475           DFHEIV99,
 11476           DFHEIV99
 11477     SET ADDRESS OF LETTER-ARCHIVE TO
 11478         DFHEIV20
 11479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11480
 11481
 11482* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 11483* TO THIS MASTER-KEY INFORMATION.
 11484
 11485     IF LA-CARRIER  = CARRIER-CODE AND
 11486        LA-CLAIM-NO = CLAIM-NO     AND
 11487        LA-CERT-NO  = CERT-NO
 11488        NEXT SENTENCE
 11489     ELSE
 11490        GO TO 2475-UNLOCK.
 11491
 11492     IF CERTI GREATER THAN LOW-VALUES
 11493        MOVE CERTI               TO LA-CERT-PRIME.
 11494     IF SUFXI GREATER THAN LOW-VALUES
 11495        MOVE SUFXI               TO LA-CERT-SFX.
 11496     IF CERTCARI GREATER THAN LOW-VALUES
 11497        MOVE CERTCARI            TO LA-CARRIER.
 11498
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 217
* EL131.cbl
 11499
 11500* EXEC CICS REWRITE
 11501*         DATASET  (ARCH-FILE-ID)
 11502*         FROM     (LETTER-ARCHIVE)
 11503*    END-EXEC.
 11504     MOVE LENGTH OF
 11505      LETTER-ARCHIVE
 11506       TO DFHEIV11
 11507*    MOVE '&& L                  %   #00010039' TO DFHEIV0
 11508     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11509     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11510     MOVE X'2020233030303130303339' TO DFHEIV0(25:11)
 11511     CALL 'kxdfhei1' USING DFHEIV0,
 11512           ARCH-FILE-ID,
 11513           LETTER-ARCHIVE,
 11514           DFHEIV11,
 11515           DFHEIV99
 11516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11517
 11518
 11519     GO TO 2475-EXIT.
 11520
 11521 2475-UNLOCK.
 11522
 11523* EXEC CICS UNLOCK
 11524*         DATASET  (ARCH-FILE-ID)
 11525*    END-EXEC.
 11526*    MOVE '&*                    #   #00010047' TO DFHEIV0
 11527     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11528     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11529     MOVE X'2020233030303130303437' TO DFHEIV0(25:11)
 11530     CALL 'kxdfhei1' USING DFHEIV0,
 11531           ARCH-FILE-ID,
 11532           DFHEIV99
 11533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11534
 11535
 11536 2475-EXIT.
 11537     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 218
* EL131.cbl
 11539 2600-CREATE-MAINT-NOTE.
 11540     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 11541     MOVE '1'                    TO CNTL-REC-TYPE.
 11542     MOVE SPACES                 TO CNTL-PROC-ID.
 11543     MOVE ZERO                   TO CNTL-SEQ-NO.
 11544
 11545
 11546* EXEC CICS READ
 11547*         SET        (ADDRESS OF CONTROL-FILE)
 11548*         DATASET    ('ELCNTL')
 11549*         RIDFLD     (CNTL-KEY)
 11550*    END-EXEC.
 11551     MOVE 'ELCNTL' TO DFHEIV1
 11552*    MOVE '&"S        E          (   #00010060' TO DFHEIV0
 11553     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11555     MOVE X'2020233030303130303630' TO DFHEIV0(25:11)
 11556     CALL 'kxdfhei1' USING DFHEIV0,
 11557           DFHEIV1,
 11558           DFHEIV20,
 11559           DFHEIV99,
 11560           CNTL-KEY,
 11561           DFHEIV99,
 11562           DFHEIV99,
 11563           DFHEIV99
 11564     SET ADDRESS OF CONTROL-FILE TO
 11565         DFHEIV20
 11566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11567
 11568
 11569     IF CO-NO-USE-AUDIT-CHANGES
 11570         GO TO 2600-EXIT.
 11571
 11572     IF PROCL GREATER ZERO
 11573     IF PROCI NOT = LOW-VALUES
 11574     IF PROCI NOT = CL-PROCESSOR-ID
 11575         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 11576         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 11577         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11578
 11579     IF SEXL GREATER ZERO
 11580     IF SEXI NOT = LOW-VALUES
 11581     IF SEXI NOT = CL-INSURED-SEX-CD
 11582         MOVE 'SEX'                TO SPLIT-INFO-DESC
 11583         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 11584         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11585
 11586     IF BIRTHL GREATER ZERO
 11587     IF HOLD-BIRTH NOT = LOW-VALUES
 11588     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 11589         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 11590         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 11591         MOVE SPACES               TO DC-OPTION-CODE
 11592         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11593         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11594         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11595
 11596     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 219
* EL131.cbl
 11597     IF SOCIALI NOT = LOW-VALUES
 11598     IF SOCIALI NOT = CL-SOC-SEC-NO
 11599         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 11600         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 11601         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11602
 11603     IF OCCL GREATER ZERO
 11604     IF OCCI NOT = LOW-VALUES
 11605     IF OCCI NOT = CL-INSURED-OCC-CD
 11606         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 11607         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 11608         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11609
 11610     IF BENEL GREATER ZERO
 11611     IF BENEI NOT = LOW-VALUES
 11612     IF BENEI NOT = CL-BENEFICIARY
 11613         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 11614         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 11615         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11616
 11617     IF PREMTYPL GREATER ZERO
 11618     IF PREMTYPI NOT = LOW-VALUES
 11619     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 11620         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 11621         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 11622         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11623
 11624     IF CAUSEL GREATER ZERO
 11625     IF CAUSEI NOT = LOW-VALUES
 11626     IF CAUSEI NOT = CL-CAUSE-CD
 11627         MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 11628         MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 11629         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11630
 11631     IF ENDL GREATER ZERO
 11632     IF HOLD-END NOT = LOW-VALUES
 11633     IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 11634         MOVE 'END DT'             TO SPLIT-INFO-DESC
 11635         MOVE CL-EST-END-OF-DISAB-DT
 11636                                   TO DC-BIN-DATE-1
 11637         MOVE SPACES               TO DC-OPTION-CODE
 11638         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11639         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11640         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11641
 11642     IF PDTHRUL GREATER ZERO
 11643     IF HOLD-PDTHRU NOT = LOW-VALUES
 11644     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 11645         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 11646         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 11647         MOVE SPACES               TO DC-OPTION-CODE
 11648         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11649         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11650         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11651
 11652     IF PDAMTL GREATER ZERO
 11653     IF HOLD-PDAMT NOT = ZEROS
 11654     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 220
* EL131.cbl
 11655         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 11656         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 11657         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 11658         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11659
 11660     IF NODAYSL GREATER ZERO
 11661     IF HOLD-NODAYS NOT = ZEROS
 11662     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 11663         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 11664         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 11665         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 11666         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11667
 11668     IF NOPMTSL GREATER ZERO
 11669     IF HOLD-NOPMTS NOT = ZEROS
 11670     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 11671         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 11672         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 11673         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 11674         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11675
 11676     IF FORMTYPL GREATER ZERO
 11677     IF FORMTYPI NOT = LOW-VALUES
 11678     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 11679         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 11680         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 11681         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11682
 11683     IF REPL GREATER ZERO
 11684     IF HOLD-REPORTED NOT = LOW-VALUES
 11685     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 11686         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 11687         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 11688         MOVE SPACES               TO DC-OPTION-CODE
 11689         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11690         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11691         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11692
 11693     IF ADDONDTL GREATER ZERO
 11694     IF HOLD-ADDON NOT = LOW-VALUES
 11695     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 11696         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 11697         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 11698         MOVE SPACES               TO DC-OPTION-CODE
 11699         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11700         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11701         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11702
 11703     IF PRICDL GREATER ZERO
 11704     IF PRICDI NOT = LOW-VALUES
 11705     IF PRICDI NOT = CL-PRIORITY-CD
 11706         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 11707         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 11708         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11709
 11710     IF FILETOL GREATER ZERO
 11711     IF FILETOI NOT = LOW-VALUES
 11712     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 221
* EL131.cbl
 11713         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 11714         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 11715         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11716
 11717     IF SUPVL GREATER ZERO
 11718     IF SUPVI NOT = LOW-VALUES
 11719     IF SUPVI NOT = CL-SUPV-ATTN-CD
 11720         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 11721         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 11722         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11723
 11724     IF MLNAMEL GREATER ZERO
 11725     IF MLNAMEI NOT = LOW-VALUES
 11726     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 11727         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 11728         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 11729         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11730
 11731     IF MFNAMEL GREATER ZERO
 11732     IF MFNAMEI NOT = LOW-VALUES
 11733     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 11734         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 11735         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 11736         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11737
 11738     IF MMINITL GREATER ZERO
 11739     IF MMINITI NOT = LOW-VALUES
 11740     IF MMINITI NOT = CL-INSURED-MID-INIT
 11741         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 11742         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 11743         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11744
 11745     IF CERTEFFL GREATER ZERO
 11746     IF HOLD-EFF NOT = LOW-VALUES
 11747     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 11748         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 11749         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 11750         MOVE SPACES               TO DC-OPTION-CODE
 11751         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11752         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11753         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11754
 11755     IF CERTACTL GREATER ZERO
 11756     IF CERTACTI NOT = LOW-VALUES
 11757     IF CERTACTI NOT = CL-CERT-ACCOUNT
 11758         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 11759         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 11760         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11761
 11762     IF CERTSTL GREATER ZERO
 11763     IF CERTSTI NOT = LOW-VALUES
 11764     IF CERTSTI NOT = CL-CERT-STATE
 11765         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 11766         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 11767         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11768
 11769     IF CERTCARL GREATER ZERO
 11770     IF CERTCARI NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 222
* EL131.cbl
 11771     IF CERTCARI NOT = CL-CERT-CARRIER
 11772         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 11773         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 11774         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11775
 11776     IF CERTGRPL GREATER ZERO
 11777     IF CERTGRPI NOT = LOW-VALUES
 11778     IF CERTGRPI NOT = CL-CERT-GROUPING
 11779         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 11780         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 11781         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11782
 11783     IF CERTL GREATER ZERO OR
 11784        SUFXL GREATER ZERO
 11785     IF (CERTI NOT = LOW-VALUES AND
 11786                     CL-CERT-PRIME)
 11787                OR
 11788        (SUFXI NOT = LOW-VALUES AND
 11789                     CL-CERT-SFX)
 11790         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 11791         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 11792         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11793
 11794 2600-EXIT.
 11795      EXIT.
 11796
 11797 2650-WRITE-MAINT-NOTE.
 11798
 11799* EXEC CICS GETMAIN
 11800*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11801*         LENGTH   (TRLR-LENGTH)
 11802*         INITIMG  (GETMAIN-SPACE)
 11803*    END-EXEC.
 11804*    MOVE ',"IL                  $   #00010295' TO DFHEIV0
 11805     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11806     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11807     MOVE X'2020233030303130323935' TO DFHEIV0(25:11)
 11808     CALL 'kxdfhei1' USING DFHEIV0,
 11809           DFHEIV20,
 11810           TRLR-LENGTH,
 11811           GETMAIN-SPACE
 11812     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11813         DFHEIV20
 11814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11815
 11816
 11817
 11818* EXEC CICS HANDLE CONDITION
 11819*         DUPREC   (2650-EXIT)
 11820*    END-EXEC.
 11821*    MOVE '"$%                   ! : #00010301' TO DFHEIV0
 11822     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11823     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11824     MOVE X'3A20233030303130333031' TO DFHEIV0(25:11)
 11825     CALL 'kxdfhei1' USING DFHEIV0
 11826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11827
 11828
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 223
* EL131.cbl
 11829     MOVE SPACES             TO ACTIVITY-TRAILERS.
 11830
 11831     IF CERTL GREATER ZERO
 11832         MOVE CERTI          TO CL-CERT-PRIME.
 11833
 11834     IF SUFXL GREATER ZERO
 11835         MOVE SUFXI          TO CL-CERT-SFX.
 11836
 11837     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 11838
 11839     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 11840     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 11841
 11842     MOVE 'AT'               TO AT-RECORD-ID.
 11843
 11844     MOVE '6'                TO AT-TRAILER-TYPE.
 11845     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 11846                                AT-GEN-INFO-LAST-MAINT-DT.
 11847     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 11848                                AT-GEN-INFO-LAST-UPDATED-BY.
 11849     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 11850     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 11851     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 11852
 11853
 11854* EXEC CICS WRITE
 11855*         DATASET  (TRLR-FILE-ID)
 11856*         RIDFLD   (AT-CONTROL-PRIMARY)
 11857*         FROM     (ACTIVITY-TRAILERS)
 11858*    END-EXEC.
 11859     MOVE LENGTH OF
 11860      ACTIVITY-TRAILERS
 11861       TO DFHEIV11
 11862*    MOVE '&$ L                  ''   #00010329' TO DFHEIV0
 11863     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11864     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11865     MOVE X'2020233030303130333239' TO DFHEIV0(25:11)
 11866     CALL 'kxdfhei1' USING DFHEIV0,
 11867           TRLR-FILE-ID,
 11868           ACTIVITY-TRAILERS,
 11869           DFHEIV11,
 11870           AT-CONTROL-PRIMARY,
 11871           DFHEIV99,
 11872           DFHEIV99
 11873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11874
 11875
 11876 2650-EXIT.
 11877      EXIT.
 11878
 11879 2800-CHECK-AUTO-PAY.
 11880
 11881     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 11882     MOVE PI-CARRIER         TO TRLR-CARRIER.
 11883     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 11884     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 11885     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 11886
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 224
* EL131.cbl
 11887
 11888* EXEC CICS HANDLE CONDITION
 11889*         NOTFND    (2800-EXIT)
 11890*         ENDFILE   (2800-EXIT)
 11891*    END-EXEC.
 11892*    MOVE '"$I''                  ! ; #00010346' TO DFHEIV0
 11893     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11894     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11895     MOVE X'3B20233030303130333436' TO DFHEIV0(25:11)
 11896     CALL 'kxdfhei1' USING DFHEIV0
 11897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11898
 11899
 11900
 11901* EXEC CICS READ
 11902*        DATASET (TRLR-FILE-ID)
 11903*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11904*        RIDFLD  (TRLR-KEY)
 11905*    END-EXEC.
 11906*    MOVE '&"S        E          (   #00010351' TO DFHEIV0
 11907     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11908     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11909     MOVE X'2020233030303130333531' TO DFHEIV0(25:11)
 11910     CALL 'kxdfhei1' USING DFHEIV0,
 11911           TRLR-FILE-ID,
 11912           DFHEIV20,
 11913           DFHEIV99,
 11914           TRLR-KEY,
 11915           DFHEIV99,
 11916           DFHEIV99,
 11917           DFHEIV99
 11918     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11919         DFHEIV20
 11920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11921
 11922
 11923     IF BENEFICIARY-PAID-AUTO
 11924         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 11925     END-IF.
 11926
 11927 2800-EXIT.
 11928      EXIT.
 11929
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 225
* EL131.cbl
 11931 3000-DELETE-CLAIM.
 11932     IF  NOT MODIFY-CAP
 11933         MOVE ER-0070            TO EMI-ERROR
 11934         MOVE -1                 TO MAINTL
 11935         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11936         GO TO 8110-SEND-DATA.
 11937
 11938
 11939* EXEC CICS READ
 11940*         SET      (ADDRESS OF CLAIM-MASTER)
 11941*         DATASET  (CLMS-FILE-ID)
 11942*         RIDFLD   (MSTR-KEY)
 11943*    END-EXEC.
 11944*    MOVE '&"S        E          (   #00010372' TO DFHEIV0
 11945     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11946     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11947     MOVE X'2020233030303130333732' TO DFHEIV0(25:11)
 11948     CALL 'kxdfhei1' USING DFHEIV0,
 11949           CLMS-FILE-ID,
 11950           DFHEIV20,
 11951           DFHEIV99,
 11952           MSTR-KEY,
 11953           DFHEIV99,
 11954           DFHEIV99,
 11955           DFHEIV99
 11956     SET ADDRESS OF CLAIM-MASTER TO
 11957         DFHEIV20
 11958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11959
 11960
 11961     IF CL-1ST-TRL-AVAIL
 11962         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 11963     ELSE
 11964        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 11965        MOVE 0                   TO TRLR-SEQ-NO
 11966
 11967* EXEC CICS STARTBR
 11968*            DATASET (TRLR-FILE-ID)
 11969*            RIDFLD  (TRLR-KEY)
 11970*        END-EXEC
 11971     MOVE 0
 11972       TO DFHEIV11
 11973*    MOVE '&,         G          &   #00010383' TO DFHEIV0
 11974     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11975     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11976     MOVE X'2020233030303130333833' TO DFHEIV0(25:11)
 11977     CALL 'kxdfhei1' USING DFHEIV0,
 11978           TRLR-FILE-ID,
 11979           TRLR-KEY,
 11980           DFHEIV99,
 11981           DFHEIV11,
 11982           DFHEIV99
 11983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11984         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 11985
 11986* EXEC CICS ENDBR
 11987*            DATASET (TRLR-FILE-ID)
 11988*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 226
* EL131.cbl
 11989     MOVE 0
 11990       TO DFHEIV11
 11991*    MOVE '&2                    $   #00010388' TO DFHEIV0
 11992     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11993     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11994     MOVE X'2020233030303130333838' TO DFHEIV0(25:11)
 11995     CALL 'kxdfhei1' USING DFHEIV0,
 11996           TRLR-FILE-ID,
 11997           DFHEIV11,
 11998           DFHEIV99
 11999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12000        IF SCREEN-ERROR
 12001            MOVE ER-0208         TO EMI-ERROR
 12002            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12003            MOVE -1              TO MAINTL
 12004            GO TO 8110-SEND-DATA
 12005        ELSE
 12006            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 12007
 12008     IF SCREEN-ERROR
 12009         MOVE -1                 TO MAINTL
 12010         GO TO 8110-SEND-DATA.
 12011
 12012     MOVE -1                     TO ONE-OR-MIN1.
 12013     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 12014
 12015     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 12016         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 12017                                    WS-SAVE-CLAIM-KEY
 12018         MOVE +1                 TO ONE-OR-MIN1
 12019         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 12020
 12021     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 12022
 12023     MOVE LOW-VALUES             TO EL131AO.
 12024     MOVE ER-0000                TO EMI-ERROR.
 12025     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12026     MOVE 'X'                    TO PI-RETURN-CD-1.
 12027     MOVE -1                     TO MAINTL.
 12028     GO TO 8100-SEND-MAP.
 12029
 12030 3010-DEL-MSTR-TRLR.
 12031
 12032* EXEC CICS READ UPDATE
 12033*         SET       (ADDRESS OF CLAIM-MASTER)
 12034*         DATASET   (CLMS-FILE-ID)
 12035*         RIDFLD    (MSTR-KEY)
 12036*    END-EXEC.
 12037*    MOVE '&"S        EU         (   #00010422' TO DFHEIV0
 12038     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12039     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12040     MOVE X'2020233030303130343232' TO DFHEIV0(25:11)
 12041     CALL 'kxdfhei1' USING DFHEIV0,
 12042           CLMS-FILE-ID,
 12043           DFHEIV20,
 12044           DFHEIV99,
 12045           MSTR-KEY,
 12046           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 227
* EL131.cbl
 12047           DFHEIV99,
 12048           DFHEIV99
 12049     SET ADDRESS OF CLAIM-MASTER TO
 12050         DFHEIV20
 12051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12052
 12053
 12054     if (cl-priority-cd = '8')
 12055        and (pi-processor-id not = 'PEMA' and 'JMS '
 12056             AND 'AMWA')
 12057        MOVE ER-8003             TO EMI-ERROR
 12058        PERFORM 9900-ERROR-FORMAT
 12059                                 THRU 9900-EXIT
 12060        MOVE -1                  TO MAINTL
 12061        GO TO 8110-SEND-DATA
 12062     end-if
 12063
 12064     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 12065     MOVE ZERO                   TO TRLR-SEQ-NO.
 12066
 12067
 12068* EXEC CICS HANDLE CONDITION
 12069*         NOTFND    (3010-DEL-ACTQ)
 12070*         ENDFILE   (3040-EXIT)
 12071*    END-EXEC.
 12072*    MOVE '"$I''                  ! < #00010441' TO DFHEIV0
 12073     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12074     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12075     MOVE X'3C20233030303130343431' TO DFHEIV0(25:11)
 12076     CALL 'kxdfhei1' USING DFHEIV0
 12077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12078
 12079
 12080     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 12081
 12082 3010-DEL-ACTQ.
 12083
 12084
 12085* EXEC CICS HANDLE CONDITION
 12086*         NOTFND    (3010-NO-ACTIVITY)
 12087*         ENDFILE   (3050-EXIT)
 12088*    END-EXEC.
 12089*    MOVE '"$I''                  ! = #00010450' TO DFHEIV0
 12090     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12091     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12092     MOVE X'3D20233030303130343530' TO DFHEIV0(25:11)
 12093     CALL 'kxdfhei1' USING DFHEIV0
 12094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12095
 12096
 12097
 12098* EXEC CICS STARTBR
 12099*         DATASET  (ACTQ-FILE-ID)
 12100*         RIDFLD   (ACTQ-KEY)
 12101*    END-EXEC.
 12102     MOVE 0
 12103       TO DFHEIV11
 12104*    MOVE '&,         G          &   #00010455' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 228
* EL131.cbl
 12105     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12106     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12107     MOVE X'2020233030303130343535' TO DFHEIV0(25:11)
 12108     CALL 'kxdfhei1' USING DFHEIV0,
 12109           ACTQ-FILE-ID,
 12110           ACTQ-KEY,
 12111           DFHEIV99,
 12112           DFHEIV11,
 12113           DFHEIV99
 12114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12115
 12116
 12117
 12118* EXEC CICS GETMAIN
 12119*         SET      (ADDRESS OF ACTIVITY-QUE)
 12120*         LENGTH   (ACTQ-LENGTH)
 12121*         INITIMG  (GETMAIN-SPACE)
 12122*    END-EXEC.
 12123*    MOVE ',"IL                  $   #00010460' TO DFHEIV0
 12124     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12125     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12126     MOVE X'2020233030303130343630' TO DFHEIV0(25:11)
 12127     CALL 'kxdfhei1' USING DFHEIV0,
 12128           DFHEIV20,
 12129           ACTQ-LENGTH,
 12130           GETMAIN-SPACE
 12131     SET ADDRESS OF ACTIVITY-QUE TO
 12132         DFHEIV20
 12133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12134
 12135
 12136     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 12137
 12138
 12139* EXEC CICS ENDBR
 12140*         DATASET (ACTQ-FILE-ID)
 12141*    END-EXEC.
 12142     MOVE 0
 12143       TO DFHEIV11
 12144*    MOVE '&2                    $   #00010468' TO DFHEIV0
 12145     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12146     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12147     MOVE X'2020233030303130343638' TO DFHEIV0(25:11)
 12148     CALL 'kxdfhei1' USING DFHEIV0,
 12149           ACTQ-FILE-ID,
 12150           DFHEIV11,
 12151           DFHEIV99
 12152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12153
 12154
 12155 3010-NO-ACTIVITY.
 12156
 12157
 12158* EXEC CICS HANDLE CONDITION
 12159*        NOTFND   (3010-CERT-NOT-FOUND)
 12160*    END-EXEC.
 12161*    MOVE '"$I                   ! > #00010474' TO DFHEIV0
 12162     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 229
* EL131.cbl
 12163     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12164     MOVE X'3E20233030303130343734' TO DFHEIV0(25:11)
 12165     CALL 'kxdfhei1' USING DFHEIV0
 12166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12167
 12168
 12169     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 12170     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12171     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 12172     MOVE CL-CERT-STATE          TO CERT-STATE.
 12173     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12174     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 12175     MOVE CL-CERT-NO             TO CERT-CERT.
 12176
 12177
 12178* EXEC CICS READ
 12179*        DATASET   (CERT-FILE-ID)
 12180*        RIDFLD    (CERT-KEY)
 12181*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 12182*    END-EXEC.
 12183*    MOVE '&"S        E          (   #00010486' TO DFHEIV0
 12184     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12185     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12186     MOVE X'2020233030303130343836' TO DFHEIV0(25:11)
 12187     CALL 'kxdfhei1' USING DFHEIV0,
 12188           CERT-FILE-ID,
 12189           DFHEIV20,
 12190           DFHEIV99,
 12191           CERT-KEY,
 12192           DFHEIV99,
 12193           DFHEIV99,
 12194           DFHEIV99
 12195     SET ADDRESS OF CERTIFICATE-MASTER TO
 12196         DFHEIV20
 12197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12198
 12199
 12200     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 12201       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 12202         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 12203     ELSE
 12204         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 12205
 12206 3010-CERT-NOT-FOUND.
 12207
 12208
 12209* EXEC CICS DELETE
 12210*        DATASET  (CLMS-FILE-ID)
 12211*    END-EXEC.
 12212*    MOVE '&(                    &   #00010500' TO DFHEIV0
 12213     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12214     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12215     MOVE X'2020233030303130353030' TO DFHEIV0(25:11)
 12216     CALL 'kxdfhei1' USING DFHEIV0,
 12217           CLMS-FILE-ID,
 12218           DFHEIV99,
 12219           DFHEIV99,
 12220           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 230
* EL131.cbl
 12221           DFHEIV99
 12222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12223
 12224
 12225 3010-EXIT.
 12226      EXIT.
 12227
 12228 3020-UPDATE-CERT.
 12229
 12230* EXEC CICS READ UPDATE
 12231*         DATASET  (CERT-FILE-ID)
 12232*         RIDFLD   (CERT-KEY)
 12233*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12234*    END-EXEC.
 12235*    MOVE '&"S        EU         (   #00010508' TO DFHEIV0
 12236     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12237     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12238     MOVE X'2020233030303130353038' TO DFHEIV0(25:11)
 12239     CALL 'kxdfhei1' USING DFHEIV0,
 12240           CERT-FILE-ID,
 12241           DFHEIV20,
 12242           DFHEIV99,
 12243           CERT-KEY,
 12244           DFHEIV99,
 12245           DFHEIV99,
 12246           DFHEIV99
 12247     SET ADDRESS OF CERTIFICATE-MASTER TO
 12248         DFHEIV20
 12249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12250
 12251
 12252     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 12253
 12254
 12255* EXEC CICS HANDLE CONDITION
 12256*         DUPKEY   (3020-EXIT)
 12257*    END-EXEC.
 12258*    MOVE '"$$                   ! ? #00010516' TO DFHEIV0
 12259     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12260     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12261     MOVE X'3F20233030303130353136' TO DFHEIV0(25:11)
 12262     CALL 'kxdfhei1' USING DFHEIV0
 12263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12264
 12265
 12266
 12267* EXEC CICS REWRITE
 12268*         DATASET  (CERT-FILE-ID)
 12269*         FROM     (CERTIFICATE-MASTER)
 12270*    END-EXEC.
 12271     MOVE LENGTH OF
 12272      CERTIFICATE-MASTER
 12273       TO DFHEIV11
 12274*    MOVE '&& L                  %   #00010520' TO DFHEIV0
 12275     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12276     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12277     MOVE X'2020233030303130353230' TO DFHEIV0(25:11)
 12278     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 231
* EL131.cbl
 12279           CERT-FILE-ID,
 12280           CERTIFICATE-MASTER,
 12281           DFHEIV11,
 12282           DFHEIV99
 12283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12284
 12285
 12286 3020-EXIT.
 12287     EXIT.
 12288
 12289 3030-DELETE-CERT.
 12290
 12291* EXEC CICS READ UPDATE
 12292*         DATASET  (CERT-FILE-ID)
 12293*         RIDFLD   (CERT-KEY)
 12294*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12295*    END-EXEC.
 12296*    MOVE '&"S        EU         (   #00010529' TO DFHEIV0
 12297     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12298     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12299     MOVE X'2020233030303130353239' TO DFHEIV0(25:11)
 12300     CALL 'kxdfhei1' USING DFHEIV0,
 12301           CERT-FILE-ID,
 12302           DFHEIV20,
 12303           DFHEIV99,
 12304           CERT-KEY,
 12305           DFHEIV99,
 12306           DFHEIV99,
 12307           DFHEIV99
 12308     SET ADDRESS OF CERTIFICATE-MASTER TO
 12309         DFHEIV20
 12310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12311
 12312
 12313
 12314* EXEC CICS DELETE
 12315*         DATASET   (CERT-FILE-ID)
 12316*    END-EXEC.
 12317*    MOVE '&(                    &   #00010535' TO DFHEIV0
 12318     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12319     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12320     MOVE X'2020233030303130353335' TO DFHEIV0(25:11)
 12321     CALL 'kxdfhei1' USING DFHEIV0,
 12322           CERT-FILE-ID,
 12323           DFHEIV99,
 12324           DFHEIV99,
 12325           DFHEIV99,
 12326           DFHEIV99
 12327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12328
 12329
 12330 3030-EXIT.
 12331     EXIT.
 12332
 12333 3040-DELETE-TRLR.
 12334
 12335* EXEC CICS READ
 12336*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 232
* EL131.cbl
 12337*         DATASET  (TRLR-FILE-ID)
 12338*         RIDFLD   (TRLR-KEY)
 12339*         GTEQ
 12340*    END-EXEC.
 12341*    MOVE '&"S        G          (   #00010543' TO DFHEIV0
 12342     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12343     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12344     MOVE X'2020233030303130353433' TO DFHEIV0(25:11)
 12345     CALL 'kxdfhei1' USING DFHEIV0,
 12346           TRLR-FILE-ID,
 12347           DFHEIV20,
 12348           DFHEIV99,
 12349           TRLR-KEY,
 12350           DFHEIV99,
 12351           DFHEIV99,
 12352           DFHEIV99
 12353     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12354         DFHEIV20
 12355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12356
 12357
 12358     IF PI-COMPANY-CD = AT-COMPANY-CD
 12359        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 12360        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 12361           GO TO 3040-EXIT
 12362        ELSE
 12363           NEXT SENTENCE
 12364     ELSE
 12365        GO TO 3040-EXIT.
 12366
 12367
 12368* EXEC CICS DELETE
 12369*         DATASET  (TRLR-FILE-ID)
 12370*         RIDFLD   (TRLR-KEY)
 12371*    END-EXEC.
 12372*    MOVE '&(  R                 &   #00010559' TO DFHEIV0
 12373     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12374     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12375     MOVE X'2020233030303130353539' TO DFHEIV0(25:11)
 12376     CALL 'kxdfhei1' USING DFHEIV0,
 12377           TRLR-FILE-ID,
 12378           TRLR-KEY,
 12379           DFHEIV99,
 12380           DFHEIV99,
 12381           DFHEIV99
 12382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12383
 12384
 12385     GO TO 3040-DELETE-TRLR.
 12386
 12387 3040-EXIT.
 12388     EXIT.
 12389
 12390 3050-DELETE-ACTQ.
 12391
 12392* EXEC CICS READNEXT
 12393*         DATASET  (ACTQ-FILE-ID)
 12394*         RIDFLD   (ACTQ-KEY)
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 233
* EL131.cbl
 12395*         INTO     (ACTIVITY-QUE)
 12396*    END-EXEC.
 12397     MOVE LENGTH OF
 12398      ACTIVITY-QUE
 12399       TO DFHEIV12
 12400     MOVE 0
 12401       TO DFHEIV11
 12402*    MOVE '&.IL                  )   #00010570' TO DFHEIV0
 12403     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12404     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12405     MOVE X'2020233030303130353730' TO DFHEIV0(25:11)
 12406     CALL 'kxdfhei1' USING DFHEIV0,
 12407           ACTQ-FILE-ID,
 12408           ACTIVITY-QUE,
 12409           DFHEIV12,
 12410           ACTQ-KEY,
 12411           DFHEIV99,
 12412           DFHEIV11,
 12413           DFHEIV99,
 12414           DFHEIV99
 12415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12416
 12417
 12418     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 12419         GO TO 3050-EXIT.
 12420
 12421
 12422* EXEC CICS ENDBR
 12423*         DATASET  (ACTQ-FILE-ID)
 12424*    END-EXEC.
 12425     MOVE 0
 12426       TO DFHEIV11
 12427*    MOVE '&2                    $   #00010579' TO DFHEIV0
 12428     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12429     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12430     MOVE X'2020233030303130353739' TO DFHEIV0(25:11)
 12431     CALL 'kxdfhei1' USING DFHEIV0,
 12432           ACTQ-FILE-ID,
 12433           DFHEIV11,
 12434           DFHEIV99
 12435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12436
 12437
 12438
 12439* EXEC CICS DELETE
 12440*         DATASET   (ACTQ-FILE-ID)
 12441*         RIDFLD    (ACTQ-KEY)
 12442*    END-EXEC.
 12443*    MOVE '&(  R                 &   #00010583' TO DFHEIV0
 12444     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12445     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12446     MOVE X'2020233030303130353833' TO DFHEIV0(25:11)
 12447     CALL 'kxdfhei1' USING DFHEIV0,
 12448           ACTQ-FILE-ID,
 12449           ACTQ-KEY,
 12450           DFHEIV99,
 12451           DFHEIV99,
 12452           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 234
* EL131.cbl
 12453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12454
 12455
 12456
 12457* EXEC CICS STARTBR
 12458*         DATASET   (ACTQ-FILE-ID)
 12459*         RIDFLD    (ACTQ-KEY)
 12460*    END-EXEC.
 12461     MOVE 0
 12462       TO DFHEIV11
 12463*    MOVE '&,         G          &   #00010588' TO DFHEIV0
 12464     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12465     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12466     MOVE X'2020233030303130353838' TO DFHEIV0(25:11)
 12467     CALL 'kxdfhei1' USING DFHEIV0,
 12468           ACTQ-FILE-ID,
 12469           ACTQ-KEY,
 12470           DFHEIV99,
 12471           DFHEIV11,
 12472           DFHEIV99
 12473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12474
 12475
 12476     GO TO 3050-DELETE-ACTQ.
 12477
 12478 3050-EXIT.
 12479     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 235
* EL131.cbl
 12481 3060-READ-TRLR.
 12482
 12483* EXEC CICS HANDLE CONDITION
 12484*         NOTFND    (3060-EXIT)
 12485*         ENDFILE   (3060-EXIT)
 12486*    END-EXEC.
 12487*    MOVE '"$I''                  ! @ #00010599' TO DFHEIV0
 12488     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12489     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12490     MOVE X'4020233030303130353939' TO DFHEIV0(25:11)
 12491     CALL 'kxdfhei1' USING DFHEIV0
 12492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12493
 12494
 12495 3060-LOOP.
 12496
 12497* EXEC CICS READNEXT
 12498*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12499*         DATASET  (TRLR-FILE-ID)
 12500*         RIDFLD   (TRLR-KEY)
 12501*    END-EXEC.
 12502     MOVE 0
 12503       TO DFHEIV11
 12504*    MOVE '&.S                   )   #00010605' TO DFHEIV0
 12505     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12506     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12507     MOVE X'2020233030303130363035' TO DFHEIV0(25:11)
 12508     CALL 'kxdfhei1' USING DFHEIV0,
 12509           TRLR-FILE-ID,
 12510           DFHEIV20,
 12511           DFHEIV99,
 12512           TRLR-KEY,
 12513           DFHEIV99,
 12514           DFHEIV11,
 12515           DFHEIV99,
 12516           DFHEIV99
 12517     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12518         DFHEIV20
 12519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12520
 12521
 12522     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 12523         GO TO 3060-EXIT.
 12524
 12525     IF FORM-CONTROL-TR
 12526         IF AT-RECORDED-DT = SAVE-BIN-DATE
 12527             NEXT SENTENCE
 12528         ELSE
 12529             MOVE 'X'            TO ERROR-SWITCH
 12530             GO TO 3060-EXIT
 12531     ELSE
 12532         IF PAYMENT-TR OR CORRESPONDENCE-TR
 12533            MOVE 'X'                 TO ERROR-SWITCH
 12534            GO TO 3060-EXIT.
 12535
 12536     GO TO 3060-LOOP.
 12537
 12538 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 236
* EL131.cbl
 12539     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 237
* EL131.cbl
 12541 4000-FORCE-ERRORS.
 12542     IF PI-RETURN-CD-1 = 'X'
 12543         MOVE ER-0311            TO EMI-ERROR
 12544         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12545         MOVE -1                 TO MAINTL
 12546         GO TO 8110-SEND-DATA.
 12547
 12548     IF NOT FORCE-CAP
 12549         MOVE ER-0416            TO EMI-ERROR
 12550         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12551         MOVE -1                 TO MAINTL
 12552         GO TO 8110-SEND-DATA.
 12553
 12554     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 12555     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 12556     IF EMI-FATAL-CTR GREATER THAN ZERO
 12557         GO TO 4000-FATAL-ERRORS.
 12558
 12559     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 12560
 12561     IF EMI-FATAL-CTR GREATER THAN ZERO
 12562         GO TO 4000-FATAL-ERRORS.
 12563
 12564     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 12565
 12566     IF EMI-FATAL-CTR GREATER THAN ZERO
 12567         GO TO 4000-FATAL-ERRORS.
 12568
 12569     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 12570     MOVE AL-UANOF               TO CERTA.
 12571     MOVE ER-0000 TO EMI-ERROR.
 12572     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12573
 12574 4000-FATAL-ERRORS.
 12575     MOVE -1                     TO MAINTL.
 12576     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 238
* EL131.cbl
 12578 5000-BUILD-MAP.
 12579     IF PI-RETURN-CD-1 = SPACE
 12580         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 12581
 12582     MOVE SPACE                  TO PI-RETURN-CD-1.
 12583
 12584     MOVE LOW-VALUES             TO EL131AI.
 12585
 12586     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 12587     MOVE PI-CARRIER             TO CARRIER-CODE.
 12588     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 12589     MOVE PI-CERT-NO             TO CERT-NO.
 12590
 12591 5000-READ-CLAIM-MASTER.
 12592
 12593
 12594* EXEC CICS READ
 12595*         SET      (ADDRESS OF CLAIM-MASTER)
 12596*         DATASET  (CLMS-FILE-ID)
 12597*         RIDFLD   (MSTR-KEY)
 12598*    END-EXEC.
 12599*    MOVE '&"S        E          (   #00010682' TO DFHEIV0
 12600     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12601     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12602     MOVE X'2020233030303130363832' TO DFHEIV0(25:11)
 12603     CALL 'kxdfhei1' USING DFHEIV0,
 12604           CLMS-FILE-ID,
 12605           DFHEIV20,
 12606           DFHEIV99,
 12607           MSTR-KEY,
 12608           DFHEIV99,
 12609           DFHEIV99,
 12610           DFHEIV99
 12611     SET ADDRESS OF CLAIM-MASTER TO
 12612         DFHEIV20
 12613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12614
 12615
 12616     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 12617
 12618 5000-READ-DIAGNOSIS-TRAILER.
 12619
 12620
 12621* EXEC CICS HANDLE CONDITION
 12622*         NOTFND (5000-TRLR-NOT-FOUND)
 12623*    END-EXEC.
 12624*    MOVE '"$I                   ! A #00010692' TO DFHEIV0
 12625     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12626     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12627     MOVE X'4120233030303130363932' TO DFHEIV0(25:11)
 12628     CALL 'kxdfhei1' USING DFHEIV0
 12629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12630
 12631
 12632     MOVE MSTR-KEY               TO TRLR-KEY.
 12633     MOVE NINETY                 TO TRLR-SEQ-NO.
 12634
 12635
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 239
* EL131.cbl
 12636* EXEC CICS READ
 12637*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12638*         DATASET  (TRLR-FILE-ID)
 12639*         RIDFLD   (TRLR-KEY)
 12640*    END-EXEC.
 12641*    MOVE '&"S        E          (   #00010699' TO DFHEIV0
 12642     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12643     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12644     MOVE X'2020233030303130363939' TO DFHEIV0(25:11)
 12645     CALL 'kxdfhei1' USING DFHEIV0,
 12646           TRLR-FILE-ID,
 12647           DFHEIV20,
 12648           DFHEIV99,
 12649           TRLR-KEY,
 12650           DFHEIV99,
 12651           DFHEIV99,
 12652           DFHEIV99
 12653     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12654         DFHEIV20
 12655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12656
 12657
 12658     MOVE AT-INFO-LINE-1         TO DIAGO.
 12659
 12660 5000-READ-CERTIFICATE-MASTER.
 12661
 12662     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 12663     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 12664     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 12665     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 12666     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 12667     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 12668     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 12669
 12670
 12671* EXEC CICS HANDLE CONDITION
 12672*         NOTFND (5000-CERT-NOT-FOUND)
 12673*    END-EXEC.
 12674*    MOVE '"$I                   ! B #00010717' TO DFHEIV0
 12675     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12676     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12677     MOVE X'4220233030303130373137' TO DFHEIV0(25:11)
 12678     CALL 'kxdfhei1' USING DFHEIV0
 12679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12680
 12681
 12682
 12683* EXEC CICS READ
 12684*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12685*         DATASET  (CERT-FILE-ID)
 12686*         RIDFLD   (CERT-KEY)
 12687*    END-EXEC.
 12688*    MOVE '&"S        E          (   #00010721' TO DFHEIV0
 12689     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12690     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12691     MOVE X'2020233030303130373231' TO DFHEIV0(25:11)
 12692     CALL 'kxdfhei1' USING DFHEIV0,
 12693           CERT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 240
* EL131.cbl
 12694           DFHEIV20,
 12695           DFHEIV99,
 12696           CERT-KEY,
 12697           DFHEIV99,
 12698           DFHEIV99,
 12699           DFHEIV99
 12700     SET ADDRESS OF CERTIFICATE-MASTER TO
 12701         DFHEIV20
 12702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12703
 12704
 12705     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 12706     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 12707
 12708     GO TO 5000-EXIT.
 12709
 12710 5000-TRLR-NOT-FOUND.
 12711     MOVE ER-7687                TO EMI-ERROR.
 12712     MOVE -1                     TO DIAGL.
 12713     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12714     GO TO 5000-EXIT.
 12715
 12716 5000-CERT-NOT-FOUND.
 12717     MOVE ER-0206                TO EMI-ERROR.
 12718     MOVE -1                     TO CERTL.
 12719     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12720
 12721 5000-EXIT.
 12722     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 241
* EL131.cbl
 12724 5010-RESET-PI-AREA.
 12725     IF CERTI GREATER THAN LOW-VALUES
 12726         MOVE CERTI              TO PI-CERT-PRIME.
 12727
 12728     IF SUFXI GREATER THAN LOW-VALUES
 12729         MOVE SUFXI              TO PI-CERT-SFX.
 12730
 12731     IF CERTEFFI GREATER THAN LOW-VALUES
 12732         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 12733
 12734     IF CERTACTI GREATER THAN LOW-VALUES
 12735         MOVE CERTACTI           TO PI-ACCOUNT.
 12736
 12737     IF CERTSTI GREATER THAN LOW-VALUES
 12738         MOVE CERTSTI            TO PI-STATE.
 12739
 12740     IF CERTCARI GREATER THAN LOW-VALUES
 12741         MOVE CERTCARI           TO PI-CARRIER.
 12742
 12743     IF CERTGRPI GREATER THAN LOW-VALUES
 12744         MOVE CERTGRPI           TO PI-GROUPING.
 12745
 12746 5010-EXIT.
 12747     EXIT.
 12748
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 242
* EL131.cbl
 12750 5020-MOVE-MSTR.
 12751
 12752     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 12753     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 12754     MOVE WS-CLAIM-SEQU          TO SEQUO.
 12755     MOVE AL-SABON               TO SEQUA.
 12756     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 12757     MOVE CL-CLAIM-TYPE          TO TYPEO.
 12758
 12759     IF CL-TOTAL-PAID-AMT  = +0 AND
 12760        CL-LAST-PMT-AMT    = +0 AND
 12761        CL-NO-OF-PMTS-MADE = +0
 12762          MOVE AL-UANON          TO TYPEA.
 12763
 12764     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 12765     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 12766     MOVE CL-CERT-PRIME          TO CERTO.
 12767     MOVE CL-CERT-SFX            TO SUFXO.
 12768     MOVE CL-CERT-CARRIER        TO CARRO.
 12769
 12770     IF CL-CLAIM-STATUS = 'C'
 12771         MOVE 'CLOSED'           TO STATUSO
 12772     ELSE
 12773         MOVE 'OPEN  '           TO STATUSO.
 12774
 12775     MOVE CL-PROCESSOR-ID        TO PROCO.
 12776
 12777     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 12778     MOVE CL-CCN                 TO CCNOO.
 12779
 12780     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 12781     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 12782     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 12783     MOVE CL-INSURED-SEX-CD      TO SEXO.
 12784
 12785     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 12786         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 12787         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12788         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12789         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 12790     ELSE
 12791         MOVE SPACES             TO BIRTHO.
 12792
 12793     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 12794        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 12795         NEXT SENTENCE
 12796       ELSE
 12797         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 12798
 12799     IF PI-COMPANY-ID = 'DMD'
 12800       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
 12801          IF SOCIALO = SPACES OR LOW-VALUES
 12802            MOVE ER-0885         TO EMI-ERROR
 12803            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12804
 12805     MOVE CL-INSURED-OCC-CD      TO OCCO.
 12806     MOVE CL-CAUSE-CD            TO CAUSEO.
 12807
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 243
* EL131.cbl
 12808     IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 12809         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 12810         MOVE SPACES                 TO DC-OPTION-CODE
 12811         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12812         MOVE DC-GREG-DATE-1-EDIT TO ENDO
 12813     ELSE
 12814         MOVE SPACES             TO ENDO.
 12815
 12816     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 12817        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 12818        MOVE SPACES             TO DC-OPTION-CODE
 12819        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12820        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 12821        IF PI-USES-PAID-TO
 12822           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 12823           MOVE '6'                TO DC-OPTION-CODE
 12824           MOVE +1                 TO DC-ELAPSED-DAYS
 12825           MOVE +0                 TO DC-ELAPSED-MONTHS
 12826           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12827           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 12828        ELSE
 12829           NEXT SENTENCE
 12830     ELSE
 12831        MOVE SPACES             TO PDTHRUO.
 12832
 12833     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 12834     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 12835     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 12836     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 12837
 12838     IF MODIFY-CAP
 12839        MOVE AL-UNNOF            TO PDAMTA
 12840                                    NODAYSA
 12841                                    NOPMTSA
 12842        MOVE AL-UANOF            TO PDTHRUA.
 12843
 12844     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 12845         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 12846         MOVE SPACES             TO DC-OPTION-CODE
 12847         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12848         MOVE DC-GREG-DATE-1-EDIT TO INCO
 12849     ELSE
 12850         MOVE SPACES             TO INCO.
 12851
 12852     IF CL-NO-OF-PMTS-MADE = ZEROS
 12853        MOVE AL-UANOF            TO INCA.
 12854
 12855     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 12856
 12857     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 12858         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 12859         MOVE SPACES             TO DC-OPTION-CODE
 12860         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12861         MOVE DC-GREG-DATE-1-EDIT TO REPO
 12862     ELSE
 12863         MOVE SPACES             TO REPO.
 12864
 12865     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 244
* EL131.cbl
 12866         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 12867         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12868         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12869         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 12870     ELSE
 12871         MOVE SPACES             TO ESTO.
 12872
 12873     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 12874         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 12875         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12876         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12877         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 12878     ELSE
 12879         MOVE SPACES             TO MNTDTO.
 12880
 12881
 12882     IF CL-LAST-MAINT-TYPE = SPACE
 12883         MOVE 'SET-UP'           TO MNTTYPEO
 12884     ELSE
 12885     IF CL-LAST-MAINT-TYPE = '1'
 12886         MOVE 'PAYMNT'           TO MNTTYPEO
 12887     ELSE
 12888     IF CL-LAST-MAINT-TYPE = '2'
 12889         MOVE 'LETTER'           TO MNTTYPEO
 12890     ELSE
 12891     IF CL-LAST-MAINT-TYPE = '3'
 12892         MOVE 'UPDATE'           TO MNTTYPEO
 12893     ELSE
 12894     IF CL-LAST-MAINT-TYPE = '4'
 12895         MOVE 'RESTOR'           TO MNTTYPEO
 12896     ELSE
 12897     IF CL-LAST-MAINT-TYPE = '5'
 12898         MOVE 'INC DT'           TO MNTTYPEO
 12899     ELSE
 12900     IF CL-LAST-MAINT-TYPE = '6'
 12901         MOVE ' CONV'            TO MNTTYPEO
 12902     ELSE
 12903     IF CL-LAST-MAINT-TYPE = 'C'
 12904         MOVE 'CHGBEN'           TO MNTTYPEO
 12905     ELSE
 12906     IF CL-LAST-MAINT-TYPE = 'E'
 12907         MOVE 'ERRCOR'           TO MNTTYPEO
 12908     ELSE
 12909         MOVE SPACES             TO MNTTYPEO.
 12910
 12911     MOVE CL-BENEFICIARY         TO BENEO.
 12912     MOVE CL-FILE-LOCATION       TO FILETOO.
 12913     MOVE CL-PRIORITY-CD         TO PRICDO.
 12914     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 12915     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 12916     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 12917     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 12918
 12919 5020-EXIT.
 12920     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 245
* EL131.cbl
 12922 5030-MOVE-CERT.
 12923
 12924     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 12925         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12926         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12927         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12928         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 12929       ELSE
 12930         MOVE SPACES             TO CERTEFFO
 12931         MOVE ZERO               TO HOLD-DATE.
 12932
 12933     MOVE CM-ACCOUNT             TO CERTACTO.
 12934     MOVE CM-STATE               TO CERTSTO PI-STATE.
 12935     MOVE CM-GROUPING            TO CERTGRPO.
 12936     MOVE CM-CARRIER             TO CERTCARO.
 12937     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 12938     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 12939     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 12940     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 12941     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 12942     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 12943     MOVE CM-JT-INITIAL          TO JNTINITO.
 12944     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 12945
 12946*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 12947     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12948     MOVE '3'                    TO CNTL-REC-TYPE.
 12949     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 12950     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 12951     MOVE ZERO                   TO CNTL-SEQ-NO.
 12952
 12953
 12954* EXEC CICS READ
 12955*         SET        (ADDRESS OF CONTROL-FILE)
 12956*         DATASET    ('ELCNTL')
 12957*         RIDFLD     (CNTL-KEY)
 12958*         RESP       (WS-RESPONSE)
 12959*    END-EXEC.
 12960     MOVE 'ELCNTL' TO DFHEIV1
 12961*    MOVE '&"S        E          (  N#00010975' TO DFHEIV0
 12962     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12963     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12964     MOVE X'204E233030303130393735' TO DFHEIV0(25:11)
 12965     CALL 'kxdfhei1' USING DFHEIV0,
 12966           DFHEIV1,
 12967           DFHEIV20,
 12968           DFHEIV99,
 12969           CNTL-KEY,
 12970           DFHEIV99,
 12971           DFHEIV99,
 12972           DFHEIV99
 12973     SET ADDRESS OF CONTROL-FILE TO
 12974         DFHEIV20
 12975     MOVE EIBRESP  TO WS-RESPONSE
 12976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12977
 12978
 12979     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 246
* EL131.cbl
 12980        MOVE ZERO                TO CP-FREE-LOOK
 12981     ELSE
 12982        MOVE CF-ST-FREE-LOOK-PERIOD
 12983                                 TO CP-FREE-LOOK.
 12984
 12985     IF CM-LF-BENEFIT-CD = '00'
 12986        GO TO 5030-MOVE-CERT-AH.
 12987
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 247
* EL131.cbl
 12989     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 12990     MOVE '5'                    TO DC-OPTION-CODE
 12991     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12992     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 12993     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 12994     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 12995     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 12996     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 12997     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12998     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 12999     MOVE '4'                    TO CP-REM-TERM-METHOD
 13000     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 13001     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13002     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 13003
 13004     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 13005     IF CM-LF-PREMIUM-RATE NUMERIC
 13006         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 13007     ELSE
 13008         MOVE ZEROS              TO LCVRATEO.
 13009
 13010     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 13011         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 13012
 13013     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 13014
 13015     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 13016
 13017     IF CM-LF-CURRENT-STATUS = '8'
 13018        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 13019            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 13020            MOVE ' '             TO DC-OPTION-CODE
 13021            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13022            IF NOT DATE-CONVERSION-ERROR
 13023                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 13024
 13025     IF CM-LF-CURRENT-STATUS = '7'
 13026        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13027            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 13028            MOVE ' '             TO DC-OPTION-CODE
 13029            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13030            IF NOT DATE-CONVERSION-ERROR
 13031                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 13032
 13033     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 13034         MOVE ' '                TO DC-OPTION-CODE
 13035         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 13036         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13037         IF NOT DATE-CONVERSION-ERROR
 13038             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 13039             MOVE HOLD-MONTH     TO WORK-MONTH
 13040             MOVE HOLD-YEAR      TO WORK-YEAR
 13041             MOVE WORK-DATE-MY   TO LCVEXITO.
 13042
 13043     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 13044        IF CP-REMAINING-TERM-3 = ZEROS
 13045           MOVE 'EXPIRED'        TO LCVSTATO
 13046        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 248
* EL131.cbl
 13047           MOVE 'ACTIVE'         TO LCVSTATO.
 13048
 13049     IF CM-LF-CURRENT-STATUS = '2'
 13050        MOVE 'PEND   '           TO LCVSTATO.
 13051     IF CM-LF-CURRENT-STATUS = '3'
 13052        MOVE 'RESTORE'           TO LCVSTATO.
 13053     IF CM-LF-CURRENT-STATUS = '5'
 13054        MOVE 'REISSUE'           TO LCVSTATO.
 13055     IF CM-LF-CURRENT-STATUS = '6'
 13056        MOVE 'LMP DIS'           TO LCVSTATO.
 13057     IF CM-LF-CURRENT-STATUS = '7'
 13058        MOVE 'DEATH  '           TO LCVSTATO.
 13059     IF CM-LF-CURRENT-STATUS = '8'
 13060        MOVE 'CANCEL '           TO LCVSTATO.
 13061     IF CM-LF-CURRENT-STATUS = '9'
 13062        MOVE 'RE-ONLY'           TO LCVSTATO.
 13063     IF CM-LF-CURRENT-STATUS = 'V'
 13064        MOVE 'VOID   '           TO LCVSTATO.
 13065     IF CM-LF-CURRENT-STATUS = 'D'
 13066        MOVE 'DECLINE'           TO LCVSTATO.
 13067
 13068     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 13069     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 13070     MOVE '4'                    TO BEN-REC-TYPE.
 13071     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 13072     MOVE ZERO                   TO BEN-SEQ-NO.
 13073
 13074
 13075* EXEC CICS READ GTEQ
 13076*         DATASET  (CNTL-FILE-ID)
 13077*         RIDFLD   (BENEFIT-KEY)
 13078*         SET      (ADDRESS OF CONTROL-FILE)
 13079*    END-EXEC.
 13080*    MOVE '&"S        G          (   #00011077' TO DFHEIV0
 13081     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13082     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13083     MOVE X'2020233030303131303737' TO DFHEIV0(25:11)
 13084     CALL 'kxdfhei1' USING DFHEIV0,
 13085           CNTL-FILE-ID,
 13086           DFHEIV20,
 13087           DFHEIV99,
 13088           BENEFIT-KEY,
 13089           DFHEIV99,
 13090           DFHEIV99,
 13091           DFHEIV99
 13092     SET ADDRESS OF CONTROL-FILE TO
 13093         DFHEIV20
 13094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13095
 13096
 13097     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 13098        CF-RECORD-TYPE NOT = '4'
 13099         MOVE ER-0240            TO EMI-ERROR
 13100         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13101         GO TO 5030-MOVE-CERT-FINISH.
 13102
 13103     MOVE ZERO                   TO COUNT-2.
 13104     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 249
* EL131.cbl
 13105
 13106     IF SCREEN-ERROR
 13107         MOVE ER-0282            TO EMI-ERROR
 13108         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13109        ELSE
 13110         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 13111
 13112 5030-MOVE-CERT-AH.
 13113
 13114     IF CM-LF-BENEFIT-CD = '00'
 13115         IF CM-AH-BENEFIT-CD = '00'
 13116             GO TO 5030-MOVE-CERT-FINISH.
 13117
 13118     IF CM-AH-BENEFIT-CD = '00'
 13119        MOVE SPACES             TO ACVKINDO
 13120        COMPUTE PI-PAYMENT-AMT =
 13121                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 13122        GO TO 5030-MOVE-CERT-FINISH.
 13123
 13124     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 13125     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 13126     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 13127     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 13128     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 13129     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13130     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13131     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 13132
 13133**DMD **********************************************
 13134     IF PI-COMPANY-ID = 'DMD'
 13135         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 13136                                   CM-PMT-EXTENSION-DAYS
 13137         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 13138                                      CL-NO-OF-DAYS-PAID
 13139         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 13140             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 13141         MOVE WS-REM-MOS         TO ACVRTRMO
 13142                                    CP-REMAINING-TERM-3
 13143         MOVE WS-REM-DAYS        TO DAYSPO
 13144         GO TO 5030-SKIP-RTRM.
 13145**DMD **********************************************
 13146
 13147     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13148     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13149     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 13150     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 13151
 13152 5030-SKIP-RTRM.
 13153     IF CM-AH-PREMIUM-RATE NUMERIC
 13154         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 13155     ELSE
 13156         MOVE ZEROS              TO ACVRATEO.
 13157
 13158     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 13159     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 13160
 13161     IF CM-AH-CURRENT-STATUS = '8'
 13162        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 250
* EL131.cbl
 13163            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 13164            MOVE ' '             TO DC-OPTION-CODE
 13165            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13166            IF NOT DATE-CONVERSION-ERROR
 13167                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 13168
 13169     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 13170        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 13171            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 13172            MOVE ' '             TO DC-OPTION-CODE
 13173            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13174            IF NOT DATE-CONVERSION-ERROR
 13175                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 13176
 13177     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 13178        IF CP-REMAINING-TERM-3 = ZEROS
 13179           MOVE 'EXPIRED'        TO ACVSTATO
 13180        ELSE
 13181           MOVE 'ACTIVE'         TO ACVSTATO.
 13182
 13183     IF CM-AH-CURRENT-STATUS = '2'
 13184        MOVE 'PEND   '           TO ACVSTATO.
 13185     IF CM-AH-CURRENT-STATUS = '3'
 13186        MOVE 'RESTORE'           TO ACVSTATO.
 13187     IF CM-AH-CURRENT-STATUS = '5'
 13188        MOVE 'REISSUE'           TO ACVSTATO.
 13189     IF CM-AH-CURRENT-STATUS = '6'
 13190        MOVE 'LMP DIS'           TO ACVSTATO.
 13191     IF CM-AH-CURRENT-STATUS = '7'
 13192        MOVE 'DEATH  '           TO ACVSTATO.
 13193     IF CM-AH-CURRENT-STATUS = '8'
 13194        MOVE 'CANCEL '           TO ACVSTATO.
 13195     IF CM-AH-CURRENT-STATUS = '9'
 13196        MOVE 'RE-ONLY'           TO ACVSTATO.
 13197     IF CM-AH-CURRENT-STATUS = 'V'
 13198        MOVE 'VOID   '           TO ACVSTATO.
 13199     IF CM-AH-CURRENT-STATUS = '9'
 13200        MOVE 'DECLINE'           TO ACVSTATO.
 13201
 13202     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 13203         MOVE ' '                TO DC-OPTION-CODE
 13204         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 13205         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13206         IF NOT DATE-CONVERSION-ERROR
 13207             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 13208             MOVE HOLD-MONTH     TO WORK-MONTH
 13209             MOVE HOLD-YEAR      TO WORK-YEAR
 13210             MOVE WORK-DATE-MY   TO ACVEXITO.
 13211
 13212     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 13213
 13214     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 13215     MOVE '5'                    TO BEN-REC-TYPE.
 13216     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 13217     MOVE ZERO                   TO BEN-SEQ-NO.
 13218
 13219
 13220* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 251
* EL131.cbl
 13221*         DATASET  (CNTL-FILE-ID)
 13222*         RIDFLD   (BENEFIT-KEY)
 13223*         SET      (ADDRESS OF CONTROL-FILE)
 13224*    END-EXEC.
 13225*    MOVE '&"S        G          (   #00011205' TO DFHEIV0
 13226     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13227     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13228     MOVE X'2020233030303131323035' TO DFHEIV0(25:11)
 13229     CALL 'kxdfhei1' USING DFHEIV0,
 13230           CNTL-FILE-ID,
 13231           DFHEIV20,
 13232           DFHEIV99,
 13233           BENEFIT-KEY,
 13234           DFHEIV99,
 13235           DFHEIV99,
 13236           DFHEIV99
 13237     SET ADDRESS OF CONTROL-FILE TO
 13238         DFHEIV20
 13239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13240
 13241
 13242     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 13243        CF-RECORD-TYPE NOT = '5'
 13244         MOVE ER-0250            TO EMI-ERROR
 13245         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13246         GO TO 5030-MOVE-CERT-FINISH.
 13247
 13248     MOVE ZERO                   TO COUNT-2.
 13249     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 13250
 13251     IF SCREEN-ERROR
 13252         MOVE ER-0283            TO EMI-ERROR
 13253         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13254       ELSE
 13255         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 13256
 13257 5030-MOVE-CERT-FINISH.
 13258
 13259     MOVE CM-LOAN-APR            TO APRO.
 13260     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 13261     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 13262     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 13263     MOVE CM-LOAN-NUMBER         TO LOANNOO
 13264     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 13265     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 13266
 13267     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 13268         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 13269         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13270         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13271         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 13272     ELSE
 13273         MOVE SPACES               TO ADDONDTO.
 13274
 13275     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 13276
 13277 5030-EXIT.
 13278     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 252
* EL131.cbl
 13280 5040-FIND-BENEFIT.
 13281     ADD 1                       TO COUNT-2.
 13282     IF COUNT-2 GREATER THAN 8
 13283         GO TO 5050-BENEFIT-NOTFND.
 13284
 13285     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 13286         GO TO 5060-EXIT.
 13287
 13288     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 13289         GO TO 5050-BENEFIT-NOTFND.
 13290
 13291     GO TO 5040-FIND-BENEFIT.
 13292
 13293 5050-BENEFIT-NOTFND.
 13294     MOVE 'X'                    TO ERROR-SWITCH.
 13295
 13296 5060-EXIT.
 13297     EXIT.
 13298
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 253
* EL131.cbl
 13300 6000-CALCULATE-CERT-TERM.
 13301
 13302     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 13303         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 13304     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 13305         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 13306     IF CM-LOAN-APR NOT NUMERIC
 13307         MOVE ZEROS              TO CM-LOAN-APR.
 13308
 13309*    IF WS-CALC-METHOD  = 'G'
 13310         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 13311*     ELSE
 13312*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 13313
 13314     IF N GREATER 120
 13315         MOVE 120                TO N.
 13316
 13317     MOVE '6'                    TO DC-OPTION-CODE.
 13318     MOVE N                      TO DC-ELAPSED-MONTHS.
 13319     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13320     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 13321
 13322     IF CM-LF-BENEFIT-CD NOT = ZERO
 13323         MOVE N                  TO CM-LF-ORIG-TERM
 13324         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 13325         IF NO-CONVERSION-ERROR
 13326             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 13327
 13328     IF CM-AH-BENEFIT-CD NOT = ZERO
 13329         MOVE N                  TO CM-AH-ORIG-TERM
 13330         IF NO-CONVERSION-ERROR
 13331             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 13332
 13333 6000-EXIT.
 13334      EXIT.
 13335
 13336 6100-CALC-GROSS-TERM.
 13337     MOVE CM-LOAN-BALANCE         TO L.
 13338     MOVE PI-PAYMENT-AMT          TO M.
 13339
 13340     COMPUTE N = L / M.
 13341     IF N LESS 1
 13342         MOVE 1  TO N.
 13343
 13344     IF CM-LF-BENEFIT-CD NOT = ZERO
 13345         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 13346     ELSE
 13347         MOVE ZEROS               TO WS-LF-RATE.
 13348
 13349     IF CM-AH-BENEFIT-CD NOT = ZERO
 13350         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 13351     ELSE
 13352         MOVE ZEROS               TO WS-AH-RATE.
 13353
 13354     COMPUTE I = CM-LOAN-APR / +1200.
 13355
 13356 6105-LOOP.
 13357     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 254
* EL131.cbl
 13358         GO TO 6200-EXIT.
 13359     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 13360     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 13361         ADD 1 TO N
 13362         GO TO 6105-LOOP.
 13363
 13364 6200-EXIT.
 13365      EXIT.
 13366
 13367 6210-CALC-LEFT-RIGHTONE.
 13368      MOVE L         TO LEFT-TOT-1.
 13369      SUBTRACT 1 FROM N.
 13370      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 13371      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 13372      ADD 1 TO N.
 13373 6211-CALC-TERM1.
 13374      MOVE N         TO TERM1.
 13375      MULTIPLY M BY TERM1.
 13376 6212-LOOP.
 13377      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 13378      ADD 1 TO A-N.
 13379      MULTIPLY A-N BY TERM1.
 13380      SUBTRACT 1 FROM A-N.
 13381      ADD TERM1 TO LEFT-TOT-1.
 13382 6213-CALC-TERM2.
 13383      MOVE M         TO TERM2.
 13384      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 13385      MULTIPLY IA-N BY TERM2.
 13386      SUBTRACT TERM2 FROM LEFT-TOT-1.
 13387 6215-CALC-RIGHTONE.
 13388      MOVE M         TO RIGHT-TOT-1.
 13389      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 13390      MULTIPLY A-N BY RIGHT-TOT-1.
 13391 6220-EXIT.
 13392      EXIT.
 13393
 13394 6300-CALC-A-N.
 13395     IF N LESS 1
 13396         MOVE 0     TO A-N
 13397         GO TO 6300-EXIT.
 13398     IF I = 0
 13399         MOVE .00001 TO I.
 13400     ADD 1 TO I.
 13401     DIVIDE I INTO 1 GIVING V.
 13402     SUBTRACT 1 FROM I.
 13403     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 13404     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 13405     DIVIDE I INTO TERM3 GIVING A-N.
 13406 6300-EXIT.
 13407      EXIT.
 13408
 13409 6350-CALC-IA-N.
 13410     IF N LESS 1
 13411         MOVE 0      TO IA-N
 13412         GO TO 6400-EXIT.
 13413     ADD 1 TO N.
 13414     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 13415     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 255
* EL131.cbl
 13416     MULTIPLY N BY V-EX-N GIVING TERM3.
 13417     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 13418     SUBTRACT V FROM 1 GIVING TERM4.
 13419     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 13420 6400-EXIT.
 13421      EXIT.
 13422
 13423 6450-CALC-V-EX-N.
 13424     IF N LESS 1
 13425         MOVE 1    TO V-EX-N
 13426         GO TO 6490-EXIT.
 13427     MOVE N        TO NV-STORE.
 13428     IF V-EX-ONETIME = 1  OR
 13429        V NOT = V-EXPONENT (1)
 13430          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 13431 6460-LOOP.
 13432     IF N GREATER 248
 13433         MOVE 248 TO N.
 13434     IF N = 1
 13435         MOVE V               TO V-EX-N
 13436      ELSE
 13437         MOVE V-EXPONENT (N)  TO V-EX-N.
 13438     GO TO 6490-EXIT.
 13439
 13440 6470-BUILD-V-EX-TABLE.
 13441     MOVE 2      TO N.
 13442     MOVE V      TO V-EXPONENT (1)
 13443                    V-EX-N.
 13444 6471-LOOP.
 13445     MULTIPLY V BY V-EX-N.
 13446     MOVE V-EX-N   TO V-EXPONENT (N).
 13447     ADD 1 TO N.
 13448     IF N LESS 248
 13449         GO TO 6471-LOOP.
 13450     MOVE NV-STORE     TO N.
 13451     MOVE 0            TO V-EX-ONETIME.
 13452 6480-EXIT.
 13453      EXIT.
 13454
 13455 6490-EXIT.
 13456      EXIT.
 13457
 13458 6500-CALC-NET-TERM.
 13459     MOVE CM-LOAN-BALANCE         TO L.
 13460     MOVE PI-PAYMENT-AMT          TO M.
 13461
 13462     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 13463     IF WS-REMAIN GREATER ZERO
 13464         ADD 1 TO N.
 13465     IF N = 0
 13466         MOVE 1 TO N.
 13467
 13468 6700-EXIT.
 13469      EXIT.
 13470
 13471 6999-CALC-TERM-EXIT.
 13472     EXIT.
 13473
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 256
* EL131.cbl
 13475 7000-RESET-ATTRIBUTE.
 13476
 13477     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 13478                                    CERTSTA   CERTCARA
 13479                                    CERTGRPA.
 13480     MOVE -1                     TO CERTCARL.
 13481
 13482 7000-EXIT.
 13483     EXIT.
 13484
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 257
* EL131.cbl
 13486 7600-BROWSE-CLAIM.
 13487
 13488
 13489* EXEC CICS READ
 13490*        DATASET(CLMS-FILE-ID)
 13491*        SET    (ADDRESS OF CLAIM-MASTER)
 13492*        RIDFLD (MSTR-KEY)
 13493*        GENERIC
 13494*        EQUAL
 13495*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 13496*    END-EXEC.
 13497*    MOVE '&"S  KG    E          (   #00011457' TO DFHEIV0
 13498     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 13499     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13500     MOVE X'2020233030303131343537' TO DFHEIV0(25:11)
 13501     CALL 'kxdfhei1' USING DFHEIV0,
 13502           CLMS-FILE-ID,
 13503           DFHEIV20,
 13504           DFHEIV99,
 13505           MSTR-KEY,
 13506           ELMSTR-GENERIC-LENGTH,
 13507           DFHEIV99,
 13508           DFHEIV99
 13509     SET ADDRESS OF CLAIM-MASTER TO
 13510         DFHEIV20
 13511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13512
 13513
 13514     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 13515
 13516     if cl-assoc-cert-total = 0
 13517        move 1 to cl-assoc-cert-total
 13518     end-if
 13519     IF CL-ASSOC-CERT-SEQU = 0
 13520        MOVE 1 TO CL-ASSOC-CERT-SEQU
 13521     END-IF
 13522
 13523     IF CL-ASSOC-CERT-TOTAL = 1
 13524         MOVE AL-SADOF           TO BCERT1A
 13525                                    BSUFX1A
 13526                                    BCERT2A
 13527                                    BSUFX2A
 13528                                    BCERT3A
 13529                                    BSUFX3A
 13530                                    BCERT4A
 13531                                    BSUFX4A
 13532                                    BCERT5A
 13533                                    BSUFX5A
 13534                                    PCERTNOA
 13535                                    PSUFXA
 13536                                    LABEL1A
 13537                                    LABEL2A
 13538         GO TO 7699-EXIT.
 13539
 13540 7610-BROWSE-CLAIM-LOOP.
 13541
 13542     MOVE LOW-VALUES             TO BCERT1O
 13543                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 258
* EL131.cbl
 13544                                    BCERT2O
 13545                                    BSUFX2O
 13546                                    BCERT3O
 13547                                    BSUFX3O
 13548                                    BCERT4O
 13549                                    BSUFX4O
 13550                                    BCERT5O
 13551                                    BSUFX5O.
 13552
 13553
 13554* EXEC CICS HANDLE CONDITION
 13555*        ENDFILE  (7630-END-BROWSE)
 13556*    END-EXEC.
 13557*    MOVE '"$''                   ! C #00011505' TO DFHEIV0
 13558     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 13559     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13560     MOVE X'4320233030303131353035' TO DFHEIV0(25:11)
 13561     CALL 'kxdfhei1' USING DFHEIV0
 13562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13563
 13564
 13565
 13566* EXEC CICS STARTBR
 13567*        DATASET    (CLMS-FILE-ID)
 13568*        RIDFLD     (MSTR-KEY)
 13569*    END-EXEC.
 13570     MOVE 0
 13571       TO DFHEIV11
 13572*    MOVE '&,         G          &   #00011509' TO DFHEIV0
 13573     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13574     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13575     MOVE X'2020233030303131353039' TO DFHEIV0(25:11)
 13576     CALL 'kxdfhei1' USING DFHEIV0,
 13577           CLMS-FILE-ID,
 13578           MSTR-KEY,
 13579           DFHEIV99,
 13580           DFHEIV11,
 13581           DFHEIV99
 13582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13583
 13584
 13585     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 13586
 13587 7620-READ-CLAIM-LOOP.
 13588
 13589
 13590* EXEC CICS READNEXT
 13591*        DATASET   (CLMS-FILE-ID)
 13592*        SET       (ADDRESS OF CLAIM-MASTER)
 13593*        RIDFLD    (MSTR-KEY)
 13594*    END-EXEC.
 13595     MOVE 0
 13596       TO DFHEIV11
 13597*    MOVE '&.S                   )   #00011518' TO DFHEIV0
 13598     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13599     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13600     MOVE X'2020233030303131353138' TO DFHEIV0(25:11)
 13601     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 259
* EL131.cbl
 13602           CLMS-FILE-ID,
 13603           DFHEIV20,
 13604           DFHEIV99,
 13605           MSTR-KEY,
 13606           DFHEIV99,
 13607           DFHEIV11,
 13608           DFHEIV99,
 13609           DFHEIV99
 13610     SET ADDRESS OF CLAIM-MASTER TO
 13611         DFHEIV20
 13612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13613
 13614
 13615     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 13616        CL-CARRIER     NOT = CARRI           OR
 13617        CL-CLAIM-NO    NOT = CLAIMI
 13618        GO TO 7630-END-BROWSE.
 13619
 13620     IF WS-ASSOCIATED-CERTS = 1
 13621         MOVE CL-CERT-PRIME      TO BCERT1O
 13622         MOVE CL-CERT-SFX        TO BSUFX1O.
 13623
 13624     IF WS-ASSOCIATED-CERTS = 2
 13625         MOVE CL-CERT-PRIME      TO BCERT2O
 13626         MOVE CL-CERT-SFX        TO BSUFX2O.
 13627
 13628     IF WS-ASSOCIATED-CERTS = 3
 13629         MOVE CL-CERT-PRIME      TO BCERT3O
 13630         MOVE CL-CERT-SFX        TO BSUFX3O.
 13631
 13632     IF WS-ASSOCIATED-CERTS = 4
 13633         MOVE CL-CERT-PRIME      TO BCERT4O
 13634         MOVE CL-CERT-SFX        TO BSUFX4O.
 13635
 13636     IF WS-ASSOCIATED-CERTS = 5
 13637         MOVE CL-CERT-PRIME      TO BCERT5O
 13638         MOVE CL-CERT-SFX        TO BSUFX5O
 13639     ELSE
 13640         ADD +1                  TO WS-ASSOCIATED-CERTS
 13641         GO TO 7620-READ-CLAIM-LOOP.
 13642
 13643 7630-END-BROWSE.
 13644
 13645
 13646* EXEC CICS ENDBR
 13647*        DATASET   (CLMS-FILE-ID)
 13648*    END-EXEC.
 13649     MOVE 0
 13650       TO DFHEIV11
 13651*    MOVE '&2                    $   #00011554' TO DFHEIV0
 13652     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13653     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13654     MOVE X'2020233030303131353534' TO DFHEIV0(25:11)
 13655     CALL 'kxdfhei1' USING DFHEIV0,
 13656           CLMS-FILE-ID,
 13657           DFHEIV11,
 13658           DFHEIV99
 13659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 260
* EL131.cbl
 13660
 13661
 13662 7640-HIGHLIGHT-CERT-DISPLAYED.
 13663
 13664     MOVE AL-SANON               TO BCERT1A
 13665                                    BSUFX1A
 13666                                    BCERT2A
 13667                                    BSUFX2A
 13668                                    BCERT3A
 13669                                    BSUFX3A
 13670                                    BCERT4A
 13671                                    BSUFX4A
 13672                                    BCERT5A
 13673                                    BSUFX5A.
 13674
 13675     IF BCERT1O = CERTI AND
 13676        BSUFX1O = SUFXI
 13677            MOVE AL-SABON        TO BCERT1A
 13678                                    BSUFX1A.
 13679
 13680     IF BCERT2O = CERTI AND
 13681        BSUFX2O = SUFXI
 13682            MOVE AL-SABON        TO BCERT2A
 13683                                    BSUFX2A.
 13684
 13685     IF BCERT3O = CERTI AND
 13686        BSUFX3O = SUFXI
 13687            MOVE AL-SABON        TO BCERT3A
 13688                                    BSUFX3A.
 13689
 13690     IF BCERT4O = CERTI AND
 13691        BSUFX4O = SUFXI
 13692            MOVE AL-SABON        TO BCERT4A
 13693                                    BSUFX4A.
 13694
 13695     IF BCERT5O = CERTI AND
 13696        BSUFX5O = SUFXI
 13697            MOVE AL-SABON        TO BCERT5A
 13698                                    BSUFX5A.
 13699
 13700 7699-EXIT.
 13701     EXIT.
 13702
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 261
* EL131.cbl
 13704 7700-CHECK-SEQUENCE.
 13705
 13706
 13707* EXEC CICS HANDLE CONDITION
 13708*        ENDFILE  (7799-EXIT)
 13709*        NOTFND   (7799-EXIT)
 13710*    END-EXEC.
 13711*    MOVE '"$''I                  ! D #00011602' TO DFHEIV0
 13712     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 13713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13714     MOVE X'4420233030303131363032' TO DFHEIV0(25:11)
 13715     CALL 'kxdfhei1' USING DFHEIV0
 13716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13717
 13718
 13719
 13720* EXEC CICS READ
 13721*        DATASET(CLMS-FILE-ID)
 13722*        SET    (ADDRESS OF CLAIM-MASTER)
 13723*        RIDFLD (MSTR-KEY)
 13724*        GENERIC
 13725*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 13726*    END-EXEC.
 13727*    MOVE '&"S  KG    E          (   #00011607' TO DFHEIV0
 13728     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 13729     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13730     MOVE X'2020233030303131363037' TO DFHEIV0(25:11)
 13731     CALL 'kxdfhei1' USING DFHEIV0,
 13732           CLMS-FILE-ID,
 13733           DFHEIV20,
 13734           DFHEIV99,
 13735           MSTR-KEY,
 13736           ELMSTR-GENERIC-LENGTH,
 13737           DFHEIV99,
 13738           DFHEIV99
 13739     SET ADDRESS OF CLAIM-MASTER TO
 13740         DFHEIV20
 13741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13742
 13743
 13744     COMPUTE WS-ASSOC-CERT-TOTAL =
 13745             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 13746
 13747     GO TO 7799-EXIT.
 13748
 13749 7710-RESEQUENCE-CLAIMS.
 13750
 13751
 13752* EXEC CICS HANDLE CONDITION
 13753*        ENDFILE  (7799-EXIT)
 13754*    END-EXEC.
 13755*    MOVE '"$''                   ! E #00011622' TO DFHEIV0
 13756     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 13757     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13758     MOVE X'4520233030303131363232' TO DFHEIV0(25:11)
 13759     CALL 'kxdfhei1' USING DFHEIV0
 13760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13761
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 262
* EL131.cbl
 13762
 13763
 13764* EXEC CICS STARTBR
 13765*        DATASET(CLMS-FILE-ID)
 13766*        RIDFLD (MSTR-KEY)
 13767*    END-EXEC.
 13768     MOVE 0
 13769       TO DFHEIV11
 13770*    MOVE '&,         G          &   #00011626' TO DFHEIV0
 13771     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13772     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13773     MOVE X'2020233030303131363236' TO DFHEIV0(25:11)
 13774     CALL 'kxdfhei1' USING DFHEIV0,
 13775           CLMS-FILE-ID,
 13776           MSTR-KEY,
 13777           DFHEIV99,
 13778           DFHEIV11,
 13779           DFHEIV99
 13780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13781
 13782
 13783     COMPUTE WS-ASSOC-CERT-SEQU =
 13784             WS-ASSOC-CERT-SEQU + 1.
 13785
 13786     COMPUTE WS-READNEXT-SWITCH =
 13787             WS-READNEXT-SWITCH + 1.
 13788
 13789 7720-READ-CLAIM-LOOP.
 13790
 13791
 13792* EXEC CICS READNEXT
 13793*        DATASET(CLMS-FILE-ID)
 13794*        SET    (ADDRESS OF CLAIM-MASTER)
 13795*        RIDFLD (MSTR-KEY)
 13796*    END-EXEC.
 13797     MOVE 0
 13798       TO DFHEIV11
 13799*    MOVE '&.S                   )   #00011639' TO DFHEIV0
 13800     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13801     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13802     MOVE X'2020233030303131363339' TO DFHEIV0(25:11)
 13803     CALL 'kxdfhei1' USING DFHEIV0,
 13804           CLMS-FILE-ID,
 13805           DFHEIV20,
 13806           DFHEIV99,
 13807           MSTR-KEY,
 13808           DFHEIV99,
 13809           DFHEIV11,
 13810           DFHEIV99,
 13811           DFHEIV99
 13812     SET ADDRESS OF CLAIM-MASTER TO
 13813         DFHEIV20
 13814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13815
 13816
 13817     IF WS-READNEXT-SWITCH = 1
 13818         ADD 1                   TO WS-READNEXT-SWITCH
 13819         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 263
* EL131.cbl
 13820
 13821 7730-END-BROWSE.
 13822
 13823
 13824* EXEC CICS ENDBR
 13825*        DATASET(CLMS-FILE-ID)
 13826*    END-EXEC.
 13827     MOVE 0
 13828       TO DFHEIV11
 13829*    MOVE '&2                    $   #00011651' TO DFHEIV0
 13830     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13831     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13832     MOVE X'2020233030303131363531' TO DFHEIV0(25:11)
 13833     CALL 'kxdfhei1' USING DFHEIV0,
 13834           CLMS-FILE-ID,
 13835           DFHEIV11,
 13836           DFHEIV99
 13837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13838
 13839
 13840 7740-READ-CLAIM-UPDATE.
 13841
 13842     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 13843        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 13844        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 13845        GO TO 7799-EXIT
 13846     ELSE
 13847        MOVE ZERO                TO WS-READNEXT-SWITCH.
 13848
 13849
 13850* EXEC CICS READ
 13851*        DATASET(CLMS-FILE-ID)
 13852*        SET    (ADDRESS OF CLAIM-MASTER)
 13853*        RIDFLD (MSTR-KEY)
 13854*        UPDATE
 13855*    END-EXEC.
 13856*    MOVE '&"S        EU         (   #00011664' TO DFHEIV0
 13857     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13858     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13859     MOVE X'2020233030303131363634' TO DFHEIV0(25:11)
 13860     CALL 'kxdfhei1' USING DFHEIV0,
 13861           CLMS-FILE-ID,
 13862           DFHEIV20,
 13863           DFHEIV99,
 13864           MSTR-KEY,
 13865           DFHEIV99,
 13866           DFHEIV99,
 13867           DFHEIV99
 13868     SET ADDRESS OF CLAIM-MASTER TO
 13869         DFHEIV20
 13870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13871
 13872
 13873     if (cl-priority-cd = '8')
 13874        and (pi-processor-id not = 'PEMA' and 'JMS '
 13875             AND 'AMWA')
 13876        MOVE ER-8003             TO EMI-ERROR
 13877        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 264
* EL131.cbl
 13878                                 THRU 9900-EXIT
 13879        MOVE -1                  TO MAINTL
 13880        GO TO 8110-SEND-DATA
 13881     end-if
 13882
 13883     IF PI-COMPANY-ID = 'CID' or 'AHL'
 13884         MOVE 'Y'                TO CL-YESNOSW
 13885     END-IF.
 13886
 13887     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 13888     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 13889
 13890
 13891* EXEC CICS REWRITE
 13892*         DATASET(CLMS-FILE-ID)
 13893*         FROM   (CLAIM-MASTER)
 13894*    END-EXEC.
 13895     MOVE LENGTH OF
 13896      CLAIM-MASTER
 13897       TO DFHEIV11
 13898*    MOVE '&& L                  %   #00011688' TO DFHEIV0
 13899     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13900     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13901     MOVE X'2020233030303131363838' TO DFHEIV0(25:11)
 13902     CALL 'kxdfhei1' USING DFHEIV0,
 13903           CLMS-FILE-ID,
 13904           CLAIM-MASTER,
 13905           DFHEIV11,
 13906           DFHEIV99
 13907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13908
 13909
 13910     GO TO 7710-RESEQUENCE-CLAIMS.
 13911
 13912 7799-EXIT.
 13913     EXIT.
 13914
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 265
* EL131.cbl
 13916 7800-CHECK-AUTO-ACTIVITY.
 13917
 13918
 13919* EXEC CICS HANDLE CONDITION
 13920*        NOTFND   (7800-NOT-FOUND)
 13921*    END-EXEC.
 13922*    MOVE '"$I                   ! F #00011701' TO DFHEIV0
 13923     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13924     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13925     MOVE X'4620233030303131373031' TO DFHEIV0(25:11)
 13926     CALL 'kxdfhei1' USING DFHEIV0
 13927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13928
 13929
 13930     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 13931     MOVE 'T'                        TO  CNTL-REC-TYPE.
 13932     MOVE SPACES                     TO  CNTL-PROC-ID.
 13933     MOVE +0                         TO  CNTL-SEQ-NO.
 13934
 13935
 13936* EXEC CICS READ
 13937*        DATASET   (CNTL-FILE-ID)
 13938*        RIDFLD    (CNTL-KEY)
 13939*        SET       (ADDRESS OF CONTROL-FILE)
 13940*    END-EXEC.
 13941*    MOVE '&"S        E          (   #00011710' TO DFHEIV0
 13942     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13943     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13944     MOVE X'2020233030303131373130' TO DFHEIV0(25:11)
 13945     CALL 'kxdfhei1' USING DFHEIV0,
 13946           CNTL-FILE-ID,
 13947           DFHEIV20,
 13948           DFHEIV99,
 13949           CNTL-KEY,
 13950           DFHEIV99,
 13951           DFHEIV99,
 13952           DFHEIV99
 13953     SET ADDRESS OF CONTROL-FILE TO
 13954         DFHEIV20
 13955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13956
 13957
 13958     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 13959         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 13960
 13961     IF CL-ACTIVITY-CODE NOT = ZEROS
 13962         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 13963         IF MISC-SUB IS GREATER THAN +9
 13964             SUBTRACT +9 FROM MISC-SUB
 13965             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 13966         ELSE
 13967             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 13968     ELSE
 13969         MOVE 'Y'                              TO  WS-RESET-SW.
 13970
 13971     IF STATUSI = 'C' OR 'CLOSED'
 13972         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 13973             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 266
* EL131.cbl
 13974                                         PI-LETTER-SW
 13975             GO TO 7800-EXIT.
 13976
 13977     IF STATUSI = 'C' OR 'CLOSED'
 13978         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 13979             MOVE 'N'                TO  PI-LETTER-SW
 13980         ELSE
 13981             MOVE 'Y'                TO  PI-LETTER-SW.
 13982
 13983     IF STATUSI = 'O' OR 'OPEN'
 13984         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 13985             MOVE 'N'                TO  PI-REC-FOUND-SW
 13986                                         PI-LETTER-SW
 13987             GO TO 7800-EXIT.
 13988
 13989     IF STATUSI = 'O' OR 'OPEN'
 13990         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 13991             MOVE 'N'                TO  PI-LETTER-SW
 13992         ELSE
 13993             MOVE 'Y'                TO  PI-LETTER-SW.
 13994
 13995     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 13996     GO TO 7800-EXIT.
 13997
 13998 7800-NOT-FOUND.
 13999
 14000     MOVE 'N'                        TO  PI-REC-FOUND-SW
 14001                                         PI-LETTER-SW.
 14002
 14003 7800-EXIT.
 14004     EXIT.
 14005
 14006 7850-AUTO-LETTER-WRITER.
 14007
 14008     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 14009     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 14010
 14011     IF STATUSI = 'C' OR 'CLOSED'
 14012         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 14013     ELSE
 14014         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 14015
 14016     IF STATUSI = 'C' OR 'CLOSED'
 14017         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 14018             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14019             MOVE '6'                TO  DC-OPTION-CODE
 14020             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 14021             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14022             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14023             IF NO-CONVERSION-ERROR
 14024                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 14025             ELSE
 14026                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 14027
 14028     IF STATUSI = 'C' OR 'CLOSED'
 14029         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 14030             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14031             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 267
* EL131.cbl
 14032             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 14033             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14034             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14035             IF NO-CONVERSION-ERROR
 14036                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 14037             ELSE
 14038                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 14039
 14040     IF STATUSI = 'O' OR 'OPEN'
 14041         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 14042             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14043             MOVE '6'                TO  DC-OPTION-CODE
 14044             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 14045             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14046             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14047             IF NO-CONVERSION-ERROR
 14048                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 14049             ELSE
 14050                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 14051
 14052     IF STATUSI = 'O' OR 'OPEN'
 14053         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 14054             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14055             MOVE '6'                TO  DC-OPTION-CODE
 14056             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 14057             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14058             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14059             IF NO-CONVERSION-ERROR
 14060                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 14061             ELSE
 14062                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 14063
 14064
 14065* EXEC CICS LINK
 14066*        PROGRAM    (LINK-1523)
 14067*        COMMAREA   (W-1523-LINKDATA)
 14068*        LENGTH     (W-1523-COMM-LENGTH)
 14069*    END-EXEC.
 14070*    MOVE '."C                   (   #00011822' TO DFHEIV0
 14071     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14073     MOVE X'2020233030303131383232' TO DFHEIV0(25:11)
 14074     CALL 'kxdfhei1' USING DFHEIV0,
 14075           LINK-1523,
 14076           W-1523-LINKDATA,
 14077           W-1523-COMM-LENGTH,
 14078           DFHEIV99,
 14079           DFHEIV99,
 14080           DFHEIV99,
 14081           DFHEIV99
 14082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14083
 14084
 14085     IF W-1523-ERROR-CODE = ZEROS
 14086         GO TO 7850-EXIT.
 14087
 14088     IF W-1523-FATAL-ERROR
 14089         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 268
* EL131.cbl
 14090         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14091
 14092     IF W-1523-ERROR-CODE = 0191
 14093         MOVE ER-0803                TO  EMI-ERROR
 14094         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14095
 14096 7850-EXIT.
 14097     EXIT.
 14098
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 269
* EL131.cbl
 14100 8000-CREATE-DMO-REC.
 14101     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 14102     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 14103     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 14104
 14105
 14106* EXEC CICS HANDLE CONDITION
 14107*         NOTFND   (8000-NOTE-NOT-FOUND)
 14108*    END-EXEC.
 14109*    MOVE '"$I                   ! G #00011848' TO DFHEIV0
 14110     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14111     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14112     MOVE X'4720233030303131383438' TO DFHEIV0(25:11)
 14113     CALL 'kxdfhei1' USING DFHEIV0
 14114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14115
 14116
 14117
 14118* EXEC CICS READ
 14119*         DATASET(NOTE-FILE-ID)
 14120*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14121*         RIDFLD (NOTE-KEY)
 14122*    END-EXEC.
 14123*    MOVE '&"S        E          (   #00011852' TO DFHEIV0
 14124     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14125     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14126     MOVE X'2020233030303131383532' TO DFHEIV0(25:11)
 14127     CALL 'kxdfhei1' USING DFHEIV0,
 14128           NOTE-FILE-ID,
 14129           DFHEIV20,
 14130           DFHEIV99,
 14131           NOTE-KEY,
 14132           DFHEIV99,
 14133           DFHEIV99,
 14134           DFHEIV99
 14135     SET ADDRESS OF CERTIFICATE-NOTE TO
 14136         DFHEIV20
 14137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14138
 14139
 14140     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14141     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14142     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14143
 14144     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 14145         MOVE 'CC'               TO DCT-PRODUCT-CODE
 14146     ELSE
 14147         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14148
 14149     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14150     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14151
 14152
 14153* EXEC CICS LINK
 14154*        PROGRAM    ('DLO006')
 14155*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14156*        LENGTH     (WS-DCT-LENGTH)
 14157*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 270
* EL131.cbl
 14158     MOVE 'DLO006' TO DFHEIV1
 14159*    MOVE '."C                   (   #00011870' TO DFHEIV0
 14160     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14162     MOVE X'2020233030303131383730' TO DFHEIV0(25:11)
 14163     CALL 'kxdfhei1' USING DFHEIV0,
 14164           DFHEIV1,
 14165           DCT-COMMUNICATION-AREA,
 14166           WS-DCT-LENGTH,
 14167           DFHEIV99,
 14168           DFHEIV99,
 14169           DFHEIV99,
 14170           DFHEIV99
 14171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14172
 14173
 14174     IF  DCT-RETURN-CODE = 'OK'
 14175         GO TO 8000-CONT.
 14176
 14177     IF DCT-RETURN-CODE = '01' OR '02'
 14178         GO TO 8000-EXIT.
 14179
 14180     IF DCT-RETURN-CODE = '03'
 14181         MOVE ER-0951            TO EMI-ERROR
 14182         MOVE -1                 TO MAINTL
 14183         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14184         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14185         GO TO 8110-SEND-DATA.
 14186
 14187     IF DCT-RETURN-CODE = '04'
 14188         MOVE ER-0946            TO EMI-ERROR
 14189         MOVE -1                 TO MAINTL
 14190         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14191         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14192         GO TO 8110-SEND-DATA.
 14193
 14194     IF DCT-RETURN-CODE = '05'
 14195         MOVE ER-0947            TO EMI-ERROR
 14196         MOVE -1                 TO MAINTL
 14197         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14198         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14199         GO TO 8110-SEND-DATA.
 14200
 14201     IF DCT-RETURN-CODE = '06'
 14202         MOVE ER-0921            TO EMI-ERROR
 14203         MOVE -1                 TO MAINTL
 14204         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14205         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14206         GO TO 8110-SEND-DATA.
 14207
 14208     IF DCT-RETURN-CODE = '07'
 14209         MOVE ER-0919            TO EMI-ERROR
 14210         MOVE -1                 TO MAINTL
 14211         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14212         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14213         GO TO 8110-SEND-DATA.
 14214
 14215     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 271
* EL131.cbl
 14216         MOVE ER-0948            TO EMI-ERROR
 14217         MOVE -1                 TO MAINTL
 14218         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14219         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14220         GO TO 8110-SEND-DATA.
 14221
 14222     IF DCT-RETURN-CODE = 'N1'
 14223         MOVE ER-0950            TO EMI-ERROR
 14224         MOVE -1                 TO MAINTL
 14225         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14226         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14227         GO TO 8110-SEND-DATA.
 14228
 14229     IF DCT-RETURN-CODE = 'E1'
 14230         MOVE ER-0974            TO EMI-ERROR
 14231         MOVE -1                 TO MAINTL
 14232         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14233         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14234         GO TO 8110-SEND-DATA.
 14235
 14236     IF DCT-RETURN-CODE = 'E2'
 14237         MOVE ER-0975            TO EMI-ERROR
 14238         MOVE -1                 TO MAINTL
 14239         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14240         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14241         GO TO 8110-SEND-DATA.
 14242
 14243     IF DCT-RETURN-CODE NOT = 'OK'
 14244         MOVE ER-0949            TO EMI-ERROR
 14245         MOVE -1                 TO MAINTL
 14246         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14247         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14248         GO TO 8110-SEND-DATA.
 14249
 14250 8000-CONT.
 14251
 14252     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14253     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14254     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14255     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14256     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14257     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14258     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14259     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14260
 14261     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14262     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14263     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14264     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 14265     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14266
 14267     IF STATUSI = 'OPEN' OR 'O'
 14268         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 14269      ELSE
 14270         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 14271
 14272     IF STATUSI = 'OPEN' OR 'O'
 14273        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 272
* EL131.cbl
 14274         MOVE '1'                TO DM-CLAIM-STATUS
 14275      ELSE
 14276         MOVE '2'                TO DM-CLAIM-STATUS.
 14277
 14278     IF STATUSI = 'CLOSED' OR 'C'
 14279        IF NOT FINAL-PAID
 14280         MOVE '3'                TO DM-CLAIM-STATUS
 14281      ELSE
 14282         MOVE '4'                TO DM-CLAIM-STATUS.
 14283
 14284     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14285
 14286
 14287* EXEC CICS LINK
 14288*        PROGRAM    ('DLO025')
 14289*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14290*        LENGTH     (WS-DMO-LENGTH)
 14291*    END-EXEC.
 14292     MOVE 'DLO025' TO DFHEIV1
 14293*    MOVE '."C                   (   #00011988' TO DFHEIV0
 14294     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14295     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14296     MOVE X'2020233030303131393838' TO DFHEIV0(25:11)
 14297     CALL 'kxdfhei1' USING DFHEIV0,
 14298           DFHEIV1,
 14299           DMO-COMMUNICATION-AREA,
 14300           WS-DMO-LENGTH,
 14301           DFHEIV99,
 14302           DFHEIV99,
 14303           DFHEIV99,
 14304           DFHEIV99
 14305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14306
 14307
 14308     IF  DM-RETURN-CODE = 'OK'
 14309         GO TO 8000-EXIT.
 14310
 14311     IF DM-RETURN-CODE = '01'
 14312         MOVE ER-8051            TO EMI-ERROR
 14313         MOVE -1                 TO MAINTL
 14314         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14315         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14316         GO TO 8110-SEND-DATA.
 14317
 14318     IF DM-RETURN-CODE = '02'
 14319         MOVE ER-8052            TO EMI-ERROR
 14320         MOVE -1                 TO MAINTL
 14321         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14322         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14323         GO TO 8110-SEND-DATA.
 14324
 14325     IF DM-RETURN-CODE = '03'
 14326         MOVE ER-8053            TO EMI-ERROR
 14327         MOVE -1                 TO MAINTL
 14328         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14329         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14330         GO TO 8110-SEND-DATA.
 14331
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 273
* EL131.cbl
 14332     IF DM-RETURN-CODE = '04'
 14333         MOVE ER-8054            TO EMI-ERROR
 14334         MOVE -1                 TO MAINTL
 14335         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14336         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14337         GO TO 8110-SEND-DATA.
 14338
 14339     IF DM-RETURN-CODE = '05'
 14340         MOVE ER-8055            TO EMI-ERROR
 14341         MOVE -1                 TO MAINTL
 14342         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14343         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14344         GO TO 8110-SEND-DATA.
 14345
 14346     IF DM-RETURN-CODE = '06'
 14347         MOVE ER-8056            TO EMI-ERROR
 14348         MOVE -1                 TO MAINTL
 14349         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14350         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14351         GO TO 8110-SEND-DATA.
 14352
 14353     IF DM-RETURN-CODE = '07'
 14354         MOVE ER-8057            TO EMI-ERROR
 14355         MOVE -1                 TO MAINTL
 14356         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14357         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14358         GO TO 8110-SEND-DATA.
 14359
 14360     IF DM-RETURN-CODE = '08'
 14361         MOVE ER-8058            TO EMI-ERROR
 14362         MOVE -1                 TO MAINTL
 14363         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14364         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14365         GO TO 8110-SEND-DATA.
 14366
 14367     IF DM-RETURN-CODE = '09'
 14368         MOVE ER-8059            TO EMI-ERROR
 14369         MOVE -1                 TO MAINTL
 14370         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14371         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14372         GO TO 8110-SEND-DATA.
 14373
 14374     IF DM-RETURN-CODE = '10'
 14375         MOVE ER-8060            TO EMI-ERROR
 14376         MOVE -1                 TO MAINTL
 14377         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14378         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14379         GO TO 8110-SEND-DATA.
 14380
 14381     IF DM-RETURN-CODE = '11'
 14382         MOVE ER-8061            TO EMI-ERROR
 14383         MOVE -1                 TO MAINTL
 14384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14385         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14386         GO TO 8110-SEND-DATA.
 14387
 14388     IF DM-RETURN-CODE = '12'
 14389         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 274
* EL131.cbl
 14390         MOVE -1                 TO MAINTL
 14391         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14392         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14393         GO TO 8110-SEND-DATA.
 14394
 14395     IF DM-RETURN-CODE = '13'
 14396         MOVE ER-8063            TO EMI-ERROR
 14397         MOVE -1                 TO MAINTL
 14398         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14399         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14400         GO TO 8110-SEND-DATA.
 14401
 14402     IF DM-RETURN-CODE = '14'
 14403         MOVE ER-8064            TO EMI-ERROR
 14404         MOVE -1                 TO MAINTL
 14405         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14406         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14407         GO TO 8110-SEND-DATA.
 14408
 14409     IF DM-RETURN-CODE = '15'
 14410         MOVE ER-8065            TO EMI-ERROR
 14411         MOVE -1                 TO MAINTL
 14412         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14413         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14414         GO TO 8110-SEND-DATA.
 14415
 14416     IF DM-RETURN-CODE = '16'
 14417         MOVE ER-8154            TO EMI-ERROR
 14418         MOVE -1                 TO MAINTL
 14419         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14420         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14421         GO TO 8110-SEND-DATA.
 14422
 14423     IF DM-RETURN-CODE = '17'
 14424         MOVE ER-8155            TO EMI-ERROR
 14425         MOVE -1                 TO MAINTL
 14426         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14427         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14428         GO TO 8110-SEND-DATA.
 14429
 14430     IF DM-RETURN-CODE = 'N1'
 14431         MOVE ER-8152            TO EMI-ERROR
 14432         MOVE -1                 TO MAINTL
 14433         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14434         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14435         GO TO 8110-SEND-DATA.
 14436
 14437     IF DM-RETURN-CODE = 'E1'
 14438         MOVE ER-8153            TO EMI-ERROR
 14439         MOVE -1                 TO MAINTL
 14440         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14441         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14442         GO TO 8110-SEND-DATA.
 14443
 14444     MOVE ER-8066                TO EMI-ERROR.
 14445     MOVE -1                     TO MAINTL.
 14446     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14447     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 275
* EL131.cbl
 14448     GO TO 8110-SEND-DATA.
 14449
 14450 8000-NOTE-NOT-FOUND.
 14451
 14452* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14453*    MOVE '6"R                   !   #00012137' TO DFHEIV0
 14454     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14456     MOVE X'2020233030303132313337' TO DFHEIV0(25:11)
 14457     CALL 'kxdfhei1' USING DFHEIV0
 14458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14459
 14460     MOVE ER-0954                TO EMI-ERROR.
 14461     MOVE -1                     TO MAINTL.
 14462     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14463     GO TO 8110-SEND-DATA.
 14464
 14465 8000-EXIT.
 14466     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 276
* EL131.cbl
 14468 8050-FORMAT-LAST-NAME-1ST.
 14469*****************************************************************
 14470*             M O V E   N A M E   R O U T I N E                 *
 14471*                                                               *
 14472*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14473*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14474*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 14475*                                                               *
 14476*                  FIELD               VALUE                    *
 14477*                  -----               -----                    *
 14478*           W-NAME-LAST    (CL15)      SMITH                    *
 14479*           W-NAME-FIRST   (CL15)      JOHN                     *
 14480*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 14481*                                                               *
 14482*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 14483*                SMITH, JOHN ALLEN                              *
 14484*                     OR                                        *
 14485*                SMITH, JOHN A.                                 *
 14486*                                                               *
 14487*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 14488*     COPYBOOK, ELCNWA.                                         *
 14489*****************************************************************.
 14490
 14491     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 14492     MOVE ZERO                   TO WS-NAME-SW.
 14493     SET NWA-INDEX               TO +1.
 14494
 14495     IF W-NAME-LAST   = SPACES  AND
 14496        W-NAME-MIDDLE = SPACES
 14497          MOVE +1                TO WS-NAME-SW.
 14498
 14499     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14500     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 14501
 14502     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14503     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 14504
 14505     SET NWA-INDEX UP BY +1.
 14506
 14507     IF W-NAME-MIDDLE NOT = SPACES
 14508         IF W-NAME-MIDDLE-2 = SPACES
 14509             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14510             SET NWA-INDEX UP BY +1
 14511             MOVE '.'            TO WS-NW (NWA-INDEX)
 14512             SET NWA-INDEX UP BY +2
 14513         ELSE
 14514             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14515             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 14516
 14517 8050-EXIT.
 14518     EXIT.
 14519
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 277
* EL131.cbl
 14521 8060-MOVE-NAME.
 14522     IF WS-NAME-SW GREATER THAN +1
 14523         GO TO 8060-EXIT.
 14524
 14525     IF WS-NAME-WORK2 = SPACES
 14526         GO TO 8060-EXIT.
 14527
 14528     SET NWA-INDEX2            TO +1.
 14529     SET NWA-INDEX3            TO +2.
 14530
 14531 8060-MOVE-NAME-CYCLE.
 14532     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 14533
 14534     IF NWA-INDEX LESS THAN +30
 14535         SET NWA-INDEX UP BY +1
 14536     ELSE
 14537         ADD +2 TO  WS-NAME-SW
 14538         GO TO 8060-EXIT.
 14539
 14540     IF NWA-INDEX2 LESS THAN +20
 14541         SET NWA-INDEX3 UP BY +1
 14542         SET NWA-INDEX2 UP BY +1.
 14543
 14544     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 14545        WS-NW2 (NWA-INDEX3) = SPACES
 14546         IF WS-NAME-SW = ZERO
 14547             MOVE ','            TO WS-NW (NWA-INDEX)
 14548             SET NWA-INDEX UP BY +2
 14549             MOVE +1             TO WS-NAME-SW
 14550             GO TO 8060-EXIT
 14551         ELSE
 14552             GO TO 8060-EXIT.
 14553
 14554     GO TO 8060-MOVE-NAME-CYCLE.
 14555
 14556 8060-EXIT.
 14557     EXIT.
 14558
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 278
* EL131.cbl
 14560
 14561 8070-UNLOCK-CLAIM-MSTR.
 14562
 14563* EXEC CICS UNLOCK
 14564*        DATASET   (CLMS-FILE-ID)
 14565*    END-EXEC.
 14566*    MOVE '&*                    #   #00012240' TO DFHEIV0
 14567     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 14568     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14569     MOVE X'2020233030303132323430' TO DFHEIV0(25:11)
 14570     CALL 'kxdfhei1' USING DFHEIV0,
 14571           CLMS-FILE-ID,
 14572           DFHEIV99
 14573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14574
 14575
 14576 8070-EXIT.
 14577      EXIT.
 14578
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 279
* EL131.cbl
 14580 8100-SEND-MAP.
 14581     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 14582
 14583     IF NOT PI-NO-CARRIER-SECURITY
 14584        MOVE AL-SANOF            TO CERTCARA.
 14585     IF NOT PI-NO-ACCOUNT-SECURITY
 14586        MOVE AL-SANOF            TO CERTACTA.
 14587
 14588     IF PI-PROCESSOR-ID = 'LGXX'
 14589        MOVE AL-UANON            TO CCNOA.
 14590
 14591     IF PI-COMPANY-ID = 'DMD'
 14592        NEXT SENTENCE
 14593     ELSE
 14594        MOVE AL-SADOF            TO PFKEY6A.
 14595
 14596     IF PI-USES-PAID-TO
 14597        MOVE 'PAID TO  :' TO PTHRHDGO.
 14598
 14599
 14600* EXEC CICS SEND
 14601*         MAP     ('EL131A')
 14602*         MAPSET  ('EL131S')
 14603*         ERASE
 14604*         FREEKB
 14605*         CURSOR
 14606*    END-EXEC.
 14607     MOVE 'EL131A' TO DFHEIV1
 14608     MOVE -1
 14609       TO DFHEIV11
 14610     MOVE 'EL131S' TO DFHEIV2
 14611*    MOVE '8$     CT  E F  H     ,   #00012267' TO DFHEIV0
 14612     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 14613     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 14614     MOVE X'2020233030303132323637' TO DFHEIV0(25:11)
 14615     CALL 'kxdfhei1' USING DFHEIV0,
 14616           DFHEIV1,
 14617           EL131AO,
 14618           DFHEIV99,
 14619           DFHEIV2,
 14620           DFHEIV99,
 14621           DFHEIV99,
 14622           DFHEIV99,
 14623           DFHEIV11,
 14624           DFHEIV99,
 14625           DFHEIV99,
 14626           DFHEIV99
 14627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14628
 14629
 14630     GO TO 9000-RETURN-TRANS.
 14631
 14632 8110-SEND-DATA.
 14633     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 14634
 14635     IF PI-USES-PAID-TO
 14636        MOVE 'PAID TO  :' TO PTHRHDGO.
 14637
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 280
* EL131.cbl
 14638     IF PI-PROCESSOR-ID = 'LGXX'
 14639        MOVE AL-UANON            TO CCNOA.
 14640
 14641     IF PI-COMPANY-ID = 'DMD'
 14642        NEXT SENTENCE
 14643     ELSE
 14644        MOVE AL-SADOF            TO PFKEY6A.
 14645
 14646
 14647* EXEC CICS SEND
 14648*         MAP      ('EL131A')
 14649*         MAPSET   ('EL131S')
 14650*         DATAONLY
 14651*         FREEKB
 14652*         CURSOR
 14653*    END-EXEC.
 14654     MOVE 'EL131A' TO DFHEIV1
 14655     MOVE -1
 14656       TO DFHEIV11
 14657     MOVE 'EL131S' TO DFHEIV2
 14658*    MOVE '8$D    CT    F  H     ,   #00012291' TO DFHEIV0
 14659     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 14660     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 14661     MOVE X'2020233030303132323931' TO DFHEIV0(25:11)
 14662     CALL 'kxdfhei1' USING DFHEIV0,
 14663           DFHEIV1,
 14664           EL131AO,
 14665           DFHEIV99,
 14666           DFHEIV2,
 14667           DFHEIV99,
 14668           DFHEIV99,
 14669           DFHEIV99,
 14670           DFHEIV11,
 14671           DFHEIV99,
 14672           DFHEIV99,
 14673           DFHEIV99
 14674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14675
 14676
 14677     GO TO 9000-RETURN-TRANS.
 14678
 14679 8120-FORMAT-TIME-DATE.
 14680
 14681     IF SKIP-ATTRIBUTE = 'Y'
 14682        MOVE SPACES              TO SKIP-ATTRIBUTE
 14683        MOVE ER-0598             TO EMI-ERROR
 14684        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14685        GO TO 8125-SKIP-ATTRIBUTE.
 14686
 14687*     IF PI-COMPANY-ID = 'DMD'
 14688      IF PI-PROCESSOR-ID <> 'EMER'
 14689         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 14690                                    CERTCARA  CERTGRPA CERTA SUFXA
 14691
 14692     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 14693                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 14694                                    JNTINITA  JNTAGEA   APRA
 14695                                    LCVCDA    LCVOTRMA  LCVRTRMA
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 281
* EL131.cbl
 14696                                    LCVBENEA  LCVFORMA  LCVCNDTA
 14697                                    LCVEXITA  LCVSTATA  LCVKINDA
 14698                                    ACVCDA    ACVOTRMA  ACVRTRMA
 14699                                    ACVBENEA  ACVFORMA  ACVCNDTA
 14700                                    ACVEXITA  ACVSTATA  ACVKINDA
 14701                                    PMTFREQA  INDGRPA   PREMTYPA
 14702                                    REINCDA   LCVRATEA  ACVRATEA
 14703                                    ADDONDTA.
 14704
 14705*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 14706*       IF PI-COMPANY-ID = 'DMD'
 14707*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 14708*                                   SUFXA
 14709*                                   PDAMTA    NODAYSA   NOPMTSA
 14710*                                   INCA      OCCA
 14711*          IF NOT SYSTEM-MODIFY-CAP
 14712*              MOVE AL-SANOF         TO PDTHRUA.
 14713
 14714     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 14715         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 14716
 14717 8125-SKIP-ATTRIBUTE.
 14718
 14719     MOVE SAVE-DATE              TO DATEO.
 14720
 14721* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 14722*    END-EXEC
 14723*    MOVE '0"A                   "   #00012342' TO DFHEIV0
 14724     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 14725     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 14726     MOVE X'2020233030303132333432' TO DFHEIV0(25:11)
 14727     CALL 'kxdfhei1' USING DFHEIV0,
 14728           LCP-CICS-TIME
 14729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14730
 14731* EXEC CICS FORMATTIME
 14732*              ABSTIME(LCP-CICS-TIME)
 14733*              TIME(LCP-TIME-OF-DAY-XX)
 14734*    END-EXEC
 14735*    MOVE 'j$(     (             #   #00012344' TO DFHEIV0
 14736     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 14737     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14738     MOVE X'2020233030303132333434' TO DFHEIV0(25:11)
 14739     CALL 'kxdfhei1' USING DFHEIV0,
 14740           LCP-CICS-TIME,
 14741           LCP-TIME-OF-DAY-XX
 14742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14743     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 14744     MOVE UN-HOURS               TO FOR-HOURS.
 14745     MOVE UN-MINUTES             TO FOR-MINUTES.
 14746     MOVE TIME-OUT               TO TIMEO.
 14747     MOVE PI-COMPANY-ID          TO COMPO.
 14748     MOVE PI-PROCESSOR-ID        TO USERIDO.
 14749     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 14750     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 14751     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 14752
 14753 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 282
* EL131.cbl
 14754     EXIT.
 14755
 14756 8150-ENTERED-CLAIM-NOTFOUND.
 14757
 14758     MOVE ER-0204                TO EMI-ERROR.
 14759     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14760     MOVE -1                     TO MAINTL.
 14761     GO TO 8100-SEND-MAP.
 14762
 14763 8200-RETURN-PRIOR.
 14764     MOVE SPACE                  TO PI-RETURN-CD-1.
 14765     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 14766     GO TO 9200-XCTL.
 14767
 14768 8300-GET-HELP.
 14769     MOVE XCTL-EL010             TO CALL-PGM.
 14770     GO TO 9200-XCTL.
 14771
 14772 8400-RETURN-MASTER.
 14773     MOVE SPACE                  TO PI-RETURN-CD-1.
 14774     MOVE XCTL-EL126             TO CALL-PGM.
 14775     GO TO 9200-XCTL.
 14776
 14777 8500-TRLR-MNT.
 14778     IF PI-RETURN-CD-1 = 'X'
 14779         MOVE ER-0311            TO EMI-ERROR
 14780         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14781         MOVE -1                 TO MAINTL
 14782         GO TO 8110-SEND-DATA.
 14783
 14784
 14785* EXEC CICS WRITEQ TS
 14786*         QUEUE     (PI-KEY)
 14787*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14788*         LENGTH    (PI-COMM-LENGTH)
 14789*    END-EXEC.
 14790*    MOVE '*"                    ''   #00012389' TO DFHEIV0
 14791     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14792     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14793     MOVE X'2020233030303132333839' TO DFHEIV0(25:11)
 14794     CALL 'kxdfhei1' USING DFHEIV0,
 14795           PI-KEY,
 14796           PROGRAM-INTERFACE-BLOCK,
 14797           PI-COMM-LENGTH,
 14798           DFHEIV99,
 14799           DFHEIV99,
 14800           DFHEIV99
 14801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14802
 14803
 14804     MOVE XCTL-EL142             TO CALL-PGM.
 14805     GO TO 9200-XCTL.
 14806
 14807 8600-ADDR-MNT.
 14808     IF PI-RETURN-CD-1 = 'X'
 14809         MOVE ER-0311            TO EMI-ERROR
 14810         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14811         MOVE -1                 TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 283
* EL131.cbl
 14812         GO TO 8110-SEND-DATA.
 14813
 14814
 14815* EXEC CICS WRITEQ TS
 14816*         QUEUE     (PI-KEY)
 14817*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14818*         LENGTH    (PI-COMM-LENGTH)
 14819*    END-EXEC.
 14820*    MOVE '*"                    ''   #00012405' TO DFHEIV0
 14821     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14822     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14823     MOVE X'2020233030303132343035' TO DFHEIV0(25:11)
 14824     CALL 'kxdfhei1' USING DFHEIV0,
 14825           PI-KEY,
 14826           PROGRAM-INTERFACE-BLOCK,
 14827           PI-COMM-LENGTH,
 14828           DFHEIV99,
 14829           DFHEIV99,
 14830           DFHEIV99
 14831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14832
 14833
 14834     MOVE XCTL-EL141             TO CALL-PGM.
 14835     GO TO 9200-XCTL.
 14836
 14837 8700-CERT-MNT.
 14838     IF PI-RETURN-CD-1 = 'X'
 14839         MOVE ER-7690            TO EMI-ERROR
 14840         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14841         MOVE -1                 TO MAINTL
 14842         GO TO 8110-SEND-DATA.
 14843
 14844
 14845* EXEC CICS WRITEQ TS
 14846*         QUEUE     (PI-KEY)
 14847*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14848*         LENGTH    (PI-COMM-LENGTH)
 14849*    END-EXEC.
 14850*    MOVE '*"                    ''   #00012421' TO DFHEIV0
 14851     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14852     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14853     MOVE X'2020233030303132343231' TO DFHEIV0(25:11)
 14854     CALL 'kxdfhei1' USING DFHEIV0,
 14855           PI-KEY,
 14856           PROGRAM-INTERFACE-BLOCK,
 14857           PI-COMM-LENGTH,
 14858           DFHEIV99,
 14859           DFHEIV99,
 14860           DFHEIV99
 14861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14862
 14863
 14864     MOVE XCTL-EL1273            TO CALL-PGM.
 14865     GO TO 9200-XCTL.
 14866
 14867 8750-DMD-CLM-FIX.
 14868
 14869* EXEC CICS WRITEQ TS
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 284
* EL131.cbl
 14870*         QUEUE     (PI-KEY)
 14871*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14872*         LENGTH    (PI-COMM-LENGTH)
 14873*    END-EXEC.
 14874*    MOVE '*"                    ''   #00012431' TO DFHEIV0
 14875     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14876     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14877     MOVE X'2020233030303132343331' TO DFHEIV0(25:11)
 14878     CALL 'kxdfhei1' USING DFHEIV0,
 14879           PI-KEY,
 14880           PROGRAM-INTERFACE-BLOCK,
 14881           PI-COMM-LENGTH,
 14882           DFHEIV99,
 14883           DFHEIV99,
 14884           DFHEIV99
 14885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14886
 14887
 14888     MOVE XCTL-EL400DMD          TO CALL-PGM.
 14889     GO TO 9200-XCTL.
 14890
 14891 8800-UNAUTHORIZED-ACCESS.
 14892     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 14893     GO TO 8990-SEND-TEXT.
 14894
 14895 8810-PF23-ENTERED.
 14896     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 14897     MOVE XCTL-EL005             TO CALL-PGM.
 14898     GO TO 9200-XCTL.
 14899
 14900 8820-XCTL-ERROR.
 14901
 14902* EXEC CICS HANDLE CONDITION
 14903*        PGMIDERR (8990-SEND-TEXT)
 14904*    END-EXEC.
 14905*    MOVE '"$L                   ! H #00012450' TO DFHEIV0
 14906     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 14907     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14908     MOVE X'4820233030303132343530' TO DFHEIV0(25:11)
 14909     CALL 'kxdfhei1' USING DFHEIV0
 14910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14911
 14912
 14913     MOVE SPACE                 TO PI-ENTRY-CD-1.
 14914     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 14915     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 14916     MOVE XCTL-EL005            TO CALL-PGM.
 14917     GO TO 9200-XCTL.
 14918
 14919 8990-SEND-TEXT.
 14920
 14921* EXEC CICS SEND TEXT
 14922*         FROM      (LOGOFF-TEXT)
 14923*         LENGTH    (LOGOFF-LENGTH)
 14924*         ERASE
 14925*         FREEKB
 14926*    END-EXEC.
 14927*    MOVE '8&      T  E F  H   F -   #00012461' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 285
* EL131.cbl
 14928     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 14929     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 14930     MOVE X'2020233030303132343631' TO DFHEIV0(25:11)
 14931     CALL 'kxdfhei1' USING DFHEIV0,
 14932           LOGOFF-TEXT,
 14933           LOGOFF-LENGTH,
 14934           DFHEIV99,
 14935           DFHEIV99,
 14936           DFHEIV99,
 14937           DFHEIV99,
 14938           DFHEIV99,
 14939           DFHEIV99,
 14940           DFHEIV99,
 14941           DFHEIV99,
 14942           DFHEIV99,
 14943           DFHEIV99
 14944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14945
 14946
 14947     GO TO 9100-RETURN-CICS.
 14948
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 286
* EL131.cbl
 14950 9000-RETURN-TRANS.
 14951
 14952* EXEC CICS RETURN
 14953*         TRANSID   (TRANS-ID)
 14954*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 14955*         LENGTH    (PI-COMM-LENGTH)
 14956*    END-EXEC.
 14957*    MOVE '.(CT                  ''   #00012472' TO DFHEIV0
 14958     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 14959     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14960     MOVE X'2020233030303132343732' TO DFHEIV0(25:11)
 14961     CALL 'kxdfhei1' USING DFHEIV0,
 14962           TRANS-ID,
 14963           PROGRAM-INTERFACE-BLOCK,
 14964           PI-COMM-LENGTH,
 14965           DFHEIV99,
 14966           DFHEIV99,
 14967           DFHEIV99
 14968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14969
 14970
 14971
 14972* GOBACK.
 14973     MOVE '9%                    "   ' TO DFHEIV0
 14974     MOVE 'EL131' TO DFHEIV1
 14975     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 14976     GOBACK.
 14977
 14978 9100-RETURN-CICS.
 14979
 14980* EXEC CICS RETURN
 14981*    END-EXEC.
 14982*    MOVE '.(                    ''   #00012481' TO DFHEIV0
 14983     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 14984     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14985     MOVE X'2020233030303132343831' TO DFHEIV0(25:11)
 14986     CALL 'kxdfhei1' USING DFHEIV0,
 14987           DFHEIV99,
 14988           DFHEIV99,
 14989           DFHEIV99,
 14990           DFHEIV99,
 14991           DFHEIV99,
 14992           DFHEIV99
 14993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14994
 14995
 14996
 14997* GOBACK.
 14998     MOVE '9%                    "   ' TO DFHEIV0
 14999     MOVE 'EL131' TO DFHEIV1
 15000     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15001     GOBACK.
 15002
 15003 9200-XCTL.
 15004
 15005* EXEC CICS XCTL
 15006*         PROGRAM    (CALL-PGM)
 15007*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 287
* EL131.cbl
 15008*         LENGTH     (PI-COMM-LENGTH)
 15009*    END-EXEC.
 15010*    MOVE '.$C                   %   #00012487' TO DFHEIV0
 15011     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 15012     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15013     MOVE X'2020233030303132343837' TO DFHEIV0(25:11)
 15014     CALL 'kxdfhei1' USING DFHEIV0,
 15015           CALL-PGM,
 15016           PROGRAM-INTERFACE-BLOCK,
 15017           PI-COMM-LENGTH,
 15018           DFHEIV99
 15019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15020
 15021
 15022 9700-LINK-RTRM-FILE-ID.
 15023
 15024* EXEC CICS LINK
 15025*        PROGRAM  (RTRM-FILE-ID)
 15026*        COMMAREA (CALCULATION-PASS-AREA)
 15027*        LENGTH   (CP-COMM-LENGTH)
 15028*    END-EXEC.
 15029*    MOVE '."C                   (   #00012494' TO DFHEIV0
 15030     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15031     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15032     MOVE X'2020233030303132343934' TO DFHEIV0(25:11)
 15033     CALL 'kxdfhei1' USING DFHEIV0,
 15034           RTRM-FILE-ID,
 15035           CALCULATION-PASS-AREA,
 15036           CP-COMM-LENGTH,
 15037           DFHEIV99,
 15038           DFHEIV99,
 15039           DFHEIV99,
 15040           DFHEIV99
 15041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15042
 15043
 15044 9700-EXIT.
 15045      EXIT.
 15046
 15047 9800-CONVERT-DATE.
 15048     MOVE SPACES TO DC-ERROR-CODE.
 15049
 15050* EXEC CICS LINK
 15051*         PROGRAM    (DATE-CONV)
 15052*         COMMAREA   (DATE-CONVERSION-DATA)
 15053*         LENGTH     (DC-COMM-LENGTH)
 15054*    END-EXEC.
 15055*    MOVE '."C                   (   #00012505' TO DFHEIV0
 15056     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15057     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15058     MOVE X'2020233030303132353035' TO DFHEIV0(25:11)
 15059     CALL 'kxdfhei1' USING DFHEIV0,
 15060           DATE-CONV,
 15061           DATE-CONVERSION-DATA,
 15062           DC-COMM-LENGTH,
 15063           DFHEIV99,
 15064           DFHEIV99,
 15065           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 288
* EL131.cbl
 15066           DFHEIV99
 15067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15068
 15069
 15070 9800-EXIT.
 15071     EXIT.
 15072
 15073 9900-ERROR-FORMAT.
 15074
 15075* EXEC CICS LINK
 15076*         PROGRAM    (XCTL-EL001)
 15077*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 15078*         LENGTH     (EMI-COMM-LENGTH)
 15079*    END-EXEC.
 15080*    MOVE '."C                   (   #00012515' TO DFHEIV0
 15081     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15082     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15083     MOVE X'2020233030303132353135' TO DFHEIV0(25:11)
 15084     CALL 'kxdfhei1' USING DFHEIV0,
 15085           XCTL-EL001,
 15086           ERROR-MESSAGE-INTERFACE-BLOCK,
 15087           EMI-COMM-LENGTH,
 15088           DFHEIV99,
 15089           DFHEIV99,
 15090           DFHEIV99,
 15091           DFHEIV99
 15092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15093
 15094
 15095 9900-EXIT.
 15096     EXIT.
 15097
 15098 9990-ABEND.
 15099     MOVE DFHEIBLK               TO EMI-LINE1.
 15100
 15101* EXEC CICS LINK
 15102*         PROGRAM   (XCTL-EL004)
 15103*         COMMAREA  (EMI-LINE1)
 15104*         LENGTH    (72)
 15105*     END-EXEC.
 15106     MOVE 72
 15107       TO DFHEIV11
 15108*    MOVE '."C                   (   #00012526' TO DFHEIV0
 15109     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15110     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15111     MOVE X'2020233030303132353236' TO DFHEIV0(25:11)
 15112     CALL 'kxdfhei1' USING DFHEIV0,
 15113           XCTL-EL004,
 15114           EMI-LINE1,
 15115           DFHEIV11,
 15116           DFHEIV99,
 15117           DFHEIV99,
 15118           DFHEIV99,
 15119           DFHEIV99
 15120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15121
 15122
 15123     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 289
* EL131.cbl
 15124
 15125     GO TO 8110-SEND-DATA.
 15126
 15127 9995-SECURITY-VIOLATION.
 15128*           COPY ELCSCTP.
 15129******************************************************************
 15130*                                                                *
 15131*                            ELCSCTP                             *
 15132*                            VMOD=2.001                          *
 15133*                                                                *
 15134*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 15135******************************************************************
 15136
 15137
 15138     MOVE EIBDATE          TO SM-JUL-DATE.
 15139     MOVE EIBTRMID         TO SM-TERMID.
 15140     MOVE THIS-PGM         TO SM-PGM.
 15141     MOVE EIBTIME          TO TIME-IN.
 15142     MOVE TIME-OUT         TO SM-TIME.
 15143     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 15144
 15145
 15146* EXEC CICS LINK
 15147*         PROGRAM  ('EL003')
 15148*         COMMAREA (SECURITY-MESSAGE)
 15149*         LENGTH   (80)
 15150*    END-EXEC.
 15151     MOVE 'EL003' TO DFHEIV1
 15152     MOVE 80
 15153       TO DFHEIV11
 15154*    MOVE '."C                   (   #00012554' TO DFHEIV0
 15155     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15156     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15157     MOVE X'2020233030303132353534' TO DFHEIV0(25:11)
 15158     CALL 'kxdfhei1' USING DFHEIV0,
 15159           DFHEIV1,
 15160           SECURITY-MESSAGE,
 15161           DFHEIV11,
 15162           DFHEIV99,
 15163           DFHEIV99,
 15164           DFHEIV99,
 15165           DFHEIV99
 15166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15167
 15168
 15169******************************************************************
 15170
 15171
 15172
 15173 9999-DFHBACK SECTION.
 15174     MOVE '9%                    "   ' TO DFHEIV0
 15175     MOVE 'EL131' TO DFHEIV1
 15176     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15177     GOBACK.
 15178 9999-DFHEXIT.
 15179     IF DFHEIGDJ EQUAL 0001
 15180         NEXT SENTENCE
 15181     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 290
* EL131.cbl
 15182         GO TO 8820-XCTL-ERROR,
 15183               8150-ENTERED-CLAIM-NOTFOUND,
 15184               9990-ABEND
 15185         DEPENDING ON DFHEIGDI
 15186     ELSE IF DFHEIGDJ EQUAL 3
 15187         GO TO 0130-TS-ERROR,
 15188               0130-TS-ERROR
 15189         DEPENDING ON DFHEIGDI
 15190     ELSE IF DFHEIGDJ EQUAL 4
 15191         GO TO 0600-CONTINUE-NAME-UPDATE
 15192         DEPENDING ON DFHEIGDI
 15193     ELSE IF DFHEIGDJ EQUAL 5
 15194         GO TO 1004-BENE-NOT-FOUND
 15195         DEPENDING ON DFHEIGDI
 15196     ELSE IF DFHEIGDJ EQUAL 6
 15197         GO TO 1120-CNTL-NOTFND
 15198         DEPENDING ON DFHEIGDI
 15199     ELSE IF DFHEIGDJ EQUAL 7
 15200         GO TO 1150-NOTOPEN-ERROR,
 15201               1150-EXIT
 15202         DEPENDING ON DFHEIGDI
 15203     ELSE IF DFHEIGDJ EQUAL 8
 15204         GO TO 1490-STATE-NOTFND
 15205         DEPENDING ON DFHEIGDI
 15206     ELSE IF DFHEIGDJ EQUAL 9
 15207         GO TO 1500-CARR-NOTFND
 15208         DEPENDING ON DFHEIGDI
 15209     ELSE IF DFHEIGDJ EQUAL 10
 15210         GO TO 1620-ACCT-NOTFND
 15211         DEPENDING ON DFHEIGDI
 15212     ELSE IF DFHEIGDJ EQUAL 11
 15213         GO TO 2020-EXIT
 15214         DEPENDING ON DFHEIGDI
 15215     ELSE IF DFHEIGDJ EQUAL 12
 15216         GO TO 2030-EXIT
 15217         DEPENDING ON DFHEIGDI
 15218     ELSE IF DFHEIGDJ EQUAL 13
 15219         GO TO 2040-EXIT
 15220         DEPENDING ON DFHEIGDI
 15221     ELSE IF DFHEIGDJ EQUAL 14
 15222         GO TO 2050-EXIT
 15223         DEPENDING ON DFHEIGDI
 15224     ELSE IF DFHEIGDJ EQUAL 15
 15225         GO TO 2060-CERT-NOTFND
 15226         DEPENDING ON DFHEIGDI
 15227     ELSE IF DFHEIGDJ EQUAL 16
 15228         GO TO 2060-DUPKEY
 15229         DEPENDING ON DFHEIGDI
 15230     ELSE IF DFHEIGDJ EQUAL 17
 15231         GO TO 2070-NOT-FOUND
 15232         DEPENDING ON DFHEIGDI
 15233     ELSE IF DFHEIGDJ EQUAL 18
 15234         GO TO 2070-EXIT
 15235         DEPENDING ON DFHEIGDI
 15236     ELSE IF DFHEIGDJ EQUAL 19
 15237         GO TO 2080-EXIT
 15238         DEPENDING ON DFHEIGDI
 15239     ELSE IF DFHEIGDJ EQUAL 20
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 291
* EL131.cbl
 15240         GO TO 2400-TRLR-NOTFND,
 15241               2410-EXIT
 15242         DEPENDING ON DFHEIGDI
 15243     ELSE IF DFHEIGDJ EQUAL 21
 15244         GO TO 2425-NINETY-NOTFND,
 15245               2425-NINETY-NOTFND
 15246         DEPENDING ON DFHEIGDI
 15247     ELSE IF DFHEIGDJ EQUAL 22
 15248         GO TO 2430-EXIT,
 15249               2440-EXIT
 15250         DEPENDING ON DFHEIGDI
 15251     ELSE IF DFHEIGDJ EQUAL 23
 15252         GO TO 2440-EXIT
 15253         DEPENDING ON DFHEIGDI
 15254     ELSE IF DFHEIGDJ EQUAL 24
 15255         GO TO 2460-EXIT
 15256         DEPENDING ON DFHEIGDI
 15257     ELSE IF DFHEIGDJ EQUAL 25
 15258         GO TO 2475-EXIT
 15259         DEPENDING ON DFHEIGDI
 15260     ELSE IF DFHEIGDJ EQUAL 26
 15261         GO TO 2650-EXIT
 15262         DEPENDING ON DFHEIGDI
 15263     ELSE IF DFHEIGDJ EQUAL 27
 15264         GO TO 2800-EXIT,
 15265               2800-EXIT
 15266         DEPENDING ON DFHEIGDI
 15267     ELSE IF DFHEIGDJ EQUAL 28
 15268         GO TO 3010-DEL-ACTQ,
 15269               3040-EXIT
 15270         DEPENDING ON DFHEIGDI
 15271     ELSE IF DFHEIGDJ EQUAL 29
 15272         GO TO 3010-NO-ACTIVITY,
 15273               3050-EXIT
 15274         DEPENDING ON DFHEIGDI
 15275     ELSE IF DFHEIGDJ EQUAL 30
 15276         GO TO 3010-CERT-NOT-FOUND
 15277         DEPENDING ON DFHEIGDI
 15278     ELSE IF DFHEIGDJ EQUAL 31
 15279         GO TO 3020-EXIT
 15280         DEPENDING ON DFHEIGDI
 15281     ELSE IF DFHEIGDJ EQUAL 32
 15282         GO TO 3060-EXIT,
 15283               3060-EXIT
 15284         DEPENDING ON DFHEIGDI
 15285     ELSE IF DFHEIGDJ EQUAL 33
 15286         GO TO 5000-TRLR-NOT-FOUND
 15287         DEPENDING ON DFHEIGDI
 15288     ELSE IF DFHEIGDJ EQUAL 34
 15289         GO TO 5000-CERT-NOT-FOUND
 15290         DEPENDING ON DFHEIGDI
 15291     ELSE IF DFHEIGDJ EQUAL 35
 15292         GO TO 7630-END-BROWSE
 15293         DEPENDING ON DFHEIGDI
 15294     ELSE IF DFHEIGDJ EQUAL 36
 15295         GO TO 7799-EXIT,
 15296               7799-EXIT
 15297         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 10-Jun-13 13:40 Page 292
* EL131.cbl
 15298     ELSE IF DFHEIGDJ EQUAL 37
 15299         GO TO 7799-EXIT
 15300         DEPENDING ON DFHEIGDI
 15301     ELSE IF DFHEIGDJ EQUAL 38
 15302         GO TO 7800-NOT-FOUND
 15303         DEPENDING ON DFHEIGDI
 15304     ELSE IF DFHEIGDJ EQUAL 39
 15305         GO TO 8000-NOTE-NOT-FOUND
 15306         DEPENDING ON DFHEIGDI
 15307     ELSE IF DFHEIGDJ EQUAL 40
 15308         GO TO 8990-SEND-TEXT
 15309         DEPENDING ON DFHEIGDI.
 15310     MOVE '9%                    "   ' TO DFHEIV0
 15311     MOVE 'EL131' TO DFHEIV1
 15312     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15313     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       10884     Code:       50896
