* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page   1
* NSRASBL.cbl
* Options: int("NSRASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSRASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRASBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSRASLTR
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* ChangeS ARE MARKED BY THE Change EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  Change   Change REQUEST PGMR  DESCRIPTION OF Change
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page   2
* NSRASBL.cbl
    14* 060611    2011022800001  PEMA  NEW PROGRAM
    15* 122911    2011022800001  AJRA  ADD VA DISCLOSURE TO CERT PRINT
    16* 071212    2011022800001  AJRA  ADD UNDW ID
    17* 072312    2011022800001  AJRA    ADD NEW FIELDS
    18* 090612  IR2012090600001  AJRA  NAPERSOFT
    19* 091112  IR2012091100002  AJRA  FIX AKA
    20* 091312  IR2012091100004  AJRA  FIX JOINT NAME
    21* 092412  IR2012092350004  AJRA  FIX CANCEL AMT
    22* 100112  IR2012100100002  AJRA  FIX ADDRESS WITH 2 SPACES
    23* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    24* 101412    2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    25* 101812    2012101700002  AJRA  READ ENDT BY ARCHIVE NO
    26* 110612    2012101700002  AJRA  ADD NEW FIELDS
    27******************************************************************
    28 ENVIRONMENT DIVISION.
    29 DATA DIVISION.
    30 working-storage section.
    31 01  DFH-START PIC X(04).
    32 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    33 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    34 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    35 77  S1                          PIC S999 COMP-3 VALUE +0.
    36 77  E1                          PIC S999 COMP-3 VALUE +0.
    37 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    38 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    39 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    40 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    41 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    42 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    43 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    44 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    45 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    46 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    47 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    48 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    49     88  FOUND-BENE                  VALUE 'Y'.
    50 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    51 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    52 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    53 77  WS-ERPNDB-SW                PIC X  VALUE ' '.
    54     88  END-OF-ERPNDB              VALUE 'Y'.
    55 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    56     88  ACCT-FOUND                 VALUE 'Y'.
    57 77  WS-ELCERT-SW                PIC X  VALUE ' '.
    58     88  CERT-FOUND                 VALUE 'Y'.
    59     88  CERT-NOT-FOUND             VALUE 'N'.
    60 77  WS-ERENDT-SW                PIC X  VALUE ' '.
    61     88  ENDT-FOUND                 VALUE 'Y'.
    62     88  ENDT-NOT-FOUND             VALUE 'N'.
    63 77  WS-LF-ABBRV                 PIC X(10) VALUE SPACES.
    64 77  WS-LF-DESC                  PIC X(02) VALUE SPACES.
    65 77  WS-LF-EARN                  PIC X     VALUE ' '.
    66 77  WS-WAIT-PER                 PIC X(03) VALUE ZEROS.
    67 77  WS-RET-ELIM                 PIC X(01) VALUE SPACES.
    68 77  WS-AH-DESC                  PIC X(35) VALUE SPACES.
    69 77  WS-BEN-DAYS                 PIC X(02) VALUE ZEROS.
    70 77  WS-CSR-ID                   PIC XXXX  VALUE SPACES.
    71 77  WS-LF-BENCD                 PIC XX    VALUE '00'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page   3
* NSRASBL.cbl
    72 77  WS-AH-BENCD                 PIC XX    VALUE '00'.
    73 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    74 77  WS-COMPANY-CD               PIC X  VALUE LOW-VALUES.
    75 77  WS-WORK-PREM                PIC S9(9)V99 COMP-3 VALUE +0.
    76 77  WS-WORK-LF-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    77 77  WS-WORK-ALT-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    78 77  WS-WORK-CMB-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    79 77  WS-WORK-AH-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    80 77  WS-WORK-REF                 PIC S9(9)V99 COMP-3 VALUE +0.
    81 77  WS-WORK-LF-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    82 77  WS-WORK-AH-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    83 77  WS-ISSUE-CANCEL-SW          PIC X  VALUE SPACES.
    84     88  PROCESS-ISSUE               VALUE 'I'.
    85     88  PROCESS-CANCEL              VALUE 'C'.
    86 77  WS-SAVE-OUT-LETTER          PIC X(6)  VALUE SPACES.
    87 77  WS-WORK-COMM                PIC 9(7)V99 VALUE ZEROS.
    88 77  WS-DIFF                     PIC 999 VALUE ZEROS.
    89 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
    90 77  WS-CHGBK-LIFE-PCT           PIC S9V9(5) COMP-3 VALUE +0.
    91 77  WS-CHGBK-AH-PCT             PIC S9V9(5) COMP-3 VALUE +0.
    92 77  WS-CERT-EFF-DT              PIC XX  VALUE SPACES.
    93 77  LINK-ELVADS                 PIC X(8) VALUE 'ELVADS'.
    94 01  WS-CALC-FIELDS.
    95     12  WS-WRK-AMOUNT           PIC S9(7)V99 COMP-3 VALUE +0.
    96     12  WS-WRK-AMOUNT2          PIC S9(7)V99 COMP-3 VALUE +0.
    97     12  WS-CSO-LF-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
    98     12  WS-CSO-ALT-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
    99     12  WS-CSO-CMB-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   100     12  WS-CSO-AH-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   101     12  WS-CSO-PORTION          PIC S9(7)V99 COMP-3 VALUE +0.
   102     12  WS-ACCT-LF-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   103     12  WS-ACCT-ALT-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   104     12  WS-ACCT-CMB-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   105     12  WS-ACCT-AH-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   106     12  WS-ACCT-PORTION         PIC S9(7)V99 COMP-3 VALUE +0.
   107     12  WS-CSO-ORIG-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   108     12  WS-CSO-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   109     12  WS-CSO-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   110     12  WS-CSO-ORIG-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   111     12  WS-CSO-ORIG-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   112     12  WS-ACCT-ORIG-LF-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   113     12  WS-ACCT-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   114     12  WS-ACCT-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   115     12  WS-ACCT-ORIG-AH-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   116     12  WS-ACCT-ORIG-PORTION    PIC S9(7)V99 COMP-3 VALUE +0.
   117     12  WS-CSO-NEW-LF-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   118     12  WS-CSO-NEW-ALT-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   119     12  WS-CSO-NEW-CMB-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   120     12  WS-CSO-NEW-AH-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   121     12  WS-CSO-NEW-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   122     12  WS-ACCT-NEW-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   123     12  WS-ACCT-NEW-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   124     12  WS-ACCT-NEW-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   125     12  WS-ACCT-NEW-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   126     12  WS-ACCT-NEW-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   127     12  WS-CSO-LF-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   128     12  WS-CSO-ALT-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   129     12  WS-CSO-CMB-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page   4
* NSRASBL.cbl
   130     12  WS-CSO-AH-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   131     12  WS-CSO-PORTION-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   132     12  WS-ACCT-LF-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   133     12  WS-ACCT-ALT-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   134     12  WS-ACCT-CMB-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   135     12  WS-ACCT-AH-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   136     12  WS-ACCT-PORTION-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   137 01  WS-SAVE-ERACCT-REC          PIC X(2000).
   138 01  WS-XML-WORK                 PIC X(4200)  VALUE SPACES.
   139 01 response-code         pic s9(8) comp.
   140 01 display-response      pic 9(8).
   141 01 bl-index              pic 9(8) comp.
   142 01 max-last-name         pic x(18).
   143 01 first-initial         pic x.
   144 01 name-in-range-flag    pic 9.
   145 01 max-entries           pic s9(8) comp value 100.
   146 01 WS-PASSED-DT          PIC XX   VALUE LOW-VALUES.
   147 01 lower-case    pic x(26) value
   148            "abcdefghijklmnopqrstuvwxyz".
   149 01 upper-case    pic x(26) value
   150            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
   151
   152*                                COPY ELCVADS.
   153******************************************************************
   154*                                                                *
   155*                                                                *
   156*                            ELCVADS.                            *
   157*                                                                *
   158*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   159*   ELVADS                  LENGTH = 350                         *
   160******************************************************************
   161******************************************************************
   162*                   C H A N G E   L O G
   163*
   164* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   165*-----------------------------------------------------------------
   166*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   167* EFFECTIVE    NUMBER
   168*-----------------------------------------------------------------
   169* 100111    2011022800001  AJRA  NAPERSOFT
   170******************************************************************
   171
   172 01  VIRGINIA-DISCLOSURE.
   173     12  VD-COMPANY-CD              PIC X.
   174     12  VD-CARRIER                 PIC X.
   175     12  VD-GROUPING.
   176         20  VD-GROUPING-PREFIX     PIC XXX.
   177         20  VD-GROUPING-PRIME      PIC XXX.
   178     12  VD-STATE                   PIC XX.
   179     12  VD-ACCOUNT.
   180         20  VD-ACCOUNT-PREFIX      PIC X(4).
   181         20  VD-ACCOUNT-PRIME       PIC X(6).
   182     12  VD-CERT-EFF-DT             PIC XX.
   183     12  VD-CERT-NO.
   184         20  VD-CERT-PRIME          PIC X(10).
   185         20  VD-CERT-SFX            PIC X.
   186     12  VD-ENTRY-BATCH             PIC X(6).
   187     12  VD-CSR-ID                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page   5
* NSRASBL.cbl
   188     12  VD-NAME.
   189         20  VD-INSURED-LAST-NAME   PIC X(15).
   190         20  VD-INSURED-FIRST-NAME.
   191             24  VD-INSURED-1ST-INIT PIC X.
   192             24  FILLER             PIC X(9).
   193         20  VD-INSURED-MIDDLE-INIT PIC X.
   194     12  VD-JOINT-INSURED.
   195         20 VD-JOINT-LAST-NAME      PIC X(15).
   196         20 VD-JOINT-FIRST-NAME.
   197            24  VD-JOINT-FIRST-INIT PIC X.
   198            24  FILLER              PIC X(9).
   199         20 VD-JOINT-MIDDLE-INIT    PIC X.
   200     12  VD-INSURED-ADDRESS-1       PIC X(30).
   201     12  VD-INSURED-ADDRESS-2       PIC X(30).
   202     12  VD-INSURED-CITY-STATE.
   203         20  VD-INSURED-CITY        PIC X(28).
   204         20  VD-INSURED-STATE       PIC XX.
   205     12  VD-INSURED-ZIP-CODE.
   206         20  VD-INSURED-ZIP-PRIME.
   207             24  VD-INSURED-ZIP-1   PIC X.
   208                 88  VD-CANADIAN-POST-CODE
   209                                       VALUE 'A' THRU 'Z'.
   210             24  FILLER             PIC X(4).
   211         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
   212     12  VD-BENEFICIARY-NAME        PIC X(30).
   213     12  VD-ACCOUNT-NAME            PIC X(30).
   214     12  VD-LOAN-TERM               PIC S999   COMP-3.
   215     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   216     12  VD-1ST-PMT-DT              PIC XX.
   217     12  VD-LIFE-BENEFIT-CD         PIC XX.
   218         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   219         88  VD-INVALID-LIFE           VALUE '  ' '00'
   220                                             '90' THRU '99'.
   221     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   222                                    PIC XX.
   223     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   224     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   225     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   226     12  VD-LF-TERM                 PIC S999   COMP-3.
   227     12  VD-AH-BENEFIT-CD           PIC XX.
   228         88  VD-VALID-AH               VALUE '01' THRU '89'.
   229         88  VD-INVALID-AH             VALUE '  ' '00'
   230                                             '90' THRU '99'.
   231     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   232     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   233     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   234     12  VD-AH-TERM                 PIC S999   COMP-3.
   235     12  VD-LETTER-ID               PIC X(4).
   236     12  VD-PROC-ID                 PIC X(4).
   237     12  VD-COMP-ID                 PIC X(3).
   238     12  VD-CURRENT-DATE            PIC XX.
   239     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   240     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
   241     12  FILLER                     PIC X(32).
   242 01  WS-PASS-AREA.
   243     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   244     05  WS-PASS-VADS-REC    PIC X(350).
   245
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page   6
* NSRASBL.cbl
   246*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   247*                         COPY ELCZREC.
   248******************************************************************
   249*                                                                *
   250*                                                                *
   251*                            ELCZREC.                            *
   252*                                                                *
   253*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   254*                                                                *
   255******************************************************************
   256*-----------------------------------------------------------------
   257*                   C H A N G E   L O G
   258*
   259* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   260*-----------------------------------------------------------------
   261*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   262* EFFECTIVE    NUMBER
   263*-----------------------------------------------------------------
   264* 122011    2011022800001  AJRA  NEW FILE
   265* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   266*-----------------------------------------------------------------
   267 01  W-Z-CONTROL-DATA.
   268     05  W-NUMBER-OF-COPIES      PIC  9.
   269     05  FILLER                  PIC  X.
   270     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   271     05  FILLER                  PIC  X.
   272     05  W-DAYS-TO-RESEND        PIC  999.
   273     05  FILLER                  PIC  X.
   274     05  W-FORM-TO-RESEND        PIC  X(4).
   275     05  FILLER                  PIC  X.
   276     05  W-PROMPT-LETTER         PIC  X.
   277     05  FILLER                  PIC  X.
   278     05  W-ENCLOSURE-CD          PIC  XXX.
   279     05  FILLER                  PIC  X.
   280     05  W-AUTO-CLOSE-IND        PIC  X.
   281     05  FILLER                  PIC  X.
   282     05  W-LETTER-TO-BENE        PIC  X.
   283     05  FILLER                  PIC  X.
   284     05  W-LETTER-TO-ACCT        PIC  X.
   285     05  FILLER                  PIC  X.
   286     05  W-LETTER-TYPE           PIC  X.
   287     05  FILLER                  PIC  X.
   288     05  W-PRINT-CERTIFICATE     PIC  X.
   289     05  FILLER                  PIC  X.
   290     05  W-REFUND-REQUIRED       PIC  X.
   291     05  FILLER                  PIC  X.
   292     05  W-ONBASE-CODE           PIC  XX.
   293     05  FILLER                  PIC  X.
   294     05  W-ACCT-SUMM             PIC  X.
   295     05  FILLER                  PIC  X.
   296     05  W-CSO-SUMM              PIC  X.
   297     05  FILLER                  PIC  X(31).
   298 01  MISC.
   299     12  WS-RESPONSE             PIC S9(8)   COMP.
   300         88  RESP-NORMAL                  VALUE +00.
   301         88  RESP-NOTFND                  VALUE +13.
   302         88  RESP-DUPREC                  VALUE +14.
   303         88  RESP-DUPKEY                  VALUE +15.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page   7
* NSRASBL.cbl
   304         88  RESP-NOTOPEN                 VALUE +19.
   305         88  RESP-ENDFILE                 VALUE +20.
   306 01  srch-commarea.
   307*                                copy ELCADLTRSPI.
   308******************************************************************
   309*                   C H A N G E   L O G
   310*
   311* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   312*-----------------------------------------------------------------
   313*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   314* EFFECTIVE    NUMBER
   315*-----------------------------------------------------------------
   316* 060611    2011022800001  PEMA  NEW COPYBOOK
   317* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   318* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   319******************************************************************
   320****************************************
   321*  commarea for NaperSoft On Demand Admin services letters
   322*  (business logic input & output)
   323****************************************
   324     03  BL-INPUT.
   325         05  BL-DATA-SRCE        PIC X.
   326         05  BL-LETTER-ID        PIC XXXX.
   327         05  BL-CARRIER          PIC X.
   328         05  BL-GROUP            PIC X(6).
   329         05  BL-STATE            PIC XX.
   330         05  BL-ACCOUNT          PIC X(10).
   331         05  BL-EFF-DT           PIC X(10).
   332         05  BL-CERT-NO          PIC X(11).
   333         05  BL-BATCH-NO         PIC X(6).
   334         05  BL-BATCH-SEQ        PIC 9(8).
   335         05  BL-RESP-NO          PIC X(10).
   336         05  BL-NO-OF-COPIES     PIC 99.
   337         05  BL-PROC-ID          PIC XXXX.
   338         05  BL-COMP-ID          PIC XXX.
   339         05  BL-PRINT-NOW-SW     PIC X.
   340         05  BL-ENC-CD           PIC XXX.
   341         05  BL-RESEND-DT        PIC X(10).
   342         05  BL-FOLLOW-UP-DT     PIC X(10).
   343         05  BL-ARCHIVE-NO       PIC 9(8).
   344         05  BL-FUNC             PIC X(8).
   345         05  BL-COMMENTS         PIC X(100).
   346         05  FILLER REDEFINES BL-COMMENTS.
   347             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   348             10  BL-LETTER-TO-ACCT PIC X.
   349             10  BL-LETTER-TO-BENE PIC X.
   350             10  BL-WRITE-ERARCH   PIC X.
   351                 88  ERARCH-QWS      VALUE 'Q'.
   352                 88  ERARCH-BATCH    VALUE 'B'.
   353                 88  ERARCH-TEMP     VALUE 'T'.
   354             10  BL-PROCESS-TYPE PIC X(07).
   355             10  BL-CERT-FORM-ID PIC X(05).
   356             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   357             10  BL-SOURCE-SCREEN PIC X(8).
   358             10  FILLER          PIC X(25).
   359     03  BL-OUTPUT.
   360         05  BL-STATUS                   PIC X.
   361             88  BL-OK                      VALUE "P".
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page   8
* NSRASBL.cbl
   362             88  BL-FAIL                  VALUE "F".
   363         05  BL-MESSAGE          PIC X(50).
   364     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   365     03  FILLER                  PIC X(31).
   366 01  filler                      pic x(500).
   367 01  WS-SAVE-CARRIER-INFO.
   368     05  WS-PREV-CARRIER         PIC X      VALUE SPACES.
   369     05  WS-CARR-NAME            PIC X(30)  VALUE SPACES.
   370     05  WS-CARR-ICO             PIC X(30)  VALUE SPACES.
   371     05  WS-CARR-ADDR1           PIC X(30)  VALUE SPACES.
   372     05  WS-CARR-ADDR2           PIC X(30)  VALUE SPACES.
   373     05  WS-CARR-CITYST          PIC X(30)  VALUE SPACES.
   374     05  WS-CARR-ZIP             PIC X(9)   VALUE SPACES.
   375     05  WS-CARR-PHONE           PIC X(11)  VALUE SPACES.
   376 01  WS-SAVE-STATE-INFO.
   377     05  WS-PREV-STATE           PIC XX     VALUE SPACES.
   378     05  WS-STATE-NAME           PIC X(25)  VALUE SPACES.
   379 01  WS-SAVE-LFBEN-INFO.
   380     05  WS-PREV-LFBEN           PIC XX     VALUE SPACES.
   381     05  WS-LFBEN-ALPH           PIC XXX    VALUE SPACES.
   382     05  WS-LFBEN-DESC           PIC X(10)  VALUE SPACES.
   383 01  WS-SAVE-AHBEN-INFO.
   384     05  WS-PREV-AHBEN           PIC XX     VALUE SPACES.
   385     05  WS-AHBEN-DESC           PIC X(10)  VALUE SPACES.
   386     05  WS-AHBEN-RET-ELIM       PIC X      VALUE SPACES.
   387     05  WS-AHBEN-DAYS           PIC XX     VALUE SPACES.
   388 01  WS-ERPNDB-KEY.
   389     05  WS-ERPNDB-COMPANY-CD    PIC X.
   390     05  WS-ERPNDB-BATCH-NO      PIC X(6).
   391     05  WS-ERPNDB-BATCH-SEQ     PIC S9(4) COMP  VALUE +0.
   392     05  WS-ERPNDB-CHG-SEQ       PIC S9(4) COMP  VALUE +0.
   393 01  WS-ELENCC-KEY.
   394     05  WS-ELENCC-COMPANY-CD    PIC X.
   395     05  WS-ELENCC-REC-TYPE      PIC X.
   396     05  WS-ELENCC-ENC-CODE      PIC X(5).
   397     05  F                       PIC X(9).
   398 01  WS-ELCERT-KEY.
   399     05  WS-ELCERT-COMPANY-CD    PIC X.
   400     05  WS-ELCERT-CARRIER       PIC X.
   401     05  WS-ELCERT-GROUP         PIC X(6).
   402     05  WS-ELCERT-STATE         PIC XX.
   403     05  WS-ELCERT-ACCOUNT       PIC X(10).
   404     05  WS-ELCERT-EFF-DT        PIC XX.
   405     05  WS-ELCERT-CERT-NO       PIC X(11).
   406 01  WS-ERENDT-KEY.
   407     05  WS-ERENDT-COMPANY-CD    PIC X.
   408     05  WS-ERENDT-CARRIER       PIC X.
   409     05  WS-ERENDT-GROUP         PIC X(6).
   410     05  WS-ERENDT-STATE         PIC XX.
   411     05  WS-ERENDT-ACCOUNT       PIC X(10).
   412     05  WS-ERENDT-EFF-DT        PIC XX.
   413     05  WS-ERENDT-CERT-NO       PIC X(11).
   414     05  WS-ERENDT-REC-TYPE      PIC X.
   415     05  WS-ERENDT-SEQ-NO        PIC 9(4) BINARY.
   416
   417 01  WS-ERENDT-KEY-BY-ARCH.
   418     05  WS-ERENDT-COMPANY-CD-A1 PIC X.
   419     05  WS-ERENDT-ARCHIVE       PIC 9(8) BINARY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page   9
* NSRASBL.cbl
   420 01  WS-ERCOMP-KEY.
   421     05  WS-ERCOMP-COMPANY-CD    PIC X.
   422     05  WS-ERCOMP-CARRIER       PIC X.
   423     05  WS-ERCOMP-GROUP         PIC X(6).
   424     05  WS-ERCOMP-RESP-NO       PIC X(10).
   425     05  WS-ERCOMP-ACCOUNT       PIC X(10).
   426     05  WS-ERCOMP-REC-TYPE      PIC X.
   427 01  WS-ERMAIL-KEY.
   428     05  WS-ERMAIL-COMPANY-CD    PIC X.
   429     05  WS-ERMAIL-CARRIER       PIC X.
   430     05  WS-ERMAIL-GROUP         PIC X(6).
   431     05  WS-ERMAIL-STATE         PIC XX.
   432     05  WS-ERMAIL-ACCOUNT       PIC X(10).
   433     05  WS-ERMAIL-EFF-DT        PIC XX.
   434     05  WS-ERMAIL-CERT-NO       PIC X(11).
   435 01  WS-ERACCT-KEY.
   436     05  WS-ERACCT-COMPANY-CD    PIC X.
   437     05  WS-ERACCT-CARRIER       PIC X.
   438     05  WS-ERACCT-GROUP         PIC X(6).
   439     05  WS-ERACCT-STATE         PIC XX.
   440     05  WS-ERACCT-ACCOUNT       PIC X(10).
   441     05  WS-ERACCT-EXP-DT        PIC XX.
   442     05  FILLER                  PIC XXXX.
   443 01  WS-ELLETR-KEY.
   444     05  WS-ELLETR-COMPANY-CD    PIC X.
   445     05  WS-ELLETR-LETTER-ID     PIC X(12).
   446     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   447 01  WS-ELCNTL-KEY.
   448     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   449     05  WS-ELCNTL-REC-TYPE      PIC X.
   450     05  WS-ELCNTL-GENL.
   451         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   452         10  WS-ELCNTL-BEN-CD.
   453             15  F               PIC X.
   454             15  WS-ELCNTL-CARR  PIC X.
   455     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   456*                                COPY ELCDATE.
   457******************************************************************
   458*                                                                *
   459*                                                                *
   460*                            ELCDATE.                            *
   461*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   462*                            VMOD=2.003
   463*                                                                *
   464*                                                                *
   465*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   466*                 LENGTH = 200                                   *
   467******************************************************************
   468
   469 01  DATE-CONVERSION-DATA.
   470     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   471     12  DC-OPTION-CODE                PIC X.
   472         88  BIN-TO-GREG                VALUE ' '.
   473         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   474         88  EDIT-GREG-TO-BIN           VALUE '2'.
   475         88  YMD-GREG-TO-BIN            VALUE '3'.
   476         88  MDY-GREG-TO-BIN            VALUE '4'.
   477         88  JULIAN-TO-BIN              VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  10
* NSRASBL.cbl
   478         88  BIN-PLUS-ELAPSED           VALUE '6'.
   479         88  FIND-CENTURY               VALUE '7'.
   480         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   481         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   482         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   483         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   484         88  JULIAN-TO-BIN-3            VALUE 'C'.
   485         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   486         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   487         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   488         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   489         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   490         88  CHECK-LEAP-YEAR            VALUE 'H'.
   491         88  BIN-3-TO-GREG              VALUE 'I'.
   492         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   493         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   494         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   495         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   496         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   497         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   498         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   499         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   500         88  THREE-CHARACTER-BIN
   501                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   502         88  GREGORIAN-TO-BIN
   503                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   504         88  BIN-TO-GREGORIAN
   505                  VALUES ' ' '1' 'I' '8' 'G'.
   506         88  JULIAN-TO-BINARY
   507                  VALUES '5' 'C' 'E' 'F'.
   508     12  DC-ERROR-CODE                 PIC X.
   509         88  NO-CONVERSION-ERROR        VALUE ' '.
   510         88  DATE-CONVERSION-ERROR
   511                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   512         88  DATE-IS-ZERO               VALUE '1'.
   513         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   514         88  DATE-IS-INVALID            VALUE '3'.
   515         88  DATE1-GREATER-DATE2        VALUE '4'.
   516         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   517         88  DATE-INVALID-OPTION        VALUE '9'.
   518         88  INVALID-CENTURY            VALUE 'A'.
   519         88  ONLY-CENTURY               VALUE 'B'.
   520         88  ONLY-LEAP-YEAR             VALUE 'C'.
   521         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   522     12  DC-END-OF-MONTH               PIC X.
   523         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   524     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   525         88  USE-NORMAL-PROCESS         VALUE ' '.
   526         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   527         88  ADJUST-UP-100-YRS          VALUE '2'.
   528     12  FILLER                        PIC X.
   529     12  DC-CONVERSION-DATES.
   530         16  DC-BIN-DATE-1             PIC XX.
   531         16  DC-BIN-DATE-2             PIC XX.
   532         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   533         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   534                       DC-GREG-DATE-1-EDIT.
   535             20  DC-EDIT1-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  11
* NSRASBL.cbl
   536             20  SLASH1-1              PIC X.
   537             20  DC-EDIT1-DAY          PIC 99.
   538             20  SLASH1-2              PIC X.
   539             20  DC-EDIT1-YEAR         PIC 99.
   540         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   541         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   542                     DC-GREG-DATE-2-EDIT.
   543             20  DC-EDIT2-MONTH        PIC 99.
   544             20  SLASH2-1              PIC X.
   545             20  DC-EDIT2-DAY          PIC 99.
   546             20  SLASH2-2              PIC X.
   547             20  DC-EDIT2-YEAR         PIC 99.
   548         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   549         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   550                     DC-GREG-DATE-1-YMD.
   551             20  DC-YMD-YEAR           PIC 99.
   552             20  DC-YMD-MONTH          PIC 99.
   553             20  DC-YMD-DAY            PIC 99.
   554         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   555         16  DC-GREG-DATE-1-MDY-R REDEFINES
   556                      DC-GREG-DATE-1-MDY.
   557             20  DC-MDY-MONTH          PIC 99.
   558             20  DC-MDY-DAY            PIC 99.
   559             20  DC-MDY-YEAR           PIC 99.
   560         16  DC-GREG-DATE-1-ALPHA.
   561             20  DC-ALPHA-MONTH        PIC X(10).
   562             20  DC-ALPHA-DAY          PIC 99.
   563             20  FILLER                PIC XX.
   564             20  DC-ALPHA-CENTURY.
   565                 24 DC-ALPHA-CEN-N     PIC 99.
   566             20  DC-ALPHA-YEAR         PIC 99.
   567         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   568         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   569         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   570         16  DC-JULIAN-DATE            PIC 9(05).
   571         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   572                                       PIC 9(05).
   573         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   574             20  DC-JULIAN-YEAR        PIC 99.
   575             20  DC-JULIAN-DAYS        PIC 999.
   576         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   577         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   578         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   579     12  DATE-CONVERSION-VARIBLES.
   580         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   581         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   582             20  FILLER                PIC 9(3).
   583             20  HOLD-CEN-1-CCYY.
   584                 24  HOLD-CEN-1-CC     PIC 99.
   585                 24  HOLD-CEN-1-YY     PIC 99.
   586             20  HOLD-CEN-1-MO         PIC 99.
   587             20  HOLD-CEN-1-DA         PIC 99.
   588         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   589             20  HOLD-CEN-1-R-MO       PIC 99.
   590             20  HOLD-CEN-1-R-DA       PIC 99.
   591             20  HOLD-CEN-1-R-CCYY.
   592                 24  HOLD-CEN-1-R-CC   PIC 99.
   593                 24  HOLD-CEN-1-R-YY   PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  12
* NSRASBL.cbl
   594             20  FILLER                PIC 9(3).
   595         16  HOLD-CENTURY-1-X.
   596             20  FILLER                PIC X(3)  VALUE SPACES.
   597             20  HOLD-CEN-1-X-CCYY.
   598                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   599                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   600             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   601             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   602         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   603             20  HOLD-CEN-1-R-X-MO     PIC XX.
   604             20  HOLD-CEN-1-R-X-DA     PIC XX.
   605             20  HOLD-CEN-1-R-X-CCYY.
   606                 24  HOLD-CEN-1-R-X-CC PIC XX.
   607                 24  HOLD-CEN-1-R-X-YY PIC XX.
   608             20  FILLER                PIC XXX.
   609         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   610         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   611         16  DC-JULIAN-DATE-1          PIC 9(07).
   612         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   613             20  DC-JULIAN-1-CCYY.
   614                 24  DC-JULIAN-1-CC    PIC 99.
   615                 24  DC-JULIAN-1-YR    PIC 99.
   616             20  DC-JULIAN-DA-1        PIC 999.
   617         16  DC-JULIAN-DATE-2          PIC 9(07).
   618         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   619             20  DC-JULIAN-2-CCYY.
   620                 24  DC-JULIAN-2-CC    PIC 99.
   621                 24  DC-JULIAN-2-YR    PIC 99.
   622             20  DC-JULIAN-DA-2        PIC 999.
   623         16  DC-GREG-DATE-A-EDIT.
   624             20  DC-EDITA-MONTH        PIC 99.
   625             20  SLASHA-1              PIC X VALUE '/'.
   626             20  DC-EDITA-DAY          PIC 99.
   627             20  SLASHA-2              PIC X VALUE '/'.
   628             20  DC-EDITA-CCYY.
   629                 24  DC-EDITA-CENT     PIC 99.
   630                 24  DC-EDITA-YEAR     PIC 99.
   631         16  DC-GREG-DATE-B-EDIT.
   632             20  DC-EDITB-MONTH        PIC 99.
   633             20  SLASHB-1              PIC X VALUE '/'.
   634             20  DC-EDITB-DAY          PIC 99.
   635             20  SLASHB-2              PIC X VALUE '/'.
   636             20  DC-EDITB-CCYY.
   637                 24  DC-EDITB-CENT     PIC 99.
   638                 24  DC-EDITB-YEAR     PIC 99.
   639         16  DC-GREG-DATE-CYMD         PIC 9(08).
   640         16  DC-GREG-DATE-CYMD-R REDEFINES
   641                              DC-GREG-DATE-CYMD.
   642             20  DC-CYMD-CEN           PIC 99.
   643             20  DC-CYMD-YEAR          PIC 99.
   644             20  DC-CYMD-MONTH         PIC 99.
   645             20  DC-CYMD-DAY           PIC 99.
   646         16  DC-GREG-DATE-MDCY         PIC 9(08).
   647         16  DC-GREG-DATE-MDCY-R REDEFINES
   648                              DC-GREG-DATE-MDCY.
   649             20  DC-MDCY-MONTH         PIC 99.
   650             20  DC-MDCY-DAY           PIC 99.
   651             20  DC-MDCY-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  13
* NSRASBL.cbl
   652             20  DC-MDCY-YEAR          PIC 99.
   653    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   654        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   655    12  DC-EL310-DATE                  PIC X(21).
   656    12  FILLER                         PIC X(28).
   657*                                COPY NSCASEXTR.
   658******************************************************************
   659*                                                                *
   660*                                                                *
   661*                            NSCASEXTR.                          *
   662*                            VMOD=2.001                          *
   663*                                                                *
   664*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   665*                                                                *
   666*   FILE TYPE = VSAM,KSDS                                        *
   667*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   668*                                                                *
   669*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   670*                                                                *
   671*   LOG = NO                                                     *
   672*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   673******************************************************************
   674*-----------------------------------------------------------------
   675*                   C H A N G E   L O G
   676*
   677* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   678*-----------------------------------------------------------------
   679*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   680* EFFECTIVE    NUMBER
   681*-----------------------------------------------------------------
   682* 072211    2011022800001  PEMA  NEW FILE
   683*-----------------------------------------------------------------
   684 01 NSAS-EXTRACT-RECORD.
   685    05  NSAS-CONTROL-PRIMARY.
   686        10  NSAS-COMPANY-CD      PIC X.
   687        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   688        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   689    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   690    05  FILLER                   PIC X(143).
   691*                                COPY ERCPNDB.
   692******************************************************************
   693*                                                                *
   694*                                                                *
   695*                            ERCPNDB.                            *
   696*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   697*                            VMOD=2.025                          *
   698*                                                                *
   699*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   700*                                                                *
   701******************************************************************
   702*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   703*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   704******************************************************************
   705*                                                                *
   706*                                                                *
   707*   FILE TYPE = VSAM,KSDS                                        *
   708*   RECORD SIZE = 585  RECFORM = FIXED                           *
   709*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  14
* NSRASBL.cbl
   710*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   711*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   712*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   713*                                                 RKP=13,LEN=36  *
   714*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   715*                                      AND CHG-SEQ.)             *
   716*                                                RKP=49,LEN=11   *
   717*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   718*                                      AND CHG-SEQ.)             *
   719*                                                RKP=60,LEN=15   *
   720*                                                                *
   721*   LOG = NO                                                     *
   722*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   723******************************************************************
   724******************************************************************
   725*                   C H A N G E   L O G
   726*
   727* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   728*-----------------------------------------------------------------
   729*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   730* EFFECTIVE    NUMBER
   731*-----------------------------------------------------------------
   732* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   733* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   734* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   735* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   736* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   737* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   738* 032306                   PEMA  ADD BOW LOAN NUMBER
   739* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   740* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   741* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   742* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   743* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   744* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   745* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   746* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   747******************************************************************
   748
   749 01  PENDING-BUSINESS.
   750     12  PB-RECORD-ID                     PIC XX.
   751         88  VALID-PB-ID                        VALUE 'PB'.
   752
   753     12  PB-CONTROL-PRIMARY.
   754         16  PB-COMPANY-CD                PIC X.
   755         16  PB-ENTRY-BATCH               PIC X(6).
   756         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   757         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   758
   759     12  PB-CONTROL-BY-ACCOUNT.
   760         16  PB-COMPANY-CD-A1             PIC X.
   761         16  PB-CARRIER                   PIC X.
   762         16  PB-GROUPING.
   763             20  PB-GROUPING-PREFIX       PIC XXX.
   764             20  PB-GROUPING-PRIME        PIC XXX.
   765         16  PB-STATE                     PIC XX.
   766         16  PB-ACCOUNT.
   767             20  PB-ACCOUNT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  15
* NSRASBL.cbl
   768             20  PB-ACCOUNT-PRIME         PIC X(6).
   769         16  PB-CERT-EFF-DT               PIC XX.
   770         16  PB-CERT-NO.
   771             20  PB-CERT-PRIME            PIC X(10).
   772             20  PB-CERT-SFX              PIC X.
   773         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   774
   775         16  PB-RECORD-TYPE               PIC X.
   776             88  PB-MAILING-DATA                VALUE '0'.
   777             88  PB-ISSUE                       VALUE '1'.
   778             88  PB-CANCELLATION                VALUE '2'.
   779             88  PB-BATCH-TRAILER               VALUE '9'.
   780
   781     12  PB-CONTROL-BY-ORIG-BATCH.
   782         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   783         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   784         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   785         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   786
   787     12  PB-CONTROL-BY-CSR.
   788         16  PB-CSR-COMPANY-CD            PIC X.
   789         16  PB-CSR-ID                    PIC X(4).
   790         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   791         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   792         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   793******************************************************************
   794*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   795******************************************************************
   796
   797     12  PB-LAST-MAINT-DT                 PIC XX.
   798     12  PB-LAST-MAINT-BY                 PIC X(4).
   799     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   800
   801     12  PB-RECORD-BODY                   PIC X(375).
   802
   803     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   804         16  PB-CERT-ORIGIN               PIC X.
   805             88  CLASIC-CREATED-CERT         VALUE '1'.
   806         16  PB-I-NAME.
   807             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   808             20  PB-I-INSURED-FIRST-NAME.
   809                 24  PB-I-INSURED-1ST-INIT PIC X.
   810                 24  FILLER                PIC X(9).
   811             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   812         16  PB-I-AGE                     PIC S99   COMP-3.
   813         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   814         16  PB-I-BIRTHDAY                PIC XX.
   815         16  PB-I-INSURED-SEX             PIC X.
   816             88  PB-SEX-MALE     VALUE 'M'.
   817             88  PB-SEX-FEMALE   VALUE 'F'.
   818
   819         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   820         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   821         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   822         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   823         16  PB-I-SKIP-CODE               PIC X.
   824             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   825             88  PB-SKIP-JULY              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  16
* NSRASBL.cbl
   826             88  PB-SKIP-AUGUST            VALUE '2'.
   827             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   828             88  PB-SKIP-JULY-AUG          VALUE '4'.
   829             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   830             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   831             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   832             88  PB-SKIP-JUNE              VALUE '8'.
   833             88  PB-SKIP-JUNE-JULY         VALUE '9'.
   834             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   835             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   836         16  PB-I-TERM-TYPE               PIC X.
   837             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   838             88  PB-PAID-WEEKLY            VALUE 'W'.
   839             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   840             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
   841             88  PB-PAID-13-YEARLY         VALUE 'T'.
   842         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   843         16  PB-I-POLICY-FORM-NO          PIC X(12).
   844         16  PB-I-DATA-ENTRY-SW           PIC X.
   845             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   846             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   847             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   848             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   849         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   850         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   851*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   852         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   853         16  FILLER                       PIC X.
   854
   855         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   856             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   857             88  PB-INVALID-LIFE             VALUE '  ' '00'
   858                                                   '90' THRU '99'.
   859         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   860                                          PIC XX.
   861         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   862         16  PB-I-AMOUNT-FINANCED REDEFINES
   863                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   864         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   865         16  PB-I-UNPAID-CASH-PRICE REDEFINES
   866                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
   867         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   868         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   869         16  PB-I-CLP-AMOUNT REDEFINES
   870                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
   871         16  PB-I-LF-CALC-FLAG            PIC X.
   872             88 PB-COMP-LF-PREM               VALUE '?'.
   873         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   874         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   875         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   876         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   877         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
   878         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   879         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
   880         16  PB-I-LF-ABBR                 PIC XXX.
   881         16  PB-I-LF-INPUT-CD             PIC XX.
   882
   883         16  PB-I-AH-BENEFIT-CD           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  17
* NSRASBL.cbl
   884             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   885             88  PB-INVALID-AH               VALUE '  ' '00'
   886                                                   '90' THRU '99'.
   887         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   888         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   889         16  PB-I-AH-CALC-FLAG            PIC X.
   890             88 PB-COMP-AH-PREM                  VALUE '?'.
   891         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
   892         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   893         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
   894         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   895         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   896         16  PB-I-AH-ABBR                 PIC XXX.
   897         16  PB-I-AH-INPUT-CD             PIC XXX.
   898
   899         16  PB-I-SPECIAL-REIN-CODE       PIC X.
   900         16  PB-I-REIN-TABLE              PIC XXX.
   901         16  PB-I-BUSINESS-TYPE           PIC 99.
   902         16  PB-I-INDV-GRP-CD             PIC X.
   903         16  PB-I-MORT-CODE.
   904             20  PB-I-TABLE               PIC X.
   905             20  PB-I-INTEREST            PIC XX.
   906             20  PB-I-MORT-TYP            PIC X.
   907         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   908         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   909         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   910         16  PB-I-INDV-GRP-OVRD           PIC X.
   911         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   912         16  PB-I-SIG-SW                  PIC X.
   913             88  PB-POLICY-SIGNED             VALUE 'Y'.
   914         16  PB-I-RATE-CLASS              PIC XX.
   915         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   916         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
   917         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   918         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   919         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   920         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   921         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   922         16  PB-I-BENEFIT-TYPE            PIC XXX.
   923         16  PB-I-OB-FLAG                 PIC X.
   924             88  PB-I-OB                      VALUE 'B'.
   925             88  PB-I-SUMMARY                 VALUE 'Z'.
   926         16  PB-I-ENTRY-STATUS            PIC X.
   927             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   928                                              'M' '5' '9' '2'.
   929             88  PB-I-NORMAL-ENTRY            VALUE '1'.
   930             88  PB-I-POLICY-PENDING          VALUE '2'.
   931             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   932             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   933             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   934             88  PB-I-REIN-ONLY               VALUE '9'.
   935             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
   936             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   937             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
   938             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   939         16  PB-I-INT-CODE                PIC X.
   940             88  PB-ADD-ON-INTEREST           VALUE 'A'.
   941             88  PB-SIMPLE-INTEREST           VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  18
* NSRASBL.cbl
   942         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   943         16  PB-I-SOC-SEC-NO              PIC X(11).
   944         16  PB-I-MEMBER-NO               PIC X(12).
   945         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
   946*        16  PB-I-LOAN-OFFICER            PIC XXX.
   947         16  PB-I-OLD-LOF                 PIC XXX.
   948         16  PB-I-LF-EXPIRE-DT            PIC XX.
   949         16  PB-I-AH-EXPIRE-DT            PIC XX.
   950         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   951         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   952         16  PB-I-LIFE-INDICATOR          PIC X.
   953             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   954         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   955         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
   956                                          PIC S9(5)V99    COMP-3.
   957         16  PB-I-MAIL-ADDRS-SW           PIC X.
   958             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   959             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   960         16  PB-I-1ST-PMT-DT              PIC XX.
   961         16  PB-I-JOINT-INSURED.
   962             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   963             20 PB-I-JOINT-FIRST-NAME.
   964                24  PB-I-JOINT-FIRST-INIT PIC X.
   965                24  FILLER                PIC X(9).
   966             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   967*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   968         16  PB-I-BENEFICIARY-NAME.
   969             20  PB-I-BANK-NUMBER         PIC X(10).
   970             20  FILLER                   PIC X(15).
   971         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   972         16  PB-I-REFERENCE               PIC X(12).
   973         16  FILLER REDEFINES PB-I-REFERENCE.
   974             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   975             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   976             20  PB-I-CLP-STATE           PIC XX.
   977         16  PB-I-UNDERWRITING-STATUS     PIC X.
   978             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   979             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   980             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   981         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
   982         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
   983         16  PB-I-RESIDENT-STATE          PIC XX.
   984         16  PB-I-RATE-CODE               PIC X(4).
   985         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
   986         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   987         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   988         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
   989         16  PB-I-BANK-NOCHRGB            PIC 99.
   990         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
   991         16  PB-I-JOINT-BIRTHDAY          PIC XX.
   992
   993     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
   994         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
   995             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
   996         16  PB-C-CANCEL-ORIGIN           PIC X.
   997             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
   998         16  PB-C-LF-CANCEL-DT            PIC XX.
   999         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  19
* NSRASBL.cbl
  1000         16  PB-C-LF-CALC-REQ             PIC X.
  1001             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1002         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1003         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  1004         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1005             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1006         16  PB-C-AH-CANCEL-DT            PIC XX.
  1007         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1008         16  PB-C-AH-CALC-REQ             PIC X.
  1009             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1010         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1011         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1012         16  PB-C-LAST-NAME               PIC X(15).
  1013         16  PB-C-REFUND-SW               PIC X.
  1014             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1015             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1016         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1017         16  PB-C-PAYEE-CODE              PIC X(6).
  1018         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1019         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1020         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1021         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1022         16  PB-C-REFERENCE               PIC X(12).
  1023         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1024         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1025         16  PB-C-POST-CARD-IND           PIC X.
  1026         16  PB-C-CANCEL-REASON           PIC X.
  1027         16  PB-C-REF-INTERFACE-SW        PIC X.
  1028         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1029         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1030         16  FILLER                       PIC X(01).
  1031*        16  FILLER                       PIC X(18).
  1032         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1033*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1034         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  1035         16  PB-CANCELED-CERT-DATA.
  1036             20  PB-CI-INSURED-NAME.
  1037                 24  PB-CI-LAST-NAME      PIC X(15).
  1038                 24  PB-CI-INITIALS       PIC XX.
  1039             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  1040             20  PB-CI-INSURED-SEX        PIC X.
  1041             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1042             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1043             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1044             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1045             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1046             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  1047             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1048             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1049             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1050             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1051             20  PB-CI-RATE-CLASS         PIC XX.
  1052             20  PB-CI-RATE-DEV-LF        PIC XXX.
  1053             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1054             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1055             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1056             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1057             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  20
* NSRASBL.cbl
  1058             20  PB-CI-LF-ABBR            PIC X(3).
  1059             20  PB-CI-AH-ABBR            PIC X(3).
  1060             20  PB-CI-OB-FLAG            PIC X.
  1061                 88  PB-CI-OB                VALUE 'B'.
  1062             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1063                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1064                                           'M' '4' '5' '9' '2'.
  1065                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1066                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1067                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1068                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1069                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1070                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1071                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1072                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1073                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1074                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1075                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1076                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1077             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1078                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1079                                           'M' '4' '5' '9' '2'.
  1080                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1081                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1082                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1083                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1084                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1085                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1086                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1087                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1088                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1089                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1090                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1091                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1092             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1093             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1094             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1095             20  PB-CI-MEMBER-NO          PIC X(12).
  1096             20  PB-CI-INT-CODE           PIC X.
  1097                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1098                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1099             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1100             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1101             20  PB-CI-COMP-EXCP-SW       PIC X.
  1102                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1103                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1104             20  PB-CI-ENTRY-STATUS       PIC X.
  1105             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1106             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1107             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1108             20  PB-CI-DEATH-DT           PIC XX.
  1109             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1110             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1111             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1112             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1113             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1114             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1115             20  PB-CI-ENTRY-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  21
* NSRASBL.cbl
  1116             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1117             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1118             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1119             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1120             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1121             20  PB-CI-OLD-LOF               PIC XXX.
  1122*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1123             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1124             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1125             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1126             20  PB-CI-INDV-GRP-CD           PIC X.
  1127             20  PB-CI-BENEFICIARY-NAME.
  1128                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1129                 24  FILLER                  PIC X(15).
  1130             20  PB-CI-NOTE-SW               PIC X.
  1131             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1132             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1133             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1134             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1135             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1136             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1137             20  PB-CI-FIRST-NAME            PIC X(10).
  1138             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1139
  1140         16  FILLER                       PIC X(13).
  1141*032306  16  FILLER                       PIC X(27).
  1142*        16  FILLER                       PIC X(46).
  1143
  1144     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1145         16  FILLER                       PIC X(10).
  1146         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1147         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1148         16  PB-M-INSURED-MID-INIT        PIC X.
  1149         16  PB-M-INSURED-AGE             PIC 99.
  1150         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1151         16  PB-M-INSURED-SEX             PIC X.
  1152         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1153         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1154         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1155         16  PB-M-INSURED-CITY-STATE.
  1156             20  PB-M-INSURED-CITY        PIC X(28).
  1157             20  PB-M-INSURED-STATE       PIC XX.
  1158         16  PB-M-INSURED-ZIP-CODE.
  1159             20  PB-M-INSURED-ZIP-PRIME.
  1160                 24  PB-M-INSURED-ZIP-1   PIC X.
  1161                     88  PB-M-CANADIAN-POST-CODE
  1162                                             VALUE 'A' THRU 'Z'.
  1163                 24  FILLER               PIC X(4).
  1164             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1165         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1166                                        PB-M-INSURED-ZIP-CODE.
  1167             20  PM-M-INS-CAN-POST1       PIC XXX.
  1168             20  PM-M-INS-CAN-POST2       PIC XXX.
  1169             20  FILLER                   PIC XXX.
  1170         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1171         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1172         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1173         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  22
* NSRASBL.cbl
  1174         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1175         16  PB-M-CRED-BENE-CITYST.
  1176             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1177             20  PB-M-CRED-BENE-STATE     PIC XX.
  1178         16  FILLER                       PIC X(92).
  1179
  1180     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1181         16  FILLER                       PIC X(10).
  1182         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1183         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1184         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1185         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1186         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1187         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1188         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1189         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1190         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1191         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1192         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1193         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1194         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1195         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1196         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1197         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1198         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1199         16  PB-ACCOUNT-NAME              PIC X(30).
  1200         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1201         16  PB-REFERENCE                 PIC X(12).
  1202         16  PB-B-RECEIVED-DT             PIC XX.
  1203         16  FILLER                       PIC X(234).
  1204
  1205     12  PB-RECORD-STATUS.
  1206         16  PB-CREDIT-SELECT-DT          PIC XX.
  1207         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  1208         16  PB-BILLED-DT                 PIC XX.
  1209         16  PB-BILLING-STATUS            PIC X.
  1210             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1211             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1212             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1213         16  PB-RECORD-BILL               PIC X.
  1214             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1215             88  PB-RECORD-RETURNED           VALUE 'R'.
  1216             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1217             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1218             88  PB-OVERRIDE-AH               VALUE 'A'.
  1219             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1220         16  PB-BATCH-ENTRY               PIC X.
  1221             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1222             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1223             88  PB-REISSUED-CERT             VALUE 'E'.
  1224             88  PB-MONTHLY-CERT              VALUE 'M'.
  1225             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1226             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1227             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1228         16  PB-FORCE-CODE                PIC X.
  1229             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1230             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1231             88  PB-CANCEL-FORCE              VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  23
* NSRASBL.cbl
  1232             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1233             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1234             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1235             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1236             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1237             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1238             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1239         16  PB-FATAL-FLAG                PIC X.
  1240             88  PB-FATAL-ERRORS              VALUE 'X'.
  1241         16  PB-FORCE-ER-CD               PIC X.
  1242             88  PB-FORCE-ERRORS              VALUE 'F'.
  1243             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1244         16  PB-WARN-ER-CD                PIC X.
  1245             88  PB-WARNING-ERRORS            VALUE 'W'.
  1246         16  FILLER                       PIC X.
  1247         16  PB-OUT-BAL-CD                PIC X.
  1248             88  PB-OUT-OF-BAL                VALUE 'O'.
  1249         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1250         16  PB-AH-OVERRIDE-L1            PIC X.
  1251         16  PB-INPUT-DT                  PIC XX.
  1252         16  PB-INPUT-BY                  PIC X(4).
  1253         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1254         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1255         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1256         16  PB-LF-EARNING-METHOD         PIC X.
  1257         16  PB-AH-EARNING-METHOD         PIC X.
  1258         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1259         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1260         16  PB-REIN-CD                   PIC XXX.
  1261         16  PB-LF-REFUND-TYPE            PIC X.
  1262         16  PB-AH-REFUND-TYPE            PIC X.
  1263         16  PB-ACCT-EFF-DT               PIC XX.
  1264         16  PB-ACCT-EXP-DT               PIC XX.
  1265         16  PB-COMPANY-ID                PIC X(3).
  1266         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1267         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1268         16  PB-SV-CARRIER                PIC X.
  1269         16  PB-SV-GROUPING               PIC X(6).
  1270         16  PB-SV-STATE                  PIC XX.
  1271         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1272         16  PB-GA-BILLING-INFO.
  1273             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1274                                          PIC XX.
  1275         16  PB-SV-REMIT-TO  REDEFINES
  1276             PB-GA-BILLING-INFO           PIC X(10).
  1277         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1278         16  PB-I-LOAN-OFFICER            PIC X(5).
  1279         16  PB-I-VIN                     PIC X(17).
  1280
  1281         16  FILLER                       PIC X(04).
  1282         16  IMNET-BYPASS-SW              PIC X.
  1283
  1284******************************************************************
  1285*                COMMON EDIT ERRORS                              *
  1286******************************************************************
  1287
  1288     12  PB-COMMON-ERRORS.
  1289         16  PB-COMMON-ERROR    OCCURS 10 TIMES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  24
* NSRASBL.cbl
  1290                                           PIC S9(4)     COMP.
  1291
  1292******************************************************************
  1293*                                COPY ERCENDT.
  1294******************************************************************
  1295*                                                                *
  1296*                                                                *
  1297*                            ERCENDT.                            *
  1298*                            VMOD=2.001                          *
  1299*                                                                *
  1300*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1301*                                                                *
  1302*   FILE TYPE = VSAM,KSDS                                        *
  1303*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1304*                                                                *
  1305*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1306*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1307*                                                                *
  1308*   LOG = NO                                                     *
  1309*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1310******************************************************************
  1311*-----------------------------------------------------------------
  1312*                   C H A N G E   L O G
  1313*
  1314* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1315*-----------------------------------------------------------------
  1316*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1317* EFFECTIVE    NUMBER
  1318*-----------------------------------------------------------------
  1319* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1320*                                WITH OPEN CLAIMS
  1321* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1322* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1323*-----------------------------------------------------------------
  1324 01  ENDORSEMENT-RECORD.
  1325     12  EN-RECORD-ID                PIC XX.
  1326         88  VALID-EN-ID                VALUE 'EN'.
  1327     12  EN-CONTROL-PRIMARY.
  1328         16  EN-COMPANY-CD           PIC X.
  1329         16  EN-CARRIER              PIC X.
  1330         16  EN-GROUPING             PIC X(6).
  1331         16  EN-STATE                PIC XX.
  1332         16  EN-ACCOUNT              PIC X(10).
  1333         16  EN-CERT-EFF-DT          PIC XX.
  1334         16  EN-CERT-NO.
  1335             20  EN-CERT-PRIME       PIC X(10).
  1336             20  EN-CERT-SFX         PIC X.
  1337         16  EN-REC-TYPE             PIC X.
  1338             88  EN-ISSUE               VALUE 'I'.
  1339             88  EN-CANCELLATION        VALUE 'C'.
  1340         16  EN-SEQ-NO               PIC 9(04) BINARY.
  1341     12  EN-CONTROL-BY-ARCH-NO.
  1342         16  EN-COMPANY-CD-A1              PIC X.
  1343         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  1344     12  EN-LAST-MAINT-DT            PIC XX.
  1345     12  EN-LAST-MAINT-BY            PIC X(4).
  1346     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1347     12  EN-ENDORSEMENT-RECORD       PIC X(329).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  25
* NSRASBL.cbl
  1348     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1349         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  1350         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  1351         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  1352         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  1353         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  1354         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  1355         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  1356         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  1357         16  EN-LF-ORIG-BENCD        PIC XX.
  1358         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  1359         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1360         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1361         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1362         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1363         16  EN-LF-ORIG-EXP-DT       PIC XX.
  1364*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1365         16  EN-ORIG-CRED-BENE       PIC X(25).
  1366         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1367         16  FILLER                  PIC X.
  1368         16  EN-AH-ORIG-BENCD        PIC XX.
  1369         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  1370         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1371         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1372         16  EN-AH-ORIG-EXP-DT       PIC XX.
  1373*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1374*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1375         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1376         16  F                       PIC X(09).
  1377         16  EN-AH-ORIG-CP           PIC 99.
  1378         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  1379         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  1380         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  1381         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  1382         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  1383         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  1384         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  1385         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  1386         16  EN-LF-NEW-BENCD         PIC XX.
  1387         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  1388         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1389         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1390         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1391         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1392         16  EN-LF-NEW-EXP-DT        PIC XX.
  1393         16  EN-NEW-CRED-BENE        PIC X(25).
  1394         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1395         16  FILLER                  PIC X.
  1396         16  EN-AH-NEW-BENCD         PIC XX.
  1397         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  1398         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1399         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1400         16  EN-AH-NEW-EXP-DT        PIC XX.
  1401*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1402*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1403*        16  F                       PIC X(12).
  1404         16  EN-AH-NEW-CP            PIC 99.
  1405         16  EN-SIG-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  26
* NSRASBL.cbl
  1406         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1407         16  FILLER                  PIC X(37).
  1408     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1409         16  EN-LF-ORIG-REF-DT       PIC XX.
  1410         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1411         16  EN-AH-ORIG-REF-DT       PIC XX.
  1412         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1413         16  EN-LF-NEW-REF-DT        PIC XX.
  1414         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1415         16  EN-AH-NEW-REF-DT        PIC XX.
  1416         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1417         16  EN-FLAG-CERT            PIC X.
  1418         16  EN-INS-LAST-NAME        PIC X(15).
  1419         16  EN-INS-FIRST-NAME       PIC X(10).
  1420         16  EN-INS-MIDDLE-INIT      PIC X.
  1421         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1422         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1423         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1424         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1425         16  FILLER                  PIC X(262).
  1426     12  EN-MONEY-SW             PIC X.
  1427     12  EN-HEALTH-APP           PIC X.
  1428     12  EN-VOUCHER-SW           PIC X.
  1429     12  EN-PAYEE                PIC X(14).
  1430     12  EN-INPUT-DT             PIC XX.
  1431     12  EN-PROCESS-DT           PIC XX.
  1432     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1433     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1434     12  EN-REASON-CODES.
  1435         16  F OCCURS 12.
  1436             20  EN-REASON-CODE  PIC X(4).
  1437     12  EN-TEMPLATE-USED        PIC X(8).
  1438     12  EN-DOCU-TYPE            PIC X.
  1439         88  EN-VERI-DOCU          VALUE 'V'.
  1440         88  EN-GCE-DOCU           VALUE 'G'.
  1441         88  EN-CANC-DOCU          VALUE 'C'.
  1442     12  EN-COMMENTS1            PIC X(13).
  1443     12  EN-COMMENTS2            PIC X(70).
  1444     12  EN-COMM-CHGBK           PIC X.
  1445         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  1446         88  EN-CHG-ACCT           VALUE 'Y'.
  1447     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  1448     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  1449     12  EN-BATCH-NUMBER         PIC X(6).
  1450     12  EN-ACCT-SUMM            PIC X.
  1451     12  EN-CSO-SUMM             PIC X.
  1452     12  FILLER                  PIC X(13).
  1453******************************************************************
  1454*                                COPY ERCMAIL.
  1455******************************************************************
  1456*                                                                *
  1457*                                                                *
  1458*                            ERCMAIL                             *
  1459*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1460*                            VMOD=2.003                          *
  1461*                                                                *
  1462*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1463*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  27
* NSRASBL.cbl
  1464*   FILE TYPE = VSAM,KSDS                                        *
  1465*   RECORD SIZE = 374   RECFORM = FIX                            *
  1466*                                                                *
  1467*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1468*   ALTERNATE PATH    = NOT USED                                 *
  1469*                                                                *
  1470*   LOG = YES                                                    *
  1471*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1472******************************************************************
  1473*                   C H A N G E   L O G
  1474*
  1475* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1476*-----------------------------------------------------------------
  1477*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1478* EFFECTIVE    NUMBER
  1479*-----------------------------------------------------------------
  1480* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1481* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1482* 111108                   PEMA  ADD CRED BENE ADDR2
  1483******************************************************************
  1484
  1485 01  MAILING-DATA.
  1486     12  MA-RECORD-ID                      PIC XX.
  1487         88  VALID-MA-ID                       VALUE 'MA'.
  1488
  1489     12  MA-CONTROL-PRIMARY.
  1490         16  MA-COMPANY-CD                 PIC X.
  1491         16  MA-CARRIER                    PIC X.
  1492         16  MA-GROUPING.
  1493             20  MA-GROUPING-PREFIX        PIC XXX.
  1494             20  MA-GROUPING-PRIME         PIC XXX.
  1495         16  MA-STATE                      PIC XX.
  1496         16  MA-ACCOUNT.
  1497             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1498             20  MA-ACCOUNT-PRIME          PIC X(6).
  1499         16  MA-CERT-EFF-DT                PIC XX.
  1500         16  MA-CERT-NO.
  1501             20  MA-CERT-PRIME             PIC X(10).
  1502             20  MA-CERT-SFX               PIC X.
  1503
  1504     12  FILLER                            PIC XX.
  1505
  1506     12  MA-ACCESS-CONTROL.
  1507         16  MA-SOURCE-SYSTEM              PIC XX.
  1508             88  MA-FROM-CREDIT                VALUE 'CR'.
  1509             88  MA-FROM-VSI                   VALUE 'VS'.
  1510             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1511             88  MA-FROM-OTHER                 VALUE 'OT'.
  1512         16  MA-RECORD-ADD-DT              PIC XX.
  1513         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1514         16  MA-LAST-MAINT-DT              PIC XX.
  1515         16  MA-LAST-MAINT-BY              PIC XXXX.
  1516         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1517
  1518     12  MA-PROFILE-INFO.
  1519         16  MA-QUALIFY-CODE-1             PIC XX.
  1520         16  MA-QUALIFY-CODE-2             PIC XX.
  1521         16  MA-QUALIFY-CODE-3             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  28
* NSRASBL.cbl
  1522         16  MA-QUALIFY-CODE-4             PIC XX.
  1523         16  MA-QUALIFY-CODE-5             PIC XX.
  1524
  1525         16  MA-INSURED-LAST-NAME          PIC X(15).
  1526         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1527         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1528         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1529         16  MA-INSURED-BIRTH-DT           PIC XX.
  1530         16  MA-INSURED-SEX                PIC X.
  1531             88  MA-SEX-MALE                   VALUE 'M'.
  1532             88  MA-SEX-FEMALE                 VALUE 'F'.
  1533         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1534
  1535         16  MA-ADDRESS-CORRECTED          PIC X.
  1536         16  MA-JOINT-BIRTH-DT             PIC XX.
  1537*        16  FILLER                        PIC X(12).
  1538
  1539         16  MA-ADDRESS-LINE-1             PIC X(30).
  1540         16  MA-ADDRESS-LINE-2             PIC X(30).
  1541         16  MA-CITY-STATE.
  1542             20  MA-CITY                   PIC X(28).
  1543             20  MA-ADDR-STATE             PIC XX.
  1544         16  MA-ZIP.
  1545             20  MA-ZIP-CODE.
  1546                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1547                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1548                 24  FILLER                PIC X(4).
  1549             20  MA-ZIP-PLUS4              PIC X(4).
  1550         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1551             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1552             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1553             20  FILLER                    PIC X(3).
  1554
  1555         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1556
  1557         16  FILLER                        PIC XXX.
  1558*        16  FILLER                        PIC X(10).
  1559
  1560     12  MA-CRED-BENE-INFO.
  1561         16  MA-CRED-BENE-NAME                 PIC X(25).
  1562         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1563         16  MA-CRED-BENE-ADDR2                PIC X(30).
  1564         16  MA-CRED-BENE-CTYST.
  1565             20  MA-CRED-BENE-CITY             PIC X(28).
  1566             20  MA-CRED-BENE-STATE            PIC XX.
  1567         16  MA-CRED-BENE-ZIP.
  1568             20  MA-CB-ZIP-CODE.
  1569                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1570                     88  MA-CB-CANADIAN-POST-CODE
  1571                                           VALUE 'A' THRU 'Z'.
  1572                 24  FILLER                    PIC X(4).
  1573             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1574         16  MA-CB-CANADIAN-POSTAL-CODE
  1575                            REDEFINES MA-CRED-BENE-ZIP.
  1576             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1577             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1578             20  FILLER                        PIC X(3).
  1579     12  MA-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  29
* NSRASBL.cbl
  1580         16  MA-MAIL-DATA OCCURS 7.
  1581             20  MA-MAIL-TYPE              PIC X.
  1582                 88  MA-12MO-MAILING           VALUE '1'.
  1583                 88  MA-EXP-MAILING            VALUE '2'.
  1584             20  MA-MAIL-STATUS            PIC X.
  1585                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1586                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1587                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1588             20  MA-MAIL-DATE              PIC XX.
  1589     12  FILLER                            PIC XX.
  1590     12  FILLER                            PIC XX.
  1591*    12  FILLER                            PIC X(30).
  1592******************************************************************
  1593*                                COPY ERCCOMP.
  1594******************************************************************
  1595*                                                                *
  1596*                                                                *
  1597*                            ERCCOMP                             *
  1598*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1599*                            VMOD=2.019                          *
  1600*                                                                *
  1601*   ONLINE CREDIT SYSTEM                                         *
  1602*                                                                *
  1603*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1604*                                                                *
  1605*   FILE TYPE = VSAM,KSDS                                        *
  1606*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1607*                                                                *
  1608*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1609*       ALTERNATE PATH = NONE                                    *
  1610*                                                                *
  1611*   LOG = NO                                                     *
  1612*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1613*                                                                *
  1614******************************************************************
  1615*                   C H A N G E   L O G
  1616*
  1617* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1618*-----------------------------------------------------------------
  1619*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1620* EFFECTIVE    NUMBER
  1621*-----------------------------------------------------------------
  1622* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1623* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1624* 092205    2005050300006  PEMA  ADD LEASE FEE
  1625* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1626* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1627* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1628* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1629* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1630* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1631******************************************************************
  1632
  1633 01  COMPENSATION-MASTER.
  1634     12  CO-RECORD-ID                          PIC XX.
  1635         88  VALID-CO-ID                          VALUE 'CO'.
  1636
  1637     12  CO-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  30
* NSRASBL.cbl
  1638         16  CO-COMPANY-CD                     PIC X.
  1639         16  CO-CONTROL.
  1640             20  CO-CTL-1.
  1641                 24  CO-CARR-GROUP.
  1642                     28  CO-CARRIER            PIC X.
  1643                     28  CO-GROUPING.
  1644                         32  CO-GROUP-PREFIX   PIC XXX.
  1645                         32  CO-GROUP-PRIME    PIC XXX.
  1646                 24  CO-RESP-NO.
  1647                     28  CO-RESP-PREFIX        PIC X(4).
  1648                     28  CO-RESP-PRIME         PIC X(6).
  1649             20  CO-CTL-2.
  1650                 24  CO-ACCOUNT.
  1651                     28  CO-ACCT-PREFIX        PIC X(4).
  1652                     28  CO-ACCT-PRIME         PIC X(6).
  1653         16  CO-TYPE                           PIC X.
  1654             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1655             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1656             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1657
  1658     12  CO-MAINT-INFORMATION.
  1659         16  CO-LAST-MAINT-DT                  PIC XX.
  1660         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1661         16  CO-LAST-MAINT-USER                PIC X(4).
  1662     12  FILLER                                PIC XX.
  1663     12  CO-STMT-TYPE                          PIC XXX.
  1664     12  CO-COMP-TYPE                          PIC X.
  1665         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1666     12  CO-STMT-OWNER                         PIC X(4).
  1667     12  CO-BALANCE-CONTROL                    PIC X.
  1668         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1669         88  CO-NO-BALANCE                        VALUE 'N'.
  1670
  1671     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1672         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1673         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1674         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1675
  1676     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1677         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1678         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1679
  1680     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1681     12  CO-GA-DIRECT-DEP                      PIC X.
  1682     12  CO-FUTURE-SPACE                       PIC X.
  1683         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1684
  1685     12  CO-ACCT-NAME                          PIC X(30).
  1686     12  CO-MAIL-NAME                          PIC X(30).
  1687     12  CO-ADDR-1                             PIC X(30).
  1688     12  CO-ADDR-2                             PIC X(30).
  1689     12  CO-ADDR-3.
  1690         16  CO-ADDR-CITY                      PIC X(27).
  1691         16  CO-ADDR-STATE                     PIC XX.
  1692     12  CO-CSO-1099                           PIC X.
  1693     12  CO-ZIP.
  1694         16  CO-ZIP-PRIME.
  1695             20  CO-ZIP-PRI-1ST                PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  31
* NSRASBL.cbl
  1696                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1697             20  FILLER                        PIC X(4).
  1698         16  CO-ZIP-PLUS4                      PIC X(4).
  1699     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1700         16  CO-CAN-POSTAL-1                   PIC XXX.
  1701         16  CO-CAN-POSTAL-2                   PIC XXX.
  1702         16  FILLER                            PIC XXX.
  1703     12  CO-SOC-SEC                            PIC X(13).
  1704     12  CO-TELEPHONE.
  1705         16  CO-AREA-CODE                      PIC XXX.
  1706         16  CO-PREFIX                         PIC XXX.
  1707         16  CO-PHONE                          PIC X(4).
  1708
  1709     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1710
  1711     12  CO-AR-BAL-LEVEL                       PIC X.
  1712         88  CO-AR-REF-LVL                        VALUE '1'.
  1713         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1714         88  CO-AR-BILL-LVL                       VALUE '2'.
  1715         88  CO-AR-AGT-LVL                        VALUE '3'.
  1716         88  CO-AR-FR-LVL                         VALUE '4'.
  1717
  1718     12  CO-AR-NORMAL-PRINT                    PIC X.
  1719         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1720         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1721
  1722     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1723
  1724     12  CO-AR-REPORTING                       PIC X.
  1725         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1726         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1727
  1728     12  CO-AR-PULL-CHECK                      PIC X.
  1729         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1730         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1731
  1732     12  CO-AR-BALANCE-PRINT                   PIC X.
  1733         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1734
  1735     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1736         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1737         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1738         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1739
  1740     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1741
  1742     12  CO-USER-CODE                          PIC X.
  1743     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1744
  1745******************************************************************
  1746*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1747*    THE LAST MONTH END RUN.
  1748******************************************************************
  1749
  1750     12  CO-LAST-ACTIVITY-DATE.
  1751         16  CO-ACT-YEAR                       PIC 99.
  1752         16  CO-ACT-MONTH                      PIC 99.
  1753         16  CO-ACT-DAY                        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  32
* NSRASBL.cbl
  1754
  1755     12  CO-LAST-STMT-DT.
  1756         16  CO-LAST-STMT-YEAR                 PIC 99.
  1757         16  CO-LAST-STMT-MONTH                PIC 99.
  1758         16  CO-LAST-STMT-DAY                  PIC 99.
  1759
  1760     12  CO-MO-END-TOTALS.
  1761         16  CO-MONTHLY-TOTALS.
  1762             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1763             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1764             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1765             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1766             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1767
  1768         16  CO-AGING-TOTALS.
  1769             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1770             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1771             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1772             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1773
  1774         16  CO-YTD-TOTALS.
  1775             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1776             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1777
  1778         16  CO-OVER-UNDER-TOTALS.
  1779             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1780             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1781
  1782     12  CO-MISCELLANEOUS-TOTALS.
  1783         16  CO-FICA-TOTALS.
  1784             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1785             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1786
  1787         16  CO-CLAIM-TOTALS.
  1788             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1789             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1790
  1791******************************************************************
  1792*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1793*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1794******************************************************************
  1795
  1796     12  CO-CURRENT-TOTALS.
  1797         16  CO-CURRENT-LAST-STMT-DT.
  1798             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1799             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1800             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1801
  1802         16  CO-CURRENT-MONTHLY-TOTALS.
  1803             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1804             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1805             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1806             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1807             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1808
  1809         16  CO-CURRENT-AGING-TOTALS.
  1810             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1811             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  33
* NSRASBL.cbl
  1812             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1813             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1814
  1815         16  CO-CURRENT-YTD-TOTALS.
  1816             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1817             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1818
  1819     12  CO-PAID-COMM-TOTALS.
  1820         16  CO-YTD-PAID-COMMS.
  1821             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1822             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1823
  1824     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1825         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1826         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1827
  1828     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1829         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1830         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1831         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1832         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1833         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1834         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1835         88  CO-FINAL-LETTER                  VALUE 'F'.
  1836         88  CO-RECONCILING                   VALUE 'R'.
  1837         88  CO-PHONE-CALL                    VALUE 'P'.
  1838         88  CO-LEGAL                         VALUE 'L'.
  1839         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1840         88  CO-WRITE-OFF                     VALUE 'W'.
  1841         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1842
  1843     12  CO-CSR-CODE                       PIC X(4).
  1844
  1845     12  CO-GA-STATUS-INFO.
  1846         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1847         16  CO-GA-TERMINATION-DT          PIC XX.
  1848         16  CO-GA-STATUS-CODE             PIC X.
  1849             88  CO-GA-ACTIVE                 VALUE 'A'.
  1850             88  CO-GA-INACTIVE               VALUE 'I'.
  1851             88  CO-GA-PENDING                VALUE 'P'.
  1852         16  CO-GA-COMMENTS.
  1853             20  CO-GA-COMMENT-1           PIC X(40).
  1854             20  CO-GA-COMMENT-2           PIC X(40).
  1855             20  CO-GA-COMMENT-3           PIC X(40).
  1856             20  CO-GA-COMMENT-4           PIC X(40).
  1857
  1858     12  CO-RPTCD2                         PIC X(10).
  1859     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1860         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1861         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1862
  1863     12  CO-TYPE-AGENT                     PIC X(01).
  1864         88  CO-CORPORATION                   VALUE 'C'.
  1865         88  CO-PARTNERSHIP                   VALUE 'P'.
  1866         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1867         88  CO-TRUST                         VALUE 'T'.
  1868         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1869
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  34
* NSRASBL.cbl
  1870     12  CO-FAXNO.
  1871         16  CO-FAX-AREA-CODE                  PIC XXX.
  1872         16  CO-FAX-PREFIX                     PIC XXX.
  1873         16  CO-FAX-PHONE                      PIC X(4).
  1874
  1875     12  CO-BANK-INFORMATION.
  1876         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1877         16  CO-BANK-TRANSIT-NON REDEFINES
  1878             CO-BANK-TRANSIT-NO                PIC 9(8).
  1879
  1880         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1881     12  CO-MISC-DEDUCT-INFO REDEFINES
  1882                  CO-BANK-INFORMATION.
  1883         16  CO-MD-GL-ACCT                     PIC X(10).
  1884         16  CO-MD-DIV                         PIC XX.
  1885         16  CO-MD-CENTER                      PIC X(4).
  1886         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1887         16  CO-CREATE-AP-CHECK                PIC X.
  1888         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1889         16  FILLER                            PIC XXX.
  1890     12  CO-ACH-STATUS                         PIC X.
  1891         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1892         88  CO-ACH-PENDING                        VALUE 'P'.
  1893
  1894     12  CO-BILL-SW                            PIC X.
  1895     12  CO-CONTROL-NAME                       PIC X(30).
  1896     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1897     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1898     12  CO-CLP-STATE                          PIC XX.
  1899     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1900     12  CO-SPP-REFUND-EDIT                    PIC X.
  1901
  1902******************************************************************
  1903*                                COPY ELCCERT.
  1904******************************************************************
  1905*                                                                *
  1906*                            ELCCERT.                            *
  1907*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1908*                            VMOD=2.013                          *
  1909*                                                                *
  1910*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1911*                                                                *
  1912*   FILE TYPE = VSAM,KSDS                                        *
  1913*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1914*                                                                *
  1915*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1916*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1917*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1918*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1919*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1920*                                                                *
  1921*   LOG = YES                                                    *
  1922*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1923******************************************************************
  1924*                   C H A N G E   L O G
  1925*
  1926* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1927*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  35
* NSRASBL.cbl
  1928*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1929* EFFECTIVE    NUMBER
  1930*-----------------------------------------------------------------
  1931* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1932* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1933* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1934* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1935* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1936* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1937* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1938* 032612  CR2011110200001  PEMA  AHL CHANGES
  1939******************************************************************
  1940
  1941 01  CERTIFICATE-MASTER.
  1942     12  CM-RECORD-ID                      PIC XX.
  1943         88  VALID-CM-ID                      VALUE 'CM'.
  1944
  1945     12  CM-CONTROL-PRIMARY.
  1946         16  CM-COMPANY-CD                 PIC X.
  1947         16  CM-CARRIER                    PIC X.
  1948         16  CM-GROUPING.
  1949             20  CM-GROUPING-PREFIX        PIC X(3).
  1950             20  CM-GROUPING-PRIME         PIC X(3).
  1951         16  CM-STATE                      PIC XX.
  1952         16  CM-ACCOUNT.
  1953             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1954             20  CM-ACCOUNT-PRIME          PIC X(6).
  1955         16  CM-CERT-EFF-DT                PIC XX.
  1956         16  CM-CERT-NO.
  1957             20  CM-CERT-PRIME             PIC X(10).
  1958             20  CM-CERT-SFX               PIC X.
  1959
  1960     12  CM-CONTROL-BY-NAME.
  1961         16  CM-COMPANY-CD-A1              PIC X.
  1962         16  CM-INSURED-LAST-NAME          PIC X(15).
  1963         16  CM-INSURED-INITIALS.
  1964             20  CM-INSURED-INITIAL1       PIC X.
  1965             20  CM-INSURED-INITIAL2       PIC X.
  1966
  1967     12  CM-CONTROL-BY-SSN.
  1968         16  CM-COMPANY-CD-A2              PIC X.
  1969         16  CM-SOC-SEC-NO.
  1970             20  CM-SSN-STATE              PIC XX.
  1971             20  CM-SSN-ACCOUNT            PIC X(6).
  1972             20  CM-SSN-LN3.
  1973                 25  CM-INSURED-INITIALS-A2.
  1974                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1975                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1976                 25 CM-PART-LAST-NAME-A2         PIC X.
  1977
  1978     12  CM-CONTROL-BY-CERT-NO.
  1979         16  CM-COMPANY-CD-A4              PIC X.
  1980         16  CM-CERT-NO-A4                 PIC X(11).
  1981
  1982     12  CM-CONTROL-BY-MEMB.
  1983         16  CM-COMPANY-CD-A5              PIC X.
  1984         16  CM-MEMBER-NO.
  1985             20  CM-MEMB-STATE             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  36
* NSRASBL.cbl
  1986             20  CM-MEMB-ACCOUNT           PIC X(6).
  1987             20  CM-MEMB-LN4.
  1988                 25  CM-INSURED-INITIALS-A5.
  1989                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1990                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1991                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1992
  1993     12  CM-INSURED-PROFILE-DATA.
  1994         16  CM-INSURED-FIRST-NAME.
  1995             20  CM-INSURED-1ST-INIT       PIC X.
  1996             20  FILLER                    PIC X(9).
  1997         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1998         16  CM-INSURED-SEX                PIC X.
  1999             88  CM-SEX-MALE                  VALUE 'M'.
  2000             88  CM-SEX-FEMAL                 VALUE 'F'.
  2001         16  CM-INSURED-JOINT-AGE          PIC 99.
  2002         16  CM-JOINT-INSURED-NAME.
  2003             20  CM-JT-LAST-NAME           PIC X(15).
  2004             20  CM-JT-FIRST-NAME.
  2005                 24  CM-JT-1ST-INIT        PIC X.
  2006                 24  FILLER                PIC X(9).
  2007             20  CM-JT-INITIAL             PIC X.
  2008
  2009     12  CM-LIFE-DATA.
  2010         16  CM-LF-BENEFIT-CD              PIC XX.
  2011         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2012         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2013         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2014         16  CM-LF-DEV-CODE                PIC XXX.
  2015         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2016         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2017         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2018         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2019         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2020         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2021         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2022         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2023         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2024         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2025         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2026         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2027         16  FILLER                        PIC XX.
  2028
  2029     12  CM-AH-DATA.
  2030         16  CM-AH-BENEFIT-CD              PIC XX.
  2031         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2032         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2033         16  CM-AH-DEV-CODE                PIC XXX.
  2034         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2035         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2036         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2037         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2038         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2039         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2040         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2041         16  CM-AH-PAID-THRU-DT            PIC XX.
  2042             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2043         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  37
* NSRASBL.cbl
  2044         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2045         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2046         16  FILLER                        PIC X.
  2047
  2048     12  CM-LOAN-INFORMATION.
  2049         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2050         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2051                                           PIC S9(5)V99  COMP-3.
  2052         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2053         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2054         16  CM-PAY-FREQUENCY              PIC S99.
  2055         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2056         16  CM-RATE-CLASS                 PIC XX.
  2057         16  CM-BENEFICIARY                PIC X(25).
  2058         16  CM-POLICY-FORM-NO             PIC X(12).
  2059         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2060         16  CM-LAST-ADD-ON-DT             PIC XX.
  2061         16  CM-DEDUCTIBLE-AMOUNTS.
  2062             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2063             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2064         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2065             20  CM-RESIDENT-STATE         PIC XX.
  2066             20  CM-RATE-CODE              PIC X(4).
  2067             20  FILLER                    PIC XX.
  2068         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2069             20  CM-LOAN-OFFICER           PIC X(5).
  2070             20  FILLER                    PIC XXX.
  2071         16  CM-CSR-CODE                   PIC XXX.
  2072         16  CM-UNDERWRITING-CODE          PIC X.
  2073             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2074         16  CM-POST-CARD-IND              PIC X.
  2075         16  CM-NH-INTERFACE-SW            PIC X.
  2076         16  CM-PREMIUM-TYPE               PIC X.
  2077             88  CM-SING-PRM                  VALUE '1'.
  2078             88  CM-O-B-COVERAGE              VALUE '2'.
  2079             88  CM-OPEN-END                  VALUE '3'.
  2080         16  CM-IND-GRP-TYPE               PIC X.
  2081             88  CM-INDIVIDUAL                VALUE 'I'.
  2082             88  CM-GROUP                     VALUE 'G'.
  2083         16  CM-SKIP-CODE                  PIC X.
  2084             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2085             88  SKIP-JULY                    VALUE '1'.
  2086             88  SKIP-AUGUST                  VALUE '2'.
  2087             88  SKIP-SEPTEMBER               VALUE '3'.
  2088             88  SKIP-JULY-AUG                VALUE '4'.
  2089             88  SKIP-AUG-SEPT                VALUE '5'.
  2090             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2091             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2092             88  SKIP-JUNE                    VALUE '8'.
  2093             88  SKIP-JUNE-JULY               VALUE '9'.
  2094             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2095             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2096         16  CM-PAYMENT-MODE               PIC X.
  2097             88  PAY-MONTHLY                  VALUE SPACE.
  2098             88  PAY-WEEKLY                   VALUE '1'.
  2099             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2100             88  PAY-BI-WEEKLY                VALUE '3'.
  2101             88  PAY-SEMI-ANUALLY             VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  38
* NSRASBL.cbl
  2102         16  CM-LOAN-NUMBER                PIC X(8).
  2103         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2104         16  CM-OLD-LOF                    PIC XXX.
  2105*        16  CM-LOAN-OFFICER               PIC XXX.
  2106         16  CM-REIN-TABLE                 PIC XXX.
  2107         16  CM-SPECIAL-REIN-CODE          PIC X.
  2108         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2109         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2110         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2111
  2112     12  CM-STATUS-DATA.
  2113         16  CM-ENTRY-STATUS               PIC X.
  2114         16  CM-ENTRY-DT                   PIC XX.
  2115
  2116         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2117         16  CM-LF-CANCEL-DT               PIC XX.
  2118         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2119
  2120         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2121         16  CM-LF-DEATH-DT                PIC XX.
  2122         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2123
  2124         16  CM-LF-CURRENT-STATUS          PIC X.
  2125             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2126                                                'M' '4' '5' '9'.
  2127             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2128             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2129             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2130             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2131             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2132             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2133             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2134             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2135             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2136             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2137             88  CM-LF-DECLINED               VALUE 'D'.
  2138             88  CM-LF-VOIDED                 VALUE 'V'.
  2139
  2140         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2141         16  CM-AH-CANCEL-DT               PIC XX.
  2142         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2143
  2144         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2145         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2146         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2147
  2148         16  CM-AH-CURRENT-STATUS          PIC X.
  2149             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2150                                                'M' '4' '5' '9'.
  2151             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2152             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2153             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2154             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2155             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2156             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2157             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2158             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2159             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  39
* NSRASBL.cbl
  2160             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2161             88  CM-AH-DECLINED               VALUE 'D'.
  2162             88  CM-AH-VOIDED                 VALUE 'V'.
  2163
  2164         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2165             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2166             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2167             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2168         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2169
  2170         16  CM-ENTRY-BATCH                PIC X(6).
  2171         16  CM-LF-EXIT-BATCH              PIC X(6).
  2172         16  CM-AH-EXIT-BATCH              PIC X(6).
  2173         16  CM-LAST-MONTH-END             PIC XX.
  2174
  2175     12  CM-NOTE-SW                        PIC X.
  2176         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2177         88  CERT-NOTES-PRESENT               VALUE '1'.
  2178         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2179         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2180         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2181         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2182         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2183         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2184     12  CM-COMP-EXCP-SW                   PIC X.
  2185         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2186         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2187     12  CM-INSURED-ADDRESS-SW             PIC X.
  2188         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2189         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2190
  2191*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2192     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2193     12  FILLER                            PIC X.
  2194
  2195*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2196     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2197     12  FILLER                            PIC X.
  2198*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2199     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2200
  2201     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2202         88  CERT-ADDED-BATCH                 VALUE ' '.
  2203         88  CERT-ADDED-ONLINE                VALUE '1'.
  2204         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2205         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2206         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2207     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2208         88  CERT-AS-LOADED                   VALUE ' '.
  2209         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2210         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2211         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2212         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2213         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2214         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2215         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2216
  2217     12  CM-ACCOUNT-COMM-PCTS.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  40
* NSRASBL.cbl
  2218         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2219         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2220
  2221     12  CM-USER-FIELD                     PIC X.
  2222     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2223     12  CM-CLP-STATE                      PIC XX.
  2224     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2225     12  CM-USER-RESERVED                  PIC XXX.
  2226     12  FILLER REDEFINES CM-USER-RESERVED.
  2227         16  CM-AH-CLASS-CD                PIC XX.
  2228         16  F                             PIC X.
  2229******************************************************************
  2230*                                COPY ELCCRTO.
  2231******************************************************************
  2232*                                                                *
  2233*                            ELCCRTO.                            *
  2234*                                                                *
  2235*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2236*                                                                *
  2237*   FILE TYPE = VSAM,KSDS                                        *
  2238*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2239*                                                                *
  2240*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2241*                                                                *
  2242*   LOG = YES                                                    *
  2243*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2244******************************************************************
  2245*                   C H A N G E   L O G
  2246*
  2247* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2248*-----------------------------------------------------------------
  2249*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2250* EFFECTIVE    NUMBER
  2251*-----------------------------------------------------------------
  2252* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2253* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2254* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2255******************************************************************
  2256 01  ORIGINAL-CERTIFICATE.
  2257     12  OC-RECORD-ID                      PIC XX.
  2258         88  VALID-OC-ID                      VALUE 'OC'.
  2259     12  OC-CONTROL-PRIMARY.
  2260         16  OC-COMPANY-CD                 PIC X.
  2261         16  OC-CARRIER                    PIC X.
  2262         16  OC-GROUPING                   PIC X(6).
  2263         16  OC-STATE                      PIC XX.
  2264         16  OC-ACCOUNT                    PIC X(10).
  2265         16  OC-CERT-EFF-DT                PIC XX.
  2266         16  OC-CERT-NO.
  2267             20  OC-CERT-PRIME             PIC X(10).
  2268             20  OC-CERT-SFX               PIC X.
  2269         16  OC-RECORD-TYPE                PIC X.
  2270         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2271     12  OC-LAST-MAINT-DT                  PIC XX.
  2272     12  OC-LAST-MAINT-BY                  PIC X(4).
  2273     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2274     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2275     12  FILLER                            PIC X(49).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  41
* NSRASBL.cbl
  2276     12  OC-ORIG-REC.
  2277         16  OC-INS-LAST-NAME              PIC X(15).
  2278         16  OC-INS-FIRST-NAME             PIC X(10).
  2279         16  OC-INS-MIDDLE-INIT            PIC X.
  2280         16  OC-INS-AGE                    PIC S999     COMP-3.
  2281         16  OC-JNT-LAST-NAME              PIC X(15).
  2282         16  OC-JNT-FIRST-NAME             PIC X(10).
  2283         16  OC-JNT-MIDDLE-INIT            PIC X.
  2284         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2285         16  OC-LF-BENCD                   PIC XX.
  2286         16  OC-LF-TERM                    PIC S999      COMP-3.
  2287         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2288         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2289         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2290         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2291         16  OC-LF-EXP-DT                  PIC XX.
  2292         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2293         16  OC-LF-CANCEL-DT               PIC XX.
  2294         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2295         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2296         16  OC-AH-BENCD                   PIC XX.
  2297         16  OC-AH-TERM                    PIC S999      COMP-3.
  2298         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2299         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2300         16  OC-AH-EXP-DT                  PIC XX.
  2301         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2302         16  OC-AH-CP                      PIC 99.
  2303         16  OC-AH-CANCEL-DT               PIC XX.
  2304         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2305         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2306         16  OC-CRED-BENE-NAME             PIC X(25).
  2307         16  OC-1ST-PMT-DT                 PIC XX.
  2308         16  FILLER                        PIC X(215).
  2309
  2310     12  FILLER                            PIC X(50).
  2311******************************************************************
  2312*                                COPY ERCACCT.
  2313******************************************************************
  2314*                                                                *
  2315*                                                                *
  2316*                            ERCACCT                             *
  2317*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2318*                            VMOD=2.031                          *
  2319*                                                                *
  2320*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2321*                                                                *
  2322*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2323*   VSAM ACCOUNT MASTER FILES.                                   *
  2324*                                                                *
  2325*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2326*                                                                *
  2327*   FILE TYPE = VSAM,KSDS                                        *
  2328*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2329*                                                                *
  2330*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2331*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2332*                                                                *
  2333*   LOG = NO                                                     *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  42
* NSRASBL.cbl
  2334*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2335*                                                                *
  2336*                                                                *
  2337******************************************************************
  2338*                   C H A N G E   L O G
  2339*
  2340* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2341*-----------------------------------------------------------------
  2342*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2343* EFFECTIVE    NUMBER
  2344*-----------------------------------------------------------------
  2345* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2346* 092705    2005050300006  PEMA  ADD SPP LEASES
  2347* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2348* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2349* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2350* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2351* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2352******************************************************************
  2353
  2354 01  ACCOUNT-MASTER.
  2355     12  AM-RECORD-ID                      PIC XX.
  2356         88  VALID-AM-ID                      VALUE 'AM'.
  2357
  2358     12  AM-CONTROL-PRIMARY.
  2359         16  AM-COMPANY-CD                 PIC X.
  2360         16  AM-MSTR-CNTRL.
  2361             20  AM-CONTROL-A.
  2362                 24  AM-CARRIER            PIC X.
  2363                 24  AM-GROUPING.
  2364                     28 AM-GROUPING-PREFIX PIC XXX.
  2365                     28 AM-GROUPING-PRIME  PIC XXX.
  2366                 24  AM-STATE              PIC XX.
  2367                 24  AM-ACCOUNT.
  2368                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2369                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2370             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2371                                           PIC X(19).
  2372             20  AM-CNTRL-B.
  2373                 24  AM-EXPIRATION-DT      PIC XX.
  2374                 24  FILLER                PIC X(4).
  2375             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2376                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2377
  2378     12  AM-CONTROL-BY-VAR-GRP.
  2379         16  AM-COMPANY-CD-A1              PIC X.
  2380         16  AM-VG-CARRIER                 PIC X.
  2381         16  AM-VG-GROUPING                PIC X(6).
  2382         16  AM-VG-STATE                   PIC XX.
  2383         16  AM-VG-ACCOUNT                 PIC X(10).
  2384         16  AM-VG-DATE.
  2385             20  AM-VG-EXPIRATION-DT       PIC XX.
  2386             20  FILLER                    PIC X(4).
  2387         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2388                                           PIC 9(11)      COMP-3.
  2389     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2390         16  FILLER                        PIC X(10).
  2391         16  AM-VG-KEY3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  43
* NSRASBL.cbl
  2392             20  AM-VG3-ACCOUNT            PIC X(10).
  2393             20  AM-VG3-EXP-DT             PIC XX.
  2394         16  FILLER                        PIC X(4).
  2395     12  AM-MAINT-INFORMATION.
  2396         16  AM-LAST-MAINT-DT              PIC XX.
  2397         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2398         16  AM-LAST-MAINT-USER            PIC X(4).
  2399         16  FILLER                        PIC XX.
  2400
  2401     12  AM-EFFECTIVE-DT                   PIC XX.
  2402     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2403
  2404     12  AM-PREV-DATES  COMP-3.
  2405         16  AM-PREV-EXP-DT                PIC 9(11).
  2406         16  AM-PREV-EFF-DT                PIC 9(11).
  2407
  2408     12  AM-REPORT-CODE-1                  PIC X(10).
  2409     12  AM-REPORT-CODE-2                  PIC X(10).
  2410
  2411     12  AM-CITY-CODE                      PIC X(4).
  2412     12  AM-COUNTY-PARISH                  PIC X(6).
  2413
  2414     12  AM-NAME                           PIC X(30).
  2415     12  AM-PERSON                         PIC X(30).
  2416     12  AM-ADDRS                          PIC X(30).
  2417     12  AM-CITY.
  2418         16  AM-ADDR-CITY                  PIC X(28).
  2419         16  AM-ADDR-STATE                 PIC XX.
  2420     12  AM-ZIP.
  2421         16  AM-ZIP-PRIME.
  2422             20  AM-ZIP-PRI-1ST            PIC X.
  2423                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2424             20  FILLER                    PIC X(4).
  2425         16  AM-ZIP-PLUS4                  PIC X(4).
  2426     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2427         16  AM-CAN-POSTAL-1               PIC XXX.
  2428         16  AM-CAN-POSTAL-2               PIC XXX.
  2429         16  FILLER                        PIC XXX.
  2430     12  AM-TEL-NO.
  2431         16  AM-AREA-CODE                  PIC 999.
  2432         16  AM-TEL-PRE                    PIC 999.
  2433         16  AM-TEL-NBR                    PIC 9(4).
  2434     12  AM-TEL-LOC                        PIC X.
  2435         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2436         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2437
  2438     12  AM-COMM-STRUCTURE.
  2439         16  AM-DEFN-1.
  2440             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2441                 24  AM-AGT.
  2442                     28  AM-AGT-PREFIX     PIC X(4).
  2443                     28  AM-AGT-PRIME      PIC X(6).
  2444                 24  AM-COM-TYP            PIC X.
  2445                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2446                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2447                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2448                 24  AM-RECALC-LV-INDIC    PIC X.
  2449                 24  AM-RETRO-LV-INDIC     PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  44
* NSRASBL.cbl
  2450                 24  AM-GL-CODES           PIC X.
  2451                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2452                 24  FILLER                PIC X(01).
  2453         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2454             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2455                 24  FILLER                PIC X(11).
  2456                 24  AM-L-COMA             PIC XXX.
  2457                 24  AM-J-COMA             PIC XXX.
  2458                 24  AM-A-COMA             PIC XXX.
  2459                 24  FILLER                PIC X(6).
  2460
  2461     12  AM-COMM-CHANGE-STATUS             PIC X.
  2462         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2463
  2464     12  AM-CSR-CODE                       PIC X(4).
  2465
  2466     12  AM-BILLING-STATUS                 PIC X.
  2467         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2468         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2469     12  AM-AUTO-REFUND-SW                 PIC X.
  2470         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2471         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2472     12  AM-GPCD                           PIC 99.
  2473     12  AM-IG                             PIC X.
  2474         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2475         88  AM-HAS-GROUP                     VALUE '2'.
  2476     12  AM-STATUS                         PIC X.
  2477         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2478         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2479         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2480         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2481         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2482         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2483     12  AM-REMIT-TO                       PIC 99.
  2484     12  AM-ID-NO                          PIC X(11).
  2485
  2486     12  AM-CAL-TABLE                      PIC XX.
  2487     12  AM-LF-DEVIATION                   PIC XXX.
  2488     12  AM-AH-DEVIATION                   PIC XXX.
  2489     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2490     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2491     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2492     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2493     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2494     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2495
  2496     12  AM-USER-FIELDS.
  2497         16  AM-FLD-1                      PIC XX.
  2498         16  AM-FLD-2                      PIC XX.
  2499         16  AM-FLD-3                      PIC XX.
  2500         16  AM-FLD-4                      PIC XX.
  2501         16  AM-FLD-5                      PIC XX.
  2502
  2503     12  AM-1ST-PROD-DATE.
  2504         16  AM-1ST-PROD-YR                PIC XX.
  2505         16  AM-1ST-PROD-MO                PIC XX.
  2506         16  AM-1ST-PROD-DA                PIC XX.
  2507     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  45
* NSRASBL.cbl
  2508     12  AM-CERTS-PURGED-DATE.
  2509         16  AM-PUR-YR                     PIC XX.
  2510         16  AM-PUR-MO                     PIC XX.
  2511         16  AM-PUR-DA                     PIC XX.
  2512     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2513     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2514     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2515     12  AM-INACTIVE-DATE.
  2516         16  AM-INA-MO                     PIC 99.
  2517         16  AM-INA-DA                     PIC 99.
  2518         16  AM-INA-YR                     PIC 99.
  2519     12  AM-AR-HI-CERT-DATE                PIC XX.
  2520
  2521     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2522     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2523
  2524     12  AM-OB-PAYMENT-MODE                PIC X.
  2525         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2526         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2527         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2528         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2529
  2530     12  AM-AH-ONLY-INDICATOR              PIC X.
  2531         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2532         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2533
  2534     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2535
  2536     12  AM-OVER-SHORT.
  2537         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2538         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2539
  2540     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2541     12  AM-DCC-CLP-STATE                  PIC XX.
  2542
  2543     12  AM-RECALC-COMM                    PIC X.
  2544     12  AM-RECALC-REIN                    PIC X.
  2545
  2546     12  AM-REI-TABLE                      PIC XXX.
  2547     12  AM-REI-ET-LF                      PIC X.
  2548     12  AM-REI-ET-AH                      PIC X.
  2549     12  AM-REI-PE-LF                      PIC X.
  2550     12  AM-REI-PE-AH                      PIC X.
  2551     12  AM-REI-PRT-ST                     PIC X.
  2552     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2553     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2554     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2555     12  AM-REI-GROUP-A                    PIC X(6).
  2556     12  AM-REI-MORT                       PIC X(4).
  2557     12  AM-REI-PRT-OW                     PIC X.
  2558     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2559     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2560     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2561     12  AM-REI-GROUP-B                    PIC X(6).
  2562
  2563     12  AM-TRUST-TYPE                     PIC X(2).
  2564
  2565     12  AM-EMPLOYER-STMT-USED             PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  46
* NSRASBL.cbl
  2566     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2567
  2568     12  AM-STD-AH-TYPE                    PIC XX.
  2569     12  AM-EARN-METHODS.
  2570         16  AM-EARN-METHOD-R              PIC X.
  2571             88 AM-REF-RL-R78                 VALUE 'R'.
  2572             88 AM-REF-RL-PR                  VALUE 'P'.
  2573             88 AM-REF-RL-MEAN                VALUE 'M'.
  2574             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2575         16  AM-EARN-METHOD-L              PIC X.
  2576             88 AM-REF-LL-R78                 VALUE 'R'.
  2577             88 AM-REF-LL-PR                  VALUE 'P'.
  2578             88 AM-REF-LL-MEAN                VALUE 'M'.
  2579             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2580         16  AM-EARN-METHOD-A              PIC X.
  2581             88 AM-REF-AH-R78                 VALUE 'R'.
  2582             88 AM-REF-AH-PR                  VALUE 'P'.
  2583             88 AM-REF-AH-MEAN                VALUE 'M'.
  2584             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2585             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2586             88 AM-REF-AH-NET                 VALUE 'N'.
  2587
  2588     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2589     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2590     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2591
  2592     12  AM-RET-Y-N                        PIC X.
  2593     12  AM-RET-P-E                        PIC X.
  2594     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2595     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2596     12  AM-RET-GRP                        PIC X(6).
  2597     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2598         16  AM-POOL-PRIME                 PIC XXX.
  2599         16  AM-POOL-SUB                   PIC XXX.
  2600     12  AM-RETRO-EARNINGS.
  2601         16  AM-RET-EARN-R                 PIC X.
  2602         16  AM-RET-EARN-L                 PIC X.
  2603         16  AM-RET-EARN-A                 PIC X.
  2604     12  AM-RET-ST-TAX-USE                 PIC X.
  2605         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2606         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2607     12  AM-RETRO-BEG-EARNINGS.
  2608         16  AM-RET-BEG-EARN-R             PIC X.
  2609         16  AM-RET-BEG-EARN-L             PIC X.
  2610         16  AM-RET-BEG-EARN-A             PIC X.
  2611     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2612     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2613
  2614     12  AM-USER-SELECT-OPTIONS.
  2615         16  AM-USER-SELECT-1              PIC X(10).
  2616         16  AM-USER-SELECT-2              PIC X(10).
  2617         16  AM-USER-SELECT-3              PIC X(10).
  2618         16  AM-USER-SELECT-4              PIC X(10).
  2619         16  AM-USER-SELECT-5              PIC X(10).
  2620
  2621     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2622
  2623     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  47
* NSRASBL.cbl
  2624
  2625     12  AM-RPT045A-SWITCH                 PIC X.
  2626         88  RPT045A-OFF                   VALUE 'N'.
  2627
  2628     12  AM-INSURANCE-LIMITS.
  2629         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2630         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2631
  2632     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2633         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2634
  2635     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2636         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2637         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2638
  2639     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2640
  2641     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2642     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2643     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2644     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2645     12  AM-DCC-UEF-STATE                  PIC XX.
  2646     12  FILLER                            PIC XXX.
  2647     12  AM-REPORT-CODE-3                  PIC X(10).
  2648*    12  FILLER                            PIC X(22).
  2649
  2650     12  AM-RESERVE-DATE.
  2651         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2652         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2653         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2654
  2655     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2656     12  AM-NOTIFICATION-TYPES.
  2657         16  AM-NOTIF-OF-LETTERS           PIC X.
  2658         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2659         16  AM-NOTIF-OF-REPORTS           PIC X.
  2660         16  AM-NOTIF-OF-STATUS            PIC X.
  2661
  2662     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2663         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2664         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2665         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2666         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2667
  2668     12  AM-BENEFIT-CONTROLS.
  2669         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2670             20  AM-BENEFIT-CODE           PIC XX.
  2671             20  AM-BENEFIT-TYPE           PIC X.
  2672             20  AM-BENEFIT-REVISION       PIC XXX.
  2673             20  AM-BENEFIT-REM-TERM       PIC X.
  2674             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2675             20  FILLER                    PIC XX.
  2676         16  FILLER                        PIC X(80).
  2677
  2678     12  AM-TRANSFER-DATA.
  2679         16  AM-TRANSFERRED-FROM.
  2680             20  AM-TRNFROM-CARRIER        PIC X.
  2681             20  AM-TRNFROM-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  48
* NSRASBL.cbl
  2682                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2683                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2684             20  AM-TRNFROM-STATE          PIC XX.
  2685             20  AM-TRNFROM-ACCOUNT.
  2686                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2687                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2688             20  AM-TRNFROM-DTE            PIC XX.
  2689         16  AM-TRANSFERRED-TO.
  2690             20  AM-TRNTO-CARRIER          PIC X.
  2691             20  AM-TRNTO-GROUPING.
  2692                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2693                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2694             20  AM-TRNTO-STATE            PIC XX.
  2695             20  AM-TRNTO-ACCOUNT.
  2696                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2697                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2698             20  AM-TRNTO-DTE              PIC XX.
  2699         16  FILLER                        PIC X(10).
  2700
  2701     12  AM-SAVED-REMIT-TO                 PIC 99.
  2702
  2703     12  AM-COMM-STRUCTURE-SAVED.
  2704         16  AM-DEFN-1-SAVED.
  2705             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2706                 24  AM-AGT-SV             PIC X(10).
  2707                 24  AM-COM-TYP-SV         PIC X.
  2708                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2709                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2710                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2711                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2712                 24  FILLER                PIC X.
  2713                 24  AM-GL-CODES-SV        PIC X.
  2714                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2715                 24  FILLER                PIC X.
  2716         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2717             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2718                 24  FILLER                PIC X(11).
  2719                 24  AM-L-COMA-SV          PIC XXX.
  2720                 24  AM-J-COMA-SV          PIC XXX.
  2721                 24  AM-A-COMA-SV          PIC XXX.
  2722                 24  FILLER                PIC X(6).
  2723
  2724     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2725         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2726            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2727            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2728            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2729
  2730     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2731     12  FILLER                            PIC X(120).
  2732
  2733     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2734         16  AM-CONTROL-NAME               PIC X(30).
  2735         16  AM-EXECUTIVE-ONE.
  2736             20  AM-EXEC1-NAME             PIC X(15).
  2737             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2738                                                          COMP-3.
  2739             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  49
* NSRASBL.cbl
  2740                                                          COMP-3.
  2741         16  AM-EXECUTIVE-TWO.
  2742             20  AM-EXEC2-NAME             PIC X(15).
  2743             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2744                                                          COMP-3.
  2745             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2746                                                          COMP-3.
  2747
  2748     12  AM-RETRO-ADDITIONAL-DATA.
  2749         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2750         16  AM-RETRO-PREM-P-E             PIC X.
  2751         16  AM-RETRO-CLMS-P-I             PIC X.
  2752         16  AM-RETRO-RET-BRACKET-LF.
  2753             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2754                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2755                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2756             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2757                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2758                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2759             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2760                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2761                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2762         16  AM-RETRO-RET-BRACKET-AH.
  2763             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2764                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2765                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2766                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2767             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2768                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2769                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2770             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2771                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2772                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2773
  2774     12  AM-COMMENTS.
  2775         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2776
  2777     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2778         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2779         16  AM-FLI-BILLING-CODE           PIC X.
  2780         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2781         16  AM-FLI-UNITED-IDENT           PIC X.
  2782         16  AM-FLI-INTEREST-LOST-DATA.
  2783             20  AM-FLI-BANK-NO            PIC X(5).
  2784             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2785             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2786             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2787         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2788             20  AM-FLI-AGT                PIC X(9).
  2789             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2790             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2791         16  FILLER                        PIC X(102).
  2792
  2793     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2794         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2795             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2796             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2797             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  50
* NSRASBL.cbl
  2798             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2799             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2800         16  FILLER                          PIC X(10).
  2801******************************************************************
  2802*                                COPY ELCTEXT.
  2803******************************************************************
  2804*                                                                *
  2805*                                                                *
  2806*                            ELCTEXT.                            *
  2807*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2808*                            VMOD=2.008                          *
  2809*                                                                *
  2810*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2811*                                     FORM LETTERS,              *
  2812*                                     CERT FORM DISPLAY.
  2813*                                                                *
  2814*   FILE TYPE = VSAM,KSDS                                        *
  2815*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2816*                                                                *
  2817*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2818*       ALTERNATE INDEX = NONE                                   *
  2819*                                                                *
  2820*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2821*       ALTERNATE INDEX = NONE                                   *
  2822*                                                                *
  2823*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  2824*       ALTERNATE INDEX = NONE                                   *
  2825*                                                                *
  2826*   LOG = NO                                                     *
  2827*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2828******************************************************************
  2829 01  TEXT-FILES.
  2830     12  TEXT-FILE-ID                PIC XX.
  2831         88  FORMS-FILE-TEXT            VALUE 'TF'.
  2832         88  LETTER-FILE-TEXT           VALUE 'TL'.
  2833         88  HELP-FILE-TEXT             VALUE 'TH'.
  2834
  2835     12  TX-CONTROL-PRIMARY.
  2836         16  TX-COMPANY-CD           PIC X.
  2837             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  2838         16  TX-ACCESS-CD-GENL       PIC X(12).
  2839
  2840         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2841             20  TX-LETTER-NO        PIC X(4).
  2842             20  FILLER              PIC X(8).
  2843
  2844         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2845             20  TX-FORM-NO          PIC X(12).
  2846
  2847         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2848             20  TX-HELP-TYPE        PIC X.
  2849                 88  HELP-FOR-GENERAL   VALUE ' '.
  2850                 88  HELP-BY-SCREEN     VALUE 'S'.
  2851                 88  HELP-BY-ERROR      VALUE 'E'.
  2852             20  TX-SCREEN-OR-ERROR  PIC X(4).
  2853                 88  GENERAL-INFO-HELP  VALUE '0000'.
  2854             20  TX-HELP-FOR-COMPANY  PIC XXX.
  2855                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  51
* NSRASBL.cbl
  2856             20  FILLER              PIC X(4).
  2857
  2858         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  2859
  2860     12  TX-PROCESS-CONTROL          PIC XX.
  2861         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  2862
  2863     12  TX-TEXT-LINE                PIC X(70).
  2864
  2865     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  2866         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  2867         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  2868         88  TX-VALID-FORM-SQUEEZE-VALUE
  2869                                        VALUE 'Y' ' '.
  2870
  2871     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  2872         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  2873         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  2874         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  2875         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  2876         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  2877         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  2878         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  2879                                              'K' 'N' ' '
  2880                                              'Z'.
  2881
  2882     12  TX-ARCHIVE-SW               PIC X.
  2883         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  2884         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  2885         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  2886
  2887     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  2888     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  2889
  2890     12  TX-BSR-CODE                 PIC X.
  2891         88  TX-BSR-LETTER              VALUE 'B'.
  2892         88  TX-NON-BSR-LETTER          VALUE ' '.
  2893
  2894     12  FILLER                      PIC X.
  2895*****************************************************************
  2896*                                COPY ELCCNTL.
  2897******************************************************************
  2898*                                                                *
  2899*                                                                *
  2900*                            ELCCNTL.                            *
  2901*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2902*                            VMOD=2.059                          *
  2903*                                                                *
  2904*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2905*                                                                *
  2906*   FILE TYPE = VSAM,KSDS                                        *
  2907*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2908*                                                                *
  2909*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2910*       ALTERNATE INDEX = NONE                                   *
  2911*                                                                *
  2912*   LOG = YES                                                    *
  2913*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  52
* NSRASBL.cbl
  2914******************************************************************
  2915*                   C H A N G E   L O G
  2916*
  2917* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2918*-----------------------------------------------------------------
  2919*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2920* EFFECTIVE    NUMBER
  2921*-----------------------------------------------------------------
  2922* 082503                   PEMA  ADD BENEFIT GROUP
  2923* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2924* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2925* 092705    2005050300006  PEMA  ADD SPP LEASES
  2926* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2927* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2928* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2929* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2930* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2931* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2932******************************************************************
  2933*
  2934 01  CONTROL-FILE.
  2935     12  CF-RECORD-ID                       PIC XX.
  2936         88  VALID-CF-ID                        VALUE 'CF'.
  2937
  2938     12  CF-CONTROL-PRIMARY.
  2939         16  CF-COMPANY-ID                  PIC XXX.
  2940         16  CF-RECORD-TYPE                 PIC X.
  2941             88  CF-COMPANY-MASTER              VALUE '1'.
  2942             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2943             88  CF-STATE-MASTER                VALUE '3'.
  2944             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2945             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2946             88  CF-CARRIER-MASTER              VALUE '6'.
  2947             88  CF-MORTALITY-MASTER            VALUE '7'.
  2948             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2949             88  CF-TERMINAL-MASTER             VALUE '9'.
  2950             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2951             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2952             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2953             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2954             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2955             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2956             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2957             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2958             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2959         16  CF-ACCESS-CD-GENL              PIC X(4).
  2960         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2961             20  CF-PROCESSOR               PIC X(4).
  2962         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2963             20  CF-STATE-CODE              PIC XX.
  2964             20  FILLER                     PIC XX.
  2965         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2966             20  FILLER                     PIC XX.
  2967             20  CF-HI-BEN-IN-REC           PIC XX.
  2968         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2969             20  FILLER                     PIC XXX.
  2970             20  CF-CARRIER-CNTL            PIC X.
  2971         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  53
* NSRASBL.cbl
  2972             20  FILLER                     PIC XX.
  2973             20  CF-HI-TYPE-IN-REC          PIC 99.
  2974         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2975             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2976                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2977             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2978             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2979         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2980             20  FILLER                     PIC X.
  2981             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2982         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2983             20  FILLER                     PIC XX.
  2984             20  CF-MORTGAGE-PLAN           PIC XX.
  2985         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2986
  2987     12  CF-LAST-MAINT-DT                   PIC XX.
  2988     12  CF-LAST-MAINT-BY                   PIC X(4).
  2989     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2990
  2991     12  CF-RECORD-BODY                     PIC X(728).
  2992
  2993
  2994****************************************************************
  2995*             COMPANY MASTER RECORD                            *
  2996****************************************************************
  2997
  2998     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2999         16  CF-COMPANY-ADDRESS.
  3000             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3001             20  CF-CL-IN-CARE-OF           PIC X(30).
  3002             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3003             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3004             20  CF-CL-CITY-STATE           PIC X(30).
  3005             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3006             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3007         16  CF-COMPANY-CD                  PIC X.
  3008         16  CF-COMPANY-PASSWORD            PIC X(8).
  3009         16  CF-SECURITY-OPTION             PIC X.
  3010             88  ALL-SECURITY                   VALUE '1'.
  3011             88  COMPANY-VERIFY                 VALUE '2'.
  3012             88  PROCESSOR-VERIFY               VALUE '3'.
  3013             88  NO-SECURITY                    VALUE '4'.
  3014             88  ALL-BUT-TERM                   VALUE '5'.
  3015         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3016             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3017         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3018             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3019         16  CF-INFORCE-LOCATION            PIC X.
  3020             88  CERTS-ARE-ONLINE               VALUE '1'.
  3021             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3022             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3023         16  CF-LOWER-CASE-LETTERS          PIC X.
  3024         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3025             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3026             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3027             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3028             88  CF-ACCNT-CNTL                  VALUE '3'.
  3029             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  54
* NSRASBL.cbl
  3030
  3031         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3032         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3033
  3034         16  CF-LGX-CREDIT-USER             PIC X.
  3035             88  CO-IS-NOT-USER                 VALUE 'N'.
  3036             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3037
  3038         16 CF-CREDIT-CALC-CODES.
  3039             20  CF-CR-REM-TERM-CALC PIC X.
  3040               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3041               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3042               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3043               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3044               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3045               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3046               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3047             20  CF-CR-R78-METHOD           PIC X.
  3048               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3049               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3050
  3051         16  CF-CLAIM-CONTROL-COUNTS.
  3052             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3053                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3054
  3055             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3056                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3057
  3058             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3059                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3060
  3061             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3062                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3063
  3064         16  CF-CURRENT-MONTH-END           PIC XX.
  3065
  3066         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3067             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3068             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3069             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3070             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3071                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3072                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3073             20  CF-CO-PREM-REJECT-SW       PIC X.
  3074                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3075                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3076             20  CF-CO-REF-REJECT-SW        PIC X.
  3077                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3078                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3079
  3080         16  CF-CO-REPORTING-DT             PIC XX.
  3081         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3082         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3083           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3084           88  CF-CO-MONTH-END                  VALUE '1'.
  3085
  3086         16  CF-LGX-CLAIM-USER              PIC X.
  3087             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  55
* NSRASBL.cbl
  3088             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3089
  3090         16  CF-CREDIT-EDIT-CONTROLS.
  3091             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3092             20  CF-MIN-AGE                 PIC 99.
  3093             20  CF-DEFAULT-AGE             PIC 99.
  3094             20  CF-MIN-TERM                PIC S999      COMP-3.
  3095             20  CF-MAX-TERM                PIC S999      COMP-3.
  3096             20  CF-DEFAULT-SEX             PIC X.
  3097             20  CF-JOINT-AGE-INPUT         PIC X.
  3098                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3099             20  CF-BIRTH-DATE-INPUT        PIC X.
  3100                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3101             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3102                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3103                 88  CF-ZERO-CARRIER            VALUE '1'.
  3104                 88  CF-ZERO-GROUPING           VALUE '2'.
  3105                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3106             20  CF-EDIT-SW                 PIC X.
  3107                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3108             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3109             20  CF-CR-PR-METHOD            PIC X.
  3110               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3111               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3112             20  FILLER                     PIC X.
  3113
  3114         16  CF-CREDIT-MISC-CONTROLS.
  3115             20  CF-REIN-TABLE-SW           PIC X.
  3116                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3117             20  CF-COMP-TABLE-SW           PIC X.
  3118                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3119             20  CF-EXPERIENCE-RETENTION-AGE
  3120                                            PIC S9        COMP-3.
  3121             20  CF-CONVERSION-DT           PIC XX.
  3122             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3123             20  CF-RUN-FREQUENCY-SW        PIC X.
  3124                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3125                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3126
  3127             20  CF-CR-CHECK-NO-CONTROL.
  3128                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3129                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3130                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3131                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3132                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3133                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3134
  3135                 24  CF-CR-CHECK-COUNT       REDEFINES
  3136                     CF-CR-CHECK-COUNTER      PIC X(4).
  3137
  3138                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3139                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3140
  3141                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3142                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3143                 24  CF-MAIL-PROCESSING       PIC X.
  3144                     88  MAIL-PROCESSING          VALUE 'Y'.
  3145
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  56
* NSRASBL.cbl
  3146         16  CF-MISC-SYSTEM-CONTROL.
  3147             20  CF-SYSTEM-C                 PIC X.
  3148                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3149             20  CF-SYSTEM-D                 PIC X.
  3150                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3151             20  CF-SOC-SEC-NO-SW            PIC X.
  3152                 88  SOC-SEC-NO-USED             VALUE '1'.
  3153             20  CF-MEMBER-NO-SW             PIC X.
  3154                 88  MEMBER-NO-USED              VALUE '1'.
  3155             20  CF-TAX-ID-NUMBER            PIC X(11).
  3156             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3157             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3158                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3159                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3160                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3161                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3162             20  CF-SYSTEM-E                 PIC X.
  3163                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3164
  3165         16  CF-LGX-LIFE-USER               PIC X.
  3166             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3167             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3168
  3169         16  CF-CR-MONTH-END-DT             PIC XX.
  3170
  3171         16  CF-FILE-MAINT-DATES.
  3172             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3173                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3174             20  CF-LAST-BATCH       REDEFINES
  3175                 CF-LAST-BATCH-NO               PIC X(4).
  3176             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3177             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3178             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3179             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3180             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3181             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3182             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3183             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3184             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3185             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3186
  3187         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3188         16  FILLER                         PIC X.
  3189
  3190         16  CF-ALT-MORT-CODE               PIC X(4).
  3191         16  CF-MEMBER-CAPTION              PIC X(10).
  3192
  3193         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3194             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3195             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3196             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3197             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3198             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3199
  3200         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3201
  3202         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3203         16  CF-LIFE-OVERRIDE-L2            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  57
* NSRASBL.cbl
  3204         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3205         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3206
  3207         16  CF-AH-OVERRIDE-L1              PIC X.
  3208         16  CF-AH-OVERRIDE-L2              PIC XX.
  3209         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3210         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3211
  3212         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3213         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3214
  3215         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3216         16  CF-AR-LAST-EL860-DT            PIC XX.
  3217         16  CF-MP-MONTH-END-DT             PIC XX.
  3218
  3219         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3220         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3221             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3222
  3223         16  CF-AR-MONTH-END-DT             PIC XX.
  3224
  3225         16  CF-CRDTCRD-USER                PIC X.
  3226             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3227             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3228
  3229         16  CF-CC-MONTH-END-DT             PIC XX.
  3230
  3231         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3232
  3233         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3234             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3235             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3236             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3237         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3238         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3239         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3240         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3241             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3242             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3243         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3244         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3245         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3246             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3247         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3248
  3249         16  CF-CL-ZIP-CODE.
  3250             20  CF-CL-ZIP-PRIME.
  3251                 24  CF-CL-ZIP-1ST          PIC X.
  3252                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3253                 24  FILLER                 PIC X(4).
  3254             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3255         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3256             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3257             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3258             20  FILLER                     PIC XXX.
  3259
  3260         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3261         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  58
* NSRASBL.cbl
  3262         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3263         16  CF-CO-OPTION-START-DATE        PIC XX.
  3264         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3265           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3266                                                      '3' '4'.
  3267           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3268           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3269           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3270           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3271           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3272           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3273
  3274         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3275
  3276         16  CF-PAYMENT-APPROVAL-LEVELS.
  3277             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3278             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3279             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3280             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3281             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3282             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3283
  3284         16  CF-END-USER-REPORTING-USER     PIC X.
  3285             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3286             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3287
  3288         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3289             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3290             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3291
  3292         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3293
  3294         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3295         16  FILLER                         PIC X.
  3296
  3297         16  CF-CREDIT-ARCHIVE-CNTL.
  3298             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3299             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3300             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3301
  3302         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3303
  3304         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3305             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3306             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3307
  3308         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3309             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3310             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3311
  3312         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3313
  3314         16  CF-CO-ACH-ID-CODE              PIC  X.
  3315             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3316             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3317             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3318         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3319         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  59
* NSRASBL.cbl
  3320         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3321         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3322         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3323         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3324         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3325         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3326         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3327                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3328         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3329                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3330
  3331         16  CF-CO-OVER-SHORT.
  3332             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3333             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3334
  3335*         16  FILLER                         PIC X(102).
  3336         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3337             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3338             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3339
  3340         16  CF-AH-APPROVAL-DAYS.
  3341             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3342             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3343             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3344             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3345
  3346         16  FILLER                         PIC X(82).
  3347****************************************************************
  3348*             PROCESSOR/USER RECORD                            *
  3349****************************************************************
  3350
  3351     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3352         16  CF-PROCESSOR-NAME              PIC X(30).
  3353         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3354         16  CF-PROCESSOR-TITLE             PIC X(26).
  3355         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3356                 88  MESSAGE-YES                VALUE 'Y'.
  3357                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3358
  3359*****************************************************
  3360****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3361****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3362****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3363****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3364*****************************************************
  3365
  3366         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3367             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3368             20  CF-APPLICATION-FORCE       PIC X.
  3369             20  CF-INDIVIDUAL-APP.
  3370                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3371                     28  CF-BROWSE-APP      PIC X.
  3372                     28  CF-UPDATE-APP      PIC X.
  3373
  3374         16  CF-CURRENT-TERM-ON             PIC X(4).
  3375         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3376             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3377             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  60
* NSRASBL.cbl
  3378             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3379             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3380             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3381             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3382             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3383         16  CF-PROCESSOR-CARRIER           PIC X.
  3384             88  NO-CARRIER-SECURITY            VALUE ' '.
  3385         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3386             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3387         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3388             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3389         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3390             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3391
  3392         16  CF-PROC-SYS-ACCESS-SW.
  3393             20  CF-PROC-CREDIT-CLAIMS-SW.
  3394                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3395                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3396                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3397                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3398             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3399                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3400                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3401             20  CF-PROC-LIFE-GNRLDGR-SW.
  3402                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3403                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3404                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3405                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3406             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3407                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3408                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3409         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3410             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3411             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3412         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3413
  3414         16  CF-APPROVAL-LEVEL                  PIC X.
  3415             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3416             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3417             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3418             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3419
  3420         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3421
  3422         16  CF-LANGUAGE-TYPE                   PIC X.
  3423             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3424             88  CF-LANG-IS-FR                      VALUE 'F'.
  3425
  3426         16  CF-CSR-IND                         PIC X.
  3427         16  FILLER                             PIC X(239).
  3428
  3429****************************************************************
  3430*             PROCESSOR/REMINDERS RECORD                       *
  3431****************************************************************
  3432
  3433     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3434         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3435             20  CF-START-REMIND-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  61
* NSRASBL.cbl
  3436             20  CF-END-REMIND-DT           PIC XX.
  3437             20  CF-REMINDER-TEXT           PIC X(50).
  3438         16  FILLER                         PIC X(296).
  3439
  3440
  3441****************************************************************
  3442*             STATE MASTER RECORD                              *
  3443****************************************************************
  3444
  3445     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3446         16  CF-STATE-ABBREVIATION          PIC XX.
  3447         16  CF-STATE-NAME                  PIC X(25).
  3448         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3449         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3450             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3451             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3452             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3453             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3454                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3455                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3456             20  CF-ST-PREM-REJECT-SW       PIC X.
  3457                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3458                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3459             20  CF-ST-REF-REJECT-SW        PIC X.
  3460                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3461                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3462         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3463         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3464         16  CF-ST-REFUND-RULES.
  3465             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3466             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3467             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3468         16  CF-ST-FST-PMT-EXTENSION.
  3469             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3470             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3471                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3472                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3473                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3474                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3475         16  CF-ST-STATE-CALL.
  3476             20  CF-ST-CALL-UNEARNED        PIC X.
  3477             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3478             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3479         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3480             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3481             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3482         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3483         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3484         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3485         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3486         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3487         16  FILLER                         PIC X.
  3488         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3489             20  CF-ST-BENEFIT-CD           PIC XX.
  3490             20  CF-ST-BENEFIT-KIND         PIC X.
  3491                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3492                 88  CF-ST-AH-KIND              VALUE 'A'.
  3493             20  CF-ST-REM-TERM-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  62
* NSRASBL.cbl
  3494                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3495                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3496                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3497                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3498                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3499                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3500                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3501                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3502
  3503             20  CF-ST-REFUND-CALC          PIC X.
  3504                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3505                 88  ST-REFD-BY-R78             VALUE '1'.
  3506                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3507                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3508                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3509                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3510                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3511                 88  ST-REFD-UTAH               VALUE '7'.
  3512                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3513                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3514                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3515
  3516             20  CF-ST-EARNING-CALC         PIC X.
  3517                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3518                 88  ST-EARN-BY-R78             VALUE '1'.
  3519                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3520                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3521                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3522                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3523                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3524                 88  ST-EARN-MEAN               VALUE '8'.
  3525                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3526
  3527             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3528                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3529                 88  ST-OVRD-BY-R78             VALUE '1'.
  3530                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3531                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3532                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3533                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3534                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3535                 88  ST-OVRD-MEAN               VALUE '8'.
  3536                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3537             20  FILLER                     PIC X.
  3538
  3539         16  CF-ST-COMMISSION-CAPS.
  3540             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3541             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3542             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3543             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3544         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3545                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3546
  3547         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3548
  3549         16  CF-ST-STATUTORY-INTEREST.
  3550             20  CF-ST-STAT-DATE-FROM       PIC X.
  3551                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  63
* NSRASBL.cbl
  3552                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3553             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3554             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3555             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3556             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3557             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3558
  3559         16  CF-ST-OVER-SHORT.
  3560             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3561             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3562
  3563         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3564
  3565         16  CF-ST-RT-CALC                  PIC X.
  3566
  3567         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3568         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3569         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3570         16  CF-ST-RF-LR-CALC               PIC X.
  3571         16  CF-ST-RF-LL-CALC               PIC X.
  3572         16  CF-ST-RF-LN-CALC               PIC X.
  3573         16  CF-ST-RF-AH-CALC               PIC X.
  3574         16  CF-ST-RF-CP-CALC               PIC X.
  3575*        16  FILLER                         PIC X(206).
  3576*CIDMOD         16  FILLER                         PIC X(192).
  3577         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3578             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3579         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3580         16  CF-ST-VFY-2ND-BENE             PIC X.
  3581         16  FILLER                         PIC X(186).
  3582
  3583****************************************************************
  3584*             BENEFIT MASTER RECORD                            *
  3585****************************************************************
  3586
  3587     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3588         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3589             20  CF-BENEFIT-CODE            PIC XX.
  3590             20  CF-BENEFIT-NUMERIC  REDEFINES
  3591                 CF-BENEFIT-CODE            PIC XX.
  3592             20  CF-BENEFIT-ALPHA           PIC XXX.
  3593             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3594             20  CF-BENEFIT-COMMENT         PIC X(10).
  3595
  3596             20  CF-LF-COVERAGE-TYPE        PIC X.
  3597                 88  CF-REDUCING                VALUE 'R'.
  3598                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3599
  3600             20  CF-SPECIAL-CALC-CD         PIC X.
  3601                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3602                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3603                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3604                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3605                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3606                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3607                 88  CF-FARM-PLAN               VALUE 'F'.
  3608                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3609                 88  CF-2-MTH-INTEREST          VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  64
* NSRASBL.cbl
  3610                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3611                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3612                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3613                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3614                 88  CF-PRUDENTIAL              VALUE 'P'.
  3615                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3616                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3617                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3618                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3619                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3620                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3621
  3622             20  CF-JOINT-INDICATOR         PIC X.
  3623                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3624
  3625*            20  FILLER                     PIC X(12).
  3626             20  FILLER                     PIC X(11).
  3627             20  CF-BENEFIT-CATEGORY        PIC X.
  3628             20  CF-LOAN-TYPE               PIC X(8).
  3629
  3630             20  CF-CO-REM-TERM-CALC        PIC X.
  3631                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3632                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3633                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3634                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3635                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3636
  3637             20  CF-CO-EARNINGS-CALC        PIC X.
  3638                 88  CO-EARN-BY-R78             VALUE '1'.
  3639                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3640                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3641                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3642                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3643                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3644                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3645                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3646
  3647             20  CF-CO-REFUND-CALC          PIC X.
  3648                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3649                 88  CO-REFD-BY-R78             VALUE '1'.
  3650                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3651                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3652                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3653                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3654                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3655                 88  CO-REFD-MEAN               VALUE '8'.
  3656                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3657                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3658                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3659
  3660             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3661                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3662                 88  CO-OVRD-BY-R78             VALUE '1'.
  3663                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3664                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3665                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3666                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3667                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  65
* NSRASBL.cbl
  3668                 88  CO-OVRD-MEAN               VALUE '8'.
  3669                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3670
  3671             20  CF-CO-BEN-I-G-CD           PIC X.
  3672                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3673                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3674                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3675
  3676         16  FILLER                         PIC X(304).
  3677
  3678
  3679****************************************************************
  3680*             CARRIER MASTER RECORD                            *
  3681****************************************************************
  3682
  3683     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3684         16  CF-ADDRESS-DATA.
  3685             20  CF-MAIL-TO-NAME            PIC X(30).
  3686             20  CF-IN-CARE-OF              PIC X(30).
  3687             20  CF-ADDRESS-LINE-1          PIC X(30).
  3688             20  CF-ADDRESS-LINE-2          PIC X(30).
  3689             20  CF-CITY-STATE              PIC X(30).
  3690             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3691             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3692
  3693         16  CF-CLAIM-NO-CONTROL.
  3694             20  CF-CLAIM-NO-METHOD         PIC X.
  3695                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3696                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3697                 88  CLAIM-NO-SEQ               VALUE '3'.
  3698                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3699             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3700                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3701                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3702                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3703
  3704         16  CF-CHECK-NO-CONTROL.
  3705             20  CF-CHECK-NO-METHOD         PIC X.
  3706                 88  CHECK-NO-MANUAL            VALUE '1'.
  3707                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3708                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3709                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3710             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3711                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3712
  3713         16  CF-DOMICILE-STATE              PIC XX.
  3714
  3715         16  CF-EXPENSE-CONTROLS.
  3716             20  CF-EXPENSE-METHOD          PIC X.
  3717                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3718                 88  DOLLARS-PER-PMT            VALUE '2'.
  3719                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3720                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3721             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3722             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3723
  3724         16  CF-CORRESPONDENCE-CONTROL.
  3725             20  CF-LETTER-RESEND-OPT       PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  66
* NSRASBL.cbl
  3726                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3727                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3728             20  FILLER                     PIC X(4).
  3729
  3730         16  CF-RESERVE-CONTROLS.
  3731             20  CF-MANUAL-SW               PIC X.
  3732                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3733             20  CF-FUTURE-SW               PIC X.
  3734                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3735             20  CF-PTC-SW                  PIC X.
  3736                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3737             20  CF-IBNR-SW                 PIC X.
  3738                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3739             20  CF-PTC-LF-SW               PIC X.
  3740                 88  CF-LF-PTC-USED             VALUE '1'.
  3741             20  CF-CDT-ACCESS-METHOD       PIC X.
  3742                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3743                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3744                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3745             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3746
  3747         16  CF-CLAIM-CALC-METHOD           PIC X.
  3748             88  360-PLUS-MONTHS                VALUE '1'.
  3749             88  365-PLUS-MONTHS                VALUE '2'.
  3750             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3751             88  360-DAILY                      VALUE '4'.
  3752             88  365-DAILY                      VALUE '5'.
  3753
  3754         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3755         16  FILLER                         PIC X(11).
  3756
  3757         16  CF-LIMIT-AMOUNTS.
  3758             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3759             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3760             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3761             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3762             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3763             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3764             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3765             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3766             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3767             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3768
  3769         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3770         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3771         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3772
  3773         16  CF-ZIP-CODE.
  3774             20  CF-ZIP-PRIME.
  3775                 24  CF-ZIP-1ST             PIC X.
  3776                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3777                 24  FILLER                 PIC X(4).
  3778             20  CF-ZIP-PLUS4               PIC X(4).
  3779         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3780             20  CF-CAN-POSTAL-1            PIC XXX.
  3781             20  CF-CAN-POSTAL-2            PIC XXX.
  3782             20  FILLER                     PIC XXX.
  3783
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  67
* NSRASBL.cbl
  3784         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3785         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3786         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3787
  3788         16  CF-RATING-SWITCH               PIC X.
  3789             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3790             88  CF-NO-RATING                   VALUE 'N'.
  3791
  3792         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3793
  3794         16  CF-CARRIER-OVER-SHORT.
  3795             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3796             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3797
  3798         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3799         16  CF-SECPAY-SWITCH               PIC X.
  3800             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3801             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3802         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3803         16  FILLER                         PIC X(448).
  3804*        16  FILLER                         PIC X(452).
  3805
  3806
  3807****************************************************************
  3808*             MORTALITY MASTER RECORD                          *
  3809****************************************************************
  3810
  3811     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3812         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3813                                INDEXED BY CF-MORT-NDX.
  3814             20  CF-MORT-TABLE              PIC X(5).
  3815             20  CF-MORT-TABLE-TYPE         PIC X.
  3816                 88  CF-MORT-JOINT              VALUE 'J'.
  3817                 88  CF-MORT-SINGLE             VALUE 'S'.
  3818                 88  CF-MORT-COMBINED           VALUE 'C'.
  3819                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3820                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3821             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3822             20  CF-MORT-AGE-METHOD         PIC XX.
  3823                 88  CF-AGE-LAST                VALUE 'AL'.
  3824                 88  CF-AGE-NEAR                VALUE 'AN'.
  3825             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3826             20  CF-MORT-ADJUSTMENT-DIRECTION
  3827                                            PIC X.
  3828                 88  CF-MINUS                   VALUE '-'.
  3829                 88  CF-PLUS                    VALUE '+'.
  3830             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3831             20  CF-MORT-JOINT-CODE         PIC X.
  3832                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3833             20  CF-MORT-PC-Q               PIC X.
  3834                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3835             20  CF-MORT-TABLE-CODE         PIC X(4).
  3836             20  CF-MORT-COMMENTS           PIC X(15).
  3837             20  FILLER                     PIC X(14).
  3838
  3839         16  FILLER                         PIC X(251).
  3840
  3841
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  68
* NSRASBL.cbl
  3842****************************************************************
  3843*             BUSSINESS TYPE MASTER RECORD                     *
  3844****************************************************************
  3845
  3846     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3847* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3848* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3849* AND RECORD 05 IS TYPES 81-99
  3850         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3851             20  CF-BUSINESS-TITLE          PIC  X(19).
  3852             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3853                                            PIC S9V9(4) COMP-3.
  3854             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3855             20  FILLER                     PIC  X.
  3856         16  FILLER                         PIC  X(248).
  3857
  3858
  3859****************************************************************
  3860*             TERMINAL MASTER RECORD                           *
  3861****************************************************************
  3862
  3863     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3864
  3865         16  CF-COMPANY-TERMINALS.
  3866             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3867                                  PIC X(4).
  3868         16  FILLER               PIC X(248).
  3869
  3870
  3871****************************************************************
  3872*             LIFE EDIT MASTER RECORD                          *
  3873****************************************************************
  3874
  3875     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3876         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3877             20  CF-LIFE-CODE-IN            PIC XX.
  3878             20  CF-LIFE-CODE-OUT           PIC XX.
  3879         16  FILLER                         PIC X(248).
  3880
  3881
  3882****************************************************************
  3883*             AH EDIT MASTER RECORD                            *
  3884****************************************************************
  3885
  3886     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3887         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3888             20  CF-AH-CODE-IN              PIC XXX.
  3889             20  CF-AH-CODE-OUT             PIC XX.
  3890         16  FILLER                         PIC X(248).
  3891
  3892
  3893****************************************************************
  3894*             CREDIBILITY TABLES                               *
  3895****************************************************************
  3896
  3897     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3898         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3899                             INDEXED BY CF-CRDB-NDX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  69
* NSRASBL.cbl
  3900             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3901             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3902             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3903         16  FILLER                         PIC  X(332).
  3904
  3905
  3906****************************************************************
  3907*             REPORT CUSTOMIZATION RECORD                      *
  3908****************************************************************
  3909
  3910     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3911         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3912             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3913             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3914             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3915**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3916****       A T-TRANSFER.                                   ****
  3917             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3918
  3919         16  FILLER                         PIC XX.
  3920
  3921         16  CF-CARRIER-CNTL-OPT.
  3922             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3923                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3924                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3925             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3926                                            PIC X.
  3927         16  CF-GROUP-CNTL-OPT.
  3928             20  CF-GROUP-OPT-SEQ           PIC 9.
  3929                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3930                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3931             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3932                                            PIC X(6).
  3933         16  CF-STATE-CNTL-OPT.
  3934             20  CF-STATE-OPT-SEQ           PIC 9.
  3935                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3936                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3937             20  CF-STATE-SELECT OCCURS 3 TIMES
  3938                                            PIC XX.
  3939         16  CF-ACCOUNT-CNTL-OPT.
  3940             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3941                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3942                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3943             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3944                                            PIC X(10).
  3945         16  CF-BUS-TYP-CNTL-OPT.
  3946             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3947                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3948                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3949             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3950                                            PIC XX.
  3951         16  CF-LF-TYP-CNTL-OPT.
  3952             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3953                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3954                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3955             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3956                                            PIC XX.
  3957         16  CF-AH-TYP-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  70
* NSRASBL.cbl
  3958             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3959                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3960                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3961             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3962                                            PIC XX.
  3963         16  CF-REPTCD1-CNTL-OPT.
  3964             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3965                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3966                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3967             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3968                                            PIC X(10).
  3969         16  CF-REPTCD2-CNTL-OPT.
  3970             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3971                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3972                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3973             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3974                                            PIC X(10).
  3975         16  CF-USER1-CNTL-OPT.
  3976             20  CF-USER1-OPT-SEQ           PIC 9.
  3977                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3978                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3979             20  CF-USER1-SELECT OCCURS 3 TIMES
  3980                                            PIC X(10).
  3981         16  CF-USER2-CNTL-OPT.
  3982             20  CF-USER2-OPT-SEQ           PIC 9.
  3983                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3984                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3985             20  CF-USER2-SELECT OCCURS 3 TIMES
  3986                                            PIC X(10).
  3987         16  CF-USER3-CNTL-OPT.
  3988             20  CF-USER3-OPT-SEQ           PIC 9.
  3989                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3990                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3991             20  CF-USER3-SELECT OCCURS 3 TIMES
  3992                                            PIC X(10).
  3993         16  CF-USER4-CNTL-OPT.
  3994             20  CF-USER4-OPT-SEQ           PIC 9.
  3995                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3996                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3997             20  CF-USER4-SELECT OCCURS 3 TIMES
  3998                                            PIC X(10).
  3999         16  CF-USER5-CNTL-OPT.
  4000             20  CF-USER5-OPT-SEQ           PIC 9.
  4001                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4002                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4003             20  CF-USER5-SELECT OCCURS 3 TIMES
  4004                                            PIC X(10).
  4005         16  CF-REINS-CNTL-OPT.
  4006             20  CF-REINS-OPT-SEQ           PIC 9.
  4007                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4008                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4009             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4010                 24  CF-REINS-PRIME         PIC XXX.
  4011                 24  CF-REINS-SUB           PIC XXX.
  4012
  4013         16  CF-AGENT-CNTL-OPT.
  4014             20  CF-AGENT-OPT-SEQ           PIC 9.
  4015                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  71
* NSRASBL.cbl
  4016                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4017             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4018                                            PIC X(10).
  4019
  4020         16  FILLER                         PIC X(43).
  4021
  4022         16  CF-LOSS-RATIO-SELECT.
  4023             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4024             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4025         16  CF-ENTRY-DATE-SELECT.
  4026             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4027             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4028         16  CF-EFFECTIVE-DATE-SELECT.
  4029             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4030             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4031
  4032         16  CF-EXCEPTION-LIST-IND          PIC X.
  4033             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4034
  4035         16  FILLER                         PIC X(318).
  4036
  4037****************************************************************
  4038*                  EXCEPTION REPORTING RECORD                  *
  4039****************************************************************
  4040
  4041     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4042         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4043             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4044
  4045         16  CF-COMBINED-LIFE-AH-OPT.
  4046             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4047             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4048             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4049             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4050
  4051         16  CF-LIFE-OPT.
  4052             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4053             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4054             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4055             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4056             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4057             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4058             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4059             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4060             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4061             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4062
  4063         16  CF-AH-OPT.
  4064             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4065             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4066             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4067             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4068             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4069             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4070             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4071             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4072             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4073             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  72
* NSRASBL.cbl
  4074
  4075         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4076             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4077             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4078             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4079
  4080         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4081
  4082         16  FILLER                         PIC X(673).
  4083
  4084
  4085****************************************************************
  4086*             MORTGAGE SYSTEM PLAN RECORD                      *
  4087****************************************************************
  4088
  4089     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4090         16  CF-PLAN-TYPE                   PIC X.
  4091             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4092             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4093             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4094         16  CF-PLAN-ABBREV                 PIC XXX.
  4095         16  CF-PLAN-DESCRIPT               PIC X(10).
  4096         16  CF-PLAN-NOTES                  PIC X(20).
  4097         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4098         16  CF-PLAN-UNDERWRITING.
  4099             20  CF-PLAN-TERM-DATA.
  4100                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4101                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4102             20  CF-PLAN-AGE-DATA.
  4103                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4104                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4105                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4106             20  CF-PLAN-BENEFIT-DATA.
  4107                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4108                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4109                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4110                                            PIC S9(7)V99  COMP-3.
  4111         16  CF-PLAN-POLICY-FORMS.
  4112             20  CF-POLICY-FORM             PIC X(12).
  4113             20  CF-MASTER-APPLICATION      PIC X(12).
  4114             20  CF-MASTER-POLICY           PIC X(12).
  4115         16  CF-PLAN-RATING.
  4116             20  CF-RATE-CODE               PIC X(5).
  4117             20  CF-SEX-RATING              PIC X.
  4118                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4119                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4120             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4121             20  CF-SUB-STD-TYPE            PIC X.
  4122                 88  CF-PCT-OF-PREM            VALUE '1'.
  4123                 88  CF-PCT-OF-BENE            VALUE '2'.
  4124         16  CF-PLAN-PREM-TOLERANCES.
  4125             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4126             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4127         16  CF-PLAN-PYMT-TOLERANCES.
  4128             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4129             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4130         16  CF-PLAN-MISC-DATA.
  4131             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  73
* NSRASBL.cbl
  4132             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4133             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4134         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4135         16  CF-PLAN-IND-GRP                PIC X.
  4136             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4137                                                     '1'.
  4138             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4139                                                     '2'.
  4140         16  CF-MIB-SEARCH-SW               PIC X.
  4141             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4142             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4143             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4144             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4145         16  CF-ALPHA-SEARCH-SW             PIC X.
  4146             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4147             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4148             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4149             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4150             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4151             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4152             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4153             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4154             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4155             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4156                                                     'A' 'B' 'C'
  4157                                                     'X' 'Y' 'Z'.
  4158         16  CF-EFF-DT-RULE-SW              PIC X.
  4159             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4160             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4161             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4162             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4163             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4164         16  FILLER                         PIC X(4).
  4165         16  CF-HEALTH-QUESTIONS            PIC X.
  4166             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4167         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4168         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4169         16  CF-PLAN-SNGL-JNT               PIC X.
  4170             88  CF-COMBINED-PLAN              VALUE 'C'.
  4171             88  CF-JNT-PLAN                   VALUE 'J'.
  4172             88  CF-SNGL-PLAN                  VALUE 'S'.
  4173         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4174         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4175         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4176         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4177         16  CF-RERATE-CNTL                 PIC  X.
  4178             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4179             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4180             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4181             88  CF-AUTO-RECALC                 VALUE '4'.
  4182         16  CF-BENEFIT-TYPE                PIC  X.
  4183             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4184             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4185         16  CF-POLICY-FEE                  PIC S999V99
  4186                                                    COMP-3.
  4187         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4188         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4189         16  CF-3RD-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  74
* NSRASBL.cbl
  4190         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4191         16  FILLER                         PIC  X(32).
  4192         16  CF-TERMINATION-FORM            PIC  X(04).
  4193         16  FILLER                         PIC  X(08).
  4194         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4195                                                       COMP-3.
  4196         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4197         16  CF-ISSUE-LETTER                PIC  X(4).
  4198         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4199         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4200             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4201             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4202         16  CF-MP-REFUND-CALC              PIC X.
  4203             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4204             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4205             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4206             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4207             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4208             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4209             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4210             88  CF-MP-REFD-MEAN                VALUE '8'.
  4211         16  CF-ALT-RATE-CODE               PIC  X(5).
  4212
  4213
  4214         16  FILLER                         PIC X(498).
  4215****************************************************************
  4216*             MORTGAGE COMPANY MASTER RECORD                   *
  4217****************************************************************
  4218
  4219     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4220         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4221         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4222             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4223             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4224             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4225             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4226             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4227
  4228         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4229         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4230         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4231         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4232         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4233
  4234         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4235             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4236         16  CF-MP-RECON-USE-IND            PIC X(1).
  4237             88  CF-MP-USE-RECON             VALUE 'Y'.
  4238         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4239             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4240         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4241             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4242             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4243         16  FILLER                         PIC X(1).
  4244         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4245             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4246         16  CF-MORTG-MIB-VERSION           PIC X.
  4247             88  CF-MORTG-MIB-BATCH         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  75
* NSRASBL.cbl
  4248             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4249             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4250         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4251             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4252                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4253             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4254                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4255             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4256                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4257             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4258                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4259             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4260                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4261             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4262                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4263         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4264         16  FILLER                         PIC X(7).
  4265         16  CF-MORTG-DESTINATION-SYMBOL.
  4266             20  CF-MORTG-MIB-COMM          PIC X(5).
  4267             20  CF-MORTG-MIB-TERM          PIC X(5).
  4268         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4269             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4270         16  FILLER                         PIC X(03).
  4271         16  CF-MP-CHECK-NO-CONTROL.
  4272             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4273                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4274                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4275                                                ' ' LOW-VALUES.
  4276                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4277                                               VALUE '3'.
  4278         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4279         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4280         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4281             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4282                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4283             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4284                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4285             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4286                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4287             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4288                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4289             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4290                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4291             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4292                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4293         16  CF-MORTG-BILLING-AREA.
  4294             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4295                                            PIC X.
  4296         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4297         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4298         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4299         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4300             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4301             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4302         16  FILLER                         PIC X.
  4303         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4304             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4305             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  76
* NSRASBL.cbl
  4306         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4307         16  FILLER                         PIC X(8).
  4308         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4309         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4310         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4311         16  CF-ACH-COMPANY-ID.
  4312             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4313                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4314                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4315                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4316             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4317         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4318             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4319         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4320             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4321             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4322         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4323         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4324         16  FILLER                         PIC X(536).
  4325
  4326****************************************************************
  4327*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4328****************************************************************
  4329
  4330     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4331         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4332             20  CF-FEMALE-HEIGHT.
  4333                 24  CF-FEMALE-FT           PIC 99.
  4334                 24  CF-FEMALE-IN           PIC 99.
  4335             20  CF-FEMALE-MIN-WT           PIC 999.
  4336             20  CF-FEMALE-MAX-WT           PIC 999.
  4337         16  FILLER                         PIC X(428).
  4338
  4339     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4340         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4341             20  CF-MALE-HEIGHT.
  4342                 24  CF-MALE-FT             PIC 99.
  4343                 24  CF-MALE-IN             PIC 99.
  4344             20  CF-MALE-MIN-WT             PIC 999.
  4345             20  CF-MALE-MAX-WT             PIC 999.
  4346         16  FILLER                         PIC X(428).
  4347******************************************************************
  4348*             AUTOMATIC ACTIVITY RECORD                          *
  4349******************************************************************
  4350     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4351         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4352             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4353             20  CF-SYS-LETTER-ID           PIC X(04).
  4354             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4355             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4356             20  CF-SYS-RESET-SW            PIC X(01).
  4357             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4358             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4359
  4360         16  FILLER                         PIC X(50).
  4361
  4362         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4363             20  CF-USER-ACTIVE-SW          PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  77
* NSRASBL.cbl
  4364             20  CF-USER-LETTER-ID          PIC X(04).
  4365             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4366             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4367             20  CF-USER-RESET-SW           PIC X(01).
  4368             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4369             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4370             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4371
  4372         16  FILLER                         PIC X(246).
  4373*                                COPY NSCASVARS.
  4374******************************************************************
  4375*                   C H A N G E   L O G
  4376*
  4377* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4378*-----------------------------------------------------------------
  4379*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4380* EFFECTIVE    NUMBER
  4381*-----------------------------------------------------------------
  4382* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
  4383* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
  4384******************************************************************
  4385 01 NAPER-OUTPUT-DATA.
  4386    05  F                       PIC X(07) VALUE "LETTER=".
  4387    05  OUT-LETTER              PIC X(06) VALUE SPACES.
  4388    05  F                       PIC X(08) VALUE "~PROCID=".
  4389    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
  4390    05  F                       PIC X(10) VALUE "~PROCNAME=".
  4391    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
  4392    05  F                       PIC X(11) VALUE "~PROCTITLE=".
  4393    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
  4394    05  F                       PIC X(09) VALUE "~CSRNAME=".
  4395    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
  4396    05  F                       PIC X(10) VALUE "~CSRTITLE=".
  4397    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
  4398    05  F                       PIC X(06) VALUE "~CARR=".
  4399    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
  4400    05  F                       PIC X(10) VALUE "~GROUPING=".
  4401    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
  4402    05  F                       PIC X(08) VALUE "~CERTST=".
  4403    05  OUT-STATE               PIC X(02) VALUE SPACES.
  4404    05  F                       PIC X(09) VALUE "~ACCOUNT=".
  4405    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
  4406    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
  4407    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
  4408    05  F                       PIC X(07) VALUE "~CRTNO=".
  4409    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
  4410    05  F                       PIC X(08) VALUE "~CRTSUF=".
  4411    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
  4412    05  F                       PIC X(08) VALUE "~ILNAME=".
  4413    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
  4414    05  F                       PIC X(08) VALUE "~IFNAME=".
  4415    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
  4416    05  F                       PIC X(08) VALUE "~IFINIT=".
  4417    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
  4418    05  F                       PIC X(08) VALUE "~IMINIT=".
  4419    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
  4420    05  F                       PIC X(09) VALUE "~IISSAGE=".
  4421    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  78
* NSRASBL.cbl
  4422    05  F                       PIC X(06) VALUE "~ISEX=".
  4423    05  OUT-ISEX                PIC X(01) VALUE SPACES.
  4424    05  F                       PIC X(10) VALUE "~INSADDR1=".
  4425    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
  4426    05  F                       PIC X(10) VALUE "~INSADDR2=".
  4427    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
  4428    05  F                       PIC X(09) VALUE "~INSCITY=".
  4429    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
  4430    05  F                       PIC X(10) VALUE "~INSSTATE=".
  4431    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
  4432    05  F                       PIC X(08) VALUE "~INSZIP=".
  4433    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
  4434    05  F                       PIC X(05) VALUE "~SSN=".
  4435    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
  4436    05  F                       PIC X(07) VALUE "~MEMNO=".
  4437    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
  4438    05  F                       PIC X(08) VALUE "~JLNAME=".
  4439    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
  4440    05  F                       PIC X(08) VALUE "~JFNAME=".
  4441    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
  4442    05  F                       PIC X(08) VALUE "~JMINIT=".
  4443    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
  4444    05  F                       PIC X(08) VALUE "~JNTAGE=".
  4445    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
  4446    05  F                       PIC X(10) VALUE "~ACCTNAME=".
  4447    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
  4448    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
  4449    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
  4450    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
  4451    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
  4452    05  F                       PIC X(10) VALUE "~ACCTCITY=".
  4453    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
  4454    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
  4455    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
  4456    05  F                       PIC X(09) VALUE "~ACCTZIP=".
  4457    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
  4458    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
  4459    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
  4460    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
  4461    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
  4462    05  F                       PIC X(09) VALUE "~BUSTYPE=".
  4463    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
  4464    05  F                       PIC X(10) VALUE "~BENENAME=".
  4465    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
  4466    05  F                       PIC X(11) VALUE "~BENEADDR1=".
  4467    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
  4468    05  F                       PIC X(11) VALUE "~BENEADDR2=".
  4469    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
  4470    05  F                       PIC X(10) VALUE "~BENECITY=".
  4471    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
  4472    05  F                       PIC X(11) VALUE "~BENESTATE=".
  4473    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
  4474    05  F                       PIC X(09) VALUE "~BENEZIP=".
  4475    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
  4476    05  F                       PIC X(10) VALUE "~CARRNAME=".
  4477    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
  4478    05  F                       PIC X(08) VALUE "~RESPNO=".
  4479    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  79
* NSRASBL.cbl
  4480    05  F                       PIC X(12) VALUE "~COACCTNAME=".
  4481    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
  4482    05  F                       PIC X(12) VALUE "~COMAILNAME=".
  4483    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
  4484    05  F                       PIC X(11) VALUE "~COMPADDR1=".
  4485    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
  4486    05  F                       PIC X(11) VALUE "~COMPADDR2=".
  4487    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
  4488    05  F                       PIC X(10) VALUE "~COMPCITY=".
  4489    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
  4490    05  F                       PIC X(11) VALUE "~COMPSTATE=".
  4491    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
  4492    05  F                       PIC X(09) VALUE "~COMPZIP=".
  4493    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
  4494    05  F                       PIC X(11) VALUE "~COMPPHONE=".
  4495    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
  4496    05  F                       PIC X(09) VALUE "~COMPFAX=".
  4497    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
  4498    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
  4499    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
  4500    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
  4501    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
  4502    05  F                       PIC X(08) VALUE "~RPTCD1=".
  4503    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
  4504    05  F                       PIC X(08) VALUE "~RPTCD2=".
  4505    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
  4506    05  F                       PIC X(09) VALUE "~ENTRYDT=".
  4507    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
  4508    05  F                       PIC X(07) VALUE "~BATCH=".
  4509    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
  4510    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
  4511    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
  4512    05  F                       PIC X(10) VALUE "~1STPMTDT=".
  4513    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
  4514    05  F                       PIC X(05) VALUE "~APR=".
  4515    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
  4516    05  F                       PIC X(08) VALUE "~LNTERM=".
  4517    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
  4518    05  F                       PIC X(11) VALUE "~RATECLASS=".
  4519    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
  4520    05  F                       PIC X(09) VALUE "~EXTDAYS=".
  4521    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
  4522    05  F                       PIC X(09) VALUE "~CSRCODE=".
  4523    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
  4524    05  F                       PIC X(07) VALUE "~UCODE=".
  4525    05  OUT-UCODE               PIC X(01) VALUE SPACES.
  4526    05  F                       PIC X(10) VALUE "~PREMTYPE=".
  4527    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
  4528    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
  4529    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
  4530    05  F                       PIC X(06) VALUE "~SKIP=".
  4531    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
  4532    05  F                       PIC X(06) VALUE "~MODE=".
  4533    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
  4534    05  F                       PIC X(09) VALUE "~LOANOFF=".
  4535    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
  4536    05  F                       PIC X(06) VALUE "~RTBL=".
  4537    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  80
* NSRASBL.cbl
  4538    05  F                       PIC X(10) VALUE "~SPECREIN=".
  4539    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
  4540    05  F                       PIC X(09) VALUE "~LFBENCD=".
  4541    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
  4542    05  F                       PIC X(08) VALUE "~LFTERM=".
  4543    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
  4544    05  F                       PIC X(07) VALUE "~LFDEV=".
  4545    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
  4546    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
  4547    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
  4548    05  F                       PIC X(07) VALUE "~LFBEN=".
  4549    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
  4550    05  F                       PIC X(08) VALUE "~LFPREM=".
  4551    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4552    05  F                       PIC X(08) VALUE "~LFABEN=".
  4553    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4554    05  F                       PIC X(09) VALUE "~LFAPREM=".
  4555    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
  4556    05  F                       PIC X(07) VALUE "~LFNSP=".
  4557    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4558    05  F                       PIC X(08) VALUE "~LFRBEN=".
  4559    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4560    05  F                       PIC X(07) VALUE "~LFCAN=".
  4561    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4562    05  F                       PIC X(07) VALUE "~LFDTH=".
  4563    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
  4564    05  F                       PIC X(08) VALUE "~LFRATE=".
  4565    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4566    05  F                       PIC X(09) VALUE "~LFARATE=".
  4567    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
  4568    05  F                       PIC X(09) VALUE "~LFEXPDT=".
  4569    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
  4570    05  F                       PIC X(08) VALUE "~LFSTAT=".
  4571    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
  4572    05  F                       PIC X(09) VALUE "~LFCANDT=".
  4573    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
  4574    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
  4575    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4576    05  F                       PIC X(07) VALUE "~DTHDT=".
  4577    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
  4578    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
  4579    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
  4580    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
  4581    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4582    05  F                       PIC X(08) VALUE "~LFCOMM=".
  4583    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4584    05  F                       PIC X(11) VALUE "~LFBENDESC=".
  4585    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
  4586    05  F                       PIC X(11) VALUE "~LFBENABRV=".
  4587    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
  4588    05  F                       PIC X(09) VALUE "~AHBENCD=".
  4589    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
  4590    05  F                       PIC X(08) VALUE "~AHTERM=".
  4591    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
  4592    05  F                       PIC X(11) VALUE "~AHCRITPER=".
  4593    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
  4594    05  F                       PIC X(09) VALUE "~AHDEVCD=".
  4595    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  81
* NSRASBL.cbl
  4596    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
  4597    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
  4598    05  F                       PIC X(07) VALUE "~AHBEN=".
  4599    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
  4600    05  F                       PIC X(08) VALUE "~AHPREM=".
  4601    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4602    05  F                       PIC X(07) VALUE "~AHNSP=".
  4603    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4604    05  F                       PIC X(07) VALUE "~AHCAN=".
  4605    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4606    05  F                       PIC X(10) VALUE "~AHITDPMT=".
  4607    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
  4608    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
  4609    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4610    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
  4611    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
  4612    05  F                       PIC X(08) VALUE "~AHRATE=".
  4613    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4614    05  F                       PIC X(09) VALUE "~AHEXPDT=".
  4615    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
  4616    05  F                       PIC X(08) VALUE "~AHSTAT=".
  4617    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
  4618    05  F                       PIC X(09) VALUE "~AHCANDT=".
  4619    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
  4620    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
  4621    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4622    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
  4623    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4624    05  F                       PIC X(08) VALUE "~AHCOMM=".
  4625    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4626    05  F                       PIC X(11) VALUE "~AHBENDESC=".
  4627    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
  4628    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
  4629    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
  4630    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
  4631    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
  4632    05  F                       PIC X(08) VALUE "~AHWAIT=".
  4633    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
  4634    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
  4635    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
  4636    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
  4637                                PIC X(2).
  4638    05  F                       PIC X(09) VALUE "~TOTPREM=".
  4639    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
  4640    05  F                       PIC X(08) VALUE "~TOTREF=".
  4641    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
  4642    05  F                       PIC X(08) VALUE "~SEXPDT=".
  4643    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
  4644    05  F                       PIC X(07) VALUE "~STERM=".
  4645    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
  4646    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
  4647    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
  4648    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
  4649    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
  4650    05  F                       PIC X(11) VALUE "~IORIGINIT=".
  4651    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
  4652    05  F                       PIC X(10) VALUE "~IORIGAGE=".
  4653    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  82
* NSRASBL.cbl
  4654    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
  4655    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
  4656    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
  4657    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
  4658    05  F                       PIC X(11) VALUE "~JORIGINIT=".
  4659    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
  4660    05  F                       PIC X(10) VALUE "~JORIGAGE=".
  4661    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
  4662    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
  4663    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
  4664    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
  4665    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
  4666    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
  4667    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
  4668    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
  4669                                PIC X(12).
  4670    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
  4671    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
  4672    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
  4673                                PIC X(12).
  4674    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
  4675    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
  4676    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
  4677    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
  4678    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
  4679    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4680    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
  4681    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
  4682    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
  4683                                PIC X(12).
  4684    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
  4685    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
  4686    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
  4687                                PIC X(10).
  4688    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
  4689    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
  4690    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
  4691    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
  4692    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
  4693    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
  4694    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
  4695    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
  4696    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
  4697    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
  4698    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
  4699    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
  4700    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
  4701                                PIC X(10).
  4702    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
  4703    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
  4704    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
  4705                                PIC X(10).
  4706    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
  4707    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
  4708    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
  4709    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
  4710    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
  4711    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  83
* NSRASBL.cbl
  4712    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
  4713    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
  4714    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
  4715    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
  4716    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
  4717    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
  4718    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
  4719    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
  4720    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
  4721    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
  4722    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
  4723    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
  4724    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
  4725                                PIC X(2).
  4726    05  F                       PIC X(09) VALUE "~OSEXPDT=".
  4727    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
  4728    05  F                       PIC X(08) VALUE "~OSTERM=".
  4729    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
  4730    05  F                       PIC X(11) VALUE "~INEWLNAME=".
  4731    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
  4732    05  F                       PIC X(11) VALUE "~INEWFNAME=".
  4733    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
  4734    05  F                       PIC X(10) VALUE "~INEWINIT=".
  4735    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
  4736    05  F                       PIC X(09) VALUE "~INEWAGE=".
  4737    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
  4738    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
  4739                                PIC X(09).
  4740    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
  4741    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
  4742    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
  4743    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
  4744    05  F                       PIC X(10) VALUE "~JNEWINIT=".
  4745    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
  4746    05  F                       PIC X(09) VALUE "~JNEWAGE=".
  4747    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
  4748    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
  4749                                PIC X(09).
  4750    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
  4751    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
  4752    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
  4753    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
  4754    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
  4755                                PIC X(09).
  4756    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
  4757    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
  4758    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
  4759                                PIC X(12).
  4760    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
  4761    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
  4762    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
  4763                                PIC X(10).
  4764    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
  4765    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
  4766    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
  4767    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
  4768    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
  4769                                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  84
* NSRASBL.cbl
  4770    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
  4771    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
  4772    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
  4773                                PIC X(10).
  4774    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
  4775    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
  4776    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
  4777    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
  4778    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
  4779    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
  4780    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
  4781    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
  4782    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
  4783                                PIC X(09).
  4784    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
  4785    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
  4786    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
  4787                                PIC X(09).
  4788    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
  4789    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
  4790    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
  4791                                PIC X(10).
  4792    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
  4793    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
  4794    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
  4795                                PIC X(10).
  4796    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
  4797    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
  4798    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
  4799    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
  4800    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
  4801    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
  4802    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
  4803    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
  4804    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
  4805    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
  4806    05  F                       PIC X(09) VALUE "~NEWWAIT=".
  4807    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
  4808    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
  4809    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
  4810    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
  4811                                PIC X(09).
  4812    05  F                       PIC X(09) VALUE "~NSEXPDT=".
  4813    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
  4814    05  F                       PIC X(08) VALUE "~NSTERM=".
  4815    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
  4816    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
  4817                                PIC X(09).
  4818    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
  4819    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
  4820    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
  4821    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
  4822    05  F                       PIC X(11) VALUE "~PAYABLETO=".
  4823    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
  4824    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
  4825    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
  4826    05  F                       PIC X(09) VALUE "~BALLOON=".
  4827    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  85
* NSRASBL.cbl
  4828    05  F                       PIC X(10) VALUE "~LEASEIND=".
  4829    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
  4830    05  F                       PIC X(09) VALUE "~RESCIND=".
  4831    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
  4832    05  F                       PIC X(07) VALUE "~RCD01=".
  4833    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
  4834    05  F                       PIC X(07) VALUE "~RCD02=".
  4835    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
  4836    05  F                       PIC X(07) VALUE "~RCD03=".
  4837    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
  4838    05  F                       PIC X(07) VALUE "~RCD04=".
  4839    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
  4840    05  F                       PIC X(07) VALUE "~RCD05=".
  4841    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
  4842    05  F                       PIC X(07) VALUE "~RCD06=".
  4843    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
  4844    05  F                       PIC X(07) VALUE "~RCD07=".
  4845    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
  4846    05  F                       PIC X(07) VALUE "~RCD08=".
  4847    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
  4848    05  F                       PIC X(07) VALUE "~RCD09=".
  4849    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
  4850    05  F                       PIC X(07) VALUE "~RCD10=".
  4851    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
  4852    05  F                       PIC X(07) VALUE "~RCD11=".
  4853    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
  4854    05  F                       PIC X(07) VALUE "~RCD12=".
  4855    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
  4856    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
  4857    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
  4858    05  F                       PIC X(08) VALUE "~ARCHNO=".
  4859    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
  4860    05  F                       PIC X(06) VALUE "~FORM=".
  4861    05  OUT-FORM                PIC X(03) VALUE SPACES.
  4862    05  F                       PIC X(09) VALUE "~ENCLINE=".
  4863    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
  4864    05  F                       PIC X(08) VALUE "~ATTACH=".
  4865    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
  4866    05  F                       PIC X(10) VALUE "~OUTSTACK=".
  4867    05  OUT-STACK               PIC X(10) VALUE SPACES.
  4868    05  F                       PIC X(11) VALUE "~STATENAME=".
  4869    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
  4870    05  F                       PIC X(08) VALUE "~PRTNOW=".
  4871    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
  4872    05  F                       PIC X(05) VALUE "~NCB=".
  4873    05  OUT-CHGBACK             PIC X     VALUE ' '.
  4874    05  F                       PIC X(8) VALUE "~CSOAMT=".
  4875    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
  4876    05  F                       PIC X(9) VALUE "~ACCTAMT=".
  4877    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
  4878    05  F                       PIC X(09) VALUE "~LETRTYP=".
  4879    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
  4880    05  F                       PIC X(10) VALUE "~PRNTCERT=".
  4881    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
  4882    05  F                       PIC X(08) VALUE "~INSBDT=".
  4883    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
  4884    05  F                       PIC X(08) VALUE "~JNTBDT=".
  4885    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  86
* NSRASBL.cbl
  4886    05  F                       PIC X(08) VALUE "~TOTINT=".
  4887    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
  4888    05  F                       PIC X(8) VALUE "~TOPREM=".
  4889    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  4890    05  F                       PIC X(7) VALUE "~TOREF=".
  4891    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  4892    05  F                       PIC X(7) VALUE "~CANDT=".
  4893    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  4894    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  4895    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  4896    05  F                       PIC X(08) VALUE "~CERTID=".
  4897    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
  4898    05  F                       PIC X(08) VALUE "~UNDWID=".
  4899    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
  4900    05  F                       PIC X(8) VALUE "~TNPREM=".
  4901    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  4902    05  F                       PIC X(7) VALUE "~TNREF=".
  4903    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  4904    05  F                       PIC X(8)  VALUE "~COVIND=".
  4905    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
  4906    05  F                       PIC X(9)  VALUE "~OCOVIND=".
  4907    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
  4908    05  F                       PIC X(9)  VALUE "~NCOVIND=".
  4909    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  4910    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  4911    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  4912    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  4913    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  4914    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
  4915    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  4916    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  4917                                PIC X(10).
  4918    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  4919    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  4920    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  4921    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  4922    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  4923    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  4924    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
  4925    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  4926    05  F                       PIC X(10) VALUE "~LFREFCHG=".
  4927    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  4928    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  4929    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  4930    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  4931    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  4932    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  4933    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4934    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  4935    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4936    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  4937    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  4938    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  4939    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  4940    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  4941    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  4942    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
  4943    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  87
* NSRASBL.cbl
  4944    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  4945    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
  4946    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  4947    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  4948    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  4949    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4950    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  4951    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4952    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  4953    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  4954    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
  4955    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  4956    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
  4957    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4958    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  4959    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4960    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
  4961    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4962    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  4963    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  4964    05  F                       PIC X(09) VALUE "~CSOOAMT=".
  4965    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  4966    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
  4967    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4968    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  4969    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4970    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  4971    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4972    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
  4973    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  4974    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  4975    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  4976    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  4977    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  4978    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  4979    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4980    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  4981    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4982    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
  4983    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  4984    05  F                       PIC X(09) VALUE "~CSONAMT=".
  4985    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
  4986    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  4987    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  4988    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  4989    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  4990    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  4991    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  4992    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  4993    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  4994    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  4995    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  4996    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  4997    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  4998    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  4999    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5000    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
  5001    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  88
* NSRASBL.cbl
  5002    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  5003    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5004    05  F                       PIC X(08) VALUE "~CSOCHG=".
  5005    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  5006    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  5007    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  5008    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  5009    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  5010    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  5011    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  5012    05  F                       PIC X(10) VALUE "~AHNCANDT=".
  5013    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  5014    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
  5015    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
  5016    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  5017    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  5018    05  F                       PIC X(8)  VALUE "~SCREEN=".
  5019    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  5020    05  F                       PIC X(11) VALUE 'EndOfString'.
  5021    05  f                       pic x(12) value spaces.
  5022*                                COPY ERCARCH.
  5023******************************************************************
  5024*                                                                *
  5025*                            ERCARCH.                            *
  5026*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5027*                            VMOD=2.002                          *
  5028*                                                                *
  5029*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5030*                                                                *
  5031*   FILE TYPE = VSAM,KSDS                                        *
  5032*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5033*                                                                *
  5034*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5035*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5036*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5037*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5038*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5039*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5040*                                                                *
  5041*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5042******************************************************************
  5043*                   C H A N G E   L O G
  5044*
  5045* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5046*-----------------------------------------------------------------
  5047*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5048* EFFECTIVE    NUMBER
  5049*-----------------------------------------------------------------
  5050* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5051* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5052* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5053******************************************************************
  5054 01  LETTER-ARCHIVE.
  5055     12  LA-RECORD-ID                PIC  X(02).
  5056         88  LA-VALID-ID                VALUE 'LA'.
  5057
  5058     12  LA-CONTROL-PRIMARY.
  5059         16  LA-COMPANY-CD           PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  89
* NSRASBL.cbl
  5060         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5061
  5062     12  LA-CONTROL-BY-CERT-RESP.
  5063         16  LA-COMPANY-CD-A2        PIC  X(01).
  5064         16  LA-CERT-NO-A2.
  5065             20  LA-CERT-PRIME-A2    PIC  X(10).
  5066             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5067         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5068             20  LA-RESP-PERSON-A2   PIC  X(10).
  5069             20  LA-TYPE-A2          PIC  X(01).
  5070         16  LA-CARRIER-A2           PIC  X(01).
  5071         16  LA-GROUPING-A2          PIC  X(06).
  5072         16  LA-STATE-A2             PIC  X(02).
  5073         16  LA-ACCOUNT-A2           PIC  X(10).
  5074         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5075         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5076
  5077     12  LA-CONTROL-BY-FORM.
  5078         16  LA-COMPANY-CD-A3        PIC  X(01).
  5079         16  LA-FORM-A3              PIC  X(04).
  5080         16  LA-CARRIER-A3           PIC  X(01).
  5081         16  LA-GROUPING-A3          PIC  X(06).
  5082         16  LA-STATE-A3             PIC  X(02).
  5083         16  LA-ACCOUNT-A3           PIC  X(10).
  5084         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5085
  5086     12  LA-CONTROL-BY-PROCESSOR.
  5087         16  LA-COMPANY-CD-A4        PIC  X(01).
  5088         16  LA-PROCESSOR-CD         PIC  X(04).
  5089         16  LA-CARRIER-A4           PIC  X(01).
  5090         16  LA-GROUPING-A4          PIC  X(06).
  5091         16  LA-STATE-A4             PIC  X(02).
  5092         16  LA-ACCOUNT-A4           PIC  X(10).
  5093         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5094
  5095     12  LA-CONTROL-BY-KEY-FIELDS.
  5096         16  LA-COMPANY-CD-A5        PIC  X(01).
  5097         16  LA-CARRIER-A5           PIC  X(01).
  5098         16  LA-GROUPING-A5          PIC  X(06).
  5099         16  LA-STATE-A5             PIC  X(02).
  5100         16  LA-ACCOUNT-A5           PIC  X(10).
  5101         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5102
  5103     12  LA-CONTROL-BY-GROUP-CODE.
  5104         16  LA-COMPANY-CD-A6        PIC  X(01).
  5105         16  LA-ENTRY-A6.
  5106             20  LA-FILLER           PIC  X(02).
  5107             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5108         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5109
  5110     12  FILLER                      PIC  X(09).
  5111
  5112     12  LA-HEADER-RECORD.
  5113         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5114         16  LA-CREATION-DATE        PIC  X(02).
  5115         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5116         16  LA-FINAL-ACT-DATE       REDEFINES
  5117               LA-FOLLOW-UP-DATE     PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  90
* NSRASBL.cbl
  5118         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5119         16  LA-NO-OF-COPIES         PIC S9(01).
  5120         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5121         16  LA-REPLY-DATE           PIC  X(02).
  5122         16  LA-RESEND-DATES.
  5123             20  LA-RESEND-DATE      PIC  X(02).
  5124             20  LA-SENT-DATE        PIC  X(02).
  5125             20  FILLER              PIC  X(08).
  5126         16  LA-SOURCE-INFORMATION.
  5127             20  LA-DATA-SOURCE      PIC  X(01).
  5128             20  LA-ADDR-SOURCE      PIC  X(01).
  5129         16  LA-STATUS               PIC  X(01).
  5130             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5131             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5132             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5133             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5134             88  LA-STATUS-PURGED         VALUE 'P'.
  5135             88  LA-STATUS-VOIDED         VALUE 'V'.
  5136         16  LA-LAST-RESENT-PRINT-DATE
  5137                                     PIC  X(02).
  5138         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5139             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5140                                          VALUE 'C'.
  5141             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5142                                          VALUE 'F'.
  5143             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5144                                          VALUE 'P'.
  5145         16  LA-PURGED-DATE          PIC  X(02).
  5146         16  LA-VOIDED-DATE          PIC  X(02).
  5147         16  LA-RESEND-LETR          PIC  X(4).
  5148         16  FILLER                  PIC  X(08).
  5149*        16  LA-RESEND-LETR-2        PIC  X(4).
  5150*        16  LA-RESEND-LETR-3        PIC  X(4).
  5151*        16  FILLER                  PIC  X(59).
  5152         16  LA-ARCHIVE-STATUS       PIC  X.
  5153             88  LA-TEMP                VALUE 'T'.
  5154             88  LA-QWS                 VALUE 'Q'.
  5155             88  LA-BATCH               VALUE 'B'.
  5156         16  LA-FINAL-ACT-IND        PIC  X(1).
  5157         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5158         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5159         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5160                                     PIC X(4).
  5161         16  FILLER                  PIC  X(42).
  5162*        16  FILLER                  PIC  X(71).
  5163         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5164         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5165         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5166                                     PIC  X(4).
  5167         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5168
  5169******************************************************************
  5170 01  FILLER                      PIC X(500)  VALUE SPACES.
  5171*                                COPY ELCENCC.
  5172******************************************************************
  5173*                                                                *
  5174*                                                                *
  5175*                            ELCENCC                             *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  91
* NSRASBL.cbl
  5176*                            VMOD=2.001                          *
  5177*                                                                *
  5178*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5179*                                                                *
  5180*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5181*   A NAPERSOFT DOCUMENT                                         *
  5182*                                                                *
  5183*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5184*                                                                *
  5185*   FILE TYPE = VSAM,KSDS                                        *
  5186*   RECORD SIZE = 400   RECFORM = FIX                            *
  5187*                                                                *
  5188*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5189*                                                                *
  5190*   LOG = NO                                                     *
  5191*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5192*                                                                *
  5193*                                                                *
  5194******************************************************************
  5195*                   C H A N G E   L O G
  5196*
  5197* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5198*-----------------------------------------------------------------
  5199*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5200* EFFECTIVE    NUMBER
  5201*-----------------------------------------------------------------
  5202* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5203******************************************************************
  5204 01  ENCLOSURE-CODES.
  5205     12  NC-RECORD-ID                      PIC XX.
  5206         88  VALID-NC-ID                      VALUE 'NC'.
  5207     12  NC-CONTROL-PRIMARY.
  5208         16  NC-COMPANY-CD                 PIC X.
  5209         16  NC-REC-TYPE                   PIC X.
  5210             88  NC-CLAIMS                   VALUE '1'.
  5211             88  NC-ADMIN                    VALUE '2'.
  5212         16  NC-ENC-CODE                   PIC X(5).
  5213         16  FILLER                        PIC X(09).
  5214     12  NC-MAINT-INFORMATION.
  5215         16  NC-LAST-MAINT-DT              PIC XX.
  5216         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5217         16  NC-LAST-MAINT-USER            PIC X(4).
  5218         16  FILLER                        PIC XX.
  5219     12  NC-OUTPUT-STACK                   PIC XXX.
  5220     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5221     12  NC-ATTACHMENTS                    PIC X(100).
  5222     12  NC-FUTURE                         PIC X(50).
  5223     12  FILLER                            PIC X(117).
  5224******************************************************************
  5225****************************************************************
  5226*
  5227* Copyright (c) 2007 by Clerity Solutions, Inc.
  5228* All rights reserved.
  5229*
  5230****************************************************************
  5231 01  DFHEIV.
  5232   02  DFHEIV0               PIC X(35).
  5233   02  DFHEIV1               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  92
* NSRASBL.cbl
  5234   02  DFHEIV2               PIC X(08).
  5235   02  DFHEIV3               PIC X(08).
  5236   02  DFHEIV4               PIC X(06).
  5237   02  DFHEIV5               PIC X(04).
  5238   02  DFHEIV6               PIC X(04).
  5239   02  DFHEIV7               PIC X(02).
  5240   02  DFHEIV8               PIC X(02).
  5241   02  DFHEIV9               PIC X(01).
  5242   02  DFHEIV10              PIC S9(7) COMP-3.
  5243   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5244   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5245   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5246   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5247   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5248   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5249   02  DFHEIV17              PIC X(04).
  5250   02  DFHEIV18              PIC X(04).
  5251   02  DFHEIV19              PIC X(04).
  5252   02  DFHEIV20              USAGE IS POINTER.
  5253   02  DFHEIV21              USAGE IS POINTER.
  5254   02  DFHEIV22              USAGE IS POINTER.
  5255   02  DFHEIV23              USAGE IS POINTER.
  5256   02  DFHEIV24              USAGE IS POINTER.
  5257   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5258   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5259   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5260   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5261   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5262   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5263   02  FILLER                PIC X(02).
  5264   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5265   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5266   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5267   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5268   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5269 LINKAGE  SECTION.
  5270*****************************************************************
  5271*                                                               *
  5272* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5273* All rights reserved.                                          *
  5274*                                                               *
  5275*****************************************************************
  5276 01  dfheiblk.
  5277     02  eibtime          pic s9(7) comp-3.
  5278     02  eibdate          pic s9(7) comp-3.
  5279     02  eibtrnid         pic x(4).
  5280     02  eibtaskn         pic s9(7) comp-3.
  5281     02  eibtrmid         pic x(4).
  5282     02  dfheigdi         pic s9(4) comp.
  5283     02  eibcposn         pic s9(4) comp.
  5284     02  eibcalen         pic s9(4) comp.
  5285     02  eibaid           pic x(1).
  5286     02  eibfiller1       pic x(1).
  5287     02  eibfn            pic x(2).
  5288     02  eibfiller2       pic x(2).
  5289     02  eibrcode         pic x(6).
  5290     02  eibfiller3       pic x(2).
  5291     02  eibds            pic x(8).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  93
* NSRASBL.cbl
  5292     02  eibreqid         pic x(8).
  5293     02  eibrsrce         pic x(8).
  5294     02  eibsync          pic x(1).
  5295     02  eibfree          pic x(1).
  5296     02  eibrecv          pic x(1).
  5297     02  eibsend          pic x(1).
  5298     02  eibatt           pic x(1).
  5299     02  eibeoc           pic x(1).
  5300     02  eibfmh           pic x(1).
  5301     02  eibcompl         pic x(1).
  5302     02  eibsig           pic x(1).
  5303     02  eibconf          pic x(1).
  5304     02  eiberr           pic x(1).
  5305     02  eibrldbk         pic x(1).
  5306     02  eiberrcd         pic x(4).
  5307     02  eibsynrb         pic x(1).
  5308     02  eibnodat         pic x(1).
  5309     02  eibfiller5       pic x(2).
  5310     02  eibresp          pic 9(09) comp.
  5311     02  eibresp2         pic 9(09) comp.
  5312     02  dfheigdj         pic s9(4) comp.
  5313     02  dfheigdk         pic s9(4) comp.
  5314 01 dfhcommarea                  PIC X(6500).
  5315 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  5316 0000-DFHEXIT SECTION.
  5317     MOVE '9#                    $   ' TO DFHEIV0.
  5318     MOVE 'NSRASBL' TO DFHEIV1.
  5319     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5320     display ' entering pgm nsrasbl '
  5321     display ' commarea ' dfhcommarea
  5322     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5323     MOVE '5'                    TO DC-OPTION-CODE
  5324     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5325     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  5326     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  5327     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  5328     move dfhcommarea            to srch-commarea
  5329*****************************************************
  5330* The full       key has been established and passed
  5331* to this program via NSRASLTR
  5332*****************************************************
  5333     PERFORM 1115-MATCH-COMPANY  THRU 1115-EXIT
  5334     display ' input data ' bl-carrier ' ' bl-group ' '
  5335        bl-account ' ' bl-eff-dt ' ' bl-cert-no
  5336     MOVE BL-LETTER-ID           TO OUT-LETTER
  5337     MOVE BL-PROC-ID             TO OUT-PROC-ID
  5338     MOVE BL-CARRIER             TO OUT-CARRIER
  5339     MOVE BL-GROUP               TO OUT-GROUPING
  5340     MOVE BL-ACCOUNT             TO OUT-ACCOUNT
  5341     MOVE BL-PRINT-NOW-SW        TO OUT-PRINT-NOW
  5342     MOVE BL-CERT-FORM-ID        TO OUT-CERTIFICATE-ID
  5343     MOVE BL-SOURCE-SCREEN       TO OUT-SCREEN-ID
  5344     STRING DC-EDITA-CCYY DC-EDITA-MONTH
  5345        DC-EDITA-DAY  DELIMITED BY SIZE
  5346        INTO OUT-CYCLE-DT
  5347     END-STRING
  5348     IF BL-EFF-DT = '99/99/99' OR '99/99/9999'
  5349        MOVE HIGH-VALUES         TO WS-PASSED-DT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  94
* NSRASBL.cbl
  5350     ELSE
  5351        IF BL-EFF-DT = SPACES
  5352           display ' bad eff data ' bl-eff-dt ' ' bl-cert-no
  5353        ELSE
  5354           IF BL-EFF-DT (9:2) = SPACES
  5355              STRING BL-EFF-DT (7:2) BL-EFF-DT (1:2)
  5356                     BL-EFF-DT (4:2)
  5357                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5358              END-STRING
  5359           ELSE
  5360              STRING BL-EFF-DT (9:2) BL-EFF-DT (1:2)
  5361                     BL-EFF-DT (4:2)
  5362                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5363              END-STRING
  5364           END-IF
  5365           MOVE '3'              TO DC-OPTION-CODE
  5366           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5367           IF NO-CONVERSION-ERROR
  5368              MOVE DC-BIN-DATE-1 TO WS-PASSED-DT
  5369           ELSE
  5370              MOVE 'BAD EFF DATE CONVERT ' TO BL-MESSAGE
  5371              SET BL-FAIL TO TRUE
  5372              GO TO 0000-RETURN
  5373           END-IF
  5374        END-IF
  5375     END-IF
  5376     perform 0800-init-out-data  thru 0800-exit
  5377     SET BL-FAIL TO TRUE
  5378******************************************************************
  5379* DATA SOURCE MEANINGS  BL-DATA-SRCE
  5380*    1) FROM ACCT MAINT
  5381*    2) FROM CERT UPDATE
  5382*    3) FROM COMP MAINT
  5383*    4) FROM REVIEW AND CORRECTIONS
  5384******************************************************************
  5385     EVALUATE BL-DATA-SRCE
  5386        WHEN '1'
  5387           PERFORM 0100-DATA-SRCE-1 THRU 0100-EXIT
  5388        WHEN '2'
  5389           PERFORM 0200-DATA-SRCE-2 THRU 0200-EXIT
  5390        WHEN '3'
  5391           PERFORM 0300-DATA-SRCE-3 THRU 0300-EXIT
  5392        WHEN '4'
  5393           PERFORM 0400-DATA-SRCE-4 THRU 0400-EXIT
  5394        WHEN OTHER
  5395           MOVE ' BAD DATA SOURCE CODE ' TO BL-MESSAGE
  5396     END-EVALUATE
  5397     IF BL-OK
  5398        display ' bl write erarch ' bl-write-erarch
  5399        PERFORM 1250-GET-ELLETR  THRU 1250-EXIT
  5400        PERFORM 1700-GET-ELENCC  THRU 1700-EXIT
  5401        IF BL-ARCHIVE-NO = ZEROS
  5402           PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  5403           MOVE WS-ARCHIVE-NO    TO BL-ARCHIVE-NO
  5404           display ' arch zeros, new arch ' bl-archive-no
  5405        END-IF
  5406        MOVE BL-ARCHIVE-NO       TO OUT-ARCH-NO
  5407        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  95
* NSRASBL.cbl
  5408        display ' bl write erarch ' bl-write-erarch
  5409        IF BL-WRITE-ERARCH = 'T' OR 'B'
  5410           PERFORM 0700-WRITE-EXTR THRU 0700-EXIT
  5411           IF BL-FAIL
  5412              GO TO 0000-RETURN
  5413           END-IF
  5414        END-IF
  5415        MOVE W-LETTER-TO-ACCT    TO BL-LETTER-TO-ACCT
  5416        MOVE W-LETTER-TO-BENE    TO BL-LETTER-TO-BENE
  5417     END-IF
  5418     .
  5419 0000-RETURN.
  5420     move srch-commarea          to dfhcommarea
  5421
  5422* exec cics
  5423*       return
  5424*    end-exec
  5425*    MOVE '.(                    ''   #00005417' TO DFHEIV0
  5426     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5427     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5428     MOVE X'2020233030303035343137' TO DFHEIV0(25:11)
  5429     CALL 'kxdfhei1' USING DFHEIV0,
  5430           DFHEIV99,
  5431           DFHEIV99,
  5432           DFHEIV99,
  5433           DFHEIV99,
  5434           DFHEIV99,
  5435           DFHEIV99
  5436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5437     .
  5438 0100-DATA-SRCE-1.
  5439     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5440     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5441     MOVE ' '                    TO WS-ERACCT-SW
  5442     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  5443     MOVE WS-COMPANY-CD          TO WS-ERACCT-COMPANY-CD
  5444     MOVE BL-CARRIER             TO WS-ERACCT-CARRIER
  5445     MOVE BL-GROUP               TO WS-ERACCT-GROUP
  5446     MOVE BL-STATE               TO WS-ERACCT-STATE
  5447     MOVE BL-ACCOUNT             TO WS-ERACCT-ACCOUNT
  5448     MOVE WS-PASSED-DT           TO WS-ERACCT-EXP-DT
  5449                                    WS-CERT-EFF-DT
  5450     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  5451     IF ACCT-FOUND
  5452        MOVE AM-CSR-CODE         TO WS-CSR-ID
  5453        PERFORM 1025-GET-CSR-INFO
  5454                                 THRU 1025-EXIT
  5455        PERFORM 1300-DETERMINE-COMM
  5456                                 THRU 1300-EXIT
  5457        SET BL-OK TO TRUE
  5458     ELSE
  5459        MOVE ' ACCOUNT MASTER NOT FOUND ' TO BL-MESSAGE
  5460        SET BL-FAIL TO TRUE
  5461     END-IF
  5462     .
  5463 0100-EXIT.
  5464     EXIT.
  5465 0200-DATA-SRCE-2.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  96
* NSRASBL.cbl
  5466     display ' made it to data srce 2 '
  5467     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5468     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5469     MOVE ' '                    TO WS-ELCERT-SW
  5470     MOVE WS-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  5471     MOVE BL-CARRIER             TO WS-ELCERT-CARRIER
  5472     MOVE BL-GROUP               TO WS-ELCERT-GROUP
  5473     MOVE BL-STATE               TO WS-ELCERT-STATE
  5474     MOVE BL-ACCOUNT             TO WS-ELCERT-ACCOUNT
  5475     MOVE WS-PASSED-DT           TO WS-ELCERT-EFF-DT
  5476                                    WS-CERT-EFF-DT
  5477     MOVE BL-CERT-NO             TO WS-ELCERT-CERT-NO
  5478
  5479     MOVE ' '                 TO WS-ERACCT-SW
  5480     MOVE LOW-VALUES          TO WS-ERACCT-KEY
  5481     MOVE WS-ELCERT-KEY (1:22) TO WS-ERACCT-KEY (1:22)
  5482     PERFORM 1200-GET-ERACCT  THRU 1200-EXIT
  5483     IF ACCT-FOUND
  5484        MOVE AM-CSR-CODE      TO WS-CSR-ID
  5485        PERFORM 1025-GET-CSR-INFO THRU 1025-EXIT
  5486     END-IF
  5487     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  5488     IF CERT-FOUND
  5489        PERFORM 1130-MATCH-BENCDS THRU 1130-EXIT
  5490        MOVE WS-LF-ABBRV         TO OUT-LF-ABBRV
  5491        MOVE WS-LF-DESC          TO OUT-LF-DESC
  5492        IF WS-LF-EARN = 'B'
  5493           MOVE 'B'              TO OUT-BALLOON-IND
  5494        END-IF
  5495        MOVE WS-WAIT-PER         TO OUT-WAIT-PER
  5496        MOVE WS-RET-ELIM         TO OUT-RET-ELIM
  5497        MOVE WS-AH-DESC          TO OUT-AH-DESC
  5498        MOVE WS-BEN-DAYS         TO OUT-BEN-DAYS
  5499
  5500        IF BL-ENDT-ARCH-NO > ZERO
  5501           MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5502           MOVE BL-ENDT-ARCH-NO    TO WS-ERENDT-ARCHIVE
  5503           PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5504        ELSE
  5505           IF BL-ARCHIVE-NO > ZERO
  5506              MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5507              MOVE BL-ARCHIVE-NO      TO WS-ERENDT-ARCHIVE
  5508              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5509           END-IF
  5510        END-IF
  5511
  5512        IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  5513           AND (OUT-BALLOON-IND = 'B')
  5514           MOVE 'B'              TO OUT-FORM (3:1)
  5515        END-IF
  5516        SET BL-OK TO TRUE
  5517     ELSE
  5518        display ' cert not found ' ws-elcert-cert-no
  5519        MOVE ' CERTIFICATE NOT FOUND ' TO BL-MESSAGE
  5520        SET BL-FAIL TO TRUE
  5521     END-IF
  5522     .
  5523 0200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  97
* NSRASBL.cbl
  5524     EXIT.
  5525 0300-DATA-SRCE-3.
  5526     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5527     MOVE WS-COMPANY-CD          TO WS-ERCOMP-COMPANY-CD
  5528     MOVE BL-CARRIER             TO WS-ERCOMP-CARRIER
  5529     MOVE BL-GROUP               TO WS-ERCOMP-GROUP
  5530     MOVE BL-RESP-NO             TO WS-ERCOMP-RESP-NO
  5531     MOVE BL-ACCOUNT             TO WS-ERCOMP-ACCOUNT
  5532     IF WS-ERCOMP-ACCOUNT = SPACES
  5533        MOVE LOW-VALUES          TO WS-ERCOMP-ACCOUNT
  5534        MOVE 'G'                 TO WS-ERCOMP-REC-TYPE
  5535     ELSE
  5536        MOVE 'A'                 TO WS-ERCOMP-REC-TYPE
  5537     END-IF
  5538     PERFORM 1225-GET-ERCOMP     THRU 1225-EXIT
  5539     IF RESP-NORMAL
  5540        MOVE CO-CSR-CODE         TO WS-CSR-ID
  5541        PERFORM 1025-GET-CSR-INFO
  5542                                 THRU 1025-EXIT
  5543        SET BL-OK TO TRUE
  5544     ELSE
  5545        MOVE ' COMPENSATION MASTER NOT FOUND ' TO BL-MESSAGE
  5546        SET BL-FAIL TO TRUE
  5547     END-IF
  5548     .
  5549 0300-EXIT.
  5550     EXIT.
  5551 0400-DATA-SRCE-4.
  5552     MOVE WS-COMPANY-CD          TO WS-ERPNDB-COMPANY-CD
  5553     MOVE BL-BATCH-NO            TO WS-ERPNDB-BATCH-NO
  5554     MOVE BL-BATCH-SEQ           TO WS-ERPNDB-BATCH-SEQ
  5555     MOVE +0                     TO WS-ERPNDB-CHG-SEQ
  5556     MOVE ' '                    TO WS-ERPNDB-SW WS-ERACCT-SW
  5557                                    WS-ELCERT-SW WS-ERENDT-SW
  5558
  5559* EXEC CICS READ
  5560*         DATASET    ('ERPNDB')
  5561*         INTO       (PENDING-BUSINESS)
  5562*         RIDFLD     (WS-ERPNDB-KEY)
  5563*         RESP       (WS-RESPONSE)
  5564*    END-EXEC
  5565     MOVE LENGTH OF
  5566      PENDING-BUSINESS
  5567       TO DFHEIV11
  5568     MOVE 'ERPNDB' TO DFHEIV1
  5569*    MOVE '&"IL       E          (  N#00005541' TO DFHEIV0
  5570     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5571     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5572     MOVE X'204E233030303035353431' TO DFHEIV0(25:11)
  5573     CALL 'kxdfhei1' USING DFHEIV0,
  5574           DFHEIV1,
  5575           PENDING-BUSINESS,
  5576           DFHEIV11,
  5577           WS-ERPNDB-KEY,
  5578           DFHEIV99,
  5579           DFHEIV99,
  5580           DFHEIV99
  5581     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  98
* NSRASBL.cbl
  5582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5583     IF RESP-NORMAL
  5584        IF PB-RECORD-TYPE = '1' OR '2'
  5585           MOVE PB-CARRIER       TO BL-CARRIER
  5586           MOVE PB-GROUPING      TO BL-GROUP
  5587           MOVE PB-STATE         TO BL-STATE
  5588           MOVE PB-ACCOUNT       TO BL-ACCOUNT
  5589           MOVE PB-CERT-NO       TO BL-CERT-NO
  5590           MOVE PB-CSR-ID        TO WS-CSR-ID
  5591           IF PB-ISSUE
  5592              SET PROCESS-ISSUE TO TRUE
  5593              MOVE PB-I-LF-BENEFIT-CD TO WS-LF-BENCD
  5594              MOVE PB-I-AH-BENEFIT-CD TO WS-AH-BENCD
  5595              MOVE PB-I-LF-PREM-CALC TO OUT-LF-CALC-PRM
  5596              MOVE PB-I-AH-PREM-CALC TO OUT-AH-CALC-PRM
  5597           ELSE
  5598              SET PROCESS-CANCEL TO TRUE
  5599              MOVE PB-CI-LF-BENEFIT-CD TO WS-LF-BENCD
  5600              MOVE PB-CI-AH-BENEFIT-CD TO WS-AH-BENCD
  5601              MOVE PB-C-LF-REF-CALC TO OUT-LF-CALC-REF
  5602              MOVE PB-C-AH-REF-CALC TO OUT-AH-CALC-REF
  5603           END-IF
  5604           PERFORM 1120-MATCH-CARRIER
  5605                                 THRU 1120-EXIT
  5606           PERFORM 1125-MATCH-STATE
  5607                                 THRU 1125-EXIT
  5608           PERFORM 1130-MATCH-BENCDS
  5609                                 THRU 1130-EXIT
  5610           MOVE WS-LF-ABBRV      TO OUT-LF-ABBRV
  5611           MOVE WS-LF-DESC       TO OUT-LF-DESC
  5612                                    OUT-ORIG-LF-DESC
  5613           IF WS-LF-EARN = 'B'
  5614              MOVE 'B'           TO OUT-BALLOON-IND
  5615           END-IF
  5616           MOVE WS-WAIT-PER      TO OUT-WAIT-PER
  5617                                    OUT-ORIG-WAIT-PER
  5618           MOVE WS-RET-ELIM      TO OUT-RET-ELIM
  5619                                    OUT-ORIG-RET-ELIM
  5620           MOVE WS-AH-DESC       TO OUT-AH-DESC
  5621                                    OUT-ORIG-AH-DESC
  5622           MOVE WS-BEN-DAYS      TO OUT-BEN-DAYS
  5623                                    OUT-ORIG-BEN-DAYS
  5624           PERFORM 1025-GET-CSR-INFO
  5625                                 THRU 1025-EXIT
  5626
  5627           MOVE LOW-VALUES       TO WS-ERACCT-KEY
  5628           MOVE PB-CONTROL-BY-ACCOUNT (1:22)
  5629                                 TO WS-ERACCT-KEY (1:22)
  5630           MOVE PB-CERT-EFF-DT   TO WS-CERT-EFF-DT
  5631           PERFORM 1200-GET-ERACCT THRU 1200-EXIT
  5632           IF ACCT-FOUND
  5633              MOVE AM-CSR-CODE      TO WS-CSR-ID
  5634              PERFORM 1025-GET-CSR-INFO
  5635                                    THRU 1025-EXIT
  5636              PERFORM 1300-DETERMINE-COMM
  5637                                    THRU 1300-EXIT
  5638           END-IF
  5639
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page  99
* NSRASBL.cbl
  5640           MOVE PB-CONTROL-BY-ACCOUNT (1:33)
  5641                                 TO WS-ELCERT-KEY
  5642           PERFORM 1100-GET-ELCERT
  5643                                 THRU 1100-EXIT
  5644
  5645           IF BL-ENDT-ARCH-NO > ZERO
  5646              MOVE PB-COMPANY-CD   TO WS-ERENDT-COMPANY-CD-A1
  5647              MOVE BL-ENDT-ARCH-NO TO WS-ERENDT-ARCHIVE
  5648              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5649           ELSE
  5650              IF BL-ARCHIVE-NO > ZERO
  5651                 MOVE PB-COMPANY-CD TO WS-ERENDT-COMPANY-CD-A1
  5652                 MOVE BL-ARCHIVE-NO TO WS-ERENDT-ARCHIVE
  5653                 PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5654              END-IF
  5655           END-IF
  5656
  5657           SET BL-OK TO TRUE
  5658           IF (PB-STATE = 'KY' OR 'MD' OR 'WI')
  5659              AND (OUT-BALLOON-IND = 'B')
  5660              MOVE 'B'           TO OUT-FORM (3:1)
  5661           END-IF
  5662        END-IF
  5663     END-IF
  5664     .
  5665 0400-EXIT.
  5666     EXIT.
  5667 0500-SCRUB-DATA.
  5668*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  5669*   A DIFFERENT DELIMITER IN PROGRAM NSRASLTR BUT
  5670*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  5671*   TO A HEX 26 TO GET BY THE DECODER
  5672     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  5673                                 TO M1
  5674     MOVE OUT-ACCT-NAME          TO WS-WORK-FIELD
  5675     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5676        (A1 > M1)
  5677        OR (WS-WORK-FIELD (A1:1) = '*')
  5678        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  5679        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  5680     END-PERFORM
  5681     IF A1 > M1
  5682        CONTINUE
  5683     ELSE
  5684        MOVE WS-WORK-FIELD (1:A1 - 1)
  5685                                 TO OUT-ACCT-NAME
  5686     END-IF
  5687     MOVE FUNCTION LENGTH(OUT-BENE-NAME)
  5688                                 TO M1
  5689     MOVE OUT-BENE-NAME          TO WS-WORK-FIELD
  5690     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5691        (A1 > M1)
  5692        OR (WS-WORK-FIELD (A1:1) = '*')
  5693        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  5694        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  5695     END-PERFORM
  5696     IF A1 > M1
  5697        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 100
* NSRASBL.cbl
  5698     ELSE
  5699        MOVE WS-WORK-FIELD (1:A1 - 1)
  5700                                 TO OUT-BENE-NAME
  5701     END-IF
  5702     IF OUT-CERT-NO = LOW-VALUES OR SPACES
  5703         MOVE '0000000000 '  TO OUT-CERT-NO
  5704     END-IF
  5705     MOVE +1 TO M1
  5706     MOVE SPACES TO BL-RECORD-PASSED-DATA
  5707     MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  5708                                 TO NS-LEN
  5709     display ' naper output data length ' ns-len
  5710     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5711        (NAPER-OUTPUT-DATA (A1:11) = 'EndOfString')
  5712        OR (A1 > NS-LEN)
  5713        IF NAPER-OUTPUT-DATA (A1:3) = SPACES
  5714           CONTINUE
  5715        ELSE
  5716           IF NAPER-OUTPUT-DATA (A1:1) = '~'
  5717              MOVE '&'           TO BL-RECORD-PASSED-DATA (M1:1)
  5718              MOVE ' '           TO NAPER-OUTPUT-DATA (A1:1)
  5719              ADD +1 TO M1
  5720           ELSE
  5721              IF NAPER-OUTPUT-DATA (A1:1) = '&'
  5722                 MOVE '%26'      TO BL-RECORD-PASSED-DATA (M1:3)
  5723                 ADD +3 TO M1
  5724              ELSE
  5725                 MOVE NAPER-OUTPUT-DATA (A1:1)
  5726                                 TO BL-RECORD-PASSED-DATA (M1:1)
  5727                 ADD +1 TO M1
  5728              END-IF
  5729           END-IF
  5730        END-IF
  5731     END-PERFORM
  5732     .
  5733 0500-EXIT.
  5734     EXIT.
  5735 0600-GET-ERENDT.
  5736
  5737* EXEC CICS READ
  5738*         DATASET    ('ERENDT2')
  5739*         INTO       (ENDORSEMENT-RECORD)
  5740*         RIDFLD     (WS-ERENDT-KEY-BY-ARCH)
  5741*         RESP       (WS-RESPONSE)
  5742*    END-EXEC
  5743     MOVE LENGTH OF
  5744      ENDORSEMENT-RECORD
  5745       TO DFHEIV11
  5746     MOVE 'ERENDT2' TO DFHEIV1
  5747*    MOVE '&"IL       E          (  N#00005700' TO DFHEIV0
  5748     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5749     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5750     MOVE X'204E233030303035373030' TO DFHEIV0(25:11)
  5751     CALL 'kxdfhei1' USING DFHEIV0,
  5752           DFHEIV1,
  5753           ENDORSEMENT-RECORD,
  5754           DFHEIV11,
  5755           WS-ERENDT-KEY-BY-ARCH,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 101
* NSRASBL.cbl
  5756           DFHEIV99,
  5757           DFHEIV99,
  5758           DFHEIV99
  5759     MOVE EIBRESP  TO WS-RESPONSE
  5760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5761     DISPLAY ' JUST READ ENDT ' WS-RESPONSE ' '
  5762         WS-ERENDT-ARCHIVE
  5763     IF (RESP-NORMAL)
  5764        SET ENDT-FOUND TO TRUE
  5765        PERFORM 0620-BUILD-ENDT  THRU 0620-EXIT
  5766        PERFORM 0650-PROCESS-NO-Change
  5767                                 THRU 0650-EXIT
  5768     END-IF
  5769     .
  5770 0600-EXIT.
  5771     EXIT.
  5772 0620-BUILD-ENDT.
  5773     MOVE SPACES                 TO OUT-ORIG-LF-CAN-DT
  5774                                    OUT-NEW-LF-CAN-DT
  5775                                    OUT-ORIG-AH-CAN-DT
  5776                                    OUT-NEW-AH-CAN-DT
  5777                                    OUT-ORIG-CAN-DT
  5778                                    OUT-NEW-CAN-DT
  5779     IF EN-REC-TYPE = 'C'
  5780        GO TO 0620-PROCESS-CANCEL
  5781     END-IF
  5782     MOVE EN-LF-ORIG-BENCD       TO WS-LF-BENCD
  5783     MOVE EN-AH-ORIG-BENCD       TO WS-AH-BENCD
  5784     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  5785     MOVE WS-LF-DESC             TO OUT-ORIG-LF-DESC
  5786     IF WS-LF-EARN = 'B'
  5787        MOVE 'B'                 TO OUT-BALLOON-IND
  5788     END-IF
  5789     MOVE WS-AH-DESC             TO OUT-ORIG-AH-DESC
  5790     MOVE WS-RET-ELIM            TO OUT-ORIG-RET-ELIM
  5791     MOVE WS-BEN-DAYS            TO OUT-ORIG-BEN-DAYS
  5792     MOVE WS-WAIT-PER            TO OUT-ORIG-WAIT-PER
  5793     MOVE EN-INS-ORIG-LAST-NAME    TO OUT-ORIG-ILNAME
  5794     MOVE EN-INS-ORIG-FIRST-NAME   TO OUT-ORIG-IFNAME
  5795     MOVE EN-INS-ORIG-MIDDLE-INIT  TO OUT-ORIG-MINIT
  5796     MOVE EN-INS-ORIG-AGE          TO OUT-ORIG-IAGE
  5797     MOVE EN-JNT-ORIG-LAST-NAME    TO OUT-ORIG-JLNAME
  5798     MOVE EN-JNT-ORIG-FIRST-NAME   TO OUT-ORIG-JFNAME
  5799     MOVE EN-JNT-ORIG-MIDDLE-INIT  TO OUT-ORIG-JMINIT
  5800     MOVE EN-JNT-ORIG-AGE          TO OUT-ORIG-JAGE
  5801     MOVE EN-LF-ORIG-BENCD         TO OUT-ORIG-LF-BENCD
  5802     MOVE EN-LF-ORIG-TERM          TO OUT-ORIG-LF-TERM
  5803     MOVE EN-LF-ORIG-BEN-AMT       TO OUT-ORIG-LF-BEN
  5804     MOVE EN-LF-ORIG-PRM-AMT       TO OUT-ORIG-LF-PRM
  5805     MOVE EN-LF-ORIG-ALT-BEN-AMT   TO OUT-ORIG-LF-ALT-BEN
  5806     MOVE EN-LF-ORIG-ALT-PRM-AMT   TO OUT-ORIG-LF-ALT-PRM
  5807     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  5808                             EN-LF-ORIG-ALT-PRM-AMT
  5809     MOVE WS-WRK-AMOUNT          TO OUT-ORIG-LF-CMB-PREM
  5810     IF EN-LF-ORIG-BENCD EQUAL '00' OR SPACES
  5811         MOVE SPACES             TO OUT-ORIG-LF-BEN-A
  5812                                    OUT-ORIG-LF-PRM-A
  5813                                    OUT-ORIG-LF-ALT-BEN-A
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 102
* NSRASBL.cbl
  5814                                    OUT-ORIG-LF-ALT-PRM-A
  5815                                    OUT-ORIG-COVERAGE-IND
  5816     ELSE
  5817         MOVE 'LIFE'             TO OUT-ORIG-COVERAGE-IND
  5818     END-IF
  5819     MOVE EN-LF-ORIG-EXP-DT      TO DC-BIN-DATE-1
  5820     MOVE ' '                    TO DC-OPTION-CODE
  5821     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5822     IF NO-CONVERSION-ERROR
  5823        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5824           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5825              INTO OUT-ORIG-LF-EXP-DT
  5826        END-STRING
  5827     END-IF
  5828     MOVE EN-AH-ORIG-BENCD       TO OUT-ORIG-AH-BENCD
  5829     MOVE EN-AH-ORIG-TERM        TO OUT-ORIG-AH-TERM
  5830     MOVE EN-AH-ORIG-BEN-AMT     TO OUT-ORIG-AH-BEN
  5831     MOVE EN-AH-ORIG-PRM-AMT     TO OUT-ORIG-AH-PRM
  5832     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  5833         MOVE SPACES             TO OUT-ORIG-AH-BEN-A
  5834                                    OUT-ORIG-AH-PRM-A
  5835     ELSE
  5836        IF OUT-ORIG-COVERAGE-IND = 'LIFE'
  5837            MOVE 'BOTH'          TO OUT-ORIG-COVERAGE-IND
  5838        ELSE
  5839            MOVE 'AH  '          TO OUT-ORIG-COVERAGE-IND
  5840        END-IF
  5841     END-IF
  5842     COMPUTE WS-WORK-PREM =
  5843        EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT
  5844           + EN-AH-ORIG-PRM-AMT
  5845     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-PREM
  5846     MOVE EN-AH-ORIG-EXP-DT      TO DC-BIN-DATE-1
  5847     MOVE ' '                    TO DC-OPTION-CODE
  5848     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5849     IF NO-CONVERSION-ERROR
  5850        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5851           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5852              INTO OUT-ORIG-AH-EXP-DT
  5853        END-STRING
  5854     END-IF
  5855     MOVE EN-AH-ORIG-CP          TO OUT-ORIG-CRIT-PER
  5856                                    OUT-ORIG-MAX-PMTS
  5857     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  5858         MOVE SPACES             TO OUT-ORIG-MAX-PMTS-A
  5859     END-IF
  5860     MOVE EN-INS-NEW-LAST-NAME    TO OUT-NEW-ILNAME
  5861     MOVE EN-INS-NEW-FIRST-NAME   TO OUT-NEW-IFNAME
  5862     MOVE EN-INS-NEW-MIDDLE-INIT  TO OUT-NEW-IMINIT
  5863     MOVE EN-INS-NEW-AGE          TO OUT-NEW-IAGE
  5864     MOVE EN-JNT-NEW-LAST-NAME    TO OUT-NEW-JLNAME
  5865     MOVE EN-JNT-NEW-FIRST-NAME   TO OUT-NEW-JFNAME
  5866     MOVE EN-JNT-NEW-MIDDLE-INIT  TO OUT-NEW-JMINIT
  5867     MOVE EN-JNT-NEW-AGE          TO OUT-NEW-JAGE
  5868     MOVE EN-LF-NEW-BENCD        TO WS-LF-BENCD
  5869     MOVE EN-AH-NEW-BENCD        TO WS-AH-BENCD
  5870     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  5871     MOVE WS-LF-DESC             TO OUT-NEW-LF-DESC
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 103
* NSRASBL.cbl
  5872     IF WS-LF-EARN = 'B'
  5873        MOVE 'B'                 TO OUT-BALLOON-IND
  5874     END-IF
  5875     MOVE WS-AH-DESC             TO OUT-NEW-AH-DESC
  5876     MOVE WS-RET-ELIM            TO OUT-NEW-RET-ELIM
  5877     MOVE WS-BEN-DAYS            TO OUT-NEW-BEN-DAYS
  5878     MOVE WS-WAIT-PER            TO OUT-NEW-WAIT-PER
  5879     MOVE EN-LF-NEW-BENCD         TO OUT-NEW-LF-BENCD
  5880     MOVE EN-LF-NEW-TERM          TO OUT-NEW-LF-TERM
  5881     MOVE EN-LF-NEW-BEN-AMT       TO OUT-NEW-LF-BEN
  5882     MOVE EN-LF-NEW-PRM-AMT       TO OUT-NEW-LF-PRM
  5883     MOVE EN-LF-NEW-ALT-BEN-AMT   TO OUT-NEW-LF-ALT-BEN
  5884     MOVE EN-LF-NEW-ALT-PRM-AMT   TO OUT-NEW-LF-ALT-PRM
  5885     COMPUTE WS-WRK-AMOUNT = EN-LF-NEW-PRM-AMT +
  5886                             EN-LF-NEW-ALT-PRM-AMT
  5887     MOVE WS-WRK-AMOUNT           TO OUT-NEW-LF-CMB-PREM
  5888     IF EN-LF-NEW-BENCD EQUAL '00' OR SPACES
  5889         MOVE SPACES             TO OUT-NEW-LF-BEN-A
  5890                                    OUT-NEW-LF-PRM-A
  5891                                    OUT-NEW-LF-ALT-BEN-A
  5892                                    OUT-NEW-LF-ALT-PRM-A
  5893                                    OUT-NEW-LF-CMB-PREM-A
  5894                                    OUT-NEW-COVERAGE-IND
  5895     ELSE
  5896         MOVE 'LIFE'             TO OUT-NEW-COVERAGE-IND
  5897     END-IF
  5898    MOVE EN-LF-NEW-EXP-DT        TO DC-BIN-DATE-1
  5899     MOVE ' '                     TO DC-OPTION-CODE
  5900     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  5901     IF NO-CONVERSION-ERROR
  5902        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5903           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5904              INTO OUT-NEW-LF-EXP-DT
  5905        END-STRING
  5906     END-IF
  5907     MOVE EN-AH-NEW-BENCD         TO OUT-NEW-AH-BENCD
  5908     MOVE EN-AH-NEW-TERM          TO OUT-NEW-AH-TERM
  5909     MOVE EN-AH-NEW-BEN-AMT       TO OUT-NEW-AH-BEN
  5910     MOVE EN-AH-NEW-PRM-AMT       TO OUT-NEW-AH-PRM
  5911     COMPUTE WS-WORK-PREM =
  5912        EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT
  5913           + EN-AH-NEW-PRM-AMT
  5914     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-PREM
  5915     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  5916         MOVE SPACES             TO OUT-NEW-AH-BEN-A
  5917                                    OUT-NEW-AH-PRM-A
  5918     ELSE
  5919        IF OUT-NEW-COVERAGE-IND = 'LIFE'
  5920            MOVE 'BOTH'          TO OUT-NEW-COVERAGE-IND
  5921        ELSE
  5922            MOVE 'AH  '          TO OUT-NEW-COVERAGE-IND
  5923        END-IF
  5924     END-IF
  5925     MOVE EN-AH-NEW-EXP-DT        TO DC-BIN-DATE-1
  5926     MOVE ' '                     TO DC-OPTION-CODE
  5927     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  5928     IF NO-CONVERSION-ERROR
  5929        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 104
* NSRASBL.cbl
  5930           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5931              INTO OUT-NEW-AH-EXP-DT
  5932        END-STRING
  5933     END-IF
  5934     MOVE EN-AH-NEW-CP            TO OUT-NEW-CRIT-PER
  5935                                     OUT-NEW-MAX-PMTS
  5936     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  5937         MOVE SPACES             TO OUT-NEW-MAX-PMTS-A
  5938     END-IF
  5939     IF EN-LF-ORIG-EXP-DT > EN-AH-ORIG-EXP-DT
  5940        MOVE OUT-ORIG-LF-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  5941     ELSE
  5942        MOVE OUT-ORIG-AH-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  5943     END-IF
  5944     IF EN-LF-NEW-EXP-DT > EN-AH-NEW-EXP-DT
  5945        MOVE OUT-NEW-LF-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  5946     ELSE
  5947        MOVE OUT-NEW-AH-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  5948     END-IF
  5949     IF EN-LF-ORIG-TERM > EN-AH-ORIG-TERM
  5950        MOVE EN-LF-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  5951     ELSE
  5952        MOVE EN-AH-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  5953     END-IF
  5954     IF EN-LF-NEW-TERM > EN-AH-NEW-TERM
  5955        MOVE EN-LF-NEW-TERM      TO OUT-NEW-SCHED-TERM
  5956     ELSE
  5957        MOVE EN-AH-NEW-TERM      TO OUT-NEW-SCHED-TERM
  5958     END-IF
  5959     COMPUTE WS-WORK-PREM =
  5960        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  5961        EN-AH-NEW-PRM-AMT) -
  5962        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT +
  5963        EN-AH-ORIG-PRM-AMT)
  5964     MOVE WS-WORK-PREM           TO OUT-TOT-PRM-CHG
  5965     IF EN-CSO-PORTION NOT NUMERIC
  5966        MOVE ZEROS               TO EN-CSO-PORTION
  5967     END-IF
  5968     IF EN-ACCT-PORTION NOT NUMERIC
  5969        MOVE ZERO                TO EN-ACCT-PORTION
  5970     END-IF
  5971*    MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  5972*    MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  5973     IF WS-WORK-PREM > +0
  5974        MOVE 'CSO'               TO OUT-PAYEE
  5975     ELSE
  5976      IF WS-WORK-PREM = +0
  5977         MOVE 'ZERO'             TO OUT-PAYEE
  5978      ELSE
  5979         MOVE 'ACCT'             TO OUT-PAYEE
  5980      END-IF
  5981     END-IF
  5982     COMPUTE WS-ACCT-ORIG-LF-PORT =
  5983        EN-LF-ORIG-PRM-AMT * EN-LF-ORIG-COMM-PCT
  5984     MOVE WS-ACCT-ORIG-LF-PORT TO OUT-ACCT-ORIG-LF-PORT
  5985     COMPUTE WS-ACCT-ORIG-ALT-LF-PORT =
  5986        EN-LF-ORIG-ALT-PRM-AMT * EN-LF-ORIG-COMM-PCT
  5987     MOVE WS-ACCT-ORIG-ALT-LF-PORT TO OUT-ACCT-ORIG-ALT-LF-PORT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 105
* NSRASBL.cbl
  5988     COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  5989        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  5990        * EN-LF-ORIG-COMM-PCT
  5991     MOVE WS-ACCT-ORIG-CMB-LF-PORT TO OUT-ACCT-ORIG-CMB-LF-PORT
  5992     COMPUTE WS-ACCT-ORIG-AH-PORT =
  5993        EN-AH-ORIG-PRM-AMT * EN-AH-ORIG-COMM-PCT
  5994     MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  5995     COMPUTE WS-ACCT-ORIG-PORTION =
  5996        WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  5997     MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  5998
  5999     COMPUTE WS-CSO-ORIG-LF-PORT =
  6000       EN-LF-ORIG-PRM-AMT - WS-ACCT-ORIG-LF-PORT
  6001     MOVE WS-CSO-ORIG-LF-PORT TO OUT-CSO-ORIG-LF-PORT
  6002     COMPUTE WS-CSO-ORIG-ALT-LF-PORT =
  6003       EN-LF-ORIG-ALT-PRM-AMT - WS-ACCT-ORIG-ALT-LF-PORT
  6004     MOVE WS-CSO-ORIG-ALT-LF-PORT TO OUT-CSO-ORIG-ALT-LF-PORT
  6005     COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6006       (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6007        WS-ACCT-ORIG-CMB-LF-PORT
  6008     MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6009     COMPUTE WS-CSO-ORIG-AH-PORT =
  6010        EN-AH-ORIG-PRM-AMT - WS-ACCT-ORIG-AH-PORT
  6011     MOVE WS-CSO-ORIG-AH-PORT TO OUT-CSO-ORIG-AH-PORT
  6012     COMPUTE WS-CSO-ORIG-PORTION =
  6013        WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6014     MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6015     COMPUTE WS-ACCT-NEW-LF-PORT =
  6016        EN-LF-NEW-PRM-AMT * EN-LF-NEW-COMM-PCT
  6017     MOVE WS-ACCT-NEW-LF-PORT TO OUT-ACCT-NEW-LF-PORT
  6018     COMPUTE WS-ACCT-NEW-ALT-LF-PORT =
  6019        EN-LF-NEW-ALT-PRM-AMT * EN-LF-NEW-COMM-PCT
  6020     MOVE WS-ACCT-NEW-ALT-LF-PORT TO OUT-ACCT-NEW-ALT-LF-PORT
  6021     COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6022        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT)
  6023        * EN-LF-NEW-COMM-PCT
  6024     MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6025     COMPUTE WS-ACCT-NEW-AH-PORT =
  6026        EN-AH-NEW-PRM-AMT * EN-AH-NEW-COMM-PCT
  6027     MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6028     COMPUTE WS-ACCT-NEW-PORTION =
  6029        WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6030     MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6031
  6032     COMPUTE WS-CSO-NEW-LF-PORT =
  6033       EN-LF-NEW-PRM-AMT - WS-ACCT-NEW-LF-PORT
  6034     MOVE WS-CSO-NEW-LF-PORT TO OUT-CSO-NEW-LF-PORT
  6035     COMPUTE WS-CSO-NEW-ALT-LF-PORT =
  6036       EN-LF-NEW-ALT-PRM-AMT - WS-ACCT-NEW-ALT-LF-PORT
  6037     MOVE WS-CSO-NEW-ALT-LF-PORT TO OUT-CSO-NEW-ALT-LF-PORT
  6038     COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6039       (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6040        WS-ACCT-NEW-CMB-LF-PORT
  6041     MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6042     COMPUTE WS-CSO-NEW-AH-PORT =
  6043        EN-AH-NEW-PRM-AMT - WS-ACCT-NEW-AH-PORT
  6044     MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6045     COMPUTE WS-CSO-NEW-PORTION =
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 106
* NSRASBL.cbl
  6046        WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6047     MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6048
  6049     COMPUTE WS-ACCT-LF-PORT-CHG =
  6050        WS-ACCT-NEW-LF-PORT - WS-ACCT-ORIG-LF-PORT
  6051     MOVE WS-ACCT-LF-PORT-CHG TO OUT-ACCT-LF-PORT-CHG
  6052     COMPUTE WS-ACCT-ALT-LF-PORT-CHG =
  6053        WS-ACCT-NEW-ALT-LF-PORT - WS-ACCT-ORIG-ALT-LF-PORT
  6054     MOVE WS-ACCT-ALT-LF-PORT-CHG TO OUT-ACCT-ALT-LF-PORT-CHG
  6055     COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6056        WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6057     MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6058     COMPUTE WS-ACCT-AH-PORT-CHG =
  6059        WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6060     MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6061     COMPUTE WS-ACCT-PORTION-CHG =
  6062        WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6063     MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6064
  6065     COMPUTE WS-CSO-LF-PORT-CHG =
  6066        WS-CSO-NEW-LF-PORT - WS-CSO-ORIG-LF-PORT
  6067     MOVE WS-CSO-LF-PORT-CHG TO OUT-CSO-LF-PORT-CHG
  6068     COMPUTE WS-CSO-ALT-LF-PORT-CHG =
  6069        WS-CSO-NEW-ALT-LF-PORT - WS-CSO-ORIG-ALT-LF-PORT
  6070     MOVE WS-CSO-ALT-LF-PORT-CHG TO OUT-CSO-ALT-LF-PORT-CHG
  6071     COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6072        WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6073     MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6074     COMPUTE WS-CSO-AH-PORT-CHG =
  6075        WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6076     MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6077     COMPUTE WS-CSO-PORTION-CHG =
  6078        WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6079     MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6080
  6081     COMPUTE WS-WORK-PREM =
  6082         EN-LF-NEW-PRM-AMT - EN-LF-ORIG-PRM-AMT
  6083     MOVE WS-WORK-PREM           TO OUT-LF-PREM-CHG
  6084     COMPUTE WS-WORK-PREM =
  6085         EN-LF-NEW-ALT-PRM-AMT - EN-LF-ORIG-ALT-PRM-AMT
  6086     MOVE WS-WORK-PREM           TO OUT-LF-ALT-PREM-CHG
  6087     COMPUTE WS-WORK-PREM =
  6088        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6089        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6090     MOVE WS-WORK-PREM           TO OUT-LF-CMB-PREM-CHG
  6091     COMPUTE WS-WORK-PREM =
  6092        (EN-AH-NEW-PRM-AMT - EN-AH-ORIG-PRM-AMT)
  6093     MOVE WS-WORK-PREM           TO OUT-AH-PREM-CHG
  6094
  6095     move en-sig-sw              to out-sig-sw
  6096     MOVE EN-HEALTH-APP          TO OUT-HEALTH-APP
  6097     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6098     GO TO 0620-CONTINUE
  6099     .
  6100 0620-PROCESS-CANCEL.
  6101     IF EN-LF-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6102        MOVE EN-LF-ORIG-REF-DT   TO DC-BIN-DATE-1
  6103        MOVE ' '                 TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 107
* NSRASBL.cbl
  6104        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6105        IF NO-CONVERSION-ERROR
  6106           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6107              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6108                 INTO OUT-ORIG-LF-CAN-DT
  6109           END-STRING
  6110        END-IF
  6111        MOVE OUT-ORIG-LF-CAN-DT  TO OUT-ORIG-CAN-DT
  6112     END-IF
  6113
  6114     IF EN-LF-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6115        MOVE EN-LF-NEW-REF-DT    TO DC-BIN-DATE-1
  6116        MOVE ' '                 TO DC-OPTION-CODE
  6117        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6118        IF NO-CONVERSION-ERROR
  6119           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6120              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6121                 INTO OUT-NEW-LF-CAN-DT
  6122           END-STRING
  6123        END-IF
  6124        MOVE OUT-NEW-LF-CAN-DT   TO OUT-NEW-CAN-DT
  6125     END-IF
  6126
  6127     IF EN-AH-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6128        MOVE EN-AH-ORIG-REF-DT      TO DC-BIN-DATE-1
  6129        MOVE ' '                    TO DC-OPTION-CODE
  6130        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6131        IF NO-CONVERSION-ERROR
  6132           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6133              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6134                 INTO OUT-ORIG-AH-CAN-DT
  6135           END-STRING
  6136        END-IF
  6137        IF EN-AH-ORIG-REF-DT > EN-LF-ORIG-REF-DT
  6138           MOVE OUT-ORIG-AH-CAN-DT  TO OUT-ORIG-CAN-DT
  6139        END-IF
  6140     END-IF
  6141
  6142     IF EN-AH-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6143        MOVE EN-AH-NEW-REF-DT       TO DC-BIN-DATE-1
  6144        MOVE ' '                    TO DC-OPTION-CODE
  6145        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6146        IF NO-CONVERSION-ERROR
  6147           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6148              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6149                 INTO OUT-NEW-AH-CAN-DT
  6150           END-STRING
  6151        END-IF
  6152        IF EN-AH-NEW-REF-DT > EN-LF-NEW-REF-DT
  6153           MOVE OUT-NEW-AH-CAN-DT  TO OUT-NEW-CAN-DT
  6154        END-IF
  6155     END-IF
  6156     MOVE EN-LF-ORIG-REF-AMT     TO OUT-ORIG-LF-REF
  6157     MOVE EN-AH-ORIG-REF-AMT     TO OUT-ORIG-AH-REF
  6158     MOVE EN-LF-NEW-REF-AMT      TO OUT-NEW-LF-REF
  6159     MOVE EN-AH-NEW-REF-AMT      TO OUT-NEW-AH-REF
  6160     COMPUTE WS-WORK-PREM =
  6161        EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 108
* NSRASBL.cbl
  6162     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-REF
  6163     COMPUTE WS-WORK-PREM =
  6164        EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6165     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-REF
  6166     COMPUTE WS-WORK-PREM =
  6167        (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6168        (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6169     MOVE WS-WORK-PREM           TO OUT-TOT-REF-CHG
  6170
  6171     COMPUTE WS-WORK-PREM =
  6172        (EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT)
  6173     MOVE WS-WORK-PREM           TO OUT-LF-REF-CHG
  6174     COMPUTE WS-WORK-PREM =
  6175        (EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT)
  6176     MOVE WS-WORK-PREM           TO OUT-AH-REF-CHG
  6177
  6178*     MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6179*     MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6180     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6181
  6182     IF EN-COMM-CHGBK = 'N'
  6183         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6184                                   OUT-CSO-ORIG-ALT-LF-PORT
  6185         MOVE EN-LF-ORIG-REF-AMT TO OUT-CSO-ORIG-CMB-LF-PORT
  6186         MOVE EN-AH-ORIG-REF-AMT TO OUT-CSO-ORIG-AH-PORT
  6187         COMPUTE WS-CSO-ORIG-PORTION =
  6188             EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6189         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6190         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6191                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6192                                   OUT-ACCT-ORIG-CMB-LF-PORT
  6193                                   OUT-ACCT-ORIG-AH-PORT
  6194                                   OUT-ACCT-ORIG-PORTION
  6195
  6196         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6197                                   OUT-CSO-NEW-ALT-LF-PORT
  6198         MOVE EN-LF-NEW-REF-AMT TO OUT-CSO-NEW-CMB-LF-PORT
  6199         MOVE EN-AH-NEW-REF-AMT TO OUT-CSO-NEW-AH-PORT
  6200         COMPUTE WS-CSO-NEW-PORTION =
  6201             EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6202         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6203         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6204                                   OUT-ACCT-NEW-ALT-LF-PORT
  6205                                   OUT-ACCT-NEW-CMB-LF-PORT
  6206                                   OUT-ACCT-NEW-AH-PORT
  6207                                   OUT-ACCT-NEW-PORTION
  6208
  6209         MOVE ZERO              TO OUT-CSO-LF-PORT-CHG
  6210                                   OUT-CSO-ALT-LF-PORT-CHG
  6211         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6212           EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT
  6213         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6214         COMPUTE WS-CSO-AH-PORT-CHG =
  6215           EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT
  6216         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6217         COMPUTE WS-CSO-PORTION-CHG =
  6218           (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6219           (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 109
* NSRASBL.cbl
  6220         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6221         MOVE ZERO              TO OUT-ACCT-LF-PORT-CHG
  6222                                   OUT-ACCT-ALT-LF-PORT-CHG
  6223                                   OUT-ACCT-CMB-LF-PORT-CHG
  6224                                   OUT-ACCT-AH-PORT-CHG
  6225                                   OUT-ACCT-PORTION-CHG
  6226     ELSE
  6227         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6228                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6229         COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6230           (EN-LF-ORIG-REF-AMT * EN-LF-ORIG-REF-COMM-PCT)
  6231         MOVE WS-ACCT-ORIG-CMB-LF-PORT TO
  6232                                  OUT-ACCT-ORIG-CMB-LF-PORT
  6233         COMPUTE WS-ACCT-ORIG-AH-PORT =
  6234           (EN-AH-ORIG-REF-AMT * EN-AH-ORIG-REF-COMM-PCT)
  6235         MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6236         COMPUTE WS-ACCT-ORIG-PORTION =
  6237            WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6238         MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6239
  6240         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6241                                   OUT-CSO-ORIG-ALT-LF-PORT
  6242         COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6243           (EN-LF-ORIG-REF-AMT - WS-ACCT-ORIG-CMB-LF-PORT)
  6244         MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6245         COMPUTE WS-CSO-ORIG-AH-PORT =
  6246           (EN-AH-ORIG-REF-AMT - WS-ACCT-ORIG-AH-PORT)
  6247         MOVE WS-CSO-AH-PORTION  TO OUT-CSO-ORIG-AH-PORT
  6248         COMPUTE WS-CSO-ORIG-PORTION =
  6249            WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6250         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6251
  6252         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6253                                   OUT-ACCT-NEW-ALT-LF-PORT
  6254         COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6255           (EN-LF-NEW-REF-AMT * EN-LF-NEW-REF-COMM-PCT)
  6256         MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6257         COMPUTE WS-ACCT-NEW-AH-PORT =
  6258           (EN-AH-NEW-REF-AMT * EN-AH-NEW-REF-COMM-PCT)
  6259         MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6260         COMPUTE WS-ACCT-NEW-PORTION =
  6261            WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6262         MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6263
  6264         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6265                                   OUT-CSO-NEW-ALT-LF-PORT
  6266         COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6267           (EN-LF-NEW-REF-AMT - WS-ACCT-NEW-CMB-LF-PORT)
  6268         MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6269         COMPUTE WS-CSO-NEW-AH-PORT =
  6270           (EN-AH-NEW-REF-AMT - WS-ACCT-NEW-AH-PORT)
  6271         MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6272         COMPUTE WS-CSO-NEW-PORTION =
  6273            WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6274         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6275
  6276         MOVE ZERO               TO OUT-ACCT-LF-PORT-CHG
  6277                                    OUT-ACCT-ALT-LF-PORT-CHG
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 110
* NSRASBL.cbl
  6278         COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6279            WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6280         MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6281         COMPUTE WS-ACCT-AH-PORT-CHG =
  6282            WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6283         MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6284         COMPUTE WS-ACCT-PORTION-CHG =
  6285            WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6286         MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6287
  6288         MOVE ZERO               TO OUT-CSO-LF-PORT-CHG
  6289                                    OUT-CSO-ALT-LF-PORT-CHG
  6290         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6291            WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6292         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6293         COMPUTE WS-CSO-AH-PORT-CHG =
  6294            WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6295         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6296         COMPUTE WS-CSO-PORTION-CHG =
  6297            WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6298         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6299
  6300     END-IF
  6301     .
  6302 0620-CONTINUE.
  6303     display ' about to bld reason codes ' en-reason-code (1)
  6304     move en-reason-code (1)     to out-rea-cd1
  6305     move en-reason-code (2)     to out-rea-cd2
  6306     move en-reason-code (3)     to out-rea-cd3
  6307     move en-reason-code (4)     to out-rea-cd4
  6308     move en-reason-code (5)     to out-rea-cd5
  6309     move en-reason-code (6)     to out-rea-cd6
  6310     move en-reason-code (7)     to out-rea-cd7
  6311     move en-reason-code (8)     to out-rea-cd8
  6312     move en-reason-code (9)     to out-rea-cd9
  6313     move en-reason-code (10)    to out-rea-cd10
  6314     move en-reason-code (11)    to out-rea-cd11
  6315     move en-reason-code (12)    to out-rea-cd12
  6316*    PERFORM 1300-DETERMINE-COMM
  6317*                                THRU 1300-EXIT
  6318     .
  6319 0620-EXIT.
  6320     EXIT.
  6321 0650-PROCESS-NO-Change.
  6322     IF EN-REC-TYPE = 'C'
  6323        GO TO 0650-PROCESS-CANCEL
  6324     END-IF
  6325     if ((OUT-NEW-ILNAME = OUT-ORIG-ILNAME)
  6326        AND (OUT-NEW-ILNAME NOT = SPACES))
  6327                      AND
  6328        ((OUT-NEW-IFNAME = OUT-ORIG-IFNAME)
  6329        AND (OUT-NEW-IFNAME NOT = SPACES))
  6330                      AND
  6331        ((OUT-NEW-IMINIT = OUT-ORIG-MINIT)
  6332        AND (OUT-NEW-IFNAME NOT = SPACES))
  6333        move 'No Change'         to out-new-Ifname
  6334        MOVE SPACES              TO OUT-NEW-IMINIT
  6335        move spaces              to out-new-Ilname
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 111
* NSRASBL.cbl
  6336     ELSE
  6337         IF OUT-NEW-ILNAME = SPACES
  6338           AND OUT-NEW-IFNAME = SPACES
  6339           AND OUT-NEW-IMINIT = SPACES
  6340           AND OUT-ORIG-ILNAME NOT = SPACES
  6341            MOVE 'None'          TO OUT-NEW-IFNAME
  6342            MOVE SPACES          TO OUT-NEW-IMINIT
  6343            MOVE SPACES          TO OUT-NEW-ILNAME
  6344         END-IF
  6345     END-IF
  6346     IF ((OUT-NEW-JLNAME = OUT-ORIG-JLNAME)
  6347        AND (OUT-NEW-JLNAME NOT = SPACES))
  6348                    AND
  6349        ((OUT-NEW-JFNAME = OUT-ORIG-JFNAME)
  6350        AND (OUT-NEW-JFNAME NOT = SPACES))
  6351                    AND
  6352        ((OUT-NEW-JMINIT = OUT-ORIG-JMINIT)
  6353        AND (OUT-NEW-JFNAME NOT = SPACES))
  6354        MOVE 'No Change'         TO OUT-NEW-JFNAME
  6355        MOVE SPACES              TO OUT-NEW-JMINIT
  6356        MOVE SPACES              TO OUT-NEW-JLNAME
  6357     ELSE
  6358         IF OUT-NEW-JLNAME = SPACES
  6359           AND OUT-NEW-JFNAME = SPACES
  6360           AND OUT-NEW-JMINIT = SPACES
  6361           AND OUT-ORIG-JLNAME NOT = SPACES
  6362            MOVE 'None'          TO OUT-NEW-JFNAME
  6363            MOVE SPACES          TO OUT-NEW-JMINIT
  6364            MOVE SPACES          TO OUT-NEW-JLNAME
  6365         END-IF
  6366     END-IF
  6367     IF (EN-LF-NEW-BEN-AMT = EN-LF-ORIG-BEN-AMT)
  6368        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6369        MOVE 'No Change'         TO OUT-NEW-LF-BEN-A
  6370     ELSE
  6371         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6372           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6373             MOVE ZEROS          TO OUT-NEW-LF-BEN
  6374         END-IF
  6375     END-IF
  6376     IF (EN-LF-NEW-PRM-AMT = EN-LF-ORIG-PRM-AMT)
  6377        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6378        MOVE 'No Change'         TO OUT-NEW-LF-PRM-A
  6379     ELSE
  6380         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6381           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6382             MOVE ZEROS          TO OUT-NEW-LF-PRM
  6383         END-IF
  6384     END-IF
  6385     IF (EN-LF-NEW-ALT-BEN-AMT = EN-LF-ORIG-ALT-BEN-AMT)
  6386        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6387        MOVE 'No Change'         TO OUT-NEW-LF-ALT-BEN-A
  6388     ELSE
  6389         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6390           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6391             MOVE ZEROS          TO OUT-NEW-LF-ALT-BEN
  6392         END-IF
  6393     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 112
* NSRASBL.cbl
  6394     IF (EN-LF-NEW-ALT-PRM-AMT = EN-LF-ORIG-ALT-PRM-AMT)
  6395        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6396        MOVE 'No Change'         TO OUT-NEW-LF-ALT-PRM-A
  6397     ELSE
  6398         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6399           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6400             MOVE ZEROS          TO OUT-NEW-LF-ALT-PRM
  6401         END-IF
  6402     END-IF
  6403
  6404     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6405                              EN-LF-ORIG-ALT-PRM-AMT
  6406     COMPUTE WS-WRK-AMOUNT2 = EN-LF-NEW-PRM-AMT +
  6407                               EN-LF-NEW-ALT-PRM-AMT
  6408     IF (WS-WRK-AMOUNT2 = WS-WRK-AMOUNT)
  6409        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6410        MOVE 'No Change'         TO OUT-NEW-LF-CMB-PREM-A
  6411     ELSE
  6412         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6413           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6414            MOVE ZEROS          TO OUT-NEW-LF-CMB-PREM
  6415         END-IF
  6416     END-IF
  6417     IF OUT-NEW-SCHED-EXP-DT = OUT-ORIG-SCHED-EXP-DT
  6418        MOVE 'No Change'         TO OUT-NEW-SCHED-EXP-DT
  6419     END-IF
  6420     IF (OUT-NEW-LF-EXP-DT = OUT-ORIG-LF-EXP-DT)
  6421        AND (OUT-NEW-LF-EXP-DT NOT = SPACES)
  6422        MOVE 'No Change'         TO OUT-NEW-LF-EXP-DT
  6423     END-IF
  6424     IF (OUT-NEW-LF-DESC = OUT-ORIG-LF-DESC)
  6425        AND (OUT-NEW-LF-DESC NOT = SPACES)
  6426        MOVE 'No Change'         to OUT-NEW-LF-DESC
  6427     ELSE
  6428        IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6429          AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6430            MOVE 'None'          TO OUT-NEW-LF-DESC
  6431        END-IF
  6432     end-if
  6433     IF (OUT-NEW-AH-EXP-DT = OUT-ORIG-AH-EXP-DT)
  6434       AND (OUT-NEW-AH-EXP-DT NOT = SPACES)
  6435        MOVE 'No Change'          TO OUT-NEW-AH-EXP-DT
  6436     END-IF
  6437     IF (EN-AH-NEW-BEN-AMT = EN-AH-ORIG-BEN-AMT)
  6438        AND (EN-AH-ORIG-BEN-AMT NOT = ZEROS)
  6439        MOVE 'No Change'         TO OUT-NEW-AH-BEN-A
  6440     ELSE
  6441         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6442           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6443             MOVE ZEROS          TO OUT-NEW-AH-BEN
  6444         END-IF
  6445     END-IF
  6446     IF (EN-AH-NEW-PRM-AMT = EN-AH-ORIG-PRM-AMT)
  6447        AND (EN-AH-ORIG-PRM-AMT NOT = ZEROS)
  6448        MOVE 'No Change'         TO OUT-NEW-AH-PRM-A
  6449     ELSE
  6450         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6451           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 113
* NSRASBL.cbl
  6452             MOVE ZEROS          TO OUT-NEW-AH-PRM
  6453         END-IF
  6454     END-IF
  6455     IF (OUT-NEW-AH-DESC = OUT-ORIG-AH-DESC)
  6456        AND (OUT-ORIG-AH-DESC NOT = SPACES)
  6457        MOVE 'No Change'         TO OUT-NEW-AH-DESC
  6458     ELSE
  6459         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6460           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6461             MOVE 'None'         TO OUT-NEW-AH-DESC
  6462         END-IF
  6463     END-IF
  6464     IF EN-INS-NEW-AGE = EN-INS-ORIG-AGE
  6465        MOVE 'No Change'         TO OUT-NEW-IAGE-A
  6466     END-IF
  6467     IF (EN-JNT-NEW-AGE = EN-JNT-ORIG-AGE)
  6468        AND (EN-JNT-ORIG-AGE NOT = ZEROS)
  6469        MOVE 'No Change'         TO OUT-NEW-JAGE-A
  6470     ELSE
  6471         IF (EN-JNT-ORIG-AGE NOT = ZEROS AND SPACES)
  6472           AND (EN-JNT-NEW-AGE = ZEROS OR SPACES)
  6473             MOVE 'None'         TO OUT-NEW-JAGE-A
  6474         END-IF
  6475     END-IF
  6476     IF (EN-LF-NEW-TERM = EN-LF-ORIG-TERM)
  6477        AND (EN-LF-ORIG-TERM NOT = ZEROS)
  6478        MOVE 'No Change'         TO OUT-NEW-LF-TERM-A
  6479     ELSE
  6480         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6481           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6482             MOVE ZEROS          TO OUT-NEW-LF-TERM
  6483         END-IF
  6484     END-IF
  6485     IF (EN-AH-NEW-TERM = EN-AH-ORIG-TERM)
  6486        AND (EN-AH-ORIG-TERM NOT = ZEROS)
  6487        MOVE 'No Change'         TO OUT-NEW-AH-TERM-A
  6488     ELSE
  6489         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6490           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6491             MOVE ZEROS          TO OUT-NEW-AH-TERM
  6492         END-IF
  6493     END-IF
  6494     IF (EN-AH-NEW-CP = EN-AH-ORIG-CP)
  6495        AND (EN-AH-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6496        MOVE 'No Change'         TO OUT-NEW-CRIT-PER-A
  6497                                    OUT-NEW-MAX-PMTS-A
  6498     ELSE
  6499         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6500           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6501             MOVE 'None'         TO OUT-NEW-CRIT-PER-A
  6502                                    OUT-NEW-MAX-PMTS-A
  6503         END-IF
  6504     END-IF
  6505     IF OUT-NEW-SCHED-TERM = OUT-ORIG-SCHED-TERM
  6506        MOVE 'No Change'         TO OUT-NEW-SCHED-TERM-A
  6507     END-IF
  6508     IF (OUT-NEW-WAIT-PER = OUT-ORIG-WAIT-PER)
  6509       AND (OUT-ORIG-WAIT-PER NOT = SPACES)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 114
* NSRASBL.cbl
  6510         MOVE 'No Change'        TO OUT-NEW-WAIT-PER
  6511     ELSE
  6512         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6513           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6514             MOVE 'None'         TO OUT-NEW-WAIT-PER
  6515         END-IF
  6516     END-IF
  6517     .
  6518 0650-PROCESS-CANCEL.
  6519     .
  6520 0650-EXIT.
  6521     EXIT.
  6522 0700-WRITE-EXTR.
  6523     display ' made it to 0700 '
  6524     PERFORM 1000-BUILD-ERARCH   THRU 1000-EXIT
  6525     IF BL-FAIL
  6526        MOVE ' COULDNT BUILD ERARCH ' TO BL-MESSAGE
  6527        GO TO 0700-EXIT
  6528     END-IF
  6529     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  6530     MOVE BL-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  6531     MOVE +0                     TO NSAS-SEQ-NO
  6532     PERFORM 0710-BUILD-NSASEXTR THRU 0710-EXIT
  6533     PERFORM 0720-WRITE-NSASEXTR THRU 0720-EXIT
  6534     IF BL-FAIL
  6535        MOVE ' COULDNT BUILD STD NSASEXTR ' TO BL-MESSAGE
  6536        GO TO 0700-EXIT
  6537     END-IF
  6538     IF W-LETTER-TO-ACCT NOT = SPACES
  6539        display ' acct ne spaces ' bl-archive-no
  6540        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  6541        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  6542        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  6543        MOVE +1                  TO NSAS-SEQ-NO
  6544        PERFORM 0720-WRITE-NSASEXTR
  6545                                 THRU 0720-EXIT
  6546        IF BL-FAIL
  6547           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO BL-MESSAGE
  6548           GO TO 0700-EXIT
  6549        END-IF
  6550     END-IF
  6551     IF W-LETTER-TO-BENE NOT = SPACES
  6552        display ' bene ne spaces ' bl-archive-no
  6553        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  6554        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  6555        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  6556        MOVE +2                  TO NSAS-SEQ-NO
  6557        PERFORM 0720-WRITE-NSASEXTR
  6558                                 THRU 0720-EXIT
  6559        IF BL-FAIL
  6560           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO BL-MESSAGE
  6561        END-IF
  6562     END-IF
  6563     IF W-PRINT-CERTIFICATE = 'Y' AND
  6564        BL-STATE = 'VA'
  6565           MOVE OUT-ACCT-NAME       TO VD-ACCOUNT-NAME
  6566           MOVE WS-COMPANY-CD       TO VD-COMPANY-CD
  6567           MOVE BL-CARRIER          TO VD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 115
* NSRASBL.cbl
  6568           MOVE BL-GROUP            TO VD-GROUPING
  6569           MOVE BL-STATE            TO VD-STATE
  6570           MOVE BL-ACCOUNT          TO VD-ACCOUNT
  6571           MOVE WS-ELCERT-EFF-DT    TO VD-CERT-EFF-DT
  6572           MOVE BL-CERT-NO          TO VD-CERT-NO
  6573           MOVE OUT-ILNAME          TO VD-INSURED-LAST-NAME
  6574           MOVE OUT-IFNAME          TO VD-INSURED-FIRST-NAME
  6575           MOVE OUT-IMINIT          TO VD-INSURED-MIDDLE-INIT
  6576           MOVE OUT-JLNAME          TO VD-JOINT-LAST-NAME
  6577           MOVE OUT-JFNAME          TO VD-JOINT-FIRST-NAME
  6578           MOVE OUT-JMINIT          TO VD-JOINT-MIDDLE-INIT
  6579           MOVE OUT-BENE-NAME       TO VD-BENEFICIARY-NAME
  6580           MOVE OUT-ENTRY-BATCH     TO VD-ENTRY-BATCH
  6581           MOVE OUT-CSR-CODE        TO VD-CSR-ID
  6582           MOVE CM-LF-BENEFIT-CD    TO VD-LF-BENEFIT-CD
  6583           MOVE CM-LF-PREMIUM-AMT   TO VD-LF-PREMIUM-AMT
  6584           MOVE CM-LF-BENEFIT-AMT   TO VD-LF-BENEFIT-AMT
  6585           MOVE CM-LF-ORIG-TERM     TO VD-LF-TERM
  6586           MOVE CM-LF-PREMIUM-RATE  TO VD-LF-RATE
  6587           MOVE CM-AH-BENEFIT-CD    TO VD-AH-BENEFIT-CD
  6588           MOVE CM-AH-PREMIUM-AMT   TO VD-AH-PREMIUM-AMT
  6589           MOVE CM-AH-BENEFIT-AMT   TO VD-AH-BENEFIT-AMT
  6590           MOVE CM-AH-ORIG-TERM     TO VD-AH-TERM
  6591           MOVE CM-AH-PREMIUM-RATE  TO VD-AH-RATE
  6592           MOVE CM-LOAN-TERM        TO VD-LOAN-TERM
  6593           MOVE CM-LOAN-APR         TO VD-LOAN-APR
  6594           MOVE CM-LOAN-1ST-PMT-DT  TO VD-1ST-PMT-DT
  6595           MOVE OUT-INS-ADDR1       TO VD-INSURED-ADDRESS-1
  6596           MOVE OUT-INS-ADDR2       TO VD-INSURED-ADDRESS-2
  6597           MOVE OUT-INS-CITY        TO VD-INSURED-CITY
  6598           MOVE OUT-INS-STATE       TO VD-INSURED-STATE
  6599           MOVE OUT-INS-ZIP         TO VD-INSURED-ZIP-CODE
  6600           MOVE 'VADS'              TO VD-LETTER-ID
  6601           MOVE OUT-PROC-ID         TO VD-PROC-ID
  6602           MOVE BL-COMP-ID          TO VD-COMP-ID
  6603           MOVE EIBTIME             TO VD-CURRENT-TIME
  6604           MOVE SAVE-BIN-DATE       TO VD-CURRENT-DATE
  6605           MOVE BL-ARCHIVE-NO       TO VD-ARCHIVE-NO
  6606           MOVE VIRGINIA-DISCLOSURE TO WS-PASS-VADS-REC
  6607
  6608* EXEC CICS LINK
  6609*              PROGRAM    (LINK-ELVADS)
  6610*              COMMAREA   (WS-PASS-AREA)
  6611*              LENGTH     (WS-PASS-AREA-LENGTH)
  6612*          END-EXEC
  6613*    MOVE '."C                   (   #00006552' TO DFHEIV0
  6614     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6615     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6616     MOVE X'2020233030303036353532' TO DFHEIV0(25:11)
  6617     CALL 'kxdfhei1' USING DFHEIV0,
  6618           LINK-ELVADS,
  6619           WS-PASS-AREA,
  6620           WS-PASS-AREA-LENGTH,
  6621           DFHEIV99,
  6622           DFHEIV99,
  6623           DFHEIV99,
  6624           DFHEIV99
  6625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 116
* NSRASBL.cbl
  6626     END-IF
  6627     .
  6628 0700-EXIT.
  6629     EXIT.
  6630  0710-BUILD-NSASEXTR.
  6631***  i added the extra space in front of the 1st ~
  6632***  only because there may be a letter to acct or bene
  6633     STRING
  6634         OUT-LETTER             ' ~'
  6635         OUT-PROC-ID            '~'
  6636         OUT-PROC-NAME          '~'
  6637         OUT-PROC-TITLE         '~'
  6638         OUT-CSR-NAME           '~'
  6639         OUT-CSR-TITLE          '~'
  6640         OUT-CARRIER            '~'
  6641         OUT-GROUPING           '~'
  6642         OUT-STATE              '~'
  6643         OUT-ACCOUNT            '~'
  6644         OUT-CERT-EFF-DT        '~'
  6645         OUT-CERT-NO            '~'
  6646         OUT-CERT-SFX           '~'
  6647         OUT-ILNAME             '~'
  6648         OUT-IFNAME             '~'
  6649         OUT-IFINIT             '~'
  6650         OUT-IMINIT             '~'
  6651         OUT-IAGE               '~'
  6652         OUT-ISEX               '~'
  6653         OUT-INS-ADDR1          '~'
  6654         OUT-INS-ADDR2          '~'
  6655         OUT-INS-CITY           '~'
  6656         OUT-INS-STATE          '~'
  6657         OUT-INS-ZIP            '~'
  6658         OUT-SOC-SEC-NO         '~'
  6659         OUT-MEMBER-NO          '~'
  6660         OUT-JLNAME             '~'
  6661         OUT-JFNAME             '~'
  6662         OUT-JMINIT             '~'
  6663         OUT-JAGE               '~'
  6664         OUT-ACCT-NAME          '~'
  6665         OUT-ACCT-ADDR1         '~'
  6666         OUT-ACCT-ADDR2         '~'
  6667         OUT-ACCT-CITY          '~'
  6668         OUT-ACCT-STATE         '~'
  6669         OUT-ACCT-ZIP           '~'
  6670         OUT-ACCT-PHONE         '~'
  6671         OUT-ACCT-CNTRL-NAME    '~'
  6672         OUT-ACCT-BUS-TYPE      '~'
  6673         OUT-BENE-NAME          '~'
  6674         OUT-BENE-ADDR1         '~'
  6675         OUT-BENE-ADDR2         '~'
  6676         OUT-BENE-CITY          '~'
  6677         OUT-BENE-STATE         '~'
  6678         OUT-BENE-ZIP           '~'
  6679         OUT-CARR-NAME          '~'
  6680         OUT-RESP-NO            '~'
  6681         OUT-COMP-NAME          '~'
  6682         OUT-COMP-MAIL-TO       '~'
  6683         OUT-COMP-ADDR1         '~'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 117
* NSRASBL.cbl
  6684         OUT-COMP-ADDR2         '~'
  6685         OUT-COMP-CITY          '~'
  6686         OUT-COMP-STATE         '~'
  6687         OUT-COMP-ZIP           '~'
  6688         OUT-COMP-PHONE         '~'
  6689         OUT-COMP-FAX           '~'
  6690         OUT-COMP-STATUS        '~'
  6691         OUT-BILL-SW            '~'
  6692         OUT-RPT-CD1            '~'
  6693         OUT-RPT-CD2            '~'
  6694         OUT-ENTRY-DT           '~'
  6695         OUT-ENTRY-BATCH        '~'
  6696         OUT-ENTRY-STATUS       '~'
  6697         OUT-1ST-PMT-DT         '~'
  6698         OUT-LOAN-APR           '~'
  6699         OUT-LOAN-TERM          '~'
  6700         OUT-RATE-CLASS         '~'
  6701         OUT-EXT-DAYS           '~'
  6702         OUT-CSR-CODE           '~'
  6703         OUT-UCODE              '~'
  6704         OUT-PREM-TYPE          '~'
  6705         OUT-IND-GRP            '~'
  6706         OUT-SKIP-CD            '~'
  6707         OUT-PMT-MODE           '~'
  6708         OUT-LOAN-OFF           '~'
  6709         OUT-REIN-TABLE         '~'
  6710         OUT-SPEC-REIN          '~'
  6711         OUT-LF-BENCD           '~'
  6712         OUT-LF-TERM            '~'
  6713         OUT-LF-DEV-CD          '~'
  6714         OUT-LF-DEV-PCT         '~'
  6715         OUT-LF-BEN             '~'
  6716         OUT-LF-PRM             '~'
  6717         OUT-LF-ALT-BEN         '~'
  6718         OUT-LF-ALT-PRM         '~'
  6719         OUT-LF-NSP             '~'
  6720         OUT-LF-REM-BEN         '~'
  6721         OUT-LF-REF             '~'
  6722         OUT-LF-DTH             '~'
  6723         OUT-LF-RATE            '~'
  6724         OUT-LF-ALT-RATE        '~'
  6725         OUT-LF-EXP-DT          '~'
  6726         OUT-LF-CUR-STATUS      '~'
  6727         OUT-LF-CAN-DT          '~'
  6728         OUT-LF-CAN-EXIT-DT     '~'
  6729         OUT-LF-DTH-DT          '~'
  6730         OUT-LF-DTH-EXIT-DT     '~'
  6731         OUT-LF-EXIT-BATCH      '~'
  6732         OUT-LF-COMM-PCT        '~'
  6733         OUT-LF-DESC            '~'
  6734         OUT-LF-ABBRV           '~'
  6735         OUT-AH-BENCD           '~'
  6736         OUT-AH-TERM            '~'
  6737         OUT-CRIT-PER           '~'
  6738         OUT-AH-DEV-CD          '~'
  6739         OUT-AH-DEV-PCT         '~'
  6740         OUT-AH-BEN             '~'
  6741         OUT-AH-PRM             '~'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 118
* NSRASBL.cbl
  6742         OUT-AH-NSP             '~'
  6743         OUT-AH-REF             '~'
  6744         OUT-AH-CLM             '~'
  6745         OUT-AH-TOT-BEN         '~'
  6746         OUT-AH-PDTHRU-DT       '~'
  6747         OUT-AH-RATE            '~'
  6748         OUT-AH-EXP-DT          '~'
  6749         OUT-AH-CUR-STATUS      '~'
  6750         OUT-AH-CAN-DT          '~'
  6751         OUT-AH-CAN-EXIT-DT     '~'
  6752         OUT-AH-EXIT-BATCH      '~'
  6753         OUT-AH-COMM-PCT        '~'
  6754         OUT-AH-DESC            '~'
  6755         OUT-RET-ELIM           '~'
  6756         OUT-BEN-DAYS           '~'
  6757         OUT-WAIT-PER           '~'
  6758         OUT-MAX-PMTS           '~'
  6759         OUT-TOT-PRM            '~'
  6760         OUT-TOT-REF            '~'
  6761         OUT-SCHED-EXP-DT       '~'
  6762         OUT-SCHED-TERM         '~'
  6763         OUT-ORIG-ILNAME        '~'
  6764         OUT-ORIG-IFNAME        '~'
  6765         OUT-ORIG-MINIT         '~'
  6766         OUT-ORIG-IAGE          '~'
  6767         OUT-ORIG-JLNAME        '~'
  6768         OUT-ORIG-JFNAME        '~'
  6769         OUT-ORIG-JMINIT        '~'
  6770         OUT-ORIG-JAGE          '~'
  6771         OUT-ORIG-LF-BENCD      '~'
  6772         OUT-ORIG-LF-TERM       '~'
  6773         OUT-ORIG-LF-BEN        '~'
  6774         OUT-ORIG-LF-PRM        '~'
  6775         OUT-LF-CALC-PRM        '~'
  6776         OUT-ORIG-LF-REF        '~'
  6777         OUT-LF-CALC-REF        '~'
  6778         OUT-ORIG-LF-ALT-BEN    '~'
  6779         OUT-ORIG-LF-ALT-PRM    '~'
  6780         OUT-ORIG-LF-EXP-DT     '~'
  6781         OUT-ORIG-LF-DESC       '~'
  6782         OUT-ORIG-AH-BENCD      '~'
  6783         OUT-ORIG-AH-TERM       '~'
  6784         OUT-ORIG-CRIT-PER      '~'
  6785         OUT-ORIG-AH-BEN        '~'
  6786         OUT-ORIG-AH-PRM        '~'
  6787         OUT-AH-CALC-PRM        '~'
  6788         OUT-ORIG-AH-REF        '~'
  6789         OUT-AH-CALC-REF        '~'
  6790         OUT-ORIG-AH-EXP-DT     '~'
  6791         OUT-ORIG-AH-DESC       '~'
  6792         OUT-ORIG-RET-ELIM      '~'
  6793         OUT-ORIG-BEN-DAYS      '~'
  6794         OUT-ORIG-WAIT-PER      '~'
  6795         OUT-ORIG-MAX-PMTS      '~'
  6796         OUT-ORIG-SCHED-EXP-DT  '~'
  6797         OUT-ORIG-SCHED-TERM    '~'
  6798         OUT-NEW-ILNAME         '~'
  6799         OUT-NEW-IFNAME         '~'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 119
* NSRASBL.cbl
  6800         OUT-NEW-IMINIT         '~'
  6801         OUT-NEW-IAGE           '~'
  6802         OUT-NEW-JLNAME         '~'
  6803         OUT-NEW-JFNAME         '~'
  6804         OUT-NEW-JMINIT         '~'
  6805         OUT-NEW-JAGE           '~'
  6806         OUT-NEW-LF-BENCD       '~'
  6807         OUT-NEW-LF-TERM        '~'
  6808         OUT-NEW-LF-BEN         '~'
  6809         OUT-NEW-LF-PRM         '~'
  6810         OUT-NEW-LF-REF         '~'
  6811         OUT-NEW-LF-ALT-BEN     '~'
  6812         OUT-NEW-LF-ALT-PRM     '~'
  6813         OUT-NEW-LF-EXP-DT      '~'
  6814         OUT-NEW-LF-DESC        '~'
  6815         OUT-NEW-AH-BENCD       '~'
  6816         OUT-NEW-AH-TERM        '~'
  6817         OUT-NEW-CRIT-PER       '~'
  6818         OUT-NEW-AH-BEN         '~'
  6819         OUT-NEW-AH-PRM         '~'
  6820         OUT-NEW-AH-REF         '~'
  6821         OUT-NEW-AH-EXP-DT      '~'
  6822         OUT-NEW-AH-DESC        '~'
  6823         OUT-NEW-RET-ELIM       '~'
  6824         OUT-NEW-BEN-DAYS       '~'
  6825         OUT-NEW-WAIT-PER       '~'
  6826         OUT-NEW-MAX-PMTS       '~'
  6827         OUT-NEW-SCHED-EXP-DT   '~'
  6828         OUT-NEW-SCHED-TERM     '~'
  6829         OUT-TOT-PRM-CHG        '~'
  6830         OUT-TOT-REF-CHG        '~'
  6831         OUT-PAYEE              '~'
  6832         OUT-SIG-SW             '~'
  6833         OUT-BALLOON-IND        '~'
  6834         OUT-LEASE-IND          '~'
  6835         OUT-RESCIND            '~'
  6836         OUT-REA-CD1            '~'
  6837         OUT-REA-CD2            '~'
  6838         OUT-REA-CD3            '~'
  6839         OUT-REA-CD4            '~'
  6840         OUT-REA-CD5            '~'
  6841         OUT-REA-CD6            '~'
  6842         OUT-REA-CD7            '~'
  6843         OUT-REA-CD8            '~'
  6844         OUT-REA-CD9            '~'
  6845         OUT-REA-CD10           '~'
  6846         OUT-REA-CD11           '~'
  6847         OUT-REA-CD12           '~'
  6848         OUT-CYCLE-DT           '~'
  6849         OUT-ARCH-NO            '~'
  6850         OUT-FORM               '~'
  6851         OUT-ENC-LINE           '~'
  6852         OUT-ATTACH             '~'
  6853         OUT-STACK              '~'
  6854         OUT-STATE-NAME         '~'
  6855         OUT-PRINT-NOW          '~'
  6856         OUT-CHGBACK            '~'
  6857         OUT-CSO-PORTION        '~'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 120
* NSRASBL.cbl
  6858         OUT-ACCT-PORTION       '~'
  6859         OUT-LETTER-TYPE        '~'
  6860         OUT-PRINT-CERTIFICATE  '~'
  6861         OUT-INS-BIRTHDATE      '~'
  6862         OUT-JNT-BIRTHDATE      '~'
  6863         OUT-TOT-INTEREST       '~'
  6864         OUT-ORIG-TOT-PREM      '~'
  6865         OUT-ORIG-TOT-REF       '~'
  6866         OUT-CANCEL-DT          '~'
  6867         OUT-HEALTH-APP         '~'
  6868         OUT-CERTIFICATE-ID     '~'
  6869         OUT-UNDW-ID            '~'
  6870         OUT-NEW-TOT-PREM       '~'
  6871         OUT-NEW-TOT-REF        '~'
  6872         OUT-COVERAGE-IND       '~'
  6873         OUT-ORIG-COVERAGE-IND  '~'
  6874         OUT-NEW-COVERAGE-IND   '~'
  6875         OUT-LF-CMB-PREM        '~'
  6876         OUT-ORIG-LF-CMB-PREM   '~'
  6877         OUT-NEW-LF-CMB-PREM    '~'
  6878         OUT-LF-PREM-CHG        '~'
  6879         OUT-LF-ALT-PREM-CHG    '~'
  6880         OUT-LF-CMB-PREM-CHG    '~'
  6881         OUT-AH-PREM-CHG        '~'
  6882         OUT-LF-REF-CHG         '~'
  6883         OUT-AH-REF-CHG         '~'
  6884         OUT-ACCT-LF-PORTION    '~'
  6885         OUT-ACCT-ALT-LF-PORT   '~'
  6886         OUT-ACCT-CMB-LF-PORT   '~'
  6887         OUT-ACCT-AH-PORTION    '~'
  6888         OUT-CSO-LF-PORTION     '~'
  6889         OUT-CSO-ALT-LF-PORT    '~'
  6890         OUT-CSO-CMB-LF-PORT    '~'
  6891         OUT-CSO-AH-PORTION     '~'
  6892         OUT-ACCT-ORIG-LF-PORT  '~'
  6893         OUT-ACCT-ORIG-ALT-LF-PORT '~'
  6894         OUT-ACCT-ORIG-CMB-LF-PORT '~'
  6895         OUT-ACCT-ORIG-AH-PORT  '~'
  6896         OUT-ACCT-ORIG-PORTION  '~'
  6897         OUT-CSO-ORIG-LF-PORT   '~'
  6898         OUT-CSO-ORIG-ALT-LF-PORT '~'
  6899         OUT-CSO-ORIG-CMB-LF-PORT '~'
  6900         OUT-CSO-ORIG-AH-PORT   '~'
  6901         OUT-CSO-ORIG-PORTION   '~'
  6902         OUT-ACCT-NEW-LF-PORT   '~'
  6903         OUT-ACCT-NEW-ALT-LF-PORT '~'
  6904         OUT-ACCT-NEW-CMB-LF-PORT '~'
  6905         OUT-ACCT-NEW-AH-PORT   '~'
  6906         OUT-ACCT-NEW-PORTION   '~'
  6907         OUT-CSO-NEW-LF-PORT    '~'
  6908         OUT-CSO-NEW-ALT-LF-PORT '~'
  6909         OUT-CSO-NEW-CMB-LF-PORT '~'
  6910         OUT-CSO-NEW-AH-PORT    '~'
  6911         OUT-CSO-NEW-PORTION    '~'
  6912         OUT-ACCT-LF-PORT-CHG   '~'
  6913         OUT-ACCT-ALT-LF-PORT-CHG '~'
  6914         OUT-ACCT-CMB-LF-PORT-CHG '~'
  6915         OUT-ACCT-AH-PORT-CHG   '~'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 121
* NSRASBL.cbl
  6916         OUT-ACCT-PORTION-CHG   '~'
  6917         OUT-CSO-LF-PORT-CHG    '~'
  6918         OUT-CSO-ALT-LF-PORT-CHG '~'
  6919         OUT-CSO-CMB-LF-PORT-CHG '~'
  6920         OUT-CSO-AH-PORT-CHG    '~'
  6921         OUT-CSO-PORTION-CHG    '~'
  6922         OUT-ORIG-LF-CAN-DT     '~'
  6923         OUT-NEW-LF-CAN-DT      '~'
  6924         OUT-ORIG-AH-CAN-DT     '~'
  6925         OUT-NEW-AH-CAN-DT      '~'
  6926         OUT-ORIG-CAN-DT        '~'
  6927         OUT-NEW-CAN-DT         '~'
  6928         OUT-SCREEN-ID          '~'
  6929            DELIMITED BY '   ' INTO NSAS-LETTER-VARIABLES
  6930     END-STRING
  6931     .
  6932 0710-exit.
  6933     EXIT.
  6934 0720-WRITE-NSASEXTR.
  6935
  6936* EXEC CICS WRITE
  6937*       DATASET    ('NSASEXTR')
  6938*       FROM       (NSAS-EXTRACT-RECORD)
  6939*       RIDFLD     (NSAS-CONTROL-PRIMARY)
  6940*       RESP       (WS-RESPONSE)
  6941*    END-EXEC
  6942     MOVE LENGTH OF
  6943      NSAS-EXTRACT-RECORD
  6944       TO DFHEIV11
  6945     MOVE 'NSASEXTR' TO DFHEIV1
  6946*    MOVE '&$ L                  ''  N#00006866' TO DFHEIV0
  6947     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6948     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6949     MOVE X'204E233030303036383636' TO DFHEIV0(25:11)
  6950     CALL 'kxdfhei1' USING DFHEIV0,
  6951           DFHEIV1,
  6952           NSAS-EXTRACT-RECORD,
  6953           DFHEIV11,
  6954           NSAS-CONTROL-PRIMARY,
  6955           DFHEIV99,
  6956           DFHEIV99
  6957     MOVE EIBRESP  TO WS-RESPONSE
  6958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6959     IF NOT RESP-NORMAL
  6960        display ' bad write nsasextr ' ws-response
  6961        SET BL-FAIL TO TRUE
  6962     END-IF
  6963     .
  6964 0720-EXIT.
  6965     EXIT.
  6966 0800-init-out-data.
  6967     MOVE ZEROS                  TO OUT-IAGE
  6968                                    OUT-JAGE
  6969                                    OUT-LOAN-APR
  6970                                    OUT-LOAN-TERM
  6971                                    OUT-EXT-DAYS
  6972                                    OUT-LF-TERM
  6973                                    OUT-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 122
* NSRASBL.cbl
  6974                                    OUT-LF-DEV-PCT
  6975                                    OUT-AH-DEV-PCT
  6976                                    OUT-LF-BEN
  6977                                    OUT-AH-BEN
  6978                                    OUT-CRIT-PER
  6979                                    OUT-MAX-PMTS
  6980                                    OUT-SCHED-TERM
  6981                                    OUT-ORIG-IAGE
  6982                                    OUT-ORIG-JAGE
  6983                                    OUT-NEW-IAGE
  6984                                    OUT-NEW-JAGE
  6985                                    OUT-ORIG-LF-TERM
  6986                                    OUT-ORIG-AH-TERM
  6987                                    OUT-NEW-LF-TERM
  6988                                    OUT-NEW-AH-TERM
  6989                                    OUT-ORIG-CRIT-PER
  6990                                    OUT-ORIG-MAX-PMTS
  6991                                    OUT-ORIG-SCHED-TERM
  6992                                    OUT-NEW-SCHED-TERM
  6993                                    OUT-NEW-CRIT-PER
  6994                                    OUT-NEW-MAX-PMTS
  6995                                    OUT-CSO-PORTION
  6996                                    OUT-CSO-LF-PORTION
  6997                                    OUT-CSO-ALT-LF-PORT
  6998                                    OUT-CSO-CMB-LF-PORT
  6999                                    OUT-CSO-AH-PORTION
  7000                                    OUT-ACCT-PORTION
  7001                                    OUT-ACCT-LF-PORTION
  7002                                    OUT-ACCT-ALT-LF-PORT
  7003                                    OUT-ACCT-CMB-LF-PORT
  7004                                    OUT-ACCT-AH-PORTION
  7005                                    OUT-LF-PREM-CHG
  7006                                    OUT-LF-ALT-PREM-CHG
  7007                                    OUT-LF-CMB-PREM-CHG
  7008                                    OUT-AH-PREM-CHG
  7009                                    OUT-LF-REF-CHG
  7010                                    OUT-AH-REF-CHG
  7011     .
  7012 0800-exit.
  7013     exit.
  7014 1000-BUILD-ERARCH.
  7015* DATA SOURCE MEANINGS  BL-DATA-SRCE
  7016*    1) FROM ACCT MAINT
  7017*    2) FROM CERT UPDATE
  7018*    3) FROM COMP MAINT
  7019*    4) FROM REVIEW AND CORRECTIONS
  7020******************************************************************
  7021     MOVE 'LA'                   TO LETTER-ARCHIVE
  7022     MOVE BL-ARCHIVE-NO          TO LA-ARCHIVE-NO
  7023                                    LA-ARCHIVE-NO-A2
  7024                                    LA-ARCHIVE-NO-A3
  7025                                    LA-ARCHIVE-NO-A4
  7026                                    LA-ARCHIVE-NO-A5
  7027                                    LA-ARCHIVE-NO-A6
  7028     MOVE WS-COMPANY-CD          TO LA-COMPANY-CD
  7029                                    LA-COMPANY-CD-A2
  7030                                    LA-COMPANY-CD-A3
  7031                                    LA-COMPANY-CD-A4
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 123
* NSRASBL.cbl
  7032                                    LA-COMPANY-CD-A5
  7033                                    LA-COMPANY-CD-A6
  7034     MOVE BL-CARRIER             TO LA-CARRIER-A2
  7035                                    LA-CARRIER-A3
  7036                                    LA-CARRIER-A4
  7037                                    LA-CARRIER-A5
  7038     MOVE BL-GROUP               TO LA-GROUPING-A2
  7039                                    LA-GROUPING-A3
  7040                                    LA-GROUPING-A4
  7041                                    LA-GROUPING-A5
  7042     MOVE BL-ACCOUNT             TO LA-ACCOUNT-A2
  7043                                    LA-ACCOUNT-A3
  7044                                    LA-ACCOUNT-A4
  7045                                    LA-ACCOUNT-A5
  7046     MOVE BL-STATE               TO LA-STATE-A2
  7047                                    LA-STATE-A3
  7048                                    LA-STATE-A4
  7049                                    LA-STATE-A5
  7050     IF BL-DATA-SRCE = '2' OR '4'
  7051        MOVE WS-ELCERT-EFF-DT    TO LA-EFFECT-DATE-A2
  7052        MOVE BL-CERT-NO          TO LA-CERT-NO-A2
  7053     ELSE
  7054        MOVE LOW-VALUES          TO LA-EFFECT-DATE-A2
  7055     END-IF
  7056     IF BL-DATA-SRCE = '4'
  7057        MOVE BL-BATCH-NO         TO LA-ENTRY-A6
  7058     END-IF
  7059     MOVE BL-PROC-ID             TO LA-PROCESSOR-CD
  7060                                    LA-LAST-UPDATED-BY
  7061     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7062                                    LA-INITIAL-PRINT-DATE
  7063                                    LA-SENT-DATE
  7064                                    LA-REPLY-DATE
  7065                                    LA-RESEND-DATE
  7066                                    LA-FOLLOW-UP-DATE
  7067     MOVE 'A'                    TO LA-STATUS
  7068     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7069     MOVE W-FORM-TO-RESEND       TO LA-RESEND-LETR
  7070     IF W-DAYS-TO-RESEND NOT NUMERIC
  7071        MOVE ZEROS               TO W-DAYS-TO-RESEND
  7072     END-IF
  7073     IF W-DAYS-TO-RESEND > ZEROS
  7074        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7075        MOVE W-DAYS-TO-RESEND  TO DC-ELAPSED-DAYS
  7076        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7077        MOVE '6'                 TO DC-OPTION-CODE
  7078        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7079        IF NO-CONVERSION-ERROR
  7080           MOVE DC-BIN-DATE-2    TO LA-RESEND-DATE
  7081        END-IF
  7082     END-IF
  7083     IF W-DAYS-TO-FOLLOW-UP >= ZEROS
  7084        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7085        MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  7086        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7087        MOVE '6'                 TO DC-OPTION-CODE
  7088        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7089        IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 124
* NSRASBL.cbl
  7090           MOVE DC-BIN-DATE-2    TO LA-FOLLOW-UP-DATE
  7091        END-IF
  7092     END-IF
  7093
  7094     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7095     MOVE BL-LETTER-ID           TO LA-FORM-A3
  7096     MOVE BL-DATA-SRCE           TO LA-DATA-SOURCE
  7097     MOVE BL-WRITE-ERARCH        TO LA-ARCHIVE-STATUS
  7098     IF BL-ENDT-ARCH-NO > ZEROS
  7099        MOVE BL-ENDT-ARCH-NO     TO LA-ENDT-ARCH-NO
  7100     ELSE
  7101        MOVE BL-ARCHIVE-NO       TO LA-ENDT-ARCH-NO
  7102     END-IF
  7103     MOVE SAVE-BIN-DATE          TO LA-CREATION-DATE
  7104                                    LA-LAST-MAINT-DATE
  7105     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7106                                    LA-NO-OF-TEXT-RECORDS
  7107     MOVE EIBTIME                TO LA-LAST-MAINT-TIME
  7108
  7109* EXEC CICS WRITE
  7110*         DATASET   ('ERARCH')
  7111*         FROM      (LETTER-ARCHIVE)
  7112*         RIDFLD    (LA-CONTROL-PRIMARY)
  7113*         RESP      (WS-RESPONSE)
  7114*    END-EXEC
  7115     MOVE LENGTH OF
  7116      LETTER-ARCHIVE
  7117       TO DFHEIV11
  7118     MOVE 'ERARCH' TO DFHEIV1
  7119*    MOVE '&$ L                  ''  N#00007021' TO DFHEIV0
  7120     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7121     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7122     MOVE X'204E233030303037303231' TO DFHEIV0(25:11)
  7123     CALL 'kxdfhei1' USING DFHEIV0,
  7124           DFHEIV1,
  7125           LETTER-ARCHIVE,
  7126           DFHEIV11,
  7127           LA-CONTROL-PRIMARY,
  7128           DFHEIV99,
  7129           DFHEIV99
  7130     MOVE EIBRESP  TO WS-RESPONSE
  7131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7132     IF NOT RESP-NORMAL
  7133        DISPLAY ' BAD WRITE ON ERARCH ' WS-RESPONSE ' '
  7134        la-archive-no
  7135        SET BL-FAIL TO TRUE
  7136     END-IF
  7137     .
  7138 1000-EXIT.
  7139     EXIT.
  7140 1025-GET-CSR-INFO.
  7141     MOVE WS-CSR-ID              TO OUT-CSR-CODE
  7142                                    OUT-CSR-TITLE
  7143                                    OUT-PROC-TITLE
  7144                                    OUT-UNDW-ID
  7145     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7146     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
  7147     MOVE WS-CSR-ID              TO WS-ELCNTL-GENL
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 125
* NSRASBL.cbl
  7148     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7149
  7150* EXEC CICS READ
  7151*       INTO    (CONTROL-FILE)
  7152*       DATASET ('ELCNTL')
  7153*       RIDFLD  (WS-ELCNTL-KEY)
  7154*       RESP    (WS-RESPONSE)
  7155*    END-EXEC
  7156     MOVE LENGTH OF
  7157      CONTROL-FILE
  7158       TO DFHEIV11
  7159     MOVE 'ELCNTL' TO DFHEIV1
  7160*    MOVE '&"IL       E          (  N#00007044' TO DFHEIV0
  7161     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7162     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7163     MOVE X'204E233030303037303434' TO DFHEIV0(25:11)
  7164     CALL 'kxdfhei1' USING DFHEIV0,
  7165           DFHEIV1,
  7166           CONTROL-FILE,
  7167           DFHEIV11,
  7168           WS-ELCNTL-KEY,
  7169           DFHEIV99,
  7170           DFHEIV99,
  7171           DFHEIV99
  7172     MOVE EIBRESP  TO WS-RESPONSE
  7173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7174     IF RESP-NORMAL
  7175        MOVE CF-PROCESSOR-NAME   TO OUT-CSR-NAME
  7176                                    OUT-PROC-NAME
  7177*       MOVE CF-PROCESSOR-TITLE  TO OUT-CSR-TITLE
  7178*                                   OUT-PROC-TITLE
  7179     END-IF
  7180     IF BL-PROC-ID NOT = PB-CSR-ID
  7181        MOVE BL-COMP-ID          TO WS-ELCNTL-KEY
  7182        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
  7183        MOVE BL-PROC-ID          TO WS-ELCNTL-GENL
  7184                                    OUT-PROC-TITLE
  7185        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  7186
  7187* EXEC CICS READ
  7188*          INTO    (CONTROL-FILE)
  7189*          DATASET ('ELCNTL')
  7190*          RIDFLD  (WS-ELCNTL-KEY)
  7191*          RESP    (WS-RESPONSE)
  7192*       END-EXEC
  7193     MOVE LENGTH OF
  7194      CONTROL-FILE
  7195       TO DFHEIV11
  7196     MOVE 'ELCNTL' TO DFHEIV1
  7197*    MOVE '&"IL       E          (  N#00007062' TO DFHEIV0
  7198     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7199     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7200     MOVE X'204E233030303037303632' TO DFHEIV0(25:11)
  7201     CALL 'kxdfhei1' USING DFHEIV0,
  7202           DFHEIV1,
  7203           CONTROL-FILE,
  7204           DFHEIV11,
  7205           WS-ELCNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 126
* NSRASBL.cbl
  7206           DFHEIV99,
  7207           DFHEIV99,
  7208           DFHEIV99
  7209     MOVE EIBRESP  TO WS-RESPONSE
  7210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7211        IF RESP-NORMAL
  7212           MOVE CF-PROCESSOR-NAME   TO OUT-PROC-NAME
  7213*          MOVE CF-PROCESSOR-TITLE  TO OUT-PROC-TITLE
  7214        END-IF
  7215     END-IF
  7216     .
  7217 1025-EXIT.
  7218     EXIT.
  7219 1050-GET-ERMAIL.
  7220     MOVE CM-CONTROL-PRIMARY     TO WS-ERMAIL-KEY
  7221
  7222* EXEC CICS READ
  7223*         DATASET    ('ERMAIL')
  7224*         INTO       (MAILING-DATA)
  7225*         RIDFLD     (WS-ERMAIL-KEY)
  7226*         RESP       (WS-RESPONSE)
  7227*    END-EXEC
  7228     MOVE LENGTH OF
  7229      MAILING-DATA
  7230       TO DFHEIV11
  7231     MOVE 'ERMAIL' TO DFHEIV1
  7232*    MOVE '&"IL       E          (  N#00007078' TO DFHEIV0
  7233     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7234     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7235     MOVE X'204E233030303037303738' TO DFHEIV0(25:11)
  7236     CALL 'kxdfhei1' USING DFHEIV0,
  7237           DFHEIV1,
  7238           MAILING-DATA,
  7239           DFHEIV11,
  7240           WS-ERMAIL-KEY,
  7241           DFHEIV99,
  7242           DFHEIV99,
  7243           DFHEIV99
  7244     MOVE EIBRESP  TO WS-RESPONSE
  7245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7246     IF RESP-NORMAL
  7247        MOVE MA-ADDRESS-LINE-1   TO OUT-INS-ADDR1
  7248        MOVE MA-ADDRESS-LINE-2   TO OUT-INS-ADDR2
  7249        MOVE MA-CITY             TO OUT-INS-CITY
  7250        MOVE MA-ADDR-STATE       TO OUT-INS-STATE
  7251        MOVE MA-ZIP              TO OUT-INS-ZIP
  7252        MOVE MA-CRED-BENE-NAME   TO OUT-BENE-NAME
  7253        MOVE MA-CRED-BENE-ADDR   TO OUT-BENE-ADDR1
  7254        MOVE MA-CRED-BENE-ADDR2  TO OUT-BENE-ADDR2
  7255        MOVE MA-CRED-BENE-CITY   TO OUT-BENE-CITY
  7256        MOVE MA-CRED-BENE-STATE  TO OUT-BENE-STATE
  7257        MOVE MA-CRED-BENE-ZIP    TO OUT-BENE-ZIP
  7258        IF MA-INSURED-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7259           MOVE MA-INSURED-BIRTH-DT
  7260                                 TO DC-BIN-DATE-1
  7261           MOVE ' '              TO DC-OPTION-CODE
  7262           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7263           IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 127
* NSRASBL.cbl
  7264              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7265                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7266                INTO OUT-INS-BIRTHDATE
  7267              END-STRING
  7268           END-IF
  7269        END-IF
  7270        IF MA-JOINT-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7271           MOVE MA-JOINT-BIRTH-DT
  7272                                 TO DC-BIN-DATE-1
  7273           MOVE ' '              TO DC-OPTION-CODE
  7274           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7275           IF NO-CONVERSION-ERROR
  7276              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7277                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7278                INTO OUT-JNT-BIRTHDATE
  7279              END-STRING
  7280           END-IF
  7281        END-IF
  7282     END-IF
  7283     .
  7284 1050-EXIT.
  7285     EXIT.
  7286 1100-GET-ELCERT.
  7287
  7288* EXEC CICS READ
  7289*         DATASET    ('ELCERT')
  7290*         INTO       (CERTIFICATE-MASTER)
  7291*         RIDFLD     (WS-ELCERT-KEY)
  7292*         RESP       (WS-RESPONSE)
  7293*    END-EXEC.
  7294     MOVE LENGTH OF
  7295      CERTIFICATE-MASTER
  7296       TO DFHEIV11
  7297     MOVE 'ELCERT' TO DFHEIV1
  7298*    MOVE '&"IL       E          (  N#00007125' TO DFHEIV0
  7299     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7300     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7301     MOVE X'204E233030303037313235' TO DFHEIV0(25:11)
  7302     CALL 'kxdfhei1' USING DFHEIV0,
  7303           DFHEIV1,
  7304           CERTIFICATE-MASTER,
  7305           DFHEIV11,
  7306           WS-ELCERT-KEY,
  7307           DFHEIV99,
  7308           DFHEIV99,
  7309           DFHEIV99
  7310     MOVE EIBRESP  TO WS-RESPONSE
  7311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7312
  7313     IF RESP-NORMAL
  7314        SET CERT-FOUND TO TRUE
  7315        PERFORM 1110-BUILD-CERT  THRU 1110-EXIT
  7316        PERFORM 1050-GET-ERMAIL  THRU 1050-EXIT
  7317     END-IF
  7318     .
  7319 1100-EXIT.
  7320     EXIT.
  7321 1110-BUILD-CERT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 128
* NSRASBL.cbl
  7322     PERFORM 1300-DETERMINE-COMM THRU 1300-EXIT
  7323     MOVE SPACES                 TO OUT-COVERAGE-IND
  7324     MOVE SPACES                 TO OUT-ORIG-COVERAGE-IND
  7325     MOVE SPACES                 TO OUT-NEW-COVERAGE-IND
  7326     MOVE CM-CARRIER             TO OUT-CARRIER
  7327     MOVE CM-GROUPING            TO OUT-GROUPING
  7328     MOVE CM-STATE               TO OUT-STATE
  7329     MOVE CM-ACCOUNT             TO OUT-ACCOUNT
  7330     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  7331     MOVE ' '                    TO DC-OPTION-CODE
  7332     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7333     IF NO-CONVERSION-ERROR
  7334        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7335           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7336              INTO OUT-CERT-EFF-DT
  7337        END-STRING
  7338     END-IF
  7339     MOVE CM-CERT-NO             TO OUT-CERT-NO
  7340     MOVE CM-INSURED-LAST-NAME   TO OUT-ILNAME
  7341                                    OUT-ORIG-ILNAME
  7342     MOVE CM-INSURED-INITIAL1    TO OUT-IFINIT
  7343     MOVE CM-INSURED-INITIAL2    TO OUT-IMINIT
  7344                                    OUT-ORIG-MINIT
  7345     IF (CM-SSN-STATE = CM-STATE)
  7346        AND (CM-SSN-ACCOUNT = CM-ACCOUNT (5:6))
  7347        MOVE SPACES              TO OUT-SOC-SEC-NO
  7348     ELSE
  7349        MOVE CM-SOC-SEC-NO       TO OUT-SOC-SEC-NO
  7350     END-IF
  7351     IF (CM-MEMB-STATE = CM-STATE)
  7352        AND (CM-MEMB-ACCOUNT = CM-ACCOUNT (5:6))
  7353        MOVE SPACES              TO OUT-MEMBER-NO
  7354     ELSE
  7355        MOVE CM-MEMBER-NO        TO OUT-MEMBER-NO
  7356     END-IF
  7357     MOVE CM-INSURED-FIRST-NAME  TO OUT-IFNAME
  7358                                    OUT-ORIG-IFNAME
  7359     MOVE CM-INSURED-ISSUE-AGE   TO OUT-IAGE
  7360                                    OUT-ORIG-IAGE
  7361     MOVE CM-INSURED-SEX         TO OUT-ISEX
  7362     MOVE CM-INSURED-JOINT-AGE   TO OUT-JAGE
  7363                                    OUT-ORIG-JAGE
  7364     MOVE CM-JT-LAST-NAME        TO OUT-JLNAME
  7365                                    OUT-ORIG-JLNAME
  7366     MOVE CM-JT-FIRST-NAME       TO OUT-JFNAME
  7367                                    OUT-ORIG-JFNAME
  7368     MOVE CM-JT-INITIAL          TO OUT-JMINIT
  7369                                    OUT-ORIG-JMINIT
  7370     MOVE CM-LF-BENEFIT-CD       TO OUT-LF-BENCD
  7371                                    OUT-ORIG-LF-BENCD
  7372     MOVE CM-LF-ORIG-TERM        TO OUT-LF-TERM
  7373                                    OUT-ORIG-LF-TERM
  7374     MOVE CM-LF-DEV-CODE         TO OUT-LF-DEV-CD
  7375     IF CM-LF-DEV-PCT NOT NUMERIC
  7376        MOVE ZEROS               TO CM-LF-DEV-PCT
  7377     END-IF
  7378     MOVE CM-LF-DEV-PCT          TO OUT-LF-DEV-PCT
  7379     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 129
* NSRASBL.cbl
  7380        IF (PB-C-LF-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7381          (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7382             MOVE SPACES          TO OUT-LF-BENCD
  7383                                     WS-LF-BENCD
  7384                                     OUT-LF-CAN-DT
  7385             MOVE ZEROS           TO OUT-LF-TERM
  7386                                     OUT-LF-BEN
  7387                                     OUT-LF-PRM
  7388                                     OUT-LF-ALT-BEN
  7389                                     OUT-LF-ALT-PRM
  7390                                     OUT-LF-COMM-PCT
  7391                                     OUT-LF-NSP
  7392                                     OUT-LF-REM-BEN
  7393                                     WS-WORK-LF-PREM
  7394                                     WS-WORK-ALT-LF-PREM
  7395                                     WS-WORK-CMB-LF-PREM
  7396                                     OUT-LF-REF
  7397                                     OUT-ORIG-LF-REF
  7398                                     WS-WORK-LF-REF
  7399             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7400             GO TO 1100-LF-CONT
  7401        END-IF
  7402     END-IF
  7403
  7404     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7405        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7406             MOVE SPACES          TO OUT-LF-BENCD
  7407                                     WS-LF-BENCD
  7408                                     OUT-LF-CAN-DT
  7409             MOVE ZEROS           TO OUT-LF-TERM
  7410                                     OUT-LF-BEN
  7411                                     OUT-LF-PRM
  7412                                     OUT-LF-ALT-BEN
  7413                                     OUT-LF-ALT-PRM
  7414                                     OUT-LF-COMM-PCT
  7415                                     OUT-LF-NSP
  7416                                     OUT-LF-REM-BEN
  7417                                     WS-WORK-LF-PREM
  7418                                     WS-WORK-ALT-LF-PREM
  7419                                     WS-WORK-CMB-LF-PREM
  7420                                     OUT-LF-REF
  7421                                     OUT-ORIG-LF-REF
  7422                                     WS-WORK-LF-REF
  7423             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7424             GO TO 1100-LF-CONT
  7425        END-IF
  7426     END-IF
  7427     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  7428         MOVE 'LIFE'             TO OUT-COVERAGE-IND
  7429                                    OUT-ORIG-COVERAGE-IND
  7430     END-IF
  7431
  7432     MOVE CM-LF-BENEFIT-CD       TO WS-LF-BENCD
  7433     MOVE CM-LF-BENEFIT-AMT      TO OUT-LF-BEN
  7434                                    OUT-ORIG-LF-BEN
  7435     MOVE CM-LF-PREMIUM-AMT      TO OUT-LF-PRM
  7436                                    OUT-ORIG-LF-PRM
  7437                                    WS-WORK-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 130
* NSRASBL.cbl
  7438     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
  7439        MOVE ZEROS               TO CM-LF-ALT-BENEFIT-AMT
  7440     END-IF
  7441     MOVE CM-LF-ALT-BENEFIT-AMT  TO OUT-LF-ALT-BEN
  7442                                    OUT-ORIG-LF-ALT-BEN
  7443     IF CM-LF-ALT-PREMIUM-AMT NOT NUMERIC
  7444        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-AMT
  7445     END-IF
  7446     MOVE CM-LF-ALT-PREMIUM-AMT  TO OUT-LF-ALT-PRM
  7447                                    OUT-ORIG-LF-ALT-PRM
  7448                                    WS-WORK-ALT-LF-PREM
  7449     COMPUTE WS-WRK-AMOUNT = CM-LF-PREMIUM-AMT +
  7450                             CM-LF-ALT-PREMIUM-AMT
  7451     MOVE WS-WRK-AMOUNT          TO OUT-LF-CMB-PREM
  7452                                 OUT-ORIG-LF-CMB-PREM
  7453                                 WS-WORK-CMB-LF-PREM
  7454     IF CM-LF-NSP-PREMIUM-AMT NOT NUMERIC
  7455        MOVE ZEROS               TO CM-LF-NSP-PREMIUM-AMT
  7456     END-IF
  7457     MOVE CM-LF-NSP-PREMIUM-AMT  TO OUT-LF-NSP
  7458     MOVE CM-LF-REMAINING-AMT    TO OUT-LF-REM-BEN
  7459     MOVE CM-LF-ITD-CANCEL-AMT   TO OUT-LF-REF
  7460                                    OUT-ORIG-LF-REF
  7461                                    WS-WORK-LF-REF
  7462     IF CM-LF-DEATH-CLAIM-APPLIED
  7463        AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  7464            MOVE PB-C-LF-CANCEL-AMT TO OUT-LF-REF
  7465                                    OUT-ORIG-LF-REF
  7466                                    WS-WORK-LF-REF
  7467     END-IF
  7468     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  7469     MOVE ' '                    TO DC-OPTION-CODE
  7470     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7471     IF NO-CONVERSION-ERROR
  7472        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7473           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7474              INTO OUT-LF-CAN-DT
  7475        END-STRING
  7476     END-IF
  7477
  7478     IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7479         MOVE ZEROS          TO WS-WORK-LF-PREM
  7480                                WS-WORK-ALT-LF-PREM
  7481                                WS-WORK-CMB-LF-PREM
  7482     END-IF
  7483
  7484      .
  7485 1100-LF-CONT.
  7486
  7487     MOVE CM-LF-ITD-DEATH-AMT    TO OUT-LF-DTH
  7488     IF CM-LF-PREMIUM-RATE NOT NUMERIC
  7489        MOVE ZEROS               TO CM-LF-PREMIUM-RATE
  7490     END-IF
  7491     MOVE CM-LF-PREMIUM-RATE     TO OUT-LF-RATE
  7492     IF CM-LF-ALT-PREMIUM-RATE NOT NUMERIC
  7493        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-RATE
  7494     END-IF
  7495     MOVE CM-LF-ALT-PREMIUM-RATE TO OUT-LF-ALT-RATE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 131
* NSRASBL.cbl
  7496     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7497        IF (PB-C-AH-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7498          (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7499              MOVE SPACES              TO OUT-AH-BENCD
  7500                                          WS-AH-BENCD
  7501                                          OUT-AH-CAN-DT
  7502              MOVE ZEROS               TO OUT-AH-TERM
  7503                                          OUT-AH-BEN
  7504                                          OUT-AH-PRM
  7505                                          OUT-AH-NSP
  7506                                          OUT-AH-COMM-PCT
  7507                                          OUT-CRIT-PER
  7508                                          WS-WORK-AH-PREM
  7509                                          OUT-AH-REF
  7510                                          OUT-ORIG-AH-REF
  7511                                          WS-WORK-AH-REF
  7512              MOVE SPACES              TO OUT-MAX-PMTS-A
  7513                                          OUT-WAIT-PER
  7514                                          OUT-RET-ELIM
  7515                                          OUT-AH-DESC
  7516                                          OUT-BEN-DAYS
  7517              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  7518             GO TO 1100-AH-CONT
  7519        END-IF
  7520     END-IF
  7521
  7522     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7523        IF (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7524              MOVE SPACES              TO OUT-AH-BENCD
  7525                                          WS-AH-BENCD
  7526                                          OUT-AH-CAN-DT
  7527              MOVE ZEROS               TO OUT-AH-TERM
  7528                                          OUT-AH-BEN
  7529                                          OUT-AH-PRM
  7530                                          OUT-AH-NSP
  7531                                          OUT-AH-COMM-PCT
  7532                                          OUT-CRIT-PER
  7533                                          WS-WORK-AH-PREM
  7534                                          OUT-AH-REF
  7535                                          OUT-ORIG-AH-REF
  7536                                          WS-WORK-AH-REF
  7537              MOVE SPACES              TO OUT-MAX-PMTS-A
  7538                                          OUT-WAIT-PER
  7539                                          OUT-RET-ELIM
  7540                                          OUT-AH-DESC
  7541                                          OUT-BEN-DAYS
  7542              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  7543             GO TO 1100-AH-CONT
  7544        END-IF
  7545     END-IF
  7546     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BENCD
  7547     MOVE CM-AH-BENEFIT-CD       TO OUT-AH-BENCD
  7548                                    OUT-ORIG-AH-BENCD
  7549     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  7550        COMPUTE OUT-AH-TOT-BEN = CM-AH-ORIG-TERM *
  7551           CM-AH-BENEFIT-AMT
  7552        IF OUT-COVERAGE-IND = 'LIFE'
  7553            MOVE 'BOTH'          TO OUT-COVERAGE-IND
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 132
* NSRASBL.cbl
  7554                                    OUT-ORIG-COVERAGE-IND
  7555        ELSE
  7556            MOVE 'AH  '          TO OUT-COVERAGE-IND
  7557                                    OUT-ORIG-COVERAGE-IND
  7558        END-IF
  7559     ELSE
  7560        MOVE ZEROS               TO OUT-AH-TOT-BEN
  7561     END-IF
  7562     MOVE CM-AH-ORIG-TERM        TO OUT-AH-TERM
  7563                                    OUT-ORIG-AH-TERM
  7564     MOVE CM-AH-CRITICAL-PERIOD  TO OUT-CRIT-PER
  7565                                    OUT-ORIG-CRIT-PER
  7566                                    OUT-MAX-PMTS
  7567                                    OUT-ORIG-MAX-PMTS
  7568     IF CM-AH-BENEFIT-CD EQUAL '00' OR SPACES
  7569         MOVE SPACES             TO OUT-MAX-PMTS-A
  7570     END-IF
  7571     MOVE CM-AH-DEV-CODE         TO OUT-AH-DEV-CD
  7572     IF CM-AH-DEV-PCT NOT NUMERIC
  7573        MOVE ZEROS               TO CM-AH-DEV-PCT
  7574     END-IF
  7575     MOVE CM-AH-DEV-PCT          TO OUT-AH-DEV-PCT
  7576     MOVE CM-AH-BENEFIT-AMT      TO OUT-AH-BEN
  7577                                    OUT-ORIG-AH-BEN
  7578     MOVE CM-AH-PREMIUM-AMT      TO OUT-AH-PRM
  7579                                    OUT-ORIG-AH-PRM
  7580                                    WS-WORK-AH-PREM
  7581     MOVE CM-AH-NSP-PREMIUM-AMT  TO OUT-AH-NSP
  7582     MOVE CM-AH-ITD-CANCEL-AMT   TO OUT-AH-REF
  7583                                    OUT-ORIG-AH-REF
  7584                                    WS-WORK-AH-REF
  7585     IF CM-AH-DEATH-CLAIM-APPLIED
  7586        AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  7587            MOVE PB-C-AH-CANCEL-AMT TO OUT-AH-REF
  7588                                    OUT-ORIG-AH-REF
  7589                                    WS-WORK-AH-REF
  7590     END-IF
  7591     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  7592     MOVE ' '                    TO DC-OPTION-CODE
  7593     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7594     IF NO-CONVERSION-ERROR
  7595        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7596           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7597              INTO OUT-AH-CAN-DT
  7598        END-STRING
  7599     END-IF
  7600
  7601     IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7602         MOVE ZEROS          TO WS-WORK-AH-PREM
  7603     END-IF
  7604
  7605      .
  7606 1100-AH-CONT.
  7607
  7608     MOVE CM-AH-ITD-AH-PMT       TO OUT-AH-CLM
  7609     MOVE CM-AH-PAID-THRU-DT     TO DC-BIN-DATE-1
  7610     MOVE ' '                    TO DC-OPTION-CODE
  7611     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 133
* NSRASBL.cbl
  7612     IF NO-CONVERSION-ERROR
  7613        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7614           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7615              INTO OUT-AH-PDTHRU-DT
  7616        END-STRING
  7617     END-IF
  7618     IF CM-AH-PREMIUM-RATE NOT NUMERIC
  7619        MOVE ZEROS               TO CM-AH-PREMIUM-RATE
  7620     END-IF
  7621     MOVE CM-AH-PREMIUM-RATE     TO OUT-AH-RATE
  7622     IF CM-LOAN-APR NOT NUMERIC
  7623        MOVE ZEROS               TO CM-LOAN-APR
  7624     END-IF
  7625     MOVE CM-LOAN-APR            TO OUT-LOAN-APR
  7626     MOVE CM-LOAN-TERM           TO OUT-LOAN-TERM
  7627     MOVE CM-RATE-CLASS          TO OUT-RATE-CLASS
  7628     MOVE CM-PMT-EXTENSION-DAYS  TO OUT-EXT-DAYS
  7629     MOVE CM-UNDERWRITING-CODE   TO OUT-UCODE
  7630     MOVE CM-PREMIUM-TYPE        TO OUT-PREM-TYPE
  7631     MOVE CM-IND-GRP-TYPE        TO OUT-IND-GRP
  7632     MOVE CM-LOAN-OFFICER        TO OUT-LOAN-OFF
  7633     MOVE CM-REIN-TABLE          TO OUT-REIN-TABLE
  7634     MOVE CM-SPECIAL-REIN-CODE   TO OUT-SPEC-REIN
  7635     MOVE CM-LF-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  7636     MOVE ' '                    TO DC-OPTION-CODE
  7637     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7638     IF NO-CONVERSION-ERROR
  7639        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7640           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7641              INTO OUT-LF-EXP-DT
  7642        END-STRING
  7643     END-IF
  7644     MOVE OUT-LF-EXP-DT          TO OUT-ORIG-LF-EXP-DT
  7645     MOVE CM-AH-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  7646     MOVE ' '                    TO DC-OPTION-CODE
  7647     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7648     IF NO-CONVERSION-ERROR
  7649        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7650           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7651              INTO OUT-AH-EXP-DT
  7652        END-STRING
  7653     END-IF
  7654     MOVE OUT-AH-EXP-DT          TO OUT-ORIG-AH-EXP-DT
  7655     MOVE CM-LOAN-1ST-PMT-DT     TO DC-BIN-DATE-1
  7656     MOVE ' '                    TO DC-OPTION-CODE
  7657     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7658     IF NO-CONVERSION-ERROR
  7659        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7660           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7661              INTO OUT-1ST-PMT-DT
  7662        END-STRING
  7663     END-IF
  7664     MOVE CM-ENTRY-STATUS        TO OUT-ENTRY-STATUS
  7665     MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  7666     MOVE ' '                    TO DC-OPTION-CODE
  7667     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7668     IF NO-CONVERSION-ERROR
  7669        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 134
* NSRASBL.cbl
  7670           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7671              INTO OUT-ENTRY-DT
  7672        END-STRING
  7673     END-IF
  7674     MOVE CM-LF-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  7675     MOVE ' '                    TO DC-OPTION-CODE
  7676     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7677     IF NO-CONVERSION-ERROR
  7678        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7679           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7680              INTO OUT-LF-CAN-EXIT-DT
  7681        END-STRING
  7682     END-IF
  7683     MOVE CM-LF-DEATH-DT         TO DC-BIN-DATE-1
  7684     MOVE ' '                    TO DC-OPTION-CODE
  7685     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7686     IF NO-CONVERSION-ERROR
  7687        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7688           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7689              INTO OUT-LF-DTH-DT
  7690        END-STRING
  7691     END-IF
  7692     MOVE CM-LF-DEATH-EXIT-DT    TO DC-BIN-DATE-1
  7693     MOVE ' '                    TO DC-OPTION-CODE
  7694     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7695     IF NO-CONVERSION-ERROR
  7696        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7697           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7698              INTO OUT-LF-DTH-EXIT-DT
  7699        END-STRING
  7700     END-IF
  7701     MOVE CM-LF-CURRENT-STATUS   TO OUT-LF-CUR-STATUS
  7702     IF OUT-AH-CAN-DT NOT = SPACES
  7703        MOVE OUT-AH-CAN-DT       TO OUT-CANCEL-DT
  7704     ELSE
  7705        MOVE OUT-LF-CAN-DT       TO OUT-CANCEL-DT
  7706     END-IF
  7707     MOVE CM-AH-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  7708     MOVE ' '                    TO DC-OPTION-CODE
  7709     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7710     IF NO-CONVERSION-ERROR
  7711        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7712           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7713              INTO OUT-AH-CAN-EXIT-DT
  7714        END-STRING
  7715     END-IF
  7716     MOVE CM-AH-CURRENT-STATUS   TO OUT-AH-CUR-STATUS
  7717     IF CM-ENTRY-BATCH = LOW-VALUES
  7718        MOVE SPACES              TO CM-ENTRY-BATCH
  7719     END-IF
  7720     MOVE CM-ENTRY-BATCH         TO OUT-ENTRY-BATCH
  7721     IF CM-LF-EXIT-BATCH = LOW-VALUES
  7722        MOVE SPACES              TO CM-LF-EXIT-BATCH
  7723     END-IF
  7724     MOVE CM-LF-EXIT-BATCH       TO OUT-LF-EXIT-BATCH
  7725     IF CM-AH-EXIT-BATCH = LOW-VALUES
  7726        MOVE SPACES              TO CM-AH-EXIT-BATCH
  7727     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 135
* NSRASBL.cbl
  7728     MOVE CM-AH-EXIT-BATCH       TO OUT-AH-EXIT-BATCH
  7729     MOVE WS-CHGBK-LIFE-PCT      TO OUT-LF-COMM-PCT
  7730     MOVE WS-CHGBK-AH-PCT        TO OUT-AH-COMM-PCT
  7731     MOVE CM-CERT-SFX            TO OUT-CERT-SFX
  7732     MOVE CM-CONTROL-PRIMARY     TO MA-CONTROL-PRIMARY
  7733     COMPUTE WS-WORK-PREM =
  7734        (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT
  7735           + CM-AH-PREMIUM-AMT)
  7736     MOVE WS-WORK-PREM           TO OUT-TOT-PRM
  7737                                    OUT-ORIG-TOT-PREM
  7738     COMPUTE WS-WORK-REF =
  7739        (WS-WORK-LF-REF + WS-WORK-AH-REF)
  7740     MOVE WS-WORK-REF            TO OUT-TOT-REF
  7741                                    OUT-ORIG-TOT-REF
  7742     IF CM-LF-LOAN-EXPIRE-DT > CM-AH-LOAN-EXPIRE-DT
  7743        MOVE OUT-LF-EXP-DT       TO OUT-SCHED-EXP-DT
  7744     ELSE
  7745        MOVE OUT-AH-EXP-DT       TO OUT-SCHED-EXP-DT
  7746     END-IF
  7747     MOVE OUT-SCHED-EXP-DT       TO OUT-ORIG-SCHED-EXP-DT
  7748     IF CM-LF-ORIG-TERM > CM-AH-ORIG-TERM
  7749        MOVE CM-LF-ORIG-TERM     TO OUT-SCHED-TERM
  7750     ELSE
  7751        MOVE CM-AH-ORIG-TERM     TO OUT-SCHED-TERM
  7752     END-IF
  7753     MOVE OUT-SCHED-TERM         TO OUT-ORIG-SCHED-TERM
  7754     IF CM-NH-INT-ON-REFS NUMERIC
  7755        IF CM-NH-INT-ON-REFS NOT = ZEROS
  7756           MOVE CM-NH-INT-ON-REFS TO OUT-TOT-INTEREST
  7757        END-IF
  7758     END-IF
  7759
  7760     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7761        IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7762            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  7763        END-IF
  7764        IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7765            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  7766        END-IF
  7767     END-IF
  7768*
  7769*     IF BL-DATA-SRCE = '2'
  7770*        IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7771*            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  7772*        END-IF
  7773*        IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7774*            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  7775*        END-IF
  7776*     END-IF
  7777
  7778     COMPUTE WS-ACCT-LF-PORTION =
  7779        WS-WORK-LF-PREM * WS-CHGBK-LIFE-PCT
  7780     MOVE WS-ACCT-LF-PORTION TO OUT-ACCT-LF-PORTION
  7781                                OUT-ACCT-ORIG-LF-PORT
  7782     COMPUTE WS-ACCT-ALT-LF-PORTION =
  7783        WS-WORK-ALT-LF-PREM * WS-CHGBK-LIFE-PCT
  7784     MOVE WS-ACCT-ALT-LF-PORTION TO OUT-ACCT-ALT-LF-PORT
  7785                                OUT-ACCT-ORIG-ALT-LF-PORT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 136
* NSRASBL.cbl
  7786     COMPUTE WS-ACCT-CMB-LF-PORTION =
  7787        WS-WORK-CMB-LF-PREM * WS-CHGBK-LIFE-PCT
  7788     MOVE WS-ACCT-CMB-LF-PORTION TO OUT-ACCT-CMB-LF-PORT
  7789                                OUT-ACCT-ORIG-CMB-LF-PORT
  7790     COMPUTE WS-ACCT-AH-PORTION =
  7791        WS-WORK-AH-PREM * WS-CHGBK-AH-PCT
  7792     MOVE WS-ACCT-AH-PORTION TO OUT-ACCT-AH-PORTION
  7793                                OUT-ACCT-ORIG-AH-PORT
  7794     COMPUTE WS-ACCT-PORTION =
  7795        WS-ACCT-CMB-LF-PORTION + WS-ACCT-AH-PORTION
  7796     MOVE WS-ACCT-PORTION TO OUT-ACCT-PORTION
  7797                                OUT-ACCT-ORIG-PORTION
  7798
  7799     COMPUTE WS-CSO-LF-PORTION =
  7800       WS-WORK-LF-PREM - WS-ACCT-LF-PORTION
  7801     MOVE WS-CSO-LF-PORTION TO OUT-CSO-LF-PORTION
  7802                               OUT-CSO-ORIG-LF-PORT
  7803     COMPUTE WS-CSO-ALT-LF-PORTION =
  7804       WS-WORK-ALT-LF-PREM - WS-ACCT-ALT-LF-PORTION
  7805     MOVE WS-CSO-ALT-LF-PORTION TO OUT-CSO-ALT-LF-PORT
  7806                                   OUT-CSO-ORIG-ALT-LF-PORT
  7807     COMPUTE WS-CSO-CMB-LF-PORTION =
  7808       WS-WORK-CMB-LF-PREM - WS-ACCT-CMB-LF-PORTION
  7809     MOVE WS-CSO-CMB-LF-PORTION TO OUT-CSO-CMB-LF-PORT
  7810                                   OUT-CSO-ORIG-CMB-LF-PORT
  7811     COMPUTE WS-CSO-AH-PORTION =
  7812        WS-WORK-AH-PREM - WS-ACCT-AH-PORTION
  7813     MOVE WS-CSO-AH-PORTION TO OUT-CSO-AH-PORTION
  7814                               OUT-CSO-ORIG-AH-PORT
  7815     COMPUTE WS-CSO-PORTION =
  7816        WS-CSO-CMB-LF-PORTION + WS-CSO-AH-PORTION
  7817     MOVE WS-CSO-PORTION TO OUT-CSO-PORTION
  7818                            OUT-CSO-ORIG-PORTION
  7819     .
  7820 1110-EXIT.
  7821     EXIT.
  7822 1115-MATCH-COMPANY.
  7823     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7824     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  7825     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7826
  7827* EXEC CICS READ
  7828*       INTO    (CONTROL-FILE)
  7829*       DATASET ('ELCNTL')
  7830*       RIDFLD  (WS-ELCNTL-KEY)
  7831*       RESP    (WS-RESPONSE)
  7832*    END-EXEC
  7833     MOVE LENGTH OF
  7834      CONTROL-FILE
  7835       TO DFHEIV11
  7836     MOVE 'ELCNTL' TO DFHEIV1
  7837*    MOVE '&"IL       E          (  N#00007644' TO DFHEIV0
  7838     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7839     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7840     MOVE X'204E233030303037363434' TO DFHEIV0(25:11)
  7841     CALL 'kxdfhei1' USING DFHEIV0,
  7842           DFHEIV1,
  7843           CONTROL-FILE,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 137
* NSRASBL.cbl
  7844           DFHEIV11,
  7845           WS-ELCNTL-KEY,
  7846           DFHEIV99,
  7847           DFHEIV99,
  7848           DFHEIV99
  7849     MOVE EIBRESP  TO WS-RESPONSE
  7850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7851     IF RESP-NORMAL
  7852        MOVE CF-COMPANY-CD       TO WS-COMPANY-CD
  7853     END-IF
  7854     .
  7855 1115-EXIT.
  7856     EXIT.
  7857 1120-MATCH-CARRIER.
  7858     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7859     MOVE '6'                    TO WS-ELCNTL-REC-TYPE
  7860     MOVE BL-CARRIER             TO WS-ELCNTL-CARR
  7861     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7862
  7863* EXEC CICS READ
  7864*       INTO    (CONTROL-FILE)
  7865*       DATASET ('ELCNTL')
  7866*       RIDFLD  (WS-ELCNTL-KEY)
  7867*       RESP    (WS-RESPONSE)
  7868*    END-EXEC
  7869     MOVE LENGTH OF
  7870      CONTROL-FILE
  7871       TO DFHEIV11
  7872     MOVE 'ELCNTL' TO DFHEIV1
  7873*    MOVE '&"IL       E          (  N#00007661' TO DFHEIV0
  7874     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7875     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7876     MOVE X'204E233030303037363631' TO DFHEIV0(25:11)
  7877     CALL 'kxdfhei1' USING DFHEIV0,
  7878           DFHEIV1,
  7879           CONTROL-FILE,
  7880           DFHEIV11,
  7881           WS-ELCNTL-KEY,
  7882           DFHEIV99,
  7883           DFHEIV99,
  7884           DFHEIV99
  7885     MOVE EIBRESP  TO WS-RESPONSE
  7886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7887     IF RESP-NORMAL
  7888        MOVE CF-MAIL-TO-NAME     TO OUT-CARR-NAME
  7889     ELSE
  7890        MOVE 'UNKNOWN'           TO OUT-CARR-NAME
  7891     END-IF
  7892     .
  7893 1120-EXIT.
  7894     EXIT.
  7895 1125-MATCH-STATE.
  7896     MOVE BL-STATE               TO OUT-STATE
  7897     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7898     MOVE '3'                    TO WS-ELCNTL-REC-TYPE
  7899     MOVE BL-STATE               TO WS-ELCNTL-STATE
  7900     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7901
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 138
* NSRASBL.cbl
  7902* EXEC CICS READ
  7903*       INTO    (CONTROL-FILE)
  7904*       DATASET ('ELCNTL')
  7905*       RIDFLD  (WS-ELCNTL-KEY)
  7906*       RESP    (WS-RESPONSE)
  7907*    END-EXEC
  7908     MOVE LENGTH OF
  7909      CONTROL-FILE
  7910       TO DFHEIV11
  7911     MOVE 'ELCNTL' TO DFHEIV1
  7912*    MOVE '&"IL       E          (  N#00007681' TO DFHEIV0
  7913     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7914     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7915     MOVE X'204E233030303037363831' TO DFHEIV0(25:11)
  7916     CALL 'kxdfhei1' USING DFHEIV0,
  7917           DFHEIV1,
  7918           CONTROL-FILE,
  7919           DFHEIV11,
  7920           WS-ELCNTL-KEY,
  7921           DFHEIV99,
  7922           DFHEIV99,
  7923           DFHEIV99
  7924     MOVE EIBRESP  TO WS-RESPONSE
  7925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7926     IF RESP-NORMAL
  7927        MOVE CF-STATE-NAME       TO OUT-STATE-NAME
  7928     ELSE
  7929        MOVE 'UNKNOWN'           TO OUT-STATE-NAME
  7930     END-IF
  7931     .
  7932 1125-EXIT.
  7933     EXIT.
  7934 1130-MATCH-BENCDS.
  7935     MOVE SPACES                 TO WS-LF-ABBRV
  7936                                    WS-LF-DESC
  7937                                    WS-LF-EARN
  7938                                    WS-WAIT-PER
  7939                                    WS-RET-ELIM
  7940                                    WS-AH-DESC
  7941                                    WS-BEN-DAYS
  7942     IF WS-LF-BENCD NOT = ZEROS AND SPACES
  7943        PERFORM 1140-MATCH-LFBEN THRU 1140-EXIT
  7944     END-IF
  7945     IF WS-AH-BENCD NOT = ZEROS AND SPACES
  7946        PERFORM 1150-MATCH-AHBEN THRU 1150-EXIT
  7947     END-IF
  7948     .
  7949 1130-EXIT.
  7950     EXIT.
  7951 1140-MATCH-LFBEN.
  7952     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7953     MOVE '4'                    TO WS-ELCNTL-REC-TYPE
  7954     MOVE WS-LF-BENCD            TO WS-ELCNTL-BEN-CD
  7955     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7956
  7957* EXEC CICS READ
  7958*       INTO    (CONTROL-FILE)
  7959*       DATASET ('ELCNTL')
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 139
* NSRASBL.cbl
  7960*       RIDFLD  (WS-ELCNTL-KEY)
  7961*       GTEQ
  7962*       RESP    (WS-RESPONSE)
  7963*    END-EXEC
  7964     MOVE LENGTH OF
  7965      CONTROL-FILE
  7966       TO DFHEIV11
  7967     MOVE 'ELCNTL' TO DFHEIV1
  7968*    MOVE '&"IL       G          (  N#00007717' TO DFHEIV0
  7969     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  7970     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7971     MOVE X'204E233030303037373137' TO DFHEIV0(25:11)
  7972     CALL 'kxdfhei1' USING DFHEIV0,
  7973           DFHEIV1,
  7974           CONTROL-FILE,
  7975           DFHEIV11,
  7976           WS-ELCNTL-KEY,
  7977           DFHEIV99,
  7978           DFHEIV99,
  7979           DFHEIV99
  7980     MOVE EIBRESP  TO WS-RESPONSE
  7981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7982     IF RESP-NORMAL
  7983        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7984           (WS-LF-BENCD = CF-BENEFIT-CODE (S1))
  7985           OR (S1 > +8)
  7986        END-PERFORM
  7987        IF S1 < + 9
  7988           MOVE CF-BENEFIT-ALPHA (S1)
  7989                                 TO WS-LF-ABBRV
  7990           MOVE WS-LF-BENCD      TO WS-LF-DESC
  7991           MOVE CF-CO-EARNINGS-CALC (S1)
  7992                                 TO WS-LF-EARN
  7993        ELSE
  7994           MOVE 'XX'             TO WS-LF-DESC
  7995           MOVE 'XXX'            TO WS-LF-ABBRV
  7996        END-IF
  7997     ELSE
  7998        DISPLAY ' NO LF BEN CD ' WS-LF-BENCD
  7999     END-IF
  8000     .
  8001 1140-EXIT.
  8002     EXIT.
  8003 1150-MATCH-AHBEN.
  8004     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8005     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  8006     MOVE WS-AH-BENCD            TO WS-ELCNTL-BEN-CD
  8007     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8008
  8009* EXEC CICS READ
  8010*       INTO    (CONTROL-FILE)
  8011*       DATASET ('ELCNTL')
  8012*       RIDFLD  (WS-ELCNTL-KEY)
  8013*       GTEQ
  8014*       RESP    (WS-RESPONSE)
  8015*    END-EXEC
  8016     MOVE LENGTH OF
  8017      CONTROL-FILE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 140
* NSRASBL.cbl
  8018       TO DFHEIV11
  8019     MOVE 'ELCNTL' TO DFHEIV1
  8020*    MOVE '&"IL       G          (  N#00007750' TO DFHEIV0
  8021     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8022     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8023     MOVE X'204E233030303037373530' TO DFHEIV0(25:11)
  8024     CALL 'kxdfhei1' USING DFHEIV0,
  8025           DFHEIV1,
  8026           CONTROL-FILE,
  8027           DFHEIV11,
  8028           WS-ELCNTL-KEY,
  8029           DFHEIV99,
  8030           DFHEIV99,
  8031           DFHEIV99
  8032     MOVE EIBRESP  TO WS-RESPONSE
  8033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8034     IF RESP-NORMAL
  8035        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8036           (WS-AH-BENCD = CF-BENEFIT-CODE (S1))
  8037           OR (S1 > +8)
  8038        END-PERFORM
  8039        IF S1 < + 9
  8040           MOVE CF-BENEFIT-ALPHA (S1)
  8041                                 TO WS-WAIT-PER
  8042           MOVE CF-BENEFIT-ALPHA (S1) (3:1)
  8043                                 TO WS-RET-ELIM
  8044           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  8045                                 TO WS-BEN-DAYS
  8046           IF CF-SPECIAL-CALC-CD (S1) = 'C'
  8047              IF CF-JOINT-INDICATOR (S1) = 'J'
  8048                 MOVE 'Joint Critical Period Disability'
  8049                                 TO WS-AH-DESC
  8050              ELSE
  8051                 MOVE 'Single Critical Period-Primary Only'
  8052                                 TO WS-AH-DESC
  8053              END-IF
  8054           ELSE
  8055              IF CF-JOINT-INDICATOR (S1) = 'J'
  8056                 MOVE 'Joint Disability'
  8057                                 TO WS-AH-DESC
  8058              ELSE
  8059                 MOVE 'Single Disability (Primary Only)'
  8060                                 TO WS-AH-DESC
  8061              END-IF
  8062           END-IF
  8063        ELSE
  8064           MOVE 'NOT FOUND'      TO WS-AH-DESC
  8065        END-IF
  8066     ELSE
  8067        DISPLAY ' NO AH BEN CD ' WS-AH-BENCD
  8068     END-IF
  8069     .
  8070 1150-EXIT.
  8071     EXIT.
  8072 1200-GET-ERACCT.
  8073     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  8074     MOVE ' UNKNOWN '            TO OUT-ACCT-NAME
  8075                                    OUT-ACCT-ADDR1
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 141
* NSRASBL.cbl
  8076                                    OUT-ACCT-ADDR2
  8077                                    OUT-ACCT-CITY
  8078     MOVE ZEROS                  TO WS-CHGBACK
  8079
  8080* EXEC CICS STARTBR
  8081*        DATASET   ('ERACCT')
  8082*        RIDFLD    (WS-ERACCT-KEY)
  8083*        GTEQ
  8084*        RESP      (WS-RESPONSE)
  8085*    END-EXEC
  8086     MOVE 'ERACCT' TO DFHEIV1
  8087     MOVE 0
  8088       TO DFHEIV11
  8089*    MOVE '&,         G          &  N#00007802' TO DFHEIV0
  8090     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8091     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8092     MOVE X'204E233030303037383032' TO DFHEIV0(25:11)
  8093     CALL 'kxdfhei1' USING DFHEIV0,
  8094           DFHEIV1,
  8095           WS-ERACCT-KEY,
  8096           DFHEIV99,
  8097           DFHEIV11,
  8098           DFHEIV99
  8099     MOVE EIBRESP  TO WS-RESPONSE
  8100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8101     IF RESP-NORMAL
  8102
  8103* EXEC CICS READNEXT
  8104*          INTO    (ACCOUNT-MASTER)
  8105*          DATASET ('ERACCT')
  8106*          RIDFLD  (WS-ERACCT-KEY)
  8107*          RESP    (WS-RESPONSE)
  8108*       END-EXEC
  8109     MOVE LENGTH OF
  8110      ACCOUNT-MASTER
  8111       TO DFHEIV12
  8112     MOVE 'ERACCT' TO DFHEIV1
  8113     MOVE 0
  8114       TO DFHEIV11
  8115*    MOVE '&.IL                  )  N#00007809' TO DFHEIV0
  8116     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8117     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8118     MOVE X'204E233030303037383039' TO DFHEIV0(25:11)
  8119     CALL 'kxdfhei1' USING DFHEIV0,
  8120           DFHEIV1,
  8121           ACCOUNT-MASTER,
  8122           DFHEIV12,
  8123           WS-ERACCT-KEY,
  8124           DFHEIV99,
  8125           DFHEIV11,
  8126           DFHEIV99,
  8127           DFHEIV99
  8128     MOVE EIBRESP  TO WS-RESPONSE
  8129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8130     END-IF
  8131     IF RESP-NORMAL
  8132        PERFORM UNTIL
  8133           NOT (RESP-NORMAL)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 142
* NSRASBL.cbl
  8134           OR (WS-SAVE-ERACCT-KEY NOT =
  8135                        AM-CONTROL-PRIMARY (1:20))
  8136           IF BL-DATA-SRCE = '4' OR '2'
  8137              IF (WS-CERT-EFF-DT < AM-EXPIRATION-DT
  8138                 AND >= AM-EFFECTIVE-DT)
  8139                 PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8140                    (AM-COM-TYP (S1) = 'C' OR 'D')
  8141                    OR (S1 > +10)
  8142                 END-PERFORM
  8143                 IF S1 < +11
  8144                    MOVE AM-COMM-CHARGEBACK (S1)
  8145                                 TO WS-CHGBACK
  8146                 END-IF
  8147              END-IF
  8148           END-IF
  8149           MOVE ACCOUNT-MASTER   TO WS-SAVE-ERACCT-REC
  8150
  8151* EXEC CICS READNEXT
  8152*             INTO    (ACCOUNT-MASTER)
  8153*             DATASET ('ERACCT')
  8154*             RIDFLD  (WS-ERACCT-KEY)
  8155*             RESP    (WS-RESPONSE)
  8156*          END-EXEC
  8157     MOVE LENGTH OF
  8158      ACCOUNT-MASTER
  8159       TO DFHEIV12
  8160     MOVE 'ERACCT' TO DFHEIV1
  8161     MOVE 0
  8162       TO DFHEIV11
  8163*    MOVE '&.IL                  )  N#00007835' TO DFHEIV0
  8164     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8165     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8166     MOVE X'204E233030303037383335' TO DFHEIV0(25:11)
  8167     CALL 'kxdfhei1' USING DFHEIV0,
  8168           DFHEIV1,
  8169           ACCOUNT-MASTER,
  8170           DFHEIV12,
  8171           WS-ERACCT-KEY,
  8172           DFHEIV99,
  8173           DFHEIV11,
  8174           DFHEIV99,
  8175           DFHEIV99
  8176     MOVE EIBRESP  TO WS-RESPONSE
  8177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8178        END-PERFORM
  8179        MOVE WS-SAVE-ERACCT-REC  TO ACCOUNT-MASTER
  8180        IF WS-SAVE-ERACCT-KEY = AM-CONTROL-PRIMARY (1:20)
  8181           SET ACCT-FOUND TO TRUE
  8182           MOVE AM-NAME          TO OUT-ACCT-NAME
  8183           MOVE AM-ADDRS         TO OUT-ACCT-ADDR1
  8184           MOVE SPACES           TO OUT-ACCT-ADDR2
  8185           MOVE AM-ADDR-CITY     TO OUT-ACCT-CITY
  8186           MOVE AM-ADDR-STATE    TO OUT-ACCT-STATE
  8187           MOVE AM-ZIP-PRIME     TO OUT-ACCT-ZIP
  8188           MOVE AM-REPORT-CODE-1 TO OUT-RPT-CD1
  8189           MOVE AM-REPORT-CODE-2 TO OUT-RPT-CD2
  8190           IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  8191              STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 143
* NSRASBL.cbl
  8192                 INTO OUT-ACCT-ZIP (6:5)
  8193              END-STRING
  8194           END-IF
  8195           MOVE AM-TEL-NO        TO OUT-ACCT-PHONE
  8196           MOVE AM-GPCD          TO OUT-ACCT-BUS-TYPE
  8197           MOVE AM-STATE         TO OUT-FORM
  8198           IF AM-ACCOUNT (10:1) = 'L'
  8199              MOVE 'L'           TO OUT-FORM (3:1)
  8200                                    OUT-LEASE-IND
  8201           END-IF
  8202           MOVE AM-CONTROL-PRIMARY (1:8)
  8203                                 TO WS-ERCOMP-KEY
  8204           IF AM-REMIT-TO NOT NUMERIC
  8205              MOVE 01            TO AM-REMIT-TO
  8206           END-IF
  8207           MOVE AM-AGT (AM-REMIT-TO) TO WS-ERCOMP-RESP-NO
  8208           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8209              (AM-COM-TYP (S1) = 'C' OR 'D')
  8210              OR (S1 > +10)
  8211           END-PERFORM
  8212           IF S1 < +11
  8213              MOVE AM-AGT (S1)   TO WS-ERCOMP-ACCOUNT
  8214           END-IF
  8215           MOVE 'A'              TO WS-ERCOMP-REC-TYPE
  8216           PERFORM 1225-GET-ERCOMP THRU 1225-EXIT
  8217        END-IF
  8218     END-IF
  8219
  8220* EXEC CICS ENDBR
  8221*        DATASET   ('ERACCT')
  8222*    END-EXEC
  8223     MOVE 'ERACCT' TO DFHEIV1
  8224     MOVE 0
  8225       TO DFHEIV11
  8226*    MOVE '&2                    $   #00007882' TO DFHEIV0
  8227     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8228     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8229     MOVE X'2020233030303037383832' TO DFHEIV0(25:11)
  8230     CALL 'kxdfhei1' USING DFHEIV0,
  8231           DFHEIV1,
  8232           DFHEIV11,
  8233           DFHEIV99
  8234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8235    .
  8236 1200-EXIT.
  8237     EXIT.
  8238 1225-GET-ERCOMP.
  8239
  8240* EXEC CICS READ
  8241*       INTO    (COMPENSATION-MASTER)
  8242*       DATASET ('ERCOMP')
  8243*       RIDFLD  (WS-ERCOMP-KEY)
  8244*       RESP    (WS-RESPONSE)
  8245*    END-EXEC
  8246     MOVE LENGTH OF
  8247      COMPENSATION-MASTER
  8248       TO DFHEIV11
  8249     MOVE 'ERCOMP' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 144
* NSRASBL.cbl
  8250*    MOVE '&"IL       E          (  N#00007889' TO DFHEIV0
  8251     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8252     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8253     MOVE X'204E233030303037383839' TO DFHEIV0(25:11)
  8254     CALL 'kxdfhei1' USING DFHEIV0,
  8255           DFHEIV1,
  8256           COMPENSATION-MASTER,
  8257           DFHEIV11,
  8258           WS-ERCOMP-KEY,
  8259           DFHEIV99,
  8260           DFHEIV99,
  8261           DFHEIV99
  8262     MOVE EIBRESP  TO WS-RESPONSE
  8263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8264     IF RESP-NORMAL
  8265        MOVE CO-RESP-NO          TO OUT-RESP-NO
  8266        MOVE CO-ACCT-NAME        TO OUT-COMP-NAME
  8267        MOVE CO-MAIL-NAME        TO OUT-COMP-MAIL-TO
  8268        MOVE CO-ADDR-1           TO OUT-COMP-ADDR1
  8269        MOVE CO-ADDR-2           TO OUT-COMP-ADDR2
  8270        MOVE CO-ADDR-CITY        TO OUT-COMP-CITY
  8271        MOVE CO-ADDR-STATE       TO OUT-COMP-STATE
  8272        MOVE CO-ZIP              TO OUT-COMP-ZIP
  8273        MOVE CO-TELEPHONE        TO OUT-COMP-PHONE
  8274        MOVE CO-FAXNO            TO OUT-COMP-FAX
  8275        MOVE CO-GA-STATUS-CODE   TO OUT-COMP-STATUS
  8276        MOVE CO-BILL-SW          TO OUT-BILL-SW
  8277     END-IF
  8278     .
  8279 1225-EXIT.
  8280     EXIT.
  8281 1250-GET-ELLETR.
  8282     display ' made it to 1250 '
  8283     move spaces                 to W-Z-CONTROL-DATA
  8284     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  8285     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  8286     MOVE +0                     TO WS-ELLETR-SEQ-NO
  8287
  8288* EXEC CICS READ
  8289*         DATASET    ('ELLETR')
  8290*         INTO       (TEXT-FILES)
  8291*         RIDFLD     (WS-ELLETR-KEY)
  8292*         RESP       (WS-RESPONSE)
  8293*         GTEQ
  8294*    END-EXEC
  8295     MOVE LENGTH OF
  8296      TEXT-FILES
  8297       TO DFHEIV11
  8298     MOVE 'ELLETR' TO DFHEIV1
  8299*    MOVE '&"IL       G          (  N#00007918' TO DFHEIV0
  8300     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8301     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8302     MOVE X'204E233030303037393138' TO DFHEIV0(25:11)
  8303     CALL 'kxdfhei1' USING DFHEIV0,
  8304           DFHEIV1,
  8305           TEXT-FILES,
  8306           DFHEIV11,
  8307           WS-ELLETR-KEY,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 145
* NSRASBL.cbl
  8308           DFHEIV99,
  8309           DFHEIV99,
  8310           DFHEIV99
  8311     MOVE EIBRESP  TO WS-RESPONSE
  8312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8313     IF RESP-NORMAL
  8314        IF (LETTER-FILE-TEXT)
  8315           AND (BL-LETTER-ID = TX-LETTER-NO)
  8316           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  8317           display ' found good z record '
  8318           PERFORM 1280-PROCESS-Z-CONTROLS
  8319                                 THRU 1280-EXIT
  8320        END-IF
  8321     END-IF
  8322     .
  8323 1250-EXIT.
  8324     EXIT.
  8325 1280-PROCESS-Z-CONTROLS.
  8326     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  8327*    IF W-FORM-TO-RESEND > SPACES
  8328*       MOVE W-FORM-TO-RESEND    TO OUT-FORM
  8329*    ELSE
  8330*       MOVE SPACES              TO OUT-FORM
  8331*    END-IF
  8332     MOVE W-ENCLOSURE-CD         TO BL-ENC-CD
  8333     MOVE W-LETTER-TYPE          TO OUT-LETTER-TYPE
  8334     MOVE W-PRINT-CERTIFICATE    TO OUT-PRINT-CERTIFICATE
  8335     .
  8336 1280-EXIT.
  8337     EXIT.
  8338 1300-DETERMINE-COMM.
  8339******************************************************************
  8340* DATA SOURCE MEANINGS  BL-DATA-SRCE
  8341*    1) FROM ACCT MAINT
  8342*    2) FROM CERT UPDATE
  8343*    3) FROM COMP MAINT
  8344*    4) FROM REVIEW AND CORRECTIONS
  8345******************************************************************
  8346     MOVE 'Y'                    TO OUT-CHGBACK
  8347     MOVE ZEROS                  TO WS-DIFF
  8348                                    WS-CHGBK-LIFE-PCT
  8349                                    WS-CHGBK-AH-PCT
  8350     IF BL-DATA-SRCE = '4'
  8351        IF PB-CANCELLATION
  8352           MOVE PB-CI-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8353           MOVE PB-CI-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8354           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
  8355           MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-2
  8356           IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  8357              MOVE PB-C-LF-CANCEL-DT
  8358                                 TO DC-BIN-DATE-2
  8359           END-IF
  8360           MOVE '1'              TO DC-OPTION-CODE
  8361           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8362           IF NO-CONVERSION-ERROR
  8363              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8364              IF DC-ODD-DAYS-OVER > +1
  8365                 ADD +1          TO WS-DIFF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 146
* NSRASBL.cbl
  8366              END-IF
  8367              IF (WS-CHGBACK = 99)
  8368                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8369                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8370                                WS-CHGBK-AH-PCT
  8371                   MOVE 'N'  TO OUT-CHGBACK
  8372              END-IF
  8373           END-IF
  8374        ELSE
  8375           MOVE PB-I-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8376           MOVE PB-I-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8377        END-IF
  8378     ELSE
  8379        MOVE CM-LIFE-COMM-PCT TO WS-CHGBK-LIFE-PCT
  8380        MOVE CM-AH-COMM-PCT   TO WS-CHGBK-AH-PCT
  8381        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8382           OR (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8383           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  8384           MOVE CM-AH-CANCEL-DT  TO DC-BIN-DATE-2
  8385           IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  8386              MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  8387           END-IF
  8388           MOVE '1'              TO DC-OPTION-CODE
  8389           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8390           IF NO-CONVERSION-ERROR
  8391              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8392              IF DC-ODD-DAYS-OVER > +1
  8393                 ADD +1          TO WS-DIFF
  8394              END-IF
  8395              IF (WS-CHGBACK = 99)
  8396                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8397                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8398                                WS-CHGBK-AH-PCT
  8399                   MOVE 'N'  TO OUT-CHGBACK
  8400              END-IF
  8401           END-IF
  8402        END-IF
  8403     END-IF
  8404     .
  8405 1300-EXIT.
  8406     EXIT.
  8407 1500-GET-ARCH-NO.
  8408     DISPLAY ' MADE IT TO 1500 '
  8409     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  8410     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8411     MOVE SPACES                 TO WS-ELCNTL-GENL
  8412     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8413
  8414* EXEC CICS READ
  8415*       INTO    (CONTROL-FILE)
  8416*       DATASET ('ELCNTL')
  8417*       RIDFLD  (WS-ELCNTL-KEY)
  8418*       UPDATE
  8419*       RESP    (WS-RESPONSE)
  8420*    END-EXEC
  8421     MOVE LENGTH OF
  8422      CONTROL-FILE
  8423       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 147
* NSRASBL.cbl
  8424     MOVE 'ELCNTL' TO DFHEIV1
  8425*    MOVE '&"IL       EU         (  N#00008025' TO DFHEIV0
  8426     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8427     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8428     MOVE X'204E233030303038303235' TO DFHEIV0(25:11)
  8429     CALL 'kxdfhei1' USING DFHEIV0,
  8430           DFHEIV1,
  8431           CONTROL-FILE,
  8432           DFHEIV11,
  8433           WS-ELCNTL-KEY,
  8434           DFHEIV99,
  8435           DFHEIV99,
  8436           DFHEIV99
  8437     MOVE EIBRESP  TO WS-RESPONSE
  8438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8439     IF RESP-NORMAL
  8440        AND (CF-COMPANY-ID  = BL-COMP-ID)
  8441        AND (CF-RECORD-TYPE = '1')
  8442        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  8443        MOVE CF-CREDIT-LAST-ARCH-NUM
  8444                                 TO WS-ARCHIVE-NO
  8445
  8446* EXEC CICS REWRITE
  8447*          FROM    (CONTROL-FILE)
  8448*          DATASET ('ELCNTL')
  8449*       END-EXEC
  8450     MOVE LENGTH OF
  8451      CONTROL-FILE
  8452       TO DFHEIV11
  8453     MOVE 'ELCNTL' TO DFHEIV1
  8454*    MOVE '&& L                  %   #00008038' TO DFHEIV0
  8455     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8456     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8457     MOVE X'2020233030303038303338' TO DFHEIV0(25:11)
  8458     CALL 'kxdfhei1' USING DFHEIV0,
  8459           DFHEIV1,
  8460           CONTROL-FILE,
  8461           DFHEIV11,
  8462           DFHEIV99
  8463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8464     ELSE
  8465        MOVE +0                  TO WS-ARCHIVE-NO
  8466     END-IF
  8467    .
  8468 1500-EXIT.
  8469     EXIT.
  8470 1700-GET-ELENCC.
  8471     MOVE WS-COMPANY-CD          TO WS-ELENCC-KEY
  8472     MOVE '2'                    TO WS-ELENCC-REC-TYPE
  8473     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  8474     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  8475        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  8476        OR (E1 > +5)
  8477     END-PERFORM
  8478     IF E1 < +5
  8479        MOVE BL-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  8480     END-IF
  8481
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 148
* NSRASBL.cbl
  8482* EXEC CICS READ
  8483*        DATASET   ('ELENCC')
  8484*        INTO      (ENCLOSURE-CODES)
  8485*        RIDFLD    (WS-ELENCC-KEY)
  8486*        RESP      (WS-RESPONSE)
  8487*    END-EXEC
  8488     MOVE LENGTH OF
  8489      ENCLOSURE-CODES
  8490       TO DFHEIV11
  8491     MOVE 'ELENCC' TO DFHEIV1
  8492*    MOVE '&"IL       E          (  N#00008059' TO DFHEIV0
  8493     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8494     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8495     MOVE X'204E233030303038303539' TO DFHEIV0(25:11)
  8496     CALL 'kxdfhei1' USING DFHEIV0,
  8497           DFHEIV1,
  8498           ENCLOSURE-CODES,
  8499           DFHEIV11,
  8500           WS-ELENCC-KEY,
  8501           DFHEIV99,
  8502           DFHEIV99,
  8503           DFHEIV99
  8504     MOVE EIBRESP  TO WS-RESPONSE
  8505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8506     IF NOT RESP-NORMAL
  8507        display ' elencc resp not normal ' ws-response
  8508        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  8509
  8510* EXEC CICS READ
  8511*           DATASET   ('ELENCC')
  8512*           INTO      (ENCLOSURE-CODES)
  8513*           RIDFLD    (WS-ELENCC-KEY)
  8514*           RESP      (WS-RESPONSE)
  8515*       END-EXEC
  8516     MOVE LENGTH OF
  8517      ENCLOSURE-CODES
  8518       TO DFHEIV11
  8519     MOVE 'ELENCC' TO DFHEIV1
  8520*    MOVE '&"IL       E          (  N#00008068' TO DFHEIV0
  8521     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8522     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8523     MOVE X'204E233030303038303638' TO DFHEIV0(25:11)
  8524     CALL 'kxdfhei1' USING DFHEIV0,
  8525           DFHEIV1,
  8526           ENCLOSURE-CODES,
  8527           DFHEIV11,
  8528           WS-ELENCC-KEY,
  8529           DFHEIV99,
  8530           DFHEIV99,
  8531           DFHEIV99
  8532     MOVE EIBRESP  TO WS-RESPONSE
  8533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8534     END-IF
  8535     IF RESP-NORMAL
  8536        display ' elencc resp normal ' ws-response
  8537        MOVE NC-OUTPUT-STACK     TO OUT-STACK
  8538        MOVE NC-ENCLOSURE-LINE   TO OUT-ENC-LINE
  8539        MOVE NC-ATTACHMENTS      TO OUT-ATTACH
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:07 Page 149
* NSRASBL.cbl
  8540     END-IF
  8541     .
  8542 1700-EXIT.
  8543     EXIT.
  8544 9700-DATE-LINK.
  8545
  8546* EXEC CICS LINK
  8547*        PROGRAM   ('ELDATCV')
  8548*        COMMAREA  (DATE-CONVERSION-DATA)
  8549*        LENGTH    (DC-COMM-LENGTH)
  8550*    END-EXEC.
  8551     MOVE 'ELDATCV' TO DFHEIV1
  8552*    MOVE '."C                   (   #00008085' TO DFHEIV0
  8553     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8555     MOVE X'2020233030303038303835' TO DFHEIV0(25:11)
  8556     CALL 'kxdfhei1' USING DFHEIV0,
  8557           DFHEIV1,
  8558           DATE-CONVERSION-DATA,
  8559           DC-COMM-LENGTH,
  8560           DFHEIV99,
  8561           DFHEIV99,
  8562           DFHEIV99,
  8563           DFHEIV99
  8564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8565
  8566 9700-EXIT.
  8567      EXIT.
  8568
  8569 9999-DFHBACK SECTION.
  8570     MOVE '9%                    "   ' TO DFHEIV0
  8571     MOVE 'NSRASBL' TO DFHEIV1
  8572     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8573     GOBACK.
  8574 9999-DFHEXIT.
  8575     IF DFHEIGDJ EQUAL 0001
  8576         NEXT SENTENCE.
  8577     MOVE '9%                    "   ' TO DFHEIV0
  8578     MOVE 'NSRASBL' TO DFHEIV1
  8579     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8580     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34476     Code:       53240
