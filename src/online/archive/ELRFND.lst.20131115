* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   1
* ELRFND.cbl
* Options: int("ELRFND.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRFND.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRFND.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRFND.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRFND.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:23:50.
     7*                            VMOD=2.011
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   2
* ELRFND.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM REFUNDS      *
    28*            *****************************************************
    29
    30
    31******************************************************************
    32*                                                                *
    33*              INPUT FIELDS USED                                 *
    34*                                                                *
    35******************************************************************
    36*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    37*  REFUND DATE      - CP-VALUATION-DT                            *
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM                           *
    39*  LOAN TERM        - CP-LOAN-TERM                               *
    40*  REMAINING TERM   - CP-REMAINING-TERM                          *
    41*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    42*  STATE CODE       - CP-STATE                                   *
    43*  STATE CODE       - CP-STATE-STD-ABBV                          *
    44*  CLASS CODE       - CP-CLASS-CODE                              *
    45*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    46*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    47*  PROCESS TYPE     - CP-PROCESS-TYPE                            *
    48*  BENEFIT KIND     - CP-BENEFIT-TYPE                            *
    49*  A.P.R.           - CP-LOAN-APR                                *
    50*  METHOD           - CP-EARNING-METHOD                          *
    51*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  COMPANY I.D.     - CP-COMPANY-ID                              *
    54*  BENEFIT CODE     - CP-BENEFIT-CD                              *
    55*  INSURED AGE      - CP-ISSUE-AGE                               *
    56******************************************************************
    57 ENVIRONMENT DIVISION.
    58
    59 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   3
* ELRFND.cbl
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63 77  FILLER   PIC X(32) VALUE '********************************'.
    64 77  FILLER   PIC X(32) VALUE '**  ELRFND  WORKING STORAGE   **'.
    65 77  FILLER   PIC X(32) VALUE '********VMOD=2.011 *************'.
    66 77  WS-UE-CLP                   PIC S9(5)V99 COMP-3 VALUE +0.
    67 77  WS-GFR3                     PIC S9(5)V99 COMP-3 VALUE +0.
    68 77  WS-MONTH                    PIC S999     COMP-3 VALUE +0.
    69
    70 01  WS-WORK-MISC.
    71     12  WS-REMAINING-TERM   PIC S9(4)V9      COMP-3.
    72     12  WS-TEMP-RESULT      PIC S9(7)V9(6)   COMP-3.
    73     12  WS-REMAINING-AMT    PIC S9(7)V9(6)   COMP-3.
    74     12  WS-ORIG-PREM        PIC S9(7)V9(6)   COMP-3.
    75     12  WS-REMAIN-PREM      PIC S9(7)V9(6)   COMP-3.
    76     12  WS-NP-REF-FACTOR    PIC S9(4)V9(11)  COMP-3.
    77     12  WS-SAVE-TERM        PIC S9(3)        COMP-3.
    78     12  WS-SAVE-LOAN-TERM   PIC S9(3)        COMP-3.
    79     12  WS-SAVE-BENEFIT     PIC S9(9)V99     COMP-3.
    80     12  WS-SAVE-EARN-METHOD PIC X.
    81     12  CAL-RFND            PIC S9(5)V99     COMP-3.
    82     12  FACTOR-1            PIC S9(4)V9(11)  COMP-3.
    83     12  FACTOR-2            PIC S9(4)V9(11)  COMP-3.
    84     12  FACTOR-3            PIC S9(4)V9(11)  COMP-3.
    85     12  FACTOR-4            PIC S9(4)V9(11)  COMP-3.
    86     12  FACTOR-5            PIC S9(7)        COMP-3.
    87     12  FACTOR-6            PIC S9(7)        COMP-3.
    88     12  RATE-FACTOR-1       PIC S9V99        COMP-3.
    89     12  RATE-FACTOR-2       PIC S999         COMP-3.
    90     12  R78-FACTOR          PIC S9(4)V9(11)  COMP-3.
    91     12  PR-FACTOR           PIC S9(4)V9(11)  COMP-3.
    92     12  RSUM-FACTOR         PIC S9(4)V9(11)  COMP-3.
    93     12  RSUM-REMAINING-TERM PIC S9(3)V99     COMP-3.
    94
    95 01  TEXAS-REG-WORK-AREAS.
    96     12  TEX-FACT-1          PIC S9(7)V9(2)  COMP-3.
    97     12  TEX-FACT-2          PIC S9(3)       COMP-3.
    98     12  TEX-FACT-3          PIC S9(3)       COMP-3.
    99     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   100     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   101     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   102     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   103     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   104     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   105
   106 01  NET-PAY-INTERFACE.
   107     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   108     12  N-P-ORIG            PIC S9(3)       COMP-3.
   109     12  N-P-REM             PIC S9(3)       COMP-3.
   110     12  N-P-OPT             PIC X.
   111     12  N-P-LOAN            PIC S9(3)       COMP-3.
   112     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   113
   114*                        COPY ERCNETWS.
   115*****************************************************************
   116*                                                               *
   117*                                                               *
   118*                            ERCNETWS                           *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   4
* ELRFND.cbl
   119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   120*                            VMOD=2.014                         *
   121*                                                               *
   122*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   123*                                                               *
   124*****************************************************************.
   125*                   C H A N G E   L O G
   126*
   127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   128*-----------------------------------------------------------------
   129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   130* EFFECTIVE    NUMBER
   131*-----------------------------------------------------------------
   132* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   133* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   134* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   135* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   136******************************************************************
   137
   138 01  NET-PAY-WORK-AREA.
   139     12  OPTION-SW               PIC X   VALUE 'X'.
   140        88  NPO-STD         VALUE SPACE.
   141        88  NPO-ALT         VALUE 'A'.
   142        88  NPO-SIMPLE      VALUE 'S'.
   143        88  NPO-2MO         VALUE 'I'.
   144        88  NPO-3MO         VALUE 'J'.
   145        88  NPO-4MO         VALUE 'K'.
   146        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   147        88  NPO-TRUNC-0     VALUE 'T'.
   148        88  NPO-TRUNC-1     VALUE 'U'.
   149        88  NPO-TRUNC-2     VALUE 'V'.
   150        88  NPO-TRUNC-3     VALUE 'W'.
   151        88  NPO-TRUNC-4     VALUE 'X'.
   152        88  NPO-REFUND      VALUE 'R'.
   153        88  NPO-PRUDENTIAL  VALUE 'P'.
   154
   155     12  TYPE-SW             PIC X   VALUE 'N'.
   156        88  NET-STD             VALUE 'N'.
   157        88  NET-SMP             VALUE 'S'.
   158
   159     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   160        88  NP-RATING           VALUE '1'.
   161        88  NP-REFUND           VALUE '2'.
   162        88  NP-REMAIN-AMT       VALUE '3'.
   163
   164     12  COMP-3-WORK-AREA         COMP-3.
   165         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   166         16  V               PIC SV9(13)       VALUE +.0.
   167         16  J               PIC SV9(9)        VALUE +0.
   168         16  K               PIC SV9(9)        VALUE +0.
   169         16  I               PIC SV9(10)       VALUE +.0.
   170         16  D               PIC S9(5)         VALUE +.0.
   171         16  APR100          PIC SV9(9)        VALUE +.0.
   172         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   173         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   174         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   175         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   176         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   5
* ELRFND.cbl
   177         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   178         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   179         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   180         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   181         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   182         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   183         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   184         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   185         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   186         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   187         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   188         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   189         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   190         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   191         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   192         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   193         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   194         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   195         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   196         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   197         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   198         16  K1              PIC S999          VALUE +1.
   199         16  K12             PIC S999          VALUE +12.
   200         16  K100            PIC S999          VALUE +100.
   201         16  K1000           PIC S9(7)         VALUE +1000.
   202         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   203         16  Y REDEFINES NC-LR
   204                             PIC S99V9(5).
   205         16  TI              PIC S999V9(5)     VALUE +0.
   206         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   207         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   208         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   209         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   210         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   211         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   212         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   213         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   214
   215         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   216         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   217         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   218         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   219         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   220         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   221         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
   222         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   223         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   224         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   225         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   226         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   227         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   228
   229         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
   230
   231         16  ORIGINAL-TERM   PIC S999.
   232         16  M              REDEFINES ORIGINAL-TERM
   233                             PIC S999.
   234
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   6
* ELRFND.cbl
   235         16  REMAINING-TERM  PIC S999.
   236         16  R              REDEFINES REMAINING-TERM
   237                             PIC S999.
   238
   239         16  LOAN-TERM       PIC S999.
   240         16  N              REDEFINES LOAN-TERM
   241                             PIC S999.
   242
   243         16  EXPIRED-TERM    PIC S999.
   244         16  E              REDEFINES EXPIRED-TERM
   245                             PIC S999.
   246
   247         16  PRUDENTIAL-WORK-AMT
   248                             PIC S9(7)V9(8).
   249         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   250                             PIC S9(7)V9(8).
   251
   252         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   253         16  VX              PIC S9V9(13)      VALUE +0.0.
   254         16  SV              PIC S9V9(13)      VALUE +0.0.
   255         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   256         16  SX              PIC S9V9(13)      VALUE +0.0.
   257         16  SE              PIC S9V9(10)      VALUE +0.0.
   258         16  N2              PIC S9(7)         VALUE +0.
   259         16  N3              PIC S9(7)         VALUE +0.
   260         16  K-I             PIC S9V9(8)       VALUE +0.0.
   261
   262     12  BINARY-WORK-AREA        COMP.
   263         16  X1              PIC S999        VALUE +0.
   264         16  X2              PIC S999        VALUE +0.
   265         16  MAX-X           PIC S9(5)       VALUE +0.
   266         16  B1              PIC S9(5)       VALUE +1.
   267         16  LINDX           PIC S999        VALUE ZEROS.
   268         16  AHNDX           PIC S999        VALUE ZEROS.
   269
   270     12  CSO-RATE-WORK-AREAS.
   271         16  C-PMTS-PER-YEAR     PIC S999 COMP-3 VALUE ZEROS.
   272         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   273         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   274     12  WS-WORK-MISC.
   275         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   276         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   277*        16  WS-AGE              PIC 99           VALUE ZEROS.
   278         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   279         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   280         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   281         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   282         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   283         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   284         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   285         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   286         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   287         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
   288         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   289         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   290******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   7
* ELRFND.cbl
   292*                        COPY ELCDATE.
   293******************************************************************
   294*                                                                *
   295*                                                                *
   296*                            ELCDATE.                            *
   297*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   298*                            VMOD=2.003
   299*                                                                *
   300*                                                                *
   301*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   302*                 LENGTH = 200                                   *
   303******************************************************************
   304
   305 01  DATE-CONVERSION-DATA.
   306     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   307     12  DC-OPTION-CODE                PIC X.
   308         88  BIN-TO-GREG                VALUE ' '.
   309         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   310         88  EDIT-GREG-TO-BIN           VALUE '2'.
   311         88  YMD-GREG-TO-BIN            VALUE '3'.
   312         88  MDY-GREG-TO-BIN            VALUE '4'.
   313         88  JULIAN-TO-BIN              VALUE '5'.
   314         88  BIN-PLUS-ELAPSED           VALUE '6'.
   315         88  FIND-CENTURY               VALUE '7'.
   316         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   317         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   318         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   319         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   320         88  JULIAN-TO-BIN-3            VALUE 'C'.
   321         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   322         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   323         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   324         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   325         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   326         88  CHECK-LEAP-YEAR            VALUE 'H'.
   327         88  BIN-3-TO-GREG              VALUE 'I'.
   328         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   329         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   330         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   331         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   332         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   333         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   334         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   335         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   336         88  THREE-CHARACTER-BIN
   337                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   338         88  GREGORIAN-TO-BIN
   339                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   340         88  BIN-TO-GREGORIAN
   341                  VALUES ' ' '1' 'I' '8' 'G'.
   342         88  JULIAN-TO-BINARY
   343                  VALUES '5' 'C' 'E' 'F'.
   344     12  DC-ERROR-CODE                 PIC X.
   345         88  NO-CONVERSION-ERROR        VALUE ' '.
   346         88  DATE-CONVERSION-ERROR
   347                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   348         88  DATE-IS-ZERO               VALUE '1'.
   349         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   8
* ELRFND.cbl
   350         88  DATE-IS-INVALID            VALUE '3'.
   351         88  DATE1-GREATER-DATE2        VALUE '4'.
   352         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   353         88  DATE-INVALID-OPTION        VALUE '9'.
   354         88  INVALID-CENTURY            VALUE 'A'.
   355         88  ONLY-CENTURY               VALUE 'B'.
   356         88  ONLY-LEAP-YEAR             VALUE 'C'.
   357         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   358     12  DC-END-OF-MONTH               PIC X.
   359         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   360     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   361         88  USE-NORMAL-PROCESS         VALUE ' '.
   362         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   363         88  ADJUST-UP-100-YRS          VALUE '2'.
   364     12  FILLER                        PIC X.
   365     12  DC-CONVERSION-DATES.
   366         16  DC-BIN-DATE-1             PIC XX.
   367         16  DC-BIN-DATE-2             PIC XX.
   368         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   369         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   370                       DC-GREG-DATE-1-EDIT.
   371             20  DC-EDIT1-MONTH        PIC 99.
   372             20  SLASH1-1              PIC X.
   373             20  DC-EDIT1-DAY          PIC 99.
   374             20  SLASH1-2              PIC X.
   375             20  DC-EDIT1-YEAR         PIC 99.
   376         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   377         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   378                     DC-GREG-DATE-2-EDIT.
   379             20  DC-EDIT2-MONTH        PIC 99.
   380             20  SLASH2-1              PIC X.
   381             20  DC-EDIT2-DAY          PIC 99.
   382             20  SLASH2-2              PIC X.
   383             20  DC-EDIT2-YEAR         PIC 99.
   384         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   385         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   386                     DC-GREG-DATE-1-YMD.
   387             20  DC-YMD-YEAR           PIC 99.
   388             20  DC-YMD-MONTH          PIC 99.
   389             20  DC-YMD-DAY            PIC 99.
   390         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   391         16  DC-GREG-DATE-1-MDY-R REDEFINES
   392                      DC-GREG-DATE-1-MDY.
   393             20  DC-MDY-MONTH          PIC 99.
   394             20  DC-MDY-DAY            PIC 99.
   395             20  DC-MDY-YEAR           PIC 99.
   396         16  DC-GREG-DATE-1-ALPHA.
   397             20  DC-ALPHA-MONTH        PIC X(10).
   398             20  DC-ALPHA-DAY          PIC 99.
   399             20  FILLER                PIC XX.
   400             20  DC-ALPHA-CENTURY.
   401                 24 DC-ALPHA-CEN-N     PIC 99.
   402             20  DC-ALPHA-YEAR         PIC 99.
   403         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   404         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   405         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   406         16  DC-JULIAN-DATE            PIC 9(05).
   407         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   9
* ELRFND.cbl
   408                                       PIC 9(05).
   409         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   410             20  DC-JULIAN-YEAR        PIC 99.
   411             20  DC-JULIAN-DAYS        PIC 999.
   412         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   413         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   414         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   415     12  DATE-CONVERSION-VARIBLES.
   416         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   417         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   418             20  FILLER                PIC 9(3).
   419             20  HOLD-CEN-1-CCYY.
   420                 24  HOLD-CEN-1-CC     PIC 99.
   421                 24  HOLD-CEN-1-YY     PIC 99.
   422             20  HOLD-CEN-1-MO         PIC 99.
   423             20  HOLD-CEN-1-DA         PIC 99.
   424         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   425             20  HOLD-CEN-1-R-MO       PIC 99.
   426             20  HOLD-CEN-1-R-DA       PIC 99.
   427             20  HOLD-CEN-1-R-CCYY.
   428                 24  HOLD-CEN-1-R-CC   PIC 99.
   429                 24  HOLD-CEN-1-R-YY   PIC 99.
   430             20  FILLER                PIC 9(3).
   431         16  HOLD-CENTURY-1-X.
   432             20  FILLER                PIC X(3)  VALUE SPACES.
   433             20  HOLD-CEN-1-X-CCYY.
   434                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   435                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   436             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   437             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   438         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   439             20  HOLD-CEN-1-R-X-MO     PIC XX.
   440             20  HOLD-CEN-1-R-X-DA     PIC XX.
   441             20  HOLD-CEN-1-R-X-CCYY.
   442                 24  HOLD-CEN-1-R-X-CC PIC XX.
   443                 24  HOLD-CEN-1-R-X-YY PIC XX.
   444             20  FILLER                PIC XXX.
   445         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   446         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   447         16  DC-JULIAN-DATE-1          PIC 9(07).
   448         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   449             20  DC-JULIAN-1-CCYY.
   450                 24  DC-JULIAN-1-CC    PIC 99.
   451                 24  DC-JULIAN-1-YR    PIC 99.
   452             20  DC-JULIAN-DA-1        PIC 999.
   453         16  DC-JULIAN-DATE-2          PIC 9(07).
   454         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   455             20  DC-JULIAN-2-CCYY.
   456                 24  DC-JULIAN-2-CC    PIC 99.
   457                 24  DC-JULIAN-2-YR    PIC 99.
   458             20  DC-JULIAN-DA-2        PIC 999.
   459         16  DC-GREG-DATE-A-EDIT.
   460             20  DC-EDITA-MONTH        PIC 99.
   461             20  SLASHA-1              PIC X VALUE '/'.
   462             20  DC-EDITA-DAY          PIC 99.
   463             20  SLASHA-2              PIC X VALUE '/'.
   464             20  DC-EDITA-CCYY.
   465                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  10
* ELRFND.cbl
   466                 24  DC-EDITA-YEAR     PIC 99.
   467         16  DC-GREG-DATE-B-EDIT.
   468             20  DC-EDITB-MONTH        PIC 99.
   469             20  SLASHB-1              PIC X VALUE '/'.
   470             20  DC-EDITB-DAY          PIC 99.
   471             20  SLASHB-2              PIC X VALUE '/'.
   472             20  DC-EDITB-CCYY.
   473                 24  DC-EDITB-CENT     PIC 99.
   474                 24  DC-EDITB-YEAR     PIC 99.
   475         16  DC-GREG-DATE-CYMD         PIC 9(08).
   476         16  DC-GREG-DATE-CYMD-R REDEFINES
   477                              DC-GREG-DATE-CYMD.
   478             20  DC-CYMD-CEN           PIC 99.
   479             20  DC-CYMD-YEAR          PIC 99.
   480             20  DC-CYMD-MONTH         PIC 99.
   481             20  DC-CYMD-DAY           PIC 99.
   482         16  DC-GREG-DATE-MDCY         PIC 9(08).
   483         16  DC-GREG-DATE-MDCY-R REDEFINES
   484                              DC-GREG-DATE-MDCY.
   485             20  DC-MDCY-MONTH         PIC 99.
   486             20  DC-MDCY-DAY           PIC 99.
   487             20  DC-MDCY-CEN           PIC 99.
   488             20  DC-MDCY-YEAR          PIC 99.
   489    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   490        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   491    12  DC-EL310-DATE                  PIC X(21).
   492    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  11
* ELRFND.cbl
   494*                        COPY ELCCALC.
   495******************************************************************
   496*                                                                *
   497*                           ELCCALC.                            *
   498*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   499*                            VMOD=2.025                          *
   500*                                                                *
   501*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   502*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   503*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   504*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   505*                                                                *
   506*  PASSED TO ELRTRM                                              *
   507*  -----------------                                             *
   508*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   509*  ORIGINAL TERM                                                 *
   510*  BEGINNING DATE                                                *
   511*  ENDING DATE                                                   *
   512*  COMPANY I.D.                                                  *
   513*  ACCOUNT MASTER USER FIELD                                     *
   514*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   515*  FREE LOOK DAYS                                                *
   516*                                                                *
   517*  RETURNED FROM ELRTRM                                          *
   518*  ---------------------                                         *
   519*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   520*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   521*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   522*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   523*----------------------------------------------------------------*
   524*  PASSED TO ELRAMT                                              *
   525*  ----------------                                              *
   526*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   527*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   528*  ORIGINAL AMOUNT                                               *
   529*  ALTERNATE BENEFIT (BALLON)                                    *
   530*  A.P.R. - NET PAY ONLY                                         *
   531*  METHOD
   532*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   533*  COMPANY I.D.                                                  *
   534*  BENEFIT TYPE                                                  *
   535*                                                                *
   536*  RETURNED FROM ELRAMT                                          *
   537*  --------------------                                          *
   538*  REMAINING AMOUNT 1 - CURRENT                                  *
   539*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   540*  REMAINING AMOUNT FACTOR
   541*----------------------------------------------------------------*
   542*  PASSED TO ELRESV                                              *
   543*  -----------------                                             *
   544*  CERTIFICATE EFFECTIVE DATE                                    *
   545*  VALUATION DATE                                                *
   546*  PAID THRU DATE                                                *
   547*  BENEFIT                                                       *
   548*  INCURRED DATE                                                 *
   549*  REPORTED DATE                                                 *
   550*  ISSUE AGE                                                     *
   551*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  12
* ELRFND.cbl
   552*  CDT PERCENT                                                   *
   553*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   554* *CLAIM TYPE (LIFE, A/H)                                        *
   555* *REMAINING BENEFIT (FROM ELRAMT)                               *
   556* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   557*                                                                *
   558*  RETURNED FROM ELRESV                                          *
   559*  --------------------                                          *
   560*  CDT TABLE USED                                                *
   561*  CDT FACTOR USED                                               *
   562*  PAY TO CURRENT RESERVE                                        *
   563*  I.B.N.R. - A/H ONLY                                           *
   564*  FUTURE (ACCRUED) AH ONLY                                      *
   565*----------------------------------------------------------------*
   566*  PASSED TO ELRATE                                              *
   567*  ----------------                                              *
   568*  CERT ISSUE DATE                                               *
   569*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   570*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   571*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   572*  STATE CODE (CLIENT DEFINED)                                   *
   573*  STATE CODE (STANDARD P.O. ABBRV)                              *
   574*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   575*  DEVIATION CODE                                                *
   576*  ISSUE AGE                                                     *
   577*  ORIGINAL BENEFIT AMOUNT                                       *
   578*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   579*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   580*  BENEFIT KIND (LIFE OR A/H)                                    *
   581*  A.P.R.                                                        *
   582*  METHOD
   583*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   584*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   585*  COMPANY I.D. (3 CHARACTER)                                    *
   586*  BENEFIT CODE                                                  *
   587*  BENEFIT OVERRIDE CODE                                         *
   588*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   589*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   590*  JOINT INDICATOR (CSL ONLY)                                    *
   591*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   592*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   593*                                                                *
   594*  RETURNED FROM ELRATE                                          *
   595*  --------------------                                          *
   596*  CALCULATED PREMIUM                                            *
   597*  PREMIUM RATE                                                  *
   598*  MORTALITY CODE                                                *
   599*  MAX ATTAINED AGE                                              *
   600*  MAX AGE                                                       *
   601*  MAX TERM                                                      *
   602*  MAX MONTHLY BENEFIT                                           *
   603*  MAX TOTAL BENIFIT                                             *
   604*  COMPOSITE RATE (OPEN-END ONLY)                                *
   605*----------------------------------------------------------------*
   606*  PASSED TO ELRFND                                              *
   607*  ----------------                                              *
   608*  CERT ISSUE DATE                                               *
   609*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  13
* ELRFND.cbl
   610*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   611*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   612*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   613*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   614*  STATE CODE (CLIENT DEFINED)                                   *
   615*  STATE CODE (STANDARD P.O. ABBRV)                              *
   616*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   617*  DEVIATION CODE                                                *
   618*  ISSUE AGE                                                     *
   619*  ORIGINAL BENEFIT AMOUNT                                       *
   620*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   621*  PROCESS TYPE (CANCEL)                                         *
   622*  BENEFIT KIND (LIFE OR A/H)                                    *
   623*  A.P.R.                                                        *
   624*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   625*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   626*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   627*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   628*  COMPANY I.D. (3 CHARACTER)                                    *
   629*  BENEFIT CODE                                                  *
   630*  BENEFIT OVERRIDE CODE                                         *
   631*                                                                *
   632*  RETURNED FROM ELRFND                                          *
   633*  --------------------                                          *
   634*  CALCULATED REFUND                                             *
   635*----------------------------------------------------------------*
   636*  PASSED TO ELEARN                                              *
   637*  ----------------                                              *
   638*  CERT ISSUE DATE                                               *
   639*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   640*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   641*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   642*  STATE CODE (CLIENT DEFINED)                                   *
   643*  STATE CODE (STANDARD P.O. ABBRV)                              *
   644*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   645*  DEVIATION CODE                                                *
   646*  ISSUE AGE                                                     *
   647*  ORIGINAL BENEFIT AMOUNT                                       *
   648*  BENEFIT KIND (LIFE OR A/H)                                    *
   649*  A.P.R.                                                        *
   650*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   651*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   652*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   653*  COMPANY I.D. (3 CHARACTER)                                    *
   654*  BENEFIT CODE                                                  *
   655*  BENEFIT OVERRIDE CODE                                         *
   656*                                                                *
   657*  RETURNED FROM ELEARN                                          *
   658*  --------------------                                          *
   659*  INDICATED  EARNINGS                                           *
   660*----------------------------------------------------------------*
   661*                 LENGTH = 450                                   *
   662*                                                                *
   663******************************************************************
   664******************************************************************
   665*                   C H A N G E   L O G
   666*
   667* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  14
* ELRFND.cbl
   668*-----------------------------------------------------------------
   669*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   670* EFFECTIVE    NUMBER
   671*-----------------------------------------------------------------
   672* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   673* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   674* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   675* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   676* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   677* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   678* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   679* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   680* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   681******************************************************************
   682
   683 01  CALCULATION-PASS-AREA.
   684     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   685                                     COMP.
   686
   687     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   688       88  NO-CP-ERROR                             VALUE ZERO.
   689       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   690                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   691       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   692       88  CP-ERROR-IN-DATES                       VALUE '2'.
   693       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   694       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   695       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   696       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   697       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   698       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   699       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   700       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   701       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   702       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   703       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   704       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   705       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   706       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   707       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   708
   709     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   710       88  NO-CP-ERROR-2                           VALUE ZERO.
   711***********************  INPUT AREAS ****************************
   712
   713     12  CP-CALCULATION-AREA.
   714         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   715         16  CP-CERT-EFF-DT        PIC XX.
   716         16  CP-VALUATION-DT       PIC XX.
   717         16  CP-PAID-THRU-DT       PIC XX.
   718         16  CP-BENEFIT-TYPE       PIC X.
   719           88  CP-AH                               VALUE 'A' 'D'
   720                                                   'I' 'U'.
   721           88  CP-REDUCING-LIFE                    VALUE 'R'.
   722           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   723         16  CP-INCURRED-DT        PIC XX.
   724         16  CP-REPORTED-DT        PIC XX.
   725         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  15
* ELRFND.cbl
   726         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   727         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   728                                     COMP-3.
   729         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   730                                     COMP-3.
   731         16  CP-CDT-METHOD         PIC X.
   732           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   733           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   734           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   735         16  CP-CLAIM-TYPE         PIC X.
   736           88  CP-AH-CLAIM                         VALUE 'A'.
   737           88  CP-LIFE-CLAIM                       VALUE 'L'.
   738         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   739                                     COMP-3.
   740         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   741                                     COMP-3.
   742         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   743                                     COMP-3.
   744         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   745                                     COMP-3.
   746         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   747                                     COMP-3.
   748         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   749                                     COMP-3.
   750         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   751                                     COMP-3.
   752         16  CP-REM-TERM-METHOD    PIC X.
   753           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   754           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   755           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   756           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   757           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   758           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   759           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   760         16  CP-EARNING-METHOD     PIC X.
   761           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   762           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   763           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   764           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   765           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   766           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   767           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   768           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   769           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   770           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   771           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   772           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   773           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   774           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   775         16  CP-PROCESS-TYPE       PIC X.
   776           88  CP-CLAIM                            VALUE '1'.
   777           88  CP-CANCEL                           VALUE '2'.
   778           88  CP-ISSUE                            VALUE '3'.
   779         16  CP-SPECIAL-CALC-CD    PIC X.
   780           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   781           88  CP-1-MTH-INTEREST               VALUE ' '.
   782           88  CP-0-MTH-INTEREST               VALUE 'A'.
   783           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  16
* ELRFND.cbl
   784           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   785           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   786           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   787           88  CP-FARM-PLAN                    VALUE 'F'.
   788           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   789           88  CP-2-MTH-INTEREST               VALUE 'I'.
   790           88  CP-3-MTH-INTEREST               VALUE 'J'.
   791           88  CP-4-MTH-INTEREST               VALUE 'K'.
   792           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   793           88  CP-MORTGAGE-REC                 VALUE 'M'.
   794           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   795           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   796           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   797           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   798                                                     'W' 'X'.
   799           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   800           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   801           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   802           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   803           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   804           88  CP-SUMMARY-REC                  VALUE 'Z'.
   805           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   806           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   807           88  CP-AD-D-BENEFIT                 VALUE '4'.
   808           88  CP-CSL-METH-1                   VALUE '5'.
   809           88  CP-CSL-METH-2                   VALUE '6'.
   810           88  CP-CSL-METH-3                   VALUE '7'.
   811           88  CP-CSL-METH-4                   VALUE '8'.
   812
   813         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   814                                     COMP-3.
   815         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   816         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   817         16  CP-STATE              PIC XX          VALUE SPACE.
   818         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   819         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   820           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   821               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   822         16  CP-R78-OPTION         PIC X.
   823           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   824           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   825
   826         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   827         16  CP-IBNR-RESERVE-SW    PIC X.
   828         16  CP-CLAIM-STATUS       PIC X.
   829         16  CP-RATE-FILE          PIC X.
   830         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   831                                     COMP-3.
   832
   833         16  CP-LIFE-OVERRIDE-CODE PIC X.
   834         16  CP-AH-OVERRIDE-CODE   PIC X.
   835
   836         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   837                                     COMP-3.
   838         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   839                                   PIC S9(5)V99 COMP-3.
   840         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   841                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  17
* ELRFND.cbl
   842         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   843                                     COMP-3.
   844         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   845                                     COMP-3.
   846         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   847                                  PIC S9(7)V99 COMP-3.
   848
   849         16  CP-PAID-FROM-DATE     PIC X(02).
   850         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   851         16  CP-EXT-DAYS-CALC      PIC X.
   852           88  CP-EXT-NO-CHG                   VALUE ' '.
   853           88  CP-EXT-CHG-LF                   VALUE '1'.
   854           88  CP-EXT-CHG-AH                   VALUE '2'.
   855           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   856         16  CP-DOMICILE-STATE     PIC XX.
   857         16  CP-CARRIER            PIC X.
   858         16  CP-REIN-FLAG          PIC X.
   859         16  CP-REM-TRM-CALC-OPTION PIC X.
   860           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   861                      '2' '3' '4' '5'.
   862           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   863           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   864           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   865           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   866           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   867           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   868           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   869           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   870         16  CP-SIG-SWITCH         PIC X.
   871         16  CP-RATING-METHOD      PIC X.
   872           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   873           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   874           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   875           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   876           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   877           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   878           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   879           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   880           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   881         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   882                                     COMP-3.
   883         16  CP-BEN-CATEGORY       PIC X.
   884         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   885         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   886                                   PIC S99V9(5) COMP-3.
   887         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   888         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   889                                   PIC S99V9(5) COMP-3.
   890         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   891         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   892         16  CP-EXPIRE-DT          PIC XX.
   893         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   894         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   895         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   896         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   897         16  CP-DDF-SPEC-CALC      PIC X.
   898             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   899             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  18
* ELRFND.cbl
   900         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   901         16  CP-CANCEL-REASON      PIC X.
   902         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   903         16  CP-PMT-MODE           PIC X.
   904         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   905         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   906         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   907         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   908         16  FILLER                PIC X.
   909
   910***************    OUTPUT FROM ELRESV   ************************
   911
   912         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   913
   914         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   915                                     COMP-3.
   916         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   917                                     COMP-3.
   918         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   919                                     COMP-3.
   920         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   921                                     COMP-3.
   922         16  FILLER                PIC X(09).
   923***************    OUTPUT FROM ELRTRM   *************************
   924
   925         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   926                                     COMP-3.
   927         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   928                                     COMP-3.
   929         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   930                                     COMP-3.
   931         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   932                                     COMP-3.
   933         16  FILLER                PIC X(12).
   934
   935***************    OUTPUT FROM ELRAMT   *************************
   936
   937         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   938                                     COMP-3.
   939         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   940                                     COMP-3.
   941         16  FILLER                PIC X(12).
   942
   943***************    OUTPUT FROM ELRATE   *************************
   944
   945         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   946                                     COMP-3.
   947         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   948                                     COMP-3.
   949         16  CP-MORTALITY-CODE     PIC X(4).
   950         16  CP-RATE-EDIT-FLAG     PIC X.
   951             88  CP-RATES-NEED-APR                  VALUE '1'.
   952         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   953                                     COMP-3.
   954         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   955         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   956         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   957                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  19
* ELRFND.cbl
   958         16  FILLER                PIC X(07).
   959
   960***************    OUTPUT FROM ELRFND   *************************
   961
   962         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   963                                     COMP-3.
   964         16  CP-REFUND-TYPE-USED   PIC X.
   965           88  CP-R-AS-R78                         VALUE '1'.
   966           88  CP-R-AS-PRORATA                     VALUE '2'.
   967           88  CP-R-AS-CALIF                       VALUE '3'.
   968           88  CP-R-AS-TEXAS                       VALUE '4'.
   969           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   970           88  CP-R-AS-NET-PAY                     VALUE '5'.
   971           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   972           88  CP-R-AS-MEAN                        VALUE '8'.
   973           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   974           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   975           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   976           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   977           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   978           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   979         16  FILLER                PIC X(12).
   980
   981***************    OUTPUT FROM ELEARN   *************************
   982
   983         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   984                                     COMP-3.
   985         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   986                                     COMP-3.
   987         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   988                                     COMP-3.
   989         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   990                                     COMP-3.
   991         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   992                                     COMP-3.
   993         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   994                                     COMP-3.
   995         16  CP-EARNING-TYPE-USED  PIC X.
   996           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   997           88  CP-E-AS-R78                         VALUE '1'.
   998           88  CP-E-AS-PRORATA                     VALUE '2'.
   999           88  CP-E-AS-TEXAS                       VALUE '4'.
  1000           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1001           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1002           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1003           88  CP-E-AS-MEAN                        VALUE '8'.
  1004           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1005         16  FILLER                PIC X(12).
  1006
  1007***************    OUTPUT FROM ELPMNT   *************************
  1008
  1009         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1010                                     COMP-3.
  1011         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1012                                     COMP-3.
  1013         16  FILLER                PIC X(12).
  1014
  1015***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  20
* ELRFND.cbl
  1016         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1017                                     COMP-3.
  1018         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1019                                     COMP-3.
  1020         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1021                                     COMP-3.
  1022         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1023                                     COMP-3.
  1024         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1025                                     COMP-3.
  1026         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1027                                     COMP-3.
  1028         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1029             88  OPEN-RATE-FILE                   VALUE 'O'.
  1030             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1031             88  IO-ERROR                         VALUE 'E'.
  1032
  1033         16  CP-FIRST-PAY-DATE     PIC XX.
  1034
  1035         16  CP-JOINT-INDICATOR    PIC X.
  1036
  1037         16  CP-RESERVE-REMAINING-TERM
  1038                                   PIC S9(4)V9    VALUE ZERO
  1039                                     COMP-3.
  1040
  1041         16  CP-INSURED-BIRTH-DT   PIC XX.
  1042
  1043         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1044                                     COMP-3.
  1045
  1046         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1047                                     COMP-3.
  1048
  1049         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1050                                     COMP-3.
  1051
  1052         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1053                                     COMP-3.
  1054
  1055         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1056                                     COMP-3.
  1057
  1058         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1059                                     COMP-3.
  1060
  1061         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1062                                     COMP-3.
  1063
  1064         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1065             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1066
  1067         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1068                                     COMP-3.
  1069         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1070                                     COMP-3.
  1071         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1072         16  FILLER                PIC X(15).
  1073******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  21
* ELRFND.cbl
  1074
  1075
  1076****************************************************************
  1077*
  1078* Copyright (c) 2007 by Clerity Solutions, Inc.
  1079* All rights reserved.
  1080*
  1081****************************************************************
  1082 01  DFHEIV.
  1083   02  DFHEIV0               PIC X(35).
  1084   02  DFHEIV1               PIC X(08).
  1085   02  DFHEIV2               PIC X(08).
  1086   02  DFHEIV3               PIC X(08).
  1087   02  DFHEIV4               PIC X(06).
  1088   02  DFHEIV5               PIC X(04).
  1089   02  DFHEIV6               PIC X(04).
  1090   02  DFHEIV7               PIC X(02).
  1091   02  DFHEIV8               PIC X(02).
  1092   02  DFHEIV9               PIC X(01).
  1093   02  DFHEIV10              PIC S9(7) COMP-3.
  1094   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1095   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1096   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1097   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1098   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1099   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1100   02  DFHEIV17              PIC X(04).
  1101   02  DFHEIV18              PIC X(04).
  1102   02  DFHEIV19              PIC X(04).
  1103   02  DFHEIV20              USAGE IS POINTER.
  1104   02  DFHEIV21              USAGE IS POINTER.
  1105   02  DFHEIV22              USAGE IS POINTER.
  1106   02  DFHEIV23              USAGE IS POINTER.
  1107   02  DFHEIV24              USAGE IS POINTER.
  1108   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1109   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1110   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1111   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1112   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1113   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1114   02  FILLER                PIC X(02).
  1115   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1116   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1117   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1118   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1119   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1120 LINKAGE  SECTION.
  1121*****************************************************************
  1122*                                                               *
  1123* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1124* All rights reserved.                                          *
  1125*                                                               *
  1126*****************************************************************
  1127 01  dfheiblk.
  1128     02  eibtime          pic s9(7) comp-3.
  1129     02  eibdate          pic s9(7) comp-3.
  1130     02  eibtrnid         pic x(4).
  1131     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  22
* ELRFND.cbl
  1132     02  eibtrmid         pic x(4).
  1133     02  dfheigdi         pic s9(4) comp.
  1134     02  eibcposn         pic s9(4) comp.
  1135     02  eibcalen         pic s9(4) comp.
  1136     02  eibaid           pic x(1).
  1137     02  eibfiller1       pic x(1).
  1138     02  eibfn            pic x(2).
  1139     02  eibfiller2       pic x(2).
  1140     02  eibrcode         pic x(6).
  1141     02  eibfiller3       pic x(2).
  1142     02  eibds            pic x(8).
  1143     02  eibreqid         pic x(8).
  1144     02  eibrsrce         pic x(8).
  1145     02  eibsync          pic x(1).
  1146     02  eibfree          pic x(1).
  1147     02  eibrecv          pic x(1).
  1148     02  eibsend          pic x(1).
  1149     02  eibatt           pic x(1).
  1150     02  eibeoc           pic x(1).
  1151     02  eibfmh           pic x(1).
  1152     02  eibcompl         pic x(1).
  1153     02  eibsig           pic x(1).
  1154     02  eibconf          pic x(1).
  1155     02  eiberr           pic x(1).
  1156     02  eibrldbk         pic x(1).
  1157     02  eiberrcd         pic x(4).
  1158     02  eibsynrb         pic x(1).
  1159     02  eibnodat         pic x(1).
  1160     02  eibfiller5       pic x(2).
  1161     02  eibresp          pic 9(09) comp.
  1162     02  eibresp2         pic 9(09) comp.
  1163     02  dfheigdj         pic s9(4) comp.
  1164     02  dfheigdk         pic s9(4) comp.
  1165 01  DFHCOMMAREA                PIC X(450).
  1166
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  23
* ELRFND.cbl
  1168 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1169 0000-DFHEXIT SECTION.
  1170     MOVE '9#                    $   ' TO DFHEIV0.
  1171     MOVE 'ELRFND' TO DFHEIV1.
  1172     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1173     MOVE DFHCOMMAREA    TO  CALCULATION-PASS-AREA.
  1174
  1175 000-START-REFUND-CALC.
  1176*                      COPY ELCRFNDP.
  1177****************************************************************
  1178*                                                              *
  1179*                            ELCRFNDP.                         *
  1180*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1181*                            VMOD=2.028                        *
  1182*                                                              *
  1183****************************************************************.
  1184*                   C H A N G E   L O G
  1185*
  1186* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1187*-----------------------------------------------------------------
  1188*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1189* EFFECTIVE    NUMBER
  1190*-----------------------------------------------------------------
  1191* 042203                   PEMA ADD SPECIAL IN CALC FOR CID
  1192* 033104    2003080800002  PEMA ADD GAP NON REFUNDABLE OPTION
  1193* 042904    2003080800002  PEMA ADD ACTUARIAL EARNING METHOD
  1194* 110609  CR2009092300002  PEMA CHANGE MN REFUNDS
  1195* 000000  CR2008042200001  PEMA ADD 0 APR PROCESSING
  1196* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  1197* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1198* 032612  CR2011110200001  PEMA AHL CHANGES
  1199******************************************************************
  1200
  1201     MOVE ZERO                   TO  CP-RETURN-CODE
  1202                                     CP-CALC-REFUND.
  1203     MOVE SPACE                  TO  CP-REFUND-TYPE-USED.
  1204
  1205 0001-GET-CANCEL-TYPE.
  1206     IF CP-CERT-EFF-DT = CP-VALUATION-DT
  1207        MOVE CP-ORIGINAL-PREMIUM TO CP-CALC-REFUND
  1208        GO TO 1999-CALC-REF-AMT-X.
  1209
  1210     IF CP-CANCEL-REASON = 'R'
  1211        IF CP-CALC-CLP
  1212           MOVE CP-ORIGINAL-PREMIUM
  1213                                 TO CP-CALC-REFUND
  1214        ELSE
  1215           COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM -
  1216              CP-DDF-ADMIN-FEES
  1217        END-IF
  1218        MOVE 'R'                 TO CP-REFUND-TYPE-USED
  1219        GO TO 1999-CALC-REF-AMT-X
  1220     END-IF
  1221     IF CP-REMAINING-TERM = ZERO   OR
  1222        CP-REMAINING-TERM NEGATIVE
  1223          MOVE ZERO TO CP-CALC-REFUND
  1224          GO TO 1999-CALC-REF-AMT-X.
  1225
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  24
* ELRFND.cbl
  1226     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1227     MOVE SPACE              TO DC-OPTION-CODE.
  1228     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1229
  1230     IF DATE-CONVERSION-ERROR
  1231         MOVE '2' TO CP-RETURN-CODE
  1232         GO TO 1999-CALC-REF-AMT-X.
  1233
  1234     IF CP-AH
  1235        GO TO 1030-GET-AH-REFUND.
  1236
  1237********************    LIFE REFUNDS    **************************
  1238
  1239     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1240         MOVE +0                TO CP-TERM-OR-EXT-DAYS.
  1241
  1242     IF CP-LOAN-TERM NOT NUMERIC
  1243         MOVE +0                TO CP-LOAN-TERM.
  1244
  1245     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1246
  1247     COMPUTE R78-FACTOR =
  1248            (CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1249              (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1250************************************************************
  1251***       ADDED IF CONDITION FOR TESTING PURPOSES.       ***
  1252***---------------------------------------------------------
  1253     IF CP-TRUNCATED-LIFE
  1254        MOVE  CP-LOAN-TERM         TO  WS-RATE-TERM
  1255     ELSE
  1256        MOVE  CP-ORIGINAL-TERM     TO  WS-RATE-TERM.
  1257***
  1258************************************************************
  1259**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1260**** FOLLOWING.
  1261****       FOR NC. LIFE..
  1262****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1263****  TRUNCATED NET COVERAGE --- TERM > 60 USE RULE OF ANTIC.
  1264****                             TERM <= 60 USE SUM OF DIGITS.
  1265****  DECREASING COVERAGE    --- EFF DATE > 093081 AND
  1266****                             TERM > 60 USE RULE OF ANTIC
  1267****                             OTHERWISE USE RULE OF 78.
  1268****
  1269****
  1270
  1271     IF (CP-COMPANY-ID = 'NCL') AND
  1272        (CP-STATE-STD-ABBRV = 'NC')
  1273        IF CP-LEVEL-LIFE
  1274           GO TO 1023-REF-PR
  1275        ELSE
  1276        IF CP-EARN-AS-NET-PAY AND
  1277           CP-TRUNCATED-LIFE
  1278           IF CP-ORIGINAL-TERM GREATER THAN 60
  1279              GO TO 1021-ANTICIPATION-REF
  1280           ELSE
  1281              GO TO 1026-REF-R78
  1282        ELSE
  1283        IF CP-REDUCING-LIFE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  25
* ELRFND.cbl
  1284           IF (DC-GREG-DATE-CYMD  GREATER 19810930 AND
  1285              CP-ORIGINAL-TERM GREATER THAN 60)
  1286              GO TO 1021-ANTICIPATION-REF
  1287           ELSE
  1288              GO TO 1075-SUM-OF-DIGITS.
  1289
  1290****
  1291**** THE FOLLOWING IF STATEMENT FOR CID ONLY SHOULD DO THE
  1292**** FOLLOWING.
  1293****       FOR OH. LIFE..
  1294****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1295****  NET/NET TRUNCATED      --- TERM > 60 USE RULE OF ANTIC.
  1296****  GROSS DECREASING       --- RULE OF 78
  1297****
  1298****
  1299
  1300     IF (CP-COMPANY-ID = 'CID') AND
  1301        (CP-STATE-STD-ABBRV = 'OH') AND
  1302        (CP-CLASS-CODE NOT = 'L ')
  1303        IF CP-LEVEL-LIFE
  1304           GO TO 1023-REF-PR
  1305        ELSE
  1306           IF (CP-ORIGINAL-TERM > 60) OR
  1307              (CP-EARN-AS-NET-PAY)
  1308              GO TO 1028-NET-PAY-REFUND
  1309           ELSE
  1310              GO TO 1026-REF-R78
  1311           END-IF
  1312        END-IF
  1313     END-IF
  1314
  1315**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1316**** FOLLOWING.
  1317****       FOR VA. LIFE..
  1318****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1319****           NET COVERAGES --- USE RULE OF ANTIC.
  1320****  DECREASING COVERAGE    --- EFF DATE < 010193 USE R78.
  1321****                         --- EFF DATE > 123194 USE ANTIC.
  1322****                         --- EFF DATE BETWEEN 010193 AND 12319
  1323****                             WITH TERM > 61 USE RULE OF ANTIC
  1324****                             OTHERWISE USE RULE OF 78.
  1325****
  1326****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1327****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1328****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1329****            WILL FOLLOW.
  1330****
  1331****
  1332****
  1333
  1334     IF (CP-COMPANY-ID = 'NCL') AND
  1335        (CP-STATE-STD-ABBRV = 'VA')
  1336        IF CP-LEVEL-LIFE
  1337           GO TO 1023-REF-PR
  1338        ELSE
  1339        IF CP-EARN-AS-NET-PAY
  1340           GO TO 1021-ANTICIPATION-REF
  1341        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  26
* ELRFND.cbl
  1342        IF CP-REDUCING-LIFE
  1343           IF DC-GREG-DATE-CYMD LESS THAN 19930101
  1344              GO TO 1026-REF-R78
  1345           ELSE
  1346           IF DC-GREG-DATE-CYMD GREATER THAN 19941231
  1347              GO TO 1021-ANTICIPATION-REF
  1348           ELSE
  1349           IF CP-ORIGINAL-TERM GREATER THAN 61
  1350              GO TO 1021-ANTICIPATION-REF
  1351           ELSE
  1352              GO TO 1026-REF-R78.
  1353
  1354     IF (CP-COMPANY-ID = 'CID')
  1355        AND (CP-STATE-STD-ABBRV = 'IN')
  1356        AND (DC-GREG-DATE-CYMD < 20030401)
  1357        IF CP-REDUCING-LIFE
  1358           GO TO 1026-REF-R78
  1359        ELSE
  1360           IF CP-LEVEL-LIFE
  1361              GO TO 1023-REF-PR
  1362           END-IF
  1363        END-IF
  1364     END-IF
  1365
  1366     IF (CP-COMPANY-ID = 'CID')
  1367        AND (CP-STATE-STD-ABBRV = 'FL')
  1368        AND (DC-GREG-DATE-CYMD > 20030630)
  1369        IF CP-RATE-AS-NET-PAY
  1370           GO TO 1028-NET-PAY-REFUND
  1371        END-IF
  1372     END-IF
  1373
  1374     IF (CP-COMPANY-ID = 'CID')
  1375        AND (CP-STATE-STD-ABBRV = 'MN')
  1376        AND (CP-EARN-AS-NET-PAY)
  1377        AND (CP-RATE-AS-REG-BALLOON)
  1378        AND (DC-GREG-DATE-CYMD > 20091231)
  1379        GO TO 1028-NET-PAY-REFUND
  1380     END-IF
  1381     IF (CP-COMPANY-ID = 'CID')
  1382        AND (CP-STATE-STD-ABBRV = 'MN')
  1383        AND (DC-GREG-DATE-CYMD > 20091231)
  1384        AND (CP-RATE-AS-NET-PAY)
  1385        GO TO 1021-ANTICIPATION-REF
  1386     END-IF
  1387     IF (CP-COMPANY-ID = 'CID')
  1388        AND (CP-STATE-STD-ABBRV = 'MO')
  1389        AND (DC-GREG-DATE-CYMD > 20030630)
  1390        AND (CP-LOAN-TERM < +121)
  1391        IF CP-RATE-AS-NET-PAY
  1392           GO TO 1028-NET-PAY-REFUND
  1393        END-IF
  1394     END-IF
  1395
  1396     IF (CP-COMPANY-ID = 'CID')
  1397        AND (CP-STATE-STD-ABBRV = 'ND')
  1398        AND (DC-GREG-DATE-CYMD > 20011231)
  1399        AND (CP-REDUCING-LIFE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  27
* ELRFND.cbl
  1400        GO TO 1021-ANTICIPATION-REF
  1401     END-IF
  1402
  1403     IF CP-CRITICAL-PERIOD
  1404        IF CP-COMPANY-ID = 'NCL'
  1405           NEXT SENTENCE
  1406        ELSE
  1407           GO TO 1022-REF-CRITICAL-PERIOD-LF.
  1408
  1409     IF CP-TERM-IS-DAYS  AND
  1410        CP-TERM-OR-EXT-DAYS GREATER ZERO
  1411         GO TO 1024-REF-PR-DAYS.
  1412
  1413     IF CP-STATE-STD-ABBRV = 'NM'
  1414       IF CP-REDUCING-LIFE
  1415*        IF DC-GREG-DATE-1-YMD LESS THAN '980901'
  1416         IF DC-GREG-DATE-CYMD LESS THAN 19980901
  1417             GO TO 1026-REF-R78.
  1418
  1419     IF CP-EARN-ANTICIPATION
  1420         GO TO 1021-ANTICIPATION-REF.
  1421
  1422     IF CP-STATE-STD-ABBRV = 'ME'
  1423         IF CP-COMPANY-ID = 'NCL' OR 'CVL'
  1424            NEXT SENTENCE
  1425         ELSE
  1426            IF CP-REDUCING-LIFE
  1427               GO TO 1021-ANTICIPATION-REF.
  1428
  1429     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1430        IF CP-STATE-STD-ABBRV = 'TX'
  1431            GO TO SKIP-CSO-TEXAS-LIFE-PROCESSING
  1432        END-IF
  1433     END-IF.
  1434
  1435     IF CP-STATE-STD-ABBRV = 'TX'
  1436       IF CP-COMPANY-ID EQUAL 'HER' OR 'NCL'
  1437          NEXT SENTENCE
  1438       END-IF
  1439        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1440           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1441           GO TO 1021-ANTICIPATION-REF.
  1442
  1443 SKIP-CSO-TEXAS-LIFE-PROCESSING.
  1444
  1445     IF CP-EARN-BY-PRORATA
  1446         GO TO 1023-REF-PR.
  1447
  1448     IF CP-EARN-AS-MEAN
  1449         GO TO 1025-REF-MEAN.
  1450
  1451     IF CP-EARN-AS-TEXAS
  1452         GO TO 1027-TEXAS-REFUND.
  1453
  1454     IF CP-EARN-AS-NET-PAY
  1455         GO TO 1028-NET-PAY-REFUND.
  1456
  1457     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  28
* ELRFND.cbl
  1458         GO TO 1000-NO-NET-PAY.
  1459
  1460     IF  CP-COMPANY-ID IS EQUAL TO 'CID' OR 'CSO'
  1461       IF CP-STATE-STD-ABBRV = 'NC'
  1462         IF CP-REDUCING-LIFE
  1463           IF CP-ORIGINAL-TERM GREATER 60  AND
  1464              DC-GREG-DATE-CYMD GREATER 19810930
  1465                GO TO 1028-NET-PAY-REFUND
  1466           ELSE
  1467              GO TO 1026-REF-R78.
  1468
  1469
  1470     IF CP-STATE-STD-ABBRV = 'NC'
  1471       IF CP-COMPANY-ID EQUAL 'NCL'
  1472          NEXT SENTENCE
  1473       END-IF
  1474       IF CP-REDUCING-LIFE
  1475         IF CP-ORIGINAL-TERM GREATER 60  AND
  1476            DC-GREG-DATE-CYMD GREATER 19810930
  1477             GO TO 1021-ANTICIPATION-REF
  1478         ELSE
  1479             GO TO 1026-REF-R78.
  1480
  1481     IF CP-STATE-STD-ABBRV = 'UT'
  1482       IF CP-COMPANY-ID EQUAL 'NCL'
  1483          NEXT SENTENCE
  1484       END-IF
  1485         IF CP-ORIGINAL-TERM GREATER 62         AND
  1486            CP-LOAN-APR GREATER ZERO            AND
  1487            DC-GREG-DATE-CYMD GREATER 19810831 AND
  1488            DC-GREG-DATE-CYMD LESS    19830901
  1489             GO TO 1028-NET-PAY-REFUND
  1490         ELSE
  1491             GO TO 1026-REF-R78.
  1492
  1493     IF CP-STATE-STD-ABBRV = 'OH'
  1494       IF CP-COMPANY-ID EQUAL 'NCL' OR 'HER'
  1495          NEXT SENTENCE
  1496       END-IF
  1497           IF CP-ORIGINAL-TERM GREATER 60         AND
  1498              CP-CLASS-CODE NOT = 'L '            AND
  1499              CP-LOAN-APR GREATER ZERO            AND
  1500              DC-GREG-DATE-CYMD GREATER 19831031
  1501              GO TO 1028-NET-PAY-REFUND
  1502           ELSE
  1503              GO TO 1026-REF-R78.
  1504
  1505     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1506       IF CP-STATE-STD-ABBRV = 'MT'
  1507         GO TO SKIP-CSO-MT-LF-PROCESSING.
  1508
  1509
  1510     IF CP-STATE-STD-ABBRV = 'MT'
  1511       IF CP-COMPANY-ID EQUAL 'NCL'
  1512          NEXT SENTENCE
  1513       END-IF
  1514         IF CP-ORIGINAL-TERM GREATER 61         AND
  1515            CP-LOAN-APR GREATER ZERO            AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  29
* ELRFND.cbl
  1516            DC-GREG-DATE-CYMD GREATER 19830318
  1517             GO TO 1028-NET-PAY-REFUND
  1518         ELSE
  1519             GO TO 1026-REF-R78.
  1520
  1521 SKIP-CSO-MT-LF-PROCESSING.
  1522
  1523     IF CP-STATE-STD-ABBRV = 'RI'
  1524       IF CP-COMPANY-ID EQUAL 'NCL'
  1525          NEXT SENTENCE
  1526       END-IF
  1527         IF CP-ORIGINAL-TERM GREATER 60         AND
  1528            CP-LOAN-APR GREATER ZERO            AND
  1529            DC-GREG-DATE-CYMD GREATER 19831231
  1530             GO TO 1028-NET-PAY-REFUND
  1531         ELSE
  1532             GO TO 1026-REF-R78.
  1533
  1534
  1535 1000-NO-NET-PAY.
  1536
  1537     IF CP-STATE-STD-ABBRV = 'WY'
  1538       IF CP-COMPANY-ID EQUAL 'NCL'
  1539          NEXT SENTENCE
  1540       END-IF
  1541        IF CP-COMPANY-ID = 'TMS'
  1542           GO TO 1026-REF-R78
  1543        ELSE
  1544           GO TO 1023-REF-PR.
  1545
  1546     IF CP-EARN-BY-R78
  1547         GO TO 1026-REF-R78.
  1548
  1549     IF CP-EARN-AS-SUM-OF-DIGITS
  1550         GO TO 1075-SUM-OF-DIGITS.
  1551
  1552     IF CP-LEVEL-LIFE
  1553         GO TO 1023-REF-PR
  1554     ELSE
  1555         GO TO 1026-REF-R78.
  1556
  1557*-----------------------------------------------------------------
  1558 1021-ANTICIPATION-REF.
  1559     MOVE '6'                  TO CP-REFUND-TYPE-USED.
  1560
  1561     MOVE CP-LOAN-TERM         TO WS-SAVE-LOAN-TERM.
  1562     IF CP-LOAN-TERM = ZEROS
  1563        MOVE CP-ORIGINAL-TERM TO CP-LOAN-TERM
  1564     END-IF
  1565     COMPUTE CP-LOAN-TERM = CP-LOAN-TERM - CP-ORIGINAL-TERM +
  1566                            CP-REMAINING-TERM.
  1567
  1568     MOVE CP-ORIGINAL-BENEFIT  TO WS-SAVE-BENEFIT.
  1569     MOVE CP-ORIGINAL-TERM     TO WS-SAVE-TERM.
  1570     MOVE CP-EARNING-METHOD    TO WS-SAVE-EARN-METHOD.
  1571
  1572     MOVE CP-REMAINING-BENEFIT TO CP-ORIGINAL-BENEFIT.
  1573     MOVE CP-REMAINING-TERM    TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  30
* ELRFND.cbl
  1574     MOVE CP-RATING-METHOD     TO CP-EARNING-METHOD.
  1575
  1576     IF CP-REMAINING-TERM = WS-SAVE-TERM
  1577         MOVE 'N'              TO CP-ROA-REFUND
  1578     ELSE
  1579         MOVE 'Y'              TO CP-ROA-REFUND.
  1580
  1581******    TO COMPUTE PREMIUM AT REFUND DATE
  1582     PERFORM 2500-GET-RATE.
  1583
  1584     MOVE 'N'                  TO CP-ROA-REFUND.
  1585     MOVE WS-SAVE-BENEFIT      TO CP-ORIGINAL-BENEFIT.
  1586     MOVE WS-SAVE-TERM         TO CP-ORIGINAL-TERM.
  1587     MOVE WS-SAVE-LOAN-TERM    TO CP-LOAN-TERM.
  1588
  1589     IF CP-PREMIUM-RATE = ZEROS
  1590        MOVE '7'                 TO CP-RETURN-CODE
  1591        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1592        GO TO 1999-CALC-REF-AMT-X.
  1593
  1594     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1595
  1596******    TO COMPUTE PREMIUM AT ORIGINAL ISSUE DATE
  1597     PERFORM 2500-GET-RATE.
  1598
  1599     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1600
  1601     IF CP-PREMIUM-RATE = ZEROS
  1602        MOVE '7'            TO CP-RETURN-CODE
  1603        GO TO 1999-CALC-REF-AMT-X.
  1604
  1605     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1606
  1607     IF  WS-ORIG-PREM = ZEROS
  1608         MOVE ZEROS TO WS-NP-REF-FACTOR
  1609        ELSE
  1610         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1611                                            WS-ORIG-PREM.
  1612
  1613     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1614                                        CP-ORIGINAL-PREMIUM.
  1615
  1616     GO TO 1999-CALC-REF-AMT-X.
  1617
  1618*---------------------------------------------------------------
  1619 1022-REF-CRITICAL-PERIOD-LF.
  1620     GO TO 1023-REF-PR.
  1621
  1622*---------------------------------------------------------------
  1623 1023-REF-PR.
  1624     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1625     COMPUTE CP-CALC-REFUND ROUNDED =
  1626            CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1627
  1628     GO TO 1999-CALC-REF-AMT-X.
  1629
  1630*---------------------------------------------------------------
  1631 1024-REF-PR-DAYS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  31
* ELRFND.cbl
  1632     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1633     MOVE CP-VALUATION-DT    TO DC-BIN-DATE-2.
  1634     MOVE '1'                TO DC-OPTION-CODE.
  1635     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1636
  1637     IF DATE-CONVERSION-ERROR
  1638         MOVE '2' TO CP-RETURN-CODE
  1639         GO TO 1999-CALC-REF-AMT-X.
  1640
  1641     COMPUTE CP-CALC-REFUND ROUNDED =
  1642         (CP-ORIGINAL-PREMIUM / CP-TERM-OR-EXT-DAYS) *
  1643                 (CP-TERM-OR-EXT-DAYS - DC-ELAPSED-DAYS).
  1644
  1645     GO TO 1999-CALC-REF-AMT-X.
  1646
  1647*---------------------------------------------------------------
  1648 1025-REF-MEAN.
  1649     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1650     COMPUTE CP-CALC-REFUND ROUNDED =
  1651          ((CP-ORIGINAL-PREMIUM * PR-FACTOR) +
  1652           (CP-ORIGINAL-PREMIUM * R78-FACTOR)) * +.5.
  1653
  1654     GO TO 1999-CALC-REF-AMT-X.
  1655
  1656*---------------------------------------------------------------
  1657 1026-REF-R78.
  1658     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1659*    IF CP-TERM-TIMES-TERM
  1660*        COMPUTE R78-FACTOR =
  1661*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1662*               (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1663*
  1664     COMPUTE CP-CALC-REFUND ROUNDED =
  1665        CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1666
  1667     GO TO 1999-CALC-REF-AMT-X.
  1668
  1669*---------------------------------------------------------------
  1670 1027-TEXAS-REFUND.
  1671     MOVE '4'               TO CP-REFUND-TYPE-USED.
  1672     IF CP-PAY-FREQUENCY = ZERO
  1673        MOVE ZERO TO CP-CALC-REFUND
  1674        MOVE '5'  TO CP-RETURN-CODE
  1675        GO TO 1999-CALC-REF-AMT-X.
  1676
  1677     COMPUTE TEX-FACT-4 = (CP-ORIGINAL-TERM * CP-ORIGINAL-TERM) +
  1678         (CP-PAY-FREQUENCY * CP-ORIGINAL-TERM).
  1679
  1680     DIVIDE CP-REMAINING-TERM BY CP-PAY-FREQUENCY
  1681         GIVING TEX-FACT-5
  1682             REMAINDER TEX-FACT-6.
  1683
  1684     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CP-PAY-FREQUENCY.
  1685
  1686     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  1687         (TEX-FACT-5 * CP-PAY-FREQUENCY) +
  1688         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CP-PAY-FREQUENCY))).
  1689
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  32
* ELRFND.cbl
  1690     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  1691
  1692     COMPUTE CP-CALC-REFUND ROUNDED = CP-ORIGINAL-PREMIUM
  1693                                        * TEX-FACT-8.
  1694
  1695     GO TO 1999-CALC-REF-AMT-X.
  1696
  1697*---------------------------------------------------------------
  1698 1028-NET-PAY-REFUND.
  1699     MOVE '5'               TO CP-REFUND-TYPE-USED.
  1700     IF CP-LOAN-APR = ZERO
  1701        MOVE ZERO TO CP-CALC-REFUND
  1702        MOVE '1'  TO CP-RETURN-CODE
  1703        GO TO 1999-CALC-REF-AMT-X.
  1704
  1705     MOVE CP-LOAN-APR           TO N-P-APR.
  1706     MOVE CP-ORIGINAL-TERM      TO N-P-ORIG  N-P-LOAN.
  1707     MOVE CP-REMAINING-TERM     TO N-P-REM.
  1708
  1709     IF CP-TRUNCATED-LIFE
  1710        MOVE CP-LOAN-TERM     TO N-P-LOAN.
  1711
  1712     MOVE 'R'                   TO N-P-OPT.
  1713
  1714     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1715
  1716     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  1717                                        CP-ORIGINAL-PREMIUM.
  1718
  1719 1029-UTAH-REFUND.
  1720*
  1721*---------------------------------------------------------------
  1722* FOLLOWING IS FOR TRISH - 10/26/98  (FOR UTAH ONLY).
  1723*---------------------------------------------------------------
  1724*
  1725     GO TO 1999-CALC-REF-AMT-X.
  1726*
  1727*---------------------------------------------------------------
  1728     IF (CP-STATE-STD-ABBRV NOT = 'UT')
  1729                      OR
  1730        (CP-COMPANY-ID EQUAL 'NCL')
  1731         GO TO 1999-CALC-REF-AMT-X.
  1732     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1733
  1734     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1735        GREATER ZERO AND LESS 13
  1736         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1737                 (CP-CALC-REFUND * .05).
  1738
  1739     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1740        GREATER 12 AND LESS 25
  1741         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1742                 (CP-CALC-REFUND * .025).
  1743
  1744     GO TO 1999-CALC-REF-AMT-X.
  1745*---------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  33
* ELRFND.cbl
  1747*---------------------------------------------------------------
  1748 1030-GET-AH-REFUND.
  1749     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1750
  1751     COMPUTE R78-FACTOR =
  1752            ((CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1753                (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1))).
  1754
  1755*    IF CP-TERM-TIMES-TERM
  1756*        COMPUTE R78-FACTOR =
  1757*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1758*            (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1759*
  1760
  1761**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1762**** FOLLOWING.
  1763****       FOR VA. DISABILITY
  1764****                         --- EFF DATE > 123192 AND
  1765****                             TERM > 61 USE RULE OF ANTIC
  1766****                             OTHERWISE USE RULE OF 78.
  1767****
  1768****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1769****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1770****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1771****            WILL FOLLOW.
  1772****
  1773****
  1774****
  1775     IF CP-COMPANY-ID = 'NCL' or 'AHL'
  1776        IF CP-STATE-STD-ABBRV = 'VA'
  1777           IF (DC-GREG-DATE-CYMD GREATER 19921231) AND
  1778              (CP-ORIGINAL-TERM GREATER THAN 61)
  1779               MOVE '6'        TO CP-EARNING-METHOD
  1780               GO TO 1060-ANTICIPATION-REF
  1781            ELSE
  1782               MOVE '1'        TO CP-EARNING-METHOD
  1783               GO TO 1050-R78-REF.
  1784
  1785     IF CP-STATE-STD-ABBRV = 'WY'
  1786        IF CP-COMPANY-ID = 'TMS'
  1787           GO TO 1050-R78-REF.
  1788
  1789     IF CP-COMPANY-ID = 'NCL' OR 'WDS' OR 'CID' OR 'DCC' OR 'AHL'
  1790         NEXT SENTENCE
  1791     ELSE
  1792         IF CP-CRITICAL-PERIOD
  1793             GO TO 1035-REF-AH-CRITICAL-PERIOD.
  1794
  1795*      THE FOLLOWING HAPPENS WHEN THE REFUND METHOD FOR THE
  1796*    BENEFIT CODE IS A NON REFUNDABLE METHOD
  1797*    I AM CHECKING THE TERM AND REM TERM BECAUSE OF THE 30
  1798*    DAY FREE LOOK PERIOD. ALSO, 55 AND 56 ARE THE BIU CODES
  1799     IF (CP-GAP-NON-REFUNDABLE)
  1800        IF (CP-ORIGINAL-TERM NOT = CP-REMAINING-TERM)
  1801           OR (CP-BENEFIT-CD = '55' OR '56')
  1802           MOVE ZEROS            TO CP-CALC-REFUND
  1803           MOVE 'G'              TO CP-REFUND-TYPE-USED
  1804           GO TO 1999-CALC-REF-AMT-X
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  34
* ELRFND.cbl
  1805        END-IF
  1806     END-IF
  1807     IF CP-GAP-ACTUARIAL
  1808         GO TO 1070-NET-PAY-REFUND
  1809     END-IF
  1810     IF (CP-COMPANY-ID = 'CID')
  1811        AND (CP-STATE-STD-ABBRV = 'MN')
  1812        AND (DC-GREG-DATE-CYMD > 20091231)
  1813        IF (CP-CRITICAL-PERIOD)
  1814           GO TO 1040-PR-REF
  1815        ELSE
  1816           GO TO 1055-MEAN-REF
  1817     END-IF
  1818     IF CP-COMPANY-ID EQUAL 'CID' OR 'DCC'
  1819        IF CP-STATE-STD-ABBRV = 'NC'
  1820           GO TO SKIP-CSO-NC-AH-PROCESSING.
  1821
  1822     IF (CP-COMPANY-ID = 'CID')
  1823        AND (CP-STATE-STD-ABBRV = 'IN')
  1824        AND (DC-GREG-DATE-CYMD < 20030401)
  1825        GO TO 1026-REF-R78
  1826     END-IF
  1827
  1828     IF (CP-COMPANY-ID = 'CID')
  1829        AND (CP-STATE-STD-ABBRV = 'FL')
  1830        AND (DC-GREG-DATE-CYMD > 20030630)
  1831        AND (CP-CRITICAL-PERIOD)
  1832        GO TO 1040-PR-REF
  1833     END-IF
  1834
  1835     IF (CP-COMPANY-ID = 'CID')
  1836        AND (CP-STATE-STD-ABBRV = 'MO')
  1837        AND (DC-GREG-DATE-CYMD > 20030630)
  1838        AND (CP-CRITICAL-PERIOD)
  1839        GO TO 1040-PR-REF
  1840     END-IF
  1841
  1842     IF (CP-COMPANY-ID = 'CID')
  1843        AND (CP-STATE-STD-ABBRV = 'ND')
  1844        AND (CP-CRITICAL-PERIOD)
  1845        AND (DC-GREG-DATE-CYMD > 20011231)
  1846        GO TO 1040-PR-REF
  1847     END-IF
  1848
  1849     IF (CP-COMPANY-ID = 'CID')
  1850        AND (CP-STATE-STD-ABBRV = 'ND')
  1851        AND (DC-GREG-DATE-CYMD > 20011231)
  1852        GO TO 1060-ANTICIPATION-REF
  1853     END-IF
  1854
  1855     IF CP-STATE-STD-ABBRV = 'NC'
  1856       IF CP-COMPANY-ID = 'NCL' OR 'NCB'
  1857          NEXT SENTENCE
  1858       END-IF
  1859         IF DC-GREG-DATE-CYMD GREATER 19810930
  1860            IF CP-EARN-ANTICIPATION
  1861                GO TO 1060-ANTICIPATION-REF
  1862            ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  35
* ELRFND.cbl
  1863                GO TO 1055-MEAN-REF.
  1864
  1865 SKIP-CSO-NC-AH-PROCESSING.
  1866
  1867     IF CP-STATE-STD-ABBRV = 'NM'
  1868       IF CP-COMPANY-ID = 'NCL' OR 'DCC' OR 'AHL'
  1869          NEXT SENTENCE
  1870       END-IF
  1871         IF DC-GREG-DATE-CYMD GREATER THAN 19871231
  1872            IF CP-COMPANY-ID = 'MON'
  1873              MOVE '6'             TO CP-EARNING-METHOD
  1874              GO TO 1060-ANTICIPATION-REF
  1875             ELSE
  1876              GO TO 1055-MEAN-REF.
  1877
  1878     IF CP-STATE-STD-ABBRV = 'CT'
  1879       IF CP-COMPANY-ID EQUAL 'NCL' OR 'DCC'
  1880          NEXT SENTENCE
  1881       END-IF
  1882          MOVE '6'              TO CP-EARNING-METHOD
  1883          GO TO 1060-ANTICIPATION-REF.
  1884
  1885     IF CP-STATE-STD-ABBRV = 'ME'
  1886       IF CP-COMPANY-ID = 'NCL' OR 'CVL' OR 'DCC'
  1887          NEXT SENTENCE
  1888       END-IF
  1889           IF CP-EARN-BY-PRORATA
  1890              GO TO 1040-PR-REF
  1891           ELSE
  1892              MOVE '6'           TO CP-EARNING-METHOD
  1893              GO TO 1060-ANTICIPATION-REF.
  1894
  1895
  1896     IF CP-COMPANY-ID = 'CID' OR 'DCC'
  1897        IF CP-STATE-STD-ABBRV = 'TX' OR 'VA'
  1898            GO TO SKIP-CSO-TX-VA-AH-PROCESSING.
  1899
  1900     IF CP-STATE-STD-ABBRV = 'TX'
  1901       IF CP-COMPANY-ID = 'NCL' OR 'HER'
  1902          NEXT SENTENCE
  1903       END-IF
  1904        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1905           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1906           MOVE '6'              TO CP-EARNING-METHOD
  1907           GO TO 1060-ANTICIPATION-REF.
  1908
  1909     IF CP-STATE-STD-ABBRV = 'VA'
  1910       IF CP-COMPANY-ID EQUAL 'NCL'
  1911          NEXT SENTENCE
  1912       END-IF
  1913       IF CP-COMPANY-ID = 'NCB'
  1914           MOVE '6'                TO CP-EARNING-METHOD
  1915           GO TO 1060-ANTICIPATION-REF
  1916       ELSE
  1917           IF DC-GREG-DATE-CYMD GREATER 19921231
  1918               IF CP-ORIGINAL-TERM GREATER THAN 61
  1919                   MOVE '6'        TO CP-EARNING-METHOD
  1920                   GO TO 1060-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  36
* ELRFND.cbl
  1921               ELSE
  1922                   MOVE '1'        TO CP-EARNING-METHOD
  1923                   GO TO 1050-R78-REF.
  1924
  1925 SKIP-CSO-TX-VA-AH-PROCESSING.
  1926
  1927     IF CP-EARN-BY-PRORATA
  1928         GO TO 1040-PR-REF.
  1929
  1930     IF CP-EARN-BY-R78
  1931         GO TO 1050-R78-REF.
  1932
  1933     IF CP-EARN-AS-MEAN
  1934        GO TO 1055-MEAN-REF.
  1935
  1936     IF CP-EARN-AS-SUM-OF-DIGITS
  1937         GO TO 1075-SUM-OF-DIGITS.
  1938     IF CP-DCC-SPP-DDF
  1939        GO TO 1080-DCC-DDF-SPECIAL
  1940     END-IF
  1941     IF CP-EARN-AS-CALIF
  1942         GO TO 1060-ANTICIPATION-REF.
  1943
  1944     IF CP-EARN-ANTICIPATION
  1945         GO TO 1060-ANTICIPATION-REF.
  1946
  1947     IF CP-EARN-AS-NET-PAY
  1948         GO TO 1070-NET-PAY-REFUND.
  1949
  1950     GO TO 1050-R78-REF.
  1951
  1952*---------------------------------------------------------------
  1953 1035-REF-AH-CRITICAL-PERIOD.
  1954     IF CP-REMAINING-TERM GREATER +6
  1955        COMPUTE CP-CALC-REFUND ROUNDED =
  1956          CP-ORIGINAL-PREMIUM * (((CP-REMAINING-TERM * +2) - +5) /
  1957                       ((CP-ORIGINAL-TERM * +2) - + 5))
  1958      ELSE
  1959        COMPUTE CP-CALC-REFUND ROUNDED =
  1960          CP-ORIGINAL-PREMIUM * ((CP-REMAINING-TERM *
  1961                                           CP-REMAINING-TERM + 1)
  1962                              /  (+12 * CP-ORIGINAL-TERM) - +30).
  1963
  1964     IF CP-CALC-REFUND LESS ZERO
  1965         MOVE ZERO TO CP-CALC-REFUND.
  1966
  1967     GO TO 1999-CALC-REF-AMT-X.
  1968
  1969*---------------------------------------------------------------
  1970 1040-PR-REF.
  1971     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1972     COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1973
  1974     GO TO 1999-CALC-REF-AMT-X.
  1975
  1976*---------------------------------------------------------------
  1977 1050-R78-REF.
  1978     MOVE '1'               TO CP-REFUND-TYPE-USED.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  37
* ELRFND.cbl
  1979     COMPUTE CP-CALC-REFUND ROUNDED =
  1980           CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1981
  1982     GO TO 1999-CALC-REF-AMT-X.
  1983
  1984*---------------------------------------------------------------
  1985 1055-MEAN-REF.
  1986     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1987     COMPUTE CP-CALC-REFUND ROUNDED =
  1988         ((CP-ORIGINAL-PREMIUM * R78-FACTOR) +
  1989          (CP-ORIGINAL-PREMIUM * PR-FACTOR)) * .5.
  1990
  1991     GO TO 1999-CALC-REF-AMT-X.
  1992
  1993*---------------------------------------------------------------
  1994 1060-ANTICIPATION-REF.
  1995     MOVE '6'               TO CP-REFUND-TYPE-USED.
  1996
  1997     MOVE CP-ORIGINAL-TERM  TO WS-SAVE-TERM.
  1998     MOVE CP-LOAN-TERM      TO WS-SAVE-LOAN-TERM.
  1999     MOVE CP-EARNING-METHOD TO WS-SAVE-EARN-METHOD.
  2000
  2001     MOVE CP-REMAINING-TERM TO CP-ORIGINAL-TERM
  2002                               CP-LOAN-TERM.
  2003     MOVE CP-RATING-METHOD  TO CP-EARNING-METHOD.
  2004
  2005     PERFORM 2500-GET-RATE.
  2006
  2007     MOVE WS-SAVE-TERM      TO CP-ORIGINAL-TERM.
  2008     MOVE WS-SAVE-LOAN-TERM TO CP-LOAN-TERM.
  2009
  2010     IF CP-PREMIUM-RATE = ZEROS
  2011        MOVE '7'                 TO CP-RETURN-CODE
  2012        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  2013        GO TO 1999-CALC-REF-AMT-X.
  2014
  2015     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  2016
  2017     PERFORM 2500-GET-RATE.
  2018
  2019     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  2020
  2021     IF CP-PREMIUM-RATE = ZEROS
  2022        MOVE '7'            TO CP-RETURN-CODE
  2023        GO TO 1999-CALC-REF-AMT-X.
  2024
  2025     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  2026
  2027     IF  WS-ORIG-PREM = ZERO
  2028         MOVE ZERO                TO WS-NP-REF-FACTOR
  2029        ELSE
  2030         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  2031                                            WS-ORIG-PREM.
  2032
  2033     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  2034                                        CP-ORIGINAL-PREMIUM.
  2035
  2036     IF NOT CP-EARN-AS-CALIF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  38
* ELRFND.cbl
  2037         GO TO 1999-CALC-REF-AMT-X.
  2038
  2039*---------------------------------------------------------------
  2040 1065-CALIF-REGS.
  2041     MOVE '3'               TO CP-REFUND-TYPE-USED.
  2042     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  2043         GIVING FACTOR-5.
  2044
  2045     IF FACTOR-5 NOT GREATER +6  AND
  2046        CP-CLASS-CODE = 'A '
  2047         GO TO 1050-R78-REF.
  2048
  2049     IF FACTOR-5 = ZERO
  2050         MOVE CP-ORIGINAL-PREMIUM   TO CP-CALC-REFUND
  2051         GO TO 1999-CALC-REF-AMT-X.
  2052
  2053     IF CP-ORIGINAL-TERM LESS +014
  2054         GO TO 1999-CALC-REF-AMT-X.
  2055
  2056     MULTIPLY CP-ORIGINAL-TERM BY CP-ORIGINAL-TERM
  2057                                   GIVING FACTOR-5 ROUNDED.
  2058
  2059     MULTIPLY FACTOR-5 BY +0.0000045573 GIVING FACTOR-1 ROUNDED.
  2060
  2061     MULTIPLY +0.001125 BY CP-ORIGINAL-TERM
  2062                                   GIVING FACTOR-2 ROUNDED.
  2063
  2064     SUBTRACT FACTOR-2 FROM FACTOR-1.
  2065     ADD +0.099375 TO FACTOR-1.
  2066
  2067     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  2068                                   GIVING FACTOR-5 ROUNDED.
  2069
  2070     SUBTRACT +1.00 FROM FACTOR-5.
  2071
  2072     IF CP-ORIGINAL-TERM LESS +049
  2073         SUBTRACT +013 FROM CP-ORIGINAL-TERM
  2074                                   GIVING FACTOR-6 ROUNDED
  2075     ELSE
  2076         MOVE +035 TO FACTOR-6.
  2077
  2078     MOVE +001 TO FACTOR-2.
  2079
  2080     DIVIDE FACTOR-5 BY FACTOR-6 GIVING FACTOR-4 ROUNDED.
  2081     SUBTRACT FACTOR-4 FROM FACTOR-2.
  2082     MULTIPLY FACTOR-1 BY FACTOR-2 GIVING FACTOR-3 ROUNDED.
  2083     MOVE +001 TO FACTOR-2.
  2084     SUBTRACT FACTOR-3 FROM FACTOR-2 GIVING FACTOR-1 ROUNDED.
  2085
  2086     MULTIPLY FACTOR-1 BY CP-CALC-REFUND
  2087         GIVING CAL-RFND ROUNDED.
  2088
  2089     IF CAL-RFND LESS +0.01
  2090         MOVE ZEROS TO CAL-RFND.
  2091
  2092     IF CAL-RFND LESS CP-CALC-REFUND
  2093         MOVE CAL-RFND TO CP-CALC-REFUND.
  2094
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  39
* ELRFND.cbl
  2095     GO TO 1999-CALC-REF-AMT-X.
  2096
  2097*-----------------------------------------------------------------
  2098 1070-NET-PAY-REFUND.
  2099     MOVE '5'                    TO  CP-REFUND-TYPE-USED.
  2100     IF CP-LOAN-APR = ZERO
  2101         MOVE ZEROS              TO  CP-CALC-REFUND
  2102         MOVE '1'                TO  CP-RETURN-CODE
  2103         GO TO 1999-CALC-REF-AMT-X.
  2104
  2105     MOVE CP-LOAN-APR            TO  N-P-APR.
  2106     MOVE CP-ORIGINAL-TERM       TO  N-P-ORIG  N-P-LOAN.
  2107     MOVE CP-REMAINING-TERM      TO  N-P-REM.
  2108
  2109     MOVE 'R'                    TO  N-P-OPT.
  2110
  2111     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2112
  2113     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  2114                                        CP-ORIGINAL-PREMIUM.
  2115
  2116     GO TO 1999-CALC-REF-AMT-X.
  2117*---------------------------------------------------------------
  2118
  2119 1075-SUM-OF-DIGITS.
  2120
  2121     MOVE '9'               TO CP-REFUND-TYPE-USED.
  2122
  2123     COMPUTE RSUM-REMAINING-TERM =
  2124             CP-LOAN-TERM -
  2125                  (CP-ORIGINAL-TERM - (CP-REMAINING-TERM + 1))
  2126
  2127     COMPUTE RSUM-FACTOR =
  2128        ((RSUM-REMAINING-TERM * (RSUM-REMAINING-TERM + 1)) -
  2129               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2130                 (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1)))   /
  2131            ((CP-LOAN-TERM * (CP-LOAN-TERM + 1))           -
  2132               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2133                 (CP-LOAN-TERM - CP-ORIGINAL-TERM  + 1))).
  2134
  2135     COMPUTE CP-CALC-REFUND ROUNDED =
  2136           CP-ORIGINAL-PREMIUM * RSUM-FACTOR.
  2137
  2138     GO TO 1999-CALC-REF-AMT-X
  2139     .
  2140 1080-DCC-DDF-SPECIAL.
  2141     COMPUTE CP-MONTH =
  2142        FUNCTION REM(CP-ORIGINAL-TERM - CP-REMAINING-TERM, 12)
  2143*    DISPLAY ' BEGIN ELCRFNDP ************** '
  2144*    DISPLAY ' SPEC       ' CP-DDF-SPEC-CALC
  2145*    DISPLAY ' MONTH      ' CP-MONTH
  2146*    DISPLAY ' ORIG TERM  ' CP-ORIGINAL-TERM
  2147*    DISPLAY ' REM TERM   ' CP-REMAINING-TERM
  2148*    DISPLAY ' ORIG PREM  ' CP-ORIGINAL-PREMIUM
  2149*    DISPLAY ' 1YR EXP AL ' CP-1ST-YR-ALLOW
  2150*    DISPLAY ' HI FACT    ' CP-DDF-HI-FACT
  2151*    DISPLAY ' LO FACT    ' CP-DDF-LO-FACT
  2152*    DISPLAY ' RATE UP    ' CP-IU-RATE-UP
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  40
* ELRFND.cbl
  2153*    DISPLAY ' CLP RAT UP ' CP-CLP-RATE-UP
  2154*    DISPLAY ' EARM METH  ' CP-EARNING-METHOD
  2155*    DISPLAY '   END ELCRFNDP ************** '
  2156     IF CP-MONTH = 0
  2157        MOVE 12                  TO CP-MONTH
  2158     END-IF
  2159     MOVE CP-MONTH               TO WS-MONTH
  2160     MOVE 'D'                    TO CP-REFUND-TYPE-USED
  2161     IF CP-DCC-SPP-DDF-IU
  2162        GO TO 1090-DCC-DDF-IU
  2163     END-IF
  2164     IF CP-CALC-CLP
  2165        GO TO 1085-DCC-DDF-SPECIAL-CLP
  2166     END-IF
  2167     EVALUATE TRUE
  2168        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2169           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2170           MOVE CP-ORIGINAL-PREMIUM
  2171                                 TO CP-CALC-REFUND
  2172        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2173           MOVE CP-MONTH         TO WS-MONTH
  2174           PERFORM 1150-UE-GROSS-LT-4
  2175           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2176        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2177           MOVE CP-MONTH         TO WS-MONTH
  2178           PERFORM 1160-UE-GROSS-LT-13
  2179           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2180        WHEN OTHER
  2181           MOVE CP-MONTH         TO WS-MONTH
  2182           PERFORM 1170-UE-GROSS-GT-12
  2183           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2184     END-EVALUATE
  2185     GO TO 1999-CALC-REF-AMT-X
  2186     .
  2187 1085-DCC-DDF-SPECIAL-CLP.
  2188     EVALUATE TRUE
  2189        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2190           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2191           MOVE CP-ORIGINAL-PREMIUM
  2192                                 TO CP-CALC-REFUND
  2193        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2194           MOVE CP-MONTH         TO WS-MONTH
  2195           PERFORM 1100-UE-CLP-LT-4
  2196           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2197        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2198           MOVE CP-MONTH         TO WS-MONTH
  2199           PERFORM 1110-UE-CLP-LT-13
  2200           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2201        WHEN OTHER
  2202           MOVE CP-MONTH         TO WS-MONTH
  2203           PERFORM 1120-UE-CLP-GT-12
  2204           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2205     END-EVALUATE
  2206     GO TO 1999-CALC-REF-AMT-X
  2207     .
  2208 1090-DCC-DDF-IU.
  2209     MOVE 'I'                    TO CP-REFUND-TYPE-USED
  2210     IF CP-CALC-CLP
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  41
* ELRFND.cbl
  2211        GO TO 1095-DCC-DDF-IU-SPECIAL-CLP
  2212     END-IF
  2213     EVALUATE TRUE
  2214        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2215           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2216           MOVE CP-ORIGINAL-PREMIUM
  2217                                 TO CP-CALC-REFUND
  2218        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2219           MOVE CP-MONTH         TO WS-MONTH
  2220           PERFORM 1250-IU-UE-GROSS-LT-4
  2221           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2222        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2223           MOVE CP-MONTH         TO WS-MONTH
  2224           PERFORM 1260-IU-UE-GROSS-LT-13
  2225           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2226        WHEN OTHER
  2227           MOVE CP-MONTH         TO WS-MONTH
  2228           PERFORM 1270-IU-UE-GROSS-GT-12
  2229           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2230     END-EVALUATE
  2231     GO TO 1999-CALC-REF-AMT-X
  2232     .
  2233 1095-DCC-DDF-IU-SPECIAL-CLP.
  2234     EVALUATE TRUE
  2235        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2236           OR (CP-DDF-CLP = ZEROS)
  2237           MOVE CP-DDF-CLP       TO CP-CALC-REFUND
  2238        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2239           MOVE CP-MONTH         TO WS-MONTH
  2240           PERFORM 1200-IU-UE-CLP-LT-4
  2241           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2242        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2243           MOVE CP-MONTH         TO WS-MONTH
  2244           PERFORM 1210-IU-UE-CLP-LT-13
  2245           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2246        WHEN OTHER
  2247           MOVE CP-MONTH         TO WS-MONTH
  2248           PERFORM 1220-IU-UE-CLP-GT-12
  2249           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2250     END-EVALUATE
  2251     GO TO 1999-CALC-REF-AMT-X
  2252     .
  2253 1100-UE-CLP-LT-4.
  2254*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*mo/12}
  2255     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2256        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2257        / CP-DDF-CLP - CP-DDF-HI-FACT)
  2258        * WS-MONTH / 12)
  2259     .
  2260 1110-UE-CLP-LT-13.
  2261*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12}
  2262*****  -[(CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12
  2263*****  -CLP*UEF1}*(mo-3)/9]
  2264     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2265        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2266        / CP-DDF-CLP - CP-DDF-HI-FACT) * 3 / 12)
  2267        -  ((CP-DDF-CLP - 0) - CP-DDF-CLP
  2268        * (((CP-DDF-CLP - 0) / CP-DDF-CLP
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  42
* ELRFND.cbl
  2269        - CP-DDF-HI-FACT) * 3 / 12) - CP-DDF-CLP
  2270        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2271     .
  2272 1120-UE-CLP-GT-12.
  2273*****  CLP * {UEF1 - (UEF1 -UEF2)*mo/12}
  2274     COMPUTE WS-TEMP-RESULT ROUNDED = CP-DDF-CLP *
  2275        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2276        * WS-MONTH / 12)
  2277     .
  2278 1150-UE-GROSS-LT-4.
  2279     COMPUTE CP-1ST-YR-ALLOW = CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2280     COMPUTE WS-TEMP-RESULT ROUNDED =
  2281        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2282        * WS-MONTH / 3) - (CP-ORIGINAL-PREMIUM -
  2283        CP-1ST-YR-ALLOW - CP-DDF-YR1AF) * (1 - CP-DDF-HI-FACT)
  2284        * WS-MONTH / 12
  2285     .
  2286 1160-UE-GROSS-LT-13.
  2287     MOVE 3                      TO WS-MONTH
  2288     PERFORM 1150-UE-GROSS-LT-4
  2289     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2290     MOVE CP-MONTH               TO WS-MONTH
  2291     COMPUTE WS-TEMP-RESULT ROUNDED = WS-GFR3 - (WS-GFR3
  2292        - (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF)
  2293        * (CP-DDF-HI-FACT)) * ((WS-MONTH - 3) / 9)
  2294     .
  2295 1170-UE-GROSS-GT-12.
  2296*****  (GF-Yr1 Texp) * {UEF1 - (UEF1 -UEF2)*mo/12}
  2297     COMPUTE WS-TEMP-RESULT ROUNDED =
  2298        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW)
  2299        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2300        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2301     .
  2302 1200-IU-UE-CLP-LT-4.
  2303*****  no changes with < 4  pema 08/03/11
  2304*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*mo/12)
  2305     COMPUTE WS-TEMP-RESULT ROUNDED =
  2306        (CP-DDF-CLP - 0)
  2307        - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2308        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2309        * WS-MONTH / 12
  2310     .
  2311 1210-IU-UE-CLP-LT-13.
  2312*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2313*****  -[(CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2314*****  - CLP*UEF1]*(mo-3)/9
  2315     MOVE 3                      TO WS-MONTH
  2316     PERFORM 1200-IU-UE-CLP-LT-4
  2317     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2318     MOVE CP-MONTH               TO WS-MONTH
  2319     COMPUTE WS-TEMP-RESULT ROUNDED =
  2320        WS-UE-CLP - (WS-UE-CLP - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2321          * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2322     .
  2323 1220-IU-UE-CLP-GT-12.
  2324*****  CLP*{UEF1 - (UEF1 -UEF2)*mo/12}
  2325     COMPUTE WS-TEMP-RESULT ROUNDED =
  2326        (CP-DDF-CLP - CP-CLP-RATE-UP)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  43
* ELRFND.cbl
  2327        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2328        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2329     .
  2330 1250-IU-UE-GROSS-LT-4.
  2331*****  (Comm+MngtFee)*UECLPmo/CLPCounty+CLPCounty+AdminFee-
  2332*****  Yr1 AF*(mo/3)-[CLP*(UEF1-UEF2)+(AdminFee-Yr1AF)*
  2333*****  (1-UEF1)]*mo/12
  2334     PERFORM 1200-IU-UE-CLP-LT-4
  2335     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2336     COMPUTE WS-TEMP-RESULT = CP-DDF-COMM-AND-MFEE *
  2337        WS-UE-CLP / CP-DDF-CLP + CP-DDF-CLP +
  2338        CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF *
  2339        WS-MONTH / 3 - ((CP-DDF-CLP - CP-CLP-RATE-UP)
  2340        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2341        + (CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF)
  2342        * (1 - CP-DDF-HI-FACT)) * WS-MONTH / 12
  2343     .
  2344 1260-IU-UE-GROSS-LT-13.
  2345***** uegf3-(uegf3-(gf - 1st yr - clprateu)*hi))*(mo-3)/9
  2346     MOVE 3                      TO WS-MONTH
  2347     PERFORM 1250-IU-UE-GROSS-LT-4
  2348     move cp-month               to ws-month
  2349     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2350     COMPUTE WS-TEMP-RESULT ROUNDED =
  2351        WS-GFR3 - (WS-GFR3 - ((CP-ORIGINAL-PREMIUM
  2352        - CP-1ST-YR-ALLOW - cp-clp-rate-up))
  2353        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2354     .
  2355 1270-IU-UE-GROSS-GT-12.
  2356***** (gf - 1st yr - clprateu)*(hi-(hi-lo)*mo/12)
  2357     COMPUTE WS-TEMP-RESULT ROUNDED =
  2358        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW
  2359        - CP-CLP-RATE-UP) *
  2360        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2361        * WS-MONTH / 12)
  2362     .
  2363 1299-END-DDF-CALCS.
  2364     .
  2365 1999-CALC-REF-AMT-X.
  2366
  2367     MOVE CALCULATION-PASS-AREA TO DFHCOMMAREA.
  2368
  2369
  2370* EXEC CICS RETURN
  2371*    END-EXEC.
  2372*    MOVE '.(                    ''   #00002365' TO DFHEIV0
  2373     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2374     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2375     MOVE X'2020233030303032333635' TO DFHEIV0(25:11)
  2376     CALL 'kxdfhei1' USING DFHEIV0,
  2377           DFHEIV99,
  2378           DFHEIV99,
  2379           DFHEIV99,
  2380           DFHEIV99,
  2381           DFHEIV99,
  2382           DFHEIV99
  2383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2384
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  44
* ELRFND.cbl
  2385
  2386* GOBACK.
  2387     MOVE '9%                    "   ' TO DFHEIV0
  2388     MOVE 'ELRFND' TO DFHEIV1
  2389     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2390     GOBACK.
  2391
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  45
* ELRFND.cbl
  2393  2500-GET-RATE.
  2394
  2395* EXEC CICS LINK
  2396*        PROGRAM    ('ELRATE')
  2397*        COMMAREA   (CALCULATION-PASS-AREA)
  2398*        LENGTH     (CP-COMM-LENGTH)
  2399*        END-EXEC.
  2400     MOVE 'ELRATE' TO DFHEIV1
  2401*    MOVE '."C                   (   #00002371' TO DFHEIV0
  2402     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2403     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2404     MOVE X'2020233030303032333731' TO DFHEIV0(25:11)
  2405     CALL 'kxdfhei1' USING DFHEIV0,
  2406           DFHEIV1,
  2407           CALCULATION-PASS-AREA,
  2408           CP-COMM-LENGTH,
  2409           DFHEIV99,
  2410           DFHEIV99,
  2411           DFHEIV99,
  2412           DFHEIV99
  2413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2414
  2415
  2416  2500-EXIT.
  2417       EXIT.
  2418
  2419  9100-CONVERT-DATE.
  2420
  2421* EXEC CICS LINK
  2422*         PROGRAM   ('ELDATCV')
  2423*         COMMAREA  (DATE-CONVERSION-DATA)
  2424*         LENGTH    (DC-COMM-LENGTH)
  2425*    END-EXEC.
  2426     MOVE 'ELDATCV' TO DFHEIV1
  2427*    MOVE '."C                   (   #00002381' TO DFHEIV0
  2428     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2429     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2430     MOVE X'2020233030303032333831' TO DFHEIV0(25:11)
  2431     CALL 'kxdfhei1' USING DFHEIV0,
  2432           DFHEIV1,
  2433           DATE-CONVERSION-DATA,
  2434           DC-COMM-LENGTH,
  2435           DFHEIV99,
  2436           DFHEIV99,
  2437           DFHEIV99,
  2438           DFHEIV99
  2439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2440
  2441
  2442  9100-EXIT.
  2443       EXIT.
  2444
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  46
* ELRFND.cbl
  2446  10000-NET-TERM  SECTION.
  2447*                      COPY ERCNETP.
  2448*****************************************************************
  2449*                                                               *
  2450*                            ERCNETP                            *
  2451*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2452*                            VMOD=2.029                         *
  2453*                                                               *
  2454*****************************************************************.
  2455*
  2456*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  2457*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  2458*                                   ORIGINAL TERM (S999)
  2459*                                   REMAINING TERM (S999)
  2460*                                   NET PAY OPTION (X)
  2461*                                   LOAN TERM (S999)
  2462*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  2463*
  2464*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  2465*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  2466*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  2467*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  2468*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  2469*    CHARGED.
  2470*
  2471*    OPTIONS - S = NET SIMPLE
  2472*          SPACE = NET PAY  (1 MO. INTEREST)
  2473*              A = NET PAY  (0 MO. INTEREST)
  2474*              I = NET PAY  (2 MO. INTEREST)
  2475*              J = NET PAY  (3 MO. INTEREST)
  2476*              K = NET PAY  (4 MO. INTEREST)
  2477*              T = TRUNCATED  (0 MO. INTEREST)
  2478*              U = TRUNCATED  (1 MO. INTEREST)
  2479*              V = TRUNCATED  (2 MO. INTEREST)
  2480*              W = TRUNCATED  (3 MO. INTEREST)
  2481*              X = TRUNCATED  (4 MO. INTEREST)
  2482*              R = REFUNDS (REGULAR OR TRUNCATED)
  2483******************************************************************
  2484*                   C H A N G E   L O G
  2485*
  2486* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2487*-----------------------------------------------------------------
  2488*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2489* EFFECTIVE    NUMBER
  2490*-----------------------------------------------------------------
  2491* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  2492* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  2493* 120403                   PEMA  ADD SPECIAL TX CALC
  2494* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2495* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2496* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  2497* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  2498* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  2499* 021207                   PEMA  ADD PA NP
  2500* 022107                   PEMA  ADD NH NP AND NP TRUNC
  2501* 032807                   PEMA  ADD VT NP PLUS 2
  2502* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  2503* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  47
* ELRFND.cbl
  2504* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  2505* 110207      TO 'AL' NET PAY CALC
  2506* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  2507* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  2508* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  2509* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  2510* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  2511* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  2512* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  2513* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2514* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  2515* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2516* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  2517* 032612  CR2011110200001  PEMA  AHL CHANGES
  2518* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  2519* 122613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  2520******************************************************************
  2521
  2522     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  2523     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  2524     MOVE N-P-LOAN    TO LOAN-TERM.
  2525     MOVE N-P-REM     TO REMAINING-TERM.
  2526     MOVE N-P-OPT     TO OPTION-SW.
  2527
  2528     MOVE +0 TO FACTOR.
  2529
  2530     IF ANNUAL-INT-RATE = ZERO
  2531         GO TO 99000-ERROR.
  2532     IF ORIGINAL-TERM = ZERO
  2533         GO TO 99999-RETURN.
  2534     IF REMAINING-TERM = ZERO
  2535         GO TO 99999-RETURN.
  2536     IF REMAINING-TERM GREATER ORIGINAL-TERM
  2537         GO TO 99000-ERROR.
  2538     IF LOAN-TERM = ZERO
  2539         GO TO 99999-RETURN.
  2540     IF LOAN-TERM LESS ORIGINAL-TERM
  2541         GO TO 99000-ERROR.
  2542
  2543*    IF ANNUAL-INT-RATE LESS +2
  2544*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2545*    IF ANNUAL-INT-RATE LESS +2
  2546*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2547*    IF ANNUAL-INT-RATE LESS +2
  2548*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2549
  2550     IF NPO-REFUND
  2551         MOVE '2' TO NP-PROCESS-SW
  2552       ELSE
  2553         IF ORIGINAL-TERM = REMAINING-TERM
  2554            MOVE '1'   TO NP-PROCESS-SW
  2555           ELSE
  2556            MOVE '3'   TO NP-PROCESS-SW.
  2557
  2558     IF NPO-SIMPLE
  2559         MOVE 'S' TO TYPE-SW
  2560     ELSE
  2561         MOVE 'N' TO TYPE-SW.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  48
* ELRFND.cbl
  2562
  2563     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  2564
  2565     COMPUTE V ROUNDED = K1 / (K1 + I).
  2566
  2567     MOVE V     TO VX
  2568                   SV.
  2569
  2570     MOVE +1    TO X1
  2571                   SX.
  2572
  2573     MOVE LOAN-TERM TO MAX-X.
  2574
  2575     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  2576
  2577     IF MAX-X = +1
  2578        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  2579
  2580     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  2581
  2582     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  2583         OR 'DCC'        OR 'NCL') AND
  2584        (NOT NP-REFUND)
  2585        NEXT SENTENCE
  2586     ELSE
  2587     IF LOAN-TERM NOT = ORIGINAL-TERM
  2588        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  2589
  2590     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  2591
  2592 10500-VX-LOOP.
  2593
  2594***  VX = AMORT. LOAN TERM.
  2595***  SV = AMORT. INSURANCE TERM.
  2596***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  2597***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  2598***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  2599
  2600     IF X2 = 1
  2601        MOVE V         TO SX
  2602     END-IF
  2603     COMPUTE VX ROUNDED = VX * V.
  2604
  2605     ADD B1 TO X1.
  2606
  2607     IF X1 = REMAINING-TERM
  2608          MOVE VX    TO SV.
  2609
  2610     IF X1 EQUAL SV-MINUS-ONE
  2611        MOVE VX      TO SV-MINUS-ONE.
  2612
  2613     IF X1 = X2
  2614          MOVE VX    TO SX.
  2615
  2616     IF X1 NOT = MAX-X
  2617          GO TO 10500-VX-LOOP.
  2618
  2619 10700-COMPUTE-REMAINING-FACTOR.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  49
* ELRFND.cbl
  2620*****  WK1 = LOAN TERM AMORT
  2621     COMPUTE WK1 = K1 - VX.
  2622*****  WK2 = INS TERM AMORT
  2623     COMPUTE WK2 = K1 - SV.
  2624*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  2625     COMPUTE WK5 = K1 - SX.
  2626*****  WK6 = INS TERM - 1
  2627     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  2628
  2629     IF NP-RATING
  2630         GO TO 12000-PREMIUM-RATE.
  2631
  2632     IF NP-REFUND
  2633         GO TO 11000-REFUND-CALC.
  2634
  2635     IF NET-STD
  2636         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  2637
  2638     IF NET-SMP
  2639         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  2640         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  2641         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  2642         COMPUTE WK3 ROUNDED = WK3 * 1000.
  2643
  2644     IF REMAINING-TERM LESS THAN X2
  2645         MOVE +0 TO WK3.
  2646
  2647     MOVE WK3 TO FACTOR.
  2648
  2649     GO TO 99999-RETURN.
  2650
  2651 11000-REFUND-CALC.
  2652     IF REMAINING-TERM NOT LESS MAX-X
  2653        MOVE +1 TO FACTOR
  2654        GO TO 99999-RETURN.
  2655
  2656     IF REMAINING-TERM LESS +1
  2657        MOVE 0 TO FACTOR
  2658        GO TO 99999-RETURN.
  2659
  2660     COMPUTE WK2 ROUNDED = WK2 / I.
  2661     COMPUTE WK5 ROUNDED = WK5 / I.
  2662     COMPUTE WK1 ROUNDED = WK1 / I.
  2663
  2664     IF (CP-COMPANY-ID EQUAL 'CID')
  2665        AND (CP-STATE-STD-ABBRV = 'MN')
  2666        AND (CP-CERT-EFF-DT > X'A4FF')
  2667        AND (CP-RATE-AS-REG-BALLOON)
  2668        AND (CP-EARN-AS-NET-PAY)
  2669        AND (CP-DEVIATION-CODE NOT = 'LEV')
  2670        CONTINUE
  2671     ELSE
  2672        GO TO 11000-CHECK-MN-LEV-BALLOON
  2673     END-IF
  2674
  2675     COMPUTE R = M - E
  2676     COMPUTE FACTOR = (R - WK2 + WK5) /
  2677        (M - WK1 + WK5)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  50
* ELRFND.cbl
  2678
  2679     GO TO 99999-RETURN
  2680
  2681      .
  2682 11000-CHECK-MN-LEV-BALLOON.
  2683
  2684     IF (CP-COMPANY-ID EQUAL 'CID')
  2685        AND (CP-STATE-STD-ABBRV = 'MN')
  2686        AND (CP-CERT-EFF-DT > X'A4FF')
  2687        AND (CP-RATE-AS-REG-BALLOON)
  2688        AND (CP-EARN-AS-NET-PAY)
  2689        AND (CP-DEVIATION-CODE = 'LEV')
  2690        CONTINUE
  2691     ELSE
  2692        GO TO 11000-CONTINUE-REFUND
  2693     END-IF
  2694
  2695     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  2696     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  2697        ** (M - E)) / I
  2698
  2699     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  2700
  2701     GO TO 99999-RETURN
  2702
  2703     .
  2704 11000-CONTINUE-REFUND.
  2705*    IF CP-GAP-ACTUARIAL
  2706*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  2707*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2708*       COMPUTE WK3 = WK2 / ANGLEN
  2709*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  2710     IF CP-GAP-ACTUARIAL
  2711        COMPUTE ANGLEN = WK1 / ((1 + I) **
  2712           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2713        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  2714     ELSE
  2715        COMPUTE WK3 ROUNDED =
  2716          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  2717     END-IF
  2718
  2719     MOVE WK3  TO FACTOR.
  2720
  2721     GO TO 99999-RETURN.
  2722
  2723 12000-PREMIUM-RATE.
  2724*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  2725*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  2726*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  2727*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  2728*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  2729*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  2730
  2731     COMPUTE K-I = K1 + I.
  2732     MOVE K-I TO ONE-PLUS-I.
  2733
  2734     IF NPO-ALT OR NPO-TRUNC-0
  2735         MOVE K1 TO K-I.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  51
* ELRFND.cbl
  2736
  2737     IF NPO-2MO OR NPO-TRUNC-2
  2738         COMPUTE K-I = K1 + (2 * I).
  2739
  2740     IF NPO-3MO OR NPO-TRUNC-3
  2741         COMPUTE K-I = K1 + (3 * I).
  2742
  2743     IF NPO-4MO OR NPO-TRUNC-4
  2744         COMPUTE K-I = K1 + (4 * I).
  2745
  2746     COMPUTE RA ROUNDED = 1 -
  2747             ((X2 * (X2 + 1)) /
  2748              (N *  (N  + 1))).
  2749
  2750     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2751        (CP-CSL-VALID-NP-BENEFIT-CD)
  2752        NEXT SENTENCE
  2753     ELSE
  2754        GO TO XXXX-CHECK-DISCOUNT-5.
  2755
  2756     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2757     MOVE ' ' TO DC-OPTION-CODE.
  2758     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2759
  2760     IF DATE-CONVERSION-ERROR
  2761        MOVE '2'                 TO CP-RETURN-CODE
  2762        MOVE ZEROS               TO FACTOR
  2763                                    CP-CALC-PREMIUM
  2764         GO TO 99999-RETURN.
  2765
  2766     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  2767     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  2768     MOVE ' ' TO DC-OPTION-CODE
  2769     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2770
  2771     IF DATE-CONVERSION-ERROR
  2772        MOVE '2'                 TO CP-RETURN-CODE
  2773        MOVE ZEROS               TO FACTOR
  2774                                    CP-CALC-PREMIUM
  2775         GO TO 99999-RETURN.
  2776
  2777     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  2778
  2779     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  2780
  2781     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  2782        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  2783        CP-PAY-FREQUENCY / 365) * I
  2784     ELSE
  2785        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  2786        CP-PAY-FREQUENCY / 365) * I.
  2787
  2788     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  2789     13).
  2790
  2791     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  2792     (N - ( ANGLEN-1 / WK3)).
  2793
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  52
* ELRFND.cbl
  2794     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  2795
  2796     COMPUTE WS-CALC-FREQ-RATE EQUAL
  2797       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  2798
  2799     COMPUTE WS-Y-X-FACTOR EQUAL
  2800       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  2801       WS-CALC-FREQ-RATE).
  2802
  2803     COMPUTE WS-ODD-DAY-UNITS EQUAL
  2804       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  2805
  2806     COMPUTE WS-X-Y-FACTOR EQUAL
  2807       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  2808
  2809     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  2810       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  2811       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  2812
  2813     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  2814
  2815     GO TO 99999-RETURN.
  2816
  2817 XXXX-CHECK-DISCOUNT-5.
  2818
  2819     IF WS-DISCOUNT-OPTION EQUAL '5'
  2820        NEXT SENTENCE
  2821     ELSE
  2822        GO TO 12000-CHECK-CLIENT.
  2823
  2824      COMPUTE ANGLEN EQUAL WK1 / I.
  2825
  2826      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  2827
  2828      COMPUTE WK3 EQUAL
  2829        (12 *
  2830        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  2831        CP-ORIGINAL-BENEFIT)) /
  2832        APR100.
  2833
  2834     COMPUTE WK3 EQUAL
  2835        (WK3 * CP-PREMIUM-RATE) / +1000.
  2836
  2837     COMPUTE WK3 EQUAL
  2838        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  2839
  2840      MOVE WK3 TO CP-CALC-PREMIUM.
  2841
  2842     GO TO 99999-RETURN.
  2843
  2844 12000-CHECK-CLIENT.
  2845
  2846     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2847        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2848        (CP-TRUNCATED-LIFE)
  2849        NEXT SENTENCE
  2850     ELSE
  2851        GO TO 12000-CHECK-NEXT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  53
* ELRFND.cbl
  2852
  2853     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  2854
  2855     COMPUTE ANGLEN EQUAL WK1 / I.
  2856     COMPUTE ANGLEM EQUAL WK2 / I.
  2857
  2858     COMPUTE FM EQUAL
  2859                    (((ONE-PLUS-I ** M) * I * M) /
  2860                    ((ONE-PLUS-I ** M) - 1))
  2861                    - 1.
  2862
  2863     COMPUTE FN EQUAL
  2864                    (((ONE-PLUS-I ** N) * I * N) /
  2865                    ((ONE-PLUS-I ** N) - 1))
  2866                    - 1.
  2867
  2868     COMPUTE FNM EQUAL
  2869                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  2870                    ((ONE-PLUS-I ** (N - M)) - 1))
  2871                    - 1.
  2872
  2873     COMPUTE GR EQUAL
  2874                    (WS-WORK-RATE * ANGLEM * I) /
  2875                    (M - ANGLEM).
  2876
  2877     COMPUTE ODF EQUAL
  2878                     (1 +
  2879                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  2880                     360)) /
  2881                     ONE-PLUS-I.
  2882
  2883     COMPUTE OD EQUAL
  2884                    (1 + (ODF * (FN / I - 1))) +
  2885                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  2886
  2887     COMPUTE WK3 EQUAL
  2888*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  2889                    ((1 + FN) * ODF *
  2890                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  2891                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  2892                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  2893
  2894     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  2895     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  2896
  2897     COMPUTE WK3 EQUAL
  2898                    (WK3 / (ODF * (1 + FN))) -
  2899*                   CP-ORIGINAL-BENEFIT.
  2900                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  2901
  2902      MOVE WK3 TO CP-CALC-PREMIUM.
  2903
  2904     GO TO 99999-RETURN.
  2905
  2906 12000-CHECK-NEXT.
  2907
  2908     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  2909        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  54
* ELRFND.cbl
  2910     ELSE
  2911        GO TO 12000-CHECK-PA-TRUNC.
  2912
  2913      IF WS-WORK-DIS-RATE EQUAL +0
  2914         MOVE '7'                TO CP-RETURN-CODE
  2915         MOVE ZEROS              TO FACTOR
  2916                                    CP-CALC-PREMIUM
  2917         GO TO 99999-RETURN.
  2918
  2919      COMPUTE ANGLEN EQUAL WK1 / I.
  2920
  2921      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  2922
  2923      IF WS-WORK-DIS-RATE EQUAL APR100
  2924         ADD .00001 TO APR100.
  2925
  2926      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  2927      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  2928
  2929     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  2930        / (1 + I)
  2931     COMPUTE ANGLEN-1 = ANGLEN / Y
  2932      IF CP-COMPANY-ID EQUAL 'CDL'
  2933         COMPUTE WK3 EQUAL
  2934
  2935          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  2936          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  2937
  2938          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  2939
  2940          ((WK8 ** N) /
  2941          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  2942
  2943          ((WK9 ** N) /
  2944          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  2945
  2946      ELSE
  2947         COMPUTE WK3 EQUAL
  2948
  2949          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  2950          (12 + WS-WORK-DIS-RATE) * 12) *
  2951
  2952          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  2953
  2954          ((WK8 ** N) /
  2955          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  2956
  2957          ((WK9 ** N) /
  2958          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  2959
  2960      COMPUTE WK3 EQUAL
  2961          (WK3 * CP-PREMIUM-RATE) / +1000.
  2962
  2963      MOVE WK3 TO CP-CALC-PREMIUM.
  2964
  2965     GO TO 99999-RETURN.
  2966
  2967 12000-CHECK-PA-TRUNC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  55
* ELRFND.cbl
  2968
  2969     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2970        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  2971        (CP-EARN-AS-NET-PAY) AND
  2972        (CP-TRUNCATED-LIFE)
  2973        NEXT SENTENCE
  2974     ELSE
  2975        GO TO 12000-CHECK-MD-TRUNC.
  2976
  2977     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  2978
  2979     COMPUTE ANGLEN-M EQUAL WK5 / I.
  2980     COMPUTE ANGLEN EQUAL WK1 / I.
  2981
  2982     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  2983
  2984     COMPUTE WK3 EQUAL
  2985        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  2986        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  2987
  2988     MOVE WK3 TO CP-CALC-PREMIUM.
  2989
  2990     GO TO 99999-RETURN.
  2991
  2992 12000-CHECK-MD-TRUNC.
  2993
  2994     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2995        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2996        (CP-EARN-AS-NET-PAY) AND
  2997        (CP-TRUNCATED-LIFE)
  2998        NEXT SENTENCE
  2999     ELSE
  3000        GO TO 12000-CHECK-MD.
  3001
  3002     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3003
  3004     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3005     COMPUTE ANGLEM EQUAL WK2 / I.
  3006     COMPUTE ANGLEN EQUAL WK1 / I.
  3007
  3008     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3009
  3010     COMPUTE WK3 EQUAL
  3011        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3012        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  3013        (ANGLEN-1 * (M - ANGLEM))).
  3014
  3015     MOVE WK3 TO CP-CALC-PREMIUM.
  3016
  3017     GO TO 99999-RETURN.
  3018
  3019 12000-CHECK-MD.
  3020
  3021     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3022        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3023        (CP-EARN-AS-NET-PAY)
  3024        NEXT SENTENCE
  3025     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  56
* ELRFND.cbl
  3026        GO TO 12000-CHECK-ME-TRUNC.
  3027
  3028     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3029
  3030     COMPUTE WK3 EQUAL
  3031        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  3032
  3033     MOVE WK3 TO CP-CALC-PREMIUM.
  3034
  3035     GO TO 99999-RETURN.
  3036
  3037 12000-CHECK-ME-TRUNC.
  3038
  3039     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3040        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3041        AND (CP-EARN-AS-NET-PAY)
  3042        AND (CP-TRUNCATED-LIFE)
  3043        CONTINUE
  3044     ELSE
  3045        GO TO 12000-CHECK-CID-WA-FARMPLAN
  3046     END-IF
  3047
  3048     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3049     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3050     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3051     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3052     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3053     COMPUTE ANGLEN-1 = ANGLEN / Y
  3054     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3055     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3056     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3057     COMPUTE WK3
  3058        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3059        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3060            * (1 / (1.0635 ** (M / 12))))
  3061*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  3062*    COMPUTE WK9 EQUAL
  3063*       1 / (1 + (.045 * (N - M) / 24))
  3064*    COMPUTE WK7 EQUAL
  3065*       WS-WORK-RATE * 20 / (M + 1).
  3066*    COMPUTE WK3 EQUAL
  3067*       ((( N - ANGLEN) * WK7 * WK8) /
  3068*       (10 * ANGLEN-1 * I)) -
  3069*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  3070*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  3071*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3072*
  3073     MOVE WK3 TO CP-CALC-PREMIUM.
  3074
  3075     GO TO 99999-RETURN
  3076      .
  3077 12000-CHECK-CID-WA-FARMPLAN.
  3078
  3079     IF (CP-COMPANY-ID EQUAL 'CID')
  3080        AND (CP-STATE-STD-ABBRV = 'WA')
  3081        AND (CP-FARM-PLAN)
  3082        CONTINUE
  3083     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  57
* ELRFND.cbl
  3084        GO TO 12000-CHECK-CID-FARMPLAN
  3085     END-IF
  3086
  3087     move cp-original-term       to n
  3088     move cp-no-of-pmts          TO C-TOT-PMTS
  3089     compute c-pmts-per-year = 12 / cp-pay-frequency
  3090     move cp-pay-frequency       to m
  3091     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  3092     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3093     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  3094
  3095     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  3096        (m * 30))) / (1 + I)
  3097     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3098        ** CP-PAY-FREQUENCY) - 1
  3099     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  3100     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3101        ** TI) / WS-WORK-DIS-RATE
  3102     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  3103     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  3104     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3105        ** m) / WS-WORK-DIS-RATE
  3106     COMPUTE WK2 = WK2 * (1 + J)
  3107     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3108     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3109     COMPUTE WK3 = WK3 * (1 + J)
  3110     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  3111        ** (c-tot-pmts - 1))) / J
  3112     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3113        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  3114        (CP-PREMIUM-RATE / 1000)
  3115     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  3116     COMPUTE WK6 = (WK7 * GR)
  3117
  3118     MOVE WK6 TO CP-CALC-PREMIUM
  3119
  3120     GO TO 99999-RETURN
  3121
  3122     .
  3123 12000-CHECK-CID-FARMPLAN.
  3124     IF (CP-COMPANY-ID EQUAL 'CID')
  3125        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  3126           OR 'IN' OR 'AZ')
  3127        AND (CP-FARM-PLAN)
  3128        CONTINUE
  3129     ELSE
  3130        GO TO 12000-CHECK-SC-CID
  3131     END-IF
  3132     COMPUTE N = M / CP-PAY-FREQUENCY
  3133     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3134     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3135        ** CP-PAY-FREQUENCY) - 1
  3136     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  3137     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3138        ** TI) / WS-WORK-DIS-RATE
  3139     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  3140     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  3141     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  58
* ELRFND.cbl
  3142        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  3143     COMPUTE WK2 = WK2 * (1 + J)
  3144     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3145     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3146     COMPUTE WK3 = WK3 * (1 + J)
  3147     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  3148        ** (N - 1))) / J
  3149     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3150        ((N * WK2) - WK5)) + (N * WK1)) *
  3151        (CP-PREMIUM-RATE / 1000)
  3152     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  3153     COMPUTE WK6 = (WK7 * GR)
  3154     MOVE WK6 TO CP-CALC-PREMIUM
  3155     GO TO 99999-RETURN
  3156     .
  3157 12000-CHECK-SC-CID.
  3158     IF (CP-COMPANY-ID EQUAL 'CID')
  3159        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  3160        AND (CP-EARN-AS-NET-PAY)
  3161        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  3162        CONTINUE
  3163     ELSE
  3164        GO TO 12000-CHECK-AL-CID
  3165     END-IF
  3166     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3167     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3168     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3169     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3170     COMPUTE ANGLEN-1 = ANGLEN / Y
  3171     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3172        / 12)) / ((M + 1) / 2)
  3173     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3174     COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3175        + 6 * M) * (WK2 / 100) * (1 + I)
  3176     MOVE WK3 TO CP-CALC-PREMIUM
  3177     GO TO 99999-RETURN
  3178     .
  3179 12000-CHECK-AL-CID.
  3180     IF (CP-COMPANY-ID EQUAL 'CID')
  3181        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  3182        AND (CP-EARN-AS-NET-PAY)
  3183        CONTINUE
  3184     ELSE
  3185        GO TO 12000-CHECK-NH-CID
  3186     END-IF
  3187     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3188     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3189     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3190     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3191                   / (1 + I)
  3192     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3193     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3194     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  3195        (CP-PREMIUM-RATE / 1000)
  3196     MOVE WK3 TO CP-CALC-PREMIUM
  3197     GO TO 99999-RETURN
  3198     .
  3199 12000-CHECK-NH-CID.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  59
* ELRFND.cbl
  3200     IF (CP-COMPANY-ID EQUAL 'CID')
  3201        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  3202        AND (CP-EARN-AS-NET-PAY)
  3203        CONTINUE
  3204     ELSE
  3205        GO TO 12000-CHECK-PA-CID
  3206     END-IF
  3207     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3208     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3209     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3210                   / (1 + I)
  3211     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3212     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3213     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3214        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  3215     MOVE WK3 TO CP-CALC-PREMIUM
  3216     GO TO 99999-RETURN
  3217     .
  3218 12000-CHECK-PA-CID.
  3219     IF (CP-COMPANY-ID EQUAL 'CID')
  3220        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  3221        AND (CP-EARN-AS-NET-PAY)
  3222        CONTINUE
  3223     ELSE
  3224        GO TO 12000-CHECK-ME-CID
  3225     END-IF
  3226
  3227     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3228     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3229     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3230     COMPUTE ANGLEN-1 = ANGLEN / Y
  3231     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  3232     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3233     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  3234     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3235        * WK5
  3236     MOVE WK3 TO CP-CALC-PREMIUM
  3237     GO TO 99999-RETURN
  3238     .
  3239 12000-CHECK-ME-CID.
  3240     IF (CP-COMPANY-ID EQUAL 'CID')
  3241        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3242        AND (CP-EARN-AS-NET-PAY)
  3243        CONTINUE
  3244     ELSE
  3245        GO TO 12000-CHECK-VT-TRUNC
  3246     END-IF
  3247     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3248     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3249     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3250     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3251     COMPUTE ANGLEN-1 = ANGLEN / Y
  3252     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3253     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3254     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3255        * WK5
  3256     MOVE WK3 TO CP-CALC-PREMIUM
  3257     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  60
* ELRFND.cbl
  3258     .
  3259 12000-CHECK-VT-TRUNC.
  3260
  3261     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3262        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  3263        (CP-EARN-AS-NET-PAY) AND
  3264        (CP-TRUNCATED-LIFE)
  3265        NEXT SENTENCE
  3266     ELSE
  3267        GO TO 12000-CHECK-VT.
  3268
  3269      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  3270
  3271      COMPUTE ANGLEN EQUAL WK1 / I.
  3272
  3273      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3274
  3275      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  3276      COMPUTE WK9 EQUAL
  3277        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  3278        ((.0054 - I) / (1 + I)).
  3279      COMPUTE WK7 EQUAL
  3280        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  3281      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3282        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  3283
  3284      MOVE WK3 TO CP-CALC-PREMIUM.
  3285
  3286     GO TO 99999-RETURN.
  3287
  3288 12000-CHECK-VT.
  3289
  3290     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3291        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  3292        (CP-EARN-AS-NET-PAY)
  3293        NEXT SENTENCE
  3294     ELSE
  3295        GO TO 12000-CHECK-MINN-WDS.
  3296
  3297      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  3298
  3299      COMPUTE ANGLEN EQUAL WK1 / I.
  3300
  3301      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3302
  3303      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  3304                        (ANGLEN-1 * I)) *
  3305
  3306                        (((1.0054 ** N - 1) /
  3307                        (1.0054 ** (N - 1) * .0054)) -
  3308
  3309                        ((V * (1 - 1.0054 ** N * VX)) /
  3310                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  3311
  3312      MOVE WK3 TO CP-CALC-PREMIUM.
  3313
  3314     GO TO 99999-RETURN.
  3315
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  61
* ELRFND.cbl
  3316 12000-CHECK-MINN-WDS.
  3317
  3318     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3319        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3320        (CP-EARN-AS-NET-PAY)
  3321        NEXT SENTENCE
  3322     ELSE
  3323        GO TO 12000-CHECK-MINN-BALL-LEV.
  3324
  3325     COMPUTE ANGLEN EQUAL WK1 / I.
  3326     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  3327              (N / +12) * (2 / (N + 1)).
  3328     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  3329         WK3 * ((N - ANGLEN) / I).
  3330
  3331      MOVE WK3 TO CP-CALC-PREMIUM.
  3332
  3333     GO TO 99999-RETURN.
  3334
  3335 12000-CHECK-MINN-BALL-LEV.
  3336
  3337     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3338        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3339        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  3340        (CP-EARN-AS-REG-BALLOON)
  3341        NEXT SENTENCE
  3342     ELSE
  3343        GO TO 12000-CHECK-MINN-BALL.
  3344
  3345     COMPUTE ANGLEN EQUAL WK1 / I.
  3346
  3347     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  3348
  3349     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  3350        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  3351
  3352     MOVE WK3 TO CP-CALC-PREMIUM.
  3353
  3354     GO TO 99999-RETURN.
  3355
  3356 12000-CHECK-MINN-BALL.
  3357
  3358     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3359        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3360        (CP-EARN-AS-REG-BALLOON)
  3361        NEXT SENTENCE
  3362     ELSE
  3363        GO TO 12000-CHECK-CID-MN-BALL.
  3364
  3365     COMPUTE ANGLEN EQUAL WK1 / I.
  3366     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  3367
  3368     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  3369     / +100 * (N - 1) / 12 * 2 / N *
  3370     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  3371
  3372      MOVE WK3 TO CP-CALC-PREMIUM.
  3373
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  62
* ELRFND.cbl
  3374     GO TO 99999-RETURN.
  3375
  3376 12000-CHECK-CID-MN-BALL.
  3377     IF (CP-COMPANY-ID EQUAL 'CID')
  3378        AND (CP-STATE-STD-ABBRV = 'MN')
  3379        AND (CP-CERT-EFF-DT > X'A4FF')
  3380        AND (CP-EARN-AS-REG-BALLOON)
  3381        CONTINUE
  3382     ELSE
  3383        GO TO 12000-CHECK-CID-MN-FARM
  3384     END-IF
  3385     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3386     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3387     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  3388     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3389     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3390     COMPUTE V = 1 / (1 + I)
  3391     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3392     COMPUTE Y = (1 + (D * I) / +30)
  3393        / (1 + I)
  3394     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  3395        * CP-PREMIUM-RATE / 1000
  3396*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  3397*       MOVE CP-MONTHLY-PAYMENT  TO GR
  3398*    ELSE
  3399*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  3400*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  3401*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  3402*       DISPLAY ' BALLOON TOP ' WK6
  3403*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  3404*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  3405*          / 100
  3406*       DISPLAY ' BALLOON BOTTOM ' WK7
  3407*       COMPUTE GR = WK6 / WK7
  3408*       DISPLAY ' BALLOON PAYMENT ' GR
  3409*    END-IF
  3410     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  3411     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  3412        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  3413     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  3414     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  3415        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  3416           (CP-ALTERNATE-BENEFIT * (M + 1)))
  3417           * CP-PREMIUM-RATE / 1000
  3418     MOVE WK3                    TO CP-CALC-PREMIUM
  3419     GO TO 99999-RETURN.
  3420     .
  3421 12000-CHECK-CID-MN-FARM.
  3422
  3423     IF (CP-COMPANY-ID EQUAL 'CID')
  3424        AND (CP-STATE-STD-ABBRV = 'MN')
  3425        AND (CP-CERT-EFF-DT > X'A4FF')
  3426        AND (CP-EARN-AS-FARM-PLAN)
  3427        CONTINUE
  3428     ELSE
  3429        GO TO 12000-CHECK-NC-WDS
  3430     END-IF
  3431
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  63
* ELRFND.cbl
  3432     EVALUATE CP-PMT-MODE
  3433        WHEN 'B'
  3434           MOVE +14              TO C-DAYS-IN-PMT-PER
  3435           MOVE +26              TO C-PMTS-PER-YEAR
  3436           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3437        WHEN 'S'
  3438           MOVE +15              TO C-DAYS-IN-PMT-PER
  3439           MOVE +24              TO C-PMTS-PER-YEAR
  3440           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3441        WHEN 'T'
  3442           MOVE +360             TO C-DAYS-IN-PMT-PER
  3443           MOVE +1               TO C-PMTS-PER-YEAR
  3444           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3445        WHEN 'W'
  3446           MOVE +7               TO C-DAYS-IN-PMT-PER
  3447           MOVE +52              TO C-PMTS-PER-YEAR
  3448           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3449        WHEN 'B'
  3450           MOVE +14              TO C-DAYS-IN-PMT-PER
  3451           MOVE +26              TO C-PMTS-PER-YEAR
  3452           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3453        WHEN OTHER
  3454           move cp-no-of-pmts    to c-tot-pmts
  3455           if cp-pay-frequency > zeros
  3456              compute c-pmts-per-year =
  3457                 12 / cp-pay-frequency
  3458              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  3459           else
  3460              MOVE +30           TO C-DAYS-IN-PMT-PER
  3461              MOVE +12           TO C-PMTS-PER-YEAR
  3462              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  3463           end-if
  3464     END-EVALUATE
  3465
  3466     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3467
  3468     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3469        C-DAYS-IN-PMT-PER)) / (1 + I)
  3470
  3471     compute cp-premium-rate =
  3472        cp-premium-rate * 12 / c-pmts-per-year
  3473     move c-tot-pmts to n m
  3474     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3475     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3476     COMPUTE ANGLEN-1 = ANGLEN / Y
  3477     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3478
  3479     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  3480        (cp-premium-rate / 100)
  3481
  3482
  3483     MOVE WK3                    TO CP-CALC-PREMIUM
  3484
  3485     GO TO 99999-RETURN.
  3486
  3487     .
  3488 12000-CHECK-NC-WDS.
  3489
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  64
* ELRFND.cbl
  3490     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3491        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3492        (CP-EARN-AS-NET-PAY)
  3493        NEXT SENTENCE
  3494     ELSE
  3495        GO TO 12000-CHECK-NC-BALL-LEV.
  3496
  3497     COMPUTE WK4 EQUAL N * (1 + I * 2).
  3498     COMPUTE ANGLEN EQUAL WK1 / I.
  3499     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  3500              CP-PREMIUM-RATE / +100 *
  3501              N / +12 * 2 / (N + 1) *
  3502              (WK4 - ANGLEN) / (I * ANGLEN).
  3503
  3504      MOVE WK3 TO CP-CALC-PREMIUM.
  3505
  3506     GO TO 99999-RETURN.
  3507
  3508 12000-CHECK-NC-BALL-LEV.
  3509
  3510     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3511        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3512        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  3513        (CP-EARN-AS-REG-BALLOON)
  3514        NEXT SENTENCE
  3515     ELSE
  3516        GO TO 12000-CHECK-NC-BALL.
  3517
  3518     COMPUTE ANGLEN EQUAL WK1 / I.
  3519
  3520**** VX = 1 / (1 + I)**N.
  3521
  3522     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  3523        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  3524
  3525     MOVE WK3 TO CP-CALC-PREMIUM.
  3526
  3527     GO TO 99999-RETURN.
  3528
  3529 12000-CHECK-NC-BALL.
  3530
  3531     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3532        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3533        (CP-EARN-AS-REG-BALLOON)
  3534        NEXT SENTENCE
  3535     ELSE
  3536        GO TO 12000-CHECK-MINN-TRUNC.
  3537
  3538     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  3539     COMPUTE ANGLEN EQUAL WK1 / I.
  3540     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  3541**** VX = 1 / (1 + I)**N.
  3542
  3543     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  3544     / +100 * (N - 1) / 12 * 2 / N *
  3545     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  3546
  3547      MOVE WK3 TO CP-CALC-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  65
* ELRFND.cbl
  3548
  3549     GO TO 99999-RETURN.
  3550
  3551 12000-CHECK-MINN-TRUNC.
  3552
  3553     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3554        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3555        (M GREATER THAN +63) AND
  3556        (CP-EARN-AS-NET-PAY) AND
  3557        (CP-TRUNCATED-LIFE)
  3558        NEXT SENTENCE
  3559     ELSE
  3560        GO TO 12000-CHECK-MINN.
  3561
  3562      COMPUTE ANGLEN EQUAL WK1 / I.
  3563      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3564
  3565      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3566
  3567      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3568       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3569       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  3570
  3571      MOVE WK3 TO CP-CALC-PREMIUM.
  3572
  3573     GO TO 99999-RETURN.
  3574
  3575 12000-CHECK-MINN.
  3576
  3577     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3578        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3579        (M GREATER THAN +63) AND
  3580        (CP-EARN-AS-NET-PAY)
  3581        NEXT SENTENCE
  3582     ELSE
  3583        GO TO 12000-CHECK-MONTANA-TRUNC.
  3584
  3585      COMPUTE ANGLEN EQUAL WK1 / I.
  3586
  3587      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3588
  3589      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3590       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3591       (((N - ANGLEN) / I) + (2 * N)).
  3592
  3593      MOVE WK3 TO CP-CALC-PREMIUM.
  3594
  3595     GO TO 99999-RETURN.
  3596
  3597 12000-CHECK-MONTANA-TRUNC.
  3598
  3599     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3600        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  3601        (M GREATER THAN +63) AND
  3602        (CP-EARN-AS-NET-PAY) AND
  3603        (CP-TRUNCATED-LIFE)
  3604        NEXT SENTENCE
  3605     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  66
* ELRFND.cbl
  3606        GO TO 12000-CHECK-MONTANA.
  3607
  3608      COMPUTE ANGLEN EQUAL WK1 / I.
  3609      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3610
  3611      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3612
  3613      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  3614      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3615       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  3616
  3617      MOVE WK3 TO CP-CALC-PREMIUM.
  3618
  3619     GO TO 99999-RETURN.
  3620
  3621 12000-CHECK-MONTANA.
  3622
  3623     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3624        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  3625        (M GREATER THAN +63) AND
  3626        (CP-EARN-AS-NET-PAY)
  3627        NEXT SENTENCE
  3628     ELSE
  3629        GO TO 12001-CONTINUE-NCL-TRUNC.
  3630
  3631      COMPUTE ANGLEN EQUAL WK1 / I.
  3632
  3633      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3634
  3635      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3636       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3637       (((N - ANGLEN) / I) + (4 * N)).
  3638
  3639      MOVE WK3 TO CP-CALC-PREMIUM.
  3640
  3641     GO TO 99999-RETURN.
  3642
  3643 12001-CONTINUE-NCL-TRUNC.
  3644
  3645     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3646        (CP-EARN-AS-NET-PAY) AND
  3647        (CP-TRUNCATED-LIFE)
  3648        NEXT SENTENCE
  3649     ELSE
  3650        GO TO 12001-CONTINUE-NCL.
  3651
  3652      COMPUTE ANGLEN EQUAL WK1 / I.
  3653      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3654
  3655      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3656
  3657      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  3658      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  3659      (ANGLEN-1 * (N + 1) * I).
  3660
  3661      MOVE WK3 TO CP-CALC-PREMIUM.
  3662
  3663     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  67
* ELRFND.cbl
  3664
  3665 12001-CONTINUE-NCL.
  3666
  3667     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3668        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3669        (CP-EARN-AS-NET-PAY)
  3670        GO TO 12001-CHECK-NC-NET-PLUS3.
  3671
  3672     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3673        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  3674        (CP-EARN-AS-NET-PAY)
  3675        GO TO 12001-CHECK-CA.
  3676
  3677     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3678        (CP-EARN-AS-NET-PAY)
  3679        NEXT SENTENCE
  3680     ELSE
  3681        GO TO 12000-CONTINUE-NET.
  3682
  3683      COMPUTE ANGLEN EQUAL WK1 / I.
  3684      MOVE ANGLEN                TO ANGLEN-1.
  3685
  3686      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3687
  3688      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3689       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3690       ((N - ANGLEN) / I).
  3691
  3692      MOVE WK3 TO CP-CALC-PREMIUM.
  3693
  3694     GO TO 99999-RETURN.
  3695
  3696 12000-CONTINUE-NET.
  3697
  3698     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  3699        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  3700        (CP-EARN-AS-NET-PAY)
  3701        NEXT SENTENCE
  3702     ELSE
  3703        GO TO 12001-CONTINUE-MINN.
  3704
  3705      COMPUTE ANGLEN EQUAL WK6 / I.
  3706      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  3707
  3708      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  3709      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  3710      COMPUTE WK3 EQUAL (WK3 / I) *
  3711       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  3712
  3713      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  3714         MOVE +0 TO CP-R-MAX-TOT-BEN.
  3715
  3716      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  3717
  3718      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  3719         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  3720         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  3721
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  68
* ELRFND.cbl
  3722      MOVE WK3 TO CP-CALC-PREMIUM.
  3723
  3724     GO TO 99999-RETURN.
  3725
  3726 12001-CONTINUE-MINN.
  3727
  3728     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3729        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  3730        (CP-TRUNCATED-LIFE)
  3731        NEXT SENTENCE
  3732     ELSE
  3733        GO TO 12001-CHECK-RI-GTL.
  3734
  3735      COMPUTE ANGLEN EQUAL WK1 / I.
  3736      COMPUTE ANGLEM EQUAL WK2 / I.
  3737
  3738      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  3739       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  3740       * M / 2400) * 1000 + .5) / 1000000.
  3741
  3742      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  3743       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  3744
  3745     GO TO 99999-RETURN.
  3746
  3747 12001-CHECK-RI-GTL.
  3748
  3749     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3750        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  3751        (CP-EARN-AS-NET-PAY)
  3752        NEXT SENTENCE
  3753     ELSE
  3754        GO TO 12001-CHECK-RI-LEASE-GTL.
  3755
  3756      COMPUTE ANGLEN EQUAL WK1 / I.
  3757*     COMPUTE ANGLEM EQUAL WK2 / I.
  3758
  3759      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  3760               (1 + WS-WORK-DIS-RATE * N).
  3761      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  3762         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  3763
  3764
  3765     GO TO 99999-RETURN.
  3766
  3767 12001-CHECK-RI-LEASE-GTL.
  3768
  3769     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3770        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  3771        (CP-SPECIAL-CALC-CD EQUAL 'H')
  3772        NEXT SENTENCE
  3773     ELSE
  3774        GO TO 12001-CHECK-OR-GTL.
  3775
  3776     COMPUTE ANGLEN EQUAL WK1 / I.
  3777
  3778     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  3779        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  69
* ELRFND.cbl
  3780                        /
  3781        (1000 * I * (1 + .0021 * N)).
  3782     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  3783       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  3784                            /
  3785       (1000 * (1 + .0027 * (N + 1))).
  3786
  3787     GO TO 99999-RETURN.
  3788
  3789 12001-CHECK-OR-GTL.
  3790
  3791     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3792        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  3793        (CP-EARN-AS-NET-PAY)
  3794        NEXT SENTENCE
  3795     ELSE
  3796        GO TO 12001-CHECK-GA-GTL.
  3797
  3798     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3799     COMPUTE ANGLEN EQUAL WK1 / I.
  3800
  3801     IF M LESS THAN +64
  3802        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  3803         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  3804                   /
  3805         (I * ANGLEN * (N - (N - M) + 1) * 600)
  3806        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  3807     ELSE
  3808        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  3809        CP-PREMIUM-RATE * (1 + I))
  3810                  /
  3811        (+1000 * I * ANGLEN)
  3812        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3813*    MOVE WK3 TO CP-CALC-PREMIUM.
  3814     GO TO 99999-RETURN.
  3815
  3816 12001-CHECK-GA-GTL.
  3817
  3818     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3819        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  3820        (CP-EARN-AS-NET-PAY)
  3821*       (CP-TRUNCATED-LIFE)
  3822        NEXT SENTENCE
  3823     ELSE
  3824        GO TO 12001-CHECK-MA-GTL.
  3825
  3826     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3827     COMPUTE ANGLEN EQUAL WK1 / I.
  3828
  3829     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  3830     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  3831      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  3832     MOVE WK3 TO CP-CALC-PREMIUM.
  3833
  3834     GO TO 99999-RETURN.
  3835
  3836 12001-CHECK-MA-GTL.
  3837
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  70
* ELRFND.cbl
  3838     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3839        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  3840        (CP-EARN-AS-NET-PAY) AND
  3841        (CP-SPECIAL-CALC-CD EQUAL 'H')
  3842        NEXT SENTENCE
  3843     ELSE
  3844        GO TO 12001-CHECK-NV-NET.
  3845
  3846     COMPUTE ANGLEN EQUAL WK1 / I.
  3847
  3848     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  3849      CP-ALTERNATE-BENEFIT * N.
  3850
  3851     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  3852     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  3853
  3854     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  3855     WK7 * (N - ANGLEN) / I.
  3856     MOVE WK3 TO CP-CALC-PREMIUM.
  3857
  3858     GO TO 99999-RETURN.
  3859
  3860 12001-CHECK-NV-NET.
  3861     IF (CP-COMPANY-ID EQUAL 'CID')
  3862        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  3863        AND (CP-EARN-AS-NET-PAY)
  3864        CONTINUE
  3865     ELSE
  3866        GO TO 12001-CHECK-MN-NET
  3867     END-IF
  3868     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3869     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3870     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3871                   / (1 + I)
  3872     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3873     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3874     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3875        (CP-PREMIUM-RATE * K-I / 1000)
  3876     MOVE WK3                    TO CP-CALC-PREMIUM
  3877     GO TO 99999-RETURN
  3878      .
  3879 12001-CHECK-MN-NET.
  3880     IF (CP-COMPANY-ID EQUAL 'CID')
  3881        AND (CP-STATE-STD-ABBRV = 'MN')
  3882        AND (CP-EARN-AS-NET-PAY)
  3883        AND (NOT CP-LEVEL-LIFE)
  3884        AND (WS-DISCOUNT-OPTION = '1')
  3885        CONTINUE
  3886     ELSE
  3887        GO TO 12001-CHECK-NC-NET
  3888     END-IF
  3889     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3890     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3891     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3892                   / (1 + I)
  3893     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3894     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3895     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  71
* ELRFND.cbl
  3896        (CP-PREMIUM-RATE / 1000) * (1 + I)
  3897     MOVE WK3                    TO CP-CALC-PREMIUM
  3898     GO TO 99999-RETURN
  3899      .
  3900 12001-CHECK-NC-NET.
  3901
  3902     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  3903        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3904        (CP-EARN-AS-NET-PAY)
  3905        NEXT SENTENCE
  3906     ELSE
  3907        GO TO 12001-CHECK-NC-NET-PLUS3.
  3908
  3909      COMPUTE ANGLEN EQUAL WK1 / I.
  3910      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3911
  3912      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  3913          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  3914          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  3915          N * (CP-PREMIUM-RATE / 1000)).
  3916
  3917      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  3918          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  3919
  3920      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  3921          ((N - ANGLEN) / I + 3) / ANGLEN) /
  3922          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  3923          (ANGLEN * 2))
  3924
  3925      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  3926
  3927      IF ANGLEN IS NOT LESS THAN WK7
  3928          COMPUTE CP-PREMIUM-RATE ROUNDED =
  3929              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  3930          COMPUTE WK3 ROUNDED =
  3931              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  3932
  3933     MOVE WK3 TO CP-CALC-PREMIUM.
  3934
  3935     GO TO 99999-RETURN.
  3936
  3937 12001-CHECK-NC-NET-PLUS3.
  3938
  3939     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3940        (CP-EARN-AS-NET-PAY) AND
  3941        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL')
  3942        NEXT SENTENCE
  3943     ELSE
  3944        GO TO 12001-CHECK-CA.
  3945
  3946     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3947     MOVE ' ' TO DC-OPTION-CODE.
  3948     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3949
  3950     IF DATE-CONVERSION-ERROR
  3951        MOVE '2'                 TO CP-RETURN-CODE
  3952        MOVE ZEROS               TO FACTOR
  3953                                    CP-CALC-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  72
* ELRFND.cbl
  3954         GO TO 99999-RETURN.
  3955
  3956     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  3957        NEXT SENTENCE
  3958     ELSE
  3959        GO TO 12001-CONTINUE-NET.
  3960
  3961     COMPUTE ANGLEN EQUAL WK1 / I.
  3962     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3963
  3964     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  3965
  3966     COMPUTE NC-R = 20 *
  3967                    ((NC-LR * ORIGINAL-TERM) / 12)
  3968                          / (ORIGINAL-TERM + 1).
  3969
  3970     COMPUTE NC-OB = NC-R / 1000.
  3971
  3972     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  3973                    (NC-OB * ORIGINAL-TERM * 3).
  3974
  3975     IF CP-EXT-CHG-LF
  3976         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  3977     ELSE
  3978         MOVE 30                 TO  NC-BIG-D.
  3979
  3980     COMPUTE NC-LITTLE-D = (1 + I) /
  3981             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  3982
  3983     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  3984             (ANGLEN * NC-LITTLE-D ).
  3985
  3986     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  3987
  3988     GO TO 99999-RETURN.
  3989
  3990 12001-CHECK-CA.
  3991
  3992     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  3993        (WS-DISCOUNT-OPTION = '6')
  3994        NEXT SENTENCE
  3995     ELSE
  3996        GO TO 12001-CHECK-GTL-IA.
  3997
  3998     COMPUTE CA-J = CA-DISCOUNT / 12.
  3999     COMPUTE ANGLEN EQUAL WK1 / I.
  4000     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  4001     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  4002     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  4003     COMPUTE CA-VI = (1 + I)** -1.
  4004     COMPUTE CP-CALC-PREMIUM =
  4005         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  4006         ((1 + CA-J) / I) *
  4007         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  4008         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  4009         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  4010
  4011     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  73
* ELRFND.cbl
  4012
  4013 12001-CHECK-GTL-IA.
  4014
  4015     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  4016        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  4017        (CP-EARN-AS-NET-PAY)
  4018        NEXT SENTENCE
  4019     ELSE
  4020        GO TO 12001-CHECK-CID-TRN-VA.
  4021
  4022***************************************************************
  4023
  4024     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  4025
  4026     IF GTL-IA-ODD-DAYS = ZEROS
  4027         MOVE ZERO               TO  GTL-IA-SGN
  4028     ELSE
  4029         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  4030             MOVE +1             TO  GTL-IA-SGN
  4031         ELSE
  4032             MOVE -1             TO  GTL-IA-SGN.
  4033
  4034     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  4035     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  4036
  4037     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  4038                          GTL-IA-SGN.
  4039
  4040     COMPUTE ANGLEN EQUAL WK1 / I.
  4041     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4042
  4043     IF GTL-IA-ODF NOT = ZERO
  4044         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  4045         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  4046
  4047     COMPUTE GTL-IA-DIVIDEND =
  4048           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  4049                             (ANGLEN - ANGLEN-M))) *
  4050           ((K1 + I) * CP-PREMIUM-RATE *
  4051                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  4052
  4053     COMPUTE GTL-IA-DIVISOR =
  4054      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  4055
  4056     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  4057
  4058     COMPUTE CP-CALC-PREMIUM =
  4059                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  4060     GO TO 99999-RETURN.
  4061
  4062
  4063 12001-CHECK-CID-TRN-VA.
  4064
  4065     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4066        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  4067        (CP-EARN-AS-NET-PAY) AND
  4068        (CP-TRUNCATED-LIFE) AND
  4069        (CP-STATE-STD-ABBRV = CP-STATE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  74
* ELRFND.cbl
  4070        CONTINUE
  4071     ELSE
  4072        GO TO 12001-CHECK-CID-TX
  4073     END-IF
  4074
  4075     COMPUTE ANGLEN EQUAL WK1 / I
  4076     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4077     IF WS-WORK-DIS-RATE = ZEROS
  4078        CONTINUE
  4079     ELSE
  4080        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4081        COMPUTE WK7 = (1 / I) *
  4082              (((WK4 ** M - 1) / (WK4 - 1)) -
  4083              ((WK4 ** M * SX - VX) /
  4084              (WK4 * (1 + I) - 1))) *
  4085              (CP-PREMIUM-RATE / 1000)
  4086        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4087        COMPUTE WK8 = WK7 * 100 / ANGLEN
  4088        COMPUTE CP-CALC-PREMIUM =
  4089           WK8 *  ((WK4 * ANGLEN) / 100)
  4090     END-IF
  4091
  4092     GO TO 99999-RETURN
  4093
  4094     .
  4095
  4096 12001-CHECK-CID-TX.
  4097     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4098        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  4099        (CP-EARN-AS-NET-PAY) AND
  4100        (WS-WORK-DIS-RATE > ZEROS) AND
  4101        (CP-STATE-STD-ABBRV = CP-STATE)
  4102        CONTINUE
  4103     ELSE
  4104        GO TO 12001-CHECK-CID-LEV-MN-NEW
  4105     END-IF
  4106* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  4107     COMPUTE K-I = 1 + (1 * I)
  4108     COMPUTE ANGLEN EQUAL WK1 / I
  4109     COMPUTE ANGLEM EQUAL WK2 / I
  4110     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4111     IF WS-WORK-DIS-RATE = ZEROS
  4112        CONTINUE
  4113     ELSE
  4114        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4115        COMPUTE WK7 = (K-I / I) *
  4116              (((WK4 ** M - 1) / (WK4 - 1)) -
  4117*             ((WK4 ** M * SX - VX) /
  4118              ((WK4 ** M * SX) - VX) /
  4119*             (WK4 * (1 + I) - 1))) *
  4120              (WK4 * (1 + I) - 1)) *
  4121              (CP-PREMIUM-RATE / 1000)
  4122        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4123        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  4124        COMPUTE CP-CALC-PREMIUM =
  4125           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  4126     END-IF
  4127
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  75
* ELRFND.cbl
  4128     GO TO 99999-RETURN
  4129     .
  4130 12001-CHECK-CID-LEV-MN-NEW.
  4131*    IF (CP-COMPANY-ID EQUAL 'CID')
  4132*       AND (CP-STATE-STD-ABBRV = 'MN')
  4133*       AND (CP-EARN-AS-NET-PAY)
  4134*       AND (CP-LEVEL-LIFE)
  4135*       AND (CP-CERT-EFF-DT > X'A4FF')
  4136*       CONTINUE
  4137*    ELSE
  4138*       GO TO 12001-CHECK-CID-LEV-MN
  4139*    END-IF
  4140*
  4141*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4142*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4143*    MOVE '1'                    TO DC-OPTION-CODE
  4144*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  4145*
  4146*    IF DATE-CONVERSION-ERROR
  4147*       MOVE '2'                 TO CP-RETURN-CODE
  4148*       MOVE ZEROS               TO FACTOR
  4149*                                   CP-CALC-PREMIUM
  4150*       GO TO 99999-RETURN
  4151*    END-IF
  4152*
  4153*    COMPUTE I = CP-LOAN-APR / 100
  4154*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4155*
  4156*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4157*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4158*      * 12 / 360 * D)
  4159*
  4160*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4161*       * 12 / 360 * D
  4162*
  4163*    GO TO 99999-RETURN
  4164      .
  4165 12001-CHECK-CID-LEV-MN.
  4166
  4167     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4168        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4169        (CP-EARN-AS-NET-PAY) AND
  4170        (CP-LEVEL-LIFE) AND
  4171        (CP-STATE-STD-ABBRV = CP-STATE)
  4172        CONTINUE
  4173     ELSE
  4174        GO TO 12001-CHECK-CID-LEV-CA
  4175     END-IF
  4176
  4177     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4178         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4179         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4180
  4181     GO TO 99999-RETURN
  4182
  4183      .
  4184 12001-CHECK-CID-LEV-CA.
  4185
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  76
* ELRFND.cbl
  4186     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4187        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4188        (CP-EARN-AS-NET-PAY) AND
  4189        (CP-LEVEL-LIFE) AND
  4190        (CP-STATE-STD-ABBRV = CP-STATE)
  4191        CONTINUE
  4192     ELSE
  4193        GO TO 12001-CHECK-CID-TRN-CA
  4194     END-IF
  4195
  4196     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4197     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4198     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4199     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4200     COMPUTE CP-CALC-PREMIUM =
  4201          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4202          (CP-PREMIUM-RATE / 1000)) /
  4203          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4204
  4205     GO TO 99999-RETURN
  4206
  4207      .
  4208 12001-CHECK-CID-TRN-CA.
  4209
  4210     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4211        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4212        (CP-EARN-AS-NET-PAY) AND
  4213        (CP-TRUNCATED-LIFE) AND
  4214        (CP-STATE-STD-ABBRV = CP-STATE) AND
  4215        (WS-DISCOUNT-OPTION NOT = ' ')
  4216        CONTINUE
  4217     ELSE
  4218        GO TO 12001-CHECK-CID-TRN-MT
  4219     END-IF
  4220
  4221     COMPUTE ANGLEN EQUAL WK1 / I
  4222     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4223     IF WS-WORK-DIS-RATE = ZEROS
  4224        CONTINUE
  4225     ELSE
  4226        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4227        COMPUTE WK7 = (1 / I) *
  4228              (((WK4 ** M - 1) / (WK4 - 1)) -
  4229              ((WK4 ** M * SX - VX) /
  4230              (WK4 * (1 + I) - 1))) *
  4231              (CP-PREMIUM-RATE / 1000)
  4232        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4233        COMPUTE CP-CALC-PREMIUM =
  4234           WK4 *  WK7
  4235     END-IF
  4236
  4237     GO TO 99999-RETURN
  4238
  4239      .
  4240 12001-CHECK-CID-TRN-MT.
  4241
  4242     IF (CP-COMPANY-ID EQUAL 'CID') AND
  4243        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  77
* ELRFND.cbl
  4244                   OR
  4245        ((CP-STATE-STD-ABBRV = 'IN') AND
  4246        (CP-CERT-EFF-DT > X'9A7F'))
  4247                   OR
  4248        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4249        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4250        (CP-EARN-AS-NET-PAY) AND
  4251        (CP-TRUNCATED-LIFE) AND
  4252        (CP-STATE-STD-ABBRV = CP-STATE)
  4253        CONTINUE
  4254     ELSE
  4255        GO TO 12001-CHECK-CID-MT
  4256     END-IF
  4257
  4258* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4259     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4260        MOVE 0                   TO K-I
  4261     ELSE
  4262        MOVE 2                   TO K-I
  4263     END-IF
  4264     COMPUTE CP-TERM-OR-EXT-DAYS =
  4265           CP-TERM-OR-EXT-DAYS + 30
  4266
  4267     COMPUTE ANGLEN EQUAL WK1 / I
  4268     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4269     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4270                   / (1 + I)
  4271     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4272     IF WS-WORK-DIS-RATE = ZEROS
  4273        CONTINUE
  4274     ELSE
  4275        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4276*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4277        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4278              (((WK4 ** M - 1) / (WK4 - 1)) -
  4279              ((WK4 ** M * SX - VX) /
  4280              (WK4 * (1 + I) - 1))) *
  4281              (CP-PREMIUM-RATE / 1000)
  4282        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4283*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4284        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4285        COMPUTE CP-CALC-PREMIUM =
  4286           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4287*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4288     END-IF
  4289
  4290     GO TO 99999-RETURN
  4291
  4292     .
  4293 12001-CHECK-CID-MT.
  4294
  4295     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4296        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  4297                                OR 'VT')
  4298                   OR
  4299        ((CP-STATE-STD-ABBRV = 'IN') AND
  4300        (CP-CERT-EFF-DT > X'9A7F'))
  4301                   OR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  78
* ELRFND.cbl
  4302        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4303        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4304        (CP-EARN-AS-NET-PAY) AND
  4305        (CP-STATE-STD-ABBRV = CP-STATE)
  4306        CONTINUE
  4307     ELSE
  4308        GO TO 12001-CHECK-DCC-DD
  4309     END-IF
  4310
  4311     COMPUTE CP-TERM-OR-EXT-DAYS =
  4312           CP-TERM-OR-EXT-DAYS + 30
  4313
  4314* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4315     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4316        MOVE 0                   TO K-I
  4317     ELSE
  4318        IF CP-STATE-STD-ABBRV = 'NJ'
  4319           MOVE 1                TO K-I
  4320        ELSE
  4321           MOVE 2                TO K-I
  4322        END-IF
  4323     END-IF
  4324     COMPUTE ANGLEN EQUAL WK1 / I
  4325     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4326     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4327                   / (1 + I)
  4328     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4329     IF WS-WORK-DIS-RATE = ZEROS
  4330        CONTINUE
  4331     ELSE
  4332        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4333*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4334        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4335              (((WK4 ** N - 1) / (WK4 - 1)) -
  4336              ((WK4 ** N - SV) /
  4337              (WK4 * (1 + I) - 1))) *
  4338              (CP-PREMIUM-RATE / 1000)
  4339        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4340*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4341        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4342        COMPUTE CP-CALC-PREMIUM =
  4343           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4344*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4345     END-IF
  4346
  4347     GO TO 99999-RETURN
  4348
  4349     .
  4350 12001-CHECK-DCC-DD.
  4351     IF (CP-COMPANY-ID EQUAL 'DCC')
  4352        AND (CP-EARN-AS-NET-PAY)
  4353        AND (CP-BEN-CATEGORY = 'D')
  4354        CONTINUE
  4355     ELSE
  4356        GO TO 12001-CHECK-DCC-NET
  4357     END-IF
  4358
  4359     COMPUTE CP-TERM-OR-EXT-DAYS =
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  79
* ELRFND.cbl
  4360           CP-TERM-OR-EXT-DAYS + 30
  4361
  4362     COMPUTE ANGLEN EQUAL WK1 / I.
  4363     COMPUTE ANGLEM EQUAL WK2 / I.
  4364     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4365
  4366     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4367           / (1 + I)
  4368     COMPUTE GR     = ANGLEN / ODF
  4369*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  4370*      CP-RATE-DEV-PCT
  4371     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4372     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4373       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  4374     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4375     MOVE WK3                    TO CP-CALC-PREMIUM
  4376
  4377     GO TO 99999-RETURN
  4378
  4379     .
  4380 12001-CHECK-DCC-NET.
  4381
  4382     IF (CP-COMPANY-ID EQUAL 'DCC')
  4383        AND (CP-EARN-AS-NET-PAY)
  4384        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  4385             AND 'H' AND 'S' AND 'P')
  4386        CONTINUE
  4387     ELSE
  4388        GO TO 12001-CHECK-DCC-PNET
  4389     END-IF
  4390
  4391     COMPUTE CP-TERM-OR-EXT-DAYS =
  4392           CP-TERM-OR-EXT-DAYS + 30
  4393
  4394     COMPUTE ANGLEN EQUAL WK1 / I.
  4395     COMPUTE ANGLEM EQUAL WK2 / I.
  4396     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4397
  4398     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4399           / (1 + I)
  4400     COMPUTE GR     = ANGLEN / ODF
  4401     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  4402     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  4403       CP-RATE-DEV-PCT
  4404     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  4405*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  4406
  4407     COMPUTE WK8 = CP-PREMIUM-RATE *
  4408        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  4409     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  4410     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4411     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4412       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  4413     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4414     MOVE WK3                    TO CP-CALC-PREMIUM
  4415
  4416     GO TO 99999-RETURN
  4417
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  80
* ELRFND.cbl
  4418     .
  4419 12001-CHECK-DCC-PNET.
  4420     IF (CP-COMPANY-ID EQUAL 'DCC')
  4421        AND (CP-EARN-AS-NET-PAY)
  4422        AND (CP-BENEFIT-CD (1:1) = 'P')
  4423        CONTINUE
  4424     ELSE
  4425        GO TO 12001-CHECK-DCC-MNET
  4426     END-IF
  4427     IF CP-NO-OF-PMTS NOT NUMERIC
  4428        MOVE +0                  TO CP-NO-OF-PMTS
  4429     END-IF
  4430     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  4431        AND ' ' AND 'M'
  4432        MOVE ' '                 TO CP-PMT-MODE
  4433     END-IF
  4434******************************************************************
  4435***   Default is monthly, use loan term for rate and amort     ***
  4436******************************************************************
  4437     move cp-loan-term         to c-tot-pmts
  4438     MOVE +30                  TO C-DAYS-IN-PMT-PER
  4439     MOVE +12                  TO C-PMTS-PER-YEAR
  4440******************************************************************
  4441
  4442     evaluate true
  4443        when cp-pmt-mode = 'W'
  4444           MOVE +52              TO C-PMTS-PER-YEAR
  4445           compute c-tot-pmts = cp-loan-term /
  4446              12 * c-pmts-per-year
  4447           MOVE +7               TO C-DAYS-IN-PMT-PER
  4448        when cp-pmt-mode = 'B'
  4449           MOVE +26              TO C-PMTS-PER-YEAR
  4450           compute c-tot-pmts = cp-loan-term /
  4451              12 * c-pmts-per-year
  4452           MOVE +14              TO C-DAYS-IN-PMT-PER
  4453     end-evaluate
  4454     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4455     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4456        C-DAYS-IN-PMT-PER)) / (1 + I)
  4457     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  4458*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  4459     COMPUTE ANGLEN-1 = ANGLEN / Y
  4460     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4461     IF CP-RATE-DEV-PCT NOT = ZEROS
  4462        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4463           CP-PREMIUM-RATE
  4464     END-IF
  4465     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  4466     GO TO 99999-RETURN
  4467     .
  4468 12001-CHECK-DCC-MNET.
  4469
  4470     IF (CP-COMPANY-ID EQUAL 'DCC')
  4471        AND (CP-EARN-AS-NET-PAY)
  4472        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  4473        CONTINUE
  4474     ELSE
  4475        GO TO 12001-CHECK-DCC-MNET-LF-BAL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  81
* ELRFND.cbl
  4476     END-IF
  4477
  4478*    COMPUTE ANGLEN EQUAL WK1 / I.
  4479*    COMPUTE ANGLEM EQUAL WK2 / I.
  4480*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  4481
  4482     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  4483     MOVE WK3                    TO CP-CALC-PREMIUM
  4484
  4485     GO TO 99999-RETURN
  4486
  4487     .
  4488 12001-CHECK-DCC-MNET-LF-BAL.
  4489
  4490     IF (CP-COMPANY-ID EQUAL 'DCC')
  4491        AND (CP-EARN-AS-NET-PAY)
  4492        AND (CP-BENEFIT-CD (1:1) = 'N')
  4493        AND (CP-BEN-CATEGORY NOT = 'N')
  4494        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4495        CONTINUE
  4496     ELSE
  4497        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  4498     END-IF
  4499
  4500     IF CP-RATE-DEV-PCT NOT = ZEROS
  4501        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4502           CP-PREMIUM-RATE
  4503     END-IF
  4504*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4505     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4506        / (1 + I)
  4507     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4508     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4509     COMPUTE WK2 = (1 + J) ** (M * -1)
  4510     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4511     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4512          ** ((M - 1) * -1))) / J)
  4513     COMPUTE ANGLEM = ((1 - ((1 + J)
  4514          ** (M * -1))) / J) / OD
  4515     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4516        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  4517        / ANGLEM-1
  4518     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4519          ** ((N - M) * -1))) / I)
  4520     MOVE +0                     TO WK3
  4521     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4522        (WS-COUNTER > M)
  4523        COMPUTE ANGLEM = (1 - ((1 + J)
  4524          ** ((M - WS-COUNTER) * -1))) / J
  4525        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4526        COMPUTE WK5-CSL = (RA * ANGLEM)
  4527        + (CP-ALTERNATE-BENEFIT * WK2)
  4528        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4529     END-PERFORM
  4530     MOVE WK3                    TO CP-CALC-PREMIUM
  4531
  4532     GO TO 99999-RETURN
  4533
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  82
* ELRFND.cbl
  4534     .
  4535 12001-CHECK-DCC-MNET-LFSUM-BAL.
  4536
  4537     IF (CP-COMPANY-ID EQUAL 'DCC')
  4538        AND (CP-EARN-AS-NET-PAY)
  4539        AND (CP-BENEFIT-CD (1:1) = 'S')
  4540        AND (CP-BEN-CATEGORY NOT = 'N')
  4541        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4542        CONTINUE
  4543     ELSE
  4544        GO TO 12001-CHECK-DCC-MNET-LF
  4545     END-IF
  4546
  4547     IF CP-RATE-DEV-PCT NOT = ZEROS
  4548        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4549           CP-PREMIUM-RATE
  4550     END-IF
  4551     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4552     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4553          ** ((M - 1) * -1))) / K)
  4554     COMPUTE ANGLEM = ((1 - ((1 + K)
  4555          ** (M * -1))) / K)
  4556     MOVE CP-MONTHLY-PAYMENT     TO RA
  4557     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4558        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  4559        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4560        CP-PREMIUM-RATE / 1000
  4561     MOVE WK3                    TO CP-CALC-PREMIUM
  4562
  4563     GO TO 99999-RETURN
  4564
  4565     .
  4566 12001-CHECK-DCC-MNET-LF.
  4567
  4568     IF (CP-COMPANY-ID EQUAL 'DCC')
  4569        AND (CP-EARN-AS-NET-PAY)
  4570        AND (CP-BENEFIT-CD (1:1) = 'N')
  4571        AND (CP-BEN-CATEGORY NOT = 'N')
  4572        CONTINUE
  4573     ELSE
  4574        GO TO 12001-CHECK-DCC-MNET-SUMLF
  4575     END-IF
  4576
  4577     IF CP-RATE-DEV-PCT NOT = ZEROS
  4578        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4579           CP-PREMIUM-RATE
  4580     END-IF
  4581*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4582     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4583        / (1 + I)
  4584     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4585     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4586     COMPUTE WK2 = (1 + J) ** (M * -1)
  4587     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4588     COMPUTE ANGLEM = ((1 - ((1 + J)
  4589          ** (M * -1))) / J) / OD
  4590     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4591     COMPUTE ANGLEN-M = ((1 - ((1 + I)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  83
* ELRFND.cbl
  4592          ** ((N - M) * -1))) / I)
  4593     MOVE +0                     TO WK3
  4594     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4595        (WS-COUNTER > M)
  4596        COMPUTE ANGLEM = (1 - ((1 + J)
  4597          ** ((M - WS-COUNTER + 1) * -1))) / J
  4598        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4599        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4600        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4601     END-PERFORM
  4602     MOVE WK3                    TO CP-CALC-PREMIUM
  4603
  4604     GO TO 99999-RETURN
  4605
  4606     .
  4607 12001-CHECK-DCC-MNET-SUMLF.
  4608
  4609     IF (CP-COMPANY-ID EQUAL 'DCC')
  4610        AND (CP-EARN-AS-NET-PAY)
  4611        AND (CP-BENEFIT-CD (1:1) = 'S')
  4612        AND (CP-BEN-CATEGORY NOT = 'N')
  4613        CONTINUE
  4614     ELSE
  4615        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  4616     END-IF
  4617
  4618     IF CP-RATE-DEV-PCT NOT = ZEROS
  4619        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4620           CP-PREMIUM-RATE
  4621     END-IF
  4622     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4623     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4624        / (1 + K)
  4625     COMPUTE ANGLEN-M = (WK5 / I)
  4626     COMPUTE WK2 = (1 + K) ** (M * -1)
  4627     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4628     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4629     COMPUTE ANGLEM = ((1 - ((1 + K)
  4630          ** (M * -1))) / K) / Y
  4631     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4632     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  4633        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4634        - 1)) / K) * RA
  4635     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4636        + (CP-DAYS-TO-1ST-PMT - +30)
  4637        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4638        +0 / 1000 * 12 / 12)
  4639     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  4640        * (12 / 12)
  4641     MOVE WK3                    TO CP-CALC-PREMIUM
  4642
  4643     GO TO 99999-RETURN
  4644
  4645     .
  4646 12001-CHECK-DCC-MNET-TOT-BAL-N.
  4647
  4648     IF (CP-COMPANY-ID EQUAL 'DCC')
  4649        AND (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  84
* ELRFND.cbl
  4650        AND (CP-BENEFIT-CD (1:1) = 'N')
  4651        AND (CP-BEN-CATEGORY = 'N')
  4652        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4653        CONTINUE
  4654     ELSE
  4655        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  4656     END-IF
  4657
  4658*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4659     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4660        / (1 + I)
  4661     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4662     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  4663     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4664     COMPUTE WK2 = (1 + J) ** (M * -1)
  4665     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4666     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4667          ** ((M - 1) * -1))) / J)
  4668     COMPUTE ANGLEM = ((1 - ((1 + J)
  4669          ** (M * -1))) / J) / OD
  4670     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4671        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  4672        / ANGLEM-1
  4673     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4674          ** ((N - M) * -1))) / I)
  4675     MOVE +0                     TO WK3
  4676     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4677        (WS-COUNTER > M)
  4678        COMPUTE ANGLEM = (1 - ((1 + J)
  4679          ** ((M - WS-COUNTER) * -1))) / J
  4680        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  4681        COMPUTE WK5-CSL = (RA * ANGLEM)
  4682        + (CP-ALTERNATE-BENEFIT * WK2)
  4683        COMPUTE WK3 = WK3 +
  4684         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  4685        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  4686          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  4687          (CP-DCC-AH-RATE / 1000)
  4688     END-PERFORM
  4689     MOVE WK3                    TO CP-CALC-PREMIUM
  4690
  4691     GO TO 99999-RETURN
  4692
  4693     .
  4694 12001-CHECK-DCC-MNET-TOT-BAL-S.
  4695
  4696     IF (CP-COMPANY-ID EQUAL 'DCC')
  4697        AND (CP-EARN-AS-NET-PAY)
  4698        AND (CP-BENEFIT-CD (1:1) = 'S')
  4699        AND (CP-BEN-CATEGORY = 'N')
  4700        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4701        CONTINUE
  4702     ELSE
  4703        GO TO 12001-CHECK-DCC-MNET-TOT-N
  4704     END-IF
  4705
  4706     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4707     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  85
* ELRFND.cbl
  4708          ** ((M - 1) * -1))) / K)
  4709     COMPUTE ANGLEM = ((1 - ((1 + K)
  4710          ** (M * -1))) / K)
  4711     MOVE CP-MONTHLY-PAYMENT     TO RA
  4712     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4713        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  4714        * CP-DCC-AH-RATE / 1000))
  4715        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4716        CP-DCC-LF-RATE / 1000
  4717     MOVE WK3                    TO CP-LF-PREM
  4718     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  4719        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  4720        * CP-DCC-AH-RATE / 1000
  4721     COMPUTE WK3 = WK3 + WK5-CSL
  4722     MOVE WK3                    TO CP-CALC-PREMIUM
  4723
  4724     GO TO 99999-RETURN
  4725      .
  4726 12001-CHECK-DCC-MNET-TOT-N.
  4727
  4728     IF (CP-COMPANY-ID EQUAL 'DCC')
  4729        AND (CP-EARN-AS-NET-PAY)
  4730        AND (CP-BENEFIT-CD (1:1) = 'N')
  4731        AND (CP-BEN-CATEGORY = 'N')
  4732        CONTINUE
  4733     ELSE
  4734        GO TO 12001-CHECK-DCC-MNET-TOT-S
  4735     END-IF
  4736
  4737*    I = APR/1200
  4738*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  4739*    RA = PAYMENT AMOUNT
  4740*    WK5-CSL = THE BALANCE (PAY OFF )
  4741*    WK3 = THE ACCUMULATED PREMIUM
  4742*    WK2 = (1 + I) ^ (m * -1)
  4743*    OD  = GAMMA
  4744*
  4745*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4746     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4747        / (1 + I)
  4748     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4749     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  4750        (CP-DCC-AH-RATE / +1000)
  4751     COMPUTE WK2 = (1 + J) ** (M * -1)
  4752     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4753     COMPUTE ANGLEM = ((1 - ((1 + J)
  4754          ** (M * -1))) / J) / OD
  4755     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4756     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4757          ** ((N - M) * -1))) / I)
  4758     MOVE +0                     TO WK3
  4759     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4760        (WS-COUNTER > M)
  4761        COMPUTE ANGLEM = (1 - ((1 + J)
  4762          ** ((M - WS-COUNTER + 1) * -1))) / J
  4763        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4764        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4765        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  86
* ELRFND.cbl
  4766           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  4767     END-PERFORM
  4768     MOVE WK3                    TO CP-CALC-PREMIUM
  4769
  4770     GO TO 99999-RETURN
  4771
  4772     .
  4773 12001-CHECK-DCC-MNET-TOT-S.
  4774
  4775     IF (CP-COMPANY-ID EQUAL 'DCC')
  4776        AND (CP-EARN-AS-NET-PAY)
  4777        AND (CP-BENEFIT-CD (1:1) = 'S')
  4778        AND (CP-BEN-CATEGORY = 'N')
  4779        CONTINUE
  4780     ELSE
  4781        GO TO 12001-CONTINUE-NET
  4782     END-IF
  4783
  4784*    I = APR/1200
  4785*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  4786*    RA = PAYMENT AMOUNT
  4787*    WK5-CSL = THE BALANCE (PAY OFF )
  4788*    WK3 = THE ACCUMULATED PREMIUM
  4789*    WK2 = (1 + I) ^ (m * -1)
  4790*    OD  = GAMMA
  4791*
  4792     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  4793     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  4794        / (1 + J)
  4795     COMPUTE ANGLEM = ((1 - ((1 + J)
  4796          ** (M * -1))) / J) / OD
  4797     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4798          ** ((N - M) * -1))) / I)
  4799          * (1 + J) ** (-1 * M)
  4800     COMPUTE ANGLEN-M = ANGLEN-M / OD
  4801     MOVE CP-MONTHLY-PAYMENT     TO RA
  4802     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  4803        / +30)
  4804     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  4805        ** (WK1) - 1)) / J) * RA
  4806     COMPUTE WK5 = (((((M * (M + 1) / 2)
  4807        + (CP-DAYS-TO-1ST-PMT - +30)
  4808        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  4809        CP-DCC-AH-RATE / +1000 * 12 / 12)
  4810     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  4811        (12 / 12)
  4812     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  4813        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  4814        (CP-DCC-AH-RATE / +1000) * 12 / 12
  4815     COMPUTE WK3 = WK3 + WK5-CSL
  4816     MOVE WK3                    TO CP-CALC-PREMIUM
  4817     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4818     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4819        / (1 + K)
  4820     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4821          ** ((N - M) * -1))) / I)
  4822     COMPUTE WK2 = (1 + K) ** (M * -1)
  4823     COMPUTE ANGLEN-M = ANGLEN-M * WK2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  87
* ELRFND.cbl
  4824     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4825     COMPUTE ANGLEM = ((1 - ((1 + K)
  4826          ** (M * -1))) / K) / Y
  4827*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4828     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  4829        ((1 + K) ** (M + 1 / Y
  4830        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4831        - 1)) / K) * RA
  4832     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4833        + (CP-DAYS-TO-1ST-PMT - +30)
  4834        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4835        CP-DCC-AH-RATE / 1000 * 12 / 12)
  4836     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  4837        * (12 / 12)
  4838     MOVE WK3                    TO CP-LF-PREM
  4839
  4840     GO TO 99999-RETURN
  4841
  4842     .
  4843 12001-CONTINUE-NET.
  4844
  4845     IF NET-STD
  4846        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  4847*          OR 'DCC'
  4848         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  4849         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  4850         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  4851         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  4852                               * ((1 + N) / (1 + M))
  4853        ELSE
  4854         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  4855         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  4856         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  4857         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  4858
  4859     IF NET-SMP
  4860         COMPUTE N2 = N * N
  4861         COMPUTE N3 = N2 * N
  4862         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  4863         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  4864         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  4865         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  4866         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  4867
  4868     IF NPO-PRUDENTIAL
  4869       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  4870           VARYING WS-COUNTER FROM 1 BY 1
  4871               UNTIL WS-COUNTER = N
  4872       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  4873       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  4874
  4875     MOVE WK3 TO FACTOR.
  4876
  4877     GO TO 99999-RETURN.
  4878
  4879 12100-PRU-CALC.
  4880     IF WS-COUNTER = 1
  4881         COMPUTE PWK = (I + 1)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  88
* ELRFND.cbl
  4882     ELSE
  4883         COMPUTE PWK = PWK * (I + 1).
  4884
  4885 12199-EXIT.
  4886      EXIT.
  4887
  4888 99000-ERROR.
  4889     MOVE +9999.999999999 TO N-P-FACTOR.
  4890     MOVE '4'             TO CP-RETURN-CODE.
  4891
  4892     GO TO 99999-EXIT.
  4893
  4894 99999-RETURN.
  4895     MOVE FACTOR          TO N-P-FACTOR.
  4896
  4897 99999-EXIT.
  4898      EXIT.
  4899
  4900 9999-DFHBACK SECTION.
  4901     MOVE '9%                    "   ' TO DFHEIV0
  4902     MOVE 'ELRFND' TO DFHEIV1
  4903     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4904     GOBACK.
  4905 9999-DFHEXIT.
  4906     IF DFHEIGDJ EQUAL 0001
  4907         NEXT SENTENCE.
  4908     MOVE '9%                    "   ' TO DFHEIV0
  4909     MOVE 'ELRFND' TO DFHEIV1
  4910     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4911     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2488     Code:       40649
