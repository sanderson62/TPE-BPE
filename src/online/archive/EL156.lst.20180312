* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING
    61* 012016  IR2016011800003  PEMA  FIXED LENGTH OF PAYEE NAME
    62* 050616  CR2015030200004  TANA  Additional pmt Pd thru exp date
    63* 013017  CR2016053100001  PEMA  ACH PROCESSING
    64* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    65* 102617    2017101800003  TANA  Fix family leave auth level
    66* 022718    2017100200004  TANA  Set hold & pays > than 30 days
    67******************************************************************
    68
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page   3
* EL156.cbl
    70 ENVIRONMENT DIVISION.
    71
    72 DATA DIVISION.
    73
    74 WORKING-STORAGE SECTION.
    75 01  DFH-START PIC X(04).
    76
    77 77  FILLER  PIC X(32)  VALUE '********************************'.
    78 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    79 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    80 77  WS-SSN  PIC X(9) VALUE ZEROS.
    81 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    82 77  C0                          PIC S999 COMP-3 VALUE +0.
    83 77  C1                          PIC S999 COMP-3 VALUE +0.
    84 77  C2                          PIC S999 COMP-3 VALUE +0.
    85 77  C3                          PIC S999 COMP-3 VALUE +0.
    86 77  s1                          PIC S999 COMP-3 VALUE +0.
    87 77  s2                          pic s999 comp-3 value +0.
    88 77  P1                          PIC S999 COMP-3 VALUE +0.
    89 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    90 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    91 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    92 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    93 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    94 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    95 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    96 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    97 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    98 77  ws-max-bens                 pic s999 comp-3 value +0.
    99 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
   100 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
   101 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
   102 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
   103 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
   104 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
   105
   106*    COPY ELCSCTM.
   107******************************************************************
   108*                                                                *
   109*                                                                *
   110*                            ELCSCTM                             *
   111*                            VMOD=2.001                          *
   112*                                                                *
   113*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   114*                                                                *
   115******************************************************************
   116 01  SECURITY-MESSAGE.
   117     12  FILLER                          PIC X(30)
   118            VALUE '** LOGIC SECURITY VIOLATION -'.
   119     12  SM-READ                         PIC X(6).
   120     12  FILLER                          PIC X(5)
   121            VALUE ' PGM='.
   122     12  SM-PGM                          PIC X(6).
   123     12  FILLER                          PIC X(5)
   124            VALUE ' OPR='.
   125     12  SM-PROCESSOR-ID                 PIC X(4).
   126     12  FILLER                          PIC X(6)
   127            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page   4
* EL156.cbl
   128     12  SM-TERMID                       PIC X(4).
   129     12  FILLER                          PIC XX   VALUE SPACE.
   130     12  SM-JUL-DATE                     PIC 9(5).
   131     12  FILLER                          PIC X    VALUE SPACE.
   132     12  SM-TIME                         PIC 99.99.
   133
   134
   135*    COPY ELCSCRTY.
   136******************************************************************
   137*                                                                *
   138*                                                                *
   139*                            ELCSCRTY                            *
   140*                            VMOD=2.001                          *
   141*                                                                *
   142*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   143*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   144*        SAVED IN PI-SECURITY-ADDRESS.                           *
   145*                                                                *
   146******************************************************************
   147 01  SECURITY-CONTROL.
   148     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   149     12  FILLER                       PIC XX    VALUE 'SC'.
   150     12  SC-CREDIT-CODES.
   151         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   152             20  SC-CREDIT-DISPLAY    PIC X.
   153             20  SC-CREDIT-UPDATE     PIC X.
   154     12  SC-CLAIMS-CODES.
   155         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   156             20  SC-CLAIMS-DISPLAY    PIC X.
   157             20  SC-CLAIMS-UPDATE     PIC X.
   158
   159 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   160 01  WS-DATE-AREA.
   161     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   162     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   163     12  SAVE-DATE-CCYYMMDD.
   164         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   165         16  SAVE-DATE-YMD.
   166             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   167             20  FILLER              PIC X(04)   VALUE SPACES.
   168
   169 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   170 01  STANDARD-AREAS.
   171     12  WS-RESPONSE         PIC S9(8)   COMP.
   172         88  WS-RESP-NORMAL              VALUE +00.
   173         88  WS-RESP-ERROR               VALUE +01.
   174         88  WS-RESP-NOTFND              VALUE +13.
   175         88  WS-RESP-DUPREC              VALUE +14.
   176         88  WS-RESP-ENDFILE             VALUE +20.
   177     12  PMT-HEAD-A.
   178         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   179         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   180         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   181-        '     RESERVES  TYPE    AMOUNT'.
   182     12  PMT-HEAD-B.
   183         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   184         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   185         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page   5
* EL156.cbl
   186     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   187     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   188     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   189     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   190     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   191     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   192     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   193     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   194     12  PGM-NAME            PIC X(8).
   195     12  TIME-IN             PIC S9(7).
   196     12  TIME-OUT-R  REDEFINES TIME-IN.
   197         16  FILLER          PIC X.
   198         16  TIME-OUT        PIC 99V99.
   199         16  FILLER          PIC XX.
   200     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   201     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   202     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   203     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   204     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   205     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   206     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   207     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   208     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   209     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   210     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   211     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   212     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   213     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   214     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   215     12  WS-BLANK            PIC X       VALUE ' '.
   216
   217 01  MISC-WORK-AREAS.
   218     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   219     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   220     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   221     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   222     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   223     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   224     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   225     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   226     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   227     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   228     12  W-CALLED-NAME           PIC X(08).
   229     12  W-EOB-CODES.
   230         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   231             20  W-EOB-CODE      PIC XXX.
   232             20  W-EOB-FILLER    PIC X.
   233     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   234     12  W-NAME-LAST             PIC X(15).
   235     12  W-NAME-FIRST            PIC X(15).
   236     12  W-NAME-MIDDLE.
   237         16  FILLER              PIC X.
   238         16  W-NAME-MIDDLE-2     PIC X.
   239         16  FILLER              PIC X(13).
   240     12  W-DMD-CHECK-NO.
   241         16  W-DMD-CHECK-NO-1    PIC X(4).
   242         16  W-DMD-CHECK-NO-2    PIC X.
   243         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page   6
* EL156.cbl
   244
   245     12  WS-COMPUTE-FROM-DT  PIC XX.
   246     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   247     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   248     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   249     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   250     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   251     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   252         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   253         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   254     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   255         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   256     12  WS-UPDATE-SW        PIC X VALUE ' '.
   257     12  WS-GROUPING.
   258         16  WS-GROUP-1      PIC X VALUE SPACES.
   259         16  FILLER          PIC X(05) VALUE SPACES.
   260     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   261     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   262     12  WS-WORK-STATE-ACCT.
   263         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   264         16  FILLER          PIC X       VALUE '/'.
   265         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   266     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   267     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   268     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   269     12  QID.
   270         16  QID-TERM        PIC X(4)    VALUE SPACES.
   271         16  FILLER          PIC X(4)    VALUE '156A'.
   272     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   273     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   274     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   275     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   276     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   277     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   278     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   279     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   280     12  WS-STATUS           PIC X       VALUE SPACES.
   281     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   282     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   283     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   284     12  ws-extended-exp-dt  pic xx      value low-values.
   285     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   286     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   287     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   288     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   289     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   290     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   291     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   292     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   293     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   294     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   295     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   296     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   297     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   298     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   299     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   300     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   301     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page   7
* EL156.cbl
   302     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   303     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   304     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   305     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   306     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   307     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   308     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   309     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   310     12  WORK-DATE-FROM.
   311         16  WDF-MONTH       PIC 99        VALUE ZERO.
   312         16  WDF-DAY         PIC 99        VALUE ZERO.
   313         16  WDF-YEAR        PIC 99        VALUE ZERO.
   314     12  WORK-DATE-THRU.
   315         16  WDT-MONTH       PIC 99        VALUE ZERO.
   316         16  WDT-DAY         PIC 99        VALUE ZERO.
   317         16  WDT-YEAR        PIC 99        VALUE ZERO.
   318     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   319     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   320     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   321     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   322     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   323     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   324     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   325     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   326     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   327     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   328     12  WS-PY-WK REDEFINES WS-PY-WORK.
   329         16  WS-PY-NUM       PIC S9(7)V99.
   330         16  WS-PY-SIGN      PIC X.
   331     12  WS-DY-WORK          PIC S9(5).
   332     12  WS-DY-WK REDEFINES WS-DY-WORK.
   333         16  WS-DY-NUM       PIC S9(4).
   334         16  WS-DY-SIGN      PIC X.
   335     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   336         88  COMP-REC-FOUND              VALUE 'Y'.
   337     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   338         88  BENEFIT-FOUND       VALUE 'Y'.
   339         88  NO-BENEFIT-FOUND    VALUE 'N'.
   340     12  WS-TERMS.
   341         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   342         16  FILLER          PIC X       VALUE '/'.
   343         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   344         16  WST-REM-DAYS-GRP.
   345             20  WST-SLASH   PIC X       VALUE '/'.
   346             20  WST-REM-DAYS
   347                             PIC --9.
   348     12  WS-ACCESS.
   349         16  FILLER          PIC XX      VALUE SPACES.
   350         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   351     12  WS-STATE-ACCESS.
   352         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   353         16  FILLER          PIC XX      VALUE SPACES.
   354     12  WS-CARR-ACCESS.
   355         16  FILLER          PIC X(3)    VALUE SPACES.
   356         16  WS-CARR         PIC X       VALUE SPACES.
   357     12  DATE-WORK.
   358         16  FILLER          PIC XX      VALUE SPACES.
   359         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page   8
* EL156.cbl
   360     12  WS-SAVE-INPUT.
   361         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   362         16  WS-PAYEE        PIC XX      VALUE SPACE.
   363         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   364         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   365         16  WS-OFFLINE      PIC X       VALUE SPACE.
   366         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   367         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   368         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   369         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   370         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   371         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   372         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   373         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   374         16  WS-ETYPE        PIC X       VALUE SPACE.
   375         16  WS-CASH         PIC X       VALUE SPACE.
   376         16  WS-GROUPED      PIC X       VALUE SPACE.
   377         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   378         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   379         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   380         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   381         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   382         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   383         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   384         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   385         16  ws-int-to-rem-borr pic x value spaces.
   386     12  LAST-ERROR-LINE.
   387         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   388         16  FILLER              PIC X(30)
   389             VALUE ' FATAL ERRORS ENCOUNTERED'.
   390         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   391         16  FILLER              PIC X(28)
   392             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   393     12  WS-CHECK-AREA.
   394         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   395         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   396     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   397     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   398         16  FILLER              PIC XX.
   399         16  WS-A-CHECK-NUM-5    PIC 9(5).
   400     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   401         16  FILLER              PIC X.
   402         16  WS-A-CHECK-NUM-6    PIC 9(6).
   403     12  OPTION-1-SAVE-AREA.
   404         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   405         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   406     12  WS-WORK-ZIP.
   407         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   408         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   409     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   410                                 PIC 9(9).
   411     12  WS-FLI-PMTNOTE.
   412         16  WS-PMTOPTION        PIC XX.
   413         16  WS-DOCNAME          PIC X(28).
   414         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   415             20  WS-AMOUNT       PIC X(8).
   416             20  FILLER          PIC X(20).
   417         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page   9
* EL156.cbl
   418             20  WS-NUM-AMT      PIC 9(6)V99.
   419             20  FILLER          PIC X(20).
   420
   421     12  WS-HAN-PMTNOTE.
   422         16  WS-HAN-PMT-CODE     PIC X.
   423         16  WS-HAN-PMT-NOTE     PIC X(39).
   424
   425     12  WS-NCL-PMT-OPTION       PIC XX.
   426         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   427
   428     12  WS-CLAIM-SEQUENCE.
   429         16  FILLER              PIC X VALUE '('.
   430         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   431         16  FILLER              PIC X(04) VALUE ' OF '.
   432         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   433         16  FILLER              PIC X VALUE ')'.
   434
   435     12  WS-REFUND-AMT           PIC Z(7).99.
   436     12  WS-CALC-INT             PIC S9(7)V99.
   437     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   438
   439     12  SUB                     PIC 99 VALUE ZEROS.
   440
   441     12  WS-BOANOTE1.
   442         16  WS-BOANOTE1-DESC    PIC X(11).
   443         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   444         16  FILLER              PIC X(17).
   445     12  WS-BOANOTE2.
   446         16  WS-BOANOTE2-DESC    PIC X(11).
   447         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   448         16  FILLER              PIC X(17).
   449
   450     12  WS-NCLNOTE1.
   451         16  WS-NCLNOTE1-DESC    PIC X(11).
   452         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   453         16  FILLER              PIC X(17).
   454     12  WS-NCLNOTE2.
   455         16  WS-NCLNOTE2-DESC    PIC X(11).
   456         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   457         16  FILLER              PIC X(17).
   458
   459     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   460     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   461     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   462     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   463     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   464     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   465     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   466     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   467     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   468     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   469
   470     12  WS-AIG-WORK-AREAS.
   471         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   472             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   473         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   474             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   475         16  WS-FROM-DATE-MDY.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  10
* EL156.cbl
   476             20  WS-FROM-MO      PIC 99.
   477             20  WS-FROM-DA      PIC 99.
   478             20  WS-FROM-YR      PIC 99.
   479         16  WS-TEMP-DATE-MDY.
   480             20  WS-TEMP-MO      PIC 99.
   481             20  WS-TEMP-DA      PIC 99.
   482             20  WS-TEMP-YR      PIC 99.
   483         16  WS-BIN-FROM-DT      PIC XX.
   484         16  WS-TEMP-INC-MDY.
   485             20  WS-TEMP-INC-MO  PIC 99.
   486             20  WS-TEMP-INC-DA  PIC 99.
   487             20  WS-TEMP-INC-YR  PIC 99.
   488         16  WS-PMT-DUE-MDY.
   489             20  WS-PMT-DUE-MO   PIC 99.
   490             20  WS-PMT-DUE-DA   PIC 99.
   491             20  WS-PMT-DUE-YR   PIC 99.
   492         16  WS-PMT-DUE-DT       PIC XX.
   493         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   494         16  WS-RETRO-ELIM-DT    PIC XX.
   495         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   496             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   497         16  WS-SAVE-DUE-DA      PIC 99.
   498         16  WS-CDAYS            PIC S9(05).
   499         16  WS-DAYS-OFF         PIC S9(05).
   500         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   501             88  ELIM-SATISFIED            VALUE 'Y'.
   502         16  WS-AIG-CHECKNO.
   503             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   504             20  WS-A-CHECKNO-3-7.
   505                 24  FILLER              PIC X(3)    VALUE SPACES.
   506                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   507                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   508         16  WS-AIG-GROUPING.
   509             20  WS-A-BENE               PIC XXX.
   510             20  FILLER                  PIC XXX.
   511         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   512             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   513             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   514         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   515                 VALUE 'UNEMPLOYMENT PAYMENT'.
   516         16  WS-CHK-THRU-DT              PIC XX.
   517         16  WS-HOLD-BIN-DATE-1          PIC XX.
   518
   519 01  MISC-CSO-AREA.
   520     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   521     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   522     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   523         88  APPROVAL-NEEDED                        VALUE 'Y'.
   524     12  WS-APPROV-NOTE                  PIC X(43)
   525         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   526     12  WS-3550-APPROV-NOTE             PIC X(43)
   527         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   528     12  WS-REAUDIT-NOTE                 PIC X(43)
   529         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   530     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   531     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   532     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   533     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  11
* EL156.cbl
   534     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   535     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   536     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   537         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   538     12  WS-PAYEE-CITY-STATE     PIC X(30).
   539     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   540         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   541     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   542     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   543     12  WS-WORK-NAME            PIC X(30).
   544     12  FILLER  REDEFINES WS-WORK-NAME.
   545         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   546     12  WS-INSURED-NAME         PIC X(30).
   547     12  FILLER  REDEFINES WS-INSURED-NAME.
   548         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   549     12  WS-PAYEE-NAME           PIC X(30).
   550     12  FILLER  REDEFINES WS-PAYEE-NAME.
   551         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   552     12  WS-HOLD-UNTIL-SW        PIC X VALUE SPACES.
   553         88  HOLD-UNTIL-CHK            VALUE 'Y'.
   554     12  WS-HOLD-UNTIL-DT        PIC X(02) VALUE ZERO.
   555
   556 01  ERROR-MESSAGES.
   557     12  ER-0000                 PIC X(4)  VALUE '0000'.
   558     12  ER-0004                 PIC X(4)  VALUE '0004'.
   559     12  ER-0008                 PIC X(4)  VALUE '0008'.
   560     12  ER-0019                 PIC X(4)  VALUE '0019'.
   561     12  ER-0029                 PIC X(4)  VALUE '0029'.
   562     12  ER-0042                 PIC X(4)  VALUE '0042'.
   563     12  ER-0070                 PIC X(4)  VALUE '0070'.
   564     12  ER-0130                 PIC X(4)  VALUE '0130'.
   565     12  ER-0149                 PIC X(4)  VALUE '0149'.
   566     12  ER-0154                 PIC X(4)  VALUE '0154'.
   567     12  ER-0168                 PIC X(4)  VALUE '0168'.
   568     12  ER-0169                 PIC X(4)  VALUE '0169'.
   569     12  ER-0172                 PIC X(4)  VALUE '0174'.
   570     12  ER-0198                 PIC X(4)  VALUE '0198'.
   571     12  ER-0204                 PIC X(4)  VALUE '0204'.
   572     12  ER-0206                 PIC X(4)  VALUE '0206'.
   573     12  ER-0252                 PIC X(4)  VALUE '0252'.
   574     12  ER-0254                 PIC X(4)  VALUE '0254'.
   575     12  ER-0282                 PIC X(4)  VALUE '0282'.
   576     12  ER-0283                 PIC X(4)  VALUE '0283'.
   577     12  ER-0294                 PIC X(4)  VALUE '0294'.
   578     12  ER-0338                 PIC X(4)  VALUE '0338'.
   579     12  ER-0419                 PIC X(4)  VALUE '0419'.
   580     12  ER-0420                 PIC X(4)  VALUE '0420'.
   581     12  ER-0421                 PIC X(4)  VALUE '0421'.
   582     12  ER-0422                 PIC X(4)  VALUE '0422'.
   583     12  ER-0433                 PIC X(4)  VALUE '0433'.
   584     12  ER-0436                 PIC X(4)  VALUE '0436'.
   585     12  ER-0437                 PIC X(4)  VALUE '0437'.
   586     12  ER-0438                 PIC X(4)  VALUE '0438'.
   587     12  ER-0439                 PIC X(4)  VALUE '0439'.
   588     12  ER-0440                 PIC X(4)  VALUE '0440'.
   589     12  ER-0441                 PIC X(4)  VALUE '0441'.
   590     12  ER-0442                 PIC X(4)  VALUE '0442'.
   591     12  ER-0443                 PIC X(4)  VALUE '0443'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  12
* EL156.cbl
   592     12  ER-0444                 PIC X(4)  VALUE '0444'.
   593     12  ER-0445                 PIC X(4)  VALUE '0445'.
   594     12  ER-0446                 PIC X(4)  VALUE '0446'.
   595     12  ER-0447                 PIC X(4)  VALUE '0447'.
   596     12  ER-0448                 PIC X(4)  VALUE '0448'.
   597     12  ER-0449                 PIC X(4)  VALUE '0449'.
   598     12  ER-0452                 PIC X(4)  VALUE '0452'.
   599     12  ER-0458                 PIC X(4)  VALUE '0458'.
   600     12  ER-0459                 PIC X(4)  VALUE '0459'.
   601     12  ER-0460                 PIC X(4)  VALUE '0460'.
   602     12  ER-0461                 PIC X(4)  VALUE '0461'.
   603     12  ER-0462                 PIC X(4)  VALUE '0462'.
   604     12  ER-0463                 PIC X(4)  VALUE '0463'.
   605     12  ER-0464                 PIC X(4)  VALUE '0464'.
   606     12  ER-0465                 PIC X(4)  VALUE '0465'.
   607     12  ER-0466                 PIC X(4)  VALUE '0466'.
   608     12  ER-0467                 PIC X(4)  VALUE '0467'.
   609     12  ER-0468                 PIC X(4)  VALUE '0468'.
   610     12  ER-0469                 PIC X(4)  VALUE '0469'.
   611     12  ER-0473                 PIC X(4)  VALUE '0473'.
   612     12  ER-0474                 PIC X(4)  VALUE '0474'.
   613     12  ER-0475                 PIC X(4)  VALUE '0475'.
   614     12  ER-0476                 PIC X(4)  VALUE '0476'.
   615     12  ER-0477                 PIC X(4)  VALUE '0477'.
   616     12  ER-0478                 PIC X(4)  VALUE '0478'.
   617     12  ER-0479                 PIC X(4)  VALUE '0479'.
   618     12  ER-0481                 PIC X(4)  VALUE '0481'.
   619     12  ER-0491                 PIC X(4)  VALUE '0491'.
   620     12  ER-0492                 PIC X(4)  VALUE '0492'.
   621     12  ER-0493                 PIC X(4)  VALUE '0493'.
   622     12  ER-0494                 PIC X(4)  VALUE '0494'.
   623     12  ER-0495                 PIC X(4)  VALUE '0495'.
   624     12  ER-0499                 PIC X(4)  VALUE '0499'.
   625     12  ER-0500                 PIC X(4)  VALUE '0500'.
   626     12  ER-0501                 PIC X(4)  VALUE '0501'.
   627     12  ER-0502                 PIC X(4)  VALUE '0502'.
   628     12  ER-0508                 PIC X(4)  VALUE '0508'.
   629     12  ER-0513                 PIC X(4)  VALUE '0513'.
   630     12  ER-0518                 PIC X(4)  VALUE '0518'.
   631     12  ER-0524                 PIC X(4)  VALUE '0524'.
   632     12  ER-0525                 PIC X(4)  VALUE '0525'.
   633     12  ER-0526                 PIC X(4)  VALUE '0526'.
   634     12  ER-0530                 PIC X(4)  VALUE '0530'.
   635     12  ER-0540                 PIC X(4)  VALUE '0540'.
   636     12  ER-0541                 PIC X(4)  VALUE '0541'.
   637     12  ER-0542                 PIC X(4)  VALUE '0542'.
   638     12  ER-0543                 PIC X(4)  VALUE '0543'.
   639     12  ER-0545                 PIC X(4)  VALUE '0545'.
   640     12  ER-0552                 PIC X(4)  VALUE '0552'.
   641     12  ER-0555                 PIC X(4)  VALUE '0555'.
   642     12  ER-0556                 PIC X(4)  VALUE '0556'.
   643     12  ER-0557                 PIC X(4)  VALUE '0557'.
   644     12  ER-0572                 PIC X(4)  VALUE '0572'.
   645     12  ER-0573                 PIC X(4)  VALUE '0573'.
   646     12  ER-0594                 PIC X(4)  VALUE '0594'.
   647     12  ER-0616                 PIC X(4)  VALUE '0616'.
   648     12  ER-0617                 PIC X(4)  VALUE '0617'.
   649     12  ER-0618                 PIC X(4)  VALUE '0618'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  13
* EL156.cbl
   650     12  ER-0657                 PIC X(4)  VALUE '0657'.
   651     12  ER-0658                 PIC X(4)  VALUE '0658'.
   652     12  ER-0699                 PIC X(4)  VALUE '0699'.
   653     12  ER-0730                 PIC X(4)  VALUE '0730'.
   654     12  ER-0737                 PIC X(4)  VALUE '0737'.
   655     12  ER-0760                 PIC X(4)  VALUE '0760'.
   656     12  ER-0768                 PIC X(4)  VALUE '0768'.
   657     12  ER-0769                 PIC X(4)  VALUE '0769'.
   658     12  ER-0770                 PIC X(4)  VALUE '0770'.
   659     12  ER-0802                 PIC X(4)  VALUE '0802'.
   660     12  ER-0803                 PIC X(4)  VALUE '0803'.
   661     12  ER-0819                 PIC X(4)  VALUE '0819'.
   662     12  ER-0834                 PIC X(4)  VALUE '0834'.
   663     12  ER-0836                 PIC X(4)  VALUE '0836'.
   664     12  ER-0844                 PIC X(4)  VALUE '0844'.
   665     12  ER-0845                 PIC X(4)  VALUE '0845'.
   666     12  ER-0846                 PIC X(4)  VALUE '0846'.
   667     12  ER-0849                 PIC X(4)  VALUE '0849'.
   668     12  ER-0851                 PIC X(4)  VALUE '0851'.
   669     12  ER-0872                 PIC X(4)  VALUE '0872'.
   670     12  ER-0873                 PIC X(4)  VALUE '0873'.
   671     12  ER-0874                 PIC X(4)  VALUE '0874'.
   672     12  ER-0879                 PIC X(4)  VALUE '0879'.
   673     12  ER-0919                 PIC X(4)  VALUE '0919'.
   674     12  ER-0921                 PIC X(4)  VALUE '0921'.
   675     12  ER-0923                 PIC X(4)  VALUE '0923'.
   676     12  ER-0925                 PIC X(4)  VALUE '0925'.
   677     12  ER-0944                 PIC X(4)  VALUE '0944'.
   678     12  ER-0945                 PIC X(4)  VALUE '0945'.
   679     12  ER-0946                 PIC X(4)  VALUE '0946'.
   680     12  ER-0947                 PIC X(4)  VALUE '0947'.
   681     12  ER-0948                 PIC X(4)  VALUE '0948'.
   682     12  ER-0949                 PIC X(4)  VALUE '0949'.
   683     12  ER-0950                 PIC X(4)  VALUE '0950'.
   684     12  ER-0951                 PIC X(4)  VALUE '0951'.
   685     12  ER-0954                 PIC X(4)  VALUE '0954'.
   686     12  ER-0956                 PIC X(4)  VALUE '0956'.
   687     12  ER-0967                 PIC X(4)  VALUE '0967'.
   688     12  ER-0968                 PIC X(4)  VALUE '0968'.
   689     12  ER-0974                 PIC X(4)  VALUE '0974'.
   690     12  ER-0975                 PIC X(4)  VALUE '0975'.
   691     12  ER-1561                 PIC X(4)  VALUE '1561'.
   692     12  ER-1566                 PIC X(4)  VALUE '1566'.
   693     12  ER-1567                 PIC X(4)  VALUE '1567'.
   694     12  ER-1569                 PIC X(4)  VALUE '1569'.
   695     12  er-1582                 pic x(4)  value '1582'.
   696     12  er-1657                 pic x(4)  value '1657'.
   697     12  er-1658                 pic x(4)  value '1658'.
   698     12  er-1667                 pic x(4)  value '1667'.
   699     12  er-1670                 pic x(4)  value '1670'.
   700     12  er-1671                 pic x(4)  value '1671'.
   701     12  er-1672                 pic x(4)  value '1672'.
   702     12  er-1673                 pic x(4)  value '1673'.
   703     12  er-1674                 pic x(4)  value '1674'.
   704     12  er-1677                 pic x(4)  value '1677'.
   705     12  ER-1775                 PIC X(4)  VALUE '1775'.
   706     12  ER-1880                 PIC X(4)  VALUE '1880'.
   707     12  ER-2044                 PIC X(4)  VALUE '2044'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  14
* EL156.cbl
   708     12  ER-3140                 PIC X(4)  VALUE '3140'.
   709     12  ER-3141                 PIC X(4)  VALUE '3141'.
   710     12  ER-3255                 PIC X(4)  VALUE '3255'.
   711     12  ER-3516                 PIC X(4)  VALUE '3516'.
   712     12  ER-3527                 PIC X(4)  VALUE '3527'.
   713     12  ER-3528                 PIC X(4)  VALUE '3528'.
   714     12  ER-3529                 PIC X(4)  VALUE '3529'.
   715     12  ER-3530                 PIC X(4)  VALUE '3530'.
   716     12  ER-3531                 PIC X(4)  VALUE '3531'.
   717     12  ER-3532                 PIC X(4)  VALUE '3532'.
   718     12  ER-3533                 PIC X(4)  VALUE '3533'.
   719     12  ER-3534                 PIC X(4)  VALUE '3534'.
   720     12  ER-3535                 PIC X(4)  VALUE '3535'.
   721     12  ER-3536                 PIC X(4)  VALUE '3536'.
   722     12  ER-3537                 PIC X(4)  VALUE '3537'.
   723     12  ER-3538                 PIC X(4)  VALUE '3538'.
   724     12  ER-3539                 PIC X(4)  VALUE '3539'.
   725     12  ER-3540                 PIC X(4)  VALUE '3540'.
   726     12  ER-3541                 PIC X(4)  VALUE '3541'.
   727     12  ER-3542                 PIC X(4)  VALUE '3542'.
   728     12  ER-3543                 PIC X(4)  VALUE '3543'.
   729     12  ER-3546                 PIC X(4)  VALUE '3546'.
   730     12  ER-3549                 PIC X(4)  VALUE '3549'.
   731     12  ER-3818                 PIC X(4)  VALUE '3818'.
   732     12  ER-7540                 PIC X(4)  VALUE '7540'.
   733     12  ER-7576                 PIC X(4)  VALUE '7576'.
   734     12  ER-7579                 PIC X(4)  VALUE '7579'.
   735     12  ER-7580                 PIC X(4)  VALUE '7580'.
   736     12  ER-7583                 PIC X(4)  VALUE '7583'.
   737     12  ER-7830                 PIC X(4)  VALUE '7830'.
   738     12  ER-7831                 PIC X(4)  VALUE '7831'.
   739     12  ER-7832                 PIC X(4)  VALUE '7832'.
   740     12  ER-7833                 PIC X(4)  VALUE '7833'.
   741     12  ER-7834                 PIC X(4)  VALUE '7834'.
   742     12  ER-7835                 PIC X(4)  VALUE '7835'.
   743     12  ER-7836                 PIC X(4)  VALUE '7836'.
   744     12  ER-7837                 PIC X(4)  VALUE '7837'.
   745     12  ER-7838                 PIC X(4)  VALUE '7838'.
   746     12  ER-7841                 PIC X(4)  VALUE '7841'.
   747     12  ER-7844                 PIC X(4)  VALUE '7844'.
   748     12  ER-7845                 PIC X(4)  VALUE '7845'.
   749     12  ER-8000                 PIC X(4)  VALUE '8000'.
   750     12  ER-8051                 PIC X(4)  VALUE '8051'.
   751     12  ER-8052                 PIC X(4)  VALUE '8052'.
   752     12  ER-8053                 PIC X(4)  VALUE '8053'.
   753     12  ER-8054                 PIC X(4)  VALUE '8054'.
   754     12  ER-8055                 PIC X(4)  VALUE '8055'.
   755     12  ER-8056                 PIC X(4)  VALUE '8056'.
   756     12  ER-8057                 PIC X(4)  VALUE '8057'.
   757     12  ER-8058                 PIC X(4)  VALUE '8058'.
   758     12  ER-8059                 PIC X(4)  VALUE '8059'.
   759     12  ER-8060                 PIC X(4)  VALUE '8060'.
   760     12  ER-8061                 PIC X(4)  VALUE '8061'.
   761     12  ER-8062                 PIC X(4)  VALUE '8062'.
   762     12  ER-8063                 PIC X(4)  VALUE '8063'.
   763     12  ER-8064                 PIC X(4)  VALUE '8064'.
   764     12  ER-8065                 PIC X(4)  VALUE '8065'.
   765     12  ER-8066                 PIC X(4)  VALUE '8066'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  15
* EL156.cbl
   766     12  ER-8146                 PIC X(4)  VALUE '8146'.
   767     12  ER-8147                 PIC X(4)  VALUE '8147'.
   768     12  ER-8152                 PIC X(4)  VALUE '8152'.
   769     12  ER-8153                 PIC X(4)  VALUE '8153'.
   770     12  ER-8154                 PIC X(4)  VALUE '8154'.
   771     12  ER-8155                 PIC X(4)  VALUE '8155'.
   772     12  ER-8310                 PIC X(4)  VALUE '8310'.
   773     12  ER-8311                 PIC X(4)  VALUE '8311'.
   774     12  ER-8312                 PIC X(4)  VALUE '8312'.
   775     12  ER-8313                 PIC X(4)  VALUE '8313'.
   776     12  ER-8314                 PIC X(4)  VALUE '8314'.
   777     12  ER-8315                 PIC X(4)  VALUE '8315'.
   778     12  ER-8316                 PIC X(4)  VALUE '8316'.
   779     12  ER-8317                 PIC X(4)  VALUE '8317'.
   780
   781 01  CSO-WORK-FIELDS.
   782     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   783       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   784
   785     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   786     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   787         88  CERT-NOTE-ADDED           VALUE 'Y'.
   788     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   789         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   790     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   791
   792     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   793
   794 01  SC-NP6-CERT-NOTE.
   795     12  FILLER                  PIC X(12)
   796               VALUE 'REM BENEFIT '.
   797     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   798     12  SC-NP6-COMM             PIC X(8)
   799               VALUE ' + 6 MO '.
   800     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   801     12  FILLER                  PIC X(12)
   802               VALUE ' = AMT PAID '.
   803     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   804
   805 01  SC-NP6-ORIG-NOTE.
   806     12  FILLER                  PIC X(63)  VALUE
   807         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   808 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   809     88  PDEF-FOUND                   VALUE 'Y'.
   810 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   811     88  ACCT-FOUND                   VALUE 'Y'.
   812 01  CTBL-KEY-SAVE               PIC X(5).
   813 01  CTBL-KEY.
   814     05  CTBL-COMPANY-CD         PIC X.
   815     05  CTBL-TABLE              PIC XXX.
   816     05  CTBL-BEN-TYPE           PIC X.
   817     05  CTBL-BEN-CODE           PIC XX.
   818 01  ERPDEF-KEY-SAVE             PIC X(18).
   819 01  ERPDEF-KEY.
   820     12  ERPDEF-COMPANY-CD       PIC X.
   821     12  ERPDEF-STATE            PIC XX.
   822     12  ERPDEF-PROD-CD          PIC XXX.
   823     12  F                       PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  16
* EL156.cbl
   824     12  ERPDEF-BEN-TYPE         PIC X.
   825     12  ERPDEF-BEN-CODE         PIC XX.
   826     12  ERPDEF-EXP-DT           PIC XX.
   827 01  ELCRTT-KEY.
   828     05  CTRLR-COMP-CD       PIC X.
   829     05  CTRLR-CARRIER       PIC X.
   830     05  CTRLR-GROUPING      PIC X(6).
   831     05  CTRLR-STATE         PIC X(2).
   832     05  CTRLR-ACCOUNT       PIC X(10).
   833     05  CTRLR-EFF-DT        PIC XX.
   834     05  CTRLR-CERT-NO       PIC X(11).
   835     05  CTRLR-REC-TYPE      PIC X.
   836 01  ACCESS-KEYS.
   837     12  ELARCH-KEY.
   838         16  ARCH-CO             PIC X.
   839         16  ARCH-NUMBER         PIC S9(08) COMP.
   840         16  ARCH-REC-TYPE       PIC X.
   841         16  ARCH-SEQ            PIC S9(04) COMP.
   842     12  ELMSTR-KEY.
   843         16  MSTR-COMP-CD        PIC X.
   844         16  MSTR-CARRIER        PIC X.
   845         16  MSTR-CLAIM-NO       PIC X(7).
   846         16  MSTR-CERT-NO        PIC X(11).
   847     12  ELCNTL-KEY.
   848         16  CNTL-COMP-ID        PIC X(3).
   849         16  CNTL-REC-TYPE       PIC X.
   850         16  CNTL-ACCESS         PIC X(4).
   851         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   852     12  ELCERT-KEY.
   853         16  CERT-COMP-CD        PIC X.
   854         16  CERT-CARRIER        PIC X.
   855         16  CERT-GROUPING       PIC X(6).
   856         16  CERT-STATE          PIC XX.
   857         16  CERT-ACCOUNT        PIC X(10).
   858         16  CERT-EFF-DT         PIC XX.
   859         16  CERT-CERT-NO        PIC X(11).
   860     12  ELTRLR-KEY.
   861         16  TRLR-COMP-CD        PIC X.
   862         16  TRLR-CARRIER        PIC X.
   863         16  TRLR-CLAIM-NO       PIC X(7).
   864         16  TRLR-CERT-NO        PIC X(11).
   865         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   866     12  ELACTQ-KEY.
   867         16  ACTQ-COMP-CD        PIC X.
   868         16  ACTQ-CARRIER        PIC X.
   869         16  ACTQ-CLAIM-NO       PIC X(7).
   870         16  ACTQ-CERT-NO        PIC X(11).
   871     12  W-NOTE-KEY.
   872         16  W-NOTE-COMP-CD      PIC X.
   873         16  W-NOTE-CERT-KEY.
   874             20  W-NOTE-CARRIER  PIC X.
   875             20  W-NOTE-GROUPING PIC X(6).
   876             20  W-NOTE-STATE    PIC XX.
   877             20  W-NOTE-ACCOUNT  PIC X(10).
   878             20  W-NOTE-EFF-DT   PIC XX.
   879             20  W-NOTE-CERT-NO  PIC X(11).
   880     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   881     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  17
* EL156.cbl
   882     12  ERACCT-KEY.
   883         16  ERACCT-PARTIAL-KEY.
   884             20  ACCT-COMP-CD    PIC X.
   885             20  ACCT-CARRIER    PIC X.
   886             20  ACCT-GROUPING   PIC X(6).
   887             20  ACCT-STATE      PIC XX.
   888             20  ACCT-ACCOUNT    PIC X(10).
   889         16  ACCT-EXP-DT         PIC XX.
   890         16  FILLER              PIC X(4) VALUE SPACES.
   891     12  ELCHKQ-KEY.
   892         16  CHKQ-COMP-CD        PIC X.
   893         16  CHKQ-CONTROL        PIC S9(8) COMP.
   894         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   895     12  ELBENE-KEY.
   896         16  BENE-COMP-CD         PIC X.
   897         16  BENE-RECORD-TYPE     PIC X.
   898         16  BENE-NUMBER          PIC X(10).
   899     12  ERCOMP-KEY.
   900         16  COMP-COMP-CD        PIC X.
   901         16  COMP-CARRIER        PIC X.
   902         16  COMP-GROUP          PIC X(06).
   903         16  COMP-FIN-RESP       PIC X(10).
   904         16  COMP-ACCOUNT        PIC X(10).
   905         16  COMP-TYPE           PIC X.
   906
   907     12  DLO035-KEY.
   908         16  DL35-PROCESS-TYPE   PIC X.
   909         16  DL35-CREDIT-CARD    PIC X(20).
   910         16  DL35-BEN-TYPE       PIC XX.
   911         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   912         16  DL35-RETURN-CODE    PIC XX.
   913
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  18
* EL156.cbl
   915*    COPY ELCDATE.
   916******************************************************************
   917*                                                                *
   918*                                                                *
   919*                            ELCDATE.                            *
   920*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   921*                            VMOD=2.003
   922*                                                                *
   923*                                                                *
   924*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   925*                 LENGTH = 200                                   *
   926******************************************************************
   927
   928 01  DATE-CONVERSION-DATA.
   929     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   930     12  DC-OPTION-CODE                PIC X.
   931         88  BIN-TO-GREG                VALUE ' '.
   932         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   933         88  EDIT-GREG-TO-BIN           VALUE '2'.
   934         88  YMD-GREG-TO-BIN            VALUE '3'.
   935         88  MDY-GREG-TO-BIN            VALUE '4'.
   936         88  JULIAN-TO-BIN              VALUE '5'.
   937         88  BIN-PLUS-ELAPSED           VALUE '6'.
   938         88  FIND-CENTURY               VALUE '7'.
   939         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   940         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   941         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   942         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   943         88  JULIAN-TO-BIN-3            VALUE 'C'.
   944         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   945         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   946         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   947         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   948         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   949         88  CHECK-LEAP-YEAR            VALUE 'H'.
   950         88  BIN-3-TO-GREG              VALUE 'I'.
   951         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   952         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   953         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   954         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   955         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   956         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   957         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   958         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   959         88  THREE-CHARACTER-BIN
   960                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   961         88  GREGORIAN-TO-BIN
   962                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   963         88  BIN-TO-GREGORIAN
   964                  VALUES ' ' '1' 'I' '8' 'G'.
   965         88  JULIAN-TO-BINARY
   966                  VALUES '5' 'C' 'E' 'F'.
   967     12  DC-ERROR-CODE                 PIC X.
   968         88  NO-CONVERSION-ERROR        VALUE ' '.
   969         88  DATE-CONVERSION-ERROR
   970                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   971         88  DATE-IS-ZERO               VALUE '1'.
   972         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  19
* EL156.cbl
   973         88  DATE-IS-INVALID            VALUE '3'.
   974         88  DATE1-GREATER-DATE2        VALUE '4'.
   975         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   976         88  DATE-INVALID-OPTION        VALUE '9'.
   977         88  INVALID-CENTURY            VALUE 'A'.
   978         88  ONLY-CENTURY               VALUE 'B'.
   979         88  ONLY-LEAP-YEAR             VALUE 'C'.
   980         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   981     12  DC-END-OF-MONTH               PIC X.
   982         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   983     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   984         88  USE-NORMAL-PROCESS         VALUE ' '.
   985         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   986         88  ADJUST-UP-100-YRS          VALUE '2'.
   987     12  FILLER                        PIC X.
   988     12  DC-CONVERSION-DATES.
   989         16  DC-BIN-DATE-1             PIC XX.
   990         16  DC-BIN-DATE-2             PIC XX.
   991         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   992         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   993                       DC-GREG-DATE-1-EDIT.
   994             20  DC-EDIT1-MONTH        PIC 99.
   995             20  SLASH1-1              PIC X.
   996             20  DC-EDIT1-DAY          PIC 99.
   997             20  SLASH1-2              PIC X.
   998             20  DC-EDIT1-YEAR         PIC 99.
   999         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1000         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1001                     DC-GREG-DATE-2-EDIT.
  1002             20  DC-EDIT2-MONTH        PIC 99.
  1003             20  SLASH2-1              PIC X.
  1004             20  DC-EDIT2-DAY          PIC 99.
  1005             20  SLASH2-2              PIC X.
  1006             20  DC-EDIT2-YEAR         PIC 99.
  1007         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1008         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1009                     DC-GREG-DATE-1-YMD.
  1010             20  DC-YMD-YEAR           PIC 99.
  1011             20  DC-YMD-MONTH          PIC 99.
  1012             20  DC-YMD-DAY            PIC 99.
  1013         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1014         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1015                      DC-GREG-DATE-1-MDY.
  1016             20  DC-MDY-MONTH          PIC 99.
  1017             20  DC-MDY-DAY            PIC 99.
  1018             20  DC-MDY-YEAR           PIC 99.
  1019         16  DC-GREG-DATE-1-ALPHA.
  1020             20  DC-ALPHA-MONTH        PIC X(10).
  1021             20  DC-ALPHA-DAY          PIC 99.
  1022             20  FILLER                PIC XX.
  1023             20  DC-ALPHA-CENTURY.
  1024                 24 DC-ALPHA-CEN-N     PIC 99.
  1025             20  DC-ALPHA-YEAR         PIC 99.
  1026         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1027         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1028         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1029         16  DC-JULIAN-DATE            PIC 9(05).
  1030         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  20
* EL156.cbl
  1031                                       PIC 9(05).
  1032         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1033             20  DC-JULIAN-YEAR        PIC 99.
  1034             20  DC-JULIAN-DAYS        PIC 999.
  1035         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1036         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1037         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1038     12  DATE-CONVERSION-VARIBLES.
  1039         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1040         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1041             20  FILLER                PIC 9(3).
  1042             20  HOLD-CEN-1-CCYY.
  1043                 24  HOLD-CEN-1-CC     PIC 99.
  1044                 24  HOLD-CEN-1-YY     PIC 99.
  1045             20  HOLD-CEN-1-MO         PIC 99.
  1046             20  HOLD-CEN-1-DA         PIC 99.
  1047         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1048             20  HOLD-CEN-1-R-MO       PIC 99.
  1049             20  HOLD-CEN-1-R-DA       PIC 99.
  1050             20  HOLD-CEN-1-R-CCYY.
  1051                 24  HOLD-CEN-1-R-CC   PIC 99.
  1052                 24  HOLD-CEN-1-R-YY   PIC 99.
  1053             20  FILLER                PIC 9(3).
  1054         16  HOLD-CENTURY-1-X.
  1055             20  FILLER                PIC X(3)  VALUE SPACES.
  1056             20  HOLD-CEN-1-X-CCYY.
  1057                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1058                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1059             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1060             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1061         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1062             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1063             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1064             20  HOLD-CEN-1-R-X-CCYY.
  1065                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1066                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1067             20  FILLER                PIC XXX.
  1068         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1069         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1070         16  DC-JULIAN-DATE-1          PIC 9(07).
  1071         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1072             20  DC-JULIAN-1-CCYY.
  1073                 24  DC-JULIAN-1-CC    PIC 99.
  1074                 24  DC-JULIAN-1-YR    PIC 99.
  1075             20  DC-JULIAN-DA-1        PIC 999.
  1076         16  DC-JULIAN-DATE-2          PIC 9(07).
  1077         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1078             20  DC-JULIAN-2-CCYY.
  1079                 24  DC-JULIAN-2-CC    PIC 99.
  1080                 24  DC-JULIAN-2-YR    PIC 99.
  1081             20  DC-JULIAN-DA-2        PIC 999.
  1082         16  DC-GREG-DATE-A-EDIT.
  1083             20  DC-EDITA-MONTH        PIC 99.
  1084             20  SLASHA-1              PIC X VALUE '/'.
  1085             20  DC-EDITA-DAY          PIC 99.
  1086             20  SLASHA-2              PIC X VALUE '/'.
  1087             20  DC-EDITA-CCYY.
  1088                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  21
* EL156.cbl
  1089                 24  DC-EDITA-YEAR     PIC 99.
  1090         16  DC-GREG-DATE-B-EDIT.
  1091             20  DC-EDITB-MONTH        PIC 99.
  1092             20  SLASHB-1              PIC X VALUE '/'.
  1093             20  DC-EDITB-DAY          PIC 99.
  1094             20  SLASHB-2              PIC X VALUE '/'.
  1095             20  DC-EDITB-CCYY.
  1096                 24  DC-EDITB-CENT     PIC 99.
  1097                 24  DC-EDITB-YEAR     PIC 99.
  1098         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1099         16  DC-GREG-DATE-CYMD-R REDEFINES
  1100                              DC-GREG-DATE-CYMD.
  1101             20  DC-CYMD-CEN           PIC 99.
  1102             20  DC-CYMD-YEAR          PIC 99.
  1103             20  DC-CYMD-MONTH         PIC 99.
  1104             20  DC-CYMD-DAY           PIC 99.
  1105         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1106         16  DC-GREG-DATE-MDCY-R REDEFINES
  1107                              DC-GREG-DATE-MDCY.
  1108             20  DC-MDCY-MONTH         PIC 99.
  1109             20  DC-MDCY-DAY           PIC 99.
  1110             20  DC-MDCY-CEN           PIC 99.
  1111             20  DC-MDCY-YEAR          PIC 99.
  1112    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1113        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1114    12  DC-EL310-DATE                  PIC X(21).
  1115    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  22
* EL156.cbl
  1117*    COPY ELCLOGOF.
  1118******************************************************************
  1119*                                                                *
  1120*                                                                *
  1121*                            ELCLOGOF.                           *
  1122*                            VMOD=2.001                          *
  1123*                                                                *
  1124*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1125*                                                                *
  1126******************************************************************
  1127 01  CLASIC-LOGOFF.
  1128     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1129     12  LOGOFF-TEXT.
  1130         16  FILLER          PIC X(5)    VALUE SPACES.
  1131         16  LOGOFF-MSG.
  1132             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1133             20  FILLER      PIC X       VALUE SPACES.
  1134             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1135         16  FILLER          PIC X(80)
  1136           VALUE '* YOU ARE NOW LOGGED OFF'.
  1137         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1138         16  FILLER          PIC X       VALUE QUOTE.
  1139         16  LOGOFF-SYS-MSG  PIC X(17)
  1140           VALUE 'S CLAS-IC SYSTEM '.
  1141     12  TEXT-MESSAGES.
  1142         16  UNACCESS-MSG    PIC X(29)
  1143             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1144         16  PGMIDERR-MSG    PIC X(17)
  1145             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  23
* EL156.cbl
  1147*    COPY ELCCALC.
  1148******************************************************************
  1149*                                                                *
  1150*                           ELCCALC.                            *
  1151*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1152*                            VMOD=2.025                          *
  1153*                                                                *
  1154*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1155*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1156*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1157*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1158*                                                                *
  1159*  PASSED TO ELRTRM                                              *
  1160*  -----------------                                             *
  1161*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1162*  ORIGINAL TERM                                                 *
  1163*  BEGINNING DATE                                                *
  1164*  ENDING DATE                                                   *
  1165*  COMPANY I.D.                                                  *
  1166*  ACCOUNT MASTER USER FIELD                                     *
  1167*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1168*  FREE LOOK DAYS                                                *
  1169*                                                                *
  1170*  RETURNED FROM ELRTRM                                          *
  1171*  ---------------------                                         *
  1172*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1173*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1174*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1175*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1176*----------------------------------------------------------------*
  1177*  PASSED TO ELRAMT                                              *
  1178*  ----------------                                              *
  1179*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1180*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1181*  ORIGINAL AMOUNT                                               *
  1182*  ALTERNATE BENEFIT (BALLON)                                    *
  1183*  A.P.R. - NET PAY ONLY                                         *
  1184*  METHOD
  1185*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1186*  COMPANY I.D.                                                  *
  1187*  BENEFIT TYPE                                                  *
  1188*                                                                *
  1189*  RETURNED FROM ELRAMT                                          *
  1190*  --------------------                                          *
  1191*  REMAINING AMOUNT 1 - CURRENT                                  *
  1192*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1193*  REMAINING AMOUNT FACTOR
  1194*----------------------------------------------------------------*
  1195*  PASSED TO ELRESV                                              *
  1196*  -----------------                                             *
  1197*  CERTIFICATE EFFECTIVE DATE                                    *
  1198*  VALUATION DATE                                                *
  1199*  PAID THRU DATE                                                *
  1200*  BENEFIT                                                       *
  1201*  INCURRED DATE                                                 *
  1202*  REPORTED DATE                                                 *
  1203*  ISSUE AGE                                                     *
  1204*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  24
* EL156.cbl
  1205*  CDT PERCENT                                                   *
  1206*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1207* *CLAIM TYPE (LIFE, A/H)                                        *
  1208* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1209* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1210*                                                                *
  1211*  RETURNED FROM ELRESV                                          *
  1212*  --------------------                                          *
  1213*  CDT TABLE USED                                                *
  1214*  CDT FACTOR USED                                               *
  1215*  PAY TO CURRENT RESERVE                                        *
  1216*  I.B.N.R. - A/H ONLY                                           *
  1217*  FUTURE (ACCRUED) AH ONLY                                      *
  1218*----------------------------------------------------------------*
  1219*  PASSED TO ELRATE                                              *
  1220*  ----------------                                              *
  1221*  CERT ISSUE DATE                                               *
  1222*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1223*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1224*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1225*  STATE CODE (CLIENT DEFINED)                                   *
  1226*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1227*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1228*  DEVIATION CODE                                                *
  1229*  ISSUE AGE                                                     *
  1230*  ORIGINAL BENEFIT AMOUNT                                       *
  1231*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1232*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1233*  BENEFIT KIND (LIFE OR A/H)                                    *
  1234*  A.P.R.                                                        *
  1235*  METHOD
  1236*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1237*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1238*  COMPANY I.D. (3 CHARACTER)                                    *
  1239*  BENEFIT CODE                                                  *
  1240*  BENEFIT OVERRIDE CODE                                         *
  1241*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1242*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1243*  JOINT INDICATOR (CSL ONLY)                                    *
  1244*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1245*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1246*                                                                *
  1247*  RETURNED FROM ELRATE                                          *
  1248*  --------------------                                          *
  1249*  CALCULATED PREMIUM                                            *
  1250*  PREMIUM RATE                                                  *
  1251*  MORTALITY CODE                                                *
  1252*  MAX ATTAINED AGE                                              *
  1253*  MAX AGE                                                       *
  1254*  MAX TERM                                                      *
  1255*  MAX MONTHLY BENEFIT                                           *
  1256*  MAX TOTAL BENIFIT                                             *
  1257*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1258*----------------------------------------------------------------*
  1259*  PASSED TO ELRFND                                              *
  1260*  ----------------                                              *
  1261*  CERT ISSUE DATE                                               *
  1262*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  25
* EL156.cbl
  1263*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1264*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1265*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1266*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1267*  STATE CODE (CLIENT DEFINED)                                   *
  1268*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1269*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1270*  DEVIATION CODE                                                *
  1271*  ISSUE AGE                                                     *
  1272*  ORIGINAL BENEFIT AMOUNT                                       *
  1273*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1274*  PROCESS TYPE (CANCEL)                                         *
  1275*  BENEFIT KIND (LIFE OR A/H)                                    *
  1276*  A.P.R.                                                        *
  1277*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1278*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1279*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1280*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1281*  COMPANY I.D. (3 CHARACTER)                                    *
  1282*  BENEFIT CODE                                                  *
  1283*  BENEFIT OVERRIDE CODE                                         *
  1284*                                                                *
  1285*  RETURNED FROM ELRFND                                          *
  1286*  --------------------                                          *
  1287*  CALCULATED REFUND                                             *
  1288*----------------------------------------------------------------*
  1289*  PASSED TO ELEARN                                              *
  1290*  ----------------                                              *
  1291*  CERT ISSUE DATE                                               *
  1292*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1293*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1294*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1295*  STATE CODE (CLIENT DEFINED)                                   *
  1296*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1297*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1298*  DEVIATION CODE                                                *
  1299*  ISSUE AGE                                                     *
  1300*  ORIGINAL BENEFIT AMOUNT                                       *
  1301*  BENEFIT KIND (LIFE OR A/H)                                    *
  1302*  A.P.R.                                                        *
  1303*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1304*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1305*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1306*  COMPANY I.D. (3 CHARACTER)                                    *
  1307*  BENEFIT CODE                                                  *
  1308*  BENEFIT OVERRIDE CODE                                         *
  1309*                                                                *
  1310*  RETURNED FROM ELEARN                                          *
  1311*  --------------------                                          *
  1312*  INDICATED  EARNINGS                                           *
  1313*----------------------------------------------------------------*
  1314*                 LENGTH = 450                                   *
  1315*                                                                *
  1316******************************************************************
  1317******************************************************************
  1318*                   C H A N G E   L O G
  1319*
  1320* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  26
* EL156.cbl
  1321*-----------------------------------------------------------------
  1322*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1323* EFFECTIVE    NUMBER
  1324*-----------------------------------------------------------------
  1325* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1326* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1327* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1328* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1329* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1330* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1331* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1332* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1333* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1334* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1335* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1336******************************************************************
  1337
  1338 01  CALCULATION-PASS-AREA.
  1339     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1340                                     COMP.
  1341
  1342     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1343       88  NO-CP-ERROR                             VALUE ZERO.
  1344       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1345                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1346       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1347       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1348       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1349       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1350       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1351       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1352       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1353       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1354       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1355       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1356       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1357       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1358       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1359       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1360       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1361       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1362       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1363
  1364     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1365       88  NO-CP-ERROR-2                           VALUE ZERO.
  1366***********************  INPUT AREAS ****************************
  1367
  1368     12  CP-CALCULATION-AREA.
  1369         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1370         16  CP-CERT-EFF-DT        PIC XX.
  1371         16  CP-VALUATION-DT       PIC XX.
  1372         16  CP-PAID-THRU-DT       PIC XX.
  1373         16  CP-BENEFIT-TYPE       PIC X.
  1374           88  CP-AH                               VALUE 'A' 'D'
  1375                                                   'I' 'U'.
  1376           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1377           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1378         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  27
* EL156.cbl
  1379         16  CP-REPORTED-DT        PIC XX.
  1380         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1381         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1382         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1383                                     COMP-3.
  1384         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1385                                     COMP-3.
  1386         16  CP-CDT-METHOD         PIC X.
  1387           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1388           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1389           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1390         16  CP-CLAIM-TYPE         PIC X.
  1391           88  CP-AH-CLAIM                         VALUE 'A'.
  1392           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1393         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1394                                     COMP-3.
  1395         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1396                                     COMP-3.
  1397         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1398                                     COMP-3.
  1399         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1400                                     COMP-3.
  1401         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1402                                     COMP-3.
  1403         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1404                                     COMP-3.
  1405         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1406                                     COMP-3.
  1407         16  CP-REM-TERM-METHOD    PIC X.
  1408           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1409           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1410           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1411           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1412           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1413           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1414           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1415         16  CP-EARNING-METHOD     PIC X.
  1416           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1417           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1418           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1419           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1420           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1421           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1422           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1423           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1424           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1425           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1426           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1427           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1428           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1429           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1430         16  CP-PROCESS-TYPE       PIC X.
  1431           88  CP-CLAIM                            VALUE '1'.
  1432           88  CP-CANCEL                           VALUE '2'.
  1433           88  CP-ISSUE                            VALUE '3'.
  1434         16  CP-SPECIAL-CALC-CD    PIC X.
  1435           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1436           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  28
* EL156.cbl
  1437           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1438           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1439           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1440           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1441           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1442           88  CP-FARM-PLAN                    VALUE 'F'.
  1443           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1444           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1445           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1446           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1447           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1448           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1449           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1450           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1451           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1452           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1453                                                     'W' 'X'.
  1454           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1455           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1456           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1457           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1458           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1459           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1460           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1461           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1462           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1463           88  CP-CSL-METH-1                   VALUE '5'.
  1464           88  CP-CSL-METH-2                   VALUE '6'.
  1465           88  CP-CSL-METH-3                   VALUE '7'.
  1466           88  CP-CSL-METH-4                   VALUE '8'.
  1467
  1468         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1469                                     COMP-3.
  1470         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1471         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1472         16  CP-STATE              PIC XX          VALUE SPACE.
  1473         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1474         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1475           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1476               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1477         16  CP-R78-OPTION         PIC X.
  1478           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1479           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1480
  1481         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1482         16  CP-IBNR-RESERVE-SW    PIC X.
  1483         16  CP-CLAIM-STATUS       PIC X.
  1484         16  CP-RATE-FILE          PIC X.
  1485         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1486                                     COMP-3.
  1487
  1488         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1489         16  CP-AH-OVERRIDE-CODE   PIC X.
  1490
  1491         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1492                                     COMP-3.
  1493         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1494                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  29
* EL156.cbl
  1495         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1496                                     COMP-3.
  1497         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1498                                     COMP-3.
  1499         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1500                                     COMP-3.
  1501         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1502                                  PIC S9(7)V99 COMP-3.
  1503
  1504         16  CP-PAID-FROM-DATE     PIC X(02).
  1505         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1506         16  CP-EXT-DAYS-CALC      PIC X.
  1507           88  CP-EXT-NO-CHG                   VALUE ' '.
  1508           88  CP-EXT-CHG-LF                   VALUE '1'.
  1509           88  CP-EXT-CHG-AH                   VALUE '2'.
  1510           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1511         16  CP-DOMICILE-STATE     PIC XX.
  1512         16  CP-CARRIER            PIC X.
  1513         16  CP-REIN-FLAG          PIC X.
  1514         16  CP-REM-TRM-CALC-OPTION PIC X.
  1515           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1516                      '2' '3' '4' '5'.
  1517           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1518           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1519           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1520           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1521           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1522           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1523           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1524           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1525         16  CP-SIG-SWITCH         PIC X.
  1526         16  CP-RATING-METHOD      PIC X.
  1527           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1528           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1529           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1530           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1531           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1532           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1533           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1534           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1535           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1536         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1537                                     COMP-3.
  1538         16  CP-BEN-CATEGORY       PIC X.
  1539         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1540         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1541                                   PIC S99V9(5) COMP-3.
  1542         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1543         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1544                                   PIC S99V9(5) COMP-3.
  1545         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1546         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1547         16  CP-EXPIRE-DT          PIC XX.
  1548         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1549         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1550         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1551         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1552         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  30
* EL156.cbl
  1553             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1554             88  CP-CALC-CLP              VALUE 'C'.
  1555         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1556         16  CP-CANCEL-REASON      PIC X.
  1557         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1558         16  CP-PMT-MODE           PIC X.
  1559         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1560         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1561         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1562         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1563         16  FILLER                PIC X.
  1564
  1565***************    OUTPUT FROM ELRESV   ************************
  1566
  1567         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1568
  1569         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1570                                     COMP-3.
  1571         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1572                                     COMP-3.
  1573         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1574                                     COMP-3.
  1575         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1576                                     COMP-3.
  1577         16  FILLER                PIC X(09).
  1578***************    OUTPUT FROM ELRTRM   *************************
  1579
  1580         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1581                                     COMP-3.
  1582         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1583                                     COMP-3.
  1584         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1585                                     COMP-3.
  1586         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1587                                     COMP-3.
  1588         16  FILLER                PIC X(12).
  1589
  1590***************    OUTPUT FROM ELRAMT   *************************
  1591
  1592         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1593                                     COMP-3.
  1594         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1595                                     COMP-3.
  1596         16  FILLER                PIC X(12).
  1597
  1598***************    OUTPUT FROM ELRATE   *************************
  1599
  1600         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1601                                     COMP-3.
  1602         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1603                                     COMP-3.
  1604         16  CP-MORTALITY-CODE     PIC X(4).
  1605         16  CP-RATE-EDIT-FLAG     PIC X.
  1606             88  CP-RATES-NEED-APR                  VALUE '1'.
  1607         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1608                                     COMP-3.
  1609         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1610         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  31
* EL156.cbl
  1611         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1612                                   PIC S9(7)V99 COMP-3.
  1613         16  FILLER                PIC X(07).
  1614
  1615***************    OUTPUT FROM ELRFND   *************************
  1616
  1617         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1618                                     COMP-3.
  1619         16  CP-REFUND-TYPE-USED   PIC X.
  1620           88  CP-R-AS-R78                         VALUE '1'.
  1621           88  CP-R-AS-PRORATA                     VALUE '2'.
  1622           88  CP-R-AS-CALIF                       VALUE '3'.
  1623           88  CP-R-AS-TEXAS                       VALUE '4'.
  1624           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1625           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1626           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1627           88  CP-R-AS-MEAN                        VALUE '8'.
  1628           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1629           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1630           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1631           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1632           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1633           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1634         16  FILLER                PIC X(12).
  1635
  1636***************    OUTPUT FROM ELEARN   *************************
  1637
  1638         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1639                                     COMP-3.
  1640         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1641                                     COMP-3.
  1642         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1643                                     COMP-3.
  1644         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1645                                     COMP-3.
  1646         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1647                                     COMP-3.
  1648         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1649                                     COMP-3.
  1650         16  CP-EARNING-TYPE-USED  PIC X.
  1651           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1652           88  CP-E-AS-R78                         VALUE '1'.
  1653           88  CP-E-AS-PRORATA                     VALUE '2'.
  1654           88  CP-E-AS-TEXAS                       VALUE '4'.
  1655           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1656           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1657           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1658           88  CP-E-AS-MEAN                        VALUE '8'.
  1659           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1660         16  FILLER                PIC X(12).
  1661
  1662***************    OUTPUT FROM ELPMNT   *************************
  1663
  1664         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1665                                     COMP-3.
  1666         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1667                                     COMP-3.
  1668         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  32
* EL156.cbl
  1669
  1670***************   MISC WORK AREAS    *****************************
  1671         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1672                                     COMP-3.
  1673         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1674                                     COMP-3.
  1675         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1676                                     COMP-3.
  1677         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1678                                     COMP-3.
  1679         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1680                                     COMP-3.
  1681         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1682                                     COMP-3.
  1683         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1684             88  OPEN-RATE-FILE                   VALUE 'O'.
  1685             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1686             88  IO-ERROR                         VALUE 'E'.
  1687
  1688         16  CP-FIRST-PAY-DATE     PIC XX.
  1689
  1690         16  CP-JOINT-INDICATOR    PIC X.
  1691
  1692         16  CP-RESERVE-REMAINING-TERM
  1693                                   PIC S9(4)V9    VALUE ZERO
  1694                                     COMP-3.
  1695
  1696         16  CP-INSURED-BIRTH-DT   PIC XX.
  1697
  1698         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1699                                     COMP-3.
  1700
  1701         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1702                                     COMP-3.
  1703
  1704         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1705                                     COMP-3.
  1706
  1707         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1708                                     COMP-3.
  1709
  1710         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1711                                     COMP-3.
  1712
  1713         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1714                                     COMP-3.
  1715
  1716         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1717                                     COMP-3.
  1718
  1719         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1720             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1721
  1722         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1723                                     COMP-3.
  1724         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1725                                     COMP-3.
  1726         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  33
* EL156.cbl
  1727         16  cp-extra-periods      pic 9 value zeros.
  1728         16  cp-net-only-state     pic x value spaces.
  1729         16  FILLER                PIC X(13).
  1730******************************************************************
  1731*    COPY ELCICALC.
  1732******************************************************************
  1733*                                                                *
  1734*                           ELCCICALC.                           *
  1735*                            VMOD=2.001                          *
  1736*                                                                *
  1737*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1738*                 CALCULATION MODULE                             *
  1739*                                                                *
  1740*  PASSED TO ELCLMI                                              *
  1741*  -----------------                                             *
  1742*  STATE                                                         *
  1743*  PRODUCT                                                       *
  1744*  COVERAGE                                                      *
  1745*  EFFECTIVE DATE                                                *
  1746*  INCURRED DATE                                                 *
  1747*  ESTABLISHED DATE                                              *
  1748*  LAST PAID DATE                                                *
  1749*  REPORTED DATE                                                 *
  1750*  CLAIM PAYMENT AMOUNT                                          *
  1751*                                                                *
  1752*  RETURNED FROM ELRTRM                                          *
  1753*  ---------------------                                         *
  1754*  RETURN CODE                                                   *
  1755*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1756*  CLAIM INTEREST AMOUNT                                         *
  1757*----------------------------------------------------------------*
  1758*----------------------------------------------------------------*
  1759*                 LENGTH = 100                                   *
  1760*                                                                *
  1761******************************************************************
  1762******************************************************************
  1763*                   C H A N G E   L O G
  1764*
  1765* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1766*-----------------------------------------------------------------
  1767*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1768* EFFECTIVE    NUMBER
  1769*-----------------------------------------------------------------
  1770* 120905    2004040700004  PEMA  NEW COPYBOOK
  1771* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1772******************************************************************
  1773
  1774 01  CLAIM-INT-PASS-AREA.
  1775     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1776                                     COMP.
  1777
  1778     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1779       88  NO-CI-ERROR                             VALUE ZERO.
  1780       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1781       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1782       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1783       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1784       88  CP-AMT-LT-5000                          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  34
* EL156.cbl
  1785       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1786       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1787       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1788       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1789***********************  INPUT AREAS ****************************
  1790
  1791     12  CP-CALCULATION-AREA.
  1792         16  CP-COMPANY-CD         PIC X.
  1793         16  CP-STATE              PIC XX.
  1794         16  CP-PRODUCT            PIC XX.
  1795         16  CP-COVERAGE           PIC XX.
  1796         16  CP-INC-DT             PIC XX.
  1797         16  CP-EST-DT             PIC XX.
  1798         16  CP-LSTPD-DT           PIC XX.
  1799         16  CP-RPT-DT             PIC XX.
  1800         16  CP-PRF-DT             PIC XX.
  1801         16  CP-EFF-DT             PIC XX.
  1802         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1803         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1804         16  FILLER                PIC X(37).
  1805
  1806***************    OUTPUT FROM ELCLMI   ************************
  1807
  1808         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1809
  1810         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1811         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1812         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1813         16  FILLER                PIC X(19).
  1814******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  35
* EL156.cbl
  1816*    COPY ELCATTR.
  1817******************************************************************
  1818*                                                                *
  1819*                            ELCATTR.                            *
  1820*                            VMOD=2.001                          *
  1821*                                                                *
  1822*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1823*                                                                *
  1824*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1825*                                                                *
  1826*                   POS 1   P=PROTECTED                          *
  1827*                           U=UNPROTECTED                        *
  1828*                           S=ASKIP                              *
  1829*                   POS 2   A=ALPHA/NUMERIC                      *
  1830*                           N=NUMERIC                            *
  1831*                   POS 3   N=NORMAL                             *
  1832*                           B=BRIGHT                             *
  1833*                           D=DARK                               *
  1834*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1835*                           OF=MODIFIED DATA TAG OFF             *
  1836*                                                                *
  1837*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1838******************************************************************
  1839 01  ATTRIBUTE-LIST.
  1840     12  AL-PABOF            PIC X       VALUE 'Y'.
  1841     12  AL-PABON            PIC X       VALUE 'Z'.
  1842     12  AL-PADOF            PIC X       VALUE '%'.
  1843     12  AL-PADON            PIC X       VALUE '_'.
  1844     12  AL-PANOF            PIC X       VALUE '-'.
  1845     12  AL-PANON            PIC X       VALUE '/'.
  1846     12  AL-SABOF            PIC X       VALUE '8'.
  1847     12  AL-SABON            PIC X       VALUE '9'.
  1848     12  AL-SADOF            PIC X       VALUE '@'.
  1849     12  AL-SADON            PIC X       VALUE QUOTE.
  1850     12  AL-SANOF            PIC X       VALUE '0'.
  1851     12  AL-SANON            PIC X       VALUE '1'.
  1852     12  AL-UABOF            PIC X       VALUE 'H'.
  1853     12  AL-UABON            PIC X       VALUE 'I'.
  1854     12  AL-UADOF            PIC X       VALUE '<'.
  1855     12  AL-UADON            PIC X       VALUE '('.
  1856     12  AL-UANOF            PIC X       VALUE ' '.
  1857     12  AL-UANON            PIC X       VALUE 'A'.
  1858     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1859     12  AL-UNBON            PIC X       VALUE 'R'.
  1860     12  AL-UNDOF            PIC X       VALUE '*'.
  1861     12  AL-UNDON            PIC X       VALUE ')'.
  1862     12  AL-UNNOF            PIC X       VALUE '&'.
  1863     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  36
* EL156.cbl
  1865*    COPY ELCEMIB.
  1866******************************************************************
  1867*                                                                *
  1868*                                                                *
  1869*                            ELCEMIB.                            *
  1870*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1871*                            VMOD=2.005                          *
  1872*                                                                *
  1873*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1874*                                                                *
  1875******************************************************************
  1876 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1877     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1878     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1879     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1880     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1881     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1882     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1883     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1884     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1885     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1886         88  EMI-NO-ERRORS                    VALUE '1'.
  1887         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1888         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1889     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1890         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1891     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1892         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1893         88  EMI-AREA1-FULL                   VALUE '2'.
  1894     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1895         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1896         88  EMI-AREA2-FULL                   VALUE '2'.
  1897     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1898         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1899         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1900         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1901         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1902         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1903     12  EMI-ERROR-LINES.
  1904         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1905         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1906         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1907         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1908             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1909                 24  EMI-ERR-NUM         PIC X(4).
  1910                 24  EMI-FILLER          PIC X.
  1911                 24  EMI-SEV             PIC X.
  1912                 24  FILLER              PIC X.
  1913             20  FILLER                  PIC X(02).
  1914     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1915         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1916             20  EMI-ERROR-NUMBER    PIC X(4).
  1917             20  EMI-FILL            PIC X.
  1918             20  EMI-SEVERITY        PIC X.
  1919             20  FILLER              PIC X.
  1920             20  EMI-ERROR-TEXT.
  1921                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1922                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  37
* EL156.cbl
  1923     12  EMI-SEVERITY-SAVE           PIC X.
  1924         88  EMI-NOTE                    VALUE 'N'.
  1925         88  EMI-WARNING                 VALUE 'W'.
  1926         88  EMI-FORCABLE                VALUE 'F'.
  1927         88  EMI-FATAL                   VALUE 'X'.
  1928     12  EMI-MESSAGE-FLAG            PIC X.
  1929         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1930         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1931     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1932     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1933         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1934         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1935         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1936     12  emi-claim-no                pic x(7).
  1937     12  emi-claim-type              pic x(6).
  1938     12  FILLER                      PIC X(124)  VALUE SPACES.
  1939     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1940     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1941     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1942     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  38
* EL156.cbl
  1944*    COPY ELCLNKLT.
  1945******************************************************************
  1946*                                                                *
  1947*                                                                *
  1948*                           ELCLNKLT                             *
  1949*                            VMOD=2.003                          *
  1950*                                                                *
  1951*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1952*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1953*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1954*                                                                *
  1955*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1956*   COMPLETING THE REQUIRED FIELDS.                              *
  1957*                                                                *
  1958*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1959*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1960*                              9999 INDICATES AN UNKNOWN ABEND   *
  1961*                                   WAS DETECTED.                *
  1962*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1963*                              CODES FOUND IN THE ERROR FILE.    *
  1964******************************************************************
  1965 01  W-1523-LINKDATA.
  1966     12  W-1523-COMMON-PI-DATA.
  1967         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1968         16  FILLER              PIC  X(67).
  1969         16  W-1523-COMPANY-CD   PIC  X(01).
  1970         16  FILLER              PIC  X(10).
  1971         16  W-1523-CONTROL-IN-PROGRESS.
  1972             20  W-1523-CARRIER  PIC  X(01).
  1973             20  W-1523-GROUPING PIC  X(06).
  1974             20  W-1523-STATE    PIC  X(02).
  1975             20  W-1523-ACCOUNT  PIC  X(10).
  1976             20  W-1523-CLAIM-CERT-GRP.
  1977                 24  W-1523-CLAIM-NO
  1978                                 PIC  X(07).
  1979                 24  W-1523-CERT-NO.
  1980                     28  W-1523-CERT-PRIME
  1981                                 PIC  X(10).
  1982                     28  W-1523-CERT-SFX
  1983                                 PIC  X(01).
  1984                 24  W-1523-CERT-EFF-DT
  1985                                 PIC  X(02).
  1986         16  FILLER              PIC X(265).
  1987
  1988     12  W-1523-WORK-AREA.
  1989         16  W-1523-FORM-NUMBER  PIC  X(04).
  1990         16  W-1523-NUMBER-COPIES
  1991                                 PIC  9(01).
  1992         16  W-1523-ADDR-TYPE    PIC  X(02).
  1993         16  W-1523-FOLLOW-UP-DATE
  1994                                 PIC  X(02).
  1995         16  W-1523-RESEND-DATE  PIC  X(02).
  1996         16  W-1523-ERROR-CODE   PIC  9(04).
  1997             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1998             88  W-1523-FATAL-ERROR
  1999                                    VALUES  0006 0013 0042
  2000                                            0154 0168 0169
  2001                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  39
* EL156.cbl
  2002                                            0179 0186 0281
  2003                                            0332 2055 3697
  2004                                            3698 3699 3770
  2005                                            3771 3772 7675
  2006                                            9106 9808 9883
  2007                                            9887.
  2008             88  W-1523-STOP-ERRORS
  2009                                    VALUES  0013 0042 0154
  2010                                            0168 0169 0172
  2011                                            0281 0332 2055
  2012                                            3698 3699 7675
  2013                                            9106 9808 9883
  2014                                            9999.
  2015         16  W-1523-REASON       PIC  X(70).
  2016         16  W-1523-ARCHIVE-NUMBER
  2017                                 PIC  9(08).
  2018     12  W-1523-POINTER-AREA.
  2019         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2020         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2021         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2022         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2023         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  40
* EL156.cbl
  2025*    COPY ELCNWA.
  2026*****************************************************************
  2027*                                                               *
  2028*                                                               *
  2029*                            ELCNWA.                            *
  2030*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2031*                            VMOD=2.003                         *
  2032*                                                               *
  2033*            M O V E   N A M E   W O R K   A R E A.             *
  2034*                                                               *
  2035*****************************************************************.
  2036
  2037 01  WS-NAME-WORK-AREA.
  2038     05  WS-INSURED-LAST-NAME        PIC X(15).
  2039     05  WS-INSURED-1ST-NAME         PIC X(12).
  2040     05  WS-INSURED-MID-INIT         PIC X.
  2041
  2042     05  WS-NAME-WORK.
  2043         10  WS-NW                   PIC X
  2044             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2045
  2046     05  WS-NAME-WORK2.
  2047         10  WS-NW2                  PIC X
  2048             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2049                                        NWA-INDEX0.
  2050
  2051     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2052                                     COMP-3.
  2053
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  41
* EL156.cbl
  2055*    COPY ELCDMO.
  2056******************************************************************
  2057*                                                                *
  2058*                                                                *
  2059*                            ELCDMO.                             *
  2060*                            VMOD=2.004                          *
  2061*                                                                *
  2062*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2063*        COMMUNICATION AREA                                      *
  2064*   FILE TYPE = NA                                               *
  2065*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2066*                                                                *
  2067******************************************************************
  2068 01  DMO-COMMUNICATION-AREA.
  2069     12  DM-RECORD-TYPE                  PIC  X(02).
  2070             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2071             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2072             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2073     12  DM-DIST-CODE                    PIC  X(04).
  2074     12  DM-MAIL-CODE                    PIC  X(05).
  2075     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2076     12  DM-INSURED-NAME                 PIC  X(30).
  2077     12  DM-CLAIM-NO                     PIC  X(07).
  2078     12  DM-CLAIM-TYPE                   PIC  X.
  2079
  2080     12  DM-STATUS-DATA-AREA.
  2081         16  DM-CLAIM-STATUS             PIC  X.
  2082             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2083             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2084             88  DM-CLOSED                        VALUE '3'.
  2085             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2086             88  DM-DEFAULT                       VALUE '9'.
  2087         16  DM-STATUS-DATE              PIC  X(08).
  2088******YYYYMMDD
  2089         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2090             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2091             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2092             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2093             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2094             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2095             88  DM-RE-OPENED                     VALUE 'R'.
  2096             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2097             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2098             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2099         16  DM-STAT-CARRIER             PIC X.
  2100
  2101     12  DM-DRAFT-DATA-AREA.
  2102         16  DM-PAYMENT-TYPE             PIC  X.
  2103             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2104         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2105         16  DM-PAYMENT-DATE             PIC  X(08).
  2106******YYYYMMDD
  2107         16  DM-CERT-NO                  PIC  X(11).
  2108         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2109         16  DM-CARRIER                  PIC  X.
  2110
  2111     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  42
* EL156.cbl
  2113*    COPY ELCDMDCD.
  2114******************************************************************
  2115*                                                                *
  2116*                                                                *
  2117*                            ELCDMDCD.                           *
  2118*                            VMOD=2.001                          *
  2119*                                                                *
  2120*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2121*       COMMUNICATIONS AREA                                      *
  2122*                                                                *
  2123******************************************************************
  2124 01  CD-COMMUNICATION-AREA.
  2125     12  CD-SYSTEM-ID            PIC  X(02).
  2126         88 CD-CLAIMS                      VALUE 'CL'.
  2127         88 CD-CREDIT                      VALUE 'CR'.
  2128     12  CD-RECORD-TYPE          PIC  X(02).
  2129         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2130         88 CD-EOB-CODE                    VALUE 'EO'.
  2131         88 CD-ICD9-CODE                   VALUE 'I9'.
  2132         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2133         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2134         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2135         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2136         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2137     12  CD-RECORD-KEY           PIC  X(06).
  2138         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2139     12  CD-RETURN-CODE          PIC  X(02).
  2140     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2141     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2142     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2143     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  43
* EL156.cbl
  2145*    COPY ELCDCTB.
  2146******************************************************************
  2147*                                                                *
  2148*                                                                *
  2149*                            ELCDCTB.                            *
  2150*                            VMOD=2.002                          *
  2151*                                                                *
  2152*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2153*       COMMUNICATIONS AREA                                      *
  2154*                                                                *
  2155******************************************************************
  2156 01  DCT-COMMUNICATION-AREA.
  2157     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2158     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2159     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2160     12  DCT-PRODUCT-CODE         PIC  X(02).
  2161     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2162     12  DCT-RETURN-CODE          PIC  X(02).
  2163     12  DCT-MAIL-CODE            PIC  X(05).
  2164     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2165     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  44
* EL156.cbl
  2167 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2168 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2169 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2170 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  45
* EL156.cbl
  2172*    COPY ELCINTF.
  2173******************************************************************
  2174*                                                                *
  2175*                                                                *
  2176*                            ELCINTF.                            *
  2177*                            VMOD=2.017                          *
  2178*                                                                *
  2179*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2180*                                                                *
  2181*       LENGTH = 1024                                            *
  2182*                                                                *
  2183******************************************************************
  2184*                   C H A N G E   L O G
  2185*
  2186* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2187*-----------------------------------------------------------------
  2188*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2189* EFFECTIVE    NUMBER
  2190*-----------------------------------------------------------------
  2191* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2192******************************************************************
  2193 01  PROGRAM-INTERFACE-BLOCK.
  2194     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2195     12  PI-CALLING-PROGRAM              PIC X(8).
  2196     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2197     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2198     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2199     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2200     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2201     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2202     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2203     12  PI-COMPANY-ID                   PIC XXX.
  2204     12  PI-COMPANY-CD                   PIC X.
  2205
  2206     12  PI-COMPANY-PASSWORD             PIC X(8).
  2207
  2208     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2209
  2210     12  PI-CONTROL-IN-PROGRESS.
  2211         16  PI-CARRIER                  PIC X.
  2212         16  PI-GROUPING                 PIC X(6).
  2213         16  PI-STATE                    PIC XX.
  2214         16  PI-ACCOUNT                  PIC X(10).
  2215         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2216                                         PIC X(10).
  2217         16  PI-CLAIM-CERT-GRP.
  2218             20  PI-CLAIM-NO             PIC X(7).
  2219             20  PI-CERT-NO.
  2220                 25  PI-CERT-PRIME       PIC X(10).
  2221                 25  PI-CERT-SFX         PIC X.
  2222             20  PI-CERT-EFF-DT          PIC XX.
  2223         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2224             20  PI-PLAN-CODE            PIC X(2).
  2225             20  PI-REVISION-NUMBER      PIC X(3).
  2226             20  PI-PLAN-EFF-DT          PIC X(2).
  2227             20  PI-PLAN-EXP-DT          PIC X(2).
  2228             20  FILLER                  PIC X(11).
  2229         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  46
* EL156.cbl
  2230             20  PI-OE-REFERENCE-1.
  2231                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2232                 25  PI-OE-REF-1-SUFF    PIC XX.
  2233
  2234     12  PI-SESSION-IN-PROGRESS          PIC X.
  2235         88  CLAIM-SESSION                   VALUE '1'.
  2236         88  CREDIT-SESSION                  VALUE '2'.
  2237         88  WARRANTY-SESSION                VALUE '3'.
  2238         88  MORTGAGE-SESSION                VALUE '4'.
  2239         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2240
  2241
  2242*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2243
  2244     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2245     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2246
  2247     12  PI-CREDIT-USER                  PIC X.
  2248         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2249         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2250
  2251     12  PI-CLAIM-USER                   PIC X.
  2252         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2253         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2254
  2255     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2256         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2257         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2258         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2259         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2260         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2261
  2262     12  PI-PROCESSOR-ID                 PIC X(4).
  2263
  2264     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2265
  2266     12  PI-MEMBER-CAPTION               PIC X(10).
  2267
  2268     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2269         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2270
  2271     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2272     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2273     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2274     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2275
  2276     12  PI-AH-OVERRIDE-L1               PIC X.
  2277     12  PI-AH-OVERRIDE-L2               PIC XX.
  2278     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2279     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2280
  2281     12  PI-NEW-SYSTEM                   PIC X(2).
  2282
  2283     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2284     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2285         88  PI-USES-PAID-TO                 VALUE '1'.
  2286     12  PI-CRDTCRD-SYSTEM.
  2287         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  47
* EL156.cbl
  2288             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2289             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2290         16  PI-CC-MONTH-END-DT          PIC XX.
  2291     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2292
  2293     12  PI-OE-REFERENCE-2.
  2294         16  PI-OE-REF-2-PRIME           PIC X(10).
  2295         16  PI-OE-REF-2-SUFF            PIC X.
  2296
  2297     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2298
  2299     12  PI-LANGUAGE-TYPE                PIC X.
  2300             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2301             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2302             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2303
  2304     12  PI-POLICY-LINKAGE-IND           PIC X.
  2305         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2306         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2307                                                   LOW-VALUES.
  2308
  2309     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2310     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2311         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2312         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2313
  2314     12  PI-PROCESSOR-CSR-IND            PIC X.
  2315         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2316         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2317
  2318     12  FILLER                          PIC X(3).
  2319
  2320     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2321
  2322     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2323         PI-SYSTEM-LEVEL.
  2324
  2325         16  PI-ENTRY-CODES.
  2326             20  PI-ENTRY-CD-1           PIC X.
  2327             20  PI-ENTRY-CD-2           PIC X.
  2328
  2329         16  PI-RETURN-CODES.
  2330             20  PI-RETURN-CD-1          PIC X.
  2331             20  PI-RETURN-CD-2          PIC X.
  2332
  2333         16  PI-UPDATE-STATUS-SAVE.
  2334             20  PI-UPDATE-BY            PIC X(4).
  2335             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2336
  2337         16  PI-LOWER-CASE-LETTERS       PIC X.
  2338             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2339
  2340*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2341*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2342*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2343
  2344         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2345             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  48
* EL156.cbl
  2346             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2347             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2348             88  ACCNT-CNTL                  VALUE '3'.
  2349             88  CARR-ACCNT-CNTL             VALUE '4'.
  2350
  2351         16  PI-PROCESSOR-CAP-LIST.
  2352             20  PI-SYSTEM-CONTROLS.
  2353                24 PI-SYSTEM-DISPLAY     PIC X.
  2354                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2355                24 PI-SYSTEM-MODIFY      PIC X.
  2356                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2357             20  FILLER                  PIC XX.
  2358             20  PI-DISPLAY-CAP          PIC X.
  2359                 88  DISPLAY-CAP             VALUE 'Y'.
  2360             20  PI-MODIFY-CAP           PIC X.
  2361                 88  MODIFY-CAP              VALUE 'Y'.
  2362             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2363                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2364             20  PI-FORCE-CAP            PIC X.
  2365                 88  FORCE-CAP               VALUE 'Y'.
  2366
  2367         16  PI-PROGRAM-CONTROLS.
  2368             20  PI-PGM-PRINT-OPT        PIC X.
  2369             20  PI-PGM-FORMAT-OPT       PIC X.
  2370             20  PI-PGM-PROCESS-OPT      PIC X.
  2371             20  PI-PGM-TOTALS-OPT       PIC X.
  2372
  2373         16  PI-HELP-INTERFACE.
  2374             20  PI-LAST-ERROR-NO        PIC X(4).
  2375             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2376
  2377         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2378             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2379
  2380         16  PI-CR-CONTROL-IN-PROGRESS.
  2381             20  PI-CR-CARRIER           PIC X.
  2382             20  PI-CR-GROUPING          PIC X(6).
  2383             20  PI-CR-STATE             PIC XX.
  2384             20  PI-CR-ACCOUNT           PIC X(10).
  2385             20  PI-CR-FIN-RESP          PIC X(10).
  2386             20  PI-CR-TYPE              PIC X.
  2387
  2388         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2389
  2390         16  PI-CR-MONTH-END-DT          PIC XX.
  2391
  2392         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2393             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2394             88  PI-ZERO-CARRIER             VALUE '1'.
  2395             88  PI-ZERO-GROUPING            VALUE '2'.
  2396             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2397
  2398         16  PI-CARRIER-SECURITY         PIC X.
  2399             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2400
  2401         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2402             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2403             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  49
* EL156.cbl
  2404
  2405         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2406             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2407                                         INDEXED BY PI-ACCESS-NDX
  2408                                         PIC X.
  2409
  2410         16  PI-GA-BILLING-CONTROL       PIC X.
  2411             88  PI-GA-BILLING               VALUE '1'.
  2412
  2413         16  PI-MAIL-PROCESSING          PIC X.
  2414             88  PI-MAIL-YES                 VALUE 'Y'.
  2415
  2416         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2417
  2418         16  PI-AR-SYSTEM.
  2419             20  PI-AR-PROCESSING-CNTL   PIC X.
  2420                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2421             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2422             20  PI-AR-MONTH-END-DT      PIC XX.
  2423
  2424         16  PI-MP-SYSTEM.
  2425             20  PI-MORTGAGE-USER            PIC X.
  2426                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2427                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2428             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2429                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2430                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2431                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2432                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2433                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2434             20  PI-MP-MONTH-END-DT          PIC XX.
  2435             20  PI-MP-REFERENCE-NO.
  2436                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2437                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2438
  2439         16  PI-LABEL-CONTROL            PIC X(01).
  2440             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2441             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2442
  2443         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2444             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2445
  2446         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2447             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2448             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2449
  2450         16  FILLER                      PIC X(14).
  2451
  2452     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2453******************************************************************
  2454     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2455         16  PI-SAVE-FORM        PIC X(12).
  2456         16  PI-ACCT-KEY         PIC X(26).
  2457         16  PI-PAYEE-NAME       PIC X(30).
  2458         16  PI-DAILY-RATE       PIC S9(3)V99.
  2459         16  PI-MONTH-END-SAVE   PIC XX.
  2460         16  PI-BENEFIT-SAVE.
  2461             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  50
* EL156.cbl
  2462             20  PI-BEN-TYPE     PIC X.
  2463         16  PI-MANUAL-SW        PIC 9.
  2464         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2465         16  PI-PASS-SW          PIC X.
  2466         16  PI-PFKEY-USED       PIC X.
  2467         16  PI-CK-ASSIGN        PIC X.
  2468         16  PI-FATAL-COUNT      PIC 99.
  2469         16  PI-FORCE-COUNT      PIC 99.
  2470         16  PI-SAVE-INPUT.
  2471             20  PI-PMTTYPE      PIC X.
  2472             20  PI-PAYEE.
  2473                 24  PI-PAYEE-TYPE PIC X.
  2474                 24  PI-PAYEE-SEQ  PIC X.
  2475                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2476                   PI-PAYEE-SEQ    PIC S9.
  2477             20  PI-PMTNOTE1     PIC X(60).
  2478             20  PI-PMTNOTE2     PIC X(60).
  2479             20  PI-OFFLINE      PIC X.
  2480             20  PI-ECHECKNO     PIC X(7).
  2481             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2482                 28  PI-ECHECKNO-N     PIC X.
  2483                 28  PI-ECHECKNO-6     PIC X(6).
  2484             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2485                 24  PI-ECHECKNO-CR    PIC XX.
  2486                 24  PI-ECHECKNO-5     PIC X(5).
  2487             20  PI-HOLDTIL      PIC 9(6).
  2488             20  PI-EPYFROM      PIC 9(6).
  2489             20  PI-EPYTHRU      PIC 9(6).
  2490             20  PI-EDAYS        PIC S9(5).
  2491             20  PI-EPYAMT       PIC S9(7)V99.
  2492             20  PI-ERESV        PIC S9(7)V99.
  2493             20  PI-EEXPENS      PIC 9(6)V99.
  2494             20  PI-ETYPE        PIC X.
  2495             20  PI-CASH         PIC X.
  2496             20  PI-GROUPED      PIC X.
  2497             20  PI-INT-RATE     PIC S99V9(5).
  2498             20  PI-AIGFROM      PIC 9(6).
  2499             20  PI-LOAN-NO      PIC X(20).
  2500             20  PI-PROOF-DATE   PIC 9(6).
  2501             20  PI-PRINT-EOB-YN PIC X.
  2502             20  PI-PRINT-CLM-FRM-YN PIC X.
  2503             20  PI-PRINT-SURVEY-YN PIC X.
  2504             20  PI-SPECIAL-RELEASE-YN PIC X.
  2505             20  pi-int-to-rem-borr pic x.
  2506         16  PI-SAVE-COMPUTED.
  2507             20  PI-CCHECKNO     PIC X(7).
  2508             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2509                 28  PI-CCHECKNO-N     PIC X.
  2510                 28  PI-CCHECKNO-6     PIC X(6).
  2511             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2512                 24  PI-CCHECKNO-CR    PIC XX.
  2513                 24  PI-CCHECKNO-5     PIC X(5).
  2514             20  PI-CPYFROM      PIC XX.
  2515             20  PI-CPYTHRU      PIC XX.
  2516             20  PI-CDAYS        PIC S9(5).
  2517             20  PI-CPYAMT       PIC S9(7)V99.
  2518             20  PI-CRESV        PIC 9(6)V99.
  2519             20  PI-CEXPENS      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  51
* EL156.cbl
  2520             20  PI-PMT-APPR-SW  PIC X.
  2521                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2522                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2523                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2524         16  PI-PREV-CLMNO       PIC X(7).
  2525         16  PI-LF-COVERAGE-TYPE PIC X.
  2526         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2527         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2528         16  PI-PROVISIONAL-IND  PIC X.
  2529             88 PI-PROV-PMT      VALUE 'P'.
  2530         16  PI-PREV-TRLR-KEY    PIC X(22).
  2531         16  PI-SPLIT-PMT-SW     PIC X.
  2532         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2533         16  PI-ACTIVITY-CODE    PIC 99.
  2534         16  PI-RESET-SW         PIC X.
  2535         16  PI-SPECIAL-BEN-SW   PIC X.
  2536             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2537         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2538         16  PI-EXP-DT           PIC XX.
  2539         16  PI-LOAN-DUE-DAY     PIC 99.
  2540         16  PI-3RD-PARTY-SW     PIC X.
  2541         16  PI-LOAN-UPDATE-SW   PIC X.
  2542
  2543         16  PI-DMD-DATA.
  2544             20  PI-SV-CERT-KEY       PIC X(21).
  2545             20  PI-SV-CERT-NO        PIC X(11).
  2546             20  PI-SV-BEN            PIC X(10).
  2547             20  PI-SV-CCN            PIC X(16).
  2548             20  PI-INTEREST-PAID-IND PIC X.
  2549                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2550             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2551             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2552             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2553             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2554         16  PI-AT-EOB-CODES.
  2555             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2556         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2557         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2558         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2559         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2560         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2561         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2562         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2563         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2564         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2565         16  PI-LF-BENEFIT-CD         PIC X(2).
  2566         16  PI-EOB-CODES-EXIST PIC X.
  2567         16  PI-SET-NOTE2-MDT   PIC X.
  2568         16  PI-VFY-2ND-BENE          PIC X.
  2569         16  PI-CLM-TYPE              PIC X.
  2570         16  PI-APPROVAL-LEVEL        PIC X.
  2571         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2572         16  PI-REAUDIT-NEEDED        PIC X.
  2573         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2574         16  PI-AH-BENEFIT-CD         PIC XX.
  2575         16  pi-ah-term               pic s999 comp-3.
  2576         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2577         16  pi-max-ext               pic 999.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  52
* EL156.cbl
  2578         16  pi-max-ext-used          pic x.
  2579         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2580         16  PI-JOINT-COV-IND         PIC X.
  2581             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2582             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2583         16  PI-JOINT-INSURED-IND     PIC X.
  2584             88  PI-JOINT-INSURED        VALUE 'Y'.
  2585             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2586         16  pi-int-payees-name       pic x(30).
  2587         16  PI-RB-JOINT-COV-IND      PIC X.
  2588             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.
  2589             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.
  2590         16  pi-ach-payment           pic x.
  2591*00781          16  FILLER                   PIC X(176).
  2592*052506         16  FILLER                   PIC X(161).
  2593*031808         16  FILLER                   PIC X(154).
  2594*091808         16  FILLER                   PIC X(152).
  2595*041710         16  FILLER                   PIC X(94).
  2596         16  FILLER                   PIC X(34).
  2597
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  53
* EL156.cbl
  2599*    COPY ELCJPFX.
  2600******************************************************************
  2601*                                                                *
  2602*                                                                *
  2603*                            ELCJPFX.                            *
  2604*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2605*                            VMOD=2.002                          *
  2606*                                                                *
  2607*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2608*                                                                *
  2609*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2610*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2611*        ELCNTL - CONTROL FILE                                   *
  2612*        ELMSTR - CLAIM MASTERS                                  *
  2613*        ELTRLR - ACTIVITY TRAILERS                              *
  2614*        ELCHKQ - CHECK QUE                                      *
  2615******************************************************************
  2616 01  JOURNAL-RECORD.
  2617     12  jp-date                     pic s9(5) comp-3.
  2618     12  jp-time                     pic s9(7) comp-3.
  2619     12  JP-USER-ID                  PIC X(4).
  2620     12  JP-FILE-ID                  PIC X(8).
  2621     12  JP-PROGRAM-ID               PIC X(8).
  2622     12  JP-RECORD-TYPE              PIC X.
  2623         88 JP-ADD              VALUE 'A'.
  2624         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2625         88 JP-AFTER-CHANGE     VALUE 'C'.
  2626         88 JP-DELETE           VALUE 'D'.
  2627         88 JP-GENERIC-DELETE   VALUE 'G'.
  2628         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2629         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2630     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2631     12  JP-RECORD-AREA
  2632
  2633
  2634                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  54
* EL156.cbl
  2636*    COPY ELCAID.
  2637******************************************************************
  2638*                                                                *
  2639*                            ELCAID.                             *
  2640*                            VMOD=2.001                          *
  2641*                                                                *
  2642*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2643*                                                                *
  2644*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2645*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2646******************************************************************
  2647
  2648 01  DFHAID.
  2649   02  DFHNULL   PIC  X  VALUE  ' '.
  2650   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2651   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2652   02  DFHPEN    PIC  X  VALUE  '='.
  2653   02  DFHOPID   PIC  X  VALUE  'W'.
  2654   02  DFHPA1    PIC  X  VALUE  '%'.
  2655   02  DFHPA2    PIC  X  VALUE  '>'.
  2656   02  DFHPA3    PIC  X  VALUE  ','.
  2657   02  DFHPF1    PIC  X  VALUE  '1'.
  2658   02  DFHPF2    PIC  X  VALUE  '2'.
  2659   02  DFHPF3    PIC  X  VALUE  '3'.
  2660   02  DFHPF4    PIC  X  VALUE  '4'.
  2661   02  DFHPF5    PIC  X  VALUE  '5'.
  2662   02  DFHPF6    PIC  X  VALUE  '6'.
  2663   02  DFHPF7    PIC  X  VALUE  '7'.
  2664   02  DFHPF8    PIC  X  VALUE  '8'.
  2665   02  DFHPF9    PIC  X  VALUE  '9'.
  2666   02  DFHPF10   PIC  X  VALUE  ':'.
  2667   02  DFHPF11   PIC  X  VALUE  '#'.
  2668   02  DFHPF12   PIC  X  VALUE  '@'.
  2669   02  DFHPF13   PIC  X  VALUE  'A'.
  2670   02  DFHPF14   PIC  X  VALUE  'B'.
  2671   02  DFHPF15   PIC  X  VALUE  'C'.
  2672   02  DFHPF16   PIC  X  VALUE  'D'.
  2673   02  DFHPF17   PIC  X  VALUE  'E'.
  2674   02  DFHPF18   PIC  X  VALUE  'F'.
  2675   02  DFHPF19   PIC  X  VALUE  'G'.
  2676   02  DFHPF20   PIC  X  VALUE  'H'.
  2677   02  DFHPF21   PIC  X  VALUE  'I'.
  2678*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2679   02  DFHPF22   PIC  X  VALUE  '['.
  2680   02  DFHPF23   PIC  X  VALUE  '.'.
  2681   02  DFHPF24   PIC  X  VALUE  '<'.
  2682   02  DFHMSRE   PIC  X  VALUE  'X'.
  2683   02  DFHSTRF   PIC  X  VALUE  'h'.
  2684   02  DFHTRIG   PIC  X  VALUE  '"'.
  2685 01  FILLER    REDEFINES DFHAID.
  2686     12  FILLER              PIC X(8).
  2687     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  55
* EL156.cbl
  2689*    COPY EL156S.
  2690 01  EL156AI.
  2691     05  FILLER            PIC  X(0012).
  2692*    -------------------------------
  2693     05  RUNDTEAL PIC S9(0004) COMP.
  2694     05  RUNDTEAF PIC  X(0001).
  2695     05  FILLER REDEFINES RUNDTEAF.
  2696         10  RUNDTEAA PIC  X(0001).
  2697     05  RUNDTEAI PIC  X(0008).
  2698*    -------------------------------
  2699     05  RUNTIMAL PIC S9(0004) COMP.
  2700     05  RUNTIMAF PIC  X(0001).
  2701     05  FILLER REDEFINES RUNTIMAF.
  2702         10  RUNTIMAA PIC  X(0001).
  2703     05  RUNTIMAI PIC  X(0005).
  2704*    -------------------------------
  2705     05  SEQUL PIC S9(0004) COMP.
  2706     05  SEQUF PIC  X(0001).
  2707     05  FILLER REDEFINES SEQUF.
  2708         10  SEQUA PIC  X(0001).
  2709     05  SEQUI PIC  X(0010).
  2710*    -------------------------------
  2711     05  CLMNOL PIC S9(0004) COMP.
  2712     05  CLMNOF PIC  X(0001).
  2713     05  FILLER REDEFINES CLMNOF.
  2714         10  CLMNOA PIC  X(0001).
  2715     05  CLMNOI PIC  X(0007).
  2716*    -------------------------------
  2717     05  CARRL PIC S9(0004) COMP.
  2718     05  CARRF PIC  X(0001).
  2719     05  FILLER REDEFINES CARRF.
  2720         10  CARRA PIC  X(0001).
  2721     05  CARRI PIC  X(0001).
  2722*    -------------------------------
  2723     05  CERTNOL PIC S9(0004) COMP.
  2724     05  CERTNOF PIC  X(0001).
  2725     05  FILLER REDEFINES CERTNOF.
  2726         10  CERTNOA PIC  X(0001).
  2727     05  CERTNOI PIC  X(0010).
  2728*    -------------------------------
  2729     05  SUFXL PIC S9(0004) COMP.
  2730     05  SUFXF PIC  X(0001).
  2731     05  FILLER REDEFINES SUFXF.
  2732         10  SUFXA PIC  X(0001).
  2733     05  SUFXI PIC  X(0001).
  2734*    -------------------------------
  2735     05  CLMTYPL PIC S9(0004) COMP.
  2736     05  CLMTYPF PIC  X(0001).
  2737     05  FILLER REDEFINES CLMTYPF.
  2738         10  CLMTYPA PIC  X(0001).
  2739     05  CLMTYPI PIC  X(0006).
  2740*    -------------------------------
  2741     05  CLMSTATL PIC S9(0004) COMP.
  2742     05  CLMSTATF PIC  X(0001).
  2743     05  FILLER REDEFINES CLMSTATF.
  2744         10  CLMSTATA PIC  X(0001).
  2745     05  CLMSTATI PIC  X(0006).
  2746*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  56
* EL156.cbl
  2747     05  LSTNMEL PIC S9(0004) COMP.
  2748     05  LSTNMEF PIC  X(0001).
  2749     05  FILLER REDEFINES LSTNMEF.
  2750         10  LSTNMEA PIC  X(0001).
  2751     05  LSTNMEI PIC  X(0015).
  2752*    -------------------------------
  2753     05  FSTNMEL PIC S9(0004) COMP.
  2754     05  FSTNMEF PIC  X(0001).
  2755     05  FILLER REDEFINES FSTNMEF.
  2756         10  FSTNMEA PIC  X(0001).
  2757     05  FSTNMEI PIC  X(0012).
  2758*    -------------------------------
  2759     05  MINITL PIC S9(0004) COMP.
  2760     05  MINITF PIC  X(0001).
  2761     05  FILLER REDEFINES MINITF.
  2762         10  MINITA PIC  X(0001).
  2763     05  MINITI PIC  X(0001).
  2764*    -------------------------------
  2765     05  PRIMHDGL PIC S9(0004) COMP.
  2766     05  PRIMHDGF PIC  X(0001).
  2767     05  FILLER REDEFINES PRIMHDGF.
  2768         10  PRIMHDGA PIC  X(0001).
  2769     05  PRIMHDGI PIC  X(0012).
  2770*    -------------------------------
  2771     05  PCERTNOL PIC S9(0004) COMP.
  2772     05  PCERTNOF PIC  X(0001).
  2773     05  FILLER REDEFINES PCERTNOF.
  2774         10  PCERTNOA PIC  X(0001).
  2775     05  PCERTNOI PIC  X(0010).
  2776*    -------------------------------
  2777     05  PSUFXL PIC S9(0004) COMP.
  2778     05  PSUFXF PIC  X(0001).
  2779     05  FILLER REDEFINES PSUFXF.
  2780         10  PSUFXA PIC  X(0001).
  2781     05  PSUFXI PIC  X(0001).
  2782*    -------------------------------
  2783     05  STATUSL PIC S9(0004) COMP.
  2784     05  STATUSF PIC  X(0001).
  2785     05  FILLER REDEFINES STATUSF.
  2786         10  STATUSA PIC  X(0001).
  2787     05  STATUSI PIC  X(0010).
  2788*    -------------------------------
  2789     05  LOANHL PIC S9(0004) COMP.
  2790     05  LOANHF PIC  X(0001).
  2791     05  FILLER REDEFINES LOANHF.
  2792         10  LOANHA PIC  X(0001).
  2793     05  LOANHI PIC  X(0014).
  2794*    -------------------------------
  2795     05  LOANNOL PIC S9(0004) COMP.
  2796     05  LOANNOF PIC  X(0001).
  2797     05  FILLER REDEFINES LOANNOF.
  2798         10  LOANNOA PIC  X(0001).
  2799     05  LOANNOI PIC  X(0025).
  2800*    -------------------------------
  2801     05  DUEDAYHL PIC S9(0004) COMP.
  2802     05  DUEDAYHF PIC  X(0001).
  2803     05  FILLER REDEFINES DUEDAYHF.
  2804         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  57
* EL156.cbl
  2805     05  DUEDAYHI PIC  X(0008).
  2806*    -------------------------------
  2807     05  DUEDAYL PIC S9(0004) COMP.
  2808     05  DUEDAYF PIC  X(0001).
  2809     05  FILLER REDEFINES DUEDAYF.
  2810         10  DUEDAYA PIC  X(0001).
  2811     05  DUEDAYI PIC  X(0002).
  2812*    -------------------------------
  2813     05  ZINTHL PIC S9(0004) COMP.
  2814     05  ZINTHF PIC  X(0001).
  2815     05  FILLER REDEFINES ZINTHF.
  2816         10  ZINTHA PIC  X(0001).
  2817     05  ZINTHI PIC  X(0009).
  2818*    -------------------------------
  2819     05  ZINTL PIC S9(0004) COMP.
  2820     05  ZINTF PIC  X(0001).
  2821     05  FILLER REDEFINES ZINTF.
  2822         10  ZINTA PIC  X(0001).
  2823     05  ZINTI PIC  99V99999.
  2824*    -------------------------------
  2825     05  PTHRHDGL PIC S9(0004) COMP.
  2826     05  PTHRHDGF PIC  X(0001).
  2827     05  FILLER REDEFINES PTHRHDGF.
  2828         10  PTHRHDGA PIC  X(0001).
  2829     05  PTHRHDGI PIC  X(0014).
  2830*    -------------------------------
  2831     05  PDTHRUL PIC S9(0004) COMP.
  2832     05  PDTHRUF PIC  X(0001).
  2833     05  FILLER REDEFINES PDTHRUF.
  2834         10  PDTHRUA PIC  X(0001).
  2835     05  PDTHRUI PIC  X(0008).
  2836*    -------------------------------
  2837     05  TOTPAIDL PIC S9(0004) COMP.
  2838     05  TOTPAIDF PIC  X(0001).
  2839     05  FILLER REDEFINES TOTPAIDF.
  2840         10  TOTPAIDA PIC  X(0001).
  2841     05  TOTPAIDI PIC  X(0010).
  2842*    -------------------------------
  2843     05  COVERL PIC S9(0004) COMP.
  2844     05  COVERF PIC  X(0001).
  2845     05  FILLER REDEFINES COVERF.
  2846         10  COVERA PIC  X(0001).
  2847     05  COVERI PIC  X(0010).
  2848*    -------------------------------
  2849     05  INCURL PIC S9(0004) COMP.
  2850     05  INCURF PIC  X(0001).
  2851     05  FILLER REDEFINES INCURF.
  2852         10  INCURA PIC  X(0001).
  2853     05  INCURI PIC  X(0008).
  2854*    -------------------------------
  2855     05  LSTDTEL PIC S9(0004) COMP.
  2856     05  LSTDTEF PIC  X(0001).
  2857     05  FILLER REDEFINES LSTDTEF.
  2858         10  LSTDTEA PIC  X(0001).
  2859     05  LSTDTEI PIC  X(0008).
  2860*    -------------------------------
  2861     05  CRTSTATL PIC S9(0004) COMP.
  2862     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  58
* EL156.cbl
  2863     05  FILLER REDEFINES CRTSTATF.
  2864         10  CRTSTATA PIC  X(0001).
  2865     05  CRTSTATI PIC  X(0010).
  2866*    -------------------------------
  2867     05  EFFECTL PIC S9(0004) COMP.
  2868     05  EFFECTF PIC  X(0001).
  2869     05  FILLER REDEFINES EFFECTF.
  2870         10  EFFECTA PIC  X(0001).
  2871     05  EFFECTI PIC  X(0008).
  2872*    -------------------------------
  2873     05  TERMSL PIC S9(0004) COMP.
  2874     05  TERMSF PIC  X(0001).
  2875     05  FILLER REDEFINES TERMSF.
  2876         10  TERMSA PIC  X(0001).
  2877     05  TERMSI PIC  X(0011).
  2878*    -------------------------------
  2879     05  STACCTL PIC S9(0004) COMP.
  2880     05  STACCTF PIC  X(0001).
  2881     05  FILLER REDEFINES STACCTF.
  2882         10  STACCTA PIC  X(0001).
  2883     05  STACCTI PIC  X(0013).
  2884*    -------------------------------
  2885     05  EXPDTEHL PIC S9(0004) COMP.
  2886     05  EXPDTEHF PIC  X(0001).
  2887     05  FILLER REDEFINES EXPDTEHF.
  2888         10  EXPDTEHA PIC  X(0001).
  2889     05  EXPDTEHI PIC  X(0014).
  2890*    -------------------------------
  2891     05  EXPDTEL PIC S9(0004) COMP.
  2892     05  EXPDTEF PIC  X(0001).
  2893     05  FILLER REDEFINES EXPDTEF.
  2894         10  EXPDTEA PIC  X(0001).
  2895     05  EXPDTEI PIC  X(0008).
  2896*    -------------------------------
  2897     05  BENECAPL PIC S9(0004) COMP.
  2898     05  BENECAPF PIC  X(0001).
  2899     05  FILLER REDEFINES BENECAPF.
  2900         10  BENECAPA PIC  X(0001).
  2901     05  BENECAPI PIC  X(0013).
  2902*    -------------------------------
  2903     05  BENEL PIC S9(0004) COMP.
  2904     05  BENEF PIC  X(0001).
  2905     05  FILLER REDEFINES BENEF.
  2906         10  BENEA PIC  X(0001).
  2907     05  BENEI PIC  X(0009).
  2908*    -------------------------------
  2909     05  FORMTYPL PIC S9(0004) COMP.
  2910     05  FORMTYPF PIC  X(0001).
  2911     05  FILLER REDEFINES FORMTYPF.
  2912         10  FORMTYPA PIC  X(0001).
  2913     05  FORMTYPI PIC  X(0001).
  2914*    -------------------------------
  2915     05  PMTTYPEL PIC S9(0004) COMP.
  2916     05  PMTTYPEF PIC  X(0001).
  2917     05  FILLER REDEFINES PMTTYPEF.
  2918         10  PMTTYPEA PIC  X(0001).
  2919     05  PMTTYPEI PIC  X(0001).
  2920*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  59
* EL156.cbl
  2921     05  PAYEEL PIC S9(0004) COMP.
  2922     05  PAYEEF PIC  X(0001).
  2923     05  FILLER REDEFINES PAYEEF.
  2924         10  PAYEEA PIC  X(0001).
  2925     05  PAYEEI PIC  X(0002).
  2926*    -------------------------------
  2927     05  CHECKNOL PIC S9(0004) COMP.
  2928     05  CHECKNOF PIC  X(0001).
  2929     05  FILLER REDEFINES CHECKNOF.
  2930         10  CHECKNOA PIC  X(0001).
  2931     05  CHECKNOI PIC  X(0007).
  2932*    -------------------------------
  2933     05  OFFLINEL PIC S9(0004) COMP.
  2934     05  OFFLINEF PIC  X(0001).
  2935     05  FILLER REDEFINES OFFLINEF.
  2936         10  OFFLINEA PIC  X(0001).
  2937     05  OFFLINEI PIC  X(0001).
  2938*    -------------------------------
  2939     05  HOLDTILL PIC S9(0004) COMP.
  2940     05  HOLDTILF PIC  X(0001).
  2941     05  FILLER REDEFINES HOLDTILF.
  2942         10  HOLDTILA PIC  X(0001).
  2943     05  HOLDTILI PIC  X(0008).
  2944*    -------------------------------
  2945     05  NOTE1L PIC S9(0004) COMP.
  2946     05  NOTE1F PIC  X(0001).
  2947     05  FILLER REDEFINES NOTE1F.
  2948         10  NOTE1A PIC  X(0001).
  2949     05  NOTE1I PIC  X(0060).
  2950*    -------------------------------
  2951     05  ITRB1L PIC S9(0004) COMP.
  2952     05  ITRB1F PIC  X(0001).
  2953     05  FILLER REDEFINES ITRB1F.
  2954         10  ITRB1A PIC  X(0001).
  2955     05  ITRB1I PIC  X(0008).
  2956*    -------------------------------
  2957     05  NOTE2L PIC S9(0004) COMP.
  2958     05  NOTE2F PIC  X(0001).
  2959     05  FILLER REDEFINES NOTE2F.
  2960         10  NOTE2A PIC  X(0001).
  2961     05  NOTE2I PIC  X(0060).
  2962*    -------------------------------
  2963     05  ITRB2L PIC S9(0004) COMP.
  2964     05  ITRB2F PIC  X(0001).
  2965     05  FILLER REDEFINES ITRB2F.
  2966         10  ITRB2A PIC  X(0001).
  2967     05  ITRB2I PIC  X(0010).
  2968*    -------------------------------
  2969     05  EOBYNL PIC S9(0004) COMP.
  2970     05  EOBYNF PIC  X(0001).
  2971     05  FILLER REDEFINES EOBYNF.
  2972         10  EOBYNA PIC  X(0001).
  2973     05  EOBYNI PIC  X(0001).
  2974*    -------------------------------
  2975     05  CLMFMYNL PIC S9(0004) COMP.
  2976     05  CLMFMYNF PIC  X(0001).
  2977     05  FILLER REDEFINES CLMFMYNF.
  2978         10  CLMFMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  60
* EL156.cbl
  2979     05  CLMFMYNI PIC  X(0001).
  2980*    -------------------------------
  2981     05  SURVYYNL PIC S9(0004) COMP.
  2982     05  SURVYYNF PIC  X(0001).
  2983     05  FILLER REDEFINES SURVYYNF.
  2984         10  SURVYYNA PIC  X(0001).
  2985     05  SURVYYNI PIC  X(0001).
  2986*    -------------------------------
  2987     05  SPRELYNL PIC S9(0004) COMP.
  2988     05  SPRELYNF PIC  X(0001).
  2989     05  FILLER REDEFINES SPRELYNF.
  2990         10  SPRELYNA PIC  X(0001).
  2991     05  SPRELYNI PIC  X(0001).
  2992*    -------------------------------
  2993     05  PINTHL PIC S9(0004) COMP.
  2994     05  PINTHF PIC  X(0001).
  2995     05  FILLER REDEFINES PINTHF.
  2996         10  PINTHA PIC  X(0001).
  2997     05  PINTHI PIC  X(0004).
  2998*    -------------------------------
  2999     05  PINTL PIC S9(0004) COMP.
  3000     05  PINTF PIC  X(0001).
  3001     05  FILLER REDEFINES PINTF.
  3002         10  PINTA PIC  X(0001).
  3003     05  PINTI PIC  X(0008).
  3004*    -------------------------------
  3005     05  ITRBYNL PIC S9(0004) COMP.
  3006     05  ITRBYNF PIC  X(0001).
  3007     05  FILLER REDEFINES ITRBYNF.
  3008         10  ITRBYNA PIC  X(0001).
  3009     05  ITRBYNI PIC  X(0001).
  3010*    -------------------------------
  3011     05  PROOFDTL PIC S9(0004) COMP.
  3012     05  PROOFDTF PIC  X(0001).
  3013     05  FILLER REDEFINES PROOFDTF.
  3014         10  PROOFDTA PIC  X(0001).
  3015     05  PROOFDTI PIC  X(0008).
  3016*    -------------------------------
  3017     05  AIGFRMHL PIC S9(0004) COMP.
  3018     05  AIGFRMHF PIC  X(0001).
  3019     05  FILLER REDEFINES AIGFRMHF.
  3020         10  AIGFRMHA PIC  X(0001).
  3021     05  AIGFRMHI PIC  X(0012).
  3022*    -------------------------------
  3023     05  AIGFROML PIC S9(0004) COMP.
  3024     05  AIGFROMF PIC  X(0001).
  3025     05  FILLER REDEFINES AIGFROMF.
  3026         10  AIGFROMA PIC  X(0001).
  3027     05  AIGFROMI PIC  X(0008).
  3028*    -------------------------------
  3029     05  PMTHDGAL PIC S9(0004) COMP.
  3030     05  PMTHDGAF PIC  X(0001).
  3031     05  FILLER REDEFINES PMTHDGAF.
  3032         10  PMTHDGAA PIC  X(0001).
  3033     05  PMTHDGAI PIC  X(0066).
  3034*    -------------------------------
  3035     05  EPYFROML PIC S9(0004) COMP.
  3036     05  EPYFROMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  61
* EL156.cbl
  3037     05  FILLER REDEFINES EPYFROMF.
  3038         10  EPYFROMA PIC  X(0001).
  3039     05  EPYFROMI PIC  X(0008).
  3040*    -------------------------------
  3041     05  EPYTHRUL PIC S9(0004) COMP.
  3042     05  EPYTHRUF PIC  X(0001).
  3043     05  FILLER REDEFINES EPYTHRUF.
  3044         10  EPYTHRUA PIC  X(0001).
  3045     05  EPYTHRUI PIC  X(0008).
  3046*    -------------------------------
  3047     05  EDAYSL PIC S9(0004) COMP.
  3048     05  EDAYSF PIC  X(0001).
  3049     05  FILLER REDEFINES EDAYSF.
  3050         10  EDAYSA PIC  X(0001).
  3051     05  EDAYSI PIC  S9(6).
  3052*    -------------------------------
  3053     05  EPYAMTL PIC S9(0004) COMP.
  3054     05  EPYAMTF PIC  X(0001).
  3055     05  FILLER REDEFINES EPYAMTF.
  3056         10  EPYAMTA PIC  X(0001).
  3057     05  EPYAMTI PIC  S9(8)V99.
  3058*    -------------------------------
  3059     05  ERESVL PIC S9(0004) COMP.
  3060     05  ERESVF PIC  X(0001).
  3061     05  FILLER REDEFINES ERESVF.
  3062         10  ERESVA PIC  X(0001).
  3063     05  ERESVI PIC  S9(7)V99.
  3064*    -------------------------------
  3065     05  ETYPEL PIC S9(0004) COMP.
  3066     05  ETYPEF PIC  X(0001).
  3067     05  FILLER REDEFINES ETYPEF.
  3068         10  ETYPEA PIC  X(0001).
  3069     05  ETYPEI PIC  X(0001).
  3070*    -------------------------------
  3071     05  EEXPENSL PIC S9(0004) COMP.
  3072     05  EEXPENSF PIC  X(0001).
  3073     05  FILLER REDEFINES EEXPENSF.
  3074         10  EEXPENSA PIC  X(0001).
  3075     05  EEXPENSI PIC  9(6)V99.
  3076*    -------------------------------
  3077     05  CPYFROML PIC S9(0004) COMP.
  3078     05  CPYFROMF PIC  X(0001).
  3079     05  FILLER REDEFINES CPYFROMF.
  3080         10  CPYFROMA PIC  X(0001).
  3081     05  CPYFROMI PIC  X(0008).
  3082*    -------------------------------
  3083     05  CPYTHRUL PIC S9(0004) COMP.
  3084     05  CPYTHRUF PIC  X(0001).
  3085     05  FILLER REDEFINES CPYTHRUF.
  3086         10  CPYTHRUA PIC  X(0001).
  3087     05  CPYTHRUI PIC  X(0008).
  3088*    -------------------------------
  3089     05  CDAYSL PIC S9(0004) COMP.
  3090     05  CDAYSF PIC  X(0001).
  3091     05  FILLER REDEFINES CDAYSF.
  3092         10  CDAYSA PIC  X(0001).
  3093     05  CDAYSI PIC  9(6).
  3094*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  62
* EL156.cbl
  3095     05  CPYAMTL PIC S9(0004) COMP.
  3096     05  CPYAMTF PIC  X(0001).
  3097     05  FILLER REDEFINES CPYAMTF.
  3098         10  CPYAMTA PIC  X(0001).
  3099     05  CPYAMTI PIC  S9(8)V99.
  3100*    -------------------------------
  3101     05  CRESVL PIC S9(0004) COMP.
  3102     05  CRESVF PIC  X(0001).
  3103     05  FILLER REDEFINES CRESVF.
  3104         10  CRESVA PIC  X(0001).
  3105     05  CRESVI PIC  9(6)V99.
  3106*    -------------------------------
  3107     05  CEXPENSL PIC S9(0004) COMP.
  3108     05  CEXPENSF PIC  X(0001).
  3109     05  FILLER REDEFINES CEXPENSF.
  3110         10  CEXPENSA PIC  X(0001).
  3111     05  CEXPENSI PIC  9(6)V99.
  3112*    -------------------------------
  3113     05  ERRMSG0L PIC S9(0004) COMP.
  3114     05  ERRMSG0F PIC  X(0001).
  3115     05  FILLER REDEFINES ERRMSG0F.
  3116         10  ERRMSG0A PIC  X(0001).
  3117     05  ERRMSG0I PIC  X(0072).
  3118*    -------------------------------
  3119     05  ERRMSG1L PIC S9(0004) COMP.
  3120     05  ERRMSG1F PIC  X(0001).
  3121     05  FILLER REDEFINES ERRMSG1F.
  3122         10  ERRMSG1A PIC  X(0001).
  3123     05  ERRMSG1I PIC  X(0072).
  3124*    -------------------------------
  3125     05  ERRMSG2L PIC S9(0004) COMP.
  3126     05  ERRMSG2F PIC  X(0001).
  3127     05  FILLER REDEFINES ERRMSG2F.
  3128         10  ERRMSG2A PIC  X(0001).
  3129     05  ERRMSG2I PIC  X(0072).
  3130*    -------------------------------
  3131     05  ENTERPFL PIC S9(0004) COMP.
  3132     05  ENTERPFF PIC  X(0001).
  3133     05  FILLER REDEFINES ENTERPFF.
  3134         10  ENTERPFA PIC  X(0001).
  3135     05  ENTERPFI PIC  99.
  3136*    -------------------------------
  3137     05  PF6TITL PIC S9(0004) COMP.
  3138     05  PF6TITF PIC  X(0001).
  3139     05  FILLER REDEFINES PF6TITF.
  3140         10  PF6TITA PIC  X(0001).
  3141     05  PF6TITI PIC  X(0016).
  3142 01  EL156AO REDEFINES EL156AI.
  3143     05  FILLER            PIC  X(0012).
  3144*    -------------------------------
  3145     05  FILLER            PIC  X(0003).
  3146     05  RUNDTEAO PIC  X(0008).
  3147*    -------------------------------
  3148     05  FILLER            PIC  X(0003).
  3149     05  RUNTIMAO PIC  99.99.
  3150*    -------------------------------
  3151     05  FILLER            PIC  X(0003).
  3152     05  SEQUO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  63
* EL156.cbl
  3153*    -------------------------------
  3154     05  FILLER            PIC  X(0003).
  3155     05  CLMNOO PIC  X(0007).
  3156*    -------------------------------
  3157     05  FILLER            PIC  X(0003).
  3158     05  CARRO PIC  X(0001).
  3159*    -------------------------------
  3160     05  FILLER            PIC  X(0003).
  3161     05  CERTNOO PIC  X(0010).
  3162*    -------------------------------
  3163     05  FILLER            PIC  X(0003).
  3164     05  SUFXO PIC  X(0001).
  3165*    -------------------------------
  3166     05  FILLER            PIC  X(0003).
  3167     05  CLMTYPO PIC  X(0006).
  3168*    -------------------------------
  3169     05  FILLER            PIC  X(0003).
  3170     05  CLMSTATO PIC  X(0006).
  3171*    -------------------------------
  3172     05  FILLER            PIC  X(0003).
  3173     05  LSTNMEO PIC  X(0015).
  3174*    -------------------------------
  3175     05  FILLER            PIC  X(0003).
  3176     05  FSTNMEO PIC  X(0012).
  3177*    -------------------------------
  3178     05  FILLER            PIC  X(0003).
  3179     05  MINITO PIC  X(0001).
  3180*    -------------------------------
  3181     05  FILLER            PIC  X(0003).
  3182     05  PRIMHDGO PIC  X(0012).
  3183*    -------------------------------
  3184     05  FILLER            PIC  X(0003).
  3185     05  PCERTNOO PIC  X(0010).
  3186*    -------------------------------
  3187     05  FILLER            PIC  X(0003).
  3188     05  PSUFXO PIC  X(0001).
  3189*    -------------------------------
  3190     05  FILLER            PIC  X(0003).
  3191     05  STATUSO PIC  X(0010).
  3192*    -------------------------------
  3193     05  FILLER            PIC  X(0003).
  3194     05  LOANHO PIC  X(0014).
  3195*    -------------------------------
  3196     05  FILLER            PIC  X(0003).
  3197     05  LOANNOO PIC  X(0025).
  3198*    -------------------------------
  3199     05  FILLER            PIC  X(0003).
  3200     05  DUEDAYHO PIC  X(0008).
  3201*    -------------------------------
  3202     05  FILLER            PIC  X(0003).
  3203     05  DUEDAYO PIC  X(0002).
  3204*    -------------------------------
  3205     05  FILLER            PIC  X(0003).
  3206     05  ZINTHO PIC  X(0009).
  3207*    -------------------------------
  3208     05  FILLER            PIC  X(0003).
  3209     05  ZINTO PIC  9.99999.
  3210*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  64
* EL156.cbl
  3211     05  FILLER            PIC  X(0003).
  3212     05  PTHRHDGO PIC  X(0014).
  3213*    -------------------------------
  3214     05  FILLER            PIC  X(0003).
  3215     05  PDTHRUO PIC  X(0008).
  3216*    -------------------------------
  3217     05  FILLER            PIC  X(0003).
  3218     05  TOTPAIDO PIC  Z(6).99-.
  3219*    -------------------------------
  3220     05  FILLER            PIC  X(0003).
  3221     05  COVERO PIC  X(0010).
  3222*    -------------------------------
  3223     05  FILLER            PIC  X(0003).
  3224     05  INCURO PIC  X(0008).
  3225*    -------------------------------
  3226     05  FILLER            PIC  X(0003).
  3227     05  LSTDTEO PIC  X(0008).
  3228*    -------------------------------
  3229     05  FILLER            PIC  X(0003).
  3230     05  CRTSTATO PIC  X(0010).
  3231*    -------------------------------
  3232     05  FILLER            PIC  X(0003).
  3233     05  EFFECTO PIC  X(0008).
  3234*    -------------------------------
  3235     05  FILLER            PIC  X(0003).
  3236     05  TERMSO PIC  X(0011).
  3237*    -------------------------------
  3238     05  FILLER            PIC  X(0003).
  3239     05  STACCTO PIC  X(0013).
  3240*    -------------------------------
  3241     05  FILLER            PIC  X(0003).
  3242     05  EXPDTEHO PIC  X(0014).
  3243*    -------------------------------
  3244     05  FILLER            PIC  X(0003).
  3245     05  EXPDTEO PIC  X(0008).
  3246*    -------------------------------
  3247     05  FILLER            PIC  X(0003).
  3248     05  BENECAPO PIC  X(0013).
  3249*    -------------------------------
  3250     05  FILLER            PIC  X(0003).
  3251     05  BENEO PIC  Z(6).99.
  3252*    -------------------------------
  3253     05  FILLER            PIC  X(0003).
  3254     05  FORMTYPO PIC  X(0001).
  3255*    -------------------------------
  3256     05  FILLER            PIC  X(0003).
  3257     05  PMTTYPEO PIC  X(0001).
  3258*    -------------------------------
  3259     05  FILLER            PIC  X(0003).
  3260     05  PAYEEO PIC  X(0002).
  3261*    -------------------------------
  3262     05  FILLER            PIC  X(0003).
  3263     05  CHECKNOO PIC  X(0007).
  3264*    -------------------------------
  3265     05  FILLER            PIC  X(0003).
  3266     05  OFFLINEO PIC  X(0001).
  3267*    -------------------------------
  3268     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  65
* EL156.cbl
  3269     05  HOLDTILO PIC  99B99B99.
  3270*    -------------------------------
  3271     05  FILLER            PIC  X(0003).
  3272     05  NOTE1O PIC  X(0060).
  3273*    -------------------------------
  3274     05  FILLER            PIC  X(0003).
  3275     05  ITRB1O PIC  X(0008).
  3276*    -------------------------------
  3277     05  FILLER            PIC  X(0003).
  3278     05  NOTE2O PIC  X(0060).
  3279*    -------------------------------
  3280     05  FILLER            PIC  X(0003).
  3281     05  ITRB2O PIC  X(0010).
  3282*    -------------------------------
  3283     05  FILLER            PIC  X(0003).
  3284     05  EOBYNO PIC  X(0001).
  3285*    -------------------------------
  3286     05  FILLER            PIC  X(0003).
  3287     05  CLMFMYNO PIC  X(0001).
  3288*    -------------------------------
  3289     05  FILLER            PIC  X(0003).
  3290     05  SURVYYNO PIC  X(0001).
  3291*    -------------------------------
  3292     05  FILLER            PIC  X(0003).
  3293     05  SPRELYNO PIC  X(0001).
  3294*    -------------------------------
  3295     05  FILLER            PIC  X(0003).
  3296     05  PINTHO PIC  X(0004).
  3297*    -------------------------------
  3298     05  FILLER            PIC  X(0003).
  3299     05  PINTO PIC  Z,ZZ9.99.
  3300*    -------------------------------
  3301     05  FILLER            PIC  X(0003).
  3302     05  ITRBYNO PIC  X(0001).
  3303*    -------------------------------
  3304     05  FILLER            PIC  X(0003).
  3305     05  PROOFDTO PIC  99B99B99.
  3306*    -------------------------------
  3307     05  FILLER            PIC  X(0003).
  3308     05  AIGFRMHO PIC  X(0012).
  3309*    -------------------------------
  3310     05  FILLER            PIC  X(0003).
  3311     05  AIGFROMO PIC  99B99B99.
  3312*    -------------------------------
  3313     05  FILLER            PIC  X(0003).
  3314     05  PMTHDGAO PIC  X(0066).
  3315*    -------------------------------
  3316     05  FILLER            PIC  X(0003).
  3317     05  EPYFROMO PIC  99B99B99.
  3318*    -------------------------------
  3319     05  FILLER            PIC  X(0003).
  3320     05  EPYTHRUO PIC  99B99B99.
  3321*    -------------------------------
  3322     05  FILLER            PIC  X(0003).
  3323     05  EDAYSO PIC  Z(4)9-.
  3324*    -------------------------------
  3325     05  FILLER            PIC  X(0003).
  3326     05  EPYAMTO PIC  Z(6).99-.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  66
* EL156.cbl
  3327*    -------------------------------
  3328     05  FILLER            PIC  X(0003).
  3329     05  ERESVO PIC  Z(5).99-.
  3330*    -------------------------------
  3331     05  FILLER            PIC  X(0003).
  3332     05  ETYPEO PIC  X(0001).
  3333*    -------------------------------
  3334     05  FILLER            PIC  X(0003).
  3335     05  EEXPENSO PIC  Z(5).99.
  3336*    -------------------------------
  3337     05  FILLER            PIC  X(0003).
  3338     05  CPYFROMO PIC  99B99B99.
  3339*    -------------------------------
  3340     05  FILLER            PIC  X(0003).
  3341     05  CPYTHRUO PIC  99B99B99.
  3342*    -------------------------------
  3343     05  FILLER            PIC  X(0003).
  3344     05  CDAYSO PIC  Z(4)9-.
  3345*    -------------------------------
  3346     05  FILLER            PIC  X(0003).
  3347     05  CPYAMTO PIC  Z(6).99-.
  3348*    -------------------------------
  3349     05  FILLER            PIC  X(0003).
  3350     05  CRESVO PIC  Z(5).99.
  3351*    -------------------------------
  3352     05  FILLER            PIC  X(0003).
  3353     05  CEXPENSO PIC  Z(5).99.
  3354*    -------------------------------
  3355     05  FILLER            PIC  X(0003).
  3356     05  ERRMSG0O PIC  X(0072).
  3357*    -------------------------------
  3358     05  FILLER            PIC  X(0003).
  3359     05  ERRMSG1O PIC  X(0072).
  3360*    -------------------------------
  3361     05  FILLER            PIC  X(0003).
  3362     05  ERRMSG2O PIC  X(0072).
  3363*    -------------------------------
  3364     05  FILLER            PIC  X(0003).
  3365     05  ENTERPFO PIC  X(0002).
  3366*    -------------------------------
  3367     05  FILLER            PIC  X(0003).
  3368     05  PF6TITO PIC  X(0016).
  3369*    -------------------------------
  3370 01  EL156BI REDEFINES EL156AI.
  3371     05  FILLER            PIC  X(0012).
  3372*    -------------------------------
  3373     05  RUNDTEBL PIC S9(0004) COMP.
  3374     05  RUNDTEBF PIC  X(0001).
  3375     05  FILLER REDEFINES RUNDTEBF.
  3376         10  RUNDTEBA PIC  X(0001).
  3377     05  RUNDTEBI PIC  X(0008).
  3378*    -------------------------------
  3379     05  RUNTIMBL PIC S9(0004) COMP.
  3380     05  RUNTIMBF PIC  X(0001).
  3381     05  FILLER REDEFINES RUNTIMBF.
  3382         10  RUNTIMBA PIC  X(0001).
  3383     05  RUNTIMBI PIC  X(0005).
  3384*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  67
* EL156.cbl
  3385     05  PAYDTBL PIC S9(0004) COMP.
  3386     05  PAYDTBF PIC  X(0001).
  3387     05  FILLER REDEFINES PAYDTBF.
  3388         10  PAYDTBA PIC  X(0001).
  3389     05  PAYDTBI PIC  X(0008).
  3390*    -------------------------------
  3391     05  PAYTYPBL PIC S9(0004) COMP.
  3392     05  PAYTYPBF PIC  X(0001).
  3393     05  FILLER REDEFINES PAYTYPBF.
  3394         10  PAYTYPBA PIC  X(0001).
  3395     05  PAYTYPBI PIC  X(0015).
  3396*    -------------------------------
  3397     05  PAYAMTBL PIC S9(0004) COMP.
  3398     05  PAYAMTBF PIC  X(0001).
  3399     05  FILLER REDEFINES PAYAMTBF.
  3400         10  PAYAMTBA PIC  X(0001).
  3401     05  PAYAMTBI PIC  X(0011).
  3402*    -------------------------------
  3403     05  LOANHBL PIC S9(0004) COMP.
  3404     05  LOANHBF PIC  X(0001).
  3405     05  FILLER REDEFINES LOANHBF.
  3406         10  LOANHBA PIC  X(0001).
  3407     05  LOANHBI PIC  X(0012).
  3408*    -------------------------------
  3409     05  LOANNBL PIC S9(0004) COMP.
  3410     05  LOANNBF PIC  X(0001).
  3411     05  FILLER REDEFINES LOANNBF.
  3412         10  LOANNBA PIC  X(0001).
  3413     05  LOANNBI PIC  X(0025).
  3414*    -------------------------------
  3415     05  CKNUMHDL PIC S9(0004) COMP.
  3416     05  CKNUMHDF PIC  X(0001).
  3417     05  FILLER REDEFINES CKNUMHDF.
  3418         10  CKNUMHDA PIC  X(0001).
  3419     05  CKNUMHDI PIC  X(0012).
  3420*    -------------------------------
  3421     05  CKNUMBL PIC S9(0004) COMP.
  3422     05  CKNUMBF PIC  X(0001).
  3423     05  FILLER REDEFINES CKNUMBF.
  3424         10  CKNUMBA PIC  X(0001).
  3425     05  CKNUMBI PIC  X(0007).
  3426*    -------------------------------
  3427     05  AGTHDGL PIC S9(0004) COMP.
  3428     05  AGTHDGF PIC  X(0001).
  3429     05  FILLER REDEFINES AGTHDGF.
  3430         10  AGTHDGA PIC  X(0001).
  3431     05  AGTHDGI PIC  X(0016).
  3432*    -------------------------------
  3433     05  NAMEBL PIC S9(0004) COMP.
  3434     05  NAMEBF PIC  X(0001).
  3435     05  FILLER REDEFINES NAMEBF.
  3436         10  NAMEBA PIC  X(0001).
  3437     05  NAMEBI PIC  X(0030).
  3438*    -------------------------------
  3439     05  NAMEB2L PIC S9(0004) COMP.
  3440     05  NAMEB2F PIC  X(0001).
  3441     05  FILLER REDEFINES NAMEB2F.
  3442         10  NAMEB2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  68
* EL156.cbl
  3443     05  NAMEB2I PIC  X(0030).
  3444*    -------------------------------
  3445     05  ADDR1BL PIC S9(0004) COMP.
  3446     05  ADDR1BF PIC  X(0001).
  3447     05  FILLER REDEFINES ADDR1BF.
  3448         10  ADDR1BA PIC  X(0001).
  3449     05  ADDR1BI PIC  X(0030).
  3450*    -------------------------------
  3451     05  ADDR1B2L PIC S9(0004) COMP.
  3452     05  ADDR1B2F PIC  X(0001).
  3453     05  FILLER REDEFINES ADDR1B2F.
  3454         10  ADDR1B2A PIC  X(0001).
  3455     05  ADDR1B2I PIC  X(0030).
  3456*    -------------------------------
  3457     05  ADDR2BL PIC S9(0004) COMP.
  3458     05  ADDR2BF PIC  X(0001).
  3459     05  FILLER REDEFINES ADDR2BF.
  3460         10  ADDR2BA PIC  X(0001).
  3461     05  ADDR2BI PIC  X(0030).
  3462*    -------------------------------
  3463     05  ADDR2B2L PIC S9(0004) COMP.
  3464     05  ADDR2B2F PIC  X(0001).
  3465     05  FILLER REDEFINES ADDR2B2F.
  3466         10  ADDR2B2A PIC  X(0001).
  3467     05  ADDR2B2I PIC  X(0030).
  3468*    -------------------------------
  3469     05  CITYSTBL PIC S9(0004) COMP.
  3470     05  CITYSTBF PIC  X(0001).
  3471     05  FILLER REDEFINES CITYSTBF.
  3472         10  CITYSTBA PIC  X(0001).
  3473     05  CITYSTBI PIC  X(0030).
  3474*    -------------------------------
  3475     05  CITYST2L PIC S9(0004) COMP.
  3476     05  CITYST2F PIC  X(0001).
  3477     05  FILLER REDEFINES CITYST2F.
  3478         10  CITYST2A PIC  X(0001).
  3479     05  CITYST2I PIC  X(0030).
  3480*    -------------------------------
  3481     05  ZIPBL PIC S9(0004) COMP.
  3482     05  ZIPBF PIC  X(0001).
  3483     05  FILLER REDEFINES ZIPBF.
  3484         10  ZIPBA PIC  X(0001).
  3485     05  ZIPBI PIC  X(0009).
  3486*    -------------------------------
  3487     05  ZIPB2L PIC S9(0004) COMP.
  3488     05  ZIPB2F PIC  X(0001).
  3489     05  FILLER REDEFINES ZIPB2F.
  3490         10  ZIPB2A PIC  X(0001).
  3491     05  ZIPB2I PIC  X(0009).
  3492*    -------------------------------
  3493     05  INTHDBL PIC S9(0004) COMP.
  3494     05  INTHDBF PIC  X(0001).
  3495     05  FILLER REDEFINES INTHDBF.
  3496         10  INTHDBA PIC  X(0001).
  3497     05  INTHDBI PIC  X(0012).
  3498*    -------------------------------
  3499     05  INTAMTBL PIC S9(0004) COMP.
  3500     05  INTAMTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  69
* EL156.cbl
  3501     05  FILLER REDEFINES INTAMTBF.
  3502         10  INTAMTBA PIC  X(0001).
  3503     05  INTAMTBI PIC  X(0011).
  3504*    -------------------------------
  3505     05  PMTHDGBL PIC S9(0004) COMP.
  3506     05  PMTHDGBF PIC  X(0001).
  3507     05  FILLER REDEFINES PMTHDGBF.
  3508         10  PMTHDGBA PIC  X(0001).
  3509     05  PMTHDGBI PIC  X(0034).
  3510*    -------------------------------
  3511     05  CLMNOBL PIC S9(0004) COMP.
  3512     05  CLMNOBF PIC  X(0001).
  3513     05  FILLER REDEFINES CLMNOBF.
  3514         10  CLMNOBA PIC  X(0001).
  3515     05  CLMNOBI PIC  X(0007).
  3516*    -------------------------------
  3517     05  CARRBL PIC S9(0004) COMP.
  3518     05  CARRBF PIC  X(0001).
  3519     05  FILLER REDEFINES CARRBF.
  3520         10  CARRBA PIC  X(0001).
  3521     05  CARRBI PIC  X(0001).
  3522*    -------------------------------
  3523     05  CERTNOBL PIC S9(0004) COMP.
  3524     05  CERTNOBF PIC  X(0001).
  3525     05  FILLER REDEFINES CERTNOBF.
  3526         10  CERTNOBA PIC  X(0001).
  3527     05  CERTNOBI PIC  X(0010).
  3528*    -------------------------------
  3529     05  SUFXBL PIC S9(0004) COMP.
  3530     05  SUFXBF PIC  X(0001).
  3531     05  FILLER REDEFINES SUFXBF.
  3532         10  SUFXBA PIC  X(0001).
  3533     05  SUFXBI PIC  X(0001).
  3534*    -------------------------------
  3535     05  CLMTYPBL PIC S9(0004) COMP.
  3536     05  CLMTYPBF PIC  X(0001).
  3537     05  FILLER REDEFINES CLMTYPBF.
  3538         10  CLMTYPBA PIC  X(0001).
  3539     05  CLMTYPBI PIC  X(0006).
  3540*    -------------------------------
  3541     05  INCURBL PIC S9(0004) COMP.
  3542     05  INCURBF PIC  X(0001).
  3543     05  FILLER REDEFINES INCURBF.
  3544         10  INCURBA PIC  X(0001).
  3545     05  INCURBI PIC  X(0008).
  3546*    -------------------------------
  3547     05  PYFROMBL PIC S9(0004) COMP.
  3548     05  PYFROMBF PIC  X(0001).
  3549     05  FILLER REDEFINES PYFROMBF.
  3550         10  PYFROMBA PIC  X(0001).
  3551     05  PYFROMBI PIC  X(0008).
  3552*    -------------------------------
  3553     05  PYTHRUBL PIC S9(0004) COMP.
  3554     05  PYTHRUBF PIC  X(0001).
  3555     05  FILLER REDEFINES PYTHRUBF.
  3556         10  PYTHRUBA PIC  X(0001).
  3557     05  PYTHRUBI PIC  X(0008).
  3558*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  70
* EL156.cbl
  3559     05  DAYSBL PIC S9(0004) COMP.
  3560     05  DAYSBF PIC  X(0001).
  3561     05  FILLER REDEFINES DAYSBF.
  3562         10  DAYSBA PIC  X(0001).
  3563     05  DAYSBI PIC  X(0005).
  3564*    -------------------------------
  3565     05  BYBL PIC S9(0004) COMP.
  3566     05  BYBF PIC  X(0001).
  3567     05  FILLER REDEFINES BYBF.
  3568         10  BYBA PIC  X(0001).
  3569     05  BYBI PIC  X(0004).
  3570*    -------------------------------
  3571     05  PROOFDBL PIC S9(0004) COMP.
  3572     05  PROOFDBF PIC  X(0001).
  3573     05  FILLER REDEFINES PROOFDBF.
  3574         10  PROOFDBA PIC  X(0001).
  3575     05  PROOFDBI PIC  X(0008).
  3576*    -------------------------------
  3577     05  ACCTBL PIC S9(0004) COMP.
  3578     05  ACCTBF PIC  X(0001).
  3579     05  FILLER REDEFINES ACCTBF.
  3580         10  ACCTBA PIC  X(0001).
  3581     05  ACCTBI PIC  X(0010).
  3582*    -------------------------------
  3583     05  STATEBL PIC S9(0004) COMP.
  3584     05  STATEBF PIC  X(0001).
  3585     05  FILLER REDEFINES STATEBF.
  3586         10  STATEBA PIC  X(0001).
  3587     05  STATEBI PIC  X(0002).
  3588*    -------------------------------
  3589     05  GROUPBL PIC S9(0004) COMP.
  3590     05  GROUPBF PIC  X(0001).
  3591     05  FILLER REDEFINES GROUPBF.
  3592         10  GROUPBA PIC  X(0001).
  3593     05  GROUPBI PIC  X(0006).
  3594*    -------------------------------
  3595     05  ACARRBL PIC S9(0004) COMP.
  3596     05  ACARRBF PIC  X(0001).
  3597     05  FILLER REDEFINES ACARRBF.
  3598         10  ACARRBA PIC  X(0001).
  3599     05  ACARRBI PIC  X(0001).
  3600*    -------------------------------
  3601     05  ACCTNMBL PIC S9(0004) COMP.
  3602     05  ACCTNMBF PIC  X(0001).
  3603     05  FILLER REDEFINES ACCTNMBF.
  3604         10  ACCTNMBA PIC  X(0001).
  3605     05  ACCTNMBI PIC  X(0030).
  3606*    -------------------------------
  3607     05  UNDISBL PIC S9(0004) COMP.
  3608     05  UNDISBF PIC  X(0001).
  3609     05  FILLER REDEFINES UNDISBF.
  3610         10  UNDISBA PIC  X(0001).
  3611     05  UNDISBI PIC  X(0010).
  3612*    -------------------------------
  3613     05  RATEBL PIC S9(0004) COMP.
  3614     05  RATEBF PIC  X(0001).
  3615     05  FILLER REDEFINES RATEBF.
  3616         10  RATEBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  71
* EL156.cbl
  3617     05  RATEBI PIC  X(0006).
  3618*    -------------------------------
  3619     05  ERMSG1BL PIC S9(0004) COMP.
  3620     05  ERMSG1BF PIC  X(0001).
  3621     05  FILLER REDEFINES ERMSG1BF.
  3622         10  ERMSG1BA PIC  X(0001).
  3623     05  ERMSG1BI PIC  X(0072).
  3624*    -------------------------------
  3625     05  ENTPFBL PIC S9(0004) COMP.
  3626     05  ENTPFBF PIC  X(0001).
  3627     05  FILLER REDEFINES ENTPFBF.
  3628         10  ENTPFBA PIC  X(0001).
  3629     05  ENTPFBI PIC  99.
  3630 01  EL156BO REDEFINES EL156AI.
  3631     05  FILLER            PIC  X(0012).
  3632*    -------------------------------
  3633     05  FILLER            PIC  X(0003).
  3634     05  RUNDTEBO PIC  X(0008).
  3635*    -------------------------------
  3636     05  FILLER            PIC  X(0003).
  3637     05  RUNTIMBO PIC  99.99.
  3638*    -------------------------------
  3639     05  FILLER            PIC  X(0003).
  3640     05  PAYDTBO PIC  99B99B99.
  3641*    -------------------------------
  3642     05  FILLER            PIC  X(0003).
  3643     05  PAYTYPBO PIC  X(0015).
  3644*    -------------------------------
  3645     05  FILLER            PIC  X(0003).
  3646     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3647*    -------------------------------
  3648     05  FILLER            PIC  X(0003).
  3649     05  LOANHBO PIC  X(0012).
  3650*    -------------------------------
  3651     05  FILLER            PIC  X(0003).
  3652     05  LOANNBO PIC  X(0025).
  3653*    -------------------------------
  3654     05  FILLER            PIC  X(0003).
  3655     05  CKNUMHDO PIC  X(0012).
  3656*    -------------------------------
  3657     05  FILLER            PIC  X(0003).
  3658     05  CKNUMBO PIC  X(0007).
  3659*    -------------------------------
  3660     05  FILLER            PIC  X(0003).
  3661     05  AGTHDGO PIC  X(0016).
  3662*    -------------------------------
  3663     05  FILLER            PIC  X(0003).
  3664     05  NAMEBO PIC  X(0030).
  3665*    -------------------------------
  3666     05  FILLER            PIC  X(0003).
  3667     05  NAMEB2O PIC  X(0030).
  3668*    -------------------------------
  3669     05  FILLER            PIC  X(0003).
  3670     05  ADDR1BO PIC  X(0030).
  3671*    -------------------------------
  3672     05  FILLER            PIC  X(0003).
  3673     05  ADDR1B2O PIC  X(0030).
  3674*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  72
* EL156.cbl
  3675     05  FILLER            PIC  X(0003).
  3676     05  ADDR2BO PIC  X(0030).
  3677*    -------------------------------
  3678     05  FILLER            PIC  X(0003).
  3679     05  ADDR2B2O PIC  X(0030).
  3680*    -------------------------------
  3681     05  FILLER            PIC  X(0003).
  3682     05  CITYSTBO PIC  X(0030).
  3683*    -------------------------------
  3684     05  FILLER            PIC  X(0003).
  3685     05  CITYST2O PIC  X(0030).
  3686*    -------------------------------
  3687     05  FILLER            PIC  X(0003).
  3688     05  ZIPBO PIC  ZZZZ99999.
  3689*    -------------------------------
  3690     05  FILLER            PIC  X(0003).
  3691     05  ZIPB2O PIC  ZZZZZZZZZ.
  3692*    -------------------------------
  3693     05  FILLER            PIC  X(0003).
  3694     05  INTHDBO PIC  X(0012).
  3695*    -------------------------------
  3696     05  FILLER            PIC  X(0003).
  3697     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3698*    -------------------------------
  3699     05  FILLER            PIC  X(0003).
  3700     05  PMTHDGBO PIC  X(0034).
  3701*    -------------------------------
  3702     05  FILLER            PIC  X(0003).
  3703     05  CLMNOBO PIC  X(0007).
  3704*    -------------------------------
  3705     05  FILLER            PIC  X(0003).
  3706     05  CARRBO PIC  X(0001).
  3707*    -------------------------------
  3708     05  FILLER            PIC  X(0003).
  3709     05  CERTNOBO PIC  X(0010).
  3710*    -------------------------------
  3711     05  FILLER            PIC  X(0003).
  3712     05  SUFXBO PIC  X(0001).
  3713*    -------------------------------
  3714     05  FILLER            PIC  X(0003).
  3715     05  CLMTYPBO PIC  X(0006).
  3716*    -------------------------------
  3717     05  FILLER            PIC  X(0003).
  3718     05  INCURBO PIC  X(0008).
  3719*    -------------------------------
  3720     05  FILLER            PIC  X(0003).
  3721     05  PYFROMBO PIC  99B99B99.
  3722*    -------------------------------
  3723     05  FILLER            PIC  X(0003).
  3724     05  PYTHRUBO PIC  99B99B99.
  3725*    -------------------------------
  3726     05  FILLER            PIC  X(0003).
  3727     05  DAYSBO PIC  X(0005).
  3728*    -------------------------------
  3729     05  FILLER            PIC  X(0003).
  3730     05  BYBO PIC  X(0004).
  3731*    -------------------------------
  3732     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  73
* EL156.cbl
  3733     05  PROOFDBO PIC  99B99B99.
  3734*    -------------------------------
  3735     05  FILLER            PIC  X(0003).
  3736     05  ACCTBO PIC  X(0010).
  3737*    -------------------------------
  3738     05  FILLER            PIC  X(0003).
  3739     05  STATEBO PIC  X(0002).
  3740*    -------------------------------
  3741     05  FILLER            PIC  X(0003).
  3742     05  GROUPBO PIC  X(0006).
  3743*    -------------------------------
  3744     05  FILLER            PIC  X(0003).
  3745     05  ACARRBO PIC  X(0001).
  3746*    -------------------------------
  3747     05  FILLER            PIC  X(0003).
  3748     05  ACCTNMBO PIC  X(0030).
  3749*    -------------------------------
  3750     05  FILLER            PIC  X(0003).
  3751     05  UNDISBO PIC  ZZZ,Z99.99.
  3752*    -------------------------------
  3753     05  FILLER            PIC  X(0003).
  3754     05  RATEBO PIC  ZZZ.99.
  3755*    -------------------------------
  3756     05  FILLER            PIC  X(0003).
  3757     05  ERMSG1BO PIC  X(0072).
  3758*    -------------------------------
  3759     05  FILLER            PIC  X(0003).
  3760     05  ENTPFBO PIC  X(0002).
  3761*    -------------------------------
  3762****************************************************************
  3763*
  3764* Copyright (c) 2007-2013 Dell Inc.
  3765* All rights reserved.
  3766*
  3767****************************************************************
  3768 01  DFHEIV.
  3769   02  DFHEIV0               PIC X(35).
  3770   02  DFHEIV1               PIC X(08).
  3771   02  DFHEIV2               PIC X(08).
  3772   02  DFHEIV3               PIC X(08).
  3773   02  DFHEIV4               PIC X(06).
  3774   02  DFHEIV5               PIC X(04).
  3775   02  DFHEIV6               PIC X(04).
  3776   02  DFHEIV7               PIC X(02).
  3777   02  DFHEIV8               PIC X(02).
  3778   02  DFHEIV9               PIC X(01).
  3779   02  DFHEIV10              PIC S9(7) COMP-3.
  3780   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3781   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3782   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3783   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3784   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3785   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3786   02  DFHEIV17              PIC X(04).
  3787   02  DFHEIV18              PIC X(04).
  3788   02  DFHEIV19              PIC X(04).
  3789   02  DFHEIV20              USAGE IS POINTER.
  3790   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  74
* EL156.cbl
  3791   02  DFHEIV22              USAGE IS POINTER.
  3792   02  DFHEIV23              USAGE IS POINTER.
  3793   02  DFHEIV24              USAGE IS POINTER.
  3794   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3795   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3796   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3797   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3798   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3799   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3800   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3801   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3802   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3803   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3804   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3805   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3806   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3807   02  FILLER                PIC X(02).
  3808   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3809   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3810   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3811   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3812   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3813   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3814   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3815 LINKAGE  SECTION.
  3816*****************************************************************
  3817*                                                               *
  3818* Copyright (c) 2007-2013 Dell Inc.                             *
  3819* All rights reserved.                                          *
  3820*                                                               *
  3821*****************************************************************
  3822 01  dfheiblk.
  3823     02  eibtime          pic s9(7) comp-3.
  3824     02  eibdate          pic s9(7) comp-3.
  3825     02  eibtrnid         pic x(4).
  3826     02  eibtaskn         pic s9(7) comp-3.
  3827     02  eibtrmid         pic x(4).
  3828     02  dfheigdi         pic s9(4) comp.
  3829     02  eibcposn         pic s9(4) comp.
  3830     02  eibcalen         pic s9(4) comp.
  3831     02  eibaid           pic x(1).
  3832     02  eibfiller1       pic x(1).
  3833     02  eibfn            pic x(2).
  3834     02  eibfiller2       pic x(2).
  3835     02  eibrcode         pic x(6).
  3836     02  eibfiller3       pic x(2).
  3837     02  eibds            pic x(8).
  3838     02  eibreqid         pic x(8).
  3839     02  eibrsrce         pic x(8).
  3840     02  eibsync          pic x(1).
  3841     02  eibfree          pic x(1).
  3842     02  eibrecv          pic x(1).
  3843     02  eibsend          pic x(1).
  3844     02  eibatt           pic x(1).
  3845     02  eibeoc           pic x(1).
  3846     02  eibfmh           pic x(1).
  3847     02  eibcompl         pic x(1).
  3848     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  75
* EL156.cbl
  3849     02  eibconf          pic x(1).
  3850     02  eiberr           pic x(1).
  3851     02  eibrldbk         pic x(1).
  3852     02  eiberrcd         pic x(4).
  3853     02  eibsynrb         pic x(1).
  3854     02  eibnodat         pic x(1).
  3855     02  eibfiller5       pic x(2).
  3856     02  eibresp          pic s9(8) comp.
  3857     02  eibresp2         pic s9(8) comp.
  3858     02  dfheigdj         pic s9(4) comp.
  3859     02  dfheigdk         pic s9(4) comp.
  3860 01  DFHCOMMAREA             PIC X(1024).
  3861
  3862*    COPY ELCMSTR.
  3863******************************************************************
  3864*                                                                *
  3865*                            ELCMSTR.                            *
  3866*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3867*                            VMOD=2.012                          *
  3868*                                                                *
  3869*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3870*                                                                *
  3871*   FILE TYPE = VSAM,KSDS                                        *
  3872*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3873*                                                                *
  3874*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3875*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3876*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3877*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3878*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3879*                                                 RKP=75,LEN=21  *
  3880*                                                                *
  3881*   **** NOTE ****                                               *
  3882*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3883*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3884*                                                                *
  3885*   LOG = YES                                                    *
  3886*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3887******************************************************************
  3888*                   C H A N G E   L O G
  3889*
  3890* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3891*-----------------------------------------------------------------
  3892*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3893* EFFECTIVE    NUMBER
  3894*-----------------------------------------------------------------
  3895* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3896* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3897* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3898* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3899* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3900* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3901******************************************************************
  3902 01  CLAIM-MASTER.
  3903     12  CL-RECORD-ID                PIC XX.
  3904         88  VALID-CL-ID         VALUE 'CL'.
  3905
  3906     12  CL-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  76
* EL156.cbl
  3907         16  CL-COMPANY-CD           PIC X.
  3908         16  CL-CARRIER              PIC X.
  3909         16  CL-CLAIM-NO             PIC X(7).
  3910         16  CL-CERT-NO.
  3911             20  CL-CERT-PRIME       PIC X(10).
  3912             20  CL-CERT-SFX         PIC X.
  3913
  3914     12  CL-CONTROL-BY-NAME.
  3915         16  CL-COMPANY-CD-A1        PIC X.
  3916         16  CL-INSURED-LAST-NAME    PIC X(15).
  3917         16  CL-INSURED-NAME.
  3918             20  CL-INSURED-1ST-NAME PIC X(12).
  3919             20  CL-INSURED-MID-INIT PIC X.
  3920
  3921     12  CL-CONTROL-BY-SSN.
  3922         16  CL-COMPANY-CD-A2        PIC X.
  3923         16  CL-SOC-SEC-NO.
  3924             20  CL-SSN-STATE        PIC XX.
  3925             20  CL-SSN-ACCOUNT      PIC X(6).
  3926             20  CL-SSN-LN3          PIC X(3).
  3927
  3928     12  CL-CONTROL-BY-CERT-NO.
  3929         16  CL-COMPANY-CD-A4        PIC X.
  3930         16  CL-CERT-NO-A4.
  3931             20  CL-CERT-A4-PRIME    PIC X(10).
  3932             20  CL-CERT-A4-SFX      PIC X.
  3933
  3934     12  CL-CONTROL-BY-CCN.
  3935         16  CL-COMPANY-CD-A5        PIC X.
  3936         16  CL-CCN-A5.
  3937             20  CL-CCN.
  3938                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3939                 24  CL-CCN-PRIME-A5 PIC X(12).
  3940             20  CL-CCN-FILLER-A5    PIC X(4).
  3941
  3942     12  CL-INSURED-PROFILE-DATA.
  3943         16  CL-INSURED-BIRTH-DT     PIC XX.
  3944         16  CL-INSURED-SEX-CD       PIC X.
  3945             88  INSURED-IS-MALE        VALUE 'M'.
  3946             88  INSURED-IS-FEMALE      VALUE 'F'.
  3947             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3948         16  CL-INSURED-OCC-CD       PIC X(6).
  3949         16  FILLER                  PIC X(5).
  3950
  3951     12  CL-PROCESSING-INFO.
  3952         16  CL-PROCESSOR-ID         PIC X(4).
  3953         16  CL-CLAIM-STATUS         PIC X.
  3954             88  CLAIM-IS-OPEN          VALUE 'O'.
  3955             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3956         16  CL-CLAIM-TYPE           PIC X.
  3957*            88  AH-CLAIM               VALUE 'A'.
  3958*            88  LIFE-CLAIM             VALUE 'L'.
  3959*            88  PROPERTY-CLAIM         VALUE 'P'.
  3960*            88  IUI-CLAIM              VALUE 'I'.
  3961*            88  GAP-CLAIM              VALUE 'G'.
  3962*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3963         16  CL-CLAIM-PREM-TYPE      PIC X.
  3964             88  SINGLE-PREMIUM         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  77
* EL156.cbl
  3965             88  O-B-COVERAGE           VALUE '2'.
  3966             88  OPEN-END-COVERAGE      VALUE '3'.
  3967         16  CL-INCURRED-DT          PIC XX.
  3968         16  CL-REPORTED-DT          PIC XX.
  3969         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3970         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3971         16  CL-LAST-PMT-DT          PIC XX.
  3972         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3973         16  CL-PAID-THRU-DT         PIC XX.
  3974         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3975         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3976         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3977         16  CL-PMT-CALC-METHOD      PIC X.
  3978             88  CL-360-DAY-YR          VALUE '1'.
  3979             88  CL-365-DAY-YR          VALUE '2'.
  3980             88  CL-FULL-MONTHS         VALUE '3'.
  3981         16  CL-CAUSE-CD             PIC X(6).
  3982
  3983         16  CL-PRIME-CERT-NO.
  3984             20  CL-PRIME-CERT-PRIME PIC X(10).
  3985             20  CL-PRIME-CERT-SFX   PIC X.
  3986
  3987         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3988             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3989             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3990
  3991         16  CL-MICROFILM-NO         PIC X(10).
  3992         16  FILLER REDEFINES CL-MICROFILM-NO.
  3993             20  CL-BENEFIT-PERIOD   PIC 99.
  3994             20  FILLER              PIC X(8).
  3995         16  CL-PROG-FORM-TYPE       PIC X.
  3996         16  CL-LAST-ADD-ON-DT       PIC XX.
  3997
  3998         16  CL-LAST-REOPEN-DT       PIC XX.
  3999         16  CL-LAST-CLOSE-DT        PIC XX.
  4000         16  CL-LAST-CLOSE-REASON    PIC X(01).
  4001             88  FINAL-PAID             VALUE '1'.
  4002             88  CLAIM-DENIED           VALUE '2'.
  4003             88  AUTO-CLOSE             VALUE '3'.
  4004             88  MANUAL-CLOSE           VALUE '4'.
  4005             88  BENEFITS-CHANGED       VALUE 'C'.
  4006             88  SETUP-ERRORS           VALUE 'E'.
  4007         16  CL-ASSOC-CERT-SEQU      PIC S99.
  4008         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  4009         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  4010             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  4011         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  4012         16  FILLER                  PIC X.
  4013
  4014     12  CL-CERTIFICATE-DATA.
  4015         16  CL-CERT-ORIGIN          PIC X.
  4016             88  CERT-WAS-ONLINE        VALUE '1'.
  4017             88  CERT-WAS-CREATED       VALUE '2'.
  4018             88  COVERAGE-WAS-ADDED     VALUE '3'.
  4019         16  CL-CERT-KEY-DATA.
  4020             20  CL-CERT-CARRIER     PIC X.
  4021             20  CL-CERT-GROUPING    PIC X(6).
  4022             20  CL-CERT-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  78
* EL156.cbl
  4023             20  CL-CERT-ACCOUNT.
  4024                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4025                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4026             20  CL-CERT-EFF-DT      PIC XX.
  4027
  4028     12  CL-STATUS-CONTROLS.
  4029         16  CL-PRIORITY-CD          PIC X.
  4030             88  CONFIDENTIAL-DATA      VALUE '8'.
  4031             88  HIGHEST-PRIORITY       VALUE '9'.
  4032         16  CL-SUPV-ATTN-CD         PIC X.
  4033             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4034             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4035         16  CL-PURGED-DT            PIC XX.
  4036         16  CL-RESTORED-DT          PIC XX.
  4037         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4038         16  CL-NEXT-RESEND-DT       PIC XX.
  4039         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4040         16  CL-CRITICAL-PERIOD      PIC 99.
  4041*        16  FILLER                  PIC XX.
  4042         16  CL-LAST-MAINT-DT        PIC XX.
  4043         16  CL-LAST-MAINT-USER      PIC X(4).
  4044         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4045         16  CL-LAST-MAINT-TYPE      PIC X.
  4046             88  CLAIM-SET-UP           VALUE ' '.
  4047             88  PAYMENT-MADE           VALUE '1'.
  4048             88  LETTER-SENT            VALUE '2'.
  4049             88  MASTER-WAS-ALTERED     VALUE '3'.
  4050             88  MASTER-WAS-RESTORED    VALUE '4'.
  4051             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4052             88  FILE-CONVERTED         VALUE '6'.
  4053             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4054             88  ERROR-CORRECTION       VALUE 'E'.
  4055         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4056         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4057         16  CL-BENEFICIARY          PIC X(10).
  4058         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4059         16  CL-DENIAL-TYPE          PIC X.
  4060             88  CL-TYPE-DENIAL          VALUE '1'.
  4061             88  CL-TYPE-RESCISSION      VALUE '2'.
  4062             88  CL-TYPE-REFORMATION     VALUE '3'.
  4063             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4064             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4065         16  CL-NO-OF-EXTENSIONS     PIC 99.
  4066         16  filler                  pic x(3).
  4067*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4068*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4069*        16  CL-RTW-DT               PIC XX.
  4070
  4071     12  CL-TRAILER-CONTROLS.
  4072         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4073             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4074             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4075             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4076         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4077         16  FILLER                  PIC XX.
  4078         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4079         16  CL-ADDRESS-TRAILER-CNT.
  4080             20  CL-INSURED-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  79
* EL156.cbl
  4081                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4082             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4083                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4084             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4085                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4086             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4087                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4088             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4089                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4090             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4091                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4092             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4093                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4094
  4095     12  CL-CV-REFERENCE-NO.
  4096         16  CL-CV-REFNO-PRIME       PIC X(18).
  4097         16  CL-CV-REFNO-SFX         PIC XX.
  4098
  4099     12  CL-FILE-LOCATION            PIC X(4).
  4100
  4101     12  CL-PROCESS-ERRORS.
  4102         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4103             88  NO-FATAL-ERRORS        VALUE ZERO.
  4104         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4105             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4106
  4107     12  CL-PRODUCT-CD               PIC X.
  4108
  4109     12  CL-CURRENT-KEY-DATA.
  4110         16  CL-CURRENT-CARRIER      PIC X.
  4111         16  CL-CURRENT-GROUPING     PIC X(6).
  4112         16  CL-CURRENT-STATE        PIC XX.
  4113         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4114
  4115     12  CL-ASSOCIATES               PIC X.
  4116         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4117         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4118         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4119         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4120
  4121     12  CL-ACTIVITY-CODE            PIC 99.
  4122     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4123     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4124
  4125     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4126     12  CL-LAG-REPORT-CODE          PIC 9.
  4127     12  CL-LOAN-TYPE                PIC XX.
  4128     12  CL-LEGAL-STATE              PIC XX.
  4129
  4130     12  CL-YESNOSW                  PIC X.
  4131     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4132         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4133         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4134         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4135     12  cl-insured-type             pic x.
  4136         88  cl-claim-on-primary         value 'P'.
  4137         88  cl-claim-on-co-borrower     value 'C'.
  4138     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  80
* EL156.cbl
  4140*    COPY ELCCNTL.
  4141******************************************************************
  4142*                                                                *
  4143*                                                                *
  4144*                            ELCCNTL.                            *
  4145*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4146*                            VMOD=2.059                          *
  4147*                                                                *
  4148*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4149*                                                                *
  4150*   FILE TYPE = VSAM,KSDS                                        *
  4151*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4152*                                                                *
  4153*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4154*       ALTERNATE INDEX = NONE                                   *
  4155*                                                                *
  4156*   LOG = YES                                                    *
  4157*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4158******************************************************************
  4159*                   C H A N G E   L O G
  4160*
  4161* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4162*-----------------------------------------------------------------
  4163*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4164* EFFECTIVE    NUMBER
  4165*-----------------------------------------------------------------
  4166* 082503                   PEMA  ADD BENEFIT GROUP
  4167* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4168* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4169* 092705    2005050300006  PEMA  ADD SPP LEASES
  4170* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4171* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4172* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4173* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4174* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4175* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4176* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4177* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4178* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4179* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4180* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4181******************************************************************
  4182*
  4183 01  CONTROL-FILE.
  4184     12  CF-RECORD-ID                       PIC XX.
  4185         88  VALID-CF-ID                        VALUE 'CF'.
  4186
  4187     12  CF-CONTROL-PRIMARY.
  4188         16  CF-COMPANY-ID                  PIC XXX.
  4189         16  CF-RECORD-TYPE                 PIC X.
  4190             88  CF-COMPANY-MASTER              VALUE '1'.
  4191             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4192             88  CF-STATE-MASTER                VALUE '3'.
  4193             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4194             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4195             88  CF-CARRIER-MASTER              VALUE '6'.
  4196             88  CF-MORTALITY-MASTER            VALUE '7'.
  4197             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  81
* EL156.cbl
  4198             88  CF-TERMINAL-MASTER             VALUE '9'.
  4199             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4200             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4201             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4202             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4203             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4204             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4205             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4206             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4207             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4208         16  CF-ACCESS-CD-GENL              PIC X(4).
  4209         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4210             20  CF-PROCESSOR               PIC X(4).
  4211         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4212             20  CF-STATE-CODE              PIC XX.
  4213             20  FILLER                     PIC XX.
  4214         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4215             20  FILLER                     PIC XX.
  4216             20  CF-HI-BEN-IN-REC           PIC XX.
  4217         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4218             20  FILLER                     PIC XXX.
  4219             20  CF-CARRIER-CNTL            PIC X.
  4220         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4221             20  FILLER                     PIC XX.
  4222             20  CF-HI-TYPE-IN-REC          PIC 99.
  4223         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4224             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4225                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4226             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4227             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4228         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4229             20  FILLER                     PIC X.
  4230             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4231         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4232             20  FILLER                     PIC XX.
  4233             20  CF-MORTGAGE-PLAN           PIC XX.
  4234         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4235
  4236     12  CF-LAST-MAINT-DT                   PIC XX.
  4237     12  CF-LAST-MAINT-BY                   PIC X(4).
  4238     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4239
  4240     12  CF-RECORD-BODY                     PIC X(728).
  4241
  4242
  4243****************************************************************
  4244*             COMPANY MASTER RECORD                            *
  4245****************************************************************
  4246
  4247     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4248         16  CF-COMPANY-ADDRESS.
  4249             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4250             20  CF-CL-IN-CARE-OF           PIC X(30).
  4251             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4252             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4253             20  CF-CL-CITY-STATE           PIC X(30).
  4254             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4255             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  82
* EL156.cbl
  4256         16  CF-COMPANY-CD                  PIC X.
  4257         16  CF-COMPANY-PASSWORD            PIC X(8).
  4258         16  CF-SECURITY-OPTION             PIC X.
  4259             88  ALL-SECURITY                   VALUE '1'.
  4260             88  COMPANY-VERIFY                 VALUE '2'.
  4261             88  PROCESSOR-VERIFY               VALUE '3'.
  4262             88  NO-SECURITY                    VALUE '4'.
  4263             88  ALL-BUT-TERM                   VALUE '5'.
  4264         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4265             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4266         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4267             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4268         16  CF-INFORCE-LOCATION            PIC X.
  4269             88  CERTS-ARE-ONLINE               VALUE '1'.
  4270             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4271             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4272         16  CF-LOWER-CASE-LETTERS          PIC X.
  4273         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4274             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4275             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4276             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4277             88  CF-ACCNT-CNTL                  VALUE '3'.
  4278             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4279
  4280         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4281         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4282
  4283         16  CF-LGX-CREDIT-USER             PIC X.
  4284             88  CO-IS-NOT-USER                 VALUE 'N'.
  4285             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4286
  4287         16 CF-CREDIT-CALC-CODES.
  4288             20  CF-CR-REM-TERM-CALC PIC X.
  4289               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4290               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4291               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4292               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4293               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4294               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4295               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4296             20  CF-CR-R78-METHOD           PIC X.
  4297               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4298               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4299
  4300         16  CF-CLAIM-CONTROL-COUNTS.
  4301             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4302                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4303
  4304             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4305                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4306
  4307             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4308                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4309
  4310             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4311                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4312
  4313         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  83
* EL156.cbl
  4314
  4315         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4316             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4317             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4318             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4319             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4320                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4321                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4322             20  CF-CO-PREM-REJECT-SW       PIC X.
  4323                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4324                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4325             20  CF-CO-REF-REJECT-SW        PIC X.
  4326                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4327                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4328
  4329         16  CF-CO-REPORTING-DT             PIC XX.
  4330         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4331         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4332           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4333           88  CF-CO-MONTH-END                  VALUE '1'.
  4334
  4335         16  CF-LGX-CLAIM-USER              PIC X.
  4336             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4337             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4338
  4339         16  CF-CREDIT-EDIT-CONTROLS.
  4340             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4341             20  CF-MIN-AGE                 PIC 99.
  4342             20  CF-DEFAULT-AGE             PIC 99.
  4343             20  CF-MIN-TERM                PIC S999      COMP-3.
  4344             20  CF-MAX-TERM                PIC S999      COMP-3.
  4345             20  CF-DEFAULT-SEX             PIC X.
  4346             20  CF-JOINT-AGE-INPUT         PIC X.
  4347                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4348             20  CF-BIRTH-DATE-INPUT        PIC X.
  4349                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4350             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4351                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4352                 88  CF-ZERO-CARRIER            VALUE '1'.
  4353                 88  CF-ZERO-GROUPING           VALUE '2'.
  4354                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4355             20  CF-EDIT-SW                 PIC X.
  4356                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4357             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4358             20  CF-CR-PR-METHOD            PIC X.
  4359               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4360               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4361             20  FILLER                     PIC X.
  4362
  4363         16  CF-CREDIT-MISC-CONTROLS.
  4364             20  CF-REIN-TABLE-SW           PIC X.
  4365                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4366             20  CF-COMP-TABLE-SW           PIC X.
  4367                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4368             20  CF-EXPERIENCE-RETENTION-AGE
  4369                                            PIC S9        COMP-3.
  4370             20  CF-CONVERSION-DT           PIC XX.
  4371             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  84
* EL156.cbl
  4372             20  CF-RUN-FREQUENCY-SW        PIC X.
  4373                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4374                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4375
  4376             20  CF-CR-CHECK-NO-CONTROL.
  4377                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4378                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4379                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4380                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4381                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4382                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4383
  4384                 24  CF-CR-CHECK-COUNT       REDEFINES
  4385                     CF-CR-CHECK-COUNTER      PIC X(4).
  4386
  4387                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4388                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4389
  4390                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4391                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4392                 24  CF-MAIL-PROCESSING       PIC X.
  4393                     88  MAIL-PROCESSING          VALUE 'Y'.
  4394
  4395         16  CF-MISC-SYSTEM-CONTROL.
  4396             20  CF-SYSTEM-C                 PIC X.
  4397                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4398             20  CF-SYSTEM-D                 PIC X.
  4399                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4400             20  CF-SOC-SEC-NO-SW            PIC X.
  4401                 88  SOC-SEC-NO-USED             VALUE '1'.
  4402             20  CF-MEMBER-NO-SW             PIC X.
  4403                 88  MEMBER-NO-USED              VALUE '1'.
  4404             20  CF-TAX-ID-NUMBER            PIC X(11).
  4405             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4406             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4407                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4408                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4409                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4410                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4411             20  CF-SYSTEM-E                 PIC X.
  4412                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4413
  4414         16  CF-LGX-LIFE-USER               PIC X.
  4415             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4416             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4417
  4418         16  CF-CR-MONTH-END-DT             PIC XX.
  4419
  4420         16  CF-FILE-MAINT-DATES.
  4421             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4422                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4423             20  CF-LAST-BATCH       REDEFINES
  4424                 CF-LAST-BATCH-NO               PIC X(4).
  4425             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4426             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4427             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4428             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4429             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  85
* EL156.cbl
  4430             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4431             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4432             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4433             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4434             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4435
  4436         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4437         16  FILLER                         PIC X.
  4438
  4439         16  CF-ALT-MORT-CODE               PIC X(4).
  4440         16  CF-MEMBER-CAPTION              PIC X(10).
  4441
  4442         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4443             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4444             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4445             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4446             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4447             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4448
  4449         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4450
  4451         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4452         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4453         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4454         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4455
  4456         16  CF-AH-OVERRIDE-L1              PIC X.
  4457         16  CF-AH-OVERRIDE-L2              PIC XX.
  4458         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4459         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4460
  4461         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4462         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4463
  4464         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4465         16  CF-AR-LAST-EL860-DT            PIC XX.
  4466         16  CF-MP-MONTH-END-DT             PIC XX.
  4467
  4468         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4469         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4470             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4471
  4472         16  CF-AR-MONTH-END-DT             PIC XX.
  4473
  4474         16  CF-CRDTCRD-USER                PIC X.
  4475             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4476             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4477
  4478         16  CF-CC-MONTH-END-DT             PIC XX.
  4479
  4480         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4481
  4482         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4483             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4484             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4485             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4486         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4487         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  86
* EL156.cbl
  4488         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4489         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4490             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4491             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4492         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4493         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4494         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4495             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4496         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4497
  4498         16  CF-CL-ZIP-CODE.
  4499             20  CF-CL-ZIP-PRIME.
  4500                 24  CF-CL-ZIP-1ST          PIC X.
  4501                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4502                 24  FILLER                 PIC X(4).
  4503             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4504         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4505             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4506             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4507             20  FILLER                     PIC XXX.
  4508
  4509         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4510         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4511         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4512         16  CF-CO-OPTION-START-DATE        PIC XX.
  4513         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4514           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4515                                                      '3' '4'.
  4516           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4517           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4518           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4519           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4520           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4521           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4522
  4523         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4524
  4525         16  CF-PAYMENT-APPROVAL-LEVELS.
  4526             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4527             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4528             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4529             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4530             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4531             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4532
  4533         16  CF-END-USER-REPORTING-USER     PIC X.
  4534             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4535             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4536
  4537         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4538             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4539             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4540
  4541         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4542
  4543         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4544         16  FILLER                         PIC X.
  4545
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  87
* EL156.cbl
  4546         16  CF-CREDIT-ARCHIVE-CNTL.
  4547             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4548             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4549             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4550
  4551         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4552
  4553         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4554             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4555             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4556
  4557         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4558             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4559             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4560
  4561         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4562
  4563         16  CF-CO-ACH-ID-CODE              PIC  X.
  4564             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4565             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4566             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4567         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4568         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4569         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4570         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4571         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4572         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4573         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4574         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4575         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4576                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4577         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4578                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4579
  4580         16  CF-CO-OVER-SHORT.
  4581             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4582             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4583
  4584*         16  FILLER                         PIC X(102).
  4585         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4586             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4587             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4588
  4589         16  CF-AH-APPROVAL-DAYS.
  4590             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4591             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4592             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4593             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4594
  4595         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4596
  4597         16  CF-APPROV-LEV-5.
  4598             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4599             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4600             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4601
  4602         16  FILLER                         PIC X(68).
  4603****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  88
* EL156.cbl
  4604*             PROCESSOR/USER RECORD                            *
  4605****************************************************************
  4606
  4607     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4608         16  CF-PROCESSOR-NAME              PIC X(30).
  4609         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4610         16  CF-PROCESSOR-TITLE             PIC X(26).
  4611         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4612                 88  MESSAGE-YES                VALUE 'Y'.
  4613                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4614
  4615*****************************************************
  4616****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4617****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4618****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4619****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4620*****************************************************
  4621
  4622         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4623             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4624             20  CF-APPLICATION-FORCE       PIC X.
  4625             20  CF-INDIVIDUAL-APP.
  4626                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4627                     28  CF-BROWSE-APP      PIC X.
  4628                     28  CF-UPDATE-APP      PIC X.
  4629
  4630         16  CF-CURRENT-TERM-ON             PIC X(4).
  4631         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4632             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4633             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4634             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4635             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4636             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4637             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4638             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4639         16  CF-PROCESSOR-CARRIER           PIC X.
  4640             88  NO-CARRIER-SECURITY            VALUE ' '.
  4641         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4642             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4643         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4644             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4645         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4646             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4647
  4648         16  CF-PROC-SYS-ACCESS-SW.
  4649             20  CF-PROC-CREDIT-CLAIMS-SW.
  4650                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4651                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4652                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4653                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4654             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4655                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4656                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4657             20  CF-PROC-LIFE-GNRLDGR-SW.
  4658                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4659                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4660                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4661                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  89
* EL156.cbl
  4662             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4663                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4664                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4665         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4666             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4667             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4668         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4669
  4670         16  CF-APPROVAL-LEVEL                  PIC X.
  4671             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4672             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4673             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4674             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4675             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4676
  4677         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4678
  4679         16  CF-LANGUAGE-TYPE                   PIC X.
  4680             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4681             88  CF-LANG-IS-FR                      VALUE 'F'.
  4682
  4683         16  CF-CSR-IND                         PIC X.
  4684         16  FILLER                             PIC X(239).
  4685
  4686****************************************************************
  4687*             PROCESSOR/REMINDERS RECORD                       *
  4688****************************************************************
  4689
  4690     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4691         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4692             20  CF-START-REMIND-DT         PIC XX.
  4693             20  CF-END-REMIND-DT           PIC XX.
  4694             20  CF-REMINDER-TEXT           PIC X(50).
  4695         16  FILLER                         PIC X(296).
  4696
  4697
  4698****************************************************************
  4699*             STATE MASTER RECORD                              *
  4700****************************************************************
  4701
  4702     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4703         16  CF-STATE-ABBREVIATION          PIC XX.
  4704         16  CF-STATE-NAME                  PIC X(25).
  4705         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4706         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4707             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4708             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4709             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4710             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4711                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4712                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4713             20  CF-ST-PREM-REJECT-SW       PIC X.
  4714                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4715                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4716             20  CF-ST-REF-REJECT-SW        PIC X.
  4717                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4718                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4719         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  90
* EL156.cbl
  4720         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4721         16  CF-ST-REFUND-RULES.
  4722             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4723             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4724             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4725         16  CF-ST-FST-PMT-EXTENSION.
  4726             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4727             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4728                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4729                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4730                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4731                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4732         16  CF-ST-STATE-CALL.
  4733             20  CF-ST-CALL-UNEARNED        PIC X.
  4734             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4735             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4736         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4737             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4738             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4739         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4740         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4741         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4742         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4743         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4744         16  FILLER                         PIC X.
  4745         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4746             20  CF-ST-BENEFIT-CD           PIC XX.
  4747             20  CF-ST-BENEFIT-KIND         PIC X.
  4748                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4749                 88  CF-ST-AH-KIND              VALUE 'A'.
  4750             20  CF-ST-REM-TERM-CALC        PIC X.
  4751                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4752                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4753                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4754                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4755                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4756                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4757                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4758                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4759
  4760             20  CF-ST-REFUND-CALC          PIC X.
  4761                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4762                 88  ST-REFD-BY-R78             VALUE '1'.
  4763                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4764                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4765                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4766                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4767                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4768                 88  ST-REFD-UTAH               VALUE '7'.
  4769                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4770                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4771                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4772
  4773             20  CF-ST-EARNING-CALC         PIC X.
  4774                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4775                 88  ST-EARN-BY-R78             VALUE '1'.
  4776                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4777                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  91
* EL156.cbl
  4778                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4779                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4780                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4781                 88  ST-EARN-MEAN               VALUE '8'.
  4782                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4783
  4784             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4785                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4786                 88  ST-OVRD-BY-R78             VALUE '1'.
  4787                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4788                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4789                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4790                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4791                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4792                 88  ST-OVRD-MEAN               VALUE '8'.
  4793                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4794             20  cf-st-extra-periods        pic 9.
  4795*            20  FILLER                     PIC X.
  4796
  4797         16  CF-ST-COMMISSION-CAPS.
  4798             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4799             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4800             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4801             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4802         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4803                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4804                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4805                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4806
  4807         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4808
  4809         16  CF-ST-STATUTORY-INTEREST.
  4810             20  CF-ST-STAT-DATE-FROM       PIC X.
  4811                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4812                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4813             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4814             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4815             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4816             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4817             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4818
  4819         16  CF-ST-OVER-SHORT.
  4820             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4821             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4822
  4823         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4824
  4825         16  CF-ST-RT-CALC                  PIC X.
  4826
  4827         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4828         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4829         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4830         16  CF-ST-RF-LR-CALC               PIC X.
  4831         16  CF-ST-RF-LL-CALC               PIC X.
  4832         16  CF-ST-RF-LN-CALC               PIC X.
  4833         16  CF-ST-RF-AH-CALC               PIC X.
  4834         16  CF-ST-RF-CP-CALC               PIC X.
  4835*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  92
* EL156.cbl
  4836*CIDMOD         16  FILLER                         PIC X(192).
  4837         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4838             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4839         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4840         16  CF-ST-VFY-2ND-BENE             PIC X.
  4841         16  CF-ST-CAUSAL-STATE             PIC X.
  4842         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4843         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4844         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4845             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4846         16  CF-ST-NET-ONLY-STATE           PIC X.
  4847             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4848         16  cf-commission-cap-required     pic x.
  4849         16  CF-ST-GA-COMMISSION-CAPS.
  4850             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4851             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4852             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4853             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4854         16  CF-ST-TOT-COMMISSION-CAPS.
  4855             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4856             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4857             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4858             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4859         16  FILLER                         PIC X(156).
  4860
  4861****************************************************************
  4862*             BENEFIT MASTER RECORD                            *
  4863****************************************************************
  4864
  4865     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4866         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4867             20  CF-BENEFIT-CODE            PIC XX.
  4868             20  CF-BENEFIT-NUMERIC  REDEFINES
  4869                 CF-BENEFIT-CODE            PIC XX.
  4870             20  CF-BENEFIT-ALPHA           PIC XXX.
  4871             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4872             20  CF-BENEFIT-COMMENT         PIC X(10).
  4873
  4874             20  CF-LF-COVERAGE-TYPE        PIC X.
  4875                 88  CF-REDUCING                VALUE 'R'.
  4876                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4877
  4878             20  CF-SPECIAL-CALC-CD         PIC X.
  4879                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4880                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4881                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4882                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4883                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4884                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4885                 88  CF-FARM-PLAN               VALUE 'F'.
  4886                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4887                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4888                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4889                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4890                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4891                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4892                 88  CF-PRUDENTIAL              VALUE 'P'.
  4893                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  93
* EL156.cbl
  4894                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4895                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4896                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4897                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4898                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4899
  4900             20  CF-JOINT-INDICATOR         PIC X.
  4901                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4902
  4903*            20  FILLER                     PIC X(12).
  4904             20  cf-maximum-benefits        pic s999 comp-3.
  4905             20  FILLER                     PIC X(09).
  4906             20  CF-BENEFIT-CATEGORY        PIC X.
  4907             20  CF-LOAN-TYPE               PIC X(8).
  4908
  4909             20  CF-CO-REM-TERM-CALC        PIC X.
  4910                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4911                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4912                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4913                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4914                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4915
  4916             20  CF-CO-EARNINGS-CALC        PIC X.
  4917                 88  CO-EARN-BY-R78             VALUE '1'.
  4918                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4919                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4920                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4921                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4922                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4923                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4924                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4925
  4926             20  CF-CO-REFUND-CALC          PIC X.
  4927                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4928                 88  CO-REFD-BY-R78             VALUE '1'.
  4929                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4930                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4931                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4932                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4933                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4934                 88  CO-REFD-MEAN               VALUE '8'.
  4935                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4936                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4937                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4938
  4939             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4940                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4941                 88  CO-OVRD-BY-R78             VALUE '1'.
  4942                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4943                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4944                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4945                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4946                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4947                 88  CO-OVRD-MEAN               VALUE '8'.
  4948                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4949
  4950             20  CF-CO-BEN-I-G-CD           PIC X.
  4951                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  94
* EL156.cbl
  4952                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4953                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4954
  4955         16  FILLER                         PIC X(304).
  4956
  4957
  4958****************************************************************
  4959*             CARRIER MASTER RECORD                            *
  4960****************************************************************
  4961
  4962     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4963         16  CF-ADDRESS-DATA.
  4964             20  CF-MAIL-TO-NAME            PIC X(30).
  4965             20  CF-IN-CARE-OF              PIC X(30).
  4966             20  CF-ADDRESS-LINE-1          PIC X(30).
  4967             20  CF-ADDRESS-LINE-2          PIC X(30).
  4968             20  CF-CITY-STATE              PIC X(30).
  4969             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4970             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4971
  4972         16  CF-CLAIM-NO-CONTROL.
  4973             20  CF-CLAIM-NO-METHOD         PIC X.
  4974                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4975                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4976                 88  CLAIM-NO-SEQ               VALUE '3'.
  4977                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4978             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4979                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4980                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4981                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4982
  4983         16  CF-CHECK-NO-CONTROL.
  4984             20  CF-CHECK-NO-METHOD         PIC X.
  4985                 88  CHECK-NO-MANUAL            VALUE '1'.
  4986                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4987                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4988                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4989             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4990                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4991
  4992         16  CF-DOMICILE-STATE              PIC XX.
  4993
  4994         16  CF-EXPENSE-CONTROLS.
  4995             20  CF-EXPENSE-METHOD          PIC X.
  4996                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4997                 88  DOLLARS-PER-PMT            VALUE '2'.
  4998                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4999                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5000             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5001             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5002
  5003         16  CF-CORRESPONDENCE-CONTROL.
  5004             20  CF-LETTER-RESEND-OPT       PIC X.
  5005                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5006                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5007             20  FILLER                     PIC X(4).
  5008
  5009         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  95
* EL156.cbl
  5010             20  CF-MANUAL-SW               PIC X.
  5011                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5012             20  CF-FUTURE-SW               PIC X.
  5013                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5014             20  CF-PTC-SW                  PIC X.
  5015                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5016             20  CF-IBNR-SW                 PIC X.
  5017                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5018             20  CF-PTC-LF-SW               PIC X.
  5019                 88  CF-LF-PTC-USED             VALUE '1'.
  5020             20  CF-CDT-ACCESS-METHOD       PIC X.
  5021                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5022                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5023                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5024             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5025
  5026         16  CF-CLAIM-CALC-METHOD           PIC X.
  5027             88  360-PLUS-MONTHS                VALUE '1'.
  5028             88  365-PLUS-MONTHS                VALUE '2'.
  5029             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5030             88  360-DAILY                      VALUE '4'.
  5031             88  365-DAILY                      VALUE '5'.
  5032
  5033         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5034         16  FILLER                         PIC X(11).
  5035
  5036         16  CF-LIMIT-AMOUNTS.
  5037             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5038             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5039             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5040             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5041             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5042             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5043             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5044             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5045             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5046             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5047
  5048         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5049         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5050         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5051
  5052         16  CF-ZIP-CODE.
  5053             20  CF-ZIP-PRIME.
  5054                 24  CF-ZIP-1ST             PIC X.
  5055                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5056                 24  FILLER                 PIC X(4).
  5057             20  CF-ZIP-PLUS4               PIC X(4).
  5058         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5059             20  CF-CAN-POSTAL-1            PIC XXX.
  5060             20  CF-CAN-POSTAL-2            PIC XXX.
  5061             20  FILLER                     PIC XXX.
  5062
  5063         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5064         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5065         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5066
  5067         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  96
* EL156.cbl
  5068             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5069             88  CF-NO-RATING                   VALUE 'N'.
  5070
  5071         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5072
  5073         16  CF-CARRIER-OVER-SHORT.
  5074             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5075             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5076
  5077         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5078         16  CF-SECPAY-SWITCH               PIC X.
  5079             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5080             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5081         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5082         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5083         16  FILLER                         PIC X(444).
  5084*        16  FILLER                         PIC X(452).
  5085
  5086
  5087****************************************************************
  5088*             MORTALITY MASTER RECORD                          *
  5089****************************************************************
  5090
  5091     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5092         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5093                                INDEXED BY CF-MORT-NDX.
  5094             20  CF-MORT-TABLE              PIC X(5).
  5095             20  CF-MORT-TABLE-TYPE         PIC X.
  5096                 88  CF-MORT-JOINT              VALUE 'J'.
  5097                 88  CF-MORT-SINGLE             VALUE 'S'.
  5098                 88  CF-MORT-COMBINED           VALUE 'C'.
  5099                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5100                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5101             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5102             20  CF-MORT-AGE-METHOD         PIC XX.
  5103                 88  CF-AGE-LAST                VALUE 'AL'.
  5104                 88  CF-AGE-NEAR                VALUE 'AN'.
  5105             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5106             20  CF-MORT-ADJUSTMENT-DIRECTION
  5107                                            PIC X.
  5108                 88  CF-MINUS                   VALUE '-'.
  5109                 88  CF-PLUS                    VALUE '+'.
  5110             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5111             20  CF-MORT-JOINT-CODE         PIC X.
  5112                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5113             20  CF-MORT-PC-Q               PIC X.
  5114                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5115             20  CF-MORT-TABLE-CODE         PIC X(4).
  5116             20  CF-MORT-COMMENTS           PIC X(15).
  5117             20  FILLER                     PIC X(14).
  5118
  5119         16  FILLER                         PIC X(251).
  5120
  5121
  5122****************************************************************
  5123*             BUSSINESS TYPE MASTER RECORD                     *
  5124****************************************************************
  5125
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  97
* EL156.cbl
  5126     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5127* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5128* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5129* AND RECORD 05 IS TYPES 81-99
  5130         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5131             20  CF-BUSINESS-TITLE          PIC  X(19).
  5132             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5133                                            PIC S9V9(4) COMP-3.
  5134             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5135             20  FILLER                     PIC  X.
  5136         16  FILLER                         PIC  X(248).
  5137
  5138
  5139****************************************************************
  5140*             TERMINAL MASTER RECORD                           *
  5141****************************************************************
  5142
  5143     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5144
  5145         16  CF-COMPANY-TERMINALS.
  5146             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5147                                  PIC X(4).
  5148         16  FILLER               PIC X(248).
  5149
  5150
  5151****************************************************************
  5152*             LIFE EDIT MASTER RECORD                          *
  5153****************************************************************
  5154
  5155     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5156         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5157             20  CF-LIFE-CODE-IN            PIC XX.
  5158             20  CF-LIFE-CODE-OUT           PIC XX.
  5159         16  FILLER                         PIC X(248).
  5160
  5161
  5162****************************************************************
  5163*             AH EDIT MASTER RECORD                            *
  5164****************************************************************
  5165
  5166     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5167         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5168             20  CF-AH-CODE-IN              PIC XXX.
  5169             20  CF-AH-CODE-OUT             PIC XX.
  5170         16  FILLER                         PIC X(248).
  5171
  5172
  5173****************************************************************
  5174*             CREDIBILITY TABLES                               *
  5175****************************************************************
  5176
  5177     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5178         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5179                             INDEXED BY CF-CRDB-NDX.
  5180             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5181             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5182             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5183         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  98
* EL156.cbl
  5184
  5185
  5186****************************************************************
  5187*             REPORT CUSTOMIZATION RECORD                      *
  5188****************************************************************
  5189
  5190     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5191         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5192             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5193             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5194             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5195**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5196****       A T-TRANSFER.                                   ****
  5197             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5198
  5199         16  FILLER                         PIC XX.
  5200
  5201         16  CF-CARRIER-CNTL-OPT.
  5202             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5203                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5204                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5205             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5206                                            PIC X.
  5207         16  CF-GROUP-CNTL-OPT.
  5208             20  CF-GROUP-OPT-SEQ           PIC 9.
  5209                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5210                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5211             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5212                                            PIC X(6).
  5213         16  CF-STATE-CNTL-OPT.
  5214             20  CF-STATE-OPT-SEQ           PIC 9.
  5215                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5216                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5217             20  CF-STATE-SELECT OCCURS 3 TIMES
  5218                                            PIC XX.
  5219         16  CF-ACCOUNT-CNTL-OPT.
  5220             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5221                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5222                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5223             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5224                                            PIC X(10).
  5225         16  CF-BUS-TYP-CNTL-OPT.
  5226             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5227                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5228                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5229             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5230                                            PIC XX.
  5231         16  CF-LF-TYP-CNTL-OPT.
  5232             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5233                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5234                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5235             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5236                                            PIC XX.
  5237         16  CF-AH-TYP-CNTL-OPT.
  5238             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5239                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5240                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5241             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page  99
* EL156.cbl
  5242                                            PIC XX.
  5243         16  CF-REPTCD1-CNTL-OPT.
  5244             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5245                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5246                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5247             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5248                                            PIC X(10).
  5249         16  CF-REPTCD2-CNTL-OPT.
  5250             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5251                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5252                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5253             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5254                                            PIC X(10).
  5255         16  CF-USER1-CNTL-OPT.
  5256             20  CF-USER1-OPT-SEQ           PIC 9.
  5257                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5258                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5259             20  CF-USER1-SELECT OCCURS 3 TIMES
  5260                                            PIC X(10).
  5261         16  CF-USER2-CNTL-OPT.
  5262             20  CF-USER2-OPT-SEQ           PIC 9.
  5263                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5264                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5265             20  CF-USER2-SELECT OCCURS 3 TIMES
  5266                                            PIC X(10).
  5267         16  CF-USER3-CNTL-OPT.
  5268             20  CF-USER3-OPT-SEQ           PIC 9.
  5269                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5270                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5271             20  CF-USER3-SELECT OCCURS 3 TIMES
  5272                                            PIC X(10).
  5273         16  CF-USER4-CNTL-OPT.
  5274             20  CF-USER4-OPT-SEQ           PIC 9.
  5275                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5276                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5277             20  CF-USER4-SELECT OCCURS 3 TIMES
  5278                                            PIC X(10).
  5279         16  CF-USER5-CNTL-OPT.
  5280             20  CF-USER5-OPT-SEQ           PIC 9.
  5281                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5282                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5283             20  CF-USER5-SELECT OCCURS 3 TIMES
  5284                                            PIC X(10).
  5285         16  CF-REINS-CNTL-OPT.
  5286             20  CF-REINS-OPT-SEQ           PIC 9.
  5287                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5288                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5289             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5290                 24  CF-REINS-PRIME         PIC XXX.
  5291                 24  CF-REINS-SUB           PIC XXX.
  5292
  5293         16  CF-AGENT-CNTL-OPT.
  5294             20  CF-AGENT-OPT-SEQ           PIC 9.
  5295                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5296                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5297             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5298                                            PIC X(10).
  5299
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 100
* EL156.cbl
  5300         16  FILLER                         PIC X(43).
  5301
  5302         16  CF-LOSS-RATIO-SELECT.
  5303             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5304             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5305         16  CF-ENTRY-DATE-SELECT.
  5306             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5307             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5308         16  CF-EFFECTIVE-DATE-SELECT.
  5309             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5310             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5311
  5312         16  CF-EXCEPTION-LIST-IND          PIC X.
  5313             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5314
  5315         16  FILLER                         PIC X(318).
  5316
  5317****************************************************************
  5318*                  EXCEPTION REPORTING RECORD                  *
  5319****************************************************************
  5320
  5321     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5322         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5323             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5324
  5325         16  CF-COMBINED-LIFE-AH-OPT.
  5326             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5327             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5328             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5329             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5330
  5331         16  CF-LIFE-OPT.
  5332             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5333             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5334             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5335             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5336             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5337             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5338             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5339             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5340             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5341             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5342
  5343         16  CF-AH-OPT.
  5344             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5345             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5346             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5347             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5348             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5349             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5350             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5351             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5352             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5353             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5354
  5355         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5356             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5357             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 101
* EL156.cbl
  5358             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5359
  5360         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5361
  5362         16  FILLER                         PIC X(673).
  5363
  5364
  5365****************************************************************
  5366*             MORTGAGE SYSTEM PLAN RECORD                      *
  5367****************************************************************
  5368
  5369     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5370         16  CF-PLAN-TYPE                   PIC X.
  5371             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5372             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5373             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5374         16  CF-PLAN-ABBREV                 PIC XXX.
  5375         16  CF-PLAN-DESCRIPT               PIC X(10).
  5376         16  CF-PLAN-NOTES                  PIC X(20).
  5377         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5378         16  CF-PLAN-UNDERWRITING.
  5379             20  CF-PLAN-TERM-DATA.
  5380                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5381                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5382             20  CF-PLAN-AGE-DATA.
  5383                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5384                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5385                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5386             20  CF-PLAN-BENEFIT-DATA.
  5387                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5388                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5389                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5390                                            PIC S9(7)V99  COMP-3.
  5391         16  CF-PLAN-POLICY-FORMS.
  5392             20  CF-POLICY-FORM             PIC X(12).
  5393             20  CF-MASTER-APPLICATION      PIC X(12).
  5394             20  CF-MASTER-POLICY           PIC X(12).
  5395         16  CF-PLAN-RATING.
  5396             20  CF-RATE-CODE               PIC X(5).
  5397             20  CF-SEX-RATING              PIC X.
  5398                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5399                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5400             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5401             20  CF-SUB-STD-TYPE            PIC X.
  5402                 88  CF-PCT-OF-PREM            VALUE '1'.
  5403                 88  CF-PCT-OF-BENE            VALUE '2'.
  5404         16  CF-PLAN-PREM-TOLERANCES.
  5405             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5406             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5407         16  CF-PLAN-PYMT-TOLERANCES.
  5408             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5409             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5410         16  CF-PLAN-MISC-DATA.
  5411             20  FILLER                     PIC X.
  5412             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5413             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5414         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5415         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 102
* EL156.cbl
  5416             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5417                                                     '1'.
  5418             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5419                                                     '2'.
  5420         16  CF-MIB-SEARCH-SW               PIC X.
  5421             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5422             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5423             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5424             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5425         16  CF-ALPHA-SEARCH-SW             PIC X.
  5426             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5427             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5428             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5429             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5430             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5431             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5432             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5433             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5434             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5435             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5436                                                     'A' 'B' 'C'
  5437                                                     'X' 'Y' 'Z'.
  5438         16  CF-EFF-DT-RULE-SW              PIC X.
  5439             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5440             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5441             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5442             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5443             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5444         16  FILLER                         PIC X(4).
  5445         16  CF-HEALTH-QUESTIONS            PIC X.
  5446             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5447         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5448         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5449         16  CF-PLAN-SNGL-JNT               PIC X.
  5450             88  CF-COMBINED-PLAN              VALUE 'C'.
  5451             88  CF-JNT-PLAN                   VALUE 'J'.
  5452             88  CF-SNGL-PLAN                  VALUE 'S'.
  5453         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5454         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5455         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5456         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5457         16  CF-RERATE-CNTL                 PIC  X.
  5458             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5459             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5460             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5461             88  CF-AUTO-RECALC                 VALUE '4'.
  5462         16  CF-BENEFIT-TYPE                PIC  X.
  5463             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5464             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5465         16  CF-POLICY-FEE                  PIC S999V99
  5466                                                    COMP-3.
  5467         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5468         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5469         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5470         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5471         16  FILLER                         PIC  X(32).
  5472         16  CF-TERMINATION-FORM            PIC  X(04).
  5473         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 103
* EL156.cbl
  5474         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5475                                                       COMP-3.
  5476         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5477         16  CF-ISSUE-LETTER                PIC  X(4).
  5478         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5479         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5480             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5481             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5482         16  CF-MP-REFUND-CALC              PIC X.
  5483             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5484             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5485             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5486             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5487             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5488             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5489             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5490             88  CF-MP-REFD-MEAN                VALUE '8'.
  5491         16  CF-ALT-RATE-CODE               PIC  X(5).
  5492
  5493
  5494         16  FILLER                         PIC X(498).
  5495****************************************************************
  5496*             MORTGAGE COMPANY MASTER RECORD                   *
  5497****************************************************************
  5498
  5499     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5500         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5501         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5502             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5503             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5504             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5505             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5506             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5507
  5508         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5509         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5510         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5511         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5512         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5513
  5514         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5515             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5516         16  CF-MP-RECON-USE-IND            PIC X(1).
  5517             88  CF-MP-USE-RECON             VALUE 'Y'.
  5518         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5519             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5520         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5521             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5522             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5523         16  FILLER                         PIC X(1).
  5524         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5525             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5526         16  CF-MORTG-MIB-VERSION           PIC X.
  5527             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5528             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5529             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5530         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5531             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 104
* EL156.cbl
  5532                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5533             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5534                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5535             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5536                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5537             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5538                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5539             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5540                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5541             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5542                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5543         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5544         16  FILLER                         PIC X(7).
  5545         16  CF-MORTG-DESTINATION-SYMBOL.
  5546             20  CF-MORTG-MIB-COMM          PIC X(5).
  5547             20  CF-MORTG-MIB-TERM          PIC X(5).
  5548         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5549             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5550         16  FILLER                         PIC X(03).
  5551         16  CF-MP-CHECK-NO-CONTROL.
  5552             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5553                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5554                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5555                                                ' ' LOW-VALUES.
  5556                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5557                                               VALUE '3'.
  5558         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5559         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5560         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5561             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5562                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5563             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5564                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5565             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5566                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5567             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5568                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5569             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5570                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5571             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5572                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5573         16  CF-MORTG-BILLING-AREA.
  5574             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5575                                            PIC X.
  5576         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5577         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5578         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5579         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5580             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5581             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5582         16  FILLER                         PIC X.
  5583         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5584             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5585             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5586         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5587         16  FILLER                         PIC X(8).
  5588         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5589         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 105
* EL156.cbl
  5590         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5591         16  CF-ACH-COMPANY-ID.
  5592             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5593                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5594                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5595                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5596             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5597         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5598             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5599         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5600             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5601             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5602         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5603         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5604         16  FILLER                         PIC X(536).
  5605
  5606****************************************************************
  5607*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5608****************************************************************
  5609
  5610     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5611         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5612             20  CF-FEMALE-HEIGHT.
  5613                 24  CF-FEMALE-FT           PIC 99.
  5614                 24  CF-FEMALE-IN           PIC 99.
  5615             20  CF-FEMALE-MIN-WT           PIC 999.
  5616             20  CF-FEMALE-MAX-WT           PIC 999.
  5617         16  FILLER                         PIC X(428).
  5618
  5619     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5620         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5621             20  CF-MALE-HEIGHT.
  5622                 24  CF-MALE-FT             PIC 99.
  5623                 24  CF-MALE-IN             PIC 99.
  5624             20  CF-MALE-MIN-WT             PIC 999.
  5625             20  CF-MALE-MAX-WT             PIC 999.
  5626         16  FILLER                         PIC X(428).
  5627******************************************************************
  5628*             AUTOMATIC ACTIVITY RECORD                          *
  5629******************************************************************
  5630     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5631         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5632             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5633             20  CF-SYS-LETTER-ID           PIC X(04).
  5634             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5635             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5636             20  CF-SYS-RESET-SW            PIC X(01).
  5637             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5638             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5639
  5640         16  FILLER                         PIC X(50).
  5641
  5642         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5643             20  CF-USER-ACTIVE-SW          PIC X(01).
  5644             20  CF-USER-LETTER-ID          PIC X(04).
  5645             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5646             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5647             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 106
* EL156.cbl
  5648             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5649             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5650             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5651
  5652         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 107
* EL156.cbl
  5654*    COPY ELCCERT.
  5655******************************************************************
  5656*                                                                *
  5657*                            ELCCERT.                            *
  5658*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5659*                            VMOD=2.013                          *
  5660*                                                                *
  5661*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5662*                                                                *
  5663*   FILE TYPE = VSAM,KSDS                                        *
  5664*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5665*                                                                *
  5666*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5667*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5668*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5669*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5670*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5671*                                                                *
  5672*   LOG = YES                                                    *
  5673*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5674******************************************************************
  5675*                   C H A N G E   L O G
  5676*
  5677* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5678*-----------------------------------------------------------------
  5679*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5680* EFFECTIVE    NUMBER
  5681*-----------------------------------------------------------------
  5682* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5683* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5684* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5685* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5686* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5687* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5688* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5689* 032612  CR2011110200001  PEMA  AHL CHANGES
  5690* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5691* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5692******************************************************************
  5693
  5694 01  CERTIFICATE-MASTER.
  5695     12  CM-RECORD-ID                      PIC XX.
  5696         88  VALID-CM-ID                      VALUE 'CM'.
  5697
  5698     12  CM-CONTROL-PRIMARY.
  5699         16  CM-COMPANY-CD                 PIC X.
  5700         16  CM-CARRIER                    PIC X.
  5701         16  CM-GROUPING.
  5702             20  CM-GROUPING-PREFIX        PIC X(3).
  5703             20  CM-GROUPING-PRIME         PIC X(3).
  5704         16  CM-STATE                      PIC XX.
  5705         16  CM-ACCOUNT.
  5706             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5707             20  CM-ACCOUNT-PRIME          PIC X(6).
  5708         16  CM-CERT-EFF-DT                PIC XX.
  5709         16  CM-CERT-NO.
  5710             20  CM-CERT-PRIME             PIC X(10).
  5711             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 108
* EL156.cbl
  5712
  5713     12  CM-CONTROL-BY-NAME.
  5714         16  CM-COMPANY-CD-A1              PIC X.
  5715         16  CM-INSURED-LAST-NAME          PIC X(15).
  5716         16  CM-INSURED-INITIALS.
  5717             20  CM-INSURED-INITIAL1       PIC X.
  5718             20  CM-INSURED-INITIAL2       PIC X.
  5719
  5720     12  CM-CONTROL-BY-SSN.
  5721         16  CM-COMPANY-CD-A2              PIC X.
  5722         16  CM-SOC-SEC-NO.
  5723             20  CM-SSN-STATE              PIC XX.
  5724             20  CM-SSN-ACCOUNT            PIC X(6).
  5725             20  CM-SSN-LN3.
  5726                 25  CM-INSURED-INITIALS-A2.
  5727                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5728                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5729                 25 CM-PART-LAST-NAME-A2         PIC X.
  5730
  5731     12  CM-CONTROL-BY-CERT-NO.
  5732         16  CM-COMPANY-CD-A4              PIC X.
  5733         16  CM-CERT-NO-A4                 PIC X(11).
  5734
  5735     12  CM-CONTROL-BY-MEMB.
  5736         16  CM-COMPANY-CD-A5              PIC X.
  5737         16  CM-MEMBER-NO.
  5738             20  CM-MEMB-STATE             PIC XX.
  5739             20  CM-MEMB-ACCOUNT           PIC X(6).
  5740             20  CM-MEMB-LN4.
  5741                 25  CM-INSURED-INITIALS-A5.
  5742                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5743                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5744                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5745
  5746     12  CM-INSURED-PROFILE-DATA.
  5747         16  CM-INSURED-FIRST-NAME.
  5748             20  CM-INSURED-1ST-INIT       PIC X.
  5749             20  FILLER                    PIC X(9).
  5750         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5751         16  CM-INSURED-SEX                PIC X.
  5752             88  CM-SEX-MALE                  VALUE 'M'.
  5753             88  CM-SEX-FEMAL                 VALUE 'F'.
  5754         16  CM-INSURED-JOINT-AGE          PIC 99.
  5755         16  CM-JOINT-INSURED-NAME.
  5756             20  CM-JT-LAST-NAME           PIC X(15).
  5757             20  CM-JT-FIRST-NAME.
  5758                 24  CM-JT-1ST-INIT        PIC X.
  5759                 24  FILLER                PIC X(9).
  5760             20  CM-JT-INITIAL             PIC X.
  5761
  5762     12  CM-LIFE-DATA.
  5763         16  CM-LF-BENEFIT-CD              PIC XX.
  5764         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5765         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5766         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5767         16  CM-LF-DEV-CODE                PIC XXX.
  5768         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5769         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 109
* EL156.cbl
  5770         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5771         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5772         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5773         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5774         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5775         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5776         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5777         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5778         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5779         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5780         16  cm-temp-epiq                  pic xx.
  5781             88  EPIQ-CLASS                  value 'EQ'.
  5782*        16  FILLER                        PIC XX.
  5783
  5784     12  CM-AH-DATA.
  5785         16  CM-AH-BENEFIT-CD              PIC XX.
  5786         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5787         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5788         16  CM-AH-DEV-CODE                PIC XXX.
  5789         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5790         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5791         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5792         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5793         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5794         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5795         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5796         16  CM-AH-PAID-THRU-DT            PIC XX.
  5797             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5798         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5799         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5800         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5801         16  FILLER                        PIC X.
  5802
  5803     12  CM-LOAN-INFORMATION.
  5804         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5805         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5806                                           PIC S9(5)V99  COMP-3.
  5807         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5808         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5809         16  CM-PAY-FREQUENCY              PIC S99.
  5810         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5811         16  CM-RATE-CLASS                 PIC XX.
  5812         16  CM-BENEFICIARY                PIC X(25).
  5813         16  CM-POLICY-FORM-NO             PIC X(12).
  5814         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5815         16  CM-LAST-ADD-ON-DT             PIC XX.
  5816         16  CM-DEDUCTIBLE-AMOUNTS.
  5817             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5818             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5819         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5820             20  CM-RESIDENT-STATE         PIC XX.
  5821             20  CM-RATE-CODE              PIC X(4).
  5822             20  FILLER                    PIC XX.
  5823         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5824             20  CM-LOAN-OFFICER           PIC X(5).
  5825             20  FILLER                    PIC XXX.
  5826         16  CM-CSR-CODE                   PIC XXX.
  5827         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 110
* EL156.cbl
  5828             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5829         16  CM-POST-CARD-IND              PIC X.
  5830         16  CM-NH-INTERFACE-SW            PIC X.
  5831         16  CM-PREMIUM-TYPE               PIC X.
  5832             88  CM-SING-PRM                  VALUE '1'.
  5833             88  CM-O-B-COVERAGE              VALUE '2'.
  5834             88  CM-OPEN-END                  VALUE '3'.
  5835         16  CM-IND-GRP-TYPE               PIC X.
  5836             88  CM-INDIVIDUAL                VALUE 'I'.
  5837             88  CM-GROUP                     VALUE 'G'.
  5838         16  CM-SKIP-CODE                  PIC X.
  5839             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5840             88  SKIP-JULY                    VALUE '1'.
  5841             88  SKIP-AUGUST                  VALUE '2'.
  5842             88  SKIP-SEPTEMBER               VALUE '3'.
  5843             88  SKIP-JULY-AUG                VALUE '4'.
  5844             88  SKIP-AUG-SEPT                VALUE '5'.
  5845             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5846             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5847             88  SKIP-JUNE                    VALUE '8'.
  5848             88  SKIP-JUNE-JULY               VALUE '9'.
  5849             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5850             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5851         16  CM-PAYMENT-MODE               PIC X.
  5852             88  PAY-MONTHLY                  VALUE SPACE.
  5853             88  PAY-WEEKLY                   VALUE '1'.
  5854             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5855             88  PAY-BI-WEEKLY                VALUE '3'.
  5856             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5857         16  CM-LOAN-NUMBER                PIC X(8).
  5858         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5859         16  CM-OLD-LOF                    PIC XXX.
  5860*        16  CM-LOAN-OFFICER               PIC XXX.
  5861         16  CM-REIN-TABLE                 PIC XXX.
  5862         16  CM-SPECIAL-REIN-CODE          PIC X.
  5863         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5864         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5865         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5866
  5867     12  CM-STATUS-DATA.
  5868         16  CM-ENTRY-STATUS               PIC X.
  5869         16  CM-ENTRY-DT                   PIC XX.
  5870
  5871         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5872         16  CM-LF-CANCEL-DT               PIC XX.
  5873         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5874
  5875         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5876         16  CM-LF-DEATH-DT                PIC XX.
  5877         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5878
  5879         16  CM-LF-CURRENT-STATUS          PIC X.
  5880             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5881                                                'M' '4' '5' '9'.
  5882             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5883             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5884             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5885             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 111
* EL156.cbl
  5886             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5887             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5888             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5889             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5890             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5891             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5892             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5893             88  CM-LF-DECLINED               VALUE 'D'.
  5894             88  CM-LF-VOIDED                 VALUE 'V'.
  5895
  5896         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5897         16  CM-AH-CANCEL-DT               PIC XX.
  5898         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5899
  5900         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5901         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5902         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5903
  5904         16  CM-AH-CURRENT-STATUS          PIC X.
  5905             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5906                                                'M' '4' '5' '9'.
  5907             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5908             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5909             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5910             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5911             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5912             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5913             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5914             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5915             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5916             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5917             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5918             88  CM-AH-DECLINED               VALUE 'D'.
  5919             88  CM-AH-VOIDED                 VALUE 'V'.
  5920
  5921         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5922             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5923             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5924             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5925         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5926
  5927         16  CM-ENTRY-BATCH                PIC X(6).
  5928         16  CM-LF-EXIT-BATCH              PIC X(6).
  5929         16  CM-AH-EXIT-BATCH              PIC X(6).
  5930         16  CM-LAST-MONTH-END             PIC XX.
  5931
  5932     12  CM-NOTE-SW                        PIC X.
  5933         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5934         88  CERT-NOTES-PRESENT               VALUE '1'.
  5935         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5936         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5937         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5938         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5939         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5940         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5941     12  CM-COMP-EXCP-SW                   PIC X.
  5942         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5943         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 112
* EL156.cbl
  5944     12  CM-INSURED-ADDRESS-SW             PIC X.
  5945         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5946         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5947
  5948*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5949     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5950     12  FILLER                            PIC X.
  5951
  5952*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5953     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5954     12  FILLER                            PIC X.
  5955*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5956     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5957
  5958     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5959         88  CERT-ADDED-BATCH                 VALUE ' '.
  5960         88  CERT-ADDED-ONLINE                VALUE '1'.
  5961         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5962         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5963         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5964     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5965         88  CERT-AS-LOADED                   VALUE ' '.
  5966         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5967         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5968         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5969         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5970         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5971         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5972         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5973
  5974     12  CM-ACCOUNT-COMM-PCTS.
  5975         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5976         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5977
  5978     12  CM-USER-FIELD                     PIC X.
  5979     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5980     12  CM-CLP-STATE                      PIC XX.
  5981     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5982     12  CM-USER-RESERVED                  PIC XXX.
  5983     12  FILLER REDEFINES CM-USER-RESERVED.
  5984         16  CM-AH-CLASS-CD                PIC XX.
  5985         16  F                             PIC X.
  5986******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 113
* EL156.cbl
  5988*    COPY ELCTRLR.
  5989******************************************************************
  5990*                                                                *
  5991*                            ELCTRLR.                            *
  5992*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5993*                            VMOD=2.014                          *
  5994*                                                                *
  5995*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5996*                                                                *
  5997*   FILE TYPE = VSAM,KSDS                                        *
  5998*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5999*                                                                *
  6000*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  6001*       ALTERNATE INDEX = NONE                                   *
  6002*                                                                *
  6003*   LOG = YES                                                    *
  6004*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6005******************************************************************
  6006*                   C H A N G E   L O G
  6007*
  6008* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6009*-----------------------------------------------------------------
  6010*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6011* EFFECTIVE    NUMBER
  6012*-----------------------------------------------------------------
  6013* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  6014* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  6015* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  6016* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  6017* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  6018* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  6019* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  6020* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  6021* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  6022* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  6023* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  6024* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  6025* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  6026* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  6027* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  6028* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6029* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  6030* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  6031* 040814    2014030500002  AJRA  ADD ICD CODES
  6032* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  6033* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6034* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  6035******************************************************************
  6036 01  ACTIVITY-TRAILERS.
  6037     12  AT-RECORD-ID                    PIC XX.
  6038         88  VALID-AT-ID                       VALUE 'AT'.
  6039
  6040     12  AT-CONTROL-PRIMARY.
  6041         16  AT-COMPANY-CD               PIC X.
  6042         16  AT-CARRIER                  PIC X.
  6043         16  AT-CLAIM-NO                 PIC X(7).
  6044         16  AT-CERT-NO.
  6045             20  AT-CERT-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 114
* EL156.cbl
  6046             20  AT-CERT-SFX             PIC X.
  6047         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  6048             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  6049             88  AT-LAST-TRL-AVAIL            VALUE +100.
  6050             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  6051             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  6052             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  6053             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  6054             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  6055             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  6056             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  6057             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  6058             88  AT-DIAGNOSIS-TRL             VALUE +90.
  6059             88  AT-BENEFICIARY-TRL           VALUE +91.
  6060             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  6061             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  6062             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  6063             88  AT-ERROR-MSGS-TRL            VALUE +95.
  6064
  6065     12  AT-TRAILER-TYPE                 PIC X.
  6066         88  RESERVE-EXPENSE-TR               VALUE '1'.
  6067         88  PAYMENT-TR                       VALUE '2'.
  6068         88  AUTO-PAY-TR                      VALUE '3'.
  6069         88  CORRESPONDENCE-TR                VALUE '4'.
  6070         88  ADDRESS-TR                       VALUE '5'.
  6071         88  GENERAL-INFO-TR                  VALUE '6'.
  6072         88  AUTO-PROMPT-TR                   VALUE '7'.
  6073         88  DENIAL-TR                        VALUE '8'.
  6074         88  INCURRED-CHG-TR                  VALUE '9'.
  6075         88  FORM-CONTROL-TR                  VALUE 'A'.
  6076
  6077     12  AT-RECORDED-DT                  PIC XX.
  6078     12  AT-RECORDED-BY                  PIC X(4).
  6079     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6080
  6081     12  AT-TRAILER-BODY                 PIC X(165).
  6082
  6083     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6084         16  AT-RESERVE-CONTROLS.
  6085             20  AT-MANUAL-SW            PIC X.
  6086                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6087             20  AT-FUTURE-SW            PIC X.
  6088                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6089             20  AT-PTC-SW               PIC X.
  6090                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6091             20  AT-IBNR-SW              PIC X.
  6092                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6093             20  AT-PTC-LF-SW            PIC X.
  6094                 88  AT-LF-PTC-USED          VALUE '1'.
  6095             20  AT-CDT-ACCESS-METHOD    PIC X.
  6096                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6097                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6098                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6099             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6100         16  AT-LAST-COMPUTED-DT         PIC XX.
  6101         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6102         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6103         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 115
* EL156.cbl
  6104         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6105         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6106         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6107         16  AT-EXPENSE-CONTROLS.
  6108             20  AT-EXPENSE-METHOD       PIC X.
  6109                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6110                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6111                 88  PERCENT-OF-PMT           VALUE '3'.
  6112                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6113             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6114             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6115         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6116         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6117
  6118         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6119         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6120
  6121*        16  FILLER                      PIC X(53).
  6122         16  FILLER                      PIC X(47).
  6123
  6124         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6125         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6126
  6127         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6128             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6129             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6130*                    C = CLOSED
  6131*                    O = OPEN
  6132             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6133*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6134
  6135     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6136         16  AT-PAYMENT-TYPE             PIC X.
  6137             88  PARTIAL-PAYMENT                VALUE '1'.
  6138             88  FINAL-PAYMENT                  VALUE '2'.
  6139             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6140             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6141             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6142             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6143             88  VOIDED-PAYMENT                 VALUE '9'.
  6144             88  TRANSFER                       VALUE 'T'.
  6145             88  LIFE-INTEREST                  VALUE 'I'.
  6146
  6147         16  AT-CLAIM-TYPE               PIC X.
  6148             88  PAID-FOR-AH                    VALUE 'A'.
  6149             88  PAID-FOR-LIFE                  VALUE 'L'.
  6150             88  PAID-FOR-IUI                   VALUE 'I'.
  6151             88  PAID-FOR-GAP                   VALUE 'G'.
  6152             88  PAID-FOR-FAM                   VALUE 'F'.
  6153         16  AT-CLAIM-PREM-TYPE          PIC X.
  6154             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6155             88  AT-O-B-COVERAGE                VALUE '2'.
  6156             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6157         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6158         16  AT-CHECK-NO                 PIC X(7).
  6159         16  AT-PAID-FROM-DT             PIC XX.
  6160         16  AT-PAID-THRU-DT             PIC XX.
  6161         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 116
* EL156.cbl
  6162         16  AT-ACH-PAYMENT              PIC X.
  6163*        16  FILLER                      PIC X.
  6164         16  AT-PAYEES-NAME              PIC X(30).
  6165         16  AT-PAYMENT-ORIGIN           PIC X.
  6166             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6167             88  ONLINE-AUTO-PMT                VALUE '2'.
  6168             88  OFFLINE-PMT                    VALUE '3'.
  6169         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6170         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6171         16  AT-VOID-DATA.
  6172             20  AT-VOID-DT              PIC XX.
  6173*00144       20  AT-VOID-REASON          PIC X(30).
  6174             20  AT-VOID-REASON          PIC X(26).
  6175         16  AT-PMT-APPROVED-BY          PIC X(04).
  6176         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6177         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6178         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6179                                         PIC S99V9(5)  COMP-3.
  6180         16  AT-CREDIT-INTERFACE.
  6181             20  AT-PMT-SELECT-DT        PIC XX.
  6182                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6183             20  AT-PMT-ACCEPT-DT        PIC XX.
  6184                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6185             20  AT-VOID-SELECT-DT       PIC XX.
  6186                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6187             20  AT-VOID-ACCEPT-DT       PIC XX.
  6188                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6189
  6190         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6191                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6192                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6193         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6194
  6195         16  AT-FORCE-CONTROL            PIC X.
  6196             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6197         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6198         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6199         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6200         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6201         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6202         16  AT-BENEFIT-TYPE             PIC X.
  6203
  6204         16  AT-EXPENSE-TYPE             PIC X.
  6205         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6206
  6207         16  AT-PAYEE-TYPE-CD.
  6208             20  AT-PAYEE-TYPE           PIC X.
  6209                 88  INSURED-PAID           VALUE 'I'.
  6210                 88  BENEFICIARY-PAID       VALUE 'B'.
  6211                 88  ACCOUNT-PAID           VALUE 'A'.
  6212                 88  OTHER-1-PAID           VALUE 'O'.
  6213                 88  OTHER-2-PAID           VALUE 'Q'.
  6214                 88  DOCTOR-PAID            VALUE 'P'.
  6215                 88  EMPLOYER-PAID          VALUE 'E'.
  6216             20  AT-PAYEE-SEQ            PIC X.
  6217
  6218         16  AT-CASH-PAYMENT             PIC X.
  6219         16  AT-GROUPED-PAYMENT          PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 117
* EL156.cbl
  6220         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6221         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6222         16  AT-APPROVED-LEVEL           PIC X.
  6223         16  AT-VOID-TYPE                PIC X.
  6224             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6225             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6226         16  AT-AIG-UNEMP-IND            PIC X.
  6227             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6228         16  AT-ASSOCIATES               PIC X.
  6229             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6230             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6231
  6232         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6233         16  AT-CV-PMT-CODE              PIC X.
  6234             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6235             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6236             88  FULL-ADD-PAYMENT           VALUE '3'.
  6237             88  HALF-ADD-PAYMENT           VALUE '4'.
  6238             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6239             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6240             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6241             88  ADDL-PAYMENT               VALUE '8'.
  6242
  6243         16  AT-EOB-CODE1                PIC XXX.
  6244         16  AT-EOB-CODE2                PIC XXX.
  6245         16  AT-EOB-CODE3                PIC XXX.
  6246         16  FILLER REDEFINES AT-EOB-CODE3.
  6247             20  AT-PRINT-CLM-FORM       PIC X.
  6248             20  AT-PRINT-SURVEY         PIC X.
  6249             20  AT-SPECIAL-RELEASE      PIC X.
  6250         16  AT-EOB-CODE4                PIC XXX.
  6251         16  FILLER REDEFINES AT-EOB-CODE4.
  6252             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6253             20  FILLER                  PIC X.
  6254         16  AT-EOB-CODE5                PIC XXX.
  6255         16  FILLER REDEFINES AT-EOB-CODE5.
  6256             20  AT-PMT-PROOF-DT         PIC XX.
  6257             20  FILLER                  PIC X.
  6258
  6259         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6260             88  AT-PRINT-EOB            VALUE 'Y'.
  6261
  6262         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6263         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6264
  6265     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6266         16  AT-SCHEDULE-START-DT        PIC XX.
  6267         16  AT-SCHEDULE-END-DT          PIC XX.
  6268         16  AT-TERMINATED-DT            PIC XX.
  6269         16  AT-LAST-PMT-TYPE            PIC X.
  6270             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6271             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6272         16  AT-FIRST-PMT-DATA.
  6273             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6274             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6275             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6276         16  AT-REGULAR-PMT-DATA.
  6277             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 118
* EL156.cbl
  6278             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6279             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6280         16  AT-AUTO-PAYEE-CD.
  6281             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6282                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6283                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6284                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6285                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6286                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6287             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6288         16  AT-AUTO-PAY-DAY             PIC 99.
  6289         16  AT-AUTO-CASH                PIC X.
  6290             88  AT-CASH                      VALUE 'Y'.
  6291             88  AT-NON-CASH                  VALUE 'N'.
  6292*        16  FILLER                      PIC X(129).
  6293         16  AT-AUTO-END-LETTER          PIC X(4).
  6294         16  FILLER                      PIC X(125).
  6295
  6296         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6297         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6298
  6299     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6300         16  AT-LETTER-SENT-DT           PIC XX.
  6301         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6302         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6303         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6304         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6305         16  AT-LETTER-ORIGIN            PIC X.
  6306             88  ONLINE-CREATION              VALUE '1' '3'.
  6307             88  OFFLINE-CREATION             VALUE '2' '4'.
  6308             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6309             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6310         16  AT-STD-LETTER-FORM          PIC X(4).
  6311         16  AT-REASON-TEXT              PIC X(70).
  6312         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6313         16  AT-ADDRESEE-TYPE            PIC X.
  6314              88  INSURED-ADDRESEE            VALUE 'I'.
  6315              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6316              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6317              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6318              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6319              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6320              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6321         16  AT-ADDRESSEE-NAME           PIC X(30).
  6322         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6323         16  AT-RESEND-PRINT-DATE        PIC XX.
  6324         16  AT-CORR-SOL-UNSOL           PIC X.
  6325         16  AT-LETTER-PURGED-DT         PIC XX.
  6326*
  6327*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6328*
  6329         16  AT-CSO-REDEFINITION.
  6330             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6331             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6332             20  AT-LETTER-TO-BENE       PIC X(1).
  6333             20  AT-STOP-LETTER-DT       PIC X(2).
  6334             20  AT-AUTH-RCVD            PIC X(1).
  6335             20  FILLER                  PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 119
* EL156.cbl
  6336*             20  FILLER                  PIC X(27).
  6337             20  AT-CSO-LETTER-STATUS    PIC X.
  6338                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6339                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6340                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6341             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6342             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6343*
  6344*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6345*
  6346*        16  FILLER                      PIC X(26).
  6347*
  6348*        16  AT-DMD-BSR-CODE             PIC X.
  6349*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6350*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6351*
  6352*        16  AT-DMD-LETTER-STATUS        PIC X.
  6353*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6354*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6355*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6356*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6357*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6358
  6359         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6360         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6361
  6362     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6363         16  AT-ADDRESS-TYPE             PIC X.
  6364             88  INSURED-ADDRESS               VALUE 'I'.
  6365             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6366             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6367             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6368             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6369             88  OTHER-ADDRESS-1               VALUE 'O'.
  6370             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6371         16  AT-MAIL-TO-NAME             PIC X(30).
  6372         16  AT-ADDRESS-LINE-1           PIC X(30).
  6373         16  AT-ADDRESS-LINE-2           PIC X(30).
  6374         16  AT-CITY-STATE.
  6375             20  AT-CITY                 PIC X(28).
  6376             20  AT-STATE                PIC XX.
  6377         16  AT-ZIP.
  6378             20  AT-ZIP-CODE.
  6379                 24  AT-ZIP-1ST          PIC X.
  6380                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6381                 24  FILLER              PIC X(4).
  6382             20  AT-ZIP-PLUS4            PIC X(4).
  6383         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6384             20  AT-CAN-POSTAL-1         PIC XXX.
  6385             20  AT-CAN-POSTAL-2         PIC XXX.
  6386             20  FILLER                  PIC XXX.
  6387         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6388*         16  FILLER                      PIC X(23).
  6389         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6390         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6391         16  FILLER                      PIC X(13).
  6392         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6393         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 120
* EL156.cbl
  6394
  6395     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6396         16  AT-INFO-LINE-1              PIC X(60).
  6397         16  FILLER REDEFINES AT-INFO-LINE-1.
  6398             20  AT-NOTE-ERROR-NO OCCURS 15
  6399                                         PIC X(4).
  6400         16  AT-INFO-LINE-2              PIC X(60).
  6401         16  FILLER REDEFINES AT-INFO-LINE-2.
  6402             20  AT-ICD-CODE-1           PIC X(8).
  6403             20  AT-ICD-CODE-2           PIC X(8).
  6404             20  FILLER                  PIC X(44).
  6405         16  AT-INFO-TRAILER-TYPE        PIC X.
  6406             88  AT-ERRORS-NOTE          VALUE 'E'.
  6407             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6408             88  AT-CALL-NOTE            VALUE 'C'.
  6409             88  AT-MAINT-NOTE           VALUE 'M'.
  6410             88  AT-CERT-CHANGE          VALUE 'X'.
  6411             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6412             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6413             88  AT-CERT-CANCELLED       VALUE 'T'.
  6414         16  AT-CALL-TYPE                PIC X.
  6415             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6416             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6417         16  AT-NOTE-CONTINUATION        PIC X.
  6418             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6419         16  AT-EOB-CODES-EXIST          PIC X.
  6420             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6421         16  FILLER                      PIC X(35).
  6422         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6423         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6424
  6425     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6426         16  AT-PROMPT-LINE-1            PIC X(60).
  6427         16  AT-PROMPT-LINE-2            PIC X(60).
  6428         16  AT-PROMPT-START-DT          PIC XX.
  6429         16  AT-PROMPT-END-DT            PIC XX.
  6430         16  FILLER                      PIC X(35).
  6431         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6432         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6433
  6434     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6435         16  AT-DENIAL-INFO-1            PIC X(60).
  6436         16  AT-DENIAL-INFO-2            PIC X(60).
  6437         16  AT-DENIAL-DT                PIC XX.
  6438         16  AT-RETRACTION-DT            PIC XX.
  6439         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6440*         16  FILLER                      PIC X(31).
  6441         16  AT-DENIAL-PROOF-DT          PIC XX.
  6442         16  FILLER                      PIC X(29).
  6443         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6444         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6445
  6446     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6447         16  AT-OLD-INCURRED-DT          PIC XX.
  6448         16  AT-OLD-REPORTED-DT          PIC XX.
  6449         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6450         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6451         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 121
* EL156.cbl
  6452         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6453         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6454         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6455         16  FILLER                      PIC X(26).
  6456         16  AT-OLD-DIAG-CODE            PIC X(6).
  6457         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6458         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6459         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6460         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6461         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6462         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6463         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6464         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6465         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6466         16  FILLER                      PIC X(9).
  6467         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6468
  6469     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6470         16  AT-FORM-SEND-ON-DT          PIC XX.
  6471         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6472         16  AT-FORM-RE-SEND-DT          PIC XX.
  6473         16  AT-FORM-ANSWERED-DT         PIC XX.
  6474         16  AT-FORM-PRINTED-DT          PIC XX.
  6475         16  AT-FORM-REPRINT-DT          PIC XX.
  6476         16  AT-FORM-TYPE                PIC X.
  6477             88  INITIAL-FORM                  VALUE '1'.
  6478             88  PROGRESS-FORM                 VALUE '2'.
  6479         16  AT-INSTRUCT-LN-1            PIC X(28).
  6480         16  AT-INSTRUCT-LN-2            PIC X(28).
  6481         16  AT-INSTRUCT-LN-3            PIC X(28).
  6482         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6483         16  AT-FORM-ADDRESS             PIC X.
  6484             88  FORM-TO-INSURED              VALUE 'I'.
  6485             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6486             88  FORM-TO-OTHER-1              VALUE 'O'.
  6487             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6488         16  AT-RELATED-1.
  6489             20 AT-REL-CARR-1            PIC X.
  6490             20 AT-REL-CLAIM-1           PIC X(7).
  6491             20 AT-REL-CERT-1            PIC X(11).
  6492         16  AT-RELATED-2.
  6493             20 AT-REL-CARR-2            PIC X.
  6494             20 AT-REL-CLAIM-2           PIC X(7).
  6495             20 AT-REL-CERT-2            PIC X(11).
  6496         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6497         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6498         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6499         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6500         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6501         16  AT-STOP-FORM-DT             PIC X(2).
  6502
  6503         16  FILLER                      PIC X(09).
  6504         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6505         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6506******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 122
* EL156.cbl
  6508*    COPY ELCACTQ.
  6509******************************************************************
  6510*                                                                *
  6511*                            ELCACTQ.                            *
  6512*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6513*                            VMOD=2.004                          *
  6514*                                                                *
  6515*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6516*                                                                *
  6517*   FILE TYPE = VSAM,KSDS                                        *
  6518*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6519*                                                                *
  6520*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6521*       ALTERNATE INDEX = NONE                                   *
  6522*                                                                *
  6523*   LOG = YES                                                    *
  6524*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6525*                                                                *
  6526*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6527******************************************************************
  6528
  6529 01  ACTIVITY-QUE.
  6530     12  AQ-RECORD-ID                PIC XX.
  6531         88  VALID-AQ-ID                VALUE 'AQ'.
  6532
  6533     12  AQ-CONTROL-PRIMARY.
  6534         16  AQ-COMPANY-CD           PIC X.
  6535         16  AQ-CARRIER              PIC X.
  6536         16  AQ-CLAIM-NO             PIC X(7).
  6537         16  AQ-CERT-NO.
  6538             20  AQ-CERT-PRIME       PIC X(10).
  6539             20  AQ-CERT-SFX         PIC X.
  6540
  6541     12  AQ-PENDING-ACTIVITY-FLAGS.
  6542         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6543         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6544             88  PENDING-PAYMENTS       VALUE '1'.
  6545         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6546             88  PENDING-FULL-PRINT     VALUE '1'.
  6547             88  PENDING-PART-PRINT     VALUE '2'.
  6548         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6549             88  PENDING-LETTERS        VALUE '1'.
  6550         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6551             88  PENDING-RESTORE        VALUE 'C'.
  6552             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6553
  6554     12  FILLER                      PIC X(20).
  6555
  6556     12  AQ-RESEND-DATE              PIC XX.
  6557     12  AQ-FOLLOWUP-DATE            PIC XX.
  6558     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6559     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6560     12  AQ-AUTO-LETTER              PIC X(4).
  6561     12  FILLER                      PIC XX.
  6562     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6563*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 123
* EL156.cbl
  6565*    COPY ERCACCT.
  6566******************************************************************
  6567*                                                                *
  6568*                                                                *
  6569*                            ERCACCT                             *
  6570*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6571*                            VMOD=2.031                          *
  6572*                                                                *
  6573*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6574*                                                                *
  6575*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6576*   VSAM ACCOUNT MASTER FILES.                                   *
  6577*                                                                *
  6578*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6579*                                                                *
  6580*   FILE TYPE = VSAM,KSDS                                        *
  6581*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6582*                                                                *
  6583*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6584*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6585*                                                                *
  6586*   LOG = NO                                                     *
  6587*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6588*                                                                *
  6589*                                                                *
  6590******************************************************************
  6591*                   C H A N G E   L O G
  6592*
  6593* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6594*-----------------------------------------------------------------
  6595*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6596* EFFECTIVE    NUMBER
  6597*-----------------------------------------------------------------
  6598* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6599* 092705    2005050300006  PEMA  ADD SPP LEASES
  6600* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6601* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6602* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6603* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6604* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6605* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6606******************************************************************
  6607
  6608 01  ACCOUNT-MASTER.
  6609     12  AM-RECORD-ID                      PIC XX.
  6610         88  VALID-AM-ID                      VALUE 'AM'.
  6611
  6612     12  AM-CONTROL-PRIMARY.
  6613         16  AM-COMPANY-CD                 PIC X.
  6614         16  AM-MSTR-CNTRL.
  6615             20  AM-CONTROL-A.
  6616                 24  AM-CARRIER            PIC X.
  6617                 24  AM-GROUPING.
  6618                     28 AM-GROUPING-PREFIX PIC XXX.
  6619                     28 AM-GROUPING-PRIME  PIC XXX.
  6620                 24  AM-STATE              PIC XX.
  6621                 24  AM-ACCOUNT.
  6622                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 124
* EL156.cbl
  6623                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6624             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6625                                           PIC X(19).
  6626             20  AM-CNTRL-B.
  6627                 24  AM-EXPIRATION-DT      PIC XX.
  6628                 24  FILLER                PIC X(4).
  6629             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6630                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6631
  6632     12  AM-CONTROL-BY-VAR-GRP.
  6633         16  AM-COMPANY-CD-A1              PIC X.
  6634         16  AM-VG-CARRIER                 PIC X.
  6635         16  AM-VG-GROUPING                PIC X(6).
  6636         16  AM-VG-STATE                   PIC XX.
  6637         16  AM-VG-ACCOUNT                 PIC X(10).
  6638         16  AM-VG-DATE.
  6639             20  AM-VG-EXPIRATION-DT       PIC XX.
  6640             20  FILLER                    PIC X(4).
  6641         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6642                                           PIC 9(11)      COMP-3.
  6643     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6644         16  FILLER                        PIC X(10).
  6645         16  AM-VG-KEY3.
  6646             20  AM-VG3-ACCOUNT            PIC X(10).
  6647             20  AM-VG3-EXP-DT             PIC XX.
  6648         16  FILLER                        PIC X(4).
  6649     12  AM-MAINT-INFORMATION.
  6650         16  AM-LAST-MAINT-DT              PIC XX.
  6651         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6652         16  AM-LAST-MAINT-USER            PIC X(4).
  6653         16  FILLER                        PIC XX.
  6654
  6655     12  AM-EFFECTIVE-DT                   PIC XX.
  6656     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6657
  6658     12  AM-PREV-DATES  COMP-3.
  6659         16  AM-PREV-EXP-DT                PIC 9(11).
  6660         16  AM-PREV-EFF-DT                PIC 9(11).
  6661
  6662     12  AM-REPORT-CODE-1                  PIC X(10).
  6663     12  AM-REPORT-CODE-2                  PIC X(10).
  6664
  6665     12  AM-CITY-CODE                      PIC X(4).
  6666     12  AM-COUNTY-PARISH                  PIC X(6).
  6667
  6668     12  AM-NAME                           PIC X(30).
  6669     12  AM-PERSON                         PIC X(30).
  6670     12  AM-ADDRS                          PIC X(30).
  6671     12  AM-CITY.
  6672         16  AM-ADDR-CITY                  PIC X(28).
  6673         16  AM-ADDR-STATE                 PIC XX.
  6674     12  AM-ZIP.
  6675         16  AM-ZIP-PRIME.
  6676             20  AM-ZIP-PRI-1ST            PIC X.
  6677                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6678             20  FILLER                    PIC X(4).
  6679         16  AM-ZIP-PLUS4                  PIC X(4).
  6680     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 125
* EL156.cbl
  6681         16  AM-CAN-POSTAL-1               PIC XXX.
  6682         16  AM-CAN-POSTAL-2               PIC XXX.
  6683         16  FILLER                        PIC XXX.
  6684     12  AM-TEL-NO.
  6685         16  AM-AREA-CODE                  PIC 999.
  6686         16  AM-TEL-PRE                    PIC 999.
  6687         16  AM-TEL-NBR                    PIC 9(4).
  6688     12  AM-TEL-LOC                        PIC X.
  6689         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6690         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6691
  6692     12  AM-COMM-STRUCTURE.
  6693         16  AM-DEFN-1.
  6694             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6695                 24  AM-AGT.
  6696                     28  AM-AGT-PREFIX     PIC X(4).
  6697                     28  AM-AGT-PRIME      PIC X(6).
  6698                 24  AM-COM-TYP            PIC X.
  6699                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6700                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6701                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6702                 24  AM-RECALC-LV-INDIC    PIC X.
  6703                 24  AM-RETRO-LV-INDIC     PIC X.
  6704                 24  AM-GL-CODES           PIC X.
  6705                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6706                 24  FILLER                PIC X(01).
  6707         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6708             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6709                 24  FILLER                PIC X(11).
  6710                 24  AM-L-COMA             PIC XXX.
  6711                 24  AM-J-COMA             PIC XXX.
  6712                 24  AM-A-COMA             PIC XXX.
  6713                 24  FILLER                PIC X(6).
  6714
  6715     12  AM-COMM-CHANGE-STATUS             PIC X.
  6716         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6717
  6718     12  AM-CSR-CODE                       PIC X(4).
  6719
  6720     12  AM-BILLING-STATUS                 PIC X.
  6721         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6722         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6723     12  AM-AUTO-REFUND-SW                 PIC X.
  6724         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6725         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6726     12  AM-GPCD                           PIC 99.
  6727     12  AM-IG                             PIC X.
  6728         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6729         88  AM-HAS-GROUP                     VALUE '2'.
  6730     12  AM-STATUS                         PIC X.
  6731         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6732         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6733         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6734         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6735         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6736         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6737         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6738         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 126
* EL156.cbl
  6739         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6740         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6741     12  AM-REMIT-TO                       PIC 99.
  6742     12  AM-ID-NO                          PIC X(11).
  6743
  6744     12  AM-CAL-TABLE                      PIC XX.
  6745     12  AM-LF-DEVIATION                   PIC XXX.
  6746     12  AM-AH-DEVIATION                   PIC XXX.
  6747     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6748     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6749     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6750     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6751     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6752     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6753
  6754     12  AM-USER-FIELDS.
  6755         16  AM-FLD-1                      PIC XX.
  6756         16  AM-FLD-2                      PIC XX.
  6757         16  AM-FLD-3                      PIC XX.
  6758         16  AM-FLD-4                      PIC XX.
  6759         16  AM-FLD-5                      PIC XX.
  6760
  6761     12  AM-1ST-PROD-DATE.
  6762         16  AM-1ST-PROD-YR                PIC XX.
  6763         16  AM-1ST-PROD-MO                PIC XX.
  6764         16  AM-1ST-PROD-DA                PIC XX.
  6765     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6766     12  AM-CERTS-PURGED-DATE.
  6767         16  AM-PUR-YR                     PIC XX.
  6768         16  AM-PUR-MO                     PIC XX.
  6769         16  AM-PUR-DA                     PIC XX.
  6770     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6771     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6772     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6773     12  AM-INACTIVE-DATE.
  6774         16  AM-INA-MO                     PIC 99.
  6775         16  AM-INA-DA                     PIC 99.
  6776         16  AM-INA-YR                     PIC 99.
  6777     12  AM-AR-HI-CERT-DATE                PIC XX.
  6778
  6779     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6780     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6781
  6782     12  AM-OB-PAYMENT-MODE                PIC X.
  6783         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6784         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6785         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6786         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6787
  6788     12  AM-AH-ONLY-INDICATOR              PIC X.
  6789         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6790         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6791
  6792     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6793
  6794     12  AM-OVER-SHORT.
  6795         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6796         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 127
* EL156.cbl
  6797
  6798     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6799     12  AM-DCC-CLP-STATE                  PIC XX.
  6800
  6801     12  AM-RECALC-COMM                    PIC X.
  6802     12  AM-RECALC-REIN                    PIC X.
  6803
  6804     12  AM-REI-TABLE                      PIC XXX.
  6805     12  AM-REI-ET-LF                      PIC X.
  6806     12  AM-REI-ET-AH                      PIC X.
  6807     12  AM-REI-PE-LF                      PIC X.
  6808     12  AM-REI-PE-AH                      PIC X.
  6809     12  AM-REI-PRT-ST                     PIC X.
  6810     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6811     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6812     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6813     12  AM-REI-GROUP-A                    PIC X(6).
  6814     12  AM-REI-MORT                       PIC X(4).
  6815     12  AM-REI-PRT-OW                     PIC X.
  6816     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6817     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6818     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6819     12  AM-REI-GROUP-B                    PIC X(6).
  6820
  6821     12  AM-TRUST-TYPE                     PIC X(2).
  6822
  6823     12  AM-EMPLOYER-STMT-USED             PIC X.
  6824     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6825
  6826     12  AM-STD-AH-TYPE                    PIC XX.
  6827     12  AM-EARN-METHODS.
  6828         16  AM-EARN-METHOD-R              PIC X.
  6829             88 AM-REF-RL-R78                 VALUE 'R'.
  6830             88 AM-REF-RL-PR                  VALUE 'P'.
  6831             88 AM-REF-RL-MEAN                VALUE 'M'.
  6832             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6833         16  AM-EARN-METHOD-L              PIC X.
  6834             88 AM-REF-LL-R78                 VALUE 'R'.
  6835             88 AM-REF-LL-PR                  VALUE 'P'.
  6836             88 AM-REF-LL-MEAN                VALUE 'M'.
  6837             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6838         16  AM-EARN-METHOD-A              PIC X.
  6839             88 AM-REF-AH-R78                 VALUE 'R'.
  6840             88 AM-REF-AH-PR                  VALUE 'P'.
  6841             88 AM-REF-AH-MEAN                VALUE 'M'.
  6842             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6843             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6844             88 AM-REF-AH-NET                 VALUE 'N'.
  6845
  6846     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6847     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6848     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6849
  6850     12  AM-RET-Y-N                        PIC X.
  6851     12  AM-RET-P-E                        PIC X.
  6852     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6853     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6854     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 128
* EL156.cbl
  6855     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6856         16  AM-POOL-PRIME                 PIC XXX.
  6857         16  AM-POOL-SUB                   PIC XXX.
  6858     12  AM-RETRO-EARNINGS.
  6859         16  AM-RET-EARN-R                 PIC X.
  6860         16  AM-RET-EARN-L                 PIC X.
  6861         16  AM-RET-EARN-A                 PIC X.
  6862     12  AM-RET-ST-TAX-USE                 PIC X.
  6863         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6864         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6865     12  AM-RETRO-BEG-EARNINGS.
  6866         16  AM-RET-BEG-EARN-R             PIC X.
  6867         16  AM-RET-BEG-EARN-L             PIC X.
  6868         16  AM-RET-BEG-EARN-A             PIC X.
  6869     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6870     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6871
  6872     12  AM-USER-SELECT-OPTIONS.
  6873         16  AM-USER-SELECT-1              PIC X(10).
  6874         16  AM-USER-SELECT-2              PIC X(10).
  6875         16  AM-USER-SELECT-3              PIC X(10).
  6876         16  AM-USER-SELECT-4              PIC X(10).
  6877         16  AM-USER-SELECT-5              PIC X(10).
  6878
  6879     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6880
  6881     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6882
  6883     12  AM-RPT045A-SWITCH                 PIC X.
  6884         88  RPT045A-OFF                   VALUE 'N'.
  6885
  6886     12  AM-INSURANCE-LIMITS.
  6887         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6888         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6889
  6890     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6891         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6892
  6893     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6894         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6895         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6896
  6897     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6898
  6899     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6900     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6901     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6902     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6903     12  AM-DCC-UEF-STATE                  PIC XX.
  6904     12  FILLER                            PIC XXX.
  6905     12  AM-REPORT-CODE-3                  PIC X(10).
  6906*    12  FILLER                            PIC X(22).
  6907
  6908     12  AM-RESERVE-DATE.
  6909         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6910         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6911         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6912
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 129
* EL156.cbl
  6913     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6914     12  AM-NOTIFICATION-TYPES.
  6915         16  AM-NOTIF-OF-LETTERS           PIC X.
  6916         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6917         16  AM-NOTIF-OF-REPORTS           PIC X.
  6918         16  AM-NOTIF-OF-STATUS            PIC X.
  6919
  6920     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6921         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6922         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6923         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6924         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6925
  6926     12  AM-BENEFIT-CONTROLS.
  6927         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6928             20  AM-BENEFIT-CODE           PIC XX.
  6929             20  AM-BENEFIT-TYPE           PIC X.
  6930             20  AM-BENEFIT-REVISION       PIC XXX.
  6931             20  AM-BENEFIT-REM-TERM       PIC X.
  6932             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6933             20  FILLER                    PIC XX.
  6934         16  FILLER                        PIC X(80).
  6935
  6936     12  AM-TRANSFER-DATA.
  6937         16  AM-TRANSFERRED-FROM.
  6938             20  AM-TRNFROM-CARRIER        PIC X.
  6939             20  AM-TRNFROM-GROUPING.
  6940                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6941                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6942             20  AM-TRNFROM-STATE          PIC XX.
  6943             20  AM-TRNFROM-ACCOUNT.
  6944                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6945                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6946             20  AM-TRNFROM-DTE            PIC XX.
  6947         16  AM-TRANSFERRED-TO.
  6948             20  AM-TRNTO-CARRIER          PIC X.
  6949             20  AM-TRNTO-GROUPING.
  6950                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6951                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6952             20  AM-TRNTO-STATE            PIC XX.
  6953             20  AM-TRNTO-ACCOUNT.
  6954                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6955                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6956             20  AM-TRNTO-DTE              PIC XX.
  6957         16  FILLER                        PIC X(10).
  6958
  6959     12  AM-SAVED-REMIT-TO                 PIC 99.
  6960
  6961     12  AM-COMM-STRUCTURE-SAVED.
  6962         16  AM-DEFN-1-SAVED.
  6963             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6964                 24  AM-AGT-SV             PIC X(10).
  6965                 24  AM-COM-TYP-SV         PIC X.
  6966                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6967                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6968                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6969                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6970                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 130
* EL156.cbl
  6971                 24  AM-GL-CODES-SV        PIC X.
  6972                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6973                 24  FILLER                PIC X.
  6974         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6975             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6976                 24  FILLER                PIC X(11).
  6977                 24  AM-L-COMA-SV          PIC XXX.
  6978                 24  AM-J-COMA-SV          PIC XXX.
  6979                 24  AM-A-COMA-SV          PIC XXX.
  6980                 24  FILLER                PIC X(6).
  6981
  6982     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6983         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6984            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6985            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6986            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6987
  6988     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6989     12  FILLER                            PIC X(120).
  6990
  6991     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6992         16  AM-CONTROL-NAME               PIC X(30).
  6993         16  AM-EXECUTIVE-ONE.
  6994             20  AM-EXEC1-NAME             PIC X(15).
  6995             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6996                                                          COMP-3.
  6997             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6998                                                          COMP-3.
  6999         16  AM-EXECUTIVE-TWO.
  7000             20  AM-EXEC2-NAME             PIC X(15).
  7001             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7002                                                          COMP-3.
  7003             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7004                                                          COMP-3.
  7005
  7006     12  AM-RETRO-ADDITIONAL-DATA.
  7007         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7008         16  AM-RETRO-PREM-P-E             PIC X.
  7009         16  AM-RETRO-CLMS-P-I             PIC X.
  7010         16  AM-RETRO-RET-BRACKET-LF.
  7011             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7012                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7013                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7014             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7015                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7016                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7017             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7018                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7019                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7020         16  AM-RETRO-RET-BRACKET-AH.
  7021             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7022                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7023                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7024                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7025             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7026                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7027                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7028             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 131
* EL156.cbl
  7029                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7030                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7031
  7032     12  AM-COMMENTS.
  7033         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7034
  7035     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7036         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7037         16  AM-FLI-BILLING-CODE           PIC X.
  7038         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7039         16  AM-FLI-UNITED-IDENT           PIC X.
  7040         16  AM-FLI-INTEREST-LOST-DATA.
  7041             20  AM-FLI-BANK-NO            PIC X(5).
  7042             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7043             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7044             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7045         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7046             20  AM-FLI-AGT                PIC X(9).
  7047             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7048             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7049         16  FILLER                        PIC X(102).
  7050
  7051     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7052         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7053             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7054             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7055             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7056             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7057             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7058         16  FILLER                          PIC X(10).
  7059******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 132
* EL156.cbl
  7061*    COPY ELCCHKQ.
  7062******************************************************************
  7063*                                                                *
  7064*                                                                *
  7065*                            ELCCHKQ.                            *
  7066*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7067*                            VMOD=2.007                          *
  7068*                                                                *
  7069*   FILE DESCRIPTION = CHECK QUE FILE                            *
  7070*                                                                *
  7071*   FILE TYPE = VSAM,KSDS                                        *
  7072*   RECORD SIZE = 100  RECFORM = FIXED                           *
  7073*                                                                *
  7074*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  7075*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  7076*                                                                *
  7077*   LOG = YES                                                    *
  7078*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7079******************************************************************
  7080 01  CHECK-QUE.
  7081     12  CQ-RECORD-ID                PIC XX.
  7082         88  VALID-CQ-ID         VALUE 'CQ'.
  7083
  7084     12  CQ-CONTROL-PRIMARY.
  7085         16  CQ-COMPANY-CD           PIC X.
  7086         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7087         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7088
  7089     12  CQ-CONTROL-BY-PAYEE.
  7090         16  CQ-CONTROL-BY-NUMBER.
  7091             20  CQ-COMPANY-CD-A1     PIC X.
  7092             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7093         16  CQ-PAYEE-CARRIER        PIC X.
  7094         16  CQ-PAYEE-GROUPING       PIC X(6).
  7095         16  CQ-PAYEE-STATE          PIC XX.
  7096         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7097         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7098
  7099     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7100         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7101         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7102         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7103         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7104         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7105         16  FILLER                  PIC X(3).
  7106
  7107     12  CQ-ENTRY-TYPE               PIC X.
  7108             88  CHECK-ON-QUE           VALUE 'Q'.
  7109             88  ALIGNMENT-CHECK        VALUE 'A'.
  7110             88  SPOILED-CHECK          VALUE 'S'.
  7111             88  PAYMENT-ABORTED        VALUE 'X'.
  7112
  7113     12  CQ-CLAIM-MAST-CNTL.
  7114         16  CQ-CARRIER              PIC X.
  7115         16  CQ-CLAIM-NO             PIC X(7).
  7116         16  CQ-CERT-NO.
  7117             20  CQ-CERT-PRIME       PIC X(10).
  7118             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 133
* EL156.cbl
  7119         16  CQ-CLAIM-TYPE           PIC X.
  7120             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7121             88  CQ-AH-CLAIM            VALUE 'A'.
  7122         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7123             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7124             88  CQ-O-B-COVERAGE        VALUE '2'.
  7125             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7126
  7127     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7128     12  CQ-CHECK-NUMBER             PIC X(7).
  7129     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7130     12  CQ-PAYMENT-TYPE             PIC X.
  7131             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7132             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7133             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7134             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7135             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7136             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7137             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7138             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7139     12  CQ-VOID-INDICATOR           PIC X.
  7140             88  CHECK-IS-STOPPED          VALUE 'S'.
  7141             88  CHECK-IS-VOID             VALUE 'V'.
  7142     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7143     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7144     12  CQ-CHECK-BY-USER            PIC X(4).
  7145     12  CQ-PRE-NUMBERING-SW         PIC X.
  7146       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7147       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7148
  7149     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7150     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7151     12  CQ-LEDGER-FLAG              PIC X(01).
  7152     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7153     12  CQ-LAST-UPDATED-DT          PIC XX.
  7154     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7155     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7156
  7157     12  FILLER                      PIC X(04).
  7158
  7159******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 134
* EL156.cbl
  7161*    COPY ELCBENE.
  7162******************************************************************
  7163*                                                                *
  7164*                            ELCBENE.                            *
  7165*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7166*                            VMOD=2.006                          *
  7167*                                                                *
  7168*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7169*                                                                *
  7170*   FILE TYPE = VSAM,KSDS                                        *
  7171*   RECORD SIZE = 500   RECFORM = FIX                            *
  7172*                                                                *
  7173*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7174*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7175*                                                                *
  7176*   LOG = YES                                                    *
  7177*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7178*                                                                *
  7179*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7180******************************************************************
  7181*                   C H A N G E   L O G
  7182*
  7183* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7184*-----------------------------------------------------------------
  7185*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7186* EFFECTIVE    NUMBER
  7187*-----------------------------------------------------------------
  7188* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7189* 082317  CR2017082100003  PEMA  Add sub type
  7190******************************************************************
  7191
  7192 01  BENEFICIARY-MASTER.
  7193     12  BE-RECORD-ID                PIC XX.
  7194         88  VALID-BE-ID                VALUE 'BE'.
  7195
  7196     12  BE-CONTROL-PRIMARY.
  7197         16  BE-COMPANY-CD           PIC X.
  7198         16  BE-RECORD-TYPE          PIC X.
  7199             88  BENEFICIARY-RECORD  VALUE 'B'.
  7200             88  ADJUSTOR-RECORD     VALUE 'A'.
  7201         16  BE-BENEFICIARY          PIC X(10).
  7202     12  BE-CONTROL-BY-NAME.
  7203         16  BE-COMPANY-CD-A1        PIC X.
  7204         16  BE-RECORD-TYPE-A1       PIC X.
  7205         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7206         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7207
  7208     12  BE-LAST-MAINT-DT            PIC XX.
  7209     12  BE-LAST-MAINT-BY            PIC X(4).
  7210     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7211
  7212     12  BE-ADDRESS-DATA.
  7213         16  BE-MAIL-TO-NAME         PIC X(30).
  7214         16  BE-ADDRESS-LINE-1       PIC X(30).
  7215         16  BE-ADDRESS-LINE-2       PIC X(30).
  7216         16  BE-ADDRESS-LINE-3       PIC X(30).
  7217         16  BE-CITY-STATE.
  7218             20  BE-CITY             PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 135
* EL156.cbl
  7219             20  BE-STATE            PIC XX.
  7220         16  BE-ZIP-CODE.
  7221             20  BE-ZIP-PRIME.
  7222                 24  BE-ZIP-1ST      PIC X.
  7223                     88  BE-CANADIAN-POST-CODE
  7224                                         VALUE 'A' THRU 'Z'.
  7225                 24  FILLER          PIC X(4).
  7226             20  BE-ZIP-PLUS4        PIC X(4).
  7227         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7228             20  BE-CAN-POSTAL-1     PIC XXX.
  7229             20  BE-CAN-POSTAL-2     PIC XXX.
  7230             20  FILLER              PIC XXX.
  7231         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7232         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7233
  7234******************************************************************
  7235*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7236*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7237******************************************************************
  7238     12  BE-CARRIER                  PIC X.
  7239
  7240     12  BE-ADDRESS-DATA2.
  7241         16  BE-MAIL-TO-NAME2        PIC X(30).
  7242         16  BE-ADDRESS-LINE-12      PIC X(30).
  7243         16  BE-ADDRESS-LINE-22      PIC X(30).
  7244         16  BE-ADDRESS-LINE-32      PIC X(30).
  7245         16  BE-CITY-STATE2.
  7246             20  BE-CITY2            PIC X(28).
  7247             20  BE-STATE2           PIC XX.
  7248         16  BE-ZIP-CODE2.
  7249             20  BE-ZIP-PRIME2.
  7250                 24  BE-ZIP-1ST2     PIC X.
  7251                     88  BE-CANADIAN-POST-CODE2
  7252                                         VALUE 'A' THRU 'Z'.
  7253                 24  FILLER          PIC X(4).
  7254             20  BE-ZIP-PLUS42       PIC X(4).
  7255         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7256             20  BE-CAN-POSTAL-12    PIC XXX.
  7257             20  BE-CAN-POSTAL-22    PIC XXX.
  7258             20  FILLER              PIC XXX.
  7259         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7260         16  BE-ACH-DATA.
  7261             20  BE-ACH-YES-OR-NO    PIC X.
  7262                 88  BE-ON-ACH       VALUE 'Y'.
  7263                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7264             20  BE-ACH-ABA-ROUTING-NUMBER
  7265                                     PIC X(15).
  7266             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7267                                     PIC X(20).
  7268             20  BE-ACH-SUB-TYPE     PIC XX.
  7269             20  FILLER              PIC X(23).
  7270         16  BE-BILLING-STMT-DATA.
  7271*            20  BE-BSR              PIC X.
  7272*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7273*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7274*            20  BE-BSR-FROM         PIC X(30).
  7275*            20  BE-BSR-DEPT         PIC X(30).
  7276             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 136
* EL156.cbl
  7277             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7278             20  BE-OUTPUT-TYPE      PIC X.
  7279                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7280                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7281
  7282     12  FILLER                      PIC X(28).
  7283******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 137
* EL156.cbl
  7285*    COPY ELCARCH.
  7286******************************************************************
  7287*                                                                *
  7288*                            ELCARCH.                            *
  7289*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7290*                            VMOD=2.007                          *
  7291*                                                                *
  7292*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7293*                                                                *
  7294*   FILE TYPE = VSAM,KSDS                                        *
  7295*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7296*                                                                *
  7297*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7298*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7299*                                                                *
  7300*   LOG = NO                                                     *
  7301*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7302*                                                                *
  7303*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7304******************************************************************
  7305 01  LETTER-ARCHIVE.
  7306     12  LA-RECORD-ID                PIC XX.
  7307         88  VALID-LA-ID                VALUE 'LA'.
  7308
  7309     12  LA-CONTROL-PRIMARY.
  7310         16  LA-COMPANY-CD           PIC X.
  7311         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7312         16  LA-RECORD-TYPE          PIC X.
  7313             88  LA-HEADER-DATA         VALUE '1'.
  7314             88  LA-ADDRESS-DATA        VALUE '2'.
  7315             88  LA-TEXT-DATA           VALUE '3'.
  7316             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7317         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7318
  7319     12  LA-CONTROL-BY-TYPE.
  7320         16  LA-COMPANY-CD-A1        PIC X.
  7321         16  LA-RECORD-TYPE-A1       PIC X.
  7322         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7323         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7324
  7325     12  LA-TEXT-RECORD.
  7326         16  LA-SKIP-CONTROL         PIC XX.
  7327             88  NO-LINES-SKIPPED       VALUE SPACES.
  7328             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7329         16  LA-TEXT-LINE            PIC X(70).
  7330
  7331     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7332         16  FILLER                  PIC XX.
  7333         16  LA-ADDRESS-LINE         PIC X(30).
  7334         16  FILLER                  PIC X(40).
  7335
  7336     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7337         16  FILLER                  PIC XX.
  7338         16  LA-CARRIER              PIC X.
  7339         16  LA-CLAIM-NO             PIC X(7).
  7340         16  LA-CERT-NO.
  7341             20  LA-CERT-PRIME       PIC X(10).
  7342             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 138
* EL156.cbl
  7343         16  LA-NO-OF-COPIES         PIC S9.
  7344         16  LA-RESEND-DATE          PIC XX.
  7345         16  LA-PROCESSOR-CD         PIC X(4).
  7346         16  LA-CREATION-DT          PIC XX.
  7347         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7348         16  LA-RESEND-PRINT-DATE    PIC XX.
  7349         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7350         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7351*
  7352* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7353*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7354*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7355*   I        20  LA-DMD-RES-ST           PIC XX.
  7356*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7357*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7358*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7359*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7360*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7361*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7362*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7363*   I        20  LA-DMD-UND-CODE         PIC XX.
  7364*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7365*   V    16  FILLER                  PIC X(15).
  7366* -----
  7367*
  7368* REINSERTED  CSO  MODS
  7369*
  7370         16  FILLER.
  7371             20  FILLER                  PIC X(29).
  7372             20  LA-CSO-LETTER-STATUS    PIC X.
  7373                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7374                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7375                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7376             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7377             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7378*
  7379
  7380     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7381         16  FILLER                  PIC XX.
  7382         16  LA4-CARRIER             PIC X.
  7383         16  LA4-CLAIM-NO            PIC X(7).
  7384         16  LA4-CERT-NO.
  7385             20  LA4-CERT-PRIME      PIC X(10).
  7386             20  LA4-CERT-SFX        PIC X.
  7387         16  LA4-NO-OF-COPIES        PIC S9.
  7388         16  LA4-RESEND-DATE         PIC XX.
  7389         16  LA4-PROCESSOR-CD        PIC X(4).
  7390         16  LA4-CREATION-DT         PIC XX.
  7391         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7392         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7393         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7394         16  LA4-FORM-TYPE           PIC X.
  7395             88  LA4-INITIAL-FORM    VALUE '1'.
  7396             88  LA4-PROGRESS-FORM   VALUE '2'.
  7397         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7398         16  LA4-STATE               PIC X(02).
  7399         16  FILLER                  PIC X(31).
  7400******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 139
* EL156.cbl
  7402*    COPY ELCDAR.
  7403******************************************************************
  7404*                                                                *
  7405*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7406*   FILE TYPE = VSAM,KSDS                                        *
  7407*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7408*   BASE CLUSTER = DLYACTV                                       *
  7409*   LOG = YES                                                    *
  7410*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7411*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7412*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7413*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7414*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7415*               BY PROGRAM "LGINFCE".                            *
  7416*                                                                *
  7417******************************************************************
  7418 01  DAILY-ACTIVITY-RECORD.
  7419     05  DA-KEY.
  7420         10  DA-COMP-CD          PIC X.
  7421         10  DA-CARRIER          PIC X.
  7422         10  DA-CLAIM-NO         PIC X(7).
  7423         10  DA-CERT-NO.
  7424             15  DA-CERT-PRIME   PIC X(10).
  7425             15  DA-CERT-SFX     PIC X.
  7426     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7427     05  DA-RECORD-TYPE          PIC X.
  7428     05  FILLER                  PIC X(2).
  7429******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 140
* EL156.cbl
  7431*    COPY ERCCOMP.
  7432******************************************************************
  7433*                                                                *
  7434*                                                                *
  7435*                            ERCCOMP                             *
  7436*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7437*                            VMOD=2.019                          *
  7438*                                                                *
  7439*   ONLINE CREDIT SYSTEM                                         *
  7440*                                                                *
  7441*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7442*                                                                *
  7443*   FILE TYPE = VSAM,KSDS                                        *
  7444*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7445*                                                                *
  7446*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7447*       ALTERNATE PATH = NONE                                    *
  7448*                                                                *
  7449*   LOG = NO                                                     *
  7450*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7451*                                                                *
  7452******************************************************************
  7453*                   C H A N G E   L O G
  7454*
  7455* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7456*-----------------------------------------------------------------
  7457*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7458* EFFECTIVE    NUMBER
  7459*-----------------------------------------------------------------
  7460* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7461* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7462* 092205    2005050300006  PEMA  ADD LEASE FEE
  7463* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7464* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7465* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7466* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7467* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7468* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7469******************************************************************
  7470
  7471 01  COMPENSATION-MASTER.
  7472     12  CO-RECORD-ID                          PIC XX.
  7473         88  VALID-CO-ID                          VALUE 'CO'.
  7474
  7475     12  CO-CONTROL-PRIMARY.
  7476         16  CO-COMPANY-CD                     PIC X.
  7477         16  CO-CONTROL.
  7478             20  CO-CTL-1.
  7479                 24  CO-CARR-GROUP.
  7480                     28  CO-CARRIER            PIC X.
  7481                     28  CO-GROUPING.
  7482                         32  CO-GROUP-PREFIX   PIC XXX.
  7483                         32  CO-GROUP-PRIME    PIC XXX.
  7484                 24  CO-RESP-NO.
  7485                     28  CO-RESP-PREFIX        PIC X(4).
  7486                     28  CO-RESP-PRIME         PIC X(6).
  7487             20  CO-CTL-2.
  7488                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 141
* EL156.cbl
  7489                     28  CO-ACCT-PREFIX        PIC X(4).
  7490                     28  CO-ACCT-PRIME         PIC X(6).
  7491         16  CO-TYPE                           PIC X.
  7492             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7493             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7494             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7495
  7496     12  CO-MAINT-INFORMATION.
  7497         16  CO-LAST-MAINT-DT                  PIC XX.
  7498         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7499         16  CO-LAST-MAINT-USER                PIC X(4).
  7500     12  FILLER                                PIC XX.
  7501     12  CO-STMT-TYPE                          PIC XXX.
  7502     12  CO-COMP-TYPE                          PIC X.
  7503         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7504     12  CO-STMT-OWNER                         PIC X(4).
  7505     12  CO-BALANCE-CONTROL                    PIC X.
  7506         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7507         88  CO-NO-BALANCE                        VALUE 'N'.
  7508
  7509     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7510         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7511         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7512         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7513
  7514     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7515         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7516         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7517
  7518     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7519     12  CO-GA-DIRECT-DEP                      PIC X.
  7520     12  CO-FUTURE-SPACE                       PIC X.
  7521         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7522
  7523     12  CO-ACCT-NAME                          PIC X(30).
  7524     12  CO-MAIL-NAME                          PIC X(30).
  7525     12  CO-ADDR-1                             PIC X(30).
  7526     12  CO-ADDR-2                             PIC X(30).
  7527     12  CO-ADDR-3.
  7528         16  CO-ADDR-CITY                      PIC X(27).
  7529         16  CO-ADDR-STATE                     PIC XX.
  7530     12  CO-CSO-1099                           PIC X.
  7531     12  CO-ZIP.
  7532         16  CO-ZIP-PRIME.
  7533             20  CO-ZIP-PRI-1ST                PIC X.
  7534                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7535             20  FILLER                        PIC X(4).
  7536         16  CO-ZIP-PLUS4                      PIC X(4).
  7537     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7538         16  CO-CAN-POSTAL-1                   PIC XXX.
  7539         16  CO-CAN-POSTAL-2                   PIC XXX.
  7540         16  FILLER                            PIC XXX.
  7541     12  CO-SOC-SEC                            PIC X(13).
  7542     12  CO-TELEPHONE.
  7543         16  CO-AREA-CODE                      PIC XXX.
  7544         16  CO-PREFIX                         PIC XXX.
  7545         16  CO-PHONE                          PIC X(4).
  7546
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 142
* EL156.cbl
  7547     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7548
  7549     12  CO-AR-BAL-LEVEL                       PIC X.
  7550         88  CO-AR-REF-LVL                        VALUE '1'.
  7551         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7552         88  CO-AR-BILL-LVL                       VALUE '2'.
  7553         88  CO-AR-AGT-LVL                        VALUE '3'.
  7554         88  CO-AR-FR-LVL                         VALUE '4'.
  7555
  7556     12  CO-AR-NORMAL-PRINT                    PIC X.
  7557         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7558         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7559
  7560     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7561
  7562     12  CO-AR-REPORTING                       PIC X.
  7563         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7564         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7565
  7566     12  CO-AR-PULL-CHECK                      PIC X.
  7567         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7568         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7569
  7570     12  CO-AR-BALANCE-PRINT                   PIC X.
  7571         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7572
  7573     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7574         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7575         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7576         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7577
  7578     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7579
  7580     12  CO-USER-CODE                          PIC X.
  7581     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7582
  7583******************************************************************
  7584*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7585*    THE LAST MONTH END RUN.
  7586******************************************************************
  7587
  7588     12  CO-LAST-ACTIVITY-DATE.
  7589         16  CO-ACT-YEAR                       PIC 99.
  7590         16  CO-ACT-MONTH                      PIC 99.
  7591         16  CO-ACT-DAY                        PIC 99.
  7592
  7593     12  CO-LAST-STMT-DT.
  7594         16  CO-LAST-STMT-YEAR                 PIC 99.
  7595         16  CO-LAST-STMT-MONTH                PIC 99.
  7596         16  CO-LAST-STMT-DAY                  PIC 99.
  7597
  7598     12  CO-MO-END-TOTALS.
  7599         16  CO-MONTHLY-TOTALS.
  7600             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7601             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7602             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7603             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7604             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 143
* EL156.cbl
  7605
  7606         16  CO-AGING-TOTALS.
  7607             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7608             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7609             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7610             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7611
  7612         16  CO-YTD-TOTALS.
  7613             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7614             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7615
  7616         16  CO-OVER-UNDER-TOTALS.
  7617             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7618             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7619
  7620     12  CO-MISCELLANEOUS-TOTALS.
  7621         16  CO-FICA-TOTALS.
  7622             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7623             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7624
  7625         16  CO-CLAIM-TOTALS.
  7626             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7627             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7628
  7629******************************************************************
  7630*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7631*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7632******************************************************************
  7633
  7634     12  CO-CURRENT-TOTALS.
  7635         16  CO-CURRENT-LAST-STMT-DT.
  7636             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7637             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7638             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7639
  7640         16  CO-CURRENT-MONTHLY-TOTALS.
  7641             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7642             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7643             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7644             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7645             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7646
  7647         16  CO-CURRENT-AGING-TOTALS.
  7648             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7649             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7650             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7651             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7652
  7653         16  CO-CURRENT-YTD-TOTALS.
  7654             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7655             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7656
  7657     12  CO-PAID-COMM-TOTALS.
  7658         16  CO-YTD-PAID-COMMS.
  7659             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7660             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7661
  7662     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 144
* EL156.cbl
  7663         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7664         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7665
  7666     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7667         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7668         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7669         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7670         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7671         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7672         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7673         88  CO-FINAL-LETTER                  VALUE 'F'.
  7674         88  CO-RECONCILING                   VALUE 'R'.
  7675         88  CO-PHONE-CALL                    VALUE 'P'.
  7676         88  CO-LEGAL                         VALUE 'L'.
  7677         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7678         88  CO-WRITE-OFF                     VALUE 'W'.
  7679         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7680
  7681     12  CO-CSR-CODE                       PIC X(4).
  7682
  7683     12  CO-GA-STATUS-INFO.
  7684         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7685         16  CO-GA-TERMINATION-DT          PIC XX.
  7686         16  CO-GA-STATUS-CODE             PIC X.
  7687             88  CO-GA-ACTIVE                 VALUE 'A'.
  7688             88  CO-GA-INACTIVE               VALUE 'I'.
  7689             88  CO-GA-PENDING                VALUE 'P'.
  7690         16  CO-GA-COMMENTS.
  7691             20  CO-GA-COMMENT-1           PIC X(40).
  7692             20  CO-GA-COMMENT-2           PIC X(40).
  7693             20  CO-GA-COMMENT-3           PIC X(40).
  7694             20  CO-GA-COMMENT-4           PIC X(40).
  7695
  7696     12  CO-RPTCD2                         PIC X(10).
  7697     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7698         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7699         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7700
  7701     12  CO-TYPE-AGENT                     PIC X(01).
  7702         88  CO-CORPORATION                   VALUE 'C'.
  7703         88  CO-PARTNERSHIP                   VALUE 'P'.
  7704         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7705         88  CO-TRUST                         VALUE 'T'.
  7706         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7707
  7708     12  CO-FAXNO.
  7709         16  CO-FAX-AREA-CODE                  PIC XXX.
  7710         16  CO-FAX-PREFIX                     PIC XXX.
  7711         16  CO-FAX-PHONE                      PIC X(4).
  7712
  7713     12  CO-BANK-INFORMATION.
  7714         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7715         16  CO-BANK-TRANSIT-NON REDEFINES
  7716             CO-BANK-TRANSIT-NO                PIC 9(8).
  7717
  7718         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7719     12  CO-MISC-DEDUCT-INFO REDEFINES
  7720                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 145
* EL156.cbl
  7721         16  CO-MD-GL-ACCT                     PIC X(10).
  7722         16  CO-MD-DIV                         PIC XX.
  7723         16  CO-MD-CENTER                      PIC X(4).
  7724         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7725         16  CO-CREATE-AP-CHECK                PIC X.
  7726         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7727         16  FILLER                            PIC XXX.
  7728     12  CO-ACH-STATUS                         PIC X.
  7729         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7730         88  CO-ACH-PENDING                        VALUE 'P'.
  7731
  7732     12  CO-BILL-SW                            PIC X.
  7733     12  CO-CONTROL-NAME                       PIC X(30).
  7734     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7735     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7736     12  CO-CLP-STATE                          PIC XX.
  7737     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7738     12  CO-SPP-REFUND-EDIT                    PIC X.
  7739
  7740******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 146
* EL156.cbl
  7742*    COPY ERCDMDNT.
  7743******************************************************************
  7744*                                                                *
  7745*                            ERCDMDNT                            *
  7746*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7747*                            VMOD=2.005                          *
  7748*                                                                *
  7749*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7750*                                                                *
  7751*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7752*                                                                *
  7753*        FILE TYPE= VSAM,KSDS                                    *
  7754*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7755*                                                                *
  7756*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7757*                                                                *
  7758*        LOG = YES                                               *
  7759*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7760*                                                                *
  7761******************************************************************
  7762
  7763 01  CERTIFICATE-NOTE.
  7764     12  CN-RECORD-ID                     PIC  XX.
  7765         88  VALID-CN-ID                      VALUE 'CN'.
  7766
  7767     12  CN-CONTROL-PRIMARY.
  7768         16  CN-COMPANY-CD                PIC X.
  7769         16  CN-CERT-KEY.
  7770             20  CN-CARRIER               PIC X.
  7771             20  CN-GROUPING.
  7772                 24  CN-GROUPING-PREFIX   PIC XXX.
  7773                 24  CN-GROUPING-PRIME    PIC XXX.
  7774             20  CN-STATE                 PIC XX.
  7775             20  CN-ACCOUNT.
  7776                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7777                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7778             20  CN-CERT-EFF-DT           PIC XX.
  7779             20  CN-CERT-NO.
  7780                 24  CN-CERT-PRIME        PIC X(10).
  7781                 24  CN-CERT-SFX          PIC X.
  7782
  7783     12  CN-BILLING-START-LINE-NO         PIC 99.
  7784     12  CN-BILLING-END-LINE-NO           PIC 99.
  7785
  7786     12  CN-LINES.
  7787         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7788
  7789     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7790         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7791         16  CN-CSI-GENERAL-DATA-AREA.
  7792             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7793
  7794         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7795             CN-CSI-GENERAL-DATA-AREA.
  7796             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7797             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7798             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7799             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 147
* EL156.cbl
  7800             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7801             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7802             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7803             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7804             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7805             20  FILLER                       PIC XX.
  7806             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7807             20  FILLER                       PIC X(38).
  7808
  7809         16  CN-CSI-PRODUCT-DATA-AREA.
  7810             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7811
  7812         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7813             CN-CSI-PRODUCT-DATA-AREA.
  7814             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7815             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7816             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7817             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7818             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7819             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7820             20  FILLER                   PIC XX.
  7821             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7822             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7823             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7824             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7825             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7826             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7827             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7828             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7829             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7830             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7831             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7832             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7833             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7834             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7835             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7836             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7837             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7838             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7839             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7840             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7841             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7842             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7843             20  FILLER                   PIC X(25).
  7844
  7845         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7846             CN-CSI-CREDIT-CARD-DATA.
  7847             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7848             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7849             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7850             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7851             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7852             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7853             20  FILLER                   PIC XX.
  7854             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7855             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7856             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7857             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 148
* EL156.cbl
  7858             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7859             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7860             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7861             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7862             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7863             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7864             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7865             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7866             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7867             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7868             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7869             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7870             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7871             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7872             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7873             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7874             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7875             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7876             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7877             20  FILLER                   PIC X(17).
  7878
  7879         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7880             CN-CSI-FAMILY-LEAVE-DATA.
  7881             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7882             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7883             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7884             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7885             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7886             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7887             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7888             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7889             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7890             20  CN-CSI-SL-INT-ON-PROCEEDS
  7891                                          PIC S9(5)V99  COMP-3.
  7892             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7893             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7894             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7895             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7896             20  CN-CSI-SL-POLICY-BENEFITS
  7897                                          PIC S9(5)V99  COMP-3.
  7898             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7899             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7900             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7901             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7902             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7903             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7904             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7905             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7906             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7907             20  CN-CSI-SL-STATE-NOT      PIC X.
  7908             20  FILLER                   PIC XX.
  7909
  7910         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7911             CN-CSI-SENIOR-LIFE-DATA.
  7912             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7913             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7914             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7915                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 149
* EL156.cbl
  7916             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7917             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7918             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7919             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7920             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7921             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7922             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7923             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7924             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7925             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7926             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7927             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7928             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7929             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7930             20  CN-CSI-PP-REPAIR         PIC X.
  7931             20  CN-CSI-PP-REPLACE        PIC X.
  7932             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7933             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7934             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7935             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7936             20  FILLER                   PIC X(5).
  7937
  7938         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7939             CN-CSI-PURCH-PROP-DATA.
  7940             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7941             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7942             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7943             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7944             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7945             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7946             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7947             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7948             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7949             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7950             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7951             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7952             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7953             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7954             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7955             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7956             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7957             20  CN-CSI-EW-REPLACE        PIC X.
  7958             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7959             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7960             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7961             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7962             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7963             20  FILLER                   PIC X(4).
  7964
  7965     12  CN-LAST-MAINT-DT                 PIC XX.
  7966     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7967     12  CN-LAST-MAINT-USER               PIC X(4).
  7968     12  FILLER                           PIC X(6).
  7969
  7970******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 150
* EL156.cbl
  7972*    COPY ERCCNOT.
  7973******************************************************************
  7974*                                                                *
  7975*                            ERCCNOT                             *
  7976*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7977*                            VMOD=2.003                          *
  7978*                                                                *
  7979*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7980*                                                                *
  7981*        FILE TYPE= VSAM,KSDS                                    *
  7982*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7983*                                                                *
  7984*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7985*                                                                *
  7986*        LOG = YES                                               *
  7987*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7988*                                                                *
  7989******************************************************************
  7990*                   C H A N G E   L O G
  7991*
  7992* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7993*-----------------------------------------------------------------
  7994*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7995* EFFECTIVE    NUMBER
  7996*-----------------------------------------------------------------
  7997* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7998******************************************************************
  7999
  8000 01  CERT-NOTE-FILE.
  8001     12  CZ-RECORD-ID                PIC  XX.
  8002         88  VALID-CZ-ID                  VALUE 'CZ'.
  8003
  8004     12  CZ-CONTROL-PRIMARY.
  8005         16  CZ-COMPANY-CD           PIC X.
  8006         16  CZ-CARRIER              PIC X.
  8007         16  CZ-GROUPING.
  8008             20 CZ-GROUPING-PREFIX   PIC XXX.
  8009             20 CZ-GROUPING-PRIME    PIC XXX.
  8010         16  CZ-STATE                PIC XX.
  8011         16  CZ-ACCOUNT.
  8012             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  8013             20 CZ-ACCOUNT-PRIME     PIC X(6).
  8014         16  CZ-CERT-EFF-DT          PIC XX.
  8015         16  CZ-CERT-NO.
  8016             20  CZ-CERT-PRIME       PIC X(10).
  8017             20  CZ-CERT-SFX         PIC X.
  8018         16  CZ-RECORD-TYPE          PIC X.
  8019             88  CERT-NOTE           VALUE '1'.
  8020             88  CLAIM-CERT-NOTE     VALUE '2'.
  8021         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  8022
  8023     12  CZ-LAST-MAINT-DT            PIC XX.
  8024     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8025     12  CZ-LAST-MAINT-USER          PIC X(4).
  8026
  8027     12  CZ-NOTE-INFORMATION.
  8028         16  CZ-NOTE                 PIC X(63).
  8029         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 151
* EL156.cbl
  8030******************************************************************
  8031*                            COPY ERCPDEF.
  8032******************************************************************
  8033*                                                                *
  8034*                                                                *
  8035*                            ERCPDEF.                            *
  8036*                                                                *
  8037*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  8038*                                                                *
  8039*    FILE TYPE = VSAM,KSDS                                       *
  8040*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  8041*                                                                *
  8042*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  8043*                                                                *
  8044*    LOG = YES                                                   *
  8045*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8046******************************************************************
  8047*                   C H A N G E   L O G
  8048*
  8049* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8050*-----------------------------------------------------------------
  8051*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8052* EFFECTIVE    NUMBER
  8053*-----------------------------------------------------------------
  8054* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8055* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8056* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  8057******************************************************************
  8058 01  PRODUCT-MASTER.
  8059    12  PD-RECORD-ID                 PIC X(02).
  8060        88  VALID-PD-ID                  VALUE 'PD'.
  8061    12  PD-CONTROL-PRIMARY.
  8062        16  PD-COMPANY-CD            PIC X.
  8063        16  PD-STATE                 PIC XX.
  8064        16  PD-PRODUCT-CD            PIC XXX.
  8065        16  PD-FILLER                PIC X(7).
  8066        16  PD-BEN-TYPE              PIC X.
  8067        16  PD-BEN-CODE              PIC XX.
  8068        16  PD-PROD-EXP-DT           PIC XX.
  8069    12  FILLER                       PIC X(50).
  8070    12  PD-PRODUCT-DATA OCCURS 8.
  8071        16  PD-PROD-CODE             PIC X.
  8072            88  PD-PROD-LIFE           VALUE 'L'.
  8073            88  PD-PROD-PROP           VALUE 'P'.
  8074            88  PD-PROD-AH             VALUE 'A'.
  8075            88  PD-PROD-IU             VALUE 'I'.
  8076            88  PD-PROD-GAP            VALUE 'G'.
  8077            88  PD-PROD-FAML           VALUE 'F'.
  8078        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  8079        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  8080        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  8081        16  PD-MAX-TERM              PIC S999        COMP-3.
  8082        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  8083        16  FILLER                   PIC X.
  8084        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  8085        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  8086        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  8087        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 152
* EL156.cbl
  8088        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  8089        16  PD-REC-CRIT-PERIOD       PIC 99.
  8090        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  8091            20  PD-RECURRING-YN      PIC X.
  8092            20  FILLER               PIC X.
  8093        16  PD-RTW-MOS               PIC 99.
  8094        16  PD-MAX-EXTENSION         PIC 99.
  8095        16  pd-ben-pct               pic sv999 comp-3.
  8096*       16  FILLER                   PIC XX.
  8097    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  8098    12  PD-TERM-LIMITS OCCURS 15.
  8099        16  PD-LOW-TERM              PIC S999        COMP-3.
  8100        16  PD-HI-TERM               PIC S999        COMP-3.
  8101*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8102    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8103        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8104        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8105    12  PD-EARN-FACTORS.
  8106        16  FILLER OCCURS 15.
  8107            20  FILLER OCCURS 15.
  8108                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8109    12  PD-PRODUCT-DESC              PIC X(80).
  8110    12  PD-TRUNCATED                 PIC X.
  8111    12  FILLER                       PIC X(59).
  8112    12  PD-MAINT-INFORMATION.
  8113        16  PD-LAST-MAINT-DT         PIC X(02).
  8114        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8115        16  PD-LAST-MAINT-BY         PIC X(04).
  8116*                            COPY ELCCRTT.
  8117******************************************************************
  8118*                                                                *
  8119*                            ELCCRTT.                            *
  8120*                                                                *
  8121*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8122*                                                                *
  8123*   FILE TYPE = VSAM,KSDS                                        *
  8124*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8125*                                                                *
  8126*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8127*                                                                *
  8128*   LOG = YES                                                    *
  8129*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8130******************************************************************
  8131*                   C H A N G E   L O G
  8132*
  8133* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8134*-----------------------------------------------------------------
  8135*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8136* EFFECTIVE    NUMBER
  8137*-----------------------------------------------------------------
  8138* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8139* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8140* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8141* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8142* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8143* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8144* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8145* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 153
* EL156.cbl
  8146* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8147******************************************************************
  8148
  8149 01  CERTIFICATE-TRAILERS.
  8150     12  CS-RECORD-ID                      PIC XX.
  8151         88  VALID-CS-ID                      VALUE 'CS'.
  8152
  8153     12  CS-CONTROL-PRIMARY.
  8154         16  CS-COMPANY-CD                 PIC X.
  8155         16  CS-CARRIER                    PIC X.
  8156         16  CS-GROUPING                   PIC X(6).
  8157         16  CS-STATE                      PIC XX.
  8158         16  CS-ACCOUNT                    PIC X(10).
  8159         16  CS-CERT-EFF-DT                PIC XX.
  8160         16  CS-CERT-NO.
  8161             20  CS-CERT-PRIME             PIC X(10).
  8162             20  CS-CERT-SFX               PIC X.
  8163         16  CS-TRAILER-TYPE               PIC X.
  8164             88  COMM-TRLR           VALUE 'A'.
  8165             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8166             88  CERT-DATA-TRLR      VALUE 'C'.
  8167
  8168     12  CS-DATA-AREA                      PIC X(516).
  8169
  8170     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8171         16  CS-BANK-COMMISSION-AREA.
  8172             20  CS-BANK-COMMS       OCCURS 10.
  8173                 24  CS-AGT                PIC X(10).
  8174                 24  CS-COM-TYP            PIC X.
  8175                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8176                 24  CS-RECALC-LV-INDIC    PIC X.
  8177                 24  FILLER                PIC X(10).
  8178         16  FILLER                        PIC X(256).
  8179
  8180     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8181****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8182         16  CS-MB-CLAIM-DATA OCCURS 24.
  8183             20  CS-CLAIM-NO               PIC X(7).
  8184             20  CS-CLAIM-TYPE             PIC X.
  8185                 88  CS-AH-CLM               VALUE 'A'.
  8186                 88  CS-IU-CLM               VALUE 'I'.
  8187                 88  CS-GP-CLM               VALUE 'G'.
  8188                 88  CS-LF-CLM               VALUE 'L'.
  8189                 88  CS-PR-CLM               VALUE 'P'.
  8190                 88  CS-FL-CLM               VALUE 'F'.
  8191             20  CS-INSURED-TYPE           PIC X.
  8192                 88  CS-PRIM-INSURED          VALUE 'P'.
  8193                 88  CS-CO-BORROWER           VALUE 'C'.
  8194             20  CS-BENEFIT-PERIOD         PIC 99.
  8195             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8196             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8197             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8198         16  FILLER                        PIC X(12).
  8199     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8200         16  CS-VIN-NUMBER                 PIC X(17).
  8201         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8202         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8203         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 154
* EL156.cbl
  8204         16  cs-agent-name.
  8205             20  cs-agent-fname            pic x(20).
  8206             20  cs-agent-mi               pic x.
  8207             20  cs-agent-lname            pic x(25).
  8208         16  cs-license-no                 pic x(15).
  8209         16  cs-npn-number                 pic x(10).
  8210         16  cs-agent-edit-status          pic x.
  8211             88  cs-ae-refer-to-manager      value 'M'.
  8212             88  cs-ae-cover-sheet           value 'C'.
  8213             88  cs-ae-sig-form              value 'S'.
  8214             88  cs-ae-verified              value 'V'.
  8215             88  cs-unidentified-signature   value 'U'.
  8216             88  cs-cert-returned            value 'R'.
  8217             88  cs-accept-no-commission     value 'N'.
  8218         16  cs-year                       pic 9999.
  8219         16  cs-make                       pic x(20).
  8220         16  cs-model                      pic x(20).
  8221         16  cs-future                     pic x(20).
  8222         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8223         16  FILLER                        PIC X(356). *> was 420
  8224*        16  FILLER                        PIC X(496).
  8225 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8226                          CONTROL-FILE CERTIFICATE-MASTER
  8227                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8228                          ACCOUNT-MASTER CHECK-QUE
  8229                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8230                          DAILY-ACTIVITY-RECORD
  8231                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8232                          CERT-NOTE-FILE PRODUCT-MASTER
  8233                          CERTIFICATE-TRAILERS.
  8234 0000-DFHEXIT SECTION.
  8235     MOVE '9#                    $   ' TO DFHEIV0.
  8236     MOVE 'EL156' TO DFHEIV1.
  8237     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8238
  8239     IF EIBCALEN = 0
  8240         GO TO 8800-UNAUTHORIZED-ACCESS.
  8241
  8242     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8243     MOVE EIBTRMID               TO QID-TERM.
  8244     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8245     MOVE '2'                    TO EMI-SWITCH2.
  8246     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8247     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8248
  8249     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8250     MOVE '5'                    TO DC-OPTION-CODE.
  8251     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8252     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8253                                    SAVE-BIN-DATE.
  8254     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8255     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8256
  8257     IF SAVE-DATE-YY > 70
  8258         MOVE 19                 TO SAVE-DATE-CC
  8259     ELSE
  8260         MOVE 20                 TO SAVE-DATE-CC.
  8261
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 155
* EL156.cbl
  8262     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8263         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8264     END-IF.
  8265
  8266     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8267        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8268     ELSE
  8269        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8270     END-IF
  8271
  8272     IF PI-PRINT-CLM-FRM-YN = 'N'
  8273         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8274     ELSE
  8275         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8276     END-IF
  8277
  8278     IF PI-PRINT-SURVEY-YN = 'N'
  8279         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8280     ELSE
  8281         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8282     END-IF
  8283
  8284     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8285         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8286     ELSE
  8287         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8288     END-IF
  8289
  8290* EXEC CICS HANDLE CONDITION
  8291*        NOTOPEN   (9990-ABEND)
  8292*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8293*        MAPFAIL   (0400-FIRST-TIME)
  8294*        DUPREC    (6180-DUPREC)
  8295*        ERROR     (9990-ABEND)
  8296*    END-EXEC.
  8297*    MOVE '"$JL?%.               ! " #00008285' TO DFHEIV0
  8298     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8299     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8300     MOVE X'2220233030303038323835' TO DFHEIV0(25:11)
  8301     CALL 'kxdfhei1' USING DFHEIV0
  8302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8303
  8304
  8305     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8306         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8307
  8308     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8309         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8310             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8311             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8312             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8313             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8314             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8315             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8316             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8317             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8318             MOVE LOW-VALUES           TO EL156AI
  8319             MOVE 'Y'                  TO FIRST-ENTRY
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 156
* EL156.cbl
  8320         ELSE
  8321             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8322             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8323             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8324             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8325             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8326             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8327             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8328             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8329
  8330     IF RETURNED-FROM NOT = SPACES
  8331        IF (RETURNED-FROM = 'EL614')
  8332           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8333           IF WS-SAVED-EOB-CODES NOT = SPACES
  8334              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8335           ELSE
  8336              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8337           END-IF
  8338        END-IF
  8339         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8340            MOVE 'Y'             TO FIRST-ENTRY
  8341            IF RETURNED-FROM = 'EL614'
  8342               AND (PI-PASS-SW NOT = 'C')
  8343               IF WS-SAVED-EOB-CODES NOT = SPACES
  8344                  MOVE WS-SAVED-EOB-CODES
  8345                                 TO PI-PMTNOTE2
  8346                                    WS-PMTNOTE2
  8347                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8348               ELSE
  8349                  MOVE SPACES    TO PI-PMTNOTE2
  8350                                    WS-PMTNOTE2
  8351                                    PI-EOB-CODES-EXIST
  8352               END-IF
  8353            END-IF
  8354            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8355            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8356            IF RETURNED-FROM = 'EL614'
  8357               GO TO 1000-EDIT-DATA
  8358            END-IF
  8359            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8360               (PAYEEI   = LOW-VALUES OR SPACES)
  8361               GO TO 8100-SEND-INITIAL-MAP
  8362            ELSE
  8363               GO TO 1000-EDIT-DATA.
  8364
  8365     IF EIBTRNID NOT = TRANS-ID
  8366         GO TO 0400-FIRST-TIME.
  8367
  8368     IF EIBAID = DFHCLEAR
  8369        IF PI-PASS-SW = 'C'
  8370           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8371           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8372           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8373           MOVE 'Y'            TO RETURNED-FROM-B
  8374           GO TO 1000-EDIT-DATA
  8375        ELSE
  8376           GO TO 9400-CLEAR.
  8377
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 157
* EL156.cbl
  8378     IF PI-PASS-SW = 'C'
  8379         MOVE MAP-NAMEB          TO MAP-NAME
  8380         IF EIBAID = DFHPF1 OR DFHPF13
  8381             GO TO 5000-UPDATE
  8382           ELSE
  8383             IF EIBAID NOT = DFHENTER
  8384                 MOVE LOW-VALUES TO EL156BI
  8385                 MOVE MAP-NAMEB  TO MAP-NAME
  8386                 MOVE ER-0029    TO EMI-ERROR
  8387                 MOVE -1         TO  ENTPFBL
  8388                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8389                 GO TO 8200-SEND-DATAONLY.
  8390
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 158
* EL156.cbl
  8392 0200-RECEIVE.
  8393     MOVE LOW-VALUES             TO EL156AI.
  8394     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8395         MOVE ER-0008            TO EMI-ERROR
  8396         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8397         IF PI-PASS-SW = 'C'
  8398             MOVE -1             TO ENTPFBL
  8399             GO TO 8200-SEND-DATAONLY
  8400         ELSE
  8401             MOVE -1             TO PMTTYPEL
  8402             GO TO 8200-SEND-DATAONLY.
  8403
  8404     IF PI-COMPANY-ID = 'DMD'
  8405         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8406
  8407     IF PI-PASS-SW = 'C'
  8408         MOVE MAP-NAMEB          TO MAP-NAME.
  8409
  8410
  8411* EXEC CICS RECEIVE
  8412*        MAP   (MAP-NAME)
  8413*        MAPSET(MAPSET-NAME)
  8414*        ASIS
  8415*        INTO  (EL156AI)
  8416*    END-EXEC.
  8417     MOVE LENGTH OF
  8418      EL156AI
  8419       TO DFHEIV11
  8420*    MOVE '8"TAI  L              ''   #00008398' TO DFHEIV0
  8421     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8422     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8423     MOVE X'2020233030303038333938' TO DFHEIV0(25:11)
  8424     CALL 'kxdfhei1' USING DFHEIV0,
  8425           MAP-NAME,
  8426           EL156AI,
  8427           DFHEIV11,
  8428           MAPSET-NAME,
  8429           DFHEIV99,
  8430           DFHEIV99
  8431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8432
  8433
  8434     IF PI-PASS-SW NOT = 'C'
  8435         GO TO 0250-MAPA.
  8436
  8437     IF ENTPFBL NOT > ZERO
  8438         MOVE MAP-NAMEB          TO MAP-NAME
  8439         MOVE ER-0029            TO EMI-ERROR
  8440         MOVE -1                 TO  ENTPFBL
  8441         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8442         GO TO 8200-SEND-DATAONLY.
  8443
  8444     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8445         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8446       ELSE
  8447         MOVE MAP-NAMEB           TO MAP-NAME
  8448         MOVE ER-0029             TO EMI-ERROR
  8449         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 159
* EL156.cbl
  8450         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8451         GO TO 8200-SEND-DATAONLY.
  8452
  8453     IF EIBAID = DFHPF1 OR DFHPF13
  8454         IF MODIFY-CAP
  8455            GO TO 5000-UPDATE
  8456          ELSE
  8457            MOVE 'UPDATE'           TO SM-READ
  8458            PERFORM 9995-SECURITY-VIOLATION
  8459            MOVE MAP-NAMEB          TO MAP-NAME
  8460            MOVE ER-0070            TO EMI-ERROR
  8461            MOVE -1                 TO  ENTPFBL
  8462            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8463            GO TO 8200-SEND-DATAONLY.
  8464
  8465 0250-MAPA.
  8466     IF ENTERPFL = 0
  8467         GO TO 0300-CHECK-PFKEYS.
  8468
  8469     IF EIBAID NOT = DFHENTER
  8470         MOVE ER-0004            TO EMI-ERROR
  8471         GO TO 0320-INPUT-ERROR.
  8472
  8473     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8474         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8475     ELSE
  8476         MOVE ER-0029            TO EMI-ERROR
  8477         GO TO 0320-INPUT-ERROR.
  8478
  8479 0300-CHECK-PFKEYS.
  8480     IF EIBAID = DFHPF7 OR DFHPF8
  8481         GO TO 8820-PF7-8.
  8482
  8483     IF EIBAID = DFHPF23
  8484         GO TO 8810-PF23.
  8485
  8486     IF EIBAID = DFHPF24
  8487         GO TO 9200-RETURN-MAIN-MENU.
  8488
  8489     IF EIBAID = DFHPF12
  8490         GO TO 9500-PF12.
  8491
  8492     IF EIBAID = DFHPF1
  8493        IF PI-PASS-SW = 'A' OR 'B'
  8494          GO TO 0330-BROWSE-FORWARD.
  8495
  8496     IF EIBAID = DFHPF2
  8497        IF PI-PASS-SW = 'A' OR 'B'
  8498          GO TO 0350-BROWSE-BACKWARD.
  8499
  8500     IF EIBAID = DFHPF6
  8501        IF PI-EOB-CODES-EXIST = 'Y'
  8502           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8503        ELSE
  8504           MOVE SPACES              TO WS-PMTNOTE2
  8505        END-IF
  8506         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8507         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 160
* EL156.cbl
  8508            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8509         END-IF
  8510         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8511         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  8512             MOVE 'EL614'        TO PGM-NAME
  8513             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8514             GO TO 9300-XCTL
  8515         ELSE
  8516             MOVE XCTL-157       TO PGM-NAME
  8517             GO TO 9300-XCTL.
  8518
  8519     IF EIBAID = DFHPF9
  8520        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8521        MOVE XCTL-141            TO PGM-NAME
  8522        GO TO 9300-XCTL.
  8523
  8524     IF EIBAID = DFHPF10
  8525        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8526        MOVE XCTL-155            TO PGM-NAME
  8527        GO TO 9300-XCTL.
  8528
  8529     MOVE SPACES                 TO ERRMSG0O
  8530                                    ERRMSG1O
  8531                                    ERRMSG2O.
  8532
  8533     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8534         IF PI-PASS-SW NOT = 'B'
  8535             MOVE ER-0422        TO EMI-ERROR
  8536             GO TO 0320-INPUT-ERROR
  8537           ELSE
  8538             GO TO 0700-TEST-FOR-CHANGES.
  8539
  8540     IF EIBAID = DFHPF11
  8541        IF PI-PASS-SW = 'C'
  8542           MOVE ER-0029          TO EMI-ERROR
  8543           GO TO 0320-INPUT-ERROR.
  8544
  8545     IF EIBAID = DFHENTER OR DFHPF11
  8546        NEXT SENTENCE
  8547     ELSE
  8548        MOVE ER-0029             TO EMI-ERROR
  8549        GO TO 0320-INPUT-ERROR.
  8550
  8551     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8552
  8553     if pi-epyfrom not = zeros
  8554        if pi-epyfrom not = ws-epyfrom
  8555           move zeros        to ws-edays
  8556        end-if
  8557     end-if
  8558
  8559     if pi-epythru not = zeros
  8560        if pi-epythru not = ws-epythru
  8561           move zeros        to ws-edays
  8562        end-if
  8563     end-if
  8564
  8565     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 161
* EL156.cbl
  8566         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8567         GO TO 1000-EDIT-DATA
  8568     ELSE
  8569         IF PI-FATAL-COUNT NOT = 0 OR
  8570            PI-FORCE-COUNT NOT = 0
  8571             GO TO 1000-EDIT-DATA
  8572         ELSE
  8573             GO TO 2000-EDIT-DONE.
  8574
  8575 0320-INPUT-ERROR.
  8576     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8577
  8578     IF ENTERPFL = 0
  8579         MOVE -1                 TO PMTTYPEL
  8580     ELSE
  8581         MOVE AL-UNBON           TO ENTERPFA
  8582         MOVE -1                 TO ENTERPFL.
  8583
  8584     GO TO 8200-SEND-DATAONLY.
  8585
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 162
* EL156.cbl
  8587 0330-BROWSE-FORWARD.
  8588
  8589     MOVE CLMNOI            TO PI-CLAIM-NO.
  8590     MOVE CARRI             TO PI-CARRIER.
  8591     MOVE CERTNOI           TO PI-CERT-PRIME.
  8592     MOVE SUFXI             TO PI-CERT-SFX.
  8593
  8594     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8595     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8596     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8597     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8598
  8599     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8600
  8601
  8602* EXEC CICS HANDLE CONDITION
  8603*         NOTFND   (0380-CLAIM-END-FILE)
  8604*         ENDFILE  (0380-CLAIM-END-FILE)
  8605*    END-EXEC.
  8606*    MOVE '"$I''                  ! # #00008572' TO DFHEIV0
  8607     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8608     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8609     MOVE X'2320233030303038353732' TO DFHEIV0(25:11)
  8610     CALL 'kxdfhei1' USING DFHEIV0
  8611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8612
  8613
  8614
  8615* EXEC CICS STARTBR
  8616*         DATASET    ('ELMSTR')
  8617*         RIDFLD     (ELMSTR-KEY)
  8618*         GTEQ
  8619*    END-EXEC.
  8620     MOVE 'ELMSTR' TO DFHEIV1
  8621     MOVE 0
  8622       TO DFHEIV11
  8623*    MOVE '&,         G          &   #00008577' TO DFHEIV0
  8624     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8625     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8626     MOVE X'2020233030303038353737' TO DFHEIV0(25:11)
  8627     CALL 'kxdfhei1' USING DFHEIV0,
  8628           DFHEIV1,
  8629           ELMSTR-KEY,
  8630           DFHEIV99,
  8631           DFHEIV11,
  8632           DFHEIV99
  8633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8634
  8635
  8636     MOVE 'Y' TO WS-BROWSE-START-SW.
  8637
  8638 0335-READNEXT.
  8639
  8640
  8641* EXEC CICS READNEXT
  8642*         DATASET    ('ELMSTR')
  8643*         RIDFLD     (ELMSTR-KEY)
  8644*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 163
* EL156.cbl
  8645*    END-EXEC.
  8646     MOVE 'ELMSTR' TO DFHEIV1
  8647     MOVE 0
  8648       TO DFHEIV11
  8649*    MOVE '&.S                   )   #00008587' TO DFHEIV0
  8650     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8651     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8652     MOVE X'2020233030303038353837' TO DFHEIV0(25:11)
  8653     CALL 'kxdfhei1' USING DFHEIV0,
  8654           DFHEIV1,
  8655           DFHEIV20,
  8656           DFHEIV99,
  8657           ELMSTR-KEY,
  8658           DFHEIV99,
  8659           DFHEIV11,
  8660           DFHEIV99,
  8661           DFHEIV99
  8662     SET ADDRESS OF CLAIM-MASTER TO
  8663         DFHEIV20
  8664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8665
  8666
  8667     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8668        GO TO 0380-CLAIM-END-FILE.
  8669
  8670     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8671        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8672        GO TO 0335-READNEXT.
  8673
  8674     IF PI-COMPANY-ID = 'CRI'
  8675         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8676            GO TO 0380-CLAIM-END-FILE.
  8677
  8678     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8679         GO TO 0335-READNEXT.
  8680
  8681     IF PI-CARRIER-SECURITY > SPACES
  8682         IF CL-CARRIER = PI-CARRIER-SECURITY
  8683             NEXT SENTENCE
  8684         ELSE
  8685             GO TO 0335-READNEXT.
  8686
  8687     IF PI-ACCOUNT-SECURITY > SPACES
  8688         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8689             NEXT SENTENCE
  8690         ELSE
  8691             GO TO 0335-READNEXT.
  8692
  8693     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8694     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8695     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8696
  8697     GO TO 0400-FIRST-TIME.
  8698
  8699 0350-BROWSE-BACKWARD.
  8700
  8701     MOVE CLMNOI            TO PI-CLAIM-NO
  8702                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 164
* EL156.cbl
  8703     MOVE CARRI             TO PI-CARRIER.
  8704     MOVE CERTNOI           TO PI-CERT-PRIME.
  8705     MOVE SUFXI             TO PI-CERT-SFX.
  8706
  8707     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8708
  8709     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8710     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8711     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8712
  8713
  8714* EXEC CICS HANDLE CONDITION
  8715*         NOTFND   (0380-CLAIM-END-FILE)
  8716*         ENDFILE  (0380-CLAIM-END-FILE)
  8717*    END-EXEC.
  8718*    MOVE '"$I''                  ! $ #00008639' TO DFHEIV0
  8719     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8720     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8721     MOVE X'2420233030303038363339' TO DFHEIV0(25:11)
  8722     CALL 'kxdfhei1' USING DFHEIV0
  8723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8724
  8725
  8726
  8727* EXEC CICS STARTBR
  8728*         DATASET    ('ELMSTR')
  8729*         RIDFLD     (ELMSTR-KEY)
  8730*         GTEQ
  8731*    END-EXEC.
  8732     MOVE 'ELMSTR' TO DFHEIV1
  8733     MOVE 0
  8734       TO DFHEIV11
  8735*    MOVE '&,         G          &   #00008644' TO DFHEIV0
  8736     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8737     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8738     MOVE X'2020233030303038363434' TO DFHEIV0(25:11)
  8739     CALL 'kxdfhei1' USING DFHEIV0,
  8740           DFHEIV1,
  8741           ELMSTR-KEY,
  8742           DFHEIV99,
  8743           DFHEIV11,
  8744           DFHEIV99
  8745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8746
  8747
  8748     MOVE 'Y' TO WS-BROWSE-START-SW.
  8749
  8750
  8751* EXEC CICS READNEXT
  8752*         DATASET    ('ELMSTR')
  8753*         RIDFLD     (ELMSTR-KEY)
  8754*         SET        (ADDRESS OF CLAIM-MASTER)
  8755*    END-EXEC.
  8756     MOVE 'ELMSTR' TO DFHEIV1
  8757     MOVE 0
  8758       TO DFHEIV11
  8759*    MOVE '&.S                   )   #00008652' TO DFHEIV0
  8760     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 165
* EL156.cbl
  8761     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8762     MOVE X'2020233030303038363532' TO DFHEIV0(25:11)
  8763     CALL 'kxdfhei1' USING DFHEIV0,
  8764           DFHEIV1,
  8765           DFHEIV20,
  8766           DFHEIV99,
  8767           ELMSTR-KEY,
  8768           DFHEIV99,
  8769           DFHEIV11,
  8770           DFHEIV99,
  8771           DFHEIV99
  8772     SET ADDRESS OF CLAIM-MASTER TO
  8773         DFHEIV20
  8774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8775
  8776
  8777
  8778* EXEC CICS READPREV
  8779*         DATASET    ('ELMSTR')
  8780*         RIDFLD     (ELMSTR-KEY)
  8781*         SET        (ADDRESS OF CLAIM-MASTER)
  8782*    END-EXEC.
  8783     MOVE 'ELMSTR' TO DFHEIV1
  8784     MOVE 0
  8785       TO DFHEIV11
  8786*    MOVE '&0S                   )   #00008658' TO DFHEIV0
  8787     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8788     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8789     MOVE X'2020233030303038363538' TO DFHEIV0(25:11)
  8790     CALL 'kxdfhei1' USING DFHEIV0,
  8791           DFHEIV1,
  8792           DFHEIV20,
  8793           DFHEIV99,
  8794           ELMSTR-KEY,
  8795           DFHEIV99,
  8796           DFHEIV11,
  8797           DFHEIV99,
  8798           DFHEIV99
  8799     SET ADDRESS OF CLAIM-MASTER TO
  8800         DFHEIV20
  8801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8802
  8803
  8804 0360-BROWSE-BACKWARD.
  8805
  8806
  8807* EXEC CICS READPREV
  8808*         DATASET    ('ELMSTR')
  8809*         RIDFLD     (ELMSTR-KEY)
  8810*         SET        (ADDRESS OF CLAIM-MASTER)
  8811*    END-EXEC.
  8812     MOVE 'ELMSTR' TO DFHEIV1
  8813     MOVE 0
  8814       TO DFHEIV11
  8815*    MOVE '&0S                   )   #00008666' TO DFHEIV0
  8816     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8817     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8818     MOVE X'2020233030303038363636' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 166
* EL156.cbl
  8819     CALL 'kxdfhei1' USING DFHEIV0,
  8820           DFHEIV1,
  8821           DFHEIV20,
  8822           DFHEIV99,
  8823           ELMSTR-KEY,
  8824           DFHEIV99,
  8825           DFHEIV11,
  8826           DFHEIV99,
  8827           DFHEIV99
  8828     SET ADDRESS OF CLAIM-MASTER TO
  8829         DFHEIV20
  8830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8831
  8832
  8833     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8834        GO TO 0380-CLAIM-END-FILE.
  8835
  8836     IF PI-COMPANY-ID = 'CRI'
  8837         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8838            GO TO 0380-CLAIM-END-FILE.
  8839
  8840     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8841         GO TO 0360-BROWSE-BACKWARD.
  8842
  8843     IF PI-CARRIER-SECURITY > SPACES
  8844         IF CL-CARRIER = PI-CARRIER-SECURITY
  8845             NEXT SENTENCE
  8846         ELSE
  8847             GO TO 0360-BROWSE-BACKWARD.
  8848
  8849     IF PI-ACCOUNT-SECURITY > SPACES
  8850         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8851             NEXT SENTENCE
  8852         ELSE
  8853             GO TO 0360-BROWSE-BACKWARD.
  8854
  8855     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8856     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8857     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8858
  8859     GO TO 0400-FIRST-TIME.
  8860
  8861 0380-CLAIM-END-FILE.
  8862
  8863     MOVE ER-0130     TO EMI-ERROR.
  8864     MOVE -1          TO CLMNOL.
  8865     MOVE AL-UABON    TO CARRA
  8866                         CLMNOA
  8867                         CERTNOA
  8868                         SUFXA.
  8869
  8870     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8871
  8872     GO TO 8200-SEND-DATAONLY.
  8873
  8874 0400-FIRST-TIME.
  8875
  8876     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 167
* EL156.cbl
  8877        MOVE 'N'         TO WS-BROWSE-START-SW
  8878
  8879* EXEC CICS ENDBR
  8880*            DATASET    ('ELMSTR')
  8881*       END-EXEC.
  8882     MOVE 'ELMSTR' TO DFHEIV1
  8883     MOVE 0
  8884       TO DFHEIV11
  8885*    MOVE '&2                    $   #00008717' TO DFHEIV0
  8886     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8887     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8888     MOVE X'2020233030303038373137' TO DFHEIV0(25:11)
  8889     CALL 'kxdfhei1' USING DFHEIV0,
  8890           DFHEIV1,
  8891           DFHEIV11,
  8892           DFHEIV99
  8893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8894
  8895
  8896     IF PI-PROCESSOR-ID = 'LGXX'
  8897         NEXT SENTENCE
  8898     ELSE
  8899
  8900* EXEC CICS READQ TS
  8901*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8902*            INTO    (SECURITY-CONTROL)
  8903*            LENGTH  (SC-COMM-LENGTH)
  8904*            ITEM    (SC-ITEM)
  8905*        END-EXEC
  8906*    MOVE '*$II   L              ''   #00008724' TO DFHEIV0
  8907     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8908     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8909     MOVE X'2020233030303038373234' TO DFHEIV0(25:11)
  8910     CALL 'kxdfhei1' USING DFHEIV0,
  8911           PI-SECURITY-TEMP-STORE-ID,
  8912           SECURITY-CONTROL,
  8913           SC-COMM-LENGTH,
  8914           SC-ITEM,
  8915           DFHEIV99,
  8916           DFHEIV99
  8917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8918         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8919         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8920
  8921     MOVE LOW-VALUES             TO EL156AI.
  8922     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8923     MOVE 'Y'                    TO FIRST-ENTRY.
  8924     GO TO 7000-SHOW-CLAIM.
  8925
  8926 0500-CREATE-TEMP-STORAGE.
  8927     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8928
  8929
  8930* EXEC CICS WRITEQ TS
  8931*        QUEUE (QID)
  8932*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8933*        LENGTH(PI-COMM-LENGTH)
  8934*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 168
* EL156.cbl
  8935*    MOVE '*"     L              ''   #00008741' TO DFHEIV0
  8936     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8937     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8938     MOVE X'2020233030303038373431' TO DFHEIV0(25:11)
  8939     CALL 'kxdfhei1' USING DFHEIV0,
  8940           QID,
  8941           PROGRAM-INTERFACE-BLOCK,
  8942           PI-COMM-LENGTH,
  8943           DFHEIV99,
  8944           DFHEIV99,
  8945           DFHEIV99
  8946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8947
  8948
  8949
  8950* EXEC CICS WRITEQ TS
  8951*        QUEUE (QID)
  8952*        FROM  (EL156AI)
  8953*        LENGTH(MAP-LENGTH)
  8954*    END-EXEC.
  8955*    MOVE '*"     L              ''   #00008747' TO DFHEIV0
  8956     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8957     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8958     MOVE X'2020233030303038373437' TO DFHEIV0(25:11)
  8959     CALL 'kxdfhei1' USING DFHEIV0,
  8960           QID,
  8961           EL156AI,
  8962           MAP-LENGTH,
  8963           DFHEIV99,
  8964           DFHEIV99,
  8965           DFHEIV99
  8966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8967
  8968
  8969 0599-EXIT.
  8970      EXIT.
  8971
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 169
* EL156.cbl
  8973 0600-RECOVER-TEMP-STORAGE.
  8974
  8975* EXEC CICS READQ TS
  8976*        QUEUE (QID)
  8977*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8978*        LENGTH(PI-COMM-LENGTH)
  8979*    END-EXEC.
  8980*    MOVE '*$I    L              ''   #00008758' TO DFHEIV0
  8981     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8982     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8983     MOVE X'2020233030303038373538' TO DFHEIV0(25:11)
  8984     CALL 'kxdfhei1' USING DFHEIV0,
  8985           QID,
  8986           PROGRAM-INTERFACE-BLOCK,
  8987           PI-COMM-LENGTH,
  8988           DFHEIV99,
  8989           DFHEIV99,
  8990           DFHEIV99
  8991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8992
  8993
  8994
  8995* EXEC CICS READQ TS
  8996*        QUEUE (QID)
  8997*        INTO  (EL156AI)
  8998*        LENGTH(MAP-LENGTH)
  8999*    END-EXEC.
  9000*    MOVE '*$I    L              ''   #00008764' TO DFHEIV0
  9001     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9002     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9003     MOVE X'2020233030303038373634' TO DFHEIV0(25:11)
  9004     CALL 'kxdfhei1' USING DFHEIV0,
  9005           QID,
  9006           EL156AI,
  9007           MAP-LENGTH,
  9008           DFHEIV99,
  9009           DFHEIV99,
  9010           DFHEIV99
  9011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9012
  9013
  9014     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  9015
  9016     IF PMTTYPEI NOT = LOW-VALUES
  9017         MOVE AL-UANON           TO PMTTYPEA.
  9018
  9019     IF PAYEEI NOT = LOW-VALUES
  9020         MOVE AL-UANON           TO PAYEEA.
  9021
  9022     IF NOTE1I NOT = LOW-VALUES
  9023         MOVE AL-UANON           TO NOTE1A.
  9024
  9025     IF (RETURNED-FROM = 'EL614')
  9026        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  9027     END-IF
  9028*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  9029*       AND (PI-EOB-CODES-EXIST = 'Y')
  9030*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 170
* EL156.cbl
  9031*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  9032     IF PI-SET-NOTE2-MDT = 'Y'
  9033         MOVE AL-SANON           TO NOTE2A
  9034     END-IF
  9035
  9036     IF OFFLINEI NOT = LOW-VALUES
  9037         MOVE AL-UANON           TO OFFLINEA.
  9038
  9039*    IF GROUPEDI NOT = LOW-VALUES
  9040*        MOVE AL-UANON           TO GROUPEDA.
  9041
  9042*    IF CASHI NOT = LOW-VALUES
  9043*        MOVE AL-UANON           TO CASHA.
  9044
  9045     IF CHECKNOI NOT = LOW-VALUES
  9046         MOVE AL-UANON           TO CHECKNOA.
  9047
  9048     IF HOLDTILI NOT = LOW-VALUES
  9049         MOVE AL-UANON           TO HOLDTILA.
  9050
  9051     IF EPYFROMI NOT = LOW-VALUES
  9052         MOVE AL-UANON           TO EPYFROMA.
  9053
  9054     IF AIGFROMI NOT = LOW-VALUES
  9055         MOVE AL-UANON           TO AIGFROMA.
  9056
  9057     IF EPYTHRUI NOT = LOW-VALUES
  9058         MOVE AL-UANON           TO EPYTHRUA.
  9059
  9060     IF EDAYSI NOT = LOW-VALUES
  9061         MOVE AL-UNNON           TO EDAYSA.
  9062
  9063     IF EPYAMTL NOT = +0
  9064         MOVE AL-UNNON           TO EPYAMTA.
  9065
  9066     IF ERESVL NOT = +0
  9067         MOVE AL-UNNON           TO ERESVA.
  9068
  9069     IF EEXPENSL NOT = +0
  9070         MOVE AL-UNNON           TO EEXPENSA.
  9071
  9072     IF ETYPEI NOT = LOW-VALUES
  9073         MOVE AL-UNNON           TO ETYPEA.
  9074
  9075     IF PROOFDTI NOT = 0
  9076         MOVE AL-UNNON           TO PROOFDTA.
  9077
  9078     IF EOBYNI = 'Y' OR 'N' OR 'S'
  9079        MOVE AL-UANON            TO EOBYNA
  9080     END-IF
  9081     IF CLMFMYNI = 'Y' OR 'N'
  9082        MOVE AL-UANON            TO CLMFMYNA
  9083     END-IF
  9084
  9085     IF SURVYYNI = 'Y' OR 'N'
  9086        IF PI-APPROVAL-LEVEL = '4' OR '5'
  9087           MOVE AL-UANON         TO SURVYYNA
  9088        END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 171
* EL156.cbl
  9089     END-IF
  9090
  9091     IF SPRELYNI = 'Y' OR 'N'
  9092        MOVE AL-UANON            TO SPRELYNA
  9093     END-IF
  9094
  9095     .
  9096 0699-EXIT.
  9097      EXIT.
  9098
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 172
* EL156.cbl
  9100 0700-TEST-FOR-CHANGES.
  9101     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  9102         MOVE ER-0433            TO EMI-ERROR
  9103         GO TO 0750-FUNCTION-ERROR.
  9104
  9105     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  9106
  9107     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9108         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9109         MOVE 'A'                TO PI-PASS-SW
  9110         GO TO 1000-EDIT-DATA.
  9111
  9112     IF PI-FATAL-COUNT NOT = 0
  9113         MOVE ER-0499            TO EMI-ERROR
  9114         GO TO 0750-FUNCTION-ERROR.
  9115
  9116     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9117         MOVE ER-0500            TO EMI-ERROR
  9118         GO TO 0750-FUNCTION-ERROR.
  9119
  9120     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9121        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9122           MOVE ER-0542          TO EMI-ERROR
  9123           MOVE -1               TO EPYAMTL
  9124           GO TO 0750-FUNCTION-ERROR.
  9125
  9126     IF PI-OFFLINE = 'Y'  OR
  9127        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9128        MOVE EIBAID              TO PI-PFKEY-USED
  9129        GO TO 5000-UPDATE.
  9130
  9131     GO TO 6000-BUILD-SCREEN-B.
  9132
  9133 0750-FUNCTION-ERROR.
  9134     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9135
  9136     IF ENTERPFL > 0
  9137         MOVE -1                 TO ENTERPFL
  9138         MOVE AL-UNBON           TO ENTERPFA
  9139         GO TO 8200-SEND-DATAONLY
  9140     ELSE
  9141         MOVE -1                 TO ENTERPFL
  9142         MOVE AL-UNNOF           TO ENTERPFA
  9143         GO TO 8200-SEND-DATAONLY.
  9144
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 173
* EL156.cbl
  9146 0800-DELETE-TS.
  9147
  9148* EXEC CICS HANDLE CONDITION
  9149*        QIDERR(0800-EXIT)
  9150*    END-EXEC.
  9151*    MOVE '"$N                   ! % #00008903' TO DFHEIV0
  9152     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9154     MOVE X'2520233030303038393033' TO DFHEIV0(25:11)
  9155     CALL 'kxdfhei1' USING DFHEIV0
  9156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9157
  9158
  9159
  9160* EXEC CICS DELETEQ TS
  9161*        QUEUE(QID)
  9162*    END-EXEC.
  9163*    MOVE '*&                    #   #00008907' TO DFHEIV0
  9164     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9165     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9166     MOVE X'2020233030303038393037' TO DFHEIV0(25:11)
  9167     CALL 'kxdfhei1' USING DFHEIV0,
  9168           QID,
  9169           DFHEIV99
  9170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9171
  9172
  9173 0800-EXIT.
  9174      EXIT.
  9175 0900-GET-DDF-LIMITS.
  9176
  9177     if cm-clp-state = zeros or spaces or low-values
  9178        move cm-state            to cm-clp-state
  9179     end-if
  9180     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9181     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9182     MOVE cm-clp-state           TO ERPDEF-STATE
  9183     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9184     evaluate true
  9185        when (cl-claim-type = 'L' or 'P')
  9186           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9187             and 'CU')
  9188           move 'L'              to erpdef-ben-type
  9189           move pi-lf-benefit-cd to erpdef-ben-code
  9190        when (cl-claim-type not = 'L' and 'P')
  9191           and (pi-ah-benefit-cd not = '00' and '  ')
  9192           move 'A'              to erpdef-ben-type
  9193           move pi-ah-benefit-cd to erpdef-ben-code
  9194        when (cl-claim-type not = 'L' and 'P')
  9195           and (pi-ah-benefit-cd = '00' or '  ')
  9196           move 'L'              to erpdef-ben-type
  9197           move pi-lf-benefit-cd to erpdef-ben-code
  9198        when (cl-claim-type = 'L' or 'P')
  9199           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9200           move 'A'              to erpdef-ben-type
  9201           move pi-ah-benefit-cd to erpdef-ben-code
  9202        when other
  9203           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 174
* EL156.cbl
  9204           move pi-ah-benefit-cd to erpdef-ben-code
  9205     end-evaluate
  9206*    if (cl-claim-type = 'L' or 'P')
  9207*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9208*          and 'CU')
  9209*       move 'L'                 to erpdef-ben-type
  9210*       move pi-lf-benefit-cd    to erpdef-ben-code
  9211*    else
  9212*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9213*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9214*    end-if
  9215     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9216
  9217     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9218
  9219
  9220* EXEC CICS STARTBR
  9221*        DATASET  ('ERPDEF')
  9222*        RIDFLD   (ERPDEF-KEY)
  9223*        GTEQ
  9224*        RESP     (WS-RESPONSE)
  9225*    END-EXEC
  9226     MOVE 'ERPDEF' TO DFHEIV1
  9227     MOVE 0
  9228       TO DFHEIV11
  9229*    MOVE '&,         G          &  N#00008957' TO DFHEIV0
  9230     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9231     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9232     MOVE X'204E233030303038393537' TO DFHEIV0(25:11)
  9233     CALL 'kxdfhei1' USING DFHEIV0,
  9234           DFHEIV1,
  9235           ERPDEF-KEY,
  9236           DFHEIV99,
  9237           DFHEIV11,
  9238           DFHEIV99
  9239     MOVE EIBRESP  TO WS-RESPONSE
  9240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9241
  9242     IF NOT WS-RESP-NORMAL
  9243        GO TO 0900-EXIT
  9244     END-IF
  9245
  9246     .
  9247 0900-READNEXT.
  9248
  9249
  9250* EXEC CICS READNEXT
  9251*       DATASET  ('ERPDEF')
  9252*       SET      (ADDRESS OF PRODUCT-MASTER)
  9253*       RIDFLD   (ERPDEF-KEY)
  9254*       RESP     (WS-RESPONSE)
  9255*    END-EXEC
  9256     MOVE 'ERPDEF' TO DFHEIV1
  9257     MOVE 0
  9258       TO DFHEIV11
  9259*    MOVE '&.S                   )  N#00008971' TO DFHEIV0
  9260     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9261     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 175
* EL156.cbl
  9262     MOVE X'204E233030303038393731' TO DFHEIV0(25:11)
  9263     CALL 'kxdfhei1' USING DFHEIV0,
  9264           DFHEIV1,
  9265           DFHEIV20,
  9266           DFHEIV99,
  9267           ERPDEF-KEY,
  9268           DFHEIV99,
  9269           DFHEIV11,
  9270           DFHEIV99,
  9271           DFHEIV99
  9272     SET ADDRESS OF PRODUCT-MASTER TO
  9273         DFHEIV20
  9274     MOVE EIBRESP  TO WS-RESPONSE
  9275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9276
  9277     IF NOT WS-RESP-NORMAL
  9278        GO TO 0900-ENDBR
  9279     END-IF
  9280
  9281     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9282        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9283           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9284        ELSE
  9285           GO TO 0900-READNEXT
  9286        END-IF
  9287     ELSE
  9288        GO TO 0900-ENDBR
  9289     END-IF
  9290
  9291     IF CM-LOAN-TERM = ZEROS
  9292        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9293     END-IF
  9294
  9295     .
  9296 0900-ENDBR.
  9297
  9298
  9299* EXEC CICS ENDBR
  9300*       DATASET  ('ERPDEF')
  9301*    END-EXEC
  9302     MOVE 'ERPDEF' TO DFHEIV1
  9303     MOVE 0
  9304       TO DFHEIV11
  9305*    MOVE '&2                    $   #00008999' TO DFHEIV0
  9306     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9307     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9308     MOVE X'2020233030303038393939' TO DFHEIV0(25:11)
  9309     CALL 'kxdfhei1' USING DFHEIV0,
  9310           DFHEIV1,
  9311           DFHEIV11,
  9312           DFHEIV99
  9313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9314
  9315     .
  9316 0900-EXIT.
  9317     EXIT.
  9318 1000-EDIT-DATA.
  9319
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 176
* EL156.cbl
  9320     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9321         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9322         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9323
  9324     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9325
  9326     IF NOT MODIFY-CAP
  9327         MOVE ER-0070            TO EMI-ERROR
  9328         MOVE -1                 TO PMTTYPEL
  9329         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9330         GO TO 2000-EDIT-DONE.
  9331
  9332     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9333                         '5' AND '6'
  9334         MOVE ER-0420            TO EMI-ERROR
  9335         MOVE -1                 TO PMTTYPEL
  9336         MOVE AL-UABON           TO PMTTYPEA
  9337         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9338     ELSE
  9339         MOVE AL-UANON           TO PMTTYPEA.
  9340
  9341*    IF PI-OFFLINE = 'Y'
  9342*       IF PI-GROUPED = 'Y'
  9343*          MOVE ER-1880         TO EMI-ERROR
  9344*          MOVE -1              TO GROUPEDL
  9345*          MOVE AL-UABON        TO GROUPEDA
  9346*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9347*
  9348*    IF GROUPEDL > +0
  9349*       IF PI-GROUPED = 'Y' OR 'N'
  9350*          MOVE AL-UANON TO GROUPEDA
  9351*       ELSE
  9352*          MOVE ER-3140            TO EMI-ERROR
  9353*          MOVE -1                 TO GROUPEDL
  9354*          MOVE AL-UABON           TO GROUPEDA
  9355*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9356*
  9357*    IF CASHL > +0
  9358*       IF PI-CASH = 'Y' OR 'N'
  9359*          MOVE AL-UANON           TO CASHA
  9360*       ELSE
  9361*          MOVE ER-3141            TO EMI-ERROR
  9362*          MOVE -1                 TO CASHL
  9363*          MOVE AL-UABON           TO CASHA
  9364*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9365
  9366     IF LOANNOL > +0
  9367         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9368
  9369 1000-EDIT-PAYEE.
  9370
  9371     IF PI-PAYEE-SEQ NOT NUMERIC
  9372         MOVE ER-0294            TO  EMI-ERROR
  9373         MOVE -1                 TO  PAYEEL
  9374         MOVE AL-UABON           TO  PAYEEA
  9375         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9376         GO TO 1000-CONT-EDIT.
  9377
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 177
* EL156.cbl
  9378     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9379                         'E' OR 'O' OR 'Q'
  9380         NEXT SENTENCE
  9381     ELSE
  9382         MOVE ER-0294            TO  EMI-ERROR
  9383         MOVE -1                 TO  PAYEEL
  9384         MOVE AL-UABON           TO  PAYEEA
  9385         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9386         GO TO 1000-CONT-EDIT.
  9387
  9388     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9389        (PI-PAYEE-SEQ NOT < '1' AND
  9390         PI-PAYEE-SEQ NOT > '9'))
  9391      OR
  9392        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9393         (PI-PAYEE-SEQ NOT > '9'))
  9394         MOVE AL-UANON            TO PAYEEA
  9395     ELSE
  9396         MOVE ER-0294            TO EMI-ERROR
  9397         MOVE -1                 TO PAYEEL
  9398         MOVE AL-UABON           TO PAYEEA
  9399         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9400
  9401     IF PI-COMPANY-ID = 'DMD'
  9402         IF PI-PAYEE-TYPE = 'B' AND
  9403            PI-PAYEE-SEQ NOT = '0'
  9404               MOVE ER-7841            TO EMI-ERROR
  9405               MOVE -1                 TO PAYEEL
  9406               MOVE AL-UABON           TO PAYEEA
  9407               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9408
  9409     IF PI-COMPANY-ID = 'JHL'
  9410         IF PI-PAYEE = 'B0'
  9411             NEXT SENTENCE
  9412           ELSE
  9413
  9414* EXEC CICS HANDLE CONDITION
  9415*            ENDFILE(1950-NOT-FOUND)
  9416*            NOTFND (1950-NOT-FOUND)
  9417*        END-EXEC
  9418*    MOVE '"$''I                  ! & #00009101' TO DFHEIV0
  9419     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9420     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9421     MOVE X'2620233030303039313031' TO DFHEIV0(25:11)
  9422     CALL 'kxdfhei1' USING DFHEIV0
  9423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9424         MOVE 'N'                    TO FOUND-TOL-SW
  9425         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9426         MOVE '2'                    TO CNTL-REC-TYPE
  9427         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9428         MOVE +0                     TO CNTL-SEQ-NO
  9429         MOVE 'PROC'                 TO FILE-SWITCH
  9430         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9431         IF PI-PAYEE = 'I1' AND
  9432            APPROVAL-LEVEL-2
  9433             NEXT SENTENCE
  9434           ELSE
  9435         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 178
* EL156.cbl
  9436             MOVE ER-3546        TO EMI-ERROR
  9437             MOVE -1             TO PAYEEL
  9438             MOVE AL-UABON       TO PAYEEA
  9439             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9440
  9441     IF PI-PAYEE-TYPE = 'E'
  9442        IF PI-PMTTYPE = '5' OR '6'
  9443            NEXT SENTENCE
  9444        ELSE
  9445            MOVE ER-3539            TO EMI-ERROR
  9446            MOVE -1                 TO PAYEEL
  9447            MOVE AL-UABON           TO PAYEEA
  9448            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9449
  9450 1000-CONT-EDIT.
  9451
  9452     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9453        IF PI-EPYAMT NOT NEGATIVE
  9454            MOVE ER-0421         TO EMI-ERROR
  9455            MOVE -1              TO OFFLINEL
  9456            MOVE AL-UABON        TO OFFLINEA
  9457            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9458        ELSE
  9459            MOVE AL-UANON        TO OFFLINEA.
  9460
  9461     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  9462        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9463           CONTINUE
  9464        ELSE
  9465           IF PI-PRINT-EOB-YN = 'S' AND
  9466              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9467                CONTINUE
  9468           ELSE
  9469              MOVE ER-1561       TO EMI-ERROR
  9470              MOVE -1            TO EOBYNL
  9471              MOVE AL-UABON      TO EOBYNA
  9472              PERFORM 9900-ERROR-FORMAT
  9473                                 THRU 9900-EXIT
  9474           END-IF
  9475        END-IF
  9476
  9477        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9478            MOVE ER-1566        TO EMI-ERROR
  9479            MOVE -1             TO CLMFMYNL
  9480            MOVE AL-UABON       TO CLMFMYNA
  9481            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9482        END-IF
  9483
  9484        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9485            MOVE ER-1567        TO EMI-ERROR
  9486            MOVE -1             TO SURVYYNL
  9487            MOVE AL-UABON       TO SURVYYNA
  9488            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9489        END-IF
  9490
  9491        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9492            MOVE ER-1569        TO EMI-ERROR
  9493            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 179
* EL156.cbl
  9494            MOVE AL-UABON       TO SPRELYNA
  9495            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9496        END-IF
  9497
  9498     END-IF
  9499     IF PI-EPYAMT IS NEGATIVE
  9500         IF PI-OFFLINE NOT = 'Y'
  9501             MOVE ER-0836        TO  EMI-ERROR
  9502             MOVE -1             TO  OFFLINEL
  9503             MOVE AL-UABON       TO  OFFLINEA
  9504             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9505
  9506     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9507        MOVE ER-0872             TO EMI-ERROR
  9508        MOVE -1                  TO PROOFDTL
  9509        MOVE AL-UABON            TO PROOFDTA
  9510        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9511     ELSE
  9512        MOVE '4'                TO DC-OPTION-CODE
  9513        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9514        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9515        IF DATE-CONVERSION-ERROR
  9516            MOVE ER-0873        TO EMI-ERROR
  9517            MOVE -1                  TO PROOFDTL
  9518            MOVE AL-UABON            TO PROOFDTA
  9519            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9520        ELSE
  9521            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9522            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9523                MOVE ER-0873    TO EMI-ERROR
  9524                MOVE -1                  TO PROOFDTL
  9525                MOVE AL-UABON            TO PROOFDTA
  9526                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9527            END-IF
  9528        END-IF
  9529     END-IF.
  9530
  9531     IF PI-COMPANY-ID = 'DMD'
  9532        IF NOTE1L NOT = ZEROS
  9533            MOVE ER-7844        TO  EMI-ERROR
  9534            MOVE -1             TO  NOTE1L
  9535            MOVE AL-UABON       TO  NOTE1A
  9536            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9537
  9538     IF PI-COMPANY-ID = 'DMD'
  9539        IF NOTE2L NOT = ZEROS
  9540          GO TO 1004-DMD-EOB-CHECKS.
  9541
  9542     IF NOTE1L NOT > +0
  9543         GO TO 1005-CHECK-ERRORS.
  9544
  9545     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9546         GO TO 1005-CHECK-ERRORS.
  9547
  9548     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9549         GO TO 1003-HAN-PMT-NOTES.
  9550
  9551     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 180
* EL156.cbl
  9552
  9553     IF WS-PMTOPTION NUMERIC
  9554        IF WS-PMTOPTION > '00' AND < '17'
  9555           NEXT SENTENCE
  9556        ELSE
  9557           MOVE ER-0618          TO EMI-ERROR
  9558           MOVE -1               TO NOTE1L
  9559           MOVE AL-UABON         TO NOTE1A
  9560           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9561     ELSE
  9562        GO TO 1005-CHECK-ERRORS.
  9563
  9564     IF WS-PMTOPTION = '05' AND
  9565        WS-DOCNAME = SPACES
  9566          MOVE ER-0616             TO EMI-ERROR
  9567          MOVE -1                  TO NOTE1L
  9568          MOVE AL-UABON            TO NOTE1A
  9569          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9570
  9571     IF WS-PMTOPTION = '15' OR '16'
  9572
  9573* EXEC CICS BIF DEEDIT
  9574*            FIELD (WS-AMOUNT)
  9575*            LENGTH(08)
  9576*        END-EXEC
  9577     MOVE 08
  9578       TO DFHEIV11
  9579*    MOVE '@"L                   #   #00009253' TO DFHEIV0
  9580     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9581     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9582     MOVE X'2020233030303039323533' TO DFHEIV0(25:11)
  9583     CALL 'kxdfhei1' USING DFHEIV0,
  9584           WS-AMOUNT,
  9585           DFHEIV11
  9586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9587        IF (WS-NUM-AMT = ZEROS) OR
  9588           (WS-AMOUNT NOT NUMERIC)
  9589           MOVE ER-0617          TO EMI-ERROR
  9590           MOVE -1               TO NOTE1L
  9591           MOVE AL-UABON         TO NOTE1A
  9592           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9593
  9594     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9595
  9596     GO TO 1005-CHECK-ERRORS.
  9597
  9598 1003-HAN-PMT-NOTES.
  9599
  9600     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9601
  9602     IF WS-HAN-PMT-CODE = SPACE
  9603         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9604     ELSE
  9605     IF WS-HAN-PMT-CODE = 'A'
  9606         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9607                                 TO WS-HAN-PMT-NOTE
  9608     ELSE
  9609     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 181
* EL156.cbl
  9610         MOVE ':FINAL PAYMENT / DECEASED'
  9611                                 TO WS-HAN-PMT-NOTE
  9612     ELSE
  9613     IF WS-HAN-PMT-CODE = 'C'
  9614         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9615                                 TO WS-HAN-PMT-NOTE
  9616     ELSE
  9617     IF WS-HAN-PMT-CODE = 'D'
  9618         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9619                                 TO WS-HAN-PMT-NOTE
  9620     ELSE
  9621     IF WS-HAN-PMT-CODE = 'E'
  9622         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9623                                 TO WS-HAN-PMT-NOTE
  9624     ELSE
  9625     IF WS-HAN-PMT-CODE = 'F'
  9626         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9627                                 TO WS-HAN-PMT-NOTE
  9628     ELSE
  9629     IF WS-HAN-PMT-CODE = 'P'
  9630         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9631
  9632     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9633     GO TO 1005-CHECK-ERRORS.
  9634
  9635 1004-DMD-EOB-CHECKS.
  9636
  9637     INITIALIZE PI-AT-EOB-CODES.
  9638
  9639     IF NOTE2I (20:21) > SPACES
  9640         MOVE ER-7845          TO EMI-ERROR
  9641         MOVE -1               TO NOTE2L
  9642         MOVE AL-UABON         TO NOTE2A
  9643         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9644         GO TO 1005-CHECK-ERRORS
  9645      ELSE
  9646         MOVE NOTE2I             TO W-EOB-CODES.
  9647
  9648     MOVE +1                     TO W-EOB-NDX.
  9649
  9650 1004-CHECK-EACH-EOB.
  9651
  9652     IF W-EOB-NDX > +5
  9653             OR
  9654        W-EOB-CODE (W-EOB-NDX) = SPACES
  9655         GO TO 1004-CHECK-DUP-EOB.
  9656
  9657     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9658         MOVE ER-0956            TO EMI-ERROR
  9659         MOVE -1                 TO NOTE2L
  9660         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9661         GO TO 1005-CHECK-ERRORS.
  9662
  9663     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9664     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9665     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9666     MOVE 'DLO023'               TO PGM-NAME.
  9667
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 182
* EL156.cbl
  9668
  9669* EXEC CICS LINK
  9670*        PROGRAM    (PGM-NAME)
  9671*        COMMAREA   (CD-COMMUNICATION-AREA)
  9672*        LENGTH     (CD-RCRD-LENGTH)
  9673*    END-EXEC.
  9674*    MOVE '."C                   (   #00009338' TO DFHEIV0
  9675     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9676     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9677     MOVE X'2020233030303039333338' TO DFHEIV0(25:11)
  9678     CALL 'kxdfhei1' USING DFHEIV0,
  9679           PGM-NAME,
  9680           CD-COMMUNICATION-AREA,
  9681           CD-RCRD-LENGTH,
  9682           DFHEIV99,
  9683           DFHEIV99,
  9684           DFHEIV99,
  9685           DFHEIV99
  9686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9687
  9688
  9689     IF CD-RETURN-CODE = 'OK'
  9690         GO TO 1004-CONT.
  9691
  9692     MOVE -1                     TO NOTE2L.
  9693
  9694     IF CD-RETURN-CODE = '01'
  9695         MOVE ER-8310            TO EMI-ERROR
  9696         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9697         GO TO 1005-CHECK-ERRORS.
  9698
  9699     IF CD-RETURN-CODE = '02'
  9700         MOVE ER-8311            TO EMI-ERROR
  9701         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9702         GO TO 1005-CHECK-ERRORS.
  9703
  9704     IF CD-RETURN-CODE = '03'
  9705         MOVE ER-8312            TO EMI-ERROR
  9706         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9707         GO TO 1005-CHECK-ERRORS.
  9708
  9709     IF CD-RETURN-CODE = '04'
  9710         MOVE ER-8313            TO EMI-ERROR
  9711         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9712         GO TO 1005-CHECK-ERRORS.
  9713
  9714     IF CD-RETURN-CODE = '05'
  9715         MOVE ER-8314            TO EMI-ERROR
  9716         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9717         GO TO 1005-CHECK-ERRORS.
  9718
  9719     IF CD-RETURN-CODE = '06'
  9720         MOVE ER-8315            TO EMI-ERROR
  9721         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9722         GO TO 1005-CHECK-ERRORS.
  9723
  9724     IF CD-RETURN-CODE = 'E1'
  9725         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 183
* EL156.cbl
  9726         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9727         GO TO 1005-CHECK-ERRORS.
  9728
  9729     IF CD-RETURN-CODE = 'N1'
  9730         MOVE ER-8317            TO EMI-ERROR
  9731         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9732         GO TO 1005-CHECK-ERRORS.
  9733
  9734 1004-CONT.
  9735     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9736
  9737     ADD +1 TO W-EOB-NDX.
  9738     GO TO 1004-CHECK-EACH-EOB.
  9739
  9740 1004-CHECK-DUP-EOB.
  9741     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9742         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9743                               PI-AT-EOB-CODE (3) OR
  9744                               PI-AT-EOB-CODE (4) OR
  9745                               PI-AT-EOB-CODE (5)))
  9746                  OR
  9747        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9748         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9749                               PI-AT-EOB-CODE (4) OR
  9750                               PI-AT-EOB-CODE (5)))
  9751                  OR
  9752        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9753         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9754                               PI-AT-EOB-CODE (5)))
  9755                  OR
  9756        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9757         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9758            MOVE ER-8000            TO EMI-ERROR
  9759            MOVE AL-UABON           TO NOTE2A
  9760            MOVE -1                 TO NOTE2L
  9761            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9762            GO TO 1005-CHECK-ERRORS.
  9763
  9764 1005-CHECK-ERRORS.
  9765*    IF PI-COMPANY-ID NOT = 'DMD'
  9766        GO TO 1006-CHECK-ERRORS.
  9767
  9768*********  DMD CODE START ******************
  9769*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9770*       GO TO 1006-CHECK-ERRORS.
  9771*
  9772*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9773*
  9774*    COMPUTE W-PAYMENT-TOTAL
  9775*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9776*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9777*               AND
  9778*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9779*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9780*          MOVE ER-0967    TO EMI-ERROR
  9781*          MOVE -1         TO PMTTYPEL
  9782*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9783*
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 184
* EL156.cbl
  9784*    GO TO 1006-CHECK-ERRORS.
  9785*********  DMD CODE END ******************
  9786
  9787 1006-CHECK-ERRORS.
  9788     if emi-forcable-ctr = zeros
  9789        and emi-fatal-ctr = zeros
  9790        continue
  9791     else
  9792        IF NOT EMI-NO-ERRORS
  9793           GO TO 2000-EDIT-DONE
  9794        end-if
  9795     end-if
  9796
  9797* EXEC CICS HANDLE CONDITION
  9798*        NOTFND(1950-NOT-FOUND)
  9799*    END-EXEC.
  9800*    MOVE '"$I                   ! '' #00009451' TO DFHEIV0
  9801     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9803     MOVE X'2720233030303039343531' TO DFHEIV0(25:11)
  9804     CALL 'kxdfhei1' USING DFHEIV0
  9805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9806
  9807
  9808     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9809     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9810     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9811     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9812     MOVE 'MSTR'                 TO FILE-SWITCH.
  9813
  9814     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9815
  9816     IF PI-COMPANY-ID = 'DMD'
  9817         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9818
  9819     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9820        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9821           MOVE ER-0873    TO EMI-ERROR
  9822           MOVE -1                  TO PROOFDTL
  9823           MOVE AL-UABON            TO PROOFDTA
  9824           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9825        END-IF
  9826     END-IF
  9827     if cl-benefit-period = zeros
  9828        move er-1667             to emi-error
  9829        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9830     end-if
  9831     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9832     MOVE +95                    TO TRLR-SEQ-NO
  9833
  9834* EXEC CICS READ
  9835*       DATASET  ('ELTRLR')
  9836*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9837*       RIDFLD   (ELTRLR-KEY)
  9838*       RESP     (WS-RESPONSE)
  9839*    END-EXEC
  9840     MOVE 'ELTRLR' TO DFHEIV1
  9841*    MOVE '&"S        E          (  N#00009480' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 185
* EL156.cbl
  9842     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9843     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9844     MOVE X'204E233030303039343830' TO DFHEIV0(25:11)
  9845     CALL 'kxdfhei1' USING DFHEIV0,
  9846           DFHEIV1,
  9847           DFHEIV20,
  9848           DFHEIV99,
  9849           ELTRLR-KEY,
  9850           DFHEIV99,
  9851           DFHEIV99,
  9852           DFHEIV99
  9853     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9854         DFHEIV20
  9855     MOVE EIBRESP  TO WS-RESPONSE
  9856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9857
  9858     if ws-resp-normal
  9859        perform varying s1 from +1 by +1 until
  9860           at-note-error-no (s1) = spaces
  9861           if at-note-error-no (s1) = '1662'
  9862              continue
  9863           else
  9864              move at-note-error-no (s1)
  9865                                 to emi-error
  9866              if at-note-error-no (s1) = '1653'
  9867                 evaluate true
  9868                    when cl-claim-type = 'L'
  9869                       move '  LF  '
  9870                                 to emi-claim-type
  9871                    when cl-claim-type = 'I'
  9872                       move '  IU  '
  9873                                 to emi-claim-type
  9874                    when cl-claim-type = 'A'
  9875                       move '  AH  '
  9876                                 to emi-claim-type
  9877                    when other
  9878                       move ' FMLA '
  9879                                 to emi-claim-type
  9880                 end-evaluate
  9881              end-if
  9882              PERFORM 9900-ERROR-FORMAT
  9883                                 THRU 9900-EXIT
  9884           end-if
  9885        end-perform
  9886     end-if
  9887     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9888         IF PI-PMTTYPE = '5' OR '6'
  9889             NEXT SENTENCE
  9890         ELSE
  9891             MOVE ER-0555             TO EMI-ERROR
  9892             MOVE -1                  TO PMTTYPEL
  9893             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9894
  9895     IF CL-LAST-CLOSE-REASON = '2'
  9896         IF CL-CLAIM-STATUS = 'C'
  9897             MOVE ER-0760        TO  EMI-ERROR
  9898             MOVE -1             TO  PMTTYPEL
  9899             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 186
* EL156.cbl
  9900
  9901     IF PI-ACTIVITY-CODE = 9
  9902         MOVE ER-3538            TO  EMI-ERROR
  9903         MOVE -1                 TO  PMTTYPEL
  9904         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9905
  9906     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9907         GO TO 1008-READ-CERT.
  9908**********************AIG LOGIC STARTS *********************
  9909     IF CL-CERT-PRIME = 'INCOMPLETE'
  9910         MOVE ER-3540            TO  EMI-ERROR
  9911         MOVE -1                 TO  PMTTYPEL
  9912         MOVE AL-UABON           TO  PMTTYPEA
  9913         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9914         GO TO 2000-EDIT-DONE.
  9915
  9916     IF PI-PMTTYPE = '4'
  9917         IF PI-EPYAMT IS NEGATIVE
  9918             IF PI-ECHECKNO-CR = 'CR'
  9919                 NEXT SENTENCE
  9920             ELSE
  9921                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9922
  9923     IF PI-PMTTYPE = '4'
  9924         IF PI-ECHECKNO-CR = 'CR'
  9925             IF PI-EPYAMT IS NEGATIVE
  9926                 NEXT SENTENCE
  9927             ELSE
  9928                 MOVE ER-0834    TO  EMI-ERROR
  9929                 MOVE -1         TO  EPYAMTL
  9930                 MOVE AL-UNBON   TO  EPYAMTA
  9931                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9932
  9933     IF PI-PMTTYPE = '4'
  9934         IF PI-EPYAMT IS NEGATIVE
  9935             IF PI-OFFLINE = 'Y'
  9936                 NEXT SENTENCE
  9937             ELSE
  9938                 MOVE 'Y'        TO  PI-OFFLINE
  9939                                     WS-OFFLINE
  9940                                     OFFLINEO
  9941                 MOVE AL-UANON   TO  OFFLINEA.
  9942
  9943*    IF PI-PMTTYPE = '4'
  9944*        IF PI-EPYAMT IS NEGATIVE
  9945*            IF PI-CASH = 'Y'
  9946*                NEXT SENTENCE
  9947*            ELSE
  9948*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9949*                MOVE AL-UANON   TO  CASHA
  9950*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9951*
  9952*    IF PI-CASH NOT = 'Y' AND 'N'
  9953*         IF PI-OFFLINE = 'Y'  AND
  9954*            PI-ECHECKNO-CR = 'CR'
  9955*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9956*              MOVE AL-UANON     TO  CASHA
  9957*              GO TO 1007-DEFAULT-AIG-CHECKNO.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 187
* EL156.cbl
  9958*
  9959*    IF PI-CASH NOT = 'Y' AND 'N'
  9960*        IF PI-PMTTYPE = '5' OR '6'
  9961*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9962*            MOVE AL-UANON       TO  CASHA
  9963*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9964*
  9965*    IF PI-CASH NOT = 'Y' AND 'N'
  9966*       IF CL-ASSOCIATES = 'N' OR 'A'
  9967*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9968*           MOVE AL-UANON        TO  CASHA
  9969*       ELSE
  9970*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9971*           MOVE AL-UANON        TO  CASHA.
  9972*
  9973*    IF PI-PMTTYPE = '5' OR '6'
  9974*        IF PI-CASH = 'N'
  9975*            MOVE ER-0819        TO  EMI-ERROR
  9976*            MOVE AL-UANON       TO  CASHA
  9977*            MOVE -1             TO  CASHL
  9978*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9979*
  9980*    IF CL-ASSOCIATES = 'N' OR 'A'
  9981*       IF CASHI = 'N'
  9982*        MOVE ER-3537            TO  EMI-ERROR
  9983*        MOVE AL-UANON           TO  CASHA
  9984*        MOVE -1                 TO  CASHL
  9985*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9986
  9987 1007-DEFAULT-AIG-CHECKNO.
  9988
  9989     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9990         MOVE ER-3532            TO  EMI-ERROR
  9991         MOVE -1                 TO  PMTTYPEL
  9992         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9993**********************AIG LOGIC ENDS ***********************
  9994
  9995 1008-READ-CERT.
  9996
  9997     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9998     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9999     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 10000     MOVE CL-CERT-STATE          TO CERT-STATE.
 10001     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 10002     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 10003     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 10004     MOVE 'CERT'                 TO FILE-SWITCH.
 10005
 10006     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 10007
 10008     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10009        MOVE CM-LF-LOAN-EXPIRE-DT
 10010                                 TO WS-EXP-DT PI-EXP-DT
 10011                                    ws-extended-exp-dt
 10012     ELSE
 10013        MOVE CM-AH-LOAN-EXPIRE-DT
 10014                                 TO WS-EXP-DT PI-EXP-DT
 10015                                    ws-extended-exp-dt
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 188
* EL156.cbl
 10016     end-if
 10017     MOVE '6'           TO DC-OPTION-CODE
 10018     if pi-dcc-product-code not = spaces
 10019        move cm-ah-benefit-cd    to pi-ah-benefit-cd
 10020        move cm-lf-benefit-cd    to pi-lf-benefit-cd
 10021        PERFORM 0900-GET-DDF-limits
 10022                                 THRU 0900-EXIT
 10023        IF PDEF-FOUND
 10024         AND CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 10025           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10026              (P1 > +8)
 10027              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 10028           END-PERFORM
 10029           IF P1 < +9
 10030              MOVE '6'           TO DC-OPTION-CODE
 10031              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10032              IF CL-NO-OF-EXTENSIONS NUMERIC
 10033               display ' 156 - no of ext ' CL-NO-OF-EXTENSIONS
 10034                 MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10035                                             PI-MAX-EXT
 10036              ELSE
 10037                 MOVE PD-MAX-EXTENSION (P1)
 10038                                 TO DC-ELAPSED-MONTHS
 10039              END-IF
 10040              PERFORM 9700-LINK-DATE-CONVERT
 10041                                 THRU 9700-EXIT
 10042              if no-conversion-error
 10043                 move dc-bin-date-2 to ws-extended-exp-dt
 10044              end-if
 10045           else
 10046              move er-1674       to emi-error
 10047              PERFORM 9900-ERROR-FORMAT
 10048                                 THRU 9900-EXIT
 10049           end-if
 10050        ELSE
 10051           IF CL-NO-OF-EXTENSIONS NUMERIC
 10052              MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10053                                          PI-MAX-EXT
 10054           ELSE
 10055              MOVE ZERO  TO DC-ELAPSED-MONTHS
 10056           END-IF
 10057           MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10058           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10059           if no-conversion-error
 10060              move dc-bin-date-2 to ws-extended-exp-dt
 10061           end-if
 10062        end-if
 10063     ELSE
 10064        IF CL-NO-OF-EXTENSIONS NUMERIC
 10065           MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10066                                       PI-MAX-EXT
 10067        ELSE
 10068           MOVE ZERO  TO DC-ELAPSED-MONTHS
 10069        END-IF
 10070        MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10071        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10072        if no-conversion-error
 10073           move dc-bin-date-2 to ws-extended-exp-dt
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 189
* EL156.cbl
 10074        end-if
 10075     end-if
 10076*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10077*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
 10078
 10079     IF CL-INCURRED-DT < CM-CERT-EFF-DT
 10080         MOVE ER-0458            TO EMI-ERROR
 10081         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10082
 10083     IF (CL-INCURRED-DT > WS-EXP-DT)
 10084        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
 10085        MOVE ER-1677             TO EMI-ERROR
 10086        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
 10087     END-IF
 10088     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
 10089     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
 10090         MOVE ER-0459            TO EMI-ERROR
 10091         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10092
 10093     IF CL-REPORTED-DT = LOW-VALUES
 10094        MOVE ER-0530             TO EMI-ERROR
 10095        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10096
 10097     IF PI-COMPANY-ID = 'NCL'
 10098        IF CM-CREDIT-INTERFACE-SW-1 = '2'
 10099            MOVE ER-0770            TO EMI-ERROR
 10100            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10101
 10102     IF PI-COMPANY-ID = 'NCL'
 10103        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
 10104            MOVE ER-0737            TO EMI-ERROR
 10105            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10106
 10107     IF CM-ENTRY-STATUS = 'D' OR 'V'
 10108         MOVE ER-0768            TO  EMI-ERROR
 10109         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10110
 10111     IF CM-CREDIT-INTERFACE-SW-1 = '4'
 10112         MOVE ER-0769            TO  EMI-ERROR
 10113         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10114
 10115     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10116         GO TO 1020-DO-LIFE-EDITS
 10117     ELSE
 10118         GO TO 1030-DO-AH-EDITS.
 10119
 10120 1010-GENERAL-ERROR.
 10121     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10122
 10123     IF EMI-MESSAGE-FORMATTED
 10124         MOVE -1                 TO PMTTYPEL.
 10125
 10126 1010-EXIT.
 10127     EXIT.
 10128
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 190
* EL156.cbl
 10130 1020-DO-LIFE-EDITS.
 10131     IF CM-LF-BENEFIT-CD = '00'
 10132         IF PI-PMTTYPE = '5' OR '6'
 10133             MOVE ER-0658        TO EMI-ERROR
 10134             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10135         ELSE
 10136            if (pi-company-id = 'DCC' or 'VPP')
 10137               and (pi-dcc-product-code not = spaces)
 10138               continue
 10139            else
 10140               MOVE ER-1775      TO EMI-ERROR
 10141               PERFORM 1040-PMTTYPE-ERROR
 10142                                 THRU 1040-EXIT
 10143            end-if
 10144         end-if
 10145     end-if
 10146
 10147     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10148     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10149         MOVE ER-0460            TO EMI-ERROR
 10150         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10151
 10152     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10153     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10154     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10155     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10156     MOVE '4'                    TO  CNTL-REC-TYPE.
 10157     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10158     MOVE 'BENE'                 TO  FILE-SWITCH.
 10159     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10160     IF NO-BENEFIT-FOUND
 10161         GO TO 1950-NOT-FOUND.
 10162
 10163     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10164
 10165     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10166         IF PI-PMTTYPE = '4'
 10167             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10168                PI-LF-COVERAGE-TYPE = 'P'
 10169                 NEXT SENTENCE
 10170             ELSE
 10171                 MOVE ER-0461        TO EMI-ERROR
 10172                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10173         ELSE
 10174            NEXT SENTENCE
 10175     ELSE
 10176         IF PI-PMTTYPE = '2'
 10177            IF NOT CM-O-B-COVERAGE
 10178              AND CM-LF-CURRENT-STATUS = '7'
 10179                MOVE ER-0462     TO EMI-ERROR
 10180                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10181
 10182     IF PI-PMTTYPE = '2'
 10183         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10184            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10185             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
 10186             MOVE ER-0730            TO  EMI-ERROR
 10187             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 191
* EL156.cbl
 10188             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10189
 10190     IF PI-PMTTYPE = '2'
 10191         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10192            PI-LF-COVERAGE-TYPE = 'P'
 10193             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10194                 MOVE ER-0462    TO  EMI-ERROR
 10195                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10196
 10197     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10198       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10199         MOVE ER-0466            TO EMI-ERROR
 10200         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10201
 10202     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10203         IF PI-PMTTYPE = '3'
 10204             MOVE 0436           TO EMI-ERROR
 10205             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10206             GO TO 1045-EDIT-PAYEE-ADDR
 10207         ELSE
 10208             GO TO 1045-EDIT-PAYEE-ADDR.
 10209
 10210     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10211        PI-LF-COVERAGE-TYPE = 'P'
 10212         IF PI-PMTTYPE = '3'
 10213             MOVE ER-0436          TO  EMI-ERROR
 10214             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10215         ELSE
 10216             NEXT SENTENCE
 10217     ELSE
 10218         IF PI-PMTTYPE = '1' OR '3'
 10219             MOVE ER-0436            TO EMI-ERROR
 10220             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10221*
 10222     IF PI-COMPANY-ID = 'CID' AND
 10223        CL-CERT-STATE = 'SC'  AND
 10224        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10225           MOVE ER-0879    TO  EMI-ERROR
 10226           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10227           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10228     END-IF.
 10229     IF PI-COMPANY-ID = 'AHL'
 10230        evaluate true
 10231           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10232              MOVE ER-0879       TO  EMI-ERROR
 10233              PERFORM 1040-PMTTYPE-ERROR
 10234                                 THRU 1040-EXIT
 10235              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10236           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10237                 '6D' OR '6H' OR '6R'
 10238              MOVE ER-0879       TO  EMI-ERROR
 10239              PERFORM 1040-PMTTYPE-ERROR
 10240                                 THRU 1040-EXIT
 10241              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10242           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10243              MOVE ER-0879       TO  EMI-ERROR
 10244              PERFORM 1040-PMTTYPE-ERROR
 10245                                 THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 192
* EL156.cbl
 10246              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10247        end-evaluate
 10248     END-IF
 10249     GO TO 1045-EDIT-PAYEE-ADDR.
 10250
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 193
* EL156.cbl
 10252 1030-DO-AH-EDITS.
 10253     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10254     IF CM-AH-BENEFIT-CD = '00'
 10255         IF PI-PMTTYPE = '5' OR '6'
 10256             MOVE ER-0658        TO EMI-ERROR
 10257             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10258         ELSE
 10259             MOVE ER-1775        TO EMI-ERROR
 10260             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10261
 10262     IF CL-TOTAL-PAID-AMT = ZEROS
 10263         IF PI-PMTTYPE = '4'
 10264             MOVE ER-0438        TO EMI-ERROR
 10265             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10266
 10267     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10268         IF PI-PMTTYPE = '3'
 10269             MOVE ER-0463        TO EMI-ERROR
 10270             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10271         ELSE
 10272             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10273              AND CM-LF-CURRENT-STATUS = '7'
 10274                 MOVE ER-0465    TO EMI-ERROR
 10275                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10276
 10277     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10278         IF PI-PMTTYPE = '3'
 10279             MOVE ER-0464        TO EMI-ERROR
 10280             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10281         ELSE
 10282             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10283                 MOVE ER-0469    TO EMI-ERROR
 10284                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10285
 10286     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10287         IF PI-PMTTYPE = '3'
 10288             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10289                 MOVE ER-0467    TO EMI-ERROR
 10290                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10291             ELSE
 10292                 NEXT SENTENCE
 10293         ELSE
 10294             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10295                 MOVE ER-0468    TO EMI-ERROR
 10296                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10297
 10298     GO TO 1045-EDIT-PAYEE-ADDR.
 10299
 10300 1040-PMTTYPE-ERROR.
 10301     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10302
 10303     IF EMI-MESSAGE-FORMATTED
 10304         MOVE -1                 TO PMTTYPEL
 10305         MOVE AL-UABON           TO PMTTYPEA.
 10306
 10307 1040-EXIT.
 10308     EXIT.
 10309
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 194
* EL156.cbl
 10311 1045-EDIT-PAYEE-ADDR.
 10312
 10313     IF PI-OFFLINE = 'N' AND
 10314        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10315           < PI-PAYEE-SEQ-NUM)
 10316        OR
 10317         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10318         (PI-PAYEE-TYPE = 'B')                 AND
 10319         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10320        OR
 10321         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10322           < PI-PAYEE-SEQ-NUM)
 10323        OR
 10324         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10325           < PI-PAYEE-SEQ-NUM)
 10326        OR
 10327         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10328           < PI-PAYEE-SEQ-NUM)
 10329        OR
 10330         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10331           < PI-PAYEE-SEQ-NUM)
 10332        OR
 10333         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10334           < PI-PAYEE-SEQ-NUM))
 10335             MOVE ER-0437        TO EMI-ERROR
 10336             MOVE -1             TO PAYEEL
 10337             MOVE AL-UABON       TO PAYEEA
 10338             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10339
 10340     IF PI-OFFLINE    = 'N' AND
 10341        PI-PAYEE-TYPE = 'B' AND
 10342        PI-PAYEE-SEQ  = '0'
 10343         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10344         IF BENE-FOUND-SW = 'N'
 10345             MOVE ER-0437        TO EMI-ERROR
 10346             MOVE -1             TO PAYEEL
 10347             MOVE AL-UABON       TO PAYEEA
 10348             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10349
 10350     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10351        IF PI-OFFLINE    = 'N'  AND
 10352           PI-PAYEE-TYPE = 'B'  AND
 10353           PI-PAYEE-SEQ  = '9'
 10354             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10355             IF BENE-FOUND-SW = 'N'
 10356                MOVE ER-0437        TO EMI-ERROR
 10357                MOVE -1             TO PAYEEL
 10358                MOVE AL-UABON       TO PAYEEA
 10359                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10360
 10361*    IF PI-COMPANY-ID = 'CRI'
 10362*        IF CL-CLAIM-TYPE = 'L'
 10363*            MOVE 'N'                TO  WS-GROUPED
 10364*                                        PI-GROUPED
 10365*                                        GROUPEDI
 10366*            MOVE AL-UANON           TO  GROUPEDA
 10367*            GO TO 1050-EDIT-CHECK-NO
 10368*        ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 195
* EL156.cbl
 10369*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10370*            IF WS-GROUP-1 = 'C'
 10371*                NEXT SENTENCE
 10372*            ELSE
 10373*                MOVE 'N'            TO  WS-GROUPED
 10374*                                        PI-GROUPED
 10375*                                        GROUPEDI
 10376*                MOVE AL-UANON       TO  GROUPEDA
 10377*                GO TO 1050-EDIT-CHECK-NO.
 10378
 10379*     IF PI-GROUPED = 'Y'
 10380*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10381*           NEXT SENTENCE
 10382*        ELSE
 10383*           MOVE ER-0437        TO EMI-ERROR
 10384*           MOVE -1             TO PAYEEL
 10385**02180            MOVE AL-UABON       TO PAYEEA
 10386*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10387*
 10388*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10389*        (PI-GROUPED    = ' ')
 10390*        NEXT SENTENCE
 10391*     ELSE
 10392*
 10393     GO TO 1050-EDIT-CHECK-NO.
 10394*     IF PI-COMPANY-ID = 'CRI'
 10395*        MOVE 'N'           TO GROUPEDI
 10396*                              PI-GROUPED
 10397*                              WS-GROUPED
 10398*        MOVE AL-UANON      TO GROUPEDA.
 10399*
 10400*     IF PI-COMPANY-ID = 'CRI'
 10401*        IF PI-PAYEE-TYPE = 'B'
 10402*           IF BENE-FOUND-SW = 'Y'
 10403*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10404*                 MOVE 'Y'           TO GROUPEDI
 10405*                                       PI-GROUPED
 10406*                                       WS-GROUPED
 10407*                 MOVE AL-UANON      TO GROUPEDA
 10408*              ELSE
 10409*                 NEXT SENTENCE
 10410*           ELSE
 10411*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10412*              IF BENE-FOUND-SW = 'Y'
 10413*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10414*                    MOVE 'Y'      TO GROUPEDI
 10415*                                     PI-GROUPED
 10416*                                     WS-GROUPED
 10417*                    MOVE AL-UANON TO GROUPEDA.
 10418*
 10419
 10420     IF PI-COMPANY-ID NOT = 'CRI'
 10421        GO TO 1050-EDIT-CHECK-NO.
 10422
 10423*************** CRI CODE START ******************
 10424     IF PI-PAYEE-TYPE NOT = 'A'
 10425        GO TO 1050-EDIT-CHECK-NO.
 10426
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 196
* EL156.cbl
 10427     MOVE LOW-VALUES             TO ERACCT-KEY.
 10428     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10429     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10430     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10431     MOVE PI-STATE               TO ACCT-STATE.
 10432     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10433     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10434     MOVE 'ACCT'                 TO FILE-SWITCH.
 10435
 10436     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10437     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10438
 10439
 10440* EXEC CICS HANDLE CONDITION
 10441*         NOTFND   (1950-NOT-FOUND)
 10442*         ENDFILE  (1950-NOT-FOUND)
 10443*    END-EXEC.
 10444*    MOVE '"$I''                  ! ( #00010068' TO DFHEIV0
 10445     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10447     MOVE X'2820233030303130303638' TO DFHEIV0(25:11)
 10448     CALL 'kxdfhei1' USING DFHEIV0
 10449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10450
 10451
 10452
 10453* EXEC CICS STARTBR
 10454*         DATASET   ('ERACCT')
 10455*         RIDFLD    (ERACCT-KEY)
 10456*         GTEQ
 10457*    END-EXEC.
 10458     MOVE 'ERACCT' TO DFHEIV1
 10459     MOVE 0
 10460       TO DFHEIV11
 10461*    MOVE '&,         G          &   #00010073' TO DFHEIV0
 10462     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10463     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10464     MOVE X'2020233030303130303733' TO DFHEIV0(25:11)
 10465     CALL 'kxdfhei1' USING DFHEIV0,
 10466           DFHEIV1,
 10467           ERACCT-KEY,
 10468           DFHEIV99,
 10469           DFHEIV11,
 10470           DFHEIV99
 10471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10472
 10473
 10474 1046-READNEXT-ERACCT.
 10475
 10476
 10477* EXEC CICS READNEXT
 10478*         DATASET   ('ERACCT')
 10479*         RIDFLD    (ERACCT-KEY)
 10480*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10481*    END-EXEC.
 10482     MOVE 'ERACCT' TO DFHEIV1
 10483     MOVE 0
 10484       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 197
* EL156.cbl
 10485*    MOVE '&.S                   )   #00010081' TO DFHEIV0
 10486     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10487     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10488     MOVE X'2020233030303130303831' TO DFHEIV0(25:11)
 10489     CALL 'kxdfhei1' USING DFHEIV0,
 10490           DFHEIV1,
 10491           DFHEIV20,
 10492           DFHEIV99,
 10493           ERACCT-KEY,
 10494           DFHEIV99,
 10495           DFHEIV11,
 10496           DFHEIV99,
 10497           DFHEIV99
 10498     SET ADDRESS OF ACCOUNT-MASTER TO
 10499         DFHEIV20
 10500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10501
 10502
 10503     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10504        IF WS-ERACCT-HOLD-RECORD = SPACES
 10505           GO TO 1950-NOT-FOUND
 10506        ELSE
 10507           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10508           GO TO 1048-CONTINUE.
 10509
 10510     IF ACCT-EXP-DT = HIGH-VALUES
 10511        NEXT SENTENCE
 10512     ELSE
 10513        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10514        GO TO 1046-READNEXT-ERACCT.
 10515
 10516 1048-CONTINUE.
 10517
 10518*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10519*       MOVE 'Y'                 TO GROUPEDI
 10520*                                   PI-GROUPED
 10521*                                   WS-GROUPED
 10522*       MOVE AL-UANON            TO GROUPEDA.
 10523*************** CRI CODE END ******************
 10524
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 198
* EL156.cbl
 10526 1050-EDIT-CHECK-NO.
 10527
 10528     IF PI-OFFLINE = 'Y'
 10529         IF PI-ECHECKNO = SPACES
 10530              MOVE ER-0439        TO EMI-ERROR
 10531              GO TO 1090-CHECK-NO-ERROR
 10532           ELSE
 10533*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10534*           IF PI-ECHECKNO-N = 'N' AND
 10535*              PI-CASH       = 'Y'
 10536*                MOVE ER-3535        TO EMI-ERROR
 10537*                GO TO 1090-CHECK-NO-ERROR
 10538*             ELSE
 10539*                MOVE AL-UANON    TO CHECKNOA
 10540*                GO TO 1100-EDIT-HOLDTIL
 10541*         ELSE
 10542            MOVE AL-UANON    TO CHECKNOA
 10543            GO TO 1100-EDIT-HOLDTIL.
 10544
 10545     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10546     MOVE '6'                    TO CNTL-REC-TYPE.
 10547
 10548     IF CONTROL-IS-ACTUAL-CARRIER
 10549         MOVE PI-CARRIER         TO WS-CARR
 10550     ELSE
 10551         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10552
 10553     IF PI-COMPANY-ID = 'FIA'
 10554         MOVE PI-CARRIER         TO WS-CARR.
 10555
 10556     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10557     MOVE 0                      TO CNTL-SEQ-NO.
 10558     MOVE 'CARR'                 TO FILE-SWITCH.
 10559
 10560     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10561
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 199
* EL156.cbl
 10563     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10564         GO TO 1051-EDIT-CHECKNO-CONT.
 10565
 10566**********************AIG LOGIC STARTS**********************
 10567     IF PI-ECHECKNO = SPACES
 10568         IF CHECK-NO-MANUAL
 10569             MOVE ER-0441        TO EMI-ERROR
 10570             GO TO 1090-CHECK-NO-ERROR
 10571         ELSE
 10572             MOVE AL-UANOF       TO CHECKNOA
 10573             GO TO 1100-EDIT-HOLDTIL.
 10574
 10575     IF PI-ECHECKNO NOT = SPACES
 10576         IF CHECK-NO-MANUAL
 10577             MOVE AL-UANON       TO CHECKNOA
 10578             GO TO 1100-EDIT-HOLDTIL.
 10579
 10580     IF PI-ECHECKNO-CR = 'CR'
 10581        IF PI-OFFLINE = 'Y'
 10582            MOVE AL-UANON       TO CHECKNOA
 10583            GO TO 1100-EDIT-HOLDTIL
 10584        ELSE
 10585            MOVE ER-3534        TO EMI-ERROR
 10586            GO TO 1090-CHECK-NO-ERROR.
 10587
 10588     IF PI-ECHECKNO-N = 'N'
 10589        IF PI-CASH = 'N'
 10590            MOVE AL-UANON       TO CHECKNOA
 10591            GO TO 1100-EDIT-HOLDTIL
 10592        ELSE
 10593            MOVE ER-3535          TO EMI-ERROR
 10594            GO TO 1090-CHECK-NO-ERROR.
 10595
 10596     MOVE ER-0442        TO EMI-ERROR
 10597     GO TO 1090-CHECK-NO-ERROR.
 10598**********************AIG LOGIC ENDS************************
 10599
 10600 1051-EDIT-CHECKNO-CONT.
 10601
 10602     IF PI-COMPANY-ID = 'DMD'
 10603        IF PI-ECHECKNO NOT = SPACES
 10604           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10605              MOVE ER-0442        TO EMI-ERROR
 10606              GO TO 1090-CHECK-NO-ERROR
 10607            ELSE
 10608              GO TO 1100-EDIT-HOLDTIL
 10609          ELSE
 10610           GO TO 1100-EDIT-HOLDTIL.
 10611
 10612     IF PI-ECHECKNO = SPACES
 10613         IF CHECK-NO-MANUAL
 10614             MOVE ER-0441        TO EMI-ERROR
 10615             GO TO 1090-CHECK-NO-ERROR
 10616         ELSE
 10617             MOVE AL-UANOF       TO CHECKNOA
 10618             GO TO 1100-EDIT-HOLDTIL
 10619     ELSE
 10620         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 200
* EL156.cbl
 10621             MOVE AL-UANON       TO CHECKNOA
 10622             GO TO 1100-EDIT-HOLDTIL
 10623         ELSE
 10624             MOVE ER-0442        TO EMI-ERROR
 10625             GO TO 1090-CHECK-NO-ERROR.
 10626
 10627 1090-CHECK-NO-ERROR.
 10628     MOVE -1                     TO CHECKNOL.
 10629     MOVE AL-UABON               TO CHECKNOA.
 10630     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10631
 10632     GO TO 2000-EDIT-DONE.
 10633
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 201
* EL156.cbl
 10635 1100-EDIT-HOLDTIL.
 10636     MOVE AL-UANON               TO HOLDTILA.
 10637
 10638     IF PI-HOLDTIL = ZEROS
 10639        IF PI-OFFLINE = 'Y'
 10640           MOVE ER-0572          TO EMI-ERROR
 10641           GO TO 1105-HOLDTIL-ERROR
 10642        ELSE
 10643           GO TO 1110-EDIT-PAID-FROM.
 10644
 10645     MOVE '4'                    TO DC-OPTION-CODE.
 10646     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10647     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10648
 10649     IF DATE-CONVERSION-ERROR
 10650         MOVE ER-0446            TO EMI-ERROR
 10651         GO TO 1105-HOLDTIL-ERROR
 10652     END-IF
 10653     IF PI-OFFLINE = 'Y'
 10654        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10655           MOVE ER-0446            TO EMI-ERROR
 10656           GO TO 1105-HOLDTIL-ERROR
 10657        END-IF
 10658     END-IF
 10659
 10660     IF PI-OFFLINE = 'Y'
 10661        GO TO 1110-EDIT-PAID-FROM.
 10662
 10663     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10664     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10665     MOVE '1'                    TO DC-OPTION-CODE.
 10666     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10667
 10668*    IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10669     IF DC-ELAPSED-DAYS > 60 OR DATE-CONVERSION-ERROR
 10670         MOVE ER-0447            TO EMI-ERROR
 10671         GO TO 1105-HOLDTIL-ERROR.
 10672
 10673     GO TO 1110-EDIT-PAID-FROM.
 10674
 10675 1105-HOLDTIL-ERROR.
 10676     MOVE -1                     TO HOLDTILL.
 10677     MOVE AL-UNBON               TO HOLDTILA.
 10678     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10679
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 202
* EL156.cbl
 10681 1110-EDIT-PAID-FROM.
 10682     MOVE AL-UANON               TO EPYFROMA.
 10683
 10684     IF PI-EPYFROM = ZEROS
 10685         GO TO 1120-CALCULATE-PAID-FROM.
 10686
 10687     IF PI-PMTTYPE = '5' OR '6'
 10688         MOVE ER-0448            TO EMI-ERROR
 10689         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10690         MOVE AL-UNBON           TO EPYFROMA
 10691         MOVE -1                 TO EPYFROML
 10692         GO TO 1150-EDIT-PAID-THRU.
 10693
 10694     MOVE '4'                    TO DC-OPTION-CODE.
 10695     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10696     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10697
 10698     IF DATE-CONVERSION-ERROR
 10699         MOVE ER-0449            TO EMI-ERROR
 10700         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10701         MOVE AL-UNBON           TO EPYFROMA
 10702         MOVE -1                 TO EPYFROML
 10703     ELSE
 10704         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10705
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 203
* EL156.cbl
 10707 1120-CALCULATE-PAID-FROM.
 10708     IF PI-PMTTYPE = '5' OR '6'
 10709         GO TO 1150-EDIT-PAID-THRU.
 10710
 10711*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10712*       IF PI-PMTTYPE = '4'
 10713*         GO TO 1150-EDIT-PAID-THRU.
 10714
 10715     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10716         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10717         MOVE ' '                TO DC-OPTION-CODE
 10718         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10719         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10720         GO TO 1145-TEST-PAID-FROM.
 10721
 10722     IF PI-PMTTYPE = '4'
 10723        GO TO 1150-EDIT-PAID-THRU.
 10724
 10725     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10726     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10727     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10728     MOVE '5'                    TO CNTL-REC-TYPE.
 10729     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10730     MOVE 'BENE'                 TO FILE-SWITCH.
 10731
 10732     IF WS-BEN-CD = ZEROS
 10733         GO TO 1950-NOT-FOUND.
 10734
 10735     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10736
 10737     IF NO-BENEFIT-FOUND
 10738         GO TO 1950-NOT-FOUND.
 10739
 10740     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10741     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10742
 10743     IF PI-BEN-DAYS NOT NUMERIC
 10744        MOVE ZEROS               TO PI-BEN-DAYS.
 10745
 10746     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10747
 10748     SET HOLD-UNTIL-CHK TO TRUE
 10749     MOVE CL-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 10750     PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10751     MOVE SPACE TO WS-HOLD-UNTIL-SW
 10752     IF WS-HOLD-UNTIL-DT > CL-PAID-THRU-DT
 10753         MOVE WS-HOLD-UNTIL-DT     TO DC-BIN-DATE-1
 10754         MOVE '6'                 TO DC-OPTION-CODE
 10755         MOVE +0                  TO DC-ELAPSED-MONTHS
 10756         MOVE +1                  TO DC-ELAPSED-DAYS
 10757         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10758         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10759         GO TO 1145-TEST-PAID-FROM.
 10760
 10761     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10762        (CL-TOTAL-PAID-AMT > ZEROS)
 10763         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10764         MOVE '6'                 TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 204
* EL156.cbl
 10765         MOVE +0                  TO DC-ELAPSED-MONTHS
 10766         MOVE +1                  TO DC-ELAPSED-DAYS
 10767         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10768         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10769         GO TO 1145-TEST-PAID-FROM.
 10770
 10771******************************************************************
 10772****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10773****** SPECIAL ENTERED DATE.
 10774******************************************************************
 10775
 10776     IF PI-AIGFROM = ZEROS
 10777         GO TO 1130-CONTINUE-PAID-FROM.
 10778
 10779     MOVE AL-UANON TO AIGFROMA.
 10780
 10781     MOVE '4'                    TO DC-OPTION-CODE.
 10782     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10783     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10784
 10785     IF DATE-CONVERSION-ERROR
 10786         MOVE ER-0449            TO EMI-ERROR
 10787         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10788         MOVE AL-UNBON           TO AIGFROMA
 10789         MOVE -1                 TO AIGFROML
 10790         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10791     ELSE
 10792         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10793         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10794
 10795     GO TO 1140-CONTINUE-PAID-FROM.
 10796
 10797 1130-CONTINUE-PAID-FROM.
 10798
 10799     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10800        (CL-TOTAL-PAID-AMT = ZEROS)
 10801           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10802
 10803 1140-CONTINUE-PAID-FROM.
 10804
 10805     IF PI-BEN-TYPE = 'R'
 10806         IF PI-BEN-DAYS = ZEROS
 10807             NEXT SENTENCE
 10808         ELSE
 10809         IF PI-COMPANY-ID NOT = 'DMD'
 10810             SUBTRACT 1 FROM PI-BEN-DAYS.
 10811
 10812     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10813
 10814     IF PI-COMPANY-ID = 'DMD'
 10815         MOVE -1                 TO DC-ELAPSED-DAYS
 10816         MOVE +0                 TO DC-ELAPSED-MONTHS
 10817         MOVE '6'                TO DC-OPTION-CODE
 10818         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10819         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10820         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10821                               REMAINDER DC-ELAPSED-DAYS
 10822      ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 205
* EL156.cbl
 10823         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10824         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10825
 10826     MOVE '6'                    TO DC-OPTION-CODE.
 10827     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10828     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10829
 10830     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10831
 10832     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10833         MOVE ER-0541            TO EMI-ERROR
 10834         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10835         MOVE -1                 TO EPYFROML
 10836         MOVE AL-UNBON           TO EPYFROMA.
 10837
 10838     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10839        (PI-BENEFIT-SAVE = '60E')
 10840        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10841           (CL-TOTAL-PAID-AMT = ZEROS)
 10842             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10843             MOVE 30                  TO DC-ELAPSED-DAYS
 10844             MOVE +0                  TO DC-ELAPSED-MONTHS
 10845             MOVE '6'                 TO DC-OPTION-CODE
 10846             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10847
 10848     IF PI-BEN-TYPE = 'R'
 10849         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10850     ELSE
 10851         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10852         IF WS-SV-EPYFROM = LOW-VALUES
 10853            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10854
 10855     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10856         IF WS-USE-AIG-PAYFROM   OR
 10857            WS-AIG-RECALC-PAYFROM
 10858              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10859                                      DC-BIN-DATE-1
 10860              MOVE ' '            TO  DC-OPTION-CODE
 10861              MOVE +0             TO  DC-ELAPSED-MONTHS
 10862                                      DC-ELAPSED-DAYS
 10863              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10864              IF NO-CONVERSION-ERROR
 10865                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10866
 10867     IF PI-CPYFROM < CL-INCURRED-DT
 10868        MOVE -1                  TO EPYFROML
 10869        MOVE ER-3542             TO EMI-ERROR
 10870        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10871
 10872     IF CM-ENTRY-DT < CL-INCURRED-DT
 10873        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10874        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10875        MOVE +0                     TO DC-ELAPSED-DAYS
 10876        MOVE +0                     TO DC-ELAPSED-MONTHS
 10877        MOVE '1'                    TO DC-OPTION-CODE
 10878        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10879        ELSE
 10880        MOVE ZEROS TO DC-ELAPSED-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 206
* EL156.cbl
 10881
 10882     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10883         NEXT SENTENCE
 10884     ELSE
 10885         IF DC-ELAPSED-MONTHS < 2
 10886             MOVE ER-3255        TO EMI-ERROR
 10887             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10888
 10889 1145-TEST-PAID-FROM.
 10890     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10891         GO TO 1150-EDIT-PAID-THRU.
 10892
 10893     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10894         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10895         MOVE ' '                TO DC-OPTION-CODE
 10896         MOVE +0                 TO DC-ELAPSED-MONTHS
 10897                                    DC-ELAPSED-DAYS
 10898         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10899         IF NO-CONVERSION-ERROR
 10900             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10901         ELSE
 10902             MOVE SPACES             TO EMI-DATE-FIELD.
 10903
 10904     IF PI-HOLDTIL NOT = ZEROS
 10905        CONTINUE
 10906     ELSE
 10907     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10908         IF CL-TOTAL-PAID-AMT = ZEROS
 10909             MOVE ER-3543            TO EMI-ERROR
 10910             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10911             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10912             IF EMI-MESSAGE-FORMATTED
 10913                MOVE -1             TO EPYFROML
 10914                MOVE AL-UNBON       TO EPYFROMA
 10915             ELSE
 10916                NEXT SENTENCE
 10917         ELSE
 10918             MOVE ER-0452            TO EMI-ERROR
 10919             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10920             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10921             IF EMI-MESSAGE-FORMATTED
 10922                MOVE -1             TO EPYFROML
 10923                MOVE AL-UNBON       TO EPYFROMA.
 10924
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 207
* EL156.cbl
 10926 1150-EDIT-PAID-THRU.
 10927
 10928     MOVE AL-UANON               TO EPYTHRUA.
 10929
 10930     IF PI-EPYTHRU = ZEROS
 10931*        IF PI-PMTTYPE = '4' OR '5' OR '6'
 10932         IF PI-PMTTYPE = '5' OR '6'
 10933           OR (CL-CLAIM-TYPE NOT = 'L' AND PI-PMTTYPE = '4')
 10934             GO TO 1200-EDIT-FIND-TOLERANCES
 10935         ELSE
 10936            IF (PI-PMTTYPE = '3') OR (PI-PMTTYPE = '4') OR
 10937               (PI-PMTTYPE = '2' AND
 10938                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10939               GO TO 1152-CHECK-TYPE
 10940            ELSE
 10941               MOVE ER-0473      TO EMI-ERROR
 10942               GO TO 1170-PAID-THRU-FATAL-ERROR
 10943     ELSE
 10944         IF PI-PMTTYPE = '5' OR '6'
 10945             MOVE ER-0474        TO EMI-ERROR
 10946             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10947
 10948     MOVE '4'                    TO DC-OPTION-CODE.
 10949     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10950     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10951
 10952     IF DATE-CONVERSION-ERROR
 10953         MOVE ER-0475            TO EMI-ERROR
 10954         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10955
 10956     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10957
 10958     IF PI-COMPANY-ID = 'DMD'
 10959         IF PI-PMTTYPE NOT = '2'
 10960                 AND
 10961            WS-EXP-DT > WS-SV-EPYTHRU
 10962             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10963             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10964             MOVE '1'              TO DC-OPTION-CODE
 10965             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10966             IF DATE-CONVERSION-ERROR
 10967                 MOVE ER-0944      TO EMI-ERROR
 10968                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10969             ELSE
 10970                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10971                    DC-ELAPSED-DAYS   = 1
 10972                     MOVE ER-0945  TO EMI-ERROR
 10973                     MOVE -1       TO EPYTHRUL
 10974                     MOVE AL-UABON TO EPYTHRUA
 10975                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10976
 10977     IF PI-PMTTYPE = '4'
 10978         NEXT SENTENCE
 10979     ELSE
 10980         IF WS-SV-EPYTHRU = WS-EXP-DT
 10981             IF PI-PMTTYPE NOT = '2' AND '3'
 10982                 MOVE ER-3541    TO EMI-ERROR
 10983                 MOVE -1         TO PMTTYPEL
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 208
* EL156.cbl
 10984                 MOVE AL-UABON   TO PMTTYPEA
 10985                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10986
 10987     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10988         MOVE ER-0501            TO EMI-ERROR
 10989         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10990
 10991     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10992        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 10993*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10994*              MOVE ER-0540         TO EMI-ERROR
 10995*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10996*              MOVE -1              TO EPYTHRUL
 10997*              MOVE AL-UNBON        TO EPYTHRUA
 10998*          ELSE
 10999*          IF PI-COMPANY-ID = 'DMD'
 11000*              MOVE ER-7540         TO EMI-ERROR
 11001*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11002*              MOVE -1              TO EPYTHRUL
 11003*              MOVE AL-UNBON        TO EPYTHRUA
 11004*          ELSE
 11005               IF PI-PMTTYPE NOT = '2' AND '3'
 11006                  IF PI-COMPANY-ID = '???'
 11007                      MOVE ER-7540  TO EMI-ERROR
 11008                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11009                      MOVE -1       TO EPYTHRUL
 11010                      MOVE AL-UNBON TO EPYTHRUA
 11011                  ELSE
 11012                      MOVE ER-0540  TO EMI-ERROR
 11013                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11014                      MOVE -1       TO EPYTHRUL
 11015                      MOVE AL-UNBON TO EPYTHRUA.
 11016
 11017     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11018            OR
 11019        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 11020         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11021            OR
 11022        (PI-CPYFROM NOT = LOW-VALUES AND
 11023         PI-CPYFROM < CL-PAID-THRU-DT)
 11024        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 11025
 11026 1152-CHECK-TYPE.
 11027     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11028        OR (PI-PMTTYPE = '5' OR '6')
 11029         GO TO 1160-EDIT-PAID-THRU-AH.
 11030
 11031 1155-EDIT-PAID-THRU-LIFE.
 11032     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11033     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11034     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11035     MOVE '4'                    TO CNTL-REC-TYPE.
 11036     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11037     MOVE 'BENE'                 TO FILE-SWITCH.
 11038
 11039     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11040
 11041     IF NO-BENEFIT-FOUND
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 209
* EL156.cbl
 11042         GO TO 1950-NOT-FOUND.
 11043
 11044     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 11045
 11046     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 11047
 11048     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11049        PI-LF-COVERAGE-TYPE = 'P'
 11050         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 11051         GO TO 1200-EDIT-FIND-TOLERANCES.
 11052
 11053     IF PI-EPYTHRU = ZEROS
 11054        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 11055
 11056     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11057         MOVE ER-0476            TO EMI-ERROR
 11058         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11059
 11060     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 11061*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 11062     move cl-critical-period    to dc-elapsed-months
 11063     MOVE +0                    TO DC-ELAPSED-DAYS.
 11064     MOVE '6'                   TO DC-OPTION-CODE.
 11065     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11066
 11067     IF (NO-CONVERSION-ERROR AND
 11068         WS-SPECIAL-CALC-CD = 'C')
 11069        IF CL-INCURRED-DT > DC-BIN-DATE-2
 11070            MOVE ER-0657 TO EMI-ERROR
 11071            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11072
 11073     IF PI-COMPANY-ID = 'NCL'
 11074         IF WS-SPECIAL-CALC-CD = 'C' AND
 11075            cl-critical-period = zeros
 11076*           CM-LF-CRITICAL-PERIOD = +0
 11077             MOVE ER-0844       TO EMI-ERROR
 11078             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11079
 11080     GO TO 1200-EDIT-FIND-TOLERANCES.
 11081
 11082 1160-EDIT-PAID-THRU-AH.
 11083     IF PI-EPYTHRU = ZEROS
 11084        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11085                                    WS-SV-EPYTHRU
 11086     ELSE
 11087        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 11088
 11089     IF WS-SV-EPYTHRU < PI-CPYFROM
 11090         MOVE ER-0508            TO EMI-ERROR
 11091         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11092
 11093     perform 7975-read-acct      thru 7975-exit
 11094     move zeros                  to pi-max-ext
 11095     if PI-DCC-PRODUCT-CODE NOT = SPACES
 11096        PERFORM 0900-GET-DDF-LIMITS
 11097                                 THRU 0900-EXIT
 11098        IF PDEF-FOUND
 11099           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 210
* EL156.cbl
 11100              (P1 > +8)
 11101              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11102           END-PERFORM
 11103           IF P1 < +9
 11104              MOVE PD-MAX-extension (P1)
 11105                                 TO pi-max-ext
 11106           else
 11107              move er-1674       to emi-error
 11108              PERFORM 9900-ERROR-FORMAT
 11109                                 THRU 9900-EXIT
 11110           END-IF
 11111        else
 11112           move er-1672          to emi-error
 11113           PERFORM 9900-ERROR-FORMAT
 11114                                 THRU 9900-EXIT
 11115        END-IF
 11116     end-if
 11117     move spaces                 to pi-max-ext-used
 11118     IF PI-PMTTYPE = '3'
 11119        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11120        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11121           MOVE ER-0477          TO EMI-ERROR
 11122           PERFORM 1165-PAID-THRU-ERROR
 11123                                 THRU 1165-EXIT
 11124        ELSE
 11125           continue
 11126        end-if
 11127     ELSE
 11128        IF WS-SV-EPYTHRU > WS-EXP-DT
 11129         IF PI-DCC-PRODUCT-CODE NOT > SPACES
 11130           move ws-exp-dt        to dc-bin-date-1
 11131           move ws-sv-epythru    to dc-bin-date-2
 11132           MOVE '1'              TO DC-OPTION-CODE
 11133           MOVE +0               TO DC-ELAPSED-DAYS
 11134                                    DC-ELAPSED-MONTHS
 11135           PERFORM 9700-LINK-DATE-CONVERT
 11136                                 THRU 9700-EXIT
 11137           if no-conversion-error
 11138              if dc-elapsed-days > zeros
 11139                 add +1 to dc-elapsed-months
 11140              end-if
 11141              if dc-elapsed-months > pi-max-ext
 11142                 MOVE ER-0557    TO EMI-ERROR
 11143                 PERFORM 1165-PAID-THRU-ERROR
 11144                                 THRU 1165-EXIT
 11145              else
 11146                 move 'Y'        to pi-max-ext-used
 11147                 move er-1670    to emi-error
 11148                 perform 9900-error-format
 11149                                 thru 9900-exit
 11150              end-if
 11151           end-if
 11152         ELSE
 11153            MOVE ER-0557    TO EMI-ERROR
 11154            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 11155         END-IF
 11156        end-if
 11157     end-if
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 211
* EL156.cbl
 11158
 11159     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 11160         PI-PMTTYPE NOT = '3'
 11161         MOVE ER-0541        TO EMI-ERROR
 11162         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11163
 11164     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 11165        (PI-PMTTYPE NOT = '3')
 11166         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 11167             MOVE ER-0478        TO EMI-ERROR
 11168             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11169
 11170     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11171        (PI-PMTTYPE NOT = '4')
 11172         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11173             MOVE ER-0479        TO EMI-ERROR
 11174             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11175
 11176     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11177         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11178             MOVE ER-0545        TO EMI-ERROR
 11179             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11180
 11181     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11182         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11183             MOVE ER-0481        TO EMI-ERROR
 11184             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11185
 11186*    IF PI-COMPANY-ID = 'NCL'
 11187*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11188*           CM-AH-CRITICAL-PERIOD = +0
 11189*            MOVE ER-0844        TO  EMI-ERROR
 11190*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11191
 11192*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11193     if (cl-critical-period = zeros)
 11194        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11195          GO TO 1200-EDIT-FIND-TOLERANCES.
 11196
 11197     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11198     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11199     MOVE '1'        TO DC-OPTION-CODE.
 11200     MOVE +0         TO DC-ELAPSED-DAYS
 11201                        DC-ELAPSED-MONTHS.
 11202     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11203
 11204*    IF NO-CONVERSION-ERROR
 11205*       COMPUTE ws-benefits-paid =
 11206*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11207*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11208*           MOVE ER-0657 TO EMI-ERROR
 11209*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11210
 11211     GO TO 1200-EDIT-FIND-TOLERANCES.
 11212
 11213 1165-PAID-THRU-ERROR.
 11214     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11215
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 212
* EL156.cbl
 11216     IF EMI-MESSAGE-FORMATTED
 11217         MOVE -1                 TO EPYTHRUL
 11218         MOVE AL-UNBON           TO EPYTHRUA.
 11219
 11220 1165-EXIT.
 11221     EXIT.
 11222
 11223 1166-CHECK-ALL-TRLRS.
 11224
 11225     IF PI-PMTTYPE = '4'
 11226        GO TO 1166-TRLR-EXIT.
 11227
 11228     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11229
 11230     IF HOLD-UNTIL-CHK
 11231        CONTINUE
 11232     ELSE
 11233     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11234        WS-SV-EPYFROM = LOW-VALUES
 11235          GO TO 1166-END-CHECK.
 11236
 11237
 11238* EXEC CICS HANDLE CONDITION
 11239*        ENDFILE   (1166-END-CHECK)
 11240*        NOTFND    (1166-END-CHECK)
 11241*    END-EXEC.
 11242*    MOVE '"$''I                  ! ) #00010821' TO DFHEIV0
 11243     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11245     MOVE X'2920233030303130383231' TO DFHEIV0(25:11)
 11246     CALL 'kxdfhei1' USING DFHEIV0
 11247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11248
 11249
 11250     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11251     MOVE +100                   TO TRLR-SEQ-NO.
 11252
 11253
 11254* EXEC CICS STARTBR
 11255*         DATASET    ('ELTRLR')
 11256*         RIDFLD     (ELTRLR-KEY)
 11257*         GTEQ
 11258*    END-EXEC.
 11259     MOVE 'ELTRLR' TO DFHEIV1
 11260     MOVE 0
 11261       TO DFHEIV11
 11262*    MOVE '&,         G          &   #00010829' TO DFHEIV0
 11263     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11264     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11265     MOVE X'2020233030303130383239' TO DFHEIV0(25:11)
 11266     CALL 'kxdfhei1' USING DFHEIV0,
 11267           DFHEIV1,
 11268           ELTRLR-KEY,
 11269           DFHEIV99,
 11270           DFHEIV11,
 11271           DFHEIV99
 11272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11273
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 213
* EL156.cbl
 11274
 11275     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11276
 11277 1166-READ-TRLR-NEXT.
 11278
 11279
 11280* EXEC CICS READNEXT
 11281*         DATASET    ('ELTRLR')
 11282*         RIDFLD     (ELTRLR-KEY)
 11283*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11284*    END-EXEC.
 11285     MOVE 'ELTRLR' TO DFHEIV1
 11286     MOVE 0
 11287       TO DFHEIV11
 11288*    MOVE '&.S                   )   #00010839' TO DFHEIV0
 11289     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11290     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11291     MOVE X'2020233030303130383339' TO DFHEIV0(25:11)
 11292     CALL 'kxdfhei1' USING DFHEIV0,
 11293           DFHEIV1,
 11294           DFHEIV20,
 11295           DFHEIV99,
 11296           ELTRLR-KEY,
 11297           DFHEIV99,
 11298           DFHEIV11,
 11299           DFHEIV99,
 11300           DFHEIV99
 11301     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11302         DFHEIV20
 11303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11304
 11305
 11306     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11307        TRLR-CARRIER  = MSTR-CARRIER  AND
 11308        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11309        TRLR-CERT-NO  = MSTR-CERT-NO
 11310          NEXT SENTENCE
 11311      ELSE
 11312          GO TO 1166-END-CHECK.
 11313
 11314* **  BYPASS ALL NON-PAYMENT TRAILERS
 11315
 11316     IF AT-TRAILER-TYPE = '2'
 11317        NEXT SENTENCE
 11318     ELSE
 11319        GO TO 1166-READ-TRLR-NEXT.
 11320
 11321* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11322
 11323     IF AT-PAYMENT-TYPE = '1' OR '2'
 11324        NEXT SENTENCE
 11325     ELSE
 11326        GO TO 1166-READ-TRLR-NEXT.
 11327
 11328* **  BYPASS ALL VOID PAYMENTS
 11329
 11330     IF AT-VOID-DT NOT = LOW-VALUES
 11331        GO TO 1166-READ-TRLR-NEXT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 214
* EL156.cbl
 11332
 11333     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11334        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11335          GO TO 1166-READ-TRLR-NEXT.
 11336     IF HOLD-UNTIL-CHK
 11337        IF AT-PAID-THRU-DT > WS-HOLD-UNTIL-DT
 11338          AND AT-TO-BE-WRITTEN-DT > ZERO
 11339           MOVE AT-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 11340        END-IF
 11341     END-IF
 11342
 11343     IF HOLD-UNTIL-CHK
 11344        CONTINUE
 11345     ELSE
 11346     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11347         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11348            OR
 11349        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11350         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 11351        NEXT SENTENCE
 11352     ELSE
 11353         IF CL-TOTAL-PAID-AMT > ZEROS
 11354             MOVE ER-0502            TO EMI-ERROR
 11355             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11356             MOVE -1                 TO EPYTHRUL
 11357             MOVE AL-UNBON           TO EPYTHRUA.
 11358
 11359     GO TO 1166-READ-TRLR-NEXT.
 11360
 11361 1166-END-CHECK.
 11362
 11363     IF WS-BROWSE-TRLR-SW = 'Y'
 11364
 11365* EXEC CICS ENDBR
 11366*            DATASET   ('ELTRLR')
 11367*       END-EXEC.
 11368     MOVE 'ELTRLR' TO DFHEIV1
 11369     MOVE 0
 11370       TO DFHEIV11
 11371*    MOVE '&2                    $   #00010903' TO DFHEIV0
 11372     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11373     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11374     MOVE X'2020233030303130393033' TO DFHEIV0(25:11)
 11375     CALL 'kxdfhei1' USING DFHEIV0,
 11376           DFHEIV1,
 11377           DFHEIV11,
 11378           DFHEIV99
 11379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11380
 11381
 11382     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11383
 11384 1166-TRLR-EXIT.
 11385     EXIT.
 11386
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 215
* EL156.cbl
 11388 1170-PAID-THRU-FATAL-ERROR.
 11389     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11390
 11391     MOVE -1                     TO EPYTHRUL.
 11392     MOVE AL-UNBON               TO EPYTHRUA.
 11393
 11394 1200-EDIT-FIND-TOLERANCES.
 11395
 11396* EXEC CICS HANDLE CONDITION
 11397*        ENDFILE(1950-NOT-FOUND)
 11398*        NOTFND (1950-NOT-FOUND)
 11399*    END-EXEC.
 11400*    MOVE '"$''I                  ! * #00010920' TO DFHEIV0
 11401     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11402     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11403     MOVE X'2A20233030303130393230' TO DFHEIV0(25:11)
 11404     CALL 'kxdfhei1' USING DFHEIV0
 11405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11406
 11407
 11408     IF PI-PROCESSOR-ID = 'LGXX'
 11409        GO TO 1240-FIND-ACCT-TOLERANCES.
 11410
 11411     MOVE 'N'                    TO FOUND-TOL-SW.
 11412     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11413     MOVE '2'                    TO CNTL-REC-TYPE.
 11414     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11415     MOVE +0                     TO CNTL-SEQ-NO.
 11416     MOVE 'PROC'                 TO FILE-SWITCH.
 11417
 11418     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11419
 11420     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11421     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11422                                    PI-MAX-PMT-TOL.
 11423     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11424
 11425     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11426         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11427
 11428     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11429     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11430                                    PI-MAX-LF-PMT-TOL.
 11431
 11432     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11433         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11434
 11435     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11436                                    PI-MAX-EXP-PMT.
 11437
 11438 1240-FIND-ACCT-TOLERANCES.
 11439
 11440     IF WS-PMT-TOL NOT = +0
 11441         MOVE 'Y'                TO FOUND-TOL-SW.
 11442
 11443     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11444         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11445         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 216
* EL156.cbl
 11446         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11447         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11448         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11449         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11450     ELSE
 11451         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11452         MOVE PI-CARRIER             TO ACCT-CARRIER
 11453         MOVE PI-GROUPING            TO ACCT-GROUPING
 11454         MOVE PI-STATE               TO ACCT-STATE
 11455         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11456         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11457
 11458     MOVE 'ACCT'                 TO FILE-SWITCH.
 11459
 11460     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11461     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11462
 11463
 11464* EXEC CICS HANDLE CONDITION
 11465*         NOTFND   (1950-NOT-FOUND)
 11466*         ENDFILE  (1950-NOT-FOUND)
 11467*    END-EXEC.
 11468*    MOVE '"$I''                  ! + #00010980' TO DFHEIV0
 11469     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11470     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11471     MOVE X'2B20233030303130393830' TO DFHEIV0(25:11)
 11472     CALL 'kxdfhei1' USING DFHEIV0
 11473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11474
 11475
 11476
 11477* EXEC CICS STARTBR
 11478*        DATASET('ERACCT')
 11479*        RIDFLD (ERACCT-KEY)
 11480*        GTEQ
 11481*    END-EXEC.
 11482     MOVE 'ERACCT' TO DFHEIV1
 11483     MOVE 0
 11484       TO DFHEIV11
 11485*    MOVE '&,         G          &   #00010985' TO DFHEIV0
 11486     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11487     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11488     MOVE X'2020233030303130393835' TO DFHEIV0(25:11)
 11489     CALL 'kxdfhei1' USING DFHEIV0,
 11490           DFHEIV1,
 11491           ERACCT-KEY,
 11492           DFHEIV99,
 11493           DFHEIV11,
 11494           DFHEIV99
 11495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11496
 11497
 11498 1245-FIND-ACCT-TOLERANCES-LOOP.
 11499
 11500
 11501* EXEC CICS READNEXT
 11502*        DATASET('ERACCT')
 11503*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 217
* EL156.cbl
 11504*        RIDFLD (ERACCT-KEY)
 11505*    END-EXEC.
 11506     MOVE 'ERACCT' TO DFHEIV1
 11507     MOVE 0
 11508       TO DFHEIV11
 11509*    MOVE '&.S                   )   #00010993' TO DFHEIV0
 11510     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11511     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11512     MOVE X'2020233030303130393933' TO DFHEIV0(25:11)
 11513     CALL 'kxdfhei1' USING DFHEIV0,
 11514           DFHEIV1,
 11515           DFHEIV20,
 11516           DFHEIV99,
 11517           ERACCT-KEY,
 11518           DFHEIV99,
 11519           DFHEIV11,
 11520           DFHEIV99,
 11521           DFHEIV99
 11522     SET ADDRESS OF ACCOUNT-MASTER TO
 11523         DFHEIV20
 11524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11525
 11526
 11527     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11528        IF WS-ERACCT-HOLD-RECORD = SPACES
 11529           GO TO 1950-NOT-FOUND
 11530        ELSE
 11531           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11532           GO TO 1250-CONTINUE.
 11533
 11534     IF ACCT-EXP-DT = HIGH-VALUES
 11535        NEXT SENTENCE
 11536     ELSE
 11537        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11538        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11539
 11540 1250-CONTINUE.
 11541
 11542     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11543
 11544     IF FOUND-TOL-SW = 'N'
 11545         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11546
 11547********* 1260-FIND-STATE-TOLERANCES.
 11548
 11549     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11550     MOVE PI-STATE               TO WS-ST-ACCESS.
 11551     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11552     MOVE '3'                    TO CNTL-REC-TYPE.
 11553     MOVE +0                     TO CNTL-SEQ-NO.
 11554     MOVE 'STAT'                 TO FILE-SWITCH.
 11555
 11556     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11557
 11558     IF WS-PMT-TOL = +0
 11559         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11560
 11561     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 218
* EL156.cbl
 11562     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11563     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11564     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11565     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11566
 11567****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11568****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11569     IF PI-PAYEE-TYPE <> 'B'
 11570           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11571     END-IF.
 11572
 11573     IF PI-PMTTYPE      = '2'  AND
 11574        PI-SPLIT-PMT-SW = 'Y'  AND
 11575        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11576          MOVE ER-3530                TO EMI-ERROR
 11577          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11578
 11579********* 1280-FIND-BENEFIT-TOLERANCES.
 11580
 11581     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11582        OR (PI-PMTTYPE = '5' OR '6')
 11583         GO TO 1300-FIND-CARR-TOLERANCES.
 11584
 11585     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11586     MOVE '4'                    TO CNTL-REC-TYPE.
 11587     MOVE +0                     TO CNTL-SEQ-NO.
 11588     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11589     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11590     MOVE 'BENE'                 TO FILE-SWITCH.
 11591
 11592     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11593
 11594     IF NO-BENEFIT-FOUND
 11595         GO TO 1950-NOT-FOUND.
 11596
 11597     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11598     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11599     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11600
 11601
 11602* EXEC CICS HANDLE CONDITION
 11603*        NOTFND(1950-NOT-FOUND)
 11604*    END-EXEC.
 11605*    MOVE '"$I                   ! , #00011073' TO DFHEIV0
 11606     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11607     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11608     MOVE X'2C20233030303131303733' TO DFHEIV0(25:11)
 11609     CALL 'kxdfhei1' USING DFHEIV0
 11610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11611
 11612
 11613 1300-FIND-CARR-TOLERANCES.
 11614     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11615     MOVE '6'                    TO CNTL-REC-TYPE.
 11616
 11617     IF CONTROL-IS-ACTUAL-CARRIER
 11618         MOVE PI-CARRIER               TO WS-CARR
 11619     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 219
* EL156.cbl
 11620         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11621
 11622     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11623     MOVE +0                     TO CNTL-SEQ-NO.
 11624     MOVE 'CARR'                 TO FILE-SWITCH.
 11625
 11626     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11627
 11628     IF WS-DAYS-TOL = +0
 11629         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11630
 11631     IF WS-PMT-TOL = +0
 11632         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11633
 11634     IF WS-MAX-DAYS-TOL = +0
 11635         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11636
 11637     IF WS-MAX-PMT-TOL = +0
 11638         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11639                                    PI-MAX-PMT-TOL.
 11640
 11641     IF WS-MAX-LF-PMT-TOL = +0
 11642        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11643                                    PI-MAX-LF-PMT-TOL.
 11644
 11645     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11646
 11647********* 1320-FIND-COMP-TOLERANCES.
 11648
 11649     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11650     MOVE '1'                    TO CNTL-REC-TYPE.
 11651     MOVE SPACES                 TO CNTL-ACCESS.
 11652     MOVE +0                     TO CNTL-SEQ-NO.
 11653     MOVE 'COMP'                 TO FILE-SWITCH.
 11654
 11655     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11656
 11657     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11658     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11659
 11660     IF WS-PMT-TOL NOT = +0
 11661        IF WS-TOL-SEVERITY NOT = ' '
 11662         GO TO 1360-EDIT-DAYS.
 11663
 11664     IF WS-PMT-TOL = +0
 11665         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11666
 11667     IF WS-TOL-SEVERITY = ' '
 11668         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11669
 11670 1360-EDIT-DAYS.
 11671     IF PI-PMTTYPE NOT = '4'
 11672        IF PI-EDAYS NEGATIVE OR
 11673           PI-EPYAMT NEGATIVE
 11674          MOVE ER-0513             TO EMI-ERROR
 11675          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11676          MOVE -1                  TO PMTTYPEL.
 11677
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 220
* EL156.cbl
 11678     IF PI-PMTTYPE = '5' OR '6'
 11679        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11680
 11681     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11682        IF PI-PMTTYPE = '4'
 11683          MOVE PI-EDAYS          TO PI-CDAYS.
 11684
 11685     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11686         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11687
 11688     IF PI-PMTTYPE = '4'
 11689        MOVE PI-EDAYS            TO PI-CDAYS
 11690        GO TO 1400-EDIT-PAYMENT.
 11691
 11692     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11693        GO TO 1500-EDIT-EXPENSES.
 11694
 11695*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11696*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11697*          CM-AH-BENEFIT-CD = '23'              AND
 11698*          CL-CERT-STATE    = '04'              AND
 11699*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11700*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11701*            GO TO 1362-CHECK-MAX-DAYS.
 11702
 11703     IF PI-EDAYS = ZEROS
 11704*        IF PI-COMPANY-ID = 'DMD'
 11705*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11706*            MOVE -1             TO DC-ELAPSED-DAYS
 11707*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11708*            MOVE '6'            TO DC-OPTION-CODE
 11709*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11710*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11711*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11712*            MOVE '1'            TO DC-OPTION-CODE
 11713*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11714*            IF NO-CONVERSION-ERROR
 11715*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11716*                                 + DC-ODD-DAYS-OVER
 11717*               MOVE 6           TO EDAYSL
 11718*               MOVE AL-UNNON    TO EDAYSA
 11719*            ELSE
 11720*                NEXT SENTENCE
 11721*       ELSE
 11722            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11723            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11724            MOVE '1'             TO DC-OPTION-CODE
 11725            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11726            IF NO-CONVERSION-ERROR
 11727                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11728                ADD 1                 TO PI-EDAYS
 11729                MOVE AL-UNNON         TO EDAYSA.
 11730
 11731*    IF PI-COMPANY-ID = 'DMD'
 11732*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11733*        MOVE -1                 TO DC-ELAPSED-DAYS
 11734*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11735*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 221
* EL156.cbl
 11736*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11737*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11738*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11739*        MOVE '1'                TO DC-OPTION-CODE
 11740*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11741*    ELSE
 11742         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11743         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11744         MOVE '1'                TO DC-OPTION-CODE.
 11745         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11746
 11747     IF NO-CONVERSION-ERROR
 11748        IF PI-COMPANY-ID = 'DMD'
 11749            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11750                             + DC-ODD-DAYS-OVER
 11751        ELSE
 11752            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11753            ADD 1                TO PI-CDAYS.
 11754
 11755     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11756        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11757        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11758
 11759     IF PI-EDAYS NOT NUMERIC
 11760         MOVE ER-0491            TO EMI-ERROR
 11761         GO TO 1370-DAYS-ERROR.
 11762
 11763     IF CL-NO-OF-PMTS-MADE = 0
 11764        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11765        AND CL-CERT-STATE = 'MI'
 11766        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11767            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11768     END-IF.
 11769
 11770 1362-CHECK-MAX-DAYS.
 11771
 11772     IF WS-MAX-DAYS-TOL = +999
 11773         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11774
 11775     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11776         IF PI-EDAYS = ZEROS
 11777             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11778         ELSE
 11779             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11780
 11781     IF WS-MAX-DAYS-TOL NOT = ZERO
 11782        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11783           PI-CDAYS > WS-MAX-DAYS-TOL
 11784             MOVE ER-0492          TO EMI-ERROR
 11785             GO TO 1370-DAYS-ERROR.
 11786
 11787 1365-SKIP-MAX-DAYS-EDIT.
 11788     IF PI-EDAYS = ZEROS
 11789        GO TO 1400-EDIT-PAYMENT.
 11790
 11791     IF WS-DAYS-TOL NOT = ZERO
 11792        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11793           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 222
* EL156.cbl
 11794                MOVE ER-0493     TO EMI-ERROR
 11795                GO TO 1370-DAYS-ERROR.
 11796
 11797     GO TO 1400-EDIT-PAYMENT.
 11798
 11799 1370-DAYS-ERROR.
 11800     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11801
 11802     IF EMI-MESSAGE-FORMATTED
 11803         MOVE -1                 TO EDAYSL
 11804         MOVE AL-UABON           TO EDAYSA.
 11805
 11806     GO TO 1400-EDIT-PAYMENT.
 11807
 11808 1380-EDIT-EXPENSE-PMT-AMT.
 11809     IF PI-PMTTYPE = '5' OR '6'
 11810         NEXT SENTENCE
 11811     ELSE
 11812         GO TO 1400-EDIT-PAYMENT.
 11813
 11814     IF WS-MAX-EXP-PMT NOT = ZEROS
 11815        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11816            MOVE ER-3529            TO EMI-ERROR
 11817            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11818
 11819     GO TO 1500-EDIT-EXPENSES.
 11820
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 223
* EL156.cbl
 11822
 11823 1390-CHECK-PAYMENT-DAYS.
 11824
 11825     IF PI-EDAYS = 0
 11826         MOVE PI-CDAYS TO WS-PD-DAYS
 11827     ELSE
 11828         MOVE PI-EDAYS TO WS-PD-DAYS
 11829     END-IF.
 11830
 11831     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11832         IF WS-PD-DAYS = 14
 11833            GO TO 1390-EXIT
 11834         END-IF
 11835     END-IF.
 11836
 11837     IF PI-COMPANY-ID = 'AHL'  AND
 11838        CM-AH-BENEFIT-CD = '1K'
 11839         IF WS-PD-DAYS = 14
 11840            GO TO 1390-EXIT
 11841         END-IF
 11842     END-IF.
 11843
 11844     IF WS-PD-DAYS < 30
 11845         MOVE ER-3549              TO EMI-ERROR
 11846         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11847     END-IF.
 11848
 11849 1390-EXIT.
 11850      EXIT.
 11851
 11852 1400-EDIT-PAYMENT.
 11853*    IF PI-COMPANY-ID = 'DMD'
 11854*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11855*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11856
 11857     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 11858        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11859        MOVE PI-CARRIER          TO ACCT-CARRIER
 11860        MOVE PI-GROUPING         TO ACCT-GROUPING
 11861        MOVE PI-STATE            TO ACCT-STATE
 11862        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11863        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11864        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11865        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11866
 11867
 11868* EXEC CICS READ
 11869*          DATASET ('ERACCT')
 11870*          RIDFLD  (ERACCT-KEY)
 11871*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11872*          GTEQ
 11873*          resp    (WS-RESPONSE)
 11874*       END-EXEC
 11875     MOVE 'ERACCT' TO DFHEIV1
 11876*    MOVE '&"S        G          (  N#00011331' TO DFHEIV0
 11877     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11878     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11879     MOVE X'204E233030303131333331' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 224
* EL156.cbl
 11880     CALL 'kxdfhei1' USING DFHEIV0,
 11881           DFHEIV1,
 11882           DFHEIV20,
 11883           DFHEIV99,
 11884           ERACCT-KEY,
 11885           DFHEIV99,
 11886           DFHEIV99,
 11887           DFHEIV99
 11888     SET ADDRESS OF ACCOUNT-MASTER TO
 11889         DFHEIV20
 11890     MOVE EIBRESP  TO WS-RESPONSE
 11891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11892        IF WS-RESP-NORMAL
 11893           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11894           and pi-cert-eff-dt < am-expiration-dt
 11895           and pi-cert-eff-dt >= am-effective-dt
 11896           move am-dcc-product-code to pi-dcc-product-code
 11897        else
 11898           move spaces           to pi-dcc-product-code
 11899        end-if
 11900        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11901           PERFORM 0900-GET-DDF-LIMITS
 11902                                 THRU 0900-EXIT
 11903           IF PDEF-FOUND
 11904              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11905                 (P1 > +8)
 11906                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11907              END-PERFORM
 11908              IF P1 < +9
 11909                 if pd-ben-pct (p1) not numeric
 11910                    move zeros   to pd-ben-pct (p1)
 11911                 end-if
 11912                 if pd-ben-pct (p1) = zeros
 11913                    move +1      to ws-work-ben-pct
 11914                 else
 11915                    move pd-ben-pct (p1)
 11916                                 to ws-work-ben-pct
 11917                 end-if
 11918                 compute cm-ah-benefit-amt =
 11919                    cm-ah-benefit-amt * ws-work-ben-pct
 11920                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11921                    move pd-max-amt (p1) to cm-ah-benefit-amt
 11922                 end-if
 11923              else
 11924                 move er-1674    to emi-error
 11925                 PERFORM 9900-ERROR-FORMAT
 11926                                 THRU 9900-EXIT
 11927              END-IF
 11928           else
 11929              move er-1672       to emi-error
 11930              PERFORM 9900-ERROR-FORMAT
 11931                                 THRU 9900-EXIT
 11932           END-IF
 11933        end-if
 11934     END-IF
 11935     IF PI-PMTTYPE NOT = '4'
 11936        GO TO 1405-CALC-PAYMENT.
 11937     IF PI-EDAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 225
* EL156.cbl
 11938         MOVE PI-EPYAMT           TO PI-CPYAMT
 11939         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11940         GO TO 1430-CHECK-AH-TOLERANCE.
 11941
 11942*    IF PI-COMPANY-ID = 'FIA'
 11943*       IF CERT-ACCOUNT = '0000011043'
 11944*        COMPUTE PI-DAILY-RATE ROUNDED =
 11945*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11946*        COMPUTE PI-CPYAMT ROUNDED =
 11947*                          PI-DAILY-RATE * PI-EDAYS
 11948*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11949*        GO TO 1430-CHECK-AH-TOLERANCE.
 11950
 11951     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11952         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11953         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11954         GO TO 1420-CHECK-AIG-BENEFIT.
 11955
 11956     IF WS-CALC-METHOD = '2' OR  '5'
 11957         COMPUTE PI-DAILY-RATE ROUNDED =
 11958                        (CM-AH-BENEFIT-AMT * 12) / 365
 11959         COMPUTE PI-CPYAMT ROUNDED =
 11960                           PI-DAILY-RATE * PI-EDAYS
 11961        GO TO 1420-CHECK-AIG-BENEFIT.
 11962
 11963     IF WS-CALC-METHOD = '3'
 11964         COMPUTE PI-DAILY-RATE =
 11965                         (CM-AH-BENEFIT-AMT * 12) / 365
 11966         COMPUTE PI-CPYAMT ROUNDED =
 11967                           PI-DAILY-RATE * PI-EDAYS
 11968        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 226
* EL156.cbl
 11970*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11971
 11972****************************************************************
 11973****************************************************************
 11974*                  CALCULATED FROM      PAYMENT      PAYMENT
 11975*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11976* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11977*1-01-83  1-15-83    0    15     15        15           15
 11978*1-01-83  1-30-83    0    30     30        30           30
 11979*1-01-83  1-31-83    1     0     31        30           30
 11980*1-01-83  2-01-83    1     1     32        31           31
 11981*1-01-83  2-15-83    1    15     46        45           45
 11982*1-01-83  2-28-83    2     0     59        60           60
 11983*1-01-83  3-01-83    2     1     60        61           61
 11984*1-01-83  3-31-83    3     0     90        90           90
 11985*1-15-83  1-31-83    0    17     17        17           16
 11986*1-15-83  2-01-83    0    18     18        18           17
 11987*1-15-83  2-28-83    1    14     45        44           46
 11988*1-21-83  3-09-83    1    20     48        50           49
 11989*2-05-83  3-06-83    1     2     30        32           32
 11990*2-05-83  3-23-83    1    19     47        49           49
 11991*2-15-83  2-28-83    0    14     14        14           16
 11992*2-15-83  3-01-83    0    15     15        15           17
 11993*2-21-83  3-19-83    0    27     27        27           29
 11994*2-21-83  3-20-83    1     0     28        30           30
 11995*2-21-83  4-10-83    1    18     49        30           50
 11996*2-21-83  5-19-83    2    27     88        87           89
 11997*2-21-83  5-22-83    3     2     91        92           92
 11998*3-21-83  5-19-83    1    30     60        60           59
 11999****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 227
* EL156.cbl
 12001 1405-CALC-PAYMENT.
 12002     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12003     MOVE ' '                    TO DC-OPTION-CODE.
 12004     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12005     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 12006     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 12007
 12008     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12009     MOVE ' '                    TO DC-OPTION-CODE.
 12010     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12011     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 12012     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 12013
 12014     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12015     MOVE -1                     TO DC-ELAPSED-DAYS.
 12016     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 12017     MOVE '6'                    TO DC-OPTION-CODE.
 12018     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12019     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 12020
 12021     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 12022     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 12023     MOVE '1'                    TO DC-OPTION-CODE.
 12024     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12025
 12026     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 12027     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 12028     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 12029
 12030******************************************************************
 12031*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 12032*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 12033*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 12034******************************************************************
 12035
 12036     IF WS-CALC-METHOD = '1'           AND
 12037        DC-ELAPSED-MONTHS > ZERO AND
 12038        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 12039        WDF-DAY > WDT-DAY
 12040          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 12041          MOVE ZEROS               TO DC-ELAPSED-DAYS
 12042          MOVE -1                  TO DC-ELAPSED-MONTHS
 12043          MOVE '6'                 TO DC-OPTION-CODE
 12044          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12045          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 12046          COMPUTE WS-SAVE-ODD-DAYS =
 12047          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 12048          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 12049
 12050     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 12051     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 12052     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 12053
 12054     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 12055     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 12056
 12057*    IF PI-COMPANY-ID = 'FIA'
 12058*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 228
* EL156.cbl
 12059*        COMPUTE PI-DAILY-RATE ROUNDED =
 12060*                          (CM-AH-BENEFIT-AMT * 13) / 365
 12061*        COMPUTE PI-CPYAMT ROUNDED =
 12062*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 12063*        GO TO 1420-CHECK-AIG-BENEFIT.
 12064
 12065*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12066*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 12067*          CM-AH-BENEFIT-CD = '23'               AND
 12068*          CL-CERT-STATE    = '04'               AND
 12069*         (PI-PMTTYPE = '1' OR '2' OR '3')
 12070*            COMPUTE WS-DAILY-RATE ROUNDED =
 12071*                               CM-AH-BENEFIT-AMT / 30
 12072*            COMPUTE PI-CPYAMT ROUNDED =
 12073*                               (WS-DAILY-RATE * PI-CDAYS)
 12074*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12075*            GO TO 1420-CHECK-AIG-BENEFIT.
 12076
 12077     IF WS-CALC-METHOD = '1'
 12078         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12079         COMPUTE PI-CPYAMT ROUNDED =
 12080             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12081             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12082         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 12083         GO TO 1420-CHECK-AIG-BENEFIT.
 12084
 12085     IF WS-CALC-METHOD = '2'
 12086         COMPUTE PI-DAILY-RATE ROUNDED =
 12087                          (CM-AH-BENEFIT-AMT * 12) / 365
 12088         COMPUTE PI-CPYAMT ROUNDED =
 12089             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12090             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12091         GO TO 1420-CHECK-AIG-BENEFIT.
 12092
 12093     IF WS-CALC-METHOD = '4'
 12094         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 12095         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 12096         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12097         COMPUTE PI-CPYAMT ROUNDED =
 12098                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 12099         GO TO 1420-CHECK-AIG-BENEFIT.
 12100
 12101     IF WS-CALC-METHOD = '5'
 12102         COMPUTE PI-DAILY-RATE ROUNDED =
 12103                            (CM-AH-BENEFIT-AMT * 12) / 365
 12104         COMPUTE PI-CPYAMT ROUNDED =
 12105                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 12106         GO TO 1420-CHECK-AIG-BENEFIT.
 12107
 12108     IF WS-CALC-METHOD NOT = '3'
 12109        GO TO 1410-CHECK-PAYMENT.
 12110
 12111******   CALCULATION METHOD  3  ROUTINE
 12112     COMPUTE PI-DAILY-RATE =
 12113                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 12114
 12115******CHECK TO SEE IF WITHIN SAME MONTH
 12116     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 229
* EL156.cbl
 12117        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 12118                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 12119         GO TO 1420-CHECK-AIG-BENEFIT.
 12120
 12121******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 12122     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 12123             SAVE-ODD-DAYS-OVER = ZEROS
 12124      COMPUTE PI-CPYAMT  ROUNDED =
 12125                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 12126      GO TO 1420-CHECK-AIG-BENEFIT.
 12127
 12128******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 12129******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 12130     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12131        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 12132        IF WDF-MONTH > 12
 12133           ADD 1                 TO WDF-YEAR
 12134           SUBTRACT 12         FROM WDF-MONTH.
 12135
 12136******CONVERT THE NEW FROM MONTH TO BINARY
 12137     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12138        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 12139        MOVE '4'              TO DC-OPTION-CODE
 12140        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12141        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 12142
 12143     IF WDF-MONTH = WDT-MONTH AND
 12144        WDF-YEAR  = WDT-YEAR
 12145          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 12146                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 12147                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 12148        ELSE
 12149          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 12150          MOVE WDT-DAY              TO THRU-PMT-DAYS
 12151          COMPUTE PI-CPYAMT ROUNDED =
 12152       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 12153       +
 12154       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 12155       +
 12156       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 12157
 12158     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 230
* EL156.cbl
 12160 1410-CHECK-PAYMENT.
 12161******PAYMENT OPTION 6
 12162******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 12163     IF SAVE-ELAPSED-MONTHS > ZERO
 12164        IF SAVE-ODD-DAYS-OVER = ZEROS
 12165           GO TO 1412-CHECK-TO-DAY
 12166        ELSE
 12167           IF WDF-DAY > WDT-DAY
 12168              IF WDF-MONTH = 02
 12169                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12170                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 12171                  GO TO 1412-CHECK-TO-DAY
 12172              ELSE
 12173                  IF FROM-DAYS-IN-MONTH = 31
 12174                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 12175                     GO TO 1412-CHECK-TO-DAY
 12176                  ELSE
 12177                     GO TO 1412-CHECK-TO-DAY
 12178           ELSE
 12179               GO TO 1412-CHECK-TO-DAY.
 12180
 12181     IF WDF-MONTH NOT = WDT-MONTH
 12182        IF WDF-MONTH = 02
 12183           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12184           IF WDF-DAY = 29
 12185              ADD 1              TO SAVE-ODD-DAYS-OVER
 12186           ELSE
 12187              ADD 2              TO SAVE-ODD-DAYS-OVER
 12188        ELSE
 12189           IF FROM-DAYS-IN-MONTH = 31
 12190              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12191
 12192 1412-CHECK-TO-DAY.
 12193        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12194           IF WDT-DAY = 28
 12195              ADD 2              TO SAVE-ODD-DAYS-OVER
 12196           ELSE
 12197              IF WDT-DAY = 29
 12198                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12199              ELSE
 12200                 NEXT SENTENCE
 12201        ELSE
 12202           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12203              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12204
 12205     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12206     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12207     COMPUTE PI-CPYAMT ROUNDED =
 12208         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12209         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12210
 12211     GO TO 1420-CHECK-AIG-BENEFIT.
 12212
 12213 1415-CHECK-LEAP-YEAR.
 12214     IF FROM-DAYS-IN-MONTH = 29
 12215        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12216
 12217 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 231
* EL156.cbl
 12218     EXIT.
 12219
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 232
* EL156.cbl
 12221 1420-CHECK-AIG-BENEFIT.
 12222
 12223     IF WS-SPECIAL-CALC-CD = 'Q'
 12224         GO TO 1425-CHECK-WHOLE-MONTH.
 12225
 12226*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12227*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12228*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12229*       (PI-PMTTYPE = '1' OR '2')
 12230*        NEXT SENTENCE
 12231*    ELSE
 12232         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12233         GO TO 1430-CHECK-AH-TOLERANCE.
 12234
 12235******************AIG LOGIC STARTS**********************
 12236*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12237*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12238*    MOVE ER-3533      TO EMI-ERROR.
 12239*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12240*    GO TO 1430-CHECK-AH-TOLERANCE.
 12241******************AIG LOGIC ENDS************************
 12242
 12243 1425-CHECK-WHOLE-MONTH.
 12244******************************************************************
 12245****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12246****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12247****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12248****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12249****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12250****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12251****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12252****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12253****          PAID * MONTHLY BENEFIT.                         ****
 12254******************************************************************
 12255
 12256     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12257
 12258     IF CL-NO-OF-PMTS-MADE > +0
 12259         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12260
 12261     IF PI-CDAYS < WS-BEN-DAYS
 12262         GO TO 1430-CHECK-AH-TOLERANCE.
 12263
 12264     IF PI-CDAYS = WS-BEN-DAYS
 12265         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12266         GO TO 1430-CHECK-AH-TOLERANCE.
 12267
 12268*    IF PI-COMPANY-ID = 'ACM'
 12269*       NEXT SENTENCE
 12270*    ELSE
 12271        GO TO 1425-NOT-ACM-W15C.
 12272
 12273*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12274*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12275*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12276*    MOVE '6'                    TO  DC-OPTION-CODE.
 12277*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12278*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 233
* EL156.cbl
 12279*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12280*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12281*       MOVE '1'                 TO  DC-OPTION-CODE
 12282*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12283*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12284*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12285*       IF NO-CONVERSION-ERROR
 12286*          IF (DC-ELAPSED-MONTHS > +0) OR
 12287*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12288*             NEXT SENTENCE
 12289*          ELSE
 12290*             MOVE +0            TO  PI-CPYAMT
 12291*             MOVE ER-0846       TO  EMI-ERROR
 12292*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12293*             GO TO 1430-CHECK-AH-TOLERANCE
 12294*       ELSE
 12295*           MOVE ER-0846         TO  EMI-ERROR
 12296*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12297*           GO TO 1430-CHECK-AH-TOLERANCE.
 12298*
 12299*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12300*       ADD +1 TO DC-ELAPSED-MONTHS.
 12301*
 12302*    COMPUTE PI-CPYAMT ROUNDED =
 12303*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12304*
 12305*    GO TO 1430-CHECK-AH-TOLERANCE.
 12306
 12307 1425-NOT-ACM-W15C.
 12308
 12309     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12310     MOVE '6'                        TO  DC-OPTION-CODE.
 12311     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12312     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12313
 12314     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12315     IF NO-CONVERSION-ERROR
 12316         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12317     ELSE
 12318         MOVE ER-0846                TO  EMI-ERROR
 12319         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12320         GO TO 1430-CHECK-AH-TOLERANCE.
 12321
 12322     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12323     MOVE '1'                        TO  DC-OPTION-CODE.
 12324     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12325     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12326     IF NO-CONVERSION-ERROR
 12327         IF DC-ODD-DAYS-OVER = +0
 12328             NEXT SENTENCE
 12329         ELSE
 12330             MOVE ER-0846            TO  EMI-ERROR
 12331             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12332             GO TO 1430-CHECK-AH-TOLERANCE
 12333     ELSE
 12334         MOVE ER-0846                TO  EMI-ERROR
 12335         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12336         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 234
* EL156.cbl
 12337
 12338     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12339         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12340
 12341     GO TO 1430-CHECK-AH-TOLERANCE.
 12342
 12343 1425-CONT-WHOLE-MONTH-PMTS.
 12344******************************************************************
 12345****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12346****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12347****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12348******************************************************************
 12349
 12350     IF PI-COMPANY-ID = 'ACM'
 12351        NEXT SENTENCE
 12352     ELSE
 12353        IF DC-ODD-DAYS-OVER = +0
 12354            NEXT SENTENCE
 12355        ELSE
 12356            MOVE ER-0845            TO  EMI-ERROR
 12357            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12358            GO TO 1430-CHECK-AH-TOLERANCE.
 12359
 12360     COMPUTE PI-CPYAMT ROUNDED =
 12361                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12362
 12363 1430-CHECK-AH-TOLERANCE.
 12364     IF PI-PMT-APPR-SW = 'G'
 12365         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12366
 12367*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12368*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12369*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12370*
 12371*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12372*      IF WDF-MONTH = 02
 12373*        IF SAVE-ELAPSED-MONTHS = 0
 12374*          NEXT SENTENCE
 12375*        ELSE
 12376*          IF SAVE-ODD-DAYS-OVER > 0
 12377*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12378*            COMPUTE WS-PMT-MOS ROUNDED =
 12379*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12380*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12381*                                     WS-PMT-MOS
 12382*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12383*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12384*          ELSE
 12385*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12386*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12387*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12388*                                     WS-PMT-MOS.
 12389
 12390     IF WS-MAX-PMT-TOL NOT = ZERO
 12391        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12392           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12393            MOVE ER-0494         TO  EMI-ERROR
 12394            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 235
* EL156.cbl
 12395            GO TO 1500-EDIT-EXPENSES.
 12396
 12397 1430-CONT-CHECK-AH-TOLERANCE.
 12398
 12399     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12400        GO TO 1500-EDIT-EXPENSES.
 12401
 12402     IF CM-O-B-COVERAGE
 12403        GO TO 1500-EDIT-EXPENSES.
 12404
 12405     IF PI-COMPANY-ID = 'NCL'
 12406       IF FOUND-TOL-SW = 'Y'
 12407         IF WS-PMT-TOL NOT = ZERO
 12408           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12409              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12410                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12411                  IF WS-NCL-PMT-OPTION = SPACES
 12412                      MOVE ER-0699 TO EMI-ERROR
 12413                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12414                  ELSE
 12415                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12416                      NEXT SENTENCE
 12417                  ELSE
 12418                  IF NOT WS-VALID-NCL-OPTION
 12419                      MOVE ER-0699 TO EMI-ERROR
 12420                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12421
 12422     IF WS-PMT-TOL NOT = ZERO
 12423        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12424           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12425           MOVE ER-0495          TO EMI-ERROR
 12426           PERFORM 1490-PAYMENT-ERROR
 12427                                 THRU 1490-EXIT
 12428        end-if
 12429     end-if
 12430
 12431     GO TO 1500-EDIT-EXPENSES.
 12432
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 236
* EL156.cbl
 12434 1440-COMPUTE-LIFE-REMAINING.
 12435
 12436     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12437        IF PI-PMTTYPE = '4'
 12438          MOVE PI-EPYAMT TO PI-CPYAMT
 12439          GO TO 1460-TEST-TYPE.
 12440
 12441     IF WS-LF-COVERAGE-TYPE = 'L'
 12442        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12443                          - CL-TOTAL-PAID-AMT
 12444        GO TO 1450-CHECK-MAX.
 12445
 12446     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12447        PI-LF-COVERAGE-TYPE = 'P'
 12448          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12449                              CM-LF-ITD-DEATH-AMT
 12450          GO TO 1450-CHECK-MAX.
 12451
 12452     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12453     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12454     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12455     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12456     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12457     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12458     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12459     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12460     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12461
 12462     PERFORM 9800-LINK-REM-TERM.
 12463
 12464     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12465     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12466     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12467     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12468     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12469     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12470     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12471     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12472     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12473     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12474     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12475     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12476     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12477     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12478     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12479     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12480     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 12481        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12482        MOVE PI-CARRIER          TO ACCT-CARRIER
 12483        MOVE PI-GROUPING         TO ACCT-GROUPING
 12484        MOVE PI-STATE            TO ACCT-STATE
 12485        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12486        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12487        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12488        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12489
 12490
 12491* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 237
* EL156.cbl
 12492*          DATASET ('ERACCT')
 12493*          RIDFLD  (ERACCT-KEY)
 12494*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12495*          GTEQ
 12496*          resp    (WS-RESPONSE)
 12497*       END-EXEC
 12498     MOVE 'ERACCT' TO DFHEIV1
 12499*    MOVE '&"S        G          (  N#00011936' TO DFHEIV0
 12500     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12501     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12502     MOVE X'204E233030303131393336' TO DFHEIV0(25:11)
 12503     CALL 'kxdfhei1' USING DFHEIV0,
 12504           DFHEIV1,
 12505           DFHEIV20,
 12506           DFHEIV99,
 12507           ERACCT-KEY,
 12508           DFHEIV99,
 12509           DFHEIV99,
 12510           DFHEIV99
 12511     SET ADDRESS OF ACCOUNT-MASTER TO
 12512         DFHEIV20
 12513     MOVE EIBRESP  TO WS-RESPONSE
 12514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12515        IF WS-RESP-NORMAL
 12516           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12517           and (pi-cert-eff-dt < am-expiration-dt)
 12518           and (pi-cert-eff-dt >= am-effective-dt)
 12519           move am-dcc-product-code to pi-dcc-product-code
 12520        else
 12521           move spaces           to pi-dcc-product-code
 12522        end-if
 12523        if pi-dcc-product-code not = spaces
 12524           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12525           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12526           PERFORM 0900-GET-DDF-limits
 12527                                 THRU 0900-EXIT
 12528           IF PDEF-FOUND
 12529              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12530                 (P1 > +8)
 12531                 OR (PD-PROD-CODE (P1) = 'L')
 12532              END-PERFORM
 12533              IF P1 < +9
 12534                 MOVE PD-MAX-AMT (P1)
 12535                                 TO CP-R-MAX-TOT-BEN
 12536              else
 12537                 move er-1674    to emi-error
 12538                 PERFORM 9900-ERROR-FORMAT
 12539                                 THRU 9900-EXIT
 12540              END-IF
 12541           else
 12542              move er-1672       to emi-error
 12543              PERFORM 9900-ERROR-FORMAT
 12544                                 THRU 9900-EXIT
 12545           END-IF
 12546        end-if
 12547     END-IF
 12548
 12549* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 238
* EL156.cbl
 12550*       PROGRAM  (LINK-REMAMT)
 12551*       COMMAREA (CALCULATION-PASS-AREA)
 12552*       LENGTH   (CP-COMM-LENGTH)
 12553*    END-EXEC.
 12554*    MOVE '."C                   (   #00011976' TO DFHEIV0
 12555     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12557     MOVE X'2020233030303131393736' TO DFHEIV0(25:11)
 12558     CALL 'kxdfhei1' USING DFHEIV0,
 12559           LINK-REMAMT,
 12560           CALCULATION-PASS-AREA,
 12561           CP-COMM-LENGTH,
 12562           DFHEIV99,
 12563           DFHEIV99,
 12564           DFHEIV99,
 12565           DFHEIV99
 12566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12567
 12568
 12569     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12570
 12571     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12572     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12573
 12574     IF PI-COMPANY-ID = 'BOA' AND
 12575        PI-PMTTYPE    = '2'   AND
 12576        PI-OFFLINE    = 'N'
 12577           GO TO 1441-COMPUTE-BOA-INTEREST.
 12578
 12579     IF PI-COMPANY-ID = 'NCL' AND
 12580        PI-PMTTYPE    = '2'   AND
 12581        PI-OFFLINE    = 'N'
 12582          GO TO 1442-COMPUTE-NCL-INTEREST
 12583       ELSE
 12584          GO TO 1445-CONTINUE.
 12585
 12586 1441-COMPUTE-BOA-INTEREST.
 12587     MOVE +0             TO WS-CALC-INT.
 12588
 12589     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12590     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12591     MOVE +0             TO DC-ELAPSED-MONTHS
 12592                            DC-ELAPSED-DAYS.
 12593     MOVE '1'            TO DC-OPTION-CODE.
 12594     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12595     IF NO-CONVERSION-ERROR
 12596         NEXT SENTENCE
 12597     ELSE
 12598         GO TO 1445-CONTINUE.
 12599
 12600     IF (PI-INT-RATE NOT > ZEROS)  AND
 12601        (DC-ELAPSED-DAYS > +30)
 12602         MOVE ER-3531            TO EMI-ERROR
 12603         MOVE -1                 TO PINTL
 12604         MOVE AL-UNBON           TO PINTA
 12605         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12606
 12607     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 239
* EL156.cbl
 12608         GO TO 1445-CONTINUE.
 12609
 12610     IF (PI-INT-RATE NOT > ZEROS)  OR
 12611        (DC-ELAPSED-DAYS NOT > +30)
 12612         MOVE PI-EPYAMT TO PI-CPYAMT
 12613         GO TO 1441-FORMAT-NOTE.
 12614
 12615     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12616                                 *  PI-INT-RATE
 12617                                 *  DC-ELAPSED-DAYS
 12618                                 /  365
 12619                                 /  100.
 12620
 12621     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12622
 12623 1441-FORMAT-NOTE.
 12624
 12625     MOVE SPACES        TO WS-BOANOTE1.
 12626     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12627     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12628     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12629     MOVE AL-UANON      TO NOTE1A.
 12630
 12631     IF WS-CALC-INT > ZEROS
 12632         MOVE SPACES        TO WS-BOANOTE2
 12633         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12634         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12635         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12636         MOVE AL-UANON      TO NOTE2A.
 12637
 12638     GO TO 1445-CONTINUE.
 12639
 12640 1442-COMPUTE-NCL-INTEREST.
 12641     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12642     MOVE PI-STATE               TO WS-ST-ACCESS.
 12643     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12644     MOVE '3'                    TO CNTL-REC-TYPE.
 12645     MOVE +0                     TO CNTL-SEQ-NO.
 12646     MOVE 'STAT'                 TO FILE-SWITCH.
 12647
 12648     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12649
 12650     MOVE +0                 TO WS-CALC-INT.
 12651
 12652     IF ST-STAT-FROM-INCURRED
 12653         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12654       ELSE
 12655     IF ST-STAT-FROM-REPORTED
 12656         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12657       ELSE
 12658         GO TO 1445-CONTINUE.
 12659
 12660     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12661     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12662     MOVE +0                 TO DC-ELAPSED-MONTHS
 12663                                DC-ELAPSED-DAYS.
 12664     MOVE '1'                TO DC-OPTION-CODE.
 12665     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 240
* EL156.cbl
 12666     IF NO-CONVERSION-ERROR
 12667         NEXT SENTENCE
 12668     ELSE
 12669         GO TO 1445-CONTINUE.
 12670
 12671     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12672        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12673         GO TO 1445-CONTINUE.
 12674
 12675     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12676                                 *  CF-ST-STAT-INTEREST.
 12677
 12678     MOVE SPACES              TO WS-NCLNOTE1.
 12679     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12680     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12681     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12682                                 PI-PMTNOTE1
 12683                                 NOTE1I.
 12684     MOVE AL-UANON            TO NOTE1A.
 12685
 12686     IF WS-CALC-INT > ZEROS
 12687         MOVE SPACES          TO WS-NCLNOTE2
 12688         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12689         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12690         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12691                                 PI-PMTNOTE2
 12692                                 NOTE2I
 12693         MOVE AL-UANON        TO NOTE2A.
 12694
 12695     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12696
 12697 1445-CONTINUE.
 12698
 12699     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12700        GO TO 1460-TEST-TYPE.
 12701
 12702     IF CM-O-B-COVERAGE
 12703        GO TO 1460-TEST-TYPE.
 12704
 12705     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12706         GO TO 1450-CHECK-MAX.
 12707
 12708     if (pi-company-id = 'DCC' or 'VPP')
 12709        and (pdef-found)
 12710        if pi-epyamt > pd-max-amt (p1)
 12711           move er-1657          to emi-error
 12712           perform 1490-payment-error
 12713                                 thru 1490-exit
 12714           go to 1460-test-type
 12715        end-if
 12716     else
 12717        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12718           > PI-EPYAMT)
 12719                         OR
 12720           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12721           < PI-EPYAMT)
 12722           MOVE ER-0594          TO EMI-ERROR
 12723           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 241
* EL156.cbl
 12724                                 THRU 1490-EXIT
 12725           GO TO 1460-TEST-TYPE
 12726        end-if
 12727     end-if
 12728     .
 12729 1450-CHECK-MAX.
 12730
 12731     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12732        PI-LF-COVERAGE-TYPE = 'P'
 12733         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12734                                   CM-LF-ITD-DEATH-AMT
 12735     ELSE
 12736         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12737                                   CL-TOTAL-PAID-AMT.
 12738
 12739     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12740          MOVE ER-0543           TO EMI-ERROR
 12741          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12742
 12743 1460-TEST-TYPE.
 12744
 12745     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12746        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12747           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12748                                   CM-LF-ALT-BENEFIT-AMT -
 12749                                   CL-TOTAL-PAID-AMT
 12750           IF PI-EPYAMT > WS-LF-BEN-AMT
 12751               MOVE ER-0543      TO EMI-ERROR
 12752               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12753           END-IF
 12754        END-IF
 12755     END-IF
 12756
 12757     IF PI-PMT-APPR-SW = 'G'
 12758       NEXT SENTENCE
 12759     ELSE
 12760       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12761         IF PI-EPYAMT = ZERO
 12762             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12763                 MOVE ER-0494    TO  EMI-ERROR
 12764                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12765                 GO TO 1500-EDIT-EXPENSES
 12766             ELSE
 12767                 NEXT SENTENCE
 12768         ELSE
 12769             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12770                 MOVE ER-0494    TO  EMI-ERROR
 12771                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12772                 GO TO 1500-EDIT-EXPENSES.
 12773
 12774     IF PI-PMTTYPE NOT = '2' OR
 12775        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12776         GO TO 1500-EDIT-EXPENSES.
 12777
 12778     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12779     MOVE ER-0526                TO EMI-ERROR.
 12780     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12781
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 242
* EL156.cbl
 12782     IF EMI-ERROR-NUMBER (1) = '0526'
 12783        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12784
 12785     IF EMI-ERROR-NUMBER (2) = '0526'
 12786        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12787
 12788     GO TO 1500-EDIT-EXPENSES.
 12789
 12790 1490-PAYMENT-ERROR.
 12791     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12792
 12793     IF EMI-MESSAGE-FORMATTED
 12794         MOVE -1                 TO EPYAMTL
 12795         MOVE AL-UNBON           TO EPYAMTA.
 12796
 12797 1490-EXIT.
 12798      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 243
* EL156.cbl
 12800 1500-EDIT-EXPENSES.
 12801     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12802         GO TO 1500-SKIP-ERROR-0556.
 12803
 12804 1500-CONTINUE-ON.
 12805
 12806     IF CM-O-B-COVERAGE
 12807        MOVE ER-0556             TO EMI-ERROR
 12808        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12809
 12810 1500-SKIP-ERROR-0556.
 12811     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12812        IF PI-EEXPENS NOT = ZEROS
 12813           MOVE ER-0524          TO EMI-ERROR
 12814           GO TO 1590-EXPENSE-ERROR
 12815        ELSE
 12816           GO TO 1600-EDIT-RESERVES.
 12817
 12818     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12819     MOVE '6'                    TO CNTL-REC-TYPE.
 12820
 12821     IF CONTROL-IS-ACTUAL-CARRIER
 12822         MOVE PI-CARRIER         TO WS-CARR
 12823     ELSE
 12824         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12825
 12826     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12827     MOVE +0                     TO CNTL-SEQ-NO.
 12828     MOVE 'CARR'                 TO FILE-SWITCH.
 12829
 12830     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12831
 12832     IF EXPENSE-CALC-MANUAL
 12833        GO TO 1600-EDIT-RESERVES.
 12834
 12835     IF DOLLARS-PER-PMT
 12836        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12837        GO TO 1600-EDIT-RESERVES.
 12838
 12839     IF DOLLARS-PER-MONTH AND
 12840        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12841       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12842       GO TO 1600-EDIT-RESERVES.
 12843
 12844     IF PERCENT-OF-PAYMENT
 12845        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12846
 12847     GO TO 1600-EDIT-RESERVES.
 12848
 12849 1590-EXPENSE-ERROR.
 12850     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12851
 12852     IF EMI-MESSAGE-FORMATTED
 12853        MOVE -1                  TO EEXPENSL
 12854        MOVE AL-UNBON            TO EEXPENSA.
 12855
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 244
* EL156.cbl
 12857 1600-EDIT-RESERVES.
 12858     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12859        IF PI-ERESV = ZEROS
 12860           GO TO 1700-EDIT-EXPENSE-TYPE
 12861        ELSE
 12862           MOVE ER-0525          TO EMI-ERROR
 12863           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12864           GO TO 1700-EDIT-EXPENSE-TYPE.
 12865
 12866     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12867     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12868     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12869
 12870     IF NOT AT-MANUAL-RESERVES-USED
 12871        IF PI-ERESV NOT = ZEROS
 12872           MOVE ER-0518          TO EMI-ERROR
 12873           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12874
 12875     IF AT-MANUAL-RESERVES-USED
 12876        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12877        GO TO 1700-EDIT-EXPENSE-TYPE.
 12878
 12879     IF AT-FUTURE-RESERVES-USED
 12880        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12881
 12882     IF AT-FUTURE-RESERVES-USED
 12883        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12884
 12885     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12886        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12887
 12888     IF AT-IBNR-RESERVES-USED
 12889        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12890
 12891     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12892     GO TO 1700-EDIT-EXPENSE-TYPE.
 12893
 12894 1690-RESERVE-ERROR.
 12895     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12896
 12897     IF EMI-MESSAGE-FORMATTED
 12898        MOVE AL-UNBON            TO ERESVA
 12899        MOVE -1                  TO ERESVL.
 12900
 12901 1690-EXIT.
 12902      EXIT.
 12903
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 245
* EL156.cbl
 12905 1700-EDIT-EXPENSE-TYPE.
 12906     IF PI-PMTTYPE NOT = '5' AND '6'
 12907        GO TO 2000-EDIT-DONE.
 12908
 12909     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12910                   '6' OR '7' OR '8' OR '9'
 12911        GO TO 2000-EDIT-DONE.
 12912
 12913 1705-EXPENSE-ERROR.
 12914     MOVE ER-0573                TO EMI-ERROR.
 12915     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12916
 12917     IF EMI-MESSAGE-FORMATTED
 12918        MOVE AL-UABON            TO ETYPEA
 12919        MOVE -1                  TO ETYPEL.
 12920
 12921     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 246
* EL156.cbl
 12923 1950-NOT-FOUND.
 12924     IF FILE-SWITCH = 'MSTR'
 12925        MOVE ER-0204             TO EMI-ERROR.
 12926
 12927     IF FILE-SWITCH = 'CARR'
 12928        MOVE ER-0252             TO EMI-ERROR.
 12929
 12930     IF FILE-SWITCH = 'COMP'
 12931        MOVE ER-0254             TO EMI-ERROR.
 12932
 12933     IF FILE-SWITCH = 'STAT'
 12934        MOVE ER-0149             TO EMI-ERROR.
 12935
 12936     IF FILE-SWITCH = 'PROC'
 12937        MOVE ER-0019             TO EMI-ERROR.
 12938
 12939     IF FILE-SWITCH = 'ACCT'
 12940        MOVE ER-0198             TO EMI-ERROR.
 12941
 12942     IF FILE-SWITCH = 'BENE'
 12943        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12944           MOVE ER-0282          TO EMI-ERROR
 12945        ELSE
 12946           MOVE ER-0283          TO EMI-ERROR.
 12947
 12948     MOVE -1                     TO PMTTYPEL.
 12949     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12950
 12951     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12952                                     WS-FORCE-CTR.
 12953
 12954     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12955                                     WS-FATAL-CTR.
 12956
 12957     GO TO 8200-SEND-DATAONLY.
 12958
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 247
* EL156.cbl
 12960 2000-EDIT-DONE.
 12961     perform 2210-dcc-max-benes thru 2210-exit
 12962     if pi-company-id not = 'DCC' and 'VPP'
 12963        IF (WS-SPECIAL-CALC-CD = 'C')
 12964           and (cl-critical-period > 0)
 12965           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12966              IF PI-EPYAMT > ZEROS
 12967                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12968                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12969              ELSE
 12970                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12971                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12972              END-IF
 12973              if ws-benefits-paid > cl-critical-period
 12974                 MOVE ER-0657          TO EMI-ERROR
 12975                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12976              END-IF
 12977           END-IF
 12978        END-IF
 12979     end-if
 12980     IF PI-HOLDTIL NOT = ZEROS
 12981        MOVE PI-HOLDTIL          TO HOLDTILO
 12982        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12983
 12984     IF PI-EPYFROM NOT = ZEROS
 12985        MOVE PI-EPYFROM          TO EPYFROMO
 12986        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12987
 12988     IF PI-EPYTHRU NOT = ZEROS
 12989        MOVE PI-EPYTHRU            TO EPYTHRUO
 12990        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12991        IF PI-USES-PAID-TO
 12992           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12993           MOVE '4'                TO DC-OPTION-CODE
 12994           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12995           IF NO-CONVERSION-ERROR
 12996              MOVE +1              TO DC-ELAPSED-DAYS
 12997              MOVE +0              TO DC-ELAPSED-MONTHS
 12998              MOVE '6'             TO DC-OPTION-CODE
 12999              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13000              IF NO-CONVERSION-ERROR
 13001                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13002
 13003     MOVE PI-EDAYS               TO EDAYSO.
 13004
 13005     IF PI-AIGFROM NOT = ZEROS
 13006        MOVE PI-AIGFROM          TO AIGFROMO
 13007        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13008
 13009     MOVE PI-EPYAMT              TO EPYAMTO.
 13010     MOVE PI-ERESV               TO ERESVO.
 13011     MOVE PI-EEXPENS             TO EEXPENSO.
 13012
 13013     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13014     MOVE SPACES                 TO DC-OPTION-CODE.
 13015     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13016
 13017     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 248
* EL156.cbl
 13018        MOVE SPACES              TO CPYFROMI
 13019     ELSE
 13020        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 13021        IF PI-EPYFROM = ZEROS
 13022           MOVE AL-UANON             TO EPYFROMA
 13023           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 13024           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 13025
 13026     IF PI-USES-PAID-TO
 13027        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 13028        MOVE +1                            TO DC-ELAPSED-DAYS
 13029        MOVE +0                            TO DC-ELAPSED-MONTHS
 13030        MOVE '6'                           TO DC-OPTION-CODE
 13031        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13032        IF NO-CONVERSION-ERROR
 13033           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 13034           IF PI-EPYTHRU = ZEROS
 13035              MOVE AL-UANON                TO EPYTHRUA
 13036              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 13037              MOVE ' '                     TO DC-OPTION-CODE
 13038              MOVE +0                      TO DC-ELAPSED-DAYS
 13039                                              DC-ELAPSED-MONTHS
 13040              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13041              IF NO-CONVERSION-ERROR
 13042                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 13043                  GO TO 2001-CONTINUE
 13044              ELSE
 13045                  GO TO 2001-CONTINUE
 13046           ELSE
 13047              GO TO 2001-CONTINUE.
 13048
 13049     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13050     MOVE SPACES                 TO DC-OPTION-CODE.
 13051     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13052
 13053     IF DATE-CONVERSION-ERROR
 13054        MOVE SPACES              TO CPYTHRUI
 13055     ELSE
 13056        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13057        IF PI-EPYTHRU = ZEROS
 13058           MOVE AL-UANON TO EPYTHRUA
 13059           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 13060           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 13061
 13062 2001-CONTINUE.
 13063
 13064     MOVE PI-CDAYS               TO CDAYSO.
 13065
 13066     IF PI-EDAYS = ZEROS
 13067        MOVE AL-UNNON TO EDAYSA
 13068        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 13069
 13070     MOVE PI-CPYAMT              TO CPYAMTO.
 13071
 13072     IF PI-EPYAMT = ZEROS
 13073        MOVE AL-UNNON            TO EPYAMTA
 13074        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 13075
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 249
* EL156.cbl
 13076     MOVE PI-CRESV               TO CRESVO.
 13077     MOVE PI-CEXPENS             TO CEXPENSO.
 13078
 13079     IF PI-EEXPENS = ZEROS
 13080        MOVE AL-UNNON TO EEXPENSA
 13081        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 13082
 13083     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13084        AND (CL-CLAIM-TYPE = 'L')
 13085        AND (PI-OFFLINE NOT EQUAL 'Y')
 13086        IF PI-PMTTYPE = '2' OR '4'
 13087           PERFORM 2200-CALC-INTEREST
 13088                                 THRU 2200-EXIT
 13089        END-IF
 13090     END-IF
 13091     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 13092     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 13093     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 13094
 13095     IF EMI-FATAL-CTR = ZEROS
 13096        MOVE 'B'                 TO PI-PASS-SW.
 13097
 13098     IF NOT EMI-MESSAGE-FORMATTED
 13099         MOVE -1                 TO EPYFROML
 13100     ELSE
 13101         IF EMI-ERROR-NUMBER (1) = '0526' AND
 13102            EMI-ERROR-NUMBER (2) = SPACES
 13103             MOVE -1             TO EPYFROML.
 13104
 13105     GO TO 8200-SEND-DATAONLY.
 13106
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 250
* EL156.cbl
 13108 2200-CALC-INTEREST.
 13109     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 13110        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 13111        MOVE '4'                 TO DC-OPTION-CODE
 13112        PERFORM 9700-LINK-DATE-CONVERT
 13113        IF DATE-CONVERSION-ERROR
 13114            MOVE LOW-VALUES      TO CP-PRF-DT
 13115        ELSE
 13116           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 13117        END-IF
 13118     END-IF
 13119     if (pi-int-to-rem-borr <> 'Y' and 'N')
 13120        if pi-rb-joint-coverage
 13121           move 'Y'              to pi-int-to-rem-borr
 13122        end-if
 13123     end-if
 13124     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 13125        IN CLAIM-INT-PASS-AREA
 13126     MOVE CL-CERT-STATE          TO CP-STATE
 13127        IN CLAIM-INT-PASS-AREA
 13128     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 13129     MOVE 'LF'                   TO CP-COVERAGE
 13130     MOVE CL-INCURRED-DT         TO CP-INC-DT
 13131     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 13132     MOVE LOW-VALUES             TO CP-LSTPD-DT
 13133     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 13134     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 13135     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 13136
 13137* EXEC CICS LINK
 13138*       PROGRAM   ('ELCLMI')
 13139*       COMMAREA  (CLAIM-INT-PASS-AREA)
 13140*       LENGTH    (CP-CLAIM-LENGTH)
 13141*    END-EXEC
 13142     MOVE 'ELCLMI' TO DFHEIV1
 13143*    MOVE '."C                   (   #00012549' TO DFHEIV0
 13144     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13145     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13146     MOVE X'2020233030303132353439' TO DFHEIV0(25:11)
 13147     CALL 'kxdfhei1' USING DFHEIV0,
 13148           DFHEIV1,
 13149           CLAIM-INT-PASS-AREA,
 13150           CP-CLAIM-LENGTH,
 13151           DFHEIV99,
 13152           DFHEIV99,
 13153           DFHEIV99,
 13154           DFHEIV99
 13155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13156     MOVE AL-PANOF               TO PINTHA
 13157                                    PINTA
 13158     if cp-clm-int-amt = zeros
 13159        move ' ' to pi-int-to-rem-borr
 13160     end-if
 13161     IF NO-CI-ERROR
 13162        MOVE CP-CLM-INT-AMT      TO PINTO
 13163                                    PI-INT-AMT
 13164        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 13165        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 251
* EL156.cbl
 13166        MOVE AL-PANOF            TO PINTHA
 13167                                    PINTA
 13168        if pi-rb-joint-coverage
 13169           and pi-int-amt > zeros
 13170           move '  INT TO'       to itrb1o
 13171           move ' REM BORR?'     to itrb2o
 13172           move pi-int-to-rem-borr
 13173                                 to itrbyno
 13174           move al-uanon         to itrbyna
 13175           move +1               to itrbynl
 13176        else
 13177           move ' '              to pi-int-to-rem-borr
 13178        end-if
 13179     ELSE
 13180        IF CI-RETURN-CODE = '8'
 13181           MOVE ER-3818          TO EMI-ERROR
 13182           MOVE -1               TO ZINTL
 13183           PERFORM 9900-ERROR-FORMAT
 13184                                 THRU 9900-EXIT
 13185           GO TO 2200-EXIT
 13186        ELSE
 13187           MOVE ZEROS            TO PINTO
 13188                                    PI-INT-AMT
 13189                                    PI-INT-DAYS
 13190                                    PI-INT-RATE-USED
 13191        END-IF
 13192     END-IF
 13193     IF PI-INT-AMT NOT = ZEROS
 13194        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 13195           AND (CL-SOC-SEC-NO NOT = ZEROS)
 13196           CONTINUE
 13197        ELSE
 13198           MOVE CL-SOC-SEC-NO (1:3)
 13199                                 TO WS-SSN (1:3)
 13200           MOVE CL-SOC-SEC-NO (5:2)
 13201                                 TO WS-SSN (4:2)
 13202           MOVE CL-SOC-SEC-NO (8:4)
 13203                                 TO WS-SSN (6:4)
 13204           IF (WS-SSN NUMERIC)
 13205              AND (WS-SSN NOT = ZEROS)
 13206              CONTINUE
 13207           ELSE
 13208              MOVE ER-2044       TO EMI-ERROR
 13209              PERFORM 9900-ERROR-FORMAT
 13210                                 THRU 9900-EXIT
 13211           END-IF
 13212        END-IF
 13213        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13214        if pi-int-to-rem-borr = 'Y'
 13215           move +61              to trlr-seq-no
 13216        else
 13217           MOVE +51              TO TRLR-SEQ-NO
 13218        end-if
 13219
 13220* EXEC CICS READ
 13221*          DATASET  ('ELTRLR')
 13222*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13223*          RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 252
* EL156.cbl
 13224*          RESP     (WS-RESPONSE)
 13225*       END-EXEC
 13226     MOVE 'ELTRLR' TO DFHEIV1
 13227*    MOVE '&"S        E          (  N#00012617' TO DFHEIV0
 13228     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13229     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13230     MOVE X'204E233030303132363137' TO DFHEIV0(25:11)
 13231     CALL 'kxdfhei1' USING DFHEIV0,
 13232           DFHEIV1,
 13233           DFHEIV20,
 13234           DFHEIV99,
 13235           ELTRLR-KEY,
 13236           DFHEIV99,
 13237           DFHEIV99,
 13238           DFHEIV99
 13239     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13240         DFHEIV20
 13241     MOVE EIBRESP  TO WS-RESPONSE
 13242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13243        IF (NOT WS-RESP-NORMAL)
 13244                    OR
 13245           ((WS-RESP-NORMAL)
 13246           AND ((AT-ADDRESS-LINE-1 = SPACES)
 13247           OR (AT-CITY-STATE = SPACES)))
 13248           MOVE ER-0874          TO EMI-ERROR
 13249           if pi-rb-joint-coverage
 13250              move -1            to itrbynl
 13251           end-if
 13252           PERFORM 9900-ERROR-FORMAT
 13253                                 THRU 9900-EXIT
 13254        else
 13255           move at-mail-to-name  to pi-int-payees-name
 13256        END-IF
 13257     END-IF
 13258     .
 13259 2200-EXIT.
 13260     EXIT.
 13261 2210-dcc-max-benes.
 13262
 13263     move pi-ah-term             to ws-max-bens
 13264     if cl-critical-period not = zeros and spaces
 13265        move cl-critical-period  to ws-max-bens
 13266     end-if
 13267     move cm-ah-benefit-amt      to ws-monthly-benefit
 13268     if pdef-found
 13269        and (pd-max-amt (p1) not = zeros)
 13270        if pd-ben-pct (p1) not numeric
 13271           move zeros            to pd-ben-pct (p1)
 13272        end-if
 13273        if pd-ben-pct (p1) = zeros
 13274           move +1               to ws-work-ben-pct
 13275        else
 13276           move pd-ben-pct (p1)  to ws-work-ben-pct
 13277        end-if
 13278*       compute ws-monthly-benefit =
 13279*          ws-monthly-benefit * ws-work-ben-pct
 13280*       if ws-monthly-benefit > pd-max-amt (p1)
 13281*          move pd-max-amt (p1) to ws-monthly-benefit
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 253
* EL156.cbl
 13282*       end-if
 13283     end-if
 13284
 13285     move cl-cert-key-data       to elcrtt-key (2:21)
 13286     move cl-company-cd          to ctrlr-comp-cd
 13287     move cl-cert-no             to ctrlr-cert-no
 13288     move 'B'                    to ctrlr-rec-type
 13289
 13290
 13291* EXEC CICS READ
 13292*       DATASET  ('ELCRTT')
 13293*       set      (address of CERTIFICATE-TRAILERS)
 13294*       RIDFLD   (ELCRTT-KEY)
 13295*       RESP     (WS-RESPONSE)
 13296*    END-EXEC
 13297     MOVE 'ELCRTT' TO DFHEIV1
 13298*    MOVE '&"S        E          (  N#00012670' TO DFHEIV0
 13299     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13300     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13301     MOVE X'204E233030303132363730' TO DFHEIV0(25:11)
 13302     CALL 'kxdfhei1' USING DFHEIV0,
 13303           DFHEIV1,
 13304           DFHEIV20,
 13305           DFHEIV99,
 13306           ELCRTT-KEY,
 13307           DFHEIV99,
 13308           DFHEIV99,
 13309           DFHEIV99
 13310     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13311         DFHEIV20
 13312     MOVE EIBRESP  TO WS-RESPONSE
 13313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13314     IF not WS-RESP-NORMAL
 13315        go to 2210-exit
 13316     end-if
 13317
 13318*    if instypei = 'P'
 13319*       move +1 to s1
 13320*    else
 13321*       MOVE +2 to s1
 13322*    end-if
 13323
 13324*    move +1 to s1
 13325*    evaluate cl-claim-type
 13326*       when 'A'
 13327*          move +1 to s2
 13328*       when 'I'
 13329*          move +2 to s2
 13330*       when 'G'
 13331*          move +3 to s2
 13332*       when 'L'
 13333*          move +4 to s2
 13334*       when 'P'
 13335*          move +5 to s2
 13336*    end-evaluate
 13337
 13338     move zeros                  to ws-prev-days-paid
 13339                                    ws-benefits-paid
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 254
* EL156.cbl
 13340                                    ws-prev-amt-paid
 13341     perform varying s1 from +1 by +1 until
 13342        (s1 > +24)
 13343        or (cs-claim-type (s1) = spaces)
 13344        if pi-company-id not = 'DCC' and 'VPP'
 13345           if cs-claim-type (s1) = cl-claim-type
 13346              compute ws-prev-days-paid =
 13347                 ws-prev-days-paid + cs-days-paid (s1)
 13348              compute ws-prev-amt-paid =
 13349                 ws-prev-amt-paid + cs-total-paid (s1)
 13350           end-if
 13351        else
 13352           if (cs-claim-type (s1) = cl-claim-type)
 13353              and (cs-benefit-period (s1) = cl-benefit-period)
 13354              and (cs-insured-type (s1) = cl-insured-type)
 13355              compute ws-prev-days-paid =
 13356                 ws-prev-days-paid + cs-days-paid (s1)
 13357              compute ws-prev-amt-paid =
 13358                 ws-prev-amt-paid + cs-total-paid (s1)
 13359           end-if
 13360        end-if
 13361     end-perform
 13362     if pi-epyamt > zeros
 13363        compute ws-benefits-paid =
 13364           (ws-prev-amt-paid + pi-epyamt)
 13365           / ws-monthly-benefit
 13366     else
 13367        compute ws-benefits-paid =
 13368           (ws-prev-amt-paid + pi-cpyamt)
 13369           / ws-monthly-benefit
 13370     end-if
 13371*    if pi-company-id = 'DCC'
 13372     if cl-claim-type not = 'L' and 'P'
 13373        if ws-benefits-paid > ws-max-bens
 13374           move er-1658          to emi-error
 13375           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13376        end-if
 13377     end-if
 13378*    end-if
 13379*     if s1 < +25
 13380*        if pi-epyamt > zeros
 13381*           compute ws-benefits-paid =
 13382*              (cs-total-paid (s1) + PI-EPYAMT)
 13383*              / ws-monthly-benefit
 13384*        else
 13385*           compute ws-benefits-paid =
 13386*              (cs-total-paid (s1) + PI-CPYAMT)
 13387*              / ws-monthly-benefit
 13388*        end-if
 13389
 13390*       if ws-benefits-paid > pd-crit-period (p1)
 13391*        if ws-benefits-paid > ws-max-bens
 13392*           move er-1658          to emi-error
 13393*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13394*        end-if
 13395*     end-if
 13396     .
 13397 2210-exit.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 255
* EL156.cbl
 13398     exit.
 13399
 13400 2220-update-elcrtt.
 13401
 13402
 13403* EXEC CICS GETMAIN
 13404*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13405*       LENGTH   (ELCRTT-LENGTH)
 13406*       INITIMG  (GETMAIN-SPACE)
 13407*    END-EXEC
 13408*    MOVE ',"IL                  $   #00012764' TO DFHEIV0
 13409     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13410     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13411     MOVE X'2020233030303132373634' TO DFHEIV0(25:11)
 13412     CALL 'kxdfhei1' USING DFHEIV0,
 13413           DFHEIV20,
 13414           ELCRTT-LENGTH,
 13415           GETMAIN-SPACE
 13416     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13417         DFHEIV20
 13418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13419
 13420     move cl-cert-key-data       to elcrtt-key (2:21)
 13421     move cl-company-cd          to ctrlr-comp-cd
 13422     move cl-cert-no             to ctrlr-cert-no
 13423     move 'B'                    to ctrlr-rec-type
 13424
 13425
 13426* EXEC CICS READ
 13427*       UPDATE
 13428*       DATASET  (ELCRTT-DSID)
 13429*       into     (CERTIFICATE-TRAILERS)
 13430*       RIDFLD   (ELCRTT-KEY)
 13431*       RESP     (WS-RESPONSE)
 13432*    END-EXEC
 13433     MOVE LENGTH OF
 13434      CERTIFICATE-TRAILERS
 13435       TO DFHEIV11
 13436*    MOVE '&"IL       EU         (  N#00012775' TO DFHEIV0
 13437     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13438     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13439     MOVE X'204E233030303132373735' TO DFHEIV0(25:11)
 13440     CALL 'kxdfhei1' USING DFHEIV0,
 13441           ELCRTT-DSID,
 13442           CERTIFICATE-TRAILERS,
 13443           DFHEIV11,
 13444           ELCRTT-KEY,
 13445           DFHEIV99,
 13446           DFHEIV99,
 13447           DFHEIV99
 13448     MOVE EIBRESP  TO WS-RESPONSE
 13449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13450
 13451     IF WS-RESP-NORMAL
 13452        perform 2225-upd-crt-trlr thru 2225-exit
 13453
 13454* EXEC CICS REWRITE
 13455*          DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 256
* EL156.cbl
 13456*          from     (CERTIFICATE-TRAILERS)
 13457*          RESP     (WS-RESPONSE)
 13458*       END-EXEC
 13459     MOVE LENGTH OF
 13460      CERTIFICATE-TRAILERS
 13461       TO DFHEIV11
 13462*    MOVE '&& L                  %  N#00012785' TO DFHEIV0
 13463     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13464     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13465     MOVE X'204E233030303132373835' TO DFHEIV0(25:11)
 13466     CALL 'kxdfhei1' USING DFHEIV0,
 13467           ELCRTT-DSID,
 13468           CERTIFICATE-TRAILERS,
 13469           DFHEIV11,
 13470           DFHEIV99
 13471     MOVE EIBRESP  TO WS-RESPONSE
 13472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13473     else
 13474        if ws-resp-notfnd
 13475           move 'CS'             to certificate-trailers
 13476           move cl-company-cd    to cs-company-cd
 13477           move cl-cert-key-data to cs-control-primary (2:21)
 13478           move cl-cert-no       to cs-cert-no
 13479           move 'B'              to cs-trailer-type
 13480           perform varying s1 from +1 by +1 until s1 > +24
 13481              move zeros         to cs-benefit-period (s1)
 13482                                    cs-days-paid (s1)
 13483                                    cs-total-paid (s1)
 13484                                    cs-remaining-bens (s1)
 13485           end-perform
 13486           perform 2225-upd-crt-trlr
 13487                                 thru 2225-exit
 13488
 13489* EXEC CICS WRITE
 13490*             DATASET  (ELCRTT-DSID)
 13491*             from     (CERTIFICATE-TRAILERS)
 13492*             RIDFLD   (cs-control-primary)
 13493*             RESP     (WS-RESPONSE)
 13494*          END-EXEC
 13495     MOVE LENGTH OF
 13496      CERTIFICATE-TRAILERS
 13497       TO DFHEIV11
 13498*    MOVE '&$ L                  ''  N#00012805' TO DFHEIV0
 13499     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13500     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13501     MOVE X'204E233030303132383035' TO DFHEIV0(25:11)
 13502     CALL 'kxdfhei1' USING DFHEIV0,
 13503           ELCRTT-DSID,
 13504           CERTIFICATE-TRAILERS,
 13505           DFHEIV11,
 13506           cs-control-primary,
 13507           DFHEIV99,
 13508           DFHEIV99
 13509     MOVE EIBRESP  TO WS-RESPONSE
 13510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13511        end-if
 13512     END-IF
 13513
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 257
* EL156.cbl
 13514     .
 13515 2220-exit.
 13516     exit.
 13517
 13518 2225-upd-crt-trlr.
 13519
 13520*    if instypei = 'P'
 13521*       move +1 to s1
 13522*    else
 13523*       MOVE +2 to s1
 13524*    end-if
 13525
 13526*    move +1 to s1
 13527*    evaluate cl-claim-type
 13528*       when 'A'
 13529*          move +1 to s2
 13530*       when 'I'
 13531*          move +2 to s2
 13532*       when 'G'
 13533*          move +3 to s2
 13534*       when 'L'
 13535*          move +4 to s2
 13536*       when 'P'
 13537*          move +5 to s2
 13538*    end-evaluate
 13539     perform varying s1 from +1 by +1 until
 13540        (s1 > +24)
 13541        or (cl-claim-no = cs-claim-no (s1))
 13542     end-perform
 13543     if s1 < +25
 13544        compute cs-total-paid (s1) =
 13545           cs-total-paid (s1) + at-amount-paid
 13546        compute cs-days-paid (s1) =
 13547           cs-days-paid (s1) +  at-days-in-period
 13548*       compute cs-remaining-bens (s1) =
 13549*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13550        perform 2230-accum-bens-paid thru 2230-exit
 13551     end-if
 13552
 13553     .
 13554 2225-exit.
 13555     exit.
 13556 2230-accum-bens-paid.
 13557     if cl-claim-type not = 'L' and 'P'
 13558        move pi-ah-term          to ws-max-bens
 13559        if cl-critical-period not = zeros and spaces
 13560           move cl-critical-period
 13561                                 to ws-max-bens
 13562        end-if
 13563     else
 13564        move 01                  to ws-max-bens
 13565     end-if
 13566     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13567     perform varying s2 from +1 by +1 until
 13568        (s2 > +24)
 13569        or (cs-claim-no (s2) = spaces)
 13570        if pi-company-id not = 'DCC' and 'VPP'
 13571           if cs-claim-type (s2) = cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 258
* EL156.cbl
 13572              compute ws-tot-days-paid =
 13573                 ws-tot-days-paid + cs-days-paid (s2)
 13574              compute ws-tot-amt-paid =
 13575                 ws-tot-amt-paid + cs-total-paid (s2)
 13576           end-if
 13577        else
 13578           if (cs-benefit-period (s2) = cl-benefit-period)
 13579              and (cs-claim-type (s2) = cl-claim-type)
 13580              and (cs-insured-type (s2) = cl-insured-type)
 13581              compute ws-tot-days-paid =
 13582                 ws-tot-days-paid + cs-days-paid (s2)
 13583              compute ws-tot-amt-paid =
 13584                 ws-tot-amt-paid + cs-total-paid (s2)
 13585           end-if
 13586        end-if
 13587     end-perform
 13588     if cl-claim-type = 'L' and 'P'
 13589        if ws-tot-amt-paid > zeros
 13590           move zeros            to cs-remaining-bens (s1)
 13591        else
 13592           move 01               to cs-remaining-bens (s1)
 13593        end-if
 13594     else
 13595        compute ws-pd-bens rounded =
 13596           ws-tot-amt-paid / pi-ah-benefit-amt
 13597        compute cs-remaining-bens (s1) =
 13598           ws-max-bens - ws-pd-bens
 13599        if cs-remaining-bens (s1) < zeros
 13600           move zeros            to cs-remaining-bens (s1)
 13601        end-if
 13602     end-if
 13603     .
 13604 2230-exit.
 13605     exit.
 13606 3000-MOVE-INPUT-TO-SAVE-AREA.
 13607     IF PMTTYPEL > 0
 13608         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13609
 13610     if ws-pmttype = '4'
 13611        if pi-rb-joint-coverage
 13612           if payeel = +0
 13613              move +2            to payeel
 13614              move al-uanon      to payeea
 13615              move 'Q1'          to payeeo
 13616           else
 13617              if payeei not = 'Q1' and 'q1'
 13618                 move er-1582    to emi-error
 13619                 PERFORM 9900-ERROR-FORMAT thru 9900-exit
 13620              end-if
 13621           end-if
 13622        end-if
 13623     end-if
 13624     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13625
 13626     IF WS-PMTTYPE = '9'
 13627         MOVE 'P'                TO PI-PROVISIONAL-IND
 13628         MOVE '1'                TO WS-PMTTYPE.
 13629
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 259
* EL156.cbl
 13630     IF PAYEEL > 0
 13631         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13632         MOVE PAYEEI             TO WS-PAYEE.
 13633
 13634     IF NOTE1L > +0
 13635         MOVE NOTE1I             TO WS-PMTNOTE1
 13636                                    WS-FLI-PMTNOTE
 13637                                    WS-HAN-PMTNOTE.
 13638
 13639     IF NOTE2L > +0
 13640         MOVE NOTE2I             TO WS-PMTNOTE2.
 13641
 13642     IF OFFLINEL > 0
 13643         MOVE OFFLINEI           TO WS-OFFLINE.
 13644
 13645     IF PROOFDTL > 0
 13646         MOVE PROOFDTI            TO DATE-WORK
 13647         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13648         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13649         MOVE '4'                 TO DC-OPTION-CODE
 13650         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13651         IF NO-CONVERSION-ERROR
 13652            MOVE NUM-WORK         TO PROOFDTO
 13653            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13654            MOVE NUM-WORK         TO WS-PROOF-DATE
 13655         ELSE
 13656            MOVE ZEROS            TO WS-PROOF-DATE
 13657         END-IF
 13658     END-IF.
 13659
 13660     IF EOBYNL > +0
 13661         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13662         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13663     END-IF
 13664
 13665     IF CLMFMYNL > +0
 13666         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13667         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13668     END-IF
 13669
 13670     IF SURVYYNL > +0
 13671         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13672         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13673     END-IF
 13674
 13675     IF SPRELYNL > +0
 13676         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13677         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13678     END-IF
 13679     if itrbynl <> +0
 13680        move function upper-case(itrbyni) to itrbyni
 13681        move itrbyni             to ws-int-to-rem-borr
 13682     end-if
 13683*    IF GROUPEDL > +0
 13684*        MOVE GROUPEDI           TO WS-GROUPED.
 13685*
 13686*    IF CASHL > +0
 13687*       MOVE CASHI               TO WS-CASH.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 260
* EL156.cbl
 13688     IF LOANNOL > +0
 13689         MOVE LOANNOI            TO WS-LOAN-NO.
 13690
 13691     IF CHECKNOL > 0
 13692         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13693
 13694     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13695         IF WS-AIG-CREDIT-ENTERED
 13696             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13697             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13698             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13699             MOVE AL-UANON         TO CHECKNOA.
 13700
 13701     IF HOLDTILL > 0
 13702         MOVE HOLDTILI           TO DATE-WORK
 13703         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13704         MOVE NUM-WORK           TO WS-HOLDTIL.
 13705
 13706     IF ZINTL > +0
 13707
 13708* EXEC CICS BIF DEEDIT
 13709*           FIELD   (ZINTI)
 13710*           LENGTH  (07)
 13711*       END-EXEC
 13712     MOVE 07
 13713       TO DFHEIV11
 13714*    MOVE '@"L                   #   #00013007' TO DFHEIV0
 13715     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13716     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13717     MOVE X'2020233030303133303037' TO DFHEIV0(25:11)
 13718     CALL 'kxdfhei1' USING DFHEIV0,
 13719           ZINTI,
 13720           DFHEIV11
 13721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13722        IF ZINTI NOT NUMERIC
 13723           MOVE ER-0419          TO EMI-ERROR
 13724           PERFORM 9900-ERROR-FORMAT
 13725           MOVE AL-UABON         TO ZINTA
 13726           MOVE -1               TO ZINTL
 13727        ELSE
 13728           MOVE ZINTI            TO CP-INT-RATE
 13729                                    WS-INT-RATE
 13730           MOVE CP-INT-RATE      TO ZINTO
 13731           MOVE AL-UNNON         TO ZINTA
 13732        END-IF
 13733     ELSE
 13734        MOVE ZEROS               TO CP-INT-RATE
 13735     END-IF
 13736     IF EPYFROML > 0
 13737         MOVE EPYFROMI           TO DATE-WORK
 13738         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13739         MOVE NUM-WORK           TO WS-EPYFROM.
 13740
 13741     IF AIGFROML > 0
 13742         MOVE AIGFROMI           TO DATE-WORK
 13743         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13744         MOVE NUM-WORK           TO WS-AIGFROM
 13745     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 261
* EL156.cbl
 13746         IF (AIGFROMI = LOW-VALUES) AND
 13747            (PI-AIGFROM NOT = ZEROS)
 13748              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13749
 13750     IF EPYTHRUL > +0
 13751        MOVE EPYTHRUI           TO DATE-WORK
 13752        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13753        MOVE NUM-WORK           TO WS-EPYTHRU
 13754        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13755        MOVE '4'                TO DC-OPTION-CODE
 13756        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13757        IF NO-CONVERSION-ERROR
 13758           IF PI-USES-PAID-TO
 13759              MOVE '6'                TO DC-OPTION-CODE
 13760              MOVE -1                 TO DC-ELAPSED-DAYS
 13761              MOVE +0                 TO DC-ELAPSED-MONTHS
 13762              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13763              IF NO-CONVERSION-ERROR
 13764                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13765                 MOVE ' '             TO DC-OPTION-CODE
 13766                 MOVE +0              TO DC-ELAPSED-DAYS
 13767                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13768              IF NO-CONVERSION-ERROR
 13769                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13770
 13771*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13772*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13773     IF EDAYSL > 0
 13774
 13775* EXEC CICS BIF DEEDIT
 13776*            FIELD(EDAYSI)
 13777*            LENGTH(6)
 13778*        END-EXEC
 13779     MOVE 6
 13780       TO DFHEIV11
 13781*    MOVE '@"L                   #   #00013063' TO DFHEIV0
 13782     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13783     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13784     MOVE X'2020233030303133303633' TO DFHEIV0(25:11)
 13785     CALL 'kxdfhei1' USING DFHEIV0,
 13786           EDAYSI,
 13787           DFHEIV11
 13788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13789         MOVE EDAYSI             TO WS-DY-WORK
 13790         IF WS-DY-SIGN = SPACES
 13791            MOVE WS-DY-NUM       TO WS-EDAYS
 13792            ADD 0                TO WS-EDAYS
 13793         ELSE
 13794            MOVE EDAYSI          TO WS-EDAYS
 13795            ADD 0                TO WS-EDAYS.
 13796
 13797*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13798*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13799     IF EPYAMTL > 0
 13800
 13801* EXEC CICS BIF DEEDIT
 13802*            FIELD(EPYAMTI)
 13803*            LENGTH(10)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 262
* EL156.cbl
 13804*        END-EXEC
 13805     MOVE 10
 13806       TO DFHEIV11
 13807*    MOVE '@"L                   #   #00013078' TO DFHEIV0
 13808     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13809     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13810     MOVE X'2020233030303133303738' TO DFHEIV0(25:11)
 13811     CALL 'kxdfhei1' USING DFHEIV0,
 13812           EPYAMTI,
 13813           DFHEIV11
 13814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13815         MOVE EPYAMTI            TO WS-PY-WORK
 13816         IF WS-PY-SIGN = SPACES
 13817            MOVE WS-PY-NUM       TO WS-EPYAMT
 13818            ADD 0                TO WS-EPYAMT
 13819         ELSE
 13820            MOVE EPYAMTI         TO WS-EPYAMT
 13821            ADD 0                TO WS-EPYAMT.
 13822
 13823     IF ERESVL > 0
 13824
 13825* EXEC CICS BIF DEEDIT
 13826*            FIELD(ERESVI)
 13827*            LENGTH(9)
 13828*        END-EXEC
 13829     MOVE 9
 13830       TO DFHEIV11
 13831*    MOVE '@"L                   #   #00013091' TO DFHEIV0
 13832     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13833     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13834     MOVE X'2020233030303133303931' TO DFHEIV0(25:11)
 13835     CALL 'kxdfhei1' USING DFHEIV0,
 13836           ERESVI,
 13837           DFHEIV11
 13838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13839         MOVE ERESVI TO WS-ERESV.
 13840
 13841     IF EEXPENSL > 0
 13842
 13843* EXEC CICS BIF DEEDIT
 13844*            FIELD(EEXPENSI)
 13845*            LENGTH(8)
 13846*        END-EXEC
 13847     MOVE 8
 13848       TO DFHEIV11
 13849*    MOVE '@"L                   #   #00013098' TO DFHEIV0
 13850     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13851     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13852     MOVE X'2020233030303133303938' TO DFHEIV0(25:11)
 13853     CALL 'kxdfhei1' USING DFHEIV0,
 13854           EEXPENSI,
 13855           DFHEIV11
 13856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13857         MOVE EEXPENSI           TO WS-EEXPENS.
 13858
 13859     IF ETYPEL > ZEROS
 13860         MOVE ETYPEI             TO WS-ETYPE.
 13861
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 263
* EL156.cbl
 13862     IF PI-COMPANY-ID = 'BOA'
 13863        IF PINTL > ZEROS
 13864
 13865* EXEC CICS BIF DEEDIT
 13866*            FIELD (PINTI)
 13867*            LENGTH(05)
 13868*          END-EXEC
 13869     MOVE 05
 13870       TO DFHEIV11
 13871*    MOVE '@"L                   #   #00013109' TO DFHEIV0
 13872     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13873     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13874     MOVE X'2020233030303133313039' TO DFHEIV0(25:11)
 13875     CALL 'kxdfhei1' USING DFHEIV0,
 13876           PINTI,
 13877           DFHEIV11
 13878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13879           IF PINTI NUMERIC
 13880               MOVE AL-UNNON     TO PINTA
 13881               MOVE PINTI        TO WS-INT-RATE
 13882               MOVE WS-INT-RATE  TO PINTO.
 13883
 13884 3000-EXIT.
 13885     EXIT.
 13886
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 264
* EL156.cbl
 13888 3050-REBUILD-ENTERED.
 13889
 13890     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13891
 13892     IF PI-PROV-PMT
 13893         MOVE '9'           TO PMTTYPEO
 13894     ELSE
 13895         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13896
 13897     MOVE PI-PAYEE          TO PAYEEO.
 13898     MOVE PI-PMTNOTE1       TO NOTE1O.
 13899     MOVE PI-PMTNOTE2       TO NOTE2O.
 13900     MOVE PI-OFFLINE        TO OFFLINEO.
 13901     IF PI-PROOF-DATE NOT = ZEROS
 13902         MOVE PI-PROOF-DATE TO PROOFDTO
 13903         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13904     END-IF.
 13905*    MOVE PI-GROUPED        TO GROUPEDO.
 13906
 13907*    MOVE PI-CASH           TO CASHO.
 13908
 13909     IF PI-INT-RATE > ZEROS
 13910        MOVE PI-INT-RATE         TO PINTO
 13911     end-if
 13912     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13913        IF PI-INT-AMT > ZEROS
 13914           MOVE PI-INT-AMT       TO PINTO
 13915           MOVE AL-PANOF         TO PINTA
 13916                                    PINTHA
 13917           if pi-rb-joint-coverage
 13918              move '  INT TO'    to itrb1o
 13919              move ' REM BORR?'  to itrb2o
 13920              move 'Y'           to itrbyno
 13921              move al-uanon      to itrbyna
 13922              move +1            to itrbynl
 13923           end-if
 13924        END-IF
 13925     END-IF
 13926     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13927     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13928     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13929     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13930     IF PI-HOLDTIL NOT = ZEROS
 13931        MOVE PI-HOLDTIL          TO HOLDTILO
 13932        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13933
 13934     IF PI-EPYFROM NOT = ZEROS
 13935        MOVE PI-EPYFROM          TO EPYFROMO
 13936        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13937
 13938     IF PI-AIGFROM NOT = ZEROS
 13939        MOVE PI-AIGFROM          TO AIGFROMO
 13940        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13941
 13942     IF PI-EPYTHRU NOT = ZEROS
 13943        MOVE PI-EPYTHRU          TO EPYTHRUO
 13944        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13945        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 265
* EL156.cbl
 13946           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13947           MOVE '4'                TO DC-OPTION-CODE
 13948           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13949           IF NO-CONVERSION-ERROR
 13950              MOVE +1 TO DC-ELAPSED-DAYS
 13951              MOVE +0 TO DC-ELAPSED-MONTHS
 13952              MOVE '6' TO DC-OPTION-CODE
 13953              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13954              IF NO-CONVERSION-ERROR
 13955                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13956
 13957     IF PI-EDAYS NOT = ZEROS
 13958        MOVE PI-EDAYS TO EDAYSO.
 13959
 13960     IF PI-EPYAMT NOT = ZEROS
 13961        MOVE PI-EPYAMT TO EPYAMTO.
 13962
 13963     IF PI-ERESV NOT = ZEROS
 13964        MOVE PI-ERESV TO ERESVO.
 13965
 13966     IF PI-EEXPENS NOT = ZEROS
 13967        MOVE PI-EEXPENS TO EEXPENSO.
 13968
 13969     MOVE PI-ETYPE TO ETYPEO.
 13970
 13971     IF PI-ECHECKNO NOT = SPACES
 13972        MOVE PI-ECHECKNO         TO CHECKNOO
 13973     ELSE
 13974        MOVE PI-CCHECKNO         TO CHECKNOO.
 13975
 13976     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13977     MOVE SPACES                 TO DC-OPTION-CODE.
 13978     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13979
 13980     IF DATE-CONVERSION-ERROR
 13981        MOVE SPACES              TO CPYFROMI
 13982     ELSE
 13983        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13984
 13985     IF PI-USES-PAID-TO
 13986        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13987        MOVE +1                  TO DC-ELAPSED-DAYS
 13988        MOVE +0                  TO DC-ELAPSED-MONTHS
 13989        MOVE '6'                 TO DC-OPTION-CODE
 13990        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13991        IF NO-CONVERSION-ERROR
 13992           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13993           GO TO 3051-CONTINUE.
 13994
 13995     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13996     MOVE SPACES                 TO DC-OPTION-CODE.
 13997     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13998
 13999     IF DATE-CONVERSION-ERROR
 14000        MOVE SPACES              TO CPYTHRUI
 14001     ELSE
 14002        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 14003
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 266
* EL156.cbl
 14004 3051-CONTINUE.
 14005
 14006     IF PI-CDAYS NOT = ZEROS
 14007        MOVE PI-CDAYS TO CDAYSO.
 14008
 14009     IF PI-CPYAMT NOT = ZEROS
 14010        MOVE PI-CPYAMT TO CPYAMTO.
 14011
 14012     IF PI-CRESV NOT = ZEROS
 14013        MOVE PI-CRESV TO CRESVO.
 14014
 14015     IF PI-CEXPENS NOT = ZEROS
 14016        MOVE PI-CEXPENS TO CEXPENSO.
 14017
 14018 3059-EXIT.
 14019     EXIT.
 14020
 14021 3100-DEEDIT-DATE.
 14022
 14023* EXEC CICS BIF DEEDIT
 14024*        FIELD(DATE-WORK)
 14025*        LENGTH(8)
 14026*    END-EXEC.
 14027     MOVE 8
 14028       TO DFHEIV11
 14029*    MOVE '@"L                   #   #00013256' TO DFHEIV0
 14030     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14031     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14032     MOVE X'2020233030303133323536' TO DFHEIV0(25:11)
 14033     CALL 'kxdfhei1' USING DFHEIV0,
 14034           DATE-WORK,
 14035           DFHEIV11
 14036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14037
 14038
 14039 3100-EXIT.
 14040     EXIT.
 14041
 14042 3200-CALC-AIG-DAYS.
 14043
 14044     MOVE 'N'                    TO WS-DUE-DAY-SW.
 14045
 14046     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14047     MOVE ' '                    TO DC-OPTION-CODE.
 14048     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14049     IF NO-CONVERSION-ERROR
 14050         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 14051     ELSE
 14052         GO TO 3290-ERROR.
 14053
 14054     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14055         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14056                                WS-BIN-FROM-DT
 14057     ELSE
 14058         IF CL-TOTAL-PAID-AMT > ZEROS
 14059             IF WS-SV-EPYFROM = LOW-VALUES
 14060                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14061                                        WS-BIN-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 267
* EL156.cbl
 14062             ELSE
 14063                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14064                                        WS-BIN-FROM-DT
 14065         ELSE
 14066             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14067                                        WS-BIN-FROM-DT.
 14068
 14069 3210-CONTINUE.
 14070
 14071     MOVE ' '                    TO DC-OPTION-CODE.
 14072     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14073     IF DATE-CONVERSION-ERROR
 14074         GO TO 3290-ERROR.
 14075
 14076     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 14077
 14078     IF PI-LOAN-DUE-DAY = 31
 14079         MOVE 30              TO WS-PMT-DUE-DA
 14080                                 WS-SAVE-DUE-DA
 14081     ELSE
 14082         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 14083                                 WS-SAVE-DUE-DA.
 14084
 14085     IF (PI-LOAN-DUE-DAY > 28) AND
 14086        (WS-PMT-DUE-MO = 2)
 14087         MOVE 'Y'                TO WS-DUE-DAY-SW
 14088         MOVE 28                 TO WS-PMT-DUE-DA.
 14089
 14090     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 14091     MOVE '4'                    TO DC-OPTION-CODE.
 14092     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14093     IF NO-CONVERSION-ERROR
 14094         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 14095     ELSE
 14096         GO TO 3290-ERROR.
 14097
 14098*--------------------------------------------------------------*
 14099*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 14100*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 14101*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 14102*                                                              *
 14103*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 14104*             INCURRED DATE      - 04/15/91                    *
 14105*             PMT DUE DATE       - 04/03/91                    *
 14106*             PMT DUE DATE       - 05/03/91                    *
 14107*--------------------------------------------------------------*
 14108
 14109     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14110        (WS-SV-AIGFROM = LOW-VALUES)
 14111         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 14112            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 14113             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14114             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14115             IF NO-CONVERSION-ERROR
 14116                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14117                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14118             ELSE
 14119                 GO TO 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 268
* EL156.cbl
 14120
 14121     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14122        (WS-SV-AIGFROM = LOW-VALUES)
 14123         GO TO 3205-CONT-CALC-PMT.
 14124
 14125     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 14126     MOVE ' '                    TO DC-OPTION-CODE.
 14127     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14128     IF NO-CONVERSION-ERROR
 14129         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 14130     ELSE
 14131         GO TO 3290-ERROR.
 14132
 14133     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 14134        (WS-PMT-DUE-DA < WS-FROM-DA)
 14135          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14136          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14137          IF NO-CONVERSION-ERROR
 14138              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14139              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14140          ELSE
 14141              GO TO 3290-ERROR.
 14142
 14143 3205-CONT-CALC-PMT.
 14144
 14145*--------------------------------------------------------------*
 14146*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 14147*    BETWEEN THE PAY FROM / THRU DATES.                        *
 14148*--------------------------------------------------------------*
 14149
 14150     IF CL-TOTAL-PAID-AMT = ZEROS AND
 14151        PI-PMTTYPE = '2'
 14152          NEXT SENTENCE
 14153     ELSE
 14154        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 14155           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 14156             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 14157             MOVE ER-3527            TO EMI-ERROR
 14158             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14159             MOVE -1                 TO EPYTHRUL
 14160             MOVE AL-UNBON           TO EPYTHRUA
 14161                                        EPYFROMA
 14162             GO TO 3299-EXIT.
 14163
 14164*--------------------------------------------------------------*
 14165*    CALCULATE RETRO ELIMINATION DATE                          *
 14166*--------------------------------------------------------------*
 14167
 14168     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14169         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14170     ELSE
 14171         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 14172
 14173     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 14174     MOVE +0             TO DC-ELAPSED-MONTHS.
 14175     MOVE '6'            TO DC-OPTION-CODE.
 14176     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14177     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 269
* EL156.cbl
 14178         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 14179     ELSE
 14180         GO TO 3290-ERROR.
 14181
 14182 3210-CHECK-PMT-DATE.
 14183
 14184*--------------------------------------------------------------*
 14185*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 14186*    THE ENTERED PAY FROM DATE                                 *
 14187*--------------------------------------------------------------*
 14188
 14189     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 14190         NEXT SENTENCE
 14191     ELSE
 14192         GO TO 3220-COMPUTE-DAYS.
 14193
 14194     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 14195     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14196     IF NO-CONVERSION-ERROR
 14197         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14198         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14199         GO TO 3210-CHECK-PMT-DATE
 14200     ELSE
 14201         GO TO 3290-ERROR.
 14202
 14203 3220-COMPUTE-DAYS.
 14204
 14205     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 14206     MOVE ZEROS         TO WS-CDAYS.
 14207     MOVE 'N'           TO WS-ELIMINATION-SW.
 14208
 14209*--------------------------------------------------------------*
 14210*    COMPUTE CALIFORNIA DUE DAYS                               *
 14211*--------------------------------------------------------------*
 14212
 14213     IF CL-TOTAL-PAID-AMT > ZEROS
 14214         MOVE 'Y' TO WS-ELIMINATION-SW
 14215         GO TO 3240-FIRST-PMT-DUE
 14216     ELSE
 14217        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 14218            NEXT SENTENCE
 14219        ELSE
 14220            GO TO 3240-FIRST-PMT-DUE.
 14221
 14222 3230-NEXT-PMT-DUE.
 14223
 14224     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 14225     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14226     IF NO-CONVERSION-ERROR
 14227         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 14228         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14229     ELSE
 14230         GO TO 3290-ERROR.
 14231
 14232 3240-FIRST-PMT-DUE.
 14233
 14234     IF CL-TOTAL-PAID-AMT > ZEROS
 14235         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 270
* EL156.cbl
 14236     ELSE
 14237        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14238            GO TO 3230-NEXT-PMT-DUE.
 14239
 14240     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14241         GO TO 3250-VERIFY-ELIMINATION.
 14242
 14243     ADD +30 TO WS-CDAYS.
 14244     MOVE 'Y' TO WS-ELIMINATION-SW.
 14245     GO TO 3230-NEXT-PMT-DUE.
 14246
 14247 3250-VERIFY-ELIMINATION.
 14248
 14249     IF ELIM-SATISFIED
 14250         GO TO 3260-END-CALC.
 14251
 14252     IF PI-PMTTYPE = '1'
 14253         MOVE ZEROS TO WS-CDAYS
 14254         GO TO 3260-END-CALC.
 14255
 14256     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14257         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14258     ELSE
 14259         IF CL-TOTAL-PAID-AMT > ZEROS
 14260             IF WS-SV-EPYFROM = LOW-VALUES
 14261                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14262             ELSE
 14263                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14264         ELSE
 14265             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14266
 14267     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14268     MOVE '1'                    TO DC-OPTION-CODE.
 14269     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14270     IF NO-CONVERSION-ERROR
 14271         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14272     ELSE
 14273         GO TO 3290-ERROR.
 14274
 14275     IF CL-TOTAL-PAID-AMT > ZEROS
 14276         MOVE WS-DAYS-OFF TO WS-CDAYS
 14277     ELSE
 14278         IF PI-BEN-DAYS > WS-DAYS-OFF
 14279             MOVE ZEROS TO WS-CDAYS
 14280         ELSE
 14281             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14282
 14283 3260-END-CALC.
 14284
 14285     MOVE WS-CDAYS TO PI-CDAYS.
 14286
 14287     IF PI-EDAYS = ZEROS
 14288         MOVE PI-CDAYS TO PI-EDAYS
 14289         MOVE AL-UNNON TO EDAYSA.
 14290
 14291     GO TO 3299-EXIT.
 14292
 14293 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 271
* EL156.cbl
 14294
 14295     MOVE ER-3528            TO EMI-ERROR.
 14296     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14297     MOVE -1                 TO CDAYSL.
 14298     MOVE AL-UNBON           TO CDAYSA.
 14299
 14300 3299-EXIT.
 14301     EXIT.
 14302
 14303 3300-BUMP-DATE.
 14304
 14305     IF WS-RESTORE-DUE-DAY
 14306         MOVE 'N'              TO WS-DUE-DAY-SW
 14307         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14308         ADD 1                 TO WS-PMT-DUE-MO
 14309         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14310         MOVE '4'              TO DC-OPTION-CODE
 14311         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14312         IF NO-CONVERSION-ERROR
 14313             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14314             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14315             GO TO 3399-EXIT
 14316         ELSE
 14317             MOVE '9'          TO DC-ERROR-CODE
 14318             GO TO 3399-EXIT.
 14319
 14320     IF (WS-PMT-DUE-MO = 1) AND
 14321        (WS-SAVE-DUE-DA > 28)
 14322           MOVE 'Y' TO WS-DUE-DAY-SW.
 14323
 14324     MOVE +0                 TO DC-ELAPSED-DAYS.
 14325     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14326     MOVE '6'                TO DC-OPTION-CODE.
 14327     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14328
 14329 3399-EXIT.
 14330     EXIT.
 14331
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 272
* EL156.cbl
 14333 3400-COMPUTE-EXPIRY.
 14334
 14335     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14336     MOVE +0                    TO DC-ELAPSED-DAYS
 14337                                   DC-ODD-DAYS-OVER.
 14338     MOVE '1'                   TO DC-END-OF-MONTH.
 14339     MOVE '6'                   TO DC-OPTION-CODE.
 14340
 14341     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14342         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14343     ELSE
 14344         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14345
 14346     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14347     IF NO-CONVERSION-ERROR
 14348         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14349     ELSE
 14350         GO TO 3390-CONTINUE.
 14351
 14352     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14353         GO TO 3390-CONTINUE.
 14354
 14355     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14356     MOVE '4'                    TO CNTL-REC-TYPE.
 14357     MOVE +0                     TO CNTL-SEQ-NO.
 14358     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14359     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14360     MOVE 'BENE'                 TO FILE-SWITCH.
 14361
 14362     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14363
 14364     IF NO-BENEFIT-FOUND
 14365         GO TO 3390-CONTINUE.
 14366
 14367     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 14368        IF (PI-OFFLINE = 'Y') OR
 14369           (PI-PMTTYPE = '7')
 14370           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14371                                     THRU 9870-EXIT
 14372           IF ERROR-ON-OUTPUT
 14373             MOVE -1                 TO ENTERPFL
 14374             MOVE AL-UANON           TO ENTERPFA
 14375             MOVE MAP-NAMEA          TO MAP-NAME
 14376             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14377             GO TO 8200-SEND-DATAONLY.
 14378
 14379     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14380        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14381        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14382          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14383          MOVE +0        TO DC-ELAPSED-DAYS
 14384          MOVE +1        TO DC-ELAPSED-MONTHS
 14385          MOVE 6         TO DC-OPTION-CODE
 14386          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14387          IF NO-CONVERSION-ERROR
 14388              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14389
 14390 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 273
* EL156.cbl
 14391
 14392      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14393         MOVE CM-AH-LOAN-EXPIRE-DT
 14394                                 TO DC-BIN-DATE-1
 14395      ELSE
 14396         MOVE CM-LF-LOAN-EXPIRE-DT
 14397                                 TO DC-BIN-DATE-1
 14398      END-IF
 14399
 14400      MOVE ' '                    TO DC-OPTION-CODE.
 14401      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14402      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14403      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14404
 14405 3499-EXIT.
 14406     EXIT.
 14407
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 274
* EL156.cbl
 14409
 14410 3600-CHECK-VERIFICATION.
 14411
 14412     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14413
 14414     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14415
 14416     IF PI-PAYEE-TYPE = 'I'
 14417        GO TO 3600-READ-TRAILER.
 14418
 14419     IF PI-PAYEE-TYPE = 'B'
 14420        ADD +10                  TO TRLR-SEQ-NO
 14421        GO TO 3600-READ-TRAILER.
 14422
 14423     IF PI-PAYEE-TYPE = 'A'
 14424        ADD +20                  TO TRLR-SEQ-NO
 14425        GO TO 3600-READ-TRAILER.
 14426
 14427     IF PI-PAYEE-TYPE = 'O'
 14428        ADD +50                  TO TRLR-SEQ-NO
 14429        GO TO 3600-READ-TRAILER.
 14430
 14431     IF PI-PAYEE-TYPE = 'Q'
 14432        ADD +60                  TO TRLR-SEQ-NO
 14433        GO TO 3600-READ-TRAILER.
 14434
 14435     IF PI-PAYEE-TYPE = 'P'
 14436        ADD +30                  TO TRLR-SEQ-NO
 14437        GO TO 3600-READ-TRAILER.
 14438
 14439     IF PI-PAYEE-TYPE = 'E'
 14440        ADD +40                  TO TRLR-SEQ-NO.
 14441
 14442 3600-READ-TRAILER.
 14443
 14444
 14445* EXEC CICS HANDLE CONDITION
 14446*         NOTFND(3600-CONTINUE)
 14447*    END-EXEC.
 14448*    MOVE '"$I                   ! - #00013666' TO DFHEIV0
 14449     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14450     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14451     MOVE X'2D20233030303133363636' TO DFHEIV0(25:11)
 14452     CALL 'kxdfhei1' USING DFHEIV0
 14453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14454
 14455
 14456     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14457
 14458 3600-CONTINUE.
 14459
 14460     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14461         GO TO 3600-AH-VERIFY
 14462     END-IF.
 14463
 14464     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14465       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14466         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 275
* EL156.cbl
 14467           MOVE ER-7576            TO EMI-ERROR
 14468           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14469           MOVE -1                 TO PAYEEL
 14470           MOVE AL-UABON           TO PAYEEA
 14471           GO TO 3600-EXIT
 14472         END-IF
 14473       END-IF
 14474     END-IF.
 14475
 14476     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14477     MOVE 1 TO WS-SUB2
 14478     MOVE SPACES TO WS-PAYEE-NAME
 14479     PERFORM VARYING WS-SUB FROM 1 BY 1
 14480             UNTIL WS-SUB > 30
 14481         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14482            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14483                 WS-PAYEE-NAME-X (WS-SUB2)
 14484            ADD +1 TO WS-SUB2
 14485         END-IF
 14486     END-PERFORM.
 14487
 14488     STRING CL-INSURED-1ST-NAME
 14489            CL-INSURED-MID-INIT
 14490            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14491     MOVE 1 TO WS-SUB2
 14492     MOVE SPACES TO WS-INSURED-NAME
 14493     PERFORM VARYING WS-SUB FROM 1 BY 1
 14494             UNTIL WS-SUB > 30
 14495         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14496            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14497                 WS-INSURED-NAME-X (WS-SUB2)
 14498            ADD +1 TO WS-SUB2
 14499         END-IF
 14500     END-PERFORM.
 14501
 14502     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14503        MOVE ER-7579            TO EMI-ERROR
 14504        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14505        MOVE -1                 TO PAYEEL
 14506        MOVE AL-UABON           TO PAYEEA
 14507     END-IF.
 14508
 14509     IF PI-PMTTYPE = '4'  AND
 14510        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14511        PI-PAYEE-TYPE <> 'I'
 14512          MOVE ER-7580          TO EMI-ERROR
 14513          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14514          MOVE -1               TO PAYEEL
 14515          MOVE AL-UABON         TO PAYEEA
 14516     END-IF.
 14517
 14518     GO TO 3600-EXIT.
 14519
 14520 3600-AH-VERIFY.
 14521
 14522     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14523        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14524           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 276
* EL156.cbl
 14525           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14526           MOVE -1                 TO PAYEEL
 14527           MOVE AL-UABON           TO PAYEEA
 14528        END-IF
 14529     END-IF.
 14530
 14531
 14532 3600-EXIT.
 14533     EXIT.
 14534
 14535 5000-UPDATE.
 14536
 14537     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14538
 14539     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14540
 14541     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14542        PI-OFFLINE = 'Y'
 14543        NEXT SENTENCE
 14544     ELSE
 14545        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14546
 14547*    IF PI-COMPANY-ID = 'CRI'
 14548*       IF PI-PMTTYPE = '1' OR  '2'
 14549*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14550*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14551*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14552
 14553*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14554*       IF PI-PMTTYPE = '1'
 14555*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14556*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14557
 14558     IF PI-PMTTYPE      = '2' AND
 14559        PI-SPLIT-PMT-SW = 'Y' AND
 14560        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14561          MOVE ER-3530                TO EMI-ERROR
 14562          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14563
 14564     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14565        AND (CL-CLAIM-TYPE = 'L')
 14566        IF PI-PMTTYPE = '2' OR '4'
 14567           IF PI-INT-AMT NOT = ZEROS
 14568              PERFORM 7110-BUILD-PMT-TRLR
 14569                                 THRU 7130-EXIT
 14570           ELSE
 14571              IF PI-PMTTYPE = '2'
 14572                 PERFORM 7140-BUILD-NOTE-TRLR
 14573                                 THRU 7170-EXIT
 14574              END-IF
 14575           END-IF
 14576        END-IF
 14577     END-IF
 14578*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14579*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14580*            MOVE 'N'                 TO  WS-LETTER-SW.
 14581
 14582*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 277
* EL156.cbl
 14583*        IF CL-NO-OF-PMTS-MADE = +1
 14584*                OR
 14585*           PI-PMTTYPE = '2'
 14586*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14587
 14588     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14589
 14590*    IF PI-COMPANY-ID = 'DMD'
 14591*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14592*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14593
 14594
 14595* EXEC CICS REWRITE
 14596*         DATASET('ELMSTR')
 14597*         FROM(CLAIM-MASTER)
 14598*     END-EXEC.
 14599     MOVE LENGTH OF
 14600      CLAIM-MASTER
 14601       TO DFHEIV11
 14602     MOVE 'ELMSTR' TO DFHEIV1
 14603*    MOVE '&& L                  %   #00013808' TO DFHEIV0
 14604     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14605     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14606     MOVE X'2020233030303133383038' TO DFHEIV0(25:11)
 14607     CALL 'kxdfhei1' USING DFHEIV0,
 14608           DFHEIV1,
 14609           CLAIM-MASTER,
 14610           DFHEIV11,
 14611           DFHEIV99
 14612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14613
 14614
 14615     IF WS-LETTER-SW = 'N'
 14616         GO TO 5000-END-UPDATE.
 14617
 14618 5000-GENERATE-AUTO-LETTER.
 14619
 14620
 14621* EXEC CICS LINK
 14622*        PROGRAM    (LINK-1523)
 14623*        COMMAREA   (W-1523-LINKDATA)
 14624*        LENGTH     (W-1523-COMM-LENGTH)
 14625*    END-EXEC.
 14626*    MOVE '."C                   (   #00013818' TO DFHEIV0
 14627     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14628     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14629     MOVE X'2020233030303133383138' TO DFHEIV0(25:11)
 14630     CALL 'kxdfhei1' USING DFHEIV0,
 14631           LINK-1523,
 14632           W-1523-LINKDATA,
 14633           W-1523-COMM-LENGTH,
 14634           DFHEIV99,
 14635           DFHEIV99,
 14636           DFHEIV99,
 14637           DFHEIV99
 14638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14639
 14640
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 278
* EL156.cbl
 14641     IF W-1523-FATAL-ERROR
 14642         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14643         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14644         MOVE ER-0802                TO  EMI-ERROR
 14645         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14646
 14647     IF W-1523-ERROR-CODE = 0191
 14648         MOVE ER-0803                TO  EMI-ERROR
 14649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14650
 14651     IF PI-COMPANY-ID      = 'HAN' AND
 14652        PI-PMTTYPE         = '1'   AND
 14653        PI-3RD-PARTY-SW    = 'Y'   AND
 14654        W-1523-FORM-NUMBER = 'EOB1'
 14655           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14656           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14657           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14658           GO TO 5000-GENERATE-AUTO-LETTER.
 14659
 14660 5000-END-UPDATE.
 14661
 14662     MOVE ER-0000                TO EMI-ERROR.
 14663     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14664     GO TO 7000-SHOW-CLAIM.
 14665
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 279
* EL156.cbl
 14667 5000-MOVE-NAME.
 14668     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14669     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14670     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14671
 14672 5000-EXIT.
 14673     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 280
* EL156.cbl
 14675 5300-CREATE-DMO.
 14676
 14677     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14678     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14679     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14680
 14681
 14682* EXEC CICS HANDLE CONDITION
 14683*         NOTFND   (5300-NOTE-NOT-FOUND)
 14684*    END-EXEC.
 14685*    MOVE '"$I                   ! . #00013864' TO DFHEIV0
 14686     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14687     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14688     MOVE X'2E20233030303133383634' TO DFHEIV0(25:11)
 14689     CALL 'kxdfhei1' USING DFHEIV0
 14690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14691
 14692
 14693
 14694* EXEC CICS READ
 14695*         DATASET('ERNOTE')
 14696*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14697*         RIDFLD (W-NOTE-KEY)
 14698*    END-EXEC.
 14699     MOVE 'ERNOTE' TO DFHEIV1
 14700*    MOVE '&"S        E          (   #00013868' TO DFHEIV0
 14701     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14702     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14703     MOVE X'2020233030303133383638' TO DFHEIV0(25:11)
 14704     CALL 'kxdfhei1' USING DFHEIV0,
 14705           DFHEIV1,
 14706           DFHEIV20,
 14707           DFHEIV99,
 14708           W-NOTE-KEY,
 14709           DFHEIV99,
 14710           DFHEIV99,
 14711           DFHEIV99
 14712     SET ADDRESS OF CERTIFICATE-NOTE TO
 14713         DFHEIV20
 14714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14715
 14716
 14717     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14718     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14719     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14720
 14721     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14722         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14723     ELSE
 14724         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14725
 14726     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14727     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14728     MOVE 'DLO006'               TO PGM-NAME.
 14729
 14730
 14731* EXEC CICS LINK
 14732*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 281
* EL156.cbl
 14733*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14734*        LENGTH     (DCT-RCRD-LENGTH)
 14735*    END-EXEC.
 14736*    MOVE '."C                   (   #00013887' TO DFHEIV0
 14737     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14738     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14739     MOVE X'2020233030303133383837' TO DFHEIV0(25:11)
 14740     CALL 'kxdfhei1' USING DFHEIV0,
 14741           PGM-NAME,
 14742           DCT-COMMUNICATION-AREA,
 14743           DCT-RCRD-LENGTH,
 14744           DFHEIV99,
 14745           DFHEIV99,
 14746           DFHEIV99,
 14747           DFHEIV99
 14748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14749
 14750
 14751     IF DCT-RETURN-CODE = 'OK'
 14752         GO TO 5300-CONT.
 14753
 14754     IF DCT-RETURN-CODE = '01' OR '02'
 14755         GO TO 5300-EXIT.
 14756
 14757     IF DCT-RETURN-CODE = '03'
 14758         MOVE ER-0951            TO EMI-ERROR
 14759         GO TO 5300-BAD-EXIT.
 14760
 14761     IF DCT-RETURN-CODE = '04'
 14762         MOVE ER-0946            TO EMI-ERROR
 14763         GO TO 5300-BAD-EXIT.
 14764
 14765     IF DCT-RETURN-CODE = '05'
 14766         MOVE ER-0947            TO EMI-ERROR
 14767         GO TO 5300-BAD-EXIT.
 14768
 14769     IF DCT-RETURN-CODE = '06'
 14770         MOVE ER-0921            TO EMI-ERROR
 14771         GO TO 5300-BAD-EXIT.
 14772
 14773     IF DCT-RETURN-CODE = '07'
 14774         MOVE ER-0849            TO EMI-ERROR
 14775         GO TO 5300-BAD-EXIT.
 14776
 14777     IF DCT-RETURN-CODE = '08'
 14778         MOVE ER-0948            TO EMI-ERROR
 14779         GO TO 5300-BAD-EXIT.
 14780
 14781     IF DCT-RETURN-CODE = 'N1'
 14782         MOVE ER-0950            TO EMI-ERROR
 14783         GO TO 5300-BAD-EXIT.
 14784
 14785     IF DCT-RETURN-CODE = 'E1'
 14786         MOVE ER-0974            TO EMI-ERROR
 14787         GO TO 5300-BAD-EXIT.
 14788
 14789     IF DCT-RETURN-CODE = 'E2'
 14790         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 282
* EL156.cbl
 14791         GO TO 5300-BAD-EXIT.
 14792
 14793     IF DCT-RETURN-CODE NOT = 'OK'
 14794         MOVE ER-0949            TO EMI-ERROR
 14795         GO TO 5300-BAD-EXIT.
 14796
 14797 5300-CONT.
 14798
 14799     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14800     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14801     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14802     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14803     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14804     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14805     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14806     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14807
 14808     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14809     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14810     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14811     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14812     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14813
 14814     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14815
 14816     IF PI-PMTTYPE = '2'
 14817         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14818         MOVE '4'                TO DM-CLAIM-STATUS
 14819     ELSE
 14820         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14821         MOVE '2'                TO DM-CLAIM-STATUS.
 14822
 14823     MOVE 'DLO025'               TO PGM-NAME.
 14824
 14825
 14826* EXEC CICS LINK
 14827*        PROGRAM    (PGM-NAME)
 14828*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14829*        LENGTH     (DM-DMO-LENGTH)
 14830*    END-EXEC.
 14831*    MOVE '."C                   (   #00013967' TO DFHEIV0
 14832     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14834     MOVE X'2020233030303133393637' TO DFHEIV0(25:11)
 14835     CALL 'kxdfhei1' USING DFHEIV0,
 14836           PGM-NAME,
 14837           DMO-COMMUNICATION-AREA,
 14838           DM-DMO-LENGTH,
 14839           DFHEIV99,
 14840           DFHEIV99,
 14841           DFHEIV99,
 14842           DFHEIV99
 14843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14844
 14845
 14846     IF DM-RETURN-CODE = 'OK'
 14847         GO TO 5300-EXIT.
 14848
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 283
* EL156.cbl
 14849     IF DM-RETURN-CODE = '01'
 14850         MOVE ER-8051            TO EMI-ERROR
 14851         GO TO 5300-BAD-EXIT.
 14852
 14853     IF DM-RETURN-CODE = '02'
 14854         MOVE ER-8052            TO EMI-ERROR
 14855         GO TO 5300-BAD-EXIT.
 14856
 14857     IF DM-RETURN-CODE = '03'
 14858         MOVE ER-8053            TO EMI-ERROR
 14859         GO TO 5300-BAD-EXIT.
 14860
 14861     IF DM-RETURN-CODE = '04'
 14862         MOVE ER-8054            TO EMI-ERROR
 14863         GO TO 5300-BAD-EXIT.
 14864
 14865     IF DM-RETURN-CODE = '05'
 14866         MOVE ER-8055            TO EMI-ERROR
 14867         GO TO 5300-BAD-EXIT.
 14868
 14869     IF DM-RETURN-CODE = '06'
 14870         MOVE ER-8056            TO EMI-ERROR
 14871         GO TO 5300-BAD-EXIT.
 14872
 14873     IF DM-RETURN-CODE = '07'
 14874         MOVE ER-8057            TO EMI-ERROR
 14875         GO TO 5300-BAD-EXIT.
 14876
 14877     IF DM-RETURN-CODE = '08'
 14878         MOVE ER-8058            TO EMI-ERROR
 14879         GO TO 5300-BAD-EXIT.
 14880
 14881     IF DM-RETURN-CODE = '09'
 14882         MOVE ER-8059            TO EMI-ERROR
 14883         GO TO 5300-BAD-EXIT.
 14884
 14885     IF DM-RETURN-CODE = '10'
 14886         MOVE ER-8060            TO EMI-ERROR
 14887         GO TO 5300-BAD-EXIT.
 14888
 14889     IF DM-RETURN-CODE = '11'
 14890         MOVE ER-8061            TO EMI-ERROR
 14891         GO TO 5300-BAD-EXIT.
 14892
 14893     IF DM-RETURN-CODE = '12'
 14894         MOVE ER-8062            TO EMI-ERROR
 14895         GO TO 5300-BAD-EXIT.
 14896
 14897     IF DM-RETURN-CODE = '13'
 14898         MOVE ER-8063            TO EMI-ERROR
 14899         GO TO 5300-BAD-EXIT.
 14900
 14901     IF DM-RETURN-CODE = '14'
 14902         MOVE ER-8064            TO EMI-ERROR
 14903         GO TO 5300-BAD-EXIT.
 14904
 14905     IF DM-RETURN-CODE = '15'
 14906         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 284
* EL156.cbl
 14907         GO TO 5300-BAD-EXIT.
 14908
 14909     IF DM-RETURN-CODE = '16'
 14910         MOVE ER-8154            TO EMI-ERROR
 14911         GO TO 5300-BAD-EXIT.
 14912
 14913     IF DM-RETURN-CODE = '17'
 14914         MOVE ER-8155            TO EMI-ERROR
 14915         GO TO 5300-BAD-EXIT.
 14916
 14917     IF DM-RETURN-CODE = 'N1'
 14918         MOVE ER-8152            TO EMI-ERROR
 14919         GO TO 5300-BAD-EXIT.
 14920
 14921     IF DM-RETURN-CODE = 'E1'
 14922         MOVE ER-8153            TO EMI-ERROR
 14923         GO TO 5300-BAD-EXIT.
 14924
 14925     MOVE ER-8066            TO EMI-ERROR.
 14926     GO TO 5300-BAD-EXIT.
 14927
 14928 5300-NOTE-NOT-FOUND.
 14929
 14930     MOVE ER-0954                TO EMI-ERROR.
 14931     GO TO 5300-BAD-EXIT.
 14932
 14933 5300-BAD-EXIT.
 14934
 14935* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14936*    MOVE '6"R                   !   #00014061' TO DFHEIV0
 14937     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14938     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14939     MOVE X'2020233030303134303631' TO DFHEIV0(25:11)
 14940     CALL 'kxdfhei1' USING DFHEIV0
 14941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14942
 14943     IF MAP-NAME = 'EL156A'
 14944         MOVE -1             TO ENTERPFL
 14945       ELSE
 14946         MOVE LOW-VALUES     TO EL156BI
 14947         MOVE -1             TO ENTPFBL.
 14948
 14949     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14950     GO TO 8200-SEND-DATAONLY.
 14951
 14952 5300-EXIT.
 14953     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 285
* EL156.cbl
 14955 5350-FORMAT-LAST-NAME-1ST.
 14956*****************************************************************
 14957*             M O V E   N A M E   R O U T I N E                 *
 14958*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14959*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14960*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14961*                  FIELD                   VALUE                *
 14962*           W-NAME-LAST    (CL15)      SMITH                    *
 14963*           W-NAME-FIRST   (CL15)      JOHN                     *
 14964*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14965*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14966*     CONTAIN                                                   *
 14967*                SMITH, JOHN ALLEN                              *
 14968*     OR                                                        *
 14969*                SMITH, JOHN A.                                 *
 14970*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14971*     COPYBOOK, ELCNWA.                                         *
 14972*****************************************************************.
 14973
 14974     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14975     MOVE ZERO                   TO  WS-NAME-SW.
 14976     SET NWA-INDEX               TO +1.
 14977
 14978     IF W-NAME-LAST   = SPACES AND
 14979        W-NAME-MIDDLE = SPACES
 14980         MOVE +1                 TO WS-NAME-SW.
 14981
 14982     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14983     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14984
 14985     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14986     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14987
 14988     SET NWA-INDEX UP BY +1.
 14989
 14990     IF W-NAME-MIDDLE NOT = SPACES
 14991         IF W-NAME-MIDDLE-2 = SPACES
 14992             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14993             SET NWA-INDEX UP BY +1
 14994             MOVE '.'            TO WS-NW (NWA-INDEX)
 14995             SET NWA-INDEX UP BY +2
 14996         ELSE
 14997             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14998             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14999
 15000 5350-EXIT.
 15001     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 286
* EL156.cbl
 15003 5360-MOVE-NAME.
 15004
 15005     IF WS-NAME-SW > +1
 15006         GO TO 5360-EXIT.
 15007
 15008     IF WS-NAME-WORK2 = SPACES
 15009         GO TO 5360-EXIT.
 15010
 15011     SET NWA-INDEX2            TO +1.
 15012     SET NWA-INDEX3            TO +2.
 15013
 15014 5360-MOVE-NAME-CYCLE.
 15015
 15016     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 15017
 15018     IF NWA-INDEX < +30
 15019         SET NWA-INDEX UP BY +1
 15020     ELSE
 15021         ADD +2                TO  WS-NAME-SW
 15022         GO TO 5360-EXIT.
 15023
 15024     IF NWA-INDEX2 < +20
 15025         SET NWA-INDEX3 UP BY +1
 15026         SET NWA-INDEX2 UP BY +1.
 15027
 15028     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 15029        WS-NW2 (NWA-INDEX3) = SPACES
 15030         IF WS-NAME-SW = ZERO
 15031             MOVE ','            TO  WS-NW (NWA-INDEX)
 15032             SET NWA-INDEX UP BY +2
 15033             MOVE +1             TO  WS-NAME-SW
 15034             GO TO 5360-EXIT
 15035         ELSE
 15036             GO TO 5360-EXIT.
 15037
 15038     GO TO 5360-MOVE-NAME-CYCLE.
 15039
 15040 5360-EXIT.
 15041     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 287
* EL156.cbl
 15043 6000-BUILD-SCREEN-B.
 15044     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15045     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15046     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15047     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15048
 15049     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 15050
 15051 6050-BUILD-SCREEN.
 15052     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 15053     MOVE LOW-VALUES             TO EL156BI.
 15054     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15055
 15056     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 15057
 15058     IF PI-PAYEE-TYPE = 'I'
 15059        GO TO 6060-READ-TRAILER.
 15060
 15061     IF PI-PAYEE-TYPE = 'B'
 15062        ADD +10                  TO TRLR-SEQ-NO
 15063        GO TO 6060-READ-TRAILER.
 15064
 15065     IF PI-PAYEE-TYPE = 'A'
 15066        ADD +20                  TO TRLR-SEQ-NO
 15067        GO TO 6060-READ-TRAILER.
 15068
 15069     IF PI-PAYEE-TYPE = 'O'
 15070        ADD +50                  TO TRLR-SEQ-NO
 15071        GO TO 6060-READ-TRAILER.
 15072
 15073     IF PI-PAYEE-TYPE = 'Q'
 15074        ADD +60                  TO TRLR-SEQ-NO
 15075        GO TO 6060-READ-TRAILER.
 15076
 15077     IF PI-PAYEE-TYPE = 'P'
 15078        ADD +30                  TO TRLR-SEQ-NO
 15079        GO TO 6060-READ-TRAILER.
 15080
 15081     IF PI-PAYEE-TYPE = 'E'
 15082        ADD +40                  TO TRLR-SEQ-NO.
 15083
 15084 6060-READ-TRAILER.
 15085
 15086     IF PI-PAYEE-TYPE    = 'A' AND
 15087        PI-PAYEE-SEQ-NUM = 0
 15088          GO TO 6061-READ-ACCOUNT.
 15089
 15090     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 15091        (PI-PAYEE-TYPE    = 'B')             AND
 15092        (PI-PAYEE-SEQ-NUM = 9)
 15093          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15094          IF BENE-FOUND-SW = 'N'
 15095            GO TO 6065-NOT-FOUND
 15096          ELSE
 15097            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15098            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15099            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15100*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 288
* EL156.cbl
 15101            STRING BE-CITY ' ' BE-STATE
 15102               DELIMITED BY '  ' INTO CITYSTBO
 15103            END-STRING
 15104            MOVE BE-ZIP-CODE       TO ZIPBO
 15105            GO TO 6061-READ-ACCOUNT.
 15106
 15107     IF PI-PAYEE-TYPE    = 'B' AND
 15108        PI-PAYEE-SEQ-NUM = 0
 15109          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15110          IF BENE-FOUND-SW = 'N'
 15111            GO TO 6065-NOT-FOUND
 15112          ELSE
 15113            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15114            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15115            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15116*           MOVE BE-CITY-STATE     TO CITYSTBO
 15117            STRING BE-CITY ' ' BE-STATE
 15118               DELIMITED BY '  ' INTO CITYSTBO
 15119            END-STRING
 15120            MOVE BE-ZIP-CODE       TO ZIPBO
 15121            if be-ach-yes-or-no = 'Y'
 15122               move 'Y'          to pi-ach-payment
 15123            else
 15124               move 'N'          to pi-ach-payment
 15125            end-if
 15126            GO TO 6061-READ-ACCOUNT.
 15127
 15128
 15129* EXEC CICS HANDLE CONDITION
 15130*         NOTFND(6065-NOT-FOUND)
 15131*     END-EXEC.
 15132*    MOVE '"$I                   ! / #00014247' TO DFHEIV0
 15133     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15134     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15135     MOVE X'2F20233030303134323437' TO DFHEIV0(25:11)
 15136     CALL 'kxdfhei1' USING DFHEIV0
 15137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15138
 15139
 15140     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15141
 15142     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 15143     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 15144     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 15145     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 15146*    MOVE AT-CITY-STATE          TO CITYSTBO.
 15147     STRING AT-CITY ' ' AT-STATE
 15148        DELIMITED BY '  ' INTO CITYSTBO
 15149     END-STRING
 15150     MOVE AT-ZIP-CODE            TO ZIPBO.
 15151
 15152 6061-READ-ACCOUNT.
 15153
 15154* EXEC CICS HANDLE CONDITION
 15155*         NOTFND(6068-ACCT-NOT-FND)
 15156*     END-EXEC.
 15157*    MOVE '"$I                   ! 0 #00014264' TO DFHEIV0
 15158     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 289
* EL156.cbl
 15159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15160     MOVE X'3020233030303134323634' TO DFHEIV0(25:11)
 15161     CALL 'kxdfhei1' USING DFHEIV0
 15162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15163
 15164
 15165
 15166* EXEC CICS READ
 15167*         DATASET('ERACCT')
 15168*         SET    (ADDRESS OF ACCOUNT-MASTER)
 15169*         RIDFLD (PI-ACCT-KEY)
 15170*     END-EXEC.
 15171     MOVE 'ERACCT' TO DFHEIV1
 15172*    MOVE '&"S        E          (   #00014268' TO DFHEIV0
 15173     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15175     MOVE X'2020233030303134323638' TO DFHEIV0(25:11)
 15176     CALL 'kxdfhei1' USING DFHEIV0,
 15177           DFHEIV1,
 15178           DFHEIV20,
 15179           DFHEIV99,
 15180           PI-ACCT-KEY,
 15181           DFHEIV99,
 15182           DFHEIV99,
 15183           DFHEIV99
 15184     SET ADDRESS OF ACCOUNT-MASTER TO
 15185         DFHEIV20
 15186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15187
 15188
 15189     MOVE AM-CARRIER             TO ACARRBO.
 15190     MOVE AM-GROUPING            TO GROUPBO.
 15191     MOVE AM-STATE               TO STATEBO.
 15192     MOVE AM-ACCOUNT             TO ACCTBO.
 15193     MOVE AM-NAME                TO ACCTNMBO.
 15194
 15195     IF PI-PAYEE-TYPE = 'A' AND
 15196        PI-PAYEE-SEQ-NUM = 0
 15197          MOVE AM-NAME             TO NAMEBO
 15198                                      PI-PAYEE-NAME
 15199          MOVE AM-ADDRS            TO ADDR1BO
 15200          MOVE SPACES              TO ADDR2BO
 15201*         MOVE AM-CITY             TO CITYSTBO
 15202          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 15203             DELIMITED BY '  ' INTO CITYSTBO
 15204          END-STRING
 15205          MOVE AM-ZIP-PRIME        TO WS-ZIP
 15206          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 15207          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 15208          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 15209
 15210***  We don't really need the code below because we don't do the
 15211***  AK thing anymore.  However, we may have a state special
 15212***  of some sort in the future so why not just leave it??
 15213     IF CITYSTBO EQUAL SPACES
 15214         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15215         GO TO 6070-FORMAT-DATA
 15216     END-IF.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 290
* EL156.cbl
 15217
 15218     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 15219     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 15220     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 15221     PERFORM VARYING WS-SUB FROM 30 BY -1
 15222          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 15223        IF WS-END-SUB = 0  AND
 15224           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 15225              OR LOW-VALUES  OR '.')
 15226            CONTINUE
 15227        ELSE
 15228            IF WS-END-SUB = 0
 15229                MOVE WS-SUB TO WS-END-SUB
 15230            ELSE
 15231                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 15232                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 15233                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15234                END-IF
 15235            END-IF
 15236        END-IF
 15237        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15238            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15239            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15240        END-IF
 15241     END-PERFORM.
 15242
 15243     IF WS-BEG-SUB > 0
 15244         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15245         IF WS-STATE-LENGTH = 2
 15246             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15247                  TO PI-CHECK-STATE-FOR-AK
 15248         ELSE
 15249             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15250                'ALASKA'
 15251                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15252             ELSE
 15253                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15254             END-IF
 15255         END-IF
 15256     ELSE
 15257         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15258     END-IF.
 15259
 15260     GO TO 6070-FORMAT-DATA.
 15261
 15262 6065-NOT-FOUND.
 15263     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15264     GO TO 6061-READ-ACCOUNT.
 15265
 15266 6068-ACCT-NOT-FND.
 15267     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15268
 15269 6070-FORMAT-DATA.
 15270     IF PI-HOLDTIL = ZEROS
 15271        MOVE SAVE-DATE           TO PAYDTBI
 15272       ELSE
 15273        MOVE PI-HOLDTIL          TO PAYDTBO
 15274        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 291
* EL156.cbl
 15275
 15276     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15277     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15278
 15279     IF EIBAID = DFHPF3 OR DFHPF4
 15280        NEXT SENTENCE
 15281     ELSE
 15282       GO TO 6071-CONTINUE.
 15283
 15284     MOVE PI-EPYFROM          TO PYFROMBO.
 15285     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15286
 15287     IF NOT PI-USES-PAID-TO
 15288        MOVE PI-EPYTHRU          TO PYTHRUBO
 15289        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15290     ELSE
 15291        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15292        MOVE '4'              TO DC-OPTION-CODE
 15293        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15294        IF NO-CONVERSION-ERROR
 15295           MOVE +1            TO DC-ELAPSED-DAYS
 15296           MOVE +0            TO DC-ELAPSED-MONTHS
 15297           MOVE '6'           TO DC-OPTION-CODE
 15298           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15299           IF NO-CONVERSION-ERROR
 15300              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15301
 15302     MOVE PI-EDAYS            TO DAYSBO.
 15303     MOVE PI-EPYAMT           TO PAYAMTBO.
 15304     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15305        IF PI-INT-AMT > ZEROS
 15306           MOVE PI-INT-AMT       TO INTAMTBO
 15307        END-IF
 15308     END-IF
 15309     GO TO 6072-SET-TYPE.
 15310
 15311 6071-CONTINUE.
 15312
 15313     IF PI-CPYFROM NOT = LOW-VALUES
 15314        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15315        MOVE SPACES              TO DC-OPTION-CODE
 15316        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15317        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15318
 15319     IF PI-CPYTHRU NOT = LOW-VALUES
 15320        IF NOT PI-USES-PAID-TO
 15321           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15322           MOVE SPACES             TO DC-OPTION-CODE
 15323           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15324           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15325        ELSE
 15326           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15327           MOVE '6'                TO DC-OPTION-CODE
 15328           MOVE +1                 TO DC-ELAPSED-DAYS
 15329           MOVE +0                 TO DC-ELAPSED-MONTHS
 15330           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15331           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15332
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 292
* EL156.cbl
 15333     MOVE PI-CDAYS               TO DAYSBO.
 15334     MOVE PI-CPYAMT              TO PAYAMTBO.
 15335     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15336        IF PI-INT-AMT > ZEROS
 15337           MOVE PI-INT-AMT       TO INTAMTBO
 15338        END-IF
 15339     END-IF
 15340     .
 15341 6072-SET-TYPE.
 15342     IF PI-PMTTYPE = '1'
 15343        MOVE 'PARTIAL'           TO PAYTYPBO.
 15344
 15345     IF PI-PMTTYPE = '2'
 15346        MOVE 'FINAL'             TO PAYTYPBO.
 15347
 15348     IF PI-PMTTYPE = '3'
 15349        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15350
 15351     IF PI-PMTTYPE = '4'
 15352        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15353
 15354     IF PI-PMTTYPE = '5'
 15355        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15356
 15357     IF PI-PMTTYPE = '6'
 15358        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15359
 15360     IF PI-PROV-PMT
 15361        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15362
 15363     IF PI-ECHECKNO NOT = SPACES
 15364        MOVE PI-ECHECKNO         TO CKNUMBO
 15365     ELSE
 15366        MOVE PI-CCHECKNO         TO CKNUMBO.
 15367
 15368     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 15369        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15370        MOVE +91                 TO  TRLR-SEQ-NO
 15371
 15372* EXEC CICS READ
 15373*           DATASET  ('ELTRLR')
 15374*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15375*           RIDFLD   (ELTRLR-KEY)
 15376*           RESP     (WS-RESPONSE)
 15377*       END-EXEC
 15378     MOVE 'ELTRLR' TO DFHEIV1
 15379*    MOVE '&"S        E          (  N#00014456' TO DFHEIV0
 15380     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15381     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15382     MOVE X'204E233030303134343536' TO DFHEIV0(25:11)
 15383     CALL 'kxdfhei1' USING DFHEIV0,
 15384           DFHEIV1,
 15385           DFHEIV20,
 15386           DFHEIV99,
 15387           ELTRLR-KEY,
 15388           DFHEIV99,
 15389           DFHEIV99,
 15390           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 293
* EL156.cbl
 15391     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15392         DFHEIV20
 15393     MOVE EIBRESP  TO WS-RESPONSE
 15394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15395
 15396        IF WS-RESP-NORMAL
 15397           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15398        ELSE
 15399           MOVE SPACES           TO  LOANNBO
 15400        END-IF
 15401     END-IF
 15402
 15403*       MOVE PI-LOAN-NO          TO LOANNBO
 15404
 15405     IF CKNUMBO = SPACES
 15406         MOVE SPACES             TO CKNUMHDO.
 15407
 15408     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15409     MOVE CL-CARRIER             TO CARRBO.
 15410     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15411     MOVE CL-CERT-SFX            TO SUFXBO.
 15412
 15413     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15414        EVALUATE CL-CLAIM-TYPE
 15415           WHEN 'I'
 15416              MOVE '  IU  '      TO CLMTYPBO
 15417           WHEN 'G'
 15418              MOVE ' GAP  '      TO CLMTYPBO
 15419           WHEN 'F'
 15420              MOVE ' FMLA '      TO CLMTYPBO
 15421           WHEN OTHER
 15422              MOVE PI-AH-OVERRIDE-L6
 15423                                 TO CLMTYPBO
 15424        END-EVALUATE
 15425        MOVE ZEROS               TO UNDISBO
 15426*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15427        IF PI-PMTTYPE = '5' OR '6'
 15428           GO TO 6073-GET-NOTIFY-DATA
 15429        ELSE
 15430           MOVE PI-DAILY-RATE    TO RATEBO
 15431           GO TO 6073-GET-NOTIFY-DATA.
 15432
 15433     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15434
 15435     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15436        MOVE ZEROS               TO UNDISBO
 15437     ELSE
 15438        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15439
 15440 6073-GET-NOTIFY-DATA.
 15441
 15442     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15443
 15444     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15445         MOVE SPACES             TO  NAMEB2O
 15446                                     ADDR1B2O
 15447                                     ADDR2B2O
 15448                                     CITYST2O
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 294
* EL156.cbl
 15449                                     AGTHDGO
 15450         MOVE ZEROS              TO  ZIPB2O
 15451         GO TO 6080-SET-INCURRED.
 15452
 15453     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15454     MOVE +29                    TO  TRLR-SEQ-NO.
 15455
 15456
 15457* EXEC CICS HANDLE CONDITION
 15458*        NOTFND   (6074-GET-COMP-DATA)
 15459*    END-EXEC.
 15460*    MOVE '"$I                   ! 1 #00014523' TO DFHEIV0
 15461     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15462     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15463     MOVE X'3120233030303134353233' TO DFHEIV0(25:11)
 15464     CALL 'kxdfhei1' USING DFHEIV0
 15465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15466
 15467
 15468     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15469
 15470     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15471     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15472     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15473*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15474     STRING AT-CITY ' ' AT-STATE
 15475        DELIMITED BY '  ' INTO CITYST2O
 15476     END-STRING
 15477     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15478     GO TO 6080-SET-INCURRED.
 15479
 15480 6074-GET-COMP-DATA.
 15481
 15482     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15483         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15484
 15485     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15486         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15487                                         ADDR1B2O
 15488                                         ADDR2B2O
 15489                                         CITYST2O
 15490         MOVE ZEROS                  TO  ZIPB2O
 15491         GO TO 6080-SET-INCURRED.
 15492
 15493     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15494     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15495     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15496     MOVE AM-GROUPING            TO  COMP-GROUP.
 15497     MOVE 'A'                    TO  COMP-TYPE.
 15498     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15499                                 TO  COMP-FIN-RESP.
 15500
 15501     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15502         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15503                                       'G' OR 'B' or 'S'
 15504             MOVE 'G'            TO  COMP-TYPE
 15505             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15506         ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 295
* EL156.cbl
 15507             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15508                                 TO  COMP-ACCOUNT
 15509     ELSE
 15510         MOVE 'G'                TO  COMP-TYPE
 15511         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15512
 15513     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15514
 15515     IF COMP-REC-FOUND
 15516         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15517         MOVE CO-ADDR-1          TO  ADDR1B2O
 15518         MOVE CO-ADDR-2          TO  ADDR2B2O
 15519*        MOVE CO-ADDR-3          TO  CITYST2O
 15520         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15521            DELIMITED BY '  ' INTO CITYST2O
 15522         END-STRING
 15523         MOVE CO-ZIP             TO  ZIPB2O
 15524     ELSE
 15525         MOVE 'NO COMP ADDRESS AVAILABLE'
 15526                                 TO  NAMEB2O
 15527                                     ADDR1B2O
 15528                                     ADDR2B2O
 15529                                     CITYST2O
 15530         MOVE ZEROS               TO ZIPB2O.
 15531
 15532 6080-SET-INCURRED.
 15533     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15534     MOVE SPACES                 TO DC-OPTION-CODE.
 15535     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15536     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15537     MOVE PI-PROCESSOR-ID        TO BYBO.
 15538     MOVE MAP-NAMEB              TO MAP-NAME.
 15539     MOVE 'C'                    TO PI-PASS-SW.
 15540     MOVE EIBAID                 TO PI-PFKEY-USED.
 15541     MOVE -1                     TO ENTPFBL.
 15542     GO TO 8100-SEND-INITIAL-MAP.
 15543
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 296
* EL156.cbl
 15545 6100-BUILD-PAYMENT-TRAILER.
 15546
 15547     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15548     MOVE '6'                    TO CNTL-REC-TYPE.
 15549
 15550     IF CONTROL-IS-ACTUAL-CARRIER
 15551         MOVE PI-CARRIER         TO WS-CARR
 15552     ELSE
 15553         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15554
 15555     IF PI-COMPANY-ID = 'FIA'
 15556         MOVE PI-CARRIER         TO  WS-CARR.
 15557
 15558     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15559     MOVE 0                      TO CNTL-SEQ-NO.
 15560     MOVE 'CARR'                 TO FILE-SWITCH.
 15561
 15562     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15563
 15564     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15565         IF PI-OFFLINE     = 'Y' AND
 15566            PI-ECHECKNO-CR = 'CR'
 15567              GO TO 6110-READ-CONTROL
 15568         ELSE
 15569            IF PI-CASH = 'N'
 15570                GO TO 6110-READ-CONTROL.
 15571
 15572     IF CHECK-NO-MANUAL    OR
 15573        CHECK-NO-AT-PRINT  OR
 15574        PI-OFFLINE = 'Y'
 15575          GO TO 6130-BUILD-TRAILER.
 15576     IF PI-COMPANY-ID = 'FIA'
 15577         NEXT SENTENCE
 15578     ELSE
 15579         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15580             GO TO 6110-READ-CONTROL.
 15581
 15582     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15583
 15584     IF CHECK-CNT-RESET-VALUE
 15585        MOVE +1                  TO CF-CHECK-COUNTER
 15586     ELSE
 15587        ADD +1                   TO CF-CHECK-COUNTER.
 15588
 15589     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15590
 15591     IF CHECK-NO-CARR-SEQ
 15592        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15593
 15594     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15595
 15596     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15597     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15598        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15599         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15600         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15601            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15602         MOVE WRK-NEXT-AUDIT-CHK-NO TO
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 297
* EL156.cbl
 15603                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15604     END-IF.
 15605
 15606     GO TO 6120-REWRITE.
 15607
 15608 6105-STATE-CHECK-NUMBER.
 15609     IF CHECK-NO-MANUAL    OR
 15610        CHECK-NO-AT-PRINT  OR
 15611        PI-OFFLINE = 'Y'
 15612           GO TO 6130-BUILD-TRAILER
 15613     END-IF.
 15614
 15615     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15616     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15617     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15618     MOVE '3'                TO CNTL-REC-TYPE.
 15619     MOVE +0                 TO CNTL-SEQ-NO.
 15620     MOVE 'STAT'             TO FILE-SWITCH.
 15621     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15622
 15623     IF CF-ST-CHECK-CNT-RESET
 15624         MOVE +1             TO CF-ST-CHECK-COUNTER
 15625     ELSE
 15626         ADD +1              TO CF-ST-CHECK-COUNTER
 15627     END-IF.
 15628
 15629     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15630     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15631     GO TO 6120-REWRITE.
 15632
 15633 6110-READ-CONTROL.
 15634     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15635     MOVE '1'                    TO CNTL-REC-TYPE.
 15636     MOVE SPACES                 TO CNTL-ACCESS.
 15637     MOVE 0                      TO CNTL-SEQ-NO.
 15638
 15639     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15640
 15641     IF CO-CHECK-COUNT-RESET
 15642        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15643     ELSE
 15644        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15645
 15646     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15647
 15648     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15649         IF PI-OFFLINE     = 'Y'  AND
 15650            PI-ECHECKNO-CR = 'CR'
 15651              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15652              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15653              MOVE AL-UANON           TO CHECKNOA
 15654              GO TO 6120-REWRITE
 15655         ELSE
 15656         IF PI-CASH = 'N'
 15657             MOVE 'N'                TO PI-ECHECKNO-N
 15658             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15659             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15660             MOVE AL-UANON           TO CHECKNOA
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 298
* EL156.cbl
 15661             GO TO 6120-REWRITE.
 15662
 15663     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15664
 15665 6120-REWRITE.
 15666
 15667* EXEC CICS REWRITE
 15668*         DATASET('ELCNTL')
 15669*         FROM(CONTROL-FILE)
 15670*     END-EXEC.
 15671     MOVE LENGTH OF
 15672      CONTROL-FILE
 15673       TO DFHEIV11
 15674     MOVE 'ELCNTL' TO DFHEIV1
 15675*    MOVE '&& L                  %   #00014725' TO DFHEIV0
 15676     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15677     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15678     MOVE X'2020233030303134373235' TO DFHEIV0(25:11)
 15679     CALL 'kxdfhei1' USING DFHEIV0,
 15680           DFHEIV1,
 15681           CONTROL-FILE,
 15682           DFHEIV11,
 15683           DFHEIV99
 15684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15685
 15686
 15687     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15688
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 299
* EL156.cbl
 15690 6130-BUILD-TRAILER.
 15691
 15692
 15693* EXEC CICS GETMAIN
 15694*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15695*         LENGTH    (200)
 15696*         INITIMG   (GETMAIN-SPACE)
 15697*     END-EXEC.
 15698     MOVE 200
 15699       TO DFHEIV11
 15700*    MOVE ',"IL                  $   #00014735' TO DFHEIV0
 15701     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15702     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15703     MOVE X'2020233030303134373335' TO DFHEIV0(25:11)
 15704     CALL 'kxdfhei1' USING DFHEIV0,
 15705           DFHEIV20,
 15706           DFHEIV11,
 15707           GETMAIN-SPACE
 15708     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15709         DFHEIV20
 15710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15711
 15712
 15713     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15714                                    AT-PREV-PAID-THRU-DT.
 15715     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15716     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15717     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15718     MOVE 'AT'                   TO AT-RECORD-ID.
 15719     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15720
 15721     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15722        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15723           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15724     ELSE
 15725           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15726           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15727
 15728     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15729         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15730             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15731             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15732           ELSE
 15733             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15734             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15735
 15736     MOVE '2'                    TO AT-TRAILER-TYPE.
 15737     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15738                                    AT-PAYMENT-LAST-MAINT-DT.
 15739     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15740                                    AT-PAYMENT-LAST-UPDATED-BY.
 15741     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15742     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15743     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15744     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15745
 15746     IF PI-PMT-APPROVED
 15747        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 300
* EL156.cbl
 15748           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15749
 15750     IF PI-PFKEY-USED = DFHPF5
 15751        GO TO 6140-PF5-ENTERED.
 15752
 15753     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15754     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15755
 15756     IF PI-AIG-SPECIAL-BENEFIT
 15757         IF WS-1ST-SPECIAL-PMT
 15758             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15759             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15760                                        AT-AMOUNT-PAID
 15761         ELSE
 15762             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15763
 15764     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15765
 15766     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15767     MOVE '4'                    TO DC-OPTION-CODE.
 15768     PERFORM 9700-LINK-DATE-CONVERT.
 15769
 15770     IF DATE-CONVERSION-ERROR
 15771        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15772     ELSE
 15773        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15774
 15775     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15776     MOVE '4'                    TO DC-OPTION-CODE.
 15777     PERFORM 9700-LINK-DATE-CONVERT.
 15778
 15779     IF DATE-CONVERSION-ERROR
 15780        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15781     ELSE
 15782        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15783
 15784     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD
 15785     move pi-ach-payment         to at-ach-payment
 15786     GO TO 6150-FINISH-MOVE.
 15787
 15788 6140-PF5-ENTERED.
 15789     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15790     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15791
 15792     IF PI-AIG-SPECIAL-BENEFIT
 15793         IF WS-1ST-SPECIAL-PMT
 15794             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15795             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15796                                        AT-AMOUNT-PAID
 15797         ELSE
 15798             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15799
 15800     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15801     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15802     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15803
 15804 6150-FINISH-MOVE.
 15805
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 301
* EL156.cbl
 15806     IF PI-ECHECKNO = SPACES
 15807         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15808     ELSE
 15809         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15810
 15811     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15812     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15813
 15814*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15815*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15816
 15817     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15818         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15819
 15820     IF PI-OFFLINE = 'N'
 15821        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15822        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15823     ELSE
 15824        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15825        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15826
 15827     move pi-ach-payment         to at-ach-payment
 15828     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15829
 15830     IF WS-2ND-SPECIAL-PMT
 15831         MOVE 'Y'                TO AT-CASH-PAYMENT
 15832         MOVE SPACES             TO AT-CHECK-NO
 15833         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15834         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15835         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15836         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15837
 15838     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15839                                    AT-TO-BE-WRITTEN-DT.
 15840
 15841     IF PI-HOLDTIL NOT = ZEROS
 15842        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15843        MOVE '4'                 TO DC-OPTION-CODE
 15844        PERFORM 9700-LINK-DATE-CONVERT
 15845        IF PI-OFFLINE = 'N'
 15846           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15847        ELSE
 15848           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15849
 15850     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15851     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15852                                    AT-CHECK-QUE-SEQUENCE.
 15853
 15854     IF PI-PFKEY-USED = DFHPF4
 15855        MOVE '1'                 TO AT-FORCE-CONTROL.
 15856
 15857     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15858        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15859        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15860        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15861
 15862     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15863                                    AT-VOID-SELECT-DT
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 302
* EL156.cbl
 15864                                    AT-VOID-ACCEPT-DT
 15865                                    AT-VOID-DT.
 15866     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 15867        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15868        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15869        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15870        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15871     ELSE
 15872        MOVE ZEROS               TO AT-DAILY-RATE
 15873                                    AT-ELIMINATION-DAYS
 15874        MOVE SPACES              TO AT-BENEFIT-TYPE
 15875     END-IF
 15876     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15877     MOVE '4'                    TO DC-OPTION-CODE.
 15878     PERFORM 9700-LINK-DATE-CONVERT.
 15879     IF DATE-CONVERSION-ERROR
 15880         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15881     ELSE
 15882         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15883     END-IF.
 15884     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15885     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15886     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15887     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15888     IF (PI-REAUDIT-NEEDED = 'Y')
 15889        or (pi-max-ext-used = 'Y')
 15890        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15891         PERFORM 6155-READ-CONTROL
 15892         PERFORM 6157-SET-APP-LEVEL
 15893         IF AT-APPROVAL-LEVEL-REQD < '4'
 15894            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15895         END-IF
 15896         MOVE 'Y' TO WS-NEED-APPROVAL
 15897         GO TO 6170-WRITE
 15898     END-IF.
 15899*******************************************************
 15900     IF NOT PI-PMT-GRADUATED
 15901         GO TO 6170-WRITE.
 15902     PERFORM 6155-READ-CONTROL.
 15903
 15904     IF PAID-FOR-LIFE
 15905         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15906             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15907                                     WS-PMT-APPROVAL-SW
 15908             GO TO 6170-WRITE.
 15909
 15910*05999      IF PAID-FOR-AH
 15911     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15912         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15913             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15914                                     WS-PMT-APPROVAL-SW
 15915             GO TO 6170-WRITE.
 15916
 15917     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15918
 15919     PERFORM 6157-SET-APP-LEVEL.
 15920
 15921     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 303
* EL156.cbl
 15922
 15923     IF NOT PI-PMT-GRADUATED
 15924         GO TO 6170-WRITE.
 15925
 15926
 15927* EXEC CICS HANDLE CONDITION
 15928*        NOTFND   (6170-WRITE)
 15929*    END-EXEC.
 15930*    MOVE '"$I                   ! 2 #00014954' TO DFHEIV0
 15931     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15932     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15933     MOVE X'3220233030303134393534' TO DFHEIV0(25:11)
 15934     CALL 'kxdfhei1' USING DFHEIV0
 15935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15936
 15937
 15938     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15939     MOVE '2'                    TO CNTL-REC-TYPE.
 15940     MOVE +0                     TO CNTL-SEQ-NO.
 15941     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15942
 15943
 15944* EXEC CICS READ
 15945*         DATASET  ('ELCNTL')
 15946*         SET      (ADDRESS OF CONTROL-FILE)
 15947*         RIDFLD   (ELCNTL-KEY)
 15948*    END-EXEC.
 15949     MOVE 'ELCNTL' TO DFHEIV1
 15950*    MOVE '&"S        E          (   #00014963' TO DFHEIV0
 15951     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15953     MOVE X'2020233030303134393633' TO DFHEIV0(25:11)
 15954     CALL 'kxdfhei1' USING DFHEIV0,
 15955           DFHEIV1,
 15956           DFHEIV20,
 15957           DFHEIV99,
 15958           ELCNTL-KEY,
 15959           DFHEIV99,
 15960           DFHEIV99,
 15961           DFHEIV99
 15962     SET ADDRESS OF CONTROL-FILE TO
 15963         DFHEIV20
 15964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15965
 15966
 15967     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15968
 15969     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15970                         OR '4' OR '5'
 15971         NEXT SENTENCE
 15972     ELSE
 15973         MOVE 'Y' TO WS-NEED-APPROVAL
 15974         GO TO 6170-WRITE.
 15975
 15976     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15977         MOVE 'Y' TO WS-NEED-APPROVAL
 15978         IF WS-APPROVAL-LEVEL = '1'
 15979             MOVE '2'        TO  AT-APPROVED-LEVEL
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 304
* EL156.cbl
 15980                            WS-SAVE-APPROVED-LEVEL
 15981             GO TO 6170-WRITE
 15982         ELSE
 15983             IF WS-APPROVAL-LEVEL = '2'
 15984                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15985                                WS-SAVE-APPROVED-LEVEL
 15986                 GO TO 6170-WRITE
 15987             ELSE IF WS-APPROVAL-LEVEL = '3'
 15988                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15989                                WS-SAVE-APPROVED-LEVEL
 15990                 GO TO 6170-WRITE
 15991             ELSE IF WS-APPROVAL-LEVEL = '4'
 15992                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15993                                WS-SAVE-APPROVED-LEVEL
 15994                 GO TO 6170-WRITE.
 15995
 15996     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15997                             WS-PMT-APPROVAL-SW.
 15998     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15999                             AT-APPROVAL-LEVEL-REQD.
 16000
 16001*******************************************************
 16002 6155-READ-CONTROL.
 16003     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16004     MOVE '1'                    TO CNTL-REC-TYPE.
 16005     MOVE SPACES                 TO CNTL-ACCESS.
 16006     MOVE +0                     TO CNTL-SEQ-NO.
 16007     MOVE 'COMP'                 TO FILE-SWITCH.
 16008
 16009     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 16010 6157-SET-APP-LEVEL.
 16011******A&H Limits are set as a monthly payment.  Calculate the mont
 16012******equivalent of the amount paid today
 16013     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 16014        PI-SAVE-ODD-DAYS-OVER > 0
 16015           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 16016                               / 30) + PI-SAVE-ELAPSED-MONTHS
 16017           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 16018                                  WS-CALC-PMT-MONTHS
 16019     ELSE
 16020           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 16021     END-IF.
 16022*06007      IF ((PAID-FOR-AH) AND
 16023     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16024           OR PAID-FOR-FAM) AND
 16025*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16026        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 16027              OR
 16028        ((PAID-FOR-LIFE) AND
 16029        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16030            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16031       ELSE
 16032*06014      IF ((PAID-FOR-AH)  AND
 16033         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16034           OR PAID-FOR-FAM) AND
 16035*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 16036           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 16037              OR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 305
* EL156.cbl
 16038        ((PAID-FOR-LIFE) AND
 16039        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 16040            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16041         ELSE
 16042*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 16043           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16044                OR PAID-FOR-FAM) AND
 16045               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 16046              OR
 16047          ((PAID-FOR-LIFE) AND
 16048          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 16049            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16050       ELSE
 16051           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16052                OR PAID-FOR-FAM) AND
 16053               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 16054              OR
 16055          ((PAID-FOR-LIFE) AND
 16056          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 16057            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16058       ELSE
 16059            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16060
 16061     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16062           OR PAID-FOR-FAM) AND
 16063        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 16064        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 16065            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16066        END-IF
 16067     ELSE
 16068     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16069           OR PAID-FOR-FAM) AND
 16070        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 16071        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 16072            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16073        END-IF
 16074     ELSE
 16075     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16076           OR PAID-FOR-FAM) AND
 16077        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 16078        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 16079            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16080        END-IF
 16081     ELSE
 16082     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16083           OR PAID-FOR-FAM) AND
 16084        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 16085        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 16086            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16087        END-IF
 16088     ELSE
 16089     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16090           OR PAID-FOR-FAM)
 16091            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16092
 16093 6170-WRITE.
 16094
 16095     if pi-company-id = 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 306
* EL156.cbl
 16096        PERFORM 0900-GET-DDF-limits
 16097                                 THRU 0900-EXIT
 16098     end-if
 16099     perform 2220-update-elcrtt  thru 2220-exit
 16100     IF PI-COMPANY-ID = 'DMD'
 16101        IF PI-AT-EOB-CODES NOT = SPACES
 16102           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16103           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16104           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16105           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16106           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16107
 16108
 16109* EXEC CICS HANDLE CONDITION
 16110*        DUPREC    (6180-DUPREC)
 16111*    END-EXEC.
 16112*    MOVE '"$%                   ! 3 #00015110' TO DFHEIV0
 16113     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16114     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16115     MOVE X'3320233030303135313130' TO DFHEIV0(25:11)
 16116     CALL 'kxdfhei1' USING DFHEIV0
 16117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16118
 16119
 16120
 16121* EXEC CICS WRITE
 16122*         DATASET       ('ELTRLR')
 16123*         FROM          (ACTIVITY-TRAILERS)
 16124*         RIDFLD        (AT-CONTROL-PRIMARY)
 16125*     END-EXEC.
 16126     MOVE LENGTH OF
 16127      ACTIVITY-TRAILERS
 16128       TO DFHEIV11
 16129     MOVE 'ELTRLR' TO DFHEIV1
 16130*    MOVE '&$ L                  ''   #00015114' TO DFHEIV0
 16131     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16132     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16133     MOVE X'2020233030303135313134' TO DFHEIV0(25:11)
 16134     CALL 'kxdfhei1' USING DFHEIV0,
 16135           DFHEIV1,
 16136           ACTIVITY-TRAILERS,
 16137           DFHEIV11,
 16138           AT-CONTROL-PRIMARY,
 16139           DFHEIV99,
 16140           DFHEIV99
 16141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16142
 16143
 16144     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 16145        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 16146*06088           GO TO 6199-EXIT.
 16147           GO TO 6176-APPROVAL-NOTE.
 16148
 16149
 16150* EXEC CICS GETMAIN
 16151*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16152*         LENGTH    (200)
 16153*         INITIMG   (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 307
* EL156.cbl
 16154*     END-EXEC.
 16155     MOVE 200
 16156       TO DFHEIV11
 16157*    MOVE ',"IL                  $   #00015125' TO DFHEIV0
 16158     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16159     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16160     MOVE X'2020233030303135313235' TO DFHEIV0(25:11)
 16161     CALL 'kxdfhei1' USING DFHEIV0,
 16162           DFHEIV20,
 16163           DFHEIV11,
 16164           GETMAIN-SPACE
 16165     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16166         DFHEIV20
 16167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16168
 16169
 16170     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16171
 16172     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 16173     MOVE 'AT'                   TO AT-RECORD-ID.
 16174     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16175     MOVE '6'                    TO AT-TRAILER-TYPE.
 16176     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16177                                    AT-GEN-INFO-LAST-MAINT-DT
 16178     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16179                                    AT-GEN-INFO-LAST-UPDATED-BY
 16180     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16181
 16182     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 16183     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 16184     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 16185
 16186     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 16187
 16188 6175-WRITE.
 16189
 16190
 16191* EXEC CICS HANDLE CONDITION
 16192*        DUPREC    (6190-DUPREC)
 16193*    END-EXEC.
 16194*    MOVE '"$%                   ! 4 #00015151' TO DFHEIV0
 16195     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16197     MOVE X'3420233030303135313531' TO DFHEIV0(25:11)
 16198     CALL 'kxdfhei1' USING DFHEIV0
 16199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16200
 16201
 16202
 16203* EXEC CICS WRITE
 16204*         DATASET     ('ELTRLR')
 16205*         FROM        (ACTIVITY-TRAILERS)
 16206*         RIDFLD      (AT-CONTROL-PRIMARY)
 16207*     END-EXEC.
 16208     MOVE LENGTH OF
 16209      ACTIVITY-TRAILERS
 16210       TO DFHEIV11
 16211     MOVE 'ELTRLR' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 308
* EL156.cbl
 16212*    MOVE '&$ L                  ''   #00015155' TO DFHEIV0
 16213     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16214     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16215     MOVE X'2020233030303135313535' TO DFHEIV0(25:11)
 16216     CALL 'kxdfhei1' USING DFHEIV0,
 16217           DFHEIV1,
 16218           ACTIVITY-TRAILERS,
 16219           DFHEIV11,
 16220           AT-CONTROL-PRIMARY,
 16221           DFHEIV99,
 16222           DFHEIV99
 16223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16224
 16225
 16226 6176-APPROVAL-NOTE.
 16227
 16228     IF NOT APPROVAL-NEEDED
 16229         GO TO 6199-EXIT.
 16230
 16231
 16232* EXEC CICS GETMAIN
 16233*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16234*        LENGTH    (200)
 16235*        INITIMG   (GETMAIN-SPACE)
 16236*    END-EXEC.
 16237     MOVE 200
 16238       TO DFHEIV11
 16239*    MOVE ',"IL                  $   #00015166' TO DFHEIV0
 16240     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16241     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16242     MOVE X'2020233030303135313636' TO DFHEIV0(25:11)
 16243     CALL 'kxdfhei1' USING DFHEIV0,
 16244           DFHEIV20,
 16245           DFHEIV11,
 16246           GETMAIN-SPACE
 16247     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16248         DFHEIV20
 16249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16250
 16251
 16252     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16253
 16254     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16255     MOVE 'AT'               TO AT-RECORD-ID
 16256     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16257     MOVE '6'                TO AT-TRAILER-TYPE
 16258     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16259                                AT-GEN-INFO-LAST-MAINT-DT
 16260     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16261                                AT-GEN-INFO-LAST-UPDATED-BY
 16262     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16263
 16264     IF PI-REAUDIT-NEEDED = 'Y'
 16265         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16266     ELSE
 16267         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 16268     END-IF
 16269     IF PI-APPROVAL-3550-NEEDED = 'Y'
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 309
* EL156.cbl
 16270         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16271     END-IF
 16272     MOVE SPACES             TO AT-INFO-LINE-2
 16273
 16274     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16275 6177-WRITE.
 16276
 16277
 16278* EXEC CICS HANDLE CONDITION
 16279*        DUPREC    (6185-DUPREC)
 16280*    END-EXEC.
 16281*    MOVE '"$%                   ! 5 #00015197' TO DFHEIV0
 16282     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16283     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16284     MOVE X'3520233030303135313937' TO DFHEIV0(25:11)
 16285     CALL 'kxdfhei1' USING DFHEIV0
 16286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16287
 16288
 16289
 16290* EXEC CICS WRITE
 16291*         DATASET     ('ELTRLR')
 16292*         FROM        (ACTIVITY-TRAILERS)
 16293*         RIDFLD      (AT-CONTROL-PRIMARY)
 16294*     END-EXEC.
 16295     MOVE LENGTH OF
 16296      ACTIVITY-TRAILERS
 16297       TO DFHEIV11
 16298     MOVE 'ELTRLR' TO DFHEIV1
 16299*    MOVE '&$ L                  ''   #00015201' TO DFHEIV0
 16300     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16301     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16302     MOVE X'2020233030303135323031' TO DFHEIV0(25:11)
 16303     CALL 'kxdfhei1' USING DFHEIV0,
 16304           DFHEIV1,
 16305           ACTIVITY-TRAILERS,
 16306           DFHEIV11,
 16307           AT-CONTROL-PRIMARY,
 16308           DFHEIV99,
 16309           DFHEIV99
 16310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16311
 16312
 16313
 16314     GO TO 6199-EXIT.
 16315
 16316 6180-DUPREC.
 16317
 16318     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16319     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16320     GO TO 6170-WRITE.
 16321
 16322 6185-DUPREC.
 16323     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16324     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16325     GO TO 6177-WRITE.
 16326
 16327 6190-DUPREC.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 310
* EL156.cbl
 16328     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16329     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16330     GO TO 6175-WRITE.
 16331
 16332 6199-EXIT.
 16333      EXIT.
 16334
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 311
* EL156.cbl
 16336 6200-UPDATE-CLAIM-MSTR.
 16337     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16338     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16339     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16340     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16341
 16342     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16343
 16344     MOVE ZEROS                  TO W-INTEREST.
 16345
 16346     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 16347        IF (PI-OFFLINE = 'Y') OR
 16348           (PI-PMTTYPE = '7')
 16349           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16350                                 THRU 9870-EXIT
 16351        END-IF
 16352     END-IF
 16353     IF NOT ERROR-ON-OUTPUT
 16354        CONTINUE
 16355     ELSE
 16356
 16357* EXEC CICS REWRITE
 16358*          DATASET('ELMSTR')
 16359*          FROM(CLAIM-MASTER)
 16360*       END-EXEC
 16361     MOVE LENGTH OF
 16362      CLAIM-MASTER
 16363       TO DFHEIV11
 16364     MOVE 'ELMSTR' TO DFHEIV1
 16365*    MOVE '&& L                  %   #00015250' TO DFHEIV0
 16366     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16367     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16368     MOVE X'2020233030303135323530' TO DFHEIV0(25:11)
 16369     CALL 'kxdfhei1' USING DFHEIV0,
 16370           DFHEIV1,
 16371           CLAIM-MASTER,
 16372           DFHEIV11,
 16373           DFHEIV99
 16374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16375
 16376        MOVE -1                  TO ENTPFBL
 16377        MOVE AL-UANON            TO ENTPFBA
 16378        MOVE MAP-NAMEB           TO MAP-NAME
 16379        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16380        GO TO 8200-SEND-DATAONLY
 16381     END-IF
 16382
 16383     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16384
 16385     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16386
 16387     IF PI-AIG-SPECIAL-BENEFIT
 16388         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16389
 16390     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16391
 16392     IF PI-SPECIAL-BEN-SW = 'Y'
 16393         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 312
* EL156.cbl
 16394         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16395
 16396     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16397         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16398     ELSE
 16399         IF PI-PMTTYPE NOT = '4'
 16400            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16401
 16402     IF PI-PMTTYPE = '5' OR '6'
 16403        GO TO  6250-SET-MAINT.
 16404
 16405     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16406                                         CL-LAG-REPORT-CODE.
 16407
 16408     IF CL-ACTIVITY-CODE = 09
 16409         GO TO 6200-CONT-UPDATE.
 16410
 16411     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16412         IF CL-ACTIVITY-CODE = 11
 16413             GO TO 6200-CONT-UPDATE.
 16414
 16415     IF WS-ACT-REC-FOUND-SW = 'N'
 16416         GO TO 6200-CONT-UPDATE.
 16417
 16418     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16419         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16420         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16421         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16422
 16423     IF WS-UPDATE-SW = 'Y'
 16424         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16425                                         CL-NEXT-FOLLOWUP-DT.
 16426
 16427 6200-CONT-UPDATE.
 16428
 16429     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16430       IF CLAIM-IS-CLOSED
 16431         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16432           IF WS-OPEN-CLOSE-SW = '2'
 16433             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16434                                        CL-LAST-CLOSE-DT.
 16435
 16436     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16437        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16438        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16439
 16440     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16441        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16442        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16443        MOVE 'C'                 TO CL-CLAIM-STATUS
 16444        IF PI-PMTTYPE = '2'
 16445           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16446              or 'F')
 16447           CONTINUE
 16448        ELSE
 16449           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16450        END-IF
 16451     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 313
* EL156.cbl
 16452        IF PI-PMTTYPE = '2' OR '3'
 16453           IF PI-PMTTYPE = '2' AND
 16454              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16455                 or 'F')
 16456              CONTINUE
 16457           ELSE
 16458              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16459           END-IF
 16460        END-IF
 16461     END-IF
 16462
 16463     IF PI-PMTTYPE = '4'
 16464        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16465
 16466     IF PI-COMPANY-ID = 'CVL'
 16467         IF PI-LOAN-UPDATE-SW = 'Y'
 16468             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16469             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16470             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16471             MOVE CL-CERT-STATE      TO  CERT-STATE
 16472             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16473             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16474             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16475             MOVE 'CERT'             TO  FILE-SWITCH
 16476             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16477             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16478             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16479
 16480     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16481        GO TO 6220-USE-COMPUTED.
 16482
 16483     IF (PI-PMTTYPE = '4')  AND
 16484        (PI-EPYAMT < ZEROS)
 16485          COMPUTE CL-NO-OF-DAYS-PAID =
 16486                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16487          IF CL-NO-OF-DAYS-PAID < +0
 16488              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16489          ELSE
 16490              NEXT SENTENCE
 16491     ELSE
 16492          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16493
 16494     IF PI-HOLDTIL NOT = ZEROS
 16495        CONTINUE
 16496     ELSE
 16497     IF PI-PROCESSOR-ID = 'FIX '
 16498        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16499           NEXT SENTENCE
 16500        ELSE
 16501           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16502     ELSE
 16503        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16504
 16505     IF PI-PMTTYPE = '4'
 16506        GO TO 6250-SET-MAINT.
 16507
 16508     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16509     MOVE '4'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 314
* EL156.cbl
 16510     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16511     IF PI-HOLDTIL NOT = ZEROS
 16512        CONTINUE
 16513     ELSE
 16514     IF DATE-CONVERSION-ERROR
 16515        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16516     ELSE
 16517        ADD 1                 TO CL-NO-OF-PMTS-MADE
 16518        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16519           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16520           IF PI-AIG-SPECIAL-BENEFIT
 16521               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16522           ELSE
 16523               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16524
 16525     GO TO 6250-SET-MAINT.
 16526
 16527 6220-USE-COMPUTED.
 16528
 16529     IF (PI-PMTTYPE = '4')  AND
 16530        (PI-CPYAMT < ZEROS)
 16531          COMPUTE CL-NO-OF-DAYS-PAID =
 16532                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16533          IF CL-NO-OF-DAYS-PAID < +0
 16534              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16535          ELSE
 16536              NEXT SENTENCE
 16537     ELSE
 16538          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16539
 16540     IF PI-HOLDTIL = ZEROS
 16541        ADD 1                    TO CL-NO-OF-PMTS-MADE
 16542        ADD PI-CPYAMT            TO CL-TOTAL-PAID-AMT.
 16543
 16544     IF PI-PMTTYPE = '4'
 16545        GO TO 6250-SET-MAINT.
 16546
 16547     IF PI-AIG-SPECIAL-BENEFIT
 16548         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16549     ELSE
 16550         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16551
 16552     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16553       AND PI-HOLDTIL = ZEROS
 16554        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16555
 16556 6250-SET-MAINT.
 16557     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16558
 16559     IF PI-PROCESSOR-ID = 'FIX '
 16560        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16561           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16562        ELSE
 16563           NEXT SENTENCE
 16564     ELSE
 16565        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16566
 16567     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 315
* EL156.cbl
 16568     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16569     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16570
 16571 6299-EXIT.
 16572      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 316
* EL156.cbl
 16574 6300-UPDATE-CERT.
 16575
 16576*  ADD CERTNOTE FOR SC NP+6
 16577     IF PI-COMPANY-ID = 'CID' AND
 16578       (PI-PMTTYPE = '2' OR '3') AND
 16579        CL-CERT-STATE = 'SC'  AND
 16580        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16581           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16582     END-IF.
 16583
 16584     IF PI-COMPANY-ID = 'AHL' AND
 16585       (PI-PMTTYPE = '2' OR '3') AND
 16586        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16587           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16588           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16589     END-IF.
 16590
 16591     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16592     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16593     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16594     MOVE CL-CERT-STATE    TO CERT-STATE.
 16595     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16596     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16597     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16598     MOVE 'CERT'           TO FILE-SWITCH.
 16599
 16600     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16601
 16602     IF CERT-NOTE-ADDED
 16603        IF CM-NOTE-SW = ' '
 16604           MOVE '4'             TO CM-NOTE-SW
 16605        ELSE
 16606           IF CM-NOTE-SW = '1'
 16607               MOVE '5'           TO CM-NOTE-SW
 16608           ELSE
 16609              IF CM-NOTE-SW = '2'
 16610                 MOVE '6'         TO CM-NOTE-SW
 16611              ELSE
 16612                 IF CM-NOTE-SW = '3'
 16613                    MOVE '7'      TO CM-NOTE-SW
 16614                 END-IF
 16615              END-IF
 16616           END-IF
 16617        END-IF
 16618     END-IF.
 16619
 16620     IF PI-COMPANY-ID = 'CVL'
 16621         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16622         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16623
 16624     IF PI-PMTTYPE NOT = '4'
 16625        GO TO 6340-UPDATE-CERT.
 16626
 16627     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16628        IF PI-PFKEY-USED = DFHPF5
 16629           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16630        ELSE
 16631           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 317
* EL156.cbl
 16632
 16633*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16634*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16635*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16636*               PI-LF-COVERAGE-TYPE = 'P'
 16637*                GO TO 6350-REWRITE-CERT.
 16638
 16639     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16640       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16641          PI-LF-COVERAGE-TYPE = 'P'
 16642           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16643                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16644                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16645                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16646                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16647                GO TO 6350-REWRITE-CERT
 16648            ELSE
 16649                GO TO 6350-REWRITE-CERT.
 16650
 16651     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16652         GO TO 6350-REWRITE-CERT.
 16653
 16654     IF NOT CM-AH-LUMP-SUM-DISAB
 16655        GO TO 6380-UNLOCK-CERT.
 16656
 16657     IF PI-PFKEY-USED = DFHPF5
 16658        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16659                                    CM-AH-ITD-AH-PMT
 16660        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16661        GO TO 6350-REWRITE-CERT
 16662     ELSE
 16663        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16664                                    CM-AH-ITD-AH-PMT
 16665        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16666        GO TO 6350-REWRITE-CERT.
 16667
 16668 6340-UPDATE-CERT.
 16669
 16670     IF CL-CLAIM-TYPE = 'L'
 16671         IF PI-PFKEY-USED = DFHPF5
 16672             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16673         ELSE
 16674             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16675
 16676     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16677         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16678             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16679                PI-LF-COVERAGE-TYPE = 'P'
 16680                 GO TO 6350-REWRITE-CERT.
 16681
 16682     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16683       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16684          PI-LF-COVERAGE-TYPE = 'P'
 16685           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16686                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16687                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16688                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16689                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 318
* EL156.cbl
 16690                GO TO 6350-REWRITE-CERT.
 16691
 16692     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16693         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16694            PI-LF-COVERAGE-TYPE NOT = 'P'
 16695             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16696             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16697             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16698             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16699             GO TO 6350-REWRITE-CERT.
 16700
 16701     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16702         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16703         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16704         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16705         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16706         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16707         IF PI-PFKEY-USED = DFHPF5
 16708             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16709                                        CM-AH-ITD-AH-PMT
 16710             GO TO 6350-REWRITE-CERT
 16711         ELSE
 16712             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16713                                        CM-AH-ITD-AH-PMT
 16714             GO TO 6350-REWRITE-CERT.
 16715
 16716 6350-REWRITE-CERT.
 16717
 16718
 16719* EXEC CICS REWRITE
 16720*         DATASET  ('ELCERT')
 16721*         FROM(CERTIFICATE-MASTER)
 16722*     END-EXEC.
 16723     MOVE LENGTH OF
 16724      CERTIFICATE-MASTER
 16725       TO DFHEIV11
 16726     MOVE 'ELCERT' TO DFHEIV1
 16727*    MOVE '&& L                  %   #00015597' TO DFHEIV0
 16728     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16729     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16730     MOVE X'2020233030303135353937' TO DFHEIV0(25:11)
 16731     CALL 'kxdfhei1' USING DFHEIV0,
 16732           DFHEIV1,
 16733           CERTIFICATE-MASTER,
 16734           DFHEIV11,
 16735           DFHEIV99
 16736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16737
 16738
 16739     GO TO 6399-EXIT.
 16740
 16741 6380-UNLOCK-CERT.
 16742
 16743* EXEC CICS UNLOCK
 16744*         DATASET  ('ELCERT')
 16745*     END-EXEC.
 16746     MOVE 'ELCERT' TO DFHEIV1
 16747*    MOVE '&*                    #   #00015605' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 319
* EL156.cbl
 16748     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16749     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16750     MOVE X'2020233030303135363035' TO DFHEIV0(25:11)
 16751     CALL 'kxdfhei1' USING DFHEIV0,
 16752           DFHEIV1,
 16753           DFHEIV99
 16754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16755
 16756
 16757 6399-EXIT.
 16758      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 320
* EL156.cbl
 16760 6400-UPDATE-ZERO-TRAILER.
 16761     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16762     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16763
 16764     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16765
 16766     IF PI-EPYAMT NOT = ZEROS
 16767         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16768     ELSE
 16769         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16770
 16771     IF PI-ERESV NOT = ZEROS
 16772        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16773
 16774     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16775        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16776
 16777     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16778        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16779     ELSE
 16780        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16781
 16782     IF PI-PMTTYPE = '5'
 16783        IF PI-EPYAMT = ZEROS
 16784           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16785        ELSE
 16786           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16787
 16788     IF PI-PMTTYPE = '6'
 16789        IF PI-EPYAMT = ZEROS
 16790           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16791        ELSE
 16792           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16793
 16794 6420-CHECK-OPEN-CLOSE.
 16795     IF PI-PMTTYPE = '5' OR '6'
 16796        GO TO 6450-REWRITE.
 16797
 16798     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16799         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16800             IF CLAIM-IS-CLOSED
 16801                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16802                 MOVE 1          TO  SUB-1
 16803                 GO TO 6440-AIG-LOOP.
 16804
 16805     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16806        GO TO 6450-REWRITE.
 16807
 16808     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16809        GO TO 6450-REWRITE.
 16810
 16811     MOVE 1                      TO SUB-1.
 16812
 16813 6430-LOOP.
 16814     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16815        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16816        IF PI-PMTTYPE = '1' OR '4'
 16817           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 321
* EL156.cbl
 16818           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16819           GO TO 6450-REWRITE
 16820        ELSE
 16821           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16822           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16823           GO TO 6450-REWRITE.
 16824
 16825     IF SUB-1 = 6
 16826      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16827      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16828      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16829      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16830      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16831      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16832      GO TO 6430-LOOP.
 16833
 16834     ADD 1                       TO SUB-1.
 16835     GO TO 6430-LOOP.
 16836
 16837
 16838 6440-AIG-LOOP.
 16839
 16840     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16841       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16842       IF WS-OPEN-CLOSE-SW = '1'
 16843         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16844         IF PI-PMTTYPE = '2'
 16845           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16846           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16847         ELSE
 16848           IF PI-PMTTYPE = '3'
 16849             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16850             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16851           ELSE
 16852             IF PI-PMTTYPE = '4'
 16853               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16854               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16855             ELSE
 16856               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16857               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16858       ELSE
 16859         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16860         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16861         GO TO 6450-REWRITE.
 16862
 16863     IF SUB-1 = 6
 16864      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16865      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16866      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16867      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16868      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16869      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16870      GO TO 6440-AIG-LOOP.
 16871
 16872     ADD 1                       TO SUB-1.
 16873     GO TO 6440-AIG-LOOP.
 16874
 16875 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 322
* EL156.cbl
 16876     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16877     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16878     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16879
 16880     IF PI-COMPANY-ID = 'DMD'
 16881         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16882         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16883         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16884         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16885         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16886
 16887
 16888* EXEC CICS REWRITE
 16889*         DATASET  ('ELTRLR')
 16890*         FROM     (ACTIVITY-TRAILERS)
 16891*     END-EXEC.
 16892     MOVE LENGTH OF
 16893      ACTIVITY-TRAILERS
 16894       TO DFHEIV11
 16895     MOVE 'ELTRLR' TO DFHEIV1
 16896*    MOVE '&& L                  %   #00015739' TO DFHEIV0
 16897     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16898     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16899     MOVE X'2020233030303135373339' TO DFHEIV0(25:11)
 16900     CALL 'kxdfhei1' USING DFHEIV0,
 16901           DFHEIV1,
 16902           ACTIVITY-TRAILERS,
 16903           DFHEIV11,
 16904           DFHEIV99
 16905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16906
 16907
 16908 6499-EXIT.
 16909      EXIT.
 16910
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 323
* EL156.cbl
 16912 6500-READ-DLO035.
 16913     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16914     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16915     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16916     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16917
 16918
 16919* EXEC CICS LINK
 16920*        PROGRAM    ('DLO035')
 16921*        COMMAREA   (DLO035-KEY)
 16922*        LENGTH     (DL35-LENGTH)
 16923*    END-EXEC.
 16924     MOVE 'DLO035' TO DFHEIV1
 16925*    MOVE '."C                   (   #00015754' TO DFHEIV0
 16926     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16927     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16928     MOVE X'2020233030303135373534' TO DFHEIV0(25:11)
 16929     CALL 'kxdfhei1' USING DFHEIV0,
 16930           DFHEIV1,
 16931           DLO035-KEY,
 16932           DL35-LENGTH,
 16933           DFHEIV99,
 16934           DFHEIV99,
 16935           DFHEIV99,
 16936           DFHEIV99
 16937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16938
 16939
 16940     IF DL35-RETURN-CODE = 'OK'
 16941         GO TO 6500-EXIT.
 16942
 16943     IF DL35-RETURN-CODE = '01'
 16944         MOVE ER-7830            TO EMI-ERROR
 16945         GO TO 6500-BAD-EXIT.
 16946
 16947     IF DL35-RETURN-CODE = '02'
 16948         MOVE ER-7831            TO EMI-ERROR
 16949         GO TO 6500-BAD-EXIT.
 16950
 16951     IF DL35-RETURN-CODE = '03'
 16952         MOVE ER-7832            TO EMI-ERROR
 16953         GO TO 6500-BAD-EXIT.
 16954
 16955     IF DL35-RETURN-CODE = '04'
 16956         MOVE ER-7833            TO EMI-ERROR
 16957         GO TO 6500-BAD-EXIT.
 16958
 16959     IF DL35-RETURN-CODE = '05'
 16960         MOVE ER-7834            TO EMI-ERROR
 16961         GO TO 6500-BAD-EXIT.
 16962
 16963     IF DL35-RETURN-CODE = '06'
 16964         MOVE ER-7835            TO EMI-ERROR
 16965         GO TO 6500-BAD-EXIT.
 16966
 16967     IF DL35-RETURN-CODE = '07'
 16968         MOVE ER-7836            TO EMI-ERROR
 16969         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 324
* EL156.cbl
 16970
 16971     IF DL35-RETURN-CODE = 'E1'
 16972         MOVE ER-7837            TO EMI-ERROR
 16973         GO TO 6500-BAD-EXIT.
 16974
 16975     IF DL35-RETURN-CODE NOT = 'OK'
 16976         MOVE ER-7838            TO EMI-ERROR
 16977         GO TO 6500-BAD-EXIT.
 16978
 16979 6500-EXIT.
 16980      EXIT.
 16981
 16982 6500-BAD-EXIT.
 16983
 16984* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16985*    MOVE '6"R                   !   #00015803' TO DFHEIV0
 16986     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16987     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16988     MOVE X'2020233030303135383033' TO DFHEIV0(25:11)
 16989     CALL 'kxdfhei1' USING DFHEIV0
 16990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16991
 16992     MOVE -1                 TO PMTTYPEL.
 16993     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16994     GO TO 8200-SEND-DATAONLY.
 16995
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 325
* EL156.cbl
 16997 6600-UPDATE-DLO035.
 16998     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16999     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 17000     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 17001     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 17002
 17003
 17004* EXEC CICS LINK
 17005*        PROGRAM    ('DLO035')
 17006*        COMMAREA   (DLO035-KEY)
 17007*        LENGTH     (DL35-LENGTH)
 17008*    END-EXEC.
 17009     MOVE 'DLO035' TO DFHEIV1
 17010*    MOVE '."C                   (   #00015815' TO DFHEIV0
 17011     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17012     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17013     MOVE X'2020233030303135383135' TO DFHEIV0(25:11)
 17014     CALL 'kxdfhei1' USING DFHEIV0,
 17015           DFHEIV1,
 17016           DLO035-KEY,
 17017           DL35-LENGTH,
 17018           DFHEIV99,
 17019           DFHEIV99,
 17020           DFHEIV99,
 17021           DFHEIV99
 17022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17023
 17024
 17025     IF DL35-RETURN-CODE = 'OK'
 17026         GO TO 6600-EXIT.
 17027
 17028     IF DL35-RETURN-CODE = '01'
 17029         MOVE ER-7830            TO EMI-ERROR
 17030         GO TO 6500-BAD-EXIT.
 17031
 17032     IF DL35-RETURN-CODE = '02'
 17033         MOVE ER-7831            TO EMI-ERROR
 17034         GO TO 6500-BAD-EXIT.
 17035
 17036     IF DL35-RETURN-CODE = '03'
 17037         MOVE ER-7832            TO EMI-ERROR
 17038         GO TO 6500-BAD-EXIT.
 17039
 17040     IF DL35-RETURN-CODE = '04'
 17041         MOVE ER-7833            TO EMI-ERROR
 17042         GO TO 6500-BAD-EXIT.
 17043
 17044     IF DL35-RETURN-CODE = '05'
 17045         MOVE ER-7834            TO EMI-ERROR
 17046         GO TO 6500-BAD-EXIT.
 17047
 17048     IF DL35-RETURN-CODE = '06'
 17049         MOVE ER-7835            TO EMI-ERROR
 17050         GO TO 6500-BAD-EXIT.
 17051
 17052     IF DL35-RETURN-CODE = '07'
 17053         MOVE ER-7836            TO EMI-ERROR
 17054         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 326
* EL156.cbl
 17055
 17056     IF DL35-RETURN-CODE = 'E1'
 17057         MOVE ER-7837            TO EMI-ERROR
 17058         GO TO 6500-BAD-EXIT.
 17059
 17060     IF DL35-RETURN-CODE NOT = 'OK'
 17061         MOVE ER-7838            TO EMI-ERROR
 17062         GO TO 6500-BAD-EXIT.
 17063
 17064 6600-EXIT.
 17065      EXIT.
 17066
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 327
* EL156.cbl
 17068 6700-UPDATE-ACTQ.
 17069***************************************************************
 17070*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 17071*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 17072*    ONE ALREADY THERE.                                       *
 17073***************************************************************
 17074
 17075
 17076* EXEC CICS HANDLE CONDITION
 17077*         NOTFND(6720-BUILD-NEW-RECORD)
 17078*     END-EXEC.
 17079*    MOVE '"$I                   ! 6 #00015871' TO DFHEIV0
 17080     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17081     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17082     MOVE X'3620233030303135383731' TO DFHEIV0(25:11)
 17083     CALL 'kxdfhei1' USING DFHEIV0
 17084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17085
 17086
 17087
 17088* EXEC CICS READ
 17089*         DATASET('ELACTQ')
 17090*         RIDFLD (ELMSTR-KEY)
 17091*         SET    (ADDRESS OF ACTIVITY-QUE)
 17092*         UPDATE
 17093*     END-EXEC.
 17094     MOVE 'ELACTQ' TO DFHEIV1
 17095*    MOVE '&"S        EU         (   #00015875' TO DFHEIV0
 17096     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17097     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17098     MOVE X'2020233030303135383735' TO DFHEIV0(25:11)
 17099     CALL 'kxdfhei1' USING DFHEIV0,
 17100           DFHEIV1,
 17101           DFHEIV20,
 17102           DFHEIV99,
 17103           ELMSTR-KEY,
 17104           DFHEIV99,
 17105           DFHEIV99,
 17106           DFHEIV99
 17107     SET ADDRESS OF ACTIVITY-QUE TO
 17108         DFHEIV20
 17109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17110
 17111
 17112     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17113
 17114     IF PI-AIG-SPECIAL-BENEFIT AND
 17115        PI-CASH = 'Y'
 17116         ADD 2                   TO AQ-PAYMENT-COUNTER
 17117     ELSE
 17118         ADD 1                   TO AQ-PAYMENT-COUNTER.
 17119
 17120     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 17121         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 17122
 17123     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 17124
 17125     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 328
* EL156.cbl
 17126         IF WS-PMT-APPROVAL-SW = 'A'
 17127             NEXT SENTENCE
 17128         ELSE
 17129            IF PI-AIG-SPECIAL-BENEFIT AND
 17130               PI-CASH = 'Y'
 17131                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17132                                     WS-PMT-UNAPPROVED-CNT
 17133            ELSE
 17134                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17135                                     WS-PMT-UNAPPROVED-CNT
 17136     ELSE
 17137         IF PI-PMT-APPR-SW = 'Y'
 17138            IF PI-AIG-SPECIAL-BENEFIT AND
 17139               PI-CASH = 'Y'
 17140                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17141                                     WS-PMT-UNAPPROVED-CNT
 17142            ELSE
 17143                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17144                                     WS-PMT-UNAPPROVED-CNT.
 17145
 17146     IF WS-PMT-UNAPPROVED-CNT > ZERO
 17147         MOVE ER-3536 TO EMI-ERROR
 17148         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17149
 17150     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 17151
 17152
 17153* EXEC CICS REWRITE
 17154*         DATASET('ELACTQ')
 17155*         FROM   (ACTIVITY-QUE)
 17156*     END-EXEC.
 17157     MOVE LENGTH OF
 17158      ACTIVITY-QUE
 17159       TO DFHEIV11
 17160     MOVE 'ELACTQ' TO DFHEIV1
 17161*    MOVE '&& L                  %   #00015922' TO DFHEIV0
 17162     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17163     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17164     MOVE X'2020233030303135393232' TO DFHEIV0(25:11)
 17165     CALL 'kxdfhei1' USING DFHEIV0,
 17166           DFHEIV1,
 17167           ACTIVITY-QUE,
 17168           DFHEIV11,
 17169           DFHEIV99
 17170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17171
 17172
 17173     GO TO 6799-EXIT.
 17174
 17175 6720-BUILD-NEW-RECORD.
 17176
 17177* EXEC CICS GETMAIN
 17178*         SET    (ADDRESS OF ACTIVITY-QUE)
 17179*         LENGTH (60)
 17180*         INITIMG(GETMAIN-SPACE)
 17181*     END-EXEC.
 17182     MOVE 60
 17183       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 329
* EL156.cbl
 17184*    MOVE ',"IL                  $   #00015930' TO DFHEIV0
 17185     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17186     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17187     MOVE X'2020233030303135393330' TO DFHEIV0(25:11)
 17188     CALL 'kxdfhei1' USING DFHEIV0,
 17189           DFHEIV20,
 17190           DFHEIV11,
 17191           GETMAIN-SPACE
 17192     SET ADDRESS OF ACTIVITY-QUE TO
 17193         DFHEIV20
 17194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17195
 17196
 17197     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 17198
 17199     IF PI-AIG-SPECIAL-BENEFIT AND
 17200        PI-CASH = 'Y'
 17201         MOVE 2                  TO AQ-PAYMENT-COUNTER
 17202     ELSE
 17203         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 17204
 17205     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 17206     MOVE 'AQ'                   TO AQ-RECORD-ID.
 17207     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 17208     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 17209                                    AQ-FOLLOWUP-DATE.
 17210     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 17211     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17212
 17213     IF PI-PMT-GRADUATED
 17214         IF WS-PMT-APPROVAL-SW = 'A'
 17215             NEXT SENTENCE
 17216         ELSE
 17217            IF PI-AIG-SPECIAL-BENEFIT AND
 17218               PI-CASH = 'Y'
 17219                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17220            ELSE
 17221                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17222     ELSE
 17223         IF PI-PMT-APPR-SW = 'Y'
 17224            IF PI-AIG-SPECIAL-BENEFIT AND
 17225               PI-CASH = 'Y'
 17226                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17227            ELSE
 17228                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 17229
 17230     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 17231         MOVE ER-3536 TO EMI-ERROR
 17232         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17233
 17234
 17235* EXEC CICS WRITE
 17236*         DATASET('ELACTQ')
 17237*         RIDFLD (ELMSTR-KEY)
 17238*         FROM   (ACTIVITY-QUE)
 17239*     END-EXEC.
 17240     MOVE LENGTH OF
 17241      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 330
* EL156.cbl
 17242       TO DFHEIV11
 17243     MOVE 'ELACTQ' TO DFHEIV1
 17244*    MOVE '&$ L                  ''   #00015973' TO DFHEIV0
 17245     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17246     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17247     MOVE X'2020233030303135393733' TO DFHEIV0(25:11)
 17248     CALL 'kxdfhei1' USING DFHEIV0,
 17249           DFHEIV1,
 17250           ACTIVITY-QUE,
 17251           DFHEIV11,
 17252           ELMSTR-KEY,
 17253           DFHEIV99,
 17254           DFHEIV99
 17255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17256
 17257
 17258 6799-EXIT.
 17259      EXIT.
 17260
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 331
* EL156.cbl
 17262 6800-BUILD-FORM-TRAILER.
 17263
 17264
 17265* EXEC CICS GETMAIN
 17266*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17267*         LENGTH   (200)
 17268*         INITIMG  (GETMAIN-SPACE)
 17269*    END-EXEC.
 17270     MOVE 200
 17271       TO DFHEIV11
 17272*    MOVE ',"IL                  $   #00015985' TO DFHEIV0
 17273     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17274     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17275     MOVE X'2020233030303135393835' TO DFHEIV0(25:11)
 17276     CALL 'kxdfhei1' USING DFHEIV0,
 17277           DFHEIV20,
 17278           DFHEIV11,
 17279           GETMAIN-SPACE
 17280     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17281         DFHEIV20
 17282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17283
 17284
 17285     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17286
 17287     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17288     MOVE 'AT'                   TO AT-RECORD-ID.
 17289     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17290
 17291     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17292     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17293                                    AT-FORM-LAST-MAINT-DT
 17294                                    AT-FORM-SEND-ON-DT.
 17295     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17296                                    AT-FORM-LAST-UPDATED-BY.
 17297     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17298     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17299     MOVE '6'                    TO DC-OPTION-CODE.
 17300     MOVE +29                    TO DC-ELAPSED-DAYS.
 17301     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17302     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17303     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17304
 17305     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17306         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17307
 17308     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17309                                    AT-FORM-RE-SEND-DT
 17310                                    AT-EMP-FORM-ANSWERED-DT
 17311                                    AT-PHY-FORM-ANSWERED-DT
 17312                                    AT-EMP-FORM-SEND-ON-DT
 17313                                    AT-PHY-FORM-SEND-ON-DT
 17314                                    AT-FORM-PRINTED-DT
 17315                                    AT-FORM-REPRINT-DT.
 17316     MOVE '2'                    TO AT-FORM-TYPE.
 17317
 17318     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17319     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 332
* EL156.cbl
 17320
 17321     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17322         NEXT SENTENCE
 17323     ELSE
 17324         IF CL-PROG-FORM-TYPE NOT = 'S'
 17325            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17326
 17327
 17328* EXEC CICS WRITE
 17329*         DATASET  ('ELTRLR')
 17330*         FROM     (ACTIVITY-TRAILERS)
 17331*         RIDFLD   (AT-CONTROL-PRIMARY)
 17332*     END-EXEC.
 17333     MOVE LENGTH OF
 17334      ACTIVITY-TRAILERS
 17335       TO DFHEIV11
 17336     MOVE 'ELTRLR' TO DFHEIV1
 17337*    MOVE '&$ L                  ''   #00016033' TO DFHEIV0
 17338     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17339     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17340     MOVE X'2020233030303136303333' TO DFHEIV0(25:11)
 17341     CALL 'kxdfhei1' USING DFHEIV0,
 17342           DFHEIV1,
 17343           ACTIVITY-TRAILERS,
 17344           DFHEIV11,
 17345           AT-CONTROL-PRIMARY,
 17346           DFHEIV99,
 17347           DFHEIV99
 17348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17349
 17350
 17351 6899-EXIT.
 17352      EXIT.
 17353
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 333
* EL156.cbl
 17355 6900-BUILD-ARCHIVE-HEADER.
 17356
 17357     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17358     MOVE '1'                    TO CNTL-REC-TYPE.
 17359     MOVE +0                     TO CNTL-SEQ-NO.
 17360     MOVE SPACES                 TO CNTL-ACCESS.
 17361
 17362
 17363* EXEC CICS READ
 17364*         DATASET  ('ELCNTL')
 17365*         SET      (ADDRESS OF CONTROL-FILE)
 17366*         RIDFLD   (ELCNTL-KEY)
 17367*         UPDATE
 17368*    END-EXEC.
 17369     MOVE 'ELCNTL' TO DFHEIV1
 17370*    MOVE '&"S        EU         (   #00016050' TO DFHEIV0
 17371     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17372     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17373     MOVE X'2020233030303136303530' TO DFHEIV0(25:11)
 17374     CALL 'kxdfhei1' USING DFHEIV0,
 17375           DFHEIV1,
 17376           DFHEIV20,
 17377           DFHEIV99,
 17378           ELCNTL-KEY,
 17379           DFHEIV99,
 17380           DFHEIV99,
 17381           DFHEIV99
 17382     SET ADDRESS OF CONTROL-FILE TO
 17383         DFHEIV20
 17384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17385
 17386
 17387     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17388     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17389
 17390
 17391* EXEC CICS REWRITE
 17392*         FROM     (CONTROL-FILE)
 17393*         DATASET  ('ELCNTL')
 17394*    END-EXEC.
 17395     MOVE LENGTH OF
 17396      CONTROL-FILE
 17397       TO DFHEIV11
 17398     MOVE 'ELCNTL' TO DFHEIV1
 17399*    MOVE '&& L                  %   #00016060' TO DFHEIV0
 17400     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17401     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17402     MOVE X'2020233030303136303630' TO DFHEIV0(25:11)
 17403     CALL 'kxdfhei1' USING DFHEIV0,
 17404           DFHEIV1,
 17405           CONTROL-FILE,
 17406           DFHEIV11,
 17407           DFHEIV99
 17408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17409
 17410
 17411
 17412* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 334
* EL156.cbl
 17413*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17414*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17415*    END-EXEC.
 17416*    MOVE '"$$%                  ! 7 #00016065' TO DFHEIV0
 17417     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17418     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17419     MOVE X'3720233030303136303635' TO DFHEIV0(25:11)
 17420     CALL 'kxdfhei1' USING DFHEIV0
 17421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17422
 17423
 17424
 17425* EXEC CICS GETMAIN
 17426*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17427*         LENGTH  (ELARCH-LENGTH)
 17428*         INITIMG (GETMAIN-SPACE)
 17429*    END-EXEC.
 17430*    MOVE ',"IL                  $   #00016070' TO DFHEIV0
 17431     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17432     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17433     MOVE X'2020233030303136303730' TO DFHEIV0(25:11)
 17434     CALL 'kxdfhei1' USING DFHEIV0,
 17435           DFHEIV20,
 17436           ELARCH-LENGTH,
 17437           GETMAIN-SPACE
 17438     SET ADDRESS OF LETTER-ARCHIVE TO
 17439         DFHEIV20
 17440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17441
 17442
 17443     MOVE 'LA'                   TO LA-RECORD-ID.
 17444     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17445                                    LA-ARCHIVE-NO-A1.
 17446     MOVE '4'                    TO LA-RECORD-TYPE
 17447                                    LA-RECORD-TYPE-A1.
 17448     MOVE +0                     TO LA-LINE-SEQ-NO
 17449                                    LA-LINE-SEQ-NO-A1.
 17450     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17451                                    LA-COMPANY-CD-A1.
 17452     MOVE CL-CARRIER             TO LA4-CARRIER.
 17453     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17454     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17455     MOVE CL-CERT-STATE          TO LA4-STATE.
 17456     MOVE +0                     TO LA4-NO-OF-COPIES.
 17457     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17458     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17459     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17460                                    LA4-INITIAL-PRINT-DATE
 17461                                    LA4-RESEND-PRINT-DATE
 17462                                    LA4-FORM-REM-PRINT-DT.
 17463     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17464     MOVE '2'                    TO LA4-FORM-TYPE.
 17465
 17466
 17467* EXEC CICS WRITE
 17468*         DATASET  ('ELARCH')
 17469*         FROM     (LETTER-ARCHIVE)
 17470*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 335
* EL156.cbl
 17471*    END-EXEC.
 17472     MOVE LENGTH OF
 17473      LETTER-ARCHIVE
 17474       TO DFHEIV11
 17475     MOVE 'ELARCH' TO DFHEIV1
 17476*    MOVE '&$ L                  ''   #00016099' TO DFHEIV0
 17477     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17478     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17479     MOVE X'2020233030303136303939' TO DFHEIV0(25:11)
 17480     CALL 'kxdfhei1' USING DFHEIV0,
 17481           DFHEIV1,
 17482           LETTER-ARCHIVE,
 17483           DFHEIV11,
 17484           LA-CONTROL-PRIMARY,
 17485           DFHEIV99,
 17486           DFHEIV99
 17487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17488
 17489
 17490 6999-EXIT.
 17491      EXIT.
 17492
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 336
* EL156.cbl
 17494 7000-SHOW-CLAIM.
 17495     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17496     MOVE 'A'                    TO PI-PASS-SW.
 17497     MOVE LOW-VALUES             TO PI-CPYFROM
 17498                                    PI-MONTH-END-SAVE
 17499                                    PI-CPYTHRU.
 17500
 17501     MOVE ZEROS                  TO PI-FATAL-COUNT
 17502                                    PI-DAILY-RATE
 17503                                    PI-BEN-DAYS
 17504                                    PI-MANUAL-SW
 17505                                    PI-SAVE-CURSOR
 17506                                    PI-FORCE-COUNT
 17507                                    PI-HOLDTIL
 17508                                    PI-EPYFROM
 17509                                    PI-EPYTHRU
 17510                                    PI-EDAYS
 17511                                    PI-EPYAMT
 17512                                    PI-ERESV
 17513                                    PI-EEXPENS
 17514                                    PI-CDAYS
 17515                                    PI-CPYAMT
 17516                                    PI-CRESV
 17517                                    PI-CEXPENS
 17518                                    PI-INT-RATE
 17519                                    PI-AIGFROM.
 17520     MOVE ZEROS                  TO PI-PROOF-DATE.
 17521     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17522                                    PI-REM-BEN-AMT
 17523                                    PI-MO-BEN-AMT
 17524                                    pi-ah-term.
 17525
 17526     MOVE LOW-VALUES             TO EL156AI.
 17527     MOVE MAP-NAMEA              TO MAP-NAME.
 17528
 17529* EXEC CICS HANDLE CONDITION
 17530*        NOTFND   (7010-BUILD-MAP)
 17531*    END-EXEC.
 17532*    MOVE '"$I                   ! 8 #00016143' TO DFHEIV0
 17533     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17534     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17535     MOVE X'3820233030303136313433' TO DFHEIV0(25:11)
 17536     CALL 'kxdfhei1' USING DFHEIV0
 17537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17538
 17539
 17540     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17541     MOVE '2'                    TO CNTL-REC-TYPE.
 17542     MOVE +0                     TO CNTL-SEQ-NO.
 17543     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17544
 17545
 17546* EXEC CICS READ
 17547*         DATASET  ('ELCNTL')
 17548*         SET      (ADDRESS OF CONTROL-FILE)
 17549*         RIDFLD   (ELCNTL-KEY)
 17550*    END-EXEC.
 17551     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 337
* EL156.cbl
 17552*    MOVE '&"S        E          (   #00016152' TO DFHEIV0
 17553     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17555     MOVE X'2020233030303136313532' TO DFHEIV0(25:11)
 17556     CALL 'kxdfhei1' USING DFHEIV0,
 17557           DFHEIV1,
 17558           DFHEIV20,
 17559           DFHEIV99,
 17560           ELCNTL-KEY,
 17561           DFHEIV99,
 17562           DFHEIV99,
 17563           DFHEIV99
 17564     SET ADDRESS OF CONTROL-FILE TO
 17565         DFHEIV20
 17566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17567
 17568
 17569     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17570
 17571     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17572         MOVE AL-UANON      TO SURVYYNA
 17573     END-IF.
 17574
 17575
 17576     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17577     MOVE '1'                    TO CNTL-REC-TYPE.
 17578     MOVE SPACES                 TO CNTL-ACCESS.
 17579     MOVE +0                     TO CNTL-SEQ-NO.
 17580
 17581
 17582* EXEC CICS READ
 17583*         DATASET  ('ELCNTL')
 17584*         SET      (ADDRESS OF CONTROL-FILE)
 17585*         RIDFLD   (ELCNTL-KEY)
 17586*    END-EXEC.
 17587     MOVE 'ELCNTL' TO DFHEIV1
 17588*    MOVE '&"S        E          (   #00016170' TO DFHEIV0
 17589     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17591     MOVE X'2020233030303136313730' TO DFHEIV0(25:11)
 17592     CALL 'kxdfhei1' USING DFHEIV0,
 17593           DFHEIV1,
 17594           DFHEIV20,
 17595           DFHEIV99,
 17596           ELCNTL-KEY,
 17597           DFHEIV99,
 17598           DFHEIV99,
 17599           DFHEIV99
 17600     SET ADDRESS OF CONTROL-FILE TO
 17601         DFHEIV20
 17602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17603
 17604
 17605     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17606
 17607 7010-BUILD-MAP.
 17608
 17609
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 338
* EL156.cbl
 17610* EXEC CICS HANDLE CONDITION
 17611*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17612*    END-EXEC.
 17613*    MOVE '"$I                   ! 9 #00016180' TO DFHEIV0
 17614     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17615     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17616     MOVE X'3920233030303136313830' TO DFHEIV0(25:11)
 17617     CALL 'kxdfhei1' USING DFHEIV0
 17618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17619
 17620
 17621     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17622     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17623     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17624     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17625     MOVE 'MSTR'                 TO FILE-SWITCH.
 17626
 17627     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17628
 17629     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17630     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17631     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17632     MOVE CL-CCN                 TO PI-SV-CCN.
 17633
 17634     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17635     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17636     MOVE CL-CLAIM-NO            TO CLMNOO.
 17637     MOVE CL-CARRIER             TO CARRO.
 17638     MOVE CL-CERT-PRIME          TO CERTNOO.
 17639     MOVE CL-CERT-SFX            TO SUFXO.
 17640
 17641     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17642        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17643        CONTINUE
 17644     ELSE
 17645        MOVE AL-SADOF            TO ZINTHA
 17646                                    ZINTA
 17647                                    PINTHA
 17648                                    PINTA
 17649     END-IF
 17650     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17651     EVALUATE TRUE
 17652     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17653         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17654     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17655         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17656
 17657     WHEN CL-CLAIM-TYPE = 'I'
 17658         MOVE '  IU  '           TO CLMTYPO
 17659     WHEN CL-CLAIM-TYPE = 'G'
 17660         MOVE ' GAP  '           TO CLMTYPO
 17661     WHEN CL-CLAIM-TYPE = 'F'
 17662         MOVE ' FMLA '           TO CLMTYPO
 17663     END-EVALUATE.
 17664     IF CLAIM-IS-OPEN
 17665         MOVE ' OPEN'            TO CLMSTATO
 17666     ELSE
 17667         MOVE 'CLOSED'           TO CLMSTATO.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 339
* EL156.cbl
 17668
 17669     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17670
 17671     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17672         MOVE SPACES             TO  PCERTNOO
 17673                                     PSUFXO
 17674                                     PRIMHDGO
 17675                                     SEQUO
 17676         MOVE AL-SADOF           TO  PCERTNOA
 17677                                     PSUFXA
 17678                                     PRIMHDGA
 17679                                     SEQUA
 17680     ELSE
 17681         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17682         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17683         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17684         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17685         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17686         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17687         MOVE AL-SANON               TO  PCERTNOA
 17688                                         PSUFXA
 17689                                         PRIMHDGA
 17690         MOVE AL-SABON               TO  SEQUA.
 17691
 17692     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17693
 17694     IF CL-NO-OF-PMTS-MADE = 0 AND
 17695        CL-TOTAL-PAID-AMT = 0
 17696         NEXT SENTENCE
 17697     ELSE
 17698         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17699             IF NOT PI-USES-PAID-TO
 17700                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17701                 MOVE ' '                 TO DC-OPTION-CODE
 17702                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17703                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17704             ELSE
 17705                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17706                 MOVE '6'                 TO DC-OPTION-CODE
 17707                 MOVE +1                  TO DC-ELAPSED-DAYS
 17708                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17709                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17710                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17711
 17712     IF MAP-NAME = 'EL156A'
 17713        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17714           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17715             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17716           end-if
 17717        end-if
 17718     end-if
 17719     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17720         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17721         MOVE ' '                TO DC-OPTION-CODE
 17722         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17723         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17724
 17725     IF CL-INCURRED-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 340
* EL156.cbl
 17726         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17727         MOVE ' '                TO DC-OPTION-CODE
 17728         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17729         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17730
 17731     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17732
 17733     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17734         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17735         MOVE ' '                TO DC-OPTION-CODE
 17736         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17737         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17738
 17739     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17740         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17741         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17742     ELSE
 17743         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17744         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17745
 17746     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17747     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17748     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17749     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17750                                    PI-GROUPING.
 17751     MOVE CL-CERT-STATE          TO CERT-STATE
 17752                                    PI-STATE.
 17753     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17754                                    PI-ACCOUNT.
 17755     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17756     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17757     MOVE 'CERT'                 TO FILE-SWITCH.
 17758
 17759     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17760     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17761        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17762        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17763            MOVE 'N' TO PI-JOINT-INSURED-IND
 17764     ELSE
 17765            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17766     END-IF.
 17767
 17768     perform 7975-read-acct      thru 7975-exit
 17769     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17770     MOVE PI-STATE               TO WS-ST-ACCESS.
 17771     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17772     MOVE '3'                    TO CNTL-REC-TYPE.
 17773     MOVE +0                     TO CNTL-SEQ-NO.
 17774     MOVE 'STAT'                 TO FILE-SWITCH.
 17775
 17776     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17777
 17778     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17779     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17780
 17781     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17782        GO TO 7020-BYPASS-BENEFIT.
 17783
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 341
* EL156.cbl
 17784     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17785     MOVE '4'                    TO CNTL-REC-TYPE.
 17786     MOVE +0                     TO CNTL-SEQ-NO.
 17787     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17788     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17789     MOVE 'BENE'                 TO FILE-SWITCH.
 17790
 17791     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17792
 17793     IF NO-BENEFIT-FOUND
 17794        GO TO 7020-BYPASS-BENEFIT.
 17795
 17796     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17797     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17798     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17799
 17800 7020-BYPASS-BENEFIT.
 17801
 17802*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17803*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17804*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17805
 17806     move zeros                  to PI-MAX-BENEFIT-AMT
 17807     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17808     move cm-ah-orig-term        to pi-ah-term
 17809     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17810     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17811          'G' and 'F'
 17812         GO TO 7021-GO-TO-LIFE.
 17813
 17814     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 17815        and (acct-found)
 17816        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17817        PERFORM 0900-GET-DDF-limits
 17818                                 THRU 0900-EXIT
 17819        IF PDEF-FOUND
 17820           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17821              (P1 > +8)
 17822              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17823           END-PERFORM
 17824           IF P1 < +9
 17825              if pd-ben-pct (p1) not numeric
 17826                 move zeros      to pd-ben-pct (p1)
 17827              end-if
 17828              if pd-ben-pct (p1) = zeros
 17829                 move +1         to ws-work-ben-pct
 17830              else
 17831                 move pd-ben-pct (p1)
 17832                                 to ws-work-ben-pct
 17833              end-if
 17834              compute cm-ah-benefit-amt =
 17835                 cm-ah-benefit-amt * ws-work-ben-pct
 17836              move pd-max-amt (p1) to pi-max-benefit-amt
 17837           END-IF
 17838        END-IF
 17839     end-if
 17840     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17841     MOVE 'MO. BENEFIT :'        TO BENECAPO.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 342
* EL156.cbl
 17842     if (pi-max-benefit-amt not = zeros)
 17843        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17844        move pi-max-benefit-amt  to beneo
 17845     else
 17846        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17847     end-if
 17848     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17849     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17850                                    CP-ORIGINAL-TERM.
 17851     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17852
 17853*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17854*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17855*    ELSE
 17856         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17857
 17858     MOVE ' '                    TO DC-OPTION-CODE.
 17859     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17860     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17861
 17862     IF PI-COMPANY-ID = 'DMD'
 17863         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17864         GO TO 7023-BYPASS-REMAINING-TERM.
 17865
 17866     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17867     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17868     GO TO 7022-AROUND-LIFE.
 17869
 17870 7021-GO-TO-LIFE.
 17871
 17872     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17873     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17874     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17875                                    CP-ORIGINAL-TERM.
 17876     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17877     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17878     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17879     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17880
 17881     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17882         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17883     ELSE
 17884         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17885
 17886     MOVE ' '                    TO DC-OPTION-CODE.
 17887     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17888     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17889
 17890 7022-AROUND-LIFE.
 17891
 17892     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17893     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17894     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17895     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17896     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17897     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17898     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17899
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 343
* EL156.cbl
 17900     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17901
 17902     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17903        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17904           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17905
 17906     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17907        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17908           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17909
 17910 7023-BYPASS-REMAINING-TERM.
 17911     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17912       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17913          MOVE ZEROS                  TO BENEO
 17914       ELSE
 17915          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17916          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17917          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17918          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17919          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17920          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17921          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17922          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17923          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17924          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17925          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17926          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17927          IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 17928             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17929             PERFORM 0900-GET-DDF-limits
 17930                                 THRU 0900-EXIT
 17931             IF PDEF-FOUND
 17932                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17933                   (P1 > +8)
 17934                   OR (PD-PROD-CODE (P1) = 'L')
 17935                END-PERFORM
 17936                IF P1 < +9
 17937                   MOVE PD-MAX-AMT (P1)
 17938                                 TO CP-R-MAX-TOT-BEN
 17939                END-IF
 17940             END-IF
 17941          END-IF
 17942
 17943* EXEC CICS LINK
 17944*            PROGRAM  (LINK-REMAMT)
 17945*            COMMAREA (CALCULATION-PASS-AREA)
 17946*            LENGTH   (CP-COMM-LENGTH)
 17947*         END-EXEC
 17948*    MOVE '."C                   (   #00016505' TO DFHEIV0
 17949     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17950     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17951     MOVE X'2020233030303136353035' TO DFHEIV0(25:11)
 17952     CALL 'kxdfhei1' USING DFHEIV0,
 17953           LINK-REMAMT,
 17954           CALCULATION-PASS-AREA,
 17955           CP-COMM-LENGTH,
 17956           DFHEIV99,
 17957           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 344
* EL156.cbl
 17958           DFHEIV99,
 17959           DFHEIV99
 17960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17961          MOVE CP-REMAINING-AMT       TO BENEO
 17962       end-if
 17963     end-if
 17964     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17965     MOVE +95                    TO TRLR-SEQ-NO
 17966
 17967* EXEC CICS READ
 17968*       DATASET  ('ELTRLR')
 17969*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17970*       RIDFLD   (ELTRLR-KEY)
 17971*       RESP     (WS-RESPONSE)
 17972*    END-EXEC
 17973     MOVE 'ELTRLR' TO DFHEIV1
 17974*    MOVE '&"S        E          (  N#00016515' TO DFHEIV0
 17975     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17976     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17977     MOVE X'204E233030303136353135' TO DFHEIV0(25:11)
 17978     CALL 'kxdfhei1' USING DFHEIV0,
 17979           DFHEIV1,
 17980           DFHEIV20,
 17981           DFHEIV99,
 17982           ELTRLR-KEY,
 17983           DFHEIV99,
 17984           DFHEIV99,
 17985           DFHEIV99
 17986     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17987         DFHEIV20
 17988     MOVE EIBRESP  TO WS-RESPONSE
 17989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17990
 17991     if ws-resp-normal
 17992        perform varying s1 from +1 by +1 until
 17993           at-note-error-no (s1) = spaces
 17994           move at-note-error-no (s1)
 17995                                 to emi-error
 17996           if at-note-error-no (s1) = '1653'
 17997              evaluate true
 17998                 when cl-claim-type = 'L'
 17999                    move '  LF  '
 18000                                 to emi-claim-type
 18001                 when cl-claim-type = 'I'
 18002                    move '  IU  '
 18003                                 to emi-claim-type
 18004                 when cl-claim-type = 'F'
 18005                    move ' FMLA '
 18006                                 to emi-claim-type
 18007                 when other
 18008                    move '  AH  '
 18009                                 to emi-claim-type
 18010              end-evaluate
 18011           end-if
 18012           PERFORM 9900-ERROR-FORMAT
 18013                                 THRU 9900-EXIT
 18014        end-perform
 18015     end-if
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 345
* EL156.cbl
 18016     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 18017         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 18018            WS-LF-COVERAGE-TYPE = 'P'
 18019             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 18020                                        CM-LF-ITD-DEATH-AMT
 18021             MOVE WS-REMAINING-AMT  TO  BENEO.
 18022
 18023     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 18024     MOVE BENEO                  TO PI-REM-BEN-AMT.
 18025     MOVE WS-TERMS               TO TERMSO.
 18026
 18027     IF WS-STATUS = '6' OR '7' OR '8'
 18028         MOVE AL-SABOF           TO CRTSTATA.
 18029
 18030     IF WS-STATUS = '1' OR '4'
 18031        IF CP-REMAINING-TERM-3 = ZEROS
 18032           MOVE 'EXPIRED'        TO CRTSTATO
 18033        ELSE
 18034           MOVE 'ACTIVE  '       TO CRTSTATO.
 18035
 18036     IF WS-STATUS = '2'
 18037         MOVE 'PEND    '         TO CRTSTATO.
 18038
 18039     IF WS-STATUS = '3'
 18040         MOVE 'RESTORE '         TO CRTSTATO.
 18041
 18042     IF WS-STATUS = '5'
 18043         MOVE 'REISSUE '         TO CRTSTATO.
 18044
 18045     IF WS-STATUS = '6'
 18046         MOVE 'LMP DIS'          TO CRTSTATO.
 18047
 18048     IF WS-STATUS = '7'
 18049         MOVE 'DEATH'            TO CRTSTATO.
 18050
 18051     IF WS-STATUS = '8'
 18052         MOVE 'CANCEL'           TO CRTSTATO.
 18053
 18054     IF WS-STATUS = '9'
 18055         MOVE 'RE-ONLY '         TO CRTSTATO.
 18056
 18057     IF WS-STATUS = 'V'
 18058         MOVE 'VOID  '           TO CRTSTATO.
 18059
 18060     IF WS-STATUS = 'D'
 18061         MOVE 'DECLINE '         TO CRTSTATO.
 18062
 18063     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 18064         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 18065         MOVE '5'                TO CNTL-REC-TYPE
 18066     ELSE
 18067         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 18068         MOVE '4'                TO CNTL-REC-TYPE.
 18069
 18070     MOVE '** NONE **'           TO COVERO.
 18071     MOVE AL-SABON               TO COVERA.
 18072
 18073     IF PI-COMPANY-ID = 'CVL'
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 346
* EL156.cbl
 18074         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 18075             MOVE CM-BENEFICIARY TO LOANNOO
 18076             MOVE AL-UANON       TO LOANNOA.
 18077
 18078     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 18079        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 18080        MOVE +91                 TO  TRLR-SEQ-NO
 18081
 18082* EXEC CICS READ
 18083*           DATASET  ('ELTRLR')
 18084*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18085*           RIDFLD   (ELTRLR-KEY)
 18086*           RESP     (WS-RESPONSE)
 18087*       END-EXEC
 18088     MOVE 'ELTRLR' TO DFHEIV1
 18089*    MOVE '&"S        E          (  N#00016612' TO DFHEIV0
 18090     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18091     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18092     MOVE X'204E233030303136363132' TO DFHEIV0(25:11)
 18093     CALL 'kxdfhei1' USING DFHEIV0,
 18094           DFHEIV1,
 18095           DFHEIV20,
 18096           DFHEIV99,
 18097           ELTRLR-KEY,
 18098           DFHEIV99,
 18099           DFHEIV99,
 18100           DFHEIV99
 18101     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18102         DFHEIV20
 18103     MOVE EIBRESP  TO WS-RESPONSE
 18104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18105
 18106        IF WS-RESP-NORMAL
 18107           MOVE AT-INFO-LINE-1   TO  LOANNOO
 18108        ELSE
 18109           MOVE SPACES           TO  LOANNOO
 18110        END-IF
 18111*052506
 18112*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 18113*052506
 18114     END-IF
 18115
 18116     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 18117        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 18118
 18119     IF WS-BEN-CD = ZEROS
 18120         GO TO 7050-SHOW-CONTINUE.
 18121
 18122     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 18123     MOVE WS-ACCESS              TO CNTL-ACCESS.
 18124     MOVE +0                     TO CNTL-SEQ-NO.
 18125     MOVE 'BENE'                 TO FILE-SWITCH.
 18126
 18127     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 18128     IF BENEFIT-FOUND
 18129        MOVE CF-JOINT-INDICATOR (SUB-1)
 18130                                 TO PI-JOINT-COV-IND
 18131                                    PI-RB-JOINT-COV-IND
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 347
* EL156.cbl
 18132        MOVE CF-BENEFIT-DESCRIP (SUB-1)
 18133                                 TO COVERO
 18134        MOVE AL-SANON            TO COVERA
 18135     END-IF
 18136     if (cntl-rec-type = '4')   *> Life claim
 18137        and (cm-ah-benefit-cd not = zeros) *> AH coverage
 18138        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
 18139        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD
 18140        MOVE '5'              TO CNTL-REC-TYPE
 18141        MOVE WS-ACCESS        TO CNTL-ACCESS
 18142        MOVE +0               TO CNTL-SEQ-NO
 18143        MOVE 'BENE'           TO FILE-SWITCH
 18144        PERFORM 7200-FIND-BENEFIT
 18145                              THRU 7200-EXIT
 18146        IF (BENEFIT-FOUND)
 18147           and (pi-rb-joint-cov-ind) not = 'J'
 18148           MOVE CF-JOINT-INDICATOR (SUB-1)
 18149                              TO PI-rb-JOINT-COV-IND
 18150        end-if
 18151     end-if
 18152     .
 18153 7050-SHOW-CONTINUE.
 18154
 18155     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 18156        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 18157            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 18158     END-IF
 18159
 18160     IF PI-COMPANY-ID = 'DMD'
 18161         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 18162
 18163     MOVE -1                     TO PMTTYPEL.
 18164     GO TO 8100-SEND-INITIAL-MAP.
 18165
 18166 7100-SHOW-RECORD-NOT-FOUND.
 18167     IF FILE-SWITCH = 'MSTR'
 18168         MOVE ER-0204            TO EMI-ERROR.
 18169
 18170     IF FILE-SWITCH = 'CERT'
 18171         MOVE ER-0206            TO EMI-ERROR.
 18172
 18173     IF FILE-SWITCH = 'STAT'
 18174         MOVE ER-0149            TO EMI-ERROR.
 18175
 18176     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18177
 18178     MOVE -1                     TO PMTTYPEL.
 18179     GO TO 8100-SEND-INITIAL-MAP
 18180
 18181     .
 18182 7110-BUILD-PMT-TRLR.
 18183     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18184     MOVE +51                    TO TRLR-SEQ-NO
 18185
 18186* EXEC CICS READ
 18187*        DATASET  ('ELTRLR')
 18188*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18189*        RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 348
* EL156.cbl
 18190*        RESP     (WS-RESPONSE)
 18191*    END-EXEC
 18192     MOVE 'ELTRLR' TO DFHEIV1
 18193*    MOVE '&"S        E          (  N#00016698' TO DFHEIV0
 18194     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18195     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18196     MOVE X'204E233030303136363938' TO DFHEIV0(25:11)
 18197     CALL 'kxdfhei1' USING DFHEIV0,
 18198           DFHEIV1,
 18199           DFHEIV20,
 18200           DFHEIV99,
 18201           ELTRLR-KEY,
 18202           DFHEIV99,
 18203           DFHEIV99,
 18204           DFHEIV99
 18205     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18206         DFHEIV20
 18207     MOVE EIBRESP  TO WS-RESPONSE
 18208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18209     IF WS-RESP-NORMAL
 18210        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 18211     END-IF
 18212     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 18213
 18214* EXEC CICS GETMAIN
 18215*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18216*         LENGTH    (200)
 18217*         INITIMG   (GETMAIN-SPACE)
 18218*     END-EXEC
 18219     MOVE 200
 18220       TO DFHEIV11
 18221*    MOVE ',"IL                  $   #00016708' TO DFHEIV0
 18222     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18223     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18224     MOVE X'2020233030303136373038' TO DFHEIV0(25:11)
 18225     CALL 'kxdfhei1' USING DFHEIV0,
 18226           DFHEIV20,
 18227           DFHEIV11,
 18228           GETMAIN-SPACE
 18229     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18230         DFHEIV20
 18231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18232     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 18233                                    AT-PREV-PAID-THRU-DT
 18234     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 18235     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18236     MOVE 'AT'                   TO AT-RECORD-ID
 18237     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18238     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 18239     MOVE '2'                    TO AT-TRAILER-TYPE
 18240     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18241                                    AT-PAYMENT-LAST-MAINT-DT
 18242     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18243                                    AT-PAYMENT-LAST-UPDATED-BY
 18244     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18245     MOVE 'I'                    TO AT-PAYMENT-TYPE
 18246     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 18247     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 349
* EL156.cbl
 18248     MOVE +0                     TO AT-EXPENSE-PER-PMT
 18249     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 18250     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 18251     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 18252     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 18253     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 18254     if pi-int-to-rem-borr = 'Y'
 18255        move 'Q1'                to at-payee-type-cd
 18256     else
 18257        MOVE 'O1'                TO AT-PAYEE-TYPE-CD
 18258     end-if
 18259     MOVE PI-int-payees-name     TO AT-PAYEES-NAME
 18260     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 18261     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 18262     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 18263     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 18264                                    AT-TO-BE-WRITTEN-DT
 18265     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 18266                                    AT-CHECK-QUE-SEQUENCE
 18267                                    AT-ADDL-RESERVE
 18268     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 18269                                    AT-VOID-SELECT-DT
 18270                                    AT-VOID-ACCEPT-DT
 18271                                    AT-VOID-DT
 18272                                    AT-PMT-PROOF-DT
 18273                                    AT-INT-PMT-SELECT-DT
 18274     MOVE ZEROS                  TO AT-DAILY-RATE
 18275                                    AT-ELIMINATION-DAYS
 18276     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18277*    EXEC CICS HANDLE CONDITION
 18278*        DUPREC    (7120-DUPREC)
 18279*    END-EXEC
 18280     .
 18281 7115-WRITE-INT-TRLR.
 18282
 18283* EXEC CICS WRITE
 18284*         DATASET       ('ELTRLR')
 18285*         FROM          (ACTIVITY-TRAILERS)
 18286*         RIDFLD        (AT-CONTROL-PRIMARY)
 18287*         RESP          (WS-RESPONSE)
 18288*     END-EXEC
 18289     MOVE LENGTH OF
 18290      ACTIVITY-TRAILERS
 18291       TO DFHEIV11
 18292     MOVE 'ELTRLR' TO DFHEIV1
 18293*    MOVE '&$ L                  ''  N#00016763' TO DFHEIV0
 18294     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18295     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18296     MOVE X'204E233030303136373633' TO DFHEIV0(25:11)
 18297     CALL 'kxdfhei1' USING DFHEIV0,
 18298           DFHEIV1,
 18299           ACTIVITY-TRAILERS,
 18300           DFHEIV11,
 18301           AT-CONTROL-PRIMARY,
 18302           DFHEIV99,
 18303           DFHEIV99
 18304     MOVE EIBRESP  TO WS-RESPONSE
 18305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 350
* EL156.cbl
 18306      IF WS-RESP-DUPREC
 18307         GO TO 7120-DUPREC
 18308      END-IF
 18309     GO TO 7130-EXIT
 18310     .
 18311 7120-DUPREC.
 18312     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18313     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18314     GO TO 7115-WRITE-INT-TRLR
 18315     .
 18316 7130-EXIT.
 18317      EXIT.
 18318 7140-BUILD-NOTE-TRLR.
 18319
 18320
 18321* EXEC CICS GETMAIN
 18322*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18323*         LENGTH    (200)
 18324*         INITIMG   (GETMAIN-SPACE)
 18325*     END-EXEC
 18326     MOVE 200
 18327       TO DFHEIV11
 18328*    MOVE ',"IL                  $   #00016783' TO DFHEIV0
 18329     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18330     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18331     MOVE X'2020233030303136373833' TO DFHEIV0(25:11)
 18332     CALL 'kxdfhei1' USING DFHEIV0,
 18333           DFHEIV20,
 18334           DFHEIV11,
 18335           GETMAIN-SPACE
 18336     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18337         DFHEIV20
 18338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18339     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18340     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18341     MOVE 'AT'                   TO AT-RECORD-ID
 18342     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18343     MOVE '6'                    TO AT-TRAILER-TYPE
 18344     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18345                                    AT-GEN-INFO-LAST-MAINT-DT
 18346     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18347                                    AT-GEN-INFO-LAST-UPDATED-BY
 18348     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18349     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18350     .
 18351 7150-WRITE.
 18352
 18353* EXEC CICS HANDLE CONDITION
 18354*        DUPREC    (7160-DUPREC)
 18355*    END-EXEC
 18356*    MOVE '"$%                   ! : #00016801' TO DFHEIV0
 18357     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18359     MOVE X'3A20233030303136383031' TO DFHEIV0(25:11)
 18360     CALL 'kxdfhei1' USING DFHEIV0
 18361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18362
 18363* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 351
* EL156.cbl
 18364*         DATASET     ('ELTRLR')
 18365*         FROM        (ACTIVITY-TRAILERS)
 18366*         RIDFLD      (AT-CONTROL-PRIMARY)
 18367*         RESP        (WS-RESPONSE)
 18368*     END-EXEC
 18369     MOVE LENGTH OF
 18370      ACTIVITY-TRAILERS
 18371       TO DFHEIV11
 18372     MOVE 'ELTRLR' TO DFHEIV1
 18373*    MOVE '&$ L                  ''  N#00016804' TO DFHEIV0
 18374     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18375     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18376     MOVE X'204E233030303136383034' TO DFHEIV0(25:11)
 18377     CALL 'kxdfhei1' USING DFHEIV0,
 18378           DFHEIV1,
 18379           ACTIVITY-TRAILERS,
 18380           DFHEIV11,
 18381           AT-CONTROL-PRIMARY,
 18382           DFHEIV99,
 18383           DFHEIV99
 18384     MOVE EIBRESP  TO WS-RESPONSE
 18385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18386      IF WS-RESP-DUPREC
 18387         GO TO 7160-DUPREC
 18388      END-IF
 18389     GO TO 7170-EXIT
 18390     .
 18391 7160-DUPREC.
 18392     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18393     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18394     GO TO 7150-WRITE
 18395     .
 18396 7170-EXIT.
 18397      EXIT.
 18398
 18399 7180-ADD-CERT-NOTE.
 18400*ADD CERT NOTE FOR SC NP+6
 18401
 18402
 18403* EXEC CICS GETMAIN
 18404*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18405*         LENGTH    (150)
 18406*         INITIMG   (GETMAIN-SPACE)
 18407*     END-EXEC.
 18408     MOVE 150
 18409       TO DFHEIV11
 18410*    MOVE ',"IL                  $   #00016826' TO DFHEIV0
 18411     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18412     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18413     MOVE X'2020233030303136383236' TO DFHEIV0(25:11)
 18414     CALL 'kxdfhei1' USING DFHEIV0,
 18415           DFHEIV20,
 18416           DFHEIV11,
 18417           GETMAIN-SPACE
 18418     SET ADDRESS OF CERT-NOTE-FILE TO
 18419         DFHEIV20
 18420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18421
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 352
* EL156.cbl
 18422
 18423     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18424     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18425     MOVE +1                     TO WRK-NOTE-SEQ.
 18426     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18427     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18428     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18429     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18430     MOVE CL-CERT-STATE          TO CZ-STATE.
 18431     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18432     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18433     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18434     MOVE '2'                    TO CZ-RECORD-TYPE.
 18435     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18436     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18437     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18438     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18439     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18440     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18441     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18442     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18443     IF PI-COMPANY-ID = 'AHL'
 18444        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18445           CONTINUE
 18446        ELSE
 18447           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18448              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18449           ELSE
 18450              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18451           END-IF
 18452        END-IF
 18453     END-IF
 18454     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18455     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18456
 18457 7181-WRITE.
 18458
 18459
 18460* EXEC CICS WRITE
 18461*         DATASET     ('ERCNOT')
 18462*         FROM        (CERT-NOTE-FILE)
 18463*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18464*         RESP        (WS-RESPONSE)
 18465*    END-EXEC.
 18466     MOVE LENGTH OF
 18467      CERT-NOTE-FILE
 18468       TO DFHEIV11
 18469     MOVE 'ERCNOT' TO DFHEIV1
 18470*    MOVE '&$ L                  ''  N#00016868' TO DFHEIV0
 18471     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18472     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18473     MOVE X'204E233030303136383638' TO DFHEIV0(25:11)
 18474     CALL 'kxdfhei1' USING DFHEIV0,
 18475           DFHEIV1,
 18476           CERT-NOTE-FILE,
 18477           DFHEIV11,
 18478           CZ-CONTROL-PRIMARY,
 18479           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 353
* EL156.cbl
 18480           DFHEIV99
 18481     MOVE EIBRESP  TO WS-RESPONSE
 18482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18483
 18484
 18485     IF WS-RESP-DUPREC
 18486         GO TO 7182-DUPREC
 18487     END-IF.
 18488
 18489     SET CERT-NOTE-ADDED TO TRUE.
 18490
 18491     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18492         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18493     END-IF.
 18494
 18495     GO TO 7189-EXIT.
 18496
 18497 7182-DUPREC.
 18498
 18499     ADD +1                      TO  WRK-NOTE-SEQ.
 18500     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18501     GO TO 7181-WRITE.
 18502
 18503 7189-EXIT.
 18504      EXIT.
 18505
 18506 7190-ADD-ORIG-NOTE.
 18507
 18508
 18509* EXEC CICS GETMAIN
 18510*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18511*         LENGTH    (150)
 18512*         INITIMG   (GETMAIN-SPACE)
 18513*     END-EXEC.
 18514     MOVE 150
 18515       TO DFHEIV11
 18516*    MOVE ',"IL                  $   #00016898' TO DFHEIV0
 18517     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18518     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18519     MOVE X'2020233030303136383938' TO DFHEIV0(25:11)
 18520     CALL 'kxdfhei1' USING DFHEIV0,
 18521           DFHEIV20,
 18522           DFHEIV11,
 18523           GETMAIN-SPACE
 18524     SET ADDRESS OF CERT-NOTE-FILE TO
 18525         DFHEIV20
 18526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18527
 18528
 18529     ADD +1                      TO WRK-NOTE-SEQ.
 18530     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18531     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18532     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18533     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18534     MOVE CL-CERT-STATE          TO CZ-STATE.
 18535     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18536     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18537     MOVE CL-CERT-NO             TO CZ-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 354
* EL156.cbl
 18538     MOVE '2'                    TO CZ-RECORD-TYPE.
 18539     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18540     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18541     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18542     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18543     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18544     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18545
 18546 7191-WRITE.
 18547
 18548
 18549* EXEC CICS WRITE
 18550*         DATASET     ('ERCNOT')
 18551*         FROM        (CERT-NOTE-FILE)
 18552*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18553*         RESP        (WS-RESPONSE)
 18554*    END-EXEC.
 18555     MOVE LENGTH OF
 18556      CERT-NOTE-FILE
 18557       TO DFHEIV11
 18558     MOVE 'ERCNOT' TO DFHEIV1
 18559*    MOVE '&$ L                  ''  N#00016923' TO DFHEIV0
 18560     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18561     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18562     MOVE X'204E233030303136393233' TO DFHEIV0(25:11)
 18563     CALL 'kxdfhei1' USING DFHEIV0,
 18564           DFHEIV1,
 18565           CERT-NOTE-FILE,
 18566           DFHEIV11,
 18567           CZ-CONTROL-PRIMARY,
 18568           DFHEIV99,
 18569           DFHEIV99
 18570     MOVE EIBRESP  TO WS-RESPONSE
 18571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18572
 18573
 18574     IF WS-RESP-DUPREC
 18575         GO TO 7192-DUPREC
 18576     END-IF.
 18577
 18578     GO TO 7199-EXIT.
 18579
 18580 7192-DUPREC.
 18581
 18582     ADD +1                      TO  WRK-NOTE-SEQ.
 18583     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18584     GO TO 7191-WRITE.
 18585
 18586 7199-EXIT.
 18587      EXIT.
 18588 7200-FIND-BENEFIT.
 18589     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18590
 18591
 18592* EXEC CICS HANDLE CONDITION
 18593*        ENDFILE(7200-EXIT)
 18594*        NOTFND(7200-EXIT)
 18595*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 355
* EL156.cbl
 18596*    MOVE '"$''I                  ! ; #00016947' TO DFHEIV0
 18597     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18599     MOVE X'3B20233030303136393437' TO DFHEIV0(25:11)
 18600     CALL 'kxdfhei1' USING DFHEIV0
 18601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18602
 18603
 18604
 18605* EXEC CICS READ
 18606*        DATASET('ELCNTL')
 18607*        SET(ADDRESS OF CONTROL-FILE)
 18608*        RIDFLD(ELCNTL-KEY)
 18609*        GTEQ
 18610*    END-EXEC.
 18611     MOVE 'ELCNTL' TO DFHEIV1
 18612*    MOVE '&"S        G          (   #00016952' TO DFHEIV0
 18613     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18614     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18615     MOVE X'2020233030303136393532' TO DFHEIV0(25:11)
 18616     CALL 'kxdfhei1' USING DFHEIV0,
 18617           DFHEIV1,
 18618           DFHEIV20,
 18619           DFHEIV99,
 18620           ELCNTL-KEY,
 18621           DFHEIV99,
 18622           DFHEIV99,
 18623           DFHEIV99
 18624     SET ADDRESS OF CONTROL-FILE TO
 18625         DFHEIV20
 18626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18627
 18628
 18629     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18630        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18631           GO TO 7200-EXIT.
 18632
 18633     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18634         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18635            ((SUB-1 > 8) OR
 18636            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18637
 18638     IF SUB-1 NOT = 9
 18639         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18640
 18641     GO TO 7200-EXIT.
 18642
 18643 7200-BENEFIT-DUMMY.
 18644
 18645 7200-DUMMY-EXIT.
 18646     EXIT.
 18647
 18648 7200-EXIT.
 18649     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 356
* EL156.cbl
 18651*052506
 18652*052506 7250-FIND-LETTER-TRLR.
 18653*052506     EXEC CICS HANDLE CONDITION
 18654*052506         ENDFILE  (7250-END)
 18655*052506         NOTFND   (7250-END)
 18656*052506     END-EXEC.
 18657*052506
 18658*052506     EXEC CICS STARTBR
 18659*052506         DATASET   ('ELTRLR')
 18660*052506         RIDFLD    (ELTRLR-KEY)
 18661*052506         GTEQ
 18662*052506     END-EXEC.
 18663*052506
 18664*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18665*052506
 18666*052506 7250-FIND-LOOP.
 18667*052506     EXEC CICS READNEXT
 18668*052506         DATASET   ('ELTRLR')
 18669*052506         RIDFLD    (ELTRLR-KEY)
 18670*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18671*052506     END-EXEC.
 18672*052506
 18673*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18674*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18675*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18676*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18677*052506        GO TO 7250-END
 18678*052506     END-IF.
 18679*052506
 18680*052506     IF AT-TRAILER-TYPE NOT = '4'
 18681*052506         GO TO 7250-FIND-LOOP
 18682*052506     END-IF.
 18683*052506
 18684*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18685*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18686*052506     END-IF.
 18687*052506
 18688*052506     GO TO 7250-FIND-LOOP.
 18689*052506
 18690*052506 7250-END.
 18691*052506
 18692*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18693*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18694*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18695*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18696*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18697*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18698*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18699*052506     END-IF.
 18700*052506
 18701*052506     EXEC CICS ENDBR
 18702*052506          DATASET    ('ELTRLR')
 18703*052506     END-EXEC.
 18704*052506
 18705*052506 7250-EXIT.
 18706*052506     EXIT.
 18707*052506     EJECT
 18708*052506
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 357
* EL156.cbl
 18709 7300-CHECK-AUTO-ACTIVITY.
 18710
 18711     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18712         NEXT SENTENCE
 18713     ELSE
 18714         GO TO 7399-EXIT.
 18715
 18716     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18717
 18718     IF WS-ACT-REC-FOUND-SW = 'N'
 18719         GO TO 7399-EXIT.
 18720
 18721     IF PI-ACTIVITY-CODE = 09
 18722         GO TO 7300-CONT-AUTO-ACTIVITY.
 18723
 18724     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18725        (PI-ACTIVITY-CODE = 11)
 18726         GO TO 7300-CONT-AUTO-ACTIVITY.
 18727
 18728     IF PI-PROVISIONAL-IND = 'P'
 18729         IF PI-PMTTYPE = '1'
 18730             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18731                 MOVE 'N'    TO  PI-RESET-SW
 18732                 GO TO 7399-EXIT.
 18733
 18734     IF PI-PMTTYPE = '1'
 18735         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18736             MOVE 'N'        TO  PI-RESET-SW
 18737             GO TO 7399-EXIT.
 18738
 18739     IF PI-PMTTYPE = '2' OR '3'
 18740         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18741             MOVE 'N'        TO  PI-RESET-SW
 18742             GO TO 7399-EXIT.
 18743
 18744     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18745         IF PI-PROVISIONAL-IND = 'P'
 18746             NEXT SENTENCE
 18747         ELSE
 18748             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18749
 18750 7300-CONT-AUTO-ACTIVITY.
 18751
 18752     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18753         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18754         MOVE '4'            TO DC-OPTION-CODE
 18755         MOVE +0             TO DC-ELAPSED-DAYS
 18756                                DC-ELAPSED-MONTHS
 18757         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18758         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18759         IF PI-USES-PAID-TO
 18760             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18761             IF NO-CONVERSION-ERROR
 18762                 MOVE +1     TO DC-ELAPSED-DAYS
 18763                 MOVE +0     TO DC-ELAPSED-MONTHS
 18764                 MOVE '6'    TO DC-OPTION-CODE
 18765                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18766                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 358
* EL156.cbl
 18767                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18768
 18769     IF PI-PFKEY-USED = DFHPF5
 18770         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18771         IF PI-USES-PAID-TO
 18772             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18773             MOVE +1                  TO DC-ELAPSED-DAYS
 18774             MOVE +0                  TO DC-ELAPSED-MONTHS
 18775             MOVE '6'                 TO DC-OPTION-CODE
 18776             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18777             IF NO-CONVERSION-ERROR
 18778                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18779
 18780     IF WS-CHK-THRU-DT < PI-EXP-DT
 18781         NEXT SENTENCE
 18782     ELSE
 18783         MOVE 03                     TO  WS-ACTIVITY-CODE
 18784         GO TO 7390-PROCESS-ACTIVITY.
 18785
 18786     IF PI-PROV-PMT
 18787         MOVE 09                     TO  WS-ACTIVITY-CODE
 18788     ELSE
 18789        IF PI-PMTTYPE = '1'
 18790            MOVE 02                  TO  WS-ACTIVITY-CODE
 18791        ELSE
 18792        IF PI-PMTTYPE = '2' OR '3'
 18793            MOVE 07                  TO  WS-ACTIVITY-CODE
 18794        ELSE
 18795        IF PI-PMTTYPE = '4'
 18796            MOVE 00                  TO  WS-ACTIVITY-CODE
 18797        ELSE
 18798            MOVE 'N'                 TO  PI-RESET-SW
 18799            GO TO 7399-EXIT.
 18800
 18801 7390-PROCESS-ACTIVITY.
 18802
 18803     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18804
 18805 7399-EXIT.
 18806     EXIT.
 18807
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 359
* EL156.cbl
 18809 7400-CHECK-AUTO-ACTIVITY.
 18810
 18811
 18812* EXEC CICS HANDLE CONDITION
 18813*        NOTFND   (7400-NOT-FOUND)
 18814*    END-EXEC.
 18815*    MOVE '"$I                   ! < #00017141' TO DFHEIV0
 18816     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18817     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18818     MOVE X'3C20233030303137313431' TO DFHEIV0(25:11)
 18819     CALL 'kxdfhei1' USING DFHEIV0
 18820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18821
 18822
 18823     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18824     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18825     MOVE SPACES                 TO  CNTL-ACCESS.
 18826     MOVE +0                     TO  CNTL-SEQ-NO.
 18827
 18828
 18829* EXEC CICS READ
 18830*        DATASET   ('ELCNTL')
 18831*        RIDFLD    (ELCNTL-KEY)
 18832*        SET       (ADDRESS OF CONTROL-FILE)
 18833*    END-EXEC.
 18834     MOVE 'ELCNTL' TO DFHEIV1
 18835*    MOVE '&"S        E          (   #00017150' TO DFHEIV0
 18836     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18837     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18838     MOVE X'2020233030303137313530' TO DFHEIV0(25:11)
 18839     CALL 'kxdfhei1' USING DFHEIV0,
 18840           DFHEIV1,
 18841           DFHEIV20,
 18842           DFHEIV99,
 18843           ELCNTL-KEY,
 18844           DFHEIV99,
 18845           DFHEIV99,
 18846           DFHEIV99
 18847     SET ADDRESS OF CONTROL-FILE TO
 18848         DFHEIV20
 18849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18850
 18851
 18852     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18853     GO TO 7400-EXIT.
 18854
 18855 7400-NOT-FOUND.
 18856     MOVE 'N'                        TO  PI-RESET-SW
 18857                                         WS-LETTER-SW
 18858                                         WS-ACT-REC-FOUND-SW.
 18859
 18860     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18861
 18862 7400-EXIT.
 18863     EXIT.
 18864
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 360
* EL156.cbl
 18866 7450-FORMAT-AUTO-LETTER.
 18867
 18868     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18869         MOVE 'Y'                    TO PI-RESET-SW
 18870         GO TO 7450-CONTINUE-PROCESS.
 18871
 18872     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18873
 18874     IF SUB > 9
 18875         SUBTRACT 9 FROM SUB
 18876         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18877     ELSE
 18878         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18879
 18880 7450-CONTINUE-PROCESS.
 18881
 18882     IF WS-ACTIVITY-CODE = ZEROS
 18883         MOVE 'N'                    TO  WS-LETTER-SW
 18884         GO TO 7450-EXIT.
 18885
 18886     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18887
 18888     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18889         MOVE 'N'                    TO  PI-RESET-SW
 18890                                         WS-LETTER-SW
 18891         GO TO 7450-EXIT.
 18892
 18893     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18894         MOVE 'N'                    TO  WS-LETTER-SW
 18895         GO TO 7450-EXIT.
 18896
 18897     MOVE 'Y'                        TO  WS-LETTER-SW.
 18898     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18899     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18900
 18901     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18902
 18903     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18904         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18905         MOVE '6'                    TO  DC-OPTION-CODE
 18906         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18907         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18908         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18909         IF NO-CONVERSION-ERROR
 18910             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18911         ELSE
 18912              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18913
 18914     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18915         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18916         MOVE '6'                    TO  DC-OPTION-CODE
 18917         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18918         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18919         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18920         IF NO-CONVERSION-ERROR
 18921             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18922         ELSE
 18923             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 361
* EL156.cbl
 18924
 18925 7450-EXIT.
 18926     EXIT.
 18927
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 362
* EL156.cbl
 18929 7500-RESET-AUTO-ACTIVITY.
 18930
 18931     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18932     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18933     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18934     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18935     MOVE +100                   TO  TRLR-SEQ-NO.
 18936
 18937 7500-STARTBR-TRLR.
 18938
 18939
 18940* EXEC CICS HANDLE CONDITION
 18941*        ENDFILE  (7590-END)
 18942*        NOTFND   (7590-END)
 18943*    END-EXEC.
 18944*    MOVE '"$''I                  ! = #00017243' TO DFHEIV0
 18945     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18946     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18947     MOVE X'3D20233030303137323433' TO DFHEIV0(25:11)
 18948     CALL 'kxdfhei1' USING DFHEIV0
 18949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18950
 18951
 18952
 18953* EXEC CICS STARTBR
 18954*        DATASET   ('ELTRLR')
 18955*        RIDFLD    (ELTRLR-KEY)
 18956*        GTEQ
 18957*    END-EXEC.
 18958     MOVE 'ELTRLR' TO DFHEIV1
 18959     MOVE 0
 18960       TO DFHEIV11
 18961*    MOVE '&,         G          &   #00017248' TO DFHEIV0
 18962     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18963     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18964     MOVE X'2020233030303137323438' TO DFHEIV0(25:11)
 18965     CALL 'kxdfhei1' USING DFHEIV0,
 18966           DFHEIV1,
 18967           ELTRLR-KEY,
 18968           DFHEIV99,
 18969           DFHEIV11,
 18970           DFHEIV99
 18971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18972
 18973
 18974     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18975
 18976 7500-READ-NEXT.
 18977
 18978
 18979* EXEC CICS READNEXT
 18980*        DATASET   ('ELTRLR')
 18981*        RIDFLD    (ELTRLR-KEY)
 18982*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18983*    END-EXEC.
 18984     MOVE 'ELTRLR' TO DFHEIV1
 18985     MOVE 0
 18986       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 363
* EL156.cbl
 18987*    MOVE '&.S                   )   #00017258' TO DFHEIV0
 18988     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18989     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18990     MOVE X'2020233030303137323538' TO DFHEIV0(25:11)
 18991     CALL 'kxdfhei1' USING DFHEIV0,
 18992           DFHEIV1,
 18993           DFHEIV20,
 18994           DFHEIV99,
 18995           ELTRLR-KEY,
 18996           DFHEIV99,
 18997           DFHEIV11,
 18998           DFHEIV99,
 18999           DFHEIV99
 19000     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19001         DFHEIV20
 19002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19003
 19004
 19005     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 19006        PI-CARRIER    NOT = TRLR-CARRIER  OR
 19007        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 19008        PI-CERT-NO    NOT = TRLR-CERT-NO
 19009         GO TO 7590-END.
 19010
 19011     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 19012         GO TO 7500-READ-NEXT.
 19013
 19014     IF AT-TRAILER-TYPE NOT = '4'
 19015         GO TO 7500-READ-NEXT.
 19016
 19017     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 19018         GO TO 7500-READ-NEXT.
 19019
 19020     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 19021        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 19022         GO TO 7500-READ-NEXT.
 19023
 19024     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 19025        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 19026        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 19027         GO TO 7500-READ-NEXT.
 19028
 19029     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 19030                         AND
 19031        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 19032                         AND
 19033        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 19034            GO TO 7500-READ-NEXT.
 19035
 19036     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 19037
 19038
 19039* EXEC CICS ENDBR
 19040*        DATASET   ('ELTRLR')
 19041*    END-EXEC.
 19042     MOVE 'ELTRLR' TO DFHEIV1
 19043     MOVE 0
 19044       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 364
* EL156.cbl
 19045*    MOVE '&2                    $   #00017297' TO DFHEIV0
 19046     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19047     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19048     MOVE X'2020233030303137323937' TO DFHEIV0(25:11)
 19049     CALL 'kxdfhei1' USING DFHEIV0,
 19050           DFHEIV1,
 19051           DFHEIV11,
 19052           DFHEIV99
 19053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19054
 19055
 19056     MOVE 'N'                        TO  WS-BROWSE-SW.
 19057
 19058
 19059* EXEC CICS READ
 19060*        DATASET   ('ELTRLR')
 19061*        RIDFLD    (ELTRLR-KEY)
 19062*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19063*        UPDATE
 19064*    END-EXEC.
 19065     MOVE 'ELTRLR' TO DFHEIV1
 19066*    MOVE '&"S        EU         (   #00017303' TO DFHEIV0
 19067     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19068     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19069     MOVE X'2020233030303137333033' TO DFHEIV0(25:11)
 19070     CALL 'kxdfhei1' USING DFHEIV0,
 19071           DFHEIV1,
 19072           DFHEIV20,
 19073           DFHEIV99,
 19074           ELTRLR-KEY,
 19075           DFHEIV99,
 19076           DFHEIV99,
 19077           DFHEIV99
 19078     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19079         DFHEIV20
 19080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19081
 19082
 19083     MOVE 'Y'                        TO  WS-UPDATE-SW.
 19084
 19085     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 19086         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 19087     ELSE
 19088         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 19089             NEXT SENTENCE
 19090         ELSE
 19091             GO TO 7500-REWRITE-TRLR.
 19092
 19093     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 19094
 19095     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 19096     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 19097     MOVE '1'                        TO  ARCH-REC-TYPE.
 19098     MOVE +0                         TO  ARCH-SEQ.
 19099
 19100     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 19101
 19102 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 365
* EL156.cbl
 19103
 19104
 19105* EXEC CICS REWRITE
 19106*        DATASET   ('ELTRLR')
 19107*        FROM      (ACTIVITY-TRAILERS)
 19108*    END-EXEC.
 19109     MOVE LENGTH OF
 19110      ACTIVITY-TRAILERS
 19111       TO DFHEIV11
 19112     MOVE 'ELTRLR' TO DFHEIV1
 19113*    MOVE '&& L                  %   #00017331' TO DFHEIV0
 19114     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19115     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19116     MOVE X'2020233030303137333331' TO DFHEIV0(25:11)
 19117     CALL 'kxdfhei1' USING DFHEIV0,
 19118           DFHEIV1,
 19119           ACTIVITY-TRAILERS,
 19120           DFHEIV11,
 19121           DFHEIV99
 19122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19123
 19124
 19125     GO TO 7500-STARTBR-TRLR.
 19126
 19127 7590-END.
 19128
 19129     IF WS-BROWSE-SW = 'Y'
 19130         MOVE 'N'                    TO  WS-BROWSE-SW
 19131
 19132* EXEC CICS ENDBR
 19133*            DATASET   ('ELTRLR')
 19134*        END-EXEC.
 19135     MOVE 'ELTRLR' TO DFHEIV1
 19136     MOVE 0
 19137       TO DFHEIV11
 19138*    MOVE '&2                    $   #00017342' TO DFHEIV0
 19139     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19140     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19141     MOVE X'2020233030303137333432' TO DFHEIV0(25:11)
 19142     CALL 'kxdfhei1' USING DFHEIV0,
 19143           DFHEIV1,
 19144           DFHEIV11,
 19145           DFHEIV99
 19146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19147
 19148
 19149 7599-EXIT.
 19150     EXIT.
 19151
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 366
* EL156.cbl
 19153 7600-READ-ARCH-UPDATE.
 19154
 19155
 19156* EXEC CICS HANDLE CONDITION
 19157*        NOTFND   (7699-EXIT)
 19158*    END-EXEC.
 19159*    MOVE '"$I                   ! > #00017352' TO DFHEIV0
 19160     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19162     MOVE X'3E20233030303137333532' TO DFHEIV0(25:11)
 19163     CALL 'kxdfhei1' USING DFHEIV0
 19164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19165
 19166
 19167
 19168* EXEC CICS READ
 19169*        DATASET   ('ELARCH')
 19170*        RIDFLD    (ELARCH-KEY)
 19171*        SET       (ADDRESS OF LETTER-ARCHIVE)
 19172*        UPDATE
 19173*    END-EXEC.
 19174     MOVE 'ELARCH' TO DFHEIV1
 19175*    MOVE '&"S        EU         (   #00017356' TO DFHEIV0
 19176     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19177     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19178     MOVE X'2020233030303137333536' TO DFHEIV0(25:11)
 19179     CALL 'kxdfhei1' USING DFHEIV0,
 19180           DFHEIV1,
 19181           DFHEIV20,
 19182           DFHEIV99,
 19183           ELARCH-KEY,
 19184           DFHEIV99,
 19185           DFHEIV99,
 19186           DFHEIV99
 19187     SET ADDRESS OF LETTER-ARCHIVE TO
 19188         DFHEIV20
 19189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19190
 19191
 19192     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 19193
 19194
 19195* EXEC CICS REWRITE
 19196*        DATASET   ('ELARCH')
 19197*        FROM      (LETTER-ARCHIVE)
 19198*    END-EXEC.
 19199     MOVE LENGTH OF
 19200      LETTER-ARCHIVE
 19201       TO DFHEIV11
 19202     MOVE 'ELARCH' TO DFHEIV1
 19203*    MOVE '&& L                  %   #00017365' TO DFHEIV0
 19204     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19205     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19206     MOVE X'2020233030303137333635' TO DFHEIV0(25:11)
 19207     CALL 'kxdfhei1' USING DFHEIV0,
 19208           DFHEIV1,
 19209           LETTER-ARCHIVE,
 19210           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 367
* EL156.cbl
 19211           DFHEIV99
 19212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19213
 19214
 19215 7699-EXIT.
 19216     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 368
* EL156.cbl
 19218 7700-GET-DCT.
 19219
 19220     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 19221     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 19222     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 19223     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 19224                                    PI-MAX-BENEFIT-AMT
 19225                                    PI-MAX-BENEFIT-PYMT
 19226                                    PI-MIN-PAYMENT-AMT
 19227                                    PI-TIME-OF-LOSS-BAL.
 19228
 19229
 19230* EXEC CICS HANDLE CONDITION
 19231*         NOTFND (5300-NOTE-NOT-FOUND)
 19232*     END-EXEC.
 19233*    MOVE '"$I                   ! ? #00017384' TO DFHEIV0
 19234     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19235     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19236     MOVE X'3F20233030303137333834' TO DFHEIV0(25:11)
 19237     CALL 'kxdfhei1' USING DFHEIV0
 19238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19239
 19240
 19241
 19242* EXEC CICS READ
 19243*         DATASET('ERNOTE')
 19244*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 19245*         RIDFLD (W-NOTE-KEY)
 19246*     END-EXEC.
 19247     MOVE 'ERNOTE' TO DFHEIV1
 19248*    MOVE '&"S        E          (   #00017388' TO DFHEIV0
 19249     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19250     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19251     MOVE X'2020233030303137333838' TO DFHEIV0(25:11)
 19252     CALL 'kxdfhei1' USING DFHEIV0,
 19253           DFHEIV1,
 19254           DFHEIV20,
 19255           DFHEIV99,
 19256           W-NOTE-KEY,
 19257           DFHEIV99,
 19258           DFHEIV99,
 19259           DFHEIV99
 19260     SET ADDRESS OF CERTIFICATE-NOTE TO
 19261         DFHEIV20
 19262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19263
 19264
 19265     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 19266     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 19267     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 19268     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 19269     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 19270
 19271     IF PI-PAYEE-TYPE NOT = 'B'
 19272         GO TO 7700-EXIT.
 19273
 19274     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19275     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 369
* EL156.cbl
 19276     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19277
 19278     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19279         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19280     ELSE
 19281         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19282
 19283     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19284     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19285     MOVE 'DLO006'               TO PGM-NAME.
 19286
 19287
 19288* EXEC CICS LINK
 19289*        PROGRAM    (PGM-NAME)
 19290*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19291*        LENGTH     (DCT-RCRD-LENGTH)
 19292*    END-EXEC.
 19293*    MOVE '."C                   (   #00017416' TO DFHEIV0
 19294     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19295     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19296     MOVE X'2020233030303137343136' TO DFHEIV0(25:11)
 19297     CALL 'kxdfhei1' USING DFHEIV0,
 19298           PGM-NAME,
 19299           DCT-COMMUNICATION-AREA,
 19300           DCT-RCRD-LENGTH,
 19301           DFHEIV99,
 19302           DFHEIV99,
 19303           DFHEIV99,
 19304           DFHEIV99
 19305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19306
 19307
 19308     IF DCT-RETURN-CODE = 'OK'
 19309         GO TO 7700-CONT.
 19310
 19311     IF DCT-RETURN-CODE = '01' OR '02'
 19312         GO TO 7700-SET-TO-YES.
 19313
 19314     IF DCT-RETURN-CODE = '03'
 19315
 19316* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19317*    MOVE '6"R                   !   #00017429' TO DFHEIV0
 19318     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19319     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19320     MOVE X'2020233030303137343239' TO DFHEIV0(25:11)
 19321     CALL 'kxdfhei1' USING DFHEIV0
 19322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19323         MOVE ER-0951            TO EMI-ERROR
 19324         MOVE -1                 TO PMTTYPEL
 19325         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19326         GO TO 8200-SEND-DATAONLY.
 19327
 19328     IF DCT-RETURN-CODE = '04'
 19329
 19330* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19331*    MOVE '6"R                   !   #00017436' TO DFHEIV0
 19332     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19333     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 370
* EL156.cbl
 19334     MOVE X'2020233030303137343336' TO DFHEIV0(25:11)
 19335     CALL 'kxdfhei1' USING DFHEIV0
 19336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19337         MOVE ER-0946            TO EMI-ERROR
 19338         MOVE -1                 TO PMTTYPEL
 19339         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19340         GO TO 8200-SEND-DATAONLY.
 19341
 19342     IF DCT-RETURN-CODE = '05'
 19343
 19344* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19345*    MOVE '6"R                   !   #00017443' TO DFHEIV0
 19346     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19347     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19348     MOVE X'2020233030303137343433' TO DFHEIV0(25:11)
 19349     CALL 'kxdfhei1' USING DFHEIV0
 19350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19351         MOVE ER-0947            TO EMI-ERROR
 19352         MOVE -1                 TO PMTTYPEL
 19353         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19354         GO TO 8200-SEND-DATAONLY.
 19355
 19356     IF DCT-RETURN-CODE = '06'
 19357
 19358* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19359*    MOVE '6"R                   !   #00017450' TO DFHEIV0
 19360     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19362     MOVE X'2020233030303137343530' TO DFHEIV0(25:11)
 19363     CALL 'kxdfhei1' USING DFHEIV0
 19364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19365         MOVE ER-0921            TO EMI-ERROR
 19366         MOVE -1                 TO PMTTYPEL
 19367         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19368         GO TO 8200-SEND-DATAONLY.
 19369
 19370     IF DCT-RETURN-CODE = '07'
 19371
 19372* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19373*    MOVE '6"R                   !   #00017457' TO DFHEIV0
 19374     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19375     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19376     MOVE X'2020233030303137343537' TO DFHEIV0(25:11)
 19377     CALL 'kxdfhei1' USING DFHEIV0
 19378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19379         MOVE ER-0919            TO EMI-ERROR
 19380         MOVE -1                 TO PMTTYPEL
 19381         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19382         GO TO 8200-SEND-DATAONLY.
 19383
 19384     IF DCT-RETURN-CODE = '08'
 19385
 19386* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19387*    MOVE '6"R                   !   #00017464' TO DFHEIV0
 19388     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19389     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19390     MOVE X'2020233030303137343634' TO DFHEIV0(25:11)
 19391     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 371
* EL156.cbl
 19392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19393         MOVE ER-0948            TO EMI-ERROR
 19394         MOVE -1                 TO PMTTYPEL
 19395         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19396         GO TO 8200-SEND-DATAONLY.
 19397
 19398     IF DCT-RETURN-CODE = 'N1'
 19399
 19400* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19401*    MOVE '6"R                   !   #00017471' TO DFHEIV0
 19402     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19403     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19404     MOVE X'2020233030303137343731' TO DFHEIV0(25:11)
 19405     CALL 'kxdfhei1' USING DFHEIV0
 19406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19407         MOVE ER-0950            TO EMI-ERROR
 19408         MOVE -1                 TO PMTTYPEL
 19409         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19410         GO TO 8200-SEND-DATAONLY.
 19411
 19412     IF DCT-RETURN-CODE = 'E1'
 19413
 19414* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19415*    MOVE '6"R                   !   #00017478' TO DFHEIV0
 19416     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19417     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19418     MOVE X'2020233030303137343738' TO DFHEIV0(25:11)
 19419     CALL 'kxdfhei1' USING DFHEIV0
 19420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19421         MOVE ER-0974            TO EMI-ERROR
 19422         MOVE -1                 TO PMTTYPEL
 19423         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19424         GO TO 8200-SEND-DATAONLY.
 19425
 19426     IF DCT-RETURN-CODE = 'E2'
 19427
 19428* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19429*    MOVE '6"R                   !   #00017485' TO DFHEIV0
 19430     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19431     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19432     MOVE X'2020233030303137343835' TO DFHEIV0(25:11)
 19433     CALL 'kxdfhei1' USING DFHEIV0
 19434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19435         MOVE ER-0975            TO EMI-ERROR
 19436         MOVE -1                 TO PMTTYPEL
 19437         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19438         GO TO 8200-SEND-DATAONLY.
 19439
 19440     IF DCT-RETURN-CODE NOT = 'OK'
 19441
 19442* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19443*    MOVE '6"R                   !   #00017492' TO DFHEIV0
 19444     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19445     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19446     MOVE X'2020233030303137343932' TO DFHEIV0(25:11)
 19447     CALL 'kxdfhei1' USING DFHEIV0
 19448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19449         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 372
* EL156.cbl
 19450         MOVE -1                 TO PMTTYPEL
 19451         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19452         GO TO 8200-SEND-DATAONLY.
 19453
 19454 7700-CONT.
 19455
 19456*    MOVE 'N'                    TO CASHO.
 19457*    MOVE +1                     TO CASHL.
 19458*    MOVE AL-UANON               TO CASHA.
 19459
 19460     IF PI-OFFLINE = 'Y'
 19461         GO TO 7700-EXIT.
 19462
 19463     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19464     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19465     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19466     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19467     MOVE +7                     TO CHECKNOL.
 19468     MOVE AL-UANON               TO CHECKNOA.
 19469     GO TO 7700-EXIT.
 19470
 19471 7700-SET-TO-YES.
 19472
 19473*    MOVE 'Y'                    TO CASHO.
 19474*    MOVE +1                     TO CASHL.
 19475*    MOVE AL-UANON               TO CASHA.
 19476
 19477 7700-EXIT.
 19478     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 373
* EL156.cbl
 19480 7800-READ-COMP-MSTR.
 19481
 19482
 19483* EXEC CICS HANDLE CONDITION
 19484*        NOTFND   (7800-COMP-NOTFND)
 19485*    END-EXEC.
 19486*    MOVE '"$I                   ! @ #00017526' TO DFHEIV0
 19487     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19488     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19489     MOVE X'4020233030303137353236' TO DFHEIV0(25:11)
 19490     CALL 'kxdfhei1' USING DFHEIV0
 19491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19492
 19493
 19494
 19495* EXEC CICS READ
 19496*        DATASET   ('ERCOMP')
 19497*        RIDFLD    (ERCOMP-KEY)
 19498*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19499*    END-EXEC.
 19500     MOVE 'ERCOMP' TO DFHEIV1
 19501*    MOVE '&"S        E          (   #00017530' TO DFHEIV0
 19502     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19503     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19504     MOVE X'2020233030303137353330' TO DFHEIV0(25:11)
 19505     CALL 'kxdfhei1' USING DFHEIV0,
 19506           DFHEIV1,
 19507           DFHEIV20,
 19508           DFHEIV99,
 19509           ERCOMP-KEY,
 19510           DFHEIV99,
 19511           DFHEIV99,
 19512           DFHEIV99
 19513     SET ADDRESS OF COMPENSATION-MASTER TO
 19514         DFHEIV20
 19515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19516
 19517
 19518     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19519     GO TO 7800-COMP-EXIT.
 19520
 19521 7800-COMP-NOTFND.
 19522     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19523
 19524 7800-COMP-EXIT.
 19525     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 374
* EL156.cbl
 19527 7900-READ-CLAIM.
 19528
 19529* EXEC CICS READ
 19530*        DATASET  ('ELMSTR')
 19531*        SET      (ADDRESS OF CLAIM-MASTER)
 19532*        RIDFLD   (ELMSTR-KEY)
 19533*    END-EXEC.
 19534     MOVE 'ELMSTR' TO DFHEIV1
 19535*    MOVE '&"S        E          (   #00017546' TO DFHEIV0
 19536     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19538     MOVE X'2020233030303137353436' TO DFHEIV0(25:11)
 19539     CALL 'kxdfhei1' USING DFHEIV0,
 19540           DFHEIV1,
 19541           DFHEIV20,
 19542           DFHEIV99,
 19543           ELMSTR-KEY,
 19544           DFHEIV99,
 19545           DFHEIV99,
 19546           DFHEIV99
 19547     SET ADDRESS OF CLAIM-MASTER TO
 19548         DFHEIV20
 19549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19550
 19551
 19552 7900-EXIT.
 19553      EXIT.
 19554
 19555 7910-READ-CLAIM-UPDATE.
 19556
 19557* EXEC CICS READ
 19558*        DATASET  ('ELMSTR')
 19559*        SET      (ADDRESS OF CLAIM-MASTER)
 19560*        RIDFLD   (ELMSTR-KEY)
 19561*        UPDATE
 19562*    END-EXEC.
 19563     MOVE 'ELMSTR' TO DFHEIV1
 19564*    MOVE '&"S        EU         (   #00017556' TO DFHEIV0
 19565     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19566     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19567     MOVE X'2020233030303137353536' TO DFHEIV0(25:11)
 19568     CALL 'kxdfhei1' USING DFHEIV0,
 19569           DFHEIV1,
 19570           DFHEIV20,
 19571           DFHEIV99,
 19572           ELMSTR-KEY,
 19573           DFHEIV99,
 19574           DFHEIV99,
 19575           DFHEIV99
 19576     SET ADDRESS OF CLAIM-MASTER TO
 19577         DFHEIV20
 19578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19579
 19580
 19581 7910-EXIT.
 19582      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 375
* EL156.cbl
 19584 7920-READ-BENE.
 19585     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19586     MOVE 'B'                TO BENE-RECORD-TYPE.
 19587     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19588
 19589     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19590        IF PI-PAYEE-TYPE    = 'B' AND
 19591           PI-PAYEE-SEQ-NUM = 9
 19592             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19593             MOVE WS-A-BENE           TO BENE-NUMBER.
 19594
 19595
 19596* EXEC CICS HANDLE CONDITION
 19597*        NOTFND   (7920-NOT-FOUND)
 19598*    END-EXEC.
 19599*    MOVE '"$I                   ! A #00017577' TO DFHEIV0
 19600     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19602     MOVE X'4120233030303137353737' TO DFHEIV0(25:11)
 19603     CALL 'kxdfhei1' USING DFHEIV0
 19604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19605
 19606
 19607
 19608* EXEC CICS READ
 19609*        DATASET  ('ELBENE')
 19610*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19611*        RIDFLD   (ELBENE-KEY)
 19612*    END-EXEC.
 19613     MOVE 'ELBENE' TO DFHEIV1
 19614*    MOVE '&"S        E          (   #00017581' TO DFHEIV0
 19615     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19616     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19617     MOVE X'2020233030303137353831' TO DFHEIV0(25:11)
 19618     CALL 'kxdfhei1' USING DFHEIV0,
 19619           DFHEIV1,
 19620           DFHEIV20,
 19621           DFHEIV99,
 19622           ELBENE-KEY,
 19623           DFHEIV99,
 19624           DFHEIV99,
 19625           DFHEIV99
 19626     SET ADDRESS OF BENEFICIARY-MASTER TO
 19627         DFHEIV20
 19628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19629
 19630
 19631     MOVE 'Y' TO BENE-FOUND-SW.
 19632     GO TO 7920-EXIT.
 19633
 19634 7920-NOT-FOUND.
 19635     MOVE 'N'                    TO BENE-FOUND-SW.
 19636
 19637 7920-EXIT.
 19638      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 376
* EL156.cbl
 19640 7930-READ-CONTROL.
 19641
 19642* EXEC CICS READ
 19643*        DATASET  ('ELCNTL')
 19644*        SET      (ADDRESS OF CONTROL-FILE)
 19645*        RIDFLD   (ELCNTL-KEY)
 19646*    END-EXEC.
 19647     MOVE 'ELCNTL' TO DFHEIV1
 19648*    MOVE '&"S        E          (   #00017597' TO DFHEIV0
 19649     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19650     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19651     MOVE X'2020233030303137353937' TO DFHEIV0(25:11)
 19652     CALL 'kxdfhei1' USING DFHEIV0,
 19653           DFHEIV1,
 19654           DFHEIV20,
 19655           DFHEIV99,
 19656           ELCNTL-KEY,
 19657           DFHEIV99,
 19658           DFHEIV99,
 19659           DFHEIV99
 19660     SET ADDRESS OF CONTROL-FILE TO
 19661         DFHEIV20
 19662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19663
 19664
 19665 7930-EXIT.
 19666      EXIT.
 19667
 19668 7940-READ-CONTROL-UPDATE.
 19669
 19670* EXEC CICS READ
 19671*        DATASET  ('ELCNTL')
 19672*        SET      (ADDRESS OF CONTROL-FILE)
 19673*        RIDFLD   (ELCNTL-KEY)
 19674*        UPDATE
 19675*    END-EXEC.
 19676     MOVE 'ELCNTL' TO DFHEIV1
 19677*    MOVE '&"S        EU         (   #00017607' TO DFHEIV0
 19678     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19679     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19680     MOVE X'2020233030303137363037' TO DFHEIV0(25:11)
 19681     CALL 'kxdfhei1' USING DFHEIV0,
 19682           DFHEIV1,
 19683           DFHEIV20,
 19684           DFHEIV99,
 19685           ELCNTL-KEY,
 19686           DFHEIV99,
 19687           DFHEIV99,
 19688           DFHEIV99
 19689     SET ADDRESS OF CONTROL-FILE TO
 19690         DFHEIV20
 19691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19692
 19693
 19694 7940-EXIT.
 19695      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 377
* EL156.cbl
 19697 7950-READ-TRAILER.
 19698
 19699* EXEC CICS READ
 19700*        DATASET  ('ELTRLR')
 19701*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19702*        RIDFLD   (ELTRLR-KEY)
 19703*    END-EXEC.
 19704     MOVE 'ELTRLR' TO DFHEIV1
 19705*    MOVE '&"S        E          (   #00017618' TO DFHEIV0
 19706     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19707     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19708     MOVE X'2020233030303137363138' TO DFHEIV0(25:11)
 19709     CALL 'kxdfhei1' USING DFHEIV0,
 19710           DFHEIV1,
 19711           DFHEIV20,
 19712           DFHEIV99,
 19713           ELTRLR-KEY,
 19714           DFHEIV99,
 19715           DFHEIV99,
 19716           DFHEIV99
 19717     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19718         DFHEIV20
 19719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19720
 19721
 19722 7950-EXIT.
 19723      EXIT.
 19724
 19725 7960-READ-TRAILER-UPDATE.
 19726
 19727* EXEC CICS READ
 19728*        DATASET  ('ELTRLR')
 19729*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19730*        RIDFLD   (ELTRLR-KEY)
 19731*        UPDATE
 19732*    END-EXEC.
 19733     MOVE 'ELTRLR' TO DFHEIV1
 19734*    MOVE '&"S        EU         (   #00017628' TO DFHEIV0
 19735     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19736     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19737     MOVE X'2020233030303137363238' TO DFHEIV0(25:11)
 19738     CALL 'kxdfhei1' USING DFHEIV0,
 19739           DFHEIV1,
 19740           DFHEIV20,
 19741           DFHEIV99,
 19742           ELTRLR-KEY,
 19743           DFHEIV99,
 19744           DFHEIV99,
 19745           DFHEIV99
 19746     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19747         DFHEIV20
 19748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19749
 19750
 19751 7960-EXIT.
 19752      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 378
* EL156.cbl
 19754 7970-READ-CERT.
 19755
 19756* EXEC CICS READ
 19757*        DATASET  ('ELCERT')
 19758*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19759*        RIDFLD   (ELCERT-KEY)
 19760*    END-EXEC.
 19761     MOVE 'ELCERT' TO DFHEIV1
 19762*    MOVE '&"S        E          (   #00017639' TO DFHEIV0
 19763     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19764     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19765     MOVE X'2020233030303137363339' TO DFHEIV0(25:11)
 19766     CALL 'kxdfhei1' USING DFHEIV0,
 19767           DFHEIV1,
 19768           DFHEIV20,
 19769           DFHEIV99,
 19770           ELCERT-KEY,
 19771           DFHEIV99,
 19772           DFHEIV99,
 19773           DFHEIV99
 19774     SET ADDRESS OF CERTIFICATE-MASTER TO
 19775         DFHEIV20
 19776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19777
 19778
 19779 7970-EXIT.
 19780      EXIT.
 19781 7975-read-acct.
 19782
 19783     move spaces              to WS-ACCT-RECORD-SW
 19784                                 pi-dcc-product-code
 19785
 19786     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19787     MOVE PI-CARRIER          TO ACCT-CARRIER
 19788     MOVE PI-GROUPING         TO ACCT-GROUPING
 19789     MOVE PI-STATE            TO ACCT-STATE
 19790     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19791     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19792     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19793     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19794
 19795
 19796* EXEC CICS READ
 19797*       DATASET ('ERACCT')
 19798*       RIDFLD  (ERACCT-KEY)
 19799*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19800*       GTEQ
 19801*       resp    (WS-RESPONSE)
 19802*    END-EXEC
 19803     MOVE 'ERACCT' TO DFHEIV1
 19804*    MOVE '&"S        G          (  N#00017661' TO DFHEIV0
 19805     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19807     MOVE X'204E233030303137363631' TO DFHEIV0(25:11)
 19808     CALL 'kxdfhei1' USING DFHEIV0,
 19809           DFHEIV1,
 19810           DFHEIV20,
 19811           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 379
* EL156.cbl
 19812           ERACCT-KEY,
 19813           DFHEIV99,
 19814           DFHEIV99,
 19815           DFHEIV99
 19816     SET ADDRESS OF ACCOUNT-MASTER TO
 19817         DFHEIV20
 19818     MOVE EIBRESP  TO WS-RESPONSE
 19819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19820     IF WS-RESP-NORMAL
 19821        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19822        and pi-cert-eff-dt < am-expiration-dt
 19823        and pi-cert-eff-dt >= am-effective-dt
 19824        move am-dcc-product-code to pi-dcc-product-code
 19825        set acct-found to true
 19826     end-if
 19827
 19828     .
 19829 7975-exit.
 19830     exit.
 19831 7980-READ-CERT-UPDATE.
 19832
 19833* EXEC CICS READ
 19834*        DATASET  ('ELCERT')
 19835*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19836*        RIDFLD   (ELCERT-KEY)
 19837*        UPDATE
 19838*    END-EXEC.
 19839     MOVE 'ELCERT' TO DFHEIV1
 19840*    MOVE '&"S        EU         (   #00017680' TO DFHEIV0
 19841     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19842     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19843     MOVE X'2020233030303137363830' TO DFHEIV0(25:11)
 19844     CALL 'kxdfhei1' USING DFHEIV0,
 19845           DFHEIV1,
 19846           DFHEIV20,
 19847           DFHEIV99,
 19848           ELCERT-KEY,
 19849           DFHEIV99,
 19850           DFHEIV99,
 19851           DFHEIV99
 19852     SET ADDRESS OF CERTIFICATE-MASTER TO
 19853         DFHEIV20
 19854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19855
 19856
 19857 7980-EXIT.
 19858      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 380
* EL156.cbl
 19860 8000-LOAD-ERROR-MESSAGES.
 19861     IF PI-PASS-SW = 'C'
 19862        MOVE EMI-LINE1           TO ERMSG1BO
 19863     ELSE
 19864        MOVE EMI-LINE1           TO ERRMSG1O
 19865        MOVE EMI-LINE2           TO ERRMSG2O.
 19866
 19867 8000-EXIT.
 19868     EXIT.
 19869
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 381
* EL156.cbl
 19871
 19872 8010-DMD-ERROR-CHECKS.
 19873     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19874
 19875     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19876         GO TO 8051-ISSUE-ERROR.
 19877
 19878     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19879     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19880     MOVE '3'                    TO DC-OPTION-CODE.
 19881     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19882     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19883         GO TO 8051-ISSUE-ERROR.
 19884
 19885     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19886       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19887                           OR
 19888          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19889           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19890             MOVE ER-0851         TO EMI-ERROR
 19891             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19892       END-IF
 19893       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19894             MOVE ER-8147         TO EMI-ERROR
 19895             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19896
 19897     GO TO 8090-EXIT.
 19898
 19899 8051-ISSUE-ERROR.
 19900     MOVE ER-8146            TO EMI-ERROR.
 19901     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19902     GO TO 8090-EXIT.
 19903
 19904 8090-EXIT.
 19905      EXIT.
 19906
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 382
* EL156.cbl
 19908 8100-SEND-INITIAL-MAP.
 19909
 19910     MOVE SAVE-DATE              TO RUNDTEAO.
 19911     MOVE EIBTIME                TO TIME-IN.
 19912     MOVE TIME-OUT               TO RUNTIMAO.
 19913     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19914
 19915     IF MAP-NAME = 'EL156A'
 19916        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 19917           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19918        END-IF
 19919        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 19920           MOVE 'N'     TO SURVYYNO
 19921        END-IF
 19922     END-IF
 19923*    IF MAP-NAME = 'EL156A'
 19924*       IF PI-COMPANY-ID = 'CRI'
 19925*          NEXT SENTENCE
 19926*       ELSE
 19927*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19928
 19929     IF MAP-NAME = 'EL156A'
 19930        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19931           NEXT SENTENCE
 19932        ELSE
 19933           MOVE AL-SADOF TO  PINTA    PINTHA.
 19934
 19935     IF MAP-NAME = 'EL156A'
 19936        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19937            NEXT SENTENCE
 19938        ELSE
 19939           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19940
 19941*    IF MAP-NAME = 'EL156A'
 19942*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19943*          NEXT SENTENCE
 19944*       ELSE
 19945*          MOVE AL-SADOF TO CASHHA CASHA.
 19946
 19947     IF MAP-NAME = 'EL156A'
 19948        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19949                        or 'VPP'
 19950           NEXT SENTENCE
 19951        ELSE
 19952           MOVE AL-SADOF        TO  LOANHA
 19953                                    LOANNOA.
 19954
 19955     IF MAP-NAME = 'EL156A'
 19956        MOVE -1                 TO  ENTERPFL
 19957        IF PI-USES-PAID-TO
 19958           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19959           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19960           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19961        ELSE
 19962           NEXT SENTENCE
 19963     ELSE
 19964        IF MAP-NAME = 'EL156B'
 19965           IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 383
* EL156.cbl
 19966              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19967              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19968
 19969
 19970* EXEC CICS SEND
 19971*        MAP   (MAP-NAME)
 19972*        MAPSET(MAPSET-NAME)
 19973*        FROM  (EL156AI)
 19974*        ERASE
 19975*        CURSOR
 19976*    END-EXEC.
 19977     MOVE LENGTH OF
 19978      EL156AI
 19979       TO DFHEIV12
 19980     MOVE -1
 19981       TO DFHEIV11
 19982*    MOVE '8$     CT  E    H L F ,   #00017799' TO DFHEIV0
 19983     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19984     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19985     MOVE X'2020233030303137373939' TO DFHEIV0(25:11)
 19986     CALL 'kxdfhei1' USING DFHEIV0,
 19987           MAP-NAME,
 19988           EL156AI,
 19989           DFHEIV12,
 19990           MAPSET-NAME,
 19991           DFHEIV99,
 19992           DFHEIV99,
 19993           DFHEIV99,
 19994           DFHEIV11,
 19995           DFHEIV99,
 19996           DFHEIV99,
 19997           DFHEIV99
 19998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19999
 20000
 20001     GO TO 9100-RETURN-TRAN.
 20002
 20003 8200-SEND-DATAONLY.
 20004
 20005     IF FIRST-ENTRY = 'Y'
 20006         GO TO 8100-SEND-INITIAL-MAP.
 20007
 20008     IF RETURNED-FROM-B = 'Y'
 20009         GO TO 8100-SEND-INITIAL-MAP.
 20010
 20011     MOVE SAVE-DATE              TO RUNDTEAO.
 20012     MOVE EIBTIME                TO TIME-IN.
 20013     MOVE TIME-OUT               TO RUNTIMAO.
 20014
 20015     IF EIBAID = DFHPF11
 20016        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 20017        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20018        MOVE 'EL001   '          TO RETURNED-FROM
 20019        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 20020        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 20021        GO TO 8100-SEND-INITIAL-MAP.
 20022
 20023     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 384
* EL156.cbl
 20024
 20025     IF MAP-NAME =  'EL156A'
 20026        MOVE -1                 TO  ENTERPFL
 20027        IF PI-USES-PAID-TO
 20028           MOVE 'PAID TO DATE :' TO PTHRHDGO
 20029           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 20030           MOVE PMT-HEAD-A      TO  PMTHDGAO
 20031        ELSE
 20032           NEXT SENTENCE
 20033     ELSE
 20034        IF MAP-NAME = 'EL156B'
 20035           IF PI-USES-PAID-TO
 20036              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 20037              MOVE PMT-HEAD-B     TO PMTHDGBO.
 20038
 20039     IF MAP-NAME =  'EL156A'
 20040        IF PI-COMPANY-ID = 'BOA'
 20041            IF PI-INT-RATE NUMERIC
 20042                MOVE PI-INT-RATE TO PINTO.
 20043     IF MAP-NAME = 'EL156A'
 20044        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 20045           MOVE 'PF6=EOB CODES'  TO PF6TITO
 20046*          MOVE 'Y'              TO EOBYNO
 20047        END-IF
 20048     END-IF
 20049
 20050
 20051* EXEC CICS SEND
 20052*        MAP   (MAP-NAME)
 20053*        MAPSET(MAPSET-NAME)
 20054*        FROM  (EL156AI)
 20055*        DATAONLY
 20056*        CURSOR
 20057*    END-EXEC.
 20058     MOVE LENGTH OF
 20059      EL156AI
 20060       TO DFHEIV12
 20061     MOVE -1
 20062       TO DFHEIV11
 20063*    MOVE '8$D    CT       H L F ,   #00017856' TO DFHEIV0
 20064     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 20065     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20066     MOVE X'2020233030303137383536' TO DFHEIV0(25:11)
 20067     CALL 'kxdfhei1' USING DFHEIV0,
 20068           MAP-NAME,
 20069           EL156AI,
 20070           DFHEIV12,
 20071           MAPSET-NAME,
 20072           DFHEIV99,
 20073           DFHEIV99,
 20074           DFHEIV99,
 20075           DFHEIV11,
 20076           DFHEIV99,
 20077           DFHEIV99,
 20078           DFHEIV99
 20079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20080
 20081
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 385
* EL156.cbl
 20082     GO TO 9100-RETURN-TRAN.
 20083
 20084 8300-SEND-TEXT.
 20085
 20086* EXEC CICS SEND TEXT
 20087*        FROM(LOGOFF-TEXT)
 20088*        LENGTH(LOGOFF-LENGTH)
 20089*        ERASE
 20090*        FREEKB
 20091*    END-EXEC.
 20092*    MOVE '8&      T  E F  H   F -   #00017867' TO DFHEIV0
 20093     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 20094     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 20095     MOVE X'2020233030303137383637' TO DFHEIV0(25:11)
 20096     CALL 'kxdfhei1' USING DFHEIV0,
 20097           LOGOFF-TEXT,
 20098           LOGOFF-LENGTH,
 20099           DFHEIV99,
 20100           DFHEIV99,
 20101           DFHEIV99,
 20102           DFHEIV99,
 20103           DFHEIV99,
 20104           DFHEIV99,
 20105           DFHEIV99,
 20106           DFHEIV99,
 20107           DFHEIV99,
 20108           DFHEIV99
 20109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20110
 20111
 20112
 20113* EXEC CICS RETURN
 20114*    END-EXEC.
 20115*    MOVE '.(                    ''   #00017874' TO DFHEIV0
 20116     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20117     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20118     MOVE X'2020233030303137383734' TO DFHEIV0(25:11)
 20119     CALL 'kxdfhei1' USING DFHEIV0,
 20120           DFHEIV99,
 20121           DFHEIV99,
 20122           DFHEIV99,
 20123           DFHEIV99,
 20124           DFHEIV99,
 20125           DFHEIV99
 20126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20127
 20128
 20129 8500-FILE-NOTOPEN.
 20130     IF FILE-SWITCH = 'MSTR'
 20131         MOVE ER-0154            TO EMI-ERROR.
 20132     IF FILE-SWITCH = 'TRLR'
 20133         MOVE ER-0172            TO EMI-ERROR.
 20134     IF FILE-SWITCH = 'CERT'
 20135         MOVE ER-0169            TO EMI-ERROR.
 20136     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 20137                      'PROC' OR 'STAT'
 20138         MOVE ER-0042            TO EMI-ERROR.
 20139     IF FILE-SWITCH = 'ACTQ'
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 386
* EL156.cbl
 20140         MOVE ER-0338            TO EMI-ERROR.
 20141     IF FILE-SWITCH = 'ACCT'
 20142         MOVE ER-0168            TO EMI-ERROR.
 20143
 20144     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20145     MOVE -1                     TO PMTTYPEL.
 20146
 20147     IF FIRST-ENTRY = 'Y'
 20148         GO TO 8100-SEND-INITIAL-MAP.
 20149
 20150     GO TO 8200-SEND-DATAONLY.
 20151
 20152 8600-PGRM-NOT-FOUND.
 20153
 20154     MOVE ER-0923                TO EMI-ERROR.
 20155     MOVE -1                     TO ENTPFBL.
 20156     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20157
 20158     IF FIRST-ENTRY = 'Y'
 20159         GO TO 8100-SEND-INITIAL-MAP
 20160     ELSE
 20161         GO TO 8200-SEND-DATAONLY.
 20162
 20163 8800-UNAUTHORIZED-ACCESS.
 20164     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20165     GO TO 8300-SEND-TEXT.
 20166
 20167 8810-PF23.
 20168     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20169     MOVE XCTL-005               TO PGM-NAME.
 20170     GO TO 9300-XCTL.
 20171
 20172 8820-PF7-8.
 20173     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 20174     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 20175                                    PI-SAVED-PROGRAM-2
 20176                                    PI-SAVED-PROGRAM-3
 20177                                    PI-SAVED-PROGRAM-4
 20178                                    PI-SAVED-PROGRAM-5
 20179                                    PI-SAVED-PROGRAM-6
 20180                                    PI-RETURN-TO-PROGRAM.
 20181     IF EIBAID = DFHPF8
 20182        MOVE XCTL-132            TO PGM-NAME
 20183     ELSE
 20184        MOVE XCTL-130            TO PGM-NAME.
 20185
 20186     GO TO 9300-XCTL.
 20187
 20188 9100-RETURN-TRAN.
 20189     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20190     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 20191
 20192
 20193* EXEC CICS RETURN
 20194*        TRANSID(TRANS-ID)
 20195*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20196*        LENGTH(PI-COMM-LENGTH)
 20197*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 387
* EL156.cbl
 20198*    MOVE '.(CT                  ''   #00017940' TO DFHEIV0
 20199     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20200     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20201     MOVE X'2020233030303137393430' TO DFHEIV0(25:11)
 20202     CALL 'kxdfhei1' USING DFHEIV0,
 20203           TRANS-ID,
 20204           PROGRAM-INTERFACE-BLOCK,
 20205           PI-COMM-LENGTH,
 20206           DFHEIV99,
 20207           DFHEIV99,
 20208           DFHEIV99
 20209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20210
 20211
 20212 9200-RETURN-MAIN-MENU.
 20213     MOVE XCTL-126               TO PGM-NAME.
 20214     GO TO 9300-XCTL.
 20215
 20216 9300-XCTL.
 20217
 20218* EXEC CICS XCTL
 20219*        PROGRAM(PGM-NAME)
 20220*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20221*        LENGTH(PI-COMM-LENGTH)
 20222*    END-EXEC.
 20223*    MOVE '.$C                   %   #00017951' TO DFHEIV0
 20224     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20225     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20226     MOVE X'2020233030303137393531' TO DFHEIV0(25:11)
 20227     CALL 'kxdfhei1' USING DFHEIV0,
 20228           PGM-NAME,
 20229           PROGRAM-INTERFACE-BLOCK,
 20230           PI-COMM-LENGTH,
 20231           DFHEIV99
 20232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20233
 20234
 20235 9400-CLEAR.
 20236     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20237     GO TO 9300-XCTL.
 20238
 20239 9500-PF12.
 20240     MOVE XCTL-010               TO PGM-NAME.
 20241     GO TO 9300-XCTL.
 20242
 20243 9700-LINK-DATE-CONVERT.
 20244     MOVE LINK-ELDATCV           TO PGM-NAME.
 20245
 20246* EXEC CICS LINK
 20247*        PROGRAM   (PGM-NAME)
 20248*        COMMAREA  (DATE-CONVERSION-DATA)
 20249*        LENGTH    (DC-COMM-LENGTH)
 20250*    END-EXEC.
 20251*    MOVE '."C                   (   #00017967' TO DFHEIV0
 20252     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20253     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20254     MOVE X'2020233030303137393637' TO DFHEIV0(25:11)
 20255     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 388
* EL156.cbl
 20256           PGM-NAME,
 20257           DATE-CONVERSION-DATA,
 20258           DC-COMM-LENGTH,
 20259           DFHEIV99,
 20260           DFHEIV99,
 20261           DFHEIV99,
 20262           DFHEIV99
 20263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20264
 20265
 20266 9700-EXIT.
 20267     EXIT.
 20268
 20269 9800-LINK-REM-TERM.
 20270     MOVE LINK-REMTERM TO PGM-NAME.
 20271
 20272
 20273* EXEC CICS LINK
 20274*        PROGRAM   (PGM-NAME)
 20275*        COMMAREA  (CALCULATION-PASS-AREA)
 20276*        LENGTH    (CP-COMM-LENGTH)
 20277*    END-EXEC.
 20278*    MOVE '."C                   (   #00017979' TO DFHEIV0
 20279     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20280     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20281     MOVE X'2020233030303137393739' TO DFHEIV0(25:11)
 20282     CALL 'kxdfhei1' USING DFHEIV0,
 20283           PGM-NAME,
 20284           CALCULATION-PASS-AREA,
 20285           CP-COMM-LENGTH,
 20286           DFHEIV99,
 20287           DFHEIV99,
 20288           DFHEIV99,
 20289           DFHEIV99
 20290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20291
 20292
 20293 9800-EXIT.
 20294     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 389
* EL156.cbl
 20296 9830-DMD-REMAINING-TERM.
 20297
 20298     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20299         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20300
 20301     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20302                              CM-PMT-EXTENSION-DAYS.
 20303
 20304     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20305                                  CL-NO-OF-DAYS-PAID.
 20306
 20307     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20308         GIVING W-REM REMAINDER W-REM-DAYS.
 20309
 20310     MOVE W-REM                  TO WST-REM.
 20311
 20312     IF W-REM-DAYS > ZEROS
 20313         MOVE '/'                TO WST-SLASH
 20314         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20315     ELSE
 20316         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20317
 20318 9830-EXIT.
 20319     EXIT.
 20320
 20321 9870-OUTPUT-ACTIVITY-RECORD.
 20322
 20323
 20324* EXEC CICS GETMAIN
 20325*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20326*         LENGTH(25)
 20327*         INITIMG(WS-BLANK)
 20328*    END-EXEC.
 20329     MOVE 25
 20330       TO DFHEIV11
 20331*    MOVE ',"IL                  $   #00018015' TO DFHEIV0
 20332     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20333     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20334     MOVE X'2020233030303138303135' TO DFHEIV0(25:11)
 20335     CALL 'kxdfhei1' USING DFHEIV0,
 20336           DFHEIV20,
 20337           DFHEIV11,
 20338           WS-BLANK
 20339     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20340         DFHEIV20
 20341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20342
 20343
 20344     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20345     MOVE ELMSTR-KEY             TO DA-KEY.
 20346     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20347
 20348     IF PI-PMTTYPE EQUAL '7'
 20349         MOVE 'V'                TO DA-RECORD-TYPE
 20350     ELSE
 20351         MOVE 'P'                TO DA-RECORD-TYPE.
 20352
 20353
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 390
* EL156.cbl
 20354* EXEC CICS HANDLE CONDITION
 20355*         NOTOPEN(9870-NOTOPEN)
 20356*         DUPREC(9870-EXIT)
 20357*    END-EXEC.
 20358*    MOVE '"$J%                  ! B #00018030' TO DFHEIV0
 20359     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20360     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20361     MOVE X'4220233030303138303330' TO DFHEIV0(25:11)
 20362     CALL 'kxdfhei1' USING DFHEIV0
 20363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20364
 20365
 20366
 20367* EXEC CICS WRITE
 20368*         DATASET('DLYACTV')
 20369*         RIDFLD(DA-KEY)
 20370*         FROM(DAILY-ACTIVITY-RECORD)
 20371*         LENGTH(25)
 20372*    END-EXEC.
 20373     MOVE 'DLYACTV' TO DFHEIV1
 20374     MOVE 25
 20375       TO DFHEIV11
 20376*    MOVE '&$ L                  ''   #00018035' TO DFHEIV0
 20377     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20378     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20379     MOVE X'2020233030303138303335' TO DFHEIV0(25:11)
 20380     CALL 'kxdfhei1' USING DFHEIV0,
 20381           DFHEIV1,
 20382           DAILY-ACTIVITY-RECORD,
 20383           DFHEIV11,
 20384           DA-KEY,
 20385           DFHEIV99,
 20386           DFHEIV99
 20387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20388
 20389     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20390     GO TO 9870-EXIT.
 20391
 20392 9870-NOTOPEN.
 20393
 20394     MOVE '2955'                 TO EMI-ERROR.
 20395     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20396
 20397 9870-EXIT.
 20398     EXIT.
 20399
 20400 9900-ERROR-FORMAT.
 20401
 20402     IF EMI-ERROR = ER-0923
 20403         MOVE PGM-NAME           TO W-CALLED-NAME.
 20404
 20405     MOVE LINK-001      TO PGM-NAME.
 20406     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20407
 20408
 20409* EXEC CICS LINK
 20410*        PROGRAM (PGM-NAME)
 20411*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 391
* EL156.cbl
 20412*        LENGTH  (EMI-COMM-LENGTH)
 20413*    END-EXEC.
 20414*    MOVE '."C                   (   #00018060' TO DFHEIV0
 20415     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20416     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20417     MOVE X'2020233030303138303630' TO DFHEIV0(25:11)
 20418     CALL 'kxdfhei1' USING DFHEIV0,
 20419           PGM-NAME,
 20420           ERROR-MESSAGE-INTERFACE-BLOCK,
 20421           EMI-COMM-LENGTH,
 20422           DFHEIV99,
 20423           DFHEIV99,
 20424           DFHEIV99,
 20425           DFHEIV99
 20426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20427
 20428
 20429     IF EMI-ERROR = ER-0923
 20430         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20431
 20432 9900-EXIT.
 20433     EXIT.
 20434
 20435 9990-ABEND.
 20436     MOVE LINK-004               TO PGM-NAME.
 20437     MOVE DFHEIBLK               TO EMI-LINE1.
 20438
 20439* EXEC CICS LINK
 20440*        PROGRAM   (PGM-NAME)
 20441*        COMMAREA  (EMI-LINE1)
 20442*        LENGTH    (64)
 20443*    END-EXEC.
 20444     MOVE 64
 20445       TO DFHEIV11
 20446*    MOVE '."C                   (   #00018075' TO DFHEIV0
 20447     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20448     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20449     MOVE X'2020233030303138303735' TO DFHEIV0(25:11)
 20450     CALL 'kxdfhei1' USING DFHEIV0,
 20451           PGM-NAME,
 20452           EMI-LINE1,
 20453           DFHEIV11,
 20454           DFHEIV99,
 20455           DFHEIV99,
 20456           DFHEIV99,
 20457           DFHEIV99
 20458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20459
 20460
 20461     MOVE 'EL156A'               TO  MAP-NAME.
 20462     MOVE LOW-VALUES             TO  EL156AO.
 20463     GO TO 8100-SEND-INITIAL-MAP.
 20464
 20465 9995-SECURITY-VIOLATION.
 20466*    COPY ELCSCTP.
 20467******************************************************************
 20468*                                                                *
 20469*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 392
* EL156.cbl
 20470*                            VMOD=2.001                          *
 20471*                                                                *
 20472*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20473******************************************************************
 20474
 20475
 20476     MOVE EIBDATE          TO SM-JUL-DATE.
 20477     MOVE EIBTRMID         TO SM-TERMID.
 20478     MOVE THIS-PGM         TO SM-PGM.
 20479     MOVE EIBTIME          TO TIME-IN.
 20480     MOVE TIME-OUT         TO SM-TIME.
 20481     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20482
 20483
 20484* EXEC CICS LINK
 20485*         PROGRAM  ('EL003')
 20486*         COMMAREA (SECURITY-MESSAGE)
 20487*         LENGTH   (80)
 20488*    END-EXEC.
 20489     MOVE 'EL003' TO DFHEIV1
 20490     MOVE 80
 20491       TO DFHEIV11
 20492*    MOVE '."C                   (   #00018103' TO DFHEIV0
 20493     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20494     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20495     MOVE X'2020233030303138313033' TO DFHEIV0(25:11)
 20496     CALL 'kxdfhei1' USING DFHEIV0,
 20497           DFHEIV1,
 20498           SECURITY-MESSAGE,
 20499           DFHEIV11,
 20500           DFHEIV99,
 20501           DFHEIV99,
 20502           DFHEIV99,
 20503           DFHEIV99
 20504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20505
 20506
 20507******************************************************************
 20508
 20509
 20510
 20511 9999-DFHBACK SECTION.
 20512     MOVE '9%                    "   ' TO DFHEIV0
 20513     MOVE 'EL156' TO DFHEIV1
 20514     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20515     GOBACK.
 20516 9999-DFHEXIT.
 20517     IF DFHEIGDJ EQUAL 0001
 20518         NEXT SENTENCE
 20519     ELSE IF DFHEIGDJ EQUAL 2
 20520         GO TO 9990-ABEND,
 20521               8600-PGRM-NOT-FOUND,
 20522               0400-FIRST-TIME,
 20523               6180-DUPREC,
 20524               9990-ABEND
 20525         DEPENDING ON DFHEIGDI
 20526     ELSE IF DFHEIGDJ EQUAL 3
 20527         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 393
* EL156.cbl
 20528               0380-CLAIM-END-FILE
 20529         DEPENDING ON DFHEIGDI
 20530     ELSE IF DFHEIGDJ EQUAL 4
 20531         GO TO 0380-CLAIM-END-FILE,
 20532               0380-CLAIM-END-FILE
 20533         DEPENDING ON DFHEIGDI
 20534     ELSE IF DFHEIGDJ EQUAL 5
 20535         GO TO 0800-EXIT
 20536         DEPENDING ON DFHEIGDI
 20537     ELSE IF DFHEIGDJ EQUAL 6
 20538         GO TO 1950-NOT-FOUND,
 20539               1950-NOT-FOUND
 20540         DEPENDING ON DFHEIGDI
 20541     ELSE IF DFHEIGDJ EQUAL 7
 20542         GO TO 1950-NOT-FOUND
 20543         DEPENDING ON DFHEIGDI
 20544     ELSE IF DFHEIGDJ EQUAL 8
 20545         GO TO 1950-NOT-FOUND,
 20546               1950-NOT-FOUND
 20547         DEPENDING ON DFHEIGDI
 20548     ELSE IF DFHEIGDJ EQUAL 9
 20549         GO TO 1166-END-CHECK,
 20550               1166-END-CHECK
 20551         DEPENDING ON DFHEIGDI
 20552     ELSE IF DFHEIGDJ EQUAL 10
 20553         GO TO 1950-NOT-FOUND,
 20554               1950-NOT-FOUND
 20555         DEPENDING ON DFHEIGDI
 20556     ELSE IF DFHEIGDJ EQUAL 11
 20557         GO TO 1950-NOT-FOUND,
 20558               1950-NOT-FOUND
 20559         DEPENDING ON DFHEIGDI
 20560     ELSE IF DFHEIGDJ EQUAL 12
 20561         GO TO 1950-NOT-FOUND
 20562         DEPENDING ON DFHEIGDI
 20563     ELSE IF DFHEIGDJ EQUAL 13
 20564         GO TO 3600-CONTINUE
 20565         DEPENDING ON DFHEIGDI
 20566     ELSE IF DFHEIGDJ EQUAL 14
 20567         GO TO 5300-NOTE-NOT-FOUND
 20568         DEPENDING ON DFHEIGDI
 20569     ELSE IF DFHEIGDJ EQUAL 15
 20570         GO TO 6065-NOT-FOUND
 20571         DEPENDING ON DFHEIGDI
 20572     ELSE IF DFHEIGDJ EQUAL 16
 20573         GO TO 6068-ACCT-NOT-FND
 20574         DEPENDING ON DFHEIGDI
 20575     ELSE IF DFHEIGDJ EQUAL 17
 20576         GO TO 6074-GET-COMP-DATA
 20577         DEPENDING ON DFHEIGDI
 20578     ELSE IF DFHEIGDJ EQUAL 18
 20579         GO TO 6170-WRITE
 20580         DEPENDING ON DFHEIGDI
 20581     ELSE IF DFHEIGDJ EQUAL 19
 20582         GO TO 6180-DUPREC
 20583         DEPENDING ON DFHEIGDI
 20584     ELSE IF DFHEIGDJ EQUAL 20
 20585         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 27-Feb-18 14:38 Page 394
* EL156.cbl
 20586         DEPENDING ON DFHEIGDI
 20587     ELSE IF DFHEIGDJ EQUAL 21
 20588         GO TO 6185-DUPREC
 20589         DEPENDING ON DFHEIGDI
 20590     ELSE IF DFHEIGDJ EQUAL 22
 20591         GO TO 6720-BUILD-NEW-RECORD
 20592         DEPENDING ON DFHEIGDI
 20593     ELSE IF DFHEIGDJ EQUAL 23
 20594         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20595               6900-BUILD-ARCHIVE-HEADER
 20596         DEPENDING ON DFHEIGDI
 20597     ELSE IF DFHEIGDJ EQUAL 24
 20598         GO TO 7010-BUILD-MAP
 20599         DEPENDING ON DFHEIGDI
 20600     ELSE IF DFHEIGDJ EQUAL 25
 20601         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20602         DEPENDING ON DFHEIGDI
 20603     ELSE IF DFHEIGDJ EQUAL 26
 20604         GO TO 7160-DUPREC
 20605         DEPENDING ON DFHEIGDI
 20606     ELSE IF DFHEIGDJ EQUAL 27
 20607         GO TO 7200-EXIT,
 20608               7200-EXIT
 20609         DEPENDING ON DFHEIGDI
 20610     ELSE IF DFHEIGDJ EQUAL 28
 20611         GO TO 7400-NOT-FOUND
 20612         DEPENDING ON DFHEIGDI
 20613     ELSE IF DFHEIGDJ EQUAL 29
 20614         GO TO 7590-END,
 20615               7590-END
 20616         DEPENDING ON DFHEIGDI
 20617     ELSE IF DFHEIGDJ EQUAL 30
 20618         GO TO 7699-EXIT
 20619         DEPENDING ON DFHEIGDI
 20620     ELSE IF DFHEIGDJ EQUAL 31
 20621         GO TO 5300-NOTE-NOT-FOUND
 20622         DEPENDING ON DFHEIGDI
 20623     ELSE IF DFHEIGDJ EQUAL 32
 20624         GO TO 7800-COMP-NOTFND
 20625         DEPENDING ON DFHEIGDI
 20626     ELSE IF DFHEIGDJ EQUAL 33
 20627         GO TO 7920-NOT-FOUND
 20628         DEPENDING ON DFHEIGDI
 20629     ELSE IF DFHEIGDJ EQUAL 34
 20630         GO TO 9870-NOTOPEN,
 20631               9870-EXIT
 20632         DEPENDING ON DFHEIGDI.
 20633     MOVE '9%                    "   ' TO DFHEIV0
 20634     MOVE 'EL156' TO DFHEIV1
 20635     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20636     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12772     Code:       76774
