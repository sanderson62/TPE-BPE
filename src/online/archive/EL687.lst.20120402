* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   1
* EL687.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL687.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL687.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL687 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 09/20/95 08:42:38.
     7*                            VMOD=2.019
     8*
     9*AUTHOR.    LOGIC, INC.
    10*           DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   2
* EL687.cbl
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.   TRANSACTION - EXG3
    25
    26*        IN ORDER TO START THE PRINTING OF CHECKS, THIS FUNCTION
    27*    IS USED TO QUALIFY THE CONTROL BATCHES TO BE PRINTED AND
    28*    SPECIFY A PRINT TIME.  THE CHECK WRITER PROGRAM (EL688) IS
    29*    STARTED BY THIS PROGRAM.
    30
    31*    SCREENS     - EL687A - CHECK WRITER
    32
    33*    ENTERED BY  - EL671  - REPORT MENU
    34
    35*    EXIT TO     - EL671  - RESULT OF CLEAR
    36
    37*    INPUT FILES - ERCHKQ - CHECK QUEUE
    38*                  ERPYAJ - PENDING PAYMENTS AND ADJUSTMENTS
    39*                  ELCNTL - CONTROL FILE
    40
    41*    OUTPUT FILES - ERPYAJ - PENDING PAYMENTS AND ADJUSTMENTS
    42*                   ERCHEK - CHECK MAINTENANCE
    43*                   ERCHKQ - CHECK QUEUE
    44
    45*    COMMAREA    - PASSED.  PRINT TIME PASSED TO CHECK WRITER AS
    46*                  A 2 BYTE COMP NUMBER IN THE FIRST TWO BYTES OF
    47*                  THE WORK AREA.  FORM TYPE IS PASSED AS
    48*                  ENTRY-CD-1.
    49
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   3
* EL687.cbl
    51 ENVIRONMENT DIVISION.
    52
    53 DATA DIVISION.
    54
    55 WORKING-STORAGE SECTION.
    56 01  DFH-START PIC X(04).
    57 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    58 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    59                                   USAGE POINTER.
    60 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    61 01  LCP-CURRENT-DATE-68.
    62     05  LCP-MONTH                 PIC X(2).
    63     05  FILLER                    PIC X VALUE '/'.
    64     05  LCP-DAY1                  PIC X(2).
    65     05  FILLER                    PIC X VALUE '/'.
    66     05  LCP-YEAR                  PIC X(2).
    67 01  LCP-CICS-DATE                 PIC 9(15).
    68
    69 77  FILLER  PIC X(32)  VALUE '********************************'.
    70 77  FILLER  PIC X(32)  VALUE '*    EL687 WORKING STORAGE     *'.
    71 77  FILLER  PIC X(32)  VALUE '************ V/M 2.019 *********'.
    72
    73 01  FILLER                          COMP-3.
    74     05  WS-NOT-FOUND                PIC S9          VALUE ZERO.
    75     05  WS-PRINTER-STARTED-SW       PIC S9          VALUE ZERO.
    76     05  WS-READNEXT-SW              PIC S9          VALUE ZERO.
    77     05  WS-LAST-ERROR-COUNT         PIC S9(3)       VALUE ZERO.
    78     05  WS-COMPLETED-SUCCESSFUL     PIC S9          VALUE ZERO.
    79       88  TRANSACTION-SUCCESSFUL                    VALUE +1 +2.
    80       88  CHECKS-WITHOUT-ADDRESSES                  VALUE +2.
    81
    82     05  WS-TIME-WORK                PIC S9(7)       VALUE ZERO.
    83     05  WS-TIME                     REDEFINES
    84         WS-TIME-WORK                PIC S9(3)V9(4).
    85     05  WS-HHMM                     REDEFINES
    86         WS-TIME-WORK                PIC S9(5)V99.
    87
    88     05  WS-PENDING-PAYMENTS-BROWSE-SW  PIC S9       VALUE ZERO.
    89     05  WS-CHECK-QUEUE-BROWSE-SW    PIC S9          VALUE ZERO.
    90     05  WS-CHECK-MAINT-BROWSE-SW    PIC S9          VALUE ZERO.
    91
    92     05  WS-NOT-RELEASED-COUNT       PIC S9(5)       VALUE ZERO.
    93     05  WS-NOT-RELEASED-AMOUNT      PIC S9(9)V99 VALUE ZERO.
    94     05  WS-RELEASED-COUNT           PIC S9(5)       VALUE ZERO.
    95     05  WS-RELEASED-AMOUNT          PIC S9(9)V99 VALUE ZERO.
    96
    97
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   4
* EL687.cbl
    99 01  FILLER                          COMP SYNC.
   100     05  WS-TS-LENGTH                PIC S9(4)       VALUE +750.
   101     05  WS-ERCHKQ-LENGTH            PIC S9(4)       VALUE +100.
   102     05  WS-KEY-LENGTH               PIC S9(4)       VALUE ZERO.
   103
   104     05  WS-CHECK-QUE-COUNTER        PIC S9(8)       VALUE ZERO.
   105     05  WS-CHECK-COUNTER            PIC S9(4)       VALUE +10.
   106
   107     05  WS-LAST-CONTROL-GROUP       PIC S9(8)       VALUE ZERO.
   108     05  WS-TIMES-PRINTED            PIC S9(4)       VALUE ZERO.
   109
   110     05  WS-JOURNAL-FILE-ID          PIC S9(4)       VALUE +1.
   111     05  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)       VALUE +773.
   112
   113     05  WS-SEQUENCE-NUMBER          PIC S9(4)       VALUE ZERO.
   114     05  WS-BEGIN-NUMBER             PIC S9(4)       VALUE ZERO.
   115
   116     05  WS-CQFCBAR                  PIC S9(9)       VALUE ZERO.
   117     05  WS-INDEX                    PIC S9(4)       VALUE ZERO.
   118
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   5
* EL687.cbl
   120 01  FILLER.
   121
   122     05  WS-CONTROL-FILE-KEY.
   123         10  WS-CFK-COMPANY-ID       PIC X(3)        VALUE SPACES.
   124         10  WS-CFK-RECORD-TYPE      PIC X           VALUE SPACES.
   125         10  FILLER                  PIC XX          VALUE SPACES.
   126         10  WS-CFK-BENEFIT-NO       PIC XX          VALUE SPACES.
   127         10  WS-CFK-SEQUENCE-NO      PIC S9(4)       VALUE ZERO
   128                                     COMP.
   129
   130     05  WS-PENDING-PAYMENTS-KEY.
   131         10  WS-PPK-COMPANY-CD       PIC X.
   132         10  WS-PPK-CARRIER          PIC X.
   133         10  WS-PPK-GROUPING         PIC X(6).
   134         10  WS-PPK-FIN-RESP         PIC X(10).
   135         10  WS-PPK-ACCOUNT          PIC X(10).
   136         10  WS-PPK-FILE-SEQ-NO      PIC S9(8)      COMP.
   137         10  WS-PPK-RECORD-TYPE      PIC X.
   138
   139     05  WS-CHECK-MAINT-KEY.
   140         10  WS-CMK-COMPANY-CD       PIC X.
   141         10  WS-CMK-CARRIER          PIC X.
   142         10  WS-CMK-GROUPING         PIC X(6).
   143         10  WS-CMK-STATE            PIC X(2).
   144         10  WS-CMK-ACCOUNT          PIC X(10).
   145         10  WS-CMK-CERT-EFF-DT      PIC X(2).
   146         10  WS-CMK-CERT-NO          PIC X(11).
   147         10  WS-CMK-SEQ-NO           PIC S9(4)      COMP.
   148
   149     05  WS-CHECK-QUEUE-KEY.
   150         10  WS-CQK-COMPANY-CD       PIC X.
   151         10  WS-CQK-CONTROL-NUMBER   PIC S9(8)
   152                                     COMP.
   153         10  WS-CQK-SEQUENCE-NUMBER  PIC S9(4)
   154                                     COMP.
   155
   156     05  WS-LAST-CHECK-QUEUE-KEY     PIC X(7) VALUE LOW-VALUE.
   157
   158     05  WS-COMPENSATION-MASTER-KEY.
   159         10  WS-CM-COMPANY-CD        PIC X.
   160         10  WS-CM-CARRIER           PIC X.
   161         10  WS-CM-GROUPING          PIC X(6).
   162         10  WS-CM-FIN-RESP          PIC X(10).
   163         10  WS-CM-ACCOUNT           PIC X(10).
   164         10  WS-CM-TYPE              PIC X.
   165
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   6
* EL687.cbl
   167     05  WS-MAPSET-NAME              PIC X(8)      VALUE 'EL687S'.
   168     05  WS-MAP-NAME                 PIC X(8)      VALUE 'EL687A'.
   169
   170     05  FILLER                      REDEFINES
   171         WS-MAP-NAME.
   172         20  FILLER                  PIC XX.
   173         20  WS-MAP-NUMBER           PIC X(6).
   174
   175     05  WS-PROGRAM-ID               PIC X(8)      VALUE 'EL687'.
   176     05  WS-CHECK-QUEUE-DSID         PIC X(8)      VALUE 'ERCHKQ'.
   177     05  WS-ENQ-COMPANY-ID           PIC X(3)      VALUE  ZERO.
   178     05  WS-PENDING-PAYMENTS-DSID    PIC X(8)      VALUE 'ERPYAJ'.
   179     05  WS-CONTROL-FILE-DSID        PIC X(8)      VALUE 'ELCNTL'.
   180     05  WS-COMPENSATION-MASTER-DSID PIC X(8)      VALUE 'ERCOMP'.
   181     05  WS-CHECK-MAINT-DSID         PIC X(8)      VALUE 'ERCHEK'.
   182     05  WS-JOURNAL-TYPE-ID          PIC XX        VALUE 'ER'.
   183
   184     05  WS-LOW-VALUES               PIC X VALUE LOW-VALUES.
   185     05  WS-SPACES                   PIC X           VALUE SPACES.
   186
   187     05  WS-CURRENT-DATE             PIC XX VALUE LOW-VALUES.
   188
   189     05  WS-TRANS-ID                 PIC X(4)        VALUE 'EXG3'.
   190     05  WS-CHECK-WRITER-TRANS-ID    PIC X(4)        VALUE 'EXG4'.
   191
   192     05  WS-BENEFIT-NO               PIC XX          VALUE SPACES.
   193     05  WS-KIND.
   194         10  WS-RETRO-DAYS           PIC 99.
   195         10  WS-RETRO-ELIM           PIC X.
   196     05  WS-TEXT-MESSAGE-LENGTH      PIC S9(4)       VALUE +70
   197                                     COMP SYNC.
   198     05  WS-TEXT-MESSAGE             PIC X(70)       VALUE SPACES.
   199     05  WS-TEMP-STORAGE-ITEM        PIC S9(4)       VALUE ZERO
   200                                     COMP SYNC.
   201     05  WS-TEMP-STORAGE-KEY.
   202         10  WS-TSK-TERM-ID          PIC X(4)        VALUE SPACES.
   203         10  WS-TSK-TIME             PIC S9(7)       VALUE ZERO
   204                                     COMP-3.
   205     05  WS-MINUTES                  PIC S99         VALUE ZERO.
   206     05  WS-GREATEST-CHECK-NUMBER    PIC 9(7)        VALUE ZERO.
   207     05  WS-GREATEST-CHECK-NUMBER-X  REDEFINES
   208         WS-GREATEST-CHECK-NUMBER    PIC X(7).
   209     05  WS-CHECK-NUMBER             PIC 9(7)        VALUE ZERO.
   210     05  WS-CHECK-NUMBER-X           REDEFINES
   211         WS-CHECK-NUMBER             PIC X(7).
   212     05  WS-CHECK-NO.
   213         10  FILLER                  PIC X           VALUE ZERO.
   214         10  WS-CHECK-WORK           PIC X(6).
   215     05  WS-ACKNO                    PIC 9(7)        VALUE ZERO.
   216     05  WS-ACKNO-X                  REDEFINES
   217         WS-ACKNO                    PIC X(7).
   218     05  WS-PAYMENT-TYPE             PIC X           VALUE ZERO.
   219     05  WS-PAYEE-TYPE-CD            PIC X           VALUE ZERO.
   220
   221     05  WS-INIT-CONTROL-GROUP.
   222         10  FILLER              PIC X               VALUE SPACES.
   223         10  FILLER              PIC X(7) VALUE LOW-VALUES.
   224
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   7
* EL687.cbl
   225     05  WS-SSN.
   226         10  WS-SSN-STATE            PIC XX.
   227         10  WS-SSN-ACCOUNT          PIC X(6).
   228         10  WS-SSN-LN3              PIC X(3).
   229
   230     05  WS-MEMBER-NUMBER.
   231         10  WS-MEMBER-STATE         PIC XX.
   232         10  WS-MEMBER-ACCOUNT       PIC X(6).
   233         10  WS-MEMBER-LN4           PIC X(4).
   234
   235     05  WS-OLD-CHECK-QUEUE-RECORD   PIC X(100)      VALUE SPACES.
   236     05  WS-NEW-CHECK-QUEUE-RECORD   PIC X(100)      VALUE SPACES.
   237
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   8
* EL687.cbl
   239     05  WS-ERROR-NUMBERS.
   240         10  ER-0002                 PIC 9(4)        VALUE 0002.
   241         10  ER-0004                 PIC 9(4)        VALUE 0004.
   242         10  ER-0008                 PIC 9(4)        VALUE 0008.
   243         10  ER-0029                 PIC 9(4)        VALUE 0029.
   244         10  ER-0330                 PIC 9(4)        VALUE 0330.
   245         10  ER-0361                 PIC 9(4)        VALUE 0361.
   246         10  ER-0362                 PIC 9(4)        VALUE 0362.
   247         10  ER-0363                 PIC 9(4)        VALUE 0363.
   248         10  ER-0364                 PIC 9(4)        VALUE 0364.
   249         10  ER-0365                 PIC 9(4)        VALUE 0365.
   250         10  ER-0366                 PIC 9(4)        VALUE 0366.
   251         10  ER-0367                 PIC 9(4)        VALUE 0367.
   252         10  ER-0368                 PIC 9(4)        VALUE 0368.
   253         10  ER-0369                 PIC 9(4)        VALUE 0369.
   254         10  ER-0370                 PIC 9(4)        VALUE 0370.
   255         10  ER-0371                 PIC 9(4)        VALUE 0371.
   256         10  ER-0379                 PIC 9(4)        VALUE 0379.
   257         10  ER-0380                 PIC 9(4)        VALUE 0380.
   258         10  ER-0381                 PIC 9(4)        VALUE 0381.
   259         10  ER-0382                 PIC 9(4)        VALUE 0382.
   260         10  ER-0383                 PIC 9(4)        VALUE 0383.
   261         10  ER-0385                 PIC 9(4)        VALUE 0385.
   262         10  ER-0387                 PIC 9(4)        VALUE 0387.
   263         10  ER-0389                 PIC 9(4)        VALUE 0389.
   264         10  ER-0390                 PIC 9(4)        VALUE 0390.
   265         10  ER-0391                 PIC 9(4)        VALUE 0391.
   266         10  ER-0392                 PIC 9(4)        VALUE 0392.
   267         10  ER-0393                 PIC 9(4)        VALUE 0393.
   268         10  ER-0394                 PIC 9(4)        VALUE 0394.
   269         10  ER-0395                 PIC 9(4)        VALUE 0395.
   270         10  ER-0490                 PIC 9(4)        VALUE 0490.
   271         10  ER-3130                 PIC 9(4)        VALUE 3130.
   272
   273
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   9
* EL687.cbl
   275*                            COPY ELCINTF.
   276******************************************************************
   277*                                                                *
   278*                                                                *
   279*                            ELCINTF.                            *
   280*                            VMOD=2.017                          *
   281*                                                                *
   282*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   283*                                                                *
   284*       LENGTH = 1024                                            *
   285*                                                                *
   286******************************************************************
   287 01  PROGRAM-INTERFACE-BLOCK.
   288     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   289     12  PI-CALLING-PROGRAM              PIC X(8).
   290     12  PI-SAVED-PROGRAM-1              PIC X(8).
   291     12  PI-SAVED-PROGRAM-2              PIC X(8).
   292     12  PI-SAVED-PROGRAM-3              PIC X(8).
   293     12  PI-SAVED-PROGRAM-4              PIC X(8).
   294     12  PI-SAVED-PROGRAM-5              PIC X(8).
   295     12  PI-SAVED-PROGRAM-6              PIC X(8).
   296     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   297     12  PI-COMPANY-ID                   PIC XXX.
   298     12  PI-COMPANY-CD                   PIC X.
   299
   300     12  PI-COMPANY-PASSWORD             PIC X(8).
   301
   302     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   303
   304     12  PI-CONTROL-IN-PROGRESS.
   305         16  PI-CARRIER                  PIC X.
   306         16  PI-GROUPING                 PIC X(6).
   307         16  PI-STATE                    PIC XX.
   308         16  PI-ACCOUNT                  PIC X(10).
   309         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   310                                         PIC X(10).
   311         16  PI-CLAIM-CERT-GRP.
   312             20  PI-CLAIM-NO             PIC X(7).
   313             20  PI-CERT-NO.
   314                 25  PI-CERT-PRIME       PIC X(10).
   315                 25  PI-CERT-SFX         PIC X.
   316             20  PI-CERT-EFF-DT          PIC XX.
   317         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   318             20  PI-PLAN-CODE            PIC X(2).
   319             20  PI-REVISION-NUMBER      PIC X(3).
   320             20  PI-PLAN-EFF-DT          PIC X(2).
   321             20  PI-PLAN-EXP-DT          PIC X(2).
   322             20  FILLER                  PIC X(11).
   323         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   324             20  PI-OE-REFERENCE-1.
   325                 25  PI-OE-REF-1-PRIME   PIC X(18).
   326                 25  PI-OE-REF-1-SUFF    PIC XX.
   327
   328     12  PI-SESSION-IN-PROGRESS          PIC X.
   329         88  CLAIM-SESSION                   VALUE '1'.
   330         88  CREDIT-SESSION                  VALUE '2'.
   331         88  WARRANTY-SESSION                VALUE '3'.
   332         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  10
* EL687.cbl
   333         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   334
   335
   336*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   337
   338     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   339     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   340
   341     12  PI-CREDIT-USER                  PIC X.
   342         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   343         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   344
   345     12  PI-CLAIM-USER                   PIC X.
   346         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   347         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   348
   349     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   350         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   351         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   352         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   353         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   354         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   355
   356     12  PI-PROCESSOR-ID                 PIC X(4).
   357
   358     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   359
   360     12  PI-MEMBER-CAPTION               PIC X(10).
   361
   362     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   363         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   364
   365     12  PI-LIFE-OVERRIDE-L1             PIC X.
   366     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   367     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   368     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   369
   370     12  PI-AH-OVERRIDE-L1               PIC X.
   371     12  PI-AH-OVERRIDE-L2               PIC XX.
   372     12  PI-AH-OVERRIDE-L6               PIC X(6).
   373     12  PI-AH-OVERRIDE-L12              PIC X(12).
   374
   375     12  PI-NEW-SYSTEM                   PIC X(2).
   376
   377     12  PI-PRIMARY-CERT-NO              PIC X(11).
   378     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   379         88  PI-USES-PAID-TO                 VALUE '1'.
   380     12  PI-CRDTCRD-SYSTEM.
   381         16  PI-CRDTCRD-USER             PIC X.
   382             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   383             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   384         16  PI-CC-MONTH-END-DT          PIC XX.
   385     12  PI-PROCESSOR-PRINTER            PIC X(4).
   386
   387     12  PI-OE-REFERENCE-2.
   388         16  PI-OE-REF-2-PRIME           PIC X(10).
   389         16  PI-OE-REF-2-SUFF            PIC X.
   390
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  11
* EL687.cbl
   391     12  PI-REM-TRM-CALC-OPTION          PIC X.
   392
   393     12  PI-LANGUAGE-TYPE                PIC X.
   394             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   395             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   396             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   397
   398     12  PI-POLICY-LINKAGE-IND           PIC X.
   399         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   400         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   401                                                   LOW-VALUES.
   402
   403     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   404     12  PI-CLAIM-PW-SESSION             PIC X(1).
   405         88  PI-CLAIM-CREDIT                 VALUE '1'.
   406         88  PI-CLAIM-CONVEN                 VALUE '2'.
   407     12  FILLER                          PIC X(4).
   408
   409     12  PI-SYSTEM-LEVEL                 PIC X(145).
   410
   411     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   412         PI-SYSTEM-LEVEL.
   413
   414         16  PI-ENTRY-CODES.
   415             20  PI-ENTRY-CD-1           PIC X.
   416             20  PI-ENTRY-CD-2           PIC X.
   417
   418         16  PI-RETURN-CODES.
   419             20  PI-RETURN-CD-1          PIC X.
   420             20  PI-RETURN-CD-2          PIC X.
   421
   422         16  PI-UPDATE-STATUS-SAVE.
   423             20  PI-UPDATE-BY            PIC X(4).
   424             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   425
   426         16  PI-LOWER-CASE-LETTERS       PIC X.
   427             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   428
   429*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   430*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   431*            88  CARRIER-CLM-CNTL            VALUE '2'.
   432
   433         16  PI-CERT-ACCESS-CONTROL      PIC X.
   434             88  ST-ACCNT-CNTL               VALUE ' '.
   435             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   436             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   437             88  ACCNT-CNTL                  VALUE '3'.
   438             88  CARR-ACCNT-CNTL             VALUE '4'.
   439
   440         16  PI-PROCESSOR-CAP-LIST.
   441             20  PI-SYSTEM-CONTROLS.
   442                24 PI-SYSTEM-DISPLAY     PIC X.
   443                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   444                24 PI-SYSTEM-MODIFY      PIC X.
   445                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   446             20  FILLER                  PIC XX.
   447             20  PI-DISPLAY-CAP          PIC X.
   448                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  12
* EL687.cbl
   449             20  PI-MODIFY-CAP           PIC X.
   450                 88  MODIFY-CAP              VALUE 'Y'.
   451             20  PI-MSG-AT-LOGON-CAP     PIC X.
   452                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   453             20  PI-FORCE-CAP            PIC X.
   454                 88  FORCE-CAP               VALUE 'Y'.
   455
   456         16  PI-PROGRAM-CONTROLS.
   457             20  PI-PGM-PRINT-OPT        PIC X.
   458             20  PI-PGM-FORMAT-OPT       PIC X.
   459             20  PI-PGM-PROCESS-OPT      PIC X.
   460             20  PI-PGM-TOTALS-OPT       PIC X.
   461
   462         16  PI-HELP-INTERFACE.
   463             20  PI-LAST-ERROR-NO        PIC X(4).
   464             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   465
   466         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   467             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   468
   469         16  PI-CR-CONTROL-IN-PROGRESS.
   470             20  PI-CR-CARRIER           PIC X.
   471             20  PI-CR-GROUPING          PIC X(6).
   472             20  PI-CR-STATE             PIC XX.
   473             20  PI-CR-ACCOUNT           PIC X(10).
   474             20  PI-CR-FIN-RESP          PIC X(10).
   475             20  PI-CR-TYPE              PIC X.
   476
   477         16  PI-CR-BATCH-NUMBER          PIC X(6).
   478
   479         16  PI-CR-MONTH-END-DT          PIC XX.
   480
   481         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   482             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   483             88  PI-ZERO-CARRIER             VALUE '1'.
   484             88  PI-ZERO-GROUPING            VALUE '2'.
   485             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   486
   487         16  PI-CARRIER-SECURITY         PIC X.
   488             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   489
   490         16  PI-ACCOUNT-SECURITY         PIC X(10).
   491             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   492             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   493
   494         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   495             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   496                                         INDEXED BY PI-ACCESS-NDX
   497                                         PIC X.
   498
   499         16  PI-GA-BILLING-CONTROL       PIC X.
   500             88  PI-GA-BILLING               VALUE '1'.
   501
   502         16  PI-MAIL-PROCESSING          PIC X.
   503             88  PI-MAIL-YES                 VALUE 'Y'.
   504
   505         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   506
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  13
* EL687.cbl
   507         16  PI-AR-SYSTEM.
   508             20  PI-AR-PROCESSING-CNTL   PIC X.
   509                 88  PI-AR-PROCESSING        VALUE 'Y'.
   510             20  PI-AR-SUMMARY-CODE      PIC X(6).
   511             20  PI-AR-MONTH-END-DT      PIC XX.
   512
   513         16  PI-MP-SYSTEM.
   514             20  PI-MORTGAGE-USER            PIC X.
   515                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   516                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   517             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   518                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   519                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   520                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   521                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   522                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   523             20  PI-MP-MONTH-END-DT          PIC XX.
   524             20  PI-MP-REFERENCE-NO.
   525                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   526                 24  PI-MP-REFERENCE-SFX     PIC XX.
   527
   528         16  PI-LABEL-CONTROL            PIC X(01).
   529             88  PI-CREATE-LABELS                    VALUE 'Y'.
   530             88  PI-BYPASS-LABELS                    VALUE 'N'.
   531
   532         16  PI-BILL-GROUPING-CODE       PIC X(01).
   533             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   534
   535         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   536             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   537             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   538
   539         16  FILLER                      PIC X(14).
   540
   541     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   542******************************************************************
   543*                            COPY ERC687PI.
   544*****************************************************************
   545*                                                               *
   546*                                                               *
   547*                            ERC687PI                           *
   548*                            VMOD=2.004                         *
   549*                                                               *
   550*****************************************************************.
   551
   552     12  FILLER                      REDEFINES
   553         PI-PROGRAM-WORK-AREA.
   554
   555         16  PI-TEMP-STORAGE-KEY.
   556             20  PI-TSK-TERM-ID      PIC X(4).
   557             20  PI-TSK-TIME         PIC S9(7)     COMP-3.
   558
   559         16  PI-PROCESSING-SW        PIC S9        COMP-3.
   560
   561         16  PI-NUMBER-OF-ALIGNMENT-CHECKS PIC S9  COMP-3.
   562
   563         16  PI-ALIGNMENT-CONTROL-GROUP  PIC S9(8) COMP.
   564
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  14
* EL687.cbl
   565         16  PI-ALIGNMENT-SEQUENCE-NO  PIC S9(4)   COMP.
   566
   567         16  PI-NUMBER-OF-CONTROL-GROUPS  PIC S9(4) COMP.
   568
   569         16  PI-CONTROL-GROUPS       COMP
   570             OCCURS 4 TIMES          INDEXED BY PI-INDEX.
   571
   572             20  PI-CONTROL-GROUP    PIC S9(8).
   573             20  PI-HIGH-SEQUENCE    PIC S9(4).
   574
   575         16  PI-CHECK-PRINTER-ID     PIC X(4).
   576
   577         16  PI-PRINTER-STARTED-SW   PIC S9      COMP-3.
   578
   579         16  PI-ASSIGN-CHECK-NUMBERS PIC X.
   580
   581         16  PI-COMPANY-ADDRESS.
   582             20  PI-COMPANY-NAME             PIC X(30).
   583             20  PI-COMPANY-ADDRESS-LINE1    PIC X(30).
   584             20  PI-COMPANY-ADDRESS-LINE2    PIC X(30).
   585             20  PI-COMPANY-ADDRESS-LINE3    PIC X(30).
   586             20  PI-COMPANY-CITY-ST          PIC X(30).
   587             20  PI-COMPANY-ZIP-CODE.
   588                 24  PI-COMPANY-ZIP-PRIME.
   589                     26  PI-ZIP-PRI-1ST      PIC X.
   590                         88  PI-CO-CANADIAN-POST-CODE
   591                                          VALUE 'A' THRU 'Z'.
   592                     26  FILLER              PIC X(4).
   593                 24  PI-COMPANY-ZIP-PLUS4    PIC X(4).
   594             20  PI-CANADIAN-POSTAL-CODE REDEFINES
   595                 PI-COMPANY-ZIP-CODE.
   596                 24  PI-CAN-POSTAL-1         PIC XXX.
   597                 24  PI-CAN-POSTAL-2         PIC XXX.
   598                 24  FILLER                  PIC XXX.
   599             20  PI-COMPANY-PHONE-NUMBER     PIC S9(11) COMP-3.
   600         16  PI-SYSID                PIC X(4).
   601
   602         16  PI-TEMP-STORAGE-ITEM    PIC S9(4) COMP SYNC.
   603         16  PI-LETTERS-IND          PIC X.
   604
   605         16  FILLER                  PIC X(419).
   606
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  15
* EL687.cbl
   608*                            COPY ERCCPA.
   609******************************************************************
   610*                                                                *
   611*                                                                *
   612*                            ERCCPA                              *
   613*                            VMOD=2.005                          *
   614*                                                                *
   615*   DESCRIPTION:  DATA TO BE PASSED TO CHECK WRITER ROUTINE.     *
   616*   LENGTH: 700 CHARACTERS                                       *
   617*                                                                *
   618******************************************************************
   619
   620 01  CHECK-PASS-AREA.
   621     12  CPA-ALIGNMENT               PIC S9(3)     COMP-3.
   622     12  CPA-CARRIER                 PIC X.
   623     12  CPA-GROUPING                PIC X(6).
   624     12  CPA-ACCOUNT                 PIC X(10).
   625     12  CPA-FIN-RESP                PIC X(10).
   626     12  CPA-STATE                   PIC XX.
   627     12  CPA-CERT-NO                 PIC X(11).
   628
   629     12  CPA-CAR-NAME                PIC X(30).
   630     12  CPA-CAR-ADDRESS-LINE1       PIC X(30).
   631     12  CPA-CAR-ADDRESS-LINE2       PIC X(30).
   632     12  CPA-CAR-ADDRESS-LINE3       PIC X(30).
   633     12  CPA-CAR-CITY-STATE          PIC X(30).
   634     12  CPA-CAR-ZIP-CODE            PIC S9(9)     COMP-3.
   635     12  CPA-PAYMENT-TYPE            PIC X.
   636     12  CPA-PAYMENT-BY              PIC X(4).
   637     12  CPA-CHECK-DATE              PIC X(2).
   638     12  CPA-CHECK-NUMBER            PIC X(7).
   639     12  CPA-AMOUNT-PAID             PIC S9(9)V99  COMP-3.
   640     12  CPA-AMOUNT-PAID-TO-DATE     PIC S9(9)V99  COMP-3.
   641     12  CPA-INCURRED-DT             PIC XX.
   642     12  CPA-REPORTED-DT             PIC XX.
   643     12  CPA-PAID-THRU-DT            PIC XX.
   644     12  CPA-PAID-FROM-DT            PIC XX.
   645     12  CPA-PAID-DT                 PIC XX.
   646
   647     12  CPA-PAYEE-NAME              PIC X(30).
   648     12  CPA-PAYEE-IN-CARE-OF        PIC X(30).
   649     12  CPA-PAYEE-ADDRESS-LINE1     PIC X(30).
   650     12  CPA-PAYEE-ADDRESS-LINE2     PIC X(30).
   651     12  CPA-PAYEE-CITY-ST           PIC X(30).
   652     12  CPA-PAYEE-ZIP-CODE.
   653         16  CPA-PAYEE-ZIP-PRIME.
   654             20  CPA-PAYEE-PRI-1ST   PIC X.
   655                 88  CPA-PAYEE-CAN-POST-CODE   VALUE 'A' THRU 'Z'.
   656             20  FILLER              PIC X(4).
   657         16  CPA-PAYEE-ZIP-PLUS4     PIC X(4).
   658     12  CPA-PAYEE-CAN-POSTAL-CODE  REDEFINES  CPA-PAYEE-ZIP-CODE.
   659         16  CPA-PAYEE-POST-1        PIC XXX.
   660         16  CPA-PAYEE-POST-2        PIC XXX.
   661         16  FILLER                  PIC XXX.
   662     12  CPA-PAYEE-PHONE-NO          PIC S9(11)   COMP-3.
   663
   664     12  CPA-SOC-SEC-NO              PIC X(11).
   665     12  CPA-MEMBER-NUMBER           PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  16
* EL687.cbl
   666     12  CPA-NO-OF-PMTS-MADE         PIC S9(3)    COMP-3.
   667     12  CPA-GENERAL-LEDGER          PIC X(7).
   668     12  CPA-CANC-DT                 PIC XX.
   669     12  CPA-LF-REFUND               PIC S9(7)V99  COMP-3.
   670     12  CPA-AH-REFUND               PIC S9(7)V99  COMP-3.
   671     12  CPA-INSURED-NAME            PIC X(28).
   672     12  CPA-CERT-EFF-DT             PIC XX.
   673     12  CPA-DEDUCT-WITHHELD         PIC S9(5)V99  COMP-3.
   674     12  CPA-ADDITIONAL-CHARGE       PIC S9(5)V99  COMP-3.
   675     12  FILLER                      PIC X(26).
   676     12  CPA-REST-OF-RECORD          PIC X(250).
   677
   678     12  CPA-CHECK-STUBS             REDEFINES
   679         CPA-REST-OF-RECORD.
   680         16  CPA-STUB1               PIC X(50).
   681         16  CPA-STUB2               PIC X(50).
   682         16  CPA-STUB3               PIC X(50).
   683         16  CPA-STUB4               PIC X(50).
   684         16  CPA-STUB5               PIC X(50).
   685
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  17
* EL687.cbl
   687*                            COPY ELCNWA.
   688*****************************************************************
   689*                                                               *
   690*                                                               *
   691*                            ELCNWA.                            *
   692*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   693*                            VMOD=2.003                         *
   694*                                                               *
   695*            M O V E   N A M E   W O R K   A R E A.             *
   696*                                                               *
   697*****************************************************************.
   698
   699 01  WS-NAME-WORK-AREA.
   700     05  WS-INSURED-LAST-NAME        PIC X(15).
   701     05  WS-INSURED-1ST-NAME         PIC X(12).
   702     05  WS-INSURED-MID-INIT         PIC X.
   703
   704     05  WS-NAME-WORK.
   705         10  WS-NW                   PIC X
   706             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   707
   708     05  WS-NAME-WORK2.
   709         10  WS-NW2                  PIC X
   710             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   711                                        NWA-INDEX0.
   712
   713     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   714                                     COMP-3.
   715
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  18
* EL687.cbl
   717*                            COPY EL687S.
   718 01  EL687AI.
   719     05  FILLER            PIC  X(0012).
   720*    -------------------------------
   721     05  ADATEL PIC S9(0004) COMP.
   722     05  ADATEF PIC  X(0001).
   723     05  FILLER REDEFINES ADATEF.
   724         10  ADATEA PIC  X(0001).
   725     05  ADATEI PIC  X(0008).
   726*    -------------------------------
   727     05  ATIMEL PIC S9(0004) COMP.
   728     05  ATIMEF PIC  X(0001).
   729     05  FILLER REDEFINES ATIMEF.
   730         10  ATIMEA PIC  X(0001).
   731     05  ATIMEI PIC  X(0005).
   732*    -------------------------------
   733     05  AOPTIONL PIC S9(0004) COMP.
   734     05  AOPTIONF PIC  X(0001).
   735     05  FILLER REDEFINES AOPTIONF.
   736         10  AOPTIONA PIC  X(0001).
   737     05  AOPTIONI PIC  X(0001).
   738*    -------------------------------
   739     05  ACG01L PIC S9(0004) COMP.
   740     05  ACG01F PIC  X(0001).
   741     05  FILLER REDEFINES ACG01F.
   742         10  ACG01A PIC  X(0001).
   743     05  ACG01I PIC  X(0007).
   744*    -------------------------------
   745     05  ACG02L PIC S9(0004) COMP.
   746     05  ACG02F PIC  X(0001).
   747     05  FILLER REDEFINES ACG02F.
   748         10  ACG02A PIC  X(0001).
   749     05  ACG02I PIC  X(0007).
   750*    -------------------------------
   751     05  ACG03L PIC S9(0004) COMP.
   752     05  ACG03F PIC  X(0001).
   753     05  FILLER REDEFINES ACG03F.
   754         10  ACG03A PIC  X(0001).
   755     05  ACG03I PIC  X(0007).
   756*    -------------------------------
   757     05  ACG04L PIC S9(0004) COMP.
   758     05  ACG04F PIC  X(0001).
   759     05  FILLER REDEFINES ACG04F.
   760         10  ACG04A PIC  X(0001).
   761     05  ACG04I PIC  X(0007).
   762*    -------------------------------
   763     05  AALIGNL PIC S9(0004) COMP.
   764     05  AALIGNF PIC  X(0001).
   765     05  FILLER REDEFINES AALIGNF.
   766         10  AALIGNA PIC  X(0001).
   767     05  AALIGNI PIC  X(0001).
   768*    -------------------------------
   769     05  ACKNOL PIC S9(0004) COMP.
   770     05  ACKNOF PIC  X(0001).
   771     05  FILLER REDEFINES ACKNOF.
   772         10  ACKNOA PIC  X(0001).
   773     05  ACKNOI PIC  X(0007).
   774*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  19
* EL687.cbl
   775     05  AACNL PIC S9(0004) COMP.
   776     05  AACNF PIC  X(0001).
   777     05  FILLER REDEFINES AACNF.
   778         10  AACNA PIC  X(0001).
   779     05  AACNI PIC  X(0001).
   780*    -------------------------------
   781     05  APRTL PIC S9(0004) COMP.
   782     05  APRTF PIC  X(0001).
   783     05  FILLER REDEFINES APRTF.
   784         10  APRTA PIC  X(0001).
   785     05  APRTI PIC  X(0004).
   786*    -------------------------------
   787     05  AEMSG1L PIC S9(0004) COMP.
   788     05  AEMSG1F PIC  X(0001).
   789     05  FILLER REDEFINES AEMSG1F.
   790         10  AEMSG1A PIC  X(0001).
   791     05  AEMSG1I PIC  X(0079).
   792*    -------------------------------
   793     05  AEMSG2L PIC S9(0004) COMP.
   794     05  AEMSG2F PIC  X(0001).
   795     05  FILLER REDEFINES AEMSG2F.
   796         10  AEMSG2A PIC  X(0001).
   797     05  AEMSG2I PIC  X(0079).
   798*    -------------------------------
   799     05  AEMSG3L PIC S9(0004) COMP.
   800     05  AEMSG3F PIC  X(0001).
   801     05  FILLER REDEFINES AEMSG3F.
   802         10  AEMSG3A PIC  X(0001).
   803     05  AEMSG3I PIC  X(0079).
   804*    -------------------------------
   805     05  APFKL PIC S9(0004) COMP.
   806     05  APFKF PIC  X(0001).
   807     05  FILLER REDEFINES APFKF.
   808         10  APFKA PIC  X(0001).
   809     05  APFKI PIC  9(2).
   810 01  EL687AO REDEFINES EL687AI.
   811     05  FILLER            PIC  X(0012).
   812*    -------------------------------
   813     05  FILLER            PIC  X(0003).
   814     05  ADATEO PIC  X(0008).
   815*    -------------------------------
   816     05  FILLER            PIC  X(0003).
   817     05  ATIMEO PIC  99.99.
   818*    -------------------------------
   819     05  FILLER            PIC  X(0003).
   820     05  AOPTIONO PIC  X(0001).
   821*    -------------------------------
   822     05  FILLER            PIC  X(0003).
   823     05  ACG01O PIC  9999999.
   824*    -------------------------------
   825     05  FILLER            PIC  X(0003).
   826     05  ACG02O PIC  9999999.
   827*    -------------------------------
   828     05  FILLER            PIC  X(0003).
   829     05  ACG03O PIC  9999999.
   830*    -------------------------------
   831     05  FILLER            PIC  X(0003).
   832     05  ACG04O PIC  9999999.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  20
* EL687.cbl
   833*    -------------------------------
   834     05  FILLER            PIC  X(0003).
   835     05  AALIGNO PIC  9.
   836*    -------------------------------
   837     05  FILLER            PIC  X(0003).
   838     05  ACKNOO PIC  9999999.
   839*    -------------------------------
   840     05  FILLER            PIC  X(0003).
   841     05  AACNO PIC  X(0001).
   842*    -------------------------------
   843     05  FILLER            PIC  X(0003).
   844     05  APRTO PIC  X(0004).
   845*    -------------------------------
   846     05  FILLER            PIC  X(0003).
   847     05  AEMSG1O PIC  X(0079).
   848*    -------------------------------
   849     05  FILLER            PIC  X(0003).
   850     05  AEMSG2O PIC  X(0079).
   851*    -------------------------------
   852     05  FILLER            PIC  X(0003).
   853     05  AEMSG3O PIC  X(0079).
   854*    -------------------------------
   855     05  FILLER            PIC  X(0003).
   856     05  APFKO PIC  99.
   857*    -------------------------------
   858 01  FILLER                          REDEFINES
   859     EL687AI.
   860
   861     05  FILLER                      PIC X(35).
   862
   863     05  FILLER                      OCCURS 4 TIMES
   864                                     INDEXED BY EL687A-INDEX.
   865
   866         10  EL687A-CONTROL-GROUP-LENGTH   PIC S9(4)
   867                                           COMP.
   868         10  EL687A-CONTROL-GROUP-ATTRB    PIC X.
   869         10  EL687A-CONTROL-GROUP          PIC 9(7).
   870         10  EL687A-CONTROL-GROUP-X        REDEFINES
   871             EL687A-CONTROL-GROUP          PIC X(7).
   872
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  21
* EL687.cbl
   874*                            COPY ELCJPFX.
   875******************************************************************
   876*                                                                *
   877*                                                                *
   878*                            ELCJPFX.                            *
   879*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   880*                            VMOD=2.002                          *
   881*                                                                *
   882*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   883*                                                                *
   884*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   885*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   886*        ELCNTL - CONTROL FILE                                   *
   887*        ELMSTR - CLAIM MASTERS                                  *
   888*        ELTRLR - ACTIVITY TRAILERS                              *
   889*        ELCHKQ - CHECK QUE                                      *
   890******************************************************************
   891 01  JOURNAL-RECORD.
   892     12  JP-USER-ID                  PIC X(4).
   893     12  JP-FILE-ID                  PIC X(8).
   894     12  JP-PROGRAM-ID               PIC X(8).
   895     12  JP-RECORD-TYPE              PIC X.
   896         88 JP-ADD              VALUE 'A'.
   897         88 JP-BEFORE-CHANGE    VALUE 'B'.
   898         88 JP-AFTER-CHANGE     VALUE 'C'.
   899         88 JP-DELETE           VALUE 'D'.
   900         88 JP-GENERIC-DELETE   VALUE 'G'.
   901         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   902         88 JP-KEY-CHG-ADD      VALUE 'N'.
   903     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   904     12  JP-RECORD-AREA
   905
   906
   907                                     PIC X(750).
   908
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  22
* EL687.cbl
   910*                            COPY ELCEMIB.
   911******************************************************************
   912*                                                                *
   913*                                                                *
   914*                            ELCEMIB.                            *
   915*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   916*                            VMOD=2.005                          *
   917*                                                                *
   918*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   919*                                                                *
   920******************************************************************
   921 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   922     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   923     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   924     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   925     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   926     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   927     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   928     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   929     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   930     12  EMI-SWITCH1             PIC X        VALUE '1'.
   931         88  EMI-NO-ERRORS                    VALUE '1'.
   932         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   933         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   934     12  EMI-SWITCH2             PIC X        VALUE '1'.
   935         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   936     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   937         88  EMI-AREA1-EMPTY                  VALUE '1'.
   938         88  EMI-AREA1-FULL                   VALUE '2'.
   939     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   940         88  EMI-AREA2-EMPTY                  VALUE '1'.
   941         88  EMI-AREA2-FULL                   VALUE '2'.
   942     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   943         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   944         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   945         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   946         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   947         88  EMI-BYPASS-FATALS                VALUE 'X'.
   948     12  EMI-ERROR-LINES.
   949         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   950         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   951         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   952         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   953             20  EMI-ERR-CODES OCCURS 10 TIMES.
   954                 24  EMI-ERR-NUM         PIC X(4).
   955                 24  EMI-FILLER          PIC X.
   956                 24  EMI-SEV             PIC X.
   957                 24  FILLER              PIC X.
   958             20  FILLER                  PIC X(02).
   959     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   960         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   961             20  EMI-ERROR-NUMBER    PIC X(4).
   962             20  EMI-FILL            PIC X.
   963             20  EMI-SEVERITY        PIC X.
   964             20  FILLER              PIC X.
   965             20  EMI-ERROR-TEXT.
   966                 24  EMI-TEXT-VARIABLE   PIC X(10).
   967                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  23
* EL687.cbl
   968     12  EMI-SEVERITY-SAVE           PIC X.
   969         88  EMI-NOTE                    VALUE 'N'.
   970         88  EMI-WARNING                 VALUE 'W'.
   971         88  EMI-FORCABLE                VALUE 'F'.
   972         88  EMI-FATAL                   VALUE 'X'.
   973     12  EMI-MESSAGE-FLAG            PIC X.
   974         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   975         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   976     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   977     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   978         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   979         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   980         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   981     12  FILLER                      PIC X(137)  VALUE SPACES.
   982     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   983     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   984     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   985     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   986
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  24
* EL687.cbl
   988*                            COPY ELCDATE.
   989******************************************************************
   990*                                                                *
   991*                                                                *
   992*                            ELCDATE.                            *
   993*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   994*                            VMOD=2.003
   995*                                                                *
   996*                                                                *
   997*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   998*                 LENGTH = 200                                   *
   999******************************************************************
  1000
  1001 01  DATE-CONVERSION-DATA.
  1002     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1003     12  DC-OPTION-CODE                PIC X.
  1004         88  BIN-TO-GREG                VALUE ' '.
  1005         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1006         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1007         88  YMD-GREG-TO-BIN            VALUE '3'.
  1008         88  MDY-GREG-TO-BIN            VALUE '4'.
  1009         88  JULIAN-TO-BIN              VALUE '5'.
  1010         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1011         88  FIND-CENTURY               VALUE '7'.
  1012         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1013         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1014         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1015         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1016         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1017         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1018         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1019         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1020         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1021         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1022         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1023         88  BIN-3-TO-GREG              VALUE 'I'.
  1024         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1025         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1026         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1027         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1028         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1029         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1030         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1031         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1032         88  THREE-CHARACTER-BIN
  1033                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1034         88  GREGORIAN-TO-BIN
  1035                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1036         88  BIN-TO-GREGORIAN
  1037                  VALUES ' ' '1' 'I' '8' 'G'.
  1038         88  JULIAN-TO-BINARY
  1039                  VALUES '5' 'C' 'E' 'F'.
  1040     12  DC-ERROR-CODE                 PIC X.
  1041         88  NO-CONVERSION-ERROR        VALUE ' '.
  1042         88  DATE-CONVERSION-ERROR
  1043                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1044         88  DATE-IS-ZERO               VALUE '1'.
  1045         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  25
* EL687.cbl
  1046         88  DATE-IS-INVALID            VALUE '3'.
  1047         88  DATE1-GREATER-DATE2        VALUE '4'.
  1048         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1049         88  DATE-INVALID-OPTION        VALUE '9'.
  1050         88  INVALID-CENTURY            VALUE 'A'.
  1051         88  ONLY-CENTURY               VALUE 'B'.
  1052         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1053         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1054     12  DC-END-OF-MONTH               PIC X.
  1055         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1056     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1057         88  USE-NORMAL-PROCESS         VALUE ' '.
  1058         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1059         88  ADJUST-UP-100-YRS          VALUE '2'.
  1060     12  FILLER                        PIC X.
  1061     12  DC-CONVERSION-DATES.
  1062         16  DC-BIN-DATE-1             PIC XX.
  1063         16  DC-BIN-DATE-2             PIC XX.
  1064         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1065         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1066                       DC-GREG-DATE-1-EDIT.
  1067             20  DC-EDIT1-MONTH        PIC 99.
  1068             20  SLASH1-1              PIC X.
  1069             20  DC-EDIT1-DAY          PIC 99.
  1070             20  SLASH1-2              PIC X.
  1071             20  DC-EDIT1-YEAR         PIC 99.
  1072         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1073         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1074                     DC-GREG-DATE-2-EDIT.
  1075             20  DC-EDIT2-MONTH        PIC 99.
  1076             20  SLASH2-1              PIC X.
  1077             20  DC-EDIT2-DAY          PIC 99.
  1078             20  SLASH2-2              PIC X.
  1079             20  DC-EDIT2-YEAR         PIC 99.
  1080         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1081         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1082                     DC-GREG-DATE-1-YMD.
  1083             20  DC-YMD-YEAR           PIC 99.
  1084             20  DC-YMD-MONTH          PIC 99.
  1085             20  DC-YMD-DAY            PIC 99.
  1086         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1087         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1088                      DC-GREG-DATE-1-MDY.
  1089             20  DC-MDY-MONTH          PIC 99.
  1090             20  DC-MDY-DAY            PIC 99.
  1091             20  DC-MDY-YEAR           PIC 99.
  1092         16  DC-GREG-DATE-1-ALPHA.
  1093             20  DC-ALPHA-MONTH        PIC X(10).
  1094             20  DC-ALPHA-DAY          PIC 99.
  1095             20  FILLER                PIC XX.
  1096             20  DC-ALPHA-CENTURY.
  1097                 24 DC-ALPHA-CEN-N     PIC 99.
  1098             20  DC-ALPHA-YEAR         PIC 99.
  1099         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1100         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1101         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1102         16  DC-JULIAN-DATE            PIC 9(05).
  1103         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  26
* EL687.cbl
  1104                                       PIC 9(05).
  1105         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1106             20  DC-JULIAN-YEAR        PIC 99.
  1107             20  DC-JULIAN-DAYS        PIC 999.
  1108         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1109         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1110         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1111     12  DATE-CONVERSION-VARIBLES.
  1112         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1113         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1114             20  FILLER                PIC 9(3).
  1115             20  HOLD-CEN-1-CCYY.
  1116                 24  HOLD-CEN-1-CC     PIC 99.
  1117                 24  HOLD-CEN-1-YY     PIC 99.
  1118             20  HOLD-CEN-1-MO         PIC 99.
  1119             20  HOLD-CEN-1-DA         PIC 99.
  1120         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1121             20  HOLD-CEN-1-R-MO       PIC 99.
  1122             20  HOLD-CEN-1-R-DA       PIC 99.
  1123             20  HOLD-CEN-1-R-CCYY.
  1124                 24  HOLD-CEN-1-R-CC   PIC 99.
  1125                 24  HOLD-CEN-1-R-YY   PIC 99.
  1126             20  FILLER                PIC 9(3).
  1127         16  HOLD-CENTURY-1-X.
  1128             20  FILLER                PIC X(3)  VALUE SPACES.
  1129             20  HOLD-CEN-1-X-CCYY.
  1130                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1131                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1132             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1133             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1134         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1135             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1136             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1137             20  HOLD-CEN-1-R-X-CCYY.
  1138                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1139                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1140             20  FILLER                PIC XXX.
  1141         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1142         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1143         16  DC-JULIAN-DATE-1          PIC 9(07).
  1144         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1145             20  DC-JULIAN-1-CCYY.
  1146                 24  DC-JULIAN-1-CC    PIC 99.
  1147                 24  DC-JULIAN-1-YR    PIC 99.
  1148             20  DC-JULIAN-DA-1        PIC 999.
  1149         16  DC-JULIAN-DATE-2          PIC 9(07).
  1150         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1151             20  DC-JULIAN-2-CCYY.
  1152                 24  DC-JULIAN-2-CC    PIC 99.
  1153                 24  DC-JULIAN-2-YR    PIC 99.
  1154             20  DC-JULIAN-DA-2        PIC 999.
  1155         16  DC-GREG-DATE-A-EDIT.
  1156             20  DC-EDITA-MONTH        PIC 99.
  1157             20  SLASHA-1              PIC X VALUE '/'.
  1158             20  DC-EDITA-DAY          PIC 99.
  1159             20  SLASHA-2              PIC X VALUE '/'.
  1160             20  DC-EDITA-CCYY.
  1161                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  27
* EL687.cbl
  1162                 24  DC-EDITA-YEAR     PIC 99.
  1163         16  DC-GREG-DATE-B-EDIT.
  1164             20  DC-EDITB-MONTH        PIC 99.
  1165             20  SLASHB-1              PIC X VALUE '/'.
  1166             20  DC-EDITB-DAY          PIC 99.
  1167             20  SLASHB-2              PIC X VALUE '/'.
  1168             20  DC-EDITB-CCYY.
  1169                 24  DC-EDITB-CENT     PIC 99.
  1170                 24  DC-EDITB-YEAR     PIC 99.
  1171         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1172         16  DC-GREG-DATE-CYMD-R REDEFINES
  1173                              DC-GREG-DATE-CYMD.
  1174             20  DC-CYMD-CEN           PIC 99.
  1175             20  DC-CYMD-YEAR          PIC 99.
  1176             20  DC-CYMD-MONTH         PIC 99.
  1177             20  DC-CYMD-DAY           PIC 99.
  1178         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1179         16  DC-GREG-DATE-MDCY-R REDEFINES
  1180                              DC-GREG-DATE-MDCY.
  1181             20  DC-MDCY-MONTH         PIC 99.
  1182             20  DC-MDCY-DAY           PIC 99.
  1183             20  DC-MDCY-CEN           PIC 99.
  1184             20  DC-MDCY-YEAR          PIC 99.
  1185    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1186        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1187    12  DC-EL310-DATE                  PIC X(21).
  1188    12  FILLER                         PIC X(28).
  1189
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  28
* EL687.cbl
  1191*                            COPY ELCLOGOF.
  1192******************************************************************
  1193*                                                                *
  1194*                                                                *
  1195*                            ELCLOGOF.                           *
  1196*                            VMOD=2.001                          *
  1197*                                                                *
  1198*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1199*                                                                *
  1200******************************************************************
  1201 01  CLASIC-LOGOFF.
  1202     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1203     12  LOGOFF-TEXT.
  1204         16  FILLER          PIC X(5)    VALUE SPACES.
  1205         16  LOGOFF-MSG.
  1206             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1207             20  FILLER      PIC X       VALUE SPACES.
  1208             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1209         16  FILLER          PIC X(80)
  1210           VALUE '* YOU ARE NOW LOGGED OFF'.
  1211         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1212         16  FILLER          PIC X       VALUE QUOTE.
  1213         16  LOGOFF-SYS-MSG  PIC X(17)
  1214           VALUE 'S CLAS-IC SYSTEM '.
  1215     12  TEXT-MESSAGES.
  1216         16  UNACCESS-MSG    PIC X(29)
  1217             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1218         16  PGMIDERR-MSG    PIC X(17)
  1219             VALUE 'PROGRAM NOT FOUND'.
  1220
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  29
* EL687.cbl
  1222*                            COPY ELCATTR.
  1223******************************************************************
  1224*                                                                *
  1225*                            ELCATTR.                            *
  1226*                            VMOD=2.001                          *
  1227*                                                                *
  1228*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1229*                                                                *
  1230*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1231*                                                                *
  1232*                   POS 1   P=PROTECTED                          *
  1233*                           U=UNPROTECTED                        *
  1234*                           S=ASKIP                              *
  1235*                   POS 2   A=ALPHA/NUMERIC                      *
  1236*                           N=NUMERIC                            *
  1237*                   POS 3   N=NORMAL                             *
  1238*                           B=BRIGHT                             *
  1239*                           D=DARK                               *
  1240*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1241*                           OF=MODIFIED DATA TAG OFF             *
  1242*                                                                *
  1243*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1244******************************************************************
  1245 01  ATTRIBUTE-LIST.
  1246     12  AL-PABOF            PIC X       VALUE 'Y'.
  1247     12  AL-PABON            PIC X       VALUE 'Z'.
  1248     12  AL-PADOF            PIC X       VALUE '%'.
  1249     12  AL-PADON            PIC X       VALUE '_'.
  1250     12  AL-PANOF            PIC X       VALUE '-'.
  1251     12  AL-PANON            PIC X       VALUE '/'.
  1252     12  AL-SABOF            PIC X       VALUE '8'.
  1253     12  AL-SABON            PIC X       VALUE '9'.
  1254     12  AL-SADOF            PIC X       VALUE '@'.
  1255     12  AL-SADON            PIC X       VALUE QUOTE.
  1256     12  AL-SANOF            PIC X       VALUE '0'.
  1257     12  AL-SANON            PIC X       VALUE '1'.
  1258     12  AL-UABOF            PIC X       VALUE 'H'.
  1259     12  AL-UABON            PIC X       VALUE 'I'.
  1260     12  AL-UADOF            PIC X       VALUE '<'.
  1261     12  AL-UADON            PIC X       VALUE '('.
  1262     12  AL-UANOF            PIC X       VALUE ' '.
  1263     12  AL-UANON            PIC X       VALUE 'A'.
  1264     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1265     12  AL-UNBON            PIC X       VALUE 'R'.
  1266     12  AL-UNDOF            PIC X       VALUE '*'.
  1267     12  AL-UNDON            PIC X       VALUE ')'.
  1268     12  AL-UNNOF            PIC X       VALUE '&'.
  1269     12  AL-UNNON            PIC X       VALUE 'J'.
  1270
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  30
* EL687.cbl
  1272*                            COPY ELCAID.
  1273******************************************************************
  1274*                                                                *
  1275*                            ELCAID.                             *
  1276*                            VMOD=2.001                          *
  1277*                                                                *
  1278*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1279*                                                                *
  1280*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1281*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1282******************************************************************
  1283
  1284 01  DFHAID.
  1285   02  DFHNULL   PIC  X  VALUE  ' '.
  1286   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1287   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1288   02  DFHPEN    PIC  X  VALUE  '='.
  1289   02  DFHOPID   PIC  X  VALUE  'W'.
  1290   02  DFHPA1    PIC  X  VALUE  '%'.
  1291   02  DFHPA2    PIC  X  VALUE  '>'.
  1292   02  DFHPA3    PIC  X  VALUE  ','.
  1293   02  DFHPF1    PIC  X  VALUE  '1'.
  1294   02  DFHPF2    PIC  X  VALUE  '2'.
  1295   02  DFHPF3    PIC  X  VALUE  '3'.
  1296   02  DFHPF4    PIC  X  VALUE  '4'.
  1297   02  DFHPF5    PIC  X  VALUE  '5'.
  1298   02  DFHPF6    PIC  X  VALUE  '6'.
  1299   02  DFHPF7    PIC  X  VALUE  '7'.
  1300   02  DFHPF8    PIC  X  VALUE  '8'.
  1301   02  DFHPF9    PIC  X  VALUE  '9'.
  1302   02  DFHPF10   PIC  X  VALUE  ':'.
  1303   02  DFHPF11   PIC  X  VALUE  '#'.
  1304   02  DFHPF12   PIC  X  VALUE  '@'.
  1305   02  DFHPF13   PIC  X  VALUE  'A'.
  1306   02  DFHPF14   PIC  X  VALUE  'B'.
  1307   02  DFHPF15   PIC  X  VALUE  'C'.
  1308   02  DFHPF16   PIC  X  VALUE  'D'.
  1309   02  DFHPF17   PIC  X  VALUE  'E'.
  1310   02  DFHPF18   PIC  X  VALUE  'F'.
  1311   02  DFHPF19   PIC  X  VALUE  'G'.
  1312   02  DFHPF20   PIC  X  VALUE  'H'.
  1313   02  DFHPF21   PIC  X  VALUE  'I'.
  1314*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1315   02  DFHPF22   PIC  X  VALUE  '['.
  1316   02  DFHPF23   PIC  X  VALUE  '.'.
  1317   02  DFHPF24   PIC  X  VALUE  '<'.
  1318   02  DFHMSRE   PIC  X  VALUE  'X'.
  1319   02  DFHSTRF   PIC  X  VALUE  'h'.
  1320   02  DFHTRIG   PIC  X  VALUE  '"'.
  1321
  1322 01  FILLER                      REDEFINES
  1323     DFHAID.
  1324
  1325     05  FILLER                      PIC X(8).
  1326
  1327     05  PF-VALUES                   PIC X
  1328         OCCURS 24 TIMES.
  1329
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  31
* EL687.cbl
  1331****************************************************************
  1332*
  1333* Copyright (c) 2007 by Clerity Solutions, Inc.
  1334* All rights reserved.
  1335*
  1336****************************************************************
  1337 01  DFHEIV.
  1338   02  DFHEIV0               PIC X(35).
  1339   02  DFHEIV1               PIC X(08).
  1340   02  DFHEIV2               PIC X(08).
  1341   02  DFHEIV3               PIC X(08).
  1342   02  DFHEIV4               PIC X(06).
  1343   02  DFHEIV5               PIC X(04).
  1344   02  DFHEIV6               PIC X(04).
  1345   02  DFHEIV7               PIC X(02).
  1346   02  DFHEIV8               PIC X(02).
  1347   02  DFHEIV9               PIC X(01).
  1348   02  DFHEIV10              PIC S9(7) COMP-3.
  1349   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1350   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1351   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1352   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1353   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1354   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1355   02  DFHEIV17              PIC X(04).
  1356   02  DFHEIV18              PIC X(04).
  1357   02  DFHEIV19              PIC X(04).
  1358   02  DFHEIV20              USAGE IS POINTER.
  1359   02  DFHEIV21              USAGE IS POINTER.
  1360   02  DFHEIV22              USAGE IS POINTER.
  1361   02  DFHEIV23              USAGE IS POINTER.
  1362   02  DFHEIV24              USAGE IS POINTER.
  1363   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1364   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1365   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1366   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1367   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1368   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1369   02  FILLER                PIC X(02).
  1370   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1371   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1372   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1373   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1374   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1375 LINKAGE  SECTION.
  1376*****************************************************************
  1377*                                                               *
  1378* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1379* All rights reserved.                                          *
  1380*                                                               *
  1381*****************************************************************
  1382 01  dfheiblk.
  1383     02  eibtime          pic s9(7) comp-3.
  1384     02  eibdate          pic s9(7) comp-3.
  1385     02  eibtrnid         pic x(4).
  1386     02  eibtaskn         pic s9(7) comp-3.
  1387     02  eibtrmid         pic x(4).
  1388     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  32
* EL687.cbl
  1389     02  eibcposn         pic s9(4) comp.
  1390     02  eibcalen         pic s9(4) comp.
  1391     02  eibaid           pic x(1).
  1392     02  eibfiller1       pic x(1).
  1393     02  eibfn            pic x(2).
  1394     02  eibfiller2       pic x(2).
  1395     02  eibrcode         pic x(6).
  1396     02  eibfiller3       pic x(2).
  1397     02  eibds            pic x(8).
  1398     02  eibreqid         pic x(8).
  1399     02  eibrsrce         pic x(8).
  1400     02  eibsync          pic x(1).
  1401     02  eibfree          pic x(1).
  1402     02  eibrecv          pic x(1).
  1403     02  eibsend          pic x(1).
  1404     02  eibatt           pic x(1).
  1405     02  eibeoc           pic x(1).
  1406     02  eibfmh           pic x(1).
  1407     02  eibcompl         pic x(1).
  1408     02  eibsig           pic x(1).
  1409     02  eibconf          pic x(1).
  1410     02  eiberr           pic x(1).
  1411     02  eibrldbk         pic x(1).
  1412     02  eiberrcd         pic x(4).
  1413     02  eibsynrb         pic x(1).
  1414     02  eibnodat         pic x(1).
  1415     02  eibfiller5       pic x(2).
  1416     02  eibresp          pic 9(09) comp.
  1417     02  eibresp2         pic 9(09) comp.
  1418     02  dfheigdj         pic s9(4) comp.
  1419     02  dfheigdk         pic s9(4) comp.
  1420
  1421 01  DFHCOMMAREA                     PIC X(1024).
  1422
  1423*01 DFHBLLDS                         COMP SYNC.
  1424*    05  BLLCBAR                     PIC S9(9).
  1425*    05  CQFCBAR                     PIC S9(9).
  1426*    05  CFCBAR                      PIC S9(9).
  1427*    05  PPFCBAR                     PIC S9(9).
  1428*    05  CMFCBAR                     PIC S9(9).
  1429*    05  CHFCBAR                     PIC S9(9).
  1430
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  33
* EL687.cbl
  1432*                            COPY ERCCHKQ.
  1433******************************************************************
  1434*                                                                *
  1435*                                                                *
  1436*                            ERCCHKQ                             *
  1437*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1438*                            VMOD=2.005                          *
  1439*                                                                *
  1440*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  1441*                                                                *
  1442*   FILE TYPE = VSAM,KSDS                                        *
  1443*   RECORD SIZE = 100  RECFORM = FIXED                           *
  1444*                                                                *
  1445*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  1446*       ALTERNATE PATH  = NONE                                   *
  1447*                                                                *
  1448*   LOG = YES                                                    *
  1449*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1450******************************************************************
  1451 01  CHECK-QUE.
  1452     12  CQ-RECORD-ID                PIC XX.
  1453         88  VALID-CQ-ID                     VALUE 'CQ'.
  1454
  1455     12  CQ-CONTROL-PRIMARY.
  1456         16  CQ-COMPANY-CD           PIC X.
  1457         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  1458         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  1459
  1460     12  CQ-ENTRY-TYPE               PIC X.
  1461             88  CHECK-ON-QUE           VALUE 'Q'.
  1462             88  ALIGNMENT-CHECK        VALUE 'A'.
  1463             88  MANUAL-CHECK           VALUE 'M'.
  1464             88  SPOILED-CHECK          VALUE 'S'.
  1465             88  VOIDED-CHECK           VALUE 'V'.
  1466             88  PAYMENT-ABORTED        VALUE 'X'.
  1467
  1468     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  1469
  1470     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  1471         CQ-CREDIT-MASTER-CNTL.
  1472         16  CQ-PYAJ-CARRIER         PIC X.
  1473         16  CQ-PYAJ-GROUPING        PIC X(6).
  1474         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  1475         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  1476         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  1477         16  CQ-PYAJ-REC-TYPE        PIC X.
  1478         16  FILLER                  PIC X(18).
  1479
  1480     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  1481         CQ-CREDIT-MASTER-CNTL.
  1482         16  CQ-CHEK-CARRIER         PIC X.
  1483         16  CQ-CHEK-GROUPING        PIC X(6).
  1484         16  CQ-CHEK-STATE           PIC XX.
  1485         16  CQ-CHEK-ACCOUNT         PIC X(10).
  1486         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  1487         16  CQ-CHEK-CERT-NO.
  1488             20  CQ-CHEK-CERT-PRIME  PIC X(10).
  1489             20  CQ-CHEK-CERT-SFX    PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  34
* EL687.cbl
  1490         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  1491         16  CQ-CHEK-FIN-RESP        PIC X(10).
  1492         16  FILLER                  PIC X(06).
  1493
  1494     12  CQ-CHECK-NUMBER             PIC X(7).
  1495     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  1496     12  CQ-PAYMENT-TYPE             PIC X.
  1497             88  CQ-BILLING-CREDIT         VALUE '1'.
  1498             88  CQ-REFUND-PMT             VALUE '2'.
  1499             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  1500     12  CQ-VOID-INDICATOR           PIC X.
  1501             88  CHECK-IS-VOID             VALUE 'V'.
  1502     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  1503     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  1504     12  CQ-CHECK-BY-USER            PIC X(4).
  1505     12  CQ-PRE-NUMBERING-SW         PIC X.
  1506       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  1507       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  1508
  1509     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  1510     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  1511     12  CQ-ACCOUNT-AGENT            PIC X(10).
  1512     12  CQ-CHECK-VOIDED-DT          PIC XX.
  1513
  1514     12  CQ-LETTERS-IND              PIC X.
  1515         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  1516
  1517******************************************************************
  1518
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  35
* EL687.cbl
  1520*                            COPY ELCCNTL.
  1521******************************************************************
  1522*                                                                *
  1523*                                                                *
  1524*                            ELCCNTL.                            *
  1525*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1526*                            VMOD=2.059                          *
  1527*                                                                *
  1528*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1529*                                                                *
  1530*   FILE TYPE = VSAM,KSDS                                        *
  1531*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1532*                                                                *
  1533*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1534*       ALTERNATE INDEX = NONE                                   *
  1535*                                                                *
  1536*   LOG = YES                                                    *
  1537*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1538******************************************************************
  1539*                   C H A N G E   L O G
  1540*
  1541* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1542*-----------------------------------------------------------------
  1543*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1544* EFFECTIVE    NUMBER
  1545*-----------------------------------------------------------------
  1546* 082503                   PEMA  ADD BENEFIT GROUP
  1547* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1548* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1549* 092705    2005050300006  PEMA  ADD SPP LEASES
  1550* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1551* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1552* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1553* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1554******************************************************************
  1555*
  1556 01  CONTROL-FILE.
  1557     12  CF-RECORD-ID                       PIC XX.
  1558         88  VALID-CF-ID                        VALUE 'CF'.
  1559
  1560     12  CF-CONTROL-PRIMARY.
  1561         16  CF-COMPANY-ID                  PIC XXX.
  1562         16  CF-RECORD-TYPE                 PIC X.
  1563             88  CF-COMPANY-MASTER              VALUE '1'.
  1564             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1565             88  CF-STATE-MASTER                VALUE '3'.
  1566             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1567             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1568             88  CF-CARRIER-MASTER              VALUE '6'.
  1569             88  CF-MORTALITY-MASTER            VALUE '7'.
  1570             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1571             88  CF-TERMINAL-MASTER             VALUE '9'.
  1572             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1573             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1574             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1575             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1576             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1577             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  36
* EL687.cbl
  1578             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1579             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1580             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1581         16  CF-ACCESS-CD-GENL              PIC X(4).
  1582         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1583             20  CF-PROCESSOR               PIC X(4).
  1584         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1585             20  CF-STATE-CODE              PIC XX.
  1586             20  FILLER                     PIC XX.
  1587         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1588             20  FILLER                     PIC XX.
  1589             20  CF-HI-BEN-IN-REC           PIC XX.
  1590         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1591             20  FILLER                     PIC XXX.
  1592             20  CF-CARRIER-CNTL            PIC X.
  1593         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1594             20  FILLER                     PIC XX.
  1595             20  CF-HI-TYPE-IN-REC          PIC 99.
  1596         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1597             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1598                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1599             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1600             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1601         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1602             20  FILLER                     PIC X.
  1603             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1604         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1605             20  FILLER                     PIC XX.
  1606             20  CF-MORTGAGE-PLAN           PIC XX.
  1607         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1608
  1609     12  CF-LAST-MAINT-DT                   PIC XX.
  1610     12  CF-LAST-MAINT-BY                   PIC X(4).
  1611     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1612
  1613     12  CF-RECORD-BODY                     PIC X(728).
  1614
  1615
  1616****************************************************************
  1617*             COMPANY MASTER RECORD                            *
  1618****************************************************************
  1619
  1620     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1621         16  CF-COMPANY-ADDRESS.
  1622             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1623             20  CF-CL-IN-CARE-OF           PIC X(30).
  1624             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1625             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1626             20  CF-CL-CITY-STATE           PIC X(30).
  1627             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1628             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1629         16  CF-COMPANY-CD                  PIC X.
  1630         16  CF-COMPANY-PASSWORD            PIC X(8).
  1631         16  CF-SECURITY-OPTION             PIC X.
  1632             88  ALL-SECURITY                   VALUE '1'.
  1633             88  COMPANY-VERIFY                 VALUE '2'.
  1634             88  PROCESSOR-VERIFY               VALUE '3'.
  1635             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  37
* EL687.cbl
  1636             88  ALL-BUT-TERM                   VALUE '5'.
  1637         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1638             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1639         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1640             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1641         16  CF-INFORCE-LOCATION            PIC X.
  1642             88  CERTS-ARE-ONLINE               VALUE '1'.
  1643             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1644             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1645         16  CF-LOWER-CASE-LETTERS          PIC X.
  1646         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1647             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1648             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1649             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1650             88  CF-ACCNT-CNTL                  VALUE '3'.
  1651             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1652
  1653         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1654         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1655
  1656         16  CF-LGX-CREDIT-USER             PIC X.
  1657             88  CO-IS-NOT-USER                 VALUE 'N'.
  1658             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1659
  1660         16 CF-CREDIT-CALC-CODES.
  1661             20  CF-CR-REM-TERM-CALC PIC X.
  1662               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1663               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1664               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1665               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1666               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1667               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1668               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1669             20  CF-CR-R78-METHOD           PIC X.
  1670               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1671               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1672
  1673         16  CF-CLAIM-CONTROL-COUNTS.
  1674             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1675                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1676
  1677             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1678                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1679
  1680             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1681                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1682
  1683             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1684                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1685
  1686         16  CF-CURRENT-MONTH-END           PIC XX.
  1687
  1688         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1689             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1690             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1691             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1692             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1693                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  38
* EL687.cbl
  1694                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1695             20  CF-CO-PREM-REJECT-SW       PIC X.
  1696                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1697                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1698             20  CF-CO-REF-REJECT-SW        PIC X.
  1699                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1700                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1701
  1702         16  CF-CO-REPORTING-DT             PIC XX.
  1703         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1704         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1705           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1706           88  CF-CO-MONTH-END                  VALUE '1'.
  1707
  1708         16  CF-LGX-CLAIM-USER              PIC X.
  1709             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1710             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1711
  1712         16  CF-CREDIT-EDIT-CONTROLS.
  1713             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1714             20  CF-MIN-AGE                 PIC 99.
  1715             20  CF-DEFAULT-AGE             PIC 99.
  1716             20  CF-MIN-TERM                PIC S999      COMP-3.
  1717             20  CF-MAX-TERM                PIC S999      COMP-3.
  1718             20  CF-DEFAULT-SEX             PIC X.
  1719             20  CF-JOINT-AGE-INPUT         PIC X.
  1720                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1721             20  CF-BIRTH-DATE-INPUT        PIC X.
  1722                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1723             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1724                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1725                 88  CF-ZERO-CARRIER            VALUE '1'.
  1726                 88  CF-ZERO-GROUPING           VALUE '2'.
  1727                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1728             20  CF-EDIT-SW                 PIC X.
  1729                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1730             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1731             20  CF-CR-PR-METHOD            PIC X.
  1732               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1733               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1734             20  FILLER                     PIC X.
  1735
  1736         16  CF-CREDIT-MISC-CONTROLS.
  1737             20  CF-REIN-TABLE-SW           PIC X.
  1738                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1739             20  CF-COMP-TABLE-SW           PIC X.
  1740                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1741             20  CF-EXPERIENCE-RETENTION-AGE
  1742                                            PIC S9        COMP-3.
  1743             20  CF-CONVERSION-DT           PIC XX.
  1744             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1745             20  CF-RUN-FREQUENCY-SW        PIC X.
  1746                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1747                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1748
  1749             20  CF-CR-CHECK-NO-CONTROL.
  1750                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1751                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  39
* EL687.cbl
  1752                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1753                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1754                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1755                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1756
  1757                 24  CF-CR-CHECK-COUNT       REDEFINES
  1758                     CF-CR-CHECK-COUNTER      PIC X(4).
  1759
  1760                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1761                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1762
  1763                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1764                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1765                 24  CF-MAIL-PROCESSING       PIC X.
  1766                     88  MAIL-PROCESSING          VALUE 'Y'.
  1767
  1768         16  CF-MISC-SYSTEM-CONTROL.
  1769             20  CF-SYSTEM-C                 PIC X.
  1770                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1771             20  CF-SYSTEM-D                 PIC X.
  1772                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1773             20  CF-SOC-SEC-NO-SW            PIC X.
  1774                 88  SOC-SEC-NO-USED             VALUE '1'.
  1775             20  CF-MEMBER-NO-SW             PIC X.
  1776                 88  MEMBER-NO-USED              VALUE '1'.
  1777             20  CF-TAX-ID-NUMBER            PIC X(11).
  1778             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1779             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1780                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1781                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1782                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1783                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1784             20  CF-SYSTEM-E                 PIC X.
  1785                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1786
  1787         16  CF-LGX-LIFE-USER               PIC X.
  1788             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1789             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1790
  1791         16  CF-CR-MONTH-END-DT             PIC XX.
  1792
  1793         16  CF-FILE-MAINT-DATES.
  1794             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1795                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1796             20  CF-LAST-BATCH       REDEFINES
  1797                 CF-LAST-BATCH-NO               PIC X(4).
  1798             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1799             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1800             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1801             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1802             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1803             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1804             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1805             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1806             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1807             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1808
  1809         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  40
* EL687.cbl
  1810         16  FILLER                         PIC X.
  1811
  1812         16  CF-ALT-MORT-CODE               PIC X(4).
  1813         16  CF-MEMBER-CAPTION              PIC X(10).
  1814
  1815         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1816             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1817             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1818             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1819             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1820             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1821
  1822         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1823
  1824         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1825         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1826         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1827         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1828
  1829         16  CF-AH-OVERRIDE-L1              PIC X.
  1830         16  CF-AH-OVERRIDE-L2              PIC XX.
  1831         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1832         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1833
  1834         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1835         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1836
  1837         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1838         16  CF-AR-LAST-EL860-DT            PIC XX.
  1839         16  CF-MP-MONTH-END-DT             PIC XX.
  1840
  1841         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1842         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1843             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1844
  1845         16  CF-AR-MONTH-END-DT             PIC XX.
  1846
  1847         16  CF-CRDTCRD-USER                PIC X.
  1848             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1849             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1850
  1851         16  CF-CC-MONTH-END-DT             PIC XX.
  1852
  1853         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1854
  1855         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1856             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1857             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1858             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1859         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1860         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1861         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1862         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1863             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1864             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1865         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1866         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1867         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  41
* EL687.cbl
  1868             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1869         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1870
  1871         16  CF-CL-ZIP-CODE.
  1872             20  CF-CL-ZIP-PRIME.
  1873                 24  CF-CL-ZIP-1ST          PIC X.
  1874                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1875                 24  FILLER                 PIC X(4).
  1876             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1877         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1878             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1879             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1880             20  FILLER                     PIC XXX.
  1881
  1882         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1883         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1884         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1885         16  CF-CO-OPTION-START-DATE        PIC XX.
  1886         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1887           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1888                                                      '3' '4'.
  1889           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1890           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1891           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1892           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1893           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1894           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1895
  1896         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1897
  1898         16  CF-PAYMENT-APPROVAL-LEVELS.
  1899             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1900             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1901             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1902             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1903             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1904             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1905
  1906         16  CF-END-USER-REPORTING-USER     PIC X.
  1907             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1908             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1909
  1910         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1911             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1912             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1913
  1914         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1915
  1916         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1917         16  FILLER                         PIC X.
  1918
  1919         16  CF-CREDIT-ARCHIVE-CNTL.
  1920             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1921             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1922             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1923
  1924         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1925
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  42
* EL687.cbl
  1926         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1927             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1928             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1929
  1930         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1931             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1932             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1933
  1934         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1935
  1936         16  CF-CO-ACH-ID-CODE              PIC  X.
  1937             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1938             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1939             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1940         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1941         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1942         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1943         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1944         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1945         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1946         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1947         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1948         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1949                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1950         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1951                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1952
  1953         16  CF-CO-OVER-SHORT.
  1954             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1955             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1956
  1957*         16  FILLER                         PIC X(102).
  1958         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1959             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1960             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1961
  1962         16  CF-AH-APPROVAL-DAYS.
  1963             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1964             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1965             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1966             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1967
  1968         16  FILLER                         PIC X(82).
  1969****************************************************************
  1970*             PROCESSOR/USER RECORD                            *
  1971****************************************************************
  1972
  1973     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1974         16  CF-PROCESSOR-NAME              PIC X(30).
  1975         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1976         16  CF-PROCESSOR-TITLE             PIC X(26).
  1977         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1978                 88  MESSAGE-YES                VALUE 'Y'.
  1979                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1980
  1981*****************************************************
  1982****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1983****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  43
* EL687.cbl
  1984****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1985****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1986*****************************************************
  1987
  1988         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1989             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1990             20  CF-APPLICATION-FORCE       PIC X.
  1991             20  CF-INDIVIDUAL-APP.
  1992                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1993                     28  CF-BROWSE-APP      PIC X.
  1994                     28  CF-UPDATE-APP      PIC X.
  1995
  1996         16  CF-CURRENT-TERM-ON             PIC X(4).
  1997         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1998             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1999             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2000             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2001             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2002             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2003             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2004             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2005         16  CF-PROCESSOR-CARRIER           PIC X.
  2006             88  NO-CARRIER-SECURITY            VALUE ' '.
  2007         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2008             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2009         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2010             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2011         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2012             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2013
  2014         16  CF-PROC-SYS-ACCESS-SW.
  2015             20  CF-PROC-CREDIT-CLAIMS-SW.
  2016                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2017                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2018                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2019                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2020             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2021                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2022                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2023             20  CF-PROC-LIFE-GNRLDGR-SW.
  2024                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2025                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2026                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2027                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2028             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2029                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2030                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2031         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2032             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2033             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2034         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2035
  2036         16  CF-APPROVAL-LEVEL                  PIC X.
  2037             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2038             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2039             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2040             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2041
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  44
* EL687.cbl
  2042         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2043
  2044         16  CF-LANGUAGE-TYPE                   PIC X.
  2045             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2046             88  CF-LANG-IS-FR                      VALUE 'F'.
  2047         16  FILLER                             PIC  X(240).
  2048
  2049****************************************************************
  2050*             PROCESSOR/REMINDERS RECORD                       *
  2051****************************************************************
  2052
  2053     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2054         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2055             20  CF-START-REMIND-DT         PIC XX.
  2056             20  CF-END-REMIND-DT           PIC XX.
  2057             20  CF-REMINDER-TEXT           PIC X(50).
  2058         16  FILLER                         PIC X(296).
  2059
  2060
  2061****************************************************************
  2062*             STATE MASTER RECORD                              *
  2063****************************************************************
  2064
  2065     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2066         16  CF-STATE-ABBREVIATION          PIC XX.
  2067         16  CF-STATE-NAME                  PIC X(25).
  2068         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2069         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2070             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2071             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2072             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2073             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2074                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2075                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2076             20  CF-ST-PREM-REJECT-SW       PIC X.
  2077                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2078                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2079             20  CF-ST-REF-REJECT-SW        PIC X.
  2080                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2081                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2082         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2083         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2084         16  CF-ST-REFUND-RULES.
  2085             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2086             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2087             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2088         16  CF-ST-FST-PMT-EXTENSION.
  2089             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2090             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2091                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2092                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2093                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2094                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2095         16  CF-ST-STATE-CALL.
  2096             20  CF-ST-CALL-UNEARNED        PIC X.
  2097             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2098             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2099         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  45
* EL687.cbl
  2100             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2101             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2102         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2103         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2104         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2105         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2106         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2107         16  FILLER                         PIC X.
  2108         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2109             20  CF-ST-BENEFIT-CD           PIC XX.
  2110             20  CF-ST-BENEFIT-KIND         PIC X.
  2111                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2112                 88  CF-ST-AH-KIND              VALUE 'A'.
  2113             20  CF-ST-REM-TERM-CALC        PIC X.
  2114                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2115                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2116                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2117                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2118                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2119                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2120                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2121                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2122
  2123             20  CF-ST-REFUND-CALC          PIC X.
  2124                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2125                 88  ST-REFD-BY-R78             VALUE '1'.
  2126                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2127                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2128                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2129                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2130                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2131                 88  ST-REFD-UTAH               VALUE '7'.
  2132                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2133                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2134                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2135
  2136             20  CF-ST-EARNING-CALC         PIC X.
  2137                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2138                 88  ST-EARN-BY-R78             VALUE '1'.
  2139                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2140                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2141                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2142                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2143                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2144                 88  ST-EARN-MEAN               VALUE '8'.
  2145                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2146
  2147             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2148                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2149                 88  ST-OVRD-BY-R78             VALUE '1'.
  2150                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2151                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2152                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2153                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2154                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2155                 88  ST-OVRD-MEAN               VALUE '8'.
  2156                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2157             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  46
* EL687.cbl
  2158
  2159         16  CF-ST-COMMISSION-CAPS.
  2160             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2161             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2162             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2163             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2164         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2165                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2166
  2167         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2168
  2169         16  CF-ST-STATUTORY-INTEREST.
  2170             20  CF-ST-STAT-DATE-FROM       PIC X.
  2171                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2172                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2173             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2174             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2175             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2176             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2177             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2178
  2179         16  CF-ST-OVER-SHORT.
  2180             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2181             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2182
  2183         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2184
  2185         16  CF-ST-RT-CALC                  PIC X.
  2186
  2187         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2188         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2189         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2190         16  CF-ST-RF-LR-CALC               PIC X.
  2191         16  CF-ST-RF-LL-CALC               PIC X.
  2192         16  CF-ST-RF-LN-CALC               PIC X.
  2193         16  CF-ST-RF-AH-CALC               PIC X.
  2194         16  CF-ST-RF-CP-CALC               PIC X.
  2195*        16  FILLER                         PIC X(206).
  2196*CIDMOD         16  FILLER                         PIC X(192).
  2197         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2198             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2199         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2200         16  FILLER                         PIC X(187).
  2201
  2202****************************************************************
  2203*             BENEFIT MASTER RECORD                            *
  2204****************************************************************
  2205
  2206     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2207         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2208             20  CF-BENEFIT-CODE            PIC XX.
  2209             20  CF-BENEFIT-NUMERIC  REDEFINES
  2210                 CF-BENEFIT-CODE            PIC XX.
  2211             20  CF-BENEFIT-ALPHA           PIC XXX.
  2212             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2213             20  CF-BENEFIT-COMMENT         PIC X(10).
  2214
  2215             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  47
* EL687.cbl
  2216                 88  CF-REDUCING                VALUE 'R'.
  2217                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2218
  2219             20  CF-SPECIAL-CALC-CD         PIC X.
  2220                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2221                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2222                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2223                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2224                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2225                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2226                 88  CF-FARM-PLAN               VALUE 'F'.
  2227                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2228                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2229                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2230                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2231                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2232                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2233                 88  CF-PRUDENTIAL              VALUE 'P'.
  2234                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2235                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2236                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2237                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2238                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2239                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2240
  2241             20  CF-JOINT-INDICATOR         PIC X.
  2242                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2243
  2244*            20  FILLER                     PIC X(12).
  2245             20  FILLER                     PIC X(11).
  2246             20  CF-BENEFIT-CATEGORY        PIC X.
  2247             20  CF-LOAN-TYPE               PIC X(8).
  2248
  2249             20  CF-CO-REM-TERM-CALC        PIC X.
  2250                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2251                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2252                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2253                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2254                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2255
  2256             20  CF-CO-EARNINGS-CALC        PIC X.
  2257                 88  CO-EARN-BY-R78             VALUE '1'.
  2258                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2259                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2260                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2261                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2262                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2263                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2264                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2265
  2266             20  CF-CO-REFUND-CALC          PIC X.
  2267                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2268                 88  CO-REFD-BY-R78             VALUE '1'.
  2269                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2270                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2271                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2272                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2273                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  48
* EL687.cbl
  2274                 88  CO-REFD-MEAN               VALUE '8'.
  2275                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2276                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2277                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2278
  2279             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2280                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2281                 88  CO-OVRD-BY-R78             VALUE '1'.
  2282                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2283                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2284                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2285                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2286                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2287                 88  CO-OVRD-MEAN               VALUE '8'.
  2288                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2289
  2290             20  CF-CO-BEN-I-G-CD           PIC X.
  2291                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2292                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2293                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2294
  2295         16  FILLER                         PIC X(304).
  2296
  2297
  2298****************************************************************
  2299*             CARRIER MASTER RECORD                            *
  2300****************************************************************
  2301
  2302     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2303         16  CF-ADDRESS-DATA.
  2304             20  CF-MAIL-TO-NAME            PIC X(30).
  2305             20  CF-IN-CARE-OF              PIC X(30).
  2306             20  CF-ADDRESS-LINE-1          PIC X(30).
  2307             20  CF-ADDRESS-LINE-2          PIC X(30).
  2308             20  CF-CITY-STATE              PIC X(30).
  2309             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2310             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2311
  2312         16  CF-CLAIM-NO-CONTROL.
  2313             20  CF-CLAIM-NO-METHOD         PIC X.
  2314                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2315                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2316                 88  CLAIM-NO-SEQ               VALUE '3'.
  2317                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2318             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2319                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2320                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2321                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2322
  2323         16  CF-CHECK-NO-CONTROL.
  2324             20  CF-CHECK-NO-METHOD         PIC X.
  2325                 88  CHECK-NO-MANUAL            VALUE '1'.
  2326                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2327                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2328                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2329             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2330                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2331
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  49
* EL687.cbl
  2332         16  CF-DOMICILE-STATE              PIC XX.
  2333
  2334         16  CF-EXPENSE-CONTROLS.
  2335             20  CF-EXPENSE-METHOD          PIC X.
  2336                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2337                 88  DOLLARS-PER-PMT            VALUE '2'.
  2338                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2339                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2340             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2341             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2342
  2343         16  CF-CORRESPONDENCE-CONTROL.
  2344             20  CF-LETTER-RESEND-OPT       PIC X.
  2345                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2346                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2347             20  FILLER                     PIC X(4).
  2348
  2349         16  CF-RESERVE-CONTROLS.
  2350             20  CF-MANUAL-SW               PIC X.
  2351                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2352             20  CF-FUTURE-SW               PIC X.
  2353                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2354             20  CF-PTC-SW                  PIC X.
  2355                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2356             20  CF-IBNR-SW                 PIC X.
  2357                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2358             20  CF-PTC-LF-SW               PIC X.
  2359                 88  CF-LF-PTC-USED             VALUE '1'.
  2360             20  CF-CDT-ACCESS-METHOD       PIC X.
  2361                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2362                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2363                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2364             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2365
  2366         16  CF-CLAIM-CALC-METHOD           PIC X.
  2367             88  360-PLUS-MONTHS                VALUE '1'.
  2368             88  365-PLUS-MONTHS                VALUE '2'.
  2369             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2370             88  360-DAILY                      VALUE '4'.
  2371             88  365-DAILY                      VALUE '5'.
  2372
  2373         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2374         16  FILLER                         PIC X(11).
  2375
  2376         16  CF-LIMIT-AMOUNTS.
  2377             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2378             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2379             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2380             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2381             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2382             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2383             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2384             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2385             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2386             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2387
  2388         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2389         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  50
* EL687.cbl
  2390         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2391
  2392         16  CF-ZIP-CODE.
  2393             20  CF-ZIP-PRIME.
  2394                 24  CF-ZIP-1ST             PIC X.
  2395                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2396                 24  FILLER                 PIC X(4).
  2397             20  CF-ZIP-PLUS4               PIC X(4).
  2398         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2399             20  CF-CAN-POSTAL-1            PIC XXX.
  2400             20  CF-CAN-POSTAL-2            PIC XXX.
  2401             20  FILLER                     PIC XXX.
  2402
  2403         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2404         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2405         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2406
  2407         16  CF-RATING-SWITCH               PIC X.
  2408             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2409             88  CF-NO-RATING                   VALUE 'N'.
  2410
  2411         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2412
  2413         16  CF-CARRIER-OVER-SHORT.
  2414             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2415             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2416
  2417         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2418         16  CF-SECPAY-SWITCH               PIC X.
  2419             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2420             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2421         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2422         16  FILLER                         PIC X(448).
  2423*        16  FILLER                         PIC X(452).
  2424
  2425
  2426****************************************************************
  2427*             MORTALITY MASTER RECORD                          *
  2428****************************************************************
  2429
  2430     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2431         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2432                                INDEXED BY CF-MORT-NDX.
  2433             20  CF-MORT-TABLE              PIC X(5).
  2434             20  CF-MORT-TABLE-TYPE         PIC X.
  2435                 88  CF-MORT-JOINT              VALUE 'J'.
  2436                 88  CF-MORT-SINGLE             VALUE 'S'.
  2437                 88  CF-MORT-COMBINED           VALUE 'C'.
  2438                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2439                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2440             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2441             20  CF-MORT-AGE-METHOD         PIC XX.
  2442                 88  CF-AGE-LAST                VALUE 'AL'.
  2443                 88  CF-AGE-NEAR                VALUE 'AN'.
  2444             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2445             20  CF-MORT-ADJUSTMENT-DIRECTION
  2446                                            PIC X.
  2447                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  51
* EL687.cbl
  2448                 88  CF-PLUS                    VALUE '+'.
  2449             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2450             20  CF-MORT-JOINT-CODE         PIC X.
  2451                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2452             20  CF-MORT-PC-Q               PIC X.
  2453                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2454             20  CF-MORT-TABLE-CODE         PIC X(4).
  2455             20  CF-MORT-COMMENTS           PIC X(15).
  2456             20  FILLER                     PIC X(14).
  2457
  2458         16  FILLER                         PIC X(251).
  2459
  2460
  2461****************************************************************
  2462*             BUSSINESS TYPE MASTER RECORD                     *
  2463****************************************************************
  2464
  2465     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2466* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2467* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2468* AND RECORD 05 IS TYPES 81-99
  2469         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2470             20  CF-BUSINESS-TITLE          PIC  X(19).
  2471             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2472                                            PIC S9V9(4) COMP-3.
  2473             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2474             20  FILLER                     PIC  X.
  2475         16  FILLER                         PIC  X(248).
  2476
  2477
  2478****************************************************************
  2479*             TERMINAL MASTER RECORD                           *
  2480****************************************************************
  2481
  2482     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2483
  2484         16  CF-COMPANY-TERMINALS.
  2485             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2486                                  PIC X(4).
  2487         16  FILLER               PIC X(248).
  2488
  2489
  2490****************************************************************
  2491*             LIFE EDIT MASTER RECORD                          *
  2492****************************************************************
  2493
  2494     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2495         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2496             20  CF-LIFE-CODE-IN            PIC XX.
  2497             20  CF-LIFE-CODE-OUT           PIC XX.
  2498         16  FILLER                         PIC X(248).
  2499
  2500
  2501****************************************************************
  2502*             AH EDIT MASTER RECORD                            *
  2503****************************************************************
  2504
  2505     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  52
* EL687.cbl
  2506         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2507             20  CF-AH-CODE-IN              PIC XXX.
  2508             20  CF-AH-CODE-OUT             PIC XX.
  2509         16  FILLER                         PIC X(248).
  2510
  2511
  2512****************************************************************
  2513*             CREDIBILITY TABLES                               *
  2514****************************************************************
  2515
  2516     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2517         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2518                             INDEXED BY CF-CRDB-NDX.
  2519             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2520             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2521             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2522         16  FILLER                         PIC  X(332).
  2523
  2524
  2525****************************************************************
  2526*             REPORT CUSTOMIZATION RECORD                      *
  2527****************************************************************
  2528
  2529     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2530         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2531             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2532             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2533             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2534**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2535****       A T-TRANSFER.                                   ****
  2536             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2537
  2538         16  FILLER                         PIC XX.
  2539
  2540         16  CF-CARRIER-CNTL-OPT.
  2541             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2542                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2543                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2544             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2545                                            PIC X.
  2546         16  CF-GROUP-CNTL-OPT.
  2547             20  CF-GROUP-OPT-SEQ           PIC 9.
  2548                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2549                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2550             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2551                                            PIC X(6).
  2552         16  CF-STATE-CNTL-OPT.
  2553             20  CF-STATE-OPT-SEQ           PIC 9.
  2554                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2555                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2556             20  CF-STATE-SELECT OCCURS 3 TIMES
  2557                                            PIC XX.
  2558         16  CF-ACCOUNT-CNTL-OPT.
  2559             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2560                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2561                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2562             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2563                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  53
* EL687.cbl
  2564         16  CF-BUS-TYP-CNTL-OPT.
  2565             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2566                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2567                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2568             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2569                                            PIC XX.
  2570         16  CF-LF-TYP-CNTL-OPT.
  2571             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2572                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2573                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2574             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2575                                            PIC XX.
  2576         16  CF-AH-TYP-CNTL-OPT.
  2577             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2578                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2579                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2580             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2581                                            PIC XX.
  2582         16  CF-REPTCD1-CNTL-OPT.
  2583             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2584                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2585                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2586             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2587                                            PIC X(10).
  2588         16  CF-REPTCD2-CNTL-OPT.
  2589             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2590                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2591                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2592             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2593                                            PIC X(10).
  2594         16  CF-USER1-CNTL-OPT.
  2595             20  CF-USER1-OPT-SEQ           PIC 9.
  2596                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2597                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2598             20  CF-USER1-SELECT OCCURS 3 TIMES
  2599                                            PIC X(10).
  2600         16  CF-USER2-CNTL-OPT.
  2601             20  CF-USER2-OPT-SEQ           PIC 9.
  2602                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2603                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2604             20  CF-USER2-SELECT OCCURS 3 TIMES
  2605                                            PIC X(10).
  2606         16  CF-USER3-CNTL-OPT.
  2607             20  CF-USER3-OPT-SEQ           PIC 9.
  2608                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2609                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2610             20  CF-USER3-SELECT OCCURS 3 TIMES
  2611                                            PIC X(10).
  2612         16  CF-USER4-CNTL-OPT.
  2613             20  CF-USER4-OPT-SEQ           PIC 9.
  2614                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2615                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2616             20  CF-USER4-SELECT OCCURS 3 TIMES
  2617                                            PIC X(10).
  2618         16  CF-USER5-CNTL-OPT.
  2619             20  CF-USER5-OPT-SEQ           PIC 9.
  2620                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2621                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  54
* EL687.cbl
  2622             20  CF-USER5-SELECT OCCURS 3 TIMES
  2623                                            PIC X(10).
  2624         16  CF-REINS-CNTL-OPT.
  2625             20  CF-REINS-OPT-SEQ           PIC 9.
  2626                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2627                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2628             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2629                 24  CF-REINS-PRIME         PIC XXX.
  2630                 24  CF-REINS-SUB           PIC XXX.
  2631
  2632         16  CF-AGENT-CNTL-OPT.
  2633             20  CF-AGENT-OPT-SEQ           PIC 9.
  2634                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2635                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2636             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2637                                            PIC X(10).
  2638
  2639         16  FILLER                         PIC X(43).
  2640
  2641         16  CF-LOSS-RATIO-SELECT.
  2642             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2643             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2644         16  CF-ENTRY-DATE-SELECT.
  2645             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2646             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2647         16  CF-EFFECTIVE-DATE-SELECT.
  2648             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2649             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2650
  2651         16  CF-EXCEPTION-LIST-IND          PIC X.
  2652             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2653
  2654         16  FILLER                         PIC X(318).
  2655
  2656****************************************************************
  2657*                  EXCEPTION REPORTING RECORD                  *
  2658****************************************************************
  2659
  2660     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2661         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2662             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2663
  2664         16  CF-COMBINED-LIFE-AH-OPT.
  2665             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2666             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2667             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2668             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2669
  2670         16  CF-LIFE-OPT.
  2671             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2672             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2673             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2674             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2675             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2676             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2677             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2678             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2679             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  55
* EL687.cbl
  2680             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2681
  2682         16  CF-AH-OPT.
  2683             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2684             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2685             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2686             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2687             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2688             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2689             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2690             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2691             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2692             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2693
  2694         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2695             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2696             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2697             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2698
  2699         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2700
  2701         16  FILLER                         PIC X(673).
  2702
  2703
  2704****************************************************************
  2705*             MORTGAGE SYSTEM PLAN RECORD                      *
  2706****************************************************************
  2707
  2708     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2709         16  CF-PLAN-TYPE                   PIC X.
  2710             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2711             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2712             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2713         16  CF-PLAN-ABBREV                 PIC XXX.
  2714         16  CF-PLAN-DESCRIPT               PIC X(10).
  2715         16  CF-PLAN-NOTES                  PIC X(20).
  2716         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2717         16  CF-PLAN-UNDERWRITING.
  2718             20  CF-PLAN-TERM-DATA.
  2719                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2720                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2721             20  CF-PLAN-AGE-DATA.
  2722                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2723                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2724                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2725             20  CF-PLAN-BENEFIT-DATA.
  2726                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2727                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2728                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2729                                            PIC S9(7)V99  COMP-3.
  2730         16  CF-PLAN-POLICY-FORMS.
  2731             20  CF-POLICY-FORM             PIC X(12).
  2732             20  CF-MASTER-APPLICATION      PIC X(12).
  2733             20  CF-MASTER-POLICY           PIC X(12).
  2734         16  CF-PLAN-RATING.
  2735             20  CF-RATE-CODE               PIC X(5).
  2736             20  CF-SEX-RATING              PIC X.
  2737                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  56
* EL687.cbl
  2738                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2739             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2740             20  CF-SUB-STD-TYPE            PIC X.
  2741                 88  CF-PCT-OF-PREM            VALUE '1'.
  2742                 88  CF-PCT-OF-BENE            VALUE '2'.
  2743         16  CF-PLAN-PREM-TOLERANCES.
  2744             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2745             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2746         16  CF-PLAN-PYMT-TOLERANCES.
  2747             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2748             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2749         16  CF-PLAN-MISC-DATA.
  2750             20  FILLER                     PIC X.
  2751             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2752             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2753         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2754         16  CF-PLAN-IND-GRP                PIC X.
  2755             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2756                                                     '1'.
  2757             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2758                                                     '2'.
  2759         16  CF-MIB-SEARCH-SW               PIC X.
  2760             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2761             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2762             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2763             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2764         16  CF-ALPHA-SEARCH-SW             PIC X.
  2765             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2766             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2767             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2768             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2769             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2770             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2771             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2772             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2773             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2774             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2775                                                     'A' 'B' 'C'
  2776                                                     'X' 'Y' 'Z'.
  2777         16  CF-EFF-DT-RULE-SW              PIC X.
  2778             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2779             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2780             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2781             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2782             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2783         16  FILLER                         PIC X(4).
  2784         16  CF-HEALTH-QUESTIONS            PIC X.
  2785             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2786         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2787         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2788         16  CF-PLAN-SNGL-JNT               PIC X.
  2789             88  CF-COMBINED-PLAN              VALUE 'C'.
  2790             88  CF-JNT-PLAN                   VALUE 'J'.
  2791             88  CF-SNGL-PLAN                  VALUE 'S'.
  2792         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2793         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2794         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2795         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  57
* EL687.cbl
  2796         16  CF-RERATE-CNTL                 PIC  X.
  2797             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2798             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2799             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2800             88  CF-AUTO-RECALC                 VALUE '4'.
  2801         16  CF-BENEFIT-TYPE                PIC  X.
  2802             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2803             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2804         16  CF-POLICY-FEE                  PIC S999V99
  2805                                                    COMP-3.
  2806         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2807         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2808         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2809         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2810         16  FILLER                         PIC  X(32).
  2811         16  CF-TERMINATION-FORM            PIC  X(04).
  2812         16  FILLER                         PIC  X(08).
  2813         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2814                                                       COMP-3.
  2815         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2816         16  CF-ISSUE-LETTER                PIC  X(4).
  2817         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2818         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2819             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2820             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2821         16  CF-MP-REFUND-CALC              PIC X.
  2822             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2823             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2824             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2825             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2826             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2827             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2828             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2829             88  CF-MP-REFD-MEAN                VALUE '8'.
  2830         16  CF-ALT-RATE-CODE               PIC  X(5).
  2831
  2832
  2833         16  FILLER                         PIC X(498).
  2834****************************************************************
  2835*             MORTGAGE COMPANY MASTER RECORD                   *
  2836****************************************************************
  2837
  2838     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2839         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2840         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2841             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2842             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2843             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2844             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2845             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2846
  2847         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2848         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2849         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2850         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2851         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2852
  2853         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  58
* EL687.cbl
  2854             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2855         16  CF-MP-RECON-USE-IND            PIC X(1).
  2856             88  CF-MP-USE-RECON             VALUE 'Y'.
  2857         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2858             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2859         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2860             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2861             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2862         16  FILLER                         PIC X(1).
  2863         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2864             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2865         16  CF-MORTG-MIB-VERSION           PIC X.
  2866             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2867             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2868             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2869         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2870             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2871                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2872             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2873                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2874             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2875                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2876             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2877                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2878             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2879                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2880             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2881                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2882         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2883         16  FILLER                         PIC X(7).
  2884         16  CF-MORTG-DESTINATION-SYMBOL.
  2885             20  CF-MORTG-MIB-COMM          PIC X(5).
  2886             20  CF-MORTG-MIB-TERM          PIC X(5).
  2887         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2888             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2889         16  FILLER                         PIC X(03).
  2890         16  CF-MP-CHECK-NO-CONTROL.
  2891             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2892                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2893                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2894                                                ' ' LOW-VALUES.
  2895                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2896                                               VALUE '3'.
  2897         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2898         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2899         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2900             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2901                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2902             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2903                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2904             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2905                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2906             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2907                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2908             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2909                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2910             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2911                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  59
* EL687.cbl
  2912         16  CF-MORTG-BILLING-AREA.
  2913             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2914                                            PIC X.
  2915         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2916         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2917         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2918         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2919             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2920             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2921         16  FILLER                         PIC X.
  2922         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2923             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2924             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2925         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2926         16  FILLER                         PIC X(8).
  2927         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2928         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2929         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2930         16  CF-ACH-COMPANY-ID.
  2931             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2932                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2933                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2934                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2935             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2936         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2937             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2938         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2939             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2940             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2941         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2942         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2943         16  FILLER                         PIC X(536).
  2944
  2945****************************************************************
  2946*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2947****************************************************************
  2948
  2949     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2950         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2951             20  CF-FEMALE-HEIGHT.
  2952                 24  CF-FEMALE-FT           PIC 99.
  2953                 24  CF-FEMALE-IN           PIC 99.
  2954             20  CF-FEMALE-MIN-WT           PIC 999.
  2955             20  CF-FEMALE-MAX-WT           PIC 999.
  2956         16  FILLER                         PIC X(428).
  2957
  2958     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2959         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2960             20  CF-MALE-HEIGHT.
  2961                 24  CF-MALE-FT             PIC 99.
  2962                 24  CF-MALE-IN             PIC 99.
  2963             20  CF-MALE-MIN-WT             PIC 999.
  2964             20  CF-MALE-MAX-WT             PIC 999.
  2965         16  FILLER                         PIC X(428).
  2966******************************************************************
  2967*             AUTOMATIC ACTIVITY RECORD                          *
  2968******************************************************************
  2969     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  60
* EL687.cbl
  2970         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2971             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2972             20  CF-SYS-LETTER-ID           PIC X(04).
  2973             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2974             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2975             20  CF-SYS-RESET-SW            PIC X(01).
  2976             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2977             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2978
  2979         16  FILLER                         PIC X(50).
  2980
  2981         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2982             20  CF-USER-ACTIVE-SW          PIC X(01).
  2983             20  CF-USER-LETTER-ID          PIC X(04).
  2984             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2985             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2986             20  CF-USER-RESET-SW           PIC X(01).
  2987             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2988             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2989             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2990
  2991         16  FILLER                         PIC X(246).
  2992
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  61
* EL687.cbl
  2994*                            COPY ERCPYAJ.
  2995******************************************************************
  2996*                                                                *
  2997*                            ERCPYAJ                             *
  2998*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2999*                            VMOD=2.015                          *
  3000*                                                                *
  3001*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  3002*                                                                *
  3003*                                                                *
  3004*   FILE TYPE = VSAM,KSDS                                        *
  3005*   RECORD SIZE = 200  RECFORM = FIXED                           *
  3006*                                                                *
  3007*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  3008*       ALTERNATE PATHS = NONE                                   *
  3009*                                                                *
  3010*   LOG = YES                                                    *
  3011*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3012******************************************************************
  3013******************************************************************
  3014*                   C H A N G E   L O G
  3015*
  3016* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3017*-----------------------------------------------------------------
  3018*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3019* EFFECTIVE    NUMBER
  3020*-----------------------------------------------------------------
  3021* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  3022* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  3023******************************************************************
  3024
  3025 01  PENDING-PAY-ADJ.
  3026     12  PY-RECORD-ID                     PIC XX.
  3027         88  VALID-PY-ID                        VALUE 'PY'.
  3028
  3029     12  PY-CONTROL-PRIMARY.
  3030         16  PY-COMPANY-CD                PIC X.
  3031         16  PY-CARRIER                   PIC X.
  3032         16  PY-GROUPING                  PIC X(6).
  3033         16  PY-FIN-RESP                  PIC X(10).
  3034         16  PY-ACCOUNT                   PIC X(10).
  3035         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  3036                                          PIC X(10).
  3037         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  3038         16  PY-RECORD-TYPE               PIC X.
  3039             88  PY-REMIT-RECEIVED            VALUE 'R'.
  3040             88  PY-DEPOSIT                   VALUE 'D'.
  3041             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  3042             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  3043             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  3044             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  3045             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  3046             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  3047             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  3048             88  PY-FICA-ENTRY                VALUE 'F'.
  3049             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  3050             88  PY-POLICY-FEE                VALUE 'W'.
  3051             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  62
* EL687.cbl
  3052
  3053     12  PY-PYMT-TYPE                     PIC X.
  3054             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  3055             88  PY-REINS-PYMT                VALUE 'R'.
  3056             88  PY-EXP-PYMT                  VALUE 'E'.
  3057
  3058     12  PY-BIL-INV                       PIC X(6).
  3059     12  PY-REF-NO                        PIC X(12).
  3060
  3061     12  PY-LAST-MAINT-DT                 PIC XX.
  3062     12  PY-LAST-MAINT-BY                 PIC X(4).
  3063     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3064
  3065     12  PY-PYADJ-RECORD.
  3066         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  3067         16  PY-ENTRY-COMMENT             PIC X(30).
  3068         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  3069             20  PY-GL-ACCOUNT            PIC X(10).
  3070             20  PY-GL-STATE              PIC X(02).
  3071             20  PY-GL-CANC-SW            PIC X(01).
  3072                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  3073                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  3074             20  PY-GL-COMMENT            PIC X(10).
  3075             20  FILLER      REDEFINES PY-GL-COMMENT.
  3076                 24  PY-GL-CHECK-NO       PIC 9(06).
  3077                 24  FILLER               PIC X(04).
  3078             20  FILLER                   PIC X(07).
  3079         16  PY-SAVE-ACCOUNT              PIC X(10).
  3080         16  PY-SAVE-TYPE                 PIC X(01).
  3081
  3082         16  PY-LETTERS.
  3083             20  PY-LETTER OCCURS 3 TIMES
  3084                           INDEXED BY PY-LET-NDX
  3085                                          PIC X(04).
  3086
  3087         16  PY-ERCOMP-TYPE               PIC X.
  3088             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  3089             88  PY-GA-TYPE                   VALUE 'G'.
  3090             88  PY-BANK-TYPE                 VALUE 'B'.
  3091         16  FILLER                       PIC X(05).
  3092
  3093     12  PY-RECORD-STATUS.
  3094         16  PY-CREDIT-SELECT-DT          PIC XX.
  3095         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  3096         16  PY-BILLED-DATE               PIC XX.
  3097         16  PY-REPORTED-DT               PIC XX.
  3098         16  PY-PMT-APPLIED               PIC X.
  3099             88  PY-ACCOUNT-PMT               VALUE 'A'.
  3100             88  PY-GA-PMT                    VALUE 'G'.
  3101             88  PY-OVWRITE-PMT               VALUE 'O'.
  3102             88  PY-NON-AR-PMT                VALUE 'N'.
  3103         16  FILLER                       PIC X(5).
  3104         16  PY-INPUT-DT                  PIC XX.
  3105         16  PY-CHECK-NUMBER              PIC X(6).
  3106         16  PY-VOID-SW                   PIC X.
  3107             88  PY-CHECK-VOIDED              VALUE 'V'.
  3108         16  PY-CHECK-ORIGIN-SW           PIC X.
  3109             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  63
* EL687.cbl
  3110             88  PY-REFUND-CHECK              VALUE 'R'.
  3111             88  PY-GA-CHECK                  VALUE 'G'.
  3112             88  PY-CHECK-WRITTEN             VALUE 'W'.
  3113             88  PY-CHECK-REVERSAL            VALUE 'V'.
  3114         16  PY-CHECK-WRITTEN-DT          PIC XX.
  3115         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  3116         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  3117         16  PY-BILL-FLAG                 PIC X.
  3118             88  PY-BILLED                    VALUE 'B'.
  3119         16  PY-AR-FLAG                   PIC X.
  3120             88  PY-AR-CYCLE                  VALUE 'C'.
  3121             88  PY-AR-MONTH-END              VALUE 'M'.
  3122         16  PY-AR-DATE                   PIC XX.
  3123
  3124     12  PY-GL-CODES.
  3125         16  PY-GL-DB                     PIC X(14).
  3126         16  PY-GL-CR                     PIC X(14).
  3127         16  PY-GL-FLAG                   PIC X.
  3128         16  PY-GL-DATE                   PIC XX.
  3129
  3130     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  3131     12  FILLER                           PIC X(3).
  3132******************************************************************
  3133
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  64
* EL687.cbl
  3135*                            COPY ERCCOMP.
  3136******************************************************************
  3137*                                                                *
  3138*                                                                *
  3139*                            ERCCOMP                             *
  3140*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3141*                            VMOD=2.019                          *
  3142*                                                                *
  3143*   ONLINE CREDIT SYSTEM                                         *
  3144*                                                                *
  3145*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  3146*                                                                *
  3147*   FILE TYPE = VSAM,KSDS                                        *
  3148*   RECORD SIZE = 700   RECFORM = FIXED                          *
  3149*                                                                *
  3150*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  3151*       ALTERNATE PATH = NONE                                    *
  3152*                                                                *
  3153*   LOG = NO                                                     *
  3154*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3155*                                                                *
  3156******************************************************************
  3157*                   C H A N G E   L O G
  3158*
  3159* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3160*-----------------------------------------------------------------
  3161*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3162* EFFECTIVE    NUMBER
  3163*-----------------------------------------------------------------
  3164* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3165* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  3166* 092205    2005050300006  PEMA  ADD LEASE FEE
  3167* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  3168* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  3169* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  3170* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3171* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  3172******************************************************************
  3173
  3174 01  COMPENSATION-MASTER.
  3175     12  CO-RECORD-ID                          PIC XX.
  3176         88  VALID-CO-ID                          VALUE 'CO'.
  3177
  3178     12  CO-CONTROL-PRIMARY.
  3179         16  CO-COMPANY-CD                     PIC X.
  3180         16  CO-CONTROL.
  3181             20  CO-CTL-1.
  3182                 24  CO-CARR-GROUP.
  3183                     28  CO-CARRIER            PIC X.
  3184                     28  CO-GROUPING.
  3185                         32  CO-GROUP-PREFIX   PIC XXX.
  3186                         32  CO-GROUP-PRIME    PIC XXX.
  3187                 24  CO-RESP-NO.
  3188                     28  CO-RESP-PREFIX        PIC X(4).
  3189                     28  CO-RESP-PRIME         PIC X(6).
  3190             20  CO-CTL-2.
  3191                 24  CO-ACCOUNT.
  3192                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  65
* EL687.cbl
  3193                     28  CO-ACCT-PRIME         PIC X(6).
  3194         16  CO-TYPE                           PIC X.
  3195             88  CO-COMPANY-TYPE                  VALUE 'C'.
  3196             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  3197             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  3198
  3199     12  CO-MAINT-INFORMATION.
  3200         16  CO-LAST-MAINT-DT                  PIC XX.
  3201         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  3202         16  CO-LAST-MAINT-USER                PIC X(4).
  3203     12  FILLER                                PIC XX.
  3204     12  CO-STMT-TYPE                          PIC XXX.
  3205     12  CO-COMP-TYPE                          PIC X.
  3206         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  3207     12  CO-STMT-OWNER                         PIC X(4).
  3208     12  CO-BALANCE-CONTROL                    PIC X.
  3209         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  3210         88  CO-NO-BALANCE                        VALUE 'N'.
  3211
  3212     12  CO-INTERNAL-CONTROL-1                 PIC X.
  3213         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  3214         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  3215         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  3216
  3217     12  CO-INTERNAL-CONTROL-2                 PIC X.
  3218         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  3219         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  3220
  3221     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  3222     12  CO-GA-DIRECT-DEP                      PIC X.
  3223     12  CO-FUTURE-SPACE                       PIC X.
  3224         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  3225
  3226     12  CO-ACCT-NAME                          PIC X(30).
  3227     12  CO-MAIL-NAME                          PIC X(30).
  3228     12  CO-ADDR-1                             PIC X(30).
  3229     12  CO-ADDR-2                             PIC X(30).
  3230     12  CO-ADDR-3.
  3231         16  CO-ADDR-CITY                      PIC X(27).
  3232         16  CO-ADDR-STATE                     PIC XX.
  3233     12  CO-CSO-1099                           PIC X.
  3234     12  CO-ZIP.
  3235         16  CO-ZIP-PRIME.
  3236             20  CO-ZIP-PRI-1ST                PIC X.
  3237                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3238             20  FILLER                        PIC X(4).
  3239         16  CO-ZIP-PLUS4                      PIC X(4).
  3240     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  3241         16  CO-CAN-POSTAL-1                   PIC XXX.
  3242         16  CO-CAN-POSTAL-2                   PIC XXX.
  3243         16  FILLER                            PIC XXX.
  3244     12  CO-SOC-SEC                            PIC X(13).
  3245     12  CO-TELEPHONE.
  3246         16  CO-AREA-CODE                      PIC XXX.
  3247         16  CO-PREFIX                         PIC XXX.
  3248         16  CO-PHONE                          PIC X(4).
  3249
  3250     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  66
* EL687.cbl
  3251
  3252     12  CO-AR-BAL-LEVEL                       PIC X.
  3253         88  CO-AR-REF-LVL                        VALUE '1'.
  3254         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  3255         88  CO-AR-BILL-LVL                       VALUE '2'.
  3256         88  CO-AR-AGT-LVL                        VALUE '3'.
  3257         88  CO-AR-FR-LVL                         VALUE '4'.
  3258
  3259     12  CO-AR-NORMAL-PRINT                    PIC X.
  3260         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  3261         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  3262
  3263     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  3264
  3265     12  CO-AR-REPORTING                       PIC X.
  3266         88  CO-AR-NET-REPORT                     VALUE 'N'.
  3267         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  3268
  3269     12  CO-AR-PULL-CHECK                      PIC X.
  3270         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  3271         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  3272
  3273     12  CO-AR-BALANCE-PRINT                   PIC X.
  3274         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  3275
  3276     12  CO-AR-LAST-RUN-CODE                   PIC X.
  3277         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  3278         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  3279         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  3280
  3281     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  3282
  3283     12  CO-USER-CODE                          PIC X.
  3284     12  CO-REPORT-GROUP-ID                    PIC X(12).
  3285
  3286******************************************************************
  3287*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  3288*    THE LAST MONTH END RUN.
  3289******************************************************************
  3290
  3291     12  CO-LAST-ACTIVITY-DATE.
  3292         16  CO-ACT-YEAR                       PIC 99.
  3293         16  CO-ACT-MONTH                      PIC 99.
  3294         16  CO-ACT-DAY                        PIC 99.
  3295
  3296     12  CO-LAST-STMT-DT.
  3297         16  CO-LAST-STMT-YEAR                 PIC 99.
  3298         16  CO-LAST-STMT-MONTH                PIC 99.
  3299         16  CO-LAST-STMT-DAY                  PIC 99.
  3300
  3301     12  CO-MO-END-TOTALS.
  3302         16  CO-MONTHLY-TOTALS.
  3303             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  3304             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  3305             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  3306             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  3307             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  3308
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  67
* EL687.cbl
  3309         16  CO-AGING-TOTALS.
  3310             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  3311             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  3312             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  3313             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  3314
  3315         16  CO-YTD-TOTALS.
  3316             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  3317             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  3318
  3319         16  CO-OVER-UNDER-TOTALS.
  3320             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  3321             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  3322
  3323     12  CO-MISCELLANEOUS-TOTALS.
  3324         16  CO-FICA-TOTALS.
  3325             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  3326             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  3327
  3328         16  CO-CLAIM-TOTALS.
  3329             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  3330             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  3331
  3332******************************************************************
  3333*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  3334*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  3335******************************************************************
  3336
  3337     12  CO-CURRENT-TOTALS.
  3338         16  CO-CURRENT-LAST-STMT-DT.
  3339             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  3340             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  3341             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  3342
  3343         16  CO-CURRENT-MONTHLY-TOTALS.
  3344             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  3345             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  3346             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  3347             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  3348             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  3349
  3350         16  CO-CURRENT-AGING-TOTALS.
  3351             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  3352             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  3353             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  3354             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  3355
  3356         16  CO-CURRENT-YTD-TOTALS.
  3357             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  3358             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  3359
  3360     12  CO-PAID-COMM-TOTALS.
  3361         16  CO-YTD-PAID-COMMS.
  3362             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  3363             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  3364
  3365     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  3366         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  68
* EL687.cbl
  3367         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  3368
  3369     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  3370         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  3371         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  3372         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  3373         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  3374         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  3375         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  3376         88  CO-FINAL-LETTER                  VALUE 'F'.
  3377         88  CO-RECONCILING                   VALUE 'R'.
  3378         88  CO-PHONE-CALL                    VALUE 'P'.
  3379         88  CO-LEGAL                         VALUE 'L'.
  3380         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  3381         88  CO-WRITE-OFF                     VALUE 'W'.
  3382         88  CO-NO-ACTION                     VALUE 'N' ' '.
  3383
  3384     12  CO-CSR-CODE                       PIC X(4).
  3385
  3386     12  CO-GA-STATUS-INFO.
  3387         16  CO-GA-EFFECTIVE-DT            PIC XX.
  3388         16  CO-GA-TERMINATION-DT          PIC XX.
  3389         16  CO-GA-STATUS-CODE             PIC X.
  3390             88  CO-GA-ACTIVE                 VALUE 'A'.
  3391             88  CO-GA-INACTIVE               VALUE 'I'.
  3392             88  CO-GA-PENDING                VALUE 'P'.
  3393         16  CO-GA-COMMENTS.
  3394             20  CO-GA-COMMENT-1           PIC X(40).
  3395             20  CO-GA-COMMENT-2           PIC X(40).
  3396             20  CO-GA-COMMENT-3           PIC X(40).
  3397             20  CO-GA-COMMENT-4           PIC X(40).
  3398
  3399     12  CO-RPTCD2                         PIC X(10).
  3400
  3401     12  CO-TYPE-AGENT                     PIC X(01).
  3402         88  CO-CORPORATION                   VALUE 'C'.
  3403         88  CO-PARTNERSHIP                   VALUE 'P'.
  3404         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  3405         88  CO-TRUST                         VALUE 'T'.
  3406         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  3407
  3408     12  CO-FAXNO.
  3409         16  CO-FAX-AREA-CODE                  PIC XXX.
  3410         16  CO-FAX-PREFIX                     PIC XXX.
  3411         16  CO-FAX-PHONE                      PIC X(4).
  3412
  3413     12  CO-BANK-INFORMATION.
  3414         16  CO-BANK-TRANSIT-NO                PIC X(8).
  3415         16  CO-BANK-TRANSIT-NON REDEFINES
  3416             CO-BANK-TRANSIT-NO                PIC 9(8).
  3417
  3418         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  3419     12  CO-MISC-DEDUCT-INFO REDEFINES
  3420                  CO-BANK-INFORMATION.
  3421         16  CO-MD-GL-ACCT                     PIC X(10).
  3422         16  CO-MD-DIV                         PIC XX.
  3423         16  CO-MD-CENTER                      PIC X(4).
  3424         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  69
* EL687.cbl
  3425         16  CO-CREATE-AP-CHECK                PIC X.
  3426         16  CO-DELIVER-CK-TO-MEL              PIC X.
  3427         16  FILLER                            PIC XXX.
  3428     12  CO-ACH-STATUS                         PIC X.
  3429         88  CO-ACH-ACTIVE                         VALUE 'A'.
  3430         88  CO-ACH-PENDING                        VALUE 'P'.
  3431
  3432     12  CO-BILL-SW                            PIC X.
  3433     12  CO-CONTROL-NAME                       PIC X(30).
  3434     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  3435     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  3436     12  CO-CLP-STATE                          PIC XX.
  3437     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  3438     12  CO-SPP-REFUND-EDIT                    PIC X.
  3439
  3440******************************************************************
  3441
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  70
* EL687.cbl
  3443*                            COPY ERCCHEK.
  3444******************************************************************
  3445*                                                                *
  3446*                                                                *
  3447*                            ERCCHEK                             *
  3448*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3449*                            VMOD=2.008                          *
  3450*                                                                *
  3451*   FILE DESCRIPTION = CHECK RECORDS                             *
  3452*                                                                *
  3453*   FILE TYPE = VSAM,KSDS                                        *
  3454*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3455*                                                                *
  3456*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3457*       ALTERNATE INDEX = NONE                                   *
  3458*                                                                *
  3459*   LOG = YES                                                    *
  3460*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3461******************************************************************
  3462 01  CHECK-RECORDS.
  3463     12  CH-RECORD-ID                      PIC XX.
  3464         88  VALID-CH-ID                      VALUE 'CH'.
  3465
  3466     12  CH-CONTROL-PRIMARY.
  3467         16  CH-COMPANY-CD                 PIC X.
  3468         16  CH-CARRIER                    PIC X.
  3469         16  CH-GROUPING                   PIC X(6).
  3470         16  CH-STATE                      PIC XX.
  3471         16  CH-ACCOUNT                    PIC X(10).
  3472         16  CH-CERT-EFF-DT                PIC XX.
  3473         16  CH-CERT-NO.
  3474             20  CH-CERT-PRIME             PIC X(10).
  3475             20  CH-CERT-SFX               PIC X.
  3476         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3477
  3478     12  CH-RECORDED-DT                    PIC XX.
  3479     12  CH-RECORDED-BY                    PIC X(4).
  3480     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3481
  3482     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3483     12  CH-CHECK-NO                       PIC X(7).
  3484     12  CH-REASON-FOR-CHECK               PIC X(25).
  3485     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3486     12  CH-OFFLINE-CHECK-IND              PIC X.
  3487         88  MANUAL-CHECK-WRITTEN             VALUE 'Y'.
  3488
  3489     12  CH-PAYEE-INFO.
  3490         16  CH-PAYEE-NAME-1               PIC X(30).
  3491         16  CH-PAYEE-NAME-2               PIC X(30).
  3492         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3493         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3494         16  CH-PAYEE-CITY-ST              PIC X(30).
  3495         16  CH-PAYEE-ZIP-CODE.
  3496             20  CH-PAYEE-ZIP.
  3497                 24  CH-ZIP-PRI-1ST        PIC X.
  3498                     88  CH-CANADIAN-POST-CODE
  3499                                           VALUES 'A' THRU 'Z'.
  3500                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  71
* EL687.cbl
  3501             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3502         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3503             20  CH-CAN-POSTAL-1           PIC XXX.
  3504             20  CH-CAN-POSTAL-2           PIC XXX.
  3505             20  FILLER                    PIC XXX.
  3506
  3507     12  CH-CHECK-STUB-TEXT.
  3508         16  CH-STUB-LINE-1                PIC X(50).
  3509         16  CH-STUB-LINE-2                PIC X(50).
  3510         16  CH-STUB-LINE-3                PIC X(50).
  3511         16  FILLER.
  3512           18  CH-STUB-LINE-4              PIC X(20).
  3513           18  CH-LIENHOLDER-NAME          PIC X(30).
  3514
  3515     12  CH-COMPENSATION-CONTROL.
  3516         16  CH-COMP-CARRIER               PIC X.
  3517         16  CH-COMP-GROUPING              PIC X(6).
  3518         16  CH-COMP-FIN-RESP              PIC X(10).
  3519         16  CH-COMP-ACCOUNT               PIC X(10).
  3520
  3521     12  CH-CREDIT-SELECT-DT               PIC XX.
  3522     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3523     12  CH-PAYEE-CODE                     PIC X(6).
  3524
  3525     12  CH-VOID-DATA.
  3526         20  CH-VOID-DT                    PIC XX.
  3527         20  CH-VOID-BY                    PIC X(4).
  3528         20  CH-VOID-REASON                PIC X(25).
  3529
  3530     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3531             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3532     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3533
  3534     12  CH-CHECK-REFERENCE                PIC X(12).
  3535     12  CH-CHECK-ORIGIN-SW                PIC X.
  3536             88  CH-REFUND-CHECK              VALUE 'R'.
  3537             88  CH-MAINT-CHECK               VALUE 'M'.
  3538
  3539     12  CH-CANC-DT                        PIC XX.
  3540     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3541     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3542
  3543     12  CH-INSURED-NAME                   PIC X(28).
  3544
  3545     12  CH-DEDUCT-WITHHELD                PIC S9(5)V99  COMP-3.
  3546     12  CH-ADDITIONAL-CHARGE              PIC S9(5)V99  COMP-3.
  3547
  3548     12  CH-LETTER-TABLE.
  3549         16  CH-LETTERS OCCURS 3 TIMES
  3550                        INDEXED BY CH-LT-NDX
  3551                                           PIC X(04).
  3552
  3553     12  FILLER                            PIC X(07).
  3554
  3555
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  72
* EL687.cbl
  3557 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3558                          CONTROL-FILE PENDING-PAY-ADJ
  3559                          COMPENSATION-MASTER CHECK-RECORDS.
  3560 0000-DFHEXIT SECTION.
  3561     MOVE '9#                    $   ' TO DFHEIV0.
  3562     MOVE 'EL687' TO DFHEIV1.
  3563     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3564
  3565     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3566
  3567*    NOTE *******************************************************
  3568*         *      ACCESS TO THIS MODULE CAN BE ONLY FROM AN XCTL *
  3569*         *  FROM ANOTHER MODULE.                               *
  3570*         *******************************************************.
  3571
  3572     MOVE EIBDATE                TO  DC-JULIAN-YYDDD
  3573     MOVE '5'                    TO  DC-OPTION-CODE
  3574     PERFORM 8500-DATE-CONVERSION
  3575     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-DATE
  3576
  3577     IF EIBCALEN NOT GREATER THAN ZERO
  3578         MOVE UNACCESS-MSG       TO  LOGOFF-MSG
  3579         GO TO 8300-SEND-TEXT.
  3580
  3581
  3582* EXEC CICS HANDLE CONDITION
  3583*        PGMIDERR   (9600-PGMIDERR)
  3584*        NOTFND     (0180-MAIN-LOGIC)
  3585*        ENDFILE    (0190-MAIN-LOGIC)
  3586*        TERMIDERR  (0900-TERMIDERR)
  3587*        ENQBUSY    (0910-ENQ-BUSY)
  3588*        ERROR      (9990-ERROR) END-EXEC.
  3589*    MOVE '"$LI''[).              ! " #00003577' TO DFHEIV0
  3590     MOVE X'22244C49275B292E20202020' TO DFHEIV0(1:12)
  3591     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3592     MOVE X'2220233030303033353737' TO DFHEIV0(25:11)
  3593     CALL 'kxdfhei1' USING DFHEIV0
  3594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3595
  3596
  3597     MOVE +3                     TO  EMI-NUMBER-OF-LINES
  3598     MOVE +2                     TO  EMI-SWITCH2.
  3599
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  73
* EL687.cbl
  3601 0010-MAIN-LOGIC.
  3602     IF PI-CALLING-PROGRAM NOT = WS-PROGRAM-ID
  3603         IF PI-RETURN-TO-PROGRAM NOT = WS-PROGRAM-ID
  3604             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  3605             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  3606             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  3607             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  3608             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  3609             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  3610             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  3611             MOVE WS-PROGRAM-ID        TO  PI-CALLING-PROGRAM
  3612           ELSE
  3613             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  3614             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  3615             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  3616             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  3617             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  3618             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  3619             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  3620             MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  3621       ELSE
  3622         GO TO 0040-MAIN-LOGIC.
  3623
  3624 0015-MAIN-LOGIC.
  3625*    NOTE *******************************************************
  3626*         *      INITIALIZE THE WORK FIELDS FOR THE PROGRAM     *
  3627*         *  INTERFACE BLOCK FOR THIS MODULE.                   *
  3628*         *******************************************************.
  3629
  3630     MOVE SPACES                 TO  PI-PROGRAM-WORK-AREA.
  3631
  3632     MOVE ZEROS                  TO  PI-NUMBER-OF-CONTROL-GROUPS
  3633                                     PI-NUMBER-OF-ALIGNMENT-CHECKS
  3634                                     PI-ALIGNMENT-CONTROL-GROUP
  3635                                     PI-ALIGNMENT-SEQUENCE-NO
  3636                                     PI-PROCESSING-SW
  3637                                     PI-CONTROL-GROUP (1)
  3638                                     PI-CONTROL-GROUP (2)
  3639                                     PI-CONTROL-GROUP (3)
  3640                                     PI-CONTROL-GROUP (4)
  3641                                     PI-HIGH-SEQUENCE (1)
  3642                                     PI-HIGH-SEQUENCE (2)
  3643                                     PI-HIGH-SEQUENCE (3)
  3644                                     PI-HIGH-SEQUENCE (4)
  3645                                     PI-COMPANY-ZIP-CODE
  3646                                     PI-COMPANY-PHONE-NUMBER.
  3647
  3648     MOVE WS-PRINTER-STARTED-SW  TO  PI-PRINTER-STARTED-SW.
  3649     MOVE WS-TEMP-STORAGE-KEY    TO  PI-TEMP-STORAGE-KEY.
  3650
  3651     MOVE LOW-VALUES             TO  EL687AI.
  3652     MOVE -1                     TO  AOPTIONL
  3653
  3654
  3655* EXEC CICS ASSIGN
  3656*        SYSID (PI-SYSID)
  3657*        END-EXEC.
  3658*    MOVE '"(         $          "   #00003642' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  74
* EL687.cbl
  3659     MOVE X'222820202020202020202024' TO DFHEIV0(1:12)
  3660     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  3661     MOVE X'2020233030303033363432' TO DFHEIV0(25:11)
  3662     CALL 'kxdfhei1' USING DFHEIV0,
  3663           PI-SYSID
  3664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3665
  3666
  3667     PERFORM 8100-SEND-INITIAL-MAP.
  3668
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  75
* EL687.cbl
  3670 0040-MAIN-LOGIC.
  3671*    NOTE *******************************************************
  3672*         *      AFTER THE FIRST TIME THROUGH THE PROPER ATTEN- *
  3673*         *  TION KEY USAGE NEEDS TO BE CHECKED FOR VALIDITY    *
  3674*         *  BEFORE ANY FURTHER PROCESSING CAN BE DONE.         *
  3675*         *******************************************************.
  3676
  3677     IF EIBAID = DFHCLEAR
  3678         GO TO 9400-CLEAR.
  3679
  3680     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3681         MOVE LOW-VALUES         TO  EL687AI
  3682         MOVE ER-0008            TO  EMI-ERROR
  3683         MOVE -1                 TO  APFKL
  3684         PERFORM 8200-SEND-DATAONLY.
  3685
  3686
  3687* EXEC CICS RECEIVE
  3688*        INTO   (EL687AI)
  3689*        MAPSET (WS-MAPSET-NAME)
  3690*        MAP    (WS-MAP-NAME) END-EXEC.
  3691     MOVE LENGTH OF
  3692      EL687AI
  3693       TO DFHEIV11
  3694*    MOVE '8"T I  L              ''   #00003665' TO DFHEIV0
  3695     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3696     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3697     MOVE X'2020233030303033363635' TO DFHEIV0(25:11)
  3698     CALL 'kxdfhei1' USING DFHEIV0,
  3699           WS-MAP-NAME,
  3700           EL687AI,
  3701           DFHEIV11,
  3702           WS-MAPSET-NAME,
  3703           DFHEIV99,
  3704           DFHEIV99
  3705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3706
  3707
  3708     IF APFKL IS GREATER THAN ZERO
  3709         IF EIBAID NOT = DFHENTER
  3710             MOVE ER-0004        TO  EMI-ERROR
  3711             MOVE AL-UNBOF       TO  APFKA
  3712             MOVE -1             TO  APFKL
  3713             PERFORM 8200-SEND-DATAONLY
  3714           ELSE
  3715             IF APFKO GREATER ZERO AND LESS '25'
  3716                 MOVE PF-VALUES (APFKI)  TO  EIBAID
  3717               ELSE
  3718                 MOVE ER-0029        TO  EMI-ERROR
  3719                 MOVE AL-UNBOF       TO  APFKA
  3720                 MOVE -1             TO  APFKL
  3721                 PERFORM 8200-SEND-DATAONLY.
  3722
  3723     IF EIBAID IS = DFHPF12
  3724         MOVE 'EL010'            TO  WS-PROGRAM-ID
  3725         GO TO 9300-XCTL.
  3726
  3727     IF EIBAID IS = DFHPF23
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  76
* EL687.cbl
  3728         GO TO 9000-RETURN-CICS.
  3729
  3730     IF EIBAID IS = DFHPF24
  3731         MOVE 'EL126'            TO  WS-PROGRAM-ID
  3732         GO TO 9300-XCTL.
  3733
  3734     IF EIBAID NOT = DFHENTER
  3735         MOVE ER-0008            TO  EMI-ERROR
  3736         MOVE -1                 TO  APFKL
  3737         PERFORM 8200-SEND-DATAONLY.
  3738
  3739     IF PI-PROCESSING-SW NOT = ZERO
  3740         GO TO 0240-MAIN-LOGIC.
  3741
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  77
* EL687.cbl
  3743 0100-MAIN-LOGIC.
  3744*    NOTE *******************************************************
  3745*         *          SYNTAX CHECK THE MAP FIELDS                *
  3746*         *******************************************************.
  3747
  3748     IF AOPTIONL NOT GREATER THAN ZERO
  3749         MOVE -1                 TO  AOPTIONL
  3750         MOVE AL-UNBON           TO  AOPTIONA
  3751         MOVE ER-0002            TO  EMI-ERROR
  3752         PERFORM 8200-SEND-DATAONLY.
  3753
  3754     IF (AOPTIONI GREATER ZERO AND LESS '4')
  3755       OR
  3756         (PI-COMPANY-ID = 'POS' AND
  3757          AOPTIONI = ('2' OR '3'))
  3758             MOVE AL-UNNON           TO  AOPTIONA
  3759           ELSE
  3760             MOVE -1                 TO  AOPTIONL
  3761             MOVE AL-UNBON           TO  AOPTIONA
  3762             MOVE ER-0330            TO  EMI-ERROR
  3763             PERFORM 9900-ERROR-FORMAT.
  3764
  3765     IF AALIGNL GREATER THAN ZERO
  3766         IF AALIGNI IS NUMERIC
  3767             MOVE AALIGNO  TO  PI-NUMBER-OF-ALIGNMENT-CHECKS
  3768             MOVE AL-UNNON       TO  AALIGNA
  3769           ELSE
  3770             MOVE ER-0365        TO  EMI-ERROR
  3771             MOVE -1             TO  AALIGNL
  3772             MOVE AL-UNBON       TO  AALIGNA
  3773             PERFORM 9900-ERROR-FORMAT.
  3774
  3775     IF ACKNOL GREATER THAN ZERO
  3776         IF ACKNOI IS NUMERIC
  3777             MOVE AL-UNNON       TO  ACKNOA
  3778             MOVE ACKNOI         TO  WS-CHECK-NUMBER-X
  3779           ELSE
  3780             MOVE ER-0366        TO  EMI-ERROR
  3781             MOVE -1             TO  ACKNOL
  3782             MOVE AL-UNBON       TO  ACKNOA
  3783             PERFORM 9900-ERROR-FORMAT
  3784       ELSE
  3785         MOVE ZERO               TO  WS-CHECK-NUMBER.
  3786
  3787     IF AACNL GREATER THAN ZERO
  3788         MOVE AACNI              TO  PI-ASSIGN-CHECK-NUMBERS
  3789         IF AACNI = ('Y' OR 'N')
  3790             MOVE AL-UANON       TO  AACNA
  3791             MOVE AACNI         TO  PI-ENTRY-CD-1
  3792           ELSE
  3793             MOVE AL-UABON       TO  AACNA
  3794             MOVE -1             TO  AACNL
  3795             MOVE ER-0367        TO  EMI-ERROR
  3796             PERFORM 9900-ERROR-FORMAT
  3797       ELSE
  3798         MOVE AL-UABOF           TO  AACNA
  3799         MOVE -1                 TO  AACNL
  3800         MOVE ER-0368            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  78
* EL687.cbl
  3801         PERFORM 9900-ERROR-FORMAT.
  3802
  3803     IF AACNI = 'Y'
  3804       AND ACKNOL NOT GREATER THAN ZERO
  3805         MOVE -1                 TO  ACKNOL
  3806         MOVE AL-UNBOF           TO  ACKNOA
  3807         MOVE ER-0392            TO  EMI-ERROR
  3808         PERFORM 9900-ERROR-FORMAT.
  3809
  3810     IF AACNI = 'N'
  3811       AND ACKNOL GREATER THAN ZERO
  3812         MOVE -1                 TO  ACKNOL
  3813         MOVE AL-UNBON           TO  ACKNOA
  3814         MOVE ER-0393            TO  EMI-ERROR
  3815         PERFORM 9900-ERROR-FORMAT.
  3816
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  79
* EL687.cbl
  3818*    NOTE *******************************************************
  3819*         *      CHECK THE VALIDITY OF ANY CONTROL GROUPS       *
  3820*         *  ENTERED.                                           *
  3821*         *******************************************************.
  3822
  3823     SET EL687A-INDEX
  3824         PI-INDEX TO +1.
  3825
  3826 0120-MAIN-LOGIC.
  3827     IF EL687A-CONTROL-GROUP-LENGTH (EL687A-INDEX)
  3828                                 NOT GREATER THAN ZERO
  3829         MOVE AL-UNNOF  TO  EL687A-CONTROL-GROUP-ATTRB
  3830                                                    (EL687A-INDEX)
  3831         GO TO 0190-MAIN-LOGIC.
  3832
  3833     IF EL687A-CONTROL-GROUP (EL687A-INDEX) IS NOT NUMERIC
  3834         MOVE AL-UNBON  TO  EL687A-CONTROL-GROUP-ATTRB
  3835                                                    (EL687A-INDEX)
  3836         MOVE -1  TO  EL687A-CONTROL-GROUP-LENGTH (EL687A-INDEX)
  3837         MOVE ER-0369            TO  EMI-ERROR
  3838         PERFORM 9900-ERROR-FORMAT
  3839         GO TO 0190-MAIN-LOGIC.
  3840
  3841     MOVE EL687A-CONTROL-GROUP (EL687A-INDEX)
  3842                                 TO  PI-CONTROL-GROUP (PI-INDEX)
  3843     SET PI-INDEX UP BY +1
  3844     MOVE AL-UNNON  TO  EL687A-CONTROL-GROUP-ATTRB (EL687A-INDEX)
  3845
  3846     IF PI-INDEX IS GREATER THAN +2
  3847       AND PI-CONTROL-GROUP (PI-INDEX - 2)
  3848                     NOT LESS THAN PI-CONTROL-GROUP (PI-INDEX - 1)
  3849         MOVE ER-0385            TO  EMI-ERROR
  3850         PERFORM 9900-ERROR-FORMAT
  3851         MOVE -1 TO EL687A-CONTROL-GROUP-LENGTH (EL687A-INDEX)
  3852         MOVE AL-UNBON TO EL687A-CONTROL-GROUP-ATTRB
  3853                                                   (EL687A-INDEX).
  3854
  3855     MOVE ZERO                   TO  WS-NOT-FOUND
  3856
  3857     MOVE LOW-VALUES             TO  WS-CHECK-QUEUE-KEY
  3858
  3859     MOVE PI-COMPANY-CD          TO  WS-CQK-COMPANY-CD
  3860     MOVE EL687A-CONTROL-GROUP (EL687A-INDEX)
  3861                                 TO  WS-CQK-CONTROL-NUMBER
  3862
  3863     IF WS-CHECK-QUEUE-BROWSE-SW = ZERO
  3864
  3865* EXEC CICS STARTBR
  3866*            DATASET   (WS-CHECK-QUEUE-DSID)
  3867*            RIDFLD    (WS-CHECK-QUEUE-KEY)
  3868*            GENERIC   EQUAL
  3869*            KEYLENGTH (5) END-EXEC
  3870     MOVE 5
  3871       TO DFHEIV11
  3872     MOVE 0
  3873       TO DFHEIV12
  3874*    MOVE '&,   KG    E          &   #00003826' TO DFHEIV0
  3875     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  80
* EL687.cbl
  3876     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3877     MOVE X'2020233030303033383236' TO DFHEIV0(25:11)
  3878     CALL 'kxdfhei1' USING DFHEIV0,
  3879           WS-CHECK-QUEUE-DSID,
  3880           WS-CHECK-QUEUE-KEY,
  3881           DFHEIV11,
  3882           DFHEIV12,
  3883           DFHEIV99
  3884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3885         MOVE +1                 TO  WS-CHECK-QUEUE-BROWSE-SW
  3886       ELSE
  3887
  3888* EXEC CICS RESETBR
  3889*        DATASET   (WS-CHECK-QUEUE-DSID)
  3890*        RIDFLD    (WS-CHECK-QUEUE-KEY)
  3891*        GENERIC   EQUAL
  3892*        KEYLENGTH (5) END-EXEC.
  3893     MOVE 5
  3894       TO DFHEIV11
  3895     MOVE 0
  3896       TO DFHEIV12
  3897*    MOVE '&4   KG    E          &   #00003833' TO DFHEIV0
  3898     MOVE X'26342020204B472020202045' TO DFHEIV0(1:12)
  3899     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3900     MOVE X'2020233030303033383333' TO DFHEIV0(25:11)
  3901     CALL 'kxdfhei1' USING DFHEIV0,
  3902           WS-CHECK-QUEUE-DSID,
  3903           WS-CHECK-QUEUE-KEY,
  3904           DFHEIV11,
  3905           DFHEIV12,
  3906           DFHEIV99
  3907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3908
  3909
  3910 0130-MAIN-LOGIC.
  3911
  3912* EXEC CICS READNEXT
  3913*        DATASET (WS-CHECK-QUEUE-DSID)
  3914*        RIDFLD  (WS-CHECK-QUEUE-KEY)
  3915*        SET     (ADDRESS OF CHECK-QUE) END-EXEC
  3916     MOVE 0
  3917       TO DFHEIV11
  3918*    MOVE '&.S                   )   #00003840' TO DFHEIV0
  3919     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3920     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3921     MOVE X'2020233030303033383430' TO DFHEIV0(25:11)
  3922     CALL 'kxdfhei1' USING DFHEIV0,
  3923           WS-CHECK-QUEUE-DSID,
  3924           DFHEIV20,
  3925           DFHEIV99,
  3926           WS-CHECK-QUEUE-KEY,
  3927           DFHEIV99,
  3928           DFHEIV11,
  3929           DFHEIV99,
  3930           DFHEIV99
  3931     SET ADDRESS OF CHECK-QUE TO
  3932         DFHEIV20
  3933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  81
* EL687.cbl
  3934
  3935     IF WS-CQK-COMPANY-CD NOT = PI-COMPANY-CD
  3936         GO TO 0170-MAIN-LOGIC.
  3937
  3938     IF WS-CQK-CONTROL-NUMBER NOT = EL687A-CONTROL-GROUP
  3939                                                    (EL687A-INDEX)
  3940         GO TO 0170-MAIN-LOGIC.
  3941
  3942     IF CQ-ENTRY-TYPE NOT = 'Q'
  3943         GO TO 0130-MAIN-LOGIC.
  3944
  3945     IF PI-COMPANY-ID = 'POS'
  3946         MOVE CQ-PYAJ-CARRIER    TO  PI-CARRIER.
  3947
  3948     IF AOPTIONI = '2'
  3949       AND CQ-TIMES-PRINTED NOT GREATER THAN ZERO
  3950         GO TO 0190-MAIN-LOGIC.
  3951
  3952     IF AOPTIONI = '3'
  3953       AND CQ-TIMES-PRINTED GREATER THAN ZERO
  3954         GO TO 0190-MAIN-LOGIC.
  3955
  3956     GO TO 0130-MAIN-LOGIC.
  3957
  3958 0170-MAIN-LOGIC.
  3959     MOVE ER-0394                TO  EMI-ERROR
  3960     PERFORM 9900-ERROR-FORMAT
  3961     MOVE -1 TO EL687A-CONTROL-GROUP-LENGTH (EL687A-INDEX)
  3962     MOVE AL-UNBON TO EL687A-CONTROL-GROUP-ATTRB (EL687A-INDEX)
  3963
  3964     GO TO 0190-MAIN-LOGIC.
  3965
  3966 0180-MAIN-LOGIC.
  3967     MOVE ER-0387                TO  EMI-ERROR
  3968     PERFORM 9900-ERROR-FORMAT
  3969     MOVE -1 TO EL687A-CONTROL-GROUP-LENGTH (EL687A-INDEX)
  3970     MOVE AL-UNBON TO EL687A-CONTROL-GROUP-ATTRB (EL687A-INDEX).
  3971
  3972 0190-MAIN-LOGIC.
  3973     IF EL687A-INDEX LESS THAN +4
  3974         SET EL687A-INDEX UP BY +1
  3975         GO TO 0120-MAIN-LOGIC.
  3976
  3977     IF WS-CHECK-QUEUE-BROWSE-SW NOT = ZERO
  3978         MOVE ZERO               TO  WS-CHECK-QUEUE-BROWSE-SW
  3979
  3980* EXEC CICS ENDBR
  3981*            DATASET (WS-CHECK-QUEUE-DSID) END-EXEC.
  3982     MOVE 0
  3983       TO DFHEIV11
  3984*    MOVE '&2                    $   #00003889' TO DFHEIV0
  3985     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3986     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3987     MOVE X'2020233030303033383839' TO DFHEIV0(25:11)
  3988     CALL 'kxdfhei1' USING DFHEIV0,
  3989           WS-CHECK-QUEUE-DSID,
  3990           DFHEIV11,
  3991           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  82
* EL687.cbl
  3992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3993
  3994
  3995     IF EMI-FATAL-CTR GREATER THAN ZERO
  3996         PERFORM 8200-SEND-DATAONLY.
  3997
  3998     IF AOPTIONI = ('2' OR '3')
  3999       AND PI-INDEX NOT GREATER THAN +1
  4000         MOVE -1                 TO  ACG01L
  4001         MOVE AL-UNBOF  TO  ACG01A ACG02A ACG03A ACG04A
  4002         MOVE ER-0370            TO  EMI-ERROR
  4003         PERFORM 9900-ERROR-FORMAT.
  4004
  4005     IF PI-INDEX GREATER THAN +1
  4006         NEXT SENTENCE
  4007       ELSE
  4008         GO TO 0200-MAIN-LOGIC.
  4009
  4010     SET PI-INDEX DOWN BY +1
  4011     SET PI-NUMBER-OF-CONTROL-GROUPS TO PI-INDEX
  4012     SET PI-INDEX
  4013         EL687A-INDEX TO +1.
  4014
  4015 0195-MAIN-LOGIC.
  4016     IF PI-CONTROL-GROUP (PI-INDEX) GREATER THAN ZERO
  4017         MOVE PI-CONTROL-GROUP (PI-INDEX)
  4018                     TO  EL687A-CONTROL-GROUP (EL687A-INDEX)
  4019         MOVE AL-UNNON TO EL687A-CONTROL-GROUP-ATTRB
  4020                                                    (EL687A-INDEX)
  4021       ELSE
  4022         MOVE WS-INIT-CONTROL-GROUP
  4023                     TO  EL687A-CONTROL-GROUP (EL687A-INDEX)
  4024         MOVE AL-UNNOF TO EL687A-CONTROL-GROUP-ATTRB
  4025                                                   (EL687A-INDEX).
  4026
  4027     IF PI-INDEX LESS THAN +4
  4028         SET PI-INDEX
  4029             EL687A-INDEX UP BY +1
  4030         GO TO 0195-MAIN-LOGIC.
  4031
  4032     SET EL687A-INDEX
  4033         PI-INDEX TO +1.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  83
* EL687.cbl
  4035 0200-MAIN-LOGIC.
  4036*    NOTE *******************************************************
  4037*         *      ALL OF THE SYNTAX CHECKS HAVE BEEN SUCCESSFUL- *
  4038*         *  NOW DO THE PRE-EDIT.                               *
  4039*         *                                                     *
  4040*         *      BEFORE A CHECK BATCH IS QUEUED FOR PRINT, A    *
  4041*         *  PRE-EDIT IS DONE TO ASSURE CONSISTENCY IN          *
  4042*         *  PROCESSING.  THIS EDIT CONSISTS OF THE FOLLOWING   *
  4043*         *  STEPS:                                             *
  4044*         *                                                     *
  4045*         *  1. IF A STARTING CHECK NUMBER HAS BEEN ENTERED,    *
  4046*         *     THE NUMBER IS COMPARED TO OTHER NUMBERS IN THE  *
  4047*         *     FILE FOR OVERLAPS AND GAPS.                     *
  4048*         *                                                     *
  4049*         *  2. IF ANY CHECKS IN THE RELEASED GROUPS HAVE       *
  4050*         *     ALREADY BEEN QUEUED FOR PRINT OR PRINTED.       *
  4051*         *                                                     *
  4052*         *  3. IF PRE-NUMBERING IS NOT USED THAT ALL CHECKS    *
  4053*         *     HAVE A CHECK NUMBER ASSIGNED.                   *
  4054*         *                                                     *
  4055*         *  4. IF DUPLICATE CHECK NUMBERS ARE ASSIGNED.        *
  4056*         *                                                     *
  4057*         *      BEFORE A CHECK BATCH IS QUEUED FOR RE-PRINT, A *
  4058*         *  PRE-EDIT IS DONE TO ASSURE CONSISTENCY IN          *
  4059*         *  PROCESSING.  THIS EDIT CONSISTS OF THE FOLLOWING   *
  4060*         *  STEPS:                                             *
  4061*         *                                                     *
  4062*         *  1. ALL CHECKS IN THE INDICATED GROUP(S) MUST HAVE  *
  4063*         *     BEEN PREVIOUSLY PRINTED.                        *
  4064*         *                                                     *
  4065*         *  2. IF THE PRE-NUMBERING SWITCH IS SET IN ANY RECORD*
  4066*         *     IT MUST BE SET IN ALL RECORDS.                  *
  4067*         *                                                     *
  4068*         *  3. IF A STARTING CHECK NUMBER HAS BEEN ENTERED,    *
  4069*         *     THE NUMBER IS COMPARED TO OTHER NUMBERS IN THE  *
  4070*         *     FILE FOR OVERLAPS AND GAPS.                     *
  4071*         *******************************************************.
  4072
  4073     MOVE PI-COMPANY-ID          TO  WS-ENQ-COMPANY-ID.
  4074
  4075
  4076* EXEC CICS ENQ
  4077*        RESOURCE (WS-CHECK-QUEUE-DSID)
  4078*        LENGTH   (11) END-EXEC.
  4079     MOVE 11
  4080       TO DFHEIV11
  4081*    MOVE '2$L                   $   #00003972' TO DFHEIV0
  4082     MOVE X'32244C202020202020202020' TO DFHEIV0(1:12)
  4083     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4084     MOVE X'2020233030303033393732' TO DFHEIV0(25:11)
  4085     CALL 'kxdfhei1' USING DFHEIV0,
  4086           WS-CHECK-QUEUE-DSID,
  4087           DFHEIV11,
  4088           DFHEIV99
  4089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4090
  4091
  4092
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  84
* EL687.cbl
  4093* EXEC CICS HANDLE CONDITION
  4094*        NOTFND  (0225-MAIN-LOGIC)
  4095*        ENDFILE (0230-MAIN-LOGIC) END-EXEC.
  4096*    MOVE '"$I''                  ! # #00003976' TO DFHEIV0
  4097     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4098     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4099     MOVE X'2320233030303033393736' TO DFHEIV0(25:11)
  4100     CALL 'kxdfhei1' USING DFHEIV0
  4101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4102
  4103
  4104     MOVE LOW-VALUES             TO  WS-CHECK-QUEUE-KEY.
  4105     MOVE +5                     TO  WS-KEY-LENGTH.
  4106
  4107     MOVE PI-COMPANY-CD          TO  WS-CQK-COMPANY-CD.
  4108
  4109
  4110* EXEC CICS STARTBR
  4111*        DATASET (WS-CHECK-QUEUE-DSID)
  4112*        RIDFLD  (WS-CHECK-QUEUE-KEY)
  4113*        GTEQ    END-EXEC.
  4114     MOVE 0
  4115       TO DFHEIV11
  4116*    MOVE '&,         G          &   #00003985' TO DFHEIV0
  4117     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4118     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4119     MOVE X'2020233030303033393835' TO DFHEIV0(25:11)
  4120     CALL 'kxdfhei1' USING DFHEIV0,
  4121           WS-CHECK-QUEUE-DSID,
  4122           WS-CHECK-QUEUE-KEY,
  4123           DFHEIV99,
  4124           DFHEIV11,
  4125           DFHEIV99
  4126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4127
  4128
  4129 0210-MAIN-LOGIC.
  4130     MOVE EMI-FATAL-CTR         TO  WS-LAST-ERROR-COUNT.
  4131
  4132
  4133* EXEC CICS READNEXT
  4134*        DATASET (WS-CHECK-QUEUE-DSID)
  4135*        RIDFLD  (WS-CHECK-QUEUE-KEY)
  4136*        SET     (ADDRESS OF CHECK-QUE) END-EXEC.
  4137     MOVE 0
  4138       TO DFHEIV11
  4139*    MOVE '&.S                   )   #00003993' TO DFHEIV0
  4140     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4141     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4142     MOVE X'2020233030303033393933' TO DFHEIV0(25:11)
  4143     CALL 'kxdfhei1' USING DFHEIV0,
  4144           WS-CHECK-QUEUE-DSID,
  4145           DFHEIV20,
  4146           DFHEIV99,
  4147           WS-CHECK-QUEUE-KEY,
  4148           DFHEIV99,
  4149           DFHEIV11,
  4150           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  85
* EL687.cbl
  4151           DFHEIV99
  4152     SET ADDRESS OF CHECK-QUE TO
  4153         DFHEIV20
  4154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4155
  4156
  4157     IF CQ-COMPANY-CD NOT = PI-COMPANY-CD
  4158         GO TO 0230-MAIN-LOGIC.
  4159
  4160*    IF CQ-ENTRY-TYPE NOT = 'Q'
  4161*        GO TO 0210-MAIN-LOGIC.
  4162
  4163     IF  (AOPTIONI = '1' OR '2')
  4164             AND
  4165         CQ-ENTRY-TYPE NOT = 'Q'
  4166         GO TO 0210-MAIN-LOGIC.
  4167
  4168*    NOTE *******************************************************
  4169*         *      SAVE THE CHECK NUMBER SO AT THE END OF THE     *
  4170*         *  BROWSE YOU CAN CHECK FOR GAPS OR OVERLAPS.         *
  4171*         *******************************************************.
  4172
  4173     IF CQ-CHECK-NUMBER GREATER THAN WS-GREATEST-CHECK-NUMBER-X
  4174         MOVE CQ-CHECK-NUMBER    TO  WS-GREATEST-CHECK-NUMBER-X.
  4175
  4176*    NOTE *******************************************************
  4177*         *      IF YOU ARE PROCESSING BY GROUPS BYPASS ALL     *
  4178*         *  RECORDS IF NOT IN SPECIFIED GROUPS.  SAVE THE HIGH *
  4179*         *  SEQUENCE NUMBER IN EACH GROUP FOR REPRINT.         *
  4180*         *******************************************************.
  4181
  4182     IF AOPTIONI = '2' OR '3'
  4183         NEXT SENTENCE
  4184       ELSE
  4185         GO TO 0213-MAIN-LOGIC.
  4186
  4187     SET PI-INDEX
  4188         EL687A-INDEX TO +1.
  4189
  4190 0212-MAIN-LOGIC.
  4191     IF CQ-CONTROL-NUMBER  = PI-CONTROL-GROUP (PI-INDEX)
  4192         IF CQ-SEQUENCE-NUMBER GREATER PI-HIGH-SEQUENCE (PI-INDEX)
  4193             MOVE CQ-SEQUENCE-NUMBER
  4194                                 TO PI-HIGH-SEQUENCE (PI-INDEX)
  4195             GO TO 0215-MAIN-LOGIC
  4196           ELSE
  4197             GO TO 0215-MAIN-LOGIC.
  4198
  4199     IF PI-INDEX LESS THAN +4
  4200         SET PI-INDEX
  4201             EL687A-INDEX UP BY +1
  4202         GO TO 0212-MAIN-LOGIC.
  4203
  4204     GO TO 0210-MAIN-LOGIC.
  4205
  4206 0213-MAIN-LOGIC.
  4207*    NOTE *******************************************************
  4208*         *      IF YOU ARE PRINTING ALL CONTROL GROUPS BYPASS  *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  86
* EL687.cbl
  4209*         *  THE CONTROL GROUPS THAT HAVE ALREADY BEEN PRINTED. *
  4210*         *******************************************************.
  4211
  4212     IF CQ-CONTROL-NUMBER NOT = WS-LAST-CONTROL-GROUP
  4213         MOVE CQ-CONTROL-NUMBER  TO  WS-LAST-CONTROL-GROUP
  4214         MOVE CQ-TIMES-PRINTED   TO  WS-TIMES-PRINTED.
  4215
  4216     IF WS-TIMES-PRINTED GREATER THAN ZERO
  4217         GO TO 0210-MAIN-LOGIC.
  4218
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  87
* EL687.cbl
  4220 0215-MAIN-LOGIC.
  4221
  4222*    IF  AOPTIONI = '3'
  4223     IF AOPTIONI = '1' OR '2'
  4224         GO TO 0220-MAIN-LOGIC.
  4225
  4226     IF CQ-TIMES-PRINTED GREATER THAN ZERO
  4227        MOVE -1 TO EL687A-CONTROL-GROUP-LENGTH (EL687A-INDEX)
  4228        MOVE AL-UNBON TO EL687A-CONTROL-GROUP-ATTRB (EL687A-INDEX)
  4229        MOVE ER-0379             TO  EMI-ERROR
  4230        PERFORM 9900-ERROR-FORMAT.
  4231
  4232     IF AACNI = 'Y'
  4233       AND CQ-CHECK-NUMBER NOT = SPACES
  4234         MOVE ER-0382            TO  EMI-ERROR
  4235         PERFORM 9900-ERROR-FORMAT
  4236         MOVE -1                 TO  AACNL
  4237         MOVE AL-UABON           TO  AACNA
  4238     ELSE
  4239         IF AACNI = 'N'
  4240           AND CQ-CHECK-NUMBER = SPACES
  4241             MOVE -1             TO  AACNL
  4242             MOVE AL-UABON       TO  AACNA
  4243             MOVE ER-0383        TO  EMI-ERROR
  4244             PERFORM 9900-ERROR-FORMAT.
  4245
  4246     GO TO 0210-MAIN-LOGIC.
  4247
  4248 0220-MAIN-LOGIC.
  4249
  4250     IF  CQ-ENTRY-TYPE NOT = 'Q'
  4251         GO TO 0210-MAIN-LOGIC.
  4252
  4253     IF CQ-TIMES-PRINTED NOT GREATER THAN ZERO
  4254        MOVE -1 TO EL687A-CONTROL-GROUP-LENGTH (EL687A-INDEX)
  4255        MOVE AL-UNBON TO EL687A-CONTROL-GROUP-ATTRB (EL687A-INDEX)
  4256        MOVE ER-0389             TO  EMI-ERROR
  4257        PERFORM 9900-ERROR-FORMAT.
  4258
  4259     IF CQ-PRE-NUMBERING-SW = '1'
  4260       AND AACNI = 'N'
  4261         MOVE -1                 TO  AACNL
  4262         MOVE AL-UABON           TO  AACNA
  4263         MOVE ER-0390            TO  EMI-ERROR
  4264         PERFORM 9900-ERROR-FORMAT.
  4265
  4266     IF CQ-PRE-NUMBERING-SW = SPACES
  4267       AND AACNI = 'Y'
  4268         MOVE -1                 TO  AACNL
  4269         MOVE AL-UABON           TO  AACNA
  4270         MOVE ER-0391            TO  EMI-ERROR
  4271         PERFORM 9900-ERROR-FORMAT.
  4272
  4273     GO TO 0210-MAIN-LOGIC.
  4274
  4275 0225-MAIN-LOGIC.
  4276     MOVE ER-0490                TO  EMI-ERROR
  4277     MOVE -1                     TO  AOPTIONL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  88
* EL687.cbl
  4278     PERFORM 8200-SEND-DATAONLY
  4279     PERFORM 9100-RETURN-TRAN.
  4280
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  89
* EL687.cbl
  4282 0230-MAIN-LOGIC.
  4283
  4284* EXEC CICS ENDBR
  4285*        DATASET (WS-CHECK-QUEUE-DSID) END-EXEC.
  4286     MOVE 0
  4287       TO DFHEIV11
  4288*    MOVE '&2                    $   #00004124' TO DFHEIV0
  4289     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4290     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4291     MOVE X'2020233030303034313234' TO DFHEIV0(25:11)
  4292     CALL 'kxdfhei1' USING DFHEIV0,
  4293           WS-CHECK-QUEUE-DSID,
  4294           DFHEIV11,
  4295           DFHEIV99
  4296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4297
  4298
  4299     IF EMI-FATAL-CTR GREATER THAN ZERO
  4300         PERFORM 8200-SEND-DATAONLY.
  4301
  4302*    NOTE *******************************************************
  4303*         *      READ THE COMPANY RECORD FROM THE CONTROL FILE  *
  4304*         *  TO GET THE CICS/VS PRINTER TERMINAL ID AND CHECK   *
  4305*         *  TO SEE IF THE PRINTER HAS BEEN SPECIFIED.          *
  4306*         *******************************************************.
  4307
  4308     MOVE PI-COMPANY-ID          TO  WS-CONTROL-FILE-KEY.
  4309     MOVE '1'                    TO  WS-CFK-RECORD-TYPE.
  4310     MOVE ZERO                   TO  WS-CFK-SEQUENCE-NO.
  4311
  4312
  4313* EXEC CICS READ
  4314*        DATASET (WS-CONTROL-FILE-DSID)
  4315*        RIDFLD  (WS-CONTROL-FILE-KEY)
  4316*        SET    (ADDRESS OF CONTROL-FILE) END-EXEC.
  4317*    MOVE '&"S        E          (   #00004140' TO DFHEIV0
  4318     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4319     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4320     MOVE X'2020233030303034313430' TO DFHEIV0(25:11)
  4321     CALL 'kxdfhei1' USING DFHEIV0,
  4322           WS-CONTROL-FILE-DSID,
  4323           DFHEIV20,
  4324           DFHEIV99,
  4325           WS-CONTROL-FILE-KEY,
  4326           DFHEIV99,
  4327           DFHEIV99,
  4328           DFHEIV99
  4329     SET ADDRESS OF CONTROL-FILE TO
  4330         DFHEIV20
  4331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4332
  4333
  4334     IF CF-CHECK-PRINTER-ID = SPACES
  4335         MOVE ER-0371            TO  EMI-ERROR
  4336         MOVE -1                 TO  APFKL
  4337         PERFORM 9900-ERROR-FORMAT.
  4338
  4339     MOVE SPACES                 TO  PI-ALT-DMD-PRT-ID.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  90
* EL687.cbl
  4340     IF APRTL GREATER THAN ZEROS
  4341         MOVE AL-UANON           TO  APRTA
  4342         MOVE APRTI              TO  PI-CHECK-PRINTER-ID
  4343                                     PI-ALT-DMD-PRT-ID
  4344     ELSE
  4345         MOVE CF-CHECK-PRINTER-ID
  4346                                 TO  PI-CHECK-PRINTER-ID.
  4347
  4348     MOVE CF-COMPANY-ADDRESS     TO  PI-COMPANY-ADDRESS.
  4349
  4350     IF AACNI = 'Y'
  4351         IF WS-GREATEST-CHECK-NUMBER-X NOT LESS THAN ACKNOI
  4352             MOVE ER-0380        TO  EMI-ERROR
  4353             PERFORM 9900-ERROR-FORMAT
  4354             MOVE -1             TO  ACKNOL
  4355             MOVE AL-UNBON       TO  ACKNOA
  4356         ELSE
  4357             SUBTRACT +1 FROM ACKNOO GIVING WS-ACKNO
  4358             IF WS-GREATEST-CHECK-NUMBER-X NOT = WS-ACKNO-X
  4359                 MOVE ER-0381    TO  EMI-ERROR
  4360                 PERFORM 9900-ERROR-FORMAT
  4361                 MOVE -1         TO  ACKNOL
  4362                 MOVE AL-UNBON   TO  ACKNOA
  4363             ELSE
  4364                 MOVE AL-SANON   TO  ACKNOA.
  4365
  4366     IF EMI-FATAL-CTR GREATER THAN ZERO
  4367         PERFORM 8200-SEND-DATAONLY.
  4368
  4369     MOVE AL-SANON               TO  AOPTIONA
  4370                                     ACG01A
  4371                                     ACG02A
  4372                                     ACG03A
  4373                                     ACG04A
  4374                                     AACNA
  4375                                     APRTA.
  4376
  4377     MOVE +1                     TO  PI-PROCESSING-SW
  4378                                     AALIGNL.
  4379
  4380     IF PI-NUMBER-OF-ALIGNMENT-CHECKS GREATER THAN ZERO
  4381         MOVE ER-0361            TO  EMI-ERROR
  4382       ELSE
  4383         MOVE ER-0362            TO  EMI-ERROR.
  4384
  4385     PERFORM 8200-SEND-DATAONLY.
  4386
  4387
  4388* EXEC CICS HANDLE AID
  4389*        CLEAR (9400-CLEAR)
  4390*        PA1   (0040-MAIN-LOGIC)
  4391*        PA2   (0040-MAIN-LOGIC)
  4392*        PA3   (0040-MAIN-LOGIC) END-EXEC.
  4393*    MOVE '"&=!"#               V! $ #00004198' TO DFHEIV0
  4394     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  4395     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  4396     MOVE X'2420233030303034313938' TO DFHEIV0(25:11)
  4397     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  91
* EL687.cbl
  4398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4399
  4400
  4401
  4402* EXEC CICS SYNCPOINT
  4403*        END-EXEC.
  4404*    MOVE '6"                    !   #00004204' TO DFHEIV0
  4405     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  4406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4407     MOVE X'2020233030303034323034' TO DFHEIV0(25:11)
  4408     CALL 'kxdfhei1' USING DFHEIV0
  4409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4410
  4411
  4412     GO TO 0040-MAIN-LOGIC.
  4413
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  92
* EL687.cbl
  4415 0240-MAIN-LOGIC.
  4416     IF AALIGNL GREATER THAN ZERO
  4417         IF AALIGNI IS NUMERIC
  4418             MOVE AALIGNO  TO  PI-NUMBER-OF-ALIGNMENT-CHECKS
  4419             MOVE AL-UNNON       TO  AALIGNA
  4420           ELSE
  4421             MOVE ER-0365        TO  EMI-ERROR
  4422             MOVE -1             TO  AALIGNL
  4423             MOVE AL-UNBON       TO  AALIGNA
  4424             PERFORM 8200-SEND-DATAONLY
  4425             GO TO 0040-MAIN-LOGIC.
  4426
  4427     IF PI-NUMBER-OF-ALIGNMENT-CHECKS NOT GREATER THAN ZERO
  4428         GO TO 0300-MAIN-LOGIC.
  4429
  4430     IF PI-ALIGNMENT-CONTROL-GROUP GREATER THAN ZERO
  4431         GO TO 0245-MAIN-LOGIC.
  4432
  4433     MOVE PI-COMPANY-ID          TO  WS-CONTROL-FILE-KEY.
  4434     MOVE '1'                    TO  WS-CFK-RECORD-TYPE.
  4435     MOVE ZERO                   TO  WS-CFK-SEQUENCE-NO.
  4436
  4437
  4438* EXEC CICS READ UPDATE
  4439*        DATASET (WS-CONTROL-FILE-DSID)
  4440*        RIDFLD  (WS-CONTROL-FILE-KEY)
  4441*        SET    (ADDRESS OF CONTROL-FILE) END-EXEC.
  4442*    MOVE '&"S        EU         (   #00004232' TO DFHEIV0
  4443     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4444     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4445     MOVE X'2020233030303034323332' TO DFHEIV0(25:11)
  4446     CALL 'kxdfhei1' USING DFHEIV0,
  4447           WS-CONTROL-FILE-DSID,
  4448           DFHEIV20,
  4449           DFHEIV99,
  4450           WS-CONTROL-FILE-KEY,
  4451           DFHEIV99,
  4452           DFHEIV99,
  4453           DFHEIV99
  4454     SET ADDRESS OF CONTROL-FILE TO
  4455         DFHEIV20
  4456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4457
  4458
  4459     ADD +1  TO  CF-CR-CHECK-QUE-COUNTER.
  4460
  4461     IF CR-QUE-COUNT-RESET
  4462         MOVE +1                 TO  CF-CR-CHECK-QUE-COUNTER.
  4463
  4464     MOVE CF-CR-CHECK-QUE-COUNTER TO PI-ALIGNMENT-CONTROL-GROUP.
  4465
  4466     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  4467     MOVE WS-CONTROL-FILE-DSID   TO  JP-FILE-ID.
  4468     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4469
  4470
  4471* EXEC CICS REWRITE
  4472*        DATASET (WS-CONTROL-FILE-DSID)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  93
* EL687.cbl
  4473*        FROM    (CONTROL-FILE) END-EXEC.
  4474     MOVE LENGTH OF
  4475      CONTROL-FILE
  4476       TO DFHEIV11
  4477*    MOVE '&& L                  %   #00004248' TO DFHEIV0
  4478     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4479     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4480     MOVE X'2020233030303034323438' TO DFHEIV0(25:11)
  4481     CALL 'kxdfhei1' USING DFHEIV0,
  4482           WS-CONTROL-FILE-DSID,
  4483           CONTROL-FILE,
  4484           DFHEIV11,
  4485           DFHEIV99
  4486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4487
  4488
  4489     PERFORM 8400-LOG-JOURNAL-RECORD.
  4490
  4491     MOVE EIBTRMID               TO  PI-TSK-TERM-ID.
  4492     MOVE EIBTIME                TO  PI-TSK-TIME.
  4493
  4494     IF PI-COMPANY-ID = 'DMD' OR 'CID'
  4495*        MOVE EIBTRMID       TO PI-CHECK-PRINTER-ID
  4496
  4497* EXEC CICS START
  4498*            TRANSID (WS-CHECK-WRITER-TRANS-ID)
  4499*            FROM    (PROGRAM-INTERFACE-BLOCK)
  4500*            LENGTH  (PI-COMM-LENGTH)
  4501*            TERMID  (PI-CHECK-PRINTER-ID)
  4502*        END-EXEC
  4503*    MOVE '0( LF                 0   #00004259' TO DFHEIV0
  4504     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  4505     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  4506     MOVE X'2020233030303034323539' TO DFHEIV0(25:11)
  4507     CALL 'kxdfhei1' USING DFHEIV0,
  4508           DFHEIV99,
  4509           WS-CHECK-WRITER-TRANS-ID,
  4510           DFHEIV99,
  4511           PROGRAM-INTERFACE-BLOCK,
  4512           PI-COMM-LENGTH,
  4513           DFHEIV99,
  4514           DFHEIV99,
  4515           DFHEIV99,
  4516           DFHEIV99,
  4517           DFHEIV99,
  4518           DFHEIV99,
  4519           DFHEIV99,
  4520           DFHEIV99,
  4521           DFHEIV99,
  4522           DFHEIV99
  4523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4524     ELSE
  4525
  4526* EXEC CICS START
  4527*            TRANSID (WS-CHECK-WRITER-TRANS-ID)
  4528*            FROM    (PROGRAM-INTERFACE-BLOCK)
  4529*            LENGTH  (PI-COMM-LENGTH)
  4530*            TERMID  (PI-CHECK-PRINTER-ID)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  94
* EL687.cbl
  4531*        END-EXEC.
  4532*    MOVE '0( LFT                0   #00004266' TO DFHEIV0
  4533     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  4534     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  4535     MOVE X'2020233030303034323636' TO DFHEIV0(25:11)
  4536     CALL 'kxdfhei1' USING DFHEIV0,
  4537           DFHEIV99,
  4538           WS-CHECK-WRITER-TRANS-ID,
  4539           DFHEIV99,
  4540           PROGRAM-INTERFACE-BLOCK,
  4541           PI-COMM-LENGTH,
  4542           PI-CHECK-PRINTER-ID,
  4543           DFHEIV99,
  4544           DFHEIV99,
  4545           DFHEIV99,
  4546           DFHEIV99,
  4547           DFHEIV99,
  4548           DFHEIV99,
  4549           DFHEIV99,
  4550           DFHEIV99,
  4551           DFHEIV99
  4552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4553
  4554
  4555     MOVE +1                     TO  PI-PRINTER-STARTED-SW.
  4556
  4557
  4558* EXEC CICS GETMAIN
  4559*        SET     (ADDRESS OF CHECK-QUE)
  4560*        LENGTH  (WS-ERCHKQ-LENGTH)
  4561*        INITIMG (WS-SPACES) END-EXEC.
  4562*    MOVE ',"IL                  $   #00004275' TO DFHEIV0
  4563     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4564     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4565     MOVE X'2020233030303034323735' TO DFHEIV0(25:11)
  4566     CALL 'kxdfhei1' USING DFHEIV0,
  4567           DFHEIV20,
  4568           WS-ERCHKQ-LENGTH,
  4569           WS-SPACES
  4570     SET ADDRESS OF CHECK-QUE TO
  4571         DFHEIV20
  4572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4573
  4574
  4575 0245-MAIN-LOGIC.
  4576     MOVE SPACES                 TO  CHECK-QUE.
  4577
  4578     MOVE 'CQ'                   TO  CQ-RECORD-ID.
  4579
  4580     MOVE PI-COMPANY-CD          TO  CQ-COMPANY-CD.
  4581     MOVE 'A'                    TO  CQ-ENTRY-TYPE.
  4582
  4583     MOVE PI-ALIGNMENT-CONTROL-GROUP  TO  CQ-CONTROL-NUMBER.
  4584
  4585     MOVE ZERO                   TO  CQ-CHECK-AMOUNT.
  4586     MOVE +1                     TO  CQ-TIMES-PRINTED.
  4587     MOVE WS-CURRENT-DATE        TO  CQ-CHECK-WRITTEN-DT.
  4588
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  95
* EL687.cbl
  4589     MOVE WS-CHECK-QUEUE-DSID    TO  JP-FILE-ID.
  4590     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4591
  4592     MOVE +6870                  TO  CQ-LAST-UPDATED-BY.
  4593
  4594 0250-MAIN-LOGIC.
  4595     IF AACNI = 'Y'
  4596         MOVE WS-CHECK-NUMBER-X  TO  CQ-CHECK-NUMBER
  4597         ADD +1  TO  WS-CHECK-NUMBER
  4598         MOVE '1'                TO  CQ-PRE-NUMBERING-SW.
  4599
  4600     MOVE PI-ALIGNMENT-SEQUENCE-NO  TO  CQ-SEQUENCE-NUMBER.
  4601     ADD +1  TO  PI-ALIGNMENT-SEQUENCE-NO.
  4602
  4603     MOVE SPACES                 TO  CHECK-PASS-AREA.
  4604
  4605     MOVE +1                     TO  CPA-ALIGNMENT.
  4606     MOVE CQ-CHECK-NUMBER        TO  CPA-CHECK-NUMBER.
  4607
  4608     PERFORM 0800-PRINT-CHECK.
  4609
  4610     IF AACNI = 'Y'
  4611         MOVE CHECK-QUE          TO  JP-RECORD-AREA
  4612
  4613* EXEC CICS WRITE
  4614*            DATASET (WS-CHECK-QUEUE-DSID)
  4615*            RIDFLD  (CQ-CONTROL-PRIMARY)
  4616*            FROM    (CHECK-QUE) END-EXEC
  4617     MOVE LENGTH OF
  4618      CHECK-QUE
  4619       TO DFHEIV11
  4620*    MOVE '&$ L                  ''   #00004317' TO DFHEIV0
  4621     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4622     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4623     MOVE X'2020233030303034333137' TO DFHEIV0(25:11)
  4624     CALL 'kxdfhei1' USING DFHEIV0,
  4625           WS-CHECK-QUEUE-DSID,
  4626           CHECK-QUE,
  4627           DFHEIV11,
  4628           CQ-CONTROL-PRIMARY,
  4629           DFHEIV99,
  4630           DFHEIV99
  4631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4632         PERFORM 8400-LOG-JOURNAL-RECORD.
  4633
  4634     SUBTRACT +1 FROM PI-NUMBER-OF-ALIGNMENT-CHECKS.
  4635
  4636     IF PI-NUMBER-OF-ALIGNMENT-CHECKS IS GREATER THAN ZERO
  4637         GO TO 0250-MAIN-LOGIC.
  4638
  4639     MOVE SPACES                 TO  AALIGNI.
  4640     MOVE AL-UNNOF               TO  AALIGNA.
  4641     MOVE -1                     TO  AALIGNL.
  4642     MOVE ER-0362                TO  EMI-ERROR.
  4643     PERFORM 8200-SEND-DATAONLY.
  4644
  4645
  4646* EXEC CICS SYNCPOINT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  96
* EL687.cbl
  4647*        END-EXEC.
  4648*    MOVE '6"                    !   #00004334' TO DFHEIV0
  4649     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  4650     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4651     MOVE X'2020233030303034333334' TO DFHEIV0(25:11)
  4652     CALL 'kxdfhei1' USING DFHEIV0
  4653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4654
  4655
  4656     GO TO 0040-MAIN-LOGIC.
  4657
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  97
* EL687.cbl
  4659 0300-MAIN-LOGIC.
  4660     IF PI-PRINTER-STARTED-SW = ZERO
  4661         MOVE +1                 TO  PI-PRINTER-STARTED-SW
  4662         MOVE EIBTRMID TO PI-TSK-TERM-ID
  4663         MOVE EIBTIME  TO PI-TSK-TIME
  4664
  4665         IF PI-COMPANY-ID = 'DMD' OR 'CID'
  4666*            MOVE EIBTRMID       TO PI-CHECK-PRINTER-ID
  4667
  4668* EXEC CICS START
  4669*                TRANSID (WS-CHECK-WRITER-TRANS-ID)
  4670*                FROM    (PROGRAM-INTERFACE-BLOCK)
  4671*                LENGTH  (PI-COMM-LENGTH)
  4672*                TERMID  (PI-CHECK-PRINTER-ID)
  4673*            END-EXEC
  4674*    MOVE '0( LF                 0   #00004348' TO DFHEIV0
  4675     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  4676     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  4677     MOVE X'2020233030303034333438' TO DFHEIV0(25:11)
  4678     CALL 'kxdfhei1' USING DFHEIV0,
  4679           DFHEIV99,
  4680           WS-CHECK-WRITER-TRANS-ID,
  4681           DFHEIV99,
  4682           PROGRAM-INTERFACE-BLOCK,
  4683           PI-COMM-LENGTH,
  4684           DFHEIV99,
  4685           DFHEIV99,
  4686           DFHEIV99,
  4687           DFHEIV99,
  4688           DFHEIV99,
  4689           DFHEIV99,
  4690           DFHEIV99,
  4691           DFHEIV99,
  4692           DFHEIV99,
  4693           DFHEIV99
  4694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4695         ELSE
  4696
  4697* EXEC CICS START
  4698*                TRANSID (WS-CHECK-WRITER-TRANS-ID)
  4699*                FROM    (PROGRAM-INTERFACE-BLOCK)
  4700*                LENGTH  (PI-COMM-LENGTH)
  4701*                TERMID  (PI-CHECK-PRINTER-ID)
  4702*            END-EXEC.
  4703*    MOVE '0( LFT                0   #00004355' TO DFHEIV0
  4704     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  4705     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  4706     MOVE X'2020233030303034333535' TO DFHEIV0(25:11)
  4707     CALL 'kxdfhei1' USING DFHEIV0,
  4708           DFHEIV99,
  4709           WS-CHECK-WRITER-TRANS-ID,
  4710           DFHEIV99,
  4711           PROGRAM-INTERFACE-BLOCK,
  4712           PI-COMM-LENGTH,
  4713           PI-CHECK-PRINTER-ID,
  4714           DFHEIV99,
  4715           DFHEIV99,
  4716           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  98
* EL687.cbl
  4717           DFHEIV99,
  4718           DFHEIV99,
  4719           DFHEIV99,
  4720           DFHEIV99,
  4721           DFHEIV99,
  4722           DFHEIV99
  4723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4724
  4725
  4726     SET PI-INDEX TO +1.
  4727
  4728     MOVE LOW-VALUES             TO  WS-CHECK-QUEUE-KEY.
  4729     MOVE +5                     TO  WS-KEY-LENGTH.
  4730
  4731     MOVE PI-COMPANY-CD          TO  WS-CQK-COMPANY-CD.
  4732
  4733 0310-MAIN-LOGIC.
  4734     IF AOPTIONI = '1'
  4735
  4736* EXEC CICS STARTBR
  4737*            DATASET (WS-CHECK-QUEUE-DSID)
  4738*            RIDFLD  (WS-CHECK-QUEUE-KEY)
  4739*            GTEQ    END-EXEC
  4740     MOVE 0
  4741       TO DFHEIV11
  4742*    MOVE '&,         G          &   #00004371' TO DFHEIV0
  4743     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4744     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4745     MOVE X'2020233030303034333731' TO DFHEIV0(25:11)
  4746     CALL 'kxdfhei1' USING DFHEIV0,
  4747           WS-CHECK-QUEUE-DSID,
  4748           WS-CHECK-QUEUE-KEY,
  4749           DFHEIV99,
  4750           DFHEIV11,
  4751           DFHEIV99
  4752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4753       ELSE
  4754         MOVE PI-CONTROL-GROUP (PI-INDEX) TO WS-CQK-CONTROL-NUMBER
  4755         ADD +1  PI-HIGH-SEQUENCE (PI-INDEX)
  4756             GIVING WS-SEQUENCE-NUMBER
  4757         MOVE ZERO               TO  WS-CQK-SEQUENCE-NUMBER
  4758         IF WS-CHECK-QUEUE-BROWSE-SW = ZERO
  4759
  4760* EXEC CICS STARTBR
  4761*                DATASET   (WS-CHECK-QUEUE-DSID)
  4762*                RIDFLD    (WS-CHECK-QUEUE-KEY)
  4763*                KEYLENGTH (WS-KEY-LENGTH)
  4764*                GENERIC   EQUAL END-EXEC
  4765     MOVE 0
  4766       TO DFHEIV11
  4767*    MOVE '&,   KG    E          &   #00004381' TO DFHEIV0
  4768     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
  4769     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4770     MOVE X'2020233030303034333831' TO DFHEIV0(25:11)
  4771     CALL 'kxdfhei1' USING DFHEIV0,
  4772           WS-CHECK-QUEUE-DSID,
  4773           WS-CHECK-QUEUE-KEY,
  4774           WS-KEY-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  99
* EL687.cbl
  4775           DFHEIV11,
  4776           DFHEIV99
  4777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4778             MOVE +1             TO  WS-CHECK-QUEUE-BROWSE-SW
  4779           ELSE
  4780
  4781* EXEC CICS RESETBR
  4782*                DATASET   (WS-CHECK-QUEUE-DSID)
  4783*                RIDFLD    (WS-CHECK-QUEUE-KEY)
  4784*                KEYLENGTH (WS-KEY-LENGTH)
  4785*                GENERIC   EQUAL END-EXEC.
  4786     MOVE 0
  4787       TO DFHEIV11
  4788*    MOVE '&4   KG    E          &   #00004388' TO DFHEIV0
  4789     MOVE X'26342020204B472020202045' TO DFHEIV0(1:12)
  4790     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4791     MOVE X'2020233030303034333838' TO DFHEIV0(25:11)
  4792     CALL 'kxdfhei1' USING DFHEIV0,
  4793           WS-CHECK-QUEUE-DSID,
  4794           WS-CHECK-QUEUE-KEY,
  4795           WS-KEY-LENGTH,
  4796           DFHEIV11,
  4797           DFHEIV99
  4798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4799
  4800
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 100
* EL687.cbl
  4802 0320-MAIN-LOGIC.
  4803
  4804* EXEC CICS HANDLE CONDITION
  4805*        NOTFND
  4806*        ENDFILE (0390-MAIN-LOGIC) END-EXEC.
  4807*    MOVE '"$''                  ! % #00004396' TO DFHEIV0
  4808     MOVE X'2224B9272020202020202020' TO DFHEIV0(1:12)
  4809     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4810     MOVE X'2520233030303034333936' TO DFHEIV0(25:11)
  4811     CALL 'kxdfhei1' USING DFHEIV0
  4812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4813
  4814
  4815 0325-MAIN-LOGIC.
  4816
  4817
  4818* EXEC CICS READNEXT
  4819*        DATASET (WS-CHECK-QUEUE-DSID)
  4820*        RIDFLD  (WS-CHECK-QUEUE-KEY)
  4821*        SET     (ADDRESS OF CHECK-QUE) END-EXEC.
  4822     MOVE 0
  4823       TO DFHEIV11
  4824*    MOVE '&.S                   )   #00004402' TO DFHEIV0
  4825     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4826     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4827     MOVE X'2020233030303034343032' TO DFHEIV0(25:11)
  4828     CALL 'kxdfhei1' USING DFHEIV0,
  4829           WS-CHECK-QUEUE-DSID,
  4830           DFHEIV20,
  4831           DFHEIV99,
  4832           WS-CHECK-QUEUE-KEY,
  4833           DFHEIV99,
  4834           DFHEIV11,
  4835           DFHEIV99,
  4836           DFHEIV99
  4837     SET ADDRESS OF CHECK-QUE TO
  4838         DFHEIV20
  4839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4840
  4841
  4842     IF WS-CHECK-QUEUE-KEY NOT GREATER WS-LAST-CHECK-QUEUE-KEY
  4843         GO TO 0325-MAIN-LOGIC.
  4844
  4845     MOVE WS-CHECK-QUEUE-KEY    TO WS-LAST-CHECK-QUEUE-KEY.
  4846
  4847     IF CQ-COMPANY-CD NOT = PI-COMPANY-CD
  4848         GO TO 0390-MAIN-LOGIC.
  4849
  4850     IF AOPTIONI = ('2' OR '3')
  4851         IF CQ-CONTROL-NUMBER = PI-CONTROL-GROUP (PI-INDEX)
  4852          AND CQ-SEQUENCE-NUMBER NOT GREATER THAN PI-HIGH-SEQUENCE
  4853                                                       (PI-INDEX)
  4854             NEXT SENTENCE
  4855           ELSE
  4856             GO TO 0390-MAIN-LOGIC.
  4857
  4858     IF CQ-ENTRY-TYPE NOT = 'Q'
  4859         GO TO 0325-MAIN-LOGIC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 101
* EL687.cbl
  4860
  4861     IF (AOPTIONI NOT = '3' AND
  4862         CQ-TIMES-PRINTED GREATER THAN ZERO)
  4863       OR
  4864        (AOPTIONI = '3' AND
  4865         CQ-TIMES-PRINTED NOT GREATER THAN ZERO)
  4866             GO TO 0325-MAIN-LOGIC.
  4867
  4868
  4869* EXEC CICS ENDBR
  4870*        DATASET (WS-CHECK-QUEUE-DSID) END-EXEC.
  4871     MOVE 0
  4872       TO DFHEIV11
  4873*    MOVE '&2                    $   #00004433' TO DFHEIV0
  4874     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4875     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4876     MOVE X'2020233030303034343333' TO DFHEIV0(25:11)
  4877     CALL 'kxdfhei1' USING DFHEIV0,
  4878           WS-CHECK-QUEUE-DSID,
  4879           DFHEIV11,
  4880           DFHEIV99
  4881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4882
  4883
  4884
  4885* EXEC CICS READ UPDATE
  4886*        DATASET (WS-CHECK-QUEUE-DSID)
  4887*        RIDFLD  (WS-CHECK-QUEUE-KEY)
  4888*        SET     (ADDRESS OF CHECK-QUE) END-EXEC.
  4889*    MOVE '&"S        EU         (   #00004436' TO DFHEIV0
  4890     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4891     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4892     MOVE X'2020233030303034343336' TO DFHEIV0(25:11)
  4893     CALL 'kxdfhei1' USING DFHEIV0,
  4894           WS-CHECK-QUEUE-DSID,
  4895           DFHEIV20,
  4896           DFHEIV99,
  4897           WS-CHECK-QUEUE-KEY,
  4898           DFHEIV99,
  4899           DFHEIV99,
  4900           DFHEIV99
  4901     SET ADDRESS OF CHECK-QUE TO
  4902         DFHEIV20
  4903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4904
  4905
  4906     MOVE CHECK-QUE              TO  WS-OLD-CHECK-QUEUE-RECORD.
  4907
  4908     IF AACNI = 'Y'
  4909         MOVE WS-CHECK-NUMBER-X  TO  CQ-CHECK-NUMBER
  4910         ADD +1  TO  WS-CHECK-NUMBER
  4911         MOVE '1'                TO  CQ-PRE-NUMBERING-SW.
  4912
  4913*    NOTE *******************************************************
  4914*         *                PRINT THE CHECK                      *
  4915*         *******************************************************.
  4916
  4917     IF CQ-CHECK-MAINT-PMT OR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 102
* EL687.cbl
  4918        CQ-REFUND-PMT
  4919         GO TO 0350-MAIN-LOGIC.
  4920
  4921*    NOTE *******************************************************
  4922*         *                PRINT BILLING CHECKS                 *
  4923*         *******************************************************.
  4924
  4925     MOVE SPACES                 TO  CHECK-PASS-AREA.
  4926     MOVE LOW-VALUES             TO  WS-COMPENSATION-MASTER-KEY
  4927                                     WS-PENDING-PAYMENTS-KEY.
  4928     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD
  4929                                     WS-PPK-COMPANY-CD.
  4930     MOVE CQ-PYAJ-CARRIER        TO  WS-CM-CARRIER
  4931                                     CPA-CARRIER
  4932                                     WS-PPK-CARRIER.
  4933     MOVE CQ-PYAJ-GROUPING       TO  WS-CM-GROUPING
  4934                                     CPA-GROUPING
  4935                                     WS-PPK-GROUPING.
  4936     MOVE CQ-PYAJ-FIN-RESP       TO  WS-CM-FIN-RESP
  4937                                     CPA-FIN-RESP
  4938                                     WS-PPK-FIN-RESP.
  4939     MOVE CQ-PYAJ-ACCOUNT        TO  WS-CM-ACCOUNT
  4940                                     CPA-ACCOUNT
  4941                                     WS-PPK-ACCOUNT.
  4942     MOVE CQ-PYAJ-SEQ            TO  WS-PPK-FILE-SEQ-NO.
  4943     MOVE 'C'                    TO  WS-PPK-RECORD-TYPE.
  4944
  4945     IF CQ-PYAJ-ACCOUNT NOT = LOW-VALUES
  4946        MOVE 'A'                 TO  WS-CM-TYPE
  4947     ELSE
  4948        MOVE 'G'                 TO  WS-CM-TYPE.
  4949
  4950
  4951* EXEC CICS READ
  4952*        DATASET (WS-COMPENSATION-MASTER-DSID)
  4953*        RIDFLD  (WS-COMPENSATION-MASTER-KEY)
  4954*        SET     (ADDRESS OF COMPENSATION-MASTER) END-EXEC.
  4955*    MOVE '&"S        E          (   #00004485' TO DFHEIV0
  4956     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4957     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4958     MOVE X'2020233030303034343835' TO DFHEIV0(25:11)
  4959     CALL 'kxdfhei1' USING DFHEIV0,
  4960           WS-COMPENSATION-MASTER-DSID,
  4961           DFHEIV20,
  4962           DFHEIV99,
  4963           WS-COMPENSATION-MASTER-KEY,
  4964           DFHEIV99,
  4965           DFHEIV99,
  4966           DFHEIV99
  4967     SET ADDRESS OF COMPENSATION-MASTER TO
  4968         DFHEIV20
  4969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4970
  4971
  4972
  4973* EXEC CICS READ UPDATE
  4974*        DATASET (WS-PENDING-PAYMENTS-DSID)
  4975*        RIDFLD  (WS-PENDING-PAYMENTS-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 103
* EL687.cbl
  4976*        SET     (ADDRESS OF PENDING-PAY-ADJ) END-EXEC.
  4977*    MOVE '&"S        EU         (   #00004490' TO DFHEIV0
  4978     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4979     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4980     MOVE X'2020233030303034343930' TO DFHEIV0(25:11)
  4981     CALL 'kxdfhei1' USING DFHEIV0,
  4982           WS-PENDING-PAYMENTS-DSID,
  4983           DFHEIV20,
  4984           DFHEIV99,
  4985           WS-PENDING-PAYMENTS-KEY,
  4986           DFHEIV99,
  4987           DFHEIV99,
  4988           DFHEIV99
  4989     SET ADDRESS OF PENDING-PAY-ADJ TO
  4990         DFHEIV20
  4991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4992
  4993
  4994     MOVE ZERO                   TO  CPA-ALIGNMENT.
  4995     MOVE SPACES                 TO  CPA-CERT-NO.
  4996     MOVE ZEROS                  TO  WS-CHECK-NO.
  4997     MOVE CQ-PAYMENT-TYPE        TO  CPA-PAYMENT-TYPE.
  4998     MOVE CQ-CHECK-BY-USER       TO  CPA-PAYMENT-BY.
  4999     MOVE CQ-CHECK-NUMBER        TO  CPA-CHECK-NUMBER
  5000                                     WS-CHECK-NO.
  5001     MOVE WS-CHECK-WORK          TO  PY-CHECK-NUMBER.
  5002     MOVE CQ-CHECK-AMOUNT        TO  CPA-AMOUNT-PAID.
  5003     MOVE ZEROS                  TO  CPA-AMOUNT-PAID-TO-DATE
  5004                                     CPA-NO-OF-PMTS-MADE
  5005                                     CPA-LF-REFUND
  5006                                     CPA-AH-REFUND
  5007                                     CPA-DEDUCT-WITHHELD
  5008                                     CPA-ADDITIONAL-CHARGE.
  5009     MOVE PY-REPORTED-DT         TO  CPA-REPORTED-DT.
  5010     MOVE LOW-VALUES             TO  CPA-INCURRED-DT
  5011                                     CPA-PAID-THRU-DT
  5012                                     CPA-PAID-FROM-DT
  5013                                     CPA-PAID-DT
  5014                                     CPA-CERT-EFF-DT.
  5015     MOVE ZEROS                  TO  CPA-CAR-ZIP-CODE.
  5016     MOVE CO-MAIL-NAME           TO  CPA-PAYEE-IN-CARE-OF.
  5017     MOVE CO-ACCT-NAME           TO  CPA-PAYEE-NAME.
  5018     MOVE CO-ADDR-1              TO  CPA-PAYEE-ADDRESS-LINE1.
  5019     MOVE CO-ADDR-2              TO  CPA-PAYEE-ADDRESS-LINE2.
  5020*    MOVE CO-ADDR-3              TO  CPA-PAYEE-CITY-ST.
  5021     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  5022        DELIMITED BY '  ' INTO CPA-PAYEE-CITY-ST
  5023     END-STRING
  5024     MOVE CO-TELEPHONE           TO  CPA-PAYEE-PHONE-NO.
  5025     MOVE CO-ZIP                 TO  CPA-PAYEE-ZIP-CODE.
  5026
  5027     IF NOT CO-CANADIAN-POST-CODE
  5028         INSPECT CPA-PAYEE-ZIP-CODE REPLACING ALL ' ' BY ZEROS
  5029         IF CPA-PAYEE-ZIP-PRIME NUMERIC
  5030             MOVE SPACES         TO CPA-PAYEE-ZIP-PLUS4
  5031         ELSE
  5032             MOVE ZEROS          TO CPA-PAYEE-ZIP-CODE.
  5033
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 104
* EL687.cbl
  5034     MOVE SPACES                 TO  WS-SSN-STATE
  5035                                     WS-MEMBER-STATE
  5036                                     CPA-MEMBER-NUMBER
  5037                                     WS-SSN-LN3
  5038                                     WS-MEMBER-LN4.
  5039     MOVE CO-ACCT-PRIME          TO  WS-SSN-ACCOUNT
  5040                                     WS-MEMBER-ACCOUNT.
  5041     MOVE CO-SOC-SEC             TO  CPA-SOC-SEC-NO.
  5042     MOVE WS-CURRENT-DATE        TO  CPA-CHECK-DATE
  5043                                     CQ-CHECK-WRITTEN-DT
  5044                                     PY-CHECK-WRITTEN-DT.
  5045
  5046     IF  PY-LETTER (1) GREATER THAN SPACES
  5047         MOVE 'Y'                TO  PI-LETTERS-IND
  5048
  5049     ELSE
  5050         MOVE LOW-VALUES         TO  PI-LETTERS-IND.
  5051
  5052     IF PI-COMPANY-ID = 'ITY'
  5053         MOVE PY-ENTRY-COMMENT   TO  CPA-STUB5.
  5054
  5055     IF AOPTIONI = '3'
  5056       AND CQ-PRE-NUMBERING-SW = '1'
  5057         MOVE WS-SEQUENCE-NUMBER TO  PY-CHECK-QUE-SEQUENCE.
  5058
  5059     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  5060
  5061     MOVE +6870                  TO  CQ-LAST-UPDATED-BY.
  5062
  5063
  5064* EXEC CICS REWRITE
  5065*        DATASET (WS-PENDING-PAYMENTS-DSID)
  5066*        FROM    (PENDING-PAY-ADJ)  END-EXEC.
  5067     MOVE LENGTH OF
  5068      PENDING-PAY-ADJ
  5069       TO DFHEIV11
  5070*    MOVE '&& L                  %   #00004564' TO DFHEIV0
  5071     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5072     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5073     MOVE X'2020233030303034353634' TO DFHEIV0(25:11)
  5074     CALL 'kxdfhei1' USING DFHEIV0,
  5075           WS-PENDING-PAYMENTS-DSID,
  5076           PENDING-PAY-ADJ,
  5077           DFHEIV11,
  5078           DFHEIV99
  5079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5080
  5081
  5082     MOVE WS-PENDING-PAYMENTS-DSID TO  JP-FILE-ID.
  5083     MOVE 'C'                      TO  JP-RECORD-TYPE.
  5084     PERFORM 8400-LOG-JOURNAL-RECORD.
  5085
  5086     GO TO 0375-MAIN-LOGIC.
  5087
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 105
* EL687.cbl
  5089 0350-MAIN-LOGIC.
  5090*    NOTE *******************************************************
  5091*         *         PRINT REFUND OR MISCELLANEOUS CHECKS        *
  5092*         *******************************************************.
  5093
  5094     MOVE SPACES                 TO  CHECK-PASS-AREA.
  5095     MOVE ZERO                   TO  CPA-ALIGNMENT.
  5096     MOVE LOW-VALUES             TO  WS-CHECK-MAINT-KEY.
  5097     MOVE PI-COMPANY-CD          TO  WS-CMK-COMPANY-CD.
  5098     MOVE CQ-CHEK-CARRIER        TO  WS-CMK-CARRIER
  5099                                     CPA-CARRIER.
  5100     MOVE CQ-CHEK-GROUPING       TO  WS-CMK-GROUPING
  5101                                     CPA-GROUPING.
  5102     MOVE CQ-CHEK-STATE          TO  WS-CMK-STATE
  5103                                     CPA-STATE.
  5104     MOVE CQ-CHEK-ACCOUNT        TO  WS-CMK-ACCOUNT
  5105                                     CPA-ACCOUNT.
  5106     MOVE CQ-CHEK-CERT-NO        TO  WS-CMK-CERT-NO
  5107                                     CPA-CERT-NO.
  5108     MOVE CQ-CHEK-CERT-EFF-DT    TO  WS-CMK-CERT-EFF-DT.
  5109     MOVE CQ-CHEK-SEQ-NO         TO  WS-CMK-SEQ-NO.
  5110
  5111
  5112* EXEC CICS READ UPDATE
  5113*        DATASET (WS-CHECK-MAINT-DSID)
  5114*        RIDFLD  (WS-CHECK-MAINT-KEY)
  5115*        SET     (ADDRESS OF CHECK-RECORDS) END-EXEC.
  5116*    MOVE '&"S        EU         (   #00004597' TO DFHEIV0
  5117     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5118     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5119     MOVE X'2020233030303034353937' TO DFHEIV0(25:11)
  5120     CALL 'kxdfhei1' USING DFHEIV0,
  5121           WS-CHECK-MAINT-DSID,
  5122           DFHEIV20,
  5123           DFHEIV99,
  5124           WS-CHECK-MAINT-KEY,
  5125           DFHEIV99,
  5126           DFHEIV99,
  5127           DFHEIV99
  5128     SET ADDRESS OF CHECK-RECORDS TO
  5129         DFHEIV20
  5130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5131
  5132
  5133     IF CH-LF-REFUND NOT NUMERIC
  5134         MOVE ZEROS              TO  CH-LF-REFUND.
  5135     IF CH-AH-REFUND NOT NUMERIC
  5136         MOVE ZEROS              TO  CH-AH-REFUND.
  5137     IF CH-DEDUCT-WITHHELD NOT NUMERIC
  5138         MOVE ZEROS              TO  CH-DEDUCT-WITHHELD.
  5139     IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  5140         MOVE ZEROS              TO  CH-ADDITIONAL-CHARGE.
  5141
  5142     MOVE ZERO                   TO  CPA-ALIGNMENT.
  5143     MOVE CQ-PAYMENT-TYPE        TO  CPA-PAYMENT-TYPE.
  5144     MOVE CQ-CHECK-BY-USER       TO  CPA-PAYMENT-BY.
  5145     MOVE CQ-CHECK-NUMBER        TO  CPA-CHECK-NUMBER
  5146                                     CH-CHECK-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 106
* EL687.cbl
  5147     MOVE CQ-CHECK-AMOUNT        TO  CPA-AMOUNT-PAID.
  5148     MOVE ZEROS                  TO  CPA-AMOUNT-PAID-TO-DATE
  5149                                     CPA-NO-OF-PMTS-MADE.
  5150     MOVE CH-RECORDED-DT         TO  CPA-REPORTED-DT.
  5151     MOVE LOW-VALUES             TO  CPA-INCURRED-DT
  5152                                     CPA-PAID-THRU-DT
  5153                                     CPA-PAID-FROM-DT
  5154                                     CPA-PAID-DT.
  5155     MOVE ZEROS                  TO  CPA-CAR-ZIP-CODE.
  5156     MOVE CH-PAYEE-NAME-1        TO  CPA-PAYEE-NAME.
  5157     MOVE CH-PAYEE-NAME-2        TO  CPA-PAYEE-IN-CARE-OF.
  5158     MOVE CH-PAYEE-ADDRESS-1     TO  CPA-PAYEE-ADDRESS-LINE1.
  5159
  5160     IF CH-PAYEE-CITY-ST EQUAL SPACES
  5161         MOVE CH-PAYEE-ADDRESS-2
  5162                                 TO  CPA-PAYEE-CITY-ST
  5163         MOVE SPACES             TO  CPA-PAYEE-ADDRESS-LINE2
  5164     ELSE
  5165         MOVE CH-PAYEE-ADDRESS-2
  5166                                 TO  CPA-PAYEE-ADDRESS-LINE2
  5167         MOVE CH-PAYEE-CITY-ST   TO  CPA-PAYEE-CITY-ST.
  5168
  5169     MOVE CH-STUB-LINE-1         TO  CPA-STUB1.
  5170     MOVE CH-STUB-LINE-2         TO  CPA-STUB2.
  5171     MOVE CH-STUB-LINE-3         TO  CPA-STUB3.
  5172     MOVE CH-STUB-LINE-4         TO  CPA-STUB4.
  5173     MOVE CH-PAYEE-ZIP-CODE      TO  CPA-PAYEE-ZIP-CODE.
  5174
  5175     IF CQ-REFUND-PMT
  5176         MOVE CH-CANC-DT         TO  CPA-CANC-DT
  5177         MOVE CH-CERT-EFF-DT     TO  CPA-CERT-EFF-DT
  5178         MOVE CH-INSURED-NAME    TO  CPA-INSURED-NAME
  5179     ELSE
  5180         MOVE LOW-VALUES         TO  CPA-CANC-DT
  5181                                     CPA-CERT-EFF-DT
  5182         MOVE SPACES             TO  CPA-INSURED-NAME.
  5183
  5184     MOVE CH-LF-REFUND           TO  CPA-LF-REFUND.
  5185     MOVE CH-AH-REFUND           TO  CPA-AH-REFUND.
  5186     MOVE CH-DEDUCT-WITHHELD     TO  CPA-DEDUCT-WITHHELD.
  5187     MOVE CH-ADDITIONAL-CHARGE   TO  CPA-ADDITIONAL-CHARGE.
  5188
  5189     MOVE SPACES                 TO  WS-SSN-STATE
  5190                                     WS-MEMBER-STATE
  5191                                     CPA-MEMBER-NUMBER
  5192                                     WS-SSN-LN3
  5193                                     WS-MEMBER-LN4.
  5194     MOVE CO-ACCT-PRIME          TO  WS-SSN-ACCOUNT
  5195                                     WS-MEMBER-ACCOUNT.
  5196     MOVE CO-SOC-SEC             TO  CPA-SOC-SEC-NO.
  5197     MOVE WS-CURRENT-DATE        TO  CPA-CHECK-DATE
  5198                                     CQ-CHECK-WRITTEN-DT
  5199                                     CH-CHECK-WRITTEN-DT.
  5200     IF AOPTIONI = '3'
  5201       AND CQ-PRE-NUMBERING-SW = '1'
  5202         MOVE WS-SEQUENCE-NUMBER TO  CH-CHECK-QUE-SEQUENCE.
  5203
  5204     MOVE CHECK-RECORDS          TO  JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 107
* EL687.cbl
  5205
  5206     IF  CH-LETTERS (1) GREATER THAN SPACES
  5207         MOVE 'Y'                TO  PI-LETTERS-IND
  5208
  5209     ELSE
  5210         MOVE LOW-VALUES         TO  PI-LETTERS-IND.
  5211
  5212     MOVE +6870                  TO  CQ-LAST-UPDATED-BY.
  5213
  5214
  5215* EXEC CICS REWRITE
  5216*        DATASET (WS-CHECK-MAINT-DSID)
  5217*        FROM    (CHECK-RECORDS)  END-EXEC.
  5218     MOVE LENGTH OF
  5219      CHECK-RECORDS
  5220       TO DFHEIV11
  5221*    MOVE '&& L                  %   #00004683' TO DFHEIV0
  5222     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5223     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5224     MOVE X'2020233030303034363833' TO DFHEIV0(25:11)
  5225     CALL 'kxdfhei1' USING DFHEIV0,
  5226           WS-CHECK-MAINT-DSID,
  5227           CHECK-RECORDS,
  5228           DFHEIV11,
  5229           DFHEIV99
  5230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5231
  5232
  5233     MOVE WS-CHECK-MAINT-DSID    TO  JP-FILE-ID.
  5234     MOVE 'C'                    TO  JP-RECORD-TYPE.
  5235     PERFORM 8400-LOG-JOURNAL-RECORD.
  5236
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 108
* EL687.cbl
  5238
  5239 0375-MAIN-LOGIC.
  5240     ADD +1  TO  CQ-TIMES-PRINTED.
  5241
  5242     IF AOPTIONI = '3'
  5243       AND CQ-PRE-NUMBERING-SW = '1'
  5244         MOVE CHECK-QUE          TO  WS-NEW-CHECK-QUEUE-RECORD
  5245         MOVE WS-OLD-CHECK-QUEUE-RECORD  TO  CHECK-QUE
  5246         MOVE 'S'                TO  CQ-ENTRY-TYPE.
  5247
  5248     MOVE +6870                  TO  CQ-LAST-UPDATED-BY.
  5249
  5250     MOVE 'C'                    TO  JP-RECORD-TYPE.
  5251     MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  5252     MOVE WS-CHECK-QUEUE-DSID    TO  JP-FILE-ID.
  5253     MOVE PI-LETTERS-IND         TO  CQ-LETTERS-IND.
  5254
  5255
  5256* EXEC CICS REWRITE
  5257*        DATASET (WS-CHECK-QUEUE-DSID)
  5258*        FROM    (CHECK-QUE) END-EXEC.
  5259     MOVE LENGTH OF
  5260      CHECK-QUE
  5261       TO DFHEIV11
  5262*    MOVE '&& L                  %   #00004709' TO DFHEIV0
  5263     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5264     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5265     MOVE X'2020233030303034373039' TO DFHEIV0(25:11)
  5266     CALL 'kxdfhei1' USING DFHEIV0,
  5267           WS-CHECK-QUEUE-DSID,
  5268           CHECK-QUE,
  5269           DFHEIV11,
  5270           DFHEIV99
  5271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5272
  5273
  5274     PERFORM 8400-LOG-JOURNAL-RECORD.
  5275
  5276     IF AOPTIONI NOT = '3'
  5277         GO TO 0380-MAIN-LOGIC.
  5278
  5279     IF LCP-ONCTR-01 =  0
  5280         ADD 1 TO LCP-ONCTR-01
  5281                              ,
  5282
  5283* EXEC CICS GETMAIN
  5284*            SET    (WS-CQFCBAR)
  5285*            LENGTH  (WS-ERCHKQ-LENGTH)
  5286*            END-EXEC.
  5287*    MOVE '," L                  $   #00004721' TO DFHEIV0
  5288     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  5289     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5290     MOVE X'2020233030303034373231' TO DFHEIV0(25:11)
  5291     CALL 'kxdfhei1' USING DFHEIV0,
  5292           WS-CQFCBAR,
  5293           WS-ERCHKQ-LENGTH,
  5294           DFHEIV99
  5295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 109
* EL687.cbl
  5296
  5297
  5298     MOVE WS-CQFCBAR             TO LCP-WS-ADDR-COMP
  5299     SET ADDRESS OF CHECK-QUE TO LCP-WS-ADDR-PNTR.
  5300
  5301     MOVE WS-NEW-CHECK-QUEUE-RECORD  TO  CHECK-QUE.
  5302
  5303     IF CQ-PRE-NUMBERING-SW NOT = '1'
  5304         GO TO 0380-MAIN-LOGIC.
  5305
  5306     MOVE 'Q'                    TO  CQ-ENTRY-TYPE.
  5307     MOVE PI-LETTERS-IND         TO  CQ-LETTERS-IND.
  5308
  5309     MOVE WS-SEQUENCE-NUMBER     TO  CQ-SEQUENCE-NUMBER.
  5310
  5311     ADD +1  TO  WS-SEQUENCE-NUMBER.
  5312
  5313     MOVE +6870                  TO  CQ-LAST-UPDATED-BY.
  5314
  5315     MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  5316
  5317
  5318* EXEC CICS WRITE
  5319*        DATASET (WS-CHECK-QUEUE-DSID)
  5320*        RIDFLD  (CQ-CONTROL-PRIMARY)
  5321*        FROM    (CHECK-QUE) END-EXEC.
  5322     MOVE LENGTH OF
  5323      CHECK-QUE
  5324       TO DFHEIV11
  5325*    MOVE '&$ L                  ''   #00004745' TO DFHEIV0
  5326     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5327     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5328     MOVE X'2020233030303034373435' TO DFHEIV0(25:11)
  5329     CALL 'kxdfhei1' USING DFHEIV0,
  5330           WS-CHECK-QUEUE-DSID,
  5331           CHECK-QUE,
  5332           DFHEIV11,
  5333           CQ-CONTROL-PRIMARY,
  5334           DFHEIV99,
  5335           DFHEIV99
  5336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5337
  5338
  5339     MOVE 'A'                    TO  JP-RECORD-TYPE.
  5340     PERFORM 8400-LOG-JOURNAL-RECORD.
  5341
  5342 0380-MAIN-LOGIC.
  5343     PERFORM 0800-PRINT-CHECK.
  5344
  5345
  5346* EXEC CICS STARTBR
  5347*        DATASET (WS-CHECK-QUEUE-DSID)
  5348*        RIDFLD  (WS-CHECK-QUEUE-KEY)
  5349*        EQUAL   END-EXEC.
  5350     MOVE 0
  5351       TO DFHEIV11
  5352*    MOVE '&,         E          &   #00004756' TO DFHEIV0
  5353     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 110
* EL687.cbl
  5354     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5355     MOVE X'2020233030303034373536' TO DFHEIV0(25:11)
  5356     CALL 'kxdfhei1' USING DFHEIV0,
  5357           WS-CHECK-QUEUE-DSID,
  5358           WS-CHECK-QUEUE-KEY,
  5359           DFHEIV99,
  5360           DFHEIV11,
  5361           DFHEIV99
  5362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5363
  5364
  5365     GO TO 0320-MAIN-LOGIC.
  5366
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 111
* EL687.cbl
  5368 0390-MAIN-LOGIC.
  5369     IF AOPTIONI NOT = '1'
  5370       AND PI-INDEX LESS THAN PI-NUMBER-OF-CONTROL-GROUPS
  5371         SET PI-INDEX UP BY +1
  5372         MOVE LOW-VALUES         TO WS-LAST-CHECK-QUEUE-KEY
  5373         GO TO 0310-MAIN-LOGIC.
  5374
  5375
  5376* EXEC CICS ENDBR
  5377*        DATASET (WS-CHECK-QUEUE-DSID) END-EXEC.
  5378     MOVE 0
  5379       TO DFHEIV11
  5380*    MOVE '&2                    $   #00004771' TO DFHEIV0
  5381     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5382     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5383     MOVE X'2020233030303034373731' TO DFHEIV0(25:11)
  5384     CALL 'kxdfhei1' USING DFHEIV0,
  5385           WS-CHECK-QUEUE-DSID,
  5386           DFHEIV11,
  5387           DFHEIV99
  5388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5389
  5390
  5391     IF PI-CHECK-PRINTER-ID NOT = 'R2T7'
  5392         PERFORM 0700-END-PRINT.
  5393
  5394     MOVE PI-PRINTER-STARTED-SW  TO  WS-PRINTER-STARTED-SW.
  5395     MOVE PI-TEMP-STORAGE-KEY    TO  WS-TEMP-STORAGE-KEY.
  5396     ADD +1  TO  WS-COMPLETED-SUCCESSFUL.
  5397     GO TO 0015-MAIN-LOGIC.
  5398
  5399 0700-END-PRINT SECTION.
  5400     MOVE HIGH-VALUES            TO  CHECK-PASS-AREA.
  5401     MOVE +1                     TO  WS-TS-LENGTH.
  5402
  5403     PERFORM 0800-PRINT-CHECK.
  5404
  5405     MOVE ZERO                   TO  PI-PRINTER-STARTED-SW.
  5406
  5407 0700-EXIT.
  5408     EXIT.
  5409
  5410 0800-PRINT-CHECK SECTION.
  5411
  5412* EXEC CICS WRITEQ TS
  5413*         QUEUE  (PI-TEMP-STORAGE-KEY)
  5414*         ITEM   (WS-TEMP-STORAGE-ITEM)
  5415*         FROM   (CHECK-PASS-AREA)
  5416*         LENGTH (WS-TS-LENGTH) END-EXEC.
  5417*    MOVE '*" I                  ''   #00004794' TO DFHEIV0
  5418     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  5419     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5420     MOVE X'2020233030303034373934' TO DFHEIV0(25:11)
  5421     CALL 'kxdfhei1' USING DFHEIV0,
  5422           PI-TEMP-STORAGE-KEY,
  5423           CHECK-PASS-AREA,
  5424           WS-TS-LENGTH,
  5425           WS-TEMP-STORAGE-ITEM,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 112
* EL687.cbl
  5426           DFHEIV99,
  5427           DFHEIV99
  5428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5429
  5430
  5431 0800-EXIT.
  5432     EXIT.
  5433
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 113
* EL687.cbl
  5435 0900-TERMIDERR SECTION.
  5436
  5437
  5438* EXEC CICS SYNCPOINT
  5439*        ROLLBACK END-EXEC.
  5440*    MOVE '6"R                   !   #00004806' TO DFHEIV0
  5441     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  5442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5443     MOVE X'2020233030303034383036' TO DFHEIV0(25:11)
  5444     CALL 'kxdfhei1' USING DFHEIV0
  5445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5446
  5447
  5448     MOVE ER-0371                TO  EMI-ERROR.
  5449     MOVE -1                     TO  APFKL.
  5450     PERFORM 8200-SEND-DATAONLY.
  5451     PERFORM 9100-RETURN-TRAN.
  5452
  5453 0910-ENQ-BUSY.
  5454     MOVE ER-0395                TO  EMI-ERROR.
  5455     MOVE -1                     TO  AOPTIONL.
  5456     PERFORM 8200-SEND-DATAONLY.
  5457     PERFORM 9100-RETURN-TRAN.
  5458
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 114
* EL687.cbl
  5460*5000-MOVE-NAME SECTION. COPY ELCMNS.
  5461
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 115
* EL687.cbl
  5463 8100-SEND-INITIAL-MAP SECTION.
  5464
  5465     IF EMI-ERROR NOT = ZERO
  5466         PERFORM 9900-ERROR-FORMAT
  5467       ELSE
  5468         IF TRANSACTION-SUCCESSFUL
  5469             PERFORM 9900-ERROR-FORMAT
  5470             IF CHECKS-WITHOUT-ADDRESSES
  5471                 MOVE ER-0364    TO  EMI-ERROR
  5472                 PERFORM 9900-ERROR-FORMAT.
  5473
  5474     MOVE EIBTIME                TO  WS-TIME-WORK.
  5475
  5476* EXEC CICS ASKTIME ABSTIME(LCP-CICS-DATE)
  5477*    END-EXEC
  5478*    MOVE '0"A                   "   #00004836' TO DFHEIV0
  5479     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
  5480     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  5481     MOVE X'2020233030303034383336' TO DFHEIV0(25:11)
  5482     CALL 'kxdfhei1' USING DFHEIV0,
  5483           LCP-CICS-DATE
  5484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5485
  5486* EXEC CICS FORMATTIME
  5487*              ABSTIME(LCP-CICS-DATE)
  5488*              YYMMDD(LCP-CURRENT-DATE-68)
  5489*              DATESEP('/')
  5490*    END-EXEC
  5491     MOVE '/' TO DFHEIV9
  5492*    MOVE 'j$((   "              $   #00004838' TO DFHEIV0
  5493     MOVE X'6A2428282020202220202020' TO DFHEIV0(1:12)
  5494     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5495     MOVE X'2020233030303034383338' TO DFHEIV0(25:11)
  5496     CALL 'kxdfhei1' USING DFHEIV0,
  5497           LCP-CICS-DATE,
  5498           LCP-CURRENT-DATE-68,
  5499           DFHEIV9
  5500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5501
  5502     MOVE LCP-CURRENT-DATE-68 TO ADATEO.
  5503     MOVE WS-TIME                TO  ATIMEO.
  5504     MOVE EMI-MESSAGE-AREA (1)   TO  AEMSG1O.
  5505     MOVE EMI-MESSAGE-AREA (2)   TO  AEMSG2O.
  5506     MOVE EMI-MESSAGE-AREA (3)   TO  AEMSG3O.
  5507
  5508
  5509* EXEC CICS SEND
  5510*        FROM   (EL687AI)
  5511*        MAPSET (WS-MAPSET-NAME)
  5512*        MAP    (WS-MAP-NAME)
  5513*        CURSOR ERASE END-EXEC.
  5514     MOVE LENGTH OF
  5515      EL687AI
  5516       TO DFHEIV12
  5517     MOVE -1
  5518       TO DFHEIV11
  5519*    MOVE '8$     CT  E    H L F ,   #00004850' TO DFHEIV0
  5520     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 116
* EL687.cbl
  5521     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5522     MOVE X'2020233030303034383530' TO DFHEIV0(25:11)
  5523     CALL 'kxdfhei1' USING DFHEIV0,
  5524           WS-MAP-NAME,
  5525           EL687AI,
  5526           DFHEIV12,
  5527           WS-MAPSET-NAME,
  5528           DFHEIV99,
  5529           DFHEIV99,
  5530           DFHEIV99,
  5531           DFHEIV11,
  5532           DFHEIV99,
  5533           DFHEIV99,
  5534           DFHEIV99
  5535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5536
  5537
  5538     PERFORM 9100-RETURN-TRAN.
  5539
  5540 8100-EXIT.
  5541     EXIT.
  5542
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 117
* EL687.cbl
  5544 8200-SEND-DATAONLY SECTION.
  5545
  5546     IF EMI-ERROR NOT = 3130
  5547         PERFORM 9900-ERROR-FORMAT
  5548       ELSE
  5549         IF TRANSACTION-SUCCESSFUL
  5550             PERFORM 9900-ERROR-FORMAT
  5551             IF CHECKS-WITHOUT-ADDRESSES
  5552                 MOVE ER-0364    TO  EMI-ERROR
  5553                 PERFORM 9900-ERROR-FORMAT.
  5554
  5555     MOVE EIBTIME                TO  WS-TIME-WORK.
  5556
  5557* EXEC CICS ASKTIME ABSTIME(LCP-CICS-DATE)
  5558*    END-EXEC
  5559*    MOVE '0"A                   "   #00004874' TO DFHEIV0
  5560     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
  5561     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  5562     MOVE X'2020233030303034383734' TO DFHEIV0(25:11)
  5563     CALL 'kxdfhei1' USING DFHEIV0,
  5564           LCP-CICS-DATE
  5565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5566
  5567* EXEC CICS FORMATTIME
  5568*              ABSTIME(LCP-CICS-DATE)
  5569*              YYMMDD(LCP-CURRENT-DATE-68)
  5570*              DATESEP('/')
  5571*    END-EXEC
  5572     MOVE '/' TO DFHEIV9
  5573*    MOVE 'j$((   "              $   #00004876' TO DFHEIV0
  5574     MOVE X'6A2428282020202220202020' TO DFHEIV0(1:12)
  5575     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5576     MOVE X'2020233030303034383736' TO DFHEIV0(25:11)
  5577     CALL 'kxdfhei1' USING DFHEIV0,
  5578           LCP-CICS-DATE,
  5579           LCP-CURRENT-DATE-68,
  5580           DFHEIV9
  5581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5582
  5583     MOVE LCP-CURRENT-DATE-68 TO ADATEO.
  5584     MOVE WS-TIME                TO  ATIMEO.
  5585     MOVE EMI-MESSAGE-AREA (1)   TO  AEMSG1O.
  5586     MOVE EMI-MESSAGE-AREA (2)   TO  AEMSG2O.
  5587     MOVE EMI-MESSAGE-AREA (3)   TO  AEMSG3O.
  5588
  5589
  5590* EXEC CICS SEND DATAONLY
  5591*        FROM   (EL687AI)
  5592*        MAPSET (WS-MAPSET-NAME)
  5593*        MAP    (WS-MAP-NAME)
  5594*        CURSOR END-EXEC.
  5595     MOVE LENGTH OF
  5596      EL687AI
  5597       TO DFHEIV12
  5598     MOVE -1
  5599       TO DFHEIV11
  5600*    MOVE '8$D    CT       H L F ,   #00004888' TO DFHEIV0
  5601     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 118
* EL687.cbl
  5602     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5603     MOVE X'2020233030303034383838' TO DFHEIV0(25:11)
  5604     CALL 'kxdfhei1' USING DFHEIV0,
  5605           WS-MAP-NAME,
  5606           EL687AI,
  5607           DFHEIV12,
  5608           WS-MAPSET-NAME,
  5609           DFHEIV99,
  5610           DFHEIV99,
  5611           DFHEIV99,
  5612           DFHEIV11,
  5613           DFHEIV99,
  5614           DFHEIV99,
  5615           DFHEIV99
  5616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5617
  5618
  5619     IF PI-PROCESSING-SW = ZERO
  5620         PERFORM 9100-RETURN-TRAN.
  5621
  5622     MOVE ZERO                   TO  EMI-SUB
  5623                                     EMI-NOTE-CTR
  5624                                     EMI-WARNING-CTR
  5625                                     EMI-FORCABLE-CTR
  5626                                     EMI-FATAL-CTR.
  5627
  5628     MOVE '1'                    TO  EMI-SWITCH-AREA-1
  5629                                     EMI-SWITCH-AREA-2.
  5630
  5631     MOVE SPACES                 TO  EMI-ERROR-LINES.
  5632
  5633 8200-EXIT.
  5634     EXIT.
  5635
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 119
* EL687.cbl
  5637 8300-SEND-TEXT SECTION.
  5638
  5639     IF PI-PRINTER-STARTED-SW NOT = ZERO
  5640         PERFORM 0700-END-PRINT.
  5641
  5642
  5643* EXEC CICS SEND TEXT
  5644*        FROM   (LOGOFF-TEXT)
  5645*        LENGTH (LOGOFF-LENGTH)
  5646*        ERASE  FREEKB END-EXEC.
  5647*    MOVE '8&      T  E F  H   F -   #00004917' TO DFHEIV0
  5648     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5649     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5650     MOVE X'2020233030303034393137' TO DFHEIV0(25:11)
  5651     CALL 'kxdfhei1' USING DFHEIV0,
  5652           LOGOFF-TEXT,
  5653           LOGOFF-LENGTH,
  5654           DFHEIV99,
  5655           DFHEIV99,
  5656           DFHEIV99,
  5657           DFHEIV99,
  5658           DFHEIV99,
  5659           DFHEIV99,
  5660           DFHEIV99,
  5661           DFHEIV99,
  5662           DFHEIV99,
  5663           DFHEIV99
  5664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5665
  5666
  5667
  5668* EXEC CICS RETURN
  5669*        END-EXEC.
  5670*    MOVE '.(                    &   #00004922' TO DFHEIV0
  5671     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5672     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5673     MOVE X'2020233030303034393232' TO DFHEIV0(25:11)
  5674     CALL 'kxdfhei1' USING DFHEIV0,
  5675           DFHEIV99,
  5676           DFHEIV99,
  5677           DFHEIV99,
  5678           DFHEIV99,
  5679           DFHEIV99
  5680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5681
  5682
  5683
  5684 8300-EXIT.
  5685     EXIT.
  5686
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 120
* EL687.cbl
  5688 8400-LOG-JOURNAL-RECORD SECTION.
  5689
  5690     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5691     MOVE WS-PROGRAM-ID          TO  JP-PROGRAM-ID.
  5692
  5693*    EXEC CICS JOURNAL
  5694*        JFILEID (PI-JOURNAL-FILE-ID)
  5695*        JTYPEID (WS-JOURNAL-TYPE-ID)
  5696*        FROM    (JOURNAL-RECORD)
  5697*        LENGTH  (WS-JOURNAL-RECORD-LENGTH) END-EXEC.
  5698
  5699 8400-EXIT.
  5700     EXIT.
  5701
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 121
* EL687.cbl
  5703 8500-DATE-CONVERSION SECTION.
  5704
  5705
  5706* EXEC CICS LINK
  5707*        PROGRAM  ('ELDATCV')
  5708*        COMMAREA (DATE-CONVERSION-DATA)
  5709*        LENGTH   (DC-COMM-LENGTH) END-EXEC.
  5710     MOVE 'ELDATCV' TO DFHEIV1
  5711*    MOVE '."C                   ''   #00004947' TO DFHEIV0
  5712     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5713     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5714     MOVE X'2020233030303034393437' TO DFHEIV0(25:11)
  5715     CALL 'kxdfhei1' USING DFHEIV0,
  5716           DFHEIV1,
  5717           DATE-CONVERSION-DATA,
  5718           DC-COMM-LENGTH,
  5719           DFHEIV99,
  5720           DFHEIV99,
  5721           DFHEIV99
  5722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5723
  5724
  5725
  5726 8500-EXIT.
  5727     EXIT.
  5728
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 122
* EL687.cbl
  5730 8700-LOCATE-BENEFIT SECTION.
  5731
  5732
  5733* EXEC CICS HANDLE CONDITION
  5734*        NOTFND (8700-EXIT) END-EXEC.
  5735*    MOVE '"$I                   ! & #00004959' TO DFHEIV0
  5736     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5737     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5738     MOVE X'2620233030303034393539' TO DFHEIV0(25:11)
  5739     CALL 'kxdfhei1' USING DFHEIV0
  5740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5741
  5742
  5743     MOVE SPACES                 TO  WS-KIND.
  5744
  5745     MOVE PI-COMPANY-ID          TO  WS-CFK-COMPANY-ID.
  5746     MOVE WS-BENEFIT-NO          TO  WS-CFK-BENEFIT-NO.
  5747
  5748
  5749* EXEC CICS READ
  5750*        DATASET (WS-CONTROL-FILE-DSID)
  5751*        RIDFLD  (WS-CONTROL-FILE-KEY)
  5752*        SET     (ADDRESS OF CONTROL-FILE)
  5753*        GTEQ    END-EXEC.
  5754*    MOVE '&"S        G          (   #00004967' TO DFHEIV0
  5755     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  5756     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5757     MOVE X'2020233030303034393637' TO DFHEIV0(25:11)
  5758     CALL 'kxdfhei1' USING DFHEIV0,
  5759           WS-CONTROL-FILE-DSID,
  5760           DFHEIV20,
  5761           DFHEIV99,
  5762           WS-CONTROL-FILE-KEY,
  5763           DFHEIV99,
  5764           DFHEIV99,
  5765           DFHEIV99
  5766     SET ADDRESS OF CONTROL-FILE TO
  5767         DFHEIV20
  5768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5769
  5770
  5771     IF WS-CFK-COMPANY-ID NOT = CF-COMPANY-ID
  5772       OR WS-CFK-RECORD-TYPE NOT = CF-RECORD-TYPE
  5773         GO TO 8700-EXIT.
  5774
  5775     MOVE +1                     TO  WS-INDEX.
  5776
  5777 8700-LOOKUP-BENEFIT.
  5778     IF WS-BENEFIT-NO = CF-BENEFIT-CODE (WS-INDEX)
  5779         MOVE CF-BENEFIT-ALPHA (WS-INDEX)  TO  WS-KIND
  5780         GO TO 8700-EXIT.
  5781
  5782     IF CF-BENEFIT-CODE (WS-INDEX) NOT LESS CF-HI-BEN-IN-REC
  5783         GO TO 8700-EXIT.
  5784
  5785     IF WS-INDEX LESS THAN +8
  5786         ADD +1  TO  WS-INDEX
  5787         GO TO 8700-LOOKUP-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 123
* EL687.cbl
  5788
  5789 8700-EXIT.
  5790     EXIT.
  5791
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 124
* EL687.cbl
  5793 9000-RETURN-CICS SECTION.
  5794
  5795     MOVE 'EL005'                TO  WS-PROGRAM-ID.
  5796     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5797     PERFORM 9300-XCTL.
  5798
  5799 9000-EXIT.
  5800     EXIT.
  5801
  5802 9100-RETURN-TRAN SECTION.
  5803
  5804     MOVE EMI-ERROR-NUMBER (1)  TO  PI-LAST-ERROR-NO.
  5805     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5806
  5807
  5808* EXEC CICS RETURN
  5809*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  5810*        LENGTH   (PI-COMM-LENGTH)
  5811*        TRANSID  (WS-TRANS-ID) END-EXEC.
  5812*    MOVE '.(CT                  &   #00005009' TO DFHEIV0
  5813     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5814     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5815     MOVE X'2020233030303035303039' TO DFHEIV0(25:11)
  5816     CALL 'kxdfhei1' USING DFHEIV0,
  5817           WS-TRANS-ID,
  5818           PROGRAM-INTERFACE-BLOCK,
  5819           PI-COMM-LENGTH,
  5820           DFHEIV99,
  5821           DFHEIV99
  5822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5823
  5824
  5825 9100-EXIT.
  5826     EXIT.
  5827
  5828 9300-XCTL SECTION.
  5829
  5830     IF PI-PRINTER-STARTED-SW NOT = ZERO
  5831         PERFORM 0700-END-PRINT.
  5832
  5833     MOVE DFHENTER               TO  EIBAID.
  5834
  5835
  5836* EXEC CICS XCTL
  5837*        PROGRAM  (WS-PROGRAM-ID)
  5838*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  5839*        LENGTH   (PI-COMM-LENGTH) END-EXEC.
  5840*    MOVE '.$C                   $   #00005024' TO DFHEIV0
  5841     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5842     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5843     MOVE X'2020233030303035303234' TO DFHEIV0(25:11)
  5844     CALL 'kxdfhei1' USING DFHEIV0,
  5845           WS-PROGRAM-ID,
  5846           PROGRAM-INTERFACE-BLOCK,
  5847           PI-COMM-LENGTH
  5848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5849
  5850
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 125
* EL687.cbl
  5851 9300-EXIT.
  5852     EXIT.
  5853
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 126
* EL687.cbl
  5855 9400-CLEAR SECTION.
  5856
  5857     MOVE PI-RETURN-TO-PROGRAM  TO  WS-PROGRAM-ID.
  5858     PERFORM 9300-XCTL.
  5859
  5860 9400-EXIT.
  5861     EXIT.
  5862
  5863 9600-PGMIDERR SECTION.
  5864
  5865
  5866* EXEC CICS HANDLE CONDITION
  5867*        PGMIDERR (8300-SEND-TEXT) END-EXEC.
  5868*    MOVE '"$L                   ! '' #00005043' TO DFHEIV0
  5869     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5871     MOVE X'2720233030303035303433' TO DFHEIV0(25:11)
  5872     CALL 'kxdfhei1' USING DFHEIV0
  5873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5874
  5875
  5876     MOVE WS-PROGRAM-ID          TO  PI-CALLING-PROGRAM.
  5877
  5878     MOVE 'EL005'                TO  WS-PROGRAM-ID
  5879                                     LOGOFF-PGM.
  5880     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5881     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  5882     PERFORM 9300-XCTL.
  5883
  5884 9600-EXIT.
  5885     EXIT.
  5886
  5887 9900-ERROR-FORMAT SECTION.
  5888
  5889     IF EMI-ERRORS-COMPLETE
  5890         MOVE ER-3130            TO  EMI-ERROR
  5891         GO TO 9900-EXIT.
  5892
  5893
  5894* EXEC CICS LINK
  5895*        PROGRAM  ('EL001')
  5896*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  5897*        LENGTH   (EMI-COMM-LENGTH) END-EXEC.
  5898     MOVE 'EL001' TO DFHEIV1
  5899*    MOVE '."C                   ''   #00005063' TO DFHEIV0
  5900     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5901     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5902     MOVE X'2020233030303035303633' TO DFHEIV0(25:11)
  5903     CALL 'kxdfhei1' USING DFHEIV0,
  5904           DFHEIV1,
  5905           ERROR-MESSAGE-INTERFACE-BLOCK,
  5906           EMI-COMM-LENGTH,
  5907           DFHEIV99,
  5908           DFHEIV99,
  5909           DFHEIV99
  5910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5911
  5912
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 127
* EL687.cbl
  5913     MOVE ER-3130                TO  EMI-ERROR.
  5914
  5915 9900-EXIT.
  5916     EXIT.
  5917
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 128
* EL687.cbl
  5919 9990-ERROR SECTION.
  5920
  5921     MOVE DFHEIBLK TO EMI-LINE1.
  5922
  5923* EXEC CICS LINK
  5924*        PROGRAM  ('EL004')
  5925*        COMMAREA (EMI-LINE1)
  5926*        LENGTH   (72) END-EXEC.
  5927     MOVE 'EL004' TO DFHEIV1
  5928     MOVE 72
  5929       TO DFHEIV11
  5930*    MOVE '."C                   ''   #00005077' TO DFHEIV0
  5931     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5932     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5933     MOVE X'2020233030303035303737' TO DFHEIV0(25:11)
  5934     CALL 'kxdfhei1' USING DFHEIV0,
  5935           DFHEIV1,
  5936           EMI-LINE1,
  5937           DFHEIV11,
  5938           DFHEIV99,
  5939           DFHEIV99,
  5940           DFHEIV99
  5941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5942
  5943     PERFORM 8200-SEND-DATAONLY.
  5944     GO TO 9100-RETURN-TRAN.
  5945
  5946 9990-EXIT.
  5947     EXIT.
  5948
  5949 9999-LAST-PARAGRAPH SECTION.
  5950
  5951
  5952* GOBACK.
  5953     MOVE '9%                    "   ' TO DFHEIV0
  5954     MOVE 'EL687' TO DFHEIV1
  5955     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5956     GOBACK.
  5957
  5958
  5959 9999-DFHBACK SECTION.
  5960     MOVE '9%                    "   ' TO DFHEIV0
  5961     MOVE 'EL687' TO DFHEIV1
  5962     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5963     GOBACK.
  5964 9999-DFHEXIT.
  5965     IF DFHEIGDJ EQUAL 0001
  5966         NEXT SENTENCE
  5967     ELSE IF DFHEIGDJ EQUAL 2
  5968         GO TO 9600-PGMIDERR,
  5969               0180-MAIN-LOGIC,
  5970               0190-MAIN-LOGIC,
  5971               0900-TERMIDERR,
  5972               0910-ENQ-BUSY,
  5973               9990-ERROR
  5974         DEPENDING ON DFHEIGDI
  5975     ELSE IF DFHEIGDJ EQUAL 3
  5976         GO TO 0225-MAIN-LOGIC,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page 129
* EL687.cbl
  5977               0230-MAIN-LOGIC
  5978         DEPENDING ON DFHEIGDI
  5979     ELSE IF DFHEIGDJ EQUAL 4
  5980         GO TO 9400-CLEAR,
  5981               0040-MAIN-LOGIC,
  5982               0040-MAIN-LOGIC,
  5983               0040-MAIN-LOGIC
  5984         DEPENDING ON DFHEIGDI
  5985     ELSE IF DFHEIGDJ EQUAL 5
  5986         GO TO 9999-DFHBACK,
  5987               0390-MAIN-LOGIC
  5988         DEPENDING ON DFHEIGDI
  5989     ELSE IF DFHEIGDJ EQUAL 6
  5990         GO TO 8700-EXIT
  5991         DEPENDING ON DFHEIGDI
  5992     ELSE IF DFHEIGDJ EQUAL 7
  5993         GO TO 8300-SEND-TEXT
  5994         DEPENDING ON DFHEIGDI.
  5995     MOVE '9%                    "   ' TO DFHEIV0
  5996     MOVE 'EL687' TO DFHEIV1
  5997     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5998     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        5856     Code:       14884
