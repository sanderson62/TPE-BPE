* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page   1
* ELRFND.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"ELRFND.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRFND.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRFND.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:23:50.
     7*                            VMOD=2.011
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page   2
* ELRFND.cbl
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM REFUNDS      *
    28*            *****************************************************
    29
    30
    31******************************************************************
    32*                                                                *
    33*              INPUT FIELDS USED                                 *
    34*                                                                *
    35******************************************************************
    36*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    37*  REFUND DATE      - CP-VALUATION-DT                            *
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM                           *
    39*  LOAN TERM        - CP-LOAN-TERM                               *
    40*  REMAINING TERM   - CP-REMAINING-TERM                          *
    41*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    42*  STATE CODE       - CP-STATE                                   *
    43*  STATE CODE       - CP-STATE-STD-ABBV                          *
    44*  CLASS CODE       - CP-CLASS-CODE                              *
    45*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    46*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    47*  PROCESS TYPE     - CP-PROCESS-TYPE                            *
    48*  BENEFIT KIND     - CP-BENEFIT-TYPE                            *
    49*  A.P.R.           - CP-LOAN-APR                                *
    50*  METHOD           - CP-EARNING-METHOD                          *
    51*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  COMPANY I.D.     - CP-COMPANY-ID                              *
    54*  BENEFIT CODE     - CP-BENEFIT-CD                              *
    55*  INSURED AGE      - CP-ISSUE-AGE                               *
    56******************************************************************
    57 ENVIRONMENT DIVISION.
    58
    59 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page   3
* ELRFND.cbl
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63 77  FILLER   PIC X(32) VALUE '********************************'.
    64 77  FILLER   PIC X(32) VALUE '**  ELRFND  WORKING STORAGE   **'.
    65 77  FILLER   PIC X(32) VALUE '********VMOD=2.011 *************'.
    66 77  WS-UE-CLP                   PIC S9(5)V99 COMP-3 VALUE +0.
    67 77  WS-GFR3                     PIC S9(5)V99 COMP-3 VALUE +0.
    68 77  WS-MONTH                    PIC S999     COMP-3 VALUE +0.
    69
    70 01  WS-WORK-MISC.
    71     12  WS-REMAINING-TERM   PIC S9(4)V9      COMP-3.
    72     12  WS-TEMP-RESULT      PIC S9(7)V9(6)   COMP-3.
    73     12  WS-REMAINING-AMT    PIC S9(7)V9(6)   COMP-3.
    74     12  WS-ORIG-PREM        PIC S9(7)V9(6)   COMP-3.
    75     12  WS-REMAIN-PREM      PIC S9(7)V9(6)   COMP-3.
    76     12  WS-NP-REF-FACTOR    PIC S9(4)V9(11)  COMP-3.
    77     12  WS-SAVE-TERM        PIC S9(3)        COMP-3.
    78     12  WS-SAVE-LOAN-TERM   PIC S9(3)        COMP-3.
    79     12  WS-SAVE-BENEFIT     PIC S9(9)V99     COMP-3.
    80     12  WS-SAVE-EARN-METHOD PIC X.
    81     12  CAL-RFND            PIC S9(5)V99     COMP-3.
    82     12  FACTOR-1            PIC S9(4)V9(11)  COMP-3.
    83     12  FACTOR-2            PIC S9(4)V9(11)  COMP-3.
    84     12  FACTOR-3            PIC S9(4)V9(11)  COMP-3.
    85     12  FACTOR-4            PIC S9(4)V9(11)  COMP-3.
    86     12  FACTOR-5            PIC S9(7)        COMP-3.
    87     12  FACTOR-6            PIC S9(7)        COMP-3.
    88     12  RATE-FACTOR-1       PIC S9V99        COMP-3.
    89     12  RATE-FACTOR-2       PIC S999         COMP-3.
    90     12  R78-FACTOR          PIC S9(4)V9(11)  COMP-3.
    91     12  PR-FACTOR           PIC S9(4)V9(11)  COMP-3.
    92     12  RSUM-FACTOR         PIC S9(4)V9(11)  COMP-3.
    93     12  RSUM-REMAINING-TERM PIC S9(3)V99     COMP-3.
    94
    95 01  TEXAS-REG-WORK-AREAS.
    96     12  TEX-FACT-1          PIC S9(7)V9(2)  COMP-3.
    97     12  TEX-FACT-2          PIC S9(3)       COMP-3.
    98     12  TEX-FACT-3          PIC S9(3)       COMP-3.
    99     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   100     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   101     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   102     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   103     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   104     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   105
   106 01  NET-PAY-INTERFACE.
   107     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   108     12  N-P-ORIG            PIC S9(3)       COMP-3.
   109     12  N-P-REM             PIC S9(3)       COMP-3.
   110     12  N-P-OPT             PIC X.
   111     12  N-P-LOAN            PIC S9(3)       COMP-3.
   112     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   113
   114*                        COPY ERCNETWS.
   115*****************************************************************
   116*                                                               *
   117*                                                               *
   118*                            ERCNETWS                           *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page   4
* ELRFND.cbl
   119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   120*                            VMOD=2.014                         *
   121*                                                               *
   122*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   123*                                                               *
   124*****************************************************************.
   125*                   C H A N G E   L O G
   126*
   127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   128*-----------------------------------------------------------------
   129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   130* EFFECTIVE    NUMBER
   131*-----------------------------------------------------------------
   132* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   133* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   134* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   135* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   136******************************************************************
   137
   138 01  NET-PAY-WORK-AREA.
   139     12  OPTION-SW               PIC X   VALUE 'X'.
   140        88  NPO-STD         VALUE SPACE.
   141        88  NPO-ALT         VALUE 'A'.
   142        88  NPO-SIMPLE      VALUE 'S'.
   143        88  NPO-2MO         VALUE 'I'.
   144        88  NPO-3MO         VALUE 'J'.
   145        88  NPO-4MO         VALUE 'K'.
   146        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   147        88  NPO-TRUNC-0     VALUE 'T'.
   148        88  NPO-TRUNC-1     VALUE 'U'.
   149        88  NPO-TRUNC-2     VALUE 'V'.
   150        88  NPO-TRUNC-3     VALUE 'W'.
   151        88  NPO-TRUNC-4     VALUE 'X'.
   152        88  NPO-REFUND      VALUE 'R'.
   153        88  NPO-PRUDENTIAL  VALUE 'P'.
   154
   155     12  TYPE-SW             PIC X   VALUE 'N'.
   156        88  NET-STD             VALUE 'N'.
   157        88  NET-SMP             VALUE 'S'.
   158
   159     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   160        88  NP-RATING           VALUE '1'.
   161        88  NP-REFUND           VALUE '2'.
   162        88  NP-REMAIN-AMT       VALUE '3'.
   163
   164     12  COMP-3-WORK-AREA         COMP-3.
   165         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   166         16  V               PIC SV9(13)       VALUE +.0.
   167         16  J               PIC SV9(9)        VALUE +0.
   168         16  K               PIC SV9(9)        VALUE +0.
   169         16  I               PIC SV9(10)       VALUE +.0.
   170         16  D               PIC S9(5)         VALUE +.0.
   171         16  APR100          PIC SV9(9)        VALUE +.0.
   172         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   173         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   174         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   175         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   176         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page   5
* ELRFND.cbl
   177         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   178         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   179         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   180         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   181         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   182         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   183         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   184         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   185         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   186         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   187         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   188         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   189         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   190         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   191         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   192         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   193         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   194         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   195         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   196         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   197         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   198         16  K1              PIC S999          VALUE +1.
   199         16  K12             PIC S999          VALUE +12.
   200         16  K100            PIC S999          VALUE +100.
   201         16  K1000           PIC S9(7)         VALUE +1000.
   202         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   203         16  Y REDEFINES NC-LR
   204                             PIC S99V9(5).
   205         16  TI              PIC S999V9(5)     VALUE +0.
   206         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   207         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   208         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   209         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   210         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   211         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   212         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   213         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   214
   215         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   216         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   217         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   218         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   219         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   220         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   221         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
   222         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   223         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   224         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   225         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   226         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   227         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   228
   229         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
   230
   231         16  ORIGINAL-TERM   PIC S999.
   232         16  M              REDEFINES ORIGINAL-TERM
   233                             PIC S999.
   234
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page   6
* ELRFND.cbl
   235         16  REMAINING-TERM  PIC S999.
   236         16  R              REDEFINES REMAINING-TERM
   237                             PIC S999.
   238
   239         16  LOAN-TERM       PIC S999.
   240         16  N              REDEFINES LOAN-TERM
   241                             PIC S999.
   242
   243         16  EXPIRED-TERM    PIC S999.
   244         16  E              REDEFINES EXPIRED-TERM
   245                             PIC S999.
   246
   247         16  PRUDENTIAL-WORK-AMT
   248                             PIC S9(7)V9(8).
   249         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   250                             PIC S9(7)V9(8).
   251
   252         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   253         16  VX              PIC S9V9(13)      VALUE +0.0.
   254         16  SV              PIC S9V9(13)      VALUE +0.0.
   255         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   256         16  SX              PIC S9V9(13)      VALUE +0.0.
   257         16  SE              PIC S9V9(10)      VALUE +0.0.
   258         16  N2              PIC S9(7)         VALUE +0.
   259         16  N3              PIC S9(7)         VALUE +0.
   260         16  K-I             PIC S9V9(8)       VALUE +0.0.
   261
   262     12  BINARY-WORK-AREA        COMP.
   263         16  X1              PIC S999        VALUE +0.
   264         16  X2              PIC S999        VALUE +0.
   265         16  MAX-X           PIC S9(5)       VALUE +0.
   266         16  B1              PIC S9(5)       VALUE +1.
   267         16  LINDX           PIC S999        VALUE ZEROS.
   268         16  AHNDX           PIC S999        VALUE ZEROS.
   269
   270     12  CSO-RATE-WORK-AREAS.
   271         16  C-PMTS-PER-YEAR     PIC S999 COMP-3 VALUE ZEROS.
   272         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   273         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   274     12  WS-WORK-MISC.
   275         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   276         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   277*        16  WS-AGE              PIC 99           VALUE ZEROS.
   278         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   279         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   280         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   281         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   282         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   283         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   284         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   285         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   286         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   287         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
   288         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   289         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   290******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page   7
* ELRFND.cbl
   292*                        COPY ELCDATE.
   293******************************************************************
   294*                                                                *
   295*                                                                *
   296*                            ELCDATE.                            *
   297*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   298*                            VMOD=2.003
   299*                                                                *
   300*                                                                *
   301*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   302*                 LENGTH = 200                                   *
   303******************************************************************
   304
   305 01  DATE-CONVERSION-DATA.
   306     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   307     12  DC-OPTION-CODE                PIC X.
   308         88  BIN-TO-GREG                VALUE ' '.
   309         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   310         88  EDIT-GREG-TO-BIN           VALUE '2'.
   311         88  YMD-GREG-TO-BIN            VALUE '3'.
   312         88  MDY-GREG-TO-BIN            VALUE '4'.
   313         88  JULIAN-TO-BIN              VALUE '5'.
   314         88  BIN-PLUS-ELAPSED           VALUE '6'.
   315         88  FIND-CENTURY               VALUE '7'.
   316         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   317         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   318         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   319         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   320         88  JULIAN-TO-BIN-3            VALUE 'C'.
   321         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   322         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   323         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   324         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   325         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   326         88  CHECK-LEAP-YEAR            VALUE 'H'.
   327         88  BIN-3-TO-GREG              VALUE 'I'.
   328         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   329         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   330         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   331         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   332         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   333         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   334         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   335         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   336         88  THREE-CHARACTER-BIN
   337                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   338         88  GREGORIAN-TO-BIN
   339                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   340         88  BIN-TO-GREGORIAN
   341                  VALUES ' ' '1' 'I' '8' 'G'.
   342         88  JULIAN-TO-BINARY
   343                  VALUES '5' 'C' 'E' 'F'.
   344     12  DC-ERROR-CODE                 PIC X.
   345         88  NO-CONVERSION-ERROR        VALUE ' '.
   346         88  DATE-CONVERSION-ERROR
   347                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   348         88  DATE-IS-ZERO               VALUE '1'.
   349         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page   8
* ELRFND.cbl
   350         88  DATE-IS-INVALID            VALUE '3'.
   351         88  DATE1-GREATER-DATE2        VALUE '4'.
   352         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   353         88  DATE-INVALID-OPTION        VALUE '9'.
   354         88  INVALID-CENTURY            VALUE 'A'.
   355         88  ONLY-CENTURY               VALUE 'B'.
   356         88  ONLY-LEAP-YEAR             VALUE 'C'.
   357         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   358     12  DC-END-OF-MONTH               PIC X.
   359         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   360     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   361         88  USE-NORMAL-PROCESS         VALUE ' '.
   362         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   363         88  ADJUST-UP-100-YRS          VALUE '2'.
   364     12  FILLER                        PIC X.
   365     12  DC-CONVERSION-DATES.
   366         16  DC-BIN-DATE-1             PIC XX.
   367         16  DC-BIN-DATE-2             PIC XX.
   368         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   369         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   370                       DC-GREG-DATE-1-EDIT.
   371             20  DC-EDIT1-MONTH        PIC 99.
   372             20  SLASH1-1              PIC X.
   373             20  DC-EDIT1-DAY          PIC 99.
   374             20  SLASH1-2              PIC X.
   375             20  DC-EDIT1-YEAR         PIC 99.
   376         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   377         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   378                     DC-GREG-DATE-2-EDIT.
   379             20  DC-EDIT2-MONTH        PIC 99.
   380             20  SLASH2-1              PIC X.
   381             20  DC-EDIT2-DAY          PIC 99.
   382             20  SLASH2-2              PIC X.
   383             20  DC-EDIT2-YEAR         PIC 99.
   384         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   385         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   386                     DC-GREG-DATE-1-YMD.
   387             20  DC-YMD-YEAR           PIC 99.
   388             20  DC-YMD-MONTH          PIC 99.
   389             20  DC-YMD-DAY            PIC 99.
   390         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   391         16  DC-GREG-DATE-1-MDY-R REDEFINES
   392                      DC-GREG-DATE-1-MDY.
   393             20  DC-MDY-MONTH          PIC 99.
   394             20  DC-MDY-DAY            PIC 99.
   395             20  DC-MDY-YEAR           PIC 99.
   396         16  DC-GREG-DATE-1-ALPHA.
   397             20  DC-ALPHA-MONTH        PIC X(10).
   398             20  DC-ALPHA-DAY          PIC 99.
   399             20  FILLER                PIC XX.
   400             20  DC-ALPHA-CENTURY.
   401                 24 DC-ALPHA-CEN-N     PIC 99.
   402             20  DC-ALPHA-YEAR         PIC 99.
   403         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   404         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   405         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   406         16  DC-JULIAN-DATE            PIC 9(05).
   407         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page   9
* ELRFND.cbl
   408                                       PIC 9(05).
   409         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   410             20  DC-JULIAN-YEAR        PIC 99.
   411             20  DC-JULIAN-DAYS        PIC 999.
   412         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   413         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   414         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   415     12  DATE-CONVERSION-VARIBLES.
   416         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   417         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   418             20  FILLER                PIC 9(3).
   419             20  HOLD-CEN-1-CCYY.
   420                 24  HOLD-CEN-1-CC     PIC 99.
   421                 24  HOLD-CEN-1-YY     PIC 99.
   422             20  HOLD-CEN-1-MO         PIC 99.
   423             20  HOLD-CEN-1-DA         PIC 99.
   424         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   425             20  HOLD-CEN-1-R-MO       PIC 99.
   426             20  HOLD-CEN-1-R-DA       PIC 99.
   427             20  HOLD-CEN-1-R-CCYY.
   428                 24  HOLD-CEN-1-R-CC   PIC 99.
   429                 24  HOLD-CEN-1-R-YY   PIC 99.
   430             20  FILLER                PIC 9(3).
   431         16  HOLD-CENTURY-1-X.
   432             20  FILLER                PIC X(3)  VALUE SPACES.
   433             20  HOLD-CEN-1-X-CCYY.
   434                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   435                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   436             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   437             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   438         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   439             20  HOLD-CEN-1-R-X-MO     PIC XX.
   440             20  HOLD-CEN-1-R-X-DA     PIC XX.
   441             20  HOLD-CEN-1-R-X-CCYY.
   442                 24  HOLD-CEN-1-R-X-CC PIC XX.
   443                 24  HOLD-CEN-1-R-X-YY PIC XX.
   444             20  FILLER                PIC XXX.
   445         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   446         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   447         16  DC-JULIAN-DATE-1          PIC 9(07).
   448         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   449             20  DC-JULIAN-1-CCYY.
   450                 24  DC-JULIAN-1-CC    PIC 99.
   451                 24  DC-JULIAN-1-YR    PIC 99.
   452             20  DC-JULIAN-DA-1        PIC 999.
   453         16  DC-JULIAN-DATE-2          PIC 9(07).
   454         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   455             20  DC-JULIAN-2-CCYY.
   456                 24  DC-JULIAN-2-CC    PIC 99.
   457                 24  DC-JULIAN-2-YR    PIC 99.
   458             20  DC-JULIAN-DA-2        PIC 999.
   459         16  DC-GREG-DATE-A-EDIT.
   460             20  DC-EDITA-MONTH        PIC 99.
   461             20  SLASHA-1              PIC X VALUE '/'.
   462             20  DC-EDITA-DAY          PIC 99.
   463             20  SLASHA-2              PIC X VALUE '/'.
   464             20  DC-EDITA-CCYY.
   465                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  10
* ELRFND.cbl
   466                 24  DC-EDITA-YEAR     PIC 99.
   467         16  DC-GREG-DATE-B-EDIT.
   468             20  DC-EDITB-MONTH        PIC 99.
   469             20  SLASHB-1              PIC X VALUE '/'.
   470             20  DC-EDITB-DAY          PIC 99.
   471             20  SLASHB-2              PIC X VALUE '/'.
   472             20  DC-EDITB-CCYY.
   473                 24  DC-EDITB-CENT     PIC 99.
   474                 24  DC-EDITB-YEAR     PIC 99.
   475         16  DC-GREG-DATE-CYMD         PIC 9(08).
   476         16  DC-GREG-DATE-CYMD-R REDEFINES
   477                              DC-GREG-DATE-CYMD.
   478             20  DC-CYMD-CEN           PIC 99.
   479             20  DC-CYMD-YEAR          PIC 99.
   480             20  DC-CYMD-MONTH         PIC 99.
   481             20  DC-CYMD-DAY           PIC 99.
   482         16  DC-GREG-DATE-MDCY         PIC 9(08).
   483         16  DC-GREG-DATE-MDCY-R REDEFINES
   484                              DC-GREG-DATE-MDCY.
   485             20  DC-MDCY-MONTH         PIC 99.
   486             20  DC-MDCY-DAY           PIC 99.
   487             20  DC-MDCY-CEN           PIC 99.
   488             20  DC-MDCY-YEAR          PIC 99.
   489    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   490        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   491    12  DC-EL310-DATE                  PIC X(21).
   492    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  11
* ELRFND.cbl
   494*                        COPY ELCCALC.
   495******************************************************************
   496*                                                                *
   497*                           ELCCALC.                            *
   498*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   499*                            VMOD=2.025                          *
   500*                                                                *
   501*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   502*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   503*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   504*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   505*                                                                *
   506*  PASSED TO ELRTRM                                              *
   507*  -----------------                                             *
   508*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   509*  ORIGINAL TERM                                                 *
   510*  BEGINNING DATE                                                *
   511*  ENDING DATE                                                   *
   512*  COMPANY I.D.                                                  *
   513*  ACCOUNT MASTER USER FIELD                                     *
   514*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   515*  FREE LOOK DAYS                                                *
   516*                                                                *
   517*  RETURNED FROM ELRTRM                                          *
   518*  ---------------------                                         *
   519*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   520*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   521*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   522*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   523*----------------------------------------------------------------*
   524*  PASSED TO ELRAMT                                              *
   525*  ----------------                                              *
   526*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   527*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   528*  ORIGINAL AMOUNT                                               *
   529*  ALTERNATE BENEFIT (BALLON)                                    *
   530*  A.P.R. - NET PAY ONLY                                         *
   531*  METHOD
   532*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   533*  COMPANY I.D.                                                  *
   534*  BENEFIT TYPE                                                  *
   535*                                                                *
   536*  RETURNED FROM ELRAMT                                          *
   537*  --------------------                                          *
   538*  REMAINING AMOUNT 1 - CURRENT                                  *
   539*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   540*  REMAINING AMOUNT FACTOR
   541*----------------------------------------------------------------*
   542*  PASSED TO ELRESV                                              *
   543*  -----------------                                             *
   544*  CERTIFICATE EFFECTIVE DATE                                    *
   545*  VALUATION DATE                                                *
   546*  PAID THRU DATE                                                *
   547*  BENEFIT                                                       *
   548*  INCURRED DATE                                                 *
   549*  REPORTED DATE                                                 *
   550*  ISSUE AGE                                                     *
   551*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  12
* ELRFND.cbl
   552*  CDT PERCENT                                                   *
   553*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   554* *CLAIM TYPE (LIFE, A/H)                                        *
   555* *REMAINING BENEFIT (FROM ELRAMT)                               *
   556* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   557*                                                                *
   558*  RETURNED FROM ELRESV                                          *
   559*  --------------------                                          *
   560*  CDT TABLE USED                                                *
   561*  CDT FACTOR USED                                               *
   562*  PAY TO CURRENT RESERVE                                        *
   563*  I.B.N.R. - A/H ONLY                                           *
   564*  FUTURE (ACCRUED) AH ONLY                                      *
   565*----------------------------------------------------------------*
   566*  PASSED TO ELRATE                                              *
   567*  ----------------                                              *
   568*  CERT ISSUE DATE                                               *
   569*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   570*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   571*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   572*  STATE CODE (CLIENT DEFINED)                                   *
   573*  STATE CODE (STANDARD P.O. ABBRV)                              *
   574*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   575*  DEVIATION CODE                                                *
   576*  ISSUE AGE                                                     *
   577*  ORIGINAL BENEFIT AMOUNT                                       *
   578*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   579*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   580*  BENEFIT KIND (LIFE OR A/H)                                    *
   581*  A.P.R.                                                        *
   582*  METHOD
   583*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   584*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   585*  COMPANY I.D. (3 CHARACTER)                                    *
   586*  BENEFIT CODE                                                  *
   587*  BENEFIT OVERRIDE CODE                                         *
   588*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   589*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   590*  JOINT INDICATOR (CSL ONLY)                                    *
   591*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   592*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   593*                                                                *
   594*  RETURNED FROM ELRATE                                          *
   595*  --------------------                                          *
   596*  CALCULATED PREMIUM                                            *
   597*  PREMIUM RATE                                                  *
   598*  MORTALITY CODE                                                *
   599*  MAX ATTAINED AGE                                              *
   600*  MAX AGE                                                       *
   601*  MAX TERM                                                      *
   602*  MAX MONTHLY BENEFIT                                           *
   603*  MAX TOTAL BENIFIT                                             *
   604*  COMPOSITE RATE (OPEN-END ONLY)                                *
   605*----------------------------------------------------------------*
   606*  PASSED TO ELRFND                                              *
   607*  ----------------                                              *
   608*  CERT ISSUE DATE                                               *
   609*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  13
* ELRFND.cbl
   610*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   611*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   612*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   613*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   614*  STATE CODE (CLIENT DEFINED)                                   *
   615*  STATE CODE (STANDARD P.O. ABBRV)                              *
   616*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   617*  DEVIATION CODE                                                *
   618*  ISSUE AGE                                                     *
   619*  ORIGINAL BENEFIT AMOUNT                                       *
   620*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   621*  PROCESS TYPE (CANCEL)                                         *
   622*  BENEFIT KIND (LIFE OR A/H)                                    *
   623*  A.P.R.                                                        *
   624*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   625*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   626*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   627*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   628*  COMPANY I.D. (3 CHARACTER)                                    *
   629*  BENEFIT CODE                                                  *
   630*  BENEFIT OVERRIDE CODE                                         *
   631*                                                                *
   632*  RETURNED FROM ELRFND                                          *
   633*  --------------------                                          *
   634*  CALCULATED REFUND                                             *
   635*----------------------------------------------------------------*
   636*  PASSED TO ELEARN                                              *
   637*  ----------------                                              *
   638*  CERT ISSUE DATE                                               *
   639*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   640*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   641*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   642*  STATE CODE (CLIENT DEFINED)                                   *
   643*  STATE CODE (STANDARD P.O. ABBRV)                              *
   644*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   645*  DEVIATION CODE                                                *
   646*  ISSUE AGE                                                     *
   647*  ORIGINAL BENEFIT AMOUNT                                       *
   648*  BENEFIT KIND (LIFE OR A/H)                                    *
   649*  A.P.R.                                                        *
   650*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   651*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   652*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   653*  COMPANY I.D. (3 CHARACTER)                                    *
   654*  BENEFIT CODE                                                  *
   655*  BENEFIT OVERRIDE CODE                                         *
   656*                                                                *
   657*  RETURNED FROM ELEARN                                          *
   658*  --------------------                                          *
   659*  INDICATED  EARNINGS                                           *
   660*----------------------------------------------------------------*
   661*                 LENGTH = 450                                   *
   662*                                                                *
   663******************************************************************
   664******************************************************************
   665*                   C H A N G E   L O G
   666*
   667* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  14
* ELRFND.cbl
   668*-----------------------------------------------------------------
   669*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   670* EFFECTIVE    NUMBER
   671*-----------------------------------------------------------------
   672* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   673* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   674* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   675* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   676* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   677* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   678* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   679* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   680* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   681******************************************************************
   682
   683 01  CALCULATION-PASS-AREA.
   684     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   685                                     COMP.
   686
   687     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   688       88  NO-CP-ERROR                             VALUE ZERO.
   689       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   690                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   691       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   692       88  CP-ERROR-IN-DATES                       VALUE '2'.
   693       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   694       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   695       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   696       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   697       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   698       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   699       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   700       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   701       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   702       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   703       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   704       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   705       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   706       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   707       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   708
   709     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   710       88  NO-CP-ERROR-2                           VALUE ZERO.
   711***********************  INPUT AREAS ****************************
   712
   713     12  CP-CALCULATION-AREA.
   714         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   715         16  CP-CERT-EFF-DT        PIC XX.
   716         16  CP-VALUATION-DT       PIC XX.
   717         16  CP-PAID-THRU-DT       PIC XX.
   718         16  CP-BENEFIT-TYPE       PIC X.
   719           88  CP-AH                               VALUE 'A' 'D'
   720                                                   'I' 'U'.
   721           88  CP-REDUCING-LIFE                    VALUE 'R'.
   722           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   723         16  CP-INCURRED-DT        PIC XX.
   724         16  CP-REPORTED-DT        PIC XX.
   725         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  15
* ELRFND.cbl
   726         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   727         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   728                                     COMP-3.
   729         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   730                                     COMP-3.
   731         16  CP-CDT-METHOD         PIC X.
   732           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   733           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   734           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   735         16  CP-CLAIM-TYPE         PIC X.
   736           88  CP-AH-CLAIM                         VALUE 'A'.
   737           88  CP-LIFE-CLAIM                       VALUE 'L'.
   738         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   739                                     COMP-3.
   740         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   741                                     COMP-3.
   742         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   743                                     COMP-3.
   744         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   745                                     COMP-3.
   746         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   747                                     COMP-3.
   748         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   749                                     COMP-3.
   750         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   751                                     COMP-3.
   752         16  CP-REM-TERM-METHOD    PIC X.
   753           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   754           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   755           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   756           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   757           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   758           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   759           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   760         16  CP-EARNING-METHOD     PIC X.
   761           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   762           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   763           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   764           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   765           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   766           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   767           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   768           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   769           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   770           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   771           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   772           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   773           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   774           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   775         16  CP-PROCESS-TYPE       PIC X.
   776           88  CP-CLAIM                            VALUE '1'.
   777           88  CP-CANCEL                           VALUE '2'.
   778           88  CP-ISSUE                            VALUE '3'.
   779         16  CP-SPECIAL-CALC-CD    PIC X.
   780           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   781           88  CP-1-MTH-INTEREST               VALUE ' '.
   782           88  CP-0-MTH-INTEREST               VALUE 'A'.
   783           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  16
* ELRFND.cbl
   784           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   785           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   786           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   787           88  CP-FARM-PLAN                    VALUE 'F'.
   788           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   789           88  CP-2-MTH-INTEREST               VALUE 'I'.
   790           88  CP-3-MTH-INTEREST               VALUE 'J'.
   791           88  CP-4-MTH-INTEREST               VALUE 'K'.
   792           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   793           88  CP-MORTGAGE-REC                 VALUE 'M'.
   794           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   795           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   796           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   797           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   798                                                     'W' 'X'.
   799           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   800           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   801           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   802           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   803           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   804           88  CP-SUMMARY-REC                  VALUE 'Z'.
   805           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   806           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   807           88  CP-AD-D-BENEFIT                 VALUE '4'.
   808           88  CP-CSL-METH-1                   VALUE '5'.
   809           88  CP-CSL-METH-2                   VALUE '6'.
   810           88  CP-CSL-METH-3                   VALUE '7'.
   811           88  CP-CSL-METH-4                   VALUE '8'.
   812
   813         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   814                                     COMP-3.
   815         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   816         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   817         16  CP-STATE              PIC XX          VALUE SPACE.
   818         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   819         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   820           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   821               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   822         16  CP-R78-OPTION         PIC X.
   823           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   824           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   825
   826         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   827         16  CP-IBNR-RESERVE-SW    PIC X.
   828         16  CP-CLAIM-STATUS       PIC X.
   829         16  CP-RATE-FILE          PIC X.
   830         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   831                                     COMP-3.
   832
   833         16  CP-LIFE-OVERRIDE-CODE PIC X.
   834         16  CP-AH-OVERRIDE-CODE   PIC X.
   835
   836         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   837                                     COMP-3.
   838         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   839                                   PIC S9(5)V99 COMP-3.
   840         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   841                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  17
* ELRFND.cbl
   842         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   843                                     COMP-3.
   844         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   845                                     COMP-3.
   846         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   847                                  PIC S9(7)V99 COMP-3.
   848
   849         16  CP-PAID-FROM-DATE     PIC X(02).
   850         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   851         16  CP-EXT-DAYS-CALC      PIC X.
   852           88  CP-EXT-NO-CHG                   VALUE ' '.
   853           88  CP-EXT-CHG-LF                   VALUE '1'.
   854           88  CP-EXT-CHG-AH                   VALUE '2'.
   855           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   856         16  CP-DOMICILE-STATE     PIC XX.
   857         16  CP-CARRIER            PIC X.
   858         16  CP-REIN-FLAG          PIC X.
   859         16  CP-REM-TRM-CALC-OPTION PIC X.
   860           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   861                      '2' '3' '4' '5'.
   862           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   863           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   864           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   865           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   866           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   867           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   868           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   869           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   870         16  CP-SIG-SWITCH         PIC X.
   871         16  CP-RATING-METHOD      PIC X.
   872           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   873           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   874           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   875           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   876           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   877           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   878           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   879           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   880           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   881         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   882                                     COMP-3.
   883         16  CP-BEN-CATEGORY       PIC X.
   884         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   885         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   886                                   PIC S99V9(5) COMP-3.
   887         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   888         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   889                                   PIC S99V9(5) COMP-3.
   890         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   891         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   892         16  CP-EXPIRE-DT          PIC XX.
   893         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   894         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   895         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   896         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   897         16  CP-DDF-SPEC-CALC      PIC X.
   898             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   899             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  18
* ELRFND.cbl
   900         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   901         16  CP-CANCEL-REASON      PIC X.
   902         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   903         16  CP-PMT-MODE           PIC X.
   904         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   905         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   906         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   907         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   908         16  FILLER                PIC X.
   909
   910***************    OUTPUT FROM ELRESV   ************************
   911
   912         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   913
   914         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   915                                     COMP-3.
   916         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   917                                     COMP-3.
   918         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   919                                     COMP-3.
   920         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   921                                     COMP-3.
   922         16  FILLER                PIC X(09).
   923***************    OUTPUT FROM ELRTRM   *************************
   924
   925         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   926                                     COMP-3.
   927         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   928                                     COMP-3.
   929         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   930                                     COMP-3.
   931         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   932                                     COMP-3.
   933         16  FILLER                PIC X(12).
   934
   935***************    OUTPUT FROM ELRAMT   *************************
   936
   937         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   938                                     COMP-3.
   939         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   940                                     COMP-3.
   941         16  FILLER                PIC X(12).
   942
   943***************    OUTPUT FROM ELRATE   *************************
   944
   945         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   946                                     COMP-3.
   947         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   948                                     COMP-3.
   949         16  CP-MORTALITY-CODE     PIC X(4).
   950         16  CP-RATE-EDIT-FLAG     PIC X.
   951             88  CP-RATES-NEED-APR                  VALUE '1'.
   952         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   953                                     COMP-3.
   954         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   955         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   956         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   957                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  19
* ELRFND.cbl
   958         16  FILLER                PIC X(07).
   959
   960***************    OUTPUT FROM ELRFND   *************************
   961
   962         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   963                                     COMP-3.
   964         16  CP-REFUND-TYPE-USED   PIC X.
   965           88  CP-R-AS-R78                         VALUE '1'.
   966           88  CP-R-AS-PRORATA                     VALUE '2'.
   967           88  CP-R-AS-CALIF                       VALUE '3'.
   968           88  CP-R-AS-TEXAS                       VALUE '4'.
   969           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   970           88  CP-R-AS-NET-PAY                     VALUE '5'.
   971           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   972           88  CP-R-AS-MEAN                        VALUE '8'.
   973           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   974           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   975           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   976           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   977           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   978           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   979         16  FILLER                PIC X(12).
   980
   981***************    OUTPUT FROM ELEARN   *************************
   982
   983         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   984                                     COMP-3.
   985         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   986                                     COMP-3.
   987         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   988                                     COMP-3.
   989         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   990                                     COMP-3.
   991         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   992                                     COMP-3.
   993         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   994                                     COMP-3.
   995         16  CP-EARNING-TYPE-USED  PIC X.
   996           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   997           88  CP-E-AS-R78                         VALUE '1'.
   998           88  CP-E-AS-PRORATA                     VALUE '2'.
   999           88  CP-E-AS-TEXAS                       VALUE '4'.
  1000           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1001           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1002           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1003           88  CP-E-AS-MEAN                        VALUE '8'.
  1004           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1005         16  FILLER                PIC X(12).
  1006
  1007***************    OUTPUT FROM ELPMNT   *************************
  1008
  1009         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1010                                     COMP-3.
  1011         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1012                                     COMP-3.
  1013         16  FILLER                PIC X(12).
  1014
  1015***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  20
* ELRFND.cbl
  1016         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1017                                     COMP-3.
  1018         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1019                                     COMP-3.
  1020         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1021                                     COMP-3.
  1022         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1023                                     COMP-3.
  1024         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1025                                     COMP-3.
  1026         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1027                                     COMP-3.
  1028         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1029             88  OPEN-RATE-FILE                   VALUE 'O'.
  1030             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1031             88  IO-ERROR                         VALUE 'E'.
  1032
  1033         16  CP-FIRST-PAY-DATE     PIC XX.
  1034
  1035         16  CP-JOINT-INDICATOR    PIC X.
  1036
  1037         16  CP-RESERVE-REMAINING-TERM
  1038                                   PIC S9(4)V9    VALUE ZERO
  1039                                     COMP-3.
  1040
  1041         16  CP-INSURED-BIRTH-DT   PIC XX.
  1042
  1043         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1044                                     COMP-3.
  1045
  1046         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1047                                     COMP-3.
  1048
  1049         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1050                                     COMP-3.
  1051
  1052         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1053                                     COMP-3.
  1054
  1055         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1056                                     COMP-3.
  1057
  1058         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1059                                     COMP-3.
  1060
  1061         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1062                                     COMP-3.
  1063
  1064         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1065             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1066
  1067         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1068                                     COMP-3.
  1069         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1070                                     COMP-3.
  1071         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1072         16  FILLER                PIC X(15).
  1073******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  21
* ELRFND.cbl
  1074
  1075
  1076****************************************************************
  1077*
  1078* Copyright (c) 2007 by Clerity Solutions, Inc.
  1079* All rights reserved.
  1080*
  1081****************************************************************
  1082 01  DFHEIV.
  1083   02  DFHEIV0               PIC X(35).
  1084   02  DFHEIV1               PIC X(08).
  1085   02  DFHEIV2               PIC X(08).
  1086   02  DFHEIV3               PIC X(08).
  1087   02  DFHEIV4               PIC X(06).
  1088   02  DFHEIV5               PIC X(04).
  1089   02  DFHEIV6               PIC X(04).
  1090   02  DFHEIV7               PIC X(02).
  1091   02  DFHEIV8               PIC X(02).
  1092   02  DFHEIV9               PIC X(01).
  1093   02  DFHEIV10              PIC S9(7) COMP-3.
  1094   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1095   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1096   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1097   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1098   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1099   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1100   02  DFHEIV17              PIC X(04).
  1101   02  DFHEIV18              PIC X(04).
  1102   02  DFHEIV19              PIC X(04).
  1103   02  DFHEIV20              USAGE IS POINTER.
  1104   02  DFHEIV21              USAGE IS POINTER.
  1105   02  DFHEIV22              USAGE IS POINTER.
  1106   02  DFHEIV23              USAGE IS POINTER.
  1107   02  DFHEIV24              USAGE IS POINTER.
  1108   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1109   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1110   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1111   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1112   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1113   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1114   02  FILLER                PIC X(02).
  1115   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1116   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1117   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1118   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1119   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1120 LINKAGE  SECTION.
  1121*****************************************************************
  1122*                                                               *
  1123* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1124* All rights reserved.                                          *
  1125*                                                               *
  1126*****************************************************************
  1127 01  dfheiblk.
  1128     02  eibtime          pic s9(7) comp-3.
  1129     02  eibdate          pic s9(7) comp-3.
  1130     02  eibtrnid         pic x(4).
  1131     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  22
* ELRFND.cbl
  1132     02  eibtrmid         pic x(4).
  1133     02  dfheigdi         pic s9(4) comp.
  1134     02  eibcposn         pic s9(4) comp.
  1135     02  eibcalen         pic s9(4) comp.
  1136     02  eibaid           pic x(1).
  1137     02  eibfiller1       pic x(1).
  1138     02  eibfn            pic x(2).
  1139     02  eibfiller2       pic x(2).
  1140     02  eibrcode         pic x(6).
  1141     02  eibfiller3       pic x(2).
  1142     02  eibds            pic x(8).
  1143     02  eibreqid         pic x(8).
  1144     02  eibrsrce         pic x(8).
  1145     02  eibsync          pic x(1).
  1146     02  eibfree          pic x(1).
  1147     02  eibrecv          pic x(1).
  1148     02  eibsend          pic x(1).
  1149     02  eibatt           pic x(1).
  1150     02  eibeoc           pic x(1).
  1151     02  eibfmh           pic x(1).
  1152     02  eibcompl         pic x(1).
  1153     02  eibsig           pic x(1).
  1154     02  eibconf          pic x(1).
  1155     02  eiberr           pic x(1).
  1156     02  eibrldbk         pic x(1).
  1157     02  eiberrcd         pic x(4).
  1158     02  eibsynrb         pic x(1).
  1159     02  eibnodat         pic x(1).
  1160     02  eibfiller5       pic x(2).
  1161     02  eibresp          pic 9(09) comp.
  1162     02  eibresp2         pic 9(09) comp.
  1163     02  dfheigdj         pic s9(4) comp.
  1164     02  dfheigdk         pic s9(4) comp.
  1165 01  DFHCOMMAREA                PIC X(450).
  1166
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  23
* ELRFND.cbl
  1168 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1169 0000-DFHEXIT SECTION.
  1170     MOVE '9#                    $   ' TO DFHEIV0.
  1171     MOVE 'ELRFND' TO DFHEIV1.
  1172     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1173     MOVE DFHCOMMAREA    TO  CALCULATION-PASS-AREA.
  1174
  1175 000-START-REFUND-CALC.
  1176*                      COPY ELCRFNDP.
  1177****************************************************************
  1178*                                                              *
  1179*                            ELCRFNDP.                         *
  1180*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1181*                            VMOD=2.028                        *
  1182*                                                              *
  1183****************************************************************.
  1184*                   C H A N G E   L O G
  1185*
  1186* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1187*-----------------------------------------------------------------
  1188*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1189* EFFECTIVE    NUMBER
  1190*-----------------------------------------------------------------
  1191* 042203                   PEMA ADD SPECIAL IN CALC FOR CID
  1192* 033104    2003080800002  PEMA ADD GAP NON REFUNDABLE OPTION
  1193* 042904    2003080800002  PEMA ADD ACTUARIAL EARNING METHOD
  1194* 110609  CR2009092300002  PEMA CHANGE MN REFUNDS
  1195* 000000  CR2008042200001  PEMA ADD 0 APR PROCESSING
  1196* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  1197* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1198******************************************************************
  1199
  1200     MOVE ZERO                   TO  CP-RETURN-CODE
  1201                                     CP-CALC-REFUND.
  1202     MOVE SPACE                  TO  CP-REFUND-TYPE-USED.
  1203
  1204 0001-GET-CANCEL-TYPE.
  1205     IF CP-CERT-EFF-DT = CP-VALUATION-DT
  1206        MOVE CP-ORIGINAL-PREMIUM TO CP-CALC-REFUND
  1207        GO TO 1999-CALC-REF-AMT-X.
  1208
  1209     IF CP-CANCEL-REASON = 'R'
  1210        IF CP-CALC-CLP
  1211           MOVE CP-ORIGINAL-PREMIUM
  1212                                 TO CP-CALC-REFUND
  1213        ELSE
  1214           COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM -
  1215              CP-DDF-ADMIN-FEES
  1216        END-IF
  1217        MOVE 'R'                 TO CP-REFUND-TYPE-USED
  1218        GO TO 1999-CALC-REF-AMT-X
  1219     END-IF
  1220     IF CP-REMAINING-TERM = ZERO   OR
  1221        CP-REMAINING-TERM NEGATIVE
  1222          MOVE ZERO TO CP-CALC-REFUND
  1223          GO TO 1999-CALC-REF-AMT-X.
  1224
  1225     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  24
* ELRFND.cbl
  1226     MOVE SPACE              TO DC-OPTION-CODE.
  1227     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1228
  1229     IF DATE-CONVERSION-ERROR
  1230         MOVE '2' TO CP-RETURN-CODE
  1231         GO TO 1999-CALC-REF-AMT-X.
  1232
  1233     IF CP-AH
  1234        GO TO 1030-GET-AH-REFUND.
  1235
  1236********************    LIFE REFUNDS    **************************
  1237
  1238     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1239         MOVE +0                TO CP-TERM-OR-EXT-DAYS.
  1240
  1241     IF CP-LOAN-TERM NOT NUMERIC
  1242         MOVE +0                TO CP-LOAN-TERM.
  1243
  1244     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1245
  1246     COMPUTE R78-FACTOR =
  1247            (CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1248              (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1249************************************************************
  1250***       ADDED IF CONDITION FOR TESTING PURPOSES.       ***
  1251***---------------------------------------------------------
  1252     IF CP-TRUNCATED-LIFE
  1253        MOVE  CP-LOAN-TERM         TO  WS-RATE-TERM
  1254     ELSE
  1255        MOVE  CP-ORIGINAL-TERM     TO  WS-RATE-TERM.
  1256***
  1257************************************************************
  1258**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1259**** FOLLOWING.
  1260****       FOR NC. LIFE..
  1261****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1262****  TRUNCATED NET COVERAGE --- TERM > 60 USE RULE OF ANTIC.
  1263****                             TERM <= 60 USE SUM OF DIGITS.
  1264****  DECREASING COVERAGE    --- EFF DATE > 093081 AND
  1265****                             TERM > 60 USE RULE OF ANTIC
  1266****                             OTHERWISE USE RULE OF 78.
  1267****
  1268****
  1269
  1270     IF (CP-COMPANY-ID = 'NCL') AND
  1271        (CP-STATE-STD-ABBRV = 'NC')
  1272        IF CP-LEVEL-LIFE
  1273           GO TO 1023-REF-PR
  1274        ELSE
  1275        IF CP-EARN-AS-NET-PAY AND
  1276           CP-TRUNCATED-LIFE
  1277           IF CP-ORIGINAL-TERM GREATER THAN 60
  1278              GO TO 1021-ANTICIPATION-REF
  1279           ELSE
  1280              GO TO 1026-REF-R78
  1281        ELSE
  1282        IF CP-REDUCING-LIFE
  1283           IF (DC-GREG-DATE-CYMD  GREATER 19810930 AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  25
* ELRFND.cbl
  1284              CP-ORIGINAL-TERM GREATER THAN 60)
  1285              GO TO 1021-ANTICIPATION-REF
  1286           ELSE
  1287              GO TO 1075-SUM-OF-DIGITS.
  1288
  1289****
  1290**** THE FOLLOWING IF STATEMENT FOR CID ONLY SHOULD DO THE
  1291**** FOLLOWING.
  1292****       FOR OH. LIFE..
  1293****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1294****  NET/NET TRUNCATED      --- TERM > 60 USE RULE OF ANTIC.
  1295****  GROSS DECREASING       --- RULE OF 78
  1296****
  1297****
  1298
  1299     IF (CP-COMPANY-ID = 'CID') AND
  1300        (CP-STATE-STD-ABBRV = 'OH') AND
  1301        (CP-CLASS-CODE NOT = 'L ')
  1302        IF CP-LEVEL-LIFE
  1303           GO TO 1023-REF-PR
  1304        ELSE
  1305           IF (CP-ORIGINAL-TERM > 60) OR
  1306              (CP-EARN-AS-NET-PAY)
  1307              GO TO 1028-NET-PAY-REFUND
  1308           ELSE
  1309              GO TO 1026-REF-R78
  1310           END-IF
  1311        END-IF
  1312     END-IF
  1313
  1314**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1315**** FOLLOWING.
  1316****       FOR VA. LIFE..
  1317****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1318****           NET COVERAGES --- USE RULE OF ANTIC.
  1319****  DECREASING COVERAGE    --- EFF DATE < 010193 USE R78.
  1320****                         --- EFF DATE > 123194 USE ANTIC.
  1321****                         --- EFF DATE BETWEEN 010193 AND 12319
  1322****                             WITH TERM > 61 USE RULE OF ANTIC
  1323****                             OTHERWISE USE RULE OF 78.
  1324****
  1325****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1326****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1327****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1328****            WILL FOLLOW.
  1329****
  1330****
  1331****
  1332
  1333     IF (CP-COMPANY-ID = 'NCL') AND
  1334        (CP-STATE-STD-ABBRV = 'VA')
  1335        IF CP-LEVEL-LIFE
  1336           GO TO 1023-REF-PR
  1337        ELSE
  1338        IF CP-EARN-AS-NET-PAY
  1339           GO TO 1021-ANTICIPATION-REF
  1340        ELSE
  1341        IF CP-REDUCING-LIFE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  26
* ELRFND.cbl
  1342           IF DC-GREG-DATE-CYMD LESS THAN 19930101
  1343              GO TO 1026-REF-R78
  1344           ELSE
  1345           IF DC-GREG-DATE-CYMD GREATER THAN 19941231
  1346              GO TO 1021-ANTICIPATION-REF
  1347           ELSE
  1348           IF CP-ORIGINAL-TERM GREATER THAN 61
  1349              GO TO 1021-ANTICIPATION-REF
  1350           ELSE
  1351              GO TO 1026-REF-R78.
  1352
  1353     IF (CP-COMPANY-ID = 'CID')
  1354        AND (CP-STATE-STD-ABBRV = 'IN')
  1355        AND (DC-GREG-DATE-CYMD < 20030401)
  1356        IF CP-REDUCING-LIFE
  1357           GO TO 1026-REF-R78
  1358        ELSE
  1359           IF CP-LEVEL-LIFE
  1360              GO TO 1023-REF-PR
  1361           END-IF
  1362        END-IF
  1363     END-IF
  1364
  1365     IF (CP-COMPANY-ID = 'CID')
  1366        AND (CP-STATE-STD-ABBRV = 'FL')
  1367        AND (DC-GREG-DATE-CYMD > 20030630)
  1368        IF CP-RATE-AS-NET-PAY
  1369           GO TO 1028-NET-PAY-REFUND
  1370        END-IF
  1371     END-IF
  1372
  1373     IF (CP-COMPANY-ID = 'CID')
  1374        AND (CP-STATE-STD-ABBRV = 'MN')
  1375        AND (CP-EARN-AS-NET-PAY)
  1376        AND (CP-RATE-AS-REG-BALLOON)
  1377        AND (DC-GREG-DATE-CYMD > 20091231)
  1378        GO TO 1028-NET-PAY-REFUND
  1379     END-IF
  1380     IF (CP-COMPANY-ID = 'CID')
  1381        AND (CP-STATE-STD-ABBRV = 'MN')
  1382        AND (DC-GREG-DATE-CYMD > 20091231)
  1383        AND (CP-RATE-AS-NET-PAY)
  1384        GO TO 1021-ANTICIPATION-REF
  1385     END-IF
  1386     IF (CP-COMPANY-ID = 'CID')
  1387        AND (CP-STATE-STD-ABBRV = 'MO')
  1388        AND (DC-GREG-DATE-CYMD > 20030630)
  1389        AND (CP-LOAN-TERM < +121)
  1390        IF CP-RATE-AS-NET-PAY
  1391           GO TO 1028-NET-PAY-REFUND
  1392        END-IF
  1393     END-IF
  1394
  1395     IF (CP-COMPANY-ID = 'CID')
  1396        AND (CP-STATE-STD-ABBRV = 'ND')
  1397        AND (DC-GREG-DATE-CYMD > 20011231)
  1398        AND (CP-REDUCING-LIFE)
  1399        GO TO 1021-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  27
* ELRFND.cbl
  1400     END-IF
  1401
  1402     IF CP-CRITICAL-PERIOD
  1403        IF CP-COMPANY-ID = 'NCL'
  1404           NEXT SENTENCE
  1405        ELSE
  1406           GO TO 1022-REF-CRITICAL-PERIOD-LF.
  1407
  1408     IF CP-TERM-IS-DAYS  AND
  1409        CP-TERM-OR-EXT-DAYS GREATER ZERO
  1410         GO TO 1024-REF-PR-DAYS.
  1411
  1412     IF CP-STATE-STD-ABBRV = 'NM'
  1413       IF CP-REDUCING-LIFE
  1414*        IF DC-GREG-DATE-1-YMD LESS THAN '980901'
  1415         IF DC-GREG-DATE-CYMD LESS THAN 19980901
  1416             GO TO 1026-REF-R78.
  1417
  1418     IF CP-EARN-ANTICIPATION
  1419         GO TO 1021-ANTICIPATION-REF.
  1420
  1421     IF CP-STATE-STD-ABBRV = 'ME'
  1422         IF CP-COMPANY-ID = 'NCL' OR 'CVL'
  1423            NEXT SENTENCE
  1424         ELSE
  1425            IF CP-REDUCING-LIFE
  1426               GO TO 1021-ANTICIPATION-REF.
  1427
  1428     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1429        IF CP-STATE-STD-ABBRV = 'TX'
  1430            GO TO SKIP-CSO-TEXAS-LIFE-PROCESSING
  1431        END-IF
  1432     END-IF.
  1433
  1434     IF CP-STATE-STD-ABBRV = 'TX'
  1435       IF CP-COMPANY-ID EQUAL 'HER' OR 'NCL'
  1436          NEXT SENTENCE
  1437       END-IF
  1438        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1439           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1440           GO TO 1021-ANTICIPATION-REF.
  1441
  1442 SKIP-CSO-TEXAS-LIFE-PROCESSING.
  1443
  1444     IF CP-EARN-BY-PRORATA
  1445         GO TO 1023-REF-PR.
  1446
  1447     IF CP-EARN-AS-MEAN
  1448         GO TO 1025-REF-MEAN.
  1449
  1450     IF CP-EARN-AS-TEXAS
  1451         GO TO 1027-TEXAS-REFUND.
  1452
  1453     IF CP-EARN-AS-NET-PAY
  1454         GO TO 1028-NET-PAY-REFUND.
  1455
  1456     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  1457         GO TO 1000-NO-NET-PAY.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  28
* ELRFND.cbl
  1458
  1459     IF  CP-COMPANY-ID IS EQUAL TO 'CID' OR 'CSO'
  1460       IF CP-STATE-STD-ABBRV = 'NC'
  1461         IF CP-REDUCING-LIFE
  1462           IF CP-ORIGINAL-TERM GREATER 60  AND
  1463              DC-GREG-DATE-CYMD GREATER 19810930
  1464                GO TO 1028-NET-PAY-REFUND
  1465           ELSE
  1466              GO TO 1026-REF-R78.
  1467
  1468
  1469     IF CP-STATE-STD-ABBRV = 'NC'
  1470       IF CP-COMPANY-ID EQUAL 'NCL'
  1471          NEXT SENTENCE
  1472       END-IF
  1473       IF CP-REDUCING-LIFE
  1474         IF CP-ORIGINAL-TERM GREATER 60  AND
  1475            DC-GREG-DATE-CYMD GREATER 19810930
  1476             GO TO 1021-ANTICIPATION-REF
  1477         ELSE
  1478             GO TO 1026-REF-R78.
  1479
  1480     IF CP-STATE-STD-ABBRV = 'UT'
  1481       IF CP-COMPANY-ID EQUAL 'NCL'
  1482          NEXT SENTENCE
  1483       END-IF
  1484         IF CP-ORIGINAL-TERM GREATER 62         AND
  1485            CP-LOAN-APR GREATER ZERO            AND
  1486            DC-GREG-DATE-CYMD GREATER 19810831 AND
  1487            DC-GREG-DATE-CYMD LESS    19830901
  1488             GO TO 1028-NET-PAY-REFUND
  1489         ELSE
  1490             GO TO 1026-REF-R78.
  1491
  1492     IF CP-STATE-STD-ABBRV = 'OH'
  1493       IF CP-COMPANY-ID EQUAL 'NCL' OR 'HER'
  1494          NEXT SENTENCE
  1495       END-IF
  1496           IF CP-ORIGINAL-TERM GREATER 60         AND
  1497              CP-CLASS-CODE NOT = 'L '            AND
  1498              CP-LOAN-APR GREATER ZERO            AND
  1499              DC-GREG-DATE-CYMD GREATER 19831031
  1500              GO TO 1028-NET-PAY-REFUND
  1501           ELSE
  1502              GO TO 1026-REF-R78.
  1503
  1504     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1505       IF CP-STATE-STD-ABBRV = 'MT'
  1506         GO TO SKIP-CSO-MT-LF-PROCESSING.
  1507
  1508
  1509     IF CP-STATE-STD-ABBRV = 'MT'
  1510       IF CP-COMPANY-ID EQUAL 'NCL'
  1511          NEXT SENTENCE
  1512       END-IF
  1513         IF CP-ORIGINAL-TERM GREATER 61         AND
  1514            CP-LOAN-APR GREATER ZERO            AND
  1515            DC-GREG-DATE-CYMD GREATER 19830318
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  29
* ELRFND.cbl
  1516             GO TO 1028-NET-PAY-REFUND
  1517         ELSE
  1518             GO TO 1026-REF-R78.
  1519
  1520 SKIP-CSO-MT-LF-PROCESSING.
  1521
  1522     IF CP-STATE-STD-ABBRV = 'RI'
  1523       IF CP-COMPANY-ID EQUAL 'NCL'
  1524          NEXT SENTENCE
  1525       END-IF
  1526         IF CP-ORIGINAL-TERM GREATER 60         AND
  1527            CP-LOAN-APR GREATER ZERO            AND
  1528            DC-GREG-DATE-CYMD GREATER 19831231
  1529             GO TO 1028-NET-PAY-REFUND
  1530         ELSE
  1531             GO TO 1026-REF-R78.
  1532
  1533
  1534 1000-NO-NET-PAY.
  1535
  1536     IF CP-STATE-STD-ABBRV = 'WY'
  1537       IF CP-COMPANY-ID EQUAL 'NCL'
  1538          NEXT SENTENCE
  1539       END-IF
  1540        IF CP-COMPANY-ID = 'TMS'
  1541           GO TO 1026-REF-R78
  1542        ELSE
  1543           GO TO 1023-REF-PR.
  1544
  1545     IF CP-EARN-BY-R78
  1546         GO TO 1026-REF-R78.
  1547
  1548     IF CP-EARN-AS-SUM-OF-DIGITS
  1549         GO TO 1075-SUM-OF-DIGITS.
  1550
  1551     IF CP-LEVEL-LIFE
  1552         GO TO 1023-REF-PR
  1553     ELSE
  1554         GO TO 1026-REF-R78.
  1555
  1556*-----------------------------------------------------------------
  1557 1021-ANTICIPATION-REF.
  1558     MOVE '6'                  TO CP-REFUND-TYPE-USED.
  1559
  1560     MOVE CP-LOAN-TERM         TO WS-SAVE-LOAN-TERM.
  1561     IF CP-LOAN-TERM = ZEROS
  1562        MOVE CP-ORIGINAL-TERM TO CP-LOAN-TERM
  1563     END-IF
  1564     COMPUTE CP-LOAN-TERM = CP-LOAN-TERM - CP-ORIGINAL-TERM +
  1565                            CP-REMAINING-TERM.
  1566
  1567     MOVE CP-ORIGINAL-BENEFIT  TO WS-SAVE-BENEFIT.
  1568     MOVE CP-ORIGINAL-TERM     TO WS-SAVE-TERM.
  1569     MOVE CP-EARNING-METHOD    TO WS-SAVE-EARN-METHOD.
  1570
  1571     MOVE CP-REMAINING-BENEFIT TO CP-ORIGINAL-BENEFIT.
  1572     MOVE CP-REMAINING-TERM    TO CP-ORIGINAL-TERM.
  1573     MOVE CP-RATING-METHOD     TO CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  30
* ELRFND.cbl
  1574
  1575     IF CP-REMAINING-TERM = WS-SAVE-TERM
  1576         MOVE 'N'              TO CP-ROA-REFUND
  1577     ELSE
  1578         MOVE 'Y'              TO CP-ROA-REFUND.
  1579
  1580******    TO COMPUTE PREMIUM AT REFUND DATE
  1581     PERFORM 2500-GET-RATE.
  1582
  1583     MOVE 'N'                  TO CP-ROA-REFUND.
  1584     MOVE WS-SAVE-BENEFIT      TO CP-ORIGINAL-BENEFIT.
  1585     MOVE WS-SAVE-TERM         TO CP-ORIGINAL-TERM.
  1586     MOVE WS-SAVE-LOAN-TERM    TO CP-LOAN-TERM.
  1587
  1588     IF CP-PREMIUM-RATE = ZEROS
  1589        MOVE '7'                 TO CP-RETURN-CODE
  1590        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1591        GO TO 1999-CALC-REF-AMT-X.
  1592
  1593     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1594
  1595******    TO COMPUTE PREMIUM AT ORIGINAL ISSUE DATE
  1596     PERFORM 2500-GET-RATE.
  1597
  1598     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1599
  1600     IF CP-PREMIUM-RATE = ZEROS
  1601        MOVE '7'            TO CP-RETURN-CODE
  1602        GO TO 1999-CALC-REF-AMT-X.
  1603
  1604     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1605
  1606     IF  WS-ORIG-PREM = ZEROS
  1607         MOVE ZEROS TO WS-NP-REF-FACTOR
  1608        ELSE
  1609         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1610                                            WS-ORIG-PREM.
  1611
  1612     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1613                                        CP-ORIGINAL-PREMIUM.
  1614
  1615     GO TO 1999-CALC-REF-AMT-X.
  1616
  1617*---------------------------------------------------------------
  1618 1022-REF-CRITICAL-PERIOD-LF.
  1619     GO TO 1023-REF-PR.
  1620
  1621*---------------------------------------------------------------
  1622 1023-REF-PR.
  1623     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1624     COMPUTE CP-CALC-REFUND ROUNDED =
  1625            CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1626
  1627     GO TO 1999-CALC-REF-AMT-X.
  1628
  1629*---------------------------------------------------------------
  1630 1024-REF-PR-DAYS.
  1631     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  31
* ELRFND.cbl
  1632     MOVE CP-VALUATION-DT    TO DC-BIN-DATE-2.
  1633     MOVE '1'                TO DC-OPTION-CODE.
  1634     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1635
  1636     IF DATE-CONVERSION-ERROR
  1637         MOVE '2' TO CP-RETURN-CODE
  1638         GO TO 1999-CALC-REF-AMT-X.
  1639
  1640     COMPUTE CP-CALC-REFUND ROUNDED =
  1641         (CP-ORIGINAL-PREMIUM / CP-TERM-OR-EXT-DAYS) *
  1642                 (CP-TERM-OR-EXT-DAYS - DC-ELAPSED-DAYS).
  1643
  1644     GO TO 1999-CALC-REF-AMT-X.
  1645
  1646*---------------------------------------------------------------
  1647 1025-REF-MEAN.
  1648     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1649     COMPUTE CP-CALC-REFUND ROUNDED =
  1650          ((CP-ORIGINAL-PREMIUM * PR-FACTOR) +
  1651           (CP-ORIGINAL-PREMIUM * R78-FACTOR)) * +.5.
  1652
  1653     GO TO 1999-CALC-REF-AMT-X.
  1654
  1655*---------------------------------------------------------------
  1656 1026-REF-R78.
  1657     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1658*    IF CP-TERM-TIMES-TERM
  1659*        COMPUTE R78-FACTOR =
  1660*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1661*               (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1662*
  1663     COMPUTE CP-CALC-REFUND ROUNDED =
  1664        CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1665
  1666     GO TO 1999-CALC-REF-AMT-X.
  1667
  1668*---------------------------------------------------------------
  1669 1027-TEXAS-REFUND.
  1670     MOVE '4'               TO CP-REFUND-TYPE-USED.
  1671     IF CP-PAY-FREQUENCY = ZERO
  1672        MOVE ZERO TO CP-CALC-REFUND
  1673        MOVE '5'  TO CP-RETURN-CODE
  1674        GO TO 1999-CALC-REF-AMT-X.
  1675
  1676     COMPUTE TEX-FACT-4 = (CP-ORIGINAL-TERM * CP-ORIGINAL-TERM) +
  1677         (CP-PAY-FREQUENCY * CP-ORIGINAL-TERM).
  1678
  1679     DIVIDE CP-REMAINING-TERM BY CP-PAY-FREQUENCY
  1680         GIVING TEX-FACT-5
  1681             REMAINDER TEX-FACT-6.
  1682
  1683     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CP-PAY-FREQUENCY.
  1684
  1685     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  1686         (TEX-FACT-5 * CP-PAY-FREQUENCY) +
  1687         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CP-PAY-FREQUENCY))).
  1688
  1689     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  32
* ELRFND.cbl
  1690
  1691     COMPUTE CP-CALC-REFUND ROUNDED = CP-ORIGINAL-PREMIUM
  1692                                        * TEX-FACT-8.
  1693
  1694     GO TO 1999-CALC-REF-AMT-X.
  1695
  1696*---------------------------------------------------------------
  1697 1028-NET-PAY-REFUND.
  1698     MOVE '5'               TO CP-REFUND-TYPE-USED.
  1699     IF CP-LOAN-APR = ZERO
  1700        MOVE ZERO TO CP-CALC-REFUND
  1701        MOVE '1'  TO CP-RETURN-CODE
  1702        GO TO 1999-CALC-REF-AMT-X.
  1703
  1704     MOVE CP-LOAN-APR           TO N-P-APR.
  1705     MOVE CP-ORIGINAL-TERM      TO N-P-ORIG  N-P-LOAN.
  1706     MOVE CP-REMAINING-TERM     TO N-P-REM.
  1707
  1708     IF CP-TRUNCATED-LIFE
  1709        MOVE CP-LOAN-TERM     TO N-P-LOAN.
  1710
  1711     MOVE 'R'                   TO N-P-OPT.
  1712
  1713     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1714
  1715     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  1716                                        CP-ORIGINAL-PREMIUM.
  1717
  1718 1029-UTAH-REFUND.
  1719*
  1720*---------------------------------------------------------------
  1721* FOLLOWING IS FOR TRISH - 10/26/98  (FOR UTAH ONLY).
  1722*---------------------------------------------------------------
  1723*
  1724     GO TO 1999-CALC-REF-AMT-X.
  1725*
  1726*---------------------------------------------------------------
  1727     IF (CP-STATE-STD-ABBRV NOT = 'UT')
  1728                      OR
  1729        (CP-COMPANY-ID EQUAL 'NCL')
  1730         GO TO 1999-CALC-REF-AMT-X.
  1731     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1732
  1733     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1734        GREATER ZERO AND LESS 13
  1735         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1736                 (CP-CALC-REFUND * .05).
  1737
  1738     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1739        GREATER 12 AND LESS 25
  1740         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1741                 (CP-CALC-REFUND * .025).
  1742
  1743     GO TO 1999-CALC-REF-AMT-X.
  1744*---------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  33
* ELRFND.cbl
  1746*---------------------------------------------------------------
  1747 1030-GET-AH-REFUND.
  1748     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1749
  1750     COMPUTE R78-FACTOR =
  1751            ((CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1752                (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1))).
  1753
  1754*    IF CP-TERM-TIMES-TERM
  1755*        COMPUTE R78-FACTOR =
  1756*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1757*            (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1758*
  1759
  1760**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1761**** FOLLOWING.
  1762****       FOR VA. DISABILITY
  1763****                         --- EFF DATE > 123192 AND
  1764****                             TERM > 61 USE RULE OF ANTIC
  1765****                             OTHERWISE USE RULE OF 78.
  1766****
  1767****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1768****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1769****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1770****            WILL FOLLOW.
  1771****
  1772****
  1773****
  1774     IF CP-COMPANY-ID EQUAL 'NCL'
  1775        IF CP-STATE-STD-ABBRV = 'VA'
  1776           IF (DC-GREG-DATE-CYMD GREATER 19921231) AND
  1777              (CP-ORIGINAL-TERM GREATER THAN 61)
  1778               MOVE '6'        TO CP-EARNING-METHOD
  1779               GO TO 1060-ANTICIPATION-REF
  1780            ELSE
  1781               MOVE '1'        TO CP-EARNING-METHOD
  1782               GO TO 1050-R78-REF.
  1783
  1784     IF CP-STATE-STD-ABBRV = 'WY'
  1785        IF CP-COMPANY-ID = 'TMS'
  1786           GO TO 1050-R78-REF.
  1787
  1788     IF CP-COMPANY-ID = 'NCL' OR 'WDS' OR 'CID' OR 'DCC'
  1789         NEXT SENTENCE
  1790     ELSE
  1791         IF CP-CRITICAL-PERIOD
  1792             GO TO 1035-REF-AH-CRITICAL-PERIOD.
  1793
  1794*      THE FOLLOWING HAPPENS WHEN THE REFUND METHOD FOR THE
  1795*    BENEFIT CODE IS A NON REFUNDABLE METHOD
  1796*    I AM CHECKING THE TERM AND REM TERM BECAUSE OF THE 30
  1797*    DAY FREE LOOK PERIOD. ALSO, 55 AND 56 ARE THE BIU CODES
  1798     IF (CP-GAP-NON-REFUNDABLE)
  1799        IF (CP-ORIGINAL-TERM NOT = CP-REMAINING-TERM)
  1800           OR (CP-BENEFIT-CD = '55' OR '56')
  1801           MOVE ZEROS            TO CP-CALC-REFUND
  1802           MOVE 'G'              TO CP-REFUND-TYPE-USED
  1803           GO TO 1999-CALC-REF-AMT-X
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  34
* ELRFND.cbl
  1804        END-IF
  1805     END-IF
  1806     IF CP-GAP-ACTUARIAL
  1807         GO TO 1070-NET-PAY-REFUND
  1808     END-IF
  1809     IF (CP-COMPANY-ID = 'CID')
  1810        AND (CP-STATE-STD-ABBRV = 'MN')
  1811        AND (DC-GREG-DATE-CYMD > 20091231)
  1812        IF (CP-CRITICAL-PERIOD)
  1813           GO TO 1040-PR-REF
  1814        ELSE
  1815           GO TO 1055-MEAN-REF
  1816     END-IF
  1817     IF CP-COMPANY-ID EQUAL 'CID' OR 'DCC'
  1818        IF CP-STATE-STD-ABBRV = 'NC'
  1819           GO TO SKIP-CSO-NC-AH-PROCESSING.
  1820
  1821     IF (CP-COMPANY-ID = 'CID')
  1822        AND (CP-STATE-STD-ABBRV = 'IN')
  1823        AND (DC-GREG-DATE-CYMD < 20030401)
  1824        GO TO 1026-REF-R78
  1825     END-IF
  1826
  1827     IF (CP-COMPANY-ID = 'CID')
  1828        AND (CP-STATE-STD-ABBRV = 'FL')
  1829        AND (DC-GREG-DATE-CYMD > 20030630)
  1830        AND (CP-CRITICAL-PERIOD)
  1831        GO TO 1040-PR-REF
  1832     END-IF
  1833
  1834     IF (CP-COMPANY-ID = 'CID')
  1835        AND (CP-STATE-STD-ABBRV = 'MO')
  1836        AND (DC-GREG-DATE-CYMD > 20030630)
  1837        AND (CP-CRITICAL-PERIOD)
  1838        GO TO 1040-PR-REF
  1839     END-IF
  1840
  1841     IF (CP-COMPANY-ID = 'CID')
  1842        AND (CP-STATE-STD-ABBRV = 'ND')
  1843        AND (CP-CRITICAL-PERIOD)
  1844        AND (DC-GREG-DATE-CYMD > 20011231)
  1845        GO TO 1040-PR-REF
  1846     END-IF
  1847
  1848     IF (CP-COMPANY-ID = 'CID')
  1849        AND (CP-STATE-STD-ABBRV = 'ND')
  1850        AND (DC-GREG-DATE-CYMD > 20011231)
  1851        GO TO 1060-ANTICIPATION-REF
  1852     END-IF
  1853
  1854     IF CP-STATE-STD-ABBRV = 'NC'
  1855       IF CP-COMPANY-ID = 'NCL' OR 'NCB'
  1856          NEXT SENTENCE
  1857       END-IF
  1858         IF DC-GREG-DATE-CYMD GREATER 19810930
  1859            IF CP-EARN-ANTICIPATION
  1860                GO TO 1060-ANTICIPATION-REF
  1861            ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  35
* ELRFND.cbl
  1862                GO TO 1055-MEAN-REF.
  1863
  1864 SKIP-CSO-NC-AH-PROCESSING.
  1865
  1866     IF CP-STATE-STD-ABBRV = 'NM'
  1867       IF CP-COMPANY-ID = 'NCL' OR 'DCC'
  1868          NEXT SENTENCE
  1869       END-IF
  1870         IF DC-GREG-DATE-CYMD GREATER THAN 19871231
  1871            IF CP-COMPANY-ID = 'MON'
  1872              MOVE '6'             TO CP-EARNING-METHOD
  1873              GO TO 1060-ANTICIPATION-REF
  1874             ELSE
  1875              GO TO 1055-MEAN-REF.
  1876
  1877     IF CP-STATE-STD-ABBRV = 'CT'
  1878       IF CP-COMPANY-ID EQUAL 'NCL' OR 'DCC'
  1879          NEXT SENTENCE
  1880       END-IF
  1881          MOVE '6'              TO CP-EARNING-METHOD
  1882          GO TO 1060-ANTICIPATION-REF.
  1883
  1884     IF CP-STATE-STD-ABBRV = 'ME'
  1885       IF CP-COMPANY-ID = 'NCL' OR 'CVL' OR 'DCC'
  1886          NEXT SENTENCE
  1887       END-IF
  1888           IF CP-EARN-BY-PRORATA
  1889              GO TO 1040-PR-REF
  1890           ELSE
  1891              MOVE '6'           TO CP-EARNING-METHOD
  1892              GO TO 1060-ANTICIPATION-REF.
  1893
  1894
  1895     IF CP-COMPANY-ID = 'CID' OR 'DCC'
  1896        IF CP-STATE-STD-ABBRV = 'TX' OR 'VA'
  1897            GO TO SKIP-CSO-TX-VA-AH-PROCESSING.
  1898
  1899     IF CP-STATE-STD-ABBRV = 'TX'
  1900       IF CP-COMPANY-ID = 'NCL' OR 'HER'
  1901          NEXT SENTENCE
  1902       END-IF
  1903        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1904           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1905           MOVE '6'              TO CP-EARNING-METHOD
  1906           GO TO 1060-ANTICIPATION-REF.
  1907
  1908     IF CP-STATE-STD-ABBRV = 'VA'
  1909       IF CP-COMPANY-ID EQUAL 'NCL'
  1910          NEXT SENTENCE
  1911       END-IF
  1912       IF CP-COMPANY-ID = 'NCB'
  1913           MOVE '6'                TO CP-EARNING-METHOD
  1914           GO TO 1060-ANTICIPATION-REF
  1915       ELSE
  1916           IF DC-GREG-DATE-CYMD GREATER 19921231
  1917               IF CP-ORIGINAL-TERM GREATER THAN 61
  1918                   MOVE '6'        TO CP-EARNING-METHOD
  1919                   GO TO 1060-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  36
* ELRFND.cbl
  1920               ELSE
  1921                   MOVE '1'        TO CP-EARNING-METHOD
  1922                   GO TO 1050-R78-REF.
  1923
  1924 SKIP-CSO-TX-VA-AH-PROCESSING.
  1925
  1926     IF CP-EARN-BY-PRORATA
  1927         GO TO 1040-PR-REF.
  1928
  1929     IF CP-EARN-BY-R78
  1930         GO TO 1050-R78-REF.
  1931
  1932     IF CP-EARN-AS-MEAN
  1933        GO TO 1055-MEAN-REF.
  1934
  1935     IF CP-EARN-AS-SUM-OF-DIGITS
  1936         GO TO 1075-SUM-OF-DIGITS.
  1937     IF CP-DCC-SPP-DDF
  1938        GO TO 1080-DCC-DDF-SPECIAL
  1939     END-IF
  1940     IF CP-EARN-AS-CALIF
  1941         GO TO 1060-ANTICIPATION-REF.
  1942
  1943     IF CP-EARN-ANTICIPATION
  1944         GO TO 1060-ANTICIPATION-REF.
  1945
  1946     IF CP-EARN-AS-NET-PAY
  1947         GO TO 1070-NET-PAY-REFUND.
  1948
  1949     GO TO 1050-R78-REF.
  1950
  1951*---------------------------------------------------------------
  1952 1035-REF-AH-CRITICAL-PERIOD.
  1953     IF CP-REMAINING-TERM GREATER +6
  1954        COMPUTE CP-CALC-REFUND ROUNDED =
  1955          CP-ORIGINAL-PREMIUM * (((CP-REMAINING-TERM * +2) - +5) /
  1956                       ((CP-ORIGINAL-TERM * +2) - + 5))
  1957      ELSE
  1958        COMPUTE CP-CALC-REFUND ROUNDED =
  1959          CP-ORIGINAL-PREMIUM * ((CP-REMAINING-TERM *
  1960                                           CP-REMAINING-TERM + 1)
  1961                              /  (+12 * CP-ORIGINAL-TERM) - +30).
  1962
  1963     IF CP-CALC-REFUND LESS ZERO
  1964         MOVE ZERO TO CP-CALC-REFUND.
  1965
  1966     GO TO 1999-CALC-REF-AMT-X.
  1967
  1968*---------------------------------------------------------------
  1969 1040-PR-REF.
  1970     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1971     COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1972
  1973     GO TO 1999-CALC-REF-AMT-X.
  1974
  1975*---------------------------------------------------------------
  1976 1050-R78-REF.
  1977     MOVE '1'               TO CP-REFUND-TYPE-USED.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  37
* ELRFND.cbl
  1978     COMPUTE CP-CALC-REFUND ROUNDED =
  1979           CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1980
  1981     GO TO 1999-CALC-REF-AMT-X.
  1982
  1983*---------------------------------------------------------------
  1984 1055-MEAN-REF.
  1985     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1986     COMPUTE CP-CALC-REFUND ROUNDED =
  1987         ((CP-ORIGINAL-PREMIUM * R78-FACTOR) +
  1988          (CP-ORIGINAL-PREMIUM * PR-FACTOR)) * .5.
  1989
  1990     GO TO 1999-CALC-REF-AMT-X.
  1991
  1992*---------------------------------------------------------------
  1993 1060-ANTICIPATION-REF.
  1994     MOVE '6'               TO CP-REFUND-TYPE-USED.
  1995
  1996     MOVE CP-ORIGINAL-TERM  TO WS-SAVE-TERM.
  1997     MOVE CP-LOAN-TERM      TO WS-SAVE-LOAN-TERM.
  1998     MOVE CP-EARNING-METHOD TO WS-SAVE-EARN-METHOD.
  1999
  2000     MOVE CP-REMAINING-TERM TO CP-ORIGINAL-TERM
  2001                               CP-LOAN-TERM.
  2002     MOVE CP-RATING-METHOD  TO CP-EARNING-METHOD.
  2003
  2004     PERFORM 2500-GET-RATE.
  2005
  2006     MOVE WS-SAVE-TERM      TO CP-ORIGINAL-TERM.
  2007     MOVE WS-SAVE-LOAN-TERM TO CP-LOAN-TERM.
  2008
  2009     IF CP-PREMIUM-RATE = ZEROS
  2010        MOVE '7'                 TO CP-RETURN-CODE
  2011        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  2012        GO TO 1999-CALC-REF-AMT-X.
  2013
  2014     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  2015
  2016     PERFORM 2500-GET-RATE.
  2017
  2018     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  2019
  2020     IF CP-PREMIUM-RATE = ZEROS
  2021        MOVE '7'            TO CP-RETURN-CODE
  2022        GO TO 1999-CALC-REF-AMT-X.
  2023
  2024     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  2025
  2026     IF  WS-ORIG-PREM = ZERO
  2027         MOVE ZERO                TO WS-NP-REF-FACTOR
  2028        ELSE
  2029         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  2030                                            WS-ORIG-PREM.
  2031
  2032     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  2033                                        CP-ORIGINAL-PREMIUM.
  2034
  2035     IF NOT CP-EARN-AS-CALIF
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  38
* ELRFND.cbl
  2036         GO TO 1999-CALC-REF-AMT-X.
  2037
  2038*---------------------------------------------------------------
  2039 1065-CALIF-REGS.
  2040     MOVE '3'               TO CP-REFUND-TYPE-USED.
  2041     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  2042         GIVING FACTOR-5.
  2043
  2044     IF FACTOR-5 NOT GREATER +6  AND
  2045        CP-CLASS-CODE = 'A '
  2046         GO TO 1050-R78-REF.
  2047
  2048     IF FACTOR-5 = ZERO
  2049         MOVE CP-ORIGINAL-PREMIUM   TO CP-CALC-REFUND
  2050         GO TO 1999-CALC-REF-AMT-X.
  2051
  2052     IF CP-ORIGINAL-TERM LESS +014
  2053         GO TO 1999-CALC-REF-AMT-X.
  2054
  2055     MULTIPLY CP-ORIGINAL-TERM BY CP-ORIGINAL-TERM
  2056                                   GIVING FACTOR-5 ROUNDED.
  2057
  2058     MULTIPLY FACTOR-5 BY +0.0000045573 GIVING FACTOR-1 ROUNDED.
  2059
  2060     MULTIPLY +0.001125 BY CP-ORIGINAL-TERM
  2061                                   GIVING FACTOR-2 ROUNDED.
  2062
  2063     SUBTRACT FACTOR-2 FROM FACTOR-1.
  2064     ADD +0.099375 TO FACTOR-1.
  2065
  2066     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  2067                                   GIVING FACTOR-5 ROUNDED.
  2068
  2069     SUBTRACT +1.00 FROM FACTOR-5.
  2070
  2071     IF CP-ORIGINAL-TERM LESS +049
  2072         SUBTRACT +013 FROM CP-ORIGINAL-TERM
  2073                                   GIVING FACTOR-6 ROUNDED
  2074     ELSE
  2075         MOVE +035 TO FACTOR-6.
  2076
  2077     MOVE +001 TO FACTOR-2.
  2078
  2079     DIVIDE FACTOR-5 BY FACTOR-6 GIVING FACTOR-4 ROUNDED.
  2080     SUBTRACT FACTOR-4 FROM FACTOR-2.
  2081     MULTIPLY FACTOR-1 BY FACTOR-2 GIVING FACTOR-3 ROUNDED.
  2082     MOVE +001 TO FACTOR-2.
  2083     SUBTRACT FACTOR-3 FROM FACTOR-2 GIVING FACTOR-1 ROUNDED.
  2084
  2085     MULTIPLY FACTOR-1 BY CP-CALC-REFUND
  2086         GIVING CAL-RFND ROUNDED.
  2087
  2088     IF CAL-RFND LESS +0.01
  2089         MOVE ZEROS TO CAL-RFND.
  2090
  2091     IF CAL-RFND LESS CP-CALC-REFUND
  2092         MOVE CAL-RFND TO CP-CALC-REFUND.
  2093
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  39
* ELRFND.cbl
  2094     GO TO 1999-CALC-REF-AMT-X.
  2095
  2096*-----------------------------------------------------------------
  2097 1070-NET-PAY-REFUND.
  2098     MOVE '5'                    TO  CP-REFUND-TYPE-USED.
  2099     IF CP-LOAN-APR = ZERO
  2100         MOVE ZEROS              TO  CP-CALC-REFUND
  2101         MOVE '1'                TO  CP-RETURN-CODE
  2102         GO TO 1999-CALC-REF-AMT-X.
  2103
  2104     MOVE CP-LOAN-APR            TO  N-P-APR.
  2105     MOVE CP-ORIGINAL-TERM       TO  N-P-ORIG  N-P-LOAN.
  2106     MOVE CP-REMAINING-TERM      TO  N-P-REM.
  2107
  2108     MOVE 'R'                    TO  N-P-OPT.
  2109
  2110     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2111
  2112     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  2113                                        CP-ORIGINAL-PREMIUM.
  2114
  2115     GO TO 1999-CALC-REF-AMT-X.
  2116*---------------------------------------------------------------
  2117
  2118 1075-SUM-OF-DIGITS.
  2119
  2120     MOVE '9'               TO CP-REFUND-TYPE-USED.
  2121
  2122     COMPUTE RSUM-REMAINING-TERM =
  2123             CP-LOAN-TERM -
  2124                  (CP-ORIGINAL-TERM - (CP-REMAINING-TERM + 1))
  2125
  2126     COMPUTE RSUM-FACTOR =
  2127        ((RSUM-REMAINING-TERM * (RSUM-REMAINING-TERM + 1)) -
  2128               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2129                 (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1)))   /
  2130            ((CP-LOAN-TERM * (CP-LOAN-TERM + 1))           -
  2131               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2132                 (CP-LOAN-TERM - CP-ORIGINAL-TERM  + 1))).
  2133
  2134     COMPUTE CP-CALC-REFUND ROUNDED =
  2135           CP-ORIGINAL-PREMIUM * RSUM-FACTOR.
  2136
  2137     GO TO 1999-CALC-REF-AMT-X
  2138     .
  2139 1080-DCC-DDF-SPECIAL.
  2140     COMPUTE CP-MONTH =
  2141        FUNCTION REM(CP-ORIGINAL-TERM - CP-REMAINING-TERM, 12)
  2142*    DISPLAY ' BEGIN ELCRFNDP ************** '
  2143*    DISPLAY ' SPEC       ' CP-DDF-SPEC-CALC
  2144*    DISPLAY ' MONTH      ' CP-MONTH
  2145*    DISPLAY ' ORIG TERM  ' CP-ORIGINAL-TERM
  2146*    DISPLAY ' REM TERM   ' CP-REMAINING-TERM
  2147*    DISPLAY ' ORIG PREM  ' CP-ORIGINAL-PREMIUM
  2148*    DISPLAY ' 1YR EXP AL ' CP-1ST-YR-ALLOW
  2149*    DISPLAY ' HI FACT    ' CP-DDF-HI-FACT
  2150*    DISPLAY ' LO FACT    ' CP-DDF-LO-FACT
  2151*    DISPLAY ' RATE UP    ' CP-IU-RATE-UP
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  40
* ELRFND.cbl
  2152*    DISPLAY ' CLP RAT UP ' CP-CLP-RATE-UP
  2153*    DISPLAY ' EARM METH  ' CP-EARNING-METHOD
  2154*    DISPLAY '   END ELCRFNDP ************** '
  2155     IF CP-MONTH = 0
  2156        MOVE 12                  TO CP-MONTH
  2157     END-IF
  2158     MOVE CP-MONTH               TO WS-MONTH
  2159     MOVE 'D'                    TO CP-REFUND-TYPE-USED
  2160     IF CP-DCC-SPP-DDF-IU
  2161        GO TO 1090-DCC-DDF-IU
  2162     END-IF
  2163     IF CP-CALC-CLP
  2164        GO TO 1085-DCC-DDF-SPECIAL-CLP
  2165     END-IF
  2166     EVALUATE TRUE
  2167        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2168           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2169           MOVE CP-ORIGINAL-PREMIUM
  2170                                 TO CP-CALC-REFUND
  2171        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2172           MOVE CP-MONTH         TO WS-MONTH
  2173           PERFORM 1150-UE-GROSS-LT-4
  2174           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2175        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2176           MOVE CP-MONTH         TO WS-MONTH
  2177           PERFORM 1160-UE-GROSS-LT-13
  2178           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2179        WHEN OTHER
  2180           MOVE CP-MONTH         TO WS-MONTH
  2181           PERFORM 1170-UE-GROSS-GT-12
  2182           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2183     END-EVALUATE
  2184     GO TO 1999-CALC-REF-AMT-X
  2185     .
  2186 1085-DCC-DDF-SPECIAL-CLP.
  2187     EVALUATE TRUE
  2188        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2189           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2190           MOVE CP-ORIGINAL-PREMIUM
  2191                                 TO CP-CALC-REFUND
  2192        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2193           MOVE CP-MONTH         TO WS-MONTH
  2194           PERFORM 1100-UE-CLP-LT-4
  2195           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2196        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2197           MOVE CP-MONTH         TO WS-MONTH
  2198           PERFORM 1110-UE-CLP-LT-13
  2199           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2200        WHEN OTHER
  2201           MOVE CP-MONTH         TO WS-MONTH
  2202           PERFORM 1120-UE-CLP-GT-12
  2203           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2204     END-EVALUATE
  2205     GO TO 1999-CALC-REF-AMT-X
  2206     .
  2207 1090-DCC-DDF-IU.
  2208     MOVE 'I'                    TO CP-REFUND-TYPE-USED
  2209     IF CP-CALC-CLP
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  41
* ELRFND.cbl
  2210        GO TO 1095-DCC-DDF-IU-SPECIAL-CLP
  2211     END-IF
  2212     EVALUATE TRUE
  2213        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2214           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2215           MOVE CP-ORIGINAL-PREMIUM
  2216                                 TO CP-CALC-REFUND
  2217        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2218           MOVE CP-MONTH         TO WS-MONTH
  2219           PERFORM 1250-IU-UE-GROSS-LT-4
  2220           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2221        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2222           MOVE CP-MONTH         TO WS-MONTH
  2223           PERFORM 1260-IU-UE-GROSS-LT-13
  2224           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2225        WHEN OTHER
  2226           MOVE CP-MONTH         TO WS-MONTH
  2227           PERFORM 1270-IU-UE-GROSS-GT-12
  2228           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2229     END-EVALUATE
  2230     GO TO 1999-CALC-REF-AMT-X
  2231     .
  2232 1095-DCC-DDF-IU-SPECIAL-CLP.
  2233     EVALUATE TRUE
  2234        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2235           OR (CP-DDF-CLP = ZEROS)
  2236           MOVE CP-DDF-CLP       TO CP-CALC-REFUND
  2237        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2238           MOVE CP-MONTH         TO WS-MONTH
  2239           PERFORM 1200-IU-UE-CLP-LT-4
  2240           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2241        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2242           MOVE CP-MONTH         TO WS-MONTH
  2243           PERFORM 1210-IU-UE-CLP-LT-13
  2244           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2245        WHEN OTHER
  2246           MOVE CP-MONTH         TO WS-MONTH
  2247           PERFORM 1220-IU-UE-CLP-GT-12
  2248           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2249     END-EVALUATE
  2250     GO TO 1999-CALC-REF-AMT-X
  2251     .
  2252 1100-UE-CLP-LT-4.
  2253*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*mo/12}
  2254     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2255        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2256        / CP-DDF-CLP - CP-DDF-HI-FACT)
  2257        * WS-MONTH / 12)
  2258     .
  2259 1110-UE-CLP-LT-13.
  2260*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12}
  2261*****  -[(CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12
  2262*****  -CLP*UEF1}*(mo-3)/9]
  2263     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2264        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2265        / CP-DDF-CLP - CP-DDF-HI-FACT) * 3 / 12)
  2266        -  ((CP-DDF-CLP - 0) - CP-DDF-CLP
  2267        * (((CP-DDF-CLP - 0) / CP-DDF-CLP
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  42
* ELRFND.cbl
  2268        - CP-DDF-HI-FACT) * 3 / 12) - CP-DDF-CLP
  2269        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2270     .
  2271 1120-UE-CLP-GT-12.
  2272*****  CLP * {UEF1 - (UEF1 -UEF2)*mo/12}
  2273     COMPUTE WS-TEMP-RESULT ROUNDED = CP-DDF-CLP *
  2274        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2275        * WS-MONTH / 12)
  2276     .
  2277 1150-UE-GROSS-LT-4.
  2278     COMPUTE CP-1ST-YR-ALLOW = CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2279     COMPUTE WS-TEMP-RESULT ROUNDED =
  2280        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2281        * WS-MONTH / 3) - (CP-ORIGINAL-PREMIUM -
  2282        CP-1ST-YR-ALLOW - CP-DDF-YR1AF) * (1 - CP-DDF-HI-FACT)
  2283        * WS-MONTH / 12
  2284     .
  2285 1160-UE-GROSS-LT-13.
  2286     MOVE 3                      TO WS-MONTH
  2287     PERFORM 1150-UE-GROSS-LT-4
  2288     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2289     MOVE CP-MONTH               TO WS-MONTH
  2290     COMPUTE WS-TEMP-RESULT ROUNDED = WS-GFR3 - (WS-GFR3
  2291        - (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF)
  2292        * (CP-DDF-HI-FACT)) * ((WS-MONTH - 3) / 9)
  2293     .
  2294 1170-UE-GROSS-GT-12.
  2295*****  (GF-Yr1 Texp) * {UEF1 - (UEF1 -UEF2)*mo/12}
  2296     COMPUTE WS-TEMP-RESULT ROUNDED =
  2297        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW)
  2298        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2299        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2300     .
  2301 1200-IU-UE-CLP-LT-4.
  2302*****  no changes with < 4  pema 08/03/11
  2303*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*mo/12)
  2304     COMPUTE WS-TEMP-RESULT ROUNDED =
  2305        (CP-DDF-CLP - 0)
  2306        - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2307        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2308        * WS-MONTH / 12
  2309     .
  2310 1210-IU-UE-CLP-LT-13.
  2311*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2312*****  -[(CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2313*****  - CLP*UEF1]*(mo-3)/9
  2314     MOVE 3                      TO WS-MONTH
  2315     PERFORM 1200-IU-UE-CLP-LT-4
  2316     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2317     MOVE CP-MONTH               TO WS-MONTH
  2318     COMPUTE WS-TEMP-RESULT ROUNDED =
  2319        WS-UE-CLP - (WS-UE-CLP - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2320          * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2321     .
  2322 1220-IU-UE-CLP-GT-12.
  2323*****  CLP*{UEF1 - (UEF1 -UEF2)*mo/12}
  2324     COMPUTE WS-TEMP-RESULT ROUNDED =
  2325        (CP-DDF-CLP - CP-CLP-RATE-UP)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  43
* ELRFND.cbl
  2326        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2327        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2328     .
  2329 1250-IU-UE-GROSS-LT-4.
  2330*****  (Comm+MngtFee)*UECLPmo/CLPCounty+CLPCounty+AdminFee-
  2331*****  Yr1 AF*(mo/3)-[CLP*(UEF1-UEF2)+(AdminFee-Yr1AF)*
  2332*****  (1-UEF1)]*mo/12
  2333     PERFORM 1200-IU-UE-CLP-LT-4
  2334     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2335     COMPUTE WS-TEMP-RESULT = CP-DDF-COMM-AND-MFEE *
  2336        WS-UE-CLP / CP-DDF-CLP + CP-DDF-CLP +
  2337        CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF *
  2338        WS-MONTH / 3 - ((CP-DDF-CLP - CP-CLP-RATE-UP)
  2339        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2340        + (CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF)
  2341        * (1 - CP-DDF-HI-FACT)) * WS-MONTH / 12
  2342     .
  2343 1260-IU-UE-GROSS-LT-13.
  2344***** uegf3-(uegf3-(gf - 1st yr - clprateu)*hi))*(mo-3)/9
  2345     MOVE 3                      TO WS-MONTH
  2346     PERFORM 1250-IU-UE-GROSS-LT-4
  2347     move cp-month               to ws-month
  2348     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2349     COMPUTE WS-TEMP-RESULT ROUNDED =
  2350        WS-GFR3 - (WS-GFR3 - ((CP-ORIGINAL-PREMIUM
  2351        - CP-1ST-YR-ALLOW - cp-clp-rate-up))
  2352        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2353     .
  2354 1270-IU-UE-GROSS-GT-12.
  2355***** (gf - 1st yr - clprateu)*(hi-(hi-lo)*mo/12)
  2356     COMPUTE WS-TEMP-RESULT ROUNDED =
  2357        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW
  2358        - CP-CLP-RATE-UP) *
  2359        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2360        * WS-MONTH / 12)
  2361     .
  2362 1299-END-DDF-CALCS.
  2363     .
  2364 1999-CALC-REF-AMT-X.
  2365
  2366     MOVE CALCULATION-PASS-AREA TO DFHCOMMAREA.
  2367
  2368
  2369* EXEC CICS RETURN
  2370*    END-EXEC.
  2371*    MOVE '.(                    &   #00002364' TO DFHEIV0
  2372     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2373     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2374     MOVE X'2020233030303032333634' TO DFHEIV0(25:11)
  2375     CALL 'kxdfhei1' USING DFHEIV0,
  2376           DFHEIV99,
  2377           DFHEIV99,
  2378           DFHEIV99,
  2379           DFHEIV99,
  2380           DFHEIV99
  2381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2382
  2383
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  44
* ELRFND.cbl
  2384* GOBACK.
  2385     MOVE '9%                    "   ' TO DFHEIV0
  2386     MOVE 'ELRFND' TO DFHEIV1
  2387     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2388     GOBACK.
  2389
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  45
* ELRFND.cbl
  2391  2500-GET-RATE.
  2392
  2393* EXEC CICS LINK
  2394*        PROGRAM    ('ELRATE')
  2395*        COMMAREA   (CALCULATION-PASS-AREA)
  2396*        LENGTH     (CP-COMM-LENGTH)
  2397*        END-EXEC.
  2398     MOVE 'ELRATE' TO DFHEIV1
  2399*    MOVE '."C                   ''   #00002370' TO DFHEIV0
  2400     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2401     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2402     MOVE X'2020233030303032333730' TO DFHEIV0(25:11)
  2403     CALL 'kxdfhei1' USING DFHEIV0,
  2404           DFHEIV1,
  2405           CALCULATION-PASS-AREA,
  2406           CP-COMM-LENGTH,
  2407           DFHEIV99,
  2408           DFHEIV99,
  2409           DFHEIV99
  2410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2411
  2412
  2413  2500-EXIT.
  2414       EXIT.
  2415
  2416  9100-CONVERT-DATE.
  2417
  2418* EXEC CICS LINK
  2419*         PROGRAM   ('ELDATCV')
  2420*         COMMAREA  (DATE-CONVERSION-DATA)
  2421*         LENGTH    (DC-COMM-LENGTH)
  2422*    END-EXEC.
  2423     MOVE 'ELDATCV' TO DFHEIV1
  2424*    MOVE '."C                   ''   #00002380' TO DFHEIV0
  2425     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2426     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2427     MOVE X'2020233030303032333830' TO DFHEIV0(25:11)
  2428     CALL 'kxdfhei1' USING DFHEIV0,
  2429           DFHEIV1,
  2430           DATE-CONVERSION-DATA,
  2431           DC-COMM-LENGTH,
  2432           DFHEIV99,
  2433           DFHEIV99,
  2434           DFHEIV99
  2435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2436
  2437
  2438  9100-EXIT.
  2439       EXIT.
  2440
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  46
* ELRFND.cbl
  2442  10000-NET-TERM  SECTION.
  2443*                      COPY ERCNETP.
  2444*****************************************************************
  2445*                                                               *
  2446*                            ERCNETP                            *
  2447*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2448*                            VMOD=2.029                         *
  2449*                                                               *
  2450*****************************************************************.
  2451*
  2452*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  2453*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  2454*                                   ORIGINAL TERM (S999)
  2455*                                   REMAINING TERM (S999)
  2456*                                   NET PAY OPTION (X)
  2457*                                   LOAN TERM (S999)
  2458*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  2459*
  2460*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  2461*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  2462*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  2463*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  2464*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  2465*    CHARGED.
  2466*
  2467*    OPTIONS - S = NET SIMPLE
  2468*          SPACE = NET PAY  (1 MO. INTEREST)
  2469*              A = NET PAY  (0 MO. INTEREST)
  2470*              I = NET PAY  (2 MO. INTEREST)
  2471*              J = NET PAY  (3 MO. INTEREST)
  2472*              K = NET PAY  (4 MO. INTEREST)
  2473*              T = TRUNCATED  (0 MO. INTEREST)
  2474*              U = TRUNCATED  (1 MO. INTEREST)
  2475*              V = TRUNCATED  (2 MO. INTEREST)
  2476*              W = TRUNCATED  (3 MO. INTEREST)
  2477*              X = TRUNCATED  (4 MO. INTEREST)
  2478*              R = REFUNDS (REGULAR OR TRUNCATED)
  2479******************************************************************
  2480*                   C H A N G E   L O G
  2481*
  2482* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2483*-----------------------------------------------------------------
  2484*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2485* EFFECTIVE    NUMBER
  2486*-----------------------------------------------------------------
  2487* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  2488* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  2489* 120403                   PEMA  ADD SPECIAL TX CALC
  2490* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2491* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2492* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  2493* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  2494* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  2495* 021207                   PEMA  ADD PA NP
  2496* 022107                   PEMA  ADD NH NP AND NP TRUNC
  2497* 032807                   PEMA  ADD VT NP PLUS 2
  2498* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  2499* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  47
* ELRFND.cbl
  2500* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  2501* 110207      TO 'AL' NET PAY CALC
  2502* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  2503* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  2504* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  2505* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  2506* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  2507* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  2508* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  2509* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2510* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  2511* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2512* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  2513******************************************************************
  2514
  2515     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  2516     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  2517     MOVE N-P-LOAN    TO LOAN-TERM.
  2518     MOVE N-P-REM     TO REMAINING-TERM.
  2519     MOVE N-P-OPT     TO OPTION-SW.
  2520
  2521     MOVE +0 TO FACTOR.
  2522
  2523     IF ANNUAL-INT-RATE = ZERO
  2524         GO TO 99000-ERROR.
  2525     IF ORIGINAL-TERM = ZERO
  2526         GO TO 99999-RETURN.
  2527     IF REMAINING-TERM = ZERO
  2528         GO TO 99999-RETURN.
  2529     IF REMAINING-TERM GREATER ORIGINAL-TERM
  2530         GO TO 99000-ERROR.
  2531     IF LOAN-TERM = ZERO
  2532         GO TO 99999-RETURN.
  2533     IF LOAN-TERM LESS ORIGINAL-TERM
  2534         GO TO 99000-ERROR.
  2535
  2536*    IF ANNUAL-INT-RATE LESS +2
  2537*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2538*    IF ANNUAL-INT-RATE LESS +2
  2539*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2540*    IF ANNUAL-INT-RATE LESS +2
  2541*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  2542
  2543     IF NPO-REFUND
  2544         MOVE '2' TO NP-PROCESS-SW
  2545       ELSE
  2546         IF ORIGINAL-TERM = REMAINING-TERM
  2547            MOVE '1'   TO NP-PROCESS-SW
  2548           ELSE
  2549            MOVE '3'   TO NP-PROCESS-SW.
  2550
  2551     IF NPO-SIMPLE
  2552         MOVE 'S' TO TYPE-SW
  2553     ELSE
  2554         MOVE 'N' TO TYPE-SW.
  2555
  2556     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  2557
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  48
* ELRFND.cbl
  2558     COMPUTE V ROUNDED = K1 / (K1 + I).
  2559
  2560     MOVE V     TO VX
  2561                   SV.
  2562
  2563     MOVE +1    TO X1
  2564                   SX.
  2565
  2566     MOVE LOAN-TERM TO MAX-X.
  2567
  2568     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  2569
  2570     IF MAX-X = +1
  2571        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  2572
  2573     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  2574
  2575     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  2576         OR 'DCC'        OR 'NCL') AND
  2577        (NOT NP-REFUND)
  2578        NEXT SENTENCE
  2579     ELSE
  2580     IF LOAN-TERM NOT = ORIGINAL-TERM
  2581        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  2582
  2583     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  2584
  2585 10500-VX-LOOP.
  2586
  2587***  VX = AMORT. LOAN TERM.
  2588***  SV = AMORT. INSURANCE TERM.
  2589***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  2590***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  2591***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  2592
  2593     IF X2 = 1
  2594        MOVE V         TO SX
  2595     END-IF
  2596     COMPUTE VX ROUNDED = VX * V.
  2597
  2598     ADD B1 TO X1.
  2599
  2600     IF X1 = REMAINING-TERM
  2601          MOVE VX    TO SV.
  2602
  2603     IF X1 EQUAL SV-MINUS-ONE
  2604        MOVE VX      TO SV-MINUS-ONE.
  2605
  2606     IF X1 = X2
  2607          MOVE VX    TO SX.
  2608
  2609     IF X1 NOT = MAX-X
  2610          GO TO 10500-VX-LOOP.
  2611
  2612 10700-COMPUTE-REMAINING-FACTOR.
  2613*****  WK1 = LOAN TERM AMORT
  2614     COMPUTE WK1 = K1 - VX.
  2615*****  WK2 = INS TERM AMORT
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  49
* ELRFND.cbl
  2616     COMPUTE WK2 = K1 - SV.
  2617*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  2618     COMPUTE WK5 = K1 - SX.
  2619*****  WK6 = INS TERM - 1
  2620     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  2621
  2622     IF NP-RATING
  2623         GO TO 12000-PREMIUM-RATE.
  2624
  2625     IF NP-REFUND
  2626         GO TO 11000-REFUND-CALC.
  2627
  2628     IF NET-STD
  2629         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  2630
  2631     IF NET-SMP
  2632         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  2633         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  2634         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  2635         COMPUTE WK3 ROUNDED = WK3 * 1000.
  2636
  2637     IF REMAINING-TERM LESS THAN X2
  2638         MOVE +0 TO WK3.
  2639
  2640     MOVE WK3 TO FACTOR.
  2641
  2642     GO TO 99999-RETURN.
  2643
  2644 11000-REFUND-CALC.
  2645     IF REMAINING-TERM NOT LESS MAX-X
  2646        MOVE +1 TO FACTOR
  2647        GO TO 99999-RETURN.
  2648
  2649     IF REMAINING-TERM LESS +1
  2650        MOVE 0 TO FACTOR
  2651        GO TO 99999-RETURN.
  2652
  2653     COMPUTE WK2 ROUNDED = WK2 / I.
  2654     COMPUTE WK5 ROUNDED = WK5 / I.
  2655     COMPUTE WK1 ROUNDED = WK1 / I.
  2656
  2657     IF (CP-COMPANY-ID EQUAL 'CID')
  2658        AND (CP-STATE-STD-ABBRV = 'MN')
  2659        AND (CP-CERT-EFF-DT > X'A4FF')
  2660        AND (CP-RATE-AS-REG-BALLOON)
  2661        AND (CP-EARN-AS-NET-PAY)
  2662        AND (CP-DEVIATION-CODE NOT = 'LEV')
  2663        CONTINUE
  2664     ELSE
  2665        GO TO 11000-CHECK-MN-LEV-BALLOON
  2666     END-IF
  2667
  2668     COMPUTE R = M - E
  2669     COMPUTE FACTOR = (R - WK2 + WK5) /
  2670        (M - WK1 + WK5)
  2671
  2672     GO TO 99999-RETURN
  2673
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  50
* ELRFND.cbl
  2674      .
  2675 11000-CHECK-MN-LEV-BALLOON.
  2676
  2677     IF (CP-COMPANY-ID EQUAL 'CID')
  2678        AND (CP-STATE-STD-ABBRV = 'MN')
  2679        AND (CP-CERT-EFF-DT > X'A4FF')
  2680        AND (CP-RATE-AS-REG-BALLOON)
  2681        AND (CP-EARN-AS-NET-PAY)
  2682        AND (CP-DEVIATION-CODE = 'LEV')
  2683        CONTINUE
  2684     ELSE
  2685        GO TO 11000-CONTINUE-REFUND
  2686     END-IF
  2687
  2688     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  2689     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  2690        ** (M - E)) / I
  2691
  2692     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  2693
  2694     GO TO 99999-RETURN
  2695
  2696     .
  2697 11000-CONTINUE-REFUND.
  2698*    IF CP-GAP-ACTUARIAL
  2699*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  2700*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2701*       COMPUTE WK3 = WK2 / ANGLEN
  2702*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  2703     IF CP-GAP-ACTUARIAL
  2704        COMPUTE ANGLEN = WK1 / ((1 + I) **
  2705           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2706        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  2707     ELSE
  2708        COMPUTE WK3 ROUNDED =
  2709          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  2710     END-IF
  2711
  2712     MOVE WK3  TO FACTOR.
  2713
  2714     GO TO 99999-RETURN.
  2715
  2716 12000-PREMIUM-RATE.
  2717*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  2718*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  2719*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  2720*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  2721*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  2722*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  2723
  2724     COMPUTE K-I = K1 + I.
  2725     MOVE K-I TO ONE-PLUS-I.
  2726
  2727     IF NPO-ALT OR NPO-TRUNC-0
  2728         MOVE K1 TO K-I.
  2729
  2730     IF NPO-2MO OR NPO-TRUNC-2
  2731         COMPUTE K-I = K1 + (2 * I).
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  51
* ELRFND.cbl
  2732
  2733     IF NPO-3MO OR NPO-TRUNC-3
  2734         COMPUTE K-I = K1 + (3 * I).
  2735
  2736     IF NPO-4MO OR NPO-TRUNC-4
  2737         COMPUTE K-I = K1 + (4 * I).
  2738
  2739     COMPUTE RA ROUNDED = 1 -
  2740             ((X2 * (X2 + 1)) /
  2741              (N *  (N  + 1))).
  2742
  2743     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2744        (CP-CSL-VALID-NP-BENEFIT-CD)
  2745        NEXT SENTENCE
  2746     ELSE
  2747        GO TO XXXX-CHECK-DISCOUNT-5.
  2748
  2749     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2750     MOVE ' ' TO DC-OPTION-CODE.
  2751     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2752
  2753     IF DATE-CONVERSION-ERROR
  2754        MOVE '2'                 TO CP-RETURN-CODE
  2755        MOVE ZEROS               TO FACTOR
  2756                                    CP-CALC-PREMIUM
  2757         GO TO 99999-RETURN.
  2758
  2759     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  2760     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  2761     MOVE ' ' TO DC-OPTION-CODE
  2762     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2763
  2764     IF DATE-CONVERSION-ERROR
  2765        MOVE '2'                 TO CP-RETURN-CODE
  2766        MOVE ZEROS               TO FACTOR
  2767                                    CP-CALC-PREMIUM
  2768         GO TO 99999-RETURN.
  2769
  2770     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  2771
  2772     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  2773
  2774     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  2775        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  2776        CP-PAY-FREQUENCY / 365) * I
  2777     ELSE
  2778        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  2779        CP-PAY-FREQUENCY / 365) * I.
  2780
  2781     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  2782     13).
  2783
  2784     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  2785     (N - ( ANGLEN-1 / WK3)).
  2786
  2787     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  2788
  2789     COMPUTE WS-CALC-FREQ-RATE EQUAL
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  52
* ELRFND.cbl
  2790       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  2791
  2792     COMPUTE WS-Y-X-FACTOR EQUAL
  2793       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  2794       WS-CALC-FREQ-RATE).
  2795
  2796     COMPUTE WS-ODD-DAY-UNITS EQUAL
  2797       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  2798
  2799     COMPUTE WS-X-Y-FACTOR EQUAL
  2800       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  2801
  2802     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  2803       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  2804       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  2805
  2806     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  2807
  2808     GO TO 99999-RETURN.
  2809
  2810 XXXX-CHECK-DISCOUNT-5.
  2811
  2812     IF WS-DISCOUNT-OPTION EQUAL '5'
  2813        NEXT SENTENCE
  2814     ELSE
  2815        GO TO 12000-CHECK-CLIENT.
  2816
  2817      COMPUTE ANGLEN EQUAL WK1 / I.
  2818
  2819      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  2820
  2821      COMPUTE WK3 EQUAL
  2822        (12 *
  2823        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  2824        CP-ORIGINAL-BENEFIT)) /
  2825        APR100.
  2826
  2827     COMPUTE WK3 EQUAL
  2828        (WK3 * CP-PREMIUM-RATE) / +1000.
  2829
  2830     COMPUTE WK3 EQUAL
  2831        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  2832
  2833      MOVE WK3 TO CP-CALC-PREMIUM.
  2834
  2835     GO TO 99999-RETURN.
  2836
  2837 12000-CHECK-CLIENT.
  2838
  2839     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2840        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2841        (CP-TRUNCATED-LIFE)
  2842        NEXT SENTENCE
  2843     ELSE
  2844        GO TO 12000-CHECK-NEXT.
  2845
  2846     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  2847
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  53
* ELRFND.cbl
  2848     COMPUTE ANGLEN EQUAL WK1 / I.
  2849     COMPUTE ANGLEM EQUAL WK2 / I.
  2850
  2851     COMPUTE FM EQUAL
  2852                    (((ONE-PLUS-I ** M) * I * M) /
  2853                    ((ONE-PLUS-I ** M) - 1))
  2854                    - 1.
  2855
  2856     COMPUTE FN EQUAL
  2857                    (((ONE-PLUS-I ** N) * I * N) /
  2858                    ((ONE-PLUS-I ** N) - 1))
  2859                    - 1.
  2860
  2861     COMPUTE FNM EQUAL
  2862                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  2863                    ((ONE-PLUS-I ** (N - M)) - 1))
  2864                    - 1.
  2865
  2866     COMPUTE GR EQUAL
  2867                    (WS-WORK-RATE * ANGLEM * I) /
  2868                    (M - ANGLEM).
  2869
  2870     COMPUTE ODF EQUAL
  2871                     (1 +
  2872                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  2873                     360)) /
  2874                     ONE-PLUS-I.
  2875
  2876     COMPUTE OD EQUAL
  2877                    (1 + (ODF * (FN / I - 1))) +
  2878                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  2879
  2880     COMPUTE WK3 EQUAL
  2881*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  2882                    ((1 + FN) * ODF *
  2883                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  2884                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  2885                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  2886
  2887     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  2888     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  2889
  2890     COMPUTE WK3 EQUAL
  2891                    (WK3 / (ODF * (1 + FN))) -
  2892*                   CP-ORIGINAL-BENEFIT.
  2893                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  2894
  2895      MOVE WK3 TO CP-CALC-PREMIUM.
  2896
  2897     GO TO 99999-RETURN.
  2898
  2899 12000-CHECK-NEXT.
  2900
  2901     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  2902        NEXT SENTENCE
  2903     ELSE
  2904        GO TO 12000-CHECK-PA-TRUNC.
  2905
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  54
* ELRFND.cbl
  2906      IF WS-WORK-DIS-RATE EQUAL +0
  2907         MOVE '7'                TO CP-RETURN-CODE
  2908         MOVE ZEROS              TO FACTOR
  2909                                    CP-CALC-PREMIUM
  2910         GO TO 99999-RETURN.
  2911
  2912      COMPUTE ANGLEN EQUAL WK1 / I.
  2913
  2914      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  2915
  2916      IF WS-WORK-DIS-RATE EQUAL APR100
  2917         ADD .00001 TO APR100.
  2918
  2919      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  2920      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  2921
  2922     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  2923        / (1 + I)
  2924     COMPUTE ANGLEN-1 = ANGLEN / Y
  2925      IF CP-COMPANY-ID EQUAL 'CDL'
  2926         COMPUTE WK3 EQUAL
  2927
  2928          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  2929          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  2930
  2931          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  2932
  2933          ((WK8 ** N) /
  2934          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  2935
  2936          ((WK9 ** N) /
  2937          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  2938
  2939      ELSE
  2940         COMPUTE WK3 EQUAL
  2941
  2942          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  2943          (12 + WS-WORK-DIS-RATE) * 12) *
  2944
  2945          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  2946
  2947          ((WK8 ** N) /
  2948          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  2949
  2950          ((WK9 ** N) /
  2951          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  2952
  2953      COMPUTE WK3 EQUAL
  2954          (WK3 * CP-PREMIUM-RATE) / +1000.
  2955
  2956      MOVE WK3 TO CP-CALC-PREMIUM.
  2957
  2958     GO TO 99999-RETURN.
  2959
  2960 12000-CHECK-PA-TRUNC.
  2961
  2962     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2963        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  55
* ELRFND.cbl
  2964        (CP-EARN-AS-NET-PAY) AND
  2965        (CP-TRUNCATED-LIFE)
  2966        NEXT SENTENCE
  2967     ELSE
  2968        GO TO 12000-CHECK-MD-TRUNC.
  2969
  2970     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  2971
  2972     COMPUTE ANGLEN-M EQUAL WK5 / I.
  2973     COMPUTE ANGLEN EQUAL WK1 / I.
  2974
  2975     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  2976
  2977     COMPUTE WK3 EQUAL
  2978        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  2979        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  2980
  2981     MOVE WK3 TO CP-CALC-PREMIUM.
  2982
  2983     GO TO 99999-RETURN.
  2984
  2985 12000-CHECK-MD-TRUNC.
  2986
  2987     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2988        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2989        (CP-EARN-AS-NET-PAY) AND
  2990        (CP-TRUNCATED-LIFE)
  2991        NEXT SENTENCE
  2992     ELSE
  2993        GO TO 12000-CHECK-MD.
  2994
  2995     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  2996
  2997     COMPUTE ANGLEN-M EQUAL WK5 / I.
  2998     COMPUTE ANGLEM EQUAL WK2 / I.
  2999     COMPUTE ANGLEN EQUAL WK1 / I.
  3000
  3001     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3002
  3003     COMPUTE WK3 EQUAL
  3004        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3005        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  3006        (ANGLEN-1 * (M - ANGLEM))).
  3007
  3008     MOVE WK3 TO CP-CALC-PREMIUM.
  3009
  3010     GO TO 99999-RETURN.
  3011
  3012 12000-CHECK-MD.
  3013
  3014     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3015        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3016        (CP-EARN-AS-NET-PAY)
  3017        NEXT SENTENCE
  3018     ELSE
  3019        GO TO 12000-CHECK-ME-TRUNC.
  3020
  3021     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  56
* ELRFND.cbl
  3022
  3023     COMPUTE WK3 EQUAL
  3024        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  3025
  3026     MOVE WK3 TO CP-CALC-PREMIUM.
  3027
  3028     GO TO 99999-RETURN.
  3029
  3030 12000-CHECK-ME-TRUNC.
  3031
  3032     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3033        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3034        AND (CP-EARN-AS-NET-PAY)
  3035        AND (CP-TRUNCATED-LIFE)
  3036        CONTINUE
  3037     ELSE
  3038        GO TO 12000-CHECK-CID-FARMPLAN
  3039     END-IF
  3040
  3041     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3042     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3043     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3044     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3045     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3046     COMPUTE ANGLEN-1 = ANGLEN / Y
  3047     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3048     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3049     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3050     COMPUTE WK3
  3051        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3052        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3053            * (1 / (1.0635 ** (M / 12))))
  3054*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  3055*    COMPUTE WK9 EQUAL
  3056*       1 / (1 + (.045 * (N - M) / 24))
  3057*    COMPUTE WK7 EQUAL
  3058*       WS-WORK-RATE * 20 / (M + 1).
  3059*    COMPUTE WK3 EQUAL
  3060*       ((( N - ANGLEN) * WK7 * WK8) /
  3061*       (10 * ANGLEN-1 * I)) -
  3062*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  3063*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  3064*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3065*
  3066     MOVE WK3 TO CP-CALC-PREMIUM.
  3067
  3068     GO TO 99999-RETURN.
  3069 12000-CHECK-CID-FARMPLAN.
  3070     IF (CP-COMPANY-ID EQUAL 'CID')
  3071        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  3072           OR 'IN' OR 'AZ')
  3073        AND (CP-FARM-PLAN)
  3074        CONTINUE
  3075     ELSE
  3076        GO TO 12000-CHECK-SC-CID
  3077     END-IF
  3078     COMPUTE N = M / CP-PAY-FREQUENCY
  3079     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  57
* ELRFND.cbl
  3080     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3081        ** CP-PAY-FREQUENCY) - 1
  3082     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  3083     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3084        ** TI) / WS-WORK-DIS-RATE
  3085     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  3086     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  3087     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3088        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  3089     COMPUTE WK2 = WK2 * (1 + J)
  3090     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3091     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3092     COMPUTE WK3 = WK3 * (1 + J)
  3093     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  3094        ** (N - 1))) / J
  3095     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3096        ((N * WK2) - WK5)) + (N * WK1)) *
  3097        (CP-PREMIUM-RATE / 1000)
  3098     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  3099     COMPUTE WK6 = (WK7 * GR)
  3100     MOVE WK6 TO CP-CALC-PREMIUM
  3101     GO TO 99999-RETURN
  3102     .
  3103 12000-CHECK-SC-CID.
  3104     IF (CP-COMPANY-ID EQUAL 'CID')
  3105        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  3106        AND (CP-EARN-AS-NET-PAY)
  3107        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  3108        CONTINUE
  3109     ELSE
  3110        GO TO 12000-CHECK-AL-CID
  3111     END-IF
  3112     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3113     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3114     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3115     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3116     COMPUTE ANGLEN-1 = ANGLEN / Y
  3117     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3118        / 12)) / ((M + 1) / 2)
  3119     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3120     COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3121        + 6 * M) * (WK2 / 100) * (1 + I)
  3122     MOVE WK3 TO CP-CALC-PREMIUM
  3123     GO TO 99999-RETURN
  3124     .
  3125 12000-CHECK-AL-CID.
  3126     IF (CP-COMPANY-ID EQUAL 'CID')
  3127        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  3128        AND (CP-EARN-AS-NET-PAY)
  3129        CONTINUE
  3130     ELSE
  3131        GO TO 12000-CHECK-NH-CID
  3132     END-IF
  3133     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3134     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3135     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3136     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3137                   / (1 + I)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  58
* ELRFND.cbl
  3138     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3139     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3140     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  3141        (CP-PREMIUM-RATE / 1000)
  3142     MOVE WK3 TO CP-CALC-PREMIUM
  3143     GO TO 99999-RETURN
  3144     .
  3145 12000-CHECK-NH-CID.
  3146     IF (CP-COMPANY-ID EQUAL 'CID')
  3147        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  3148        AND (CP-EARN-AS-NET-PAY)
  3149        CONTINUE
  3150     ELSE
  3151        GO TO 12000-CHECK-PA-CID
  3152     END-IF
  3153     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3154     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3155     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3156                   / (1 + I)
  3157     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3158     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3159     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3160        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  3161     MOVE WK3 TO CP-CALC-PREMIUM
  3162     GO TO 99999-RETURN
  3163     .
  3164 12000-CHECK-PA-CID.
  3165     IF (CP-COMPANY-ID EQUAL 'CID')
  3166        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  3167        AND (CP-EARN-AS-NET-PAY)
  3168        CONTINUE
  3169     ELSE
  3170        GO TO 12000-CHECK-ME-CID
  3171     END-IF
  3172
  3173     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3174     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3175     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3176     COMPUTE ANGLEN-1 = ANGLEN / Y
  3177     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  3178     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3179     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  3180     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3181        * WK5
  3182     MOVE WK3 TO CP-CALC-PREMIUM
  3183     GO TO 99999-RETURN
  3184     .
  3185 12000-CHECK-ME-CID.
  3186     IF (CP-COMPANY-ID EQUAL 'CID')
  3187        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3188        AND (CP-EARN-AS-NET-PAY)
  3189        CONTINUE
  3190     ELSE
  3191        GO TO 12000-CHECK-VT-TRUNC
  3192     END-IF
  3193     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3194     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3195     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  59
* ELRFND.cbl
  3196     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3197     COMPUTE ANGLEN-1 = ANGLEN / Y
  3198     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3199     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3200     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3201        * WK5
  3202     MOVE WK3 TO CP-CALC-PREMIUM
  3203     GO TO 99999-RETURN
  3204     .
  3205 12000-CHECK-VT-TRUNC.
  3206
  3207     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3208        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  3209        (CP-EARN-AS-NET-PAY) AND
  3210        (CP-TRUNCATED-LIFE)
  3211        NEXT SENTENCE
  3212     ELSE
  3213        GO TO 12000-CHECK-VT.
  3214
  3215      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  3216
  3217      COMPUTE ANGLEN EQUAL WK1 / I.
  3218
  3219      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3220
  3221      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  3222      COMPUTE WK9 EQUAL
  3223        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  3224        ((.0054 - I) / (1 + I)).
  3225      COMPUTE WK7 EQUAL
  3226        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  3227      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3228        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  3229
  3230      MOVE WK3 TO CP-CALC-PREMIUM.
  3231
  3232     GO TO 99999-RETURN.
  3233
  3234 12000-CHECK-VT.
  3235
  3236     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3237        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  3238        (CP-EARN-AS-NET-PAY)
  3239        NEXT SENTENCE
  3240     ELSE
  3241        GO TO 12000-CHECK-MINN-WDS.
  3242
  3243      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  3244
  3245      COMPUTE ANGLEN EQUAL WK1 / I.
  3246
  3247      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3248
  3249      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  3250                        (ANGLEN-1 * I)) *
  3251
  3252                        (((1.0054 ** N - 1) /
  3253                        (1.0054 ** (N - 1) * .0054)) -
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  60
* ELRFND.cbl
  3254
  3255                        ((V * (1 - 1.0054 ** N * VX)) /
  3256                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  3257
  3258      MOVE WK3 TO CP-CALC-PREMIUM.
  3259
  3260     GO TO 99999-RETURN.
  3261
  3262 12000-CHECK-MINN-WDS.
  3263
  3264     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3265        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3266        (CP-EARN-AS-NET-PAY)
  3267        NEXT SENTENCE
  3268     ELSE
  3269        GO TO 12000-CHECK-MINN-BALL-LEV.
  3270
  3271     COMPUTE ANGLEN EQUAL WK1 / I.
  3272     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  3273              (N / +12) * (2 / (N + 1)).
  3274     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  3275         WK3 * ((N - ANGLEN) / I).
  3276
  3277      MOVE WK3 TO CP-CALC-PREMIUM.
  3278
  3279     GO TO 99999-RETURN.
  3280
  3281 12000-CHECK-MINN-BALL-LEV.
  3282
  3283     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3284        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3285        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  3286        (CP-EARN-AS-REG-BALLOON)
  3287        NEXT SENTENCE
  3288     ELSE
  3289        GO TO 12000-CHECK-MINN-BALL.
  3290
  3291     COMPUTE ANGLEN EQUAL WK1 / I.
  3292
  3293     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  3294
  3295     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  3296        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  3297
  3298     MOVE WK3 TO CP-CALC-PREMIUM.
  3299
  3300     GO TO 99999-RETURN.
  3301
  3302 12000-CHECK-MINN-BALL.
  3303
  3304     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3305        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3306        (CP-EARN-AS-REG-BALLOON)
  3307        NEXT SENTENCE
  3308     ELSE
  3309        GO TO 12000-CHECK-CID-MN-BALL.
  3310
  3311     COMPUTE ANGLEN EQUAL WK1 / I.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  61
* ELRFND.cbl
  3312     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  3313
  3314     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  3315     / +100 * (N - 1) / 12 * 2 / N *
  3316     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  3317
  3318      MOVE WK3 TO CP-CALC-PREMIUM.
  3319
  3320     GO TO 99999-RETURN.
  3321
  3322 12000-CHECK-CID-MN-BALL.
  3323     IF (CP-COMPANY-ID EQUAL 'CID')
  3324        AND (CP-STATE-STD-ABBRV = 'MN')
  3325        AND (CP-CERT-EFF-DT > X'A4FF')
  3326        AND (CP-EARN-AS-REG-BALLOON)
  3327        CONTINUE
  3328     ELSE
  3329        GO TO 12000-CHECK-NC-WDS
  3330     END-IF
  3331     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3332     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3333     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  3334     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3335     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3336     COMPUTE V = 1 / (1 + I)
  3337     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3338     COMPUTE Y = (1 + (D * I) / +30)
  3339        / (1 + I)
  3340     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  3341        * CP-PREMIUM-RATE / 1000
  3342*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  3343*       MOVE CP-MONTHLY-PAYMENT  TO GR
  3344*    ELSE
  3345*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  3346*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  3347*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  3348*       DISPLAY ' BALLOON TOP ' WK6
  3349*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  3350*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  3351*          / 100
  3352*       DISPLAY ' BALLOON BOTTOM ' WK7
  3353*       COMPUTE GR = WK6 / WK7
  3354*       DISPLAY ' BALLOON PAYMENT ' GR
  3355*    END-IF
  3356     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  3357     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  3358        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  3359     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  3360     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  3361        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  3362           (CP-ALTERNATE-BENEFIT * (M + 1)))
  3363           * CP-PREMIUM-RATE / 1000
  3364     MOVE WK3                    TO CP-CALC-PREMIUM
  3365     GO TO 99999-RETURN.
  3366     .
  3367 12000-CHECK-NC-WDS.
  3368
  3369     IF (CP-COMPANY-ID EQUAL 'WDS') AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  62
* ELRFND.cbl
  3370        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3371        (CP-EARN-AS-NET-PAY)
  3372        NEXT SENTENCE
  3373     ELSE
  3374        GO TO 12000-CHECK-NC-BALL-LEV.
  3375
  3376     COMPUTE WK4 EQUAL N * (1 + I * 2).
  3377     COMPUTE ANGLEN EQUAL WK1 / I.
  3378     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  3379              CP-PREMIUM-RATE / +100 *
  3380              N / +12 * 2 / (N + 1) *
  3381              (WK4 - ANGLEN) / (I * ANGLEN).
  3382
  3383      MOVE WK3 TO CP-CALC-PREMIUM.
  3384
  3385     GO TO 99999-RETURN.
  3386
  3387 12000-CHECK-NC-BALL-LEV.
  3388
  3389     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3390        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3391        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  3392        (CP-EARN-AS-REG-BALLOON)
  3393        NEXT SENTENCE
  3394     ELSE
  3395        GO TO 12000-CHECK-NC-BALL.
  3396
  3397     COMPUTE ANGLEN EQUAL WK1 / I.
  3398
  3399**** VX = 1 / (1 + I)**N.
  3400
  3401     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  3402        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  3403
  3404     MOVE WK3 TO CP-CALC-PREMIUM.
  3405
  3406     GO TO 99999-RETURN.
  3407
  3408 12000-CHECK-NC-BALL.
  3409
  3410     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  3411        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3412        (CP-EARN-AS-REG-BALLOON)
  3413        NEXT SENTENCE
  3414     ELSE
  3415        GO TO 12000-CHECK-MINN-TRUNC.
  3416
  3417     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  3418     COMPUTE ANGLEN EQUAL WK1 / I.
  3419     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  3420**** VX = 1 / (1 + I)**N.
  3421
  3422     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  3423     / +100 * (N - 1) / 12 * 2 / N *
  3424     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  3425
  3426      MOVE WK3 TO CP-CALC-PREMIUM.
  3427
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  63
* ELRFND.cbl
  3428     GO TO 99999-RETURN.
  3429
  3430 12000-CHECK-MINN-TRUNC.
  3431
  3432     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3433        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3434        (M GREATER THAN +63) AND
  3435        (CP-EARN-AS-NET-PAY) AND
  3436        (CP-TRUNCATED-LIFE)
  3437        NEXT SENTENCE
  3438     ELSE
  3439        GO TO 12000-CHECK-MINN.
  3440
  3441      COMPUTE ANGLEN EQUAL WK1 / I.
  3442      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3443
  3444      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3445
  3446      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3447       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3448       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  3449
  3450      MOVE WK3 TO CP-CALC-PREMIUM.
  3451
  3452     GO TO 99999-RETURN.
  3453
  3454 12000-CHECK-MINN.
  3455
  3456     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3457        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  3458        (M GREATER THAN +63) AND
  3459        (CP-EARN-AS-NET-PAY)
  3460        NEXT SENTENCE
  3461     ELSE
  3462        GO TO 12000-CHECK-MONTANA-TRUNC.
  3463
  3464      COMPUTE ANGLEN EQUAL WK1 / I.
  3465
  3466      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3467
  3468      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3469       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3470       (((N - ANGLEN) / I) + (2 * N)).
  3471
  3472      MOVE WK3 TO CP-CALC-PREMIUM.
  3473
  3474     GO TO 99999-RETURN.
  3475
  3476 12000-CHECK-MONTANA-TRUNC.
  3477
  3478     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3479        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  3480        (M GREATER THAN +63) AND
  3481        (CP-EARN-AS-NET-PAY) AND
  3482        (CP-TRUNCATED-LIFE)
  3483        NEXT SENTENCE
  3484     ELSE
  3485        GO TO 12000-CHECK-MONTANA.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  64
* ELRFND.cbl
  3486
  3487      COMPUTE ANGLEN EQUAL WK1 / I.
  3488      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3489
  3490      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3491
  3492      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  3493      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3494       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  3495
  3496      MOVE WK3 TO CP-CALC-PREMIUM.
  3497
  3498     GO TO 99999-RETURN.
  3499
  3500 12000-CHECK-MONTANA.
  3501
  3502     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3503        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  3504        (M GREATER THAN +63) AND
  3505        (CP-EARN-AS-NET-PAY)
  3506        NEXT SENTENCE
  3507     ELSE
  3508        GO TO 12001-CONTINUE-NCL-TRUNC.
  3509
  3510      COMPUTE ANGLEN EQUAL WK1 / I.
  3511
  3512      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3513
  3514      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3515       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3516       (((N - ANGLEN) / I) + (4 * N)).
  3517
  3518      MOVE WK3 TO CP-CALC-PREMIUM.
  3519
  3520     GO TO 99999-RETURN.
  3521
  3522 12001-CONTINUE-NCL-TRUNC.
  3523
  3524     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3525        (CP-EARN-AS-NET-PAY) AND
  3526        (CP-TRUNCATED-LIFE)
  3527        NEXT SENTENCE
  3528     ELSE
  3529        GO TO 12001-CONTINUE-NCL.
  3530
  3531      COMPUTE ANGLEN EQUAL WK1 / I.
  3532      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3533
  3534      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3535
  3536      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  3537      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  3538      (ANGLEN-1 * (N + 1) * I).
  3539
  3540      MOVE WK3 TO CP-CALC-PREMIUM.
  3541
  3542     GO TO 99999-RETURN.
  3543
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  65
* ELRFND.cbl
  3544 12001-CONTINUE-NCL.
  3545
  3546     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3547        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3548        (CP-EARN-AS-NET-PAY)
  3549        GO TO 12001-CHECK-NC-NET-PLUS3.
  3550
  3551     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3552        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  3553        (CP-EARN-AS-NET-PAY)
  3554        GO TO 12001-CHECK-CA.
  3555
  3556     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3557        (CP-EARN-AS-NET-PAY)
  3558        NEXT SENTENCE
  3559     ELSE
  3560        GO TO 12000-CONTINUE-NET.
  3561
  3562      COMPUTE ANGLEN EQUAL WK1 / I.
  3563      MOVE ANGLEN                TO ANGLEN-1.
  3564
  3565      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3566
  3567      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  3568       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  3569       ((N - ANGLEN) / I).
  3570
  3571      MOVE WK3 TO CP-CALC-PREMIUM.
  3572
  3573     GO TO 99999-RETURN.
  3574
  3575 12000-CONTINUE-NET.
  3576
  3577     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  3578        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  3579        (CP-EARN-AS-NET-PAY)
  3580        NEXT SENTENCE
  3581     ELSE
  3582        GO TO 12001-CONTINUE-MINN.
  3583
  3584      COMPUTE ANGLEN EQUAL WK6 / I.
  3585      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  3586
  3587      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  3588      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  3589      COMPUTE WK3 EQUAL (WK3 / I) *
  3590       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  3591
  3592      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  3593         MOVE +0 TO CP-R-MAX-TOT-BEN.
  3594
  3595      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  3596
  3597      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  3598         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  3599         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  3600
  3601      MOVE WK3 TO CP-CALC-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  66
* ELRFND.cbl
  3602
  3603     GO TO 99999-RETURN.
  3604
  3605 12001-CONTINUE-MINN.
  3606
  3607     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3608        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  3609        (CP-TRUNCATED-LIFE)
  3610        NEXT SENTENCE
  3611     ELSE
  3612        GO TO 12001-CHECK-RI-GTL.
  3613
  3614      COMPUTE ANGLEN EQUAL WK1 / I.
  3615      COMPUTE ANGLEM EQUAL WK2 / I.
  3616
  3617      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  3618       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  3619       * M / 2400) * 1000 + .5) / 1000000.
  3620
  3621      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  3622       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  3623
  3624     GO TO 99999-RETURN.
  3625
  3626 12001-CHECK-RI-GTL.
  3627
  3628     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3629        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  3630        (CP-EARN-AS-NET-PAY)
  3631        NEXT SENTENCE
  3632     ELSE
  3633        GO TO 12001-CHECK-RI-LEASE-GTL.
  3634
  3635      COMPUTE ANGLEN EQUAL WK1 / I.
  3636*     COMPUTE ANGLEM EQUAL WK2 / I.
  3637
  3638      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  3639               (1 + WS-WORK-DIS-RATE * N).
  3640      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  3641         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  3642
  3643
  3644     GO TO 99999-RETURN.
  3645
  3646 12001-CHECK-RI-LEASE-GTL.
  3647
  3648     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3649        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  3650        (CP-SPECIAL-CALC-CD EQUAL 'H')
  3651        NEXT SENTENCE
  3652     ELSE
  3653        GO TO 12001-CHECK-OR-GTL.
  3654
  3655     COMPUTE ANGLEN EQUAL WK1 / I.
  3656
  3657     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  3658        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  3659                        /
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  67
* ELRFND.cbl
  3660        (1000 * I * (1 + .0021 * N)).
  3661     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  3662       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  3663                            /
  3664       (1000 * (1 + .0027 * (N + 1))).
  3665
  3666     GO TO 99999-RETURN.
  3667
  3668 12001-CHECK-OR-GTL.
  3669
  3670     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  3671        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  3672        (CP-EARN-AS-NET-PAY)
  3673        NEXT SENTENCE
  3674     ELSE
  3675        GO TO 12001-CHECK-GA-GTL.
  3676
  3677     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3678     COMPUTE ANGLEN EQUAL WK1 / I.
  3679
  3680     IF M LESS THAN +64
  3681        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  3682         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  3683                   /
  3684         (I * ANGLEN * (N - (N - M) + 1) * 600)
  3685        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  3686     ELSE
  3687        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  3688        CP-PREMIUM-RATE * (1 + I))
  3689                  /
  3690        (+1000 * I * ANGLEN)
  3691        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3692*    MOVE WK3 TO CP-CALC-PREMIUM.
  3693     GO TO 99999-RETURN.
  3694
  3695 12001-CHECK-GA-GTL.
  3696
  3697     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  3698        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  3699        (CP-EARN-AS-NET-PAY)
  3700*       (CP-TRUNCATED-LIFE)
  3701        NEXT SENTENCE
  3702     ELSE
  3703        GO TO 12001-CHECK-MA-GTL.
  3704
  3705     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3706     COMPUTE ANGLEN EQUAL WK1 / I.
  3707
  3708     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  3709     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  3710      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  3711     MOVE WK3 TO CP-CALC-PREMIUM.
  3712
  3713     GO TO 99999-RETURN.
  3714
  3715 12001-CHECK-MA-GTL.
  3716
  3717     IF (CP-COMPANY-ID EQUAL 'GTL') AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  68
* ELRFND.cbl
  3718        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  3719        (CP-EARN-AS-NET-PAY) AND
  3720        (CP-SPECIAL-CALC-CD EQUAL 'H')
  3721        NEXT SENTENCE
  3722     ELSE
  3723        GO TO 12001-CHECK-NV-NET.
  3724
  3725     COMPUTE ANGLEN EQUAL WK1 / I.
  3726
  3727     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  3728      CP-ALTERNATE-BENEFIT * N.
  3729
  3730     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  3731     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  3732
  3733     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  3734     WK7 * (N - ANGLEN) / I.
  3735     MOVE WK3 TO CP-CALC-PREMIUM.
  3736
  3737     GO TO 99999-RETURN.
  3738
  3739 12001-CHECK-NV-NET.
  3740     IF (CP-COMPANY-ID EQUAL 'CID')
  3741        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  3742        AND (CP-EARN-AS-NET-PAY)
  3743        CONTINUE
  3744     ELSE
  3745        GO TO 12001-CHECK-MN-NET
  3746     END-IF
  3747     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3748     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3749     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3750                   / (1 + I)
  3751     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3752     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3753     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3754        (CP-PREMIUM-RATE * K-I / 1000)
  3755     MOVE WK3                    TO CP-CALC-PREMIUM
  3756     GO TO 99999-RETURN
  3757      .
  3758 12001-CHECK-MN-NET.
  3759     IF (CP-COMPANY-ID EQUAL 'CID')
  3760        AND (CP-STATE-STD-ABBRV = 'MN')
  3761        AND (CP-EARN-AS-NET-PAY)
  3762        AND (NOT CP-LEVEL-LIFE)
  3763        AND (WS-DISCOUNT-OPTION = '1')
  3764        CONTINUE
  3765     ELSE
  3766        GO TO 12001-CHECK-NC-NET
  3767     END-IF
  3768     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3769     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3770     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3771                   / (1 + I)
  3772     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3773     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3774     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3775        (CP-PREMIUM-RATE / 1000) * (1 + I)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  69
* ELRFND.cbl
  3776     MOVE WK3                    TO CP-CALC-PREMIUM
  3777     GO TO 99999-RETURN
  3778      .
  3779 12001-CHECK-NC-NET.
  3780
  3781     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  3782        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3783        (CP-EARN-AS-NET-PAY)
  3784        NEXT SENTENCE
  3785     ELSE
  3786        GO TO 12001-CHECK-NC-NET-PLUS3.
  3787
  3788      COMPUTE ANGLEN EQUAL WK1 / I.
  3789      COMPUTE ANGLEN-M EQUAL WK5 / I.
  3790
  3791      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  3792          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  3793          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  3794          N * (CP-PREMIUM-RATE / 1000)).
  3795
  3796      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  3797          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  3798
  3799      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  3800          ((N - ANGLEN) / I + 3) / ANGLEN) /
  3801          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  3802          (ANGLEN * 2))
  3803
  3804      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  3805
  3806      IF ANGLEN IS NOT LESS THAN WK7
  3807          COMPUTE CP-PREMIUM-RATE ROUNDED =
  3808              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  3809          COMPUTE WK3 ROUNDED =
  3810              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  3811
  3812     MOVE WK3 TO CP-CALC-PREMIUM.
  3813
  3814     GO TO 99999-RETURN.
  3815
  3816 12001-CHECK-NC-NET-PLUS3.
  3817
  3818     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  3819        (CP-EARN-AS-NET-PAY) AND
  3820        (CP-COMPANY-ID NOT = 'CID' AND 'DCC')
  3821        NEXT SENTENCE
  3822     ELSE
  3823        GO TO 12001-CHECK-CA.
  3824
  3825     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3826     MOVE ' ' TO DC-OPTION-CODE.
  3827     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3828
  3829     IF DATE-CONVERSION-ERROR
  3830        MOVE '2'                 TO CP-RETURN-CODE
  3831        MOVE ZEROS               TO FACTOR
  3832                                    CP-CALC-PREMIUM
  3833         GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  70
* ELRFND.cbl
  3834
  3835     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  3836        NEXT SENTENCE
  3837     ELSE
  3838        GO TO 12001-CONTINUE-NET.
  3839
  3840     COMPUTE ANGLEN EQUAL WK1 / I.
  3841     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3842
  3843     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  3844
  3845     COMPUTE NC-R = 20 *
  3846                    ((NC-LR * ORIGINAL-TERM) / 12)
  3847                          / (ORIGINAL-TERM + 1).
  3848
  3849     COMPUTE NC-OB = NC-R / 1000.
  3850
  3851     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  3852                    (NC-OB * ORIGINAL-TERM * 3).
  3853
  3854     IF CP-EXT-CHG-LF
  3855         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  3856     ELSE
  3857         MOVE 30                 TO  NC-BIG-D.
  3858
  3859     COMPUTE NC-LITTLE-D = (1 + I) /
  3860             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  3861
  3862     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  3863             (ANGLEN * NC-LITTLE-D ).
  3864
  3865     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  3866
  3867     GO TO 99999-RETURN.
  3868
  3869 12001-CHECK-CA.
  3870
  3871     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  3872        (WS-DISCOUNT-OPTION = '6')
  3873        NEXT SENTENCE
  3874     ELSE
  3875        GO TO 12001-CHECK-GTL-IA.
  3876
  3877     COMPUTE CA-J = CA-DISCOUNT / 12.
  3878     COMPUTE ANGLEN EQUAL WK1 / I.
  3879     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  3880     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  3881     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  3882     COMPUTE CA-VI = (1 + I)** -1.
  3883     COMPUTE CP-CALC-PREMIUM =
  3884         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  3885         ((1 + CA-J) / I) *
  3886         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  3887         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  3888         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  3889
  3890     GO TO 99999-RETURN.
  3891
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  71
* ELRFND.cbl
  3892 12001-CHECK-GTL-IA.
  3893
  3894     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  3895        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  3896        (CP-EARN-AS-NET-PAY)
  3897        NEXT SENTENCE
  3898     ELSE
  3899        GO TO 12001-CHECK-CID-TRN-VA.
  3900
  3901***************************************************************
  3902
  3903     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  3904
  3905     IF GTL-IA-ODD-DAYS = ZEROS
  3906         MOVE ZERO               TO  GTL-IA-SGN
  3907     ELSE
  3908         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  3909             MOVE +1             TO  GTL-IA-SGN
  3910         ELSE
  3911             MOVE -1             TO  GTL-IA-SGN.
  3912
  3913     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  3914     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  3915
  3916     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  3917                          GTL-IA-SGN.
  3918
  3919     COMPUTE ANGLEN EQUAL WK1 / I.
  3920     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3921
  3922     IF GTL-IA-ODF NOT = ZERO
  3923         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  3924         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  3925
  3926     COMPUTE GTL-IA-DIVIDEND =
  3927           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  3928                             (ANGLEN - ANGLEN-M))) *
  3929           ((K1 + I) * CP-PREMIUM-RATE *
  3930                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  3931
  3932     COMPUTE GTL-IA-DIVISOR =
  3933      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  3934
  3935     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  3936
  3937     COMPUTE CP-CALC-PREMIUM =
  3938                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  3939     GO TO 99999-RETURN.
  3940
  3941
  3942 12001-CHECK-CID-TRN-VA.
  3943
  3944     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  3945        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  3946        (CP-EARN-AS-NET-PAY) AND
  3947        (CP-TRUNCATED-LIFE) AND
  3948        (CP-STATE-STD-ABBRV = CP-STATE)
  3949        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  72
* ELRFND.cbl
  3950     ELSE
  3951        GO TO 12001-CHECK-CID-TX
  3952     END-IF
  3953
  3954     COMPUTE ANGLEN EQUAL WK1 / I
  3955     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  3956     IF WS-WORK-DIS-RATE = ZEROS
  3957        CONTINUE
  3958     ELSE
  3959        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  3960        COMPUTE WK7 = (1 / I) *
  3961              (((WK4 ** M - 1) / (WK4 - 1)) -
  3962              ((WK4 ** M * SX - VX) /
  3963              (WK4 * (1 + I) - 1))) *
  3964              (CP-PREMIUM-RATE / 1000)
  3965        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  3966        COMPUTE WK8 = WK7 * 100 / ANGLEN
  3967        COMPUTE CP-CALC-PREMIUM =
  3968           WK8 *  ((WK4 * ANGLEN) / 100)
  3969     END-IF
  3970
  3971     GO TO 99999-RETURN
  3972
  3973     .
  3974
  3975 12001-CHECK-CID-TX.
  3976     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  3977        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  3978        (CP-EARN-AS-NET-PAY) AND
  3979        (WS-WORK-DIS-RATE > ZEROS) AND
  3980        (CP-STATE-STD-ABBRV = CP-STATE)
  3981        CONTINUE
  3982     ELSE
  3983        GO TO 12001-CHECK-CID-LEV-MN-NEW
  3984     END-IF
  3985* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  3986     COMPUTE K-I = 1 + (1 * I)
  3987     COMPUTE ANGLEN EQUAL WK1 / I
  3988     COMPUTE ANGLEM EQUAL WK2 / I
  3989     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  3990     IF WS-WORK-DIS-RATE = ZEROS
  3991        CONTINUE
  3992     ELSE
  3993        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  3994        COMPUTE WK7 = (K-I / I) *
  3995              (((WK4 ** M - 1) / (WK4 - 1)) -
  3996*             ((WK4 ** M * SX - VX) /
  3997              ((WK4 ** M * SX) - VX) /
  3998*             (WK4 * (1 + I) - 1))) *
  3999              (WK4 * (1 + I) - 1)) *
  4000              (CP-PREMIUM-RATE / 1000)
  4001        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4002        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  4003        COMPUTE CP-CALC-PREMIUM =
  4004           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  4005     END-IF
  4006
  4007     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  73
* ELRFND.cbl
  4008     .
  4009 12001-CHECK-CID-LEV-MN-NEW.
  4010*    IF (CP-COMPANY-ID EQUAL 'CID')
  4011*       AND (CP-STATE-STD-ABBRV = 'MN')
  4012*       AND (CP-EARN-AS-NET-PAY)
  4013*       AND (CP-LEVEL-LIFE)
  4014*       AND (CP-CERT-EFF-DT > X'A4FF')
  4015*       CONTINUE
  4016*    ELSE
  4017*       GO TO 12001-CHECK-CID-LEV-MN
  4018*    END-IF
  4019*
  4020*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4021*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4022*    MOVE '1'                    TO DC-OPTION-CODE
  4023*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  4024*
  4025*    IF DATE-CONVERSION-ERROR
  4026*       MOVE '2'                 TO CP-RETURN-CODE
  4027*       MOVE ZEROS               TO FACTOR
  4028*                                   CP-CALC-PREMIUM
  4029*       GO TO 99999-RETURN
  4030*    END-IF
  4031*
  4032*    COMPUTE I = CP-LOAN-APR / 100
  4033*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4034*
  4035*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4036*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4037*      * 12 / 360 * D)
  4038*
  4039*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4040*       * 12 / 360 * D
  4041*
  4042*    GO TO 99999-RETURN
  4043      .
  4044 12001-CHECK-CID-LEV-MN.
  4045
  4046     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4047        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4048        (CP-EARN-AS-NET-PAY) AND
  4049        (CP-LEVEL-LIFE) AND
  4050        (CP-STATE-STD-ABBRV = CP-STATE)
  4051        CONTINUE
  4052     ELSE
  4053        GO TO 12001-CHECK-CID-LEV-CA
  4054     END-IF
  4055
  4056     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4057         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4058         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4059
  4060     GO TO 99999-RETURN
  4061
  4062      .
  4063 12001-CHECK-CID-LEV-CA.
  4064
  4065     IF (CP-COMPANY-ID EQUAL 'CID')     AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  74
* ELRFND.cbl
  4066        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4067        (CP-EARN-AS-NET-PAY) AND
  4068        (CP-LEVEL-LIFE) AND
  4069        (CP-STATE-STD-ABBRV = CP-STATE)
  4070        CONTINUE
  4071     ELSE
  4072        GO TO 12001-CHECK-CID-TRN-CA
  4073     END-IF
  4074
  4075     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4076     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4077     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4078     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4079     COMPUTE CP-CALC-PREMIUM =
  4080          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4081          (CP-PREMIUM-RATE / 1000)) /
  4082          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4083
  4084     GO TO 99999-RETURN
  4085
  4086      .
  4087 12001-CHECK-CID-TRN-CA.
  4088
  4089     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4090        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4091        (CP-EARN-AS-NET-PAY) AND
  4092        (CP-TRUNCATED-LIFE) AND
  4093        (CP-STATE-STD-ABBRV = CP-STATE) AND
  4094        (WS-DISCOUNT-OPTION NOT = ' ')
  4095        CONTINUE
  4096     ELSE
  4097        GO TO 12001-CHECK-CID-TRN-MT
  4098     END-IF
  4099
  4100     COMPUTE ANGLEN EQUAL WK1 / I
  4101     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4102     IF WS-WORK-DIS-RATE = ZEROS
  4103        CONTINUE
  4104     ELSE
  4105        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4106        COMPUTE WK7 = (1 / I) *
  4107              (((WK4 ** M - 1) / (WK4 - 1)) -
  4108              ((WK4 ** M * SX - VX) /
  4109              (WK4 * (1 + I) - 1))) *
  4110              (CP-PREMIUM-RATE / 1000)
  4111        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4112        COMPUTE CP-CALC-PREMIUM =
  4113           WK4 *  WK7
  4114     END-IF
  4115
  4116     GO TO 99999-RETURN
  4117
  4118      .
  4119 12001-CHECK-CID-TRN-MT.
  4120
  4121     IF (CP-COMPANY-ID EQUAL 'CID') AND
  4122        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  4123                   OR
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  75
* ELRFND.cbl
  4124        ((CP-STATE-STD-ABBRV = 'IN') AND
  4125        (CP-CERT-EFF-DT > X'9A7F'))
  4126                   OR
  4127        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4128        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4129        (CP-EARN-AS-NET-PAY) AND
  4130        (CP-TRUNCATED-LIFE) AND
  4131        (CP-STATE-STD-ABBRV = CP-STATE)
  4132        CONTINUE
  4133     ELSE
  4134        GO TO 12001-CHECK-CID-MT
  4135     END-IF
  4136
  4137* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4138     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4139        MOVE 0                   TO K-I
  4140     ELSE
  4141        MOVE 2                   TO K-I
  4142     END-IF
  4143     COMPUTE CP-TERM-OR-EXT-DAYS =
  4144           CP-TERM-OR-EXT-DAYS + 30
  4145
  4146     COMPUTE ANGLEN EQUAL WK1 / I
  4147     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4148     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4149                   / (1 + I)
  4150     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4151     IF WS-WORK-DIS-RATE = ZEROS
  4152        CONTINUE
  4153     ELSE
  4154        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4155*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4156        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4157              (((WK4 ** M - 1) / (WK4 - 1)) -
  4158              ((WK4 ** M * SX - VX) /
  4159              (WK4 * (1 + I) - 1))) *
  4160              (CP-PREMIUM-RATE / 1000)
  4161        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4162*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4163        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4164        COMPUTE CP-CALC-PREMIUM =
  4165           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4166*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4167     END-IF
  4168
  4169     GO TO 99999-RETURN
  4170
  4171     .
  4172 12001-CHECK-CID-MT.
  4173
  4174     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4175        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  4176                                OR 'VT')
  4177                   OR
  4178        ((CP-STATE-STD-ABBRV = 'IN') AND
  4179        (CP-CERT-EFF-DT > X'9A7F'))
  4180                   OR
  4181        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  76
* ELRFND.cbl
  4182        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4183        (CP-EARN-AS-NET-PAY) AND
  4184        (CP-STATE-STD-ABBRV = CP-STATE)
  4185        CONTINUE
  4186     ELSE
  4187        GO TO 12001-CHECK-DCC-DD
  4188     END-IF
  4189
  4190     COMPUTE CP-TERM-OR-EXT-DAYS =
  4191           CP-TERM-OR-EXT-DAYS + 30
  4192
  4193* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4194     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4195        MOVE 0                   TO K-I
  4196     ELSE
  4197        IF CP-STATE-STD-ABBRV = 'NJ'
  4198           MOVE 1                TO K-I
  4199        ELSE
  4200           MOVE 2                TO K-I
  4201        END-IF
  4202     END-IF
  4203     COMPUTE ANGLEN EQUAL WK1 / I
  4204     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4205     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4206                   / (1 + I)
  4207     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4208     IF WS-WORK-DIS-RATE = ZEROS
  4209        CONTINUE
  4210     ELSE
  4211        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4212*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4213        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4214              (((WK4 ** N - 1) / (WK4 - 1)) -
  4215              ((WK4 ** N - SV) /
  4216              (WK4 * (1 + I) - 1))) *
  4217              (CP-PREMIUM-RATE / 1000)
  4218        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4219*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4220        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4221        COMPUTE CP-CALC-PREMIUM =
  4222           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4223*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4224     END-IF
  4225
  4226     GO TO 99999-RETURN
  4227
  4228     .
  4229 12001-CHECK-DCC-DD.
  4230     IF (CP-COMPANY-ID EQUAL 'DCC')
  4231        AND (CP-EARN-AS-NET-PAY)
  4232        AND (CP-BEN-CATEGORY = 'D')
  4233        CONTINUE
  4234     ELSE
  4235        GO TO 12001-CHECK-DCC-NET
  4236     END-IF
  4237
  4238     COMPUTE CP-TERM-OR-EXT-DAYS =
  4239           CP-TERM-OR-EXT-DAYS + 30
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  77
* ELRFND.cbl
  4240
  4241     COMPUTE ANGLEN EQUAL WK1 / I.
  4242     COMPUTE ANGLEM EQUAL WK2 / I.
  4243     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4244
  4245     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4246           / (1 + I)
  4247     COMPUTE GR     = ANGLEN / ODF
  4248*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  4249*      CP-RATE-DEV-PCT
  4250     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4251     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4252       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  4253     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4254     MOVE WK3                    TO CP-CALC-PREMIUM
  4255
  4256     GO TO 99999-RETURN
  4257
  4258     .
  4259 12001-CHECK-DCC-NET.
  4260
  4261     IF (CP-COMPANY-ID EQUAL 'DCC')
  4262        AND (CP-EARN-AS-NET-PAY)
  4263        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  4264             AND 'H' AND 'S' AND 'P')
  4265        CONTINUE
  4266     ELSE
  4267        GO TO 12001-CHECK-DCC-PNET
  4268     END-IF
  4269
  4270     COMPUTE CP-TERM-OR-EXT-DAYS =
  4271           CP-TERM-OR-EXT-DAYS + 30
  4272
  4273     COMPUTE ANGLEN EQUAL WK1 / I.
  4274     COMPUTE ANGLEM EQUAL WK2 / I.
  4275     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4276
  4277     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4278           / (1 + I)
  4279     COMPUTE GR     = ANGLEN / ODF
  4280     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  4281     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  4282       CP-RATE-DEV-PCT
  4283     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  4284*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  4285
  4286     COMPUTE WK8 = CP-PREMIUM-RATE *
  4287        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  4288     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  4289     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4290     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4291       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  4292     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4293     MOVE WK3                    TO CP-CALC-PREMIUM
  4294
  4295     GO TO 99999-RETURN
  4296
  4297     .
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  78
* ELRFND.cbl
  4298 12001-CHECK-DCC-PNET.
  4299     IF (CP-COMPANY-ID EQUAL 'DCC')
  4300        AND (CP-EARN-AS-NET-PAY)
  4301        AND (CP-BENEFIT-CD (1:1) = 'P')
  4302        CONTINUE
  4303     ELSE
  4304        GO TO 12001-CHECK-DCC-MNET
  4305     END-IF
  4306     IF CP-NO-OF-PMTS NOT NUMERIC
  4307        MOVE +0                  TO CP-NO-OF-PMTS
  4308     END-IF
  4309     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  4310        AND ' ' AND 'M'
  4311        MOVE ' '                 TO CP-PMT-MODE
  4312     END-IF
  4313     EVALUATE CP-PMT-MODE
  4314        WHEN 'W'
  4315           MOVE +7               TO C-DAYS-IN-PMT-PER
  4316           MOVE +52              TO C-PMTS-PER-YEAR
  4317           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4318        WHEN 'B'
  4319           MOVE +14              TO C-DAYS-IN-PMT-PER
  4320           MOVE +26              TO C-PMTS-PER-YEAR
  4321           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4322        WHEN OTHER
  4323           MOVE +30              TO C-DAYS-IN-PMT-PER
  4324           MOVE +12              TO C-PMTS-PER-YEAR
  4325           MOVE CP-LOAN-TERM     TO C-TOT-PMTS
  4326     END-EVALUATE
  4327     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4328     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4329        C-DAYS-IN-PMT-PER)) / (1 + I)
  4330     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  4331     COMPUTE ANGLEN-1 = ANGLEN / Y
  4332     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4333     IF CP-RATE-DEV-PCT NOT = ZEROS
  4334        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4335           CP-PREMIUM-RATE
  4336     END-IF
  4337     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  4338     GO TO 99999-RETURN
  4339     .
  4340 12001-CHECK-DCC-MNET.
  4341
  4342     IF (CP-COMPANY-ID EQUAL 'DCC')
  4343        AND (CP-EARN-AS-NET-PAY)
  4344        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  4345        CONTINUE
  4346     ELSE
  4347        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  4348     END-IF
  4349
  4350*    COMPUTE ANGLEN EQUAL WK1 / I.
  4351*    COMPUTE ANGLEM EQUAL WK2 / I.
  4352*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  4353
  4354     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  4355     MOVE WK3                    TO CP-CALC-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  79
* ELRFND.cbl
  4356
  4357     GO TO 99999-RETURN
  4358
  4359     .
  4360 12001-CHECK-DCC-MNET-LF-BAL.
  4361
  4362     IF (CP-COMPANY-ID EQUAL 'DCC')
  4363        AND (CP-EARN-AS-NET-PAY)
  4364        AND (CP-BENEFIT-CD (1:1) = 'N')
  4365        AND (CP-BEN-CATEGORY NOT = 'N')
  4366        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4367        CONTINUE
  4368     ELSE
  4369        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  4370     END-IF
  4371
  4372     IF CP-RATE-DEV-PCT NOT = ZEROS
  4373        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4374           CP-PREMIUM-RATE
  4375     END-IF
  4376*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4377     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4378        / (1 + I)
  4379     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4380     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4381     COMPUTE WK2 = (1 + J) ** (M * -1)
  4382     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4383     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4384          ** ((M - 1) * -1))) / J)
  4385     COMPUTE ANGLEM = ((1 - ((1 + J)
  4386          ** (M * -1))) / J) / OD
  4387     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4388        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  4389        / ANGLEM-1
  4390     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4391          ** ((N - M) * -1))) / I)
  4392     MOVE +0                     TO WK3
  4393     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4394        (WS-COUNTER > M)
  4395        COMPUTE ANGLEM = (1 - ((1 + J)
  4396          ** ((M - WS-COUNTER) * -1))) / J
  4397        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4398        COMPUTE WK5-CSL = (RA * ANGLEM)
  4399        + (CP-ALTERNATE-BENEFIT * WK2)
  4400        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4401     END-PERFORM
  4402     MOVE WK3                    TO CP-CALC-PREMIUM
  4403
  4404     GO TO 99999-RETURN
  4405
  4406     .
  4407 12001-CHECK-DCC-MNET-LFSUM-BAL.
  4408
  4409     IF (CP-COMPANY-ID EQUAL 'DCC')
  4410        AND (CP-EARN-AS-NET-PAY)
  4411        AND (CP-BENEFIT-CD (1:1) = 'S')
  4412        AND (CP-BEN-CATEGORY NOT = 'N')
  4413        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  80
* ELRFND.cbl
  4414        CONTINUE
  4415     ELSE
  4416        GO TO 12001-CHECK-DCC-MNET-LF
  4417     END-IF
  4418
  4419     IF CP-RATE-DEV-PCT NOT = ZEROS
  4420        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4421           CP-PREMIUM-RATE
  4422     END-IF
  4423     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4424     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4425          ** ((M - 1) * -1))) / K)
  4426     COMPUTE ANGLEM = ((1 - ((1 + K)
  4427          ** (M * -1))) / K)
  4428     MOVE CP-MONTHLY-PAYMENT     TO RA
  4429     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4430        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  4431        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4432        CP-PREMIUM-RATE / 1000
  4433     MOVE WK3                    TO CP-CALC-PREMIUM
  4434
  4435     GO TO 99999-RETURN
  4436
  4437     .
  4438 12001-CHECK-DCC-MNET-LF.
  4439
  4440     IF (CP-COMPANY-ID EQUAL 'DCC')
  4441        AND (CP-EARN-AS-NET-PAY)
  4442        AND (CP-BENEFIT-CD (1:1) = 'N')
  4443        AND (CP-BEN-CATEGORY NOT = 'N')
  4444        CONTINUE
  4445     ELSE
  4446        GO TO 12001-CHECK-DCC-MNET-SUMLF
  4447     END-IF
  4448
  4449     IF CP-RATE-DEV-PCT NOT = ZEROS
  4450        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4451           CP-PREMIUM-RATE
  4452     END-IF
  4453*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4454     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4455        / (1 + I)
  4456     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4457     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4458     COMPUTE WK2 = (1 + J) ** (M * -1)
  4459     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4460     COMPUTE ANGLEM = ((1 - ((1 + J)
  4461          ** (M * -1))) / J) / OD
  4462     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4463     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4464          ** ((N - M) * -1))) / I)
  4465     MOVE +0                     TO WK3
  4466     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4467        (WS-COUNTER > M)
  4468        COMPUTE ANGLEM = (1 - ((1 + J)
  4469          ** ((M - WS-COUNTER + 1) * -1))) / J
  4470        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4471        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  81
* ELRFND.cbl
  4472        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4473     END-PERFORM
  4474     MOVE WK3                    TO CP-CALC-PREMIUM
  4475
  4476     GO TO 99999-RETURN
  4477
  4478     .
  4479 12001-CHECK-DCC-MNET-SUMLF.
  4480
  4481     IF (CP-COMPANY-ID EQUAL 'DCC')
  4482        AND (CP-EARN-AS-NET-PAY)
  4483        AND (CP-BENEFIT-CD (1:1) = 'S')
  4484        AND (CP-BEN-CATEGORY NOT = 'N')
  4485        CONTINUE
  4486     ELSE
  4487        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  4488     END-IF
  4489
  4490     IF CP-RATE-DEV-PCT NOT = ZEROS
  4491        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4492           CP-PREMIUM-RATE
  4493     END-IF
  4494     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4495     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4496        / (1 + K)
  4497     COMPUTE ANGLEN-M = (WK5 / I)
  4498     COMPUTE WK2 = (1 + K) ** (M * -1)
  4499     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4500     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4501     COMPUTE ANGLEM = ((1 - ((1 + K)
  4502          ** (M * -1))) / K) / Y
  4503     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4504     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  4505        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4506        - 1)) / K) * RA
  4507     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4508        + (CP-DAYS-TO-1ST-PMT - +30)
  4509        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4510        +0 / 1000 * 12 / 12)
  4511     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  4512        * (12 / 12)
  4513     MOVE WK3                    TO CP-CALC-PREMIUM
  4514
  4515     GO TO 99999-RETURN
  4516
  4517     .
  4518 12001-CHECK-DCC-MNET-TOT-BAL-N.
  4519
  4520     IF (CP-COMPANY-ID EQUAL 'DCC')
  4521        AND (CP-EARN-AS-NET-PAY)
  4522        AND (CP-BENEFIT-CD (1:1) = 'N')
  4523        AND (CP-BEN-CATEGORY = 'N')
  4524        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4525        CONTINUE
  4526     ELSE
  4527        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  4528     END-IF
  4529
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  82
* ELRFND.cbl
  4530*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4531     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4532        / (1 + I)
  4533     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4534     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  4535     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4536     COMPUTE WK2 = (1 + J) ** (M * -1)
  4537     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4538     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4539          ** ((M - 1) * -1))) / J)
  4540     COMPUTE ANGLEM = ((1 - ((1 + J)
  4541          ** (M * -1))) / J) / OD
  4542     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4543        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  4544        / ANGLEM-1
  4545     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4546          ** ((N - M) * -1))) / I)
  4547     MOVE +0                     TO WK3
  4548     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4549        (WS-COUNTER > M)
  4550        COMPUTE ANGLEM = (1 - ((1 + J)
  4551          ** ((M - WS-COUNTER) * -1))) / J
  4552        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  4553        COMPUTE WK5-CSL = (RA * ANGLEM)
  4554        + (CP-ALTERNATE-BENEFIT * WK2)
  4555        COMPUTE WK3 = WK3 +
  4556         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  4557        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  4558          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  4559          (CP-DCC-AH-RATE / 1000)
  4560     END-PERFORM
  4561     MOVE WK3                    TO CP-CALC-PREMIUM
  4562
  4563     GO TO 99999-RETURN
  4564
  4565     .
  4566 12001-CHECK-DCC-MNET-TOT-BAL-S.
  4567
  4568     IF (CP-COMPANY-ID EQUAL 'DCC')
  4569        AND (CP-EARN-AS-NET-PAY)
  4570        AND (CP-BENEFIT-CD (1:1) = 'S')
  4571        AND (CP-BEN-CATEGORY = 'N')
  4572        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4573        CONTINUE
  4574     ELSE
  4575        GO TO 12001-CHECK-DCC-MNET-TOT-N
  4576     END-IF
  4577
  4578     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4579     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4580          ** ((M - 1) * -1))) / K)
  4581     COMPUTE ANGLEM = ((1 - ((1 + K)
  4582          ** (M * -1))) / K)
  4583     MOVE CP-MONTHLY-PAYMENT     TO RA
  4584     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4585        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  4586        * CP-DCC-AH-RATE / 1000))
  4587        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  83
* ELRFND.cbl
  4588        CP-DCC-LF-RATE / 1000
  4589     MOVE WK3                    TO CP-LF-PREM
  4590     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  4591        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  4592        * CP-DCC-AH-RATE / 1000
  4593     COMPUTE WK3 = WK3 + WK5-CSL
  4594     MOVE WK3                    TO CP-CALC-PREMIUM
  4595
  4596     GO TO 99999-RETURN
  4597      .
  4598 12001-CHECK-DCC-MNET-TOT-N.
  4599
  4600     IF (CP-COMPANY-ID EQUAL 'DCC')
  4601        AND (CP-EARN-AS-NET-PAY)
  4602        AND (CP-BENEFIT-CD (1:1) = 'N')
  4603        AND (CP-BEN-CATEGORY = 'N')
  4604        CONTINUE
  4605     ELSE
  4606        GO TO 12001-CHECK-DCC-MNET-TOT-S
  4607     END-IF
  4608
  4609*    I = APR/1200
  4610*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  4611*    RA = PAYMENT AMOUNT
  4612*    WK5-CSL = THE BALANCE (PAY OFF )
  4613*    WK3 = THE ACCUMULATED PREMIUM
  4614*    WK2 = (1 + I) ^ (m * -1)
  4615*    OD  = GAMMA
  4616*
  4617*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4618     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4619        / (1 + I)
  4620     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4621     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  4622        (CP-DCC-AH-RATE / +1000)
  4623     COMPUTE WK2 = (1 + J) ** (M * -1)
  4624     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4625     COMPUTE ANGLEM = ((1 - ((1 + J)
  4626          ** (M * -1))) / J) / OD
  4627     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4628     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4629          ** ((N - M) * -1))) / I)
  4630     MOVE +0                     TO WK3
  4631     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4632        (WS-COUNTER > M)
  4633        COMPUTE ANGLEM = (1 - ((1 + J)
  4634          ** ((M - WS-COUNTER + 1) * -1))) / J
  4635        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4636        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4637        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  4638           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  4639     END-PERFORM
  4640     MOVE WK3                    TO CP-CALC-PREMIUM
  4641
  4642     GO TO 99999-RETURN
  4643
  4644     .
  4645 12001-CHECK-DCC-MNET-TOT-S.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  84
* ELRFND.cbl
  4646
  4647     IF (CP-COMPANY-ID EQUAL 'DCC')
  4648        AND (CP-EARN-AS-NET-PAY)
  4649        AND (CP-BENEFIT-CD (1:1) = 'S')
  4650        AND (CP-BEN-CATEGORY = 'N')
  4651        CONTINUE
  4652     ELSE
  4653        GO TO 12001-CONTINUE-NET
  4654     END-IF
  4655
  4656*    I = APR/1200
  4657*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  4658*    RA = PAYMENT AMOUNT
  4659*    WK5-CSL = THE BALANCE (PAY OFF )
  4660*    WK3 = THE ACCUMULATED PREMIUM
  4661*    WK2 = (1 + I) ^ (m * -1)
  4662*    OD  = GAMMA
  4663*
  4664     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  4665     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  4666        / (1 + J)
  4667     COMPUTE ANGLEM = ((1 - ((1 + J)
  4668          ** (M * -1))) / J) / OD
  4669     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4670          ** ((N - M) * -1))) / I)
  4671          * (1 + J) ** (-1 * M)
  4672     COMPUTE ANGLEN-M = ANGLEN-M / OD
  4673     MOVE CP-MONTHLY-PAYMENT     TO RA
  4674     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  4675        / +30)
  4676     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  4677        ** (WK1) - 1)) / J) * RA
  4678     COMPUTE WK5 = (((((M * (M + 1) / 2)
  4679        + (CP-DAYS-TO-1ST-PMT - +30)
  4680        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  4681        CP-DCC-AH-RATE / +1000 * 12 / 12)
  4682     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  4683        (12 / 12)
  4684     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  4685        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  4686        (CP-DCC-AH-RATE / +1000) * 12 / 12
  4687     COMPUTE WK3 = WK3 + WK5-CSL
  4688     MOVE WK3                    TO CP-CALC-PREMIUM
  4689     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4690     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4691        / (1 + K)
  4692     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4693          ** ((N - M) * -1))) / I)
  4694     COMPUTE WK2 = (1 + K) ** (M * -1)
  4695     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4696     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4697     COMPUTE ANGLEM = ((1 - ((1 + K)
  4698          ** (M * -1))) / K) / Y
  4699*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4700     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  4701        ((1 + K) ** (M + 1 / Y
  4702        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4703        - 1)) / K) * RA
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  85
* ELRFND.cbl
  4704     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4705        + (CP-DAYS-TO-1ST-PMT - +30)
  4706        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4707        CP-DCC-AH-RATE / 1000 * 12 / 12)
  4708     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  4709        * (12 / 12)
  4710     MOVE WK3                    TO CP-LF-PREM
  4711
  4712     GO TO 99999-RETURN
  4713
  4714     .
  4715 12001-CONTINUE-NET.
  4716
  4717     IF NET-STD
  4718        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  4719*          OR 'DCC'
  4720         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  4721         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  4722         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  4723         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  4724                               * ((1 + N) / (1 + M))
  4725        ELSE
  4726         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  4727         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  4728         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  4729         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  4730
  4731     IF NET-SMP
  4732         COMPUTE N2 = N * N
  4733         COMPUTE N3 = N2 * N
  4734         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  4735         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  4736         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  4737         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  4738         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  4739
  4740     IF NPO-PRUDENTIAL
  4741       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  4742           VARYING WS-COUNTER FROM 1 BY 1
  4743               UNTIL WS-COUNTER = N
  4744       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  4745       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  4746
  4747     MOVE WK3 TO FACTOR.
  4748
  4749     GO TO 99999-RETURN.
  4750
  4751 12100-PRU-CALC.
  4752     IF WS-COUNTER = 1
  4753         COMPUTE PWK = (I + 1)
  4754     ELSE
  4755         COMPUTE PWK = PWK * (I + 1).
  4756
  4757 12199-EXIT.
  4758      EXIT.
  4759
  4760 99000-ERROR.
  4761     MOVE +9999.999999999 TO N-P-FACTOR.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:35 Page  86
* ELRFND.cbl
  4762     MOVE '4'             TO CP-RETURN-CODE.
  4763
  4764     GO TO 99999-EXIT.
  4765
  4766 99999-RETURN.
  4767     MOVE FACTOR          TO N-P-FACTOR.
  4768
  4769 99999-EXIT.
  4770      EXIT.
  4771
  4772 9999-DFHBACK SECTION.
  4773     MOVE '9%                    "   ' TO DFHEIV0
  4774     MOVE 'ELRFND' TO DFHEIV1
  4775     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4776     GOBACK.
  4777 9999-DFHEXIT.
  4778     IF DFHEIGDJ EQUAL 0001
  4779         NEXT SENTENCE.
  4780     MOVE '9%                    "   ' TO DFHEIV0
  4781     MOVE 'ELRFND' TO DFHEIV1
  4782     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4783     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        2488     Code:       39044
