* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page   1
* EL6521.cbl
* Options: int("EL6521.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6521.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6521.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6521.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6521.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 11/18/94 10:26:25.
     7*                            VMOD=2.004
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page   2
* EL6521.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*                                                                *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23*
    24*REMARKS.    TRANSACTION - EXD8 - COMPENSATION GA STATUS DATA.
    25*
    26******************************************************************
    27*                   C H A N G E   L O G
    28*
    29* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    30*-----------------------------------------------------------------
    31*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    32* EFFECTIVE    NUMBER
    33*-----------------------------------------------------------------
    34* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    35* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
    36* 092707    2004020600003  PEMA  ADD DELIVER TO MEL SWITCH
    37* 030211    2010012100001  PEMA  ADD RDS EMAILS TO LOGIC
    38* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    40******************************************************************
    41 ENVIRONMENT DIVISION.
    42
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page   3
* EL6521.cbl
    44 DATA DIVISION.
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47 77  FILLER  PIC X(32)  VALUE '********************************'.
    48 77  FILLER  PIC X(32)  VALUE '*    EL6521 WORKING STORAGE    *'.
    49 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.004 *********'.
    50
    51 01  WS-DATE-AREA.
    52     05  WS-SAVE-DATE                PIC X(8) VALUE SPACES.
    53     05  WS-SAVE-BIN-DT              PIC XX   VALUE SPACES.
    54     05  WS-EFF-YMD                  PIC X(6).
    55     05  WS-SAVE-BIN-EFFDT           PIC XX   VALUE SPACES.
    56     05  WS-TRM-YMD                  PIC X(6).
    57     05  WS-SAVE-BIN-TRMDT           PIC XX   VALUE SPACES.
    58     05  WS-ACH-SW                   PIC X    VALUE 'N'.
    59         88  ACH-HAS-CHANGED             VALUE 'Y'.
    60         88  NO-ACH-CHANGE               VALUE 'N'.
    61     05  SUPPRESS-MAP-SW             PIC X    VALUE SPACE.
    62         88  DO-NOT-MOVE-TO-MAP          VALUE 'N'.
    63         88  MOVE-TO-MAP                 VALUE 'Y'.
    64     05  MAP-CHANGED-SW              PIC X    VALUE 'N'.
    65         88  MAP-NOT-CHANGED             VALUE 'N'.
    66         88  MAP-CHANGED                 VALUE 'Y'.
    67     05  BILL-INST-SW                PIC X.
    68         88  BILL-INST-CHANGED           VALUE 'Y'.
    69
    70 01  WS-RESPONSE                 PIC S9(8)   COMP.
    71     88  RESP-NORMAL                  VALUE +00.
    72     88  RESP-NOTFND                  VALUE +13.
    73     88  RESP-NOTOPEN                 VALUE +19.
    74     88  RESP-ENDFILE                 VALUE +20.
    75 01  STANDARD-AREAS.
    76     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
    77     12  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1024.
    78     12  WS-SUB                      PIC S9(4) COMP VALUE +0.
    79     12  MAP-NAME                    PIC X(8) VALUE 'EL6521A'.
    80     12  MAPSET-NAME                 PIC X(8) VALUE 'EL6521S'.
    81     12  SCREEN-NUMBER               PIC X(4) VALUE '652B'.
    82     12  TRANS-ID                    PIC X(4) VALUE 'EXD8'.
    83     12  EL611-TRANS-ID              PIC X(4) VALUE 'EXL3'.
    84     12  EL6525-TRANS-ID             PIC X(4) VALUE 'EXDF'.
    85     12  EL6526-TRANS-ID             PIC X(4) VALUE 'EXDG'.
    86     12  THIS-PGM                    PIC X(8) VALUE 'EL6521'.
    87     12  PGM-NAME                    PIC X(8).
    88     12  TIME-IN                     PIC S9(7).
    89     12  TIME-OUT-R  REDEFINES TIME-IN.
    90         16  FILLER                  PIC X.
    91         16  TIME-OUT                PIC 99V99.
    92         16  FILLER                  PIC XX.
    93     12  XCTL-005                    PIC X(8) VALUE 'EL005'.
    94     12  XCTL-010                    PIC X(8) VALUE 'EL010'.
    95     12  XCTL-626                    PIC X(8) VALUE 'EL626'.
    96     12  XCTL-611                    PIC X(8) VALUE 'EL611'.
    97     12  XCTL-6525                   PIC X(8) VALUE 'EL6525'.
    98     12  XCTL-6526                   PIC X(8) VALUE 'EL6526'.
    99     12  XCTL-652                    PIC X(8) VALUE 'EL652'.
   100     12  LINK-001                    PIC X(8) VALUE 'EL001'.
   101     12  LINK-004                    PIC X(8) VALUE 'EL004'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page   4
* EL6521.cbl
   102     12  QID.
   103         16  QID-TERM                PIC X(4) VALUE SPACES.
   104         16  FILLER                  PIC X(4) VALUE '521A'.
   105     12  MAP-LENGTH                  PIC S9(4) VALUE +600  COMP.
   106     12  ERCOBI-FILE-ID              PIC X(8) VALUE 'ERCOBI'.
   107     12  ERCOMP-FILE-ID              PIC X(8) VALUE 'ERCOMP'.
   108     12  ELACHP-FILE-ID              PIC X(8) VALUE 'ELACHP'.
   109     12  ELBANK-FILE-ID              PIC X(8) VALUE 'ELBANK'.
   110     12  WS-AGENT-BANK-DESC.
   111         16 FILLER                   PIC X(7) VALUE '  AGENT'.
   112         16 FILLER                   PIC X(1) VALUE X'7D'.
   113         16 FILLER                   PIC X(15)
   114                                      VALUE 'S BANK ACCOUNT:'.
   115
   116     12  DEEDIT-FIELD                PIC X(15).
   117     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD PIC S9(15).
   118
   119     12  ERCOBI-KEY.
   120         16  ERCOBI-COMPANY-CD      PIC X.
   121         16  ERCOBI-STMT-OWNER      PIC X(4).
   122         16  ERCOBI-RGID            PIC X(12).
   123     12  WS-BILL-INST-SW            PIC X  VALUE SPACES.
   124         88  BILLING-INSTRUCTIONS-FOUND  VALUE 'Y'.
   125     12  ERROR-MESSAGES.
   126         16  ER-0000                 PIC X(4) VALUE '0000'.
   127         16  ER-0004                 PIC X(4) VALUE '0004'.
   128         16  ER-0008                 PIC X(4) VALUE '0008'.
   129         16  ER-0029                 PIC X(4) VALUE '0029'.
   130         16  ER-0068                 PIC X(4) VALUE '0068'.
   131         16  ER-0070                 PIC X(4) VALUE '0070'.
   132         16  ER-0348                 PIC X(4) VALUE '0348'.
   133         16  ER-0454                 PIC X(4) VALUE '0454'.
   134         16  ER-0876                 PIC X(4) VALUE '0876'.
   135         16  ER-1228                 PIC X(4) VALUE '1228'.
   136         16  ER-1626                 PIC X(4) VALUE '1626'.
   137         16  ER-1629                 PIC X(4) VALUE '1629'.
   138         16  ER-2039                 PIC X(4) VALUE '2039'.
   139         16  ER-2233                 PIC X(4) VALUE '2233'.
   140         16  ER-2797                 PIC X(4) VALUE '2797'.
   141         16  ER-7430                 PIC X(4) VALUE '7430'.
   142         16  ER-7431                 PIC X(4) VALUE '7431'.
   143         16  ER-7432                 PIC X(4) VALUE '7432'.
   144         16  ER-7434                 PIC X(4) VALUE '7434'.
   145         16  ER-7435                 PIC X(4) VALUE '7435'.
   146         16  ER-7436                 PIC X(4) VALUE '7436'.
   147         16  ER-7438                 PIC X(4) VALUE '7438'.
   148         16  ER-7440                 PIC X(4) VALUE '7440'.
   149         16  ER-7447                 PIC X(4) VALUE '7447'.
   150         16  ER-7449                 PIC X(4) VALUE '7449'.
   151         16  ER-7462                 PIC X(4) VALUE '7462'.
   152         16  ER-7465                 PIC X(4) VALUE '7465'.
   153         16  ER-7468                 PIC X(4) VALUE '7468'.
   154         16  ER-7469                 PIC X(4) VALUE '7469'.
   155         16  ER-8799                 PIC X(4) VALUE '8799'.
   156         16  ER-9388                 PIC X(4) VALUE '9388'.
   157         16  ER-9399                 PIC X(4) VALUE '9399'.
   158         16  ER-9999                 PIC X(4) VALUE '9999'.
   159
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page   5
* EL6521.cbl
   160     12  ELCNTL-KEY.
   161         16  CNTL-COMP-ID            PIC X(3) VALUE SPACES.
   162         16  CNTL-REC-TYPE           PIC X    VALUE SPACES.
   163         16  CNTL-ACCESS             PIC X(4) VALUE SPACES.
   164         16  CNTL-SEQ-NO             PIC S9(4) VALUE +0  COMP.
   165
   166     12  WS-BANK-INFORMATION.
   167         16 WS-BANK-DATA.
   168             20 WS-TRANSIT1              PIC X(4).
   169             20 WS-TRANSIT2              PIC X(4).
   170             20 WS-BKACCTI               PIC X(17).
   171         16 WS-ACTCDI                    PIC X(1).
   172
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page   6
* EL6521.cbl
   174*    COPY ELCLOGOF.
   175******************************************************************
   176*                                                                *
   177*                                                                *
   178*                            ELCLOGOF.                           *
   179*                            VMOD=2.001                          *
   180*                                                                *
   181*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   182*                                                                *
   183******************************************************************
   184 01  CLASIC-LOGOFF.
   185     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   186     12  LOGOFF-TEXT.
   187         16  FILLER          PIC X(5)    VALUE SPACES.
   188         16  LOGOFF-MSG.
   189             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   190             20  FILLER      PIC X       VALUE SPACES.
   191             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   192         16  FILLER          PIC X(80)
   193           VALUE '* YOU ARE NOW LOGGED OFF'.
   194         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   195         16  FILLER          PIC X       VALUE QUOTE.
   196         16  LOGOFF-SYS-MSG  PIC X(17)
   197           VALUE 'S CLAS-IC SYSTEM '.
   198     12  TEXT-MESSAGES.
   199         16  UNACCESS-MSG    PIC X(29)
   200             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   201         16  PGMIDERR-MSG    PIC X(17)
   202             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page   7
* EL6521.cbl
   204*    COPY ELCDATE.
   205******************************************************************
   206*                                                                *
   207*                                                                *
   208*                            ELCDATE.                            *
   209*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   210*                            VMOD=2.003
   211*                                                                *
   212*                                                                *
   213*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   214*                 LENGTH = 200                                   *
   215******************************************************************
   216
   217 01  DATE-CONVERSION-DATA.
   218     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   219     12  DC-OPTION-CODE                PIC X.
   220         88  BIN-TO-GREG                VALUE ' '.
   221         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   222         88  EDIT-GREG-TO-BIN           VALUE '2'.
   223         88  YMD-GREG-TO-BIN            VALUE '3'.
   224         88  MDY-GREG-TO-BIN            VALUE '4'.
   225         88  JULIAN-TO-BIN              VALUE '5'.
   226         88  BIN-PLUS-ELAPSED           VALUE '6'.
   227         88  FIND-CENTURY               VALUE '7'.
   228         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   229         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   230         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   231         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   232         88  JULIAN-TO-BIN-3            VALUE 'C'.
   233         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   234         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   235         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   236         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   237         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   238         88  CHECK-LEAP-YEAR            VALUE 'H'.
   239         88  BIN-3-TO-GREG              VALUE 'I'.
   240         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   241         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   242         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   243         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   244         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   245         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   246         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   247         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   248         88  THREE-CHARACTER-BIN
   249                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   250         88  GREGORIAN-TO-BIN
   251                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   252         88  BIN-TO-GREGORIAN
   253                  VALUES ' ' '1' 'I' '8' 'G'.
   254         88  JULIAN-TO-BINARY
   255                  VALUES '5' 'C' 'E' 'F'.
   256     12  DC-ERROR-CODE                 PIC X.
   257         88  NO-CONVERSION-ERROR        VALUE ' '.
   258         88  DATE-CONVERSION-ERROR
   259                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   260         88  DATE-IS-ZERO               VALUE '1'.
   261         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page   8
* EL6521.cbl
   262         88  DATE-IS-INVALID            VALUE '3'.
   263         88  DATE1-GREATER-DATE2        VALUE '4'.
   264         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   265         88  DATE-INVALID-OPTION        VALUE '9'.
   266         88  INVALID-CENTURY            VALUE 'A'.
   267         88  ONLY-CENTURY               VALUE 'B'.
   268         88  ONLY-LEAP-YEAR             VALUE 'C'.
   269         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   270     12  DC-END-OF-MONTH               PIC X.
   271         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   272     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   273         88  USE-NORMAL-PROCESS         VALUE ' '.
   274         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   275         88  ADJUST-UP-100-YRS          VALUE '2'.
   276     12  FILLER                        PIC X.
   277     12  DC-CONVERSION-DATES.
   278         16  DC-BIN-DATE-1             PIC XX.
   279         16  DC-BIN-DATE-2             PIC XX.
   280         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   281         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   282                       DC-GREG-DATE-1-EDIT.
   283             20  DC-EDIT1-MONTH        PIC 99.
   284             20  SLASH1-1              PIC X.
   285             20  DC-EDIT1-DAY          PIC 99.
   286             20  SLASH1-2              PIC X.
   287             20  DC-EDIT1-YEAR         PIC 99.
   288         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   289         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   290                     DC-GREG-DATE-2-EDIT.
   291             20  DC-EDIT2-MONTH        PIC 99.
   292             20  SLASH2-1              PIC X.
   293             20  DC-EDIT2-DAY          PIC 99.
   294             20  SLASH2-2              PIC X.
   295             20  DC-EDIT2-YEAR         PIC 99.
   296         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   297         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   298                     DC-GREG-DATE-1-YMD.
   299             20  DC-YMD-YEAR           PIC 99.
   300             20  DC-YMD-MONTH          PIC 99.
   301             20  DC-YMD-DAY            PIC 99.
   302         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   303         16  DC-GREG-DATE-1-MDY-R REDEFINES
   304                      DC-GREG-DATE-1-MDY.
   305             20  DC-MDY-MONTH          PIC 99.
   306             20  DC-MDY-DAY            PIC 99.
   307             20  DC-MDY-YEAR           PIC 99.
   308         16  DC-GREG-DATE-1-ALPHA.
   309             20  DC-ALPHA-MONTH        PIC X(10).
   310             20  DC-ALPHA-DAY          PIC 99.
   311             20  FILLER                PIC XX.
   312             20  DC-ALPHA-CENTURY.
   313                 24 DC-ALPHA-CEN-N     PIC 99.
   314             20  DC-ALPHA-YEAR         PIC 99.
   315         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   316         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   317         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   318         16  DC-JULIAN-DATE            PIC 9(05).
   319         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page   9
* EL6521.cbl
   320                                       PIC 9(05).
   321         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   322             20  DC-JULIAN-YEAR        PIC 99.
   323             20  DC-JULIAN-DAYS        PIC 999.
   324         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   325         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   326         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   327     12  DATE-CONVERSION-VARIBLES.
   328         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   329         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   330             20  FILLER                PIC 9(3).
   331             20  HOLD-CEN-1-CCYY.
   332                 24  HOLD-CEN-1-CC     PIC 99.
   333                 24  HOLD-CEN-1-YY     PIC 99.
   334             20  HOLD-CEN-1-MO         PIC 99.
   335             20  HOLD-CEN-1-DA         PIC 99.
   336         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   337             20  HOLD-CEN-1-R-MO       PIC 99.
   338             20  HOLD-CEN-1-R-DA       PIC 99.
   339             20  HOLD-CEN-1-R-CCYY.
   340                 24  HOLD-CEN-1-R-CC   PIC 99.
   341                 24  HOLD-CEN-1-R-YY   PIC 99.
   342             20  FILLER                PIC 9(3).
   343         16  HOLD-CENTURY-1-X.
   344             20  FILLER                PIC X(3)  VALUE SPACES.
   345             20  HOLD-CEN-1-X-CCYY.
   346                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   347                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   348             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   349             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   350         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   351             20  HOLD-CEN-1-R-X-MO     PIC XX.
   352             20  HOLD-CEN-1-R-X-DA     PIC XX.
   353             20  HOLD-CEN-1-R-X-CCYY.
   354                 24  HOLD-CEN-1-R-X-CC PIC XX.
   355                 24  HOLD-CEN-1-R-X-YY PIC XX.
   356             20  FILLER                PIC XXX.
   357         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   358         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   359         16  DC-JULIAN-DATE-1          PIC 9(07).
   360         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   361             20  DC-JULIAN-1-CCYY.
   362                 24  DC-JULIAN-1-CC    PIC 99.
   363                 24  DC-JULIAN-1-YR    PIC 99.
   364             20  DC-JULIAN-DA-1        PIC 999.
   365         16  DC-JULIAN-DATE-2          PIC 9(07).
   366         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   367             20  DC-JULIAN-2-CCYY.
   368                 24  DC-JULIAN-2-CC    PIC 99.
   369                 24  DC-JULIAN-2-YR    PIC 99.
   370             20  DC-JULIAN-DA-2        PIC 999.
   371         16  DC-GREG-DATE-A-EDIT.
   372             20  DC-EDITA-MONTH        PIC 99.
   373             20  SLASHA-1              PIC X VALUE '/'.
   374             20  DC-EDITA-DAY          PIC 99.
   375             20  SLASHA-2              PIC X VALUE '/'.
   376             20  DC-EDITA-CCYY.
   377                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  10
* EL6521.cbl
   378                 24  DC-EDITA-YEAR     PIC 99.
   379         16  DC-GREG-DATE-B-EDIT.
   380             20  DC-EDITB-MONTH        PIC 99.
   381             20  SLASHB-1              PIC X VALUE '/'.
   382             20  DC-EDITB-DAY          PIC 99.
   383             20  SLASHB-2              PIC X VALUE '/'.
   384             20  DC-EDITB-CCYY.
   385                 24  DC-EDITB-CENT     PIC 99.
   386                 24  DC-EDITB-YEAR     PIC 99.
   387         16  DC-GREG-DATE-CYMD         PIC 9(08).
   388         16  DC-GREG-DATE-CYMD-R REDEFINES
   389                              DC-GREG-DATE-CYMD.
   390             20  DC-CYMD-CEN           PIC 99.
   391             20  DC-CYMD-YEAR          PIC 99.
   392             20  DC-CYMD-MONTH         PIC 99.
   393             20  DC-CYMD-DAY           PIC 99.
   394         16  DC-GREG-DATE-MDCY         PIC 9(08).
   395         16  DC-GREG-DATE-MDCY-R REDEFINES
   396                              DC-GREG-DATE-MDCY.
   397             20  DC-MDCY-MONTH         PIC 99.
   398             20  DC-MDCY-DAY           PIC 99.
   399             20  DC-MDCY-CEN           PIC 99.
   400             20  DC-MDCY-YEAR          PIC 99.
   401    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   402        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   403    12  DC-EL310-DATE                  PIC X(21).
   404    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  11
* EL6521.cbl
   406*    COPY ELCATTR.
   407******************************************************************
   408*                                                                *
   409*                            ELCATTR.                            *
   410*                            VMOD=2.001                          *
   411*                                                                *
   412*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   413*                                                                *
   414*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   415*                                                                *
   416*                   POS 1   P=PROTECTED                          *
   417*                           U=UNPROTECTED                        *
   418*                           S=ASKIP                              *
   419*                   POS 2   A=ALPHA/NUMERIC                      *
   420*                           N=NUMERIC                            *
   421*                   POS 3   N=NORMAL                             *
   422*                           B=BRIGHT                             *
   423*                           D=DARK                               *
   424*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   425*                           OF=MODIFIED DATA TAG OFF             *
   426*                                                                *
   427*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   428******************************************************************
   429 01  ATTRIBUTE-LIST.
   430     12  AL-PABOF            PIC X       VALUE 'Y'.
   431     12  AL-PABON            PIC X       VALUE 'Z'.
   432     12  AL-PADOF            PIC X       VALUE '%'.
   433     12  AL-PADON            PIC X       VALUE '_'.
   434     12  AL-PANOF            PIC X       VALUE '-'.
   435     12  AL-PANON            PIC X       VALUE '/'.
   436     12  AL-SABOF            PIC X       VALUE '8'.
   437     12  AL-SABON            PIC X       VALUE '9'.
   438     12  AL-SADOF            PIC X       VALUE '@'.
   439     12  AL-SADON            PIC X       VALUE QUOTE.
   440     12  AL-SANOF            PIC X       VALUE '0'.
   441     12  AL-SANON            PIC X       VALUE '1'.
   442     12  AL-UABOF            PIC X       VALUE 'H'.
   443     12  AL-UABON            PIC X       VALUE 'I'.
   444     12  AL-UADOF            PIC X       VALUE '<'.
   445     12  AL-UADON            PIC X       VALUE '('.
   446     12  AL-UANOF            PIC X       VALUE ' '.
   447     12  AL-UANON            PIC X       VALUE 'A'.
   448     12  AL-UNBOF            PIC X       VALUE 'Q'.
   449     12  AL-UNBON            PIC X       VALUE 'R'.
   450     12  AL-UNDOF            PIC X       VALUE '*'.
   451     12  AL-UNDON            PIC X       VALUE ')'.
   452     12  AL-UNNOF            PIC X       VALUE '&'.
   453     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  12
* EL6521.cbl
   455*    COPY ELCEMIB.
   456******************************************************************
   457*                                                                *
   458*                                                                *
   459*                            ELCEMIB.                            *
   460*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   461*                            VMOD=2.005                          *
   462*                                                                *
   463*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   464*                                                                *
   465******************************************************************
   466 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   467     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   468     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   469     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   470     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   471     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   472     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   473     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   474     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   475     12  EMI-SWITCH1             PIC X        VALUE '1'.
   476         88  EMI-NO-ERRORS                    VALUE '1'.
   477         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   478         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   479     12  EMI-SWITCH2             PIC X        VALUE '1'.
   480         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   481     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   482         88  EMI-AREA1-EMPTY                  VALUE '1'.
   483         88  EMI-AREA1-FULL                   VALUE '2'.
   484     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   485         88  EMI-AREA2-EMPTY                  VALUE '1'.
   486         88  EMI-AREA2-FULL                   VALUE '2'.
   487     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   488         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   489         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   490         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   491         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   492         88  EMI-BYPASS-FATALS                VALUE 'X'.
   493     12  EMI-ERROR-LINES.
   494         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   495         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   496         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   497         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   498             20  EMI-ERR-CODES OCCURS 10 TIMES.
   499                 24  EMI-ERR-NUM         PIC X(4).
   500                 24  EMI-FILLER          PIC X.
   501                 24  EMI-SEV             PIC X.
   502                 24  FILLER              PIC X.
   503             20  FILLER                  PIC X(02).
   504     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   505         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   506             20  EMI-ERROR-NUMBER    PIC X(4).
   507             20  EMI-FILL            PIC X.
   508             20  EMI-SEVERITY        PIC X.
   509             20  FILLER              PIC X.
   510             20  EMI-ERROR-TEXT.
   511                 24  EMI-TEXT-VARIABLE   PIC X(10).
   512                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  13
* EL6521.cbl
   513     12  EMI-SEVERITY-SAVE           PIC X.
   514         88  EMI-NOTE                    VALUE 'N'.
   515         88  EMI-WARNING                 VALUE 'W'.
   516         88  EMI-FORCABLE                VALUE 'F'.
   517         88  EMI-FATAL                   VALUE 'X'.
   518     12  EMI-MESSAGE-FLAG            PIC X.
   519         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   520         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   521     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   522     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   523         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   524         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   525         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   526     12  emi-claim-no                pic x(7).
   527     12  emi-claim-type              pic x(6).
   528     12  FILLER                      PIC X(124)  VALUE SPACES.
   529     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   530     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   531     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   532     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  14
* EL6521.cbl
   534*    COPY ELCSCTM.
   535******************************************************************
   536*                                                                *
   537*                                                                *
   538*                            ELCSCTM                             *
   539*                            VMOD=2.001                          *
   540*                                                                *
   541*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   542*                                                                *
   543******************************************************************
   544 01  SECURITY-MESSAGE.
   545     12  FILLER                          PIC X(30)
   546            VALUE '** LOGIC SECURITY VIOLATION -'.
   547     12  SM-READ                         PIC X(6).
   548     12  FILLER                          PIC X(5)
   549            VALUE ' PGM='.
   550     12  SM-PGM                          PIC X(6).
   551     12  FILLER                          PIC X(5)
   552            VALUE ' OPR='.
   553     12  SM-PROCESSOR-ID                 PIC X(4).
   554     12  FILLER                          PIC X(6)
   555            VALUE ' TERM='.
   556     12  SM-TERMID                       PIC X(4).
   557     12  FILLER                          PIC XX   VALUE SPACE.
   558     12  SM-JUL-DATE                     PIC 9(5).
   559     12  FILLER                          PIC X    VALUE SPACE.
   560     12  SM-TIME                         PIC 99.99.
   561
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  15
* EL6521.cbl
   563*    COPY ELCSCRTY.
   564******************************************************************
   565*                                                                *
   566*                                                                *
   567*                            ELCSCRTY                            *
   568*                            VMOD=2.001                          *
   569*                                                                *
   570*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   571*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   572*        SAVED IN PI-SECURITY-ADDRESS.                           *
   573*                                                                *
   574******************************************************************
   575 01  SECURITY-CONTROL.
   576     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   577     12  FILLER                       PIC XX    VALUE 'SC'.
   578     12  SC-CREDIT-CODES.
   579         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   580             20  SC-CREDIT-DISPLAY    PIC X.
   581             20  SC-CREDIT-UPDATE     PIC X.
   582     12  SC-CLAIMS-CODES.
   583         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   584             20  SC-CLAIMS-DISPLAY    PIC X.
   585             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  16
* EL6521.cbl
   587*    COPY ELCINTF.
   588******************************************************************
   589*                                                                *
   590*                                                                *
   591*                            ELCINTF.                            *
   592*                            VMOD=2.017                          *
   593*                                                                *
   594*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   595*                                                                *
   596*       LENGTH = 1024                                            *
   597*                                                                *
   598******************************************************************
   599*                   C H A N G E   L O G
   600*
   601* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   602*-----------------------------------------------------------------
   603*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   604* EFFECTIVE    NUMBER
   605*-----------------------------------------------------------------
   606* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   607******************************************************************
   608 01  PROGRAM-INTERFACE-BLOCK.
   609     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   610     12  PI-CALLING-PROGRAM              PIC X(8).
   611     12  PI-SAVED-PROGRAM-1              PIC X(8).
   612     12  PI-SAVED-PROGRAM-2              PIC X(8).
   613     12  PI-SAVED-PROGRAM-3              PIC X(8).
   614     12  PI-SAVED-PROGRAM-4              PIC X(8).
   615     12  PI-SAVED-PROGRAM-5              PIC X(8).
   616     12  PI-SAVED-PROGRAM-6              PIC X(8).
   617     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   618     12  PI-COMPANY-ID                   PIC XXX.
   619     12  PI-COMPANY-CD                   PIC X.
   620
   621     12  PI-COMPANY-PASSWORD             PIC X(8).
   622
   623     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   624
   625     12  PI-CONTROL-IN-PROGRESS.
   626         16  PI-CARRIER                  PIC X.
   627         16  PI-GROUPING                 PIC X(6).
   628         16  PI-STATE                    PIC XX.
   629         16  PI-ACCOUNT                  PIC X(10).
   630         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   631                                         PIC X(10).
   632         16  PI-CLAIM-CERT-GRP.
   633             20  PI-CLAIM-NO             PIC X(7).
   634             20  PI-CERT-NO.
   635                 25  PI-CERT-PRIME       PIC X(10).
   636                 25  PI-CERT-SFX         PIC X.
   637             20  PI-CERT-EFF-DT          PIC XX.
   638         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   639             20  PI-PLAN-CODE            PIC X(2).
   640             20  PI-REVISION-NUMBER      PIC X(3).
   641             20  PI-PLAN-EFF-DT          PIC X(2).
   642             20  PI-PLAN-EXP-DT          PIC X(2).
   643             20  FILLER                  PIC X(11).
   644         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  17
* EL6521.cbl
   645             20  PI-OE-REFERENCE-1.
   646                 25  PI-OE-REF-1-PRIME   PIC X(18).
   647                 25  PI-OE-REF-1-SUFF    PIC XX.
   648
   649     12  PI-SESSION-IN-PROGRESS          PIC X.
   650         88  CLAIM-SESSION                   VALUE '1'.
   651         88  CREDIT-SESSION                  VALUE '2'.
   652         88  WARRANTY-SESSION                VALUE '3'.
   653         88  MORTGAGE-SESSION                VALUE '4'.
   654         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   655
   656
   657*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   658
   659     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   660     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   661
   662     12  PI-CREDIT-USER                  PIC X.
   663         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   664         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   665
   666     12  PI-CLAIM-USER                   PIC X.
   667         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   668         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   669
   670     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   671         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   672         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   673         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   674         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   675         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   676
   677     12  PI-PROCESSOR-ID                 PIC X(4).
   678
   679     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   680
   681     12  PI-MEMBER-CAPTION               PIC X(10).
   682
   683     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   684         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   685
   686     12  PI-LIFE-OVERRIDE-L1             PIC X.
   687     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   688     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   689     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   690
   691     12  PI-AH-OVERRIDE-L1               PIC X.
   692     12  PI-AH-OVERRIDE-L2               PIC XX.
   693     12  PI-AH-OVERRIDE-L6               PIC X(6).
   694     12  PI-AH-OVERRIDE-L12              PIC X(12).
   695
   696     12  PI-NEW-SYSTEM                   PIC X(2).
   697
   698     12  PI-PRIMARY-CERT-NO              PIC X(11).
   699     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   700         88  PI-USES-PAID-TO                 VALUE '1'.
   701     12  PI-CRDTCRD-SYSTEM.
   702         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  18
* EL6521.cbl
   703             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   704             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   705         16  PI-CC-MONTH-END-DT          PIC XX.
   706     12  PI-PROCESSOR-PRINTER            PIC X(4).
   707
   708     12  PI-OE-REFERENCE-2.
   709         16  PI-OE-REF-2-PRIME           PIC X(10).
   710         16  PI-OE-REF-2-SUFF            PIC X.
   711
   712     12  PI-REM-TRM-CALC-OPTION          PIC X.
   713
   714     12  PI-LANGUAGE-TYPE                PIC X.
   715             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   716             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   717             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   718
   719     12  PI-POLICY-LINKAGE-IND           PIC X.
   720         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   721         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   722                                                   LOW-VALUES.
   723
   724     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   725     12  PI-CLAIM-PW-SESSION             PIC X(1).
   726         88  PI-CLAIM-CREDIT                 VALUE '1'.
   727         88  PI-CLAIM-CONVEN                 VALUE '2'.
   728
   729     12  PI-PROCESSOR-CSR-IND            PIC X.
   730         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   731         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   732
   733     12  FILLER                          PIC X(3).
   734
   735     12  PI-SYSTEM-LEVEL                 PIC X(145).
   736
   737     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   738         PI-SYSTEM-LEVEL.
   739
   740         16  PI-ENTRY-CODES.
   741             20  PI-ENTRY-CD-1           PIC X.
   742             20  PI-ENTRY-CD-2           PIC X.
   743
   744         16  PI-RETURN-CODES.
   745             20  PI-RETURN-CD-1          PIC X.
   746             20  PI-RETURN-CD-2          PIC X.
   747
   748         16  PI-UPDATE-STATUS-SAVE.
   749             20  PI-UPDATE-BY            PIC X(4).
   750             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   751
   752         16  PI-LOWER-CASE-LETTERS       PIC X.
   753             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   754
   755*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   756*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   757*            88  CARRIER-CLM-CNTL            VALUE '2'.
   758
   759         16  PI-CERT-ACCESS-CONTROL      PIC X.
   760             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  19
* EL6521.cbl
   761             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   762             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   763             88  ACCNT-CNTL                  VALUE '3'.
   764             88  CARR-ACCNT-CNTL             VALUE '4'.
   765
   766         16  PI-PROCESSOR-CAP-LIST.
   767             20  PI-SYSTEM-CONTROLS.
   768                24 PI-SYSTEM-DISPLAY     PIC X.
   769                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   770                24 PI-SYSTEM-MODIFY      PIC X.
   771                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   772             20  FILLER                  PIC XX.
   773             20  PI-DISPLAY-CAP          PIC X.
   774                 88  DISPLAY-CAP             VALUE 'Y'.
   775             20  PI-MODIFY-CAP           PIC X.
   776                 88  MODIFY-CAP              VALUE 'Y'.
   777             20  PI-MSG-AT-LOGON-CAP     PIC X.
   778                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   779             20  PI-FORCE-CAP            PIC X.
   780                 88  FORCE-CAP               VALUE 'Y'.
   781
   782         16  PI-PROGRAM-CONTROLS.
   783             20  PI-PGM-PRINT-OPT        PIC X.
   784             20  PI-PGM-FORMAT-OPT       PIC X.
   785             20  PI-PGM-PROCESS-OPT      PIC X.
   786             20  PI-PGM-TOTALS-OPT       PIC X.
   787
   788         16  PI-HELP-INTERFACE.
   789             20  PI-LAST-ERROR-NO        PIC X(4).
   790             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   791
   792         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   793             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   794
   795         16  PI-CR-CONTROL-IN-PROGRESS.
   796             20  PI-CR-CARRIER           PIC X.
   797             20  PI-CR-GROUPING          PIC X(6).
   798             20  PI-CR-STATE             PIC XX.
   799             20  PI-CR-ACCOUNT           PIC X(10).
   800             20  PI-CR-FIN-RESP          PIC X(10).
   801             20  PI-CR-TYPE              PIC X.
   802
   803         16  PI-CR-BATCH-NUMBER          PIC X(6).
   804
   805         16  PI-CR-MONTH-END-DT          PIC XX.
   806
   807         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   808             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   809             88  PI-ZERO-CARRIER             VALUE '1'.
   810             88  PI-ZERO-GROUPING            VALUE '2'.
   811             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   812
   813         16  PI-CARRIER-SECURITY         PIC X.
   814             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   815
   816         16  PI-ACCOUNT-SECURITY         PIC X(10).
   817             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   818             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  20
* EL6521.cbl
   819
   820         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   821             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   822                                         INDEXED BY PI-ACCESS-NDX
   823                                         PIC X.
   824
   825         16  PI-GA-BILLING-CONTROL       PIC X.
   826             88  PI-GA-BILLING               VALUE '1'.
   827
   828         16  PI-MAIL-PROCESSING          PIC X.
   829             88  PI-MAIL-YES                 VALUE 'Y'.
   830
   831         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   832
   833         16  PI-AR-SYSTEM.
   834             20  PI-AR-PROCESSING-CNTL   PIC X.
   835                 88  PI-AR-PROCESSING        VALUE 'Y'.
   836             20  PI-AR-SUMMARY-CODE      PIC X(6).
   837             20  PI-AR-MONTH-END-DT      PIC XX.
   838
   839         16  PI-MP-SYSTEM.
   840             20  PI-MORTGAGE-USER            PIC X.
   841                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   842                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   843             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   844                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   845                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   846                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   847                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   848                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   849             20  PI-MP-MONTH-END-DT          PIC XX.
   850             20  PI-MP-REFERENCE-NO.
   851                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   852                 24  PI-MP-REFERENCE-SFX     PIC XX.
   853
   854         16  PI-LABEL-CONTROL            PIC X(01).
   855             88  PI-CREATE-LABELS                    VALUE 'Y'.
   856             88  PI-BYPASS-LABELS                    VALUE 'N'.
   857
   858         16  PI-BILL-GROUPING-CODE       PIC X(01).
   859             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   860
   861         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   862             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   863             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   864
   865         16  FILLER                      PIC X(14).
   866
   867     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   868******************************************************************
   869     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
   870         16  PI-MAINT                PIC  X.
   871         16  PI-CHECK-TYPE           PIC  X.
   872         16  PI-CHECK-CARRY-BAL      PIC  X.
   873         16  PI-FIRST-TIME-SW        PIC  X.
   874             88  FIRST-TIME                  VALUE 'Y'.
   875         16  PI-ERCOMP-EOF-SW        PIC  X.
   876             88  ERCOMP-EOF                  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  21
* EL6521.cbl
   877         16  PI-SAVE-PHONE           PIC  X(10).
   878         16  PI-SAVE-PHONE-RED REDEFINES PI-SAVE-PHONE  PIC 9(10).
   879         16  PI-ERC-END-BAL          PIC S9(9)V99       COMP-3.
   880         16  PI-ERCOMP-KEY.
   881             20  PI-ERC-GROUP-CD     PIC  X.
   882             20  PI-ERC-CARRIER      PIC  X.
   883             20  PI-ERC-GROUP        PIC  X(6).
   884             20  PI-ERC-RESP         PIC  X(10).
   885             20  PI-ERC-ACCT         PIC  X(10).
   886             20  PI-ERC-TYPE         PIC  X.
   887         16  PI-SAVE-ERCOMP-KEY      PIC  X(29).
   888         16  PI-BANK-TRANSIT-NUMBER.
   889             20  PI-BANK-COMPANY-CD  PIC X.
   890             20  PI-FEDERAL-NUMBER   PIC X(4).
   891             20  PI-BANK-NUMBER      PIC X(4).
   892         16  PI-BANK-ACCOUNT-NO      PIC X(17).
   893         16  PI-BANK-ACTION-CODE     PIC X.
   894         16  PI-ERCOBI-KEY.
   895             20  PI-ERCOBI-COMPANY-CD PIC X.
   896             20  PI-ERCOBI-STMT-OWNER PIC X(4).
   897             20  PI-ERCOBI-RGID      PIC X(12).
   898         16  PI-SAVE-ERCOBI-KEY      PIC X(17).
   899         16  FILLER                  PIC  X(500).
   900
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  22
* EL6521.cbl
   902*    COPY ELCAID.
   903******************************************************************
   904*                                                                *
   905*                            ELCAID.                             *
   906*                            VMOD=2.001                          *
   907*                                                                *
   908*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   909*                                                                *
   910*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   911*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   912******************************************************************
   913
   914 01  DFHAID.
   915   02  DFHNULL   PIC  X  VALUE  ' '.
   916   02  DFHENTER  PIC  X  VALUE  QUOTE.
   917   02  DFHCLEAR  PIC  X  VALUE  '_'.
   918   02  DFHPEN    PIC  X  VALUE  '='.
   919   02  DFHOPID   PIC  X  VALUE  'W'.
   920   02  DFHPA1    PIC  X  VALUE  '%'.
   921   02  DFHPA2    PIC  X  VALUE  '>'.
   922   02  DFHPA3    PIC  X  VALUE  ','.
   923   02  DFHPF1    PIC  X  VALUE  '1'.
   924   02  DFHPF2    PIC  X  VALUE  '2'.
   925   02  DFHPF3    PIC  X  VALUE  '3'.
   926   02  DFHPF4    PIC  X  VALUE  '4'.
   927   02  DFHPF5    PIC  X  VALUE  '5'.
   928   02  DFHPF6    PIC  X  VALUE  '6'.
   929   02  DFHPF7    PIC  X  VALUE  '7'.
   930   02  DFHPF8    PIC  X  VALUE  '8'.
   931   02  DFHPF9    PIC  X  VALUE  '9'.
   932   02  DFHPF10   PIC  X  VALUE  ':'.
   933   02  DFHPF11   PIC  X  VALUE  '#'.
   934   02  DFHPF12   PIC  X  VALUE  '@'.
   935   02  DFHPF13   PIC  X  VALUE  'A'.
   936   02  DFHPF14   PIC  X  VALUE  'B'.
   937   02  DFHPF15   PIC  X  VALUE  'C'.
   938   02  DFHPF16   PIC  X  VALUE  'D'.
   939   02  DFHPF17   PIC  X  VALUE  'E'.
   940   02  DFHPF18   PIC  X  VALUE  'F'.
   941   02  DFHPF19   PIC  X  VALUE  'G'.
   942   02  DFHPF20   PIC  X  VALUE  'H'.
   943   02  DFHPF21   PIC  X  VALUE  'I'.
   944*00039    02  DFHPF22   PIC  X  VALUE  ''.
   945   02  DFHPF22   PIC  X  VALUE  '['.
   946   02  DFHPF23   PIC  X  VALUE  '.'.
   947   02  DFHPF24   PIC  X  VALUE  '<'.
   948   02  DFHMSRE   PIC  X  VALUE  'X'.
   949   02  DFHSTRF   PIC  X  VALUE  'h'.
   950   02  DFHTRIG   PIC  X  VALUE  '"'.
   951 01  FILLER    REDEFINES DFHAID.
   952     12  FILLER                      PIC X(8).
   953     12  PF-VALUES                   PIC X       OCCURS 2.
   954
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  23
* EL6521.cbl
   956*    COPY EL6521S.
   957 01  EL6521AI.
   958     05  FILLER            PIC  X(0012).
   959*    -------------------------------
   960     05  DATEL PIC S9(0004) COMP.
   961     05  DATEF PIC  X(0001).
   962     05  FILLER REDEFINES DATEF.
   963         10  DATEA PIC  X(0001).
   964     05  DATEI PIC  X(0008).
   965*    -------------------------------
   966     05  TIMEL PIC S9(0004) COMP.
   967     05  TIMEF PIC  X(0001).
   968     05  FILLER REDEFINES TIMEF.
   969         10  TIMEA PIC  X(0001).
   970     05  TIMEI PIC  X(0005).
   971*    -------------------------------
   972     05  CMPNYIDL PIC S9(0004) COMP.
   973     05  CMPNYIDF PIC  X(0001).
   974     05  FILLER REDEFINES CMPNYIDF.
   975         10  CMPNYIDA PIC  X(0001).
   976     05  CMPNYIDI PIC  X(0003).
   977*    -------------------------------
   978     05  USERIDL PIC S9(0004) COMP.
   979     05  USERIDF PIC  X(0001).
   980     05  FILLER REDEFINES USERIDF.
   981         10  USERIDA PIC  X(0001).
   982     05  USERIDI PIC  X(0004).
   983*    -------------------------------
   984     05  MAINTYPL PIC S9(0004) COMP.
   985     05  MAINTYPF PIC  X(0001).
   986     05  FILLER REDEFINES MAINTYPF.
   987         10  MAINTYPA PIC  X(0001).
   988     05  MAINTYPI PIC  X(0001).
   989*    -------------------------------
   990     05  CARRIERL PIC S9(0004) COMP.
   991     05  CARRIERF PIC  X(0001).
   992     05  FILLER REDEFINES CARRIERF.
   993         10  CARRIERA PIC  X(0001).
   994     05  CARRIERI PIC  X(0001).
   995*    -------------------------------
   996     05  GROUPL PIC S9(0004) COMP.
   997     05  GROUPF PIC  X(0001).
   998     05  FILLER REDEFINES GROUPF.
   999         10  GROUPA PIC  X(0001).
  1000     05  GROUPI PIC  X(0006).
  1001*    -------------------------------
  1002     05  TYPEL PIC S9(0004) COMP.
  1003     05  TYPEF PIC  X(0001).
  1004     05  FILLER REDEFINES TYPEF.
  1005         10  TYPEA PIC  X(0001).
  1006     05  TYPEI PIC  X(0001).
  1007*    -------------------------------
  1008     05  FINRESPL PIC S9(0004) COMP.
  1009     05  FINRESPF PIC  X(0001).
  1010     05  FILLER REDEFINES FINRESPF.
  1011         10  FINRESPA PIC  X(0001).
  1012     05  FINRESPI PIC  X(0010).
  1013*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  24
* EL6521.cbl
  1014     05  COACCTL PIC S9(0004) COMP.
  1015     05  COACCTF PIC  X(0001).
  1016     05  FILLER REDEFINES COACCTF.
  1017         10  COACCTA PIC  X(0001).
  1018     05  COACCTI PIC  X(0010).
  1019*    -------------------------------
  1020     05  EFFDTL PIC S9(0004) COMP.
  1021     05  EFFDTF PIC  X(0001).
  1022     05  FILLER REDEFINES EFFDTF.
  1023         10  EFFDTA PIC  X(0001).
  1024     05  EFFDTI PIC  X(0008).
  1025*    -------------------------------
  1026     05  TRMDTL PIC S9(0004) COMP.
  1027     05  TRMDTF PIC  X(0001).
  1028     05  FILLER REDEFINES TRMDTF.
  1029         10  TRMDTA PIC  X(0001).
  1030     05  TRMDTI PIC  X(0008).
  1031*    -------------------------------
  1032     05  STATL PIC S9(0004) COMP.
  1033     05  STATF PIC  X(0001).
  1034     05  FILLER REDEFINES STATF.
  1035         10  STATA PIC  X(0001).
  1036     05  STATI PIC  X(0001).
  1037*    -------------------------------
  1038     05  WTHLDL PIC S9(0004) COMP.
  1039     05  WTHLDF PIC  X(0001).
  1040     05  FILLER REDEFINES WTHLDF.
  1041         10  WTHLDA PIC  X(0001).
  1042     05  WTHLDI PIC  S99V9999.
  1043*    -------------------------------
  1044     05  GADDL PIC S9(0004) COMP.
  1045     05  GADDF PIC  X(0001).
  1046     05  FILLER REDEFINES GADDF.
  1047         10  GADDA PIC  X(0001).
  1048     05  GADDI PIC  X(0001).
  1049*    -------------------------------
  1050     05  APCHKL PIC S9(0004) COMP.
  1051     05  APCHKF PIC  X(0001).
  1052     05  FILLER REDEFINES APCHKF.
  1053         10  APCHKA PIC  X(0001).
  1054     05  APCHKI PIC  X(0001).
  1055*    -------------------------------
  1056     05  MELSWL PIC S9(0004) COMP.
  1057     05  MELSWF PIC  X(0001).
  1058     05  FILLER REDEFINES MELSWF.
  1059         10  MELSWA PIC  X(0001).
  1060     05  MELSWI PIC  X(0001).
  1061*    -------------------------------
  1062     05  MDACTL PIC S9(0004) COMP.
  1063     05  MDACTF PIC  X(0001).
  1064     05  FILLER REDEFINES MDACTF.
  1065         10  MDACTA PIC  X(0001).
  1066     05  MDACTI PIC  X(0010).
  1067*    -------------------------------
  1068     05  MDDIVL PIC S9(0004) COMP.
  1069     05  MDDIVF PIC  X(0001).
  1070     05  FILLER REDEFINES MDDIVF.
  1071         10  MDDIVA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  25
* EL6521.cbl
  1072     05  MDDIVI PIC  X(0002).
  1073*    -------------------------------
  1074     05  MDCNTRL PIC S9(0004) COMP.
  1075     05  MDCNTRF PIC  X(0001).
  1076     05  FILLER REDEFINES MDCNTRF.
  1077         10  MDCNTRA PIC  X(0001).
  1078     05  MDCNTRI PIC  X(0004).
  1079*    -------------------------------
  1080     05  MDLOBL PIC S9(0004) COMP.
  1081     05  MDLOBF PIC  X(0001).
  1082     05  FILLER REDEFINES MDLOBF.
  1083         10  MDLOBA PIC  X(0001).
  1084     05  MDLOBI PIC  X(0006).
  1085*    -------------------------------
  1086     05  MDSTL PIC S9(0004) COMP.
  1087     05  MDSTF PIC  X(0001).
  1088     05  FILLER REDEFINES MDSTF.
  1089         10  MDSTA PIC  X(0001).
  1090     05  MDSTI PIC  X(0002).
  1091*    -------------------------------
  1092     05  MDAMTL PIC S9(0004) COMP.
  1093     05  MDAMTF PIC  X(0001).
  1094     05  FILLER REDEFINES MDAMTF.
  1095         10  MDAMTA PIC  X(0001).
  1096     05  MDAMTI PIC  S999999V99.
  1097*    -------------------------------
  1098     05  DELTOL PIC S9(0004) COMP.
  1099     05  DELTOF PIC  X(0001).
  1100     05  FILLER REDEFINES DELTOF.
  1101         10  DELTOA PIC  X(0001).
  1102     05  DELTOI PIC  X(0004).
  1103*    -------------------------------
  1104     05  RGIDL PIC S9(0004) COMP.
  1105     05  RGIDF PIC  X(0001).
  1106     05  FILLER REDEFINES RGIDF.
  1107         10  RGIDA PIC  X(0001).
  1108     05  RGIDI PIC  X(0012).
  1109*    -------------------------------
  1110     05  COMM1L PIC S9(0004) COMP.
  1111     05  COMM1F PIC  X(0001).
  1112     05  FILLER REDEFINES COMM1F.
  1113         10  COMM1A PIC  X(0001).
  1114     05  COMM1I PIC  X(0040).
  1115*    -------------------------------
  1116     05  COMM2L PIC S9(0004) COMP.
  1117     05  COMM2F PIC  X(0001).
  1118     05  FILLER REDEFINES COMM2F.
  1119         10  COMM2A PIC  X(0001).
  1120     05  COMM2I PIC  X(0040).
  1121*    -------------------------------
  1122     05  COMM3L PIC S9(0004) COMP.
  1123     05  COMM3F PIC  X(0001).
  1124     05  FILLER REDEFINES COMM3F.
  1125         10  COMM3A PIC  X(0001).
  1126     05  COMM3I PIC  X(0040).
  1127*    -------------------------------
  1128     05  COMM4L PIC S9(0004) COMP.
  1129     05  COMM4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  26
* EL6521.cbl
  1130     05  FILLER REDEFINES COMM4F.
  1131         10  COMM4A PIC  X(0001).
  1132     05  COMM4I PIC  X(0040).
  1133*    -------------------------------
  1134     05  BKLITL PIC S9(0004) COMP.
  1135     05  BKLITF PIC  X(0001).
  1136     05  FILLER REDEFINES BKLITF.
  1137         10  BKLITA PIC  X(0001).
  1138     05  BKLITI PIC  X(0023).
  1139*    -------------------------------
  1140     05  TRNSIT1L PIC S9(0004) COMP.
  1141     05  TRNSIT1F PIC  X(0001).
  1142     05  FILLER REDEFINES TRNSIT1F.
  1143         10  TRNSIT1A PIC  X(0001).
  1144     05  TRNSIT1I PIC  X(0004).
  1145*    -------------------------------
  1146     05  TRDASHL PIC S9(0004) COMP.
  1147     05  TRDASHF PIC  X(0001).
  1148     05  FILLER REDEFINES TRDASHF.
  1149         10  TRDASHA PIC  X(0001).
  1150     05  TRDASHI PIC  X(0001).
  1151*    -------------------------------
  1152     05  TRNSIT2L PIC S9(0004) COMP.
  1153     05  TRNSIT2F PIC  X(0001).
  1154     05  FILLER REDEFINES TRNSIT2F.
  1155         10  TRNSIT2A PIC  X(0001).
  1156     05  TRNSIT2I PIC  X(0004).
  1157*    -------------------------------
  1158     05  BKDESCL PIC S9(0004) COMP.
  1159     05  BKDESCF PIC  X(0001).
  1160     05  FILLER REDEFINES BKDESCF.
  1161         10  BKDESCA PIC  X(0001).
  1162     05  BKDESCI PIC  X(0023).
  1163*    -------------------------------
  1164     05  BKACCTL PIC S9(0004) COMP.
  1165     05  BKACCTF PIC  X(0001).
  1166     05  FILLER REDEFINES BKACCTF.
  1167         10  BKACCTA PIC  X(0001).
  1168     05  BKACCTI PIC  X(0017).
  1169*    -------------------------------
  1170     05  ACTLITL PIC S9(0004) COMP.
  1171     05  ACTLITF PIC  X(0001).
  1172     05  FILLER REDEFINES ACTLITF.
  1173         10  ACTLITA PIC  X(0001).
  1174     05  ACTLITI PIC  X(0023).
  1175*    -------------------------------
  1176     05  ACTCDL PIC S9(0004) COMP.
  1177     05  ACTCDF PIC  X(0001).
  1178     05  FILLER REDEFINES ACTCDF.
  1179         10  ACTCDA PIC  X(0001).
  1180     05  ACTCDI PIC  X(0001).
  1181*    -------------------------------
  1182     05  CRSLITL PIC S9(0004) COMP.
  1183     05  CRSLITF PIC  X(0001).
  1184     05  FILLER REDEFINES CRSLITF.
  1185         10  CRSLITA PIC  X(0001).
  1186     05  CRSLITI PIC  X(0017).
  1187*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  27
* EL6521.cbl
  1188     05  CRSTATL PIC S9(0004) COMP.
  1189     05  CRSTATF PIC  X(0001).
  1190     05  FILLER REDEFINES CRSTATF.
  1191         10  CRSTATA PIC  X(0001).
  1192     05  CRSTATI PIC  X(0010).
  1193*    -------------------------------
  1194     05  ERRMSG1L PIC S9(0004) COMP.
  1195     05  ERRMSG1F PIC  X(0001).
  1196     05  FILLER REDEFINES ERRMSG1F.
  1197         10  ERRMSG1A PIC  X(0001).
  1198     05  ERRMSG1I PIC  X(0071).
  1199*    -------------------------------
  1200     05  ERRMSG2L PIC S9(0004) COMP.
  1201     05  ERRMSG2F PIC  X(0001).
  1202     05  FILLER REDEFINES ERRMSG2F.
  1203         10  ERRMSG2A PIC  X(0001).
  1204     05  ERRMSG2I PIC  X(0071).
  1205*    -------------------------------
  1206     05  PFENTERL PIC S9(0004) COMP.
  1207     05  PFENTERF PIC  X(0001).
  1208     05  FILLER REDEFINES PFENTERF.
  1209         10  PFENTERA PIC  X(0001).
  1210     05  PFENTERI PIC  99.
  1211*    -------------------------------
  1212     05  ACHPF1L PIC S9(0004) COMP.
  1213     05  ACHPF1F PIC  X(0001).
  1214     05  FILLER REDEFINES ACHPF1F.
  1215         10  ACHPF1A PIC  X(0001).
  1216     05  ACHPF1I PIC  X(0015).
  1217 01  EL6521AO REDEFINES EL6521AI.
  1218     05  FILLER            PIC  X(0012).
  1219*    -------------------------------
  1220     05  FILLER            PIC  X(0003).
  1221     05  DATEO PIC  X(0008).
  1222*    -------------------------------
  1223     05  FILLER            PIC  X(0003).
  1224     05  TIMEO PIC  99.99.
  1225*    -------------------------------
  1226     05  FILLER            PIC  X(0003).
  1227     05  CMPNYIDO PIC  X(0003).
  1228*    -------------------------------
  1229     05  FILLER            PIC  X(0003).
  1230     05  USERIDO PIC  X(0004).
  1231*    -------------------------------
  1232     05  FILLER            PIC  X(0003).
  1233     05  MAINTYPO PIC  X(0001).
  1234*    -------------------------------
  1235     05  FILLER            PIC  X(0003).
  1236     05  CARRIERO PIC  X(0001).
  1237*    -------------------------------
  1238     05  FILLER            PIC  X(0003).
  1239     05  GROUPO PIC  X(0006).
  1240*    -------------------------------
  1241     05  FILLER            PIC  X(0003).
  1242     05  TYPEO PIC  X(0001).
  1243*    -------------------------------
  1244     05  FILLER            PIC  X(0003).
  1245     05  FINRESPO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  28
* EL6521.cbl
  1246*    -------------------------------
  1247     05  FILLER            PIC  X(0003).
  1248     05  COACCTO PIC  X(0010).
  1249*    -------------------------------
  1250     05  FILLER            PIC  X(0003).
  1251     05  EFFDTO PIC  X(0008).
  1252*    -------------------------------
  1253     05  FILLER            PIC  X(0003).
  1254     05  TRMDTO PIC  X(0008).
  1255*    -------------------------------
  1256     05  FILLER            PIC  X(0003).
  1257     05  STATO PIC  X(0001).
  1258*    -------------------------------
  1259     05  FILLER            PIC  X(0003).
  1260     05  WTHLDO PIC  Z.9999.
  1261*    -------------------------------
  1262     05  FILLER            PIC  X(0003).
  1263     05  GADDO PIC  X(0001).
  1264*    -------------------------------
  1265     05  FILLER            PIC  X(0003).
  1266     05  APCHKO PIC  X(0001).
  1267*    -------------------------------
  1268     05  FILLER            PIC  X(0003).
  1269     05  MELSWO PIC  X(0001).
  1270*    -------------------------------
  1271     05  FILLER            PIC  X(0003).
  1272     05  MDACTO PIC  X(0010).
  1273*    -------------------------------
  1274     05  FILLER            PIC  X(0003).
  1275     05  MDDIVO PIC  X(0002).
  1276*    -------------------------------
  1277     05  FILLER            PIC  X(0003).
  1278     05  MDCNTRO PIC  X(0004).
  1279*    -------------------------------
  1280     05  FILLER            PIC  X(0003).
  1281     05  MDLOBO PIC  X(0006).
  1282*    -------------------------------
  1283     05  FILLER            PIC  X(0003).
  1284     05  MDSTO PIC  X(0002).
  1285*    -------------------------------
  1286     05  FILLER            PIC  X(0003).
  1287     05  MDAMTO PIC  ZZZZZ.99.
  1288*    -------------------------------
  1289     05  FILLER            PIC  X(0003).
  1290     05  DELTOO PIC  X(0004).
  1291*    -------------------------------
  1292     05  FILLER            PIC  X(0003).
  1293     05  RGIDO PIC  X(0012).
  1294*    -------------------------------
  1295     05  FILLER            PIC  X(0003).
  1296     05  COMM1O PIC  X(0040).
  1297*    -------------------------------
  1298     05  FILLER            PIC  X(0003).
  1299     05  COMM2O PIC  X(0040).
  1300*    -------------------------------
  1301     05  FILLER            PIC  X(0003).
  1302     05  COMM3O PIC  X(0040).
  1303*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  29
* EL6521.cbl
  1304     05  FILLER            PIC  X(0003).
  1305     05  COMM4O PIC  X(0040).
  1306*    -------------------------------
  1307     05  FILLER            PIC  X(0003).
  1308     05  BKLITO PIC  X(0023).
  1309*    -------------------------------
  1310     05  FILLER            PIC  X(0003).
  1311     05  TRNSIT1O PIC  X(0004).
  1312*    -------------------------------
  1313     05  FILLER            PIC  X(0003).
  1314     05  TRDASHO PIC  X(0001).
  1315*    -------------------------------
  1316     05  FILLER            PIC  X(0003).
  1317     05  TRNSIT2O PIC  X(0004).
  1318*    -------------------------------
  1319     05  FILLER            PIC  X(0003).
  1320     05  BKDESCO PIC  X(0023).
  1321*    -------------------------------
  1322     05  FILLER            PIC  X(0003).
  1323     05  BKACCTO PIC  X(0017).
  1324*    -------------------------------
  1325     05  FILLER            PIC  X(0003).
  1326     05  ACTLITO PIC  X(0023).
  1327*    -------------------------------
  1328     05  FILLER            PIC  X(0003).
  1329     05  ACTCDO PIC  X(0001).
  1330*    -------------------------------
  1331     05  FILLER            PIC  X(0003).
  1332     05  CRSLITO PIC  X(0017).
  1333*    -------------------------------
  1334     05  FILLER            PIC  X(0003).
  1335     05  CRSTATO PIC  X(0010).
  1336*    -------------------------------
  1337     05  FILLER            PIC  X(0003).
  1338     05  ERRMSG1O PIC  X(0071).
  1339*    -------------------------------
  1340     05  FILLER            PIC  X(0003).
  1341     05  ERRMSG2O PIC  X(0071).
  1342*    -------------------------------
  1343     05  FILLER            PIC  X(0003).
  1344     05  PFENTERO PIC  99.
  1345*    -------------------------------
  1346     05  FILLER            PIC  X(0003).
  1347     05  ACHPF1O PIC  X(0015).
  1348*    -------------------------------
  1349
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  30
* EL6521.cbl
  1351****************************************************************
  1352*
  1353* Copyright (c) 2007 by Clerity Solutions, Inc.
  1354* All rights reserved.
  1355*
  1356****************************************************************
  1357 01  DFHEIV.
  1358   02  DFHEIV0               PIC X(35).
  1359   02  DFHEIV1               PIC X(08).
  1360   02  DFHEIV2               PIC X(08).
  1361   02  DFHEIV3               PIC X(08).
  1362   02  DFHEIV4               PIC X(06).
  1363   02  DFHEIV5               PIC X(04).
  1364   02  DFHEIV6               PIC X(04).
  1365   02  DFHEIV7               PIC X(02).
  1366   02  DFHEIV8               PIC X(02).
  1367   02  DFHEIV9               PIC X(01).
  1368   02  DFHEIV10              PIC S9(7) COMP-3.
  1369   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1370   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1371   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1372   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1373   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1374   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1375   02  DFHEIV17              PIC X(04).
  1376   02  DFHEIV18              PIC X(04).
  1377   02  DFHEIV19              PIC X(04).
  1378   02  DFHEIV20              USAGE IS POINTER.
  1379   02  DFHEIV21              USAGE IS POINTER.
  1380   02  DFHEIV22              USAGE IS POINTER.
  1381   02  DFHEIV23              USAGE IS POINTER.
  1382   02  DFHEIV24              USAGE IS POINTER.
  1383   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1384   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1385   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1386   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1387   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1388   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1389   02  FILLER                PIC X(02).
  1390   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1391   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1392   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1393   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1394   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1395 LINKAGE  SECTION.
  1396*****************************************************************
  1397*                                                               *
  1398* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1399* All rights reserved.                                          *
  1400*                                                               *
  1401*****************************************************************
  1402 01  dfheiblk.
  1403     02  eibtime          pic s9(7) comp-3.
  1404     02  eibdate          pic s9(7) comp-3.
  1405     02  eibtrnid         pic x(4).
  1406     02  eibtaskn         pic s9(7) comp-3.
  1407     02  eibtrmid         pic x(4).
  1408     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  31
* EL6521.cbl
  1409     02  eibcposn         pic s9(4) comp.
  1410     02  eibcalen         pic s9(4) comp.
  1411     02  eibaid           pic x(1).
  1412     02  eibfiller1       pic x(1).
  1413     02  eibfn            pic x(2).
  1414     02  eibfiller2       pic x(2).
  1415     02  eibrcode         pic x(6).
  1416     02  eibfiller3       pic x(2).
  1417     02  eibds            pic x(8).
  1418     02  eibreqid         pic x(8).
  1419     02  eibrsrce         pic x(8).
  1420     02  eibsync          pic x(1).
  1421     02  eibfree          pic x(1).
  1422     02  eibrecv          pic x(1).
  1423     02  eibsend          pic x(1).
  1424     02  eibatt           pic x(1).
  1425     02  eibeoc           pic x(1).
  1426     02  eibfmh           pic x(1).
  1427     02  eibcompl         pic x(1).
  1428     02  eibsig           pic x(1).
  1429     02  eibconf          pic x(1).
  1430     02  eiberr           pic x(1).
  1431     02  eibrldbk         pic x(1).
  1432     02  eiberrcd         pic x(4).
  1433     02  eibsynrb         pic x(1).
  1434     02  eibnodat         pic x(1).
  1435     02  eibfiller5       pic x(2).
  1436     02  eibresp          pic 9(09) comp.
  1437     02  eibresp2         pic 9(09) comp.
  1438     02  dfheigdj         pic s9(4) comp.
  1439     02  dfheigdk         pic s9(4) comp.
  1440 01  DFHCOMMAREA                     PIC X(1024).
  1441
  1442*    COPY ERCCOMP.
  1443******************************************************************
  1444*                                                                *
  1445*                                                                *
  1446*                            ERCCOMP                             *
  1447*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1448*                            VMOD=2.019                          *
  1449*                                                                *
  1450*   ONLINE CREDIT SYSTEM                                         *
  1451*                                                                *
  1452*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1453*                                                                *
  1454*   FILE TYPE = VSAM,KSDS                                        *
  1455*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1456*                                                                *
  1457*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1458*       ALTERNATE PATH = NONE                                    *
  1459*                                                                *
  1460*   LOG = NO                                                     *
  1461*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1462*                                                                *
  1463******************************************************************
  1464*                   C H A N G E   L O G
  1465*
  1466* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  32
* EL6521.cbl
  1467*-----------------------------------------------------------------
  1468*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1469* EFFECTIVE    NUMBER
  1470*-----------------------------------------------------------------
  1471* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1472* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1473* 092205    2005050300006  PEMA  ADD LEASE FEE
  1474* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1475* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1476* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1477* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1478* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1479* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1480******************************************************************
  1481
  1482 01  COMPENSATION-MASTER.
  1483     12  CO-RECORD-ID                          PIC XX.
  1484         88  VALID-CO-ID                          VALUE 'CO'.
  1485
  1486     12  CO-CONTROL-PRIMARY.
  1487         16  CO-COMPANY-CD                     PIC X.
  1488         16  CO-CONTROL.
  1489             20  CO-CTL-1.
  1490                 24  CO-CARR-GROUP.
  1491                     28  CO-CARRIER            PIC X.
  1492                     28  CO-GROUPING.
  1493                         32  CO-GROUP-PREFIX   PIC XXX.
  1494                         32  CO-GROUP-PRIME    PIC XXX.
  1495                 24  CO-RESP-NO.
  1496                     28  CO-RESP-PREFIX        PIC X(4).
  1497                     28  CO-RESP-PRIME         PIC X(6).
  1498             20  CO-CTL-2.
  1499                 24  CO-ACCOUNT.
  1500                     28  CO-ACCT-PREFIX        PIC X(4).
  1501                     28  CO-ACCT-PRIME         PIC X(6).
  1502         16  CO-TYPE                           PIC X.
  1503             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1504             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1505             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1506
  1507     12  CO-MAINT-INFORMATION.
  1508         16  CO-LAST-MAINT-DT                  PIC XX.
  1509         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1510         16  CO-LAST-MAINT-USER                PIC X(4).
  1511     12  FILLER                                PIC XX.
  1512     12  CO-STMT-TYPE                          PIC XXX.
  1513     12  CO-COMP-TYPE                          PIC X.
  1514         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1515     12  CO-STMT-OWNER                         PIC X(4).
  1516     12  CO-BALANCE-CONTROL                    PIC X.
  1517         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1518         88  CO-NO-BALANCE                        VALUE 'N'.
  1519
  1520     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1521         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1522         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1523         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1524
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  33
* EL6521.cbl
  1525     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1526         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1527         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1528
  1529     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1530     12  CO-GA-DIRECT-DEP                      PIC X.
  1531     12  CO-FUTURE-SPACE                       PIC X.
  1532         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1533
  1534     12  CO-ACCT-NAME                          PIC X(30).
  1535     12  CO-MAIL-NAME                          PIC X(30).
  1536     12  CO-ADDR-1                             PIC X(30).
  1537     12  CO-ADDR-2                             PIC X(30).
  1538     12  CO-ADDR-3.
  1539         16  CO-ADDR-CITY                      PIC X(27).
  1540         16  CO-ADDR-STATE                     PIC XX.
  1541     12  CO-CSO-1099                           PIC X.
  1542     12  CO-ZIP.
  1543         16  CO-ZIP-PRIME.
  1544             20  CO-ZIP-PRI-1ST                PIC X.
  1545                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1546             20  FILLER                        PIC X(4).
  1547         16  CO-ZIP-PLUS4                      PIC X(4).
  1548     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1549         16  CO-CAN-POSTAL-1                   PIC XXX.
  1550         16  CO-CAN-POSTAL-2                   PIC XXX.
  1551         16  FILLER                            PIC XXX.
  1552     12  CO-SOC-SEC                            PIC X(13).
  1553     12  CO-TELEPHONE.
  1554         16  CO-AREA-CODE                      PIC XXX.
  1555         16  CO-PREFIX                         PIC XXX.
  1556         16  CO-PHONE                          PIC X(4).
  1557
  1558     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1559
  1560     12  CO-AR-BAL-LEVEL                       PIC X.
  1561         88  CO-AR-REF-LVL                        VALUE '1'.
  1562         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1563         88  CO-AR-BILL-LVL                       VALUE '2'.
  1564         88  CO-AR-AGT-LVL                        VALUE '3'.
  1565         88  CO-AR-FR-LVL                         VALUE '4'.
  1566
  1567     12  CO-AR-NORMAL-PRINT                    PIC X.
  1568         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1569         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1570
  1571     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1572
  1573     12  CO-AR-REPORTING                       PIC X.
  1574         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1575         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1576
  1577     12  CO-AR-PULL-CHECK                      PIC X.
  1578         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1579         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1580
  1581     12  CO-AR-BALANCE-PRINT                   PIC X.
  1582         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  34
* EL6521.cbl
  1583
  1584     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1585         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1586         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1587         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1588
  1589     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1590
  1591     12  CO-USER-CODE                          PIC X.
  1592     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1593
  1594******************************************************************
  1595*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1596*    THE LAST MONTH END RUN.
  1597******************************************************************
  1598
  1599     12  CO-LAST-ACTIVITY-DATE.
  1600         16  CO-ACT-YEAR                       PIC 99.
  1601         16  CO-ACT-MONTH                      PIC 99.
  1602         16  CO-ACT-DAY                        PIC 99.
  1603
  1604     12  CO-LAST-STMT-DT.
  1605         16  CO-LAST-STMT-YEAR                 PIC 99.
  1606         16  CO-LAST-STMT-MONTH                PIC 99.
  1607         16  CO-LAST-STMT-DAY                  PIC 99.
  1608
  1609     12  CO-MO-END-TOTALS.
  1610         16  CO-MONTHLY-TOTALS.
  1611             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1612             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1613             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1614             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1615             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1616
  1617         16  CO-AGING-TOTALS.
  1618             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1619             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1620             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1621             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1622
  1623         16  CO-YTD-TOTALS.
  1624             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1625             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1626
  1627         16  CO-OVER-UNDER-TOTALS.
  1628             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1629             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1630
  1631     12  CO-MISCELLANEOUS-TOTALS.
  1632         16  CO-FICA-TOTALS.
  1633             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1634             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1635
  1636         16  CO-CLAIM-TOTALS.
  1637             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1638             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1639
  1640******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  35
* EL6521.cbl
  1641*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1642*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1643******************************************************************
  1644
  1645     12  CO-CURRENT-TOTALS.
  1646         16  CO-CURRENT-LAST-STMT-DT.
  1647             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1648             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1649             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1650
  1651         16  CO-CURRENT-MONTHLY-TOTALS.
  1652             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1653             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1654             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1655             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1656             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1657
  1658         16  CO-CURRENT-AGING-TOTALS.
  1659             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1660             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1661             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1662             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1663
  1664         16  CO-CURRENT-YTD-TOTALS.
  1665             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1666             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1667
  1668     12  CO-PAID-COMM-TOTALS.
  1669         16  CO-YTD-PAID-COMMS.
  1670             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1671             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1672
  1673     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1674         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1675         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1676
  1677     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1678         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1679         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1680         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1681         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1682         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1683         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1684         88  CO-FINAL-LETTER                  VALUE 'F'.
  1685         88  CO-RECONCILING                   VALUE 'R'.
  1686         88  CO-PHONE-CALL                    VALUE 'P'.
  1687         88  CO-LEGAL                         VALUE 'L'.
  1688         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1689         88  CO-WRITE-OFF                     VALUE 'W'.
  1690         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1691
  1692     12  CO-CSR-CODE                       PIC X(4).
  1693
  1694     12  CO-GA-STATUS-INFO.
  1695         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1696         16  CO-GA-TERMINATION-DT          PIC XX.
  1697         16  CO-GA-STATUS-CODE             PIC X.
  1698             88  CO-GA-ACTIVE                 VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  36
* EL6521.cbl
  1699             88  CO-GA-INACTIVE               VALUE 'I'.
  1700             88  CO-GA-PENDING                VALUE 'P'.
  1701         16  CO-GA-COMMENTS.
  1702             20  CO-GA-COMMENT-1           PIC X(40).
  1703             20  CO-GA-COMMENT-2           PIC X(40).
  1704             20  CO-GA-COMMENT-3           PIC X(40).
  1705             20  CO-GA-COMMENT-4           PIC X(40).
  1706
  1707     12  CO-RPTCD2                         PIC X(10).
  1708     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1709         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1710         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1711
  1712     12  CO-TYPE-AGENT                     PIC X(01).
  1713         88  CO-CORPORATION                   VALUE 'C'.
  1714         88  CO-PARTNERSHIP                   VALUE 'P'.
  1715         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1716         88  CO-TRUST                         VALUE 'T'.
  1717         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1718
  1719     12  CO-FAXNO.
  1720         16  CO-FAX-AREA-CODE                  PIC XXX.
  1721         16  CO-FAX-PREFIX                     PIC XXX.
  1722         16  CO-FAX-PHONE                      PIC X(4).
  1723
  1724     12  CO-BANK-INFORMATION.
  1725         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1726         16  CO-BANK-TRANSIT-NON REDEFINES
  1727             CO-BANK-TRANSIT-NO                PIC 9(8).
  1728
  1729         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1730     12  CO-MISC-DEDUCT-INFO REDEFINES
  1731                  CO-BANK-INFORMATION.
  1732         16  CO-MD-GL-ACCT                     PIC X(10).
  1733         16  CO-MD-DIV                         PIC XX.
  1734         16  CO-MD-CENTER                      PIC X(4).
  1735         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1736         16  CO-CREATE-AP-CHECK                PIC X.
  1737         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1738         16  FILLER                            PIC XXX.
  1739     12  CO-ACH-STATUS                         PIC X.
  1740         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1741         88  CO-ACH-PENDING                        VALUE 'P'.
  1742
  1743     12  CO-BILL-SW                            PIC X.
  1744     12  CO-CONTROL-NAME                       PIC X(30).
  1745     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1746     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1747     12  CO-CLP-STATE                          PIC XX.
  1748     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1749     12  CO-SPP-REFUND-EDIT                    PIC X.
  1750
  1751******************************************************************
  1752*    COPY ERCCOBI.
  1753******************************************************************
  1754*                                                                *
  1755*                                                                *
  1756*                            ERCCOBI                             *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  37
* EL6521.cbl
  1757*                                                                *
  1758*   ONLINE CREDIT SYSTEM                                         *
  1759*                                                                *
  1760*   FILE DESCRIPTION = COMPENSATION MASTER BILLING INSTRUCTIONS  *
  1761*                                                                *
  1762*   FILE TYPE = VSAM,KSDS                                        *
  1763*   RECORD SIZE = 620   RECFORM = FIXED                          *
  1764*                                                                *
  1765*   BASE CLUSTER NAME = ERCOBI                   RKP=2,LEN=17    *
  1766*       ALTERNATE PATH = NONE                                    *
  1767*                                                                *
  1768*   LOG = NO                                                     *
  1769*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1770*                                                                *
  1771******************************************************************
  1772*                   C H A N G E   L O G
  1773*
  1774* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1775*-----------------------------------------------------------------
  1776*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1777* EFFECTIVE    NUMBER
  1778*-----------------------------------------------------------------
  1779* 081808    2008061100001  PEMA  NEW FILE FOR BILLING INSTRUCTIONS
  1780******************************************************************
  1781 01  COMP-BILLING-INSTRUCTIONS.
  1782     12  BL-RECORD-ID                          PIC XX.
  1783         88  VALID-BL-ID                          VALUE 'BL'.
  1784     12  BL-CONTROL-PRIMARY.
  1785         16  BL-COMPANY-CD                     PIC X.
  1786         16  BL-STMT-OWNER                     PIC X(4).
  1787         16  BL-REPORT-GROUP-ID                PIC X(12).
  1788     12  BL-MAINT-INFORMATION.
  1789         16  BL-LAST-MAINT-DT                  PIC XX.
  1790         16  BL-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1791         16  BL-LAST-MAINT-USER                PIC X(4).
  1792         16  FILLER                            PIC X(10).
  1793     12  BL-ACCOUNT-NAME                       PIC X(35).
  1794     12  BL-CONTACT-NAME                       PIC X(35).
  1795     12  BL-ADDR1                              PIC X(30).
  1796     12  BL-ADDR2                              PIC X(30).
  1797     12  BL-CITY                               PIC X(30).
  1798     12  BL-STATE                              PIC XX.
  1799     12  BL-ZIP.
  1800         16  BL-ZIP-PRIME.
  1801             20  BL-ZIP-PRI-1ST                PIC X.
  1802                 88  BL-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1803             20  FILLER                        PIC X(4).
  1804         16  BL-ZIP-PLUS4                      PIC X(4).
  1805     12  BL-CANADIAN-POSTAL-CODE  REDEFINES  BL-ZIP.
  1806         16  BL-CAN-POSTAL-1                   PIC XXX.
  1807         16  BL-CAN-POSTAL-2                   PIC XXX.
  1808         16  FILLER                            PIC XXX.
  1809*    12  FILLER                                PIC X(30).
  1810     12  BL-CHECK-HANDLING                     PIC X.
  1811         88  BL-CHECKS-NET                VALUE '1' ' '.
  1812         88  BL-CHECKS-SEPARATE           VALUE '2'.
  1813     12  BL-SPECIAL-INSTRUCTIONS.
  1814         16  BL-SI-LINE-1                      PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  38
* EL6521.cbl
  1815         16  BL-SI-LINE-2                      PIC X(70).
  1816         16  BL-SI-LINE-3                      PIC X(70).
  1817         16  BL-SI-LINE-4                      PIC X(70).
  1818         16  BL-SI-LINE-5                      PIC X(70).
  1819     12  FILLER                                PIC X(59).
  1820
  1821******************************************************************
  1822*    COPY ELCACHP.
  1823******************************************************************
  1824*                                                                *
  1825*                           ELCACHP                              *
  1826*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1827*                            VMOD=2.002                          *
  1828*                                                                *
  1829*   FILE DESCRIPTION = ACH PRE-NOTIFICATION                      *
  1830*                                                                *
  1831*   FILE TYPE = VSAM,KSDS                                        *
  1832*   RECORD SIZE = 120  RECFORM = FIXED                           *
  1833*                                                                *
  1834*   BASE CLUSTER = ELACHP                         RKP=2,LEN=29   *
  1835*       ALTERNATE (NONE)                                         *
  1836*                                                                *
  1837*   LOG = YES                                                    *
  1838*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1839*                                                                *
  1840*  NO  CID  MODS  IN  COPYBOOK  ELCACHP                          *
  1841******************************************************************
  1842
  1843 01  ACH-PRENOTIFICATION.
  1844     12  AP-RECORD-ID                      PIC XX.
  1845         88  VALID-AP-ID                      VALUE 'AP'.
  1846
  1847******************************************************************
  1848*   BASE CLUSTER = ELACHP         (BASE KEY)      RKP=2,LEN=29   *
  1849******************************************************************
  1850
  1851     12  AP-CONTROL-PRIMARY.
  1852         16  AP-CONTROL-CD                 PIC X.
  1853         16  AP-CARRIER                    PIC X.
  1854         16  AP-GROUPING                   PIC X(6).
  1855         16  AP-FIN-RESP                   PIC X(10).
  1856         16  AP-ACCT-AGENT                 PIC X(10).
  1857         16  AP-CO-TYPE                    PIC X.
  1858
  1859     12  AP-CONTROL-ALT   REDEFINES  AP-CONTROL-PRIMARY.
  1860         16  AP-COMPANY-CD-ALT             PIC X.
  1861         16  AP-BENEFICIARY                PIC X(10).
  1862         16  FILLER                        PIC X(18).
  1863
  1864******************************************************************
  1865*                 FILE SYNCHRONIZATION DATA                      *
  1866******************************************************************
  1867
  1868     12  AP-FILE-SYNCH-DATA.
  1869         16  AP-LAST-CHANGE-DT             PIC XX.
  1870         16  AP-LAST-CHANGE-TIME           PIC S9(7)  COMP-3.
  1871         16  AP-LAST-CHANGE-PROCESSOR      PIC X(4).
  1872
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  39
* EL6521.cbl
  1873******************************************************************
  1874*                     PRENOTE INFORMATION
  1875******************************************************************
  1876
  1877     12  AP-BANK-INFORMATION.
  1878         16  AP-TRANSIT-NUMBER             PIC X(8).
  1879         16  AP-BANK-ACCOUNT-NO            PIC X(17).
  1880         16  AP-BANK-NAME                  PIC X(23).
  1881
  1882     12  FILLER                            PIC X(31).
  1883
  1884******************************************************************
  1885*    COPY ELCBANK.
  1886******************************************************************
  1887*                                                                *
  1888*                           ELCBANK                              *
  1889*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1890*                            VMOD=2.002                          *
  1891*                                                                *
  1892*   FILE DESCRIPTION = BANK MASTER FILE                          *
  1893*                                                                *
  1894*   FILE TYPE = VSAM,KSDS                                        *
  1895*   RECORD SIZE = 210  RECFORM = FIXED                           *
  1896*                                                                *
  1897*   BASE CLUSTER = ELBANK                         RKP=2,LEN=9    *
  1898*       ALTERNATE (NONE)                                         *
  1899*                                                                *
  1900*   LOG = YES                                                    *
  1901*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1902*                                                                *
  1903*  NO  CID  MODS  IN  COPYBOOK  ELCBANK                          *
  1904******************************************************************
  1905
  1906 01  BANK-MASTER.
  1907     12  BM-RECORD-ID                      PIC XX.
  1908         88  VALID-BM-ID                      VALUE 'BM'.
  1909
  1910******************************************************************
  1911*   BASE CLUSTER = MPBANK         (BASE KEY)      RKP=2,LEN=9    *
  1912******************************************************************
  1913
  1914     12  BM-CONTROL-PRIMARY.
  1915         16  BM-COMPANY-CD                 PIC X.
  1916         16  BM-TRANSIT-NUMBER.
  1917             20  BM-FEDERAL-NUMBER         PIC X(4).
  1918             20  BM-BANK-NUMBER            PIC X(4).
  1919     12  FILLER                            PIC X(20).
  1920
  1921******************************************************************
  1922*                 FILE SYNCHRONIZATION DATA                      *
  1923******************************************************************
  1924
  1925     12  BM-FILE-SYNCH-DATA.
  1926         16  BM-LAST-CHANGE-DT             PIC XX.
  1927         16  BM-LAST-CHANGE-TIME           PIC S9(7)  COMP-3.
  1928         16  BM-LAST-CHANGE-PROCESSOR      PIC X(4).
  1929
  1930******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  40
* EL6521.cbl
  1931*                       BANK INFORMATION                         *
  1932******************************************************************
  1933
  1934     12  BM-BANK-INFORMATION.
  1935         16  BM-NAME                       PIC X(30).
  1936         16  BM-ADDRESS1                   PIC X(30).
  1937         16  BM-ADDRESS2                   PIC X(30).
  1938         16  BM-CITY                       PIC X(25).
  1939         16  BM-STATE                      PIC X(25).
  1940         16  BM-ZIP.
  1941             20  BM-ZIP1                   PIC X(5).
  1942             20  BM-ZIP2                   PIC X(4).
  1943     12  FILLER                            PIC X(20).
  1944
  1945******************************************************************
  1946 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  1947                          COMPENSATION-MASTER
  1948                          COMP-BILLING-INSTRUCTIONS
  1949                          ACH-PRENOTIFICATION BANK-MASTER.
  1950 0000-DFHEXIT SECTION.
  1951     MOVE '9#                    $   ' TO DFHEIV0.
  1952     MOVE 'EL6521' TO DFHEIV1.
  1953     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1954
  1955     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1956     MOVE '5'                    TO DC-OPTION-CODE.
  1957     PERFORM 9700-DATE-CONVERT THRU 9700-EXIT.
  1958     MOVE DC-GREG-DATE-1-EDIT    TO WS-SAVE-DATE.
  1959     MOVE DC-BIN-DATE-1          TO WS-SAVE-BIN-DT.
  1960
  1961     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  1962     MOVE EIBTRMID               TO QID-TERM.
  1963     MOVE +2                     TO EMI-NUMBER-OF-LINES.
  1964     MOVE SPACE                  TO SUPPRESS-MAP-SW.
  1965
  1966     IF EIBCALEN = 0
  1967        GO TO 8800-UNAUTHORIZED-ACCESS
  1968     END-IF
  1969     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  1970        MOVE PI-CALLING-PROGRAM  TO RETURNED-FROM
  1971     END-IF
  1972     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1973        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1974           MOVE PI-SAVED-PROGRAM-5    TO PI-SAVED-PROGRAM-6
  1975           MOVE PI-SAVED-PROGRAM-4    TO PI-SAVED-PROGRAM-5
  1976           MOVE PI-SAVED-PROGRAM-3    TO PI-SAVED-PROGRAM-4
  1977           MOVE PI-SAVED-PROGRAM-2    TO PI-SAVED-PROGRAM-3
  1978           MOVE PI-SAVED-PROGRAM-1    TO PI-SAVED-PROGRAM-2
  1979           MOVE PI-RETURN-TO-PROGRAM  TO PI-SAVED-PROGRAM-1
  1980           MOVE PI-CALLING-PROGRAM    TO PI-RETURN-TO-PROGRAM
  1981           MOVE THIS-PGM              TO PI-CALLING-PROGRAM
  1982        ELSE
  1983           MOVE PI-RETURN-TO-PROGRAM  TO PI-CALLING-PROGRAM
  1984           MOVE PI-SAVED-PROGRAM-1    TO PI-RETURN-TO-PROGRAM
  1985           MOVE PI-SAVED-PROGRAM-2    TO PI-SAVED-PROGRAM-1
  1986           MOVE PI-SAVED-PROGRAM-3    TO PI-SAVED-PROGRAM-2
  1987           MOVE PI-SAVED-PROGRAM-4    TO PI-SAVED-PROGRAM-3
  1988           MOVE PI-SAVED-PROGRAM-5    TO PI-SAVED-PROGRAM-4
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  41
* EL6521.cbl
  1989           MOVE PI-SAVED-PROGRAM-6    TO PI-SAVED-PROGRAM-5
  1990           MOVE SPACES                TO PI-SAVED-PROGRAM-6
  1991        END-IF
  1992     END-IF
  1993     MOVE LOW-VALUES             TO EL6521AI
  1994     IF EIBTRNID = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  1995           EL6526-TRANS-ID
  1996        CONTINUE
  1997     ELSE
  1998        GO TO 0100-NOT-EL611-RETURN
  1999     END-IF
  2000
  2001     PERFORM 0600-RECOVER-TS  THRU  0600-EXIT.
  2002     MOVE XCTL-652           TO PI-RETURN-TO-PROGRAM.
  2003
  2004     MOVE PI-FEDERAL-NUMBER      TO TRNSIT1O.
  2005     MOVE PI-BANK-NUMBER         TO TRNSIT2O.
  2006     MOVE PI-BANK-ACCOUNT-NO     TO BKACCTO.
  2007
  2008     IF PI-BANK-ACTION-CODE EQUAL   'P'
  2009        MOVE 'PENDING'           TO CRSTATO.
  2010
  2011     IF PI-BANK-ACTION-CODE EQUAL   'A'
  2012        MOVE 'ACTIVE '           TO CRSTATO.
  2013
  2014     IF MAINTYPL GREATER THAN ZERO
  2015         MOVE AL-UABON           TO MAINTYPA.
  2016
  2017     IF STATL    GREATER THAN ZERO
  2018         MOVE 'Y'                TO MAP-CHANGED-SW
  2019         MOVE AL-UANON           TO STATA.
  2020
  2021     IF WTHLDL > ZERO
  2022        MOVE 'Y'                 TO MAP-CHANGED-SW
  2023        MOVE AL-UNNON            TO WTHLDA
  2024     END-IF
  2025     IF GADDL > ZERO
  2026        MOVE 'Y'                 TO MAP-CHANGED-SW
  2027        MOVE AL-UANON            TO GADDA
  2028     END-IF
  2029     IF MELSWL > ZERO
  2030        MOVE 'Y'                 TO MAP-CHANGED-SW
  2031        MOVE AL-UANON            TO MELSWA
  2032     END-IF
  2033     IF APCHKL > ZERO
  2034        MOVE 'Y'                 TO MAP-CHANGED-SW
  2035        MOVE AL-UANON            TO APCHKA
  2036     END-IF
  2037     IF MDACTL > ZERO
  2038        MOVE 'Y'                 TO MAP-CHANGED-SW
  2039        MOVE AL-UANON            TO MDACTA
  2040     END-IF
  2041     IF MDDIVL > ZERO
  2042        MOVE 'Y'                 TO MAP-CHANGED-SW
  2043        MOVE AL-UANON            TO MDDIVA
  2044     END-IF
  2045     IF MDCNTRL > ZERO
  2046        MOVE 'Y'                 TO MAP-CHANGED-SW
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  42
* EL6521.cbl
  2047        MOVE AL-UANON            TO MDCNTRA
  2048     END-IF
  2049     IF MDAMTL > ZERO
  2050        MOVE 'Y'                 TO MAP-CHANGED-SW
  2051        MOVE AL-UNNON            TO MDAMTA
  2052     END-IF
  2053     IF EFFDTL   GREATER THAN ZERO
  2054         MOVE 'Y'                TO MAP-CHANGED-SW
  2055         MOVE AL-UANON           TO EFFDTA.
  2056
  2057     IF TRMDTL   GREATER THAN ZERO
  2058         MOVE 'Y'                TO MAP-CHANGED-SW
  2059         MOVE AL-UANON           TO TRMDTA.
  2060
  2061     IF COMM1L   GREATER THAN ZERO
  2062         MOVE 'Y'                TO MAP-CHANGED-SW
  2063         MOVE AL-UANON           TO COMM1A.
  2064
  2065     IF COMM2L   GREATER THAN ZERO
  2066         MOVE 'Y'                TO MAP-CHANGED-SW
  2067         MOVE AL-UANON           TO COMM2A.
  2068
  2069     IF COMM3L   GREATER THAN ZERO
  2070         MOVE 'Y'                TO MAP-CHANGED-SW
  2071         MOVE AL-UANON           TO COMM3A.
  2072
  2073     IF COMM4L   GREATER THAN ZERO
  2074         MOVE 'Y'                TO MAP-CHANGED-SW
  2075         MOVE AL-UANON           TO COMM4A.
  2076
  2077     IF TRNSIT1L GREATER THAN ZERO
  2078         MOVE 'Y'                TO MAP-CHANGED-SW
  2079         MOVE AL-UABON           TO TRNSIT1A.
  2080
  2081     IF TRNSIT2L GREATER THAN ZERO
  2082         MOVE 'Y'                TO MAP-CHANGED-SW
  2083         MOVE AL-UABON           TO TRNSIT2A.
  2084
  2085     IF BKACCTL  GREATER THAN ZERO
  2086         MOVE 'Y'                TO MAP-CHANGED-SW
  2087         MOVE AL-UABON           TO BKACCTA.
  2088
  2089     IF ACTCDL   GREATER THAN ZERO
  2090         MOVE 'Y'                TO MAP-CHANGED-SW
  2091         MOVE AL-UABON           TO ACTCDA.
  2092
  2093     IF DELTOL > 0
  2094        MOVE 'Y'                 TO MAP-CHANGED-SW
  2095        MOVE AL-UANON            TO DELTOA
  2096     END-IF
  2097     IF RGIDL > 0
  2098        MOVE 'Y'                 TO MAP-CHANGED-SW
  2099        MOVE AL-UANON            TO RGIDA
  2100     END-IF
  2101     IF MAP-NOT-CHANGED
  2102         GO TO 0100-NOT-EL611-RETURN.
  2103
  2104     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  43
* EL6521.cbl
  2105
  2106 0100-NOT-EL611-RETURN.
  2107
  2108     IF EIBTRNID NOT = TRANS-ID
  2109         MOVE PI-MAINT           TO MAINTYPO
  2110         MOVE AL-UANON           TO MAINTYPA
  2111         MOVE -1                 TO MAINTYPL
  2112         IF PI-MAINT = 'S' OR 'C'
  2113             GO TO 4000-SHOW
  2114         ELSE
  2115             GO TO 8100-SEND-INITIAL-MAP.
  2116
  2117
  2118* EXEC CICS HANDLE CONDITION
  2119*        PGMIDERR  (9600-PGMID-ERROR)
  2120*        ERROR     (9990-ABEND)
  2121*    END-EXEC.
  2122*    MOVE '"$L.                  ! " #00002113' TO DFHEIV0
  2123     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2124     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2125     MOVE X'2220233030303032313133' TO DFHEIV0(25:11)
  2126     CALL 'kxdfhei1' USING DFHEIV0
  2127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2128
  2129
  2130     IF EIBAID = DFHCLEAR
  2131         GO TO 9400-CLEAR.
  2132
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  44
* EL6521.cbl
  2134 0200-RECEIVE.
  2135     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  2136         MOVE ER-0008            TO EMI-ERROR
  2137         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2138         MOVE -1                 TO PFENTERL
  2139         GO TO 8200-SEND-DATAONLY.
  2140
  2141
  2142* EXEC CICS RECEIVE
  2143*        MAP      (MAP-NAME)
  2144*        MAPSET   (MAPSET-NAME)
  2145*        INTO     (EL6521AI)
  2146*    END-EXEC.
  2147     MOVE LENGTH OF
  2148      EL6521AI
  2149       TO DFHEIV11
  2150*    MOVE '8"T I  L              ''   #00002129' TO DFHEIV0
  2151     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2152     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2153     MOVE X'2020233030303032313239' TO DFHEIV0(25:11)
  2154     CALL 'kxdfhei1' USING DFHEIV0,
  2155           MAP-NAME,
  2156           EL6521AI,
  2157           DFHEIV11,
  2158           MAPSET-NAME,
  2159           DFHEIV99,
  2160           DFHEIV99
  2161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2162
  2163
  2164     IF PFENTERL = 0
  2165         GO TO 0300-CHECK-PFKEYS.
  2166
  2167     IF EIBAID NOT = DFHENTER
  2168         MOVE ER-0004            TO EMI-ERROR
  2169         GO TO 0320-INPUT-ERROR.
  2170
  2171     IF (PFENTERI NUMERIC) AND (PFENTERI GREATER 0 AND LESS 25)
  2172         MOVE PF-VALUES (PFENTERI) TO EIBAID
  2173     ELSE
  2174         MOVE ER-0029              TO EMI-ERROR
  2175         GO TO 0320-INPUT-ERROR.
  2176
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  45
* EL6521.cbl
  2178
  2179 0300-CHECK-PFKEYS.
  2180     IF PI-AR-PROCESSING
  2181        IF EIBAID = DFHPF1
  2182             PERFORM 0500-WRITE-TS  THRU  0500-EXIT
  2183             MOVE XCTL-611       TO PGM-NAME
  2184             GO TO 9300-XCTL.
  2185     IF EIBAID = DFHPF2
  2186        MOVE PI-COMPANY-CD       TO PI-ERCOBI-COMPANY-CD
  2187        MOVE DELTOI              TO PI-ERCOBI-STMT-OWNER
  2188        MOVE RGIDI               TO PI-ERCOBI-RGID
  2189        PERFORM 0500-WRITE-TS    THRU 0500-EXIT
  2190        MOVE XCTL-6525           TO PGM-NAME
  2191        GO TO 9300-XCTL
  2192     END-IF
  2193     IF EIBAID = DFHPF3
  2194        PERFORM 0500-WRITE-TS    THRU 0500-EXIT
  2195        MOVE XCTL-6526           TO PGM-NAME
  2196        GO TO 9300-XCTL
  2197     END-IF
  2198     IF EIBAID = DFHPF23
  2199         GO TO 8810-PF23.
  2200     IF EIBAID = DFHPF24
  2201         GO TO 9200-RETURN-MAIN-MENU.
  2202     IF EIBAID = DFHPF12
  2203         GO TO 9500-PF12.
  2204     IF EIBAID = DFHENTER
  2205         GO TO 0330-CHECK-MAINTYP.
  2206
  2207     MOVE ER-0029                TO EMI-ERROR.
  2208 0320-INPUT-ERROR.
  2209     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2210     MOVE AL-UNBON               TO PFENTERA.
  2211     MOVE -1                     TO PFENTERL.
  2212     GO TO 8200-SEND-DATAONLY.
  2213
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  46
* EL6521.cbl
  2215 0330-CHECK-MAINTYP.
  2216
  2217     IF MAINTYPL GREATER ZERO
  2218         IF MAINTYPI = 'S' OR 'C'
  2219             MOVE AL-UANON       TO MAINTYPA
  2220             MOVE MAINTYPI       TO PI-MAINT
  2221         ELSE
  2222             MOVE -1             TO MAINTYPL
  2223             MOVE AL-UABON       TO MAINTYPA
  2224             MOVE ER-2039        TO EMI-ERROR
  2225             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2226             GO TO 8200-SEND-DATAONLY
  2227     ELSE
  2228         MOVE -1                 TO MAINTYPL
  2229         MOVE AL-UABON           TO MAINTYPA
  2230         MOVE ER-2039            TO EMI-ERROR
  2231         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2232         GO TO 8200-SEND-DATAONLY.
  2233
  2234     IF PI-MAINT = 'S'
  2235         GO TO 4000-SHOW.
  2236
  2237     GO TO 4200-MAINT.
  2238
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  47
* EL6521.cbl
  2240
  2241 0500-WRITE-TS.
  2242
  2243* EXEC CICS WRITEQ TS
  2244*         QUEUE  (QID)
  2245*         FROM   (EL6521AO)
  2246*         LENGTH (MAP-LENGTH)
  2247*    END-EXEC.
  2248*    MOVE '*"                    ''   #00002213' TO DFHEIV0
  2249     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  2250     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2251     MOVE X'2020233030303032323133' TO DFHEIV0(25:11)
  2252     CALL 'kxdfhei1' USING DFHEIV0,
  2253           QID,
  2254           EL6521AO,
  2255           MAP-LENGTH,
  2256           DFHEIV99,
  2257           DFHEIV99,
  2258           DFHEIV99
  2259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2260
  2261
  2262 0500-EXIT.
  2263      EXIT.
  2264
  2265 0600-RECOVER-TS.
  2266
  2267* EXEC CICS READQ TS
  2268*         QUEUE  (QID)
  2269*         INTO (EL6521AO)
  2270*         LENGTH (MAP-LENGTH)
  2271*    END-EXEC.
  2272*    MOVE '*$I    L              ''   #00002223' TO DFHEIV0
  2273     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  2274     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2275     MOVE X'2020233030303032323233' TO DFHEIV0(25:11)
  2276     CALL 'kxdfhei1' USING DFHEIV0,
  2277           QID,
  2278           EL6521AO,
  2279           MAP-LENGTH,
  2280           DFHEIV99,
  2281           DFHEIV99,
  2282           DFHEIV99
  2283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2284
  2285
  2286     PERFORM 0700-DELETE-TS  THRU  0700-EXIT.
  2287
  2288 0600-EXIT.
  2289      EXIT.
  2290
  2291 0700-DELETE-TS.
  2292
  2293* EXEC CICS HANDLE CONDITION
  2294*        QIDERR (0700-EXIT)
  2295*    END-EXEC.
  2296*    MOVE '"$N                   ! # #00002235' TO DFHEIV0
  2297     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  48
* EL6521.cbl
  2298     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2299     MOVE X'2320233030303032323335' TO DFHEIV0(25:11)
  2300     CALL 'kxdfhei1' USING DFHEIV0
  2301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2302
  2303
  2304
  2305* EXEC CICS DELETEQ TS
  2306*        QUEUE (QID)
  2307*    END-EXEC.
  2308*    MOVE '*&                    #   #00002239' TO DFHEIV0
  2309     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  2310     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2311     MOVE X'2020233030303032323339' TO DFHEIV0(25:11)
  2312     CALL 'kxdfhei1' USING DFHEIV0,
  2313           QID,
  2314           DFHEIV99
  2315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2316
  2317
  2318 0700-EXIT.
  2319      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  49
* EL6521.cbl
  2321
  2322 4000-SHOW.
  2323
  2324     PERFORM 7100-READ-ERCOMP THRU 7100-EXIT.
  2325
  2326     IF EIBTRNID     = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  2327           EL6526-TRANS-ID
  2328         NEXT SENTENCE
  2329     ELSE
  2330         MOVE LOW-VALUES         TO EL6521AO.
  2331
  2332     GO TO 5000-BUILD-INITIAL-SCREEN.
  2333
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  50
* EL6521.cbl
  2335 4200-MAINT.
  2336     IF NOT MODIFY-CAP
  2337         MOVE 'UPDATE'           TO SM-READ
  2338         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2339         MOVE ER-0070            TO EMI-ERROR
  2340         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2341         GO TO 8100-SEND-INITIAL-MAP.
  2342
  2343     MOVE 'N'                     TO SUPPRESS-MAP-SW.
  2344     PERFORM 7100-READ-ERCOMP THRU 7100-EXIT.
  2345
  2346     IF EMI-NO-ERRORS
  2347         NEXT SENTENCE
  2348     ELSE
  2349       IF EIBTRNID     = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  2350              EL6526-TRANS-ID
  2351           GO TO 8100-SEND-INITIAL-MAP
  2352       ELSE
  2353           GO TO 8200-SEND-DATAONLY.
  2354
  2355     PERFORM 7000-EDIT THRU 7099-EXIT.
  2356
  2357     IF EMI-NO-ERRORS
  2358         NEXT SENTENCE
  2359     ELSE
  2360       IF EIBTRNID     = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  2361             EL6526-TRANS-ID
  2362           GO TO 8100-SEND-INITIAL-MAP
  2363       ELSE
  2364           GO TO 8200-SEND-DATAONLY.
  2365
  2366     MOVE ER-0000               TO EMI-ERROR
  2367     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2368
  2369     PERFORM 7300-READ-ERCOMP-UPDATE THRU 7300-EXIT.
  2370
  2371     PERFORM 6000-CHECK-FOR-UPDATE   THRU 6049-EXIT.
  2372
  2373     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  2374     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  2375     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2376     MOVE '5'                    TO DC-OPTION-CODE.
  2377     PERFORM 9700-DATE-CONVERT THRU 9700-EXIT.
  2378
  2379     MOVE DC-BIN-DATE-1          TO CO-LAST-MAINT-DT.
  2380
  2381     PERFORM 5500-PROCESS-ELACHP THRU 5599-PROCESS-EXIT
  2382     PERFORM 6100-CHECK-BILL-INSTR
  2383                                 THRU 6100-EXIT
  2384
  2385
  2386* EXEC CICS REWRITE
  2387*        DATASET  (ERCOMP-FILE-ID)
  2388*        FROM     (COMPENSATION-MASTER)
  2389*    END-EXEC.
  2390     MOVE LENGTH OF
  2391      COMPENSATION-MASTER
  2392       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  51
* EL6521.cbl
  2393*    MOVE '&& L                  %   #00002310' TO DFHEIV0
  2394     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2395     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2396     MOVE X'2020233030303032333130' TO DFHEIV0(25:11)
  2397     CALL 'kxdfhei1' USING DFHEIV0,
  2398           ERCOMP-FILE-ID,
  2399           COMPENSATION-MASTER,
  2400           DFHEIV11,
  2401           DFHEIV99
  2402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2403
  2404
  2405     PERFORM 7100-READ-ERCOMP THRU 7100-EXIT.
  2406     MOVE LOW-VALUES             TO EL6521AO.
  2407     MOVE 'C'                    TO PI-MAINT.
  2408
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  52
* EL6521.cbl
  2410
  2411 5000-BUILD-INITIAL-SCREEN.
  2412     MOVE CO-CARRIER             TO CARRIERO.
  2413     MOVE CO-GROUPING            TO GROUPO.
  2414     MOVE CO-TYPE                TO TYPEO.
  2415     MOVE CO-RESP-NO             TO FINRESPO.
  2416     MOVE CO-CTL-2               TO COACCTO.
  2417     MOVE CO-GA-STATUS-CODE      TO STATO.
  2418     IF CO-GA-STATUS-CODE = 'A' OR 'I' OR 'P'
  2419         MOVE CO-GA-STATUS-CODE  TO STATO
  2420         MOVE AL-UANON           TO STATA
  2421         MOVE +1                 TO STATL
  2422     ELSE
  2423         MOVE AL-UANOF           TO STATA
  2424     END-IF
  2425     IF CO-GA-WITHOLD-PCT NOT NUMERIC
  2426        MOVE ZEROS               TO CO-GA-WITHOLD-PCT
  2427     END-IF
  2428     MOVE CO-GA-WITHOLD-PCT      TO WTHLDO
  2429     IF CO-GA-WITHOLD-PCT NOT = ZEROS
  2430        MOVE +3                  TO WTHLDL
  2431        MOVE AL-UANON            TO WTHLDA
  2432     END-IF
  2433     IF CO-GA-DIRECT-DEP = 'Y'
  2434        MOVE 'Y'                 TO GADDO
  2435        MOVE AL-UANON            TO GADDA
  2436        MOVE +1                  TO GADDL
  2437     ELSE
  2438        MOVE 'N'                 TO GADDO
  2439        MOVE AL-UANON            TO GADDA
  2440        MOVE +1                  TO GADDL
  2441     END-IF
  2442     IF CO-DELIVER-CK-TO-MEL = 'Y'
  2443        MOVE 'Y'                 TO MELSWO
  2444        MOVE AL-UANON            TO MELSWA
  2445        MOVE +1                  TO MELSWL
  2446     ELSE
  2447        MOVE 'N'                 TO MELSWO
  2448        MOVE AL-UANON            TO MELSWA
  2449        MOVE +1                  TO MELSWL
  2450     END-IF
  2451     IF CO-CREATE-AP-CHECK = 'Y'
  2452        MOVE 'Y'                 TO APCHKO
  2453        MOVE AL-UANON            TO APCHKA
  2454        MOVE +1                  TO APCHKL
  2455     ELSE
  2456        MOVE 'N'                 TO APCHKO
  2457        MOVE AL-UANON            TO APCHKA
  2458        MOVE +1                  TO APCHKL
  2459     END-IF
  2460     IF CO-MD-GL-ACCT = SPACES OR LOW-VALUES
  2461        MOVE AL-UANOF            TO MDACTA
  2462     ELSE
  2463        MOVE CO-MD-GL-ACCT       TO MDACTO
  2464        MOVE +2                  TO MDACTL
  2465        MOVE AL-UANON            TO MDACTA
  2466     END-IF
  2467     IF CO-MD-DIV = SPACES OR LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  53
* EL6521.cbl
  2468        MOVE AL-UANOF            TO MDDIVA
  2469     ELSE
  2470        MOVE CO-MD-DIV           TO MDDIVO
  2471        MOVE AL-UANON            TO MDDIVA
  2472     END-IF
  2473     IF CO-MD-CENTER = SPACES OR LOW-VALUES
  2474        MOVE AL-UANOF            TO MDCNTRA
  2475     ELSE
  2476        MOVE CO-MD-CENTER        TO MDCNTRO
  2477        MOVE +2                  TO MDCNTRL
  2478        MOVE AL-UANON            TO MDCNTRA
  2479     END-IF
  2480     IF CO-MD-AMT NOT NUMERIC
  2481        MOVE ZEROS               TO CO-MD-AMT
  2482     END-IF
  2483     MOVE CO-MD-AMT              TO MDAMTO
  2484     IF CO-MD-AMT NOT = ZEROS
  2485        MOVE +3                  TO MDAMTL
  2486        MOVE AL-UANON            TO MDAMTA
  2487     END-IF
  2488     MOVE ZEROS                  TO MDLOBO
  2489                                    MDSTO
  2490     IF CO-GA-EFFECTIVE-DT = LOW-VALUES OR SPACES
  2491         MOVE AL-UANOF           TO EFFDTA
  2492     ELSE
  2493         MOVE CO-GA-EFFECTIVE-DT TO DC-BIN-DATE-1
  2494         MOVE ' '                TO DC-OPTION-CODE
  2495         PERFORM 9700-DATE-CONVERT THRU 9700-EXIT
  2496         MOVE DC-GREG-DATE-1-EDIT
  2497                                 TO EFFDTO
  2498         MOVE AL-UANON           TO EFFDTA
  2499         MOVE +8                 TO EFFDTL.
  2500
  2501     IF CO-GA-TERMINATION-DT = HIGH-VALUES
  2502        MOVE '99/99/99'          TO TRMDTO
  2503        MOVE AL-UANON            TO TRMDTA
  2504     ELSE
  2505        IF CO-GA-TERMINATION-DT = LOW-VALUES OR SPACES
  2506            MOVE AL-UANOF        TO TRMDTA
  2507        ELSE
  2508           MOVE CO-GA-TERMINATION-DT
  2509                                 TO DC-BIN-DATE-1
  2510           MOVE ' '              TO DC-OPTION-CODE
  2511           PERFORM 9700-DATE-CONVERT
  2512                                 THRU 9700-EXIT
  2513           MOVE DC-GREG-DATE-1-EDIT
  2514                                 TO TRMDTO
  2515           MOVE AL-UANON         TO TRMDTA
  2516           MOVE +8               TO TRMDTL
  2517        END-IF
  2518     END-IF
  2519
  2520     IF CO-GA-COMMENT-1 = LOW-VALUES OR SPACES
  2521         MOVE AL-UANOF            TO COMM1A
  2522     ELSE
  2523         MOVE CO-GA-COMMENT-1    TO COMM1O
  2524         MOVE AL-UANON           TO COMM1A
  2525         MOVE +40                TO COMM1L.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  54
* EL6521.cbl
  2526
  2527     IF CO-GA-COMMENT-2 = LOW-VALUES OR SPACES
  2528         MOVE AL-UANOF            TO COMM2A
  2529     ELSE
  2530         MOVE CO-GA-COMMENT-2    TO COMM2O
  2531         MOVE AL-UANON           TO COMM2A
  2532         MOVE +40                TO COMM2L.
  2533
  2534     IF CO-GA-COMMENT-3 = LOW-VALUES OR SPACES
  2535         MOVE AL-UANOF           TO COMM3A
  2536     ELSE
  2537         MOVE CO-GA-COMMENT-3    TO COMM3O
  2538         MOVE AL-UANON           TO COMM3A
  2539         MOVE +40                TO COMM3L.
  2540
  2541     IF CO-GA-COMMENT-4 = LOW-VALUES OR SPACES
  2542         MOVE AL-UANOF           TO COMM4A
  2543     ELSE
  2544         MOVE CO-GA-COMMENT-4    TO COMM4O
  2545         MOVE AL-UANON           TO COMM4A
  2546         MOVE +40                TO COMM4L.
  2547
  2548     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  2549        CONTINUE
  2550     ELSE
  2551        IF (CO-BANK-TRANSIT-NO (1:4) = LOW-VALUES OR SPACES) AND
  2552           (CO-BANK-TRANSIT-NO (5:4) = LOW-VALUES OR SPACES)
  2553            MOVE AL-UANOF        TO TRNSIT1A
  2554            MOVE AL-UANOF        TO TRNSIT2A
  2555        ELSE
  2556           MOVE CO-BANK-TRANSIT-NO (1:4)
  2557                                 TO PI-BANK-TRANSIT-NUMBER (2:4)
  2558                                    TRNSIT1O
  2559           MOVE CO-BANK-TRANSIT-NO (5:4)
  2560                                 TO PI-BANK-TRANSIT-NUMBER (6:4)
  2561                                    TRNSIT2O
  2562        END-IF
  2563        IF CO-BANK-ACCOUNT-NUMBER = LOW-VALUES OR SPACES
  2564           MOVE AL-UANOF         TO BKACCTA
  2565        ELSE
  2566           MOVE CO-BANK-ACCOUNT-NUMBER
  2567                                 TO PI-BANK-ACCOUNT-NO
  2568                                    BKACCTO
  2569        END-IF
  2570     END-IF
  2571     MOVE    '       '           TO CRSTATO.
  2572
  2573     MOVE CO-ACH-STATUS          TO PI-BANK-ACTION-CODE.
  2574
  2575     IF CO-ACH-STATUS IS EQUAL      'P'
  2576        MOVE 'PENDING'           TO CRSTATO.
  2577
  2578     IF CO-ACH-STATUS IS EQUAL      'A'
  2579        MOVE 'ACTIVE '           TO CRSTATO.
  2580     IF CO-STMT-OWNER NOT = SPACES AND LOW-VALUES
  2581        MOVE CO-STMT-OWNER       TO DELTOO
  2582        MOVE AL-UANON            TO DELTOA
  2583        MOVE +4                  TO DELTOL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  55
* EL6521.cbl
  2584     ELSE
  2585        MOVE AL-UANOF            TO DELTOA
  2586     END-IF
  2587     IF CO-REPORT-GROUP-ID NOT = SPACES AND LOW-VALUES
  2588        MOVE CO-REPORT-GROUP-ID  TO RGIDO
  2589        MOVE AL-UANON            TO RGIDA
  2590        MOVE +12                 TO RGIDL
  2591     ELSE
  2592        MOVE AL-UANOF            TO RGIDA
  2593     END-IF
  2594     MOVE PI-MAINT               TO MAINTYPO.
  2595     MOVE AL-UANOF               TO MAINTYPA.
  2596     MOVE -1                     TO MAINTYPL.
  2597
  2598     GO TO 8100-SEND-INITIAL-MAP.
  2599
  2600 5099-EXIT.
  2601     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  56
* EL6521.cbl
  2603 5500-PROCESS-ELACHP.
  2604
  2605     IF ACTCDI = 'D'
  2606        PERFORM 7400-DELETE-PRE-NOTE THRU 7499-EXIT
  2607        MOVE SPACES              TO CO-BANK-INFORMATION
  2608                                    CO-ACH-STATUS
  2609        GO TO 5599-PROCESS-EXIT.
  2610
  2611     IF ACTCDI = 'C'
  2612         PERFORM 7400-DELETE-PRE-NOTE THRU 7499-EXIT
  2613         PERFORM 7600-WRITE-ELACHP THRU 7620-WRITE-EXIT
  2614         MOVE WS-BANK-DATA       TO CO-BANK-INFORMATION
  2615         MOVE WS-BKACCTI         TO CO-BANK-ACCOUNT-NUMBER
  2616         MOVE 'P'                TO CO-ACH-STATUS
  2617         GO TO 5599-PROCESS-EXIT.
  2618
  2619     IF ACTCDI =  'N'
  2620         PERFORM 7600-WRITE-ELACHP THRU 7620-WRITE-EXIT
  2621         MOVE WS-BANK-DATA       TO CO-BANK-INFORMATION
  2622         MOVE WS-BKACCTI         TO CO-BANK-ACCOUNT-NUMBER
  2623         MOVE 'P'                TO CO-ACH-STATUS  WS-ACTCDI
  2624         GO TO 5599-PROCESS-EXIT.
  2625
  2626     IF ACTCDI = 'A'
  2627         MOVE 'A'                TO CO-ACH-STATUS  WS-ACTCDI
  2628         GO TO 5599-PROCESS-EXIT.
  2629
  2630 5599-PROCESS-EXIT.
  2631
  2632     EXIT.
  2633 6000-CHECK-FOR-UPDATE.
  2634     IF STATL GREATER ZERO
  2635        MOVE STATI               TO CO-GA-STATUS-CODE.
  2636
  2637     IF EFFDTL GREATER ZERO
  2638        MOVE WS-SAVE-BIN-EFFDT   TO CO-GA-EFFECTIVE-DT.
  2639
  2640     IF TRMDTL GREATER ZERO
  2641        MOVE WS-SAVE-BIN-TRMDT   TO CO-GA-TERMINATION-DT.
  2642
  2643     IF GADDL > ZERO
  2644        MOVE GADDI               TO CO-GA-DIRECT-DEP
  2645     END-IF
  2646     IF MELSWL > ZERO
  2647        MOVE MELSWI              TO CO-DELIVER-CK-TO-MEL
  2648     END-IF
  2649     IF APCHKL > ZERO
  2650        MOVE APCHKI              TO CO-CREATE-AP-CHECK
  2651     END-IF
  2652     IF MDACTL > ZERO
  2653        MOVE MDACTI              TO CO-MD-GL-ACCT
  2654     END-IF
  2655     IF MDDIVL > ZERO
  2656        MOVE MDDIVI              TO CO-MD-DIV
  2657     END-IF
  2658     IF MDCNTRL > ZERO
  2659        MOVE MDCNTRI             TO CO-MD-CENTER
  2660     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  57
* EL6521.cbl
  2661     IF WTHLDL > ZERO
  2662        MOVE WTHLDI              TO CO-GA-WITHOLD-PCT
  2663     END-IF
  2664     IF MDAMTL > ZERO
  2665        MOVE MDAMTI              TO CO-MD-AMT
  2666     END-IF
  2667     IF DELTOL > ZERO
  2668        MOVE DELTOI              TO CO-STMT-OWNER
  2669     END-IF
  2670     IF RGIDL > ZERO
  2671        MOVE RGIDI               TO CO-REPORT-GROUP-ID
  2672     END-IF
  2673     IF COMM1L GREATER ZERO
  2674        MOVE COMM1I              TO CO-GA-COMMENT-1.
  2675
  2676     IF COMM2L GREATER ZERO
  2677        MOVE COMM2I              TO CO-GA-COMMENT-2.
  2678
  2679     IF COMM3L GREATER ZERO
  2680        MOVE COMM3I              TO CO-GA-COMMENT-3.
  2681
  2682     IF COMM4L GREATER ZERO
  2683        MOVE COMM4I              TO CO-GA-COMMENT-4.
  2684
  2685 6049-EXIT.
  2686     EXIT.
  2687 6100-CHECK-BILL-INSTR.
  2688     MOVE PI-COMPANY-CD          TO ERCOBI-COMPANY-CD
  2689     MOVE DELTOI                 TO ERCOBI-STMT-OWNER
  2690     MOVE RGIDI                  TO ERCOBI-RGID
  2691
  2692* EXEC CICS READ
  2693*       DATASET (ERCOBI-FILE-ID)
  2694*       SET     (ADDRESS OF COMP-BILLING-INSTRUCTIONS)
  2695*       RIDFLD  (ERCOBI-KEY)
  2696*       RESP    (WS-RESPONSE)
  2697*       UPDATE
  2698*    END-EXEC
  2699*    MOVE '&"S        EU         (  N#00002601' TO DFHEIV0
  2700     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2701     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2702     MOVE X'204E233030303032363031' TO DFHEIV0(25:11)
  2703     CALL 'kxdfhei1' USING DFHEIV0,
  2704           ERCOBI-FILE-ID,
  2705           DFHEIV20,
  2706           DFHEIV99,
  2707           ERCOBI-KEY,
  2708           DFHEIV99,
  2709           DFHEIV99,
  2710           DFHEIV99
  2711     SET ADDRESS OF COMP-BILLING-INSTRUCTIONS TO
  2712         DFHEIV20
  2713     MOVE EIBRESP  TO WS-RESPONSE
  2714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2715     IF NOT RESP-NORMAL
  2716        MOVE AL-UABON            TO DELTOA
  2717                                    RGIDA
  2718        MOVE ER-2797             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  58
* EL6521.cbl
  2719        MOVE -1                  TO DELTOL
  2720        PERFORM 9900-ERROR-FORMAT
  2721                                 THRU 9900-EXIT
  2722     END-IF
  2723     .
  2724 6100-EXIT.
  2725     EXIT.
  2726
  2727 7000-EDIT.
  2728     IF STATL GREATER ZERO
  2729         IF STATI = 'A' OR 'I' OR 'P'
  2730             NEXT SENTENCE
  2731          ELSE
  2732             MOVE -1             TO STATL
  2733             MOVE AL-UABON       TO STATA
  2734             MOVE ER-7438        TO EMI-ERROR
  2735             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2736
  2737     MOVE LOW-VALUES             TO WS-SAVE-BIN-EFFDT.
  2738     MOVE LOW-VALUES             TO WS-SAVE-BIN-TRMDT.
  2739
  2740     IF EFFDTL NOT = ZERO
  2741         MOVE EFFDTI             TO DEEDIT-FIELD
  2742         PERFORM 8600-DEEDIT
  2743         MOVE DEEDIT-FIELD-V0    TO DC-GREG-DATE-1-MDY
  2744         MOVE '4'                TO DC-OPTION-CODE
  2745         PERFORM 9700-DATE-CONVERT THRU 9700-EXIT
  2746         IF DATE-CONVERSION-ERROR
  2747             MOVE ER-0348        TO EMI-ERROR
  2748             MOVE -1             TO EFFDTL
  2749             MOVE AL-UABON       TO EFFDTA
  2750             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2751         ELSE
  2752             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
  2753             MOVE AL-UANON             TO EFFDTA
  2754             MOVE DC-BIN-DATE-1        TO WS-SAVE-BIN-EFFDT.
  2755
  2756     IF TRMDTL NOT = ZERO
  2757        MOVE TRMDTI              TO DEEDIT-FIELD
  2758        PERFORM 8600-DEEDIT
  2759        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  2760        IF DC-GREG-DATE-1-MDY = 999999
  2761           MOVE HIGH-VALUES      TO WS-SAVE-BIN-TRMDT
  2762        ELSE
  2763           MOVE '4'              TO DC-OPTION-CODE
  2764           PERFORM 9700-DATE-CONVERT
  2765                                 THRU 9700-EXIT
  2766           IF DATE-CONVERSION-ERROR
  2767              MOVE ER-0454       TO EMI-ERROR
  2768              MOVE -1            TO TRMDTL
  2769              MOVE AL-UABON      TO TRMDTA
  2770              PERFORM 9900-ERROR-FORMAT
  2771                                 THRU 9900-EXIT
  2772           ELSE
  2773              MOVE DC-GREG-DATE-1-EDIT
  2774                                 TO TRMDTI
  2775              MOVE AL-UANON      TO TRMDTA
  2776              MOVE DC-BIN-DATE-1 TO WS-SAVE-BIN-TRMDT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  59
* EL6521.cbl
  2777           END-IF
  2778        END-IF
  2779     END-IF
  2780     IF GADDL > ZERO
  2781        IF GADDI = 'Y' OR 'N' OR ' '
  2782           MOVE AL-UANON         TO GADDA
  2783        ELSE
  2784           MOVE AL-UABON         TO GADDA
  2785           MOVE ER-0876          TO EMI-ERROR
  2786           MOVE -1               TO GADDL
  2787           PERFORM 9900-ERROR-FORMAT
  2788                                 THRU 9900-EXIT
  2789        END-IF
  2790     END-IF
  2791     IF MELSWL > ZERO
  2792        IF MELSWI = 'Y' OR 'N' OR ' '
  2793           MOVE AL-UANON         TO MELSWA
  2794        ELSE
  2795           MOVE AL-UABON         TO MELSWA
  2796           MOVE ER-0876          TO EMI-ERROR
  2797           MOVE -1               TO MELSWL
  2798           PERFORM 9900-ERROR-FORMAT
  2799                                 THRU 9900-EXIT
  2800        END-IF
  2801     END-IF
  2802     IF APCHKL > ZERO
  2803        IF APCHKI = 'Y' OR 'N' OR ' '
  2804           MOVE AL-UANON         TO APCHKA
  2805        ELSE
  2806           MOVE AL-UABON         TO APCHKA
  2807           MOVE ER-0876          TO EMI-ERROR
  2808           MOVE -1               TO APCHKL
  2809           PERFORM 9900-ERROR-FORMAT
  2810                                 THRU 9900-EXIT
  2811        END-IF
  2812     END-IF
  2813     IF WTHLDL  > ZERO
  2814
  2815* EXEC CICS BIF
  2816*          DEEDIT
  2817*          FIELD   (WTHLDI)
  2818*          LENGTH  (6)
  2819*       END-EXEC
  2820     MOVE 6
  2821       TO DFHEIV11
  2822*    MOVE '@"L                   #   #00002707' TO DFHEIV0
  2823     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2824     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2825     MOVE X'2020233030303032373037' TO DFHEIV0(25:11)
  2826     CALL 'kxdfhei1' USING DFHEIV0,
  2827           WTHLDI,
  2828           DFHEIV11
  2829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2830        IF WTHLDI NUMERIC
  2831           MOVE AL-UNNON         TO WTHLDA
  2832        ELSE
  2833           MOVE -1               TO WTHLDL
  2834           MOVE AL-UABON         TO WTHLDA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  60
* EL6521.cbl
  2835           MOVE ER-8799          TO EMI-ERROR
  2836           PERFORM 9900-ERROR-FORMAT
  2837                                 THRU  9900-EXIT
  2838        END-IF
  2839     END-IF
  2840     IF MDAMTL  > ZERO
  2841
  2842* EXEC CICS BIF
  2843*          DEEDIT
  2844*          FIELD   (MDAMTI)
  2845*          LENGTH  (8)
  2846*       END-EXEC
  2847     MOVE 8
  2848       TO DFHEIV11
  2849*    MOVE '@"L                   #   #00002723' TO DFHEIV0
  2850     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2851     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2852     MOVE X'2020233030303032373233' TO DFHEIV0(25:11)
  2853     CALL 'kxdfhei1' USING DFHEIV0,
  2854           MDAMTI,
  2855           DFHEIV11
  2856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2857        IF MDAMTI NUMERIC
  2858           MOVE AL-UNNON         TO MDAMTA
  2859        ELSE
  2860           MOVE -1               TO MDAMTL
  2861           MOVE AL-UABON         TO MDAMTA
  2862           MOVE ER-8799          TO EMI-ERROR
  2863           PERFORM 9900-ERROR-FORMAT
  2864                                 THRU  9900-EXIT
  2865        END-IF
  2866     END-IF
  2867     IF WS-SAVE-BIN-EFFDT = LOW-VALUES OR
  2868        WS-SAVE-BIN-TRMDT = LOW-VALUES
  2869         NEXT SENTENCE
  2870       ELSE
  2871         IF WS-SAVE-BIN-TRMDT LESS THAN WS-SAVE-BIN-EFFDT
  2872             MOVE ER-1228        TO EMI-ERROR
  2873             MOVE -1             TO EFFDTL
  2874             MOVE AL-UABON       TO EFFDTA
  2875             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2876
  2877      IF ((DELTOL > +0)
  2878         OR (RGIDL > +0))
  2879         AND ((DELTOI NOT = SPACES)
  2880         AND (RGIDI NOT = SPACES))
  2881         PERFORM 6100-CHECK-BILL-INSTR
  2882                                 THRU 6100-EXIT
  2883      END-IF
  2884     MOVE SPACES                 TO WS-BANK-INFORMATION.
  2885
  2886     IF PI-AR-PROCESSING
  2887        NEXT SENTENCE
  2888     ELSE
  2889        MOVE ZEROS               TO ACTCDL, TRNSIT1L TRNSIT2L
  2890                                    BKACCTL
  2891        GO TO 7099-EXIT.
  2892
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  61
* EL6521.cbl
  2893     IF (TRNSIT1L NOT = ZERO) OR
  2894        (TRNSIT2L NOT = ZERO) OR
  2895        (BKACCTL  NOT = ZERO) OR
  2896        (ACTCDL   NOT = ZERO)
  2897         MOVE 'Y'                TO WS-ACH-SW
  2898     ELSE
  2899         GO TO 7099-EXIT.
  2900
  2901     IF (ACTCDL = ZERO) OR
  2902        (ACTCDI NOT = 'N' AND 'C' AND 'A' AND 'D')
  2903         MOVE -1                 TO ACTCDL
  2904         MOVE AL-UABON           TO ACTCDA
  2905         MOVE ER-7436            TO EMI-ERROR
  2906         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2907         GO TO 7099-EXIT.
  2908
  2909     IF ACTCDI = 'N'
  2910         GO TO 7020-NEW-ACH.
  2911
  2912     IF ACTCDI = 'C'
  2913         GO TO 7040-CHANGE-ACH.
  2914
  2915     IF ACTCDI = 'A'
  2916         GO TO 7060-ACTIVATE-ACH.
  2917
  2918****   ACH DELETE PROCESSING EDITS
  2919
  2920     IF TRNSIT1L NOT = ZERO OR
  2921        TRNSIT2L NOT = ZERO OR
  2922        BKACCTL  NOT = ZERO
  2923         MOVE -1                 TO ACTCDL
  2924         MOVE AL-UABON           TO ACTCDA
  2925         MOVE ER-7430            TO EMI-ERROR
  2926         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2927
  2928     GO TO 7099-EXIT.
  2929
  2930****   ACH NEW ENTRY PROCESSING EDITS
  2931 7020-NEW-ACH.
  2932
  2933     IF CO-ACH-STATUS = 'A' OR 'P'
  2934         MOVE -1                 TO ACTCDL
  2935         MOVE AL-UABON           TO ACTCDA
  2936         MOVE ER-7434            TO EMI-ERROR
  2937         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2938         GO TO 7099-EXIT.
  2939
  2940     IF TRNSIT1L = ZERO OR
  2941        TRNSIT2L = ZERO OR
  2942        BKACCTL = ZERO
  2943         MOVE -1                 TO TRNSIT1L
  2944         MOVE ER-7431            TO EMI-ERROR
  2945         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2946         GO TO 7099-EXIT.
  2947
  2948     IF TRNSIT1L GREATER THAN ZERO
  2949         IF TRNSIT1I = SPACES
  2950             MOVE -1             TO TRNSIT1L
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  62
* EL6521.cbl
  2951             MOVE ER-7435        TO EMI-ERROR
  2952             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2953             GO TO 7099-EXIT
  2954         ELSE
  2955             MOVE TRNSIT1I       TO WS-TRANSIT1.
  2956
  2957     IF TRNSIT2L GREATER THAN ZERO
  2958         IF TRNSIT2I = SPACES
  2959             MOVE -1             TO TRNSIT2L
  2960             MOVE ER-7435        TO EMI-ERROR
  2961             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2962             GO TO 7099-EXIT
  2963         ELSE
  2964             MOVE TRNSIT2I       TO WS-TRANSIT2.
  2965
  2966     IF BKACCTL GREATER THAN ZERO
  2967         IF BKACCTI = SPACES
  2968             MOVE -1             TO BKACCTL
  2969             MOVE ER-7435        TO EMI-ERROR
  2970             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2971             GO TO 7099-EXIT
  2972         ELSE
  2973             MOVE BKACCTI        TO WS-BKACCTI.
  2974         MOVE BKACCTI            TO WS-BKACCTI.
  2975
  2976     PERFORM 7500-VALIDATE-TRANSIT  THRU  7500-VALIDATE-EXIT.
  2977
  2978     GO TO 7099-EXIT.
  2979
  2980****   ACH CHANGE ENTRY PROCESSING EDITS
  2981 7040-CHANGE-ACH.
  2982
  2983     IF (TRNSIT1L = ZERO) AND
  2984        (TRNSIT2L = ZERO) AND
  2985        (BKACCTL = ZERO)
  2986         MOVE -1                 TO TRNSIT1L
  2987         MOVE ER-7435            TO EMI-ERROR
  2988         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2989         GO TO 7099-EXIT.
  2990
  2991     IF CO-BANK-INFORMATION = SPACES OR LOW-VALUES
  2992         MOVE -1                 TO ACTCDL
  2993         MOVE ER-7432            TO EMI-ERROR
  2994         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2995         GO TO 7099-EXIT.
  2996
  2997     MOVE CO-BANK-INFORMATION    TO WS-BANK-INFORMATION.
  2998
  2999     IF TRNSIT1L GREATER THAN ZERO
  3000         IF TRNSIT1I = SPACES
  3001             MOVE -1             TO TRNSIT1L
  3002             MOVE ER-7435        TO EMI-ERROR
  3003             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3004             GO TO 7099-EXIT
  3005         ELSE
  3006             MOVE TRNSIT1I       TO WS-TRANSIT1.
  3007
  3008     IF TRNSIT2L GREATER THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  63
* EL6521.cbl
  3009         IF TRNSIT2I = SPACES
  3010             MOVE -1             TO TRNSIT2L
  3011             MOVE ER-7435        TO EMI-ERROR
  3012             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3013             GO TO 7099-EXIT
  3014         ELSE
  3015             MOVE TRNSIT2I       TO WS-TRANSIT2.
  3016
  3017     IF BKACCTL GREATER THAN ZERO
  3018         IF BKACCTI = SPACES
  3019             MOVE -1             TO BKACCTL
  3020             MOVE ER-7435        TO EMI-ERROR
  3021             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3022             GO TO 7099-EXIT
  3023         ELSE
  3024             MOVE BKACCTI        TO WS-BKACCTI.
  3025
  3026     IF CO-BANK-INFORMATION = WS-BANK-INFORMATION
  3027         MOVE -1                 TO ACTCDL
  3028         MOVE ER-7449            TO EMI-ERROR
  3029         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3030         GO TO 7099-EXIT.
  3031
  3032     IF TRNSIT1L GREATER THAN ZERO OR
  3033        TRNSIT2L GREATER THAN ZERO
  3034         PERFORM 7500-VALIDATE-TRANSIT  THRU  7500-VALIDATE-EXIT.
  3035
  3036     GO TO 7099-EXIT.
  3037
  3038****   ACH ACTIVATE ENTRY PROCESSING EDITS
  3039 7060-ACTIVATE-ACH.
  3040
  3041     IF NOT CO-ACH-PENDING
  3042         MOVE -1                 TO ACTCDL
  3043         MOVE ER-7465            TO EMI-ERROR
  3044         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3045         GO TO 7099-EXIT.
  3046
  3047     IF TRNSIT1L NOT = ZERO OR
  3048        TRNSIT2L NOT = ZERO OR
  3049        BKACCTL  NOT = ZERO
  3050         MOVE -1                 TO ACTCDL
  3051         MOVE ER-7440            TO EMI-ERROR
  3052         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3053         GO TO 7099-EXIT.
  3054
  3055 7099-EXIT.
  3056     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  64
* EL6521.cbl
  3058
  3059 7100-READ-ERCOMP.
  3060
  3061
  3062* EXEC CICS HANDLE CONDITION
  3063*        NOTOPEN (7100-NOTOPEN)
  3064*        NOTFND  (7100-NOTFND)
  3065*    END-EXEC.
  3066*    MOVE '"$JI                  ! $ #00002932' TO DFHEIV0
  3067     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  3068     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3069     MOVE X'2420233030303032393332' TO DFHEIV0(25:11)
  3070     CALL 'kxdfhei1' USING DFHEIV0
  3071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3072
  3073
  3074
  3075* EXEC CICS READ
  3076*         DATASET  (ERCOMP-FILE-ID)
  3077*         SET      (ADDRESS OF COMPENSATION-MASTER)
  3078*         RIDFLD   (PI-ERCOMP-KEY)
  3079*    END-EXEC.
  3080*    MOVE '&"S        E          (   #00002937' TO DFHEIV0
  3081     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3082     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3083     MOVE X'2020233030303032393337' TO DFHEIV0(25:11)
  3084     CALL 'kxdfhei1' USING DFHEIV0,
  3085           ERCOMP-FILE-ID,
  3086           DFHEIV20,
  3087           DFHEIV99,
  3088           PI-ERCOMP-KEY,
  3089           DFHEIV99,
  3090           DFHEIV99,
  3091           DFHEIV99
  3092     SET ADDRESS OF COMPENSATION-MASTER TO
  3093         DFHEIV20
  3094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3095
  3096
  3097*    PERFORM 7200-READ-ERCOBI    THRU 7200-EXIT
  3098     IF DO-NOT-MOVE-TO-MAP
  3099        MOVE 'Y'                 TO SUPPRESS-MAP-SW
  3100        GO TO 7100-EXIT.
  3101
  3102     MOVE CO-LAST-MAINT-USER     TO PI-UPDATE-BY.
  3103     MOVE CO-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  3104     MOVE CO-CONTROL-PRIMARY     TO PI-ERCOMP-KEY.
  3105     MOVE CO-CARRIER             TO CARRIERO.
  3106     MOVE CO-GROUPING            TO GROUPO.
  3107     MOVE CO-TYPE                TO TYPEO.
  3108     MOVE CO-RESP-NO             TO FINRESPO.
  3109     MOVE CO-CTL-2               TO COACCTO.
  3110     MOVE CO-BANK-INFORMATION    TO PI-BANK-TRANSIT-NUMBER (2:8)
  3111     MOVE PI-FEDERAL-NUMBER      TO TRNSIT1O.
  3112     MOVE PI-BANK-NUMBER         TO TRNSIT2O.
  3113     GO TO 7100-EXIT.
  3114
  3115 7100-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  65
* EL6521.cbl
  3116     MOVE ER-7462               TO EMI-ERROR
  3117     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3118     GO TO 7100-EXIT.
  3119
  3120 7100-NOTOPEN.
  3121     MOVE ER-2233               TO EMI-ERROR
  3122     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3123     GO TO 7100-EXIT.
  3124
  3125 7100-EXIT.
  3126     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  66
* EL6521.cbl
  3128
  3129 7200-READ-ERCOBI.
  3130     MOVE CO-CONTROL-PRIMARY     TO ERCOBI-KEY
  3131
  3132* EXEC CICS READ
  3133*       DATASET (ERCOBI-FILE-ID)
  3134*       SET     (ADDRESS OF COMP-BILLING-INSTRUCTIONS)
  3135*       RIDFLD  (ERCOBI-KEY)
  3136*       RESP    (WS-RESPONSE)
  3137*    END-EXEC
  3138*    MOVE '&"S        E          (  N#00002977' TO DFHEIV0
  3139     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3140     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3141     MOVE X'204E233030303032393737' TO DFHEIV0(25:11)
  3142     CALL 'kxdfhei1' USING DFHEIV0,
  3143           ERCOBI-FILE-ID,
  3144           DFHEIV20,
  3145           DFHEIV99,
  3146           ERCOBI-KEY,
  3147           DFHEIV99,
  3148           DFHEIV99,
  3149           DFHEIV99
  3150     SET ADDRESS OF COMP-BILLING-INSTRUCTIONS TO
  3151         DFHEIV20
  3152     MOVE EIBRESP  TO WS-RESPONSE
  3153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3154     IF RESP-NORMAL
  3155        SET BILLING-INSTRUCTIONS-FOUND TO TRUE
  3156     END-IF
  3157     .
  3158 7200-EXIT.
  3159     EXIT.
  3160 7300-READ-ERCOMP-UPDATE.
  3161
  3162* EXEC CICS HANDLE CONDITION
  3163*        NOTFND  (7300-NOTFND)
  3164*        NOTOPEN (7300-NOTOPEN)
  3165*    END-EXEC.
  3166*    MOVE '"$IJ                  ! % #00002990' TO DFHEIV0
  3167     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3168     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3169     MOVE X'2520233030303032393930' TO DFHEIV0(25:11)
  3170     CALL 'kxdfhei1' USING DFHEIV0
  3171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3172
  3173
  3174
  3175* EXEC CICS READ
  3176*         DATASET  (ERCOMP-FILE-ID)
  3177*         SET      (ADDRESS OF COMPENSATION-MASTER)
  3178*         RIDFLD   (PI-ERCOMP-KEY)
  3179*         UPDATE
  3180*    END-EXEC.
  3181*    MOVE '&"S        EU         (   #00002995' TO DFHEIV0
  3182     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3183     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3184     MOVE X'2020233030303032393935' TO DFHEIV0(25:11)
  3185     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  67
* EL6521.cbl
  3186           ERCOMP-FILE-ID,
  3187           DFHEIV20,
  3188           DFHEIV99,
  3189           PI-ERCOMP-KEY,
  3190           DFHEIV99,
  3191           DFHEIV99,
  3192           DFHEIV99
  3193     SET ADDRESS OF COMPENSATION-MASTER TO
  3194         DFHEIV20
  3195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3196
  3197     GO TO 7300-EXIT.
  3198
  3199 7300-NOTOPEN.
  3200
  3201     MOVE ER-2233               TO EMI-ERROR
  3202     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3203     GO TO 7300-EXIT.
  3204 7300-NOTFND.
  3205
  3206     MOVE ER-7462               TO EMI-ERROR
  3207     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3208     GO TO 7300-EXIT.
  3209
  3210 7300-EXIT.
  3211     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  68
* EL6521.cbl
  3213
  3214 7400-DELETE-PRE-NOTE.
  3215
  3216
  3217* EXEC CICS HANDLE CONDITION
  3218*        NOTFND  (7499-EXIT)
  3219*        NOTOPEN (7450-NOTOPEN)
  3220*    END-EXEC.
  3221*    MOVE '"$IJ                  ! & #00003020' TO DFHEIV0
  3222     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3223     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3224     MOVE X'2620233030303033303230' TO DFHEIV0(25:11)
  3225     CALL 'kxdfhei1' USING DFHEIV0
  3226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3227
  3228
  3229
  3230* EXEC CICS READ
  3231*         DATASET  (ELACHP-FILE-ID)
  3232*         SET     (ADDRESS OF ACH-PRENOTIFICATION)
  3233*         RIDFLD   (CO-CONTROL-PRIMARY)
  3234*         UPDATE
  3235*    END-EXEC.
  3236*    MOVE '&"S        EU         (   #00003025' TO DFHEIV0
  3237     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3238     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3239     MOVE X'2020233030303033303235' TO DFHEIV0(25:11)
  3240     CALL 'kxdfhei1' USING DFHEIV0,
  3241           ELACHP-FILE-ID,
  3242           DFHEIV20,
  3243           DFHEIV99,
  3244           CO-CONTROL-PRIMARY,
  3245           DFHEIV99,
  3246           DFHEIV99,
  3247           DFHEIV99
  3248     SET ADDRESS OF ACH-PRENOTIFICATION TO
  3249         DFHEIV20
  3250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3251
  3252
  3253
  3254* EXEC CICS DELETE
  3255*        DATASET   (ELACHP-FILE-ID)
  3256*    END-EXEC.
  3257*    MOVE '&(                    &   #00003032' TO DFHEIV0
  3258     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  3259     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3260     MOVE X'2020233030303033303332' TO DFHEIV0(25:11)
  3261     CALL 'kxdfhei1' USING DFHEIV0,
  3262           ELACHP-FILE-ID,
  3263           DFHEIV99,
  3264           DFHEIV99,
  3265           DFHEIV99,
  3266           DFHEIV99
  3267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3268
  3269
  3270     GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  69
* EL6521.cbl
  3271
  3272 7450-NOTOPEN.
  3273     MOVE ER-7469               TO EMI-ERROR
  3274     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3275
  3276 7499-EXIT.
  3277     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  70
* EL6521.cbl
  3279
  3280******************************************************************
  3281*             V A L I D T E  T R A N S I T  N U M B E R
  3282******************************************************************
  3283 7500-VALIDATE-TRANSIT.
  3284
  3285
  3286* EXEC CICS HANDLE CONDITION
  3287*        NOTFND   (7500-NOT-FOUND)
  3288*        NOTOPEN  (7500-NOT-OPEN)
  3289*    END-EXEC.
  3290*    MOVE '"$IJ                  ! '' #00003051' TO DFHEIV0
  3291     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3292     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3293     MOVE X'2720233030303033303531' TO DFHEIV0(25:11)
  3294     CALL 'kxdfhei1' USING DFHEIV0
  3295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3296
  3297
  3298     MOVE WS-TRANSIT1          TO PI-FEDERAL-NUMBER.
  3299     MOVE WS-TRANSIT2          TO PI-BANK-NUMBER.
  3300     MOVE PI-COMPANY-CD        TO PI-BANK-COMPANY-CD.
  3301
  3302
  3303* EXEC CICS READ
  3304*        EQUAL
  3305*        DATASET   (ELBANK-FILE-ID)
  3306*        SET       (ADDRESS OF BANK-MASTER)
  3307*        RIDFLD    (PI-BANK-TRANSIT-NUMBER)
  3308*    END-EXEC.
  3309*    MOVE '&"S        E          (   #00003060' TO DFHEIV0
  3310     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3311     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3312     MOVE X'2020233030303033303630' TO DFHEIV0(25:11)
  3313     CALL 'kxdfhei1' USING DFHEIV0,
  3314           ELBANK-FILE-ID,
  3315           DFHEIV20,
  3316           DFHEIV99,
  3317           PI-BANK-TRANSIT-NUMBER,
  3318           DFHEIV99,
  3319           DFHEIV99,
  3320           DFHEIV99
  3321     SET ADDRESS OF BANK-MASTER TO
  3322         DFHEIV20
  3323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3324
  3325
  3326     GO TO 7500-VALIDATE-EXIT.
  3327
  3328 7500-NOT-OPEN.
  3329
  3330     MOVE -1                    TO TRNSIT1L
  3331     MOVE AL-UABON              TO TRNSIT1A
  3332     MOVE AL-UABON              TO TRNSIT2A
  3333     MOVE ER-7468               TO EMI-ERROR .
  3334     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3335     GO TO 7500-VALIDATE-EXIT.
  3336
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  71
* EL6521.cbl
  3337 7500-NOT-FOUND.
  3338
  3339     MOVE -1                    TO TRNSIT1L
  3340     MOVE AL-UABON              TO TRNSIT1A
  3341     MOVE AL-UABON              TO TRNSIT2A
  3342     MOVE ER-9388               TO EMI-ERROR .
  3343     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3344     GO TO 7500-VALIDATE-EXIT.
  3345
  3346 7500-VALIDATE-EXIT.
  3347     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  72
* EL6521.cbl
  3349
  3350 7600-WRITE-ELACHP.
  3351
  3352* EXEC CICS HANDLE CONDITION
  3353*        NOTOPEN (7450-NOTOPEN)
  3354*        DUPREC   (7610-DUPREC)
  3355*    END-EXEC.
  3356*    MOVE '"$J%                  ! ( #00003092' TO DFHEIV0
  3357     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  3358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3359     MOVE X'2820233030303033303932' TO DFHEIV0(25:11)
  3360     CALL 'kxdfhei1' USING DFHEIV0
  3361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3362
  3363
  3364
  3365* EXEC CICS GETMAIN
  3366*        SET      (ADDRESS OF ACH-PRENOTIFICATION)
  3367*        LENGTH   (210)
  3368*    END-EXEC.
  3369     MOVE 210
  3370       TO DFHEIV11
  3371*    MOVE '," L                  $   #00003097' TO DFHEIV0
  3372     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  3373     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3374     MOVE X'2020233030303033303937' TO DFHEIV0(25:11)
  3375     CALL 'kxdfhei1' USING DFHEIV0,
  3376           DFHEIV20,
  3377           DFHEIV11,
  3378           DFHEIV99
  3379     SET ADDRESS OF ACH-PRENOTIFICATION TO
  3380         DFHEIV20
  3381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3382
  3383
  3384     INITIALIZE  ACH-PRENOTIFICATION.
  3385
  3386     MOVE  'AP'                  TO AP-RECORD-ID.
  3387
  3388     MOVE PI-PROCESSOR-ID        TO AP-LAST-CHANGE-PROCESSOR
  3389     MOVE CO-CONTROL-PRIMARY     TO AP-CONTROL-PRIMARY
  3390     MOVE EIBTIME                TO AP-LAST-CHANGE-TIME
  3391     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  3392     MOVE '5'                    TO DC-OPTION-CODE.
  3393     PERFORM 9700-DATE-CONVERT THRU 9700-EXIT.
  3394
  3395     MOVE DC-BIN-DATE-1          TO AP-LAST-CHANGE-DT.
  3396     MOVE WS-BANK-DATA           TO AP-BANK-INFORMATION.
  3397     MOVE BM-NAME                TO AP-BANK-NAME.
  3398
  3399
  3400* EXEC CICS WRITE
  3401*        FROM      (ACH-PRENOTIFICATION)
  3402*        DATASET   (ELACHP-FILE-ID)
  3403*        RIDFLD    (CO-CONTROL-PRIMARY)
  3404*    END-EXEC.
  3405     MOVE LENGTH OF
  3406      ACH-PRENOTIFICATION
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  73
* EL6521.cbl
  3407       TO DFHEIV11
  3408*    MOVE '&$ L                  ''   #00003117' TO DFHEIV0
  3409     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3410     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3411     MOVE X'2020233030303033313137' TO DFHEIV0(25:11)
  3412     CALL 'kxdfhei1' USING DFHEIV0,
  3413           ELACHP-FILE-ID,
  3414           ACH-PRENOTIFICATION,
  3415           DFHEIV11,
  3416           CO-CONTROL-PRIMARY,
  3417           DFHEIV99,
  3418           DFHEIV99
  3419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3420
  3421
  3422     GO TO 7620-WRITE-EXIT.
  3423
  3424 7610-DUPREC.
  3425
  3426     MOVE    ER-7447            TO EMI-ERROR
  3427     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3428     GO TO 7620-WRITE-EXIT.
  3429
  3430 7620-WRITE-EXIT.
  3431      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  74
* EL6521.cbl
  3433******************************************************************
  3434 8100-SEND-INITIAL-MAP.
  3435     MOVE WS-SAVE-DATE           TO DATEO.
  3436     MOVE EIBTIME                TO TIME-IN.
  3437     MOVE TIME-OUT               TO TIMEO.
  3438     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3439     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3440     MOVE -1                     TO MAINTYPL.
  3441     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  3442     MOVE WS-AGENT-BANK-DESC    TO BKDESCO.
  3443
  3444* HIDE ACH FIELDS IF NOT AR PROCESSING
  3445     IF PI-AR-PROCESSING
  3446        NEXT SENTENCE
  3447     ELSE
  3448        MOVE AL-SADOF             TO BKLITA, BKDESCA  CRSTATA
  3449                                     ACTLITA CRSLITA ACHPF1A
  3450                                     TRNSIT1A TRNSIT2A TRDASHA
  3451                                     BKACCTA, ACTCDA.
  3452
  3453* EXEC CICS SEND
  3454*        MAP      (MAP-NAME)
  3455*        MAPSET   (MAPSET-NAME)
  3456*        FROM     (EL6521AO)
  3457*        ERASE
  3458*        CURSOR
  3459*    END-EXEC.
  3460     MOVE LENGTH OF
  3461      EL6521AO
  3462       TO DFHEIV12
  3463     MOVE -1
  3464       TO DFHEIV11
  3465*    MOVE '8$     CT  E    H L F ,   #00003153' TO DFHEIV0
  3466     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3467     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3468     MOVE X'2020233030303033313533' TO DFHEIV0(25:11)
  3469     CALL 'kxdfhei1' USING DFHEIV0,
  3470           MAP-NAME,
  3471           EL6521AO,
  3472           DFHEIV12,
  3473           MAPSET-NAME,
  3474           DFHEIV99,
  3475           DFHEIV99,
  3476           DFHEIV99,
  3477           DFHEIV11,
  3478           DFHEIV99,
  3479           DFHEIV99,
  3480           DFHEIV99
  3481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3482
  3483
  3484     GO TO 9100-RETURN-TRAN.
  3485
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  75
* EL6521.cbl
  3487 8200-SEND-DATAONLY.
  3488     MOVE WS-SAVE-DATE           TO DATEO.
  3489     MOVE EIBTIME                TO TIME-IN.
  3490     MOVE TIME-OUT               TO TIMEO.
  3491     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3492     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3493     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  3494     MOVE WS-AGENT-BANK-DESC     TO BKDESCO.
  3495
  3496* HIDE ACH FIELDS IF NOT AR PROCESSING
  3497     IF PI-AR-PROCESSING
  3498        NEXT SENTENCE
  3499     ELSE
  3500        MOVE AL-SADOF             TO BKLITA, BKDESCA  CRSTATA
  3501                                     ACTLITA CRSLITA ACHPF1A
  3502                                     TRNSIT1A TRNSIT2A TRDASHA
  3503                                     BKACCTA, ACTCDA.
  3504
  3505* EXEC CICS SEND
  3506*        MAP      (MAP-NAME)
  3507*        MAPSET   (MAPSET-NAME)
  3508*        FROM     (EL6521AO)
  3509*        DATAONLY
  3510*        CURSOR
  3511*    END-EXEC.
  3512     MOVE LENGTH OF
  3513      EL6521AO
  3514       TO DFHEIV12
  3515     MOVE -1
  3516       TO DFHEIV11
  3517*    MOVE '8$D    CT       H L F ,   #00003181' TO DFHEIV0
  3518     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3519     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3520     MOVE X'2020233030303033313831' TO DFHEIV0(25:11)
  3521     CALL 'kxdfhei1' USING DFHEIV0,
  3522           MAP-NAME,
  3523           EL6521AO,
  3524           DFHEIV12,
  3525           MAPSET-NAME,
  3526           DFHEIV99,
  3527           DFHEIV99,
  3528           DFHEIV99,
  3529           DFHEIV11,
  3530           DFHEIV99,
  3531           DFHEIV99,
  3532           DFHEIV99
  3533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3534
  3535
  3536     GO TO 9100-RETURN-TRAN.
  3537
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  76
* EL6521.cbl
  3539 8300-SEND-TEXT.
  3540
  3541* EXEC CICS SEND TEXT
  3542*        FROM     (LOGOFF-TEXT)
  3543*        LENGTH   (LOGOFF-LENGTH)
  3544*        ERASE
  3545*        FREEKB
  3546*    END-EXEC.
  3547*    MOVE '8&      T  E F  H   F -   #00003193' TO DFHEIV0
  3548     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3549     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3550     MOVE X'2020233030303033313933' TO DFHEIV0(25:11)
  3551     CALL 'kxdfhei1' USING DFHEIV0,
  3552           LOGOFF-TEXT,
  3553           LOGOFF-LENGTH,
  3554           DFHEIV99,
  3555           DFHEIV99,
  3556           DFHEIV99,
  3557           DFHEIV99,
  3558           DFHEIV99,
  3559           DFHEIV99,
  3560           DFHEIV99,
  3561           DFHEIV99,
  3562           DFHEIV99,
  3563           DFHEIV99
  3564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3565
  3566
  3567
  3568* EXEC CICS RETURN
  3569*    END-EXEC.
  3570*    MOVE '.(                    ''   #00003200' TO DFHEIV0
  3571     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3572     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3573     MOVE X'2020233030303033323030' TO DFHEIV0(25:11)
  3574     CALL 'kxdfhei1' USING DFHEIV0,
  3575           DFHEIV99,
  3576           DFHEIV99,
  3577           DFHEIV99,
  3578           DFHEIV99,
  3579           DFHEIV99,
  3580           DFHEIV99
  3581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3582
  3583
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  77
* EL6521.cbl
  3585 8600-DEEDIT.
  3586
  3587* EXEC CICS BIF DEEDIT
  3588*         FIELD(DEEDIT-FIELD)
  3589*         LENGTH(15)
  3590*    END-EXEC.
  3591     MOVE 15
  3592       TO DFHEIV11
  3593*    MOVE '@"L                   #   #00003205' TO DFHEIV0
  3594     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3595     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3596     MOVE X'2020233030303033323035' TO DFHEIV0(25:11)
  3597     CALL 'kxdfhei1' USING DFHEIV0,
  3598           DEEDIT-FIELD,
  3599           DFHEIV11
  3600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3601
  3602
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  78
* EL6521.cbl
  3604 8800-UNAUTHORIZED-ACCESS.
  3605     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3606     GO TO 8300-SEND-TEXT.
  3607
  3608 8810-PF23.
  3609     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3610     MOVE XCTL-005               TO PGM-NAME.
  3611     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  79
* EL6521.cbl
  3613
  3614 9100-RETURN-TRAN.
  3615     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3616     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  3617
  3618* EXEC CICS RETURN
  3619*        TRANSID    (TRANS-ID)
  3620*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3621*        LENGTH     (WS-COMM-LENGTH)
  3622*    END-EXEC.
  3623*    MOVE '.(CT                  ''   #00003224' TO DFHEIV0
  3624     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3625     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3626     MOVE X'2020233030303033323234' TO DFHEIV0(25:11)
  3627     CALL 'kxdfhei1' USING DFHEIV0,
  3628           TRANS-ID,
  3629           PROGRAM-INTERFACE-BLOCK,
  3630           WS-COMM-LENGTH,
  3631           DFHEIV99,
  3632           DFHEIV99,
  3633           DFHEIV99
  3634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3635
  3636
  3637 9200-RETURN-MAIN-MENU.
  3638     MOVE XCTL-626               TO PGM-NAME.
  3639     GO TO 9300-XCTL.
  3640
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  80
* EL6521.cbl
  3642 9300-XCTL.
  3643
  3644* EXEC CICS XCTL
  3645*        PROGRAM    (PGM-NAME)
  3646*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3647*        LENGTH     (WS-COMM-LENGTH)
  3648*    END-EXEC.
  3649*    MOVE '.$C                   %   #00003236' TO DFHEIV0
  3650     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3651     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3652     MOVE X'2020233030303033323336' TO DFHEIV0(25:11)
  3653     CALL 'kxdfhei1' USING DFHEIV0,
  3654           PGM-NAME,
  3655           PROGRAM-INTERFACE-BLOCK,
  3656           WS-COMM-LENGTH,
  3657           DFHEIV99
  3658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3659
  3660
  3661 9400-CLEAR.
  3662     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  3663     GO TO 9300-XCTL.
  3664
  3665 9500-PF12.
  3666     MOVE XCTL-010               TO PGM-NAME.
  3667     GO TO 9300-XCTL.
  3668
  3669 9600-PGMID-ERROR.
  3670
  3671* EXEC CICS HANDLE CONDITION
  3672*        PGMIDERR    (8300-SEND-TEXT)
  3673*    END-EXEC.
  3674*    MOVE '"$L                   ! ) #00003251' TO DFHEIV0
  3675     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3676     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3677     MOVE X'2920233030303033323531' TO DFHEIV0(25:11)
  3678     CALL 'kxdfhei1' USING DFHEIV0
  3679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3680
  3681
  3682     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  3683     MOVE ' '                    TO PI-ENTRY-CD-1.
  3684     MOVE XCTL-005               TO PGM-NAME.
  3685     MOVE PGM-NAME               TO LOGOFF-PGM.
  3686     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  3687     GO TO 9300-XCTL.
  3688
  3689 9700-DATE-CONVERT.
  3690
  3691* EXEC CICS LINK
  3692*        PROGRAM    ('ELDATCV')
  3693*        COMMAREA   (DATE-CONVERSION-DATA)
  3694*        LENGTH     (DC-COMM-LENGTH)
  3695*    END-EXEC.
  3696     MOVE 'ELDATCV' TO DFHEIV1
  3697*    MOVE '."C                   (   #00003263' TO DFHEIV0
  3698     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3699     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  81
* EL6521.cbl
  3700     MOVE X'2020233030303033323633' TO DFHEIV0(25:11)
  3701     CALL 'kxdfhei1' USING DFHEIV0,
  3702           DFHEIV1,
  3703           DATE-CONVERSION-DATA,
  3704           DC-COMM-LENGTH,
  3705           DFHEIV99,
  3706           DFHEIV99,
  3707           DFHEIV99,
  3708           DFHEIV99
  3709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3710
  3711
  3712 9700-EXIT.
  3713     EXIT.
  3714
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  82
* EL6521.cbl
  3716 9900-ERROR-FORMAT.
  3717
  3718     IF NOT EMI-ERRORS-COMPLETE
  3719         MOVE LINK-001           TO PGM-NAME
  3720
  3721* EXEC CICS LINK
  3722*            PROGRAM    (PGM-NAME)
  3723*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  3724*            LENGTH     (EMI-COMM-LENGTH)
  3725*        END-EXEC.
  3726*    MOVE '."C                   (   #00003277' TO DFHEIV0
  3727     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3728     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3729     MOVE X'2020233030303033323737' TO DFHEIV0(25:11)
  3730     CALL 'kxdfhei1' USING DFHEIV0,
  3731           PGM-NAME,
  3732           ERROR-MESSAGE-INTERFACE-BLOCK,
  3733           EMI-COMM-LENGTH,
  3734           DFHEIV99,
  3735           DFHEIV99,
  3736           DFHEIV99,
  3737           DFHEIV99
  3738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3739
  3740
  3741 9900-EXIT.
  3742     EXIT.
  3743
  3744 9990-ABEND.
  3745     MOVE LINK-004               TO PGM-NAME.
  3746     MOVE DFHEIBLK               TO EMI-LINE1.
  3747
  3748* EXEC CICS LINK
  3749*        PROGRAM   (PGM-NAME)
  3750*        COMMAREA  (EMI-LINE1)
  3751*        LENGTH    (72)
  3752*    END-EXEC.
  3753     MOVE 72
  3754       TO DFHEIV11
  3755*    MOVE '."C                   (   #00003289' TO DFHEIV0
  3756     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3757     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3758     MOVE X'2020233030303033323839' TO DFHEIV0(25:11)
  3759     CALL 'kxdfhei1' USING DFHEIV0,
  3760           PGM-NAME,
  3761           EMI-LINE1,
  3762           DFHEIV11,
  3763           DFHEIV99,
  3764           DFHEIV99,
  3765           DFHEIV99,
  3766           DFHEIV99
  3767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3768
  3769
  3770     GO TO 8200-SEND-DATAONLY.
  3771
  3772 9995-SECURITY-VIOLATION.
  3773*           COPY ELCSCTP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  83
* EL6521.cbl
  3774******************************************************************
  3775*                                                                *
  3776*                            ELCSCTP                             *
  3777*                            VMOD=2.001                          *
  3778*                                                                *
  3779*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3780******************************************************************
  3781
  3782
  3783     MOVE EIBDATE          TO SM-JUL-DATE.
  3784     MOVE EIBTRMID         TO SM-TERMID.
  3785     MOVE THIS-PGM         TO SM-PGM.
  3786     MOVE EIBTIME          TO TIME-IN.
  3787     MOVE TIME-OUT         TO SM-TIME.
  3788     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3789
  3790
  3791* EXEC CICS LINK
  3792*         PROGRAM  ('EL003')
  3793*         COMMAREA (SECURITY-MESSAGE)
  3794*         LENGTH   (80)
  3795*    END-EXEC.
  3796     MOVE 'EL003' TO DFHEIV1
  3797     MOVE 80
  3798       TO DFHEIV11
  3799*    MOVE '."C                   (   #00003315' TO DFHEIV0
  3800     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3801     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3802     MOVE X'2020233030303033333135' TO DFHEIV0(25:11)
  3803     CALL 'kxdfhei1' USING DFHEIV0,
  3804           DFHEIV1,
  3805           SECURITY-MESSAGE,
  3806           DFHEIV11,
  3807           DFHEIV99,
  3808           DFHEIV99,
  3809           DFHEIV99,
  3810           DFHEIV99
  3811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3812
  3813
  3814******************************************************************
  3815
  3816
  3817 9995-EXIT.
  3818      EXIT.
  3819
  3820 9999-DFHBACK SECTION.
  3821     MOVE '9%                    "   ' TO DFHEIV0
  3822     MOVE 'EL6521' TO DFHEIV1
  3823     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3824     GOBACK.
  3825 9999-DFHEXIT.
  3826     IF DFHEIGDJ EQUAL 0001
  3827         NEXT SENTENCE
  3828     ELSE IF DFHEIGDJ EQUAL 2
  3829         GO TO 9600-PGMID-ERROR,
  3830               9990-ABEND
  3831         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:20 Page  84
* EL6521.cbl
  3832     ELSE IF DFHEIGDJ EQUAL 3
  3833         GO TO 0700-EXIT
  3834         DEPENDING ON DFHEIGDI
  3835     ELSE IF DFHEIGDJ EQUAL 4
  3836         GO TO 7100-NOTOPEN,
  3837               7100-NOTFND
  3838         DEPENDING ON DFHEIGDI
  3839     ELSE IF DFHEIGDJ EQUAL 5
  3840         GO TO 7300-NOTFND,
  3841               7300-NOTOPEN
  3842         DEPENDING ON DFHEIGDI
  3843     ELSE IF DFHEIGDJ EQUAL 6
  3844         GO TO 7499-EXIT,
  3845               7450-NOTOPEN
  3846         DEPENDING ON DFHEIGDI
  3847     ELSE IF DFHEIGDJ EQUAL 7
  3848         GO TO 7500-NOT-FOUND,
  3849               7500-NOT-OPEN
  3850         DEPENDING ON DFHEIGDI
  3851     ELSE IF DFHEIGDJ EQUAL 8
  3852         GO TO 7450-NOTOPEN,
  3853               7610-DUPREC
  3854         DEPENDING ON DFHEIGDI
  3855     ELSE IF DFHEIGDJ EQUAL 9
  3856         GO TO 8300-SEND-TEXT
  3857         DEPENDING ON DFHEIGDI.
  3858     MOVE '9%                    "   ' TO DFHEIV0
  3859     MOVE 'EL6521' TO DFHEIV1
  3860     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3861     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4388     Code:       11006
