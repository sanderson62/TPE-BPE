* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   1
* SOCK04BL.cbl
* Options: int("SOCK04BL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK04BL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK04BL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "SOCK04BL.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2015 by Central States Health and Life          *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK04BL.
     9*
    10*AUTHOR.    Cowtown.
    11*           Colleyville, TEXAS.
    12*REMARKS.
    13***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   2
* SOCK04BL.cbl
    14***                                                            ***
    15***  This program acts as a Socket Server and expects a key    ***
    16***  to read an account master and a compensation master and   ***
    17***  will pass back a few items. It currently is designed to   ***
    18***  work with the Agent Signature Verification process.       ***
    19***                                                            ***
    20***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    21******************************************************************
    22*                   C H A N G E   L O G
    23*
    24* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    25*-----------------------------------------------------------------
    26*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    27* EFFECTIVE    NUMBER
    28*-----------------------------------------------------------------
    29* 031115  CR               PEMA  NEW PROGRAM
    30* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    31*-----------------------------------------------------------------
    32 environment division.
    33 data division.
    34 working-storage section.
    35 01  DFH-START PIC X(04).
    36 77  WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    37 77  WS-COMP-ID                   PIC XXX VALUE 'CID'.
    38 77  WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    39 77  WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    40 77  WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    41 77  WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    42 77  WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    43 77  a1                           PIC S999 COMP-3 VALUE +0.
    44 77  c1                           PIC S999 COMP-3 VALUE +0.
    45 77  WS-BUILD-SW                  PIC X.
    46     88  TIME-TO-BUILD               VALUE 'Y'.
    47 77  WS-SAVE-ERACCT               PIC X(2000).
    48 77  WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    49 77  ws-bin-eff-dt                pic xx  value low-values.
    50 77  ws-bin-1st-pay-dt            pic xx  value low-values.
    51 77  WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    52 77  ws-disp-rate                 pic z9.99999.
    53 77  WS-ERACCT-SW                PIC X VALUE ' '.
    54     88  END-OF-ERACCT                 VALUE 'Y'.
    55 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    56     88  END-OF-ERCTBL                 VALUE 'Y'.
    57 77  WS-STATUS                   PIC X.
    58 77  ws-bin-cert-eff-dt          pic xx   value low-values.
    59 77  ws-current-bin-dt           pic xx   value low-values.
    60 77  ws-cert-note-generic-key-len pic s9(4) comp value +34.
    61 77  note-count                  pic s999 comp-3 value +0.
    62 77  ws-build-note-sw            pic x value ' '.
    63     88  finished-with-notes      value 'Y'.
    64 77  ws-ercnot-sw                pic x  value spaces.
    65     88  ercnot-startbr            value 'Y'.
    66 01  ws-work-date.
    67     05  ws-work-ccyy            pic x(4).
    68     05  ws-work-mm              pic xx.
    69     05  ws-work-dd              pic xx.
    70 01  ws-work-date-num redefines ws-work-date
    71                                 pic 9(8).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   3
* SOCK04BL.cbl
    72 01  cert-note-records-holder.
    73     05  cert-note-record occurs 300.
    74         10  filler              pic x(48).
    75         10  cnr-rest            pic x(102).
    76 01  WS-AM-KEY.
    77     05  WS-AM-COMPANY-CD        PIC X.
    78     05  WS-AM-CARRIER           PIC X.
    79     05  WS-AM-GROUP             PIC X(6).
    80     05  WS-AM-STATE             PIC XX.
    81     05  WS-AM-ACCOUNT           PIC X(10).
    82     05  WS-AM-EXP-DT            PIC XX.
    83     05  FILLER                  PIC X(4).
    84 01  WS-CO-KEY.
    85     05  WS-CO-COMPANY-CD        PIC X.
    86     05  WS-CO-CARRIER           PIC X.
    87     05  WS-CO-GROUP             PIC X(6).
    88     05  WS-CO-FIN-RESP          PIC X(10).
    89     05  WS-CO-ACCOUNT           PIC X(10).
    90     05  WS-CO-TYPE              PIC X.
    91 01  WS-CM-KEY.
    92     05  WS-CM-COMPANY-CD        PIC X.
    93     05  WS-CM-CARRIER           PIC X.
    94     05  WS-CM-GROUP             PIC X(6).
    95     05  WS-CM-STATE             PIC XX.
    96     05  WS-CM-ACCOUNT           PIC X(10).
    97     05  WS-CM-EFF-DT            PIC XX.
    98     05  WS-CM-CERT-NO           PIC X(11).
    99 01  WS-CZ-KEY.
   100     05  WS-CZ-COMPANY-CD        PIC X.
   101     05  WS-CZ-CARRIER           PIC X.
   102     05  WS-CZ-GROUP             PIC X(6).
   103     05  WS-CZ-STATE             PIC XX.
   104     05  WS-CZ-ACCOUNT           PIC X(10).
   105     05  WS-CZ-EFF-DT            PIC XX.
   106     05  WS-CZ-CERT-NO           PIC X(11).
   107     05  WS-CZ-REC-TYPE          PIC X.
   108     05  ws-cz-note-seq          pic s9(4) comp.
   109 01  WS-CS-KEY.
   110     05  WS-CS-COMPANY-CD        PIC X.
   111     05  WS-CS-CARRIER           PIC X.
   112     05  WS-CS-GROUP             PIC X(6).
   113     05  WS-CS-STATE             PIC XX.
   114     05  WS-CS-ACCOUNT           PIC X(10).
   115     05  WS-CS-EFF-DT            PIC XX.
   116     05  WS-CS-CERT-NO           PIC X(11).
   117     05  WS-CS-TRLR-TYPE         PIC X.
   118 01  ws-return-stuff.
   119     05  ws-am-name              pic x(30).
   120     05  ws-am-person            pic x(30).
   121     05  ws-am-control-name      pic x(30).
   122     05  ws-am-phone             pic x(10).
   123     05  ws-co-fax               pic x(10).
   124     05  ws-co-contact           pic x(30).
   125 01  WS-CID-NO                   PIC X(8).
   126 01  WS-DISP-RESP                PIC 9(5).
   127 01  WS-RESPONSE                 PIC S9(8)   COMP.
   128     88  RESP-NORMAL                  VALUE +00.
   129     88  RESP-NOTFND                  VALUE +13.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   4
* SOCK04BL.cbl
   130     88  RESP-NOTOPEN                 VALUE +19.
   131     88  RESP-ENDFILE                 VALUE +20.
   132*                                 COPY ELCCERT.
   133******************************************************************
   134*                                                                *
   135*                            ELCCERT.                            *
   136*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   137*                            VMOD=2.013                          *
   138*                                                                *
   139*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   140*                                                                *
   141*   FILE TYPE = VSAM,KSDS                                        *
   142*   RECORD SIZE = 450  RECFORM = FIXED                           *
   143*                                                                *
   144*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   145*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   146*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   147*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   148*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   149*                                                                *
   150*   LOG = YES                                                    *
   151*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   152******************************************************************
   153*                   C H A N G E   L O G
   154*
   155* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   156*-----------------------------------------------------------------
   157*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   158* EFFECTIVE    NUMBER
   159*-----------------------------------------------------------------
   160* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   161* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   162* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   163* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   164* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   165* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   166* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   167* 032612  CR2011110200001  PEMA  AHL CHANGES
   168* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   169* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   170******************************************************************
   171
   172 01  CERTIFICATE-MASTER.
   173     12  CM-RECORD-ID                      PIC XX.
   174         88  VALID-CM-ID                      VALUE 'CM'.
   175
   176     12  CM-CONTROL-PRIMARY.
   177         16  CM-COMPANY-CD                 PIC X.
   178         16  CM-CARRIER                    PIC X.
   179         16  CM-GROUPING.
   180             20  CM-GROUPING-PREFIX        PIC X(3).
   181             20  CM-GROUPING-PRIME         PIC X(3).
   182         16  CM-STATE                      PIC XX.
   183         16  CM-ACCOUNT.
   184             20  CM-ACCOUNT-PREFIX         PIC X(4).
   185             20  CM-ACCOUNT-PRIME          PIC X(6).
   186         16  CM-CERT-EFF-DT                PIC XX.
   187         16  CM-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   5
* SOCK04BL.cbl
   188             20  CM-CERT-PRIME             PIC X(10).
   189             20  CM-CERT-SFX               PIC X.
   190
   191     12  CM-CONTROL-BY-NAME.
   192         16  CM-COMPANY-CD-A1              PIC X.
   193         16  CM-INSURED-LAST-NAME          PIC X(15).
   194         16  CM-INSURED-INITIALS.
   195             20  CM-INSURED-INITIAL1       PIC X.
   196             20  CM-INSURED-INITIAL2       PIC X.
   197
   198     12  CM-CONTROL-BY-SSN.
   199         16  CM-COMPANY-CD-A2              PIC X.
   200         16  CM-SOC-SEC-NO.
   201             20  CM-SSN-STATE              PIC XX.
   202             20  CM-SSN-ACCOUNT            PIC X(6).
   203             20  CM-SSN-LN3.
   204                 25  CM-INSURED-INITIALS-A2.
   205                     30 CM-INSURED-INITIAL1-A2   PIC X.
   206                     30 CM-INSURED-INITIAL2-A2   PIC X.
   207                 25 CM-PART-LAST-NAME-A2         PIC X.
   208
   209     12  CM-CONTROL-BY-CERT-NO.
   210         16  CM-COMPANY-CD-A4              PIC X.
   211         16  CM-CERT-NO-A4                 PIC X(11).
   212
   213     12  CM-CONTROL-BY-MEMB.
   214         16  CM-COMPANY-CD-A5              PIC X.
   215         16  CM-MEMBER-NO.
   216             20  CM-MEMB-STATE             PIC XX.
   217             20  CM-MEMB-ACCOUNT           PIC X(6).
   218             20  CM-MEMB-LN4.
   219                 25  CM-INSURED-INITIALS-A5.
   220                     30 CM-INSURED-INITIAL1-A5   PIC X.
   221                     30 CM-INSURED-INITIAL2-A5   PIC X.
   222                 25 CM-PART-LAST-NAME-A5         PIC XX.
   223
   224     12  CM-INSURED-PROFILE-DATA.
   225         16  CM-INSURED-FIRST-NAME.
   226             20  CM-INSURED-1ST-INIT       PIC X.
   227             20  FILLER                    PIC X(9).
   228         16  CM-INSURED-ISSUE-AGE          PIC 99.
   229         16  CM-INSURED-SEX                PIC X.
   230             88  CM-SEX-MALE                  VALUE 'M'.
   231             88  CM-SEX-FEMAL                 VALUE 'F'.
   232         16  CM-INSURED-JOINT-AGE          PIC 99.
   233         16  CM-JOINT-INSURED-NAME.
   234             20  CM-JT-LAST-NAME           PIC X(15).
   235             20  CM-JT-FIRST-NAME.
   236                 24  CM-JT-1ST-INIT        PIC X.
   237                 24  FILLER                PIC X(9).
   238             20  CM-JT-INITIAL             PIC X.
   239
   240     12  CM-LIFE-DATA.
   241         16  CM-LF-BENEFIT-CD              PIC XX.
   242         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   243         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   244         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   245         16  CM-LF-DEV-CODE                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   6
* SOCK04BL.cbl
   246         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   247         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   248         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   249         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   250         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   251         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   252         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   253         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   254         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   255         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   256         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   257         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   258         16  cm-temp-epiq                  pic xx.
   259             88  EPIQ-CLASS                  value 'EQ'.
   260*        16  FILLER                        PIC XX.
   261
   262     12  CM-AH-DATA.
   263         16  CM-AH-BENEFIT-CD              PIC XX.
   264         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   265         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   266         16  CM-AH-DEV-CODE                PIC XXX.
   267         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   268         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   269         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   270         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   271         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   272         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   273         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   274         16  CM-AH-PAID-THRU-DT            PIC XX.
   275             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   276         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   277         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
   278         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   279         16  FILLER                        PIC X.
   280
   281     12  CM-LOAN-INFORMATION.
   282         16  CM-LIVES                      PIC S9(7)     COMP-3.
   283         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   284                                           PIC S9(5)V99  COMP-3.
   285         16  CM-BILLED                     PIC S9(7)     COMP-3.
   286         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   287         16  CM-PAY-FREQUENCY              PIC S99.
   288         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   289         16  CM-RATE-CLASS                 PIC XX.
   290         16  CM-BENEFICIARY                PIC X(25).
   291         16  CM-POLICY-FORM-NO             PIC X(12).
   292         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   293         16  CM-LAST-ADD-ON-DT             PIC XX.
   294         16  CM-DEDUCTIBLE-AMOUNTS.
   295             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   296             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   297         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   298             20  CM-RESIDENT-STATE         PIC XX.
   299             20  CM-RATE-CODE              PIC X(4).
   300             20  FILLER                    PIC XX.
   301         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   302             20  CM-LOAN-OFFICER           PIC X(5).
   303             20  FILLER                    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   7
* SOCK04BL.cbl
   304         16  CM-CSR-CODE                   PIC XXX.
   305         16  CM-UNDERWRITING-CODE          PIC X.
   306             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   307         16  CM-POST-CARD-IND              PIC X.
   308         16  CM-NH-INTERFACE-SW            PIC X.
   309         16  CM-PREMIUM-TYPE               PIC X.
   310             88  CM-SING-PRM                  VALUE '1'.
   311             88  CM-O-B-COVERAGE              VALUE '2'.
   312             88  CM-OPEN-END                  VALUE '3'.
   313         16  CM-IND-GRP-TYPE               PIC X.
   314             88  CM-INDIVIDUAL                VALUE 'I'.
   315             88  CM-GROUP                     VALUE 'G'.
   316         16  CM-SKIP-CODE                  PIC X.
   317             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   318             88  SKIP-JULY                    VALUE '1'.
   319             88  SKIP-AUGUST                  VALUE '2'.
   320             88  SKIP-SEPTEMBER               VALUE '3'.
   321             88  SKIP-JULY-AUG                VALUE '4'.
   322             88  SKIP-AUG-SEPT                VALUE '5'.
   323             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   324             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   325             88  SKIP-JUNE                    VALUE '8'.
   326             88  SKIP-JUNE-JULY               VALUE '9'.
   327             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   328             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   329         16  CM-PAYMENT-MODE               PIC X.
   330             88  PAY-MONTHLY                  VALUE SPACE.
   331             88  PAY-WEEKLY                   VALUE '1'.
   332             88  PAY-SEMI-MONTHLY             VALUE '2'.
   333             88  PAY-BI-WEEKLY                VALUE '3'.
   334             88  PAY-SEMI-ANUALLY             VALUE '4'.
   335         16  CM-LOAN-NUMBER                PIC X(8).
   336         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   337         16  CM-OLD-LOF                    PIC XXX.
   338*        16  CM-LOAN-OFFICER               PIC XXX.
   339         16  CM-REIN-TABLE                 PIC XXX.
   340         16  CM-SPECIAL-REIN-CODE          PIC X.
   341         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   342         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   343         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   344
   345     12  CM-STATUS-DATA.
   346         16  CM-ENTRY-STATUS               PIC X.
   347         16  CM-ENTRY-DT                   PIC XX.
   348
   349         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   350         16  CM-LF-CANCEL-DT               PIC XX.
   351         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   352
   353         16  CM-LF-STATUS-AT-DEATH         PIC X.
   354         16  CM-LF-DEATH-DT                PIC XX.
   355         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   356
   357         16  CM-LF-CURRENT-STATUS          PIC X.
   358             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   359                                                'M' '4' '5' '9'.
   360             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   361             88  CM-LF-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   8
* SOCK04BL.cbl
   362             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   363             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   364             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   365             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   366             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   367             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   368             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   369             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   370             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   371             88  CM-LF-DECLINED               VALUE 'D'.
   372             88  CM-LF-VOIDED                 VALUE 'V'.
   373
   374         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   375         16  CM-AH-CANCEL-DT               PIC XX.
   376         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   377
   378         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   379         16  CM-AH-SETTLEMENT-DT           PIC XX.
   380         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   381
   382         16  CM-AH-CURRENT-STATUS          PIC X.
   383             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   384                                                'M' '4' '5' '9'.
   385             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   386             88  CM-AH-POLICY-PENDING         VALUE '2'.
   387             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   388             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   389             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   390             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   391             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   392             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   393             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   394             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   395             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   396             88  CM-AH-DECLINED               VALUE 'D'.
   397             88  CM-AH-VOIDED                 VALUE 'V'.
   398
   399         16  CM-CLAIM-INTERFACE-SW         PIC X.
   400             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   401             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   402             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   403         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   404
   405         16  CM-ENTRY-BATCH                PIC X(6).
   406         16  CM-LF-EXIT-BATCH              PIC X(6).
   407         16  CM-AH-EXIT-BATCH              PIC X(6).
   408         16  CM-LAST-MONTH-END             PIC XX.
   409
   410     12  CM-NOTE-SW                        PIC X.
   411         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   412         88  CERT-NOTES-PRESENT               VALUE '1'.
   413         88  BILLING-NOTES-PRESENT            VALUE '2'.
   414         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   415         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   416         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   417         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   418         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   419     12  CM-COMP-EXCP-SW                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page   9
* SOCK04BL.cbl
   420         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   421         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   422     12  CM-INSURED-ADDRESS-SW             PIC X.
   423         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   424         88  INSURED-ADDR-PRESENT             VALUE '1'.
   425
   426*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   427     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   428     12  FILLER                            PIC X.
   429
   430*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   431     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   432     12  FILLER                            PIC X.
   433*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   434     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
   435
   436     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   437         88  CERT-ADDED-BATCH                 VALUE ' '.
   438         88  CERT-ADDED-ONLINE                VALUE '1'.
   439         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   440         88  CERT-PURGED-OFFLINE              VALUE '3'.
   441         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   442     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   443         88  CERT-AS-LOADED                   VALUE ' '.
   444         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   445         88  CERT-CLAIM-ONLINE                VALUE '2'.
   446         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   447         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   448         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   449         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   450         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   451
   452     12  CM-ACCOUNT-COMM-PCTS.
   453         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   454         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   455
   456     12  CM-USER-FIELD                     PIC X.
   457     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   458     12  CM-CLP-STATE                      PIC XX.
   459     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   460     12  CM-USER-RESERVED                  PIC XXX.
   461     12  FILLER REDEFINES CM-USER-RESERVED.
   462         16  CM-AH-CLASS-CD                PIC XX.
   463         16  F                             PIC X.
   464******************************************************************
   465*                                 COPY ELCCRTT.
   466******************************************************************
   467*                                                                *
   468*                            ELCCRTT.                            *
   469*                                                                *
   470*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
   471*                                                                *
   472*   FILE TYPE = VSAM,KSDS                                        *
   473*   RECORD SIZE = 552  RECFORM = FIXED                           *
   474*                                                                *
   475*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
   476*                                                                *
   477*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  10
* SOCK04BL.cbl
   478*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   479******************************************************************
   480*                   C H A N G E   L O G
   481*
   482* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   483*-----------------------------------------------------------------
   484*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   485* EFFECTIVE    NUMBER
   486*-----------------------------------------------------------------
   487* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
   488* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
   489* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   490* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   491* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
   492* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   493* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   494* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
   495* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   496******************************************************************
   497
   498 01  CERTIFICATE-TRAILERS.
   499     12  CS-RECORD-ID                      PIC XX.
   500         88  VALID-CS-ID                      VALUE 'CS'.
   501
   502     12  CS-CONTROL-PRIMARY.
   503         16  CS-COMPANY-CD                 PIC X.
   504         16  CS-CARRIER                    PIC X.
   505         16  CS-GROUPING                   PIC X(6).
   506         16  CS-STATE                      PIC XX.
   507         16  CS-ACCOUNT                    PIC X(10).
   508         16  CS-CERT-EFF-DT                PIC XX.
   509         16  CS-CERT-NO.
   510             20  CS-CERT-PRIME             PIC X(10).
   511             20  CS-CERT-SFX               PIC X.
   512         16  CS-TRAILER-TYPE               PIC X.
   513             88  COMM-TRLR           VALUE 'A'.
   514             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
   515             88  CERT-DATA-TRLR      VALUE 'C'.
   516
   517     12  CS-DATA-AREA                      PIC X(516).
   518
   519     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
   520         16  CS-BANK-COMMISSION-AREA.
   521             20  CS-BANK-COMMS       OCCURS 10.
   522                 24  CS-AGT                PIC X(10).
   523                 24  CS-COM-TYP            PIC X.
   524                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
   525                 24  CS-RECALC-LV-INDIC    PIC X.
   526                 24  FILLER                PIC X(10).
   527         16  FILLER                        PIC X(256).
   528
   529     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
   530****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
   531         16  CS-MB-CLAIM-DATA OCCURS 24.
   532             20  CS-CLAIM-NO               PIC X(7).
   533             20  CS-CLAIM-TYPE             PIC X.
   534                 88  CS-AH-CLM               VALUE 'A'.
   535                 88  CS-IU-CLM               VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  11
* SOCK04BL.cbl
   536                 88  CS-GP-CLM               VALUE 'G'.
   537                 88  CS-LF-CLM               VALUE 'L'.
   538                 88  CS-PR-CLM               VALUE 'P'.
   539                 88  CS-FL-CLM               VALUE 'F'.
   540             20  CS-INSURED-TYPE           PIC X.
   541                 88  CS-PRIM-INSURED          VALUE 'P'.
   542                 88  CS-CO-BORROWER           VALUE 'C'.
   543             20  CS-BENEFIT-PERIOD         PIC 99.
   544             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
   545             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
   546             20  CS-REMAINING-BENS         PIC S999 COMP-3.
   547         16  FILLER                        PIC X(12).
   548     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
   549         16  CS-VIN-NUMBER                 PIC X(17).
   550         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
   551         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
   552         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
   553         16  cs-agent-name.
   554             20  cs-agent-fname            pic x(20).
   555             20  cs-agent-mi               pic x.
   556             20  cs-agent-lname            pic x(25).
   557         16  cs-license-no                 pic x(15).
   558         16  cs-npn-number                 pic x(10).
   559         16  cs-agent-edit-status          pic x.
   560             88  cs-ae-refer-to-manager      value 'M'.
   561             88  cs-ae-cover-sheet           value 'C'.
   562             88  cs-ae-sig-form              value 'S'.
   563             88  cs-ae-verified              value 'V'.
   564             88  cs-unidentified-signature   value 'U'.
   565             88  cs-cert-returned            value 'R'.
   566             88  cs-accept-no-commission     value 'N'.
   567         16  cs-year                       pic 9999.
   568         16  cs-make                       pic x(20).
   569         16  cs-model                      pic x(20).
   570         16  cs-future                     pic x(20).
   571         16  cs-vehicle-odometer           pic s9(7) comp-3.
   572         16  FILLER                        PIC X(356). *> was 420
   573*        16  FILLER                        PIC X(496).
   574*                                 COPY ERCACCT.
   575******************************************************************
   576*                                                                *
   577*                                                                *
   578*                            ERCACCT                             *
   579*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   580*                            VMOD=2.031                          *
   581*                                                                *
   582*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   583*                                                                *
   584*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   585*   VSAM ACCOUNT MASTER FILES.                                   *
   586*                                                                *
   587*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   588*                                                                *
   589*   FILE TYPE = VSAM,KSDS                                        *
   590*   RECORD SIZE = 2000  RECFORM = FIX                            *
   591*                                                                *
   592*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   593*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  12
* SOCK04BL.cbl
   594*                                                                *
   595*   LOG = NO                                                     *
   596*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   597*                                                                *
   598*                                                                *
   599******************************************************************
   600*                   C H A N G E   L O G
   601*
   602* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   603*-----------------------------------------------------------------
   604*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   605* EFFECTIVE    NUMBER
   606*-----------------------------------------------------------------
   607* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   608* 092705    2005050300006  PEMA  ADD SPP LEASES
   609* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   610* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   611* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   612* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   613* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   614******************************************************************
   615
   616 01  ACCOUNT-MASTER.
   617     12  AM-RECORD-ID                      PIC XX.
   618         88  VALID-AM-ID                      VALUE 'AM'.
   619
   620     12  AM-CONTROL-PRIMARY.
   621         16  AM-COMPANY-CD                 PIC X.
   622         16  AM-MSTR-CNTRL.
   623             20  AM-CONTROL-A.
   624                 24  AM-CARRIER            PIC X.
   625                 24  AM-GROUPING.
   626                     28 AM-GROUPING-PREFIX PIC XXX.
   627                     28 AM-GROUPING-PRIME  PIC XXX.
   628                 24  AM-STATE              PIC XX.
   629                 24  AM-ACCOUNT.
   630                     28  AM-ACCOUNT-PREFIX PIC X(4).
   631                     28  AM-ACCOUNT-PRIME  PIC X(6).
   632             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   633                                           PIC X(19).
   634             20  AM-CNTRL-B.
   635                 24  AM-EXPIRATION-DT      PIC XX.
   636                 24  FILLER                PIC X(4).
   637             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   638                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   639
   640     12  AM-CONTROL-BY-VAR-GRP.
   641         16  AM-COMPANY-CD-A1              PIC X.
   642         16  AM-VG-CARRIER                 PIC X.
   643         16  AM-VG-GROUPING                PIC X(6).
   644         16  AM-VG-STATE                   PIC XX.
   645         16  AM-VG-ACCOUNT                 PIC X(10).
   646         16  AM-VG-DATE.
   647             20  AM-VG-EXPIRATION-DT       PIC XX.
   648             20  FILLER                    PIC X(4).
   649         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   650                                           PIC 9(11)      COMP-3.
   651     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  13
* SOCK04BL.cbl
   652         16  FILLER                        PIC X(10).
   653         16  AM-VG-KEY3.
   654             20  AM-VG3-ACCOUNT            PIC X(10).
   655             20  AM-VG3-EXP-DT             PIC XX.
   656         16  FILLER                        PIC X(4).
   657     12  AM-MAINT-INFORMATION.
   658         16  AM-LAST-MAINT-DT              PIC XX.
   659         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   660         16  AM-LAST-MAINT-USER            PIC X(4).
   661         16  FILLER                        PIC XX.
   662
   663     12  AM-EFFECTIVE-DT                   PIC XX.
   664     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   665
   666     12  AM-PREV-DATES  COMP-3.
   667         16  AM-PREV-EXP-DT                PIC 9(11).
   668         16  AM-PREV-EFF-DT                PIC 9(11).
   669
   670     12  AM-REPORT-CODE-1                  PIC X(10).
   671     12  AM-REPORT-CODE-2                  PIC X(10).
   672
   673     12  AM-CITY-CODE                      PIC X(4).
   674     12  AM-COUNTY-PARISH                  PIC X(6).
   675
   676     12  AM-NAME                           PIC X(30).
   677     12  AM-PERSON                         PIC X(30).
   678     12  AM-ADDRS                          PIC X(30).
   679     12  AM-CITY.
   680         16  AM-ADDR-CITY                  PIC X(28).
   681         16  AM-ADDR-STATE                 PIC XX.
   682     12  AM-ZIP.
   683         16  AM-ZIP-PRIME.
   684             20  AM-ZIP-PRI-1ST            PIC X.
   685                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   686             20  FILLER                    PIC X(4).
   687         16  AM-ZIP-PLUS4                  PIC X(4).
   688     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   689         16  AM-CAN-POSTAL-1               PIC XXX.
   690         16  AM-CAN-POSTAL-2               PIC XXX.
   691         16  FILLER                        PIC XXX.
   692     12  AM-TEL-NO.
   693         16  AM-AREA-CODE                  PIC 999.
   694         16  AM-TEL-PRE                    PIC 999.
   695         16  AM-TEL-NBR                    PIC 9(4).
   696     12  AM-TEL-LOC                        PIC X.
   697         88  AM-TEL-AT-HOME                   VALUE 'H'.
   698         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   699
   700     12  AM-COMM-STRUCTURE.
   701         16  AM-DEFN-1.
   702             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   703                 24  AM-AGT.
   704                     28  AM-AGT-PREFIX     PIC X(4).
   705                     28  AM-AGT-PRIME      PIC X(6).
   706                 24  AM-COM-TYP            PIC X.
   707                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   708                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   709                 24  AM-A-COM              PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  14
* SOCK04BL.cbl
   710                 24  AM-RECALC-LV-INDIC    PIC X.
   711                 24  AM-RETRO-LV-INDIC     PIC X.
   712                 24  AM-GL-CODES           PIC X.
   713                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   714                 24  FILLER                PIC X(01).
   715         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   716             20  AM-COM-TBLS        OCCURS 10 TIMES.
   717                 24  FILLER                PIC X(11).
   718                 24  AM-L-COMA             PIC XXX.
   719                 24  AM-J-COMA             PIC XXX.
   720                 24  AM-A-COMA             PIC XXX.
   721                 24  FILLER                PIC X(6).
   722
   723     12  AM-COMM-CHANGE-STATUS             PIC X.
   724         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   725
   726     12  AM-CSR-CODE                       PIC X(4).
   727
   728     12  AM-BILLING-STATUS                 PIC X.
   729         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   730         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   731     12  AM-AUTO-REFUND-SW                 PIC X.
   732         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   733         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   734     12  AM-GPCD                           PIC 99.
   735     12  AM-IG                             PIC X.
   736         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   737         88  AM-HAS-GROUP                     VALUE '2'.
   738     12  AM-STATUS                         PIC X.
   739         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   740         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   741         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   742         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   743         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   744         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   745     12  AM-REMIT-TO                       PIC 99.
   746     12  AM-ID-NO                          PIC X(11).
   747
   748     12  AM-CAL-TABLE                      PIC XX.
   749     12  AM-LF-DEVIATION                   PIC XXX.
   750     12  AM-AH-DEVIATION                   PIC XXX.
   751     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   752     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   753     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   754     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   755     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   756     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   757
   758     12  AM-USER-FIELDS.
   759         16  AM-FLD-1                      PIC XX.
   760         16  AM-FLD-2                      PIC XX.
   761         16  AM-FLD-3                      PIC XX.
   762         16  AM-FLD-4                      PIC XX.
   763         16  AM-FLD-5                      PIC XX.
   764
   765     12  AM-1ST-PROD-DATE.
   766         16  AM-1ST-PROD-YR                PIC XX.
   767         16  AM-1ST-PROD-MO                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  15
* SOCK04BL.cbl
   768         16  AM-1ST-PROD-DA                PIC XX.
   769     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   770     12  AM-CERTS-PURGED-DATE.
   771         16  AM-PUR-YR                     PIC XX.
   772         16  AM-PUR-MO                     PIC XX.
   773         16  AM-PUR-DA                     PIC XX.
   774     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   775     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   776     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   777     12  AM-INACTIVE-DATE.
   778         16  AM-INA-MO                     PIC 99.
   779         16  AM-INA-DA                     PIC 99.
   780         16  AM-INA-YR                     PIC 99.
   781     12  AM-AR-HI-CERT-DATE                PIC XX.
   782
   783     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   784     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   785
   786     12  AM-OB-PAYMENT-MODE                PIC X.
   787         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   788         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   789         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   790         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   791
   792     12  AM-AH-ONLY-INDICATOR              PIC X.
   793         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   794         88  AM-NO-AH-ONLY                    VALUE 'N'.
   795
   796     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   797
   798     12  AM-OVER-SHORT.
   799         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   800         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   801
   802     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   803     12  AM-DCC-CLP-STATE                  PIC XX.
   804
   805     12  AM-RECALC-COMM                    PIC X.
   806     12  AM-RECALC-REIN                    PIC X.
   807
   808     12  AM-REI-TABLE                      PIC XXX.
   809     12  AM-REI-ET-LF                      PIC X.
   810     12  AM-REI-ET-AH                      PIC X.
   811     12  AM-REI-PE-LF                      PIC X.
   812     12  AM-REI-PE-AH                      PIC X.
   813     12  AM-REI-PRT-ST                     PIC X.
   814     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   815     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   816     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   817     12  AM-REI-GROUP-A                    PIC X(6).
   818     12  AM-REI-MORT                       PIC X(4).
   819     12  AM-REI-PRT-OW                     PIC X.
   820     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   821     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   822     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   823     12  AM-REI-GROUP-B                    PIC X(6).
   824
   825     12  AM-TRUST-TYPE                     PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  16
* SOCK04BL.cbl
   826
   827     12  AM-EMPLOYER-STMT-USED             PIC X.
   828     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   829
   830     12  AM-STD-AH-TYPE                    PIC XX.
   831     12  AM-EARN-METHODS.
   832         16  AM-EARN-METHOD-R              PIC X.
   833             88 AM-REF-RL-R78                 VALUE 'R'.
   834             88 AM-REF-RL-PR                  VALUE 'P'.
   835             88 AM-REF-RL-MEAN                VALUE 'M'.
   836             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   837         16  AM-EARN-METHOD-L              PIC X.
   838             88 AM-REF-LL-R78                 VALUE 'R'.
   839             88 AM-REF-LL-PR                  VALUE 'P'.
   840             88 AM-REF-LL-MEAN                VALUE 'M'.
   841             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   842         16  AM-EARN-METHOD-A              PIC X.
   843             88 AM-REF-AH-R78                 VALUE 'R'.
   844             88 AM-REF-AH-PR                  VALUE 'P'.
   845             88 AM-REF-AH-MEAN                VALUE 'M'.
   846             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   847             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   848             88 AM-REF-AH-NET                 VALUE 'N'.
   849
   850     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   851     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   852     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   853
   854     12  AM-RET-Y-N                        PIC X.
   855     12  AM-RET-P-E                        PIC X.
   856     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   857     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   858     12  AM-RET-GRP                        PIC X(6).
   859     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   860         16  AM-POOL-PRIME                 PIC XXX.
   861         16  AM-POOL-SUB                   PIC XXX.
   862     12  AM-RETRO-EARNINGS.
   863         16  AM-RET-EARN-R                 PIC X.
   864         16  AM-RET-EARN-L                 PIC X.
   865         16  AM-RET-EARN-A                 PIC X.
   866     12  AM-RET-ST-TAX-USE                 PIC X.
   867         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   868         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   869     12  AM-RETRO-BEG-EARNINGS.
   870         16  AM-RET-BEG-EARN-R             PIC X.
   871         16  AM-RET-BEG-EARN-L             PIC X.
   872         16  AM-RET-BEG-EARN-A             PIC X.
   873     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   874     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   875
   876     12  AM-USER-SELECT-OPTIONS.
   877         16  AM-USER-SELECT-1              PIC X(10).
   878         16  AM-USER-SELECT-2              PIC X(10).
   879         16  AM-USER-SELECT-3              PIC X(10).
   880         16  AM-USER-SELECT-4              PIC X(10).
   881         16  AM-USER-SELECT-5              PIC X(10).
   882
   883     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  17
* SOCK04BL.cbl
   884
   885     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   886
   887     12  AM-RPT045A-SWITCH                 PIC X.
   888         88  RPT045A-OFF                   VALUE 'N'.
   889
   890     12  AM-INSURANCE-LIMITS.
   891         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   892         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   893
   894     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   895         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   896
   897     12  AM-DISMBR-COVERAGE-SW             PIC X.
   898         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   899         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   900
   901     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   902
   903     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   904     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   905     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   906     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   907     12  AM-DCC-UEF-STATE                  PIC XX.
   908     12  FILLER                            PIC XXX.
   909     12  AM-REPORT-CODE-3                  PIC X(10).
   910*    12  FILLER                            PIC X(22).
   911
   912     12  AM-RESERVE-DATE.
   913         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   914         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   915         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   916
   917     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   918     12  AM-NOTIFICATION-TYPES.
   919         16  AM-NOTIF-OF-LETTERS           PIC X.
   920         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   921         16  AM-NOTIF-OF-REPORTS           PIC X.
   922         16  AM-NOTIF-OF-STATUS            PIC X.
   923
   924     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   925         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   926         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   927         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   928         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   929
   930     12  AM-BENEFIT-CONTROLS.
   931         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   932             20  AM-BENEFIT-CODE           PIC XX.
   933             20  AM-BENEFIT-TYPE           PIC X.
   934             20  AM-BENEFIT-REVISION       PIC XXX.
   935             20  AM-BENEFIT-REM-TERM       PIC X.
   936             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   937             20  FILLER                    PIC XX.
   938         16  FILLER                        PIC X(80).
   939
   940     12  AM-TRANSFER-DATA.
   941         16  AM-TRANSFERRED-FROM.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  18
* SOCK04BL.cbl
   942             20  AM-TRNFROM-CARRIER        PIC X.
   943             20  AM-TRNFROM-GROUPING.
   944                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   945                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   946             20  AM-TRNFROM-STATE          PIC XX.
   947             20  AM-TRNFROM-ACCOUNT.
   948                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   949                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   950             20  AM-TRNFROM-DTE            PIC XX.
   951         16  AM-TRANSFERRED-TO.
   952             20  AM-TRNTO-CARRIER          PIC X.
   953             20  AM-TRNTO-GROUPING.
   954                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   955                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   956             20  AM-TRNTO-STATE            PIC XX.
   957             20  AM-TRNTO-ACCOUNT.
   958                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   959                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   960             20  AM-TRNTO-DTE              PIC XX.
   961         16  FILLER                        PIC X(10).
   962
   963     12  AM-SAVED-REMIT-TO                 PIC 99.
   964
   965     12  AM-COMM-STRUCTURE-SAVED.
   966         16  AM-DEFN-1-SAVED.
   967             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   968                 24  AM-AGT-SV             PIC X(10).
   969                 24  AM-COM-TYP-SV         PIC X.
   970                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
   971                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
   972                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
   973                 24  AM-RECALC-LV-INDIC-SV PIC X.
   974                 24  FILLER                PIC X.
   975                 24  AM-GL-CODES-SV        PIC X.
   976                 24  AM-COM-CHARGEBACK-SV  PIC 99.
   977                 24  FILLER                PIC X.
   978         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
   979             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
   980                 24  FILLER                PIC X(11).
   981                 24  AM-L-COMA-SV          PIC XXX.
   982                 24  AM-J-COMA-SV          PIC XXX.
   983                 24  AM-A-COMA-SV          PIC XXX.
   984                 24  FILLER                PIC X(6).
   985
   986     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
   987         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
   988            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
   989            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
   990            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
   991
   992     12  AM-ORIG-DEALER-NO                 PIC X(10).
   993     12  FILLER                            PIC X(120).
   994
   995     12  AM-ACCOUNT-EXECUTIVE-DATA.
   996         16  AM-CONTROL-NAME               PIC X(30).
   997         16  AM-EXECUTIVE-ONE.
   998             20  AM-EXEC1-NAME             PIC X(15).
   999             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  19
* SOCK04BL.cbl
  1000                                                          COMP-3.
  1001             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1002                                                          COMP-3.
  1003         16  AM-EXECUTIVE-TWO.
  1004             20  AM-EXEC2-NAME             PIC X(15).
  1005             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1006                                                          COMP-3.
  1007             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1008                                                          COMP-3.
  1009
  1010     12  AM-RETRO-ADDITIONAL-DATA.
  1011         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1012         16  AM-RETRO-PREM-P-E             PIC X.
  1013         16  AM-RETRO-CLMS-P-I             PIC X.
  1014         16  AM-RETRO-RET-BRACKET-LF.
  1015             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1016                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1017                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1018             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1019                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1020                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1021             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1022                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1023                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1024         16  AM-RETRO-RET-BRACKET-AH.
  1025             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1026                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1027                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1028                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1029             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1030                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1031                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1032             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1033                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1034                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1035
  1036     12  AM-COMMENTS.
  1037         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1038
  1039     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1040         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1041         16  AM-FLI-BILLING-CODE           PIC X.
  1042         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1043         16  AM-FLI-UNITED-IDENT           PIC X.
  1044         16  AM-FLI-INTEREST-LOST-DATA.
  1045             20  AM-FLI-BANK-NO            PIC X(5).
  1046             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1047             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1048             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1049         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1050             20  AM-FLI-AGT                PIC X(9).
  1051             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1052             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1053         16  FILLER                        PIC X(102).
  1054
  1055     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1056         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1057             20  AM-BENEFIT-DMD-CODE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  20
* SOCK04BL.cbl
  1058             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1059             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1060             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1061             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1062         16  FILLER                          PIC X(10).
  1063******************************************************************
  1064*                                 COPY ERCCOMP.
  1065******************************************************************
  1066*                                                                *
  1067*                                                                *
  1068*                            ERCCOMP                             *
  1069*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1070*                            VMOD=2.019                          *
  1071*                                                                *
  1072*   ONLINE CREDIT SYSTEM                                         *
  1073*                                                                *
  1074*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1075*                                                                *
  1076*   FILE TYPE = VSAM,KSDS                                        *
  1077*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1078*                                                                *
  1079*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1080*       ALTERNATE PATH = NONE                                    *
  1081*                                                                *
  1082*   LOG = NO                                                     *
  1083*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1084*                                                                *
  1085******************************************************************
  1086*                   C H A N G E   L O G
  1087*
  1088* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1089*-----------------------------------------------------------------
  1090*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1091* EFFECTIVE    NUMBER
  1092*-----------------------------------------------------------------
  1093* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1094* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1095* 092205    2005050300006  PEMA  ADD LEASE FEE
  1096* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1097* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1098* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1099* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1100* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1101* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1102******************************************************************
  1103
  1104 01  COMPENSATION-MASTER.
  1105     12  CO-RECORD-ID                          PIC XX.
  1106         88  VALID-CO-ID                          VALUE 'CO'.
  1107
  1108     12  CO-CONTROL-PRIMARY.
  1109         16  CO-COMPANY-CD                     PIC X.
  1110         16  CO-CONTROL.
  1111             20  CO-CTL-1.
  1112                 24  CO-CARR-GROUP.
  1113                     28  CO-CARRIER            PIC X.
  1114                     28  CO-GROUPING.
  1115                         32  CO-GROUP-PREFIX   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  21
* SOCK04BL.cbl
  1116                         32  CO-GROUP-PRIME    PIC XXX.
  1117                 24  CO-RESP-NO.
  1118                     28  CO-RESP-PREFIX        PIC X(4).
  1119                     28  CO-RESP-PRIME         PIC X(6).
  1120             20  CO-CTL-2.
  1121                 24  CO-ACCOUNT.
  1122                     28  CO-ACCT-PREFIX        PIC X(4).
  1123                     28  CO-ACCT-PRIME         PIC X(6).
  1124         16  CO-TYPE                           PIC X.
  1125             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1126             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1127             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1128
  1129     12  CO-MAINT-INFORMATION.
  1130         16  CO-LAST-MAINT-DT                  PIC XX.
  1131         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1132         16  CO-LAST-MAINT-USER                PIC X(4).
  1133     12  FILLER                                PIC XX.
  1134     12  CO-STMT-TYPE                          PIC XXX.
  1135     12  CO-COMP-TYPE                          PIC X.
  1136         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1137     12  CO-STMT-OWNER                         PIC X(4).
  1138     12  CO-BALANCE-CONTROL                    PIC X.
  1139         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1140         88  CO-NO-BALANCE                        VALUE 'N'.
  1141
  1142     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1143         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1144         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1145         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1146
  1147     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1148         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1149         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1150
  1151     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1152     12  CO-GA-DIRECT-DEP                      PIC X.
  1153     12  CO-FUTURE-SPACE                       PIC X.
  1154         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1155
  1156     12  CO-ACCT-NAME                          PIC X(30).
  1157     12  CO-MAIL-NAME                          PIC X(30).
  1158     12  CO-ADDR-1                             PIC X(30).
  1159     12  CO-ADDR-2                             PIC X(30).
  1160     12  CO-ADDR-3.
  1161         16  CO-ADDR-CITY                      PIC X(27).
  1162         16  CO-ADDR-STATE                     PIC XX.
  1163     12  CO-CSO-1099                           PIC X.
  1164     12  CO-ZIP.
  1165         16  CO-ZIP-PRIME.
  1166             20  CO-ZIP-PRI-1ST                PIC X.
  1167                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1168             20  FILLER                        PIC X(4).
  1169         16  CO-ZIP-PLUS4                      PIC X(4).
  1170     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1171         16  CO-CAN-POSTAL-1                   PIC XXX.
  1172         16  CO-CAN-POSTAL-2                   PIC XXX.
  1173         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  22
* SOCK04BL.cbl
  1174     12  CO-SOC-SEC                            PIC X(13).
  1175     12  CO-TELEPHONE.
  1176         16  CO-AREA-CODE                      PIC XXX.
  1177         16  CO-PREFIX                         PIC XXX.
  1178         16  CO-PHONE                          PIC X(4).
  1179
  1180     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1181
  1182     12  CO-AR-BAL-LEVEL                       PIC X.
  1183         88  CO-AR-REF-LVL                        VALUE '1'.
  1184         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1185         88  CO-AR-BILL-LVL                       VALUE '2'.
  1186         88  CO-AR-AGT-LVL                        VALUE '3'.
  1187         88  CO-AR-FR-LVL                         VALUE '4'.
  1188
  1189     12  CO-AR-NORMAL-PRINT                    PIC X.
  1190         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1191         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1192
  1193     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1194
  1195     12  CO-AR-REPORTING                       PIC X.
  1196         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1197         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1198
  1199     12  CO-AR-PULL-CHECK                      PIC X.
  1200         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1201         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1202
  1203     12  CO-AR-BALANCE-PRINT                   PIC X.
  1204         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1205
  1206     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1207         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1208         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1209         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1210
  1211     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1212
  1213     12  CO-USER-CODE                          PIC X.
  1214     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1215
  1216******************************************************************
  1217*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1218*    THE LAST MONTH END RUN.
  1219******************************************************************
  1220
  1221     12  CO-LAST-ACTIVITY-DATE.
  1222         16  CO-ACT-YEAR                       PIC 99.
  1223         16  CO-ACT-MONTH                      PIC 99.
  1224         16  CO-ACT-DAY                        PIC 99.
  1225
  1226     12  CO-LAST-STMT-DT.
  1227         16  CO-LAST-STMT-YEAR                 PIC 99.
  1228         16  CO-LAST-STMT-MONTH                PIC 99.
  1229         16  CO-LAST-STMT-DAY                  PIC 99.
  1230
  1231     12  CO-MO-END-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  23
* SOCK04BL.cbl
  1232         16  CO-MONTHLY-TOTALS.
  1233             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1234             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1235             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1236             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1237             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1238
  1239         16  CO-AGING-TOTALS.
  1240             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1241             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1242             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1243             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1244
  1245         16  CO-YTD-TOTALS.
  1246             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1247             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1248
  1249         16  CO-OVER-UNDER-TOTALS.
  1250             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1251             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1252
  1253     12  CO-MISCELLANEOUS-TOTALS.
  1254         16  CO-FICA-TOTALS.
  1255             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1256             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1257
  1258         16  CO-CLAIM-TOTALS.
  1259             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1260             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1261
  1262******************************************************************
  1263*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1264*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1265******************************************************************
  1266
  1267     12  CO-CURRENT-TOTALS.
  1268         16  CO-CURRENT-LAST-STMT-DT.
  1269             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1270             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1271             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1272
  1273         16  CO-CURRENT-MONTHLY-TOTALS.
  1274             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1275             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1276             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1277             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1278             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1279
  1280         16  CO-CURRENT-AGING-TOTALS.
  1281             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1282             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1283             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1284             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1285
  1286         16  CO-CURRENT-YTD-TOTALS.
  1287             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1288             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1289
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  24
* SOCK04BL.cbl
  1290     12  CO-PAID-COMM-TOTALS.
  1291         16  CO-YTD-PAID-COMMS.
  1292             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1293             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1294
  1295     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1296         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1297         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1298
  1299     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1300         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1301         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1302         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1303         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1304         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1305         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1306         88  CO-FINAL-LETTER                  VALUE 'F'.
  1307         88  CO-RECONCILING                   VALUE 'R'.
  1308         88  CO-PHONE-CALL                    VALUE 'P'.
  1309         88  CO-LEGAL                         VALUE 'L'.
  1310         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1311         88  CO-WRITE-OFF                     VALUE 'W'.
  1312         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1313
  1314     12  CO-CSR-CODE                       PIC X(4).
  1315
  1316     12  CO-GA-STATUS-INFO.
  1317         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1318         16  CO-GA-TERMINATION-DT          PIC XX.
  1319         16  CO-GA-STATUS-CODE             PIC X.
  1320             88  CO-GA-ACTIVE                 VALUE 'A'.
  1321             88  CO-GA-INACTIVE               VALUE 'I'.
  1322             88  CO-GA-PENDING                VALUE 'P'.
  1323         16  CO-GA-COMMENTS.
  1324             20  CO-GA-COMMENT-1           PIC X(40).
  1325             20  CO-GA-COMMENT-2           PIC X(40).
  1326             20  CO-GA-COMMENT-3           PIC X(40).
  1327             20  CO-GA-COMMENT-4           PIC X(40).
  1328
  1329     12  CO-RPTCD2                         PIC X(10).
  1330     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1331         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1332         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1333
  1334     12  CO-TYPE-AGENT                     PIC X(01).
  1335         88  CO-CORPORATION                   VALUE 'C'.
  1336         88  CO-PARTNERSHIP                   VALUE 'P'.
  1337         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1338         88  CO-TRUST                         VALUE 'T'.
  1339         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1340
  1341     12  CO-FAXNO.
  1342         16  CO-FAX-AREA-CODE                  PIC XXX.
  1343         16  CO-FAX-PREFIX                     PIC XXX.
  1344         16  CO-FAX-PHONE                      PIC X(4).
  1345
  1346     12  CO-BANK-INFORMATION.
  1347         16  CO-BANK-TRANSIT-NO                PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  25
* SOCK04BL.cbl
  1348         16  CO-BANK-TRANSIT-NON REDEFINES
  1349             CO-BANK-TRANSIT-NO                PIC 9(8).
  1350
  1351         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1352     12  CO-MISC-DEDUCT-INFO REDEFINES
  1353                  CO-BANK-INFORMATION.
  1354         16  CO-MD-GL-ACCT                     PIC X(10).
  1355         16  CO-MD-DIV                         PIC XX.
  1356         16  CO-MD-CENTER                      PIC X(4).
  1357         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1358         16  CO-CREATE-AP-CHECK                PIC X.
  1359         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1360         16  FILLER                            PIC XXX.
  1361     12  CO-ACH-STATUS                         PIC X.
  1362         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1363         88  CO-ACH-PENDING                        VALUE 'P'.
  1364
  1365     12  CO-BILL-SW                            PIC X.
  1366     12  CO-CONTROL-NAME                       PIC X(30).
  1367     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1368     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1369     12  CO-CLP-STATE                          PIC XX.
  1370     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1371     12  CO-SPP-REFUND-EDIT                    PIC X.
  1372
  1373******************************************************************
  1374*                                 COPY ERCCNOT.
  1375******************************************************************
  1376*                                                                *
  1377*                            ERCCNOT                             *
  1378*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1379*                            VMOD=2.003                          *
  1380*                                                                *
  1381*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1382*                                                                *
  1383*        FILE TYPE= VSAM,KSDS                                    *
  1384*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1385*                                                                *
  1386*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1387*                                                                *
  1388*        LOG = YES                                               *
  1389*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1390*                                                                *
  1391******************************************************************
  1392*                   C H A N G E   L O G
  1393*
  1394* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1395*-----------------------------------------------------------------
  1396*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1397* EFFECTIVE    NUMBER
  1398*-----------------------------------------------------------------
  1399* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1400******************************************************************
  1401
  1402 01  CERT-NOTE-FILE.
  1403     12  CZ-RECORD-ID                PIC  XX.
  1404         88  VALID-CZ-ID                  VALUE 'CZ'.
  1405
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  26
* SOCK04BL.cbl
  1406     12  CZ-CONTROL-PRIMARY.
  1407         16  CZ-COMPANY-CD           PIC X.
  1408         16  CZ-CARRIER              PIC X.
  1409         16  CZ-GROUPING.
  1410             20 CZ-GROUPING-PREFIX   PIC XXX.
  1411             20 CZ-GROUPING-PRIME    PIC XXX.
  1412         16  CZ-STATE                PIC XX.
  1413         16  CZ-ACCOUNT.
  1414             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1415             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1416         16  CZ-CERT-EFF-DT          PIC XX.
  1417         16  CZ-CERT-NO.
  1418             20  CZ-CERT-PRIME       PIC X(10).
  1419             20  CZ-CERT-SFX         PIC X.
  1420         16  CZ-RECORD-TYPE          PIC X.
  1421             88  CERT-NOTE           VALUE '1'.
  1422             88  CLAIM-CERT-NOTE     VALUE '2'.
  1423         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1424
  1425     12  CZ-LAST-MAINT-DT            PIC XX.
  1426     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1427     12  CZ-LAST-MAINT-USER          PIC X(4).
  1428
  1429     12  CZ-NOTE-INFORMATION.
  1430         16  CZ-NOTE                 PIC X(63).
  1431         16  FILLER                  PIC X(39).
  1432******************************************************************
  1433*                                 COPY ELCDATE.
  1434******************************************************************
  1435*                                                                *
  1436*                                                                *
  1437*                            ELCDATE.                            *
  1438*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1439*                            VMOD=2.003
  1440*                                                                *
  1441*                                                                *
  1442*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1443*                 LENGTH = 200                                   *
  1444******************************************************************
  1445
  1446 01  DATE-CONVERSION-DATA.
  1447     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1448     12  DC-OPTION-CODE                PIC X.
  1449         88  BIN-TO-GREG                VALUE ' '.
  1450         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1451         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1452         88  YMD-GREG-TO-BIN            VALUE '3'.
  1453         88  MDY-GREG-TO-BIN            VALUE '4'.
  1454         88  JULIAN-TO-BIN              VALUE '5'.
  1455         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1456         88  FIND-CENTURY               VALUE '7'.
  1457         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1458         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1459         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1460         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1461         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1462         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1463         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  27
* SOCK04BL.cbl
  1464         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1465         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1466         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1467         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1468         88  BIN-3-TO-GREG              VALUE 'I'.
  1469         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1470         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1471         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1472         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1473         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1474         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1475         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1476         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1477         88  THREE-CHARACTER-BIN
  1478                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1479         88  GREGORIAN-TO-BIN
  1480                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1481         88  BIN-TO-GREGORIAN
  1482                  VALUES ' ' '1' 'I' '8' 'G'.
  1483         88  JULIAN-TO-BINARY
  1484                  VALUES '5' 'C' 'E' 'F'.
  1485     12  DC-ERROR-CODE                 PIC X.
  1486         88  NO-CONVERSION-ERROR        VALUE ' '.
  1487         88  DATE-CONVERSION-ERROR
  1488                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1489         88  DATE-IS-ZERO               VALUE '1'.
  1490         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1491         88  DATE-IS-INVALID            VALUE '3'.
  1492         88  DATE1-GREATER-DATE2        VALUE '4'.
  1493         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1494         88  DATE-INVALID-OPTION        VALUE '9'.
  1495         88  INVALID-CENTURY            VALUE 'A'.
  1496         88  ONLY-CENTURY               VALUE 'B'.
  1497         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1498         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1499     12  DC-END-OF-MONTH               PIC X.
  1500         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1501     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1502         88  USE-NORMAL-PROCESS         VALUE ' '.
  1503         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1504         88  ADJUST-UP-100-YRS          VALUE '2'.
  1505     12  FILLER                        PIC X.
  1506     12  DC-CONVERSION-DATES.
  1507         16  DC-BIN-DATE-1             PIC XX.
  1508         16  DC-BIN-DATE-2             PIC XX.
  1509         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1510         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1511                       DC-GREG-DATE-1-EDIT.
  1512             20  DC-EDIT1-MONTH        PIC 99.
  1513             20  SLASH1-1              PIC X.
  1514             20  DC-EDIT1-DAY          PIC 99.
  1515             20  SLASH1-2              PIC X.
  1516             20  DC-EDIT1-YEAR         PIC 99.
  1517         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1518         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1519                     DC-GREG-DATE-2-EDIT.
  1520             20  DC-EDIT2-MONTH        PIC 99.
  1521             20  SLASH2-1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  28
* SOCK04BL.cbl
  1522             20  DC-EDIT2-DAY          PIC 99.
  1523             20  SLASH2-2              PIC X.
  1524             20  DC-EDIT2-YEAR         PIC 99.
  1525         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1526         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1527                     DC-GREG-DATE-1-YMD.
  1528             20  DC-YMD-YEAR           PIC 99.
  1529             20  DC-YMD-MONTH          PIC 99.
  1530             20  DC-YMD-DAY            PIC 99.
  1531         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1532         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1533                      DC-GREG-DATE-1-MDY.
  1534             20  DC-MDY-MONTH          PIC 99.
  1535             20  DC-MDY-DAY            PIC 99.
  1536             20  DC-MDY-YEAR           PIC 99.
  1537         16  DC-GREG-DATE-1-ALPHA.
  1538             20  DC-ALPHA-MONTH        PIC X(10).
  1539             20  DC-ALPHA-DAY          PIC 99.
  1540             20  FILLER                PIC XX.
  1541             20  DC-ALPHA-CENTURY.
  1542                 24 DC-ALPHA-CEN-N     PIC 99.
  1543             20  DC-ALPHA-YEAR         PIC 99.
  1544         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1545         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1546         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1547         16  DC-JULIAN-DATE            PIC 9(05).
  1548         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1549                                       PIC 9(05).
  1550         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1551             20  DC-JULIAN-YEAR        PIC 99.
  1552             20  DC-JULIAN-DAYS        PIC 999.
  1553         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1554         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1555         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1556     12  DATE-CONVERSION-VARIBLES.
  1557         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1558         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1559             20  FILLER                PIC 9(3).
  1560             20  HOLD-CEN-1-CCYY.
  1561                 24  HOLD-CEN-1-CC     PIC 99.
  1562                 24  HOLD-CEN-1-YY     PIC 99.
  1563             20  HOLD-CEN-1-MO         PIC 99.
  1564             20  HOLD-CEN-1-DA         PIC 99.
  1565         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1566             20  HOLD-CEN-1-R-MO       PIC 99.
  1567             20  HOLD-CEN-1-R-DA       PIC 99.
  1568             20  HOLD-CEN-1-R-CCYY.
  1569                 24  HOLD-CEN-1-R-CC   PIC 99.
  1570                 24  HOLD-CEN-1-R-YY   PIC 99.
  1571             20  FILLER                PIC 9(3).
  1572         16  HOLD-CENTURY-1-X.
  1573             20  FILLER                PIC X(3)  VALUE SPACES.
  1574             20  HOLD-CEN-1-X-CCYY.
  1575                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1576                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1577             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1578             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1579         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  29
* SOCK04BL.cbl
  1580             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1581             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1582             20  HOLD-CEN-1-R-X-CCYY.
  1583                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1584                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1585             20  FILLER                PIC XXX.
  1586         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1587         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1588         16  DC-JULIAN-DATE-1          PIC 9(07).
  1589         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1590             20  DC-JULIAN-1-CCYY.
  1591                 24  DC-JULIAN-1-CC    PIC 99.
  1592                 24  DC-JULIAN-1-YR    PIC 99.
  1593             20  DC-JULIAN-DA-1        PIC 999.
  1594         16  DC-JULIAN-DATE-2          PIC 9(07).
  1595         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1596             20  DC-JULIAN-2-CCYY.
  1597                 24  DC-JULIAN-2-CC    PIC 99.
  1598                 24  DC-JULIAN-2-YR    PIC 99.
  1599             20  DC-JULIAN-DA-2        PIC 999.
  1600         16  DC-GREG-DATE-A-EDIT.
  1601             20  DC-EDITA-MONTH        PIC 99.
  1602             20  SLASHA-1              PIC X VALUE '/'.
  1603             20  DC-EDITA-DAY          PIC 99.
  1604             20  SLASHA-2              PIC X VALUE '/'.
  1605             20  DC-EDITA-CCYY.
  1606                 24  DC-EDITA-CENT     PIC 99.
  1607                 24  DC-EDITA-YEAR     PIC 99.
  1608         16  DC-GREG-DATE-B-EDIT.
  1609             20  DC-EDITB-MONTH        PIC 99.
  1610             20  SLASHB-1              PIC X VALUE '/'.
  1611             20  DC-EDITB-DAY          PIC 99.
  1612             20  SLASHB-2              PIC X VALUE '/'.
  1613             20  DC-EDITB-CCYY.
  1614                 24  DC-EDITB-CENT     PIC 99.
  1615                 24  DC-EDITB-YEAR     PIC 99.
  1616         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1617         16  DC-GREG-DATE-CYMD-R REDEFINES
  1618                              DC-GREG-DATE-CYMD.
  1619             20  DC-CYMD-CEN           PIC 99.
  1620             20  DC-CYMD-YEAR          PIC 99.
  1621             20  DC-CYMD-MONTH         PIC 99.
  1622             20  DC-CYMD-DAY           PIC 99.
  1623         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1624         16  DC-GREG-DATE-MDCY-R REDEFINES
  1625                              DC-GREG-DATE-MDCY.
  1626             20  DC-MDCY-MONTH         PIC 99.
  1627             20  DC-MDCY-DAY           PIC 99.
  1628             20  DC-MDCY-CEN           PIC 99.
  1629             20  DC-MDCY-YEAR          PIC 99.
  1630    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1631        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1632    12  DC-EL310-DATE                  PIC X(21).
  1633    12  FILLER                         PIC X(28).
  1634****************************************************************
  1635*
  1636* Copyright (c) 2007 by Clerity Solutions, Inc.
  1637* All rights reserved.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  30
* SOCK04BL.cbl
  1638*
  1639****************************************************************
  1640 01  DFHEIV.
  1641   02  DFHEIV0               PIC X(35).
  1642   02  DFHEIV1               PIC X(08).
  1643   02  DFHEIV2               PIC X(08).
  1644   02  DFHEIV3               PIC X(08).
  1645   02  DFHEIV4               PIC X(06).
  1646   02  DFHEIV5               PIC X(04).
  1647   02  DFHEIV6               PIC X(04).
  1648   02  DFHEIV7               PIC X(02).
  1649   02  DFHEIV8               PIC X(02).
  1650   02  DFHEIV9               PIC X(01).
  1651   02  DFHEIV10              PIC S9(7) COMP-3.
  1652   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1653   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1654   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1655   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1656   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1657   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1658   02  DFHEIV17              PIC X(04).
  1659   02  DFHEIV18              PIC X(04).
  1660   02  DFHEIV19              PIC X(04).
  1661   02  DFHEIV20              USAGE IS POINTER.
  1662   02  DFHEIV21              USAGE IS POINTER.
  1663   02  DFHEIV22              USAGE IS POINTER.
  1664   02  DFHEIV23              USAGE IS POINTER.
  1665   02  DFHEIV24              USAGE IS POINTER.
  1666   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1667   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1668   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1669   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1670   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1671   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1672   02  FILLER                PIC X(02).
  1673   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1674   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1675   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1676   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1677   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1678 LINKAGE  SECTION.
  1679*****************************************************************
  1680*                                                               *
  1681* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1682* All rights reserved.                                          *
  1683*                                                               *
  1684*****************************************************************
  1685 01  dfheiblk.
  1686     02  eibtime          pic s9(7) comp-3.
  1687     02  eibdate          pic s9(7) comp-3.
  1688     02  eibtrnid         pic x(4).
  1689     02  eibtaskn         pic s9(7) comp-3.
  1690     02  eibtrmid         pic x(4).
  1691     02  dfheigdi         pic s9(4) comp.
  1692     02  eibcposn         pic s9(4) comp.
  1693     02  eibcalen         pic s9(4) comp.
  1694     02  eibaid           pic x(1).
  1695     02  eibfiller1       pic x(1).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  31
* SOCK04BL.cbl
  1696     02  eibfn            pic x(2).
  1697     02  eibfiller2       pic x(2).
  1698     02  eibrcode         pic x(6).
  1699     02  eibfiller3       pic x(2).
  1700     02  eibds            pic x(8).
  1701     02  eibreqid         pic x(8).
  1702     02  eibrsrce         pic x(8).
  1703     02  eibsync          pic x(1).
  1704     02  eibfree          pic x(1).
  1705     02  eibrecv          pic x(1).
  1706     02  eibsend          pic x(1).
  1707     02  eibatt           pic x(1).
  1708     02  eibeoc           pic x(1).
  1709     02  eibfmh           pic x(1).
  1710     02  eibcompl         pic x(1).
  1711     02  eibsig           pic x(1).
  1712     02  eibconf          pic x(1).
  1713     02  eiberr           pic x(1).
  1714     02  eibrldbk         pic x(1).
  1715     02  eiberrcd         pic x(4).
  1716     02  eibsynrb         pic x(1).
  1717     02  eibnodat         pic x(1).
  1718     02  eibfiller5       pic x(2).
  1719     02  eibresp          pic 9(09) comp.
  1720     02  eibresp2         pic 9(09) comp.
  1721     02  dfheigdj         pic s9(4) comp.
  1722     02  dfheigdk         pic s9(4) comp.
  1723 01  DFHCOMMAREA.
  1724*                                copy SOCK04-COMMAREA.
  1725*****************************************************************
  1726*                                                               *
  1727* Copyright (c) 2015 by CSO.                                    *
  1728* All rights reserved.                                          *
  1729*                                                               *
  1730*****************************************************************
  1731****************************************
  1732*  commarea for SOCK04.cl2
  1733*  (business logic input & output)
  1734****************************************
  1735 03  socket-commarea.
  1736     05 sock-IN-DATA.
  1737         10  sock-CAR          PIC X.
  1738         10  sock-GRP          PIC X(6).
  1739         10  sock-ST           PIC XX.
  1740         10  sock-ACT          PIC X(10).
  1741         10  sock-EFF-DT       PIC X(8).
  1742         10  sock-cert-no      pic x(11).
  1743         10  sock-ID           PIC XXX.
  1744         10  sock-proc-id      pic x(4).
  1745         10  sock-ACTION-TAKEN PIC X.
  1746         10  FILLER              PIC X(9).
  1747     05  sock-return-area.
  1748         10  sock-am-name        pic x(30).
  1749         10  sock-am-person      pic x(30).
  1750         10  sock-am-cntrl-name  pic x(30).
  1751         10  sock-am-phone       pic x(10).
  1752         10  sock-co-fax         pic x(10).
  1753         10  sock-co-contact     pic x(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  32
* SOCK04BL.cbl
  1754 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1755 0000-DFHEXIT SECTION.
  1756     MOVE '9#                    $   ' TO DFHEIV0.
  1757     MOVE 'SOCK04BL' TO DFHEIV1.
  1758     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1759     display ' Begin SOCK04BL =' SOCK-IN-DATA '='
  1760     perform 0010-init           thru 0010-exit
  1761     perform 0100-process-request thru 0100-exit
  1762     GO TO cics-return
  1763     .
  1764 0010-init.
  1765
  1766* exec cics
  1767*       asktime
  1768*    end-exec
  1769*    MOVE '0"                    "   #00001761' TO DFHEIV0
  1770     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  1771     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  1772     MOVE X'2020233030303031373631' TO DFHEIV0(25:11)
  1773     CALL 'kxdfhei1' USING DFHEIV0,
  1774           DFHEIV99
  1775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1776     display ' eibtime ' eibtime
  1777     display ' eibdate ' eibdate
  1778     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1779     MOVE '5'                    TO DC-OPTION-CODE
  1780     perform 9700-date-link      thru 9700-exit
  1781     IF DATE-CONVERSION-ERROR
  1782        display ' error converting eibdate '
  1783        MOVE LOW-VALUES          TO ws-current-bin-dt
  1784     ELSE
  1785        MOVE DC-BIN-DATE-1       TO ws-current-bin-dt
  1786     end-if
  1787     move sock-id                to ws-comp-id
  1788     evaluate true
  1789        when ws-comp-id = 'AHL'
  1790           MOVE X'06'            TO ws-comp-cd
  1791        when ws-comp-id = 'DCC'
  1792           move X'05'            to ws-comp-cd
  1793        when ws-comp-id = 'VPP'
  1794           move X'07'            to ws-comp-cd
  1795        when other
  1796           move X'04'            to ws-comp-cd
  1797     end-evaluate
  1798     move sock-eff-dt            to dc-greg-date-1-edit
  1799     move '2'                    to dc-option-code
  1800     perform 9700-date-link      thru 9700-exit
  1801     if not no-conversion-error
  1802        display ' error converting eff date '
  1803        go to cics-return
  1804     end-if
  1805     move dc-bin-date-1          to ws-bin-cert-eff-dt
  1806     .
  1807 0010-exit.
  1808     exit.
  1809 0100-process-request.
  1810     perform 0110-get-elcert     thru 0110-exit
  1811     if resp-normal
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  33
* SOCK04BL.cbl
  1812        perform 0120-process-cert-trailer
  1813                                 thru 0120-exit
  1814        perform 0150-process-cert-notes
  1815                                 thru 0150-exit
  1816        perform 0200-process-acct-comp
  1817                                 thru 0200-exit
  1818     end-if
  1819     .
  1820 0100-exit.
  1821     exit.
  1822 0110-get-elcert.
  1823*    display ' made it to 0110-get-elcert '
  1824     move low-values             to ws-cm-key
  1825     move ws-comp-cd             to ws-cm-company-cd
  1826     move sock-car               to ws-cm-carrier
  1827     move sock-grp               to ws-cm-group
  1828     move sock-st                to ws-cm-state
  1829     move sock-act               to ws-cm-account
  1830     move ws-bin-cert-eff-dt     to ws-cm-eff-dt
  1831     move sock-cert-no           to ws-cm-cert-no
  1832
  1833* EXEC CICS READ
  1834*         INTO    (CERTIFICATE-MASTER)
  1835*         DATASET ('ELCERT')
  1836*         RIDFLD  (WS-CM-KEY)
  1837*         RESP    (WS-RESPONSE)
  1838*    END-EXEC
  1839     MOVE LENGTH OF
  1840      CERTIFICATE-MASTER
  1841       TO DFHEIV11
  1842     MOVE 'ELCERT' TO DFHEIV1
  1843*    MOVE '&"IL       E          (  N#00001820' TO DFHEIV0
  1844     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1845     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1846     MOVE X'204E233030303031383230' TO DFHEIV0(25:11)
  1847     CALL 'kxdfhei1' USING DFHEIV0,
  1848           DFHEIV1,
  1849           CERTIFICATE-MASTER,
  1850           DFHEIV11,
  1851           WS-CM-KEY,
  1852           DFHEIV99,
  1853           DFHEIV99,
  1854           DFHEIV99
  1855     MOVE EIBRESP  TO WS-RESPONSE
  1856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1857     .
  1858 0110-exit.
  1859     exit.
  1860 0120-process-cert-trailer.
  1861*    display ' made it to 0120-process cert '
  1862     perform 0121-read-elcrtt    thru 0121-exit
  1863     evaluate true
  1864        when resp-normal
  1865           perform 0122-upd-elcrtt
  1866                                 thru 0122-exit
  1867        when resp-notfnd
  1868           perform 0123-add-elcrtt
  1869                                 thru 0123-exit
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  34
* SOCK04BL.cbl
  1870        when other
  1871           display ' error cert trlr ' ws-response
  1872           go to cics-return
  1873     end-evaluate
  1874     .
  1875 0120-exit.
  1876     exit.
  1877 0121-read-elcrtt.
  1878*    display ' made it to 0121-read elcrtt  '
  1879     move cm-control-primary     to ws-cs-key
  1880     move 'C'                    to ws-cs-trlr-type
  1881
  1882* EXEC CICS READ
  1883*       UPDATE
  1884*       INTO    (CERTIFICATE-TRAILERS)
  1885*       DATASET ('ELCRTT')
  1886*       RIDFLD  (WS-CS-KEY)
  1887*       RESP    (WS-RESPONSE)
  1888*    END-EXEC
  1889     MOVE LENGTH OF
  1890      CERTIFICATE-TRAILERS
  1891       TO DFHEIV11
  1892     MOVE 'ELCRTT' TO DFHEIV1
  1893*    MOVE '&"IL       EU         (  N#00001850' TO DFHEIV0
  1894     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1895     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1896     MOVE X'204E233030303031383530' TO DFHEIV0(25:11)
  1897     CALL 'kxdfhei1' USING DFHEIV0,
  1898           DFHEIV1,
  1899           CERTIFICATE-TRAILERS,
  1900           DFHEIV11,
  1901           WS-CS-KEY,
  1902           DFHEIV99,
  1903           DFHEIV99,
  1904           DFHEIV99
  1905     MOVE EIBRESP  TO WS-RESPONSE
  1906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1907     .
  1908 0121-exit.
  1909     exit.
  1910 0122-upd-elcrtt.
  1911*    display ' made it to 0122-upd-elcrtt   '
  1912     move sock-action-taken      to cs-agent-edit-status
  1913     if cs-agent-edit-status = 'C' or 'S' or 'U' or 'R' or
  1914                               'M' or 'N'
  1915        move spaces              to cs-agent-name
  1916                                    cs-license-no
  1917                                    cs-npn-number
  1918     end-if
  1919     evaluate cs-agent-edit-status
  1920        when 'U'
  1921           move 'Unidentified'   to cs-agent-name
  1922        when 'R'
  1923           move 'Returned'       to cs-agent-name
  1924        when 'N'
  1925           move 'Accept with no commission'
  1926                                 to cs-agent-name
  1927     end-evaluate
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  35
* SOCK04BL.cbl
  1928
  1929* EXEC CICS REWRITE
  1930*       DATASET ('ELCRTT')
  1931*       FROM    (CERTIFICATE-TRAILERS)
  1932*       RESP    (WS-RESPONSE)
  1933*    END-EXEC
  1934     MOVE LENGTH OF
  1935      CERTIFICATE-TRAILERS
  1936       TO DFHEIV11
  1937     MOVE 'ELCRTT' TO DFHEIV1
  1938*    MOVE '&& L                  %  N#00001878' TO DFHEIV0
  1939     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1940     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1941     MOVE X'204E233030303031383738' TO DFHEIV0(25:11)
  1942     CALL 'kxdfhei1' USING DFHEIV0,
  1943           DFHEIV1,
  1944           CERTIFICATE-TRAILERS,
  1945           DFHEIV11,
  1946           DFHEIV99
  1947     MOVE EIBRESP  TO WS-RESPONSE
  1948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1949     .
  1950 0122-exit.
  1951     exit.
  1952 0123-add-elcrtt.
  1953*    display ' made it to 0123-add elcrtt   '
  1954     move 'CS'                   to certificate-trailers
  1955     move cm-control-primary     to cs-control-primary
  1956     move 'C'                    to cs-trailer-type
  1957     move sock-action-taken    to cs-agent-edit-status
  1958     evaluate cs-agent-edit-status
  1959        when 'U'
  1960           move 'Unidentified'   to cs-agent-name
  1961        when 'R'
  1962           move 'Returned'       to cs-agent-name
  1963        when 'N'
  1964           move 'Accept with no commission'
  1965                                 to cs-agent-name
  1966     end-evaluate
  1967
  1968* EXEC CICS WRITE
  1969*       DATASET ('ELCRTT')
  1970*       FROM    (CERTIFICATE-TRAILERS)
  1971*       RIDFLD  (cs-control-primary)
  1972*       RESP    (WS-RESPONSE)
  1973*    END-EXEC
  1974     MOVE LENGTH OF
  1975      CERTIFICATE-TRAILERS
  1976       TO DFHEIV11
  1977     MOVE 'ELCRTT' TO DFHEIV1
  1978*    MOVE '&$ L                  ''  N#00001901' TO DFHEIV0
  1979     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  1980     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1981     MOVE X'204E233030303031393031' TO DFHEIV0(25:11)
  1982     CALL 'kxdfhei1' USING DFHEIV0,
  1983           DFHEIV1,
  1984           CERTIFICATE-TRAILERS,
  1985           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  36
* SOCK04BL.cbl
  1986           cs-control-primary,
  1987           DFHEIV99,
  1988           DFHEIV99
  1989     MOVE EIBRESP  TO WS-RESPONSE
  1990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1991     .
  1992 0123-exit.
  1993     exit.
  1994 0150-process-cert-notes.
  1995*    display ' made it to 0150 process cert notes '
  1996     move spaces                 to cert-note-records-holder
  1997                                    ws-build-note-sw
  1998                                    ws-ercnot-sw
  1999     move cm-control-primary     to ws-cz-key
  2000     move '1'                    to ws-cz-rec-type
  2001     move +0                     to ws-cz-note-seq
  2002                                    c1
  2003
  2004* EXEC CICS STARTBR
  2005*         DATASET    ('ERCNOT')
  2006*         RIDFLD     (WS-CZ-KEY)
  2007*         GTEQ
  2008*         RESP       (WS-RESPONSE)
  2009*    END-EXEC
  2010     MOVE 'ERCNOT' TO DFHEIV1
  2011     MOVE 0
  2012       TO DFHEIV11
  2013*    MOVE '&,         G          &  N#00001919' TO DFHEIV0
  2014     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2015     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2016     MOVE X'204E233030303031393139' TO DFHEIV0(25:11)
  2017     CALL 'kxdfhei1' USING DFHEIV0,
  2018           DFHEIV1,
  2019           WS-CZ-KEY,
  2020           DFHEIV99,
  2021           DFHEIV11,
  2022           DFHEIV99
  2023     MOVE EIBRESP  TO WS-RESPONSE
  2024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2025     IF RESP-NORMAL
  2026        set ercnot-startbr to true
  2027*       display ' resp normal startbr '
  2028        perform until finished-with-notes
  2029
  2030* EXEC CICS READNEXT
  2031*             DATASET    ('ERCNOT')
  2032*             RIDFLD     (WS-CZ-KEY)
  2033*             INTO       (cert-note-file)
  2034*             resp       (ws-response)
  2035*          end-exec
  2036     MOVE LENGTH OF
  2037      cert-note-file
  2038       TO DFHEIV12
  2039     MOVE 'ERCNOT' TO DFHEIV1
  2040     MOVE 0
  2041       TO DFHEIV11
  2042*    MOVE '&.IL                  )  N#00001929' TO DFHEIV0
  2043     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  37
* SOCK04BL.cbl
  2044     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2045     MOVE X'204E233030303031393239' TO DFHEIV0(25:11)
  2046     CALL 'kxdfhei1' USING DFHEIV0,
  2047           DFHEIV1,
  2048           cert-note-file,
  2049           DFHEIV12,
  2050           WS-CZ-KEY,
  2051           DFHEIV99,
  2052           DFHEIV11,
  2053           DFHEIV99,
  2054           DFHEIV99
  2055     MOVE EIBRESP  TO ws-response
  2056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2057           if (resp-normal)
  2058              and (cz-control-primary (1:33) =
  2059                 cm-control-primary (1:33))
  2060              if cz-record-type = '1'
  2061                 add +1 to c1
  2062                 move cert-note-file
  2063                                 to cert-note-record (c1)
  2064              end-if
  2065           else
  2066              set finished-with-notes to true
  2067           end-if
  2068        end-perform
  2069     end-if
  2070     if ercnot-startbr
  2071*       display ' about to endbr ercnot '
  2072
  2073* exec cics endbr
  2074*          dataset    ('ERCNOT')
  2075*       end-exec
  2076     MOVE 'ERCNOT' TO DFHEIV1
  2077     MOVE 0
  2078       TO DFHEIV11
  2079*    MOVE '&2                    $   #00001950' TO DFHEIV0
  2080     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2081     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2082     MOVE X'2020233030303031393530' TO DFHEIV0(25:11)
  2083     CALL 'kxdfhei1' USING DFHEIV0,
  2084           DFHEIV1,
  2085           DFHEIV11,
  2086           DFHEIV99
  2087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2088     end-if
  2089     move c1                     to note-count
  2090     if c1 = +0
  2091        perform 0151-add-verify-agent-sig-note
  2092                                 thru 0151-exit
  2093     else
  2094        if ((cnr-rest (1) (1:21) = 'AGENT CHECK SIGNATURE')
  2095           and (sock-action-taken = 'C'))
  2096                         or
  2097           ((cnr-rest (1) (1:23) = 'MISSING AGENT SIGNATURE')
  2098           and (sock-action-taken = 'S'))
  2099                         or
  2100           ((cnr-rest (1) (1:22) = 'UNIDENTIFIED SIGNATURE')
  2101           and (sock-action-taken = 'U'))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  38
* SOCK04BL.cbl
  2102                         or
  2103           ((cnr-rest (1) (1:20) = 'CERTIFICATE RETURNED')
  2104           and (sock-action-taken = 'R'))
  2105                         or
  2106           ((cnr-rest (1) (1:19) = 'REFERRED TO MANAGER')
  2107           and (sock-action-taken = 'M'))
  2108                         or
  2109           ((cnr-rest (1) (1:25) = 'ACCEPT WITH NO COMMISSION')
  2110           and (sock-action-taken = 'N'))
  2111           go to 0150-exit
  2112        else
  2113           perform 0152-delete-cert-notes
  2114                                 thru 0152-exit
  2115           if resp-normal
  2116              perform 0151-add-verify-agent-sig-note
  2117                                 thru 0151-exit
  2118              if resp-normal
  2119                 perform 0153-put-back-cert-notes
  2120                                 thru 0153-exit
  2121                 if resp-normal
  2122                    continue
  2123                 else
  2124                    display ' something wrong with put back '
  2125                       cm-cert-no
  2126                 end-if
  2127              else
  2128                 display ' something went wrong with adding note '
  2129                    cm-cert-no
  2130              end-if
  2131           else
  2132              display ' something went wrong with generic delete '
  2133                 cm-cert-no
  2134           end-if
  2135        end-if
  2136     end-if
  2137     .
  2138 0150-exit.
  2139     exit.
  2140 0151-add-verify-agent-sig-note.
  2141*    display ' made it to 0151 add '
  2142     move 'CZ'                to cert-note-file
  2143     move cm-control-primary  to cz-control-primary
  2144     move '1'                 to cz-record-type
  2145     move +1                  to cz-note-sequence
  2146     move ws-current-bin-dt   to cz-last-maint-dt
  2147     move eibtime             to cz-last-maint-hhmmss
  2148     move sock-proc-id        to cz-last-maint-user
  2149     evaluate true
  2150        when sock-action-taken = 'C'
  2151           MOVE 'AGENT CHECK SIGNATURE COVER SHEET GENERATED'
  2152                              to cz-note
  2153        when sock-action-taken = 'S'
  2154           move 'MISSING AGENT SIGNATURE FORM GENERATED'
  2155                              to cz-note
  2156        when sock-action-taken = 'U'
  2157           move 'UNIDENTIFIED SIGNATURE'
  2158                              to cz-note
  2159        when sock-action-taken = 'R'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  39
* SOCK04BL.cbl
  2160           move 'CERTIFICATE RETURNED'
  2161                              to cz-note
  2162        when sock-action-taken = 'N'
  2163           move 'ACCEPTED WITH NO COMMISSION'
  2164                              to cz-note
  2165        when other
  2166           move 'REFERRED TO MANAGER'
  2167                              to cz-note
  2168     end-evaluate
  2169
  2170* exec cics write
  2171*       dataset   ('ERCNOT')
  2172*       from      (cert-note-file)
  2173*       ridfld    (cz-control-primary)
  2174*       resp      (ws-response)
  2175*    end-exec
  2176     MOVE LENGTH OF
  2177      cert-note-file
  2178       TO DFHEIV11
  2179     MOVE 'ERCNOT' TO DFHEIV1
  2180*    MOVE '&$ L                  ''  N#00002034' TO DFHEIV0
  2181     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2182     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2183     MOVE X'204E233030303032303334' TO DFHEIV0(25:11)
  2184     CALL 'kxdfhei1' USING DFHEIV0,
  2185           DFHEIV1,
  2186           cert-note-file,
  2187           DFHEIV11,
  2188           cz-control-primary,
  2189           DFHEIV99,
  2190           DFHEIV99
  2191     MOVE EIBRESP  TO ws-response
  2192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2193     if not resp-normal
  2194        display ' error-ercnot-write ' ws-response ' '
  2195           cz-control-primary (2:33)
  2196     end-if
  2197     .
  2198 0151-exit.
  2199     exit.
  2200 0152-delete-cert-notes.
  2201*    display ' made it to 0152 '
  2202     move cm-control-primary     to ws-cz-key
  2203     move '1'                    to ws-cz-rec-type
  2204     move +0                     to ws-cz-note-seq
  2205*    display ' about to browse delete ' ws-cz-key (2:19) ' '
  2206*       ws-cz-key (23:11)
  2207
  2208* EXEC CICS STARTBR
  2209*         DATASET    ('ERCNOT')
  2210*         RIDFLD     (WS-CZ-KEY)
  2211*         GTEQ
  2212*         RESP       (WS-RESPONSE)
  2213*    END-EXEC
  2214     MOVE 'ERCNOT' TO DFHEIV1
  2215     MOVE 0
  2216       TO DFHEIV11
  2217*    MOVE '&,         G          &  N#00002054' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  40
* SOCK04BL.cbl
  2218     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2219     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2220     MOVE X'204E233030303032303534' TO DFHEIV0(25:11)
  2221     CALL 'kxdfhei1' USING DFHEIV0,
  2222           DFHEIV1,
  2223           WS-CZ-KEY,
  2224           DFHEIV99,
  2225           DFHEIV11,
  2226           DFHEIV99
  2227     MOVE EIBRESP  TO WS-RESPONSE
  2228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2229     IF not RESP-NORMAL
  2230        display ' error startbr for delete ' ws-response
  2231        go to 0152-exit
  2232     end-if
  2233*    display ' good startbr '
  2234     .
  2235 0152-read-next.
  2236
  2237* EXEC CICS READNEXT
  2238*       DATASET    ('ERCNOT')
  2239*       RIDFLD     (WS-CZ-KEY)
  2240*       INTO       (cert-note-file)
  2241*       resp       (ws-response)
  2242*    end-exec
  2243     MOVE LENGTH OF
  2244      cert-note-file
  2245       TO DFHEIV12
  2246     MOVE 'ERCNOT' TO DFHEIV1
  2247     MOVE 0
  2248       TO DFHEIV11
  2249*    MOVE '&.IL                  )  N#00002067' TO DFHEIV0
  2250     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2251     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2252     MOVE X'204E233030303032303637' TO DFHEIV0(25:11)
  2253     CALL 'kxdfhei1' USING DFHEIV0,
  2254           DFHEIV1,
  2255           cert-note-file,
  2256           DFHEIV12,
  2257           WS-CZ-KEY,
  2258           DFHEIV99,
  2259           DFHEIV11,
  2260           DFHEIV99,
  2261           DFHEIV99
  2262     MOVE EIBRESP  TO ws-response
  2263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2264     if resp-normal
  2265*       display ' good readnext '
  2266        if cz-control-primary (1:33) = cm-control-primary (1:33)
  2267*          display ' primary equal '
  2268           if cz-record-type = '1'
  2269*             display ' rec type = 1, about to endbr '
  2270
  2271* exec cics endbr
  2272*                dataset    ('ERCNOT')
  2273*                resp       (ws-response)
  2274*             end-exec
  2275     MOVE 'ERCNOT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  41
* SOCK04BL.cbl
  2276     MOVE 0
  2277       TO DFHEIV11
  2278*    MOVE '&2                    $  N#00002079' TO DFHEIV0
  2279     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2280     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2281     MOVE X'204E233030303032303739' TO DFHEIV0(25:11)
  2282     CALL 'kxdfhei1' USING DFHEIV0,
  2283           DFHEIV1,
  2284           DFHEIV11,
  2285           DFHEIV99
  2286     MOVE EIBRESP  TO ws-response
  2287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2288              if not resp-normal
  2289                 display ' bad endbr ' ws-response
  2290                 go to 0152-exit
  2291              else
  2292*                display ' about to read update '
  2293
  2294* EXEC CICS READ
  2295*                   UPDATE
  2296*                   DATASET    ('ERCNOT')
  2297*                   RIDFLD     (WS-CZ-KEY)
  2298*                   INTO       (cert-note-file)
  2299*                   resp       (ws-response)
  2300*                end-exec
  2301     MOVE LENGTH OF
  2302      cert-note-file
  2303       TO DFHEIV11
  2304     MOVE 'ERCNOT' TO DFHEIV1
  2305*    MOVE '&"IL       EU         (  N#00002088' TO DFHEIV0
  2306     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2307     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2308     MOVE X'204E233030303032303838' TO DFHEIV0(25:11)
  2309     CALL 'kxdfhei1' USING DFHEIV0,
  2310           DFHEIV1,
  2311           cert-note-file,
  2312           DFHEIV11,
  2313           WS-CZ-KEY,
  2314           DFHEIV99,
  2315           DFHEIV99,
  2316           DFHEIV99
  2317     MOVE EIBRESP  TO ws-response
  2318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2319                 if not resp-normal
  2320                    display ' bad read update ' ws-response
  2321                    go to 0152-exit
  2322                 end-if
  2323*                display ' about to delete '
  2324
  2325* exec cics delete
  2326*                   dataset   ('ERCNOT')
  2327*                   RIDFLD     (WS-CZ-KEY)
  2328*                   resp      (ws-response)
  2329*                end-exec
  2330     MOVE 'ERCNOT' TO DFHEIV1
  2331*    MOVE '&(                    &  N#00002100' TO DFHEIV0
  2332     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2333     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  42
* SOCK04BL.cbl
  2334     MOVE X'204E233030303032313030' TO DFHEIV0(25:11)
  2335     CALL 'kxdfhei1' USING DFHEIV0,
  2336           DFHEIV1,
  2337           DFHEIV99,
  2338           DFHEIV99,
  2339           DFHEIV99,
  2340           DFHEIV99
  2341     MOVE EIBRESP  TO ws-response
  2342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2343                 if not resp-normal
  2344                    display ' bad delete ercnot ' ws-response
  2345                    go to 0152-exit
  2346                 else
  2347                    display ' good delete '
  2348                 end-if
  2349              end-if
  2350           else
  2351              display ' rec type not = 1 '
  2352           end-if
  2353           go to 0152-delete-cert-notes
  2354        else
  2355           display ' primary not = '
  2356        end-if
  2357     else
  2358        display ' error ercnot readnext delete ' ws-response
  2359     end-if
  2360*    display ' about to endbr '
  2361
  2362* exec cics endbr
  2363*       dataset    ('ERCNOT')
  2364*       resp       (ws-response)
  2365*    end-exec
  2366     MOVE 'ERCNOT' TO DFHEIV1
  2367     MOVE 0
  2368       TO DFHEIV11
  2369*    MOVE '&2                    $  N#00002123' TO DFHEIV0
  2370     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2371     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2372     MOVE X'204E233030303032313233' TO DFHEIV0(25:11)
  2373     CALL 'kxdfhei1' USING DFHEIV0,
  2374           DFHEIV1,
  2375           DFHEIV11,
  2376           DFHEIV99
  2377     MOVE EIBRESP  TO ws-response
  2378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2379     if not resp-normal
  2380        display ' bad resp endbr ercnot ' ws-response
  2381     else
  2382        display ' good endbr '
  2383     end-if
  2384     .
  2385 0152-exit.
  2386     exit.
  2387*0152-delete-cert-notes.
  2388*
  2389*    display ' made it to 0152 '
  2390*    move cm-control-primary     to ws-cz-key
  2391*    move '1'                    to ws-cz-rec-type
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  43
* SOCK04BL.cbl
  2392*    move +0                     to ws-cz-note-seq
  2393*    display ' about to generic delete ' ws-cz-key (2:19) ' '
  2394*       ws-cz-key (23:11)
  2395*    exec cics delete
  2396*       dataset    ('ERCNOT')
  2397*       keylength  (ws-cert-note-generic-key-len)
  2398*       ridfld     (ws-cz-key (1:34))
  2399*       generic
  2400*       resp       (ws-response)
  2401*    end-exec
  2402*
  2403*    display ' made it back from generic delete ' ws-response
  2404*
  2405*    .
  2406*0152-exit.
  2407*    exit.
  2408 0153-put-back-cert-notes.
  2409*    display ' made it to 0153 ' note-count
  2410     perform varying c1 from +1 by +1 until
  2411        c1 > note-count
  2412        move cert-note-record (c1)
  2413                                 to cert-note-file
  2414        add +1                   to cz-note-sequence
  2415*       display ' about to write ' cz-control-primary (2:19) ' '
  2416*          cz-control-primary (23:11) ' ' cz-note-sequence ' '
  2417*           cz-record-type ' ' cz-note-information
  2418
  2419* exec cics write
  2420*          dataset ('ERCNOT')
  2421*          FROM    (cert-note-file)
  2422*          ridfld  (cz-control-primary)
  2423*          resp    (ws-response)
  2424*       end-exec
  2425     MOVE LENGTH OF
  2426      cert-note-file
  2427       TO DFHEIV11
  2428     MOVE 'ERCNOT' TO DFHEIV1
  2429*    MOVE '&$ L                  ''  N#00002166' TO DFHEIV0
  2430     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2431     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2432     MOVE X'204E233030303032313636' TO DFHEIV0(25:11)
  2433     CALL 'kxdfhei1' USING DFHEIV0,
  2434           DFHEIV1,
  2435           cert-note-file,
  2436           DFHEIV11,
  2437           cz-control-primary,
  2438           DFHEIV99,
  2439           DFHEIV99
  2440     MOVE EIBRESP  TO ws-response
  2441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2442        if not resp-normal
  2443           display ' error-ercnot-write subsequ ' ws-response ' '
  2444              cz-control-primary (2:33)
  2445           move +999             to c1
  2446        else
  2447           display ' good ercnot write ' c1
  2448        end-if
  2449     end-perform
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  44
* SOCK04BL.cbl
  2450    .
  2451 0153-exit.
  2452     exit.
  2453 0200-process-acct-comp.
  2454*    display ' made it to 0200 '
  2455     move low-values             to ws-am-key
  2456     move ws-comp-cd             to ws-am-company-cd
  2457     move sock-car               to ws-am-carrier
  2458     move sock-grp               to ws-am-group
  2459     move sock-st                to ws-am-state
  2460     move sock-act               to ws-am-account
  2461     move ws-bin-cert-eff-dt     to ws-am-exp-dt
  2462
  2463* EXEC CICS STARTBR
  2464*         DATASET    ('ERACCT')
  2465*         RIDFLD     (WS-AM-KEY)
  2466*         GTEQ
  2467*         RESP       (WS-RESPONSE)
  2468*    END-EXEC
  2469     MOVE 'ERACCT' TO DFHEIV1
  2470     MOVE 0
  2471       TO DFHEIV11
  2472*    MOVE '&,         G          &  N#00002192' TO DFHEIV0
  2473     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2474     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2475     MOVE X'204E233030303032313932' TO DFHEIV0(25:11)
  2476     CALL 'kxdfhei1' USING DFHEIV0,
  2477           DFHEIV1,
  2478           WS-AM-KEY,
  2479           DFHEIV99,
  2480           DFHEIV11,
  2481           DFHEIV99
  2482     MOVE EIBRESP  TO WS-RESPONSE
  2483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2484     if not resp-normal
  2485        display ' bad startbr ' ws-response
  2486        go to 0200-exit
  2487     end-if
  2488
  2489* EXEC CICS READNEXT
  2490*         INTO    (ACCOUNT-MASTER)
  2491*         DATASET ('ERACCT')
  2492*         RIDFLD  (WS-AM-KEY)
  2493*         RESP    (WS-RESPONSE)
  2494*    END-EXEC
  2495     MOVE LENGTH OF
  2496      ACCOUNT-MASTER
  2497       TO DFHEIV12
  2498     MOVE 'ERACCT' TO DFHEIV1
  2499     MOVE 0
  2500       TO DFHEIV11
  2501*    MOVE '&.IL                  )  N#00002202' TO DFHEIV0
  2502     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2503     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2504     MOVE X'204E233030303032323032' TO DFHEIV0(25:11)
  2505     CALL 'kxdfhei1' USING DFHEIV0,
  2506           DFHEIV1,
  2507           ACCOUNT-MASTER,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  45
* SOCK04BL.cbl
  2508           DFHEIV12,
  2509           WS-AM-KEY,
  2510           DFHEIV99,
  2511           DFHEIV11,
  2512           DFHEIV99,
  2513           DFHEIV99
  2514     MOVE EIBRESP  TO WS-RESPONSE
  2515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2516     if (resp-normal)
  2517        and (ws-am-company-cd = ws-comp-cd)
  2518        and (ws-am-carrier    = sock-car)
  2519        and (ws-am-state      = sock-st)
  2520        and (ws-am-account    = sock-act)
  2521        continue
  2522     else
  2523        display ' account not found '
  2524        go to 0200-exit
  2525     end-if
  2526     move spaces                 to ws-return-stuff
  2527     move am-name                to sock-am-name
  2528     move am-person              to sock-am-person
  2529     move am-control-name        to sock-am-cntrl-name
  2530     move am-tel-no              to sock-am-phone
  2531     MOVE LOW-VALUES             TO WS-CO-KEY
  2532     MOVE AM-COMPANY-CD          TO WS-CO-COMPANY-CD
  2533     MOVE AM-CARRIER             TO WS-CO-CARRIER
  2534     MOVE AM-GROUPING            TO WS-CO-GROUP
  2535     MOVE 'A'                    TO WS-CO-TYPE
  2536     if am-remit-to not numeric
  2537        move zeros               to am-remit-to
  2538     end-if
  2539     if am-remit-to = zeros
  2540        move 01                  to am-remit-to
  2541     end-if
  2542     move am-agt (am-remit-to)   to ws-co-fin-resp
  2543     perform varying a1 from +1 by +1 until
  2544        (a1 > +10)
  2545        or (am-com-typ (a1) = 'C' or 'D')
  2546     end-perform
  2547     if a1 < +11
  2548        move am-agt (a1)         to ws-co-account
  2549     else
  2550        move am-account          to ws-co-account
  2551     end-if
  2552
  2553* EXEC CICS READ
  2554*         INTO    (COMPENSATION-MASTER)
  2555*         DATASET ('ERCOMP')
  2556*         RIDFLD  (WS-CO-KEY)
  2557*         RESP    (WS-RESPONSE)
  2558*    END-EXEC
  2559     MOVE LENGTH OF
  2560      COMPENSATION-MASTER
  2561       TO DFHEIV11
  2562     MOVE 'ERCOMP' TO DFHEIV1
  2563*    MOVE '&"IL       E          (  N#00002244' TO DFHEIV0
  2564     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2565     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  46
* SOCK04BL.cbl
  2566     MOVE X'204E233030303032323434' TO DFHEIV0(25:11)
  2567     CALL 'kxdfhei1' USING DFHEIV0,
  2568           DFHEIV1,
  2569           COMPENSATION-MASTER,
  2570           DFHEIV11,
  2571           WS-CO-KEY,
  2572           DFHEIV99,
  2573           DFHEIV99,
  2574           DFHEIV99
  2575     MOVE EIBRESP  TO WS-RESPONSE
  2576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2577     IF RESP-NORMAL
  2578        MOVE CO-CONTROL-NAME     TO sock-co-contact
  2579        MOVE CO-faxno            TO sock-co-fax
  2580     ELSE
  2581        MOVE ' unknown     '     TO sock-co-contact
  2582     END-IF
  2583     .
  2584 0200-exit.
  2585     exit.
  2586 cics-return.
  2587     display 'SOCK04BL Finished ' sock-return-area
  2588
  2589* exec cics
  2590*       return
  2591*    end-exec
  2592*    MOVE '.(                    ''   #00002261' TO DFHEIV0
  2593     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2594     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2595     MOVE X'2020233030303032323631' TO DFHEIV0(25:11)
  2596     CALL 'kxdfhei1' USING DFHEIV0,
  2597           DFHEIV99,
  2598           DFHEIV99,
  2599           DFHEIV99,
  2600           DFHEIV99,
  2601           DFHEIV99,
  2602           DFHEIV99
  2603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2604
  2605* goback
  2606
  2607     MOVE '9%                    "   ' TO DFHEIV0
  2608     MOVE 'SOCK04BL' TO DFHEIV1
  2609     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2610     goback
  2611     .
  2612 9700-DATE-LINK.
  2613
  2614* EXEC CICS LINK
  2615*         PROGRAM  ('ELDATCV')
  2616*         COMMAREA (DATE-CONVERSION-DATA)
  2617*         LENGTH   (DC-COMM-LENGTH)
  2618*    END-EXEC.
  2619     MOVE 'ELDATCV' TO DFHEIV1
  2620*    MOVE '."C                   (   #00002267' TO DFHEIV0
  2621     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2622     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2623     MOVE X'2020233030303032323637' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:24 Page  47
* SOCK04BL.cbl
  2624     CALL 'kxdfhei1' USING DFHEIV0,
  2625           DFHEIV1,
  2626           DATE-CONVERSION-DATA,
  2627           DC-COMM-LENGTH,
  2628           DFHEIV99,
  2629           DFHEIV99,
  2630           DFHEIV99,
  2631           DFHEIV99
  2632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2633
  2634 9700-EXIT.
  2635      EXIT.
  2636
  2637 9999-DFHBACK SECTION.
  2638     MOVE '9%                    "   ' TO DFHEIV0
  2639     MOVE 'SOCK04BL' TO DFHEIV1
  2640     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2641     GOBACK.
  2642 9999-DFHEXIT.
  2643     IF DFHEIGDJ EQUAL 0001
  2644         NEXT SENTENCE.
  2645     MOVE '9%                    "   ' TO DFHEIV0
  2646     MOVE 'SOCK04BL' TO DFHEIV1
  2647     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2648     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       52600     Code:        6416
