* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page   1
* EL614.cbl
* Options: int("EL614.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL614.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL614.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL614.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL614 .
     3*                            VMOD=2.001.
     4*
     5*
     6*AUTHOR.    PABLO.
     7*           COLLEYVILLE TX.
     8*DATE-COMPILED.
     9*SECURITY.   *****************************************************
    10*            *                                                   *
    11*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    12*            *                                                   *
    13*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page   2
* EL614.cbl
    14*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
    15*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    16*            *                                                   *
    17*            *****************************************************
    18*REMARKS.
    19*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    20*    FOR THE  EOB   CODES IN THE CLAIM SYSTEM.
    21*
    22*    SCREENS     - EL614A - EOB CODE MAINTENANCE
    23*
    24*    ENTERED BY  - EL101 - SYSTEM ADMINISTRATION MENU
    25*                  EL156 - PAYMENT WORKSHEET
    26*                  EL6317 - CERTIFICATE VERIFICATION
    27*    EXIT TO     - EL101 - SYSTEM ADMINISTRATION MENU
    28*                  EL156 - PAYMENT WORKSHEET
    29*                  EL6317 - CERTIFICATE VERIFICATION
    30*    COMMAREA    - PASSED
    31*
    32*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL101.  ON
    33*                  FIRST ENTRY, A SKELETON SCREEN IS SENT AND THE
    34*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    35*                  ENTRIES (XCTL FROM CICS VIA EX  ) THE SCREEN
    36*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    37*                  MAINTENANCE TYPE INDICATED.
    38******************************************************************
    39*                   C H A N G E   L O G
    40*
    41* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    42*-----------------------------------------------------------------
    43*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    44* EFFECTIVE    NUMBER
    45*-----------------------------------------------------------------
    46* 083110    2009122800001  PEMA  NEW PROGRAM
    47* 011811    2009122800001  AJRA  FIX SELECTION
    48* 042211    2011040600001  PEMA  FIX ISSUE NO RECORDS FOUND
    49* 081511    2011022800001  PEMA  ADMIN SERV NAPERSOFT CHANGES
    50* 121012    2012101700002  AJRA  HIGHLIGHT REASON CODES
    51* 112113    2013090300001  AJRA  NAPERSOFT PHASE 2
    52******************************************************************
    53 ENVIRONMENT DIVISION.
    54 DATA DIVISION.
    55 WORKING-STORAGE SECTION.
    56 01  DFH-START PIC X(04).
    57 77  FILLER  PIC X(32)  VALUE '********************************'.
    58 77  FILLER  PIC X(32)  VALUE '*   EL614  WORKING STORAGE     *'.
    59 77  FILLER  PIC X(32)  VALUE '***********VMOD=2.001 **********'.
    60 77  CI1                PIC S999  COMP-3 VALUE +0.
    61 77  B1                 PIC S999  COMP-3 VALUE +0.
    62 77  S1                 PIC S999  COMP-3 VALUE +0.
    63 77  S2                 PIC S999  COMP-3 VALUE +0.
    64 77  E1                 PIC S999  COMP-3 VALUE +0.
    65 77  WS-DUP-EOB-SW      PIC X VALUE ' '.
    66     88  FOUND-DUP-EOB     VALUE 'Y'.
    67*    COPY ELCSCTM.
    68******************************************************************
    69*                                                                *
    70*                                                                *
    71*                            ELCSCTM                             *
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page   3
* EL614.cbl
    72*                            VMOD=2.001                          *
    73*                                                                *
    74*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    75*                                                                *
    76******************************************************************
    77 01  SECURITY-MESSAGE.
    78     12  FILLER                          PIC X(30)
    79            VALUE '** LOGIC SECURITY VIOLATION -'.
    80     12  SM-READ                         PIC X(6).
    81     12  FILLER                          PIC X(5)
    82            VALUE ' PGM='.
    83     12  SM-PGM                          PIC X(6).
    84     12  FILLER                          PIC X(5)
    85            VALUE ' OPR='.
    86     12  SM-PROCESSOR-ID                 PIC X(4).
    87     12  FILLER                          PIC X(6)
    88            VALUE ' TERM='.
    89     12  SM-TERMID                       PIC X(4).
    90     12  FILLER                          PIC XX   VALUE SPACE.
    91     12  SM-JUL-DATE                     PIC 9(5).
    92     12  FILLER                          PIC X    VALUE SPACE.
    93     12  SM-TIME                         PIC 99.99.
    94
    95*    COPY ELCSCRTY.
    96******************************************************************
    97*                                                                *
    98*                                                                *
    99*                            ELCSCRTY                            *
   100*                            VMOD=2.001                          *
   101*                                                                *
   102*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   103*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   104*        SAVED IN PI-SECURITY-ADDRESS.                           *
   105*                                                                *
   106******************************************************************
   107 01  SECURITY-CONTROL.
   108     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   109     12  FILLER                       PIC XX    VALUE 'SC'.
   110     12  SC-CREDIT-CODES.
   111         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   112             20  SC-CREDIT-DISPLAY    PIC X.
   113             20  SC-CREDIT-UPDATE     PIC X.
   114     12  SC-CLAIMS-CODES.
   115         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   116             20  SC-CLAIMS-DISPLAY    PIC X.
   117             20  SC-CLAIMS-UPDATE     PIC X.
   118 01  WS-PASSED-FROM-CALL-PGM     PIC X(60)  VALUE SPACES.
   119 01  WS-DATE-AREA.
   120     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   121    05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   122 01  WS-SELECTED-EOB-CODES.
   123     05  WS-SELECTED-CODES OCCURS 12.
   124         10  WS-SEL-EOB-CODE PIC XXXX.
   125         10  FILLER          PIC X.
   126 01  FILLER                          COMP-3.
   127     05  WS-RECORD-COUNT             PIC S9(3)   VALUE ZERO.
   128     05  WS-READNEXT-SW              PIC S9      VALUE ZERO.
   129     05  WS-LAST-ERROR-COUNT         PIC S9(3)   VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page   4
* EL614.cbl
   130     05  WS-UPDATE-SW                PIC S9      VALUE ZERO.
   131     05  WS-COMPLETED-SUCCESSFUL     PIC S9      VALUE ZERO.
   132       88  TRANSACTION-SUCCESSFUL                    VALUE +1.
   133       88  INITIAL-TRANSACTION                       VALUE +2.
   134       88  CHANGE-SUCCESSFUL                         VALUE +3.
   135     05  TIME-IN                     PIC S9(7)   VALUE ZERO.
   136     05  TIME-OUT                    REDEFINES
   137         TIME-IN                     PIC S9(3)V9(4).
   138
   139     05  WS-BUILD-FORWARD            PIC X       VALUE 'N'.
   140         88 NEEDTOBUILDFORWARD                   VALUE 'Y'.
   141     05  WS-CODE-LOADED              PIC X       VALUE 'N'.
   142         88 CODEALREADYLOADED                    VALUE 'Y'.
   143 01  FILLER                          COMP SYNC.
   144     05  WS-INDEX                    PIC S9(4)   VALUE ZERO.
   145     05  WS-JOURNAL-FILE-ID          PIC S9(4)   VALUE +1.
   146     05  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +773.
   147     05  ELEOBC-LENGTH               PIC S9(4)   VALUE +350.
   148     05  GETMAIN-SPACE               PIC  X      VALUE SPACE.
   149
   150 01  FILLER.
   151     05  QID.
   152         10  QID-TERM            PIC X(4).
   153         10  FILLER              PIC X(4)    VALUE '614A'.
   154     05  QID-ITEM                PIC S9(4)   COMP VALUE +0.
   155     05  MAX-LINES               PIC 999     VALUE 96.
   156     05  NUM-LINES-PER-SCREEN    PIC 99      VALUE 17.
   157     05  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 12.
   158     05  TS-GROUP-WORK           PIC 9(5)    VALUE 0  COMP-3.
   159     05  TS-LENGTH               PIC S9(4)   VALUE +3360 COMP.
   160 01  FILLER.
   161     05  SC-ITEM             PIC S9(4) COMP VALUE +1.
   162     05  DEEDIT-FIELD        PIC  X(10).
   163     05  DEEDIT-FIELD-V0  REDEFINES
   164         DEEDIT-FIELD        PIC S9(10).
   165     05  WS-RESPONSE             PIC S9(8)   COMP.
   166         88  RESP-NORMAL              VALUE +00.
   167         88  RESP-ERROR               VALUE +01.
   168         88  RESP-NOTFND              VALUE +13.
   169         88  RESP-NOTOPEN             VALUE +19.
   170         88  RESP-ENDFILE             VALUE +20.
   171     05  WS-ELEOBC-KEY.
   172         10  WS-COMPANY-CD           PIC X      VALUE LOW-VALUES.
   173         10  WS-EOB-REC-TYPE         PIC X      VALUE LOW-VALUES.
   174         10  WS-EOB-CODE             PIC X(4)   VALUE LOW-VALUES.
   175         10  FILLER                  PIC X(9)   VALUE LOW-VALUES.
   176     05  WS-MAPSET-NAME              PIC X(8)  VALUE 'EL614S'.
   177     05  WS-MAP-NAME                 PIC X(8)  VALUE 'EL614A'.
   178     05  FILLER                      REDEFINES
   179         WS-MAP-NAME.
   180         10  FILLER                  PIC XX.
   181         10  WS-MAP-NUMBER           PIC X(4).
   182         10  FILLER                  PIC XX.
   183     05  THIS-PGM                    PIC X(8)  VALUE 'EL614'.
   184     05  WS-JOURNAL-TYPE-ID          PIC XX      VALUE 'EL'.
   185     05  WS-LOW-VALUES               PIC X VALUE LOW-VALUES.
   186     05  WS-SPACE                    PIC X       VALUE SPACE.
   187     05  WS-TRANS-ID                 PIC X(4)    VALUE 'EXAI'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page   5
* EL614.cbl
   188     05  WS-TEMP-STORAGE-KEY.
   189         10  WS-TS-TERM-ID           PIC X(4)    VALUE 'XXXX'.
   190         10  FILLER                  PIC X(4)    VALUE '614'.
   191     05  WS-REASON-CODE-PASSED       PIC X(26).
   192     05  WS-TABLE-CODE.
   193         10  WS-TAB-CODE-1           PIC X(1).
   194         10  WS-TAB-CODE-2-4         PIC X(3).
   195     05  WS-SCREEN-CODE.
   196         10  WS-SCR-CODE-1-3         PIC X(3).
   197         10  WS-SCR-CODE-4           PIC X(1).
   198     05  WS-ERROR-MESSAGE-AREA.
   199         10  ER-0000                 PIC 9(4)   VALUE 0000.
   200         10  ER-0004                 PIC 9(4)   VALUE 0004.
   201         10  ER-0006                 PIC 9(4)   VALUE 0006.
   202         10  ER-0008                 PIC 9(4)   VALUE 0008.
   203         10  ER-0023                 PIC 9(4)   VALUE 0023.
   204         10  ER-0029                 PIC 9(4)   VALUE 0029.
   205         10  ER-0033                 PIC 9(4)   VALUE 0033.
   206         10  ER-0070                 PIC 9(4)   VALUE 0070.
   207         10  ER-0150                 PIC 9(4)   VALUE 0150.
   208         10  ER-0491                 PIC 9(4)   VALUE 0491.
   209         10  ER-1079                 PIC 9(4)   VALUE 1079.
   210         10  ER-1257                 PIC 9(4)   VALUE 1257.
   211         10  ER-1258                 PIC 9(4)   VALUE 1258.
   212         10  ER-1698                 PIC 9(4)   VALUE 1698.
   213         10  ER-1699                 PIC 9(4)   VALUE 1699.
   214         10  ER-2261                 PIC 9(4)   VALUE 2261.
   215         10  ER-3800                 PIC 9(4)   VALUE 3800.
   216         10  ER-3801                 PIC 9(4)   VALUE 3801.
   217         10  ER-3802                 PIC 9(4)   VALUE 3802.
   218         10  ER-3803                 PIC 9(4)   VALUE 3803.
   219         10  ER-3804                 PIC 9(4)   VALUE 3804.
   220         10  ER-3805                 PIC 9(4)   VALUE 3805.
   221         10  ER-3806                 PIC 9(4)   VALUE 3806.
   222         10  ER-3807                 PIC 9(4)   VALUE 3807.
   223         10  ER-3840                 PIC 9(4)   VALUE 3840.
   224         10  ER-3841                 PIC 9(4)   VALUE 3841.
   225         10  ER-3842                 PIC 9(4)   VALUE 3842.
   226         10  ER-7220                 PIC 9(4)   VALUE 7220.
   227         10  ER-7698                 PIC 9(4)   VALUE 7698.
   228         10  ER-9999                 PIC 9(4)   VALUE 9999.
   229*    COPY ELCINTF.
   230******************************************************************
   231*                                                                *
   232*                                                                *
   233*                            ELCINTF.                            *
   234*                            VMOD=2.017                          *
   235*                                                                *
   236*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   237*                                                                *
   238*       LENGTH = 1024                                            *
   239*                                                                *
   240******************************************************************
   241*                   C H A N G E   L O G
   242*
   243* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   244*-----------------------------------------------------------------
   245*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page   6
* EL614.cbl
   246* EFFECTIVE    NUMBER
   247*-----------------------------------------------------------------
   248* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   249******************************************************************
   250 01  PROGRAM-INTERFACE-BLOCK.
   251     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   252     12  PI-CALLING-PROGRAM              PIC X(8).
   253     12  PI-SAVED-PROGRAM-1              PIC X(8).
   254     12  PI-SAVED-PROGRAM-2              PIC X(8).
   255     12  PI-SAVED-PROGRAM-3              PIC X(8).
   256     12  PI-SAVED-PROGRAM-4              PIC X(8).
   257     12  PI-SAVED-PROGRAM-5              PIC X(8).
   258     12  PI-SAVED-PROGRAM-6              PIC X(8).
   259     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   260     12  PI-COMPANY-ID                   PIC XXX.
   261     12  PI-COMPANY-CD                   PIC X.
   262
   263     12  PI-COMPANY-PASSWORD             PIC X(8).
   264
   265     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   266
   267     12  PI-CONTROL-IN-PROGRESS.
   268         16  PI-CARRIER                  PIC X.
   269         16  PI-GROUPING                 PIC X(6).
   270         16  PI-STATE                    PIC XX.
   271         16  PI-ACCOUNT                  PIC X(10).
   272         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   273                                         PIC X(10).
   274         16  PI-CLAIM-CERT-GRP.
   275             20  PI-CLAIM-NO             PIC X(7).
   276             20  PI-CERT-NO.
   277                 25  PI-CERT-PRIME       PIC X(10).
   278                 25  PI-CERT-SFX         PIC X.
   279             20  PI-CERT-EFF-DT          PIC XX.
   280         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   281             20  PI-PLAN-CODE            PIC X(2).
   282             20  PI-REVISION-NUMBER      PIC X(3).
   283             20  PI-PLAN-EFF-DT          PIC X(2).
   284             20  PI-PLAN-EXP-DT          PIC X(2).
   285             20  FILLER                  PIC X(11).
   286         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   287             20  PI-OE-REFERENCE-1.
   288                 25  PI-OE-REF-1-PRIME   PIC X(18).
   289                 25  PI-OE-REF-1-SUFF    PIC XX.
   290
   291     12  PI-SESSION-IN-PROGRESS          PIC X.
   292         88  CLAIM-SESSION                   VALUE '1'.
   293         88  CREDIT-SESSION                  VALUE '2'.
   294         88  WARRANTY-SESSION                VALUE '3'.
   295         88  MORTGAGE-SESSION                VALUE '4'.
   296         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   297
   298
   299*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   300
   301     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   302     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   303
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page   7
* EL614.cbl
   304     12  PI-CREDIT-USER                  PIC X.
   305         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   306         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   307
   308     12  PI-CLAIM-USER                   PIC X.
   309         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   310         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   311
   312     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   313         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   314         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   315         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   316         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   317         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   318
   319     12  PI-PROCESSOR-ID                 PIC X(4).
   320
   321     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   322
   323     12  PI-MEMBER-CAPTION               PIC X(10).
   324
   325     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   326         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   327
   328     12  PI-LIFE-OVERRIDE-L1             PIC X.
   329     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   330     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   331     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   332
   333     12  PI-AH-OVERRIDE-L1               PIC X.
   334     12  PI-AH-OVERRIDE-L2               PIC XX.
   335     12  PI-AH-OVERRIDE-L6               PIC X(6).
   336     12  PI-AH-OVERRIDE-L12              PIC X(12).
   337
   338     12  PI-NEW-SYSTEM                   PIC X(2).
   339
   340     12  PI-PRIMARY-CERT-NO              PIC X(11).
   341     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   342         88  PI-USES-PAID-TO                 VALUE '1'.
   343     12  PI-CRDTCRD-SYSTEM.
   344         16  PI-CRDTCRD-USER             PIC X.
   345             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   346             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   347         16  PI-CC-MONTH-END-DT          PIC XX.
   348     12  PI-PROCESSOR-PRINTER            PIC X(4).
   349
   350     12  PI-OE-REFERENCE-2.
   351         16  PI-OE-REF-2-PRIME           PIC X(10).
   352         16  PI-OE-REF-2-SUFF            PIC X.
   353
   354     12  PI-REM-TRM-CALC-OPTION          PIC X.
   355
   356     12  PI-LANGUAGE-TYPE                PIC X.
   357             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   358             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   359             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   360
   361     12  PI-POLICY-LINKAGE-IND           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page   8
* EL614.cbl
   362         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   363         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   364                                                   LOW-VALUES.
   365
   366     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   367     12  PI-CLAIM-PW-SESSION             PIC X(1).
   368         88  PI-CLAIM-CREDIT                 VALUE '1'.
   369         88  PI-CLAIM-CONVEN                 VALUE '2'.
   370
   371     12  PI-PROCESSOR-CSR-IND            PIC X.
   372         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   373         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   374
   375     12  FILLER                          PIC X(3).
   376
   377     12  PI-SYSTEM-LEVEL                 PIC X(145).
   378
   379     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   380         PI-SYSTEM-LEVEL.
   381
   382         16  PI-ENTRY-CODES.
   383             20  PI-ENTRY-CD-1           PIC X.
   384             20  PI-ENTRY-CD-2           PIC X.
   385
   386         16  PI-RETURN-CODES.
   387             20  PI-RETURN-CD-1          PIC X.
   388             20  PI-RETURN-CD-2          PIC X.
   389
   390         16  PI-UPDATE-STATUS-SAVE.
   391             20  PI-UPDATE-BY            PIC X(4).
   392             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   393
   394         16  PI-LOWER-CASE-LETTERS       PIC X.
   395             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   396
   397*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   398*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   399*            88  CARRIER-CLM-CNTL            VALUE '2'.
   400
   401         16  PI-CERT-ACCESS-CONTROL      PIC X.
   402             88  ST-ACCNT-CNTL               VALUE ' '.
   403             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   404             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   405             88  ACCNT-CNTL                  VALUE '3'.
   406             88  CARR-ACCNT-CNTL             VALUE '4'.
   407
   408         16  PI-PROCESSOR-CAP-LIST.
   409             20  PI-SYSTEM-CONTROLS.
   410                24 PI-SYSTEM-DISPLAY     PIC X.
   411                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   412                24 PI-SYSTEM-MODIFY      PIC X.
   413                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   414             20  FILLER                  PIC XX.
   415             20  PI-DISPLAY-CAP          PIC X.
   416                 88  DISPLAY-CAP             VALUE 'Y'.
   417             20  PI-MODIFY-CAP           PIC X.
   418                 88  MODIFY-CAP              VALUE 'Y'.
   419             20  PI-MSG-AT-LOGON-CAP     PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page   9
* EL614.cbl
   420                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   421             20  PI-FORCE-CAP            PIC X.
   422                 88  FORCE-CAP               VALUE 'Y'.
   423
   424         16  PI-PROGRAM-CONTROLS.
   425             20  PI-PGM-PRINT-OPT        PIC X.
   426             20  PI-PGM-FORMAT-OPT       PIC X.
   427             20  PI-PGM-PROCESS-OPT      PIC X.
   428             20  PI-PGM-TOTALS-OPT       PIC X.
   429
   430         16  PI-HELP-INTERFACE.
   431             20  PI-LAST-ERROR-NO        PIC X(4).
   432             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   433
   434         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   435             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   436
   437         16  PI-CR-CONTROL-IN-PROGRESS.
   438             20  PI-CR-CARRIER           PIC X.
   439             20  PI-CR-GROUPING          PIC X(6).
   440             20  PI-CR-STATE             PIC XX.
   441             20  PI-CR-ACCOUNT           PIC X(10).
   442             20  PI-CR-FIN-RESP          PIC X(10).
   443             20  PI-CR-TYPE              PIC X.
   444
   445         16  PI-CR-BATCH-NUMBER          PIC X(6).
   446
   447         16  PI-CR-MONTH-END-DT          PIC XX.
   448
   449         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   450             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   451             88  PI-ZERO-CARRIER             VALUE '1'.
   452             88  PI-ZERO-GROUPING            VALUE '2'.
   453             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   454
   455         16  PI-CARRIER-SECURITY         PIC X.
   456             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   457
   458         16  PI-ACCOUNT-SECURITY         PIC X(10).
   459             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   460             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   461
   462         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   463             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   464                                         INDEXED BY PI-ACCESS-NDX
   465                                         PIC X.
   466
   467         16  PI-GA-BILLING-CONTROL       PIC X.
   468             88  PI-GA-BILLING               VALUE '1'.
   469
   470         16  PI-MAIL-PROCESSING          PIC X.
   471             88  PI-MAIL-YES                 VALUE 'Y'.
   472
   473         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   474
   475         16  PI-AR-SYSTEM.
   476             20  PI-AR-PROCESSING-CNTL   PIC X.
   477                 88  PI-AR-PROCESSING        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  10
* EL614.cbl
   478             20  PI-AR-SUMMARY-CODE      PIC X(6).
   479             20  PI-AR-MONTH-END-DT      PIC XX.
   480
   481         16  PI-MP-SYSTEM.
   482             20  PI-MORTGAGE-USER            PIC X.
   483                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   484                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   485             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   486                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   487                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   488                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   489                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   490                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   491             20  PI-MP-MONTH-END-DT          PIC XX.
   492             20  PI-MP-REFERENCE-NO.
   493                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   494                 24  PI-MP-REFERENCE-SFX     PIC XX.
   495
   496         16  PI-LABEL-CONTROL            PIC X(01).
   497             88  PI-CREATE-LABELS                    VALUE 'Y'.
   498             88  PI-BYPASS-LABELS                    VALUE 'N'.
   499
   500         16  PI-BILL-GROUPING-CODE       PIC X(01).
   501             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   502
   503         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   504             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   505             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   506
   507         16  FILLER                      PIC X(14).
   508
   509     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   510******************************************************************
   511     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   512         16  PI-SELECTED-EOB-CODES.
   513             20  PI-SELECTED-CODES OCCURS 12.
   514                 24  PI-EOB-CODE     PIC XXXX.
   515                 24  FILLER          PIC X.
   516         16  PI-1ST-TIME-SW          PIC S9     COMP-3.
   517         16  PI-MODE                 PIC X.
   518             88  ADD-FUNCTION         VALUE 'A'.
   519         16  PI-DN-RCODE             PIC XXXX.
   520         16  PI-DN-TOP-KEY           PIC X(15).
   521         16  PI-DN-BOT-KEY           PIC X(15).
   522         16  PI-DN-KEYS OCCURS 17.
   523             20  PI-DN-KEY           PIC X(15).
   524         16  PI-LINE-COUNT           PIC S9(3)  COMP-3.
   525         16  PI-BROWSE-SW            PIC S9     COMP-3.
   526         16  PI-SHOW-SW              PIC S9     COMP-3.
   527         16  PI-CHANGE-SW            PIC S9     COMP-3.
   528         16  PI-RECORD-TYPE          PIC X.
   529         16  pi-FILLER               PIC X(244).
   530         16  PI-TOTAL-LINES          PIC S9(3).
   531         16  PI-CURRENT-LINE         PIC S9(3)   COMP-3.
   532         16  PI-TOP-LINE-NUM         PIC S9(3)   COMP-3.
   533         16  PI-BOT-LINE-NUM         PIC S9(3)   COMP-3.
   534         16  PI-TEMP-STOR-ITEMS      PIC S9(4)   COMP.
   535         16  PI-REASON-CODE-IND.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  11
* EL614.cbl
   536             20 PI-REASON-CODE-FLAG  OCCURS 26 TIMES PIC X(1).
   537         16  PI-EXPANDED-VIEW        PIC X(1).
   538         16  FILLER                  PIC X(1).
   539*    COPY EL614S.
   540 01  EL614AI.
   541     05  FILLER            PIC  X(0012).
   542*    -------------------------------
   543     05  ADATEL PIC S9(0004) COMP.
   544     05  ADATEF PIC  X(0001).
   545     05  FILLER REDEFINES ADATEF.
   546         10  ADATEA PIC  X(0001).
   547     05  ADATEI PIC  X(0008).
   548*    -------------------------------
   549     05  ATIMEL PIC S9(0004) COMP.
   550     05  ATIMEF PIC  X(0001).
   551     05  FILLER REDEFINES ATIMEF.
   552         10  ATIMEA PIC  X(0001).
   553     05  ATIMEI PIC  X(0005).
   554*    -------------------------------
   555     05  SELHL PIC S9(0004) COMP.
   556     05  SELHF PIC  X(0001).
   557     05  FILLER REDEFINES SELHF.
   558         10  SELHA PIC  X(0001).
   559     05  SELHI PIC  X(0003).
   560*    -------------------------------
   561     05  SEL01L PIC S9(0004) COMP.
   562     05  SEL01F PIC  X(0001).
   563     05  FILLER REDEFINES SEL01F.
   564         10  SEL01A PIC  X(0001).
   565     05  SEL01I PIC  X(0001).
   566*    -------------------------------
   567     05  EOBCD01L PIC S9(0004) COMP.
   568     05  EOBCD01F PIC  X(0001).
   569     05  FILLER REDEFINES EOBCD01F.
   570         10  EOBCD01A PIC  X(0001).
   571     05  EOBCD01I PIC  X(0004).
   572*    -------------------------------
   573     05  DESC01L PIC S9(0004) COMP.
   574     05  DESC01F PIC  X(0001).
   575     05  FILLER REDEFINES DESC01F.
   576         10  DESC01A PIC  X(0001).
   577     05  DESC01I PIC  X(0060).
   578*    -------------------------------
   579     05  SEL02L PIC S9(0004) COMP.
   580     05  SEL02F PIC  X(0001).
   581     05  FILLER REDEFINES SEL02F.
   582         10  SEL02A PIC  X(0001).
   583     05  SEL02I PIC  X(0001).
   584*    -------------------------------
   585     05  EOBCD02L PIC S9(0004) COMP.
   586     05  EOBCD02F PIC  X(0001).
   587     05  FILLER REDEFINES EOBCD02F.
   588         10  EOBCD02A PIC  X(0001).
   589     05  EOBCD02I PIC  X(0004).
   590*    -------------------------------
   591     05  DESC02L PIC S9(0004) COMP.
   592     05  DESC02F PIC  X(0001).
   593     05  FILLER REDEFINES DESC02F.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  12
* EL614.cbl
   594         10  DESC02A PIC  X(0001).
   595     05  DESC02I PIC  X(0060).
   596*    -------------------------------
   597     05  SEL03L PIC S9(0004) COMP.
   598     05  SEL03F PIC  X(0001).
   599     05  FILLER REDEFINES SEL03F.
   600         10  SEL03A PIC  X(0001).
   601     05  SEL03I PIC  X(0001).
   602*    -------------------------------
   603     05  EOBCD03L PIC S9(0004) COMP.
   604     05  EOBCD03F PIC  X(0001).
   605     05  FILLER REDEFINES EOBCD03F.
   606         10  EOBCD03A PIC  X(0001).
   607     05  EOBCD03I PIC  X(0004).
   608*    -------------------------------
   609     05  DESC03L PIC S9(0004) COMP.
   610     05  DESC03F PIC  X(0001).
   611     05  FILLER REDEFINES DESC03F.
   612         10  DESC03A PIC  X(0001).
   613     05  DESC03I PIC  X(0060).
   614*    -------------------------------
   615     05  SEL04L PIC S9(0004) COMP.
   616     05  SEL04F PIC  X(0001).
   617     05  FILLER REDEFINES SEL04F.
   618         10  SEL04A PIC  X(0001).
   619     05  SEL04I PIC  X(0001).
   620*    -------------------------------
   621     05  EOBCD04L PIC S9(0004) COMP.
   622     05  EOBCD04F PIC  X(0001).
   623     05  FILLER REDEFINES EOBCD04F.
   624         10  EOBCD04A PIC  X(0001).
   625     05  EOBCD04I PIC  X(0004).
   626*    -------------------------------
   627     05  DESC04L PIC S9(0004) COMP.
   628     05  DESC04F PIC  X(0001).
   629     05  FILLER REDEFINES DESC04F.
   630         10  DESC04A PIC  X(0001).
   631     05  DESC04I PIC  X(0060).
   632*    -------------------------------
   633     05  SEL05L PIC S9(0004) COMP.
   634     05  SEL05F PIC  X(0001).
   635     05  FILLER REDEFINES SEL05F.
   636         10  SEL05A PIC  X(0001).
   637     05  SEL05I PIC  X(0001).
   638*    -------------------------------
   639     05  EOBCD05L PIC S9(0004) COMP.
   640     05  EOBCD05F PIC  X(0001).
   641     05  FILLER REDEFINES EOBCD05F.
   642         10  EOBCD05A PIC  X(0001).
   643     05  EOBCD05I PIC  X(0004).
   644*    -------------------------------
   645     05  DESC05L PIC S9(0004) COMP.
   646     05  DESC05F PIC  X(0001).
   647     05  FILLER REDEFINES DESC05F.
   648         10  DESC05A PIC  X(0001).
   649     05  DESC05I PIC  X(0060).
   650*    -------------------------------
   651     05  SEL06L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  13
* EL614.cbl
   652     05  SEL06F PIC  X(0001).
   653     05  FILLER REDEFINES SEL06F.
   654         10  SEL06A PIC  X(0001).
   655     05  SEL06I PIC  X(0001).
   656*    -------------------------------
   657     05  EOBCD06L PIC S9(0004) COMP.
   658     05  EOBCD06F PIC  X(0001).
   659     05  FILLER REDEFINES EOBCD06F.
   660         10  EOBCD06A PIC  X(0001).
   661     05  EOBCD06I PIC  X(0004).
   662*    -------------------------------
   663     05  DESC06L PIC S9(0004) COMP.
   664     05  DESC06F PIC  X(0001).
   665     05  FILLER REDEFINES DESC06F.
   666         10  DESC06A PIC  X(0001).
   667     05  DESC06I PIC  X(0060).
   668*    -------------------------------
   669     05  SEL07L PIC S9(0004) COMP.
   670     05  SEL07F PIC  X(0001).
   671     05  FILLER REDEFINES SEL07F.
   672         10  SEL07A PIC  X(0001).
   673     05  SEL07I PIC  X(0001).
   674*    -------------------------------
   675     05  EOBCD07L PIC S9(0004) COMP.
   676     05  EOBCD07F PIC  X(0001).
   677     05  FILLER REDEFINES EOBCD07F.
   678         10  EOBCD07A PIC  X(0001).
   679     05  EOBCD07I PIC  X(0004).
   680*    -------------------------------
   681     05  DESC07L PIC S9(0004) COMP.
   682     05  DESC07F PIC  X(0001).
   683     05  FILLER REDEFINES DESC07F.
   684         10  DESC07A PIC  X(0001).
   685     05  DESC07I PIC  X(0060).
   686*    -------------------------------
   687     05  SEL08L PIC S9(0004) COMP.
   688     05  SEL08F PIC  X(0001).
   689     05  FILLER REDEFINES SEL08F.
   690         10  SEL08A PIC  X(0001).
   691     05  SEL08I PIC  X(0001).
   692*    -------------------------------
   693     05  EOBCD08L PIC S9(0004) COMP.
   694     05  EOBCD08F PIC  X(0001).
   695     05  FILLER REDEFINES EOBCD08F.
   696         10  EOBCD08A PIC  X(0001).
   697     05  EOBCD08I PIC  X(0004).
   698*    -------------------------------
   699     05  DESC08L PIC S9(0004) COMP.
   700     05  DESC08F PIC  X(0001).
   701     05  FILLER REDEFINES DESC08F.
   702         10  DESC08A PIC  X(0001).
   703     05  DESC08I PIC  X(0060).
   704*    -------------------------------
   705     05  SEL09L PIC S9(0004) COMP.
   706     05  SEL09F PIC  X(0001).
   707     05  FILLER REDEFINES SEL09F.
   708         10  SEL09A PIC  X(0001).
   709     05  SEL09I PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  14
* EL614.cbl
   710*    -------------------------------
   711     05  EOBCD09L PIC S9(0004) COMP.
   712     05  EOBCD09F PIC  X(0001).
   713     05  FILLER REDEFINES EOBCD09F.
   714         10  EOBCD09A PIC  X(0001).
   715     05  EOBCD09I PIC  X(0004).
   716*    -------------------------------
   717     05  DESC09L PIC S9(0004) COMP.
   718     05  DESC09F PIC  X(0001).
   719     05  FILLER REDEFINES DESC09F.
   720         10  DESC09A PIC  X(0001).
   721     05  DESC09I PIC  X(0060).
   722*    -------------------------------
   723     05  SEL10L PIC S9(0004) COMP.
   724     05  SEL10F PIC  X(0001).
   725     05  FILLER REDEFINES SEL10F.
   726         10  SEL10A PIC  X(0001).
   727     05  SEL10I PIC  X(0001).
   728*    -------------------------------
   729     05  EOBCD10L PIC S9(0004) COMP.
   730     05  EOBCD10F PIC  X(0001).
   731     05  FILLER REDEFINES EOBCD10F.
   732         10  EOBCD10A PIC  X(0001).
   733     05  EOBCD10I PIC  X(0004).
   734*    -------------------------------
   735     05  DESC10L PIC S9(0004) COMP.
   736     05  DESC10F PIC  X(0001).
   737     05  FILLER REDEFINES DESC10F.
   738         10  DESC10A PIC  X(0001).
   739     05  DESC10I PIC  X(0060).
   740*    -------------------------------
   741     05  SEL11L PIC S9(0004) COMP.
   742     05  SEL11F PIC  X(0001).
   743     05  FILLER REDEFINES SEL11F.
   744         10  SEL11A PIC  X(0001).
   745     05  SEL11I PIC  X(0001).
   746*    -------------------------------
   747     05  EOBCD11L PIC S9(0004) COMP.
   748     05  EOBCD11F PIC  X(0001).
   749     05  FILLER REDEFINES EOBCD11F.
   750         10  EOBCD11A PIC  X(0001).
   751     05  EOBCD11I PIC  X(0004).
   752*    -------------------------------
   753     05  DESC11L PIC S9(0004) COMP.
   754     05  DESC11F PIC  X(0001).
   755     05  FILLER REDEFINES DESC11F.
   756         10  DESC11A PIC  X(0001).
   757     05  DESC11I PIC  X(0060).
   758*    -------------------------------
   759     05  SEL12L PIC S9(0004) COMP.
   760     05  SEL12F PIC  X(0001).
   761     05  FILLER REDEFINES SEL12F.
   762         10  SEL12A PIC  X(0001).
   763     05  SEL12I PIC  X(0001).
   764*    -------------------------------
   765     05  EOBCD12L PIC S9(0004) COMP.
   766     05  EOBCD12F PIC  X(0001).
   767     05  FILLER REDEFINES EOBCD12F.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  15
* EL614.cbl
   768         10  EOBCD12A PIC  X(0001).
   769     05  EOBCD12I PIC  X(0004).
   770*    -------------------------------
   771     05  DESC12L PIC S9(0004) COMP.
   772     05  DESC12F PIC  X(0001).
   773     05  FILLER REDEFINES DESC12F.
   774         10  DESC12A PIC  X(0001).
   775     05  DESC12I PIC  X(0060).
   776*    -------------------------------
   777     05  SEL13L PIC S9(0004) COMP.
   778     05  SEL13F PIC  X(0001).
   779     05  FILLER REDEFINES SEL13F.
   780         10  SEL13A PIC  X(0001).
   781     05  SEL13I PIC  X(0001).
   782*    -------------------------------
   783     05  EOBCD13L PIC S9(0004) COMP.
   784     05  EOBCD13F PIC  X(0001).
   785     05  FILLER REDEFINES EOBCD13F.
   786         10  EOBCD13A PIC  X(0001).
   787     05  EOBCD13I PIC  X(0004).
   788*    -------------------------------
   789     05  DESC13L PIC S9(0004) COMP.
   790     05  DESC13F PIC  X(0001).
   791     05  FILLER REDEFINES DESC13F.
   792         10  DESC13A PIC  X(0001).
   793     05  DESC13I PIC  X(0060).
   794*    -------------------------------
   795     05  SEL14L PIC S9(0004) COMP.
   796     05  SEL14F PIC  X(0001).
   797     05  FILLER REDEFINES SEL14F.
   798         10  SEL14A PIC  X(0001).
   799     05  SEL14I PIC  X(0001).
   800*    -------------------------------
   801     05  EOBCD14L PIC S9(0004) COMP.
   802     05  EOBCD14F PIC  X(0001).
   803     05  FILLER REDEFINES EOBCD14F.
   804         10  EOBCD14A PIC  X(0001).
   805     05  EOBCD14I PIC  X(0004).
   806*    -------------------------------
   807     05  DESC14L PIC S9(0004) COMP.
   808     05  DESC14F PIC  X(0001).
   809     05  FILLER REDEFINES DESC14F.
   810         10  DESC14A PIC  X(0001).
   811     05  DESC14I PIC  X(0060).
   812*    -------------------------------
   813     05  SEL15L PIC S9(0004) COMP.
   814     05  SEL15F PIC  X(0001).
   815     05  FILLER REDEFINES SEL15F.
   816         10  SEL15A PIC  X(0001).
   817     05  SEL15I PIC  X(0001).
   818*    -------------------------------
   819     05  EOBCD15L PIC S9(0004) COMP.
   820     05  EOBCD15F PIC  X(0001).
   821     05  FILLER REDEFINES EOBCD15F.
   822         10  EOBCD15A PIC  X(0001).
   823     05  EOBCD15I PIC  X(0004).
   824*    -------------------------------
   825     05  DESC15L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  16
* EL614.cbl
   826     05  DESC15F PIC  X(0001).
   827     05  FILLER REDEFINES DESC15F.
   828         10  DESC15A PIC  X(0001).
   829     05  DESC15I PIC  X(0060).
   830*    -------------------------------
   831     05  SEL16L PIC S9(0004) COMP.
   832     05  SEL16F PIC  X(0001).
   833     05  FILLER REDEFINES SEL16F.
   834         10  SEL16A PIC  X(0001).
   835     05  SEL16I PIC  X(0001).
   836*    -------------------------------
   837     05  EOBCD16L PIC S9(0004) COMP.
   838     05  EOBCD16F PIC  X(0001).
   839     05  FILLER REDEFINES EOBCD16F.
   840         10  EOBCD16A PIC  X(0001).
   841     05  EOBCD16I PIC  X(0004).
   842*    -------------------------------
   843     05  DESC16L PIC S9(0004) COMP.
   844     05  DESC16F PIC  X(0001).
   845     05  FILLER REDEFINES DESC16F.
   846         10  DESC16A PIC  X(0001).
   847     05  DESC16I PIC  X(0060).
   848*    -------------------------------
   849     05  SEL17L PIC S9(0004) COMP.
   850     05  SEL17F PIC  X(0001).
   851     05  FILLER REDEFINES SEL17F.
   852         10  SEL17A PIC  X(0001).
   853     05  SEL17I PIC  X(0001).
   854*    -------------------------------
   855     05  EOBCD17L PIC S9(0004) COMP.
   856     05  EOBCD17F PIC  X(0001).
   857     05  FILLER REDEFINES EOBCD17F.
   858         10  EOBCD17A PIC  X(0001).
   859     05  EOBCD17I PIC  X(0004).
   860*    -------------------------------
   861     05  DESC17L PIC S9(0004) COMP.
   862     05  DESC17F PIC  X(0001).
   863     05  FILLER REDEFINES DESC17F.
   864         10  DESC17A PIC  X(0001).
   865     05  DESC17I PIC  X(0060).
   866*    -------------------------------
   867     05  AEMSGL PIC S9(0004) COMP.
   868     05  AEMSGF PIC  X(0001).
   869     05  FILLER REDEFINES AEMSGF.
   870         10  AEMSGA PIC  X(0001).
   871     05  AEMSGI PIC  X(0079).
   872*    -------------------------------
   873     05  APFKL PIC S9(0004) COMP.
   874     05  APFKF PIC  X(0001).
   875     05  FILLER REDEFINES APFKF.
   876         10  APFKA PIC  X(0001).
   877     05  APFKI PIC  S99.
   878*    -------------------------------
   879     05  F3KEYL PIC S9(0004) COMP.
   880     05  F3KEYF PIC  X(0001).
   881     05  FILLER REDEFINES F3KEYF.
   882         10  F3KEYA PIC  X(0001).
   883     05  F3KEYI PIC  X(0019).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  17
* EL614.cbl
   884*    -------------------------------
   885     05  F5KEYL PIC S9(0004) COMP.
   886     05  F5KEYF PIC  X(0001).
   887     05  FILLER REDEFINES F5KEYF.
   888         10  F5KEYA PIC  X(0001).
   889     05  F5KEYI PIC  X(0025).
   890 01  EL614AO REDEFINES EL614AI.
   891     05  FILLER            PIC  X(0012).
   892*    -------------------------------
   893     05  FILLER            PIC  X(0003).
   894     05  ADATEO PIC  X(0008).
   895*    -------------------------------
   896     05  FILLER            PIC  X(0003).
   897     05  ATIMEO PIC  99.99.
   898*    -------------------------------
   899     05  FILLER            PIC  X(0003).
   900     05  SELHO PIC  X(0003).
   901*    -------------------------------
   902     05  FILLER            PIC  X(0003).
   903     05  SEL01O PIC  X(0001).
   904*    -------------------------------
   905     05  FILLER            PIC  X(0003).
   906     05  EOBCD01O PIC  X(0004).
   907*    -------------------------------
   908     05  FILLER            PIC  X(0003).
   909     05  DESC01O PIC  X(0060).
   910*    -------------------------------
   911     05  FILLER            PIC  X(0003).
   912     05  SEL02O PIC  X(0001).
   913*    -------------------------------
   914     05  FILLER            PIC  X(0003).
   915     05  EOBCD02O PIC  X(0004).
   916*    -------------------------------
   917     05  FILLER            PIC  X(0003).
   918     05  DESC02O PIC  X(0060).
   919*    -------------------------------
   920     05  FILLER            PIC  X(0003).
   921     05  SEL03O PIC  X(0001).
   922*    -------------------------------
   923     05  FILLER            PIC  X(0003).
   924     05  EOBCD03O PIC  X(0004).
   925*    -------------------------------
   926     05  FILLER            PIC  X(0003).
   927     05  DESC03O PIC  X(0060).
   928*    -------------------------------
   929     05  FILLER            PIC  X(0003).
   930     05  SEL04O PIC  X(0001).
   931*    -------------------------------
   932     05  FILLER            PIC  X(0003).
   933     05  EOBCD04O PIC  X(0004).
   934*    -------------------------------
   935     05  FILLER            PIC  X(0003).
   936     05  DESC04O PIC  X(0060).
   937*    -------------------------------
   938     05  FILLER            PIC  X(0003).
   939     05  SEL05O PIC  X(0001).
   940*    -------------------------------
   941     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  18
* EL614.cbl
   942     05  EOBCD05O PIC  X(0004).
   943*    -------------------------------
   944     05  FILLER            PIC  X(0003).
   945     05  DESC05O PIC  X(0060).
   946*    -------------------------------
   947     05  FILLER            PIC  X(0003).
   948     05  SEL06O PIC  X(0001).
   949*    -------------------------------
   950     05  FILLER            PIC  X(0003).
   951     05  EOBCD06O PIC  X(0004).
   952*    -------------------------------
   953     05  FILLER            PIC  X(0003).
   954     05  DESC06O PIC  X(0060).
   955*    -------------------------------
   956     05  FILLER            PIC  X(0003).
   957     05  SEL07O PIC  X(0001).
   958*    -------------------------------
   959     05  FILLER            PIC  X(0003).
   960     05  EOBCD07O PIC  X(0004).
   961*    -------------------------------
   962     05  FILLER            PIC  X(0003).
   963     05  DESC07O PIC  X(0060).
   964*    -------------------------------
   965     05  FILLER            PIC  X(0003).
   966     05  SEL08O PIC  X(0001).
   967*    -------------------------------
   968     05  FILLER            PIC  X(0003).
   969     05  EOBCD08O PIC  X(0004).
   970*    -------------------------------
   971     05  FILLER            PIC  X(0003).
   972     05  DESC08O PIC  X(0060).
   973*    -------------------------------
   974     05  FILLER            PIC  X(0003).
   975     05  SEL09O PIC  X(0001).
   976*    -------------------------------
   977     05  FILLER            PIC  X(0003).
   978     05  EOBCD09O PIC  X(0004).
   979*    -------------------------------
   980     05  FILLER            PIC  X(0003).
   981     05  DESC09O PIC  X(0060).
   982*    -------------------------------
   983     05  FILLER            PIC  X(0003).
   984     05  SEL10O PIC  X(0001).
   985*    -------------------------------
   986     05  FILLER            PIC  X(0003).
   987     05  EOBCD10O PIC  X(0004).
   988*    -------------------------------
   989     05  FILLER            PIC  X(0003).
   990     05  DESC10O PIC  X(0060).
   991*    -------------------------------
   992     05  FILLER            PIC  X(0003).
   993     05  SEL11O PIC  X(0001).
   994*    -------------------------------
   995     05  FILLER            PIC  X(0003).
   996     05  EOBCD11O PIC  X(0004).
   997*    -------------------------------
   998     05  FILLER            PIC  X(0003).
   999     05  DESC11O PIC  X(0060).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  19
* EL614.cbl
  1000*    -------------------------------
  1001     05  FILLER            PIC  X(0003).
  1002     05  SEL12O PIC  X(0001).
  1003*    -------------------------------
  1004     05  FILLER            PIC  X(0003).
  1005     05  EOBCD12O PIC  X(0004).
  1006*    -------------------------------
  1007     05  FILLER            PIC  X(0003).
  1008     05  DESC12O PIC  X(0060).
  1009*    -------------------------------
  1010     05  FILLER            PIC  X(0003).
  1011     05  SEL13O PIC  X(0001).
  1012*    -------------------------------
  1013     05  FILLER            PIC  X(0003).
  1014     05  EOBCD13O PIC  X(0004).
  1015*    -------------------------------
  1016     05  FILLER            PIC  X(0003).
  1017     05  DESC13O PIC  X(0060).
  1018*    -------------------------------
  1019     05  FILLER            PIC  X(0003).
  1020     05  SEL14O PIC  X(0001).
  1021*    -------------------------------
  1022     05  FILLER            PIC  X(0003).
  1023     05  EOBCD14O PIC  X(0004).
  1024*    -------------------------------
  1025     05  FILLER            PIC  X(0003).
  1026     05  DESC14O PIC  X(0060).
  1027*    -------------------------------
  1028     05  FILLER            PIC  X(0003).
  1029     05  SEL15O PIC  X(0001).
  1030*    -------------------------------
  1031     05  FILLER            PIC  X(0003).
  1032     05  EOBCD15O PIC  X(0004).
  1033*    -------------------------------
  1034     05  FILLER            PIC  X(0003).
  1035     05  DESC15O PIC  X(0060).
  1036*    -------------------------------
  1037     05  FILLER            PIC  X(0003).
  1038     05  SEL16O PIC  X(0001).
  1039*    -------------------------------
  1040     05  FILLER            PIC  X(0003).
  1041     05  EOBCD16O PIC  X(0004).
  1042*    -------------------------------
  1043     05  FILLER            PIC  X(0003).
  1044     05  DESC16O PIC  X(0060).
  1045*    -------------------------------
  1046     05  FILLER            PIC  X(0003).
  1047     05  SEL17O PIC  X(0001).
  1048*    -------------------------------
  1049     05  FILLER            PIC  X(0003).
  1050     05  EOBCD17O PIC  X(0004).
  1051*    -------------------------------
  1052     05  FILLER            PIC  X(0003).
  1053     05  DESC17O PIC  X(0060).
  1054*    -------------------------------
  1055     05  FILLER            PIC  X(0003).
  1056     05  AEMSGO PIC  X(0079).
  1057*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  20
* EL614.cbl
  1058     05  FILLER            PIC  X(0003).
  1059     05  APFKO PIC  X(0002).
  1060*    -------------------------------
  1061     05  FILLER            PIC  X(0003).
  1062     05  F3KEYO PIC  X(0019).
  1063*    -------------------------------
  1064     05  FILLER            PIC  X(0003).
  1065     05  F5KEYO PIC  X(0025).
  1066*    -------------------------------
  1067 01  EL614AO-R REDEFINES EL614AI.
  1068     05  FILLER                      PIC X(37).
  1069     05  WS-MAP-LINE                 OCCURS 17
  1070                                     INDEXED BY M1 M2 N1.
  1071         10  SELL                    PIC S9(4)  COMP.
  1072         10  SELA                    PIC X.
  1073         10  SELI                    PIC X.
  1074         10  RCODEL                  PIC S9(4)  COMP.
  1075         10  RCODEA                  PIC X.
  1076         10  RCODEO                  PIC XXXX.
  1077         10  RCODEI                  REDEFINES
  1078             RCODEO                  PIC XXXX.
  1079         10  DESCL                   PIC S9(4)   COMP.
  1080         10  DESCA                   PIC X.
  1081         10  DESCO                   PIC X(60).
  1082         10  DESCI                   REDEFINES
  1083             DESCO                   PIC X(60).
  1084     05  FILLER                      PIC X(137).
  1085*    COPY ELCJPFX.
  1086******************************************************************
  1087*                                                                *
  1088*                                                                *
  1089*                            ELCJPFX.                            *
  1090*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1091*                            VMOD=2.002                          *
  1092*                                                                *
  1093*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1094*                                                                *
  1095*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1096*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1097*        ELCNTL - CONTROL FILE                                   *
  1098*        ELMSTR - CLAIM MASTERS                                  *
  1099*        ELTRLR - ACTIVITY TRAILERS                              *
  1100*        ELCHKQ - CHECK QUE                                      *
  1101******************************************************************
  1102 01  JOURNAL-RECORD.
  1103     12  jp-date                     pic s9(5) comp-3.
  1104     12  jp-time                     pic s9(7) comp-3.
  1105     12  JP-USER-ID                  PIC X(4).
  1106     12  JP-FILE-ID                  PIC X(8).
  1107     12  JP-PROGRAM-ID               PIC X(8).
  1108     12  JP-RECORD-TYPE              PIC X.
  1109         88 JP-ADD              VALUE 'A'.
  1110         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1111         88 JP-AFTER-CHANGE     VALUE 'C'.
  1112         88 JP-DELETE           VALUE 'D'.
  1113         88 JP-GENERIC-DELETE   VALUE 'G'.
  1114         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1115         88 JP-KEY-CHG-ADD      VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  21
* EL614.cbl
  1116     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1117     12  JP-RECORD-AREA
  1118
  1119
  1120                                     PIC X(750).
  1121*                                COPY ELCEOBC.
  1122******************************************************************
  1123*                                                                *
  1124*                                                                *
  1125*                            ELCEOBC                             *
  1126*                            VMOD=2.001                          *
  1127*                                                                *
  1128*   CLAIM SYSTEM EOB CODE TABLE                                  *
  1129*                                                                *
  1130*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1131*   VSAM EOB CODE TABLE                                          *
  1132*                                                                *
  1133*   FILE DESCRIPTION = EOB CODE TABLE                            *
  1134*                                                                *
  1135*   FILE TYPE = VSAM,KSDS                                        *
  1136*   RECORD SIZE = 350   RECFORM = FIX                            *
  1137*                                                                *
  1138*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  1139*                                                                *
  1140*   LOG = NO                                                     *
  1141*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1142*                                                                *
  1143*                                                                *
  1144******************************************************************
  1145*                   C H A N G E   L O G
  1146*
  1147* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1148*-----------------------------------------------------------------
  1149*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1150* EFFECTIVE    NUMBER
  1151*-----------------------------------------------------------------
  1152* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  1153* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  1154* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  1155******************************************************************
  1156 01  EOB-CODES.
  1157     12  EO-RECORD-ID                      PIC XX.
  1158         88  VALID-DN-ID                      VALUE 'EO'.
  1159     12  EO-CONTROL-PRIMARY.
  1160         16  EO-COMPANY-CD                 PIC X.
  1161         16  EO-RECORD-TYPE                PIC X.
  1162             88  EO-EOB-RECS                  VALUE '1'.
  1163             88  EO-VERIF-RECS                VALUE '2'.
  1164             88  EO-GCE-RECS                  VALUE '3'.
  1165             88  EO-CANC-RECS                 VALUE '4'.
  1166             88  EO-BILL-NOTE-RECS            VALUE '5'.
  1167         16  EO-EOB-CODE                   PIC X(4).
  1168         16  FILLER                        PIC X(9).
  1169     12  EO-MAINT-INFORMATION.
  1170         16  EO-LAST-MAINT-DT              PIC XX.
  1171         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1172         16  EO-LAST-MAINT-USER            PIC X(4).
  1173         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  22
* EL614.cbl
  1174     12  EO-DESCRIPTION                    PIC X(275).
  1175     12  FILLER                            PIC X(46).
  1176******************************************************************
  1177*    COPY ELCEMIB.
  1178******************************************************************
  1179*                                                                *
  1180*                                                                *
  1181*                            ELCEMIB.                            *
  1182*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1183*                            VMOD=2.005                          *
  1184*                                                                *
  1185*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1186*                                                                *
  1187******************************************************************
  1188 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1189     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1190     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1191     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1192     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1193     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1194     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1195     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1196     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1197     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1198         88  EMI-NO-ERRORS                    VALUE '1'.
  1199         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1200         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1201     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1202         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1203     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1204         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1205         88  EMI-AREA1-FULL                   VALUE '2'.
  1206     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1207         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1208         88  EMI-AREA2-FULL                   VALUE '2'.
  1209     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1210         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1211         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1212         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1213         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1214         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1215     12  EMI-ERROR-LINES.
  1216         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1217         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1218         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1219         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1220             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1221                 24  EMI-ERR-NUM         PIC X(4).
  1222                 24  EMI-FILLER          PIC X.
  1223                 24  EMI-SEV             PIC X.
  1224                 24  FILLER              PIC X.
  1225             20  FILLER                  PIC X(02).
  1226     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1227         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1228             20  EMI-ERROR-NUMBER    PIC X(4).
  1229             20  EMI-FILL            PIC X.
  1230             20  EMI-SEVERITY        PIC X.
  1231             20  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  23
* EL614.cbl
  1232             20  EMI-ERROR-TEXT.
  1233                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1234                 24  FILLER          PIC X(55).
  1235     12  EMI-SEVERITY-SAVE           PIC X.
  1236         88  EMI-NOTE                    VALUE 'N'.
  1237         88  EMI-WARNING                 VALUE 'W'.
  1238         88  EMI-FORCABLE                VALUE 'F'.
  1239         88  EMI-FATAL                   VALUE 'X'.
  1240     12  EMI-MESSAGE-FLAG            PIC X.
  1241         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1242         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1243     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1244     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1245         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1246         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1247         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1248     12  emi-claim-no                pic x(7).
  1249     12  emi-claim-type              pic x(6).
  1250     12  FILLER                      PIC X(124)  VALUE SPACES.
  1251     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1252     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1253     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1254     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1255*    COPY ELCDATE.
  1256******************************************************************
  1257*                                                                *
  1258*                                                                *
  1259*                            ELCDATE.                            *
  1260*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1261*                            VMOD=2.003
  1262*                                                                *
  1263*                                                                *
  1264*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1265*                 LENGTH = 200                                   *
  1266******************************************************************
  1267
  1268 01  DATE-CONVERSION-DATA.
  1269     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1270     12  DC-OPTION-CODE                PIC X.
  1271         88  BIN-TO-GREG                VALUE ' '.
  1272         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1273         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1274         88  YMD-GREG-TO-BIN            VALUE '3'.
  1275         88  MDY-GREG-TO-BIN            VALUE '4'.
  1276         88  JULIAN-TO-BIN              VALUE '5'.
  1277         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1278         88  FIND-CENTURY               VALUE '7'.
  1279         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1280         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1281         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1282         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1283         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1284         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1285         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1286         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1287         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1288         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1289         88  CHECK-LEAP-YEAR            VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  24
* EL614.cbl
  1290         88  BIN-3-TO-GREG              VALUE 'I'.
  1291         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1292         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1293         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1294         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1295         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1296         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1297         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1298         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1299         88  THREE-CHARACTER-BIN
  1300                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1301         88  GREGORIAN-TO-BIN
  1302                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1303         88  BIN-TO-GREGORIAN
  1304                  VALUES ' ' '1' 'I' '8' 'G'.
  1305         88  JULIAN-TO-BINARY
  1306                  VALUES '5' 'C' 'E' 'F'.
  1307     12  DC-ERROR-CODE                 PIC X.
  1308         88  NO-CONVERSION-ERROR        VALUE ' '.
  1309         88  DATE-CONVERSION-ERROR
  1310                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1311         88  DATE-IS-ZERO               VALUE '1'.
  1312         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1313         88  DATE-IS-INVALID            VALUE '3'.
  1314         88  DATE1-GREATER-DATE2        VALUE '4'.
  1315         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1316         88  DATE-INVALID-OPTION        VALUE '9'.
  1317         88  INVALID-CENTURY            VALUE 'A'.
  1318         88  ONLY-CENTURY               VALUE 'B'.
  1319         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1320         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1321     12  DC-END-OF-MONTH               PIC X.
  1322         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1323     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1324         88  USE-NORMAL-PROCESS         VALUE ' '.
  1325         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1326         88  ADJUST-UP-100-YRS          VALUE '2'.
  1327     12  FILLER                        PIC X.
  1328     12  DC-CONVERSION-DATES.
  1329         16  DC-BIN-DATE-1             PIC XX.
  1330         16  DC-BIN-DATE-2             PIC XX.
  1331         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1332         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1333                       DC-GREG-DATE-1-EDIT.
  1334             20  DC-EDIT1-MONTH        PIC 99.
  1335             20  SLASH1-1              PIC X.
  1336             20  DC-EDIT1-DAY          PIC 99.
  1337             20  SLASH1-2              PIC X.
  1338             20  DC-EDIT1-YEAR         PIC 99.
  1339         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1340         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1341                     DC-GREG-DATE-2-EDIT.
  1342             20  DC-EDIT2-MONTH        PIC 99.
  1343             20  SLASH2-1              PIC X.
  1344             20  DC-EDIT2-DAY          PIC 99.
  1345             20  SLASH2-2              PIC X.
  1346             20  DC-EDIT2-YEAR         PIC 99.
  1347         16  DC-GREG-DATE-1-YMD        PIC 9(06).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  25
* EL614.cbl
  1348         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1349                     DC-GREG-DATE-1-YMD.
  1350             20  DC-YMD-YEAR           PIC 99.
  1351             20  DC-YMD-MONTH          PIC 99.
  1352             20  DC-YMD-DAY            PIC 99.
  1353         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1354         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1355                      DC-GREG-DATE-1-MDY.
  1356             20  DC-MDY-MONTH          PIC 99.
  1357             20  DC-MDY-DAY            PIC 99.
  1358             20  DC-MDY-YEAR           PIC 99.
  1359         16  DC-GREG-DATE-1-ALPHA.
  1360             20  DC-ALPHA-MONTH        PIC X(10).
  1361             20  DC-ALPHA-DAY          PIC 99.
  1362             20  FILLER                PIC XX.
  1363             20  DC-ALPHA-CENTURY.
  1364                 24 DC-ALPHA-CEN-N     PIC 99.
  1365             20  DC-ALPHA-YEAR         PIC 99.
  1366         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1367         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1368         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1369         16  DC-JULIAN-DATE            PIC 9(05).
  1370         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1371                                       PIC 9(05).
  1372         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1373             20  DC-JULIAN-YEAR        PIC 99.
  1374             20  DC-JULIAN-DAYS        PIC 999.
  1375         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1376         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1377         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1378     12  DATE-CONVERSION-VARIBLES.
  1379         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1380         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1381             20  FILLER                PIC 9(3).
  1382             20  HOLD-CEN-1-CCYY.
  1383                 24  HOLD-CEN-1-CC     PIC 99.
  1384                 24  HOLD-CEN-1-YY     PIC 99.
  1385             20  HOLD-CEN-1-MO         PIC 99.
  1386             20  HOLD-CEN-1-DA         PIC 99.
  1387         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1388             20  HOLD-CEN-1-R-MO       PIC 99.
  1389             20  HOLD-CEN-1-R-DA       PIC 99.
  1390             20  HOLD-CEN-1-R-CCYY.
  1391                 24  HOLD-CEN-1-R-CC   PIC 99.
  1392                 24  HOLD-CEN-1-R-YY   PIC 99.
  1393             20  FILLER                PIC 9(3).
  1394         16  HOLD-CENTURY-1-X.
  1395             20  FILLER                PIC X(3)  VALUE SPACES.
  1396             20  HOLD-CEN-1-X-CCYY.
  1397                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1398                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1399             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1400             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1401         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1402             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1403             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1404             20  HOLD-CEN-1-R-X-CCYY.
  1405                 24  HOLD-CEN-1-R-X-CC PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  26
* EL614.cbl
  1406                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1407             20  FILLER                PIC XXX.
  1408         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1409         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1410         16  DC-JULIAN-DATE-1          PIC 9(07).
  1411         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1412             20  DC-JULIAN-1-CCYY.
  1413                 24  DC-JULIAN-1-CC    PIC 99.
  1414                 24  DC-JULIAN-1-YR    PIC 99.
  1415             20  DC-JULIAN-DA-1        PIC 999.
  1416         16  DC-JULIAN-DATE-2          PIC 9(07).
  1417         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1418             20  DC-JULIAN-2-CCYY.
  1419                 24  DC-JULIAN-2-CC    PIC 99.
  1420                 24  DC-JULIAN-2-YR    PIC 99.
  1421             20  DC-JULIAN-DA-2        PIC 999.
  1422         16  DC-GREG-DATE-A-EDIT.
  1423             20  DC-EDITA-MONTH        PIC 99.
  1424             20  SLASHA-1              PIC X VALUE '/'.
  1425             20  DC-EDITA-DAY          PIC 99.
  1426             20  SLASHA-2              PIC X VALUE '/'.
  1427             20  DC-EDITA-CCYY.
  1428                 24  DC-EDITA-CENT     PIC 99.
  1429                 24  DC-EDITA-YEAR     PIC 99.
  1430         16  DC-GREG-DATE-B-EDIT.
  1431             20  DC-EDITB-MONTH        PIC 99.
  1432             20  SLASHB-1              PIC X VALUE '/'.
  1433             20  DC-EDITB-DAY          PIC 99.
  1434             20  SLASHB-2              PIC X VALUE '/'.
  1435             20  DC-EDITB-CCYY.
  1436                 24  DC-EDITB-CENT     PIC 99.
  1437                 24  DC-EDITB-YEAR     PIC 99.
  1438         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1439         16  DC-GREG-DATE-CYMD-R REDEFINES
  1440                              DC-GREG-DATE-CYMD.
  1441             20  DC-CYMD-CEN           PIC 99.
  1442             20  DC-CYMD-YEAR          PIC 99.
  1443             20  DC-CYMD-MONTH         PIC 99.
  1444             20  DC-CYMD-DAY           PIC 99.
  1445         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1446         16  DC-GREG-DATE-MDCY-R REDEFINES
  1447                              DC-GREG-DATE-MDCY.
  1448             20  DC-MDCY-MONTH         PIC 99.
  1449             20  DC-MDCY-DAY           PIC 99.
  1450             20  DC-MDCY-CEN           PIC 99.
  1451             20  DC-MDCY-YEAR          PIC 99.
  1452    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1453        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1454    12  DC-EL310-DATE                  PIC X(21).
  1455    12  FILLER                         PIC X(28).
  1456*    COPY ELCLOGOF.
  1457******************************************************************
  1458*                                                                *
  1459*                                                                *
  1460*                            ELCLOGOF.                           *
  1461*                            VMOD=2.001                          *
  1462*                                                                *
  1463*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  27
* EL614.cbl
  1464*                                                                *
  1465******************************************************************
  1466 01  CLASIC-LOGOFF.
  1467     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1468     12  LOGOFF-TEXT.
  1469         16  FILLER          PIC X(5)    VALUE SPACES.
  1470         16  LOGOFF-MSG.
  1471             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1472             20  FILLER      PIC X       VALUE SPACES.
  1473             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1474         16  FILLER          PIC X(80)
  1475           VALUE '* YOU ARE NOW LOGGED OFF'.
  1476         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1477         16  FILLER          PIC X       VALUE QUOTE.
  1478         16  LOGOFF-SYS-MSG  PIC X(17)
  1479           VALUE 'S CLAS-IC SYSTEM '.
  1480     12  TEXT-MESSAGES.
  1481         16  UNACCESS-MSG    PIC X(29)
  1482             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1483         16  PGMIDERR-MSG    PIC X(17)
  1484             VALUE 'PROGRAM NOT FOUND'.
  1485*    COPY ELCATTR.
  1486******************************************************************
  1487*                                                                *
  1488*                            ELCATTR.                            *
  1489*                            VMOD=2.001                          *
  1490*                                                                *
  1491*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1492*                                                                *
  1493*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1494*                                                                *
  1495*                   POS 1   P=PROTECTED                          *
  1496*                           U=UNPROTECTED                        *
  1497*                           S=ASKIP                              *
  1498*                   POS 2   A=ALPHA/NUMERIC                      *
  1499*                           N=NUMERIC                            *
  1500*                   POS 3   N=NORMAL                             *
  1501*                           B=BRIGHT                             *
  1502*                           D=DARK                               *
  1503*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1504*                           OF=MODIFIED DATA TAG OFF             *
  1505*                                                                *
  1506*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1507******************************************************************
  1508 01  ATTRIBUTE-LIST.
  1509     12  AL-PABOF            PIC X       VALUE 'Y'.
  1510     12  AL-PABON            PIC X       VALUE 'Z'.
  1511     12  AL-PADOF            PIC X       VALUE '%'.
  1512     12  AL-PADON            PIC X       VALUE '_'.
  1513     12  AL-PANOF            PIC X       VALUE '-'.
  1514     12  AL-PANON            PIC X       VALUE '/'.
  1515     12  AL-SABOF            PIC X       VALUE '8'.
  1516     12  AL-SABON            PIC X       VALUE '9'.
  1517     12  AL-SADOF            PIC X       VALUE '@'.
  1518     12  AL-SADON            PIC X       VALUE QUOTE.
  1519     12  AL-SANOF            PIC X       VALUE '0'.
  1520     12  AL-SANON            PIC X       VALUE '1'.
  1521     12  AL-UABOF            PIC X       VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  28
* EL614.cbl
  1522     12  AL-UABON            PIC X       VALUE 'I'.
  1523     12  AL-UADOF            PIC X       VALUE '<'.
  1524     12  AL-UADON            PIC X       VALUE '('.
  1525     12  AL-UANOF            PIC X       VALUE ' '.
  1526     12  AL-UANON            PIC X       VALUE 'A'.
  1527     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1528     12  AL-UNBON            PIC X       VALUE 'R'.
  1529     12  AL-UNDOF            PIC X       VALUE '*'.
  1530     12  AL-UNDON            PIC X       VALUE ')'.
  1531     12  AL-UNNOF            PIC X       VALUE '&'.
  1532     12  AL-UNNON            PIC X       VALUE 'J'.
  1533*    COPY ELCAID.
  1534******************************************************************
  1535*                                                                *
  1536*                            ELCAID.                             *
  1537*                            VMOD=2.001                          *
  1538*                                                                *
  1539*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1540*                                                                *
  1541*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1542*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1543******************************************************************
  1544
  1545 01  DFHAID.
  1546   02  DFHNULL   PIC  X  VALUE  ' '.
  1547   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1548   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1549   02  DFHPEN    PIC  X  VALUE  '='.
  1550   02  DFHOPID   PIC  X  VALUE  'W'.
  1551   02  DFHPA1    PIC  X  VALUE  '%'.
  1552   02  DFHPA2    PIC  X  VALUE  '>'.
  1553   02  DFHPA3    PIC  X  VALUE  ','.
  1554   02  DFHPF1    PIC  X  VALUE  '1'.
  1555   02  DFHPF2    PIC  X  VALUE  '2'.
  1556   02  DFHPF3    PIC  X  VALUE  '3'.
  1557   02  DFHPF4    PIC  X  VALUE  '4'.
  1558   02  DFHPF5    PIC  X  VALUE  '5'.
  1559   02  DFHPF6    PIC  X  VALUE  '6'.
  1560   02  DFHPF7    PIC  X  VALUE  '7'.
  1561   02  DFHPF8    PIC  X  VALUE  '8'.
  1562   02  DFHPF9    PIC  X  VALUE  '9'.
  1563   02  DFHPF10   PIC  X  VALUE  ':'.
  1564   02  DFHPF11   PIC  X  VALUE  '#'.
  1565   02  DFHPF12   PIC  X  VALUE  '@'.
  1566   02  DFHPF13   PIC  X  VALUE  'A'.
  1567   02  DFHPF14   PIC  X  VALUE  'B'.
  1568   02  DFHPF15   PIC  X  VALUE  'C'.
  1569   02  DFHPF16   PIC  X  VALUE  'D'.
  1570   02  DFHPF17   PIC  X  VALUE  'E'.
  1571   02  DFHPF18   PIC  X  VALUE  'F'.
  1572   02  DFHPF19   PIC  X  VALUE  'G'.
  1573   02  DFHPF20   PIC  X  VALUE  'H'.
  1574   02  DFHPF21   PIC  X  VALUE  'I'.
  1575*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1576   02  DFHPF22   PIC  X  VALUE  '['.
  1577   02  DFHPF23   PIC  X  VALUE  '.'.
  1578   02  DFHPF24   PIC  X  VALUE  '<'.
  1579   02  DFHMSRE   PIC  X  VALUE  'X'.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  29
* EL614.cbl
  1580   02  DFHSTRF   PIC  X  VALUE  'h'.
  1581   02  DFHTRIG   PIC  X  VALUE  '"'.
  1582 01  FILLER    REDEFINES DFHAID.
  1583     05  FILLER                      PIC X(8).
  1584     05  PF-VALUES                   PIC X
  1585         OCCURS 24 TIMES.
  1586
  1587 01  record-table pic x(93744).
  1588 01  rec-table redefines record-table.
  1589     12  ts-group occurs 28 times indexed by ts-indx pic x(3348).
  1590 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  1591     12  REC-ENT OCCURS 336 TIMES INDEXED BY TB-INDX TB-INDX1.
  1592         16  REC-EOB-CODE                PIC XXXX.
  1593         16  REC-DESCRIPTION             PIC X(275).
  1594* 01  RECORD-TABLE                PIC X(26784) VALUE SPACES.
  1595* 01  REC-TABLE  REDEFINES RECORD-TABLE.
  1596*     12  TS-GROUP OCCURS 8 TIMES INDEXED BY TS-INDX PIC X(3348).
  1597* 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  1598*     12  REC-ENT OCCURS 96 TIMES INDEXED BY TB-INDX TB-INDX1.
  1599*         16  REC-EOB-CODE                PIC XXXX.
  1600*         16  REC-DESCRIPTION             PIC X(275).
  1601
  1602 01  TS-WORK-AREA                        PIC X(3348).
  1603
  1604****************************************************************
  1605*
  1606* Copyright (c) 2007-2013 Dell Inc.
  1607* All rights reserved.
  1608*
  1609****************************************************************
  1610 01  DFHEIV.
  1611   02  DFHEIV0               PIC X(35).
  1612   02  DFHEIV1               PIC X(08).
  1613   02  DFHEIV2               PIC X(08).
  1614   02  DFHEIV3               PIC X(08).
  1615   02  DFHEIV4               PIC X(06).
  1616   02  DFHEIV5               PIC X(04).
  1617   02  DFHEIV6               PIC X(04).
  1618   02  DFHEIV7               PIC X(02).
  1619   02  DFHEIV8               PIC X(02).
  1620   02  DFHEIV9               PIC X(01).
  1621   02  DFHEIV10              PIC S9(7) COMP-3.
  1622   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1623   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1624   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1625   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1626   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1627   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1628   02  DFHEIV17              PIC X(04).
  1629   02  DFHEIV18              PIC X(04).
  1630   02  DFHEIV19              PIC X(04).
  1631   02  DFHEIV20              USAGE IS POINTER.
  1632   02  DFHEIV21              USAGE IS POINTER.
  1633   02  DFHEIV22              USAGE IS POINTER.
  1634   02  DFHEIV23              USAGE IS POINTER.
  1635   02  DFHEIV24              USAGE IS POINTER.
  1636   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1637   02  DFHEIV26              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  30
* EL614.cbl
  1638   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1639   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1640   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1641   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1642   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1643   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1644   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1645   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1646   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1647   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1648   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1649   02  FILLER                PIC X(02).
  1650   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1651   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1652   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1653   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1654   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1655   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1656   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1657 LINKAGE  SECTION.
  1658*****************************************************************
  1659*                                                               *
  1660* Copyright (c) 2007-2013 Dell Inc.                             *
  1661* All rights reserved.                                          *
  1662*                                                               *
  1663*****************************************************************
  1664 01  dfheiblk.
  1665     02  eibtime          pic s9(7) comp-3.
  1666     02  eibdate          pic s9(7) comp-3.
  1667     02  eibtrnid         pic x(4).
  1668     02  eibtaskn         pic s9(7) comp-3.
  1669     02  eibtrmid         pic x(4).
  1670     02  dfheigdi         pic s9(4) comp.
  1671     02  eibcposn         pic s9(4) comp.
  1672     02  eibcalen         pic s9(4) comp.
  1673     02  eibaid           pic x(1).
  1674     02  eibfiller1       pic x(1).
  1675     02  eibfn            pic x(2).
  1676     02  eibfiller2       pic x(2).
  1677     02  eibrcode         pic x(6).
  1678     02  eibfiller3       pic x(2).
  1679     02  eibds            pic x(8).
  1680     02  eibreqid         pic x(8).
  1681     02  eibrsrce         pic x(8).
  1682     02  eibsync          pic x(1).
  1683     02  eibfree          pic x(1).
  1684     02  eibrecv          pic x(1).
  1685     02  eibsend          pic x(1).
  1686     02  eibatt           pic x(1).
  1687     02  eibeoc           pic x(1).
  1688     02  eibfmh           pic x(1).
  1689     02  eibcompl         pic x(1).
  1690     02  eibsig           pic x(1).
  1691     02  eibconf          pic x(1).
  1692     02  eiberr           pic x(1).
  1693     02  eibrldbk         pic x(1).
  1694     02  eiberrcd         pic x(4).
  1695     02  eibsynrb         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  31
* EL614.cbl
  1696     02  eibnodat         pic x(1).
  1697     02  eibfiller5       pic x(2).
  1698     02  eibresp          pic s9(8) comp.
  1699     02  eibresp2         pic s9(8) comp.
  1700     02  dfheigdj         pic s9(4) comp.
  1701     02  dfheigdk         pic s9(4) comp.
  1702 01  DFHCOMMAREA                     PIC X(1024).
  1703 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1704 0000-DFHEXIT SECTION.
  1705     MOVE '9#                    $   ' TO DFHEIV0.
  1706     MOVE 'EL614' TO DFHEIV1.
  1707     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1708     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1709     MOVE '5'                   TO DC-OPTION-CODE.
  1710     PERFORM 8500-DATE-CONVERSION
  1711                                THRU 8500-EXIT
  1712     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1713     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1714     MOVE DFHCOMMAREA           TO  PROGRAM-INTERFACE-BLOCK.
  1715     MOVE +1                    TO  EMI-NUMBER-OF-LINES
  1716                                    EMI-SWITCH2.
  1717     IF EIBCALEN NOT > ZERO
  1718        MOVE UNACCESS-MSG        TO LOGOFF-MSG
  1719        GO TO 8300-SEND-TEXT
  1720     END-IF
  1721
  1722* EXEC CICS HANDLE CONDITION
  1723*        PGMIDERR (9600-PGMIDERR)
  1724*        ERROR    (9990-ERROR)
  1725*    END-EXEC
  1726*    MOVE '"$L.                  ! " #00001717' TO DFHEIV0
  1727     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1728     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1729     MOVE X'2220233030303031373137' TO DFHEIV0(25:11)
  1730     CALL 'kxdfhei1' USING DFHEIV0
  1731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1732     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1733        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1734           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  1735           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  1736           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  1737           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  1738           MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  1739           MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  1740           MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  1741           MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  1742        ELSE
  1743           MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  1744           MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  1745           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  1746           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  1747           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  1748           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  1749           MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  1750           MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  1751        END-IF
  1752     END-IF
  1753     IF EIBTRNID NOT = WS-TRANS-ID
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  32
* EL614.cbl
  1754        GO TO 1000-INITIAL-SCREEN
  1755     END-IF
  1756     IF EIBAID = DFHCLEAR
  1757        GO TO 9400-CLEAR
  1758     END-IF
  1759     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1760        MOVE LOW-VALUES          TO EL614AO
  1761        MOVE -1                  TO APFKL
  1762        MOVE ER-0008             TO EMI-ERROR
  1763        GO TO 8200-SEND-DATAONLY
  1764     END-IF
  1765
  1766* EXEC CICS RECEIVE
  1767*        INTO   (EL614AO)
  1768*        MAPSET (WS-MAPSET-NAME)
  1769*        MAP    (WS-MAP-NAME)
  1770*    END-EXEC
  1771     MOVE LENGTH OF
  1772      EL614AO
  1773       TO DFHEIV11
  1774*    MOVE '8"T I  L              ''   #00001754' TO DFHEIV0
  1775     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1776     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1777     MOVE X'2020233030303031373534' TO DFHEIV0(25:11)
  1778     CALL 'kxdfhei1' USING DFHEIV0,
  1779           WS-MAP-NAME,
  1780           EL614AO,
  1781           DFHEIV11,
  1782           WS-MAPSET-NAME,
  1783           DFHEIV99,
  1784           DFHEIV99
  1785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1786     IF APFKL > ZERO
  1787        IF EIBAID NOT = DFHENTER
  1788           MOVE ER-0004          TO EMI-ERROR
  1789           MOVE AL-UNBOF         TO APFKA
  1790           MOVE -1               TO APFKL
  1791           GO TO 8200-SEND-DATAONLY
  1792        ELSE
  1793           IF APFKO NUMERIC AND
  1794              (APFKO > ZERO AND LESS '25')
  1795              MOVE PF-VALUES (APFKI)
  1796                                 TO  EIBAID
  1797           ELSE
  1798              MOVE ER-0029       TO  EMI-ERROR
  1799              MOVE AL-UNBOF      TO  APFKA
  1800              MOVE -1            TO  APFKL
  1801              GO TO 8200-SEND-DATAONLY
  1802           END-IF
  1803        END-IF
  1804     END-IF
  1805     IF EIBAID = DFHPF12
  1806        MOVE 'EL010'             TO THIS-PGM
  1807        GO TO 9300-XCTL
  1808     END-IF
  1809     IF EIBAID = DFHPF23
  1810        GO TO 9000-RETURN-CICS
  1811     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  33
* EL614.cbl
  1812     IF EIBAID = DFHPF24
  1813        IF CREDIT-SESSION
  1814           MOVE 'EL626'          TO THIS-PGM
  1815           GO TO 9300-XCTL
  1816        ELSE
  1817           MOVE 'EL126'          TO THIS-PGM
  1818           GO TO 9300-XCTL
  1819        END-IF
  1820     END-IF
  1821     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2
  1822        OR DFHPF3 OR DFHPF4 OR DFHPF5
  1823        CONTINUE
  1824     ELSE
  1825        MOVE ER-0008             TO EMI-ERROR
  1826        MOVE -1                  TO APFKL
  1827        GO TO 8200-SEND-DATAONLY
  1828     END-IF
  1829     IF EIBAID = DFHPF1 OR DFHPF2 OR DFHPF3
  1830        OR DFHPF4 OR DFHENTER OR DFHPF5
  1831        MOVE 'S'                 TO PI-MODE
  1832     ELSE
  1833        MOVE AL-UABOF            TO APFKA
  1834        MOVE -1                  TO APFKL
  1835        MOVE ER-0023             TO EMI-ERROR
  1836        PERFORM 9900-ERROR-FORMAT
  1837     END-IF
  1838     IF EMI-FATAL-CTR > ZERO
  1839        GO TO 8200-SEND-DATAONLY
  1840     END-IF
  1841     IF PI-MODE EQUAL 'S'
  1842        GO TO 2000-PROCESS-SHOW
  1843     END-IF
  1844     MOVE 'LOGIC ERROR HAS OCCURRED - PROGRAM EL614'
  1845                                 TO LOGOFF-MSG
  1846     GO TO 8300-SEND-TEXT
  1847     .
  1848 1000-INITIAL-SCREEN.
  1849     MOVE PI-PROGRAM-WORK-AREA (1:60)
  1850                                 TO WS-PASSED-FROM-CALL-PGM
  1851     MOVE PI-REASON-CODE-IND     TO WS-REASON-CODE-PASSED
  1852     EVALUATE TRUE
  1853        WHEN PI-RETURN-TO-PROGRAM = 'EL156'
  1854           MOVE WS-PASSED-FROM-CALL-PGM
  1855                                 TO PI-PROGRAM-WORK-AREA
  1856           MOVE '1'              TO PI-RECORD-TYPE
  1857        WHEN PI-RETURN-TO-PROGRAM = 'EL6316'
  1858           MOVE WS-PASSED-FROM-CALL-PGM
  1859                                 TO PI-PROGRAM-WORK-AREA
  1860           MOVE '4'              TO PI-RECORD-TYPE
  1861        WHEN PI-RETURN-TO-PROGRAM = 'EL6317'
  1862           MOVE WS-PASSED-FROM-CALL-PGM
  1863                                 TO PI-PROGRAM-WORK-AREA
  1864           MOVE '2'              TO PI-RECORD-TYPE
  1865        WHEN PI-RETURN-TO-PROGRAM = 'EL6318'
  1866           MOVE WS-PASSED-FROM-CALL-PGM
  1867                                 TO PI-PROGRAM-WORK-AREA
  1868           MOVE WS-REASON-CODE-PASSED TO PI-REASON-CODE-IND
  1869           MOVE 'N'              TO PI-EXPANDED-VIEW
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  34
* EL614.cbl
  1870           MOVE '3'              TO PI-RECORD-TYPE
  1871        WHEN OTHER
  1872           MOVE SPACES           TO PI-PROGRAM-WORK-AREA
  1873                                    WS-PASSED-FROM-CALL-PGM
  1874                                    PI-RECORD-TYPE
  1875     END-EVALUATE
  1876     MOVE PI-COMPANY-CD          TO WS-ELEOBC-KEY
  1877     MOVE PI-RECORD-TYPE         TO WS-EOB-REC-TYPE
  1878     MOVE ZERO                   TO PI-1ST-TIME-SW
  1879                                    PI-LINE-COUNT
  1880                                    PI-BROWSE-SW
  1881                                    PI-SHOW-SW
  1882                                    PI-CHANGE-SW
  1883     MOVE LOW-VALUES             TO EL614AO
  1884     GO TO 7000-BUILD-TABLE
  1885     .
  1886 2000-PROCESS-SHOW.
  1887**  THE FIRST THING TO DO IS CHECK
  1888**  FOR PF4 (CLEAR SELECTED CODES) IF PRESSED
  1889**  SPACE OUT THE PRIOR SELECTIONS. NEXT CHECK
  1890**  THE SELECTED CODES
  1891**  AGAINST THE TABLE AND SYNC THEM UP.
  1892**  IF THEY SPACE ONE OUT THEN GET RID OF IT FROM THE
  1893**  TABLE
  1894     IF EIBAID = DFHPF4
  1895        MOVE SPACES              TO PI-SELECTED-EOB-CODES
  1896        MOVE PI-TOP-LINE-NUM     TO PI-CURRENT-LINE
  1897        PERFORM 7450-SET-INDX THRU 7450-EXIT
  1898        GO TO 7050-FORMAT-LINES-FWD
  1899     END-IF
  1900
  1901     IF EIBAID = DFHPF5
  1902         IF PI-EXPANDED-VIEW = 'Y'
  1903             MOVE 'N'        TO PI-EXPANDED-VIEW
  1904         ELSE
  1905             MOVE 'Y'        TO PI-EXPANDED-VIEW
  1906         END-IF
  1907         MOVE PI-TOP-LINE-NUM TO PI-CURRENT-LINE
  1908         PERFORM 7450-SET-INDX THRU 7450-EXIT
  1909         GO TO 7050-FORMAT-LINES-FWD
  1910     END-IF
  1911     IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317' OR 'EL6318'
  1912        OR 'EL6316'
  1913        PERFORM VARYING M1 FROM +1 BY +1 UNTIL
  1914           M1 > +17
  1915           IF SELL (M1) > +0
  1916              IF SELI (M1) = SPACES
  1917                 PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  1918                    E1 > +12
  1919                    IF PI-EOB-CODE (E1) = RCODEI (M1)
  1920                       MOVE SPACES TO PI-EOB-CODE (E1)
  1921                    END-IF
  1922                 END-PERFORM
  1923              ELSE
  1924                 MOVE ' '       TO WS-DUP-EOB-SW
  1925                 PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  1926                    E1 > +12
  1927                    IF RCODEI (M1) = PI-EOB-CODE (E1)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  35
* EL614.cbl
  1928                       SET FOUND-DUP-EOB TO TRUE
  1929                    END-IF
  1930                 END-PERFORM
  1931                 IF NOT FOUND-DUP-EOB
  1932                    PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  1933                       (PI-EOB-CODE (E1) = SPACES)
  1934                       OR (E1 > +12)
  1935                    END-PERFORM
  1936                    IF E1 < +13
  1937                       MOVE RCODEI (M1) TO PI-EOB-CODE (E1)
  1938                    END-IF
  1939                 END-IF
  1940              END-IF
  1941           END-IF
  1942        END-PERFORM
  1943     END-IF
  1944     EVALUATE TRUE
  1945        WHEN EIBAID = DFHPF2
  1946           MOVE PI-TOP-LINE-NUM TO PI-BOT-LINE-NUM
  1947                                   PI-CURRENT-LINE
  1948           PERFORM 7450-SET-INDX THRU 7450-EXIT
  1949           GO TO 7150-FORMAT-LINES-BWD
  1950        WHEN EIBAID = DFHPF1
  1951           MOVE PI-BOT-LINE-NUM TO PI-TOP-LINE-NUM
  1952                                   PI-CURRENT-LINE
  1953           PERFORM 7450-SET-INDX THRU 7450-EXIT
  1954           GO TO 7050-FORMAT-LINES-FWD
  1955        WHEN EIBAID = DFHPF3
  1956           PERFORM 6100-FORMAT-EOB-CODES
  1957                                 THRU 6100-EXIT
  1958           GO TO 9400-CLEAR
  1959        WHEN OTHER
  1960*          MOVE PI-COMPANY-CD    TO WS-ELEOBC-KEY
  1961*          GO TO 7000-BROWSE-FWD
  1962           MOVE -1 TO SELL (1)
  1963           GO TO 8200-SEND-DATAONLY
  1964     END-EVALUATE
  1965     .
  1966 6100-FORMAT-EOB-CODES.
  1967**  THIS ROUTINE JUST ELIMINATES ANY EOB CODES THAT
  1968**  WERE "UN SELECTED"
  1969     MOVE SPACES                 TO WS-SELECTED-EOB-CODES
  1970     MOVE +1                     TO E1 S1
  1971     PERFORM UNTIL E1 > +12
  1972        IF PI-EOB-CODE (E1) NOT = SPACES
  1973           MOVE PI-EOB-CODE (E1) TO WS-SEL-EOB-CODE (S1)
  1974           ADD +1                TO S1
  1975        END-IF
  1976        ADD +1                   TO E1
  1977     END-PERFORM
  1978     MOVE WS-SELECTED-EOB-CODES  TO PI-SELECTED-EOB-CODES
  1979     .
  1980 6100-EXIT.
  1981     EXIT.
  1982
  1983 7000-BUILD-TABLE.
  1984
  1985     SET TB-INDX TO 1.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  36
* EL614.cbl
  1986     MOVE ZEROS                  TO  PI-TOTAL-LINES
  1987                                     PI-CURRENT-LINE
  1988                                     PI-TEMP-STOR-ITEMS.
  1989     MOVE ZERO                   TO PI-LINE-COUNT
  1990     MOVE +1                     TO PI-BROWSE-SW
  1991     MOVE LOW-VALUES             TO EL614AO
  1992
  1993****IF TEMP STORAGE EXISTS, DELETE IT.
  1994     PERFORM 7500-READ-TS THRU 7599-EXIT
  1995
  1996     IF PI-TEMP-STOR-ITEMS NOT = ZERO
  1997        PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT
  1998     END-IF.
  1999
  2000
  2001* EXEC CICS STARTBR
  2002*        DATASET   ('ELEOBC')
  2003*        RIDFLD    (WS-ELEOBC-KEY)
  2004*        GTEQ
  2005*        RESP      (WS-RESPONSE)
  2006*    END-EXEC.
  2007     MOVE 'ELEOBC' TO DFHEIV1
  2008     MOVE 0
  2009       TO DFHEIV11
  2010*    MOVE '&,         G          &  N#00001973' TO DFHEIV0
  2011     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2012     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2013     MOVE X'204E233030303031393733' TO DFHEIV0(25:11)
  2014     CALL 'kxdfhei1' USING DFHEIV0,
  2015           DFHEIV1,
  2016           WS-ELEOBC-KEY,
  2017           DFHEIV99,
  2018           DFHEIV11,
  2019           DFHEIV99
  2020     MOVE EIBRESP  TO WS-RESPONSE
  2021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2022
  2023
  2024     EVALUATE TRUE
  2025        WHEN RESP-ENDFILE
  2026           GO TO 7030-ENDBR
  2027        WHEN RESP-NORMAL
  2028           CONTINUE
  2029        WHEN RESP-NOTFND
  2030           GO TO 7030-ENDBR
  2031     END-EVALUATE.
  2032
  2033***IF COMING FROM EL6318 WE WANT TO LOAD THE HIGHLIGHTED REASON CO
  2034***FOLLOWED BY THE NON HIGHLIGHTED. FOR ALL OTHER SCREENS WE JUST
  2035***REASON CODES IN ORDER.
  2036     IF PI-RETURN-TO-PROGRAM NOT EQUAL 'EL6318'
  2037         GO TO 7020-LOOP
  2038     END-IF.
  2039
  2040 7001-HIGHLIGHT-LOOP.
  2041
  2042* EXEC CICS READNEXT
  2043*        INTO    (EOB-CODES)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  37
* EL614.cbl
  2044*        DATASET ('ELEOBC')
  2045*        RIDFLD  (WS-ELEOBC-KEY)
  2046*        RESP    (WS-RESPONSE)
  2047*    END-EXEC
  2048     MOVE LENGTH OF
  2049      EOB-CODES
  2050       TO DFHEIV12
  2051     MOVE 'ELEOBC' TO DFHEIV1
  2052     MOVE 0
  2053       TO DFHEIV11
  2054*    MOVE '&.IL                  )  N#00001997' TO DFHEIV0
  2055     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2056     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2057     MOVE X'204E233030303031393937' TO DFHEIV0(25:11)
  2058     CALL 'kxdfhei1' USING DFHEIV0,
  2059           DFHEIV1,
  2060           EOB-CODES,
  2061           DFHEIV12,
  2062           WS-ELEOBC-KEY,
  2063           DFHEIV99,
  2064           DFHEIV11,
  2065           DFHEIV99,
  2066           DFHEIV99
  2067     MOVE EIBRESP  TO WS-RESPONSE
  2068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2069
  2070     EVALUATE TRUE
  2071        WHEN RESP-ENDFILE
  2072           GO TO 7005-ENDBR
  2073        WHEN (PI-COMPANY-CD NOT = WS-COMPANY-CD)
  2074           OR ((PI-RECORD-TYPE NOT = EO-RECORD-TYPE)
  2075               AND (PI-RECORD-TYPE NOT = SPACES))
  2076           GO TO 7005-ENDBR
  2077        WHEN RESP-NORMAL
  2078           CONTINUE
  2079        WHEN RESP-NOTFND
  2080           GO TO 7005-ENDBR
  2081        WHEN EO-COMPANY-CD NOT = PI-COMPANY-CD
  2082           GO TO 7005-ENDBR
  2083     END-EVALUATE
  2084
  2085     PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  2086        S2 > +26
  2087           IF EO-EOB-CODE (1:1) = PI-REASON-CODE-FLAG (S2)
  2088              MOVE EO-EOB-CODE TO REC-EOB-CODE (TB-INDX)
  2089              MOVE EO-DESCRIPTION TO REC-DESCRIPTION (TB-INDX)
  2090              SET TB-INDX UP BY 1
  2091           END-IF
  2092     END-PERFORM
  2093
  2094     GO TO 7001-HIGHLIGHT-LOOP.
  2095
  2096 7005-ENDBR.
  2097
  2098* EXEC CICS ENDBR
  2099*        DATASET ('ELEOBC')
  2100*    END-EXEC
  2101     MOVE 'ELEOBC' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  38
* EL614.cbl
  2102     MOVE 0
  2103       TO DFHEIV11
  2104*    MOVE '&2                    $   #00002031' TO DFHEIV0
  2105     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2106     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2107     MOVE X'2020233030303032303331' TO DFHEIV0(25:11)
  2108     CALL 'kxdfhei1' USING DFHEIV0,
  2109           DFHEIV1,
  2110           DFHEIV11,
  2111           DFHEIV99
  2112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2113
  2114     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  2115     MOVE PI-COMPANY-CD          TO WS-ELEOBC-KEY
  2116     MOVE PI-RECORD-TYPE         TO WS-EOB-REC-TYPE
  2117
  2118* EXEC CICS STARTBR
  2119*        DATASET   ('ELEOBC')
  2120*        RIDFLD    (WS-ELEOBC-KEY)
  2121*        GTEQ
  2122*        RESP      (WS-RESPONSE)
  2123*    END-EXEC.
  2124     MOVE 'ELEOBC' TO DFHEIV1
  2125     MOVE 0
  2126       TO DFHEIV11
  2127*    MOVE '&,         G          &  N#00002038' TO DFHEIV0
  2128     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2129     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2130     MOVE X'204E233030303032303338' TO DFHEIV0(25:11)
  2131     CALL 'kxdfhei1' USING DFHEIV0,
  2132           DFHEIV1,
  2133           WS-ELEOBC-KEY,
  2134           DFHEIV99,
  2135           DFHEIV11,
  2136           DFHEIV99
  2137     MOVE EIBRESP  TO WS-RESPONSE
  2138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2139
  2140
  2141     EVALUATE TRUE
  2142        WHEN RESP-ENDFILE
  2143           GO TO 7030-ENDBR
  2144        WHEN RESP-NORMAL
  2145           CONTINUE
  2146        WHEN RESP-NOTFND
  2147           GO TO 7030-ENDBR
  2148     END-EVALUATE.
  2149
  2150 7010-NON-HIGHLIGHT-LOOP.
  2151
  2152* EXEC CICS READNEXT
  2153*        INTO    (EOB-CODES)
  2154*        DATASET ('ELEOBC')
  2155*        RIDFLD  (WS-ELEOBC-KEY)
  2156*        RESP    (WS-RESPONSE)
  2157*    END-EXEC
  2158     MOVE LENGTH OF
  2159      EOB-CODES
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  39
* EL614.cbl
  2160       TO DFHEIV12
  2161     MOVE 'ELEOBC' TO DFHEIV1
  2162     MOVE 0
  2163       TO DFHEIV11
  2164*    MOVE '&.IL                  )  N#00002055' TO DFHEIV0
  2165     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2166     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2167     MOVE X'204E233030303032303535' TO DFHEIV0(25:11)
  2168     CALL 'kxdfhei1' USING DFHEIV0,
  2169           DFHEIV1,
  2170           EOB-CODES,
  2171           DFHEIV12,
  2172           WS-ELEOBC-KEY,
  2173           DFHEIV99,
  2174           DFHEIV11,
  2175           DFHEIV99,
  2176           DFHEIV99
  2177     MOVE EIBRESP  TO WS-RESPONSE
  2178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2179
  2180     EVALUATE TRUE
  2181        WHEN RESP-ENDFILE
  2182           GO TO 7030-ENDBR
  2183        WHEN (PI-COMPANY-CD NOT = WS-COMPANY-CD)
  2184           OR ((PI-RECORD-TYPE NOT = EO-RECORD-TYPE)
  2185               AND (PI-RECORD-TYPE NOT = SPACES))
  2186           GO TO 7030-ENDBR
  2187        WHEN RESP-NORMAL
  2188           CONTINUE
  2189        WHEN RESP-NOTFND
  2190           GO TO 7030-ENDBR
  2191        WHEN EO-COMPANY-CD NOT = PI-COMPANY-CD
  2192           GO TO 7030-ENDBR
  2193     END-EVALUATE
  2194
  2195     MOVE 'N' TO WS-CODE-LOADED
  2196     PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  2197        S2 > +26
  2198           IF EO-EOB-CODE (1:1) = PI-REASON-CODE-FLAG (S2)
  2199               SET CODEALREADYLOADED TO TRUE
  2200           END-IF
  2201     END-PERFORM
  2202
  2203     IF NOT CODEALREADYLOADED
  2204        MOVE EO-EOB-CODE TO REC-EOB-CODE (TB-INDX)
  2205        MOVE EO-DESCRIPTION TO REC-DESCRIPTION (TB-INDX)
  2206        SET TB-INDX UP BY 1
  2207     END-IF
  2208
  2209     GO TO 7010-NON-HIGHLIGHT-LOOP.
  2210
  2211 7020-LOOP.
  2212
  2213* EXEC CICS READNEXT
  2214*        INTO    (EOB-CODES)
  2215*        DATASET ('ELEOBC')
  2216*        RIDFLD  (WS-ELEOBC-KEY)
  2217*        RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  40
* EL614.cbl
  2218*    END-EXEC
  2219     MOVE LENGTH OF
  2220      EOB-CODES
  2221       TO DFHEIV12
  2222     MOVE 'ELEOBC' TO DFHEIV1
  2223     MOVE 0
  2224       TO DFHEIV11
  2225*    MOVE '&.IL                  )  N#00002094' TO DFHEIV0
  2226     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2227     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2228     MOVE X'204E233030303032303934' TO DFHEIV0(25:11)
  2229     CALL 'kxdfhei1' USING DFHEIV0,
  2230           DFHEIV1,
  2231           EOB-CODES,
  2232           DFHEIV12,
  2233           WS-ELEOBC-KEY,
  2234           DFHEIV99,
  2235           DFHEIV11,
  2236           DFHEIV99,
  2237           DFHEIV99
  2238     MOVE EIBRESP  TO WS-RESPONSE
  2239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2240
  2241     EVALUATE TRUE
  2242        WHEN RESP-ENDFILE
  2243           GO TO 7030-ENDBR
  2244        WHEN (PI-COMPANY-CD NOT = WS-COMPANY-CD)
  2245           OR ((PI-RECORD-TYPE NOT = EO-RECORD-TYPE)
  2246               AND (PI-RECORD-TYPE NOT = SPACES))
  2247           GO TO 7030-ENDBR
  2248        WHEN RESP-NORMAL
  2249           CONTINUE
  2250        WHEN RESP-NOTFND
  2251           GO TO 7030-ENDBR
  2252        WHEN EO-COMPANY-CD NOT = PI-COMPANY-CD
  2253           GO TO 7030-ENDBR
  2254     END-EVALUATE
  2255
  2256     MOVE EO-EOB-CODE TO REC-EOB-CODE (TB-INDX)
  2257     MOVE EO-DESCRIPTION TO REC-DESCRIPTION (TB-INDX)
  2258     SET TB-INDX UP BY 1
  2259     GO TO 7020-LOOP.
  2260
  2261 7030-ENDBR.
  2262     IF TB-INDX = 1
  2263         MOVE ER-0006            TO EMI-ERROR
  2264         MOVE -1                 TO APFKL
  2265         MOVE AL-UABOF           TO APFKA
  2266         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2267         MOVE ZEROS              TO PI-TOTAL-LINES
  2268         GO TO 8100-SEND-INITIAL-MAP
  2269     END-IF.
  2270
  2271     IF PI-BROWSE-SW = +1
  2272
  2273* EXEC CICS ENDBR
  2274*          DATASET ('ELEOBC')
  2275*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  41
* EL614.cbl
  2276     MOVE 'ELEOBC' TO DFHEIV1
  2277     MOVE 0
  2278       TO DFHEIV11
  2279*    MOVE '&2                    $   #00002132' TO DFHEIV0
  2280     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2281     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2282     MOVE X'2020233030303032313332' TO DFHEIV0(25:11)
  2283     CALL 'kxdfhei1' USING DFHEIV0,
  2284           DFHEIV1,
  2285           DFHEIV11,
  2286           DFHEIV99
  2287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2288        MOVE +0                  TO PI-BROWSE-SW
  2289     END-IF
  2290
  2291     SET TB-INDX DOWN BY 1.
  2292     SET PI-TOTAL-LINES TO TB-INDX.
  2293     MOVE 1                      TO PI-CURRENT-LINE.
  2294     MOVE 1                      TO PI-TOP-LINE-NUM.
  2295     SET TB-INDX                 TO PI-CURRENT-LINE.
  2296
  2297 7050-FORMAT-LINES-FWD.
  2298     IF PI-CURRENT-LINE >= PI-TOTAL-LINES
  2299        MOVE ER-1699             TO EMI-ERROR
  2300        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2301        MOVE PI-TOP-LINE-NUM TO PI-CURRENT-LINE
  2302        PERFORM 7450-SET-INDX THRU 7450-EXIT
  2303     END-IF.
  2304
  2305     MOVE LOW-VALUES             TO EL614AI.
  2306     PERFORM 7100-FORMAT-SCREEN-FWD THRU 7100-EXIT
  2307             VARYING M1 FROM 1
  2308             BY 1 UNTIL M1 > NUM-LINES-PER-SCREEN.
  2309     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  2310     GO TO 8100-SEND-INITIAL-MAP.
  2311
  2312 7100-FORMAT-SCREEN-FWD.
  2313
  2314     IF TB-INDX > PI-TOTAL-LINES
  2315         GO TO 7100-EXIT
  2316     END-IF.
  2317
  2318     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2319         MOVE REC-EOB-CODE (TB-INDX) TO WS-TABLE-CODE
  2320         MOVE WS-TAB-CODE-1      TO WS-SCR-CODE-4
  2321         MOVE WS-TAB-CODE-2-4    TO WS-SCR-CODE-1-3
  2322         MOVE WS-SCREEN-CODE     TO RCODEO (M1)
  2323     ELSE
  2324         MOVE REC-EOB-CODE (TB-INDX) TO RCODEO (M1)
  2325     END-IF
  2326     MOVE REC-DESCRIPTION (TB-INDX)  TO DESCO (M1)
  2327
  2328     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2329        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  2330          S2 > +26
  2331            IF RCODEO (M1)(4:1) = PI-REASON-CODE-FLAG (S2)
  2332               MOVE AL-SABON TO RCODEA (M1)
  2333               MOVE AL-SABOF TO DESCA (M1)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  42
* EL614.cbl
  2334            END-IF
  2335        END-PERFORM
  2336     END-IF
  2337
  2338     IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317'
  2339        OR 'EL6316'
  2340        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  2341           E1 > +12
  2342           IF REC-EOB-CODE (TB-INDX) = PI-EOB-CODE (E1)
  2343              MOVE 'S'           TO SELI (M1)
  2344              MOVE +1            TO SELL (M1)
  2345           END-IF
  2346        END-PERFORM
  2347     END-IF
  2348
  2349     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2350        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  2351           E1 > +12
  2352           MOVE PI-EOB-CODE (E1) TO WS-SCREEN-CODE
  2353           MOVE WS-SCR-CODE-1-3  TO WS-TAB-CODE-2-4
  2354           MOVE WS-SCR-CODE-4    TO WS-TAB-CODE-1
  2355           IF REC-EOB-CODE (TB-INDX) = WS-TABLE-CODE
  2356              MOVE 'S'           TO SELI (M1)
  2357              MOVE +1            TO SELL (M1)
  2358           END-IF
  2359        END-PERFORM
  2360     END-IF
  2361
  2362     IF PI-EXPANDED-VIEW = 'Y'
  2363         IF REC-DESCRIPTION (TB-INDX) (61:60) > SPACES
  2364           AND M1 < +17
  2365             SET N1 TO M1
  2366             SET M1 UP BY +1
  2367             MOVE REC-DESCRIPTION (TB-INDX)(61:60) TO DESCO (M1)
  2368             MOVE DESCA (N1)    TO DESCA (M1)
  2369             MOVE AL-SADOF      TO SELA (M1)
  2370         END-IF
  2371         IF REC-DESCRIPTION (TB-INDX) (121:60) > SPACES
  2372           AND M1 < +17
  2373             SET N1 TO M1
  2374             SET M1 UP BY +1
  2375             MOVE REC-DESCRIPTION (TB-INDX)(121:60) TO DESCO (M1)
  2376             MOVE DESCA (N1)    TO DESCA (M1)
  2377             MOVE AL-SADOF      TO SELA (M1)
  2378         END-IF
  2379         IF REC-DESCRIPTION (TB-INDX) (181:60) > SPACES
  2380           AND M1 < +17
  2381             SET N1 TO M1
  2382             SET M1 UP BY +1
  2383             MOVE REC-DESCRIPTION (TB-INDX)(181:60) TO DESCO (M1)
  2384             MOVE DESCA (N1)    TO DESCA (M1)
  2385             MOVE AL-SADOF      TO SELA (M1)
  2386         END-IF
  2387         IF REC-DESCRIPTION (TB-INDX) (241:35) > SPACES
  2388           AND M1 < +17
  2389             SET N1 TO M1
  2390             SET M1 UP BY +1
  2391             MOVE REC-DESCRIPTION (TB-INDX)(241:35) TO DESCO (M1)
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  43
* EL614.cbl
  2392             MOVE DESCA (N1)    TO DESCA (M1)
  2393             MOVE AL-SADOF      TO SELA (M1)
  2394         END-IF
  2395     END-IF
  2396
  2397     SET PI-BOT-LINE-NUM TO TB-INDX
  2398     SET TB-INDX UP BY 1.
  2399
  2400 7100-EXIT.
  2401      EXIT.
  2402
  2403
  2404 7150-FORMAT-LINES-BWD.
  2405     IF PI-CURRENT-LINE <= 1
  2406        MOVE ER-1698             TO EMI-ERROR
  2407        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2408        MOVE PI-BOT-LINE-NUM TO PI-CURRENT-LINE
  2409        PERFORM 7450-SET-INDX THRU 7450-EXIT
  2410     END-IF.
  2411
  2412     MOVE LOW-VALUES             TO EL614AI.
  2413     MOVE 'N' TO WS-BUILD-FORWARD.
  2414     PERFORM 7150-FORMAT-SCREEN-BWD THRU 7150-EXIT
  2415             VARYING M1 FROM 17
  2416             BY -1 UNTIL M1 < 1 OR NEEDTOBUILDFORWARD.
  2417     IF NEEDTOBUILDFORWARD
  2418        PERFORM 7450-SET-INDX THRU 7450-EXIT
  2419        GO TO 7050-FORMAT-LINES-FWD
  2420     END-IF
  2421     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  2422     GO TO 8100-SEND-INITIAL-MAP.
  2423
  2424 7150-FORMAT-SCREEN-BWD.
  2425
  2426     IF TB-INDX < 1
  2427         GO TO 7150-END
  2428     END-IF.
  2429
  2430     IF PI-EXPANDED-VIEW = 'Y'
  2431         EVALUATE TRUE
  2432           WHEN REC-DESCRIPTION (TB-INDX)(241:35) > SPACES
  2433             IF M1 < +5
  2434                 GO TO 7150-END
  2435             ELSE
  2436                 SET M1 DOWN BY +4
  2437             END-IF
  2438           WHEN REC-DESCRIPTION (TB-INDX)(181:60) > SPACES
  2439             IF M1 < +4
  2440                 GO TO 7150-END
  2441             ELSE
  2442                 SET M1 DOWN BY +3
  2443             END-IF
  2444           WHEN REC-DESCRIPTION (TB-INDX)(121:60) > SPACES
  2445             IF M1 < +3
  2446                 GO TO 7150-END
  2447             ELSE
  2448                 SET M1 DOWN BY +2
  2449             END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  44
* EL614.cbl
  2450           WHEN REC-DESCRIPTION (TB-INDX)(61:60) > SPACES
  2451             IF M1 < +2
  2452                 GO TO 7150-END
  2453             ELSE
  2454                 SET M1 DOWN BY +1
  2455             END-IF
  2456         END-EVALUATE
  2457     END-IF
  2458
  2459     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2460         MOVE REC-EOB-CODE (TB-INDX) TO WS-TABLE-CODE
  2461         MOVE WS-TAB-CODE-1      TO WS-SCR-CODE-4
  2462         MOVE WS-TAB-CODE-2-4    TO WS-SCR-CODE-1-3
  2463         MOVE WS-SCREEN-CODE     TO RCODEO (M1)
  2464     ELSE
  2465         MOVE REC-EOB-CODE (TB-INDX) TO RCODEO (M1)
  2466     END-IF
  2467     MOVE REC-DESCRIPTION (TB-INDX)  TO DESCO (M1)
  2468
  2469     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2470        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  2471          S2 > +26
  2472            IF RCODEO (M1)(4:1) = PI-REASON-CODE-FLAG (S2)
  2473               MOVE AL-SABON TO RCODEA (M1)
  2474               MOVE AL-SABOF TO DESCA (M1)
  2475            END-IF
  2476        END-PERFORM
  2477     END-IF
  2478
  2479     IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317'
  2480        OR 'EL6316'
  2481        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  2482           E1 > +12
  2483           IF REC-EOB-CODE (TB-INDX) = PI-EOB-CODE (E1)
  2484              MOVE 'S'           TO SELI (M1)
  2485              MOVE +1            TO SELL (M1)
  2486           END-IF
  2487        END-PERFORM
  2488     END-IF
  2489
  2490     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2491        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  2492           E1 > +12
  2493           MOVE PI-EOB-CODE (E1) TO WS-SCREEN-CODE
  2494           MOVE WS-SCR-CODE-1-3  TO WS-TAB-CODE-2-4
  2495           MOVE WS-SCR-CODE-4    TO WS-TAB-CODE-1
  2496           IF REC-EOB-CODE (TB-INDX) = WS-TABLE-CODE
  2497              MOVE 'S'           TO SELI (M1)
  2498              MOVE +1            TO SELL (M1)
  2499           END-IF
  2500        END-PERFORM
  2501     END-IF
  2502
  2503     SET M2 TO M1
  2504     IF PI-EXPANDED-VIEW = 'Y'
  2505         IF REC-DESCRIPTION (TB-INDX) (61:60) > SPACES
  2506             SET N1 TO M1
  2507             SET M1 UP BY +1
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  45
* EL614.cbl
  2508             MOVE REC-DESCRIPTION (TB-INDX)(61:60) TO DESCO(M1)
  2509             MOVE DESCA (N1)    TO DESCA (M1)
  2510             MOVE AL-SADOF      TO SELA (M1)
  2511         END-IF
  2512         IF REC-DESCRIPTION (TB-INDX) (121:60) > SPACES
  2513             SET N1 TO M1
  2514             SET M1 UP BY +1
  2515             MOVE REC-DESCRIPTION (TB-INDX)(121:60) TO DESCO(M1)
  2516             MOVE DESCA (N1)    TO DESCA (M1)
  2517             MOVE AL-SADOF      TO SELA (M1)
  2518         END-IF
  2519         IF REC-DESCRIPTION (TB-INDX) (181:60) > SPACES
  2520             SET N1 TO M1
  2521             SET M1 UP BY +1
  2522             MOVE REC-DESCRIPTION (TB-INDX)(181:60) TO DESCO(M1)
  2523             MOVE DESCA (N1)    TO DESCA (M1)
  2524             MOVE AL-SADOF      TO SELA (M1)
  2525         END-IF
  2526         IF REC-DESCRIPTION (TB-INDX) (241:35) > SPACES
  2527             SET N1 TO M1
  2528             SET M1 UP BY +1
  2529             MOVE REC-DESCRIPTION (TB-INDX)(241:35) TO DESCO(M1)
  2530             MOVE DESCA (N1)    TO DESCA (M1)
  2531             MOVE AL-SADOF      TO SELA (M1)
  2532         END-IF
  2533     END-IF
  2534     SET M1 TO M2
  2535
  2536     SET PI-TOP-LINE-NUM TO TB-INDX
  2537     SET TB-INDX DOWN BY 1.
  2538     GO TO 7150-EXIT.
  2539
  2540 7150-END.
  2541
  2542     IF M1 >= +1
  2543        MOVE 'Y' TO WS-BUILD-FORWARD
  2544        IF TB-INDX < +1
  2545           MOVE 1 TO PI-CURRENT-LINE PI-TOP-LINE-NUM
  2546        ELSE
  2547           MOVE PI-TOP-LINE-NUM TO PI-CURRENT-LINE
  2548        END-IF
  2549     END-IF.
  2550
  2551 7150-EXIT.
  2552      EXIT.
  2553
  2554 7200-PUT-TEMP-STOR.
  2555     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  2556     SET TS-INDX TO 1.
  2557     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
  2558     PERFORM 7300-WRITE-TS THRU 7399-EXIT
  2559             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
  2560             UNTIL TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
  2561 7249-EXIT.
  2562      EXIT.
  2563 7250-DELETE-TEMP-STOR.
  2564
  2565* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  46
* EL614.cbl
  2566*         QIDERR(7299-EXIT)
  2567*    END-EXEC.
  2568*    MOVE '"$N                   ! # #00002411' TO DFHEIV0
  2569     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  2570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2571     MOVE X'2320233030303032343131' TO DFHEIV0(25:11)
  2572     CALL 'kxdfhei1' USING DFHEIV0
  2573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2574
  2575
  2576* EXEC CICS DELETEQ TS
  2577*         QUEUE(QID)
  2578*    END-EXEC.
  2579*    MOVE '*&                    #   #00002414' TO DFHEIV0
  2580     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  2581     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2582     MOVE X'2020233030303032343134' TO DFHEIV0(25:11)
  2583     CALL 'kxdfhei1' USING DFHEIV0,
  2584           QID,
  2585           DFHEIV99
  2586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2587
  2588 7299-EXIT.
  2589     EXIT.
  2590
  2591 7300-WRITE-TS.
  2592     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA.
  2593     SET TS-INDX UP BY 1.
  2594     ADD 1 TO PI-TEMP-STOR-ITEMS.
  2595
  2596* EXEC CICS WRITEQ TS
  2597*         FROM(TS-WORK-AREA)
  2598*         QUEUE(QID)
  2599*         LENGTH(TS-LENGTH)
  2600*         ITEM(PI-TEMP-STOR-ITEMS)
  2601*    END-EXEC.
  2602*    MOVE '*" I   L              ''   #00002424' TO DFHEIV0
  2603     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
  2604     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2605     MOVE X'2020233030303032343234' TO DFHEIV0(25:11)
  2606     CALL 'kxdfhei1' USING DFHEIV0,
  2607           QID,
  2608           TS-WORK-AREA,
  2609           TS-LENGTH,
  2610           PI-TEMP-STOR-ITEMS,
  2611           DFHEIV99,
  2612           DFHEIV99
  2613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2614
  2615 7399-EXIT.
  2616     EXIT.
  2617
  2618 7450-SET-INDX.
  2619     IF PI-CURRENT-LINE = 0 AND PI-TOTAL-LINES = 0
  2620        SET TB-INDX TO 1
  2621     ELSE
  2622        PERFORM 7500-READ-TS THRU 7599-EXIT
  2623        IF PI-CURRENT-LINE = 0
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  47
* EL614.cbl
  2624           SET TB-INDX TO 1
  2625        ELSE
  2626           SET TB-INDX TO PI-CURRENT-LINE
  2627        END-IF
  2628     END-IF.
  2629 7450-EXIT.
  2630      EXIT.
  2631
  2632 7500-READ-TS.
  2633
  2634* EXEC CICS HANDLE CONDITION
  2635*         QIDERR(7590-TS-QIDERR)
  2636*         ITEMERR(7585-QID-ITEMERR)
  2637*    END-EXEC.
  2638*    MOVE '"$N<                  ! $ #00002448' TO DFHEIV0
  2639     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  2640     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2641     MOVE X'2420233030303032343438' TO DFHEIV0(25:11)
  2642     CALL 'kxdfhei1' USING DFHEIV0
  2643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2644
  2645     SET TS-INDX TO 1.
  2646     MOVE 1                      TO QID-ITEM.
  2647 7501-LOOP.
  2648
  2649* EXEC CICS READQ TS
  2650*         INTO(TS-WORK-AREA)
  2651*         QUEUE(QID)
  2652*         LENGTH(TS-LENGTH)
  2653*         ITEM(QID-ITEM)
  2654*    END-EXEC.
  2655*    MOVE '*$II   L              ''   #00002455' TO DFHEIV0
  2656     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  2657     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2658     MOVE X'2020233030303032343535' TO DFHEIV0(25:11)
  2659     CALL 'kxdfhei1' USING DFHEIV0,
  2660           QID,
  2661           TS-WORK-AREA,
  2662           TS-LENGTH,
  2663           QID-ITEM,
  2664           DFHEIV99,
  2665           DFHEIV99
  2666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2667
  2668     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
  2669     SET TS-INDX UP BY 1.
  2670     ADD 1 TO QID-ITEM.
  2671     GO TO 7501-LOOP.
  2672
  2673 7585-QID-ITEMERR.
  2674     IF EIBTRNID NOT = WS-TRANS-ID
  2675        SUBTRACT 1 FROM QID-ITEM
  2676        MOVE QID-ITEM            TO PI-TEMP-STOR-ITEMS
  2677     END-IF.
  2678     GO TO 7599-EXIT.
  2679
  2680 7590-TS-QIDERR.
  2681     IF EIBTRNID = WS-TRANS-ID
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  48
* EL614.cbl
  2682        AND EIBAID = DFHCLEAR
  2683           GO TO 9100-RETURN-TRAN
  2684     END-IF.
  2685     IF EIBTRNID = WS-TRANS-ID
  2686        MOVE ER-0033             TO EMI-ERROR
  2687        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2688        GO TO 8100-SEND-INITIAL-MAP
  2689     END-IF.
  2690
  2691 7599-EXIT.
  2692      EXIT.
  2693
  2694     .
  2695*****************************************************************
  2696 8100-SEND-INITIAL-MAP.
  2697*****************************************************************
  2698     MOVE -1                     TO  APFKL.
  2699     MOVE ZERO                   TO  PI-BROWSE-SW.
  2700     MOVE SAVE-DATE              TO  ADATEO.
  2701     MOVE EIBTIME                TO  TIME-IN.
  2702     MOVE TIME-OUT               TO  ATIMEO.
  2703     IF EMI-ERROR NOT = ZERO
  2704         PERFORM 9900-ERROR-FORMAT
  2705     END-IF
  2706     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSGO
  2707     IF PI-RETURN-TO-PROGRAM NOT = 'EL156' AND 'EL6317' AND
  2708           'EL6318' AND 'EL6316'
  2709        MOVE AL-SADOF            TO SELHA
  2710                                    F3KEYA
  2711        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  2712           S1 > +17
  2713           MOVE AL-SADOF         TO SELA (S1)
  2714        END-PERFORM
  2715     END-IF
  2716
  2717     IF PI-EXPANDED-VIEW = 'Y'
  2718         MOVE 'PF5=UNEXPAND DESCRIPTIONS' TO F5KEYO
  2719     ELSE
  2720         MOVE 'PF5=EXPAND DESCRIPTIONS  ' TO F5KEYO
  2721     END-IF
  2722
  2723* EXEC CICS SEND
  2724*        FROM   (EL614AO)
  2725*        MAPSET (WS-MAPSET-NAME)
  2726*        MAP    (WS-MAP-NAME)
  2727*        CURSOR ERASE
  2728*    END-EXEC.
  2729     MOVE LENGTH OF
  2730      EL614AO
  2731       TO DFHEIV12
  2732     MOVE -1
  2733       TO DFHEIV11
  2734*    MOVE '8$     CT  E    H L F ,   #00002515' TO DFHEIV0
  2735     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2736     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2737     MOVE X'2020233030303032353135' TO DFHEIV0(25:11)
  2738     CALL 'kxdfhei1' USING DFHEIV0,
  2739           WS-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  49
* EL614.cbl
  2740           EL614AO,
  2741           DFHEIV12,
  2742           WS-MAPSET-NAME,
  2743           DFHEIV99,
  2744           DFHEIV99,
  2745           DFHEIV99,
  2746           DFHEIV11,
  2747           DFHEIV99,
  2748           DFHEIV99,
  2749           DFHEIV99
  2750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2751
  2752     GO TO 9100-RETURN-TRAN
  2753     .
  2754 8100-EXIT.
  2755      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  50
* EL614.cbl
  2757*****************************************************************
  2758 8200-SEND-DATAONLY.
  2759*****************************************************************
  2760     MOVE SAVE-DATE              TO  ADATEO.
  2761     MOVE EIBTIME                TO  TIME-IN.
  2762     MOVE TIME-OUT               TO  ATIMEO.
  2763     IF EMI-ERROR NOT = ZERO
  2764         PERFORM 9900-ERROR-FORMAT.
  2765     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSGO.
  2766     IF PI-RETURN-TO-PROGRAM NOT = 'EL156' AND 'EL6317' AND
  2767           'EL6318' AND 'EL6316'
  2768        MOVE AL-SADOF            TO SELHA
  2769                                    F3KEYA
  2770        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  2771           S1 > +17
  2772           MOVE AL-SADOF         TO SELA (S1)
  2773        END-PERFORM
  2774     END-IF
  2775
  2776* EXEC CICS SEND DATAONLY
  2777*        FROM   (EL614AO)
  2778*        MAPSET (WS-MAPSET-NAME)
  2779*        MAP    (WS-MAP-NAME)
  2780*        CURSOR
  2781*    END-EXEC.
  2782     MOVE LENGTH OF
  2783      EL614AO
  2784       TO DFHEIV12
  2785     MOVE -1
  2786       TO DFHEIV11
  2787*    MOVE '8$D    CT       H L F ,   #00002544' TO DFHEIV0
  2788     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2789     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2790     MOVE X'2020233030303032353434' TO DFHEIV0(25:11)
  2791     CALL 'kxdfhei1' USING DFHEIV0,
  2792           WS-MAP-NAME,
  2793           EL614AO,
  2794           DFHEIV12,
  2795           WS-MAPSET-NAME,
  2796           DFHEIV99,
  2797           DFHEIV99,
  2798           DFHEIV99,
  2799           DFHEIV11,
  2800           DFHEIV99,
  2801           DFHEIV99,
  2802           DFHEIV99
  2803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2804
  2805     GO TO 9100-RETURN-TRAN
  2806     .
  2807 8200-EXIT.
  2808      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  51
* EL614.cbl
  2810*****************************************************************
  2811 8300-SEND-TEXT.
  2812*****************************************************************
  2813
  2814* EXEC CICS SEND TEXT
  2815*        FROM   (LOGOFF-TEXT)
  2816*        LENGTH (LOGOFF-LENGTH)
  2817*        ERASE  FREEKB
  2818*    END-EXEC.
  2819*    MOVE '8&      T  E F  H   F -   #00002558' TO DFHEIV0
  2820     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2821     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2822     MOVE X'2020233030303032353538' TO DFHEIV0(25:11)
  2823     CALL 'kxdfhei1' USING DFHEIV0,
  2824           LOGOFF-TEXT,
  2825           LOGOFF-LENGTH,
  2826           DFHEIV99,
  2827           DFHEIV99,
  2828           DFHEIV99,
  2829           DFHEIV99,
  2830           DFHEIV99,
  2831           DFHEIV99,
  2832           DFHEIV99,
  2833           DFHEIV99,
  2834           DFHEIV99,
  2835           DFHEIV99
  2836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2837
  2838
  2839* EXEC CICS RETURN
  2840*    END-EXEC.
  2841*    MOVE '.(                    ''   #00002563' TO DFHEIV0
  2842     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2843     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2844     MOVE X'2020233030303032353633' TO DFHEIV0(25:11)
  2845     CALL 'kxdfhei1' USING DFHEIV0,
  2846           DFHEIV99,
  2847           DFHEIV99,
  2848           DFHEIV99,
  2849           DFHEIV99,
  2850           DFHEIV99,
  2851           DFHEIV99
  2852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2853
  2854 8300-EXIT.
  2855      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  52
* EL614.cbl
  2857*****************************************************************
  2858 8400-LOG-JOURNAL-RECORD.
  2859*****************************************************************
  2860     IF PI-JOURNAL-FILE-ID = 0
  2861         GO TO 8400-EXIT.
  2862     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  2863     MOVE 'ELCNTL'               TO  JP-FILE-ID.
  2864     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  2865*    EXEC CICS JOURNAL
  2866*        JFILEID (PI-JOURNAL-FILE-ID)
  2867*        JTYPEID (WS-JOURNAL-TYPE-ID)
  2868*        FROM    (JOURNAL-RECORD)
  2869*        LENGTH  (WS-JOURNAL-RECORD-LENGTH)
  2870*    END-EXEC.
  2871 8400-EXIT.
  2872      EXIT.
  2873*****************************************************************
  2874 8500-DATE-CONVERSION.
  2875*****************************************************************
  2876
  2877* EXEC CICS LINK
  2878*        PROGRAM  ('ELDATCV')
  2879*        COMMAREA (DATE-CONVERSION-DATA)
  2880*        LENGTH   (DC-COMM-LENGTH)
  2881*    END-EXEC.
  2882     MOVE 'ELDATCV' TO DFHEIV1
  2883*    MOVE '."C                   (   #00002587' TO DFHEIV0
  2884     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2885     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2886     MOVE X'2020233030303032353837' TO DFHEIV0(25:11)
  2887     CALL 'kxdfhei1' USING DFHEIV0,
  2888           DFHEIV1,
  2889           DATE-CONVERSION-DATA,
  2890           DC-COMM-LENGTH,
  2891           DFHEIV99,
  2892           DFHEIV99,
  2893           DFHEIV99,
  2894           DFHEIV99
  2895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2896
  2897 8500-EXIT.
  2898      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  53
* EL614.cbl
  2900*****************************************************************
  2901 9000-RETURN-CICS.
  2902*****************************************************************
  2903     MOVE 'EL005'                TO  THIS-PGM.
  2904     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  2905     PERFORM 9300-XCTL.
  2906 9000-EXIT.
  2907      EXIT.
  2908*****************************************************************
  2909 9100-RETURN-TRAN.
  2910*****************************************************************
  2911     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  2912     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  2913
  2914* EXEC CICS RETURN
  2915*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2916*        LENGTH   (PI-COMM-LENGTH)
  2917*        TRANSID  (WS-TRANS-ID)
  2918*    END-EXEC.
  2919*    MOVE '.(CT                  ''   #00002608' TO DFHEIV0
  2920     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2921     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2922     MOVE X'2020233030303032363038' TO DFHEIV0(25:11)
  2923     CALL 'kxdfhei1' USING DFHEIV0,
  2924           WS-TRANS-ID,
  2925           PROGRAM-INTERFACE-BLOCK,
  2926           PI-COMM-LENGTH,
  2927           DFHEIV99,
  2928           DFHEIV99,
  2929           DFHEIV99
  2930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2931
  2932 9100-EXIT.
  2933      EXIT.
  2934*****************************************************************
  2935 9300-XCTL.
  2936*****************************************************************
  2937     MOVE DFHENTER               TO  EIBAID.
  2938
  2939* EXEC CICS XCTL
  2940*        PROGRAM  (THIS-PGM)
  2941*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2942*        LENGTH   (PI-COMM-LENGTH)
  2943*    END-EXEC.
  2944*    MOVE '.$C                   %   #00002619' TO DFHEIV0
  2945     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2946     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2947     MOVE X'2020233030303032363139' TO DFHEIV0(25:11)
  2948     CALL 'kxdfhei1' USING DFHEIV0,
  2949           THIS-PGM,
  2950           PROGRAM-INTERFACE-BLOCK,
  2951           PI-COMM-LENGTH,
  2952           DFHEIV99
  2953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2954
  2955 9300-EXIT.
  2956      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  54
* EL614.cbl
  2958*****************************************************************
  2959 9400-CLEAR.
  2960*****************************************************************
  2961     MOVE PI-RETURN-TO-PROGRAM  TO  THIS-PGM.
  2962     PERFORM 9300-XCTL.
  2963 9400-EXIT.
  2964      EXIT.
  2965*****************************************************************
  2966 9600-PGMIDERR.
  2967*****************************************************************
  2968
  2969* EXEC CICS HANDLE CONDITION
  2970*        PGMIDERR (8300-SEND-TEXT)
  2971*    END-EXEC.
  2972*    MOVE '"$L                   ! % #00002637' TO DFHEIV0
  2973     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2974     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2975     MOVE X'2520233030303032363337' TO DFHEIV0(25:11)
  2976     CALL 'kxdfhei1' USING DFHEIV0
  2977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2978
  2979     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM
  2980                                     LOGOFF-PGM.
  2981     MOVE 'EL005'                TO  THIS-PGM.
  2982     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  2983     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  2984     PERFORM 9300-XCTL.
  2985 9600-EXIT.
  2986      EXIT.
  2987*****************************************************************
  2988 9900-ERROR-FORMAT.
  2989*****************************************************************
  2990     IF EMI-ERRORS-COMPLETE
  2991         ADD +1             TO  EMI-FATAL-CTR
  2992         MOVE ZERO          TO  EMI-ERROR
  2993         GO TO 9900-EXIT.
  2994
  2995* EXEC CICS LINK
  2996*        PROGRAM  ('EL001')
  2997*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  2998*        LENGTH   (EMI-COMM-LENGTH)
  2999*    END-EXEC.
  3000     MOVE 'EL001' TO DFHEIV1
  3001*    MOVE '."C                   (   #00002655' TO DFHEIV0
  3002     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3003     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3004     MOVE X'2020233030303032363535' TO DFHEIV0(25:11)
  3005     CALL 'kxdfhei1' USING DFHEIV0,
  3006           DFHEIV1,
  3007           ERROR-MESSAGE-INTERFACE-BLOCK,
  3008           EMI-COMM-LENGTH,
  3009           DFHEIV99,
  3010           DFHEIV99,
  3011           DFHEIV99,
  3012           DFHEIV99
  3013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3014
  3015     MOVE ZERO              TO  EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  55
* EL614.cbl
  3016 9900-EXIT.
  3017      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  56
* EL614.cbl
  3019*****************************************************************
  3020 9990-ERROR.
  3021*****************************************************************
  3022     MOVE DFHEIBLK               TO EMI-LINE1.
  3023
  3024* EXEC CICS LINK
  3025*        PROGRAM   ('EL004')
  3026*        COMMAREA  (EMI-LINE1)
  3027*        LENGTH    (72)
  3028*    END-EXEC.
  3029     MOVE 'EL004' TO DFHEIV1
  3030     MOVE 72
  3031       TO DFHEIV11
  3032*    MOVE '."C                   (   #00002668' TO DFHEIV0
  3033     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3034     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3035     MOVE X'2020233030303032363638' TO DFHEIV0(25:11)
  3036     CALL 'kxdfhei1' USING DFHEIV0,
  3037           DFHEIV1,
  3038           EMI-LINE1,
  3039           DFHEIV11,
  3040           DFHEIV99,
  3041           DFHEIV99,
  3042           DFHEIV99,
  3043           DFHEIV99
  3044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3045
  3046     PERFORM 8200-SEND-DATAONLY.
  3047     GO TO 9100-RETURN-TRAN.
  3048 9990-EXIT.
  3049      EXIT.
  3050*****************************************************************
  3051 9995-SECURITY-VIOLATION.
  3052*****************************************************************
  3053*           COPY ELCSCTP.
  3054******************************************************************
  3055*                                                                *
  3056*                            ELCSCTP                             *
  3057*                            VMOD=2.001                          *
  3058*                                                                *
  3059*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3060******************************************************************
  3061
  3062
  3063     MOVE EIBDATE          TO SM-JUL-DATE.
  3064     MOVE EIBTRMID         TO SM-TERMID.
  3065     MOVE THIS-PGM         TO SM-PGM.
  3066     MOVE EIBTIME          TO TIME-IN.
  3067     MOVE TIME-OUT         TO SM-TIME.
  3068     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3069
  3070
  3071* EXEC CICS LINK
  3072*         PROGRAM  ('EL003')
  3073*         COMMAREA (SECURITY-MESSAGE)
  3074*         LENGTH   (80)
  3075*    END-EXEC.
  3076     MOVE 'EL003' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  57
* EL614.cbl
  3077     MOVE 80
  3078       TO DFHEIV11
  3079*    MOVE '."C                   (   #00002697' TO DFHEIV0
  3080     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3081     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3082     MOVE X'2020233030303032363937' TO DFHEIV0(25:11)
  3083     CALL 'kxdfhei1' USING DFHEIV0,
  3084           DFHEIV1,
  3085           SECURITY-MESSAGE,
  3086           DFHEIV11,
  3087           DFHEIV99,
  3088           DFHEIV99,
  3089           DFHEIV99,
  3090           DFHEIV99
  3091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3092
  3093
  3094******************************************************************
  3095
  3096 9995-EXIT.
  3097      EXIT.
  3098 9999-LAST-PARAGRAPH SECTION.
  3099
  3100* GOBACK.
  3101     MOVE '9%                    "   ' TO DFHEIV0
  3102     MOVE 'EL614' TO DFHEIV1
  3103     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3104     GOBACK.
  3105
  3106 9999-DFHBACK SECTION.
  3107     MOVE '9%                    "   ' TO DFHEIV0
  3108     MOVE 'EL614' TO DFHEIV1
  3109     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3110     GOBACK.
  3111 9999-DFHEXIT.
  3112     IF DFHEIGDJ EQUAL 0001
  3113         NEXT SENTENCE
  3114     ELSE IF DFHEIGDJ EQUAL 2
  3115         GO TO 9600-PGMIDERR,
  3116               9990-ERROR
  3117         DEPENDING ON DFHEIGDI
  3118     ELSE IF DFHEIGDJ EQUAL 3
  3119         GO TO 7299-EXIT
  3120         DEPENDING ON DFHEIGDI
  3121     ELSE IF DFHEIGDJ EQUAL 4
  3122         GO TO 7590-TS-QIDERR,
  3123               7585-QID-ITEMERR
  3124         DEPENDING ON DFHEIGDI
  3125     ELSE IF DFHEIGDJ EQUAL 5
  3126         GO TO 8300-SEND-TEXT
  3127         DEPENDING ON DFHEIGDI.
  3128     MOVE '9%                    "   ' TO DFHEIV0
  3129     MOVE 'EL614' TO DFHEIV1
  3130     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3131     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Micro Focus Server Express         V5.1 revision 000 27-Nov-18 23:01 Page  58
* EL614.cbl
* Total Messages:     0
* Data:      103940     Code:        9832
