* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page   1
* ELRAMT.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"ELRAMT.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRAMT.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                ELRAMT.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:15.
     7*                           VMOD=2.007
     8*
     9*AUTHOR.     LOGIC, INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page   2
* ELRAMT.cbl
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE REMAINING AMOUNTS    *
    28*            *    FOR A CERTIFICATE.                             *
    29*            *                                                   *
    30*            *    ORIGINAL BENEFIT = CP-ORIGINAL-BENEFIT         *
    31*            *    ORIGINAL TERM = CP-ORIGINAL-TERM               *
    32*            *    REMAINING-TERM  = CP-REMAINING-TERM            *
    33*            *    A.P.R (FOR NET PAY) = CP-LOAN-APR              *
    34*            *    BENEFIT TYPE = CP-BENEFIT-TYPE                 *
    35*            *    METHOD = CP-EARNING-METHOD                     *
    36*            *    IF COMPANY SPECIAL METHOD  - PUT COMPANY       *
    37*            *     I.D. IN CP-COMPANY-ID.                        *
    38*            *                                                   *
    39*            *****************************************************
    40 ENVIRONMENT DIVISION.
    41
    42 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page   3
* ELRAMT.cbl
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  FILLER   PIC X(32) VALUE '********************************'.
    47 77  FILLER   PIC X(32) VALUE '**  ELRAMT  WORKING STORAGE   **'.
    48 77  FILLER   PIC X(32) VALUE '********* VMOD 2.007 ***********'.
    49
    50*                          COPY ELCRAMTW.
    51*****************************************************************
    52*                                                               *
    53*                                                               *
    54*                            ELCRAMTW.                          *
    55*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    56*                            VMOD=2.004                         *
    57*                                                               *
    58*****************************************************************.
    59******************************************************************
    60*                   C H A N G E   L O G
    61*
    62* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    63*-----------------------------------------------------------------
    64*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    65* EFFECTIVE    NUMBER
    66*-----------------------------------------------------------------
    67* 041710    2007111300001  AJRA  CALC SC NET PAY PLUS 6
    68******************************************************************
    69
    70 01  FILLER.
    71     12  WS-PASS-SW          PIC 9                  VALUE ZERO.
    72       88 COMPUTING-CURRENT-MO                      VALUE ZERO.
    73       88 COMPUTING-PRIOR-MO                        VALUE 1.
    74
    75 01  WS-WORK-MISC.
    76     12  WS-REMAINING-TERM   PIC S9(4)V9     COMP-3.
    77     12  WS-TEMP-RESULT      PIC S9(9)V9(6)  COMP-3.
    78     12  WS-REMAINING-AMT    PIC S9(9)V99    COMP-3.
    79
    80 01  TEXAS-REG-WORK-AREAS.
    81     12  TEX-FACT-1          PIC S9(9)V9(2)  COMP-3.
    82     12  TEX-FACT-2          PIC S9(3)       COMP-3.
    83     12  TEX-FACT-3          PIC S9(3)       COMP-3.
    84     12  TEX-FACT-4          PIC S9(7)       COMP-3.
    85     12  TEX-FACT-5          PIC S9(3)       COMP-3.
    86     12  TEX-FACT-6          PIC S9(3)       COMP-3.
    87     12  TEX-FACT-7          PIC S9(7)       COMP-3.
    88     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
    89     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
    90
    91 01  NET-PAY-INTERFACE.
    92     12  NP-APR              PIC S9(3)V9(4)  COMP-3.
    93     12  NP-ORIG             PIC S9(3)       COMP-3.
    94     12  NP-LOAN-TERM        PIC S9(3)       COMP-3.
    95     12  NP-REM              PIC S9(3)       COMP-3.
    96     12  NP-CAP              PIC S9(3)       COMP-3.
    97     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
    98     12  NP-WORK1            PIC S9(6)V9(6)  COMP-3.
    99     12  NP-WORK2            PIC S9(6)V9(6)  COMP-3.
   100     12  NP-OPT              PIC X(01).
   101         88  NPO-STD                         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page   4
* ELRAMT.cbl
   102         88  NPO-ALT                         VALUE 'A'.
   103         88  NPO-SIMPLE                      VALUE 'S'.
   104         88  NPO-2MO                         VALUE 'I'.
   105         88  NPO-TRUNC                       VALUE 'T' 'U' 'V'.
   106         88  NPO-TRUNC-0                     VALUE 'T'.
   107         88  NPO-TRUNC-1                     VALUE 'U'.
   108         88  NPO-TRUNC-2                     VALUE 'V'.
   109         88  NPO-REFUND                      VALUE 'R'.
   110     12  NP-TYPE             PIC X(01).
   111         88  NET-STD                         VALUE 'N'.
   112         88  NET-SMP                         VALUE 'S'.
   113
   114 01  COMP-3-WORK-AREA         COMP-3.
   115     12  V               PIC SV9(9)    VALUE +.0.
   116     12  I               PIC SV9(9)    VALUE +.0.
   117     12  Y               PIC S9(2)V9(5) VALUE +.0.
   118     12  WK1             PIC S9(4)V9(9).
   119     12  WK2             PIC S9(4)V9(9).
   120     12  WK3             PIC S9(4)V9(9).
   121     12  K1              PIC S999,     VALUE +1.
   122     12  K12             PIC S999,     VALUE +12.
   123     12  K100            PIC S999,     VALUE +100.
   124     12  K1000           PIC S9(7),    VALUE +1000.
   125     12  ANNUAL-INT-RATE PIC S9(3)V9(4).
   126     12  ORIGINAL-TERM   PIC S999.
   127     12  REMAINING-TERM  PIC S999.
   128     12  CAPPED-TERM     PIC S999.
   129     12  FACTOR          PIC S9(4)V9(9).
   130     12  VX              PIC S9V9(8)        VALUE +0.0.
   131     12  SV              PIC S9V9(8)        VALUE +0.0.
   132     12  SX              PIC S9V9(8)        VALUE +0.0.
   133     12  RA              PIC S9(6)V9(9)     VALUE +0.0.
   134     12  N2              PIC S9(7)          VALUE +0.
   135     12  N3              PIC S9(7)          VALUE +0.
   136     12  K-I             PIC S9V9(8)        VALUE +0.0.
   137     12  ODF             PIC S9(3)V9(10)    VALUE +0.0.
   138     12  OD              PIC S9(3)V9(10)    VALUE +0.0.
   139     12  ANGLEM          PIC S9(7)V9(10)    VALUE +0.0.
   140     12  ANGLEN          PIC S9(7)V9(10)    VALUE +0.0.
   141     12  ANGLEU          PIC S9(7)V9(10)    VALUE +0.0.
   142     12  ANGLEM1         PIC S9(7)V9(10)    VALUE +0.0.
   143     12  ANGLEN1         PIC S9(7)V9(10)    VALUE +0.0.
   144
   145 01  BINARY-WORK-AREA        COMP.
   146     12  X1      PIC S999        VALUE +0.
   147     12  X2      PIC S999        VALUE +0.
   148     12  MAX-X   PIC S9(5)       VALUE +0.
   149     12  B1      PIC S9(5)       VALUE +1.
   150     12  B2      PIC S9(5)       VALUE +2.
   151
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page   5
* ELRAMT.cbl
   153*                          COPY ELCCALC.
   154******************************************************************
   155*                                                                *
   156*                           ELCCALC.                            *
   157*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   158*                            VMOD=2.025                          *
   159*                                                                *
   160*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   161*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   162*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   163*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   164*                                                                *
   165*  PASSED TO ELRTRM                                              *
   166*  -----------------                                             *
   167*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   168*  ORIGINAL TERM                                                 *
   169*  BEGINNING DATE                                                *
   170*  ENDING DATE                                                   *
   171*  COMPANY I.D.                                                  *
   172*  ACCOUNT MASTER USER FIELD                                     *
   173*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   174*  FREE LOOK DAYS                                                *
   175*                                                                *
   176*  RETURNED FROM ELRTRM                                          *
   177*  ---------------------                                         *
   178*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   179*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   180*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   181*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   182*----------------------------------------------------------------*
   183*  PASSED TO ELRAMT                                              *
   184*  ----------------                                              *
   185*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   186*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   187*  ORIGINAL AMOUNT                                               *
   188*  ALTERNATE BENEFIT (BALLON)                                    *
   189*  A.P.R. - NET PAY ONLY                                         *
   190*  METHOD
   191*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   192*  COMPANY I.D.                                                  *
   193*  BENEFIT TYPE                                                  *
   194*                                                                *
   195*  RETURNED FROM ELRAMT                                          *
   196*  --------------------                                          *
   197*  REMAINING AMOUNT 1 - CURRENT                                  *
   198*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   199*  REMAINING AMOUNT FACTOR
   200*----------------------------------------------------------------*
   201*  PASSED TO ELRESV                                              *
   202*  -----------------                                             *
   203*  CERTIFICATE EFFECTIVE DATE                                    *
   204*  VALUATION DATE                                                *
   205*  PAID THRU DATE                                                *
   206*  BENEFIT                                                       *
   207*  INCURRED DATE                                                 *
   208*  REPORTED DATE                                                 *
   209*  ISSUE AGE                                                     *
   210*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page   6
* ELRAMT.cbl
   211*  CDT PERCENT                                                   *
   212*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   213* *CLAIM TYPE (LIFE, A/H)                                        *
   214* *REMAINING BENEFIT (FROM ELRAMT)                               *
   215* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   216*                                                                *
   217*  RETURNED FROM ELRESV                                          *
   218*  --------------------                                          *
   219*  CDT TABLE USED                                                *
   220*  CDT FACTOR USED                                               *
   221*  PAY TO CURRENT RESERVE                                        *
   222*  I.B.N.R. - A/H ONLY                                           *
   223*  FUTURE (ACCRUED) AH ONLY                                      *
   224*----------------------------------------------------------------*
   225*  PASSED TO ELRATE                                              *
   226*  ----------------                                              *
   227*  CERT ISSUE DATE                                               *
   228*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   229*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   230*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   231*  STATE CODE (CLIENT DEFINED)                                   *
   232*  STATE CODE (STANDARD P.O. ABBRV)                              *
   233*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   234*  DEVIATION CODE                                                *
   235*  ISSUE AGE                                                     *
   236*  ORIGINAL BENEFIT AMOUNT                                       *
   237*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   238*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   239*  BENEFIT KIND (LIFE OR A/H)                                    *
   240*  A.P.R.                                                        *
   241*  METHOD
   242*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   243*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   244*  COMPANY I.D. (3 CHARACTER)                                    *
   245*  BENEFIT CODE                                                  *
   246*  BENEFIT OVERRIDE CODE                                         *
   247*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   248*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   249*  JOINT INDICATOR (CSL ONLY)                                    *
   250*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   251*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   252*                                                                *
   253*  RETURNED FROM ELRATE                                          *
   254*  --------------------                                          *
   255*  CALCULATED PREMIUM                                            *
   256*  PREMIUM RATE                                                  *
   257*  MORTALITY CODE                                                *
   258*  MAX ATTAINED AGE                                              *
   259*  MAX AGE                                                       *
   260*  MAX TERM                                                      *
   261*  MAX MONTHLY BENEFIT                                           *
   262*  MAX TOTAL BENIFIT                                             *
   263*  COMPOSITE RATE (OPEN-END ONLY)                                *
   264*----------------------------------------------------------------*
   265*  PASSED TO ELRFND                                              *
   266*  ----------------                                              *
   267*  CERT ISSUE DATE                                               *
   268*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page   7
* ELRAMT.cbl
   269*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   270*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   271*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   272*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   273*  STATE CODE (CLIENT DEFINED)                                   *
   274*  STATE CODE (STANDARD P.O. ABBRV)                              *
   275*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   276*  DEVIATION CODE                                                *
   277*  ISSUE AGE                                                     *
   278*  ORIGINAL BENEFIT AMOUNT                                       *
   279*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   280*  PROCESS TYPE (CANCEL)                                         *
   281*  BENEFIT KIND (LIFE OR A/H)                                    *
   282*  A.P.R.                                                        *
   283*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   284*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   285*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   286*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   287*  COMPANY I.D. (3 CHARACTER)                                    *
   288*  BENEFIT CODE                                                  *
   289*  BENEFIT OVERRIDE CODE                                         *
   290*                                                                *
   291*  RETURNED FROM ELRFND                                          *
   292*  --------------------                                          *
   293*  CALCULATED REFUND                                             *
   294*----------------------------------------------------------------*
   295*  PASSED TO ELEARN                                              *
   296*  ----------------                                              *
   297*  CERT ISSUE DATE                                               *
   298*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   299*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   300*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   301*  STATE CODE (CLIENT DEFINED)                                   *
   302*  STATE CODE (STANDARD P.O. ABBRV)                              *
   303*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   304*  DEVIATION CODE                                                *
   305*  ISSUE AGE                                                     *
   306*  ORIGINAL BENEFIT AMOUNT                                       *
   307*  BENEFIT KIND (LIFE OR A/H)                                    *
   308*  A.P.R.                                                        *
   309*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   310*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   311*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   312*  COMPANY I.D. (3 CHARACTER)                                    *
   313*  BENEFIT CODE                                                  *
   314*  BENEFIT OVERRIDE CODE                                         *
   315*                                                                *
   316*  RETURNED FROM ELEARN                                          *
   317*  --------------------                                          *
   318*  INDICATED  EARNINGS                                           *
   319*----------------------------------------------------------------*
   320*                 LENGTH = 450                                   *
   321*                                                                *
   322******************************************************************
   323******************************************************************
   324*                   C H A N G E   L O G
   325*
   326* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page   8
* ELRAMT.cbl
   327*-----------------------------------------------------------------
   328*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   329* EFFECTIVE    NUMBER
   330*-----------------------------------------------------------------
   331* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   332* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   333* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   334* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   335* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   336* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   337* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   338* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   339* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   340******************************************************************
   341
   342 01  CALCULATION-PASS-AREA.
   343     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   344                                     COMP.
   345
   346     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   347       88  NO-CP-ERROR                             VALUE ZERO.
   348       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   349                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   350       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   351       88  CP-ERROR-IN-DATES                       VALUE '2'.
   352       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   353       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   354       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   355       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   356       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   357       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   358       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   359       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   360       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   361       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   362       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   363       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   364       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   365       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   366       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   367
   368     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   369       88  NO-CP-ERROR-2                           VALUE ZERO.
   370***********************  INPUT AREAS ****************************
   371
   372     12  CP-CALCULATION-AREA.
   373         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   374         16  CP-CERT-EFF-DT        PIC XX.
   375         16  CP-VALUATION-DT       PIC XX.
   376         16  CP-PAID-THRU-DT       PIC XX.
   377         16  CP-BENEFIT-TYPE       PIC X.
   378           88  CP-AH                               VALUE 'A' 'D'
   379                                                   'I' 'U'.
   380           88  CP-REDUCING-LIFE                    VALUE 'R'.
   381           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   382         16  CP-INCURRED-DT        PIC XX.
   383         16  CP-REPORTED-DT        PIC XX.
   384         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page   9
* ELRAMT.cbl
   385         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   386         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   387                                     COMP-3.
   388         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   389                                     COMP-3.
   390         16  CP-CDT-METHOD         PIC X.
   391           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   392           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   393           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   394         16  CP-CLAIM-TYPE         PIC X.
   395           88  CP-AH-CLAIM                         VALUE 'A'.
   396           88  CP-LIFE-CLAIM                       VALUE 'L'.
   397         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   398                                     COMP-3.
   399         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   400                                     COMP-3.
   401         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   402                                     COMP-3.
   403         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   404                                     COMP-3.
   405         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   406                                     COMP-3.
   407         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   408                                     COMP-3.
   409         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   410                                     COMP-3.
   411         16  CP-REM-TERM-METHOD    PIC X.
   412           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   413           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   414           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   415           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   416           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   417           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   418           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   419         16  CP-EARNING-METHOD     PIC X.
   420           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   421           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   422           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   423           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   424           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   425           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   426           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   427           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   428           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   429           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   430           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   431           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   432           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   433           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   434         16  CP-PROCESS-TYPE       PIC X.
   435           88  CP-CLAIM                            VALUE '1'.
   436           88  CP-CANCEL                           VALUE '2'.
   437           88  CP-ISSUE                            VALUE '3'.
   438         16  CP-SPECIAL-CALC-CD    PIC X.
   439           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   440           88  CP-1-MTH-INTEREST               VALUE ' '.
   441           88  CP-0-MTH-INTEREST               VALUE 'A'.
   442           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  10
* ELRAMT.cbl
   443           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   444           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   445           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   446           88  CP-FARM-PLAN                    VALUE 'F'.
   447           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   448           88  CP-2-MTH-INTEREST               VALUE 'I'.
   449           88  CP-3-MTH-INTEREST               VALUE 'J'.
   450           88  CP-4-MTH-INTEREST               VALUE 'K'.
   451           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   452           88  CP-MORTGAGE-REC                 VALUE 'M'.
   453           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   454           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   455           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   456           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   457                                                     'W' 'X'.
   458           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   459           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   460           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   461           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   462           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   463           88  CP-SUMMARY-REC                  VALUE 'Z'.
   464           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   465           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   466           88  CP-AD-D-BENEFIT                 VALUE '4'.
   467           88  CP-CSL-METH-1                   VALUE '5'.
   468           88  CP-CSL-METH-2                   VALUE '6'.
   469           88  CP-CSL-METH-3                   VALUE '7'.
   470           88  CP-CSL-METH-4                   VALUE '8'.
   471
   472         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   473                                     COMP-3.
   474         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   475         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   476         16  CP-STATE              PIC XX          VALUE SPACE.
   477         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   478         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   479           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   480               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   481         16  CP-R78-OPTION         PIC X.
   482           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   483           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   484
   485         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   486         16  CP-IBNR-RESERVE-SW    PIC X.
   487         16  CP-CLAIM-STATUS       PIC X.
   488         16  CP-RATE-FILE          PIC X.
   489         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   490                                     COMP-3.
   491
   492         16  CP-LIFE-OVERRIDE-CODE PIC X.
   493         16  CP-AH-OVERRIDE-CODE   PIC X.
   494
   495         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   496                                     COMP-3.
   497         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   498                                   PIC S9(5)V99 COMP-3.
   499         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   500                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  11
* ELRAMT.cbl
   501         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   502                                     COMP-3.
   503         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   504                                     COMP-3.
   505         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   506                                  PIC S9(7)V99 COMP-3.
   507
   508         16  CP-PAID-FROM-DATE     PIC X(02).
   509         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   510         16  CP-EXT-DAYS-CALC      PIC X.
   511           88  CP-EXT-NO-CHG                   VALUE ' '.
   512           88  CP-EXT-CHG-LF                   VALUE '1'.
   513           88  CP-EXT-CHG-AH                   VALUE '2'.
   514           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   515         16  CP-DOMICILE-STATE     PIC XX.
   516         16  CP-CARRIER            PIC X.
   517         16  CP-REIN-FLAG          PIC X.
   518         16  CP-REM-TRM-CALC-OPTION PIC X.
   519           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   520                      '2' '3' '4' '5'.
   521           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   522           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   523           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   524           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   525           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   526           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   527           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   528           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   529         16  CP-SIG-SWITCH         PIC X.
   530         16  CP-RATING-METHOD      PIC X.
   531           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   532           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   533           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   534           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   535           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   536           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   537           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   538           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   539           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   540         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   541                                     COMP-3.
   542         16  CP-BEN-CATEGORY       PIC X.
   543         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   544         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   545                                   PIC S99V9(5) COMP-3.
   546         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   547         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   548                                   PIC S99V9(5) COMP-3.
   549         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   550         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   551         16  CP-EXPIRE-DT          PIC XX.
   552         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   553         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   554         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   555         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   556         16  CP-DDF-SPEC-CALC      PIC X.
   557             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   558             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  12
* ELRAMT.cbl
   559         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   560         16  CP-CANCEL-REASON      PIC X.
   561         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   562         16  CP-PMT-MODE           PIC X.
   563         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   564         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   565         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   566         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   567         16  FILLER                PIC X.
   568
   569***************    OUTPUT FROM ELRESV   ************************
   570
   571         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   572
   573         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   574                                     COMP-3.
   575         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   576                                     COMP-3.
   577         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   578                                     COMP-3.
   579         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   580                                     COMP-3.
   581         16  FILLER                PIC X(09).
   582***************    OUTPUT FROM ELRTRM   *************************
   583
   584         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   585                                     COMP-3.
   586         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   587                                     COMP-3.
   588         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   589                                     COMP-3.
   590         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   591                                     COMP-3.
   592         16  FILLER                PIC X(12).
   593
   594***************    OUTPUT FROM ELRAMT   *************************
   595
   596         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   597                                     COMP-3.
   598         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   599                                     COMP-3.
   600         16  FILLER                PIC X(12).
   601
   602***************    OUTPUT FROM ELRATE   *************************
   603
   604         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   605                                     COMP-3.
   606         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   607                                     COMP-3.
   608         16  CP-MORTALITY-CODE     PIC X(4).
   609         16  CP-RATE-EDIT-FLAG     PIC X.
   610             88  CP-RATES-NEED-APR                  VALUE '1'.
   611         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   612                                     COMP-3.
   613         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   614         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   615         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   616                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  13
* ELRAMT.cbl
   617         16  FILLER                PIC X(07).
   618
   619***************    OUTPUT FROM ELRFND   *************************
   620
   621         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   622                                     COMP-3.
   623         16  CP-REFUND-TYPE-USED   PIC X.
   624           88  CP-R-AS-R78                         VALUE '1'.
   625           88  CP-R-AS-PRORATA                     VALUE '2'.
   626           88  CP-R-AS-CALIF                       VALUE '3'.
   627           88  CP-R-AS-TEXAS                       VALUE '4'.
   628           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   629           88  CP-R-AS-NET-PAY                     VALUE '5'.
   630           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   631           88  CP-R-AS-MEAN                        VALUE '8'.
   632           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   633           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   634           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   635           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   636           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   637           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   638         16  FILLER                PIC X(12).
   639
   640***************    OUTPUT FROM ELEARN   *************************
   641
   642         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   643                                     COMP-3.
   644         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   645                                     COMP-3.
   646         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   647                                     COMP-3.
   648         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   649                                     COMP-3.
   650         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   651                                     COMP-3.
   652         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   653                                     COMP-3.
   654         16  CP-EARNING-TYPE-USED  PIC X.
   655           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   656           88  CP-E-AS-R78                         VALUE '1'.
   657           88  CP-E-AS-PRORATA                     VALUE '2'.
   658           88  CP-E-AS-TEXAS                       VALUE '4'.
   659           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
   660           88  CP-E-AS-NET-PAY                     VALUE '5'.
   661           88  CP-E-AS-ANTICIPATION                VALUE '6'.
   662           88  CP-E-AS-MEAN                        VALUE '8'.
   663           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
   664         16  FILLER                PIC X(12).
   665
   666***************    OUTPUT FROM ELPMNT   *************************
   667
   668         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
   669                                     COMP-3.
   670         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
   671                                     COMP-3.
   672         16  FILLER                PIC X(12).
   673
   674***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  14
* ELRAMT.cbl
   675         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
   676                                     COMP-3.
   677         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
   678                                     COMP-3.
   679         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
   680                                     COMP-3.
   681         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
   682                                     COMP-3.
   683         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
   684                                     COMP-3.
   685         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
   686                                     COMP-3.
   687         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
   688             88  OPEN-RATE-FILE                   VALUE 'O'.
   689             88  CLOSE-RATE-FILE                  VALUE 'C'.
   690             88  IO-ERROR                         VALUE 'E'.
   691
   692         16  CP-FIRST-PAY-DATE     PIC XX.
   693
   694         16  CP-JOINT-INDICATOR    PIC X.
   695
   696         16  CP-RESERVE-REMAINING-TERM
   697                                   PIC S9(4)V9    VALUE ZERO
   698                                     COMP-3.
   699
   700         16  CP-INSURED-BIRTH-DT   PIC XX.
   701
   702         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
   703                                     COMP-3.
   704
   705         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
   706                                     COMP-3.
   707
   708         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
   709                                     COMP-3.
   710
   711         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
   712                                     COMP-3.
   713
   714         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
   715                                     COMP-3.
   716
   717         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
   718                                     COMP-3.
   719
   720         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
   721                                     COMP-3.
   722
   723         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
   724             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
   725
   726         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
   727                                     COMP-3.
   728         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
   729                                     COMP-3.
   730         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
   731         16  FILLER                PIC X(15).
   732******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  15
* ELRAMT.cbl
   734*                          COPY ELCDATE.
   735******************************************************************
   736*                                                                *
   737*                                                                *
   738*                            ELCDATE.                            *
   739*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   740*                            VMOD=2.003
   741*                                                                *
   742*                                                                *
   743*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   744*                 LENGTH = 200                                   *
   745******************************************************************
   746
   747 01  DATE-CONVERSION-DATA.
   748     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   749     12  DC-OPTION-CODE                PIC X.
   750         88  BIN-TO-GREG                VALUE ' '.
   751         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   752         88  EDIT-GREG-TO-BIN           VALUE '2'.
   753         88  YMD-GREG-TO-BIN            VALUE '3'.
   754         88  MDY-GREG-TO-BIN            VALUE '4'.
   755         88  JULIAN-TO-BIN              VALUE '5'.
   756         88  BIN-PLUS-ELAPSED           VALUE '6'.
   757         88  FIND-CENTURY               VALUE '7'.
   758         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   759         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   760         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   761         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   762         88  JULIAN-TO-BIN-3            VALUE 'C'.
   763         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   764         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   765         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   766         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   767         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   768         88  CHECK-LEAP-YEAR            VALUE 'H'.
   769         88  BIN-3-TO-GREG              VALUE 'I'.
   770         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   771         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   772         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   773         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   774         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   775         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   776         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   777         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   778         88  THREE-CHARACTER-BIN
   779                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   780         88  GREGORIAN-TO-BIN
   781                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   782         88  BIN-TO-GREGORIAN
   783                  VALUES ' ' '1' 'I' '8' 'G'.
   784         88  JULIAN-TO-BINARY
   785                  VALUES '5' 'C' 'E' 'F'.
   786     12  DC-ERROR-CODE                 PIC X.
   787         88  NO-CONVERSION-ERROR        VALUE ' '.
   788         88  DATE-CONVERSION-ERROR
   789                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   790         88  DATE-IS-ZERO               VALUE '1'.
   791         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  16
* ELRAMT.cbl
   792         88  DATE-IS-INVALID            VALUE '3'.
   793         88  DATE1-GREATER-DATE2        VALUE '4'.
   794         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   795         88  DATE-INVALID-OPTION        VALUE '9'.
   796         88  INVALID-CENTURY            VALUE 'A'.
   797         88  ONLY-CENTURY               VALUE 'B'.
   798         88  ONLY-LEAP-YEAR             VALUE 'C'.
   799         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   800     12  DC-END-OF-MONTH               PIC X.
   801         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   802     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   803         88  USE-NORMAL-PROCESS         VALUE ' '.
   804         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   805         88  ADJUST-UP-100-YRS          VALUE '2'.
   806     12  FILLER                        PIC X.
   807     12  DC-CONVERSION-DATES.
   808         16  DC-BIN-DATE-1             PIC XX.
   809         16  DC-BIN-DATE-2             PIC XX.
   810         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   811         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   812                       DC-GREG-DATE-1-EDIT.
   813             20  DC-EDIT1-MONTH        PIC 99.
   814             20  SLASH1-1              PIC X.
   815             20  DC-EDIT1-DAY          PIC 99.
   816             20  SLASH1-2              PIC X.
   817             20  DC-EDIT1-YEAR         PIC 99.
   818         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   819         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   820                     DC-GREG-DATE-2-EDIT.
   821             20  DC-EDIT2-MONTH        PIC 99.
   822             20  SLASH2-1              PIC X.
   823             20  DC-EDIT2-DAY          PIC 99.
   824             20  SLASH2-2              PIC X.
   825             20  DC-EDIT2-YEAR         PIC 99.
   826         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   827         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   828                     DC-GREG-DATE-1-YMD.
   829             20  DC-YMD-YEAR           PIC 99.
   830             20  DC-YMD-MONTH          PIC 99.
   831             20  DC-YMD-DAY            PIC 99.
   832         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   833         16  DC-GREG-DATE-1-MDY-R REDEFINES
   834                      DC-GREG-DATE-1-MDY.
   835             20  DC-MDY-MONTH          PIC 99.
   836             20  DC-MDY-DAY            PIC 99.
   837             20  DC-MDY-YEAR           PIC 99.
   838         16  DC-GREG-DATE-1-ALPHA.
   839             20  DC-ALPHA-MONTH        PIC X(10).
   840             20  DC-ALPHA-DAY          PIC 99.
   841             20  FILLER                PIC XX.
   842             20  DC-ALPHA-CENTURY.
   843                 24 DC-ALPHA-CEN-N     PIC 99.
   844             20  DC-ALPHA-YEAR         PIC 99.
   845         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   846         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   847         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   848         16  DC-JULIAN-DATE            PIC 9(05).
   849         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  17
* ELRAMT.cbl
   850                                       PIC 9(05).
   851         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   852             20  DC-JULIAN-YEAR        PIC 99.
   853             20  DC-JULIAN-DAYS        PIC 999.
   854         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   855         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   856         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   857     12  DATE-CONVERSION-VARIBLES.
   858         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   859         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   860             20  FILLER                PIC 9(3).
   861             20  HOLD-CEN-1-CCYY.
   862                 24  HOLD-CEN-1-CC     PIC 99.
   863                 24  HOLD-CEN-1-YY     PIC 99.
   864             20  HOLD-CEN-1-MO         PIC 99.
   865             20  HOLD-CEN-1-DA         PIC 99.
   866         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   867             20  HOLD-CEN-1-R-MO       PIC 99.
   868             20  HOLD-CEN-1-R-DA       PIC 99.
   869             20  HOLD-CEN-1-R-CCYY.
   870                 24  HOLD-CEN-1-R-CC   PIC 99.
   871                 24  HOLD-CEN-1-R-YY   PIC 99.
   872             20  FILLER                PIC 9(3).
   873         16  HOLD-CENTURY-1-X.
   874             20  FILLER                PIC X(3)  VALUE SPACES.
   875             20  HOLD-CEN-1-X-CCYY.
   876                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   877                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   878             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   879             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   880         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   881             20  HOLD-CEN-1-R-X-MO     PIC XX.
   882             20  HOLD-CEN-1-R-X-DA     PIC XX.
   883             20  HOLD-CEN-1-R-X-CCYY.
   884                 24  HOLD-CEN-1-R-X-CC PIC XX.
   885                 24  HOLD-CEN-1-R-X-YY PIC XX.
   886             20  FILLER                PIC XXX.
   887         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   888         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   889         16  DC-JULIAN-DATE-1          PIC 9(07).
   890         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   891             20  DC-JULIAN-1-CCYY.
   892                 24  DC-JULIAN-1-CC    PIC 99.
   893                 24  DC-JULIAN-1-YR    PIC 99.
   894             20  DC-JULIAN-DA-1        PIC 999.
   895         16  DC-JULIAN-DATE-2          PIC 9(07).
   896         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   897             20  DC-JULIAN-2-CCYY.
   898                 24  DC-JULIAN-2-CC    PIC 99.
   899                 24  DC-JULIAN-2-YR    PIC 99.
   900             20  DC-JULIAN-DA-2        PIC 999.
   901         16  DC-GREG-DATE-A-EDIT.
   902             20  DC-EDITA-MONTH        PIC 99.
   903             20  SLASHA-1              PIC X VALUE '/'.
   904             20  DC-EDITA-DAY          PIC 99.
   905             20  SLASHA-2              PIC X VALUE '/'.
   906             20  DC-EDITA-CCYY.
   907                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  18
* ELRAMT.cbl
   908                 24  DC-EDITA-YEAR     PIC 99.
   909         16  DC-GREG-DATE-B-EDIT.
   910             20  DC-EDITB-MONTH        PIC 99.
   911             20  SLASHB-1              PIC X VALUE '/'.
   912             20  DC-EDITB-DAY          PIC 99.
   913             20  SLASHB-2              PIC X VALUE '/'.
   914             20  DC-EDITB-CCYY.
   915                 24  DC-EDITB-CENT     PIC 99.
   916                 24  DC-EDITB-YEAR     PIC 99.
   917         16  DC-GREG-DATE-CYMD         PIC 9(08).
   918         16  DC-GREG-DATE-CYMD-R REDEFINES
   919                              DC-GREG-DATE-CYMD.
   920             20  DC-CYMD-CEN           PIC 99.
   921             20  DC-CYMD-YEAR          PIC 99.
   922             20  DC-CYMD-MONTH         PIC 99.
   923             20  DC-CYMD-DAY           PIC 99.
   924         16  DC-GREG-DATE-MDCY         PIC 9(08).
   925         16  DC-GREG-DATE-MDCY-R REDEFINES
   926                              DC-GREG-DATE-MDCY.
   927             20  DC-MDCY-MONTH         PIC 99.
   928             20  DC-MDCY-DAY           PIC 99.
   929             20  DC-MDCY-CEN           PIC 99.
   930             20  DC-MDCY-YEAR          PIC 99.
   931    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   932        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   933    12  DC-EL310-DATE                  PIC X(21).
   934    12  FILLER                         PIC X(28).
   935
   936****************************************************************
   937*
   938* Copyright (c) 2007 by Clerity Solutions, Inc.
   939* All rights reserved.
   940*
   941****************************************************************
   942 01  DFHEIV.
   943   02  DFHEIV0               PIC X(35).
   944   02  DFHEIV1               PIC X(08).
   945   02  DFHEIV2               PIC X(08).
   946   02  DFHEIV3               PIC X(08).
   947   02  DFHEIV4               PIC X(06).
   948   02  DFHEIV5               PIC X(04).
   949   02  DFHEIV6               PIC X(04).
   950   02  DFHEIV7               PIC X(02).
   951   02  DFHEIV8               PIC X(02).
   952   02  DFHEIV9               PIC X(01).
   953   02  DFHEIV10              PIC S9(7) COMP-3.
   954   02  DFHEIV11              PIC S9(4) COMP SYNC.
   955   02  DFHEIV12              PIC S9(4) COMP SYNC.
   956   02  DFHEIV13              PIC S9(4) COMP SYNC.
   957   02  DFHEIV14              PIC S9(4) COMP SYNC.
   958   02  DFHEIV15              PIC S9(4) COMP SYNC.
   959   02  DFHEIV16              PIC S9(9) COMP SYNC.
   960   02  DFHEIV17              PIC X(04).
   961   02  DFHEIV18              PIC X(04).
   962   02  DFHEIV19              PIC X(04).
   963   02  DFHEIV20              USAGE IS POINTER.
   964   02  DFHEIV21              USAGE IS POINTER.
   965   02  DFHEIV22              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  19
* ELRAMT.cbl
   966   02  DFHEIV23              USAGE IS POINTER.
   967   02  DFHEIV24              USAGE IS POINTER.
   968   02  DFHEIV25              PIC S9(9) COMP SYNC.
   969   02  DFHEIV26              PIC S9(9) COMP SYNC.
   970   02  DFHEIV27              PIC S9(9) COMP SYNC.
   971   02  DFHEIV28              PIC S9(9) COMP SYNC.
   972   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   973   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   974   02  FILLER                PIC X(02).
   975   02  DFHEIV99              PIC X(08) VALUE SPACE.
   976   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   977   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   978   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   979   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   980 LINKAGE  SECTION.
   981*****************************************************************
   982*                                                               *
   983* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   984* All rights reserved.                                          *
   985*                                                               *
   986*****************************************************************
   987 01  dfheiblk.
   988     02  eibtime          pic s9(7) comp-3.
   989     02  eibdate          pic s9(7) comp-3.
   990     02  eibtrnid         pic x(4).
   991     02  eibtaskn         pic s9(7) comp-3.
   992     02  eibtrmid         pic x(4).
   993     02  dfheigdi         pic s9(4) comp.
   994     02  eibcposn         pic s9(4) comp.
   995     02  eibcalen         pic s9(4) comp.
   996     02  eibaid           pic x(1).
   997     02  eibfiller1       pic x(1).
   998     02  eibfn            pic x(2).
   999     02  eibfiller2       pic x(2).
  1000     02  eibrcode         pic x(6).
  1001     02  eibfiller3       pic x(2).
  1002     02  eibds            pic x(8).
  1003     02  eibreqid         pic x(8).
  1004     02  eibrsrce         pic x(8).
  1005     02  eibsync          pic x(1).
  1006     02  eibfree          pic x(1).
  1007     02  eibrecv          pic x(1).
  1008     02  eibsend          pic x(1).
  1009     02  eibatt           pic x(1).
  1010     02  eibeoc           pic x(1).
  1011     02  eibfmh           pic x(1).
  1012     02  eibcompl         pic x(1).
  1013     02  eibsig           pic x(1).
  1014     02  eibconf          pic x(1).
  1015     02  eiberr           pic x(1).
  1016     02  eibrldbk         pic x(1).
  1017     02  eiberrcd         pic x(4).
  1018     02  eibsynrb         pic x(1).
  1019     02  eibnodat         pic x(1).
  1020     02  eibfiller5       pic x(2).
  1021     02  eibresp          pic 9(09) comp.
  1022     02  eibresp2         pic 9(09) comp.
  1023     02  dfheigdj         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  20
* ELRAMT.cbl
  1024     02  dfheigdk         pic s9(4) comp.
  1025 01  DFHCOMMAREA                 PIC X(450).
  1026
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  21
* ELRAMT.cbl
  1028 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1029 0000-DFHEXIT SECTION.
  1030     MOVE '9#                    $   ' TO DFHEIV0.
  1031     MOVE 'ELRAMT' TO DFHEIV1.
  1032     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1033     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1034
  1035 000-START-REM-CALC.
  1036*                           COPY ELCRAMTP.
  1037*****************************************************************
  1038*                                                               *
  1039*                                                               *
  1040*                            ELCRAMTP.                          *
  1041*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1042*                            VMOD=2.015                         *
  1043*                                                               *
  1044*                CALCULATE THE REMAINING AMOUNT.                *
  1045*****************************************************************.
  1046******************************************************************
  1047*                   C H A N G E   L O G
  1048*
  1049* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1050*-----------------------------------------------------------------
  1051*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1052* EFFECTIVE    NUMBER
  1053*-----------------------------------------------------------------
  1054* 041710    2007111300001  AJRA  CALC SC NET PAY PLUS 6
  1055* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1056* 032612  CR2011110200001  PEMA  AHL CHANGES
  1057******************************************************************
  1058
  1059     MOVE ZERO                   TO  CP-RETURN-CODE
  1060                                     CP-REMAINING-AMT
  1061                                     CP-REMAINING-AMT-PRV
  1062                                     CP-REMAMT-FACTOR
  1063                                     NP-FACTOR
  1064                                     WS-PASS-SW.
  1065
  1066 050-START.
  1067     IF COMPUTING-PRIOR-MO
  1068         COMPUTE WS-REMAINING-TERM = CP-REMAINING-TERM + +1
  1069      ELSE
  1070          MOVE CP-REMAINING-TERM   TO WS-REMAINING-TERM.
  1071
  1072     IF CP-BENEFIT-TYPE = 'A'
  1073        IF CP-R-MAX-MON-BEN NOT = ZEROS
  1074           COMPUTE CP-REMAINING-AMT = CP-REMAINING-TERM *
  1075              CP-R-MAX-MON-BEN
  1076        ELSE
  1077           COMPUTE CP-REMAINING-AMT = CP-REMAINING-TERM  *
  1078              CP-ORIGINAL-BENEFIT
  1079        END-IF
  1080        GO TO 999-CALC-REM-AMT-X
  1081     END-IF
  1082
  1083     IF CP-BENEFIT-TYPE = 'L' OR 'P'
  1084         IF CP-EARN-AS-NET-PAY
  1085             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  22
* ELRAMT.cbl
  1086         ELSE
  1087             MOVE CP-ORIGINAL-BENEFIT    TO  WS-REMAINING-AMT
  1088             GO TO 800-CALC-REM-RESULT.
  1089
  1090     IF CP-ORIGINAL-TERM = ZERO
  1091         MOVE '4'                TO  CP-RETURN-CODE
  1092         GO TO 999-CALC-REM-AMT-X.
  1093
  1094*    IF (CP-EARN-AS-REG-BALLOON)
  1095*      AND
  1096*       (NOT CP-BALLOON-LAST-PMT)
  1097*       COMPUTE WS-TEMP-RESULT ROUNDED EQUAL
  1098*         CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM - 1)
  1099*    ELSE
  1100     COMPUTE WS-TEMP-RESULT ROUNDED EQUAL
  1101                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1102
  1103     IF CP-EARN-AS-REG-BALLOON
  1104        GO TO 400-CALC-REM-BALLOON.
  1105
  1106     IF (CP-EARN-AS-NET-PAY)
  1107*       AND (CP-LOAN-APR > ZEROS)
  1108        GO TO 300-CALC-NET-PAY-REM
  1109     END-IF
  1110
  1111     IF CP-SPECIAL-CALC-CD IS EQUAL TO 'N'
  1112         GO TO 300-CALC-NET-PAY-REM.
  1113
  1114     MOVE CP-CERT-EFF-DT            TO  DC-BIN-DATE-1.
  1115     MOVE ' '                       TO  DC-OPTION-CODE.
  1116     PERFORM 0030-CNVT-DT THRU 0030-CNVT-EXIT.
  1117
  1118*    IF CP-STATE-STD-ABBRV IS EQUAL TO 'OH'   AND
  1119     IF (CP-STATE-STD-ABBRV IS EQUAL TO 'OH')   AND
  1120        (CP-CLASS-CODE NOT = 'L ') AND
  1121        CP-ORIGINAL-TERM IS GREATER THAN +60  AND
  1122        CP-LOAN-APR IS GREATER THAN +0
  1123         IF DC-GREG-DATE-CYMD IS GREATER THAN 19831031
  1124             GO TO 300-CALC-NET-PAY-REM.
  1125
  1126     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MT'   AND
  1127        CP-ORIGINAL-TERM IS GREATER THAN +61  AND
  1128        CP-LOAN-APR IS GREATER THAN +0
  1129         IF DC-GREG-DATE-CYMD IS GREATER THAN 19830318
  1130             GO TO 300-CALC-NET-PAY-REM.
  1131
  1132     IF CP-STATE-STD-ABBRV IS EQUAL TO 'UT'   AND
  1133        CP-ORIGINAL-TERM IS GREATER THAN +62  AND
  1134        CP-LOAN-APR IS GREATER THAN +0
  1135         IF DC-GREG-DATE-CYMD IS GREATER THAN 19810831  AND
  1136            DC-GREG-DATE-CYMD IS LESS    THAN 19830901
  1137             GO TO 300-CALC-NET-PAY-REM.
  1138
  1139     IF CP-STATE-STD-ABBRV IS EQUAL TO 'RI'   AND
  1140        CP-ORIGINAL-TERM IS GREATER THAN +60  AND
  1141        CP-LOAN-APR IS GREATER THAN +0
  1142         IF DC-GREG-DATE-CYMD IS GREATER THAN 19831231
  1143             GO TO 300-CALC-NET-PAY-REM.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  23
* ELRAMT.cbl
  1144
  1145     IF WS-REMAINING-TERM = CP-ORIGINAL-TERM
  1146         MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1147         GO TO 800-CALC-REM-RESULT.
  1148
  1149     IF CP-EARN-AS-TEXAS
  1150         GO TO 200-CALC-TEXAS-REM.
  1151
  1152 100-ORDINARY-REM.
  1153     COMPUTE WS-REMAINING-AMT ROUNDED = WS-TEMP-RESULT *
  1154                                          WS-REMAINING-TERM.
  1155     GO TO 800-CALC-REM-RESULT.
  1156
  1157 200-CALC-TEXAS-REM.
  1158     DIVIDE CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  1159         GIVING TEX-FACT-1.
  1160
  1161     IF CP-PAY-FREQUENCY = ZERO
  1162         MOVE '5'                TO  CP-RETURN-CODE
  1163         GO TO 999-CALC-REM-AMT-X.
  1164
  1165     DIVIDE WS-REMAINING-TERM BY CP-PAY-FREQUENCY
  1166         GIVING TEX-FACT-2
  1167         REMAINDER TEX-FACT-3.
  1168
  1169     IF TEX-FACT-3 NOT = ZERO
  1170         ADD +1 TO TEX-FACT-2.
  1171
  1172     IF (TEX-FACT-2 * CP-PAY-FREQUENCY) = CP-ORIGINAL-TERM
  1173         MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1174     ELSE
  1175         COMPUTE WS-REMAINING-AMT ROUNDED =
  1176             (TEX-FACT-1 * (TEX-FACT-2 * CP-PAY-FREQUENCY)).
  1177
  1178     GO TO 800-CALC-REM-RESULT.
  1179
  1180 300-CALC-NET-PAY-REM.
  1181
  1182     MOVE CP-LOAN-APR            TO  NP-APR.
  1183     MOVE CP-ORIGINAL-TERM       TO  NP-ORIG.
  1184     MOVE WS-REMAINING-TERM      TO  NP-REM.
  1185     MOVE CP-LOAN-TERM           TO  NP-LOAN-TERM.
  1186     MOVE CP-SPECIAL-CALC-CD     TO  NP-OPT.
  1187
  1188     IF CP-COMPANY-ID IS NOT EQUAL TO 'NCL'
  1189         GO TO 300-CONT-CALC-NET-PAY-REM.
  1190
  1191     MOVE CP-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  1192     MOVE CP-FIRST-PAY-DATE      TO  DC-BIN-DATE-2.
  1193     MOVE '1'                    TO  DC-OPTION-CODE.
  1194     PERFORM 0030-CNVT-DT THRU 0030-CNVT-EXIT.
  1195
  1196     IF DATE-CONVERSION-ERROR
  1197         MOVE '2'                TO  CP-RETURN-CODE
  1198         GO TO 999-CALC-REM-AMT-X
  1199     ELSE
  1200         MOVE DC-ELAPSED-MONTHS  TO  CP-MNTHS-TO-FIRST-PMT
  1201         MOVE DC-ODD-DAYS-OVER   TO  CP-ODD-DAYS-TO-PMT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  24
* ELRAMT.cbl
  1202
  1203     IF WS-REMAINING-TERM = CP-ORIGINAL-TERM
  1204         MOVE +1                 TO ODF
  1205     ELSE
  1206         COMPUTE ODF =
  1207         ((1 + (NP-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  1208         ((1 + (CP-ODD-DAYS-TO-PMT * NP-APR / 36500))).
  1209
  1210 300-CONT-CALC-NET-PAY-REM.
  1211
  1212     PERFORM 1000-NET-TERM.
  1213
  1214     IF ANNUAL-INT-RATE = ZEROS
  1215         COMPUTE WS-REMAINING-AMT ROUNDED =
  1216             (CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM)
  1217              * WS-REMAINING-TERM
  1218     ELSE
  1219     COMPUTE WS-REMAINING-AMT ROUNDED =
  1220             NP-FACTOR * (CP-ORIGINAL-BENEFIT / +1000).
  1221
  1222     IF CP-COMPANY-ID NOT = 'CID' AND 'AHL'
  1223        IF CP-STATE-STD-ABBRV IS EQUAL TO 'NC'
  1224                  AND
  1225           CP-EARN-AS-NET-PAY
  1226            MOVE CP-CERT-EFF-DT         TO  DC-BIN-DATE-1
  1227            MOVE ' '                    TO  DC-OPTION-CODE
  1228            PERFORM 0030-CNVT-DT THRU 0030-CNVT-EXIT
  1229            IF DC-GREG-DATE-CYMD IS GREATER THAN 19931231
  1230                GO TO 500-CALC-REM-RESULT.
  1231
  1232     IF CP-COMPANY-ID = 'CID' AND
  1233        CP-STATE-STD-ABBRV = 'SC' AND
  1234        CP-EARN-AS-NET-PAY AND
  1235        CP-LF-CLAIM-CALC-SW = 'Y' AND
  1236        (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1237            GO TO 600-CALC-REM-RESULT.
  1238
  1239     GO TO 800-CALC-REM-RESULT.
  1240
  1241 400-CALC-REM-BALLOON.
  1242     IF CP-ORIGINAL-TERM LESS THAN CP-REMAINING-TERM
  1243        MOVE CP-ORIGINAL-BENEFIT TO CP-REMAINING-AMT
  1244        ADD CP-ALTERNATE-BENEFIT TO CP-REMAINING-AMT
  1245        GO TO 999-CALC-REM-AMT-X.
  1246
  1247     IF NOT CP-BALLOON-LAST-PMT
  1248        COMPUTE WS-REMAINING-AMT ROUNDED =
  1249          (WS-TEMP-RESULT * CP-REMAINING-TERM) +
  1250*         (WS-TEMP-RESULT * (CP-REMAINING-TERM - 1)) +
  1251           CP-ALTERNATE-BENEFIT
  1252     ELSE
  1253        COMPUTE WS-REMAINING-AMT ROUNDED =
  1254          (WS-TEMP-RESULT * CP-REMAINING-TERM ) +
  1255           CP-ALTERNATE-BENEFIT.
  1256
  1257     GO TO 800-CALC-REM-RESULT.
  1258
  1259 500-CALC-REM-RESULT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  25
* ELRAMT.cbl
  1260
  1261     IF ANNUAL-INT-RATE = ZEROS
  1262         MOVE CP-ORIGINAL-BENEFIT
  1263                              TO  WS-REMAINING-AMT
  1264         GO TO 999-CALC-REM-AMT-X.
  1265
  1266     IF REMAINING-TERM  = ZEROS
  1267         GO TO 999-CALC-REM-AMT-X.
  1268
  1269     COMPUTE ANGLEN = WK1 / I.
  1270     COMPUTE WS-TEMP-RESULT = CP-ORIGINAL-BENEFIT / ANGLEN.
  1271     COMPUTE WS-REMAINING-AMT =
  1272             WS-REMAINING-AMT + (WS-TEMP-RESULT * 3).
  1273     MOVE WS-TEMP-RESULT      TO  CP-MONTHLY-PAYMENT.
  1274
  1275     GO TO 800-CALC-REM-RESULT.
  1276
  1277 600-CALC-REM-RESULT.
  1278
  1279     IF WS-REMAINING-TERM  = ZEROS
  1280         GO TO 800-CALC-REM-RESULT
  1281     END-IF.
  1282
  1283     IF ANNUAL-INT-RATE = ZEROS
  1284         COMPUTE WS-TEMP-RESULT ROUNDED = CP-ORIGINAL-BENEFIT /
  1285                                  CP-ORIGINAL-TERM
  1286         COMPUTE WS-REMAINING-AMT ROUNDED =
  1287             WS-TEMP-RESULT * (WS-REMAINING-TERM + 6)
  1288         IF WS-REMAINING-AMT > CP-ORIGINAL-BENEFIT
  1289            MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1290         END-IF
  1291         MOVE WS-TEMP-RESULT      TO  CP-MONTHLY-PAYMENT
  1292         GO TO 800-CALC-REM-RESULT
  1293     END-IF.
  1294
  1295     COMPUTE ANGLEN = WK1 / I.
  1296     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  1297                 / (1 + I)
  1298     COMPUTE ANGLEN1 = ANGLEN / Y
  1299     COMPUTE WS-TEMP-RESULT ROUNDED = CP-ORIGINAL-BENEFIT /
  1300                                   ANGLEN1.
  1301     COMPUTE CP-SCNP-6MO-AMT ROUNDED = WS-TEMP-RESULT * 6.
  1302     COMPUTE WS-REMAINING-AMT ROUNDED =
  1303             WS-REMAINING-AMT + CP-SCNP-6MO-AMT.
  1304     IF WS-REMAINING-AMT > CP-ORIGINAL-BENEFIT
  1305         MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1306     END-IF.
  1307
  1308     GO TO 800-CALC-REM-RESULT.
  1309
  1310 800-CALC-REM-RESULT.
  1311     IF COMPUTING-CURRENT-MO
  1312        MOVE WS-REMAINING-AMT TO CP-REMAINING-AMT
  1313        MOVE NP-FACTOR        TO CP-REMAMT-FACTOR
  1314        MOVE 1                TO WS-PASS-SW
  1315        IF (CP-R-MAX-TOT-BEN NOT = ZEROS)
  1316           AND (CP-R-MAX-TOT-BEN < CP-REMAINING-AMT)
  1317           MOVE CP-R-MAX-TOT-BEN TO CP-REMAINING-AMT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  26
* ELRAMT.cbl
  1318        END-IF
  1319        GO TO 050-START
  1320      ELSE
  1321        MOVE WS-REMAINING-AMT TO CP-REMAINING-AMT-PRV
  1322        IF (CP-R-MAX-TOT-BEN NOT = ZEROS)
  1323           AND (CP-R-MAX-TOT-BEN < CP-REMAINING-AMT-PRV)
  1324           MOVE CP-R-MAX-TOT-BEN TO CP-REMAINING-AMT-PRV
  1325        END-IF
  1326     END-IF
  1327     .
  1328 999-CALC-REM-AMT-X.
  1329
  1330
  1331     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  1332
  1333
  1334* EXEC CICS RETURN
  1335*        END-EXEC.
  1336*    MOVE '.(                    &   #00001329' TO DFHEIV0
  1337     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1338     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1339     MOVE X'2020233030303031333239' TO DFHEIV0(25:11)
  1340     CALL 'kxdfhei1' USING DFHEIV0,
  1341           DFHEIV99,
  1342           DFHEIV99,
  1343           DFHEIV99,
  1344           DFHEIV99,
  1345           DFHEIV99
  1346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1347
  1348
  1349
  1350* GOBACK.
  1351     MOVE '9%                    "   ' TO DFHEIV0
  1352     MOVE 'ELRAMT' TO DFHEIV1
  1353     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1354     GOBACK.
  1355
  1356 0030-CNVT-DT.
  1357
  1358
  1359* EXEC CICS LINK
  1360*        PROGRAM    ('ELDATCV')
  1361*        COMMAREA   (DATE-CONVERSION-DATA)
  1362*        LENGTH     (DC-COMM-LENGTH)
  1363*    END-EXEC.
  1364     MOVE 'ELDATCV' TO DFHEIV1
  1365*    MOVE '."C                   ''   #00001336' TO DFHEIV0
  1366     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1367     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1368     MOVE X'2020233030303031333336' TO DFHEIV0(25:11)
  1369     CALL 'kxdfhei1' USING DFHEIV0,
  1370           DFHEIV1,
  1371           DATE-CONVERSION-DATA,
  1372           DC-COMM-LENGTH,
  1373           DFHEIV99,
  1374           DFHEIV99,
  1375           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  27
* ELRAMT.cbl
  1376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1377
  1378
  1379 0030-CNVT-EXIT.
  1380     EXIT.
  1381
  1382 1000-NET-TERM SECTION.
  1383*                                COPY ELCRAMTN.
  1384*****************************************************************
  1385*                                                               *
  1386*                                                               *
  1387*                            ELCRAMTN.                          *
  1388*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1389*                            VMOD=2.008                         *
  1390*                                                               *
  1391*             CALCULATE NET PAY REMAINING AMOUNT                *
  1392*****************************************************************.
  1393
  1394     MOVE NP-APR                 TO  ANNUAL-INT-RATE.
  1395     MOVE NP-ORIG                TO  ORIGINAL-TERM.
  1396     MOVE NP-REM                 TO  REMAINING-TERM.
  1397
  1398 1000-EDIT-DATA.
  1399     MOVE +0 TO FACTOR.
  1400
  1401     IF ANNUAL-INT-RATE = ZERO
  1402         GO TO 9000-ERROR.
  1403
  1404     IF ORIGINAL-TERM  = ZERO OR
  1405        REMAINING-TERM = ZERO
  1406         GO TO 9500-RETURN.
  1407
  1408     IF NP-LOAN-TERM NOT NUMERIC
  1409        MOVE +0 TO NP-LOAN-TERM.
  1410
  1411     IF NP-LOAN-TERM EQUAL +0
  1412        MOVE ORIGINAL-TERM TO NP-LOAN-TERM.
  1413
  1414     IF REMAINING-TERM GREATER ORIGINAL-TERM
  1415         GO TO 9000-ERROR.
  1416
  1417*    IF ANNUAL-INT-RATE LESS THAN +3
  1418*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  1419*    IF ANNUAL-INT-RATE LESS THAN +3
  1420*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  1421*    IF ANNUAL-INT-RATE LESS THAN +3
  1422*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  1423
  1424     IF NPO-SIMPLE
  1425         MOVE 'S'                TO  NP-TYPE
  1426     ELSE
  1427         MOVE 'N'                TO  NP-TYPE.
  1428
  1429     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  1430
  1431     COMPUTE V ROUNDED = K1 / (K1 + I).
  1432
  1433     IF (NP-LOAN-TERM GREATER THAN NP-ORIG)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  28
* ELRAMT.cbl
  1434                AND
  1435        (CP-TRUNCATED-LIFE OR CP-SPECIAL-CALC-CD = 'N')
  1436         MOVE NP-LOAN-TERM TO MAX-X
  1437         COMPUTE REMAINING-TERM EQUAL REMAINING-TERM +
  1438             (NP-LOAN-TERM - NP-ORIG)
  1439     ELSE
  1440         MOVE ORIGINAL-TERM TO MAX-X.
  1441
  1442     COMPUTE X1 = MAX-X - ORIGINAL-TERM.
  1443
  1444     MOVE B1 TO X1 SX.
  1445     MOVE V TO VX  SV.
  1446
  1447     IF MAX-X = B1
  1448         GO TO 1000-COMPUTE-REMAINING-FACTOR.
  1449
  1450 1000-VX-LOOP.
  1451     COMPUTE VX ROUNDED = VX * V.
  1452
  1453     ADD B1 TO X1.
  1454
  1455     IF X1 = REMAINING-TERM
  1456         MOVE VX TO SV.
  1457
  1458     IF X1 = X2
  1459         MOVE VX TO SX.
  1460
  1461     IF X1 NOT = MAX-X
  1462         GO TO 1000-VX-LOOP.
  1463
  1464 1000-COMPUTE-REMAINING-FACTOR.
  1465     COMPUTE WK1 = K1 - VX.
  1466
  1467     COMPUTE WK2 = K1 - SV.
  1468
  1469     IF CP-COMPANY-ID IS EQUAL TO 'NCL'       AND
  1470        CP-EARN-AS-NET-PAY
  1471         GO TO 2100-CHECK-NCL-NET-PAY.
  1472
  1473     IF CP-COMPANY-ID IS EQUAL TO 'NCL'
  1474        IF CP-SPECIAL-CALC-CD IS EQUAL TO 'N'
  1475            IF CP-LOAN-TERM IS GREATER THAN CP-ORIGINAL-TERM
  1476                GO TO 2100-NCL-NET-TRUNC
  1477            ELSE
  1478                GO TO 2100-NCL-NET-PAY.
  1479
  1480*    IF CP-TRUNCATED-LIFE
  1481*        IF CP-LOAN-TERM = REMAINING-TERM
  1482*            GO TO 2000-PREMIUM-RATE.
  1483
  1484*    IF NOT CP-TRUNCATED-LIFE
  1485*        IF ORIGINAL-TERM = REMAINING-TERM
  1486*            GO TO 2000-PREMIUM-RATE.
  1487
  1488     COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  1489
  1490     MOVE WK3 TO FACTOR.
  1491
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  29
* ELRAMT.cbl
  1492     GO TO 9500-RETURN.
  1493
  1494 2000-PREMIUM-RATE.
  1495
  1496     COMPUTE K-I = K1 + I
  1497
  1498     IF NPO-ALT OR NPO-TRUNC
  1499         MOVE K1                 TO  K-I.
  1500
  1501     IF NPO-2MO OR NPO-TRUNC-2
  1502         COMPUTE K-I = K1 + (2 * I).
  1503
  1504     COMPUTE RA ROUNDED = 1 -
  1505         ((X2 * (X2 + 1)) /
  1506          (MAX-X * (MAX-X + 1))).
  1507
  1508     IF NET-STD
  1509         COMPUTE WK3 ROUNDED =
  1510             ((I * ORIGINAL-TERM) + VX - SX) * 2 * MAX-X
  1511         COMPUTE WK3 ROUNDED =
  1512             WK3 / (( 1 - VX) * ORIGINAL-TERM * I)
  1513         COMPUTE WK3 ROUNDED =
  1514             WK3 / ((2 * MAX-X) - ORIGINAL-TERM + 1)
  1515         COMPUTE WK3 ROUNDED =
  1516             WK3 * RA * K-I.
  1517
  1518     IF NET-SMP
  1519         COMPUTE N2 = MAX-X * MAX-X
  1520         COMPUTE N3 = N2 * MAX-X
  1521         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  1522         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  1523         COMPUTE WK3 ROUNDED = WK3 + (4 * MAX-X * WK1)
  1524         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  1525         COMPUTE WK3 ROUNDED = WK3 / (36 * (MAX-X + 1) * WK1).
  1526
  1527     MOVE WK3                    TO  FACTOR.
  1528     GO TO 9500-RETURN.
  1529
  1530 2100-CHECK-NCL-NET-PAY.
  1531
  1532     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MN'    AND
  1533        CP-ORIGINAL-TERM IS GREATER THAN +63   AND
  1534        CP-TRUNCATED-LIFE
  1535         GO TO 2100-CHECK-MINN-TRUNC.
  1536
  1537     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MN' AND
  1538        CP-ORIGINAL-TERM IS GREATER THAN +63
  1539         GO TO 2100-CHECK-MINN.
  1540
  1541     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MT'    AND
  1542        CP-ORIGINAL-TERM IS GREATER THAN +63   AND
  1543        CP-TRUNCATED-LIFE
  1544         GO TO 2100-CHECK-MONTANA-TRUNC.
  1545
  1546     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MT' AND
  1547        CP-ORIGINAL-TERM IS GREATER THAN +63
  1548         GO TO 2100-CHECK-MONTANA.
  1549
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  30
* ELRAMT.cbl
  1550     IF CP-TRUNCATED-LIFE
  1551         GO TO 2100-NCL-NET-TRUNC.
  1552
  1553 2100-NCL-NET-PAY.
  1554
  1555     COMPUTE ANGLEN = WK1 / I.
  1556
  1557     COMPUTE ANGLEU = WK2 / I.
  1558
  1559     COMPUTE ANGLEN1 = ANGLEN * ODF.
  1560
  1561     COMPUTE FACTOR = (ANGLEU / ANGLEN1) * 1000.
  1562
  1563     COMPUTE WS-REMAINING-AMT ROUNDED =
  1564         (CP-ORIGINAL-BENEFIT * ANGLEU) / ANGLEN1.
  1565
  1566     GO TO 9500-RETURN.
  1567
  1568 2100-NCL-NET-TRUNC.
  1569
  1570     COMPUTE ANGLEM = WK1 / I.
  1571
  1572     COMPUTE ANGLEU = WK2 / I.
  1573
  1574     COMPUTE ANGLEM1 = ANGLEM * ODF.
  1575
  1576     COMPUTE FACTOR = (ANGLEU / ANGLEM1) * 1000.
  1577
  1578     COMPUTE WS-REMAINING-AMT ROUNDED =
  1579         (CP-ORIGINAL-BENEFIT * ANGLEU) / ANGLEM1.
  1580
  1581     GO TO 9500-RETURN.
  1582
  1583 2100-CHECK-MINN-TRUNC.
  1584
  1585     COMPUTE ANGLEM = WK1 / I.
  1586
  1587     COMPUTE ANGLEU = WK2 / I.
  1588
  1589     COMPUTE ANGLEM1 = ANGLEM * ODF.
  1590
  1591     COMPUTE FACTOR = ((ANGLEU + 2) / ANGLEM1) * 1000.
  1592
  1593     COMPUTE WS-REMAINING-AMT ROUNDED =
  1594         (CP-ORIGINAL-BENEFIT * (ANGLEU + 2)) / ANGLEM1.
  1595
  1596     GO TO 9500-RETURN.
  1597
  1598 2100-CHECK-MINN.
  1599
  1600     COMPUTE ANGLEN = WK1 / I.
  1601
  1602     COMPUTE ANGLEU = WK2 / I.
  1603
  1604     COMPUTE ANGLEN1 = ANGLEN * ODF.
  1605
  1606     COMPUTE FACTOR = ((ANGLEU + 2) / ANGLEN1) * 1000.
  1607
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  31
* ELRAMT.cbl
  1608     COMPUTE WS-REMAINING-AMT ROUNDED =
  1609         (CP-ORIGINAL-BENEFIT * (ANGLEU + 2)) / ANGLEN1.
  1610
  1611     GO TO 9500-RETURN.
  1612
  1613 2100-CHECK-MONTANA-TRUNC.
  1614
  1615     COMPUTE ANGLEM = WK1 / I.
  1616
  1617     COMPUTE ANGLEU = WK2 / I.
  1618
  1619     COMPUTE ANGLEM1 = ANGLEM * ODF.
  1620
  1621     COMPUTE FACTOR = ((ANGLEU + 4) / ANGLEM1) * 1000.
  1622
  1623     COMPUTE WS-REMAINING-AMT ROUNDED =
  1624         (CP-ORIGINAL-BENEFIT * (ANGLEU + 4)) / ANGLEM1.
  1625
  1626     GO TO 9500-RETURN.
  1627
  1628 2100-CHECK-MONTANA.
  1629
  1630     COMPUTE ANGLEN = WK1 / I.
  1631
  1632     COMPUTE ANGLEU = WK2 / I.
  1633
  1634     COMPUTE ANGLEN1 = ANGLEN * ODF.
  1635
  1636     COMPUTE FACTOR = ((ANGLEU + 4) / ANGLEN1) * 1000.
  1637
  1638     COMPUTE WS-REMAINING-AMT ROUNDED =
  1639         (CP-ORIGINAL-BENEFIT * (ANGLEU + 4)) / ANGLEN1.
  1640
  1641     GO TO 9500-RETURN.
  1642
  1643 9000-ERROR.
  1644     GO TO 9500-RETURN.
  1645
  1646 9500-RETURN.
  1647     MOVE FACTOR                 TO  NP-FACTOR.
  1648
  1649 9999-EXIT.
  1650     EXIT.
  1651
  1652
  1653
  1654 9999-DFHBACK SECTION.
  1655     MOVE '9%                    "   ' TO DFHEIV0
  1656     MOVE 'ELRAMT' TO DFHEIV1
  1657     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1658     GOBACK.
  1659 9999-DFHEXIT.
  1660     IF DFHEIGDJ EQUAL 0001
  1661         NEXT SENTENCE.
  1662     MOVE '9%                    "   ' TO DFHEIV0
  1663     MOVE 'ELRAMT' TO DFHEIV1
  1664     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1665     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:28 Page  32
* ELRAMT.cbl
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        1984     Code:        5323
