* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   1
* ELRAMT.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"ELRAMT.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRAMT.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                ELRAMT.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:15.
     7*                           VMOD=2.007
     8*
     9*AUTHOR.     LOGIC, INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   2
* ELRAMT.cbl
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE REMAINING AMOUNTS    *
    28*            *    FOR A CERTIFICATE.                             *
    29*            *                                                   *
    30*            *    ORIGINAL BENEFIT = CP-ORIGINAL-BENEFIT         *
    31*            *    ORIGINAL TERM = CP-ORIGINAL-TERM               *
    32*            *    REMAINING-TERM  = CP-REMAINING-TERM            *
    33*            *    A.P.R (FOR NET PAY) = CP-LOAN-APR              *
    34*            *    BENEFIT TYPE = CP-BENEFIT-TYPE                 *
    35*            *    METHOD = CP-EARNING-METHOD                     *
    36*            *    IF COMPANY SPECIAL METHOD  - PUT COMPANY       *
    37*            *     I.D. IN CP-COMPANY-ID.                        *
    38*            *                                                   *
    39*            *****************************************************
    40 ENVIRONMENT DIVISION.
    41
    42 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   3
* ELRAMT.cbl
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  FILLER   PIC X(32) VALUE '********************************'.
    47 77  FILLER   PIC X(32) VALUE '**  ELRAMT  WORKING STORAGE   **'.
    48 77  FILLER   PIC X(32) VALUE '********* VMOD 2.007 ***********'.
    49
    50*                          COPY ELCRAMTW.
    51*****************************************************************
    52*                                                               *
    53*                                                               *
    54*                            ELCRAMTW.                          *
    55*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    56*                            VMOD=2.004                         *
    57*                                                               *
    58*****************************************************************.
    59******************************************************************
    60*                   C H A N G E   L O G
    61*
    62* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    63*-----------------------------------------------------------------
    64*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    65* EFFECTIVE    NUMBER
    66*-----------------------------------------------------------------
    67* 041710    2007111300001  AJRA  CALC SC NET PAY PLUS 6
    68******************************************************************
    69
    70 01  FILLER.
    71     12  WS-PASS-SW          PIC 9                  VALUE ZERO.
    72       88 COMPUTING-CURRENT-MO                      VALUE ZERO.
    73       88 COMPUTING-PRIOR-MO                        VALUE 1.
    74
    75 01  WS-WORK-MISC.
    76     12  WS-REMAINING-TERM   PIC S9(4)V9     COMP-3.
    77     12  WS-TEMP-RESULT      PIC S9(9)V9(6)  COMP-3.
    78     12  WS-REMAINING-AMT    PIC S9(9)V99    COMP-3.
    79
    80 01  TEXAS-REG-WORK-AREAS.
    81     12  TEX-FACT-1          PIC S9(9)V9(2)  COMP-3.
    82     12  TEX-FACT-2          PIC S9(3)       COMP-3.
    83     12  TEX-FACT-3          PIC S9(3)       COMP-3.
    84     12  TEX-FACT-4          PIC S9(7)       COMP-3.
    85     12  TEX-FACT-5          PIC S9(3)       COMP-3.
    86     12  TEX-FACT-6          PIC S9(3)       COMP-3.
    87     12  TEX-FACT-7          PIC S9(7)       COMP-3.
    88     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
    89     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
    90
    91 01  NET-PAY-INTERFACE.
    92     12  NP-APR              PIC S9(3)V9(4)  COMP-3.
    93     12  NP-ORIG             PIC S9(3)       COMP-3.
    94     12  NP-LOAN-TERM        PIC S9(3)       COMP-3.
    95     12  NP-REM              PIC S9(3)       COMP-3.
    96     12  NP-CAP              PIC S9(3)       COMP-3.
    97     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
    98     12  NP-WORK1            PIC S9(6)V9(6)  COMP-3.
    99     12  NP-WORK2            PIC S9(6)V9(6)  COMP-3.
   100     12  NP-OPT              PIC X(01).
   101         88  NPO-STD                         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   4
* ELRAMT.cbl
   102         88  NPO-ALT                         VALUE 'A'.
   103         88  NPO-SIMPLE                      VALUE 'S'.
   104         88  NPO-2MO                         VALUE 'I'.
   105         88  NPO-TRUNC                       VALUE 'T' 'U' 'V'.
   106         88  NPO-TRUNC-0                     VALUE 'T'.
   107         88  NPO-TRUNC-1                     VALUE 'U'.
   108         88  NPO-TRUNC-2                     VALUE 'V'.
   109         88  NPO-REFUND                      VALUE 'R'.
   110     12  NP-TYPE             PIC X(01).
   111         88  NET-STD                         VALUE 'N'.
   112         88  NET-SMP                         VALUE 'S'.
   113
   114 01  COMP-3-WORK-AREA         COMP-3.
   115     12  V               PIC SV9(9)    VALUE +.0.
   116     12  I               PIC SV9(9)    VALUE +.0.
   117     12  Y               PIC S9(2)V9(5) VALUE +.0.
   118     12  WK1             PIC S9(4)V9(9).
   119     12  WK2             PIC S9(4)V9(9).
   120     12  WK3             PIC S9(4)V9(9).
   121     12  K1              PIC S999,     VALUE +1.
   122     12  K12             PIC S999,     VALUE +12.
   123     12  K100            PIC S999,     VALUE +100.
   124     12  K1000           PIC S9(7),    VALUE +1000.
   125     12  ANNUAL-INT-RATE PIC S9(3)V9(4).
   126     12  ORIGINAL-TERM   PIC S999.
   127     12  REMAINING-TERM  PIC S999.
   128     12  CAPPED-TERM     PIC S999.
   129     12  FACTOR          PIC S9(4)V9(9).
   130     12  VX              PIC S9V9(8)        VALUE +0.0.
   131     12  SV              PIC S9V9(8)        VALUE +0.0.
   132     12  SX              PIC S9V9(8)        VALUE +0.0.
   133     12  RA              PIC S9(6)V9(9)     VALUE +0.0.
   134     12  N2              PIC S9(7)          VALUE +0.
   135     12  N3              PIC S9(7)          VALUE +0.
   136     12  K-I             PIC S9V9(8)        VALUE +0.0.
   137     12  ODF             PIC S9(3)V9(10)    VALUE +0.0.
   138     12  OD              PIC S9(3)V9(10)    VALUE +0.0.
   139     12  ANGLEM          PIC S9(7)V9(10)    VALUE +0.0.
   140     12  ANGLEN          PIC S9(7)V9(10)    VALUE +0.0.
   141     12  ANGLEU          PIC S9(7)V9(10)    VALUE +0.0.
   142     12  ANGLEM1         PIC S9(7)V9(10)    VALUE +0.0.
   143     12  ANGLEN1         PIC S9(7)V9(10)    VALUE +0.0.
   144
   145 01  BINARY-WORK-AREA        COMP.
   146     12  X1      PIC S999        VALUE +0.
   147     12  X2      PIC S999        VALUE +0.
   148     12  MAX-X   PIC S9(5)       VALUE +0.
   149     12  B1      PIC S9(5)       VALUE +1.
   150     12  B2      PIC S9(5)       VALUE +2.
   151
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   5
* ELRAMT.cbl
   153*                          COPY ELCCALC.
   154******************************************************************
   155*                                                                *
   156*                           ELCCALC.                            *
   157*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   158*                            VMOD=2.025                          *
   159*                                                                *
   160*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   161*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   162*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   163*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   164*                                                                *
   165*  PASSED TO ELRTRM                                              *
   166*  -----------------                                             *
   167*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   168*  ORIGINAL TERM                                                 *
   169*  BEGINNING DATE                                                *
   170*  ENDING DATE                                                   *
   171*  COMPANY I.D.                                                  *
   172*  ACCOUNT MASTER USER FIELD                                     *
   173*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   174*  FREE LOOK DAYS                                                *
   175*                                                                *
   176*  RETURNED FROM ELRTRM                                          *
   177*  ---------------------                                         *
   178*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   179*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   180*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   181*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   182*----------------------------------------------------------------*
   183*  PASSED TO ELRAMT                                              *
   184*  ----------------                                              *
   185*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   186*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   187*  ORIGINAL AMOUNT                                               *
   188*  ALTERNATE BENEFIT (BALLON)                                    *
   189*  A.P.R. - NET PAY ONLY                                         *
   190*  METHOD
   191*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   192*  COMPANY I.D.                                                  *
   193*  BENEFIT TYPE                                                  *
   194*                                                                *
   195*  RETURNED FROM ELRAMT                                          *
   196*  --------------------                                          *
   197*  REMAINING AMOUNT 1 - CURRENT                                  *
   198*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   199*  REMAINING AMOUNT FACTOR
   200*----------------------------------------------------------------*
   201*  PASSED TO ELRESV                                              *
   202*  -----------------                                             *
   203*  CERTIFICATE EFFECTIVE DATE                                    *
   204*  VALUATION DATE                                                *
   205*  PAID THRU DATE                                                *
   206*  BENEFIT                                                       *
   207*  INCURRED DATE                                                 *
   208*  REPORTED DATE                                                 *
   209*  ISSUE AGE                                                     *
   210*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   6
* ELRAMT.cbl
   211*  CDT PERCENT                                                   *
   212*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   213* *CLAIM TYPE (LIFE, A/H)                                        *
   214* *REMAINING BENEFIT (FROM ELRAMT)                               *
   215* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   216*                                                                *
   217*  RETURNED FROM ELRESV                                          *
   218*  --------------------                                          *
   219*  CDT TABLE USED                                                *
   220*  CDT FACTOR USED                                               *
   221*  PAY TO CURRENT RESERVE                                        *
   222*  I.B.N.R. - A/H ONLY                                           *
   223*  FUTURE (ACCRUED) AH ONLY                                      *
   224*----------------------------------------------------------------*
   225*  PASSED TO ELRATE                                              *
   226*  ----------------                                              *
   227*  CERT ISSUE DATE                                               *
   228*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   229*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   230*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   231*  STATE CODE (CLIENT DEFINED)                                   *
   232*  STATE CODE (STANDARD P.O. ABBRV)                              *
   233*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   234*  DEVIATION CODE                                                *
   235*  ISSUE AGE                                                     *
   236*  ORIGINAL BENEFIT AMOUNT                                       *
   237*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   238*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   239*  BENEFIT KIND (LIFE OR A/H)                                    *
   240*  A.P.R.                                                        *
   241*  METHOD
   242*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   243*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   244*  COMPANY I.D. (3 CHARACTER)                                    *
   245*  BENEFIT CODE                                                  *
   246*  BENEFIT OVERRIDE CODE                                         *
   247*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   248*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   249*  JOINT INDICATOR (CSL ONLY)                                    *
   250*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   251*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   252*                                                                *
   253*  RETURNED FROM ELRATE                                          *
   254*  --------------------                                          *
   255*  CALCULATED PREMIUM                                            *
   256*  PREMIUM RATE                                                  *
   257*  MORTALITY CODE                                                *
   258*  MAX ATTAINED AGE                                              *
   259*  MAX AGE                                                       *
   260*  MAX TERM                                                      *
   261*  MAX MONTHLY BENEFIT                                           *
   262*  MAX TOTAL BENIFIT                                             *
   263*  COMPOSITE RATE (OPEN-END ONLY)                                *
   264*----------------------------------------------------------------*
   265*  PASSED TO ELRFND                                              *
   266*  ----------------                                              *
   267*  CERT ISSUE DATE                                               *
   268*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   7
* ELRAMT.cbl
   269*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   270*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   271*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   272*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   273*  STATE CODE (CLIENT DEFINED)                                   *
   274*  STATE CODE (STANDARD P.O. ABBRV)                              *
   275*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   276*  DEVIATION CODE                                                *
   277*  ISSUE AGE                                                     *
   278*  ORIGINAL BENEFIT AMOUNT                                       *
   279*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   280*  PROCESS TYPE (CANCEL)                                         *
   281*  BENEFIT KIND (LIFE OR A/H)                                    *
   282*  A.P.R.                                                        *
   283*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   284*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   285*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   286*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   287*  COMPANY I.D. (3 CHARACTER)                                    *
   288*  BENEFIT CODE                                                  *
   289*  BENEFIT OVERRIDE CODE                                         *
   290*                                                                *
   291*  RETURNED FROM ELRFND                                          *
   292*  --------------------                                          *
   293*  CALCULATED REFUND                                             *
   294*----------------------------------------------------------------*
   295*  PASSED TO ELEARN                                              *
   296*  ----------------                                              *
   297*  CERT ISSUE DATE                                               *
   298*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   299*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   300*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   301*  STATE CODE (CLIENT DEFINED)                                   *
   302*  STATE CODE (STANDARD P.O. ABBRV)                              *
   303*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   304*  DEVIATION CODE                                                *
   305*  ISSUE AGE                                                     *
   306*  ORIGINAL BENEFIT AMOUNT                                       *
   307*  BENEFIT KIND (LIFE OR A/H)                                    *
   308*  A.P.R.                                                        *
   309*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   310*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   311*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   312*  COMPANY I.D. (3 CHARACTER)                                    *
   313*  BENEFIT CODE                                                  *
   314*  BENEFIT OVERRIDE CODE                                         *
   315*                                                                *
   316*  RETURNED FROM ELEARN                                          *
   317*  --------------------                                          *
   318*  INDICATED  EARNINGS                                           *
   319*----------------------------------------------------------------*
   320*                 LENGTH = 450                                   *
   321*                                                                *
   322******************************************************************
   323******************************************************************
   324*                   C H A N G E   L O G
   325*
   326* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   8
* ELRAMT.cbl
   327*-----------------------------------------------------------------
   328*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   329* EFFECTIVE    NUMBER
   330*-----------------------------------------------------------------
   331* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   332* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   333* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   334* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   335* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   336* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   337* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   338******************************************************************
   339
   340 01  CALCULATION-PASS-AREA.
   341     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   342                                     COMP.
   343
   344     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   345       88  NO-CP-ERROR                             VALUE ZERO.
   346       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   347                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   348       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   349       88  CP-ERROR-IN-DATES                       VALUE '2'.
   350       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   351       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   352       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   353       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   354       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   355       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   356       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   357       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   358       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   359       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   360       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   361       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   362       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   363       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   364       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   365
   366     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   367       88  NO-CP-ERROR-2                           VALUE ZERO.
   368***********************  INPUT AREAS ****************************
   369
   370     12  CP-CALCULATION-AREA.
   371         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   372         16  CP-CERT-EFF-DT        PIC XX.
   373         16  CP-VALUATION-DT       PIC XX.
   374         16  CP-PAID-THRU-DT       PIC XX.
   375         16  CP-BENEFIT-TYPE       PIC X.
   376           88  CP-AH                               VALUE 'A' 'D'
   377                                                   'I' 'U'.
   378           88  CP-REDUCING-LIFE                    VALUE 'R'.
   379           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   380         16  CP-INCURRED-DT        PIC XX.
   381         16  CP-REPORTED-DT        PIC XX.
   382         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   383         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   384         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page   9
* ELRAMT.cbl
   385                                     COMP-3.
   386         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   387                                     COMP-3.
   388         16  CP-CDT-METHOD         PIC X.
   389           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   390           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   391           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   392         16  CP-CLAIM-TYPE         PIC X.
   393           88  CP-AH-CLAIM                         VALUE 'A'.
   394           88  CP-LIFE-CLAIM                       VALUE 'L'.
   395         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   396                                     COMP-3.
   397         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   398                                     COMP-3.
   399         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   400                                     COMP-3.
   401         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   402                                     COMP-3.
   403         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   404                                     COMP-3.
   405         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   406                                     COMP-3.
   407         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   408                                     COMP-3.
   409         16  CP-REM-TERM-METHOD    PIC X.
   410           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   411           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   412           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   413           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   414           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   415           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   416           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   417         16  CP-EARNING-METHOD     PIC X.
   418           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   419           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   420           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   421           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   422           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   423           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   424           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   425           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   426           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   427           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   428           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   429           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   430         16  CP-PROCESS-TYPE       PIC X.
   431           88  CP-CLAIM                            VALUE '1'.
   432           88  CP-CANCEL                           VALUE '2'.
   433           88  CP-ISSUE                            VALUE '3'.
   434         16  CP-SPECIAL-CALC-CD    PIC X.
   435           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   436           88  CP-1-MTH-INTEREST               VALUE ' '.
   437           88  CP-0-MTH-INTEREST               VALUE 'A'.
   438           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   439           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   440           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   441           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   442           88  CP-FARM-PLAN                    VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  10
* ELRAMT.cbl
   443           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   444           88  CP-2-MTH-INTEREST               VALUE 'I'.
   445           88  CP-3-MTH-INTEREST               VALUE 'J'.
   446           88  CP-4-MTH-INTEREST               VALUE 'K'.
   447           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   448           88  CP-MORTGAGE-REC                 VALUE 'M'.
   449           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   450           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   451           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   452           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   453                                                     'W' 'X'.
   454           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   455           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   456           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   457           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   458           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   459           88  CP-SUMMARY-REC                  VALUE 'Z'.
   460           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   461           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   462           88  CP-AD-D-BENEFIT                 VALUE '4'.
   463           88  CP-CSL-METH-1                   VALUE '5'.
   464           88  CP-CSL-METH-2                   VALUE '6'.
   465           88  CP-CSL-METH-3                   VALUE '7'.
   466           88  CP-CSL-METH-4                   VALUE '8'.
   467
   468         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   469                                     COMP-3.
   470         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   471         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   472         16  CP-STATE              PIC XX          VALUE SPACE.
   473         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   474         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   475           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   476               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   477         16  CP-R78-OPTION         PIC X.
   478           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   479           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   480
   481         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   482         16  CP-IBNR-RESERVE-SW    PIC X.
   483         16  CP-CLAIM-STATUS       PIC X.
   484         16  CP-RATE-FILE          PIC X.
   485         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   486                                     COMP-3.
   487
   488         16  CP-LIFE-OVERRIDE-CODE PIC X.
   489         16  CP-AH-OVERRIDE-CODE   PIC X.
   490
   491         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   492                                     COMP-3.
   493         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   494                                     COMP-3.
   495         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   496                                     COMP-3.
   497         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   498                                     COMP-3.
   499
   500         16  CP-PAID-FROM-DATE     PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  11
* ELRAMT.cbl
   501         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   502         16  CP-EXT-DAYS-CALC      PIC X.
   503           88  CP-EXT-NO-CHG                   VALUE ' '.
   504           88  CP-EXT-CHG-LF                   VALUE '1'.
   505           88  CP-EXT-CHG-AH                   VALUE '2'.
   506           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   507         16  CP-DOMICILE-STATE     PIC XX.
   508         16  CP-CARRIER            PIC X.
   509         16  CP-REIN-FLAG          PIC X.
   510         16  CP-REM-TRM-CALC-OPTION PIC X.
   511           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   512                      '2' '3' '4' '5'.
   513           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   514           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   515           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   516           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   517           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   518           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   519           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   520           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   521         16  CP-SIG-SWITCH         PIC X.
   522         16  CP-RATING-METHOD      PIC X.
   523           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   524           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   525           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   526           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   527           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   528           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   529           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   530           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   531           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   532         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   533                                     COMP-3.
   534         16  CP-BEN-CATEGORY       PIC X.
   535         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   536         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   537                                   PIC S99V9(5) COMP-3.
   538         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   539         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   540                                   PIC S99V9(5) COMP-3.
   541         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   542         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   543         16  CP-EXPIRE-DT          PIC XX.
   544         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   545         16  FILLER                PIC X(35).
   546*        16  FILLER                PIC X(50).
   547
   548***************    OUTPUT FROM ELRESV   ************************
   549
   550         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   551
   552         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   553                                     COMP-3.
   554         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   555                                     COMP-3.
   556         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   557                                     COMP-3.
   558         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  12
* ELRAMT.cbl
   559                                     COMP-3.
   560         16  FILLER                PIC X(09).
   561***************    OUTPUT FROM ELRTRM   *************************
   562
   563         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   564                                     COMP-3.
   565         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   566                                     COMP-3.
   567         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   568                                     COMP-3.
   569         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   570                                     COMP-3.
   571         16  FILLER                PIC X(12).
   572
   573***************    OUTPUT FROM ELRAMT   *************************
   574
   575         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   576                                     COMP-3.
   577         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   578                                     COMP-3.
   579         16  FILLER                PIC X(12).
   580
   581***************    OUTPUT FROM ELRATE   *************************
   582
   583         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   584                                     COMP-3.
   585         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   586                                     COMP-3.
   587         16  CP-MORTALITY-CODE     PIC X(4).
   588         16  CP-RATE-EDIT-FLAG     PIC X.
   589             88  CP-RATES-NEED-APR                  VALUE '1'.
   590         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   591                                     COMP-3.
   592         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   593         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   594         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   595                                   PIC S9(7)V99 COMP-3.
   596         16  FILLER                PIC X(07).
   597
   598***************    OUTPUT FROM ELRFND   *************************
   599
   600         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   601                                     COMP-3.
   602         16  CP-REFUND-TYPE-USED   PIC X.
   603           88  CP-R-AS-R78                         VALUE '1'.
   604           88  CP-R-AS-PRORATA                     VALUE '2'.
   605           88  CP-R-AS-CALIF                       VALUE '3'.
   606           88  CP-R-AS-TEXAS                       VALUE '4'.
   607           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   608           88  CP-R-AS-NET-PAY                     VALUE '5'.
   609           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   610           88  CP-R-AS-MEAN                        VALUE '8'.
   611           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   612           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   613           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   614         16  FILLER                PIC X(12).
   615
   616***************    OUTPUT FROM ELEARN   *************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  13
* ELRAMT.cbl
   617
   618         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   619                                     COMP-3.
   620         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   621                                     COMP-3.
   622         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   623                                     COMP-3.
   624         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   625                                     COMP-3.
   626         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   627                                     COMP-3.
   628         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   629                                     COMP-3.
   630         16  CP-EARNING-TYPE-USED  PIC X.
   631           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   632           88  CP-E-AS-R78                         VALUE '1'.
   633           88  CP-E-AS-PRORATA                     VALUE '2'.
   634           88  CP-E-AS-TEXAS                       VALUE '4'.
   635           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
   636           88  CP-E-AS-NET-PAY                     VALUE '5'.
   637           88  CP-E-AS-ANTICIPATION                VALUE '6'.
   638           88  CP-E-AS-MEAN                        VALUE '8'.
   639           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
   640         16  FILLER                PIC X(12).
   641
   642***************    OUTPUT FROM ELPMNT   *************************
   643
   644         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
   645                                     COMP-3.
   646         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
   647                                     COMP-3.
   648         16  FILLER                PIC X(12).
   649
   650***************   MISC WORK AREAS    *****************************
   651         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
   652                                     COMP-3.
   653         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
   654                                     COMP-3.
   655         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
   656                                     COMP-3.
   657         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
   658                                     COMP-3.
   659         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
   660                                     COMP-3.
   661         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
   662                                     COMP-3.
   663         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
   664             88  OPEN-RATE-FILE                   VALUE 'O'.
   665             88  CLOSE-RATE-FILE                  VALUE 'C'.
   666             88  IO-ERROR                         VALUE 'E'.
   667
   668         16  CP-FIRST-PAY-DATE     PIC XX.
   669
   670         16  CP-JOINT-INDICATOR    PIC X.
   671
   672         16  CP-RESERVE-REMAINING-TERM
   673                                   PIC S9(4)V9    VALUE ZERO
   674                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  14
* ELRAMT.cbl
   675
   676         16  CP-INSURED-BIRTH-DT   PIC XX.
   677
   678         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
   679                                     COMP-3.
   680
   681         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
   682                                     COMP-3.
   683
   684         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
   685                                     COMP-3.
   686
   687         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
   688                                     COMP-3.
   689
   690         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
   691                                     COMP-3.
   692
   693         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
   694                                     COMP-3.
   695
   696         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
   697                                     COMP-3.
   698
   699         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
   700             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
   701
   702         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
   703                                     COMP-3.
   704         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
   705                                     COMP-3.
   706         16  FILLER                PIC X(17).
   707******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  15
* ELRAMT.cbl
   709*                          COPY ELCDATE.
   710******************************************************************
   711*                                                                *
   712*                                                                *
   713*                            ELCDATE.                            *
   714*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   715*                            VMOD=2.003
   716*                                                                *
   717*                                                                *
   718*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   719*                 LENGTH = 200                                   *
   720******************************************************************
   721
   722 01  DATE-CONVERSION-DATA.
   723     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   724     12  DC-OPTION-CODE                PIC X.
   725         88  BIN-TO-GREG                VALUE ' '.
   726         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   727         88  EDIT-GREG-TO-BIN           VALUE '2'.
   728         88  YMD-GREG-TO-BIN            VALUE '3'.
   729         88  MDY-GREG-TO-BIN            VALUE '4'.
   730         88  JULIAN-TO-BIN              VALUE '5'.
   731         88  BIN-PLUS-ELAPSED           VALUE '6'.
   732         88  FIND-CENTURY               VALUE '7'.
   733         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   734         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   735         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   736         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   737         88  JULIAN-TO-BIN-3            VALUE 'C'.
   738         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   739         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   740         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   741         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   742         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   743         88  CHECK-LEAP-YEAR            VALUE 'H'.
   744         88  BIN-3-TO-GREG              VALUE 'I'.
   745         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   746         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   747         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   748         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   749         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   750         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   751         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   752         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   753         88  THREE-CHARACTER-BIN
   754                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   755         88  GREGORIAN-TO-BIN
   756                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   757         88  BIN-TO-GREGORIAN
   758                  VALUES ' ' '1' 'I' '8' 'G'.
   759         88  JULIAN-TO-BINARY
   760                  VALUES '5' 'C' 'E' 'F'.
   761     12  DC-ERROR-CODE                 PIC X.
   762         88  NO-CONVERSION-ERROR        VALUE ' '.
   763         88  DATE-CONVERSION-ERROR
   764                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   765         88  DATE-IS-ZERO               VALUE '1'.
   766         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  16
* ELRAMT.cbl
   767         88  DATE-IS-INVALID            VALUE '3'.
   768         88  DATE1-GREATER-DATE2        VALUE '4'.
   769         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   770         88  DATE-INVALID-OPTION        VALUE '9'.
   771         88  INVALID-CENTURY            VALUE 'A'.
   772         88  ONLY-CENTURY               VALUE 'B'.
   773         88  ONLY-LEAP-YEAR             VALUE 'C'.
   774         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   775     12  DC-END-OF-MONTH               PIC X.
   776         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   777     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   778         88  USE-NORMAL-PROCESS         VALUE ' '.
   779         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   780         88  ADJUST-UP-100-YRS          VALUE '2'.
   781     12  FILLER                        PIC X.
   782     12  DC-CONVERSION-DATES.
   783         16  DC-BIN-DATE-1             PIC XX.
   784         16  DC-BIN-DATE-2             PIC XX.
   785         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   786         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   787                       DC-GREG-DATE-1-EDIT.
   788             20  DC-EDIT1-MONTH        PIC 99.
   789             20  SLASH1-1              PIC X.
   790             20  DC-EDIT1-DAY          PIC 99.
   791             20  SLASH1-2              PIC X.
   792             20  DC-EDIT1-YEAR         PIC 99.
   793         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   794         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   795                     DC-GREG-DATE-2-EDIT.
   796             20  DC-EDIT2-MONTH        PIC 99.
   797             20  SLASH2-1              PIC X.
   798             20  DC-EDIT2-DAY          PIC 99.
   799             20  SLASH2-2              PIC X.
   800             20  DC-EDIT2-YEAR         PIC 99.
   801         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   802         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   803                     DC-GREG-DATE-1-YMD.
   804             20  DC-YMD-YEAR           PIC 99.
   805             20  DC-YMD-MONTH          PIC 99.
   806             20  DC-YMD-DAY            PIC 99.
   807         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   808         16  DC-GREG-DATE-1-MDY-R REDEFINES
   809                      DC-GREG-DATE-1-MDY.
   810             20  DC-MDY-MONTH          PIC 99.
   811             20  DC-MDY-DAY            PIC 99.
   812             20  DC-MDY-YEAR           PIC 99.
   813         16  DC-GREG-DATE-1-ALPHA.
   814             20  DC-ALPHA-MONTH        PIC X(10).
   815             20  DC-ALPHA-DAY          PIC 99.
   816             20  FILLER                PIC XX.
   817             20  DC-ALPHA-CENTURY.
   818                 24 DC-ALPHA-CEN-N     PIC 99.
   819             20  DC-ALPHA-YEAR         PIC 99.
   820         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   821         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   822         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   823         16  DC-JULIAN-DATE            PIC 9(05).
   824         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  17
* ELRAMT.cbl
   825                                       PIC 9(05).
   826         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   827             20  DC-JULIAN-YEAR        PIC 99.
   828             20  DC-JULIAN-DAYS        PIC 999.
   829         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   830         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   831         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   832     12  DATE-CONVERSION-VARIBLES.
   833         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   834         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   835             20  FILLER                PIC 9(3).
   836             20  HOLD-CEN-1-CCYY.
   837                 24  HOLD-CEN-1-CC     PIC 99.
   838                 24  HOLD-CEN-1-YY     PIC 99.
   839             20  HOLD-CEN-1-MO         PIC 99.
   840             20  HOLD-CEN-1-DA         PIC 99.
   841         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   842             20  HOLD-CEN-1-R-MO       PIC 99.
   843             20  HOLD-CEN-1-R-DA       PIC 99.
   844             20  HOLD-CEN-1-R-CCYY.
   845                 24  HOLD-CEN-1-R-CC   PIC 99.
   846                 24  HOLD-CEN-1-R-YY   PIC 99.
   847             20  FILLER                PIC 9(3).
   848         16  HOLD-CENTURY-1-X.
   849             20  FILLER                PIC X(3)  VALUE SPACES.
   850             20  HOLD-CEN-1-X-CCYY.
   851                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   852                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   853             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   854             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   855         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   856             20  HOLD-CEN-1-R-X-MO     PIC XX.
   857             20  HOLD-CEN-1-R-X-DA     PIC XX.
   858             20  HOLD-CEN-1-R-X-CCYY.
   859                 24  HOLD-CEN-1-R-X-CC PIC XX.
   860                 24  HOLD-CEN-1-R-X-YY PIC XX.
   861             20  FILLER                PIC XXX.
   862         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   863         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   864         16  DC-JULIAN-DATE-1          PIC 9(07).
   865         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   866             20  DC-JULIAN-1-CCYY.
   867                 24  DC-JULIAN-1-CC    PIC 99.
   868                 24  DC-JULIAN-1-YR    PIC 99.
   869             20  DC-JULIAN-DA-1        PIC 999.
   870         16  DC-JULIAN-DATE-2          PIC 9(07).
   871         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   872             20  DC-JULIAN-2-CCYY.
   873                 24  DC-JULIAN-2-CC    PIC 99.
   874                 24  DC-JULIAN-2-YR    PIC 99.
   875             20  DC-JULIAN-DA-2        PIC 999.
   876         16  DC-GREG-DATE-A-EDIT.
   877             20  DC-EDITA-MONTH        PIC 99.
   878             20  SLASHA-1              PIC X VALUE '/'.
   879             20  DC-EDITA-DAY          PIC 99.
   880             20  SLASHA-2              PIC X VALUE '/'.
   881             20  DC-EDITA-CCYY.
   882                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  18
* ELRAMT.cbl
   883                 24  DC-EDITA-YEAR     PIC 99.
   884         16  DC-GREG-DATE-B-EDIT.
   885             20  DC-EDITB-MONTH        PIC 99.
   886             20  SLASHB-1              PIC X VALUE '/'.
   887             20  DC-EDITB-DAY          PIC 99.
   888             20  SLASHB-2              PIC X VALUE '/'.
   889             20  DC-EDITB-CCYY.
   890                 24  DC-EDITB-CENT     PIC 99.
   891                 24  DC-EDITB-YEAR     PIC 99.
   892         16  DC-GREG-DATE-CYMD         PIC 9(08).
   893         16  DC-GREG-DATE-CYMD-R REDEFINES
   894                              DC-GREG-DATE-CYMD.
   895             20  DC-CYMD-CEN           PIC 99.
   896             20  DC-CYMD-YEAR          PIC 99.
   897             20  DC-CYMD-MONTH         PIC 99.
   898             20  DC-CYMD-DAY           PIC 99.
   899         16  DC-GREG-DATE-MDCY         PIC 9(08).
   900         16  DC-GREG-DATE-MDCY-R REDEFINES
   901                              DC-GREG-DATE-MDCY.
   902             20  DC-MDCY-MONTH         PIC 99.
   903             20  DC-MDCY-DAY           PIC 99.
   904             20  DC-MDCY-CEN           PIC 99.
   905             20  DC-MDCY-YEAR          PIC 99.
   906    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   907        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   908    12  DC-EL310-DATE                  PIC X(21).
   909    12  FILLER                         PIC X(28).
   910
   911****************************************************************
   912*
   913* Copyright (c) 2007 by Clerity Solutions, Inc.
   914* All rights reserved.
   915*
   916****************************************************************
   917 01  DFHEIV.
   918   02  DFHEIV0               PIC X(35).
   919   02  DFHEIV1               PIC X(08).
   920   02  DFHEIV2               PIC X(08).
   921   02  DFHEIV3               PIC X(08).
   922   02  DFHEIV4               PIC X(06).
   923   02  DFHEIV5               PIC X(04).
   924   02  DFHEIV6               PIC X(04).
   925   02  DFHEIV7               PIC X(02).
   926   02  DFHEIV8               PIC X(02).
   927   02  DFHEIV9               PIC X(01).
   928   02  DFHEIV10              PIC S9(7) COMP-3.
   929   02  DFHEIV11              PIC S9(4) COMP SYNC.
   930   02  DFHEIV12              PIC S9(4) COMP SYNC.
   931   02  DFHEIV13              PIC S9(4) COMP SYNC.
   932   02  DFHEIV14              PIC S9(4) COMP SYNC.
   933   02  DFHEIV15              PIC S9(4) COMP SYNC.
   934   02  DFHEIV16              PIC S9(9) COMP SYNC.
   935   02  DFHEIV17              PIC X(04).
   936   02  DFHEIV18              PIC X(04).
   937   02  DFHEIV19              PIC X(04).
   938   02  DFHEIV20              USAGE IS POINTER.
   939   02  DFHEIV21              USAGE IS POINTER.
   940   02  DFHEIV22              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  19
* ELRAMT.cbl
   941   02  DFHEIV23              USAGE IS POINTER.
   942   02  DFHEIV24              USAGE IS POINTER.
   943   02  DFHEIV25              PIC S9(9) COMP SYNC.
   944   02  DFHEIV26              PIC S9(9) COMP SYNC.
   945   02  DFHEIV27              PIC S9(9) COMP SYNC.
   946   02  DFHEIV28              PIC S9(9) COMP SYNC.
   947   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   948   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   949   02  FILLER                PIC X(02).
   950   02  DFHEIV99              PIC X(08) VALUE SPACE.
   951   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   952   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   953   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   954   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   955 LINKAGE  SECTION.
   956*****************************************************************
   957*                                                               *
   958* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   959* All rights reserved.                                          *
   960*                                                               *
   961*****************************************************************
   962 01  dfheiblk.
   963     02  eibtime          pic s9(7) comp-3.
   964     02  eibdate          pic s9(7) comp-3.
   965     02  eibtrnid         pic x(4).
   966     02  eibtaskn         pic s9(7) comp-3.
   967     02  eibtrmid         pic x(4).
   968     02  dfheigdi         pic s9(4) comp.
   969     02  eibcposn         pic s9(4) comp.
   970     02  eibcalen         pic s9(4) comp.
   971     02  eibaid           pic x(1).
   972     02  eibfiller1       pic x(1).
   973     02  eibfn            pic x(2).
   974     02  eibfiller2       pic x(2).
   975     02  eibrcode         pic x(6).
   976     02  eibfiller3       pic x(2).
   977     02  eibds            pic x(8).
   978     02  eibreqid         pic x(8).
   979     02  eibrsrce         pic x(8).
   980     02  eibsync          pic x(1).
   981     02  eibfree          pic x(1).
   982     02  eibrecv          pic x(1).
   983     02  eibsend          pic x(1).
   984     02  eibatt           pic x(1).
   985     02  eibeoc           pic x(1).
   986     02  eibfmh           pic x(1).
   987     02  eibcompl         pic x(1).
   988     02  eibsig           pic x(1).
   989     02  eibconf          pic x(1).
   990     02  eiberr           pic x(1).
   991     02  eibrldbk         pic x(1).
   992     02  eiberrcd         pic x(4).
   993     02  eibsynrb         pic x(1).
   994     02  eibnodat         pic x(1).
   995     02  eibfiller5       pic x(2).
   996     02  eibresp          pic 9(09) comp.
   997     02  eibresp2         pic 9(09) comp.
   998     02  dfheigdj         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  20
* ELRAMT.cbl
   999     02  dfheigdk         pic s9(4) comp.
  1000 01  DFHCOMMAREA                 PIC X(450).
  1001
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  21
* ELRAMT.cbl
  1003 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1004 0000-DFHEXIT SECTION.
  1005     MOVE '9#                    $   ' TO DFHEIV0.
  1006     MOVE 'ELRAMT' TO DFHEIV1.
  1007     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1008     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1009
  1010 000-START-REM-CALC.
  1011*                           COPY ELCRAMTP.
  1012*****************************************************************
  1013*                                                               *
  1014*                                                               *
  1015*                            ELCRAMTP.                          *
  1016*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1017*                            VMOD=2.015                         *
  1018*                                                               *
  1019*                CALCULATE THE REMAINING AMOUNT.                *
  1020*****************************************************************.
  1021******************************************************************
  1022*                   C H A N G E   L O G
  1023*
  1024* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1025*-----------------------------------------------------------------
  1026*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1027* EFFECTIVE    NUMBER
  1028*-----------------------------------------------------------------
  1029* 041710    2007111300001  AJRA  CALC SC NET PAY PLUS 6
  1030******************************************************************
  1031
  1032     MOVE ZERO                   TO  CP-RETURN-CODE
  1033                                     CP-REMAINING-AMT
  1034                                     CP-REMAINING-AMT-PRV
  1035                                     CP-REMAMT-FACTOR
  1036                                     NP-FACTOR
  1037                                     WS-PASS-SW.
  1038
  1039 050-START.
  1040     IF COMPUTING-PRIOR-MO
  1041         COMPUTE WS-REMAINING-TERM = CP-REMAINING-TERM + +1
  1042      ELSE
  1043          MOVE CP-REMAINING-TERM   TO WS-REMAINING-TERM.
  1044
  1045     IF CP-BENEFIT-TYPE = 'A'
  1046         COMPUTE CP-REMAINING-AMT = CP-REMAINING-TERM  *
  1047                                          CP-ORIGINAL-BENEFIT
  1048         GO TO 999-CALC-REM-AMT-X.
  1049
  1050     IF CP-BENEFIT-TYPE = 'L' OR 'P'
  1051         IF CP-EARN-AS-NET-PAY
  1052             NEXT SENTENCE
  1053         ELSE
  1054             MOVE CP-ORIGINAL-BENEFIT    TO  WS-REMAINING-AMT
  1055             GO TO 800-CALC-REM-RESULT.
  1056
  1057     IF CP-ORIGINAL-TERM = ZERO
  1058         MOVE '4'                TO  CP-RETURN-CODE
  1059         GO TO 999-CALC-REM-AMT-X.
  1060
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  22
* ELRAMT.cbl
  1061*    IF (CP-EARN-AS-REG-BALLOON)
  1062*      AND
  1063*       (NOT CP-BALLOON-LAST-PMT)
  1064*       COMPUTE WS-TEMP-RESULT ROUNDED EQUAL
  1065*         CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM - 1)
  1066*    ELSE
  1067     COMPUTE WS-TEMP-RESULT ROUNDED EQUAL
  1068                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1069
  1070     IF CP-EARN-AS-REG-BALLOON
  1071        GO TO 400-CALC-REM-BALLOON.
  1072
  1073     IF CP-EARN-AS-NET-PAY
  1074         GO TO 300-CALC-NET-PAY-REM.
  1075
  1076     IF CP-SPECIAL-CALC-CD IS EQUAL TO 'N'
  1077         GO TO 300-CALC-NET-PAY-REM.
  1078
  1079     MOVE CP-CERT-EFF-DT            TO  DC-BIN-DATE-1.
  1080     MOVE ' '                       TO  DC-OPTION-CODE.
  1081     PERFORM 0030-CNVT-DT THRU 0030-CNVT-EXIT.
  1082
  1083*    IF CP-STATE-STD-ABBRV IS EQUAL TO 'OH'   AND
  1084     IF (CP-STATE-STD-ABBRV IS EQUAL TO 'OH')   AND
  1085        (CP-CLASS-CODE NOT = 'L ') AND
  1086        CP-ORIGINAL-TERM IS GREATER THAN +60  AND
  1087        CP-LOAN-APR IS GREATER THAN +0
  1088         IF DC-GREG-DATE-CYMD IS GREATER THAN 19831031
  1089             GO TO 300-CALC-NET-PAY-REM.
  1090
  1091     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MT'   AND
  1092        CP-ORIGINAL-TERM IS GREATER THAN +61  AND
  1093        CP-LOAN-APR IS GREATER THAN +0
  1094         IF DC-GREG-DATE-CYMD IS GREATER THAN 19830318
  1095             GO TO 300-CALC-NET-PAY-REM.
  1096
  1097     IF CP-STATE-STD-ABBRV IS EQUAL TO 'UT'   AND
  1098        CP-ORIGINAL-TERM IS GREATER THAN +62  AND
  1099        CP-LOAN-APR IS GREATER THAN +0
  1100         IF DC-GREG-DATE-CYMD IS GREATER THAN 19810831  AND
  1101            DC-GREG-DATE-CYMD IS LESS    THAN 19830901
  1102             GO TO 300-CALC-NET-PAY-REM.
  1103
  1104     IF CP-STATE-STD-ABBRV IS EQUAL TO 'RI'   AND
  1105        CP-ORIGINAL-TERM IS GREATER THAN +60  AND
  1106        CP-LOAN-APR IS GREATER THAN +0
  1107         IF DC-GREG-DATE-CYMD IS GREATER THAN 19831231
  1108             GO TO 300-CALC-NET-PAY-REM.
  1109
  1110     IF WS-REMAINING-TERM = CP-ORIGINAL-TERM
  1111         MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1112         GO TO 800-CALC-REM-RESULT.
  1113
  1114     IF CP-EARN-AS-TEXAS
  1115         GO TO 200-CALC-TEXAS-REM.
  1116
  1117 100-ORDINARY-REM.
  1118     COMPUTE WS-REMAINING-AMT ROUNDED = WS-TEMP-RESULT *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  23
* ELRAMT.cbl
  1119                                          WS-REMAINING-TERM.
  1120     GO TO 800-CALC-REM-RESULT.
  1121
  1122 200-CALC-TEXAS-REM.
  1123     DIVIDE CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  1124         GIVING TEX-FACT-1.
  1125
  1126     IF CP-PAY-FREQUENCY = ZERO
  1127         MOVE '5'                TO  CP-RETURN-CODE
  1128         GO TO 999-CALC-REM-AMT-X.
  1129
  1130     DIVIDE WS-REMAINING-TERM BY CP-PAY-FREQUENCY
  1131         GIVING TEX-FACT-2
  1132         REMAINDER TEX-FACT-3.
  1133
  1134     IF TEX-FACT-3 NOT = ZERO
  1135         ADD +1 TO TEX-FACT-2.
  1136
  1137     IF (TEX-FACT-2 * CP-PAY-FREQUENCY) = CP-ORIGINAL-TERM
  1138         MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1139     ELSE
  1140         COMPUTE WS-REMAINING-AMT ROUNDED =
  1141             (TEX-FACT-1 * (TEX-FACT-2 * CP-PAY-FREQUENCY)).
  1142
  1143     GO TO 800-CALC-REM-RESULT.
  1144
  1145 300-CALC-NET-PAY-REM.
  1146
  1147     MOVE CP-LOAN-APR            TO  NP-APR.
  1148     MOVE CP-ORIGINAL-TERM       TO  NP-ORIG.
  1149     MOVE WS-REMAINING-TERM      TO  NP-REM.
  1150     MOVE CP-LOAN-TERM           TO  NP-LOAN-TERM.
  1151     MOVE CP-SPECIAL-CALC-CD     TO  NP-OPT.
  1152
  1153     IF CP-COMPANY-ID IS NOT EQUAL TO 'NCL'
  1154         GO TO 300-CONT-CALC-NET-PAY-REM.
  1155
  1156     MOVE CP-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  1157     MOVE CP-FIRST-PAY-DATE      TO  DC-BIN-DATE-2.
  1158     MOVE '1'                    TO  DC-OPTION-CODE.
  1159     PERFORM 0030-CNVT-DT THRU 0030-CNVT-EXIT.
  1160
  1161     IF DATE-CONVERSION-ERROR
  1162         MOVE '2'                TO  CP-RETURN-CODE
  1163         GO TO 999-CALC-REM-AMT-X
  1164     ELSE
  1165         MOVE DC-ELAPSED-MONTHS  TO  CP-MNTHS-TO-FIRST-PMT
  1166         MOVE DC-ODD-DAYS-OVER   TO  CP-ODD-DAYS-TO-PMT.
  1167
  1168     IF WS-REMAINING-TERM = CP-ORIGINAL-TERM
  1169         MOVE +1                 TO ODF
  1170     ELSE
  1171         COMPUTE ODF =
  1172         ((1 + (NP-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  1173         ((1 + (CP-ODD-DAYS-TO-PMT * NP-APR / 36500))).
  1174
  1175 300-CONT-CALC-NET-PAY-REM.
  1176
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  24
* ELRAMT.cbl
  1177     PERFORM 1000-NET-TERM.
  1178
  1179     IF ANNUAL-INT-RATE = ZEROS
  1180         COMPUTE WS-REMAINING-AMT ROUNDED =
  1181             (CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM)
  1182              * WS-REMAINING-TERM
  1183     ELSE
  1184     COMPUTE WS-REMAINING-AMT ROUNDED =
  1185             NP-FACTOR * (CP-ORIGINAL-BENEFIT / +1000).
  1186
  1187     IF CP-COMPANY-ID NOT = 'CID'
  1188        IF CP-STATE-STD-ABBRV IS EQUAL TO 'NC'
  1189                  AND
  1190           CP-EARN-AS-NET-PAY
  1191            MOVE CP-CERT-EFF-DT         TO  DC-BIN-DATE-1
  1192            MOVE ' '                    TO  DC-OPTION-CODE
  1193            PERFORM 0030-CNVT-DT THRU 0030-CNVT-EXIT
  1194            IF DC-GREG-DATE-CYMD IS GREATER THAN 19931231
  1195                GO TO 500-CALC-REM-RESULT.
  1196
  1197     IF CP-COMPANY-ID = 'CID' AND
  1198        CP-STATE-STD-ABBRV = 'SC' AND
  1199        CP-EARN-AS-NET-PAY AND
  1200        CP-LF-CLAIM-CALC-SW = 'Y' AND
  1201        (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1202            GO TO 600-CALC-REM-RESULT.
  1203
  1204     GO TO 800-CALC-REM-RESULT.
  1205
  1206 400-CALC-REM-BALLOON.
  1207     IF CP-ORIGINAL-TERM LESS THAN CP-REMAINING-TERM
  1208        MOVE CP-ORIGINAL-BENEFIT TO CP-REMAINING-AMT
  1209        ADD CP-ALTERNATE-BENEFIT TO CP-REMAINING-AMT
  1210        GO TO 999-CALC-REM-AMT-X.
  1211
  1212     IF NOT CP-BALLOON-LAST-PMT
  1213        COMPUTE WS-REMAINING-AMT ROUNDED =
  1214          (WS-TEMP-RESULT * CP-REMAINING-TERM) +
  1215*         (WS-TEMP-RESULT * (CP-REMAINING-TERM - 1)) +
  1216           CP-ALTERNATE-BENEFIT
  1217     ELSE
  1218        COMPUTE WS-REMAINING-AMT ROUNDED =
  1219          (WS-TEMP-RESULT * CP-REMAINING-TERM ) +
  1220           CP-ALTERNATE-BENEFIT.
  1221
  1222     GO TO 800-CALC-REM-RESULT.
  1223
  1224 500-CALC-REM-RESULT.
  1225
  1226     IF ANNUAL-INT-RATE = ZEROS
  1227         MOVE CP-ORIGINAL-BENEFIT
  1228                              TO  WS-REMAINING-AMT
  1229         GO TO 999-CALC-REM-AMT-X.
  1230
  1231     IF REMAINING-TERM  = ZEROS
  1232         GO TO 999-CALC-REM-AMT-X.
  1233
  1234     COMPUTE ANGLEN = WK1 / I.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  25
* ELRAMT.cbl
  1235     COMPUTE WS-TEMP-RESULT = CP-ORIGINAL-BENEFIT / ANGLEN.
  1236     COMPUTE WS-REMAINING-AMT =
  1237             WS-REMAINING-AMT + (WS-TEMP-RESULT * 3).
  1238     MOVE WS-TEMP-RESULT      TO  CP-MONTHLY-PAYMENT.
  1239
  1240     GO TO 800-CALC-REM-RESULT.
  1241
  1242 600-CALC-REM-RESULT.
  1243
  1244     IF WS-REMAINING-TERM  = ZEROS
  1245         GO TO 800-CALC-REM-RESULT
  1246     END-IF.
  1247
  1248     IF ANNUAL-INT-RATE = ZEROS
  1249         COMPUTE WS-TEMP-RESULT ROUNDED = CP-ORIGINAL-BENEFIT /
  1250                                  CP-ORIGINAL-TERM
  1251         COMPUTE WS-REMAINING-AMT ROUNDED =
  1252             WS-TEMP-RESULT * (WS-REMAINING-TERM + 6)
  1253         IF WS-REMAINING-AMT > CP-ORIGINAL-BENEFIT
  1254            MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1255         END-IF
  1256         MOVE WS-TEMP-RESULT      TO  CP-MONTHLY-PAYMENT
  1257         GO TO 800-CALC-REM-RESULT
  1258     END-IF.
  1259
  1260     COMPUTE ANGLEN = WK1 / I.
  1261     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  1262                 / (1 + I)
  1263     COMPUTE ANGLEN1 = ANGLEN / Y
  1264     COMPUTE WS-TEMP-RESULT ROUNDED = CP-ORIGINAL-BENEFIT /
  1265                                   ANGLEN1.
  1266     COMPUTE CP-SCNP-6MO-AMT ROUNDED = WS-TEMP-RESULT * 6.
  1267     COMPUTE WS-REMAINING-AMT ROUNDED =
  1268             WS-REMAINING-AMT + CP-SCNP-6MO-AMT.
  1269     IF WS-REMAINING-AMT > CP-ORIGINAL-BENEFIT
  1270         MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1271     END-IF.
  1272
  1273     GO TO 800-CALC-REM-RESULT.
  1274
  1275 800-CALC-REM-RESULT.
  1276     IF COMPUTING-CURRENT-MO
  1277        MOVE WS-REMAINING-AMT TO CP-REMAINING-AMT
  1278        MOVE NP-FACTOR        TO CP-REMAMT-FACTOR
  1279        MOVE 1                TO WS-PASS-SW
  1280        GO TO 050-START
  1281      ELSE
  1282        MOVE WS-REMAINING-AMT TO CP-REMAINING-AMT-PRV.
  1283
  1284 999-CALC-REM-AMT-X.
  1285
  1286
  1287     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  1288
  1289
  1290* EXEC CICS RETURN
  1291*        END-EXEC.
  1292*    MOVE '.(                    &   #00001285' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  26
* ELRAMT.cbl
  1293     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1294     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1295     MOVE X'2020233030303031323835' TO DFHEIV0(25:11)
  1296     CALL 'kxdfhei1' USING DFHEIV0,
  1297           DFHEIV99,
  1298           DFHEIV99,
  1299           DFHEIV99,
  1300           DFHEIV99,
  1301           DFHEIV99
  1302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1303
  1304
  1305
  1306* GOBACK.
  1307     MOVE '9%                    "   ' TO DFHEIV0
  1308     MOVE 'ELRAMT' TO DFHEIV1
  1309     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1310     GOBACK.
  1311
  1312 0030-CNVT-DT.
  1313
  1314
  1315* EXEC CICS LINK
  1316*        PROGRAM    ('ELDATCV')
  1317*        COMMAREA   (DATE-CONVERSION-DATA)
  1318*        LENGTH     (DC-COMM-LENGTH)
  1319*    END-EXEC.
  1320     MOVE 'ELDATCV' TO DFHEIV1
  1321*    MOVE '."C                   ''   #00001292' TO DFHEIV0
  1322     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1323     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1324     MOVE X'2020233030303031323932' TO DFHEIV0(25:11)
  1325     CALL 'kxdfhei1' USING DFHEIV0,
  1326           DFHEIV1,
  1327           DATE-CONVERSION-DATA,
  1328           DC-COMM-LENGTH,
  1329           DFHEIV99,
  1330           DFHEIV99,
  1331           DFHEIV99
  1332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1333
  1334
  1335 0030-CNVT-EXIT.
  1336     EXIT.
  1337
  1338 1000-NET-TERM SECTION.
  1339*                                COPY ELCRAMTN.
  1340*****************************************************************
  1341*                                                               *
  1342*                                                               *
  1343*                            ELCRAMTN.                          *
  1344*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1345*                            VMOD=2.008                         *
  1346*                                                               *
  1347*             CALCULATE NET PAY REMAINING AMOUNT                *
  1348*****************************************************************.
  1349
  1350     MOVE NP-APR                 TO  ANNUAL-INT-RATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  27
* ELRAMT.cbl
  1351     MOVE NP-ORIG                TO  ORIGINAL-TERM.
  1352     MOVE NP-REM                 TO  REMAINING-TERM.
  1353
  1354 1000-EDIT-DATA.
  1355     MOVE +0 TO FACTOR.
  1356
  1357     IF ANNUAL-INT-RATE = ZERO
  1358         GO TO 9000-ERROR.
  1359
  1360     IF ORIGINAL-TERM  = ZERO OR
  1361        REMAINING-TERM = ZERO
  1362         GO TO 9500-RETURN.
  1363
  1364     IF NP-LOAN-TERM NOT NUMERIC
  1365        MOVE +0 TO NP-LOAN-TERM.
  1366
  1367     IF NP-LOAN-TERM EQUAL +0
  1368        MOVE ORIGINAL-TERM TO NP-LOAN-TERM.
  1369
  1370     IF REMAINING-TERM GREATER ORIGINAL-TERM
  1371         GO TO 9000-ERROR.
  1372
  1373*    IF ANNUAL-INT-RATE LESS THAN +3
  1374*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  1375*    IF ANNUAL-INT-RATE LESS THAN +3
  1376*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  1377*    IF ANNUAL-INT-RATE LESS THAN +3
  1378*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  1379
  1380     IF NPO-SIMPLE
  1381         MOVE 'S'                TO  NP-TYPE
  1382     ELSE
  1383         MOVE 'N'                TO  NP-TYPE.
  1384
  1385     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  1386
  1387     COMPUTE V ROUNDED = K1 / (K1 + I).
  1388
  1389     IF (NP-LOAN-TERM GREATER THAN NP-ORIG)
  1390                AND
  1391        (CP-TRUNCATED-LIFE OR CP-SPECIAL-CALC-CD = 'N')
  1392         MOVE NP-LOAN-TERM TO MAX-X
  1393         COMPUTE REMAINING-TERM EQUAL REMAINING-TERM +
  1394             (NP-LOAN-TERM - NP-ORIG)
  1395     ELSE
  1396         MOVE ORIGINAL-TERM TO MAX-X.
  1397
  1398     COMPUTE X1 = MAX-X - ORIGINAL-TERM.
  1399
  1400     MOVE B1 TO X1 SX.
  1401     MOVE V TO VX  SV.
  1402
  1403     IF MAX-X = B1
  1404         GO TO 1000-COMPUTE-REMAINING-FACTOR.
  1405
  1406 1000-VX-LOOP.
  1407     COMPUTE VX ROUNDED = VX * V.
  1408
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  28
* ELRAMT.cbl
  1409     ADD B1 TO X1.
  1410
  1411     IF X1 = REMAINING-TERM
  1412         MOVE VX TO SV.
  1413
  1414     IF X1 = X2
  1415         MOVE VX TO SX.
  1416
  1417     IF X1 NOT = MAX-X
  1418         GO TO 1000-VX-LOOP.
  1419
  1420 1000-COMPUTE-REMAINING-FACTOR.
  1421     COMPUTE WK1 = K1 - VX.
  1422
  1423     COMPUTE WK2 = K1 - SV.
  1424
  1425     IF CP-COMPANY-ID IS EQUAL TO 'NCL'       AND
  1426        CP-EARN-AS-NET-PAY
  1427         GO TO 2100-CHECK-NCL-NET-PAY.
  1428
  1429     IF CP-COMPANY-ID IS EQUAL TO 'NCL'
  1430        IF CP-SPECIAL-CALC-CD IS EQUAL TO 'N'
  1431            IF CP-LOAN-TERM IS GREATER THAN CP-ORIGINAL-TERM
  1432                GO TO 2100-NCL-NET-TRUNC
  1433            ELSE
  1434                GO TO 2100-NCL-NET-PAY.
  1435
  1436*    IF CP-TRUNCATED-LIFE
  1437*        IF CP-LOAN-TERM = REMAINING-TERM
  1438*            GO TO 2000-PREMIUM-RATE.
  1439
  1440*    IF NOT CP-TRUNCATED-LIFE
  1441*        IF ORIGINAL-TERM = REMAINING-TERM
  1442*            GO TO 2000-PREMIUM-RATE.
  1443
  1444     COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  1445
  1446     MOVE WK3 TO FACTOR.
  1447
  1448     GO TO 9500-RETURN.
  1449
  1450 2000-PREMIUM-RATE.
  1451
  1452     COMPUTE K-I = K1 + I
  1453
  1454     IF NPO-ALT OR NPO-TRUNC
  1455         MOVE K1                 TO  K-I.
  1456
  1457     IF NPO-2MO OR NPO-TRUNC-2
  1458         COMPUTE K-I = K1 + (2 * I).
  1459
  1460     COMPUTE RA ROUNDED = 1 -
  1461         ((X2 * (X2 + 1)) /
  1462          (MAX-X * (MAX-X + 1))).
  1463
  1464     IF NET-STD
  1465         COMPUTE WK3 ROUNDED =
  1466             ((I * ORIGINAL-TERM) + VX - SX) * 2 * MAX-X
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  29
* ELRAMT.cbl
  1467         COMPUTE WK3 ROUNDED =
  1468             WK3 / (( 1 - VX) * ORIGINAL-TERM * I)
  1469         COMPUTE WK3 ROUNDED =
  1470             WK3 / ((2 * MAX-X) - ORIGINAL-TERM + 1)
  1471         COMPUTE WK3 ROUNDED =
  1472             WK3 * RA * K-I.
  1473
  1474     IF NET-SMP
  1475         COMPUTE N2 = MAX-X * MAX-X
  1476         COMPUTE N3 = N2 * MAX-X
  1477         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  1478         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  1479         COMPUTE WK3 ROUNDED = WK3 + (4 * MAX-X * WK1)
  1480         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  1481         COMPUTE WK3 ROUNDED = WK3 / (36 * (MAX-X + 1) * WK1).
  1482
  1483     MOVE WK3                    TO  FACTOR.
  1484     GO TO 9500-RETURN.
  1485
  1486 2100-CHECK-NCL-NET-PAY.
  1487
  1488     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MN'    AND
  1489        CP-ORIGINAL-TERM IS GREATER THAN +63   AND
  1490        CP-TRUNCATED-LIFE
  1491         GO TO 2100-CHECK-MINN-TRUNC.
  1492
  1493     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MN' AND
  1494        CP-ORIGINAL-TERM IS GREATER THAN +63
  1495         GO TO 2100-CHECK-MINN.
  1496
  1497     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MT'    AND
  1498        CP-ORIGINAL-TERM IS GREATER THAN +63   AND
  1499        CP-TRUNCATED-LIFE
  1500         GO TO 2100-CHECK-MONTANA-TRUNC.
  1501
  1502     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MT' AND
  1503        CP-ORIGINAL-TERM IS GREATER THAN +63
  1504         GO TO 2100-CHECK-MONTANA.
  1505
  1506     IF CP-TRUNCATED-LIFE
  1507         GO TO 2100-NCL-NET-TRUNC.
  1508
  1509 2100-NCL-NET-PAY.
  1510
  1511     COMPUTE ANGLEN = WK1 / I.
  1512
  1513     COMPUTE ANGLEU = WK2 / I.
  1514
  1515     COMPUTE ANGLEN1 = ANGLEN * ODF.
  1516
  1517     COMPUTE FACTOR = (ANGLEU / ANGLEN1) * 1000.
  1518
  1519     COMPUTE WS-REMAINING-AMT ROUNDED =
  1520         (CP-ORIGINAL-BENEFIT * ANGLEU) / ANGLEN1.
  1521
  1522     GO TO 9500-RETURN.
  1523
  1524 2100-NCL-NET-TRUNC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  30
* ELRAMT.cbl
  1525
  1526     COMPUTE ANGLEM = WK1 / I.
  1527
  1528     COMPUTE ANGLEU = WK2 / I.
  1529
  1530     COMPUTE ANGLEM1 = ANGLEM * ODF.
  1531
  1532     COMPUTE FACTOR = (ANGLEU / ANGLEM1) * 1000.
  1533
  1534     COMPUTE WS-REMAINING-AMT ROUNDED =
  1535         (CP-ORIGINAL-BENEFIT * ANGLEU) / ANGLEM1.
  1536
  1537     GO TO 9500-RETURN.
  1538
  1539 2100-CHECK-MINN-TRUNC.
  1540
  1541     COMPUTE ANGLEM = WK1 / I.
  1542
  1543     COMPUTE ANGLEU = WK2 / I.
  1544
  1545     COMPUTE ANGLEM1 = ANGLEM * ODF.
  1546
  1547     COMPUTE FACTOR = ((ANGLEU + 2) / ANGLEM1) * 1000.
  1548
  1549     COMPUTE WS-REMAINING-AMT ROUNDED =
  1550         (CP-ORIGINAL-BENEFIT * (ANGLEU + 2)) / ANGLEM1.
  1551
  1552     GO TO 9500-RETURN.
  1553
  1554 2100-CHECK-MINN.
  1555
  1556     COMPUTE ANGLEN = WK1 / I.
  1557
  1558     COMPUTE ANGLEU = WK2 / I.
  1559
  1560     COMPUTE ANGLEN1 = ANGLEN * ODF.
  1561
  1562     COMPUTE FACTOR = ((ANGLEU + 2) / ANGLEN1) * 1000.
  1563
  1564     COMPUTE WS-REMAINING-AMT ROUNDED =
  1565         (CP-ORIGINAL-BENEFIT * (ANGLEU + 2)) / ANGLEN1.
  1566
  1567     GO TO 9500-RETURN.
  1568
  1569 2100-CHECK-MONTANA-TRUNC.
  1570
  1571     COMPUTE ANGLEM = WK1 / I.
  1572
  1573     COMPUTE ANGLEU = WK2 / I.
  1574
  1575     COMPUTE ANGLEM1 = ANGLEM * ODF.
  1576
  1577     COMPUTE FACTOR = ((ANGLEU + 4) / ANGLEM1) * 1000.
  1578
  1579     COMPUTE WS-REMAINING-AMT ROUNDED =
  1580         (CP-ORIGINAL-BENEFIT * (ANGLEU + 4)) / ANGLEM1.
  1581
  1582     GO TO 9500-RETURN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:40 Page  31
* ELRAMT.cbl
  1583
  1584 2100-CHECK-MONTANA.
  1585
  1586     COMPUTE ANGLEN = WK1 / I.
  1587
  1588     COMPUTE ANGLEU = WK2 / I.
  1589
  1590     COMPUTE ANGLEN1 = ANGLEN * ODF.
  1591
  1592     COMPUTE FACTOR = ((ANGLEU + 4) / ANGLEN1) * 1000.
  1593
  1594     COMPUTE WS-REMAINING-AMT ROUNDED =
  1595         (CP-ORIGINAL-BENEFIT * (ANGLEU + 4)) / ANGLEN1.
  1596
  1597     GO TO 9500-RETURN.
  1598
  1599 9000-ERROR.
  1600     GO TO 9500-RETURN.
  1601
  1602 9500-RETURN.
  1603     MOVE FACTOR                 TO  NP-FACTOR.
  1604
  1605 9999-EXIT.
  1606     EXIT.
  1607
  1608
  1609
  1610 9999-DFHBACK SECTION.
  1611     MOVE '9%                    "   ' TO DFHEIV0
  1612     MOVE 'ELRAMT' TO DFHEIV1
  1613     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1614     GOBACK.
  1615 9999-DFHEXIT.
  1616     IF DFHEIGDJ EQUAL 0001
  1617         NEXT SENTENCE.
  1618     MOVE '9%                    "   ' TO DFHEIV0
  1619     MOVE 'ELRAMT' TO DFHEIV1
  1620     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1621     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        1984     Code:        5201
