* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page   1
* EL6316.cbl
* Options: int("EL6316.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6316.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6316.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6316.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6316.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page   2
* EL6316.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24* 110410   2007070900001  PEMA  ADD REFORMATIONS AND RESCISSIONS
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    27* 072312   2011022800001  AJRA  NAPERSOFT MISC
    28* 091812 IR2012091400003  AJRA  CHANGE MSG 9999
    29* 101512   2011022800001  AJRA  FIX CLM RESC DEFAULT
    30* 102212   2012101700002  AJRA  SCREEN ID
    31* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    32* 110612   2012101700002  AJRA  ADD NEW FIELDS
    33* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    34* 121212   2012101700002  AJRA  ADD BILLING NOTE ENTRY
    35* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    36* 011413 IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    37* 121713   2013090300001  AJRA  ADD ENCLOSURE CODE TO SCREEN
    38* 122313   2013090300001  AJRA  DO ENDORSEMENT FROM CERT SCREEN
    39*-----------------------------------------------------------------
    40*REMARKS.
    41*        TRANSACTION - EXBC - CANCEL CHANGES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page   3
* EL6316.cbl
    43 ENVIRONMENT DIVISION.
    44 DATA DIVISION.
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47 77  FILLER  PIC X(32)  VALUE '********************************'.
    48 77  FILLER  PIC X(32)  VALUE '*    EL6316 WORKING STORAGE    *'.
    49 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    50 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    51 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    52 77  W-ARCH-NUMBER               PIC 9(8) BINARY  VALUE ZEROS.
    53 77  w-prtsw                     pic x  value spaces.
    54 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    55 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    56     88  ACCT-FOUND                 VALUE 'Y'.
    57 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
    58 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    59 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    60 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    61 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    62 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    63 77  s1                          pic s999 comp-3 value +0.
    64 77  s2                          pic s999 comp-3 value +0.
    65 77  WS-REASON-SW                PIC X  VALUE ' '.
    66     88  REASONS-FOUND                  VALUE 'Y'.
    67     88  REASONS-NOT-FOUND              VALUE 'N'.
    68 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    69     88  NO-CERT-RW                 VALUE 'N'.
    70     88  CERT-RW                    VALUE 'Y'.
    71 77  WS-COMM-LENGTH              PIC 9(4) BINARY.
    72 01  P pointer.
    73 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    74 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    75 01  var-ptr pointer.
    76 01  env-var-len                 pic 9(4)  binary.
    77 01  rc                          pic 9(9)  binary.
    78 01  WS-KIXHOST                  PIC X(10).
    79 01  WS-KIXSYS.
    80     05  WS-KIX-FIL1             PIC X(10).
    81     05  WS-KIX-APPS             PIC X(10).
    82     05  WS-KIX-ENV              PIC X(10).
    83     05  WS-KIX-MYENV            PIC X(10).
    84     05  WS-KIX-SYS              PIC X(10).
    85*    COPY ELCSCTM.
    86******************************************************************
    87*                                                                *
    88*                                                                *
    89*                            ELCSCTM                             *
    90*                            VMOD=2.001                          *
    91*                                                                *
    92*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    93*                                                                *
    94******************************************************************
    95 01  SECURITY-MESSAGE.
    96     12  FILLER                          PIC X(30)
    97            VALUE '** LOGIC SECURITY VIOLATION -'.
    98     12  SM-READ                         PIC X(6).
    99     12  FILLER                          PIC X(5)
   100            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page   4
* EL6316.cbl
   101     12  SM-PGM                          PIC X(6).
   102     12  FILLER                          PIC X(5)
   103            VALUE ' OPR='.
   104     12  SM-PROCESSOR-ID                 PIC X(4).
   105     12  FILLER                          PIC X(6)
   106            VALUE ' TERM='.
   107     12  SM-TERMID                       PIC X(4).
   108     12  FILLER                          PIC XX   VALUE SPACE.
   109     12  SM-JUL-DATE                     PIC 9(5).
   110     12  FILLER                          PIC X    VALUE SPACE.
   111     12  SM-TIME                         PIC 99.99.
   112
   113*    COPY ELCSCRTY.
   114******************************************************************
   115*                                                                *
   116*                                                                *
   117*                            ELCSCRTY                            *
   118*                            VMOD=2.001                          *
   119*                                                                *
   120*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   121*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   122*        SAVED IN PI-SECURITY-ADDRESS.                           *
   123*                                                                *
   124******************************************************************
   125 01  SECURITY-CONTROL.
   126     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   127     12  FILLER                       PIC XX    VALUE 'SC'.
   128     12  SC-CREDIT-CODES.
   129         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   130             20  SC-CREDIT-DISPLAY    PIC X.
   131             20  SC-CREDIT-UPDATE     PIC X.
   132     12  SC-CLAIMS-CODES.
   133         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   134             20  SC-CLAIMS-DISPLAY    PIC X.
   135             20  SC-CLAIMS-UPDATE     PIC X.
   136 01 srch-commarea.
   137*                                copy ELCADLTRSPI.
   138******************************************************************
   139*                   C H A N G E   L O G
   140*
   141* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   142*-----------------------------------------------------------------
   143*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   144* EFFECTIVE    NUMBER
   145*-----------------------------------------------------------------
   146* 060611    2011022800001  PEMA  NEW COPYBOOK
   147* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   148* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   149******************************************************************
   150****************************************
   151*  commarea for NaperSoft On Demand Admin services letters
   152*  (business logic input & output)
   153****************************************
   154     03  BL-INPUT.
   155         05  BL-DATA-SRCE        PIC X.
   156         05  BL-LETTER-ID        PIC XXXX.
   157         05  BL-CARRIER          PIC X.
   158         05  BL-GROUP            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page   5
* EL6316.cbl
   159         05  BL-STATE            PIC XX.
   160         05  BL-ACCOUNT          PIC X(10).
   161         05  BL-EFF-DT           PIC X(10).
   162         05  BL-CERT-NO          PIC X(11).
   163         05  BL-BATCH-NO         PIC X(6).
   164         05  BL-BATCH-SEQ        PIC 9(8).
   165         05  BL-RESP-NO          PIC X(10).
   166         05  BL-NO-OF-COPIES     PIC 99.
   167         05  BL-PROC-ID          PIC XXXX.
   168         05  BL-COMP-ID          PIC XXX.
   169         05  BL-PRINT-NOW-SW     PIC X.
   170         05  BL-ENC-CD           PIC XXX.
   171         05  BL-RESEND-DT        PIC X(10).
   172         05  BL-FOLLOW-UP-DT     PIC X(10).
   173         05  BL-ARCHIVE-NO       PIC 9(8).
   174         05  BL-FUNC             PIC X(8).
   175         05  BL-COMMENTS         PIC X(100).
   176         05  FILLER REDEFINES BL-COMMENTS.
   177             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   178             10  BL-LETTER-TO-ACCT PIC X.
   179             10  BL-LETTER-TO-BENE PIC X.
   180             10  BL-WRITE-ERARCH   PIC X.
   181                 88  ERARCH-QWS      VALUE 'Q'.
   182                 88  ERARCH-BATCH    VALUE 'B'.
   183                 88  ERARCH-TEMP     VALUE 'T'.
   184             10  BL-PROCESS-TYPE PIC X(07).
   185             10  BL-CERT-FORM-ID PIC X(05).
   186             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   187             10  BL-SOURCE-SCREEN PIC X(8).
   188             10  FILLER          PIC X(25).
   189     03  BL-OUTPUT.
   190         05  BL-STATUS                   PIC X.
   191             88  BL-OK                      VALUE "P".
   192             88  BL-FAIL                  VALUE "F".
   193         05  BL-MESSAGE          PIC X(50).
   194     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   195     03  FILLER                  PIC X(31).
   196
   197*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   198*                                COPY ELCZREC.
   199******************************************************************
   200*                                                                *
   201*                                                                *
   202*                            ELCZREC.                            *
   203*                                                                *
   204*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   205*                                                                *
   206******************************************************************
   207*-----------------------------------------------------------------
   208*                   C H A N G E   L O G
   209*
   210* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   211*-----------------------------------------------------------------
   212*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   213* EFFECTIVE    NUMBER
   214*-----------------------------------------------------------------
   215* 122011    2011022800001  AJRA  NEW FILE
   216* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page   6
* EL6316.cbl
   217* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   218* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   219* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   220*-----------------------------------------------------------------
   221 01  W-Z-CONTROL-DATA.
   222     05  W-NUMBER-OF-COPIES      PIC  9.
   223     05  FILLER                  PIC  X.
   224     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   225     05  FILLER                  PIC  X.
   226     05  W-DAYS-TO-RESEND        PIC  999.
   227     05  FILLER                  PIC  X.
   228     05  W-FORM-TO-RESEND        PIC  X(4).
   229     05  W-ADD-BAR-CODE          PIC  X.
   230     05  W-PROMPT-LETTER         PIC  X.
   231     05  W-HAS-RETURN-ENV        PIC  X.
   232     05  W-ENCLOSURE-CD          PIC  XXX.
   233     05  W-SIG-FLAG-DEFAULT      PIC  X.
   234     05  W-AUTO-CLOSE-IND        PIC  X.
   235     05  FILLER                  PIC  X.
   236     05  W-LETTER-TO-BENE        PIC  X.
   237     05  FILLER                  PIC  X.
   238     05  W-LETTER-TO-ACCT        PIC  X.
   239     05  FILLER                  PIC  X.
   240     05  W-LETTER-TYPE           PIC  X.
   241     05  FILLER                  PIC  X.
   242     05  W-PRINT-CERTIFICATE     PIC  X.
   243     05  FILLER                  PIC  X.
   244     05  W-REFUND-REQUIRED       PIC  X.
   245     05  FILLER                  PIC  X.
   246     05  W-ONBASE-CODE           PIC  XX.
   247     05  FILLER                  PIC  X.
   248     05  W-ACCT-SUMM             PIC  X.
   249     05  FILLER                  PIC  X.
   250     05  W-CSO-SUMM              PIC  X.
   251     05  FILLER                  PIC  X.
   252     05  W-REASONS-REQUIRED      PIC  X.
   253     05  FILLER                  PIC  X(29).
   254 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   255 01  STANDARD-AREAS.
   256     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   257     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   258                                 PIC  X(08).
   259     12  QID.
   260         16  QID-TERM        PIC X(4)    VALUE SPACES.
   261         16  FILLER          PIC X(4)    VALUE '631I'.
   262     12  TIME-MT                 PIC S9(7).
   263     12  TIME-MT-R  REDEFINES TIME-MT.
   264         16  FILLER              PIC X.
   265         16  TIME-LMT            PIC 99V99.
   266         16  FILLER              PIC X(2).
   267     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   268     12  MAP-LENGTH              PIC 9(4)   VALUE 359 BINARY.
   269     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   270     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   271     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   272     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   273     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   274     12  ELENCC-LENGTH           PIC S9(04) VALUE +400 COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page   7
* EL6316.cbl
   275     12  WS-ELCERT-KEY.
   276         16  W-CERT-COMPANY-CD   PIC X.
   277         16  W-CERT-CARRIER      PIC X.
   278         16  W-CERT-GROUPING     PIC X(6).
   279         16  W-CERT-STATE        PIC XX.
   280         16  W-CERT-ACCOUNT      PIC X(10).
   281         16  W-CERT-CERT-EFF-DT  PIC XX.
   282         16  W-CERT-CERT-PRIME   PIC X(10).
   283         16  W-CERT-CERT-SFX     PIC X.
   284     12  WS-ELEOBC-KEY.
   285         16  WS-EOBC-COMPANY-CD  PIC X.
   286         16  WS-EOBC-REC-TYPE    PIC X.
   287         16  WS-EOBC-CODE        PIC X(4).
   288         16  FILLER              PIC X(9).
   289     12  WS-ERNOTE-KEY.
   290         16  W-NOTE-COMPANY-CD   PIC X.
   291         16  W-NOTE-CARRIER      PIC X.
   292         16  W-NOTE-GROUPING     PIC X(6).
   293         16  W-NOTE-STATE        PIC XX.
   294         16  W-NOTE-ACCOUNT      PIC X(10).
   295         16  W-NOTE-CERT-EFF-DT  PIC XX.
   296         16  W-NOTE-CERT-PRIME   PIC X(10).
   297         16  W-NOTE-CERT-SFX     PIC X.
   298     12  ELLETR-KEY.
   299         16  LETR-PART-KEY.
   300             20  LETR-COMPANY-CD PIC X.
   301             20  LETR-LETTER-ID  PIC X(4).
   302         16  LETR-FILLER         PIC X(8).
   303         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   304     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   305     12  ERPNDB2-KEY.
   306         16  PNDB2-COMPANY-CD    PIC X.
   307         16  PNDB2-CARRIER       PIC X.
   308         16  PNDB2-GROUPING      PIC X(6).
   309         16  PNDB2-STATE         PIC XX.
   310         16  PNDB2-ACCOUNT       PIC X(10).
   311         16  PNDB2-CERT-EFF-DT   PIC XX.
   312         16  PNDB2-CERT-PRIME    PIC X(10).
   313         16  PNDB2-CERT-SFX      PIC X.
   314         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   315         16  PNDB2-RECORD-TYPE   PIC X.
   316     12  ERENDT-KEY.
   317         16  ENDT-COMPANY-CD       PIC X.
   318         16  ENDT-CARRIER          PIC X.
   319         16  ENDT-GROUPING         PIC X(6).
   320         16  ENDT-STATE            PIC XX.
   321         16  ENDT-ACCOUNT          PIC X(10).
   322         16  ENDT-CERT-EFF-DT      PIC XX.
   323         16  ENDT-CERT-PRIME       PIC X(10).
   324         16  ENDT-CERT-SFX         PIC X.
   325         16  ENDT-RECORD-TYPE      PIC X.
   326         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   327     12  ELCRTO-KEY.
   328         16  CRTO-COMPANY-CD     PIC X.
   329         16  CRTO-CARRIER        PIC X.
   330         16  CRTO-GROUPING       PIC X(6).
   331         16  CRTO-STATE          PIC XX.
   332         16  CRTO-ACCOUNT        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page   8
* EL6316.cbl
   333         16  CRTO-CERT-EFF-DT    PIC XX.
   334         16  CRTO-CERT-PRIME     PIC X(10).
   335         16  CRTO-CERT-SFX       PIC X.
   336         16  CRTO-RECORD-TYPE    PIC X.
   337         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   338     12  WS-ERMAIL-KEY.
   339         16  MAIL-COMPANY-CD     PIC X.
   340         16  MAIL-CARRIER        PIC X.
   341         16  MAIL-GROUPING       PIC X(6).
   342         16  MAIL-STATE          PIC XX.
   343         16  MAIL-ACCOUNT        PIC X(10).
   344         16  MAIL-CERT-EFF-DT    PIC XX.
   345         16  MAIL-CERT-PRIME     PIC X(10).
   346         16  MAIL-CERT-SFX       PIC X.
   347     12  WS-ELCRTT-KEY.
   348         16  WS-ELCRTT-PRIMARY       PIC X(33).
   349         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   350
   351     12  WS-ELENCC-KEY.
   352         16  WS-ENCC-COMPANY-CD  PIC X.
   353         16  WS-ENCC-REC-TYPE    PIC X.
   354         16  WS-ENCC-ENC-CODE    PIC X(5).
   355         16  FILLER              PIC X(09).
   356
   357     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   358     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   359     12  WS-CURRENT-DT.
   360         16  FILLER              PIC X(6)    VALUE SPACES.
   361         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   362     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   363     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   364         88  CANCEL-REC            VALUE 'C'.
   365         88  ISSUE-REC             VALUE 'I'.
   366     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   367     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   368     12  ELCNTL-KEY.
   369         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   370         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   371         16  CNTL-ACCESS.
   372             20  CNTL-STATE      PIC XX    VALUE SPACES.
   373             20  FILLER          PIC X     VALUE SPACES.
   374             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   375         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   376     12  WS-ERACCT-KEY.
   377         16  ACCT-COMPANY-CD     PIC X.
   378         16  ACCT-CARRIER        PIC X.
   379         16  ACCT-GROUPING       PIC X(6).
   380         16  ACCT-STATE          PIC XX.
   381         16  ACCT-ACCOUNT        PIC X(10).
   382         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   383         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   384     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   385     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   386     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   387     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   388     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   389     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   390     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page   9
* EL6316.cbl
   391     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   392     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   393     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   394     12  WS-ELENCC-FILE-ID       PIC X(8) VALUE 'ELENCC'.
   395     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   396     12  WS-ERMAIL-FILE-ID       PIC X(8) VALUE 'ERMAIL'.
   397     12  WS-RESPONSE             PIC S9(8)   COMP.
   398         88  RESP-NORMAL                  VALUE +00.
   399         88  RESP-NOTFND                  VALUE +13.
   400         88  RESP-DUPREC                  VALUE +14.
   401         88  RESP-DUPKEY                  VALUE +15.
   402         88  RESP-NOTOPEN                 VALUE +19.
   403         88  RESP-ENDFILE                 VALUE +20.
   404     12  MAP-NAME            PIC X(8)    VALUE 'EL631I'.
   405     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6316S'.
   406     12  SCREEN-NUMBER       PIC X(4)    VALUE '631I'.
   407     12  TRANS-ID            PIC X(4)    VALUE 'EXBC'.
   408     12  THIS-PGM            PIC X(8)    VALUE 'EL6316'.
   409     12  PGM-NAME            PIC X(8).
   410     12  TIME-IN             PIC S9(7).
   411     12  TIME-OUT-R  REDEFINES TIME-IN.
   412         16  FILLER          PIC X.
   413         16  TIME-OUT        PIC 99V99.
   414         16  FILLER          PIC X(2).
   415     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   416     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   417     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   418     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   419     12  XCTL-6317           PIC X(8)    VALUE 'EL6317'.
   420     12  XCTL-6318           PIC X(8)    VALUE 'EL6318'.
   421     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   422     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   423     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   424     12  WS-PHONE.
   425         16  WS-PH1              PIC XXX.
   426         16  WS-PH2              PIC XXX.
   427         16  WS-PH3              PIC XXXX.
   428     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   429     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   430
   431     12  WS-BILLING-NOTE.
   432         16  WS-BN-NOTE          PIC X(25).
   433         16  WS-BN-LTRID         PIC X(4).
   434         16  FILLER              PIC X(3).
   435         16  WS-BN-DATE          PIC X(8).
   436         16  FILLER              PIC X(3).
   437         16  WS-BN-USERID        PIC X(4).
   438         16  FILLER              PIC X(30).
   439     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   440         16  WS-MAN-BN-NOTE      PIC X(63).
   441         16  FILLER              PIC X(14).
   442     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   443     12  WS-TMPDATE.
   444         16  FILLER              PIC X(2).
   445         16  WS-TMPDT            PIC X(6).
   446     12  WS-AMTX                 PIC X(10).
   447     12  WS-AMTN  REDEFINES WS-AMTX PIC 9(10).
   448     12  WS-AMTV2 REDEFINES WS-AMTN PIC 9(8)V99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  10
* EL6316.cbl
   449     12  NEW-ORIG-REC.
   450         16  NEW-INS-LAST-NAME             PIC X(15).
   451         16  NEW-INS-FIRST-NAME            PIC X(10).
   452         16  NEW-INS-MIDDLE-INIT           PIC X.
   453         16  NEW-INS-AGE                   PIC S999     COMP-3.
   454         16  NEW-JNT-LAST-NAME             PIC X(15).
   455         16  NEW-JNT-FIRST-NAME            PIC X(10).
   456         16  NEW-JNT-MIDDLE-INIT           PIC X.
   457         16  NEW-JNT-AGE                   PIC S999     COMP-3.
   458         16  NEW-LF-BENCD                  PIC XX.
   459         16  NEW-LF-TERM                   PIC S999      COMP-3.
   460         16  NEW-LF-BEN-AMT                PIC S9(9)V99  COMP-3.
   461         16  NEW-LF-PRM-AMT                PIC S9(7)V99  COMP-3.
   462         16  NEW-LF-ALT-BEN-AMT            PIC S9(9)V99  COMP-3.
   463         16  NEW-LF-ALT-PRM-AMT            PIC S9(7)V99  COMP-3.
   464         16  NEW-LF-EXP-DT                 PIC XX.
   465         16  NEW-LF-COMM-PCT               PIC SV9(5)    COMP-3.
   466         16  NEW-LF-CANCEL-DT              PIC XX.
   467         16  NEW-LF-CANCEL-AMT             PIC S9(7)V99  COMP-3.
   468         16  NEW-LF-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   469         16  NEW-AH-BENCD                  PIC XX.
   470         16  NEW-AH-TERM                   PIC S999      COMP-3.
   471         16  NEW-AH-BEN-AMT                PIC S9(9)V99  COMP-3.
   472         16  NEW-AH-PRM-AMT                PIC S9(7)V99  COMP-3.
   473         16  NEW-AH-EXP-DT                 PIC XX.
   474         16  NEW-AH-COMM-PCT               PIC SV9(5)    COMP-3.
   475         16  NEW-AH-CP                     PIC 99.
   476         16  NEW-AH-CANCEL-DT              PIC XX.
   477         16  NEW-AH-CANCEL-AMT             PIC S9(7)V99  COMP-3.
   478         16  NEW-AH-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   479         16  NEW-CRED-BENE-NAME            PIC X(25).
   480         16  NEW-1ST-PMT-DT                PIC XX.
   481         16  NEW-INS-AGE-DEFAULT-FLAG      PIC X.
   482         16  NEW-JNT-AGE-DEFAULT-FLAG      PIC X.
   483         16  NEW-ISSUE-TRAN-IND            PIC X.
   484         16  NEW-CANCEL-TRAN-IND           PIC X.
   485         16  FILLER                        PIC X(235).
   486
   487 01  CERT-NOTE-ENTRIES.
   488     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   489         16  CERT-NT-TEXT                PIC X(63).
   490         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   491         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   492         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   493
   494 01  ERCNOT-AREA.
   495     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   496     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   497     12  ERCNOT-KEY.
   498         16  ERCNOT-PARTIAL-KEY.
   499             20 ERCNOT-COMPANY-CD    PIC X.
   500             20 ERCNOT-CARRIER       PIC X.
   501             20 ERCNOT-GROUPING      PIC X(06).
   502             20 ERCNOT-STATE         PIC XX.
   503             20 ERCNOT-ACCOUNT       PIC X(10).
   504             20 ERCNOT-EFF-DT        PIC XX.
   505             20 ERCNOT-CERT-NO.
   506                25 ERCNOT-CERT-PRIME PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  11
* EL6316.cbl
   507                25 ERCNOT-CERT-SFX   PIC X.
   508             20 ERCNOT-REC-TYP       PIC X.
   509         16 ERCNOT-SEQ           PIC S9(4) COMP.
   510     12  SV-PARTIAL-KEY.
   511         20 SV-COMPANY-CD            PIC X.
   512         20 SV-CARRIER               PIC X.
   513         20 SV-GROUPING              PIC X(06).
   514         20 SV-STATE                 PIC XX.
   515         20 SV-ACCOUNT               PIC X(10).
   516         20 SV-EFF-DT                PIC XX.
   517         20 SV-CERT-NO.
   518            25 SV-CERT-PRIME         PIC X(10).
   519            25 SV-CERT-SFX           PIC X(1).
   520         20 SV-REC-TYP               PIC X.
   521 01  ERROR-MESSAGES.
   522     12  ER-0000                 PIC X(4)  VALUE '0000'.
   523     12  ER-0004                 PIC X(4)  VALUE '0004'.
   524     12  ER-0008                 PIC X(4)  VALUE '0008'.
   525     12  ER-0023                 PIC X(4)  VALUE '0023'.
   526     12  ER-0029                 PIC X(4)  VALUE '0029'.
   527     12  ER-0068                 PIC X(4)  VALUE '0068'.
   528     12  ER-0132                 PIC X(4)  VALUE '0132'.
   529     12  ER-0142                 PIC X(4)  VALUE '0142'.
   530     12  ER-0148                 PIC X(4)  VALUE '0148'.
   531     12  ER-0215                 PIC X(4)  VALUE '0215'.
   532     12  ER-0280                 PIC X(4)  VALUE '0280'.
   533     12  ER-0348                 PIC X(4)  VALUE '0348'.
   534     12  ER-0419                 PIC X(4)  VALUE '0419'.
   535     12  ER-0894                 PIC X(4)  VALUE '0894'.
   536     12  ER-1101                 PIC X(4)  VALUE '1101'.
   537     12  ER-1236                 PIC X(4)  VALUE '1236'.
   538     12  ER-1560                 PIC X(4)  VALUE '1560'.
   539     12  ER-1818                 PIC X(4)  VALUE '1818'.
   540     12  ER-1820                 PIC X(4)  VALUE '1820'.
   541     12  ER-2056                 PIC X(4)  VALUE '2056'.
   542     12  ER-2079                 PIC X(4)  VALUE '2079'.
   543     12  ER-2208                 PIC X(4)  VALUE '2208'.
   544     12  ER-2209                 PIC X(4)  VALUE '2209'.
   545     12  ER-2237                 PIC X(4)  VALUE '2237'.
   546     12  ER-2238                 PIC X(4)  VALUE '2238'.
   547     12  ER-2253                 PIC X(4)  VALUE '2253'.
   548     12  ER-2619                 PIC X(4)  VALUE '2619'.
   549     12  ER-2651                 PIC X(4)  VALUE '2651'.
   550     12  ER-2784                 PIC X(4)  VALUE '2784'.
   551     12  ER-2785                 PIC X(4)  VALUE '2785'.
   552     12  ER-2786                 PIC X(4)  VALUE '2786'.
   553     12  ER-2791                 PIC X(4)  VALUE '2791'.
   554     12  ER-2845                 PIC X(4)  VALUE '2845'.
   555     12  ER-2848                 PIC X(4)  VALUE '2848'.
   556     12  ER-2851                 PIC X(4)  VALUE '2851'.
   557     12  ER-3829                 PIC X(4)  VALUE '3829'.
   558     12  ER-3830                 PIC X(4)  VALUE '3830'.
   559     12  ER-3833                 PIC X(4)  VALUE '3833'.
   560     12  ER-7638                 PIC X(4)  VALUE '7638'.
   561     12  ER-8888                 PIC X(4)  VALUE '8888'.
   562     12  ER-9999                 PIC X(4)  VALUE '9999'.
   563*    COPY ELCDATE.
   564******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  12
* EL6316.cbl
   565*                                                                *
   566*                                                                *
   567*                            ELCDATE.                            *
   568*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   569*                            VMOD=2.003
   570*                                                                *
   571*                                                                *
   572*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   573*                 LENGTH = 200                                   *
   574******************************************************************
   575
   576 01  DATE-CONVERSION-DATA.
   577     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   578     12  DC-OPTION-CODE                PIC X.
   579         88  BIN-TO-GREG                VALUE ' '.
   580         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   581         88  EDIT-GREG-TO-BIN           VALUE '2'.
   582         88  YMD-GREG-TO-BIN            VALUE '3'.
   583         88  MDY-GREG-TO-BIN            VALUE '4'.
   584         88  JULIAN-TO-BIN              VALUE '5'.
   585         88  BIN-PLUS-ELAPSED           VALUE '6'.
   586         88  FIND-CENTURY               VALUE '7'.
   587         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   588         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   589         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   590         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   591         88  JULIAN-TO-BIN-3            VALUE 'C'.
   592         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   593         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   594         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   595         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   596         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   597         88  CHECK-LEAP-YEAR            VALUE 'H'.
   598         88  BIN-3-TO-GREG              VALUE 'I'.
   599         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   600         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   601         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   602         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   603         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   604         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   605         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   606         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   607         88  THREE-CHARACTER-BIN
   608                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   609         88  GREGORIAN-TO-BIN
   610                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   611         88  BIN-TO-GREGORIAN
   612                  VALUES ' ' '1' 'I' '8' 'G'.
   613         88  JULIAN-TO-BINARY
   614                  VALUES '5' 'C' 'E' 'F'.
   615     12  DC-ERROR-CODE                 PIC X.
   616         88  NO-CONVERSION-ERROR        VALUE ' '.
   617         88  DATE-CONVERSION-ERROR
   618                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   619         88  DATE-IS-ZERO               VALUE '1'.
   620         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   621         88  DATE-IS-INVALID            VALUE '3'.
   622         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  13
* EL6316.cbl
   623         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   624         88  DATE-INVALID-OPTION        VALUE '9'.
   625         88  INVALID-CENTURY            VALUE 'A'.
   626         88  ONLY-CENTURY               VALUE 'B'.
   627         88  ONLY-LEAP-YEAR             VALUE 'C'.
   628         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   629     12  DC-END-OF-MONTH               PIC X.
   630         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   631     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   632         88  USE-NORMAL-PROCESS         VALUE ' '.
   633         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   634         88  ADJUST-UP-100-YRS          VALUE '2'.
   635     12  FILLER                        PIC X.
   636     12  DC-CONVERSION-DATES.
   637         16  DC-BIN-DATE-1             PIC XX.
   638         16  DC-BIN-DATE-2             PIC XX.
   639         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   640         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   641                       DC-GREG-DATE-1-EDIT.
   642             20  DC-EDIT1-MONTH        PIC 99.
   643             20  SLASH1-1              PIC X.
   644             20  DC-EDIT1-DAY          PIC 99.
   645             20  SLASH1-2              PIC X.
   646             20  DC-EDIT1-YEAR         PIC 99.
   647         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   648         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   649                     DC-GREG-DATE-2-EDIT.
   650             20  DC-EDIT2-MONTH        PIC 99.
   651             20  SLASH2-1              PIC X.
   652             20  DC-EDIT2-DAY          PIC 99.
   653             20  SLASH2-2              PIC X.
   654             20  DC-EDIT2-YEAR         PIC 99.
   655         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   656         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   657                     DC-GREG-DATE-1-YMD.
   658             20  DC-YMD-YEAR           PIC 99.
   659             20  DC-YMD-MONTH          PIC 99.
   660             20  DC-YMD-DAY            PIC 99.
   661         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   662         16  DC-GREG-DATE-1-MDY-R REDEFINES
   663                      DC-GREG-DATE-1-MDY.
   664             20  DC-MDY-MONTH          PIC 99.
   665             20  DC-MDY-DAY            PIC 99.
   666             20  DC-MDY-YEAR           PIC 99.
   667         16  DC-GREG-DATE-1-ALPHA.
   668             20  DC-ALPHA-MONTH        PIC X(10).
   669             20  DC-ALPHA-DAY          PIC 99.
   670             20  FILLER                PIC XX.
   671             20  DC-ALPHA-CENTURY.
   672                 24 DC-ALPHA-CEN-N     PIC 99.
   673             20  DC-ALPHA-YEAR         PIC 99.
   674         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   675         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   676         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   677         16  DC-JULIAN-DATE            PIC 9(05).
   678         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   679                                       PIC 9(05).
   680         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  14
* EL6316.cbl
   681             20  DC-JULIAN-YEAR        PIC 99.
   682             20  DC-JULIAN-DAYS        PIC 999.
   683         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   684         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   685         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   686     12  DATE-CONVERSION-VARIBLES.
   687         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   688         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   689             20  FILLER                PIC 9(3).
   690             20  HOLD-CEN-1-CCYY.
   691                 24  HOLD-CEN-1-CC     PIC 99.
   692                 24  HOLD-CEN-1-YY     PIC 99.
   693             20  HOLD-CEN-1-MO         PIC 99.
   694             20  HOLD-CEN-1-DA         PIC 99.
   695         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   696             20  HOLD-CEN-1-R-MO       PIC 99.
   697             20  HOLD-CEN-1-R-DA       PIC 99.
   698             20  HOLD-CEN-1-R-CCYY.
   699                 24  HOLD-CEN-1-R-CC   PIC 99.
   700                 24  HOLD-CEN-1-R-YY   PIC 99.
   701             20  FILLER                PIC 9(3).
   702         16  HOLD-CENTURY-1-X.
   703             20  FILLER                PIC X(3)  VALUE SPACES.
   704             20  HOLD-CEN-1-X-CCYY.
   705                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   706                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   707             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   708             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   709         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   710             20  HOLD-CEN-1-R-X-MO     PIC XX.
   711             20  HOLD-CEN-1-R-X-DA     PIC XX.
   712             20  HOLD-CEN-1-R-X-CCYY.
   713                 24  HOLD-CEN-1-R-X-CC PIC XX.
   714                 24  HOLD-CEN-1-R-X-YY PIC XX.
   715             20  FILLER                PIC XXX.
   716         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   717         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   718         16  DC-JULIAN-DATE-1          PIC 9(07).
   719         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   720             20  DC-JULIAN-1-CCYY.
   721                 24  DC-JULIAN-1-CC    PIC 99.
   722                 24  DC-JULIAN-1-YR    PIC 99.
   723             20  DC-JULIAN-DA-1        PIC 999.
   724         16  DC-JULIAN-DATE-2          PIC 9(07).
   725         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   726             20  DC-JULIAN-2-CCYY.
   727                 24  DC-JULIAN-2-CC    PIC 99.
   728                 24  DC-JULIAN-2-YR    PIC 99.
   729             20  DC-JULIAN-DA-2        PIC 999.
   730         16  DC-GREG-DATE-A-EDIT.
   731             20  DC-EDITA-MONTH        PIC 99.
   732             20  SLASHA-1              PIC X VALUE '/'.
   733             20  DC-EDITA-DAY          PIC 99.
   734             20  SLASHA-2              PIC X VALUE '/'.
   735             20  DC-EDITA-CCYY.
   736                 24  DC-EDITA-CENT     PIC 99.
   737                 24  DC-EDITA-YEAR     PIC 99.
   738         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  15
* EL6316.cbl
   739             20  DC-EDITB-MONTH        PIC 99.
   740             20  SLASHB-1              PIC X VALUE '/'.
   741             20  DC-EDITB-DAY          PIC 99.
   742             20  SLASHB-2              PIC X VALUE '/'.
   743             20  DC-EDITB-CCYY.
   744                 24  DC-EDITB-CENT     PIC 99.
   745                 24  DC-EDITB-YEAR     PIC 99.
   746         16  DC-GREG-DATE-CYMD         PIC 9(08).
   747         16  DC-GREG-DATE-CYMD-R REDEFINES
   748                              DC-GREG-DATE-CYMD.
   749             20  DC-CYMD-CEN           PIC 99.
   750             20  DC-CYMD-YEAR          PIC 99.
   751             20  DC-CYMD-MONTH         PIC 99.
   752             20  DC-CYMD-DAY           PIC 99.
   753         16  DC-GREG-DATE-MDCY         PIC 9(08).
   754         16  DC-GREG-DATE-MDCY-R REDEFINES
   755                              DC-GREG-DATE-MDCY.
   756             20  DC-MDCY-MONTH         PIC 99.
   757             20  DC-MDCY-DAY           PIC 99.
   758             20  DC-MDCY-CEN           PIC 99.
   759             20  DC-MDCY-YEAR          PIC 99.
   760    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   761        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   762    12  DC-EL310-DATE                  PIC X(21).
   763    12  FILLER                         PIC X(28).
   764*    COPY ELCLOGOF.
   765******************************************************************
   766*                                                                *
   767*                                                                *
   768*                            ELCLOGOF.                           *
   769*                            VMOD=2.001                          *
   770*                                                                *
   771*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   772*                                                                *
   773******************************************************************
   774 01  CLASIC-LOGOFF.
   775     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   776     12  LOGOFF-TEXT.
   777         16  FILLER          PIC X(5)    VALUE SPACES.
   778         16  LOGOFF-MSG.
   779             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   780             20  FILLER      PIC X       VALUE SPACES.
   781             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   782         16  FILLER          PIC X(80)
   783           VALUE '* YOU ARE NOW LOGGED OFF'.
   784         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   785         16  FILLER          PIC X       VALUE QUOTE.
   786         16  LOGOFF-SYS-MSG  PIC X(17)
   787           VALUE 'S CLAS-IC SYSTEM '.
   788     12  TEXT-MESSAGES.
   789         16  UNACCESS-MSG    PIC X(29)
   790             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   791         16  PGMIDERR-MSG    PIC X(17)
   792             VALUE 'PROGRAM NOT FOUND'.
   793*    COPY ELCATTR.
   794******************************************************************
   795*                                                                *
   796*                            ELCATTR.                            *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  16
* EL6316.cbl
   797*                            VMOD=2.001                          *
   798*                                                                *
   799*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   800*                                                                *
   801*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   802*                                                                *
   803*                   POS 1   P=PROTECTED                          *
   804*                           U=UNPROTECTED                        *
   805*                           S=ASKIP                              *
   806*                   POS 2   A=ALPHA/NUMERIC                      *
   807*                           N=NUMERIC                            *
   808*                   POS 3   N=NORMAL                             *
   809*                           B=BRIGHT                             *
   810*                           D=DARK                               *
   811*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   812*                           OF=MODIFIED DATA TAG OFF             *
   813*                                                                *
   814*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   815******************************************************************
   816 01  ATTRIBUTE-LIST.
   817     12  AL-PABOF            PIC X       VALUE 'Y'.
   818     12  AL-PABON            PIC X       VALUE 'Z'.
   819     12  AL-PADOF            PIC X       VALUE '%'.
   820     12  AL-PADON            PIC X       VALUE '_'.
   821     12  AL-PANOF            PIC X       VALUE '-'.
   822     12  AL-PANON            PIC X       VALUE '/'.
   823     12  AL-SABOF            PIC X       VALUE '8'.
   824     12  AL-SABON            PIC X       VALUE '9'.
   825     12  AL-SADOF            PIC X       VALUE '@'.
   826     12  AL-SADON            PIC X       VALUE QUOTE.
   827     12  AL-SANOF            PIC X       VALUE '0'.
   828     12  AL-SANON            PIC X       VALUE '1'.
   829     12  AL-UABOF            PIC X       VALUE 'H'.
   830     12  AL-UABON            PIC X       VALUE 'I'.
   831     12  AL-UADOF            PIC X       VALUE '<'.
   832     12  AL-UADON            PIC X       VALUE '('.
   833     12  AL-UANOF            PIC X       VALUE ' '.
   834     12  AL-UANON            PIC X       VALUE 'A'.
   835     12  AL-UNBOF            PIC X       VALUE 'Q'.
   836     12  AL-UNBON            PIC X       VALUE 'R'.
   837     12  AL-UNDOF            PIC X       VALUE '*'.
   838     12  AL-UNDON            PIC X       VALUE ')'.
   839     12  AL-UNNOF            PIC X       VALUE '&'.
   840     12  AL-UNNON            PIC X       VALUE 'J'.
   841*    COPY ELCEMIB.
   842******************************************************************
   843*                                                                *
   844*                                                                *
   845*                            ELCEMIB.                            *
   846*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   847*                            VMOD=2.005                          *
   848*                                                                *
   849*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   850*                                                                *
   851******************************************************************
   852 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   853     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   854     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  17
* EL6316.cbl
   855     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   856     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   857     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   858     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   859     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   860     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   861     12  EMI-SWITCH1             PIC X        VALUE '1'.
   862         88  EMI-NO-ERRORS                    VALUE '1'.
   863         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   864         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   865     12  EMI-SWITCH2             PIC X        VALUE '1'.
   866         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   867     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   868         88  EMI-AREA1-EMPTY                  VALUE '1'.
   869         88  EMI-AREA1-FULL                   VALUE '2'.
   870     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   871         88  EMI-AREA2-EMPTY                  VALUE '1'.
   872         88  EMI-AREA2-FULL                   VALUE '2'.
   873     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   874         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   875         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   876         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   877         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   878         88  EMI-BYPASS-FATALS                VALUE 'X'.
   879     12  EMI-ERROR-LINES.
   880         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   881         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   882         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   883         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   884             20  EMI-ERR-CODES OCCURS 10 TIMES.
   885                 24  EMI-ERR-NUM         PIC X(4).
   886                 24  EMI-FILLER          PIC X.
   887                 24  EMI-SEV             PIC X.
   888                 24  FILLER              PIC X.
   889             20  FILLER                  PIC X(02).
   890     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   891         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   892             20  EMI-ERROR-NUMBER    PIC X(4).
   893             20  EMI-FILL            PIC X.
   894             20  EMI-SEVERITY        PIC X.
   895             20  FILLER              PIC X.
   896             20  EMI-ERROR-TEXT.
   897                 24  EMI-TEXT-VARIABLE   PIC X(10).
   898                 24  FILLER          PIC X(55).
   899     12  EMI-SEVERITY-SAVE           PIC X.
   900         88  EMI-NOTE                    VALUE 'N'.
   901         88  EMI-WARNING                 VALUE 'W'.
   902         88  EMI-FORCABLE                VALUE 'F'.
   903         88  EMI-FATAL                   VALUE 'X'.
   904     12  EMI-MESSAGE-FLAG            PIC X.
   905         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   906         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   907     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   908     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   909         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   910         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   911         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   912     12  emi-claim-no                pic x(7).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  18
* EL6316.cbl
   913     12  emi-claim-type              pic x(6).
   914     12  FILLER                      PIC X(124)  VALUE SPACES.
   915     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   916     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   917     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   918     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   919*    COPY ELCTEXT.
   920******************************************************************
   921*                                                                *
   922*                                                                *
   923*                            ELCTEXT.                            *
   924*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   925*                            VMOD=2.008                          *
   926*                                                                *
   927*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   928*                                     FORM LETTERS,              *
   929*                                     CERT FORM DISPLAY.
   930*                                                                *
   931*   FILE TYPE = VSAM,KSDS                                        *
   932*   RECORD SIZE = 100   RECFORM = FIXED                          *
   933*                                                                *
   934*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   935*       ALTERNATE INDEX = NONE                                   *
   936*                                                                *
   937*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   938*       ALTERNATE INDEX = NONE                                   *
   939*                                                                *
   940*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   941*       ALTERNATE INDEX = NONE                                   *
   942*                                                                *
   943*   LOG = NO                                                     *
   944*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   945******************************************************************
   946 01  TEXT-FILES.
   947     12  TEXT-FILE-ID                PIC XX.
   948         88  FORMS-FILE-TEXT            VALUE 'TF'.
   949         88  LETTER-FILE-TEXT           VALUE 'TL'.
   950         88  HELP-FILE-TEXT             VALUE 'TH'.
   951
   952     12  TX-CONTROL-PRIMARY.
   953         16  TX-COMPANY-CD           PIC X.
   954             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   955         16  TX-ACCESS-CD-GENL       PIC X(12).
   956
   957         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   958             20  TX-LETTER-NO        PIC X(4).
   959             20  FILLER              PIC X(8).
   960
   961         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   962             20  TX-FORM-NO          PIC X(12).
   963
   964         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   965             20  TX-HELP-TYPE        PIC X.
   966                 88  HELP-FOR-GENERAL   VALUE ' '.
   967                 88  HELP-BY-SCREEN     VALUE 'S'.
   968                 88  HELP-BY-ERROR      VALUE 'E'.
   969             20  TX-SCREEN-OR-ERROR  PIC X(4).
   970                 88  GENERAL-INFO-HELP  VALUE '0000'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  19
* EL6316.cbl
   971             20  TX-HELP-FOR-COMPANY  PIC XXX.
   972                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   973             20  FILLER              PIC X(4).
   974
   975         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   976
   977     12  TX-PROCESS-CONTROL          PIC XX.
   978         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   979
   980     12  TX-TEXT-LINE                PIC X(70).
   981
   982     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   983         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   984         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   985         88  TX-VALID-FORM-SQUEEZE-VALUE
   986                                        VALUE 'Y' ' '.
   987
   988     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   989         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   990         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   991         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   992         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   993         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   994         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   995         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   996                                              'K' 'N' ' '
   997                                              'Z'.
   998
   999     12  TX-ARCHIVE-SW               PIC X.
  1000         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1001         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1002         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1003
  1004     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1005     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1006
  1007     12  TX-BSR-CODE                 PIC X.
  1008         88  TX-BSR-LETTER              VALUE 'B'.
  1009         88  TX-NON-BSR-LETTER          VALUE ' '.
  1010
  1011     12  FILLER                      PIC X.
  1012*****************************************************************
  1013*    COPY ELCINTF.
  1014******************************************************************
  1015*                                                                *
  1016*                                                                *
  1017*                            ELCINTF.                            *
  1018*                            VMOD=2.017                          *
  1019*                                                                *
  1020*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1021*                                                                *
  1022*       LENGTH = 1024                                            *
  1023*                                                                *
  1024******************************************************************
  1025*                   C H A N G E   L O G
  1026*
  1027* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1028*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  20
* EL6316.cbl
  1029*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1030* EFFECTIVE    NUMBER
  1031*-----------------------------------------------------------------
  1032* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1033******************************************************************
  1034 01  PROGRAM-INTERFACE-BLOCK.
  1035     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1036     12  PI-CALLING-PROGRAM              PIC X(8).
  1037     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1038     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1039     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1040     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1041     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1042     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1043     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1044     12  PI-COMPANY-ID                   PIC XXX.
  1045     12  PI-COMPANY-CD                   PIC X.
  1046
  1047     12  PI-COMPANY-PASSWORD             PIC X(8).
  1048
  1049     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1050
  1051     12  PI-CONTROL-IN-PROGRESS.
  1052         16  PI-CARRIER                  PIC X.
  1053         16  PI-GROUPING                 PIC X(6).
  1054         16  PI-STATE                    PIC XX.
  1055         16  PI-ACCOUNT                  PIC X(10).
  1056         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1057                                         PIC X(10).
  1058         16  PI-CLAIM-CERT-GRP.
  1059             20  PI-CLAIM-NO             PIC X(7).
  1060             20  PI-CERT-NO.
  1061                 25  PI-CERT-PRIME       PIC X(10).
  1062                 25  PI-CERT-SFX         PIC X.
  1063             20  PI-CERT-EFF-DT          PIC XX.
  1064         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1065             20  PI-PLAN-CODE            PIC X(2).
  1066             20  PI-REVISION-NUMBER      PIC X(3).
  1067             20  PI-PLAN-EFF-DT          PIC X(2).
  1068             20  PI-PLAN-EXP-DT          PIC X(2).
  1069             20  FILLER                  PIC X(11).
  1070         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1071             20  PI-OE-REFERENCE-1.
  1072                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1073                 25  PI-OE-REF-1-SUFF    PIC XX.
  1074
  1075     12  PI-SESSION-IN-PROGRESS          PIC X.
  1076         88  CLAIM-SESSION                   VALUE '1'.
  1077         88  CREDIT-SESSION                  VALUE '2'.
  1078         88  WARRANTY-SESSION                VALUE '3'.
  1079         88  MORTGAGE-SESSION                VALUE '4'.
  1080         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1081
  1082
  1083*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1084
  1085     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1086     12  PI-ORIGINAL-COMPANY-CD          PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  21
* EL6316.cbl
  1087
  1088     12  PI-CREDIT-USER                  PIC X.
  1089         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1090         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1091
  1092     12  PI-CLAIM-USER                   PIC X.
  1093         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1094         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1095
  1096     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1097         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1098         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1099         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1100         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1101         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1102
  1103     12  PI-PROCESSOR-ID                 PIC X(4).
  1104
  1105     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1106
  1107     12  PI-MEMBER-CAPTION               PIC X(10).
  1108
  1109     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1110         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1111
  1112     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1113     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1114     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1115     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1116
  1117     12  PI-AH-OVERRIDE-L1               PIC X.
  1118     12  PI-AH-OVERRIDE-L2               PIC XX.
  1119     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1120     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1121
  1122     12  PI-NEW-SYSTEM                   PIC X(2).
  1123
  1124     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1125     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1126         88  PI-USES-PAID-TO                 VALUE '1'.
  1127     12  PI-CRDTCRD-SYSTEM.
  1128         16  PI-CRDTCRD-USER             PIC X.
  1129             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1130             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1131         16  PI-CC-MONTH-END-DT          PIC XX.
  1132     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1133
  1134     12  PI-OE-REFERENCE-2.
  1135         16  PI-OE-REF-2-PRIME           PIC X(10).
  1136         16  PI-OE-REF-2-SUFF            PIC X.
  1137
  1138     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1139
  1140     12  PI-LANGUAGE-TYPE                PIC X.
  1141             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1142             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1143             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1144
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  22
* EL6316.cbl
  1145     12  PI-POLICY-LINKAGE-IND           PIC X.
  1146         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1147         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1148                                                   LOW-VALUES.
  1149
  1150     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1151     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1152         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1153         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1154
  1155     12  PI-PROCESSOR-CSR-IND            PIC X.
  1156         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1157         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1158
  1159     12  FILLER                          PIC X(3).
  1160
  1161     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1162
  1163     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1164         PI-SYSTEM-LEVEL.
  1165
  1166         16  PI-ENTRY-CODES.
  1167             20  PI-ENTRY-CD-1           PIC X.
  1168             20  PI-ENTRY-CD-2           PIC X.
  1169
  1170         16  PI-RETURN-CODES.
  1171             20  PI-RETURN-CD-1          PIC X.
  1172             20  PI-RETURN-CD-2          PIC X.
  1173
  1174         16  PI-UPDATE-STATUS-SAVE.
  1175             20  PI-UPDATE-BY            PIC X(4).
  1176             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1177
  1178         16  PI-LOWER-CASE-LETTERS       PIC X.
  1179             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1180
  1181*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1182*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1183*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1184
  1185         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1186             88  ST-ACCNT-CNTL               VALUE ' '.
  1187             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1188             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1189             88  ACCNT-CNTL                  VALUE '3'.
  1190             88  CARR-ACCNT-CNTL             VALUE '4'.
  1191
  1192         16  PI-PROCESSOR-CAP-LIST.
  1193             20  PI-SYSTEM-CONTROLS.
  1194                24 PI-SYSTEM-DISPLAY     PIC X.
  1195                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1196                24 PI-SYSTEM-MODIFY      PIC X.
  1197                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1198             20  FILLER                  PIC XX.
  1199             20  PI-DISPLAY-CAP          PIC X.
  1200                 88  DISPLAY-CAP             VALUE 'Y'.
  1201             20  PI-MODIFY-CAP           PIC X.
  1202                 88  MODIFY-CAP              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  23
* EL6316.cbl
  1203             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1204                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1205             20  PI-FORCE-CAP            PIC X.
  1206                 88  FORCE-CAP               VALUE 'Y'.
  1207
  1208         16  PI-PROGRAM-CONTROLS.
  1209             20  PI-PGM-PRINT-OPT        PIC X.
  1210             20  PI-PGM-FORMAT-OPT       PIC X.
  1211             20  PI-PGM-PROCESS-OPT      PIC X.
  1212             20  PI-PGM-TOTALS-OPT       PIC X.
  1213
  1214         16  PI-HELP-INTERFACE.
  1215             20  PI-LAST-ERROR-NO        PIC X(4).
  1216             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1217
  1218         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1219             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1220
  1221         16  PI-CR-CONTROL-IN-PROGRESS.
  1222             20  PI-CR-CARRIER           PIC X.
  1223             20  PI-CR-GROUPING          PIC X(6).
  1224             20  PI-CR-STATE             PIC XX.
  1225             20  PI-CR-ACCOUNT           PIC X(10).
  1226             20  PI-CR-FIN-RESP          PIC X(10).
  1227             20  PI-CR-TYPE              PIC X.
  1228
  1229         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1230
  1231         16  PI-CR-MONTH-END-DT          PIC XX.
  1232
  1233         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1234             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1235             88  PI-ZERO-CARRIER             VALUE '1'.
  1236             88  PI-ZERO-GROUPING            VALUE '2'.
  1237             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1238
  1239         16  PI-CARRIER-SECURITY         PIC X.
  1240             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1241
  1242         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1243             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1244             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1245
  1246         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1247             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1248                                         INDEXED BY PI-ACCESS-NDX
  1249                                         PIC X.
  1250
  1251         16  PI-GA-BILLING-CONTROL       PIC X.
  1252             88  PI-GA-BILLING               VALUE '1'.
  1253
  1254         16  PI-MAIL-PROCESSING          PIC X.
  1255             88  PI-MAIL-YES                 VALUE 'Y'.
  1256
  1257         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1258
  1259         16  PI-AR-SYSTEM.
  1260             20  PI-AR-PROCESSING-CNTL   PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  24
* EL6316.cbl
  1261                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1262             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1263             20  PI-AR-MONTH-END-DT      PIC XX.
  1264
  1265         16  PI-MP-SYSTEM.
  1266             20  PI-MORTGAGE-USER            PIC X.
  1267                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1268                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1269             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1270                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1271                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1272                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1273                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1274                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1275             20  PI-MP-MONTH-END-DT          PIC XX.
  1276             20  PI-MP-REFERENCE-NO.
  1277                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1278                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1279
  1280         16  PI-LABEL-CONTROL            PIC X(01).
  1281             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1282             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1283
  1284         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1285             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1286
  1287         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1288             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1289             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1290
  1291         16  FILLER                      PIC X(14).
  1292
  1293     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1294******************************************************************
  1295     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1296        16  PI-ISS-CAN-SW           PIC X.
  1297        16  PI-ERENDT-KEY.
  1298            20  PI-ENDT-COMPANY-CD  PIC X.
  1299            20  PI-ENDT-CARRIER     PIC X.
  1300            20  PI-ENDT-GROUPING    PIC X(6).
  1301            20  PI-ENDT-STATE       PIC XX.
  1302            20  PI-ENDT-ACCOUNT     PIC X(10).
  1303            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1304            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1305            20  PI-ENDT-CERT-SFX    PIC X.
  1306            20  PI-ENDT-RECORD-TYPE PIC X.
  1307            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1308        16  PI-ELCRTO-KEY.
  1309            20  PI-CRTO-COMPANY-CD  PIC X.
  1310            20  PI-CRTO-CARRIER     PIC X.
  1311            20  PI-CRTO-GROUPING    PIC X(6).
  1312            20  PI-CRTO-STATE       PIC XX.
  1313            20  PI-CRTO-ACCOUNT     PIC X(10).
  1314            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1315            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1316            20  PI-CRTO-CERT-SFX    PIC X.
  1317            20  PI-CRTO-RECORD-TYPE PIC X.
  1318            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  25
* EL6316.cbl
  1319        16  PI-ERPNDB-KEY           PIC X(11).
  1320        16  PI-DOCUMENT-PROCESSED   PIC X.
  1321            88  PI-VERI-PROCESSED      VALUE 'V'.
  1322            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1323        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1324        16  PI-RES-REF-CLM-TYPE     PIC X.
  1325        16  PI-CLM-RESC-IND         PIC X.
  1326            88  PI-CLM-RESCISSION      VALUE 'Y'.
  1327        16  PI-CLEAR-ERROR-SW       PIC X.
  1328            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1329        16  PI-PRTSW-ENTERED        PIC X.
  1330        16  PI-LTRID-ENTERED        PIC X(4).
  1331        16  PI-REASONS-ENTERED      PIC X(84).
  1332        16  PI-CERTNT1-ENTERED      PIC X(63).
  1333        16  PI-CERTNT2-ENTERED      PIC X(63).
  1334        16  FILLER                  PIC X(20).
  1335        16  PI-FINALIZED-IND        PIC X.
  1336        16  PI-BILLNT1-ENTERED      PIC X(63).
  1337        16  PI-ENCCODE              PIC X(3).
  1338        16  PI-FROM-CERT            PIC X.
  1339        16  PI-ENDORSE-RECORD       PIC X.
  1340        16  FILLER                  PIC X(212).
  1341    12  FILLER                      PIC X(276).
  1342*    COPY ELCAID.
  1343******************************************************************
  1344*                                                                *
  1345*                            ELCAID.                             *
  1346*                            VMOD=2.001                          *
  1347*                                                                *
  1348*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1349*                                                                *
  1350*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1351*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1352******************************************************************
  1353
  1354 01  DFHAID.
  1355   02  DFHNULL   PIC  X  VALUE  ' '.
  1356   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1357   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1358   02  DFHPEN    PIC  X  VALUE  '='.
  1359   02  DFHOPID   PIC  X  VALUE  'W'.
  1360   02  DFHPA1    PIC  X  VALUE  '%'.
  1361   02  DFHPA2    PIC  X  VALUE  '>'.
  1362   02  DFHPA3    PIC  X  VALUE  ','.
  1363   02  DFHPF1    PIC  X  VALUE  '1'.
  1364   02  DFHPF2    PIC  X  VALUE  '2'.
  1365   02  DFHPF3    PIC  X  VALUE  '3'.
  1366   02  DFHPF4    PIC  X  VALUE  '4'.
  1367   02  DFHPF5    PIC  X  VALUE  '5'.
  1368   02  DFHPF6    PIC  X  VALUE  '6'.
  1369   02  DFHPF7    PIC  X  VALUE  '7'.
  1370   02  DFHPF8    PIC  X  VALUE  '8'.
  1371   02  DFHPF9    PIC  X  VALUE  '9'.
  1372   02  DFHPF10   PIC  X  VALUE  ':'.
  1373   02  DFHPF11   PIC  X  VALUE  '#'.
  1374   02  DFHPF12   PIC  X  VALUE  '@'.
  1375   02  DFHPF13   PIC  X  VALUE  'A'.
  1376   02  DFHPF14   PIC  X  VALUE  'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  26
* EL6316.cbl
  1377   02  DFHPF15   PIC  X  VALUE  'C'.
  1378   02  DFHPF16   PIC  X  VALUE  'D'.
  1379   02  DFHPF17   PIC  X  VALUE  'E'.
  1380   02  DFHPF18   PIC  X  VALUE  'F'.
  1381   02  DFHPF19   PIC  X  VALUE  'G'.
  1382   02  DFHPF20   PIC  X  VALUE  'H'.
  1383   02  DFHPF21   PIC  X  VALUE  'I'.
  1384*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1385   02  DFHPF22   PIC  X  VALUE  '['.
  1386   02  DFHPF23   PIC  X  VALUE  '.'.
  1387   02  DFHPF24   PIC  X  VALUE  '<'.
  1388   02  DFHMSRE   PIC  X  VALUE  'X'.
  1389   02  DFHSTRF   PIC  X  VALUE  'h'.
  1390   02  DFHTRIG   PIC  X  VALUE  '"'.
  1391 01  FILLER    REDEFINES DFHAID.
  1392     12  FILLER              PIC X(8).
  1393     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1394*   COPY EL6316S.
  1395 01  EL631II.
  1396     05  FILLER            PIC  X(0012).
  1397*    -------------------------------
  1398     05  DATEL PIC S9(0004) COMP.
  1399     05  DATEF PIC  X(0001).
  1400     05  FILLER REDEFINES DATEF.
  1401         10  DATEA PIC  X(0001).
  1402     05  DATEI PIC  X(0008).
  1403*    -------------------------------
  1404     05  TIMEL PIC S9(0004) COMP.
  1405     05  TIMEF PIC  X(0001).
  1406     05  FILLER REDEFINES TIMEF.
  1407         10  TIMEA PIC  X(0001).
  1408     05  TIMEI PIC  X(0005).
  1409*    -------------------------------
  1410     05  PROCIDL PIC S9(0004) COMP.
  1411     05  PROCIDF PIC  X(0001).
  1412     05  FILLER REDEFINES PROCIDF.
  1413         10  PROCIDA PIC  X(0001).
  1414     05  PROCIDI PIC  X(0004).
  1415*    -------------------------------
  1416     05  HOSTL PIC S9(0004) COMP.
  1417     05  HOSTF PIC  X(0001).
  1418     05  FILLER REDEFINES HOSTF.
  1419         10  HOSTA PIC  X(0001).
  1420     05  HOSTI PIC  X(0009).
  1421*    -------------------------------
  1422     05  SYSL PIC S9(0004) COMP.
  1423     05  SYSF PIC  X(0001).
  1424     05  FILLER REDEFINES SYSF.
  1425         10  SYSA PIC  X(0001).
  1426     05  SYSI PIC  X(0005).
  1427*    -------------------------------
  1428     05  COMPANYL PIC S9(0004) COMP.
  1429     05  COMPANYF PIC  X(0001).
  1430     05  FILLER REDEFINES COMPANYF.
  1431         10  COMPANYA PIC  X(0001).
  1432     05  COMPANYI PIC  X(0003).
  1433*    -------------------------------
  1434     05  DATASORL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  27
* EL6316.cbl
  1435     05  DATASORF PIC  X(0001).
  1436     05  FILLER REDEFINES DATASORF.
  1437         10  DATASORA PIC  X(0001).
  1438     05  DATASORI PIC  X(0001).
  1439*    -------------------------------
  1440     05  BATCHNOL PIC S9(0004) COMP.
  1441     05  BATCHNOF PIC  X(0001).
  1442     05  FILLER REDEFINES BATCHNOF.
  1443         10  BATCHNOA PIC  X(0001).
  1444     05  BATCHNOI PIC  X(0006).
  1445*    -------------------------------
  1446     05  BSEQNOL PIC S9(0004) COMP.
  1447     05  BSEQNOF PIC  X(0001).
  1448     05  FILLER REDEFINES BSEQNOF.
  1449         10  BSEQNOA PIC  X(0001).
  1450     05  BSEQNOI PIC  X(0008).
  1451*    -------------------------------
  1452     05  ARCHNOL PIC S9(0004) COMP.
  1453     05  ARCHNOF PIC  X(0001).
  1454     05  FILLER REDEFINES ARCHNOF.
  1455         10  ARCHNOA PIC  X(0001).
  1456     05  ARCHNOI PIC  X(0008).
  1457*    -------------------------------
  1458     05  PRTSWL PIC S9(0004) COMP.
  1459     05  PRTSWF PIC  X(0001).
  1460     05  FILLER REDEFINES PRTSWF.
  1461         10  PRTSWA PIC  X(0001).
  1462     05  PRTSWI PIC  X(0001).
  1463*    -------------------------------
  1464     05  CARRL PIC S9(0004) COMP.
  1465     05  CARRF PIC  X(0001).
  1466     05  FILLER REDEFINES CARRF.
  1467         10  CARRA PIC  X(0001).
  1468     05  CARRI PIC  X(0001).
  1469*    -------------------------------
  1470     05  GROUPL PIC S9(0004) COMP.
  1471     05  GROUPF PIC  X(0001).
  1472     05  FILLER REDEFINES GROUPF.
  1473         10  GROUPA PIC  X(0001).
  1474     05  GROUPI PIC  X(0006).
  1475*    -------------------------------
  1476     05  STATEL PIC S9(0004) COMP.
  1477     05  STATEF PIC  X(0001).
  1478     05  FILLER REDEFINES STATEF.
  1479         10  STATEA PIC  X(0001).
  1480     05  STATEI PIC  X(0002).
  1481*    -------------------------------
  1482     05  ACCTL PIC S9(0004) COMP.
  1483     05  ACCTF PIC  X(0001).
  1484     05  FILLER REDEFINES ACCTF.
  1485         10  ACCTA PIC  X(0001).
  1486     05  ACCTI PIC  X(0010).
  1487*    -------------------------------
  1488     05  EFFDTL PIC S9(0004) COMP.
  1489     05  EFFDTF PIC  X(0001).
  1490     05  FILLER REDEFINES EFFDTF.
  1491         10  EFFDTA PIC  X(0001).
  1492     05  EFFDTI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  28
* EL6316.cbl
  1493*    -------------------------------
  1494     05  CERTNOL PIC S9(0004) COMP.
  1495     05  CERTNOF PIC  X(0001).
  1496     05  FILLER REDEFINES CERTNOF.
  1497         10  CERTNOA PIC  X(0001).
  1498     05  CERTNOI PIC  X(0010).
  1499*    -------------------------------
  1500     05  CRTSFXL PIC S9(0004) COMP.
  1501     05  CRTSFXF PIC  X(0001).
  1502     05  FILLER REDEFINES CRTSFXF.
  1503         10  CRTSFXA PIC  X(0001).
  1504     05  CRTSFXI PIC  X(0001).
  1505*    -------------------------------
  1506     05  LTRIDL PIC S9(0004) COMP.
  1507     05  LTRIDF PIC  X(0001).
  1508     05  FILLER REDEFINES LTRIDF.
  1509         10  LTRIDA PIC  X(0001).
  1510     05  LTRIDI PIC  X(0004).
  1511*    -------------------------------
  1512     05  SEQNOL PIC S9(0004) COMP.
  1513     05  SEQNOF PIC  X(0001).
  1514     05  FILLER REDEFINES SEQNOF.
  1515         10  SEQNOA PIC  X(0001).
  1516     05  SEQNOI PIC  X(0006).
  1517*    -------------------------------
  1518     05  FNAMEL PIC S9(0004) COMP.
  1519     05  FNAMEF PIC  X(0001).
  1520     05  FILLER REDEFINES FNAMEF.
  1521         10  FNAMEA PIC  X(0001).
  1522     05  FNAMEI PIC  X(0010).
  1523*    -------------------------------
  1524     05  MINITL PIC S9(0004) COMP.
  1525     05  MINITF PIC  X(0001).
  1526     05  FILLER REDEFINES MINITF.
  1527         10  MINITA PIC  X(0001).
  1528     05  MINITI PIC  X(0001).
  1529*    -------------------------------
  1530     05  LNAMEL PIC S9(0004) COMP.
  1531     05  LNAMEF PIC  X(0001).
  1532     05  FILLER REDEFINES LNAMEF.
  1533         10  LNAMEA PIC  X(0001).
  1534     05  LNAMEI PIC  X(0015).
  1535*    -------------------------------
  1536     05  ENCCODEL PIC S9(0004) COMP.
  1537     05  ENCCODEF PIC  X(0001).
  1538     05  FILLER REDEFINES ENCCODEF.
  1539         10  ENCCODEA PIC  X(0001).
  1540     05  ENCCODEI PIC  X(0003).
  1541*    -------------------------------
  1542     05  OLFDTL PIC S9(0004) COMP.
  1543     05  OLFDTF PIC  X(0001).
  1544     05  FILLER REDEFINES OLFDTF.
  1545         10  OLFDTA PIC  X(0001).
  1546     05  OLFDTI PIC  X(0008).
  1547*    -------------------------------
  1548     05  OLFAMTL PIC S9(0004) COMP.
  1549     05  OLFAMTF PIC  X(0001).
  1550     05  FILLER REDEFINES OLFAMTF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  29
* EL6316.cbl
  1551         10  OLFAMTA PIC  X(0001).
  1552     05  OLFAMTI PIC  X(0010).
  1553*    -------------------------------
  1554     05  OAHDTL PIC S9(0004) COMP.
  1555     05  OAHDTF PIC  X(0001).
  1556     05  FILLER REDEFINES OAHDTF.
  1557         10  OAHDTA PIC  X(0001).
  1558     05  OAHDTI PIC  X(0008).
  1559*    -------------------------------
  1560     05  OAHAMTL PIC S9(0004) COMP.
  1561     05  OAHAMTF PIC  X(0001).
  1562     05  FILLER REDEFINES OAHAMTF.
  1563         10  OAHAMTA PIC  X(0001).
  1564     05  OAHAMTI PIC  X(0010).
  1565*    -------------------------------
  1566     05  NLFDTL PIC S9(0004) COMP.
  1567     05  NLFDTF PIC  X(0001).
  1568     05  FILLER REDEFINES NLFDTF.
  1569         10  NLFDTA PIC  X(0001).
  1570     05  NLFDTI PIC  X(0008).
  1571*    -------------------------------
  1572     05  NLFAMTL PIC S9(0004) COMP.
  1573     05  NLFAMTF PIC  X(0001).
  1574     05  FILLER REDEFINES NLFAMTF.
  1575         10  NLFAMTA PIC  X(0001).
  1576     05  NLFAMTI PIC  X(0010).
  1577*    -------------------------------
  1578     05  NAHDTL PIC S9(0004) COMP.
  1579     05  NAHDTF PIC  X(0001).
  1580     05  FILLER REDEFINES NAHDTF.
  1581         10  NAHDTA PIC  X(0001).
  1582     05  NAHDTI PIC  X(0008).
  1583*    -------------------------------
  1584     05  NAHAMTL PIC S9(0004) COMP.
  1585     05  NAHAMTF PIC  X(0001).
  1586     05  FILLER REDEFINES NAHAMTF.
  1587         10  NAHAMTA PIC  X(0001).
  1588     05  NAHAMTI PIC  X(0010).
  1589*    -------------------------------
  1590     05  INPDTL PIC S9(0004) COMP.
  1591     05  INPDTF PIC  X(0001).
  1592     05  FILLER REDEFINES INPDTF.
  1593         10  INPDTA PIC  X(0001).
  1594     05  INPDTI PIC  X(0008).
  1595*    -------------------------------
  1596     05  PROCDTL PIC S9(0004) COMP.
  1597     05  PROCDTF PIC  X(0001).
  1598     05  FILLER REDEFINES PROCDTF.
  1599         10  PROCDTA PIC  X(0001).
  1600     05  PROCDTI PIC  X(0008).
  1601*    -------------------------------
  1602     05  LFCOMML PIC S9(0004) COMP.
  1603     05  LFCOMMF PIC  X(0001).
  1604     05  FILLER REDEFINES LFCOMMF.
  1605         10  LFCOMMA PIC  X(0001).
  1606     05  LFCOMMI PIC  X(0006).
  1607*    -------------------------------
  1608     05  AHCOMML PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  30
* EL6316.cbl
  1609     05  AHCOMMF PIC  X(0001).
  1610     05  FILLER REDEFINES AHCOMMF.
  1611         10  AHCOMMA PIC  X(0001).
  1612     05  AHCOMMI PIC  X(0006).
  1613*    -------------------------------
  1614     05  RCD01L PIC S9(0004) COMP.
  1615     05  RCD01F PIC  X(0001).
  1616     05  FILLER REDEFINES RCD01F.
  1617         10  RCD01A PIC  X(0001).
  1618     05  RCD01I PIC  X(0004).
  1619*    -------------------------------
  1620     05  RCD02L PIC S9(0004) COMP.
  1621     05  RCD02F PIC  X(0001).
  1622     05  FILLER REDEFINES RCD02F.
  1623         10  RCD02A PIC  X(0001).
  1624     05  RCD02I PIC  X(0004).
  1625*    -------------------------------
  1626     05  RCD03L PIC S9(0004) COMP.
  1627     05  RCD03F PIC  X(0001).
  1628     05  FILLER REDEFINES RCD03F.
  1629         10  RCD03A PIC  X(0001).
  1630     05  RCD03I PIC  X(0004).
  1631*    -------------------------------
  1632     05  RCD04L PIC S9(0004) COMP.
  1633     05  RCD04F PIC  X(0001).
  1634     05  FILLER REDEFINES RCD04F.
  1635         10  RCD04A PIC  X(0001).
  1636     05  RCD04I PIC  X(0004).
  1637*    -------------------------------
  1638     05  RCD05L PIC S9(0004) COMP.
  1639     05  RCD05F PIC  X(0001).
  1640     05  FILLER REDEFINES RCD05F.
  1641         10  RCD05A PIC  X(0001).
  1642     05  RCD05I PIC  X(0004).
  1643*    -------------------------------
  1644     05  RCD06L PIC S9(0004) COMP.
  1645     05  RCD06F PIC  X(0001).
  1646     05  FILLER REDEFINES RCD06F.
  1647         10  RCD06A PIC  X(0001).
  1648     05  RCD06I PIC  X(0004).
  1649*    -------------------------------
  1650     05  RCD07L PIC S9(0004) COMP.
  1651     05  RCD07F PIC  X(0001).
  1652     05  FILLER REDEFINES RCD07F.
  1653         10  RCD07A PIC  X(0001).
  1654     05  RCD07I PIC  X(0004).
  1655*    -------------------------------
  1656     05  RCD08L PIC S9(0004) COMP.
  1657     05  RCD08F PIC  X(0001).
  1658     05  FILLER REDEFINES RCD08F.
  1659         10  RCD08A PIC  X(0001).
  1660     05  RCD08I PIC  X(0004).
  1661*    -------------------------------
  1662     05  RCD09L PIC S9(0004) COMP.
  1663     05  RCD09F PIC  X(0001).
  1664     05  FILLER REDEFINES RCD09F.
  1665         10  RCD09A PIC  X(0001).
  1666     05  RCD09I PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  31
* EL6316.cbl
  1667*    -------------------------------
  1668     05  RCD10L PIC S9(0004) COMP.
  1669     05  RCD10F PIC  X(0001).
  1670     05  FILLER REDEFINES RCD10F.
  1671         10  RCD10A PIC  X(0001).
  1672     05  RCD10I PIC  X(0004).
  1673*    -------------------------------
  1674     05  RCD11L PIC S9(0004) COMP.
  1675     05  RCD11F PIC  X(0001).
  1676     05  FILLER REDEFINES RCD11F.
  1677         10  RCD11A PIC  X(0001).
  1678     05  RCD11I PIC  X(0004).
  1679*    -------------------------------
  1680     05  RCD12L PIC S9(0004) COMP.
  1681     05  RCD12F PIC  X(0001).
  1682     05  FILLER REDEFINES RCD12F.
  1683         10  RCD12A PIC  X(0001).
  1684     05  RCD12I PIC  X(0004).
  1685*    -------------------------------
  1686     05  CRTNT1L PIC S9(0004) COMP.
  1687     05  CRTNT1F PIC  X(0001).
  1688     05  FILLER REDEFINES CRTNT1F.
  1689         10  CRTNT1A PIC  X(0001).
  1690     05  CRTNT1I PIC  X(0063).
  1691*    -------------------------------
  1692     05  CRTNT2L PIC S9(0004) COMP.
  1693     05  CRTNT2F PIC  X(0001).
  1694     05  FILLER REDEFINES CRTNT2F.
  1695         10  CRTNT2A PIC  X(0001).
  1696     05  CRTNT2I PIC  X(0063).
  1697*    -------------------------------
  1698     05  BILNT1L PIC S9(0004) COMP.
  1699     05  BILNT1F PIC  X(0001).
  1700     05  FILLER REDEFINES BILNT1F.
  1701         10  BILNT1A PIC  X(0001).
  1702     05  BILNT1I PIC  X(0063).
  1703*    -------------------------------
  1704     05  ERRMSGL PIC S9(0004) COMP.
  1705     05  ERRMSGF PIC  X(0001).
  1706     05  FILLER REDEFINES ERRMSGF.
  1707         10  ERRMSGA PIC  X(0001).
  1708     05  ERRMSGI PIC  X(0075).
  1709*    -------------------------------
  1710     05  PFENTRL PIC S9(0004) COMP.
  1711     05  PFENTRF PIC  X(0001).
  1712     05  FILLER REDEFINES PFENTRF.
  1713         10  PFENTRA PIC  X(0001).
  1714     05  PFENTRI PIC  9(2).
  1715*    -------------------------------
  1716     05  PF3L PIC S9(0004) COMP.
  1717     05  PF3F PIC  X(0001).
  1718     05  FILLER REDEFINES PF3F.
  1719         10  PF3A PIC  X(0001).
  1720     05  PF3I PIC  X(0019).
  1721*    -------------------------------
  1722     05  PF4L PIC S9(0004) COMP.
  1723     05  PF4F PIC  X(0001).
  1724     05  FILLER REDEFINES PF4F.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  32
* EL6316.cbl
  1725         10  PF4A PIC  X(0001).
  1726     05  PF4I PIC  X(0019).
  1727 01  EL631IO REDEFINES EL631II.
  1728     05  FILLER            PIC  X(0012).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  DATEO PIC  X(0008).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  TIMEO PIC  99.99.
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  PROCIDO PIC  X(0004).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  HOSTO PIC  X(0009).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  SYSO PIC  X(0005).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  COMPANYO PIC  X(0003).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  DATASORO PIC  X(0001).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  BATCHNOO PIC  X(0006).
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  BSEQNOO PIC  X(0008).
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  ARCHNOO PIC  X(0008).
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  PRTSWO PIC  X(0001).
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  CARRO PIC  X(0001).
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  GROUPO PIC  X(0006).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  STATEO PIC  X(0002).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  ACCTO PIC  X(0010).
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  EFFDTO PIC  X(0008).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  CERTNOO PIC  X(0010).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  CRTSFXO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  33
* EL6316.cbl
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  LTRIDO PIC  X(0004).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  SEQNOO PIC  999999.
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  FNAMEO PIC  X(0010).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  MINITO PIC  X(0001).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  LNAMEO PIC  X(0015).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  ENCCODEO PIC  X(0003).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  OLFDTO PIC  X(0008).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  OLFAMTO PIC  ZZZZ999.99.
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  OAHDTO PIC  X(0008).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  OAHAMTO PIC  ZZZZ999.99.
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  NLFDTO PIC  X(0008).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  NLFAMTO PIC  ZZZZ999.99.
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  NAHDTO PIC  X(0008).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  NAHAMTO PIC  ZZZZ999.99.
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  INPDTO PIC  X(0008).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  PROCDTO PIC  X(0008).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  LFCOMMO PIC  .99999.
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  AHCOMMO PIC  .99999.
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  RCD01O PIC  X(0004).
  1840*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  34
* EL6316.cbl
  1841     05  FILLER            PIC  X(0003).
  1842     05  RCD02O PIC  X(0004).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  RCD03O PIC  X(0004).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  RCD04O PIC  X(0004).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  RCD05O PIC  X(0004).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  RCD06O PIC  X(0004).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  RCD07O PIC  X(0004).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  RCD08O PIC  X(0004).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  RCD09O PIC  X(0004).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  RCD10O PIC  X(0004).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  RCD11O PIC  X(0004).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  RCD12O PIC  X(0004).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  CRTNT1O PIC  X(0063).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  CRTNT2O PIC  X(0063).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  BILNT1O PIC  X(0063).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  ERRMSGO PIC  X(0075).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  PFENTRO PIC  X(0002).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  PF3O PIC  X(0019).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  PF4O PIC  X(0019).
  1894*    -------------------------------
  1895 01  FILLER REDEFINES EL631II.
  1896     12  FILLER                   PIC X(355).
  1897     12  REASONCDS.
  1898         16  FILLER OCCURS 12.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  35
* EL6316.cbl
  1899             20  REACDL       PIC S9(4) COMP.
  1900             20  REACDA       PIC X.
  1901             20  REACD-IN     PIC X(4).
  1902     12  FILLER               PIC X(215).
  1903****************************************************************
  1904*
  1905* Copyright (c) 2007-2013 Dell Inc.
  1906* All rights reserved.
  1907*
  1908****************************************************************
  1909 01  DFHEIV.
  1910   02  DFHEIV0               PIC X(35).
  1911   02  DFHEIV1               PIC X(08).
  1912   02  DFHEIV2               PIC X(08).
  1913   02  DFHEIV3               PIC X(08).
  1914   02  DFHEIV4               PIC X(06).
  1915   02  DFHEIV5               PIC X(04).
  1916   02  DFHEIV6               PIC X(04).
  1917   02  DFHEIV7               PIC X(02).
  1918   02  DFHEIV8               PIC X(02).
  1919   02  DFHEIV9               PIC X(01).
  1920   02  DFHEIV10              PIC S9(7) COMP-3.
  1921   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1922   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1923   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1924   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1925   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1926   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1927   02  DFHEIV17              PIC X(04).
  1928   02  DFHEIV18              PIC X(04).
  1929   02  DFHEIV19              PIC X(04).
  1930   02  DFHEIV20              USAGE IS POINTER.
  1931   02  DFHEIV21              USAGE IS POINTER.
  1932   02  DFHEIV22              USAGE IS POINTER.
  1933   02  DFHEIV23              USAGE IS POINTER.
  1934   02  DFHEIV24              USAGE IS POINTER.
  1935   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1936   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1937   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1938   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1939   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1940   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1941   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1942   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1943   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1944   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1945   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1946   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1947   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1948   02  FILLER                PIC X(02).
  1949   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1950   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1951   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1952   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1953   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1954   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1955   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1956 LINKAGE  SECTION.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  36
* EL6316.cbl
  1957*****************************************************************
  1958*                                                               *
  1959* Copyright (c) 2007-2013 Dell Inc.                             *
  1960* All rights reserved.                                          *
  1961*                                                               *
  1962*****************************************************************
  1963 01  dfheiblk.
  1964     02  eibtime          pic s9(7) comp-3.
  1965     02  eibdate          pic s9(7) comp-3.
  1966     02  eibtrnid         pic x(4).
  1967     02  eibtaskn         pic s9(7) comp-3.
  1968     02  eibtrmid         pic x(4).
  1969     02  dfheigdi         pic s9(4) comp.
  1970     02  eibcposn         pic s9(4) comp.
  1971     02  eibcalen         pic s9(4) comp.
  1972     02  eibaid           pic x(1).
  1973     02  eibfiller1       pic x(1).
  1974     02  eibfn            pic x(2).
  1975     02  eibfiller2       pic x(2).
  1976     02  eibrcode         pic x(6).
  1977     02  eibfiller3       pic x(2).
  1978     02  eibds            pic x(8).
  1979     02  eibreqid         pic x(8).
  1980     02  eibrsrce         pic x(8).
  1981     02  eibsync          pic x(1).
  1982     02  eibfree          pic x(1).
  1983     02  eibrecv          pic x(1).
  1984     02  eibsend          pic x(1).
  1985     02  eibatt           pic x(1).
  1986     02  eibeoc           pic x(1).
  1987     02  eibfmh           pic x(1).
  1988     02  eibcompl         pic x(1).
  1989     02  eibsig           pic x(1).
  1990     02  eibconf          pic x(1).
  1991     02  eiberr           pic x(1).
  1992     02  eibrldbk         pic x(1).
  1993     02  eiberrcd         pic x(4).
  1994     02  eibsynrb         pic x(1).
  1995     02  eibnodat         pic x(1).
  1996     02  eibfiller5       pic x(2).
  1997     02  eibresp          pic s9(8) comp.
  1998     02  eibresp2         pic s9(8) comp.
  1999     02  dfheigdj         pic s9(4) comp.
  2000     02  dfheigdk         pic s9(4) comp.
  2001 01  DFHCOMMAREA                 PIC X(1300).
  2002 01  var  pic x(30).
  2003*                                COPY ERCACCT.
  2004******************************************************************
  2005*                                                                *
  2006*                                                                *
  2007*                            ERCACCT                             *
  2008*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2009*                            VMOD=2.031                          *
  2010*                                                                *
  2011*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2012*                                                                *
  2013*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2014*   VSAM ACCOUNT MASTER FILES.                                   *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  37
* EL6316.cbl
  2015*                                                                *
  2016*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2017*                                                                *
  2018*   FILE TYPE = VSAM,KSDS                                        *
  2019*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2020*                                                                *
  2021*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2022*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2023*                                                                *
  2024*   LOG = NO                                                     *
  2025*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2026*                                                                *
  2027*                                                                *
  2028******************************************************************
  2029*                   C H A N G E   L O G
  2030*
  2031* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2032*-----------------------------------------------------------------
  2033*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2034* EFFECTIVE    NUMBER
  2035*-----------------------------------------------------------------
  2036* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2037* 092705    2005050300006  PEMA  ADD SPP LEASES
  2038* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2039* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2040* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2041* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2042* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2043* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2044******************************************************************
  2045
  2046 01  ACCOUNT-MASTER.
  2047     12  AM-RECORD-ID                      PIC XX.
  2048         88  VALID-AM-ID                      VALUE 'AM'.
  2049
  2050     12  AM-CONTROL-PRIMARY.
  2051         16  AM-COMPANY-CD                 PIC X.
  2052         16  AM-MSTR-CNTRL.
  2053             20  AM-CONTROL-A.
  2054                 24  AM-CARRIER            PIC X.
  2055                 24  AM-GROUPING.
  2056                     28 AM-GROUPING-PREFIX PIC XXX.
  2057                     28 AM-GROUPING-PRIME  PIC XXX.
  2058                 24  AM-STATE              PIC XX.
  2059                 24  AM-ACCOUNT.
  2060                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2061                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2062             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2063                                           PIC X(19).
  2064             20  AM-CNTRL-B.
  2065                 24  AM-EXPIRATION-DT      PIC XX.
  2066                 24  FILLER                PIC X(4).
  2067             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2068                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2069
  2070     12  AM-CONTROL-BY-VAR-GRP.
  2071         16  AM-COMPANY-CD-A1              PIC X.
  2072         16  AM-VG-CARRIER                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  38
* EL6316.cbl
  2073         16  AM-VG-GROUPING                PIC X(6).
  2074         16  AM-VG-STATE                   PIC XX.
  2075         16  AM-VG-ACCOUNT                 PIC X(10).
  2076         16  AM-VG-DATE.
  2077             20  AM-VG-EXPIRATION-DT       PIC XX.
  2078             20  FILLER                    PIC X(4).
  2079         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2080                                           PIC 9(11)      COMP-3.
  2081     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2082         16  FILLER                        PIC X(10).
  2083         16  AM-VG-KEY3.
  2084             20  AM-VG3-ACCOUNT            PIC X(10).
  2085             20  AM-VG3-EXP-DT             PIC XX.
  2086         16  FILLER                        PIC X(4).
  2087     12  AM-MAINT-INFORMATION.
  2088         16  AM-LAST-MAINT-DT              PIC XX.
  2089         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2090         16  AM-LAST-MAINT-USER            PIC X(4).
  2091         16  FILLER                        PIC XX.
  2092
  2093     12  AM-EFFECTIVE-DT                   PIC XX.
  2094     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2095
  2096     12  AM-PREV-DATES  COMP-3.
  2097         16  AM-PREV-EXP-DT                PIC 9(11).
  2098         16  AM-PREV-EFF-DT                PIC 9(11).
  2099
  2100     12  AM-REPORT-CODE-1                  PIC X(10).
  2101     12  AM-REPORT-CODE-2                  PIC X(10).
  2102
  2103     12  AM-CITY-CODE                      PIC X(4).
  2104     12  AM-COUNTY-PARISH                  PIC X(6).
  2105
  2106     12  AM-NAME                           PIC X(30).
  2107     12  AM-PERSON                         PIC X(30).
  2108     12  AM-ADDRS                          PIC X(30).
  2109     12  AM-CITY.
  2110         16  AM-ADDR-CITY                  PIC X(28).
  2111         16  AM-ADDR-STATE                 PIC XX.
  2112     12  AM-ZIP.
  2113         16  AM-ZIP-PRIME.
  2114             20  AM-ZIP-PRI-1ST            PIC X.
  2115                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2116             20  FILLER                    PIC X(4).
  2117         16  AM-ZIP-PLUS4                  PIC X(4).
  2118     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2119         16  AM-CAN-POSTAL-1               PIC XXX.
  2120         16  AM-CAN-POSTAL-2               PIC XXX.
  2121         16  FILLER                        PIC XXX.
  2122     12  AM-TEL-NO.
  2123         16  AM-AREA-CODE                  PIC 999.
  2124         16  AM-TEL-PRE                    PIC 999.
  2125         16  AM-TEL-NBR                    PIC 9(4).
  2126     12  AM-TEL-LOC                        PIC X.
  2127         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2128         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2129
  2130     12  AM-COMM-STRUCTURE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  39
* EL6316.cbl
  2131         16  AM-DEFN-1.
  2132             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2133                 24  AM-AGT.
  2134                     28  AM-AGT-PREFIX     PIC X(4).
  2135                     28  AM-AGT-PRIME      PIC X(6).
  2136                 24  AM-COM-TYP            PIC X.
  2137                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2138                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2139                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2140                 24  AM-RECALC-LV-INDIC    PIC X.
  2141                 24  AM-RETRO-LV-INDIC     PIC X.
  2142                 24  AM-GL-CODES           PIC X.
  2143                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2144                 24  FILLER                PIC X(01).
  2145         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2146             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2147                 24  FILLER                PIC X(11).
  2148                 24  AM-L-COMA             PIC XXX.
  2149                 24  AM-J-COMA             PIC XXX.
  2150                 24  AM-A-COMA             PIC XXX.
  2151                 24  FILLER                PIC X(6).
  2152
  2153     12  AM-COMM-CHANGE-STATUS             PIC X.
  2154         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2155
  2156     12  AM-CSR-CODE                       PIC X(4).
  2157
  2158     12  AM-BILLING-STATUS                 PIC X.
  2159         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2160         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2161     12  AM-AUTO-REFUND-SW                 PIC X.
  2162         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2163         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2164     12  AM-GPCD                           PIC 99.
  2165     12  AM-IG                             PIC X.
  2166         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2167         88  AM-HAS-GROUP                     VALUE '2'.
  2168     12  AM-STATUS                         PIC X.
  2169         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2170         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2171         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2172         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2173         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2174         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2175         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2176         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2177         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2178         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2179     12  AM-REMIT-TO                       PIC 99.
  2180     12  AM-ID-NO                          PIC X(11).
  2181
  2182     12  AM-CAL-TABLE                      PIC XX.
  2183     12  AM-LF-DEVIATION                   PIC XXX.
  2184     12  AM-AH-DEVIATION                   PIC XXX.
  2185     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2186     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2187     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2188     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  40
* EL6316.cbl
  2189     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2190     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2191
  2192     12  AM-USER-FIELDS.
  2193         16  AM-FLD-1                      PIC XX.
  2194         16  AM-FLD-2                      PIC XX.
  2195         16  AM-FLD-3                      PIC XX.
  2196         16  AM-FLD-4                      PIC XX.
  2197         16  AM-FLD-5                      PIC XX.
  2198
  2199     12  AM-1ST-PROD-DATE.
  2200         16  AM-1ST-PROD-YR                PIC XX.
  2201         16  AM-1ST-PROD-MO                PIC XX.
  2202         16  AM-1ST-PROD-DA                PIC XX.
  2203     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2204     12  AM-CERTS-PURGED-DATE.
  2205         16  AM-PUR-YR                     PIC XX.
  2206         16  AM-PUR-MO                     PIC XX.
  2207         16  AM-PUR-DA                     PIC XX.
  2208     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2209     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2210     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2211     12  AM-INACTIVE-DATE.
  2212         16  AM-INA-MO                     PIC 99.
  2213         16  AM-INA-DA                     PIC 99.
  2214         16  AM-INA-YR                     PIC 99.
  2215     12  AM-AR-HI-CERT-DATE                PIC XX.
  2216
  2217     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2218     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2219
  2220     12  AM-OB-PAYMENT-MODE                PIC X.
  2221         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2222         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2223         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2224         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2225
  2226     12  AM-AH-ONLY-INDICATOR              PIC X.
  2227         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2228         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2229
  2230     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2231
  2232     12  AM-OVER-SHORT.
  2233         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2234         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2235
  2236     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2237     12  AM-DCC-CLP-STATE                  PIC XX.
  2238
  2239     12  AM-RECALC-COMM                    PIC X.
  2240     12  AM-RECALC-REIN                    PIC X.
  2241
  2242     12  AM-REI-TABLE                      PIC XXX.
  2243     12  AM-REI-ET-LF                      PIC X.
  2244     12  AM-REI-ET-AH                      PIC X.
  2245     12  AM-REI-PE-LF                      PIC X.
  2246     12  AM-REI-PE-AH                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  41
* EL6316.cbl
  2247     12  AM-REI-PRT-ST                     PIC X.
  2248     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2249     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2250     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2251     12  AM-REI-GROUP-A                    PIC X(6).
  2252     12  AM-REI-MORT                       PIC X(4).
  2253     12  AM-REI-PRT-OW                     PIC X.
  2254     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2255     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2256     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2257     12  AM-REI-GROUP-B                    PIC X(6).
  2258
  2259     12  AM-TRUST-TYPE                     PIC X(2).
  2260
  2261     12  AM-EMPLOYER-STMT-USED             PIC X.
  2262     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2263
  2264     12  AM-STD-AH-TYPE                    PIC XX.
  2265     12  AM-EARN-METHODS.
  2266         16  AM-EARN-METHOD-R              PIC X.
  2267             88 AM-REF-RL-R78                 VALUE 'R'.
  2268             88 AM-REF-RL-PR                  VALUE 'P'.
  2269             88 AM-REF-RL-MEAN                VALUE 'M'.
  2270             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2271         16  AM-EARN-METHOD-L              PIC X.
  2272             88 AM-REF-LL-R78                 VALUE 'R'.
  2273             88 AM-REF-LL-PR                  VALUE 'P'.
  2274             88 AM-REF-LL-MEAN                VALUE 'M'.
  2275             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2276         16  AM-EARN-METHOD-A              PIC X.
  2277             88 AM-REF-AH-R78                 VALUE 'R'.
  2278             88 AM-REF-AH-PR                  VALUE 'P'.
  2279             88 AM-REF-AH-MEAN                VALUE 'M'.
  2280             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2281             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2282             88 AM-REF-AH-NET                 VALUE 'N'.
  2283
  2284     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2285     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2286     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2287
  2288     12  AM-RET-Y-N                        PIC X.
  2289     12  AM-RET-P-E                        PIC X.
  2290     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2291     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2292     12  AM-RET-GRP                        PIC X(6).
  2293     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2294         16  AM-POOL-PRIME                 PIC XXX.
  2295         16  AM-POOL-SUB                   PIC XXX.
  2296     12  AM-RETRO-EARNINGS.
  2297         16  AM-RET-EARN-R                 PIC X.
  2298         16  AM-RET-EARN-L                 PIC X.
  2299         16  AM-RET-EARN-A                 PIC X.
  2300     12  AM-RET-ST-TAX-USE                 PIC X.
  2301         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2302         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2303     12  AM-RETRO-BEG-EARNINGS.
  2304         16  AM-RET-BEG-EARN-R             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  42
* EL6316.cbl
  2305         16  AM-RET-BEG-EARN-L             PIC X.
  2306         16  AM-RET-BEG-EARN-A             PIC X.
  2307     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2308     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2309
  2310     12  AM-USER-SELECT-OPTIONS.
  2311         16  AM-USER-SELECT-1              PIC X(10).
  2312         16  AM-USER-SELECT-2              PIC X(10).
  2313         16  AM-USER-SELECT-3              PIC X(10).
  2314         16  AM-USER-SELECT-4              PIC X(10).
  2315         16  AM-USER-SELECT-5              PIC X(10).
  2316
  2317     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2318
  2319     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2320
  2321     12  AM-RPT045A-SWITCH                 PIC X.
  2322         88  RPT045A-OFF                   VALUE 'N'.
  2323
  2324     12  AM-INSURANCE-LIMITS.
  2325         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2326         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2327
  2328     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2329         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2330
  2331     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2332         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2333         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2334
  2335     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2336
  2337     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2338     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2339     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2340     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2341     12  AM-DCC-UEF-STATE                  PIC XX.
  2342     12  FILLER                            PIC XXX.
  2343     12  AM-REPORT-CODE-3                  PIC X(10).
  2344*    12  FILLER                            PIC X(22).
  2345
  2346     12  AM-RESERVE-DATE.
  2347         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2348         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2349         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2350
  2351     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2352     12  AM-NOTIFICATION-TYPES.
  2353         16  AM-NOTIF-OF-LETTERS           PIC X.
  2354         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2355         16  AM-NOTIF-OF-REPORTS           PIC X.
  2356         16  AM-NOTIF-OF-STATUS            PIC X.
  2357
  2358     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2359         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2360         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2361         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2362         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  43
* EL6316.cbl
  2363
  2364     12  AM-BENEFIT-CONTROLS.
  2365         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2366             20  AM-BENEFIT-CODE           PIC XX.
  2367             20  AM-BENEFIT-TYPE           PIC X.
  2368             20  AM-BENEFIT-REVISION       PIC XXX.
  2369             20  AM-BENEFIT-REM-TERM       PIC X.
  2370             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2371             20  FILLER                    PIC XX.
  2372         16  FILLER                        PIC X(80).
  2373
  2374     12  AM-TRANSFER-DATA.
  2375         16  AM-TRANSFERRED-FROM.
  2376             20  AM-TRNFROM-CARRIER        PIC X.
  2377             20  AM-TRNFROM-GROUPING.
  2378                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2379                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2380             20  AM-TRNFROM-STATE          PIC XX.
  2381             20  AM-TRNFROM-ACCOUNT.
  2382                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2383                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2384             20  AM-TRNFROM-DTE            PIC XX.
  2385         16  AM-TRANSFERRED-TO.
  2386             20  AM-TRNTO-CARRIER          PIC X.
  2387             20  AM-TRNTO-GROUPING.
  2388                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2389                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2390             20  AM-TRNTO-STATE            PIC XX.
  2391             20  AM-TRNTO-ACCOUNT.
  2392                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2393                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2394             20  AM-TRNTO-DTE              PIC XX.
  2395         16  FILLER                        PIC X(10).
  2396
  2397     12  AM-SAVED-REMIT-TO                 PIC 99.
  2398
  2399     12  AM-COMM-STRUCTURE-SAVED.
  2400         16  AM-DEFN-1-SAVED.
  2401             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2402                 24  AM-AGT-SV             PIC X(10).
  2403                 24  AM-COM-TYP-SV         PIC X.
  2404                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2405                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2406                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2407                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2408                 24  FILLER                PIC X.
  2409                 24  AM-GL-CODES-SV        PIC X.
  2410                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2411                 24  FILLER                PIC X.
  2412         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2413             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2414                 24  FILLER                PIC X(11).
  2415                 24  AM-L-COMA-SV          PIC XXX.
  2416                 24  AM-J-COMA-SV          PIC XXX.
  2417                 24  AM-A-COMA-SV          PIC XXX.
  2418                 24  FILLER                PIC X(6).
  2419
  2420     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  44
* EL6316.cbl
  2421         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2422            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2423            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2424            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2425
  2426     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2427     12  FILLER                            PIC X(120).
  2428
  2429     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2430         16  AM-CONTROL-NAME               PIC X(30).
  2431         16  AM-EXECUTIVE-ONE.
  2432             20  AM-EXEC1-NAME             PIC X(15).
  2433             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2434                                                          COMP-3.
  2435             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2436                                                          COMP-3.
  2437         16  AM-EXECUTIVE-TWO.
  2438             20  AM-EXEC2-NAME             PIC X(15).
  2439             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2440                                                          COMP-3.
  2441             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2442                                                          COMP-3.
  2443
  2444     12  AM-RETRO-ADDITIONAL-DATA.
  2445         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2446         16  AM-RETRO-PREM-P-E             PIC X.
  2447         16  AM-RETRO-CLMS-P-I             PIC X.
  2448         16  AM-RETRO-RET-BRACKET-LF.
  2449             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2450                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2451                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2452             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2453                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2454                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2455             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2456                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2457                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2458         16  AM-RETRO-RET-BRACKET-AH.
  2459             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2460                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2461                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2462                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2463             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2464                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2465                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2466             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2467                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2468                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2469
  2470     12  AM-COMMENTS.
  2471         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2472
  2473     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2474         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2475         16  AM-FLI-BILLING-CODE           PIC X.
  2476         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2477         16  AM-FLI-UNITED-IDENT           PIC X.
  2478         16  AM-FLI-INTEREST-LOST-DATA.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  45
* EL6316.cbl
  2479             20  AM-FLI-BANK-NO            PIC X(5).
  2480             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2481             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2482             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2483         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2484             20  AM-FLI-AGT                PIC X(9).
  2485             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2486             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2487         16  FILLER                        PIC X(102).
  2488
  2489     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2490         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2491             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2492             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2493             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2494             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2495             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2496         16  FILLER                          PIC X(10).
  2497******************************************************************
  2498*                                COPY ELCCNTL.
  2499******************************************************************
  2500*                                                                *
  2501*                                                                *
  2502*                            ELCCNTL.                            *
  2503*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2504*                            VMOD=2.059                          *
  2505*                                                                *
  2506*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2507*                                                                *
  2508*   FILE TYPE = VSAM,KSDS                                        *
  2509*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2510*                                                                *
  2511*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2512*       ALTERNATE INDEX = NONE                                   *
  2513*                                                                *
  2514*   LOG = YES                                                    *
  2515*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2516******************************************************************
  2517*                   C H A N G E   L O G
  2518*
  2519* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2520*-----------------------------------------------------------------
  2521*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2522* EFFECTIVE    NUMBER
  2523*-----------------------------------------------------------------
  2524* 082503                   PEMA  ADD BENEFIT GROUP
  2525* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2526* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2527* 092705    2005050300006  PEMA  ADD SPP LEASES
  2528* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2529* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2530* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2531* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2532* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2533* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2534* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2535* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2536* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  46
* EL6316.cbl
  2537* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2538******************************************************************
  2539*
  2540 01  CONTROL-FILE.
  2541     12  CF-RECORD-ID                       PIC XX.
  2542         88  VALID-CF-ID                        VALUE 'CF'.
  2543
  2544     12  CF-CONTROL-PRIMARY.
  2545         16  CF-COMPANY-ID                  PIC XXX.
  2546         16  CF-RECORD-TYPE                 PIC X.
  2547             88  CF-COMPANY-MASTER              VALUE '1'.
  2548             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2549             88  CF-STATE-MASTER                VALUE '3'.
  2550             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2551             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2552             88  CF-CARRIER-MASTER              VALUE '6'.
  2553             88  CF-MORTALITY-MASTER            VALUE '7'.
  2554             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2555             88  CF-TERMINAL-MASTER             VALUE '9'.
  2556             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2557             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2558             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2559             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2560             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2561             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2562             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2563             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2564             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2565         16  CF-ACCESS-CD-GENL              PIC X(4).
  2566         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2567             20  CF-PROCESSOR               PIC X(4).
  2568         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2569             20  CF-STATE-CODE              PIC XX.
  2570             20  FILLER                     PIC XX.
  2571         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2572             20  FILLER                     PIC XX.
  2573             20  CF-HI-BEN-IN-REC           PIC XX.
  2574         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2575             20  FILLER                     PIC XXX.
  2576             20  CF-CARRIER-CNTL            PIC X.
  2577         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2578             20  FILLER                     PIC XX.
  2579             20  CF-HI-TYPE-IN-REC          PIC 99.
  2580         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2581             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2582                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2583             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2584             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2585         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2586             20  FILLER                     PIC X.
  2587             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2588         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2589             20  FILLER                     PIC XX.
  2590             20  CF-MORTGAGE-PLAN           PIC XX.
  2591         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2592
  2593     12  CF-LAST-MAINT-DT                   PIC XX.
  2594     12  CF-LAST-MAINT-BY                   PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  47
* EL6316.cbl
  2595     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2596
  2597     12  CF-RECORD-BODY                     PIC X(728).
  2598
  2599
  2600****************************************************************
  2601*             COMPANY MASTER RECORD                            *
  2602****************************************************************
  2603
  2604     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2605         16  CF-COMPANY-ADDRESS.
  2606             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2607             20  CF-CL-IN-CARE-OF           PIC X(30).
  2608             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2609             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2610             20  CF-CL-CITY-STATE           PIC X(30).
  2611             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2612             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2613         16  CF-COMPANY-CD                  PIC X.
  2614         16  CF-COMPANY-PASSWORD            PIC X(8).
  2615         16  CF-SECURITY-OPTION             PIC X.
  2616             88  ALL-SECURITY                   VALUE '1'.
  2617             88  COMPANY-VERIFY                 VALUE '2'.
  2618             88  PROCESSOR-VERIFY               VALUE '3'.
  2619             88  NO-SECURITY                    VALUE '4'.
  2620             88  ALL-BUT-TERM                   VALUE '5'.
  2621         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2622             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2623         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2624             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2625         16  CF-INFORCE-LOCATION            PIC X.
  2626             88  CERTS-ARE-ONLINE               VALUE '1'.
  2627             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2628             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2629         16  CF-LOWER-CASE-LETTERS          PIC X.
  2630         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2631             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2632             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2633             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2634             88  CF-ACCNT-CNTL                  VALUE '3'.
  2635             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2636
  2637         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2638         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2639
  2640         16  CF-LGX-CREDIT-USER             PIC X.
  2641             88  CO-IS-NOT-USER                 VALUE 'N'.
  2642             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2643
  2644         16 CF-CREDIT-CALC-CODES.
  2645             20  CF-CR-REM-TERM-CALC PIC X.
  2646               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2647               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2648               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2649               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2650               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2651               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2652               88  CR-EARN-AFTER-16TH           VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  48
* EL6316.cbl
  2653             20  CF-CR-R78-METHOD           PIC X.
  2654               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2655               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2656
  2657         16  CF-CLAIM-CONTROL-COUNTS.
  2658             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2659                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2660
  2661             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2662                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2663
  2664             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2665                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2666
  2667             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2668                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2669
  2670         16  CF-CURRENT-MONTH-END           PIC XX.
  2671
  2672         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2673             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2674             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2675             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2676             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2677                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2678                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2679             20  CF-CO-PREM-REJECT-SW       PIC X.
  2680                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2681                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2682             20  CF-CO-REF-REJECT-SW        PIC X.
  2683                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2684                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2685
  2686         16  CF-CO-REPORTING-DT             PIC XX.
  2687         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2688         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2689           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2690           88  CF-CO-MONTH-END                  VALUE '1'.
  2691
  2692         16  CF-LGX-CLAIM-USER              PIC X.
  2693             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2694             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2695
  2696         16  CF-CREDIT-EDIT-CONTROLS.
  2697             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2698             20  CF-MIN-AGE                 PIC 99.
  2699             20  CF-DEFAULT-AGE             PIC 99.
  2700             20  CF-MIN-TERM                PIC S999      COMP-3.
  2701             20  CF-MAX-TERM                PIC S999      COMP-3.
  2702             20  CF-DEFAULT-SEX             PIC X.
  2703             20  CF-JOINT-AGE-INPUT         PIC X.
  2704                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2705             20  CF-BIRTH-DATE-INPUT        PIC X.
  2706                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2707             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2708                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2709                 88  CF-ZERO-CARRIER            VALUE '1'.
  2710                 88  CF-ZERO-GROUPING           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  49
* EL6316.cbl
  2711                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2712             20  CF-EDIT-SW                 PIC X.
  2713                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2714             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2715             20  CF-CR-PR-METHOD            PIC X.
  2716               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2717               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2718             20  FILLER                     PIC X.
  2719
  2720         16  CF-CREDIT-MISC-CONTROLS.
  2721             20  CF-REIN-TABLE-SW           PIC X.
  2722                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2723             20  CF-COMP-TABLE-SW           PIC X.
  2724                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2725             20  CF-EXPERIENCE-RETENTION-AGE
  2726                                            PIC S9        COMP-3.
  2727             20  CF-CONVERSION-DT           PIC XX.
  2728             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2729             20  CF-RUN-FREQUENCY-SW        PIC X.
  2730                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2731                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2732
  2733             20  CF-CR-CHECK-NO-CONTROL.
  2734                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2735                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2736                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2737                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2738                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2739                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2740
  2741                 24  CF-CR-CHECK-COUNT       REDEFINES
  2742                     CF-CR-CHECK-COUNTER      PIC X(4).
  2743
  2744                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2745                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2746
  2747                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2748                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2749                 24  CF-MAIL-PROCESSING       PIC X.
  2750                     88  MAIL-PROCESSING          VALUE 'Y'.
  2751
  2752         16  CF-MISC-SYSTEM-CONTROL.
  2753             20  CF-SYSTEM-C                 PIC X.
  2754                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2755             20  CF-SYSTEM-D                 PIC X.
  2756                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2757             20  CF-SOC-SEC-NO-SW            PIC X.
  2758                 88  SOC-SEC-NO-USED             VALUE '1'.
  2759             20  CF-MEMBER-NO-SW             PIC X.
  2760                 88  MEMBER-NO-USED              VALUE '1'.
  2761             20  CF-TAX-ID-NUMBER            PIC X(11).
  2762             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2763             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2764                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2765                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2766                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2767                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2768             20  CF-SYSTEM-E                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  50
* EL6316.cbl
  2769                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2770
  2771         16  CF-LGX-LIFE-USER               PIC X.
  2772             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2773             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2774
  2775         16  CF-CR-MONTH-END-DT             PIC XX.
  2776
  2777         16  CF-FILE-MAINT-DATES.
  2778             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2779                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2780             20  CF-LAST-BATCH       REDEFINES
  2781                 CF-LAST-BATCH-NO               PIC X(4).
  2782             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2783             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2784             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2785             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2786             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2787             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2788             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2789             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2790             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2791             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2792
  2793         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2794         16  FILLER                         PIC X.
  2795
  2796         16  CF-ALT-MORT-CODE               PIC X(4).
  2797         16  CF-MEMBER-CAPTION              PIC X(10).
  2798
  2799         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2800             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2801             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2802             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2803             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2804             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2805
  2806         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2807
  2808         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2809         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2810         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2811         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2812
  2813         16  CF-AH-OVERRIDE-L1              PIC X.
  2814         16  CF-AH-OVERRIDE-L2              PIC XX.
  2815         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2816         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2817
  2818         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2819         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2820
  2821         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2822         16  CF-AR-LAST-EL860-DT            PIC XX.
  2823         16  CF-MP-MONTH-END-DT             PIC XX.
  2824
  2825         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2826         16  CF-CLAIM-PAID-THRU-TO          PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  51
* EL6316.cbl
  2827             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2828
  2829         16  CF-AR-MONTH-END-DT             PIC XX.
  2830
  2831         16  CF-CRDTCRD-USER                PIC X.
  2832             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2833             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2834
  2835         16  CF-CC-MONTH-END-DT             PIC XX.
  2836
  2837         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2838
  2839         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2840             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2841             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2842             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2843         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2844         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2845         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2846         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2847             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2848             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2849         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2850         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2851         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2852             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2853         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2854
  2855         16  CF-CL-ZIP-CODE.
  2856             20  CF-CL-ZIP-PRIME.
  2857                 24  CF-CL-ZIP-1ST          PIC X.
  2858                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2859                 24  FILLER                 PIC X(4).
  2860             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2861         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2862             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2863             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2864             20  FILLER                     PIC XXX.
  2865
  2866         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2867         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2868         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2869         16  CF-CO-OPTION-START-DATE        PIC XX.
  2870         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2871           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2872                                                      '3' '4'.
  2873           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2874           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2875           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2876           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2877           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2878           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2879
  2880         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2881
  2882         16  CF-PAYMENT-APPROVAL-LEVELS.
  2883             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2884             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  52
* EL6316.cbl
  2885             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2886             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2887             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2888             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2889
  2890         16  CF-END-USER-REPORTING-USER     PIC X.
  2891             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2892             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2893
  2894         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2895             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2896             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2897
  2898         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2899
  2900         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2901         16  FILLER                         PIC X.
  2902
  2903         16  CF-CREDIT-ARCHIVE-CNTL.
  2904             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2905             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2906             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2907
  2908         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2909
  2910         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2911             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2912             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2913
  2914         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2915             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2916             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2917
  2918         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2919
  2920         16  CF-CO-ACH-ID-CODE              PIC  X.
  2921             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2922             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2923             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2924         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2925         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2926         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2927         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2928         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2929         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2930         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2931         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2932         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2933                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2934         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2935                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2936
  2937         16  CF-CO-OVER-SHORT.
  2938             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2939             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2940
  2941*         16  FILLER                         PIC X(102).
  2942         16  CF-PAYMENT-APPROVAL-LEVELS-2.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  53
* EL6316.cbl
  2943             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2944             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2945
  2946         16  CF-AH-APPROVAL-DAYS.
  2947             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2948             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2949             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2950             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2951
  2952         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2953
  2954         16  CF-APPROV-LEV-5.
  2955             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2956             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2957             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2958
  2959         16  FILLER                         PIC X(68).
  2960****************************************************************
  2961*             PROCESSOR/USER RECORD                            *
  2962****************************************************************
  2963
  2964     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2965         16  CF-PROCESSOR-NAME              PIC X(30).
  2966         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2967         16  CF-PROCESSOR-TITLE             PIC X(26).
  2968         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2969                 88  MESSAGE-YES                VALUE 'Y'.
  2970                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2971
  2972*****************************************************
  2973****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2974****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2975****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2976****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2977*****************************************************
  2978
  2979         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2980             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2981             20  CF-APPLICATION-FORCE       PIC X.
  2982             20  CF-INDIVIDUAL-APP.
  2983                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2984                     28  CF-BROWSE-APP      PIC X.
  2985                     28  CF-UPDATE-APP      PIC X.
  2986
  2987         16  CF-CURRENT-TERM-ON             PIC X(4).
  2988         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2989             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2990             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2991             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2992             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2993             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2994             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2995             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2996         16  CF-PROCESSOR-CARRIER           PIC X.
  2997             88  NO-CARRIER-SECURITY            VALUE ' '.
  2998         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2999             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3000         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  54
* EL6316.cbl
  3001             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3002         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3003             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3004
  3005         16  CF-PROC-SYS-ACCESS-SW.
  3006             20  CF-PROC-CREDIT-CLAIMS-SW.
  3007                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3008                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3009                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3010                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3011             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3012                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3013                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3014             20  CF-PROC-LIFE-GNRLDGR-SW.
  3015                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3016                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3017                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3018                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3019             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3020                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3021                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3022         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3023             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3024             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3025         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3026
  3027         16  CF-APPROVAL-LEVEL                  PIC X.
  3028             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3029             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3030             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3031             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3032             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3033
  3034         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3035
  3036         16  CF-LANGUAGE-TYPE                   PIC X.
  3037             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3038             88  CF-LANG-IS-FR                      VALUE 'F'.
  3039
  3040         16  CF-CSR-IND                         PIC X.
  3041         16  FILLER                             PIC X(239).
  3042
  3043****************************************************************
  3044*             PROCESSOR/REMINDERS RECORD                       *
  3045****************************************************************
  3046
  3047     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3048         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3049             20  CF-START-REMIND-DT         PIC XX.
  3050             20  CF-END-REMIND-DT           PIC XX.
  3051             20  CF-REMINDER-TEXT           PIC X(50).
  3052         16  FILLER                         PIC X(296).
  3053
  3054
  3055****************************************************************
  3056*             STATE MASTER RECORD                              *
  3057****************************************************************
  3058
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  55
* EL6316.cbl
  3059     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3060         16  CF-STATE-ABBREVIATION          PIC XX.
  3061         16  CF-STATE-NAME                  PIC X(25).
  3062         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3063         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3064             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3065             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3066             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3067             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3068                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3069                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3070             20  CF-ST-PREM-REJECT-SW       PIC X.
  3071                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3072                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3073             20  CF-ST-REF-REJECT-SW        PIC X.
  3074                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3075                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3076         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3077         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3078         16  CF-ST-REFUND-RULES.
  3079             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3080             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3081             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3082         16  CF-ST-FST-PMT-EXTENSION.
  3083             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3084             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3085                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3086                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3087                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3088                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3089         16  CF-ST-STATE-CALL.
  3090             20  CF-ST-CALL-UNEARNED        PIC X.
  3091             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3092             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3093         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3094             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3095             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3096         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3097         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3098         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3099         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3100         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3101         16  FILLER                         PIC X.
  3102         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3103             20  CF-ST-BENEFIT-CD           PIC XX.
  3104             20  CF-ST-BENEFIT-KIND         PIC X.
  3105                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3106                 88  CF-ST-AH-KIND              VALUE 'A'.
  3107             20  CF-ST-REM-TERM-CALC        PIC X.
  3108                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3109                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3110                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3111                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3112                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3113                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3114                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3115                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3116
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  56
* EL6316.cbl
  3117             20  CF-ST-REFUND-CALC          PIC X.
  3118                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3119                 88  ST-REFD-BY-R78             VALUE '1'.
  3120                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3121                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3122                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3123                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3124                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3125                 88  ST-REFD-UTAH               VALUE '7'.
  3126                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3127                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3128                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3129
  3130             20  CF-ST-EARNING-CALC         PIC X.
  3131                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3132                 88  ST-EARN-BY-R78             VALUE '1'.
  3133                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3134                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3135                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3136                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3137                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3138                 88  ST-EARN-MEAN               VALUE '8'.
  3139                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3140
  3141             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3142                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3143                 88  ST-OVRD-BY-R78             VALUE '1'.
  3144                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3145                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3146                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3147                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3148                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3149                 88  ST-OVRD-MEAN               VALUE '8'.
  3150                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3151             20  cf-st-extra-periods        pic 9.
  3152*            20  FILLER                     PIC X.
  3153
  3154         16  CF-ST-COMMISSION-CAPS.
  3155             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3156             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3157             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3158             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3159         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3160                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3161
  3162         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3163
  3164         16  CF-ST-STATUTORY-INTEREST.
  3165             20  CF-ST-STAT-DATE-FROM       PIC X.
  3166                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3167                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3168             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3169             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3170             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3171             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3172             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3173
  3174         16  CF-ST-OVER-SHORT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  57
* EL6316.cbl
  3175             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3176             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3177
  3178         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3179
  3180         16  CF-ST-RT-CALC                  PIC X.
  3181
  3182         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3183         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3184         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3185         16  CF-ST-RF-LR-CALC               PIC X.
  3186         16  CF-ST-RF-LL-CALC               PIC X.
  3187         16  CF-ST-RF-LN-CALC               PIC X.
  3188         16  CF-ST-RF-AH-CALC               PIC X.
  3189         16  CF-ST-RF-CP-CALC               PIC X.
  3190*        16  FILLER                         PIC X(206).
  3191*CIDMOD         16  FILLER                         PIC X(192).
  3192         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3193             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3194         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3195         16  CF-ST-VFY-2ND-BENE             PIC X.
  3196         16  CF-ST-CAUSAL-STATE             PIC X.
  3197         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3198         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3199         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3200             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3201         16  CF-ST-NET-ONLY-STATE           PIC X.
  3202             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3203         16  FILLER                         PIC X(181).
  3204
  3205****************************************************************
  3206*             BENEFIT MASTER RECORD                            *
  3207****************************************************************
  3208
  3209     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3210         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3211             20  CF-BENEFIT-CODE            PIC XX.
  3212             20  CF-BENEFIT-NUMERIC  REDEFINES
  3213                 CF-BENEFIT-CODE            PIC XX.
  3214             20  CF-BENEFIT-ALPHA           PIC XXX.
  3215             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3216             20  CF-BENEFIT-COMMENT         PIC X(10).
  3217
  3218             20  CF-LF-COVERAGE-TYPE        PIC X.
  3219                 88  CF-REDUCING                VALUE 'R'.
  3220                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3221
  3222             20  CF-SPECIAL-CALC-CD         PIC X.
  3223                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3224                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3225                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3226                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3227                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3228                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3229                 88  CF-FARM-PLAN               VALUE 'F'.
  3230                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3231                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3232                 88  CF-3-MTH-INTEREST          VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  58
* EL6316.cbl
  3233                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3234                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3235                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3236                 88  CF-PRUDENTIAL              VALUE 'P'.
  3237                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3238                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3239                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3240                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3241                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3242                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3243
  3244             20  CF-JOINT-INDICATOR         PIC X.
  3245                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3246
  3247*            20  FILLER                     PIC X(12).
  3248             20  cf-maximum-benefits        pic s999 comp-3.
  3249             20  FILLER                     PIC X(09).
  3250             20  CF-BENEFIT-CATEGORY        PIC X.
  3251             20  CF-LOAN-TYPE               PIC X(8).
  3252
  3253             20  CF-CO-REM-TERM-CALC        PIC X.
  3254                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3255                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3256                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3257                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3258                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3259
  3260             20  CF-CO-EARNINGS-CALC        PIC X.
  3261                 88  CO-EARN-BY-R78             VALUE '1'.
  3262                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3263                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3264                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3265                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3266                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3267                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3268                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3269
  3270             20  CF-CO-REFUND-CALC          PIC X.
  3271                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3272                 88  CO-REFD-BY-R78             VALUE '1'.
  3273                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3274                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3275                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3276                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3277                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3278                 88  CO-REFD-MEAN               VALUE '8'.
  3279                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3280                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3281                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3282
  3283             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3284                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3285                 88  CO-OVRD-BY-R78             VALUE '1'.
  3286                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3287                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3288                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3289                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3290                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  59
* EL6316.cbl
  3291                 88  CO-OVRD-MEAN               VALUE '8'.
  3292                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3293
  3294             20  CF-CO-BEN-I-G-CD           PIC X.
  3295                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3296                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3297                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3298
  3299         16  FILLER                         PIC X(304).
  3300
  3301
  3302****************************************************************
  3303*             CARRIER MASTER RECORD                            *
  3304****************************************************************
  3305
  3306     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3307         16  CF-ADDRESS-DATA.
  3308             20  CF-MAIL-TO-NAME            PIC X(30).
  3309             20  CF-IN-CARE-OF              PIC X(30).
  3310             20  CF-ADDRESS-LINE-1          PIC X(30).
  3311             20  CF-ADDRESS-LINE-2          PIC X(30).
  3312             20  CF-CITY-STATE              PIC X(30).
  3313             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3314             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3315
  3316         16  CF-CLAIM-NO-CONTROL.
  3317             20  CF-CLAIM-NO-METHOD         PIC X.
  3318                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3319                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3320                 88  CLAIM-NO-SEQ               VALUE '3'.
  3321                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3322             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3323                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3324                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3325                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3326
  3327         16  CF-CHECK-NO-CONTROL.
  3328             20  CF-CHECK-NO-METHOD         PIC X.
  3329                 88  CHECK-NO-MANUAL            VALUE '1'.
  3330                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3331                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3332                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3333             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3334                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3335
  3336         16  CF-DOMICILE-STATE              PIC XX.
  3337
  3338         16  CF-EXPENSE-CONTROLS.
  3339             20  CF-EXPENSE-METHOD          PIC X.
  3340                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3341                 88  DOLLARS-PER-PMT            VALUE '2'.
  3342                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3343                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3344             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3345             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3346
  3347         16  CF-CORRESPONDENCE-CONTROL.
  3348             20  CF-LETTER-RESEND-OPT       PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  60
* EL6316.cbl
  3349                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3350                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3351             20  FILLER                     PIC X(4).
  3352
  3353         16  CF-RESERVE-CONTROLS.
  3354             20  CF-MANUAL-SW               PIC X.
  3355                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3356             20  CF-FUTURE-SW               PIC X.
  3357                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3358             20  CF-PTC-SW                  PIC X.
  3359                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3360             20  CF-IBNR-SW                 PIC X.
  3361                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3362             20  CF-PTC-LF-SW               PIC X.
  3363                 88  CF-LF-PTC-USED             VALUE '1'.
  3364             20  CF-CDT-ACCESS-METHOD       PIC X.
  3365                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3366                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3367                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3368             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3369
  3370         16  CF-CLAIM-CALC-METHOD           PIC X.
  3371             88  360-PLUS-MONTHS                VALUE '1'.
  3372             88  365-PLUS-MONTHS                VALUE '2'.
  3373             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3374             88  360-DAILY                      VALUE '4'.
  3375             88  365-DAILY                      VALUE '5'.
  3376
  3377         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3378         16  FILLER                         PIC X(11).
  3379
  3380         16  CF-LIMIT-AMOUNTS.
  3381             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3382             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3383             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3384             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3385             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3386             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3387             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3388             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3389             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3390             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3391
  3392         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3393         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3394         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3395
  3396         16  CF-ZIP-CODE.
  3397             20  CF-ZIP-PRIME.
  3398                 24  CF-ZIP-1ST             PIC X.
  3399                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3400                 24  FILLER                 PIC X(4).
  3401             20  CF-ZIP-PLUS4               PIC X(4).
  3402         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3403             20  CF-CAN-POSTAL-1            PIC XXX.
  3404             20  CF-CAN-POSTAL-2            PIC XXX.
  3405             20  FILLER                     PIC XXX.
  3406
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  61
* EL6316.cbl
  3407         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3408         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3409         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3410
  3411         16  CF-RATING-SWITCH               PIC X.
  3412             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3413             88  CF-NO-RATING                   VALUE 'N'.
  3414
  3415         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3416
  3417         16  CF-CARRIER-OVER-SHORT.
  3418             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3419             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3420
  3421         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3422         16  CF-SECPAY-SWITCH               PIC X.
  3423             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3424             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3425         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3426         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3427         16  FILLER                         PIC X(444).
  3428*        16  FILLER                         PIC X(452).
  3429
  3430
  3431****************************************************************
  3432*             MORTALITY MASTER RECORD                          *
  3433****************************************************************
  3434
  3435     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3436         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3437                                INDEXED BY CF-MORT-NDX.
  3438             20  CF-MORT-TABLE              PIC X(5).
  3439             20  CF-MORT-TABLE-TYPE         PIC X.
  3440                 88  CF-MORT-JOINT              VALUE 'J'.
  3441                 88  CF-MORT-SINGLE             VALUE 'S'.
  3442                 88  CF-MORT-COMBINED           VALUE 'C'.
  3443                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3444                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3445             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3446             20  CF-MORT-AGE-METHOD         PIC XX.
  3447                 88  CF-AGE-LAST                VALUE 'AL'.
  3448                 88  CF-AGE-NEAR                VALUE 'AN'.
  3449             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3450             20  CF-MORT-ADJUSTMENT-DIRECTION
  3451                                            PIC X.
  3452                 88  CF-MINUS                   VALUE '-'.
  3453                 88  CF-PLUS                    VALUE '+'.
  3454             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3455             20  CF-MORT-JOINT-CODE         PIC X.
  3456                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3457             20  CF-MORT-PC-Q               PIC X.
  3458                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3459             20  CF-MORT-TABLE-CODE         PIC X(4).
  3460             20  CF-MORT-COMMENTS           PIC X(15).
  3461             20  FILLER                     PIC X(14).
  3462
  3463         16  FILLER                         PIC X(251).
  3464
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  62
* EL6316.cbl
  3465
  3466****************************************************************
  3467*             BUSSINESS TYPE MASTER RECORD                     *
  3468****************************************************************
  3469
  3470     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3471* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3472* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3473* AND RECORD 05 IS TYPES 81-99
  3474         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3475             20  CF-BUSINESS-TITLE          PIC  X(19).
  3476             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3477                                            PIC S9V9(4) COMP-3.
  3478             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3479             20  FILLER                     PIC  X.
  3480         16  FILLER                         PIC  X(248).
  3481
  3482
  3483****************************************************************
  3484*             TERMINAL MASTER RECORD                           *
  3485****************************************************************
  3486
  3487     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3488
  3489         16  CF-COMPANY-TERMINALS.
  3490             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3491                                  PIC X(4).
  3492         16  FILLER               PIC X(248).
  3493
  3494
  3495****************************************************************
  3496*             LIFE EDIT MASTER RECORD                          *
  3497****************************************************************
  3498
  3499     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3500         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3501             20  CF-LIFE-CODE-IN            PIC XX.
  3502             20  CF-LIFE-CODE-OUT           PIC XX.
  3503         16  FILLER                         PIC X(248).
  3504
  3505
  3506****************************************************************
  3507*             AH EDIT MASTER RECORD                            *
  3508****************************************************************
  3509
  3510     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3511         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3512             20  CF-AH-CODE-IN              PIC XXX.
  3513             20  CF-AH-CODE-OUT             PIC XX.
  3514         16  FILLER                         PIC X(248).
  3515
  3516
  3517****************************************************************
  3518*             CREDIBILITY TABLES                               *
  3519****************************************************************
  3520
  3521     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3522         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  63
* EL6316.cbl
  3523                             INDEXED BY CF-CRDB-NDX.
  3524             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3525             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3526             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3527         16  FILLER                         PIC  X(332).
  3528
  3529
  3530****************************************************************
  3531*             REPORT CUSTOMIZATION RECORD                      *
  3532****************************************************************
  3533
  3534     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3535         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3536             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3537             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3538             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3539**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3540****       A T-TRANSFER.                                   ****
  3541             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3542
  3543         16  FILLER                         PIC XX.
  3544
  3545         16  CF-CARRIER-CNTL-OPT.
  3546             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3547                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3548                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3549             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3550                                            PIC X.
  3551         16  CF-GROUP-CNTL-OPT.
  3552             20  CF-GROUP-OPT-SEQ           PIC 9.
  3553                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3554                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3555             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3556                                            PIC X(6).
  3557         16  CF-STATE-CNTL-OPT.
  3558             20  CF-STATE-OPT-SEQ           PIC 9.
  3559                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3560                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3561             20  CF-STATE-SELECT OCCURS 3 TIMES
  3562                                            PIC XX.
  3563         16  CF-ACCOUNT-CNTL-OPT.
  3564             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3565                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3566                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3567             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3568                                            PIC X(10).
  3569         16  CF-BUS-TYP-CNTL-OPT.
  3570             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3571                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3572                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3573             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3574                                            PIC XX.
  3575         16  CF-LF-TYP-CNTL-OPT.
  3576             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3577                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3578                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3579             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3580                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  64
* EL6316.cbl
  3581         16  CF-AH-TYP-CNTL-OPT.
  3582             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3583                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3584                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3585             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3586                                            PIC XX.
  3587         16  CF-REPTCD1-CNTL-OPT.
  3588             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3589                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3590                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3591             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3592                                            PIC X(10).
  3593         16  CF-REPTCD2-CNTL-OPT.
  3594             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3595                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3596                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3597             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3598                                            PIC X(10).
  3599         16  CF-USER1-CNTL-OPT.
  3600             20  CF-USER1-OPT-SEQ           PIC 9.
  3601                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3602                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3603             20  CF-USER1-SELECT OCCURS 3 TIMES
  3604                                            PIC X(10).
  3605         16  CF-USER2-CNTL-OPT.
  3606             20  CF-USER2-OPT-SEQ           PIC 9.
  3607                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3608                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3609             20  CF-USER2-SELECT OCCURS 3 TIMES
  3610                                            PIC X(10).
  3611         16  CF-USER3-CNTL-OPT.
  3612             20  CF-USER3-OPT-SEQ           PIC 9.
  3613                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3614                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3615             20  CF-USER3-SELECT OCCURS 3 TIMES
  3616                                            PIC X(10).
  3617         16  CF-USER4-CNTL-OPT.
  3618             20  CF-USER4-OPT-SEQ           PIC 9.
  3619                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3620                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3621             20  CF-USER4-SELECT OCCURS 3 TIMES
  3622                                            PIC X(10).
  3623         16  CF-USER5-CNTL-OPT.
  3624             20  CF-USER5-OPT-SEQ           PIC 9.
  3625                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3626                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3627             20  CF-USER5-SELECT OCCURS 3 TIMES
  3628                                            PIC X(10).
  3629         16  CF-REINS-CNTL-OPT.
  3630             20  CF-REINS-OPT-SEQ           PIC 9.
  3631                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3632                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3633             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3634                 24  CF-REINS-PRIME         PIC XXX.
  3635                 24  CF-REINS-SUB           PIC XXX.
  3636
  3637         16  CF-AGENT-CNTL-OPT.
  3638             20  CF-AGENT-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  65
* EL6316.cbl
  3639                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3640                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3641             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3642                                            PIC X(10).
  3643
  3644         16  FILLER                         PIC X(43).
  3645
  3646         16  CF-LOSS-RATIO-SELECT.
  3647             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3648             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3649         16  CF-ENTRY-DATE-SELECT.
  3650             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3651             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3652         16  CF-EFFECTIVE-DATE-SELECT.
  3653             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3654             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3655
  3656         16  CF-EXCEPTION-LIST-IND          PIC X.
  3657             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3658
  3659         16  FILLER                         PIC X(318).
  3660
  3661****************************************************************
  3662*                  EXCEPTION REPORTING RECORD                  *
  3663****************************************************************
  3664
  3665     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3666         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3667             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3668
  3669         16  CF-COMBINED-LIFE-AH-OPT.
  3670             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3671             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3672             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3673             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3674
  3675         16  CF-LIFE-OPT.
  3676             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3677             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3678             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3679             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3680             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3681             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3682             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3683             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3684             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3685             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3686
  3687         16  CF-AH-OPT.
  3688             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3689             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3690             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3691             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3692             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3693             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3694             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3695             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3696             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  66
* EL6316.cbl
  3697             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3698
  3699         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3700             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3701             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3702             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3703
  3704         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3705
  3706         16  FILLER                         PIC X(673).
  3707
  3708
  3709****************************************************************
  3710*             MORTGAGE SYSTEM PLAN RECORD                      *
  3711****************************************************************
  3712
  3713     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3714         16  CF-PLAN-TYPE                   PIC X.
  3715             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3716             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3717             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3718         16  CF-PLAN-ABBREV                 PIC XXX.
  3719         16  CF-PLAN-DESCRIPT               PIC X(10).
  3720         16  CF-PLAN-NOTES                  PIC X(20).
  3721         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3722         16  CF-PLAN-UNDERWRITING.
  3723             20  CF-PLAN-TERM-DATA.
  3724                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3725                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3726             20  CF-PLAN-AGE-DATA.
  3727                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3728                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3729                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3730             20  CF-PLAN-BENEFIT-DATA.
  3731                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3732                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3733                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3734                                            PIC S9(7)V99  COMP-3.
  3735         16  CF-PLAN-POLICY-FORMS.
  3736             20  CF-POLICY-FORM             PIC X(12).
  3737             20  CF-MASTER-APPLICATION      PIC X(12).
  3738             20  CF-MASTER-POLICY           PIC X(12).
  3739         16  CF-PLAN-RATING.
  3740             20  CF-RATE-CODE               PIC X(5).
  3741             20  CF-SEX-RATING              PIC X.
  3742                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3743                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3744             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3745             20  CF-SUB-STD-TYPE            PIC X.
  3746                 88  CF-PCT-OF-PREM            VALUE '1'.
  3747                 88  CF-PCT-OF-BENE            VALUE '2'.
  3748         16  CF-PLAN-PREM-TOLERANCES.
  3749             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3750             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3751         16  CF-PLAN-PYMT-TOLERANCES.
  3752             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3753             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3754         16  CF-PLAN-MISC-DATA.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  67
* EL6316.cbl
  3755             20  FILLER                     PIC X.
  3756             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3757             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3758         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3759         16  CF-PLAN-IND-GRP                PIC X.
  3760             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3761                                                     '1'.
  3762             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3763                                                     '2'.
  3764         16  CF-MIB-SEARCH-SW               PIC X.
  3765             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3766             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3767             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3768             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3769         16  CF-ALPHA-SEARCH-SW             PIC X.
  3770             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3771             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3772             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3773             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3774             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3775             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3776             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3777             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3778             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3779             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3780                                                     'A' 'B' 'C'
  3781                                                     'X' 'Y' 'Z'.
  3782         16  CF-EFF-DT-RULE-SW              PIC X.
  3783             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3784             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3785             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3786             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3787             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3788         16  FILLER                         PIC X(4).
  3789         16  CF-HEALTH-QUESTIONS            PIC X.
  3790             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3791         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3792         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3793         16  CF-PLAN-SNGL-JNT               PIC X.
  3794             88  CF-COMBINED-PLAN              VALUE 'C'.
  3795             88  CF-JNT-PLAN                   VALUE 'J'.
  3796             88  CF-SNGL-PLAN                  VALUE 'S'.
  3797         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3798         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3799         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3800         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3801         16  CF-RERATE-CNTL                 PIC  X.
  3802             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3803             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3804             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3805             88  CF-AUTO-RECALC                 VALUE '4'.
  3806         16  CF-BENEFIT-TYPE                PIC  X.
  3807             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3808             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3809         16  CF-POLICY-FEE                  PIC S999V99
  3810                                                    COMP-3.
  3811         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3812         16  CF-2ND-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  68
* EL6316.cbl
  3813         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3814         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3815         16  FILLER                         PIC  X(32).
  3816         16  CF-TERMINATION-FORM            PIC  X(04).
  3817         16  FILLER                         PIC  X(08).
  3818         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3819                                                       COMP-3.
  3820         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3821         16  CF-ISSUE-LETTER                PIC  X(4).
  3822         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3823         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3824             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3825             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3826         16  CF-MP-REFUND-CALC              PIC X.
  3827             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3828             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3829             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3830             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3831             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3832             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3833             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3834             88  CF-MP-REFD-MEAN                VALUE '8'.
  3835         16  CF-ALT-RATE-CODE               PIC  X(5).
  3836
  3837
  3838         16  FILLER                         PIC X(498).
  3839****************************************************************
  3840*             MORTGAGE COMPANY MASTER RECORD                   *
  3841****************************************************************
  3842
  3843     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3844         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3845         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3846             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3847             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3848             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3849             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3850             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3851
  3852         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3853         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3854         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3855         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3856         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3857
  3858         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3859             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3860         16  CF-MP-RECON-USE-IND            PIC X(1).
  3861             88  CF-MP-USE-RECON             VALUE 'Y'.
  3862         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3863             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3864         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3865             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3866             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3867         16  FILLER                         PIC X(1).
  3868         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3869             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3870         16  CF-MORTG-MIB-VERSION           PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  69
* EL6316.cbl
  3871             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3872             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3873             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3874         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3875             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3876                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3877             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3878                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3879             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3880                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3881             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3882                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3883             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3884                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3885             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3886                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3887         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3888         16  FILLER                         PIC X(7).
  3889         16  CF-MORTG-DESTINATION-SYMBOL.
  3890             20  CF-MORTG-MIB-COMM          PIC X(5).
  3891             20  CF-MORTG-MIB-TERM          PIC X(5).
  3892         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3893             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3894         16  FILLER                         PIC X(03).
  3895         16  CF-MP-CHECK-NO-CONTROL.
  3896             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3897                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3898                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3899                                                ' ' LOW-VALUES.
  3900                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3901                                               VALUE '3'.
  3902         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3903         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3904         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3905             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3906                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3907             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3908                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3909             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3910                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3911             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3912                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3913             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3914                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3915             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3916                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3917         16  CF-MORTG-BILLING-AREA.
  3918             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3919                                            PIC X.
  3920         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3921         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3922         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3923         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3924             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3925             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3926         16  FILLER                         PIC X.
  3927         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3928             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  70
* EL6316.cbl
  3929             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3930         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3931         16  FILLER                         PIC X(8).
  3932         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3933         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3934         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3935         16  CF-ACH-COMPANY-ID.
  3936             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3937                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3938                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3939                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3940             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3941         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3942             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3943         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3944             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3945             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3946         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3947         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3948         16  FILLER                         PIC X(536).
  3949
  3950****************************************************************
  3951*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3952****************************************************************
  3953
  3954     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3955         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3956             20  CF-FEMALE-HEIGHT.
  3957                 24  CF-FEMALE-FT           PIC 99.
  3958                 24  CF-FEMALE-IN           PIC 99.
  3959             20  CF-FEMALE-MIN-WT           PIC 999.
  3960             20  CF-FEMALE-MAX-WT           PIC 999.
  3961         16  FILLER                         PIC X(428).
  3962
  3963     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3964         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3965             20  CF-MALE-HEIGHT.
  3966                 24  CF-MALE-FT             PIC 99.
  3967                 24  CF-MALE-IN             PIC 99.
  3968             20  CF-MALE-MIN-WT             PIC 999.
  3969             20  CF-MALE-MAX-WT             PIC 999.
  3970         16  FILLER                         PIC X(428).
  3971******************************************************************
  3972*             AUTOMATIC ACTIVITY RECORD                          *
  3973******************************************************************
  3974     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3975         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3976             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3977             20  CF-SYS-LETTER-ID           PIC X(04).
  3978             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3979             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3980             20  CF-SYS-RESET-SW            PIC X(01).
  3981             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3982             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3983
  3984         16  FILLER                         PIC X(50).
  3985
  3986         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  71
* EL6316.cbl
  3987             20  CF-USER-ACTIVE-SW          PIC X(01).
  3988             20  CF-USER-LETTER-ID          PIC X(04).
  3989             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3990             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3991             20  CF-USER-RESET-SW           PIC X(01).
  3992             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3993             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3994             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3995
  3996         16  FILLER                         PIC X(246).
  3997*                                COPY ERCPNDB.
  3998******************************************************************
  3999*                                                                *
  4000*                                                                *
  4001*                            ERCPNDB.                            *
  4002*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4003*                            VMOD=2.025                          *
  4004*                                                                *
  4005*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4006*                                                                *
  4007******************************************************************
  4008*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4009*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4010******************************************************************
  4011*                                                                *
  4012*                                                                *
  4013*   FILE TYPE = VSAM,KSDS                                        *
  4014*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4015*                                                                *
  4016*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4017*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4018*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4019*                                                 RKP=13,LEN=36  *
  4020*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4021*                                      AND CHG-SEQ.)             *
  4022*                                                RKP=49,LEN=11   *
  4023*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4024*                                      AND CHG-SEQ.)             *
  4025*                                                RKP=60,LEN=15   *
  4026*                                                                *
  4027*   LOG = NO                                                     *
  4028*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4029******************************************************************
  4030******************************************************************
  4031*                   C H A N G E   L O G
  4032*
  4033* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4034*-----------------------------------------------------------------
  4035*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4036* EFFECTIVE    NUMBER
  4037*-----------------------------------------------------------------
  4038* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4039* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4040* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4041* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4042* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4043* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4044* 032306                   PEMA  ADD BOW LOAN NUMBER
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  72
* EL6316.cbl
  4045* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4046* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4047* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4048* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4049* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4050* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4051* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4052* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4053* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4054* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4055* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4056******************************************************************
  4057
  4058 01  PENDING-BUSINESS.
  4059     12  PB-RECORD-ID                     PIC XX.
  4060         88  VALID-PB-ID                        VALUE 'PB'.
  4061
  4062     12  PB-CONTROL-PRIMARY.
  4063         16  PB-COMPANY-CD                PIC X.
  4064         16  PB-ENTRY-BATCH               PIC X(6).
  4065         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4066         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4067
  4068     12  PB-CONTROL-BY-ACCOUNT.
  4069         16  PB-COMPANY-CD-A1             PIC X.
  4070         16  PB-CARRIER                   PIC X.
  4071         16  PB-GROUPING.
  4072             20  PB-GROUPING-PREFIX       PIC XXX.
  4073             20  PB-GROUPING-PRIME        PIC XXX.
  4074         16  PB-STATE                     PIC XX.
  4075         16  PB-ACCOUNT.
  4076             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4077             20  PB-ACCOUNT-PRIME         PIC X(6).
  4078         16  PB-CERT-EFF-DT               PIC XX.
  4079         16  PB-CERT-NO.
  4080             20  PB-CERT-PRIME            PIC X(10).
  4081             20  PB-CERT-SFX              PIC X.
  4082         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4083
  4084         16  PB-RECORD-TYPE               PIC X.
  4085             88  PB-MAILING-DATA                VALUE '0'.
  4086             88  PB-ISSUE                       VALUE '1'.
  4087             88  PB-CANCELLATION                VALUE '2'.
  4088             88  PB-BATCH-TRAILER               VALUE '9'.
  4089
  4090     12  PB-CONTROL-BY-ORIG-BATCH.
  4091         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4092         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4093         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4094         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4095
  4096     12  PB-CONTROL-BY-CSR.
  4097         16  PB-CSR-COMPANY-CD            PIC X.
  4098         16  PB-CSR-ID                    PIC X(4).
  4099         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4100         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4101         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4102******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  73
* EL6316.cbl
  4103*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4104******************************************************************
  4105
  4106     12  PB-LAST-MAINT-DT                 PIC XX.
  4107     12  PB-LAST-MAINT-BY                 PIC X(4).
  4108     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4109
  4110     12  PB-RECORD-BODY                   PIC X(375).
  4111
  4112     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4113         16  PB-CERT-ORIGIN               PIC X.
  4114             88  CLASIC-CREATED-CERT         VALUE '1'.
  4115         16  PB-I-NAME.
  4116             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4117             20  PB-I-INSURED-FIRST-NAME.
  4118                 24  PB-I-INSURED-1ST-INIT PIC X.
  4119                 24  FILLER                PIC X(9).
  4120             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4121         16  PB-I-AGE                     PIC S99   COMP-3.
  4122         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4123         16  PB-I-BIRTHDAY                PIC XX.
  4124         16  PB-I-INSURED-SEX             PIC X.
  4125             88  PB-SEX-MALE     VALUE 'M'.
  4126             88  PB-SEX-FEMALE   VALUE 'F'.
  4127
  4128         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4129         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4130         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4131         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4132         16  PB-I-SKIP-CODE               PIC X.
  4133             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4134             88  PB-SKIP-JULY              VALUE '1'.
  4135             88  PB-SKIP-AUGUST            VALUE '2'.
  4136             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4137             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4138             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4139             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4140             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4141             88  PB-SKIP-JUNE              VALUE '8'.
  4142             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4143             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4144             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4145         16  PB-I-TERM-TYPE               PIC X.
  4146             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4147             88  PB-PAID-WEEKLY            VALUE 'W'.
  4148             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4149             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4150             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4151         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4152         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4153         16  PB-I-DATA-ENTRY-SW           PIC X.
  4154             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4155             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4156             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4157             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4158         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4159         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4160*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  74
* EL6316.cbl
  4161         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4162         16  FILLER                       PIC X.
  4163
  4164         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4165             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4166             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4167                                                   '90' THRU '99'.
  4168         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4169                                          PIC XX.
  4170         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4171         16  PB-I-AMOUNT-FINANCED REDEFINES
  4172                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4173         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4174         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4175                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4176         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4177         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4178         16  PB-I-CLP-AMOUNT REDEFINES
  4179                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4180         16  PB-I-LF-CALC-FLAG            PIC X.
  4181             88 PB-COMP-LF-PREM               VALUE '?'.
  4182         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4183         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4184         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4185         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4186         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4187         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4188         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4189         16  PB-I-LF-ABBR                 PIC XXX.
  4190         16  PB-I-LF-INPUT-CD             PIC XX.
  4191
  4192         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4193             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4194             88  PB-INVALID-AH               VALUE '  ' '00'
  4195                                                   '90' THRU '99'.
  4196         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4197         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4198         16  PB-I-AH-CALC-FLAG            PIC X.
  4199             88 PB-COMP-AH-PREM                  VALUE '?'.
  4200         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4201         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4202         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4203         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4204         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4205         16  PB-I-AH-ABBR                 PIC XXX.
  4206         16  PB-I-AH-INPUT-CD             PIC XXX.
  4207
  4208         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4209         16  PB-I-REIN-TABLE              PIC XXX.
  4210         16  PB-I-BUSINESS-TYPE           PIC 99.
  4211         16  PB-I-INDV-GRP-CD             PIC X.
  4212         16  PB-I-MORT-CODE.
  4213             20  PB-I-TABLE               PIC X.
  4214             20  PB-I-INTEREST            PIC XX.
  4215             20  PB-I-MORT-TYP            PIC X.
  4216         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4217         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4218         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  75
* EL6316.cbl
  4219         16  PB-I-INDV-GRP-OVRD           PIC X.
  4220         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4221         16  PB-I-SIG-SW                  PIC X.
  4222             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4223         16  PB-I-RATE-CLASS              PIC XX.
  4224         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4225         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4226         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4227         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4228         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4229         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4230         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4231         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4232         16  PB-I-OB-FLAG                 PIC X.
  4233             88  PB-I-OB                      VALUE 'B'.
  4234             88  PB-I-SUMMARY                 VALUE 'Z'.
  4235         16  PB-I-ENTRY-STATUS            PIC X.
  4236             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4237                                              'M' '5' '9' '2'.
  4238             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4239             88  PB-I-POLICY-PENDING          VALUE '2'.
  4240             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4241             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4242             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4243             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4244             88  PB-I-REIN-ONLY               VALUE '9'.
  4245             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4246             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4247             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4248             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4249         16  PB-I-INT-CODE                PIC X.
  4250             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4251             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4252         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4253         16  PB-I-SOC-SEC-NO              PIC X(11).
  4254         16  PB-I-MEMBER-NO               PIC X(12).
  4255         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4256*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4257         16  PB-I-OLD-LOF                 PIC XXX.
  4258         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4259         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4260         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4261         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4262         16  PB-I-LIFE-INDICATOR          PIC X.
  4263             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4264         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4265         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4266                                          PIC S9(5)V99    COMP-3.
  4267         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4268             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4269             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4270         16  PB-I-1ST-PMT-DT              PIC XX.
  4271         16  PB-I-JOINT-INSURED.
  4272             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4273             20 PB-I-JOINT-FIRST-NAME.
  4274                24  PB-I-JOINT-FIRST-INIT PIC X.
  4275                24  FILLER                PIC X(9).
  4276             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  76
* EL6316.cbl
  4277*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4278         16  PB-I-BENEFICIARY-NAME.
  4279             20  PB-I-BANK-NUMBER         PIC X(10).
  4280             20  FILLER                   PIC X(15).
  4281         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4282         16  PB-I-REFERENCE               PIC X(12).
  4283         16  FILLER REDEFINES PB-I-REFERENCE.
  4284             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4285             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4286             20  PB-I-CLP-STATE           PIC XX.
  4287         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4288             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4289             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4290             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4291         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4292         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4293         16  PB-I-RESIDENT-STATE          PIC XX.
  4294         16  PB-I-RATE-CODE               PIC X(4).
  4295         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4296         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4297         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4298         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4299         16  PB-I-BANK-NOCHRGB            PIC 99.
  4300         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4301         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4302
  4303     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4304         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4305             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4306         16  PB-C-CANCEL-ORIGIN           PIC X.
  4307             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4308         16  PB-C-LF-CANCEL-DT            PIC XX.
  4309         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4310         16  PB-C-LF-CALC-REQ             PIC X.
  4311             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4312         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4313         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4314         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4315             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4316         16  PB-C-AH-CANCEL-DT            PIC XX.
  4317         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4318         16  PB-C-AH-CALC-REQ             PIC X.
  4319             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4320         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4321         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4322         16  PB-C-LAST-NAME               PIC X(15).
  4323         16  PB-C-REFUND-SW               PIC X.
  4324             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4325             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4326         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4327         16  PB-C-PAYEE-CODE              PIC X(6).
  4328         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4329         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4330         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4331         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4332         16  PB-C-REFERENCE               PIC X(12).
  4333         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4334         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  77
* EL6316.cbl
  4335         16  PB-C-POST-CARD-IND           PIC X.
  4336         16  PB-C-CANCEL-REASON           PIC X.
  4337         16  PB-C-REF-INTERFACE-SW        PIC X.
  4338         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4339         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4340         16  FILLER                       PIC X(01).
  4341*        16  FILLER                       PIC X(18).
  4342         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4343*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4344         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4345         16  PB-CANCELED-CERT-DATA.
  4346             20  PB-CI-INSURED-NAME.
  4347                 24  PB-CI-LAST-NAME      PIC X(15).
  4348                 24  PB-CI-INITIALS       PIC XX.
  4349             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4350             20  PB-CI-INSURED-SEX        PIC X.
  4351             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4352             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4353             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4354             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4355             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4356             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4357             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4358             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4359             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4360             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4361             20  PB-CI-RATE-CLASS         PIC XX.
  4362             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4363             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4364             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4365             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4366             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4367             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4368             20  PB-CI-LF-ABBR            PIC X(3).
  4369             20  PB-CI-AH-ABBR            PIC X(3).
  4370             20  PB-CI-OB-FLAG            PIC X.
  4371                 88  PB-CI-OB                VALUE 'B'.
  4372             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4373                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4374                                           'M' '4' '5' '9' '2'.
  4375                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4376                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4377                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4378                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4379                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4380                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4381                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4382                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4383                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4384                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4385                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4386                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4387                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4388             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4389                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4390                                           'M' '4' '5' '9' '2'.
  4391                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4392                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  78
* EL6316.cbl
  4393                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4394                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4395                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4396                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4397                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4398                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4399                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4400                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4401                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4402                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4403                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4404             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4405             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4406             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4407             20  PB-CI-MEMBER-NO          PIC X(12).
  4408             20  PB-CI-INT-CODE           PIC X.
  4409                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4410                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4411             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4412             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4413             20  PB-CI-COMP-EXCP-SW       PIC X.
  4414                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4415                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4416             20  PB-CI-ENTRY-STATUS       PIC X.
  4417             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4418             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4419             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4420             20  PB-CI-DEATH-DT           PIC XX.
  4421             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4422             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4423             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4424             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4425             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4426             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4427             20  PB-CI-ENTRY-DT              PIC XX.
  4428             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4429             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4430             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4431             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4432             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4433             20  PB-CI-OLD-LOF               PIC XXX.
  4434*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4435             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4436             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4437             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4438             20  PB-CI-INDV-GRP-CD           PIC X.
  4439             20  PB-CI-BENEFICIARY-NAME.
  4440                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4441                 24  FILLER                  PIC X(15).
  4442             20  PB-CI-NOTE-SW               PIC X.
  4443             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4444             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4445             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4446             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4447             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4448             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4449             20  PB-CI-FIRST-NAME            PIC X(10).
  4450             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  79
* EL6316.cbl
  4451
  4452         16  FILLER                       PIC X(13).
  4453*032306  16  FILLER                       PIC X(27).
  4454*        16  FILLER                       PIC X(46).
  4455
  4456     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4457         16  FILLER                       PIC X(10).
  4458         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4459         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4460         16  PB-M-INSURED-MID-INIT        PIC X.
  4461         16  PB-M-INSURED-AGE             PIC 99.
  4462         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4463         16  PB-M-INSURED-SEX             PIC X.
  4464         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4465         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4466         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4467         16  PB-M-INSURED-CITY-STATE.
  4468             20  PB-M-INSURED-CITY        PIC X(28).
  4469             20  PB-M-INSURED-STATE       PIC XX.
  4470         16  PB-M-INSURED-ZIP-CODE.
  4471             20  PB-M-INSURED-ZIP-PRIME.
  4472                 24  PB-M-INSURED-ZIP-1   PIC X.
  4473                     88  PB-M-CANADIAN-POST-CODE
  4474                                             VALUE 'A' THRU 'Z'.
  4475                 24  FILLER               PIC X(4).
  4476             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4477         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4478                                        PB-M-INSURED-ZIP-CODE.
  4479             20  PM-M-INS-CAN-POST1       PIC XXX.
  4480             20  PM-M-INS-CAN-POST2       PIC XXX.
  4481             20  FILLER                   PIC XXX.
  4482         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4483         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4484         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4485         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4486         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4487         16  PB-M-CRED-BENE-CITYST.
  4488             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4489             20  PB-M-CRED-BENE-STATE     PIC XX.
  4490         16  FILLER                       PIC X(92).
  4491
  4492     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4493         16  FILLER                       PIC X(10).
  4494         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4495         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4496         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4497         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4498         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4499         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4500         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4501         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4502         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4503         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4504         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4505         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4506         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4507         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4508         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  80
* EL6316.cbl
  4509         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4510         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4511         16  PB-ACCOUNT-NAME              PIC X(30).
  4512         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4513         16  PB-REFERENCE                 PIC X(12).
  4514         16  PB-B-RECEIVED-DT             PIC XX.
  4515         16  FILLER                       PIC X(234).
  4516
  4517     12  PB-RECORD-STATUS.
  4518         16  PB-CREDIT-SELECT-DT          PIC XX.
  4519         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4520         16  PB-BILLED-DT                 PIC XX.
  4521         16  PB-BILLING-STATUS            PIC X.
  4522             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4523             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4524             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4525         16  PB-RECORD-BILL               PIC X.
  4526             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4527             88  PB-RECORD-RETURNED           VALUE 'R'.
  4528             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4529             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4530             88  PB-OVERRIDE-AH               VALUE 'A'.
  4531             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4532         16  PB-BATCH-ENTRY               PIC X.
  4533             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4534             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4535             88  PB-REISSUED-CERT             VALUE 'E'.
  4536             88  PB-CASH-CERT                 VALUE 'C'.
  4537             88  PB-MONTHLY-CERT              VALUE 'M'.
  4538             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4539             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4540             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4541         16  PB-FORCE-CODE                PIC X.
  4542             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4543             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4544             88  PB-CANCEL-FORCE              VALUE '8'.
  4545             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4546             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4547             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4548             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4549             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4550             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4551             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4552             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4553         16  PB-FATAL-FLAG                PIC X.
  4554             88  PB-FATAL-ERRORS              VALUE 'X'.
  4555         16  PB-FORCE-ER-CD               PIC X.
  4556             88  PB-FORCE-ERRORS              VALUE 'F'.
  4557             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4558         16  PB-WARN-ER-CD                PIC X.
  4559             88  PB-WARNING-ERRORS            VALUE 'W'.
  4560         16  FILLER                       PIC X.
  4561         16  PB-OUT-BAL-CD                PIC X.
  4562             88  PB-OUT-OF-BAL                VALUE 'O'.
  4563         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4564         16  PB-AH-OVERRIDE-L1            PIC X.
  4565         16  PB-INPUT-DT                  PIC XX.
  4566         16  PB-INPUT-BY                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  81
* EL6316.cbl
  4567         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4568         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4569         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4570         16  PB-LF-EARNING-METHOD         PIC X.
  4571         16  PB-AH-EARNING-METHOD         PIC X.
  4572         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4573         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4574         16  PB-REIN-CD                   PIC XXX.
  4575         16  PB-LF-REFUND-TYPE            PIC X.
  4576         16  PB-AH-REFUND-TYPE            PIC X.
  4577         16  PB-ACCT-EFF-DT               PIC XX.
  4578         16  PB-ACCT-EXP-DT               PIC XX.
  4579         16  PB-COMPANY-ID                PIC X(3).
  4580         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4581         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4582         16  PB-SV-CARRIER                PIC X.
  4583         16  PB-SV-GROUPING               PIC X(6).
  4584         16  PB-SV-STATE                  PIC XX.
  4585         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4586         16  PB-GA-BILLING-INFO.
  4587             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4588                                          PIC XX.
  4589         16  PB-SV-REMIT-TO  REDEFINES
  4590             PB-GA-BILLING-INFO           PIC X(10).
  4591         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4592         16  PB-I-LOAN-OFFICER            PIC X(5).
  4593         16  PB-I-VIN                     PIC X(17).
  4594
  4595         16  FILLER                       PIC X(04).
  4596         16  IMNET-BYPASS-SW              PIC X.
  4597
  4598******************************************************************
  4599*                COMMON EDIT ERRORS                              *
  4600******************************************************************
  4601
  4602     12  PB-COMMON-ERRORS.
  4603         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4604                                           PIC S9(4)     COMP.
  4605
  4606******************************************************************
  4607*                                COPY ELCCERT.
  4608******************************************************************
  4609*                                                                *
  4610*                            ELCCERT.                            *
  4611*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4612*                            VMOD=2.013                          *
  4613*                                                                *
  4614*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4615*                                                                *
  4616*   FILE TYPE = VSAM,KSDS                                        *
  4617*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4618*                                                                *
  4619*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4620*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4621*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4622*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4623*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4624*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  82
* EL6316.cbl
  4625*   LOG = YES                                                    *
  4626*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4627******************************************************************
  4628*                   C H A N G E   L O G
  4629*
  4630* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4631*-----------------------------------------------------------------
  4632*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4633* EFFECTIVE    NUMBER
  4634*-----------------------------------------------------------------
  4635* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4636* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4637* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4638* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4639* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4640* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4641* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4642* 032612  CR2011110200001  PEMA  AHL CHANGES
  4643* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4644* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4645******************************************************************
  4646
  4647 01  CERTIFICATE-MASTER.
  4648     12  CM-RECORD-ID                      PIC XX.
  4649         88  VALID-CM-ID                      VALUE 'CM'.
  4650
  4651     12  CM-CONTROL-PRIMARY.
  4652         16  CM-COMPANY-CD                 PIC X.
  4653         16  CM-CARRIER                    PIC X.
  4654         16  CM-GROUPING.
  4655             20  CM-GROUPING-PREFIX        PIC X(3).
  4656             20  CM-GROUPING-PRIME         PIC X(3).
  4657         16  CM-STATE                      PIC XX.
  4658         16  CM-ACCOUNT.
  4659             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4660             20  CM-ACCOUNT-PRIME          PIC X(6).
  4661         16  CM-CERT-EFF-DT                PIC XX.
  4662         16  CM-CERT-NO.
  4663             20  CM-CERT-PRIME             PIC X(10).
  4664             20  CM-CERT-SFX               PIC X.
  4665
  4666     12  CM-CONTROL-BY-NAME.
  4667         16  CM-COMPANY-CD-A1              PIC X.
  4668         16  CM-INSURED-LAST-NAME          PIC X(15).
  4669         16  CM-INSURED-INITIALS.
  4670             20  CM-INSURED-INITIAL1       PIC X.
  4671             20  CM-INSURED-INITIAL2       PIC X.
  4672
  4673     12  CM-CONTROL-BY-SSN.
  4674         16  CM-COMPANY-CD-A2              PIC X.
  4675         16  CM-SOC-SEC-NO.
  4676             20  CM-SSN-STATE              PIC XX.
  4677             20  CM-SSN-ACCOUNT            PIC X(6).
  4678             20  CM-SSN-LN3.
  4679                 25  CM-INSURED-INITIALS-A2.
  4680                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4681                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4682                 25 CM-PART-LAST-NAME-A2         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  83
* EL6316.cbl
  4683
  4684     12  CM-CONTROL-BY-CERT-NO.
  4685         16  CM-COMPANY-CD-A4              PIC X.
  4686         16  CM-CERT-NO-A4                 PIC X(11).
  4687
  4688     12  CM-CONTROL-BY-MEMB.
  4689         16  CM-COMPANY-CD-A5              PIC X.
  4690         16  CM-MEMBER-NO.
  4691             20  CM-MEMB-STATE             PIC XX.
  4692             20  CM-MEMB-ACCOUNT           PIC X(6).
  4693             20  CM-MEMB-LN4.
  4694                 25  CM-INSURED-INITIALS-A5.
  4695                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4696                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4697                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4698
  4699     12  CM-INSURED-PROFILE-DATA.
  4700         16  CM-INSURED-FIRST-NAME.
  4701             20  CM-INSURED-1ST-INIT       PIC X.
  4702             20  FILLER                    PIC X(9).
  4703         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4704         16  CM-INSURED-SEX                PIC X.
  4705             88  CM-SEX-MALE                  VALUE 'M'.
  4706             88  CM-SEX-FEMAL                 VALUE 'F'.
  4707         16  CM-INSURED-JOINT-AGE          PIC 99.
  4708         16  CM-JOINT-INSURED-NAME.
  4709             20  CM-JT-LAST-NAME           PIC X(15).
  4710             20  CM-JT-FIRST-NAME.
  4711                 24  CM-JT-1ST-INIT        PIC X.
  4712                 24  FILLER                PIC X(9).
  4713             20  CM-JT-INITIAL             PIC X.
  4714
  4715     12  CM-LIFE-DATA.
  4716         16  CM-LF-BENEFIT-CD              PIC XX.
  4717         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4718         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4719         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4720         16  CM-LF-DEV-CODE                PIC XXX.
  4721         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4722         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4723         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4724         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4725         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4726         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4727         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4728         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4729         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4730         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4731         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4732         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4733         16  cm-temp-epiq                  pic xx.
  4734             88  EPIQ-CLASS                  value 'EQ'.
  4735*        16  FILLER                        PIC XX.
  4736
  4737     12  CM-AH-DATA.
  4738         16  CM-AH-BENEFIT-CD              PIC XX.
  4739         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4740         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  84
* EL6316.cbl
  4741         16  CM-AH-DEV-CODE                PIC XXX.
  4742         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4743         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4744         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4745         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4746         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4747         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4748         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4749         16  CM-AH-PAID-THRU-DT            PIC XX.
  4750             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4751         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4752         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4753         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4754         16  FILLER                        PIC X.
  4755
  4756     12  CM-LOAN-INFORMATION.
  4757         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4758         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4759                                           PIC S9(5)V99  COMP-3.
  4760         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4761         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4762         16  CM-PAY-FREQUENCY              PIC S99.
  4763         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4764         16  CM-RATE-CLASS                 PIC XX.
  4765         16  CM-BENEFICIARY                PIC X(25).
  4766         16  CM-POLICY-FORM-NO             PIC X(12).
  4767         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4768         16  CM-LAST-ADD-ON-DT             PIC XX.
  4769         16  CM-DEDUCTIBLE-AMOUNTS.
  4770             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4771             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4772         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4773             20  CM-RESIDENT-STATE         PIC XX.
  4774             20  CM-RATE-CODE              PIC X(4).
  4775             20  FILLER                    PIC XX.
  4776         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4777             20  CM-LOAN-OFFICER           PIC X(5).
  4778             20  FILLER                    PIC XXX.
  4779         16  CM-CSR-CODE                   PIC XXX.
  4780         16  CM-UNDERWRITING-CODE          PIC X.
  4781             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4782         16  CM-POST-CARD-IND              PIC X.
  4783         16  CM-NH-INTERFACE-SW            PIC X.
  4784         16  CM-PREMIUM-TYPE               PIC X.
  4785             88  CM-SING-PRM                  VALUE '1'.
  4786             88  CM-O-B-COVERAGE              VALUE '2'.
  4787             88  CM-OPEN-END                  VALUE '3'.
  4788         16  CM-IND-GRP-TYPE               PIC X.
  4789             88  CM-INDIVIDUAL                VALUE 'I'.
  4790             88  CM-GROUP                     VALUE 'G'.
  4791         16  CM-SKIP-CODE                  PIC X.
  4792             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4793             88  SKIP-JULY                    VALUE '1'.
  4794             88  SKIP-AUGUST                  VALUE '2'.
  4795             88  SKIP-SEPTEMBER               VALUE '3'.
  4796             88  SKIP-JULY-AUG                VALUE '4'.
  4797             88  SKIP-AUG-SEPT                VALUE '5'.
  4798             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  85
* EL6316.cbl
  4799             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4800             88  SKIP-JUNE                    VALUE '8'.
  4801             88  SKIP-JUNE-JULY               VALUE '9'.
  4802             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4803             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4804         16  CM-PAYMENT-MODE               PIC X.
  4805             88  PAY-MONTHLY                  VALUE SPACE.
  4806             88  PAY-WEEKLY                   VALUE '1'.
  4807             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4808             88  PAY-BI-WEEKLY                VALUE '3'.
  4809             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4810         16  CM-LOAN-NUMBER                PIC X(8).
  4811         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4812         16  CM-OLD-LOF                    PIC XXX.
  4813*        16  CM-LOAN-OFFICER               PIC XXX.
  4814         16  CM-REIN-TABLE                 PIC XXX.
  4815         16  CM-SPECIAL-REIN-CODE          PIC X.
  4816         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4817         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4818         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4819
  4820     12  CM-STATUS-DATA.
  4821         16  CM-ENTRY-STATUS               PIC X.
  4822         16  CM-ENTRY-DT                   PIC XX.
  4823
  4824         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4825         16  CM-LF-CANCEL-DT               PIC XX.
  4826         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4827
  4828         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4829         16  CM-LF-DEATH-DT                PIC XX.
  4830         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4831
  4832         16  CM-LF-CURRENT-STATUS          PIC X.
  4833             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4834                                                'M' '4' '5' '9'.
  4835             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4836             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4837             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4838             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4839             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4840             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4841             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4842             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4843             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4844             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4845             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4846             88  CM-LF-DECLINED               VALUE 'D'.
  4847             88  CM-LF-VOIDED                 VALUE 'V'.
  4848
  4849         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4850         16  CM-AH-CANCEL-DT               PIC XX.
  4851         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4852
  4853         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4854         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4855         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4856
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  86
* EL6316.cbl
  4857         16  CM-AH-CURRENT-STATUS          PIC X.
  4858             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4859                                                'M' '4' '5' '9'.
  4860             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4861             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4862             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4863             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4864             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4865             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4866             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4867             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4868             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4869             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4870             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4871             88  CM-AH-DECLINED               VALUE 'D'.
  4872             88  CM-AH-VOIDED                 VALUE 'V'.
  4873
  4874         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4875             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4876             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4877             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4878         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4879
  4880         16  CM-ENTRY-BATCH                PIC X(6).
  4881         16  CM-LF-EXIT-BATCH              PIC X(6).
  4882         16  CM-AH-EXIT-BATCH              PIC X(6).
  4883         16  CM-LAST-MONTH-END             PIC XX.
  4884
  4885     12  CM-NOTE-SW                        PIC X.
  4886         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4887         88  CERT-NOTES-PRESENT               VALUE '1'.
  4888         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4889         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4890         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4891         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4892         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4893         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4894     12  CM-COMP-EXCP-SW                   PIC X.
  4895         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4896         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4897     12  CM-INSURED-ADDRESS-SW             PIC X.
  4898         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4899         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4900
  4901*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4902     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4903     12  FILLER                            PIC X.
  4904
  4905*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4906     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4907     12  FILLER                            PIC X.
  4908*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4909     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4910
  4911     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4912         88  CERT-ADDED-BATCH                 VALUE ' '.
  4913         88  CERT-ADDED-ONLINE                VALUE '1'.
  4914         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  87
* EL6316.cbl
  4915         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4916         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4917     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4918         88  CERT-AS-LOADED                   VALUE ' '.
  4919         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4920         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4921         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4922         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4923         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4924         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4925         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4926
  4927     12  CM-ACCOUNT-COMM-PCTS.
  4928         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4929         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4930
  4931     12  CM-USER-FIELD                     PIC X.
  4932     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4933     12  CM-CLP-STATE                      PIC XX.
  4934     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4935     12  CM-USER-RESERVED                  PIC XXX.
  4936     12  FILLER REDEFINES CM-USER-RESERVED.
  4937         16  CM-AH-CLASS-CD                PIC XX.
  4938         16  F                             PIC X.
  4939******************************************************************
  4940*                                COPY ELCCRTO.
  4941******************************************************************
  4942*                                                                *
  4943*                            ELCCRTO.                            *
  4944*                                                                *
  4945*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4946*                                                                *
  4947*   FILE TYPE = VSAM,KSDS                                        *
  4948*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4949*                                                                *
  4950*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4951*                                                                *
  4952*   LOG = YES                                                    *
  4953*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4954******************************************************************
  4955*                   C H A N G E   L O G
  4956*
  4957* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4958*-----------------------------------------------------------------
  4959*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4960* EFFECTIVE    NUMBER
  4961*-----------------------------------------------------------------
  4962* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4963* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4964* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4965* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4966* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  4967******************************************************************
  4968 01  ORIGINAL-CERTIFICATE.
  4969     12  OC-RECORD-ID                      PIC XX.
  4970         88  VALID-OC-ID                      VALUE 'OC'.
  4971     12  OC-CONTROL-PRIMARY.
  4972         16  OC-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  88
* EL6316.cbl
  4973         16  OC-CARRIER                    PIC X.
  4974         16  OC-GROUPING                   PIC X(6).
  4975         16  OC-STATE                      PIC XX.
  4976         16  OC-ACCOUNT                    PIC X(10).
  4977         16  OC-CERT-EFF-DT                PIC XX.
  4978         16  OC-CERT-NO.
  4979             20  OC-CERT-PRIME             PIC X(10).
  4980             20  OC-CERT-SFX               PIC X.
  4981         16  OC-RECORD-TYPE                PIC X.
  4982         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4983     12  OC-LAST-MAINT-DT                  PIC XX.
  4984     12  OC-LAST-MAINT-BY                  PIC X(4).
  4985     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4986     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4987     12  FILLER                            PIC X(49).
  4988     12  OC-ORIG-REC.
  4989         16  OC-INS-LAST-NAME              PIC X(15).
  4990         16  OC-INS-FIRST-NAME             PIC X(10).
  4991         16  OC-INS-MIDDLE-INIT            PIC X.
  4992         16  OC-INS-AGE                    PIC S999     COMP-3.
  4993         16  OC-JNT-LAST-NAME              PIC X(15).
  4994         16  OC-JNT-FIRST-NAME             PIC X(10).
  4995         16  OC-JNT-MIDDLE-INIT            PIC X.
  4996         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4997         16  OC-LF-BENCD                   PIC XX.
  4998         16  OC-LF-TERM                    PIC S999      COMP-3.
  4999         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5000         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5001         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5002         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5003         16  OC-LF-EXP-DT                  PIC XX.
  5004         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5005         16  OC-LF-CANCEL-DT               PIC XX.
  5006         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5007         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5008         16  OC-AH-BENCD                   PIC XX.
  5009         16  OC-AH-TERM                    PIC S999      COMP-3.
  5010         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5011         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5012         16  OC-AH-EXP-DT                  PIC XX.
  5013         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5014         16  OC-AH-CP                      PIC 99.
  5015         16  OC-AH-CANCEL-DT               PIC XX.
  5016         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5017         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5018         16  OC-CRED-BENE-NAME             PIC X(25).
  5019         16  OC-1ST-PMT-DT                 PIC XX.
  5020         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5021         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5022         16  OC-ISSUE-TRAN-IND             PIC X.
  5023         16  OC-CANCEL-TRAN-IND            PIC X.
  5024         16  FILLER                        PIC X(211).
  5025
  5026     12  FILLER                            PIC X(50).
  5027******************************************************************
  5028*                                COPY ERCENDT.
  5029******************************************************************
  5030*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  89
* EL6316.cbl
  5031*                                                                *
  5032*                            ERCENDT.                            *
  5033*                            VMOD=2.001                          *
  5034*                                                                *
  5035*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  5036*                                                                *
  5037*   FILE TYPE = VSAM,KSDS                                        *
  5038*   RECORD SIZE = 579  RECFORM = FIXED                           *
  5039*                                                                *
  5040*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  5041*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  5042*                                                                *
  5043*   LOG = NO                                                     *
  5044*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5045******************************************************************
  5046*-----------------------------------------------------------------
  5047*                   C H A N G E   L O G
  5048*
  5049* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5050*-----------------------------------------------------------------
  5051*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5052* EFFECTIVE    NUMBER
  5053*-----------------------------------------------------------------
  5054* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  5055*                                WITH OPEN CLAIMS
  5056* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  5057* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5058* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5059* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  5060*-----------------------------------------------------------------
  5061 01  ENDORSEMENT-RECORD.
  5062     12  EN-RECORD-ID                PIC XX.
  5063         88  VALID-EN-ID                VALUE 'EN'.
  5064     12  EN-CONTROL-PRIMARY.
  5065         16  EN-COMPANY-CD           PIC X.
  5066         16  EN-CARRIER              PIC X.
  5067         16  EN-GROUPING             PIC X(6).
  5068         16  EN-STATE                PIC XX.
  5069         16  EN-ACCOUNT              PIC X(10).
  5070         16  EN-CERT-EFF-DT          PIC XX.
  5071         16  EN-CERT-NO.
  5072             20  EN-CERT-PRIME       PIC X(10).
  5073             20  EN-CERT-SFX         PIC X.
  5074         16  EN-REC-TYPE             PIC X.
  5075             88  EN-ISSUE               VALUE 'I'.
  5076             88  EN-CANCELLATION        VALUE 'C'.
  5077         16  EN-SEQ-NO               PIC 9(04) BINARY.
  5078     12  EN-CONTROL-BY-ARCH-NO.
  5079         16  EN-COMPANY-CD-A1              PIC X.
  5080         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  5081     12  EN-LAST-MAINT-DT            PIC XX.
  5082     12  EN-LAST-MAINT-BY            PIC X(4).
  5083     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  5084     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  5085     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5086         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  5087         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  5088         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  90
* EL6316.cbl
  5089         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  5090         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  5091         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  5092         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  5093         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  5094         16  EN-LF-ORIG-BENCD        PIC XX.
  5095         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  5096         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5097         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5098         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  5099         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  5100         16  EN-LF-ORIG-EXP-DT       PIC XX.
  5101*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  5102         16  EN-ORIG-CRED-BENE       PIC X(25).
  5103         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5104         16  FILLER                  PIC X.
  5105         16  EN-AH-ORIG-BENCD        PIC XX.
  5106         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  5107         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5108         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5109         16  EN-AH-ORIG-EXP-DT       PIC XX.
  5110*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  5111*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  5112         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5113         16  F                       PIC X(09).
  5114         16  EN-AH-ORIG-CP           PIC 99.
  5115         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  5116         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  5117         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  5118         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  5119         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  5120         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  5121         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  5122         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  5123         16  EN-LF-NEW-BENCD         PIC XX.
  5124         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5125         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5126         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5127         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5128         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  5129         16  EN-LF-NEW-EXP-DT        PIC XX.
  5130         16  EN-NEW-CRED-BENE        PIC X(25).
  5131         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5132         16  FILLER                  PIC X.
  5133         16  EN-AH-NEW-BENCD         PIC XX.
  5134         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5135         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5136         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5137         16  EN-AH-NEW-EXP-DT        PIC XX.
  5138*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5139*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5140*        16  F                       PIC X(12).
  5141         16  EN-AH-NEW-CP            PIC 99.
  5142         16  EN-SIG-SW               PIC X.
  5143         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5144         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  5145         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5146         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  91
* EL6316.cbl
  5147         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5148         16  FILLER                  PIC X(33).
  5149     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5150         16  EN-LF-ORIG-REF-DT       PIC XX.
  5151         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5152         16  EN-AH-ORIG-REF-DT       PIC XX.
  5153         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5154         16  EN-LF-NEW-REF-DT        PIC XX.
  5155         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5156         16  EN-AH-NEW-REF-DT        PIC XX.
  5157         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5158         16  EN-FLAG-CERT            PIC X.
  5159         16  EN-INS-LAST-NAME        PIC X(15).
  5160         16  EN-INS-FIRST-NAME       PIC X(10).
  5161         16  EN-INS-MIDDLE-INIT      PIC X.
  5162         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5163         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5164         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5165         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5166         16  FILLER                  PIC X(262).
  5167     12  EN-MONEY-SW             PIC X.
  5168     12  EN-HEALTH-APP           PIC X.
  5169     12  EN-VOUCHER-SW           PIC X.
  5170     12  EN-PAYEE                PIC X(14).
  5171     12  EN-INPUT-DT             PIC XX.
  5172     12  EN-PROCESS-DT           PIC XX.
  5173     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5174     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5175     12  EN-REASON-CODES.
  5176         16  F OCCURS 12.
  5177             20  EN-REASON-CODE  PIC X(4).
  5178     12  EN-TEMPLATE-USED        PIC X(8).
  5179     12  EN-DOCU-TYPE            PIC X.
  5180         88  EN-VERI-DOCU          VALUE 'V'.
  5181         88  EN-GCE-DOCU           VALUE 'G'.
  5182         88  EN-CANC-DOCU          VALUE 'C'.
  5183     12  EN-COMMENTS1            PIC X(13).
  5184     12  EN-COMMENTS2            PIC X(70).
  5185     12  EN-COMM-CHGBK           PIC X.
  5186         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5187         88  EN-CHG-ACCT           VALUE 'Y'.
  5188     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5189     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5190     12  EN-BATCH-NUMBER         PIC X(6).
  5191     12  EN-ACCT-SUMM            PIC X.
  5192     12  EN-CSO-SUMM             PIC X.
  5193     12  en-check-type           pic x.
  5194     12  FILLER                  PIC X(12).
  5195******************************************************************
  5196*                                COPY ERCNOTE.
  5197******************************************************************
  5198*                                                                *
  5199*                                                                *
  5200*                            ERCNOTE                             *
  5201*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5202*                            VMOD=2.003                          *
  5203*                                                                *
  5204*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  92
* EL6316.cbl
  5205*                                                                *
  5206*        FILE TYPE= VSAM,KSDS                                    *
  5207*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5208*                                                                *
  5209*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5210*                                                                *
  5211*        LOG = YES                                               *
  5212*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5213*                                                                *
  5214******************************************************************
  5215*                   C H A N G E   L O G
  5216*
  5217* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5218*-----------------------------------------------------------------
  5219*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5220* EFFECTIVE    NUMBER
  5221*-----------------------------------------------------------------
  5222* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5223*                                FILE WILL CONTAIN BILLING NOTES O
  5224******************************************************************
  5225
  5226 01  CERTIFICATE-NOTE.
  5227     12  CN-RECORD-ID                PIC  XX.
  5228         88  VALID-CN-ID                  VALUE 'CN'.
  5229
  5230     12  CN-CONTROL-PRIMARY.
  5231         16  CN-COMPANY-CD           PIC X.
  5232         16  CN-CARRIER              PIC X.
  5233         16  CN-GROUPING.
  5234             20 CN-GROUPING-PREFIX   PIC XXX.
  5235             20 CN-GROUPING-PRIME    PIC XXX.
  5236         16  CN-STATE                PIC XX.
  5237         16  CN-ACCOUNT.
  5238             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5239             20 CN-ACCOUNT-PRIME     PIC X(6).
  5240         16  CN-CERT-EFF-DT          PIC XX.
  5241         16  CN-CERT-NO.
  5242             20  CN-CERT-PRIME       PIC X(10).
  5243             20  CN-CERT-SFX         PIC X.
  5244
  5245     12  CN-BILLING-START-LINE-NO    PIC 99.
  5246     12  CN-BILLING-END-LINE-NO      PIC 99.
  5247
  5248     12  CN-LINES.
  5249         16  CN-LINE OCCURS 10       PIC X(77).
  5250
  5251     12  CN-LAST-MAINT-DT            PIC XX.
  5252     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5253     12  CN-LAST-MAINT-USER          PIC X(4).
  5254     12  FILLER                      PIC X(6).
  5255******************************************************************
  5256*                                COPY ERCMAIL.
  5257******************************************************************
  5258*                                                                *
  5259*                                                                *
  5260*                            ERCMAIL                             *
  5261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5262*                            VMOD=2.003                          *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  93
* EL6316.cbl
  5263*                                                                *
  5264*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5265*                                                                *
  5266*   FILE TYPE = VSAM,KSDS                                        *
  5267*   RECORD SIZE = 374   RECFORM = FIX                            *
  5268*                                                                *
  5269*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5270*   ALTERNATE PATH    = NOT USED                                 *
  5271*                                                                *
  5272*   LOG = YES                                                    *
  5273*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5274******************************************************************
  5275*                   C H A N G E   L O G
  5276*
  5277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5278*-----------------------------------------------------------------
  5279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5280* EFFECTIVE    NUMBER
  5281*-----------------------------------------------------------------
  5282* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5283* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5284* 111108                   PEMA  ADD CRED BENE ADDR2
  5285******************************************************************
  5286
  5287 01  MAILING-DATA.
  5288     12  MA-RECORD-ID                      PIC XX.
  5289         88  VALID-MA-ID                       VALUE 'MA'.
  5290
  5291     12  MA-CONTROL-PRIMARY.
  5292         16  MA-COMPANY-CD                 PIC X.
  5293         16  MA-CARRIER                    PIC X.
  5294         16  MA-GROUPING.
  5295             20  MA-GROUPING-PREFIX        PIC XXX.
  5296             20  MA-GROUPING-PRIME         PIC XXX.
  5297         16  MA-STATE                      PIC XX.
  5298         16  MA-ACCOUNT.
  5299             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5300             20  MA-ACCOUNT-PRIME          PIC X(6).
  5301         16  MA-CERT-EFF-DT                PIC XX.
  5302         16  MA-CERT-NO.
  5303             20  MA-CERT-PRIME             PIC X(10).
  5304             20  MA-CERT-SFX               PIC X.
  5305
  5306     12  FILLER                            PIC XX.
  5307
  5308     12  MA-ACCESS-CONTROL.
  5309         16  MA-SOURCE-SYSTEM              PIC XX.
  5310             88  MA-FROM-CREDIT                VALUE 'CR'.
  5311             88  MA-FROM-VSI                   VALUE 'VS'.
  5312             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5313             88  MA-FROM-OTHER                 VALUE 'OT'.
  5314         16  MA-RECORD-ADD-DT              PIC XX.
  5315         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5316         16  MA-LAST-MAINT-DT              PIC XX.
  5317         16  MA-LAST-MAINT-BY              PIC XXXX.
  5318         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5319
  5320     12  MA-PROFILE-INFO.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  94
* EL6316.cbl
  5321         16  MA-QUALIFY-CODE-1             PIC XX.
  5322         16  MA-QUALIFY-CODE-2             PIC XX.
  5323         16  MA-QUALIFY-CODE-3             PIC XX.
  5324         16  MA-QUALIFY-CODE-4             PIC XX.
  5325         16  MA-QUALIFY-CODE-5             PIC XX.
  5326
  5327         16  MA-INSURED-LAST-NAME          PIC X(15).
  5328         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5329         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5330         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5331         16  MA-INSURED-BIRTH-DT           PIC XX.
  5332         16  MA-INSURED-SEX                PIC X.
  5333             88  MA-SEX-MALE                   VALUE 'M'.
  5334             88  MA-SEX-FEMALE                 VALUE 'F'.
  5335         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5336
  5337         16  MA-ADDRESS-CORRECTED          PIC X.
  5338         16  MA-JOINT-BIRTH-DT             PIC XX.
  5339*        16  FILLER                        PIC X(12).
  5340
  5341         16  MA-ADDRESS-LINE-1             PIC X(30).
  5342         16  MA-ADDRESS-LINE-2             PIC X(30).
  5343         16  MA-CITY-STATE.
  5344             20  MA-CITY                   PIC X(28).
  5345             20  MA-ADDR-STATE             PIC XX.
  5346         16  MA-ZIP.
  5347             20  MA-ZIP-CODE.
  5348                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5349                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5350                 24  FILLER                PIC X(4).
  5351             20  MA-ZIP-PLUS4              PIC X(4).
  5352         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5353             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5354             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5355             20  FILLER                    PIC X(3).
  5356
  5357         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5358
  5359         16  FILLER                        PIC XXX.
  5360*        16  FILLER                        PIC X(10).
  5361
  5362     12  MA-CRED-BENE-INFO.
  5363         16  MA-CRED-BENE-NAME                 PIC X(25).
  5364         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5365         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5366         16  MA-CRED-BENE-CTYST.
  5367             20  MA-CRED-BENE-CITY             PIC X(28).
  5368             20  MA-CRED-BENE-STATE            PIC XX.
  5369         16  MA-CRED-BENE-ZIP.
  5370             20  MA-CB-ZIP-CODE.
  5371                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5372                     88  MA-CB-CANADIAN-POST-CODE
  5373                                           VALUE 'A' THRU 'Z'.
  5374                 24  FILLER                    PIC X(4).
  5375             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5376         16  MA-CB-CANADIAN-POSTAL-CODE
  5377                            REDEFINES MA-CRED-BENE-ZIP.
  5378             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  95
* EL6316.cbl
  5379             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5380             20  FILLER                        PIC X(3).
  5381     12  MA-POST-CARD-MAIL-DATA.
  5382         16  MA-MAIL-DATA OCCURS 7.
  5383             20  MA-MAIL-TYPE              PIC X.
  5384                 88  MA-12MO-MAILING           VALUE '1'.
  5385                 88  MA-EXP-MAILING            VALUE '2'.
  5386             20  MA-MAIL-STATUS            PIC X.
  5387                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5388                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5389                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5390             20  MA-MAIL-DATE              PIC XX.
  5391     12  FILLER                            PIC XX.
  5392     12  FILLER                            PIC XX.
  5393*    12  FILLER                            PIC X(30).
  5394******************************************************************
  5395*                                COPY ERCCNOT.
  5396******************************************************************
  5397*                                                                *
  5398*                            ERCCNOT                             *
  5399*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5400*                            VMOD=2.003                          *
  5401*                                                                *
  5402*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5403*                                                                *
  5404*        FILE TYPE= VSAM,KSDS                                    *
  5405*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5406*                                                                *
  5407*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5408*                                                                *
  5409*        LOG = YES                                               *
  5410*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5411*                                                                *
  5412******************************************************************
  5413*                   C H A N G E   L O G
  5414*
  5415* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5416*-----------------------------------------------------------------
  5417*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5418* EFFECTIVE    NUMBER
  5419*-----------------------------------------------------------------
  5420* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5421******************************************************************
  5422
  5423 01  CERT-NOTE-FILE.
  5424     12  CZ-RECORD-ID                PIC  XX.
  5425         88  VALID-CZ-ID                  VALUE 'CZ'.
  5426
  5427     12  CZ-CONTROL-PRIMARY.
  5428         16  CZ-COMPANY-CD           PIC X.
  5429         16  CZ-CARRIER              PIC X.
  5430         16  CZ-GROUPING.
  5431             20 CZ-GROUPING-PREFIX   PIC XXX.
  5432             20 CZ-GROUPING-PRIME    PIC XXX.
  5433         16  CZ-STATE                PIC XX.
  5434         16  CZ-ACCOUNT.
  5435             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5436             20 CZ-ACCOUNT-PRIME     PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  96
* EL6316.cbl
  5437         16  CZ-CERT-EFF-DT          PIC XX.
  5438         16  CZ-CERT-NO.
  5439             20  CZ-CERT-PRIME       PIC X(10).
  5440             20  CZ-CERT-SFX         PIC X.
  5441         16  CZ-RECORD-TYPE          PIC X.
  5442             88  CERT-NOTE           VALUE '1'.
  5443             88  CLAIM-CERT-NOTE     VALUE '2'.
  5444         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5445
  5446     12  CZ-LAST-MAINT-DT            PIC XX.
  5447     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5448     12  CZ-LAST-MAINT-USER          PIC X(4).
  5449
  5450     12  CZ-NOTE-INFORMATION.
  5451         16  CZ-NOTE                 PIC X(63).
  5452         16  FILLER                  PIC X(39).
  5453******************************************************************
  5454*                                COPY ELCEOBC.
  5455******************************************************************
  5456*                                                                *
  5457*                                                                *
  5458*                            ELCEOBC                             *
  5459*                            VMOD=2.001                          *
  5460*                                                                *
  5461*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5462*                                                                *
  5463*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5464*   VSAM EOB CODE TABLE                                          *
  5465*                                                                *
  5466*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5467*                                                                *
  5468*   FILE TYPE = VSAM,KSDS                                        *
  5469*   RECORD SIZE = 350   RECFORM = FIX                            *
  5470*                                                                *
  5471*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5472*                                                                *
  5473*   LOG = NO                                                     *
  5474*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5475*                                                                *
  5476*                                                                *
  5477******************************************************************
  5478*                   C H A N G E   L O G
  5479*
  5480* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5481*-----------------------------------------------------------------
  5482*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5483* EFFECTIVE    NUMBER
  5484*-----------------------------------------------------------------
  5485* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5486* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5487* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  5488******************************************************************
  5489 01  EOB-CODES.
  5490     12  EO-RECORD-ID                      PIC XX.
  5491         88  VALID-DN-ID                      VALUE 'EO'.
  5492     12  EO-CONTROL-PRIMARY.
  5493         16  EO-COMPANY-CD                 PIC X.
  5494         16  EO-RECORD-TYPE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  97
* EL6316.cbl
  5495             88  EO-EOB-RECS                  VALUE '1'.
  5496             88  EO-VERIF-RECS                VALUE '2'.
  5497             88  EO-GCE-RECS                  VALUE '3'.
  5498             88  EO-CANC-RECS                 VALUE '4'.
  5499             88  EO-BILL-NOTE-RECS            VALUE '5'.
  5500         16  EO-EOB-CODE                   PIC X(4).
  5501         16  FILLER                        PIC X(9).
  5502     12  EO-MAINT-INFORMATION.
  5503         16  EO-LAST-MAINT-DT              PIC XX.
  5504         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5505         16  EO-LAST-MAINT-USER            PIC X(4).
  5506         16  FILLER                        PIC XX.
  5507     12  EO-DESCRIPTION                    PIC X(275).
  5508     12  FILLER                            PIC X(46).
  5509******************************************************************
  5510*                                COPY ELCENCC.
  5511******************************************************************
  5512*                                                                *
  5513*                                                                *
  5514*                            ELCENCC                             *
  5515*                            VMOD=2.001                          *
  5516*                                                                *
  5517*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5518*                                                                *
  5519*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5520*   A NAPERSOFT DOCUMENT                                         *
  5521*                                                                *
  5522*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5523*                                                                *
  5524*   FILE TYPE = VSAM,KSDS                                        *
  5525*   RECORD SIZE = 400   RECFORM = FIX                            *
  5526*                                                                *
  5527*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5528*                                                                *
  5529*   LOG = NO                                                     *
  5530*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5531*                                                                *
  5532*                                                                *
  5533******************************************************************
  5534*                   C H A N G E   L O G
  5535*
  5536* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5537*-----------------------------------------------------------------
  5538*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5539* EFFECTIVE    NUMBER
  5540*-----------------------------------------------------------------
  5541* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5542* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  5543******************************************************************
  5544 01  ENCLOSURE-CODES.
  5545     12  NC-RECORD-ID                      PIC XX.
  5546         88  VALID-NC-ID                      VALUE 'NC'.
  5547     12  NC-CONTROL-PRIMARY.
  5548         16  NC-COMPANY-CD                 PIC X.
  5549         16  NC-REC-TYPE                   PIC X.
  5550             88  NC-CLAIMS                   VALUE '1'.
  5551             88  NC-ADMIN                    VALUE '2'.
  5552         16  NC-ENC-CODE                   PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  98
* EL6316.cbl
  5553         16  FILLER                        PIC X(09).
  5554     12  NC-MAINT-INFORMATION.
  5555         16  NC-LAST-MAINT-DT              PIC XX.
  5556         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5557         16  NC-LAST-MAINT-USER            PIC X(4).
  5558         16  FILLER                        PIC XX.
  5559     12  NC-OUTPUT-STACK                   PIC XXX.
  5560     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5561     12  NC-ATTACHMENTS                    PIC X(255).
  5562     12  NC-FUTURE                         PIC X(12).
  5563******************************************************************
  5564*                                COPY ELCCRTT.
  5565******************************************************************
  5566*                                                                *
  5567*                            ELCCRTT.                            *
  5568*                                                                *
  5569*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5570*                                                                *
  5571*   FILE TYPE = VSAM,KSDS                                        *
  5572*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5573*                                                                *
  5574*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5575*                                                                *
  5576*   LOG = YES                                                    *
  5577*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5578******************************************************************
  5579*                   C H A N G E   L O G
  5580*
  5581* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5582*-----------------------------------------------------------------
  5583*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5584* EFFECTIVE    NUMBER
  5585*-----------------------------------------------------------------
  5586* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5587* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5588* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5589* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5590* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5591* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5592* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5593* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5594* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5595******************************************************************
  5596
  5597 01  CERTIFICATE-TRAILERS.
  5598     12  CS-RECORD-ID                      PIC XX.
  5599         88  VALID-CS-ID                      VALUE 'CS'.
  5600
  5601     12  CS-CONTROL-PRIMARY.
  5602         16  CS-COMPANY-CD                 PIC X.
  5603         16  CS-CARRIER                    PIC X.
  5604         16  CS-GROUPING                   PIC X(6).
  5605         16  CS-STATE                      PIC XX.
  5606         16  CS-ACCOUNT                    PIC X(10).
  5607         16  CS-CERT-EFF-DT                PIC XX.
  5608         16  CS-CERT-NO.
  5609             20  CS-CERT-PRIME             PIC X(10).
  5610             20  CS-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page  99
* EL6316.cbl
  5611         16  CS-TRAILER-TYPE               PIC X.
  5612             88  COMM-TRLR           VALUE 'A'.
  5613             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5614             88  CERT-DATA-TRLR      VALUE 'C'.
  5615
  5616     12  CS-DATA-AREA                      PIC X(516).
  5617
  5618     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5619         16  CS-BANK-COMMISSION-AREA.
  5620             20  CS-BANK-COMMS       OCCURS 10.
  5621                 24  CS-AGT                PIC X(10).
  5622                 24  CS-COM-TYP            PIC X.
  5623                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5624                 24  CS-RECALC-LV-INDIC    PIC X.
  5625                 24  FILLER                PIC X(10).
  5626         16  FILLER                        PIC X(256).
  5627
  5628     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5629****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5630         16  CS-MB-CLAIM-DATA OCCURS 24.
  5631             20  CS-CLAIM-NO               PIC X(7).
  5632             20  CS-CLAIM-TYPE             PIC X.
  5633                 88  CS-AH-CLM               VALUE 'A'.
  5634                 88  CS-IU-CLM               VALUE 'I'.
  5635                 88  CS-GP-CLM               VALUE 'G'.
  5636                 88  CS-LF-CLM               VALUE 'L'.
  5637                 88  CS-PR-CLM               VALUE 'P'.
  5638                 88  CS-FL-CLM               VALUE 'F'.
  5639             20  CS-INSURED-TYPE           PIC X.
  5640                 88  CS-PRIM-INSURED          VALUE 'P'.
  5641                 88  CS-CO-BORROWER           VALUE 'C'.
  5642             20  CS-BENEFIT-PERIOD         PIC 99.
  5643             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5644             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5645             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5646         16  FILLER                        PIC X(12).
  5647     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5648         16  CS-VIN-NUMBER                 PIC X(17).
  5649         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5650         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5651         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5652         16  cs-agent-name.
  5653             20  cs-agent-fname            pic x(20).
  5654             20  cs-agent-mi               pic x.
  5655             20  cs-agent-lname            pic x(25).
  5656         16  cs-license-no                 pic x(15).
  5657         16  cs-npn-number                 pic x(10).
  5658         16  cs-agent-edit-status          pic x.
  5659             88  cs-ae-refer-to-manager      value 'M'.
  5660             88  cs-ae-cover-sheet           value 'C'.
  5661             88  cs-ae-sig-form              value 'S'.
  5662             88  cs-ae-verified              value 'V'.
  5663             88  cs-unidentified-signature   value 'U'.
  5664             88  cs-cert-returned            value 'R'.
  5665             88  cs-accept-no-commission     value 'N'.
  5666         16  cs-year                       pic 9999.
  5667         16  cs-make                       pic x(20).
  5668         16  cs-model                      pic x(20).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 100
* EL6316.cbl
  5669         16  cs-future                     pic x(20).
  5670         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5671         16  FILLER                        PIC X(356). *> was 420
  5672*        16  FILLER                        PIC X(496).
  5673 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5674                          ACCOUNT-MASTER CONTROL-FILE
  5675                          PENDING-BUSINESS CERTIFICATE-MASTER
  5676                          ORIGINAL-CERTIFICATE
  5677                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5678                          MAILING-DATA CERT-NOTE-FILE EOB-CODES
  5679                          ENCLOSURE-CODES CERTIFICATE-TRAILERS.
  5680 0000-DFHEXIT SECTION.
  5681     MOVE '9#                    $   ' TO DFHEIV0.
  5682     MOVE 'EL6316' TO DFHEIV1.
  5683     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5684     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5685     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5686     MOVE '5'                    TO DC-OPTION-CODE
  5687     PERFORM 9700-DATE-LINK
  5688     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT
  5689     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT
  5690     MOVE EIBTRMID               TO QID-TERM
  5691     IF EIBCALEN = 0
  5692        GO TO 8800-UNAUTHORIZED-ACCESS
  5693     END-IF
  5694     DISPLAY ' ENDORSE LENGTH  '
  5695                FUNCTION LENGTH(ENDORSEMENT-RECORD)
  5696     move function length(EL631II) TO MAP-LENGTH
  5697     DISPLAY ' MAP LENGTH      ' MAP-LENGTH
  5698     IF PI-CALLING-PROGRAM = 'EL6314'
  5699         MOVE 'Y'                    TO PI-FROM-CERT
  5700         MOVE THIS-PGM               TO PI-CALLING-PROGRAM
  5701         MOVE LOW-VALUES             TO EL631II
  5702         MOVE 'Y'                    TO PI-CLEAR-ERROR-SW
  5703         GO TO 0350-DISPLAY-COMMON-DATA
  5704     END-IF
  5705
  5706     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5707        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5708           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5709           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5710           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5711           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5712           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5713           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5714           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5715           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5716           MOVE LOW-VALUES             TO EL631II
  5717           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5718           GO TO 0350-DISPLAY-COMMON-DATA
  5719        END-IF
  5720     END-IF
  5721     IF PI-CALLING-PROGRAM = 'EL614'
  5722        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5723                                 TO WS-PASSED-REASON-CODES
  5724        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5725        IF WS-PASSED-REASON-CODES NOT = SPACES
  5726           MOVE 'Y'                TO WS-SET-CODES-MDT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 101
* EL6316.cbl
  5727        ELSE
  5728           MOVE 'N'                TO WS-SET-CODES-MDT
  5729        END-IF
  5730        PERFORM 0610-RECOVER-TEMP-STORAGE
  5731                                 THRU 0610-EXIT
  5732        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5733        GO TO 0350-DISPLAY-COMMON-DATA
  5734     END-IF
  5735     IF EIBAID = DFHCLEAR
  5736        IF PI-CLEAR-ERROR
  5737           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5738           MOVE ER-3833           TO EMI-ERROR
  5739           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5740           GO TO 0350-DISPLAY-COMMON-DATA
  5741        ELSE
  5742           GO TO 9400-CLEAR
  5743        END-IF
  5744     END-IF
  5745     .
  5746 0200-RECEIVE.
  5747     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5748        MOVE ER-0008             TO EMI-ERROR
  5749        PERFORM 9900-ERROR-FORMAT
  5750                                 THRU 9900-EXIT
  5751        MOVE -1                  TO PFENTRL
  5752        GO TO 8100-SEND-INITIAL-MAP
  5753     END-IF
  5754
  5755* EXEC CICS RECEIVE
  5756*        MAP      (MAP-NAME)
  5757*        MAPSET   (MAPSET-NAME)
  5758*        INTO     (EL631II)
  5759*    END-EXEC
  5760     MOVE LENGTH OF
  5761      EL631II
  5762       TO DFHEIV11
  5763*    MOVE '8"T I  L              ''   #00005750' TO DFHEIV0
  5764     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5765     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5766     MOVE X'2020233030303035373530' TO DFHEIV0(25:11)
  5767     CALL 'kxdfhei1' USING DFHEIV0,
  5768           MAP-NAME,
  5769           EL631II,
  5770           DFHEIV11,
  5771           MAPSET-NAME,
  5772           DFHEIV99,
  5773           DFHEIV99
  5774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5775     IF PFENTRL = 0
  5776         GO TO 0300-CHECK-PFKEYS
  5777     END-IF
  5778     IF EIBAID NOT = DFHENTER
  5779         MOVE ER-0004            TO EMI-ERROR
  5780         GO TO 0320-INPUT-ERROR
  5781     END-IF
  5782     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5783        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5784     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 102
* EL6316.cbl
  5785        MOVE ER-0029            TO EMI-ERROR
  5786        GO TO 0320-INPUT-ERROR
  5787     END-IF
  5788     .
  5789 0300-CHECK-PFKEYS.
  5790     IF EIBAID = DFHPF1
  5791        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
  5792        PERFORM 0520-ERENDT-STARTBR
  5793                                 THRU 0520-EXIT
  5794        PERFORM 0510-ERENDT-READNEXT
  5795                                 THRU 0510-EXIT
  5796        IF ERENDT-KEY = PI-PREV-ERENDT-KEY
  5797            PERFORM 0510-ERENDT-READNEXT
  5798                                 THRU 0510-EXIT
  5799        END-IF
  5800        IF (RESP-NORMAL) AND
  5801         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5802           PERFORM 0390-BUILD-FROM-ERENDT
  5803                                 THRU 0390-EXIT
  5804           MOVE 'Y'              TO PI-ENDORSE-RECORD
  5805           MOVE ER-0000          TO EMI-ERROR
  5806           PERFORM 9900-ERROR-FORMAT
  5807                                 THRU 9900-EXIT
  5808           GO TO 8100-SEND-INITIAL-MAP
  5809        ELSE
  5810           MOVE ER-2237          TO EMI-ERROR
  5811           MOVE -1               TO CARRL
  5812           PERFORM 9900-ERROR-FORMAT
  5813                                 THRU 9900-EXIT
  5814           GO TO 8200-SEND-DATAONLY
  5815        END-IF
  5816     END-IF
  5817     IF EIBAID = DFHPF2
  5818        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
  5819        PERFORM 0520-ERENDT-STARTBR
  5820                                 THRU 0520-EXIT
  5821        PERFORM 0510-ERENDT-READNEXT
  5822                                 THRU 0510-EXIT
  5823        PERFORM 0530-ERENDT-READPREV
  5824                                 THRU 0530-EXIT
  5825        PERFORM 0530-ERENDT-READPREV
  5826                                 THRU 0530-EXIT
  5827        IF (RESP-NORMAL) AND
  5828         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5829           PERFORM 0390-BUILD-FROM-ERENDT
  5830                                 THRU 0390-EXIT
  5831           MOVE 'Y'              TO PI-ENDORSE-RECORD
  5832           MOVE ER-0000          TO EMI-ERROR
  5833           PERFORM 9900-ERROR-FORMAT
  5834                                 THRU 9900-EXIT
  5835           GO TO 8100-SEND-INITIAL-MAP
  5836        ELSE
  5837           MOVE 'N'              TO PI-ENDORSE-RECORD
  5838           MOVE LOW-VALUES       TO  EL631II
  5839           GO TO 0350-DISPLAY-COMMON-DATA
  5840           MOVE ER-2238          TO EMI-ERROR
  5841           PERFORM 9900-ERROR-FORMAT
  5842                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 103
* EL6316.cbl
  5843           MOVE -1               TO CARRL
  5844           GO TO 8200-SEND-DATAONLY
  5845        END-IF
  5846     END-IF
  5847
  5848     IF (EIBAID = DFHPF3 OR DFHPF4 OR DFHPF8) AND
  5849        PI-FROM-CERT = 'Y' AND
  5850        NOT PI-PROCESSOR-IS-CSR-SUPER
  5851           GO TO 0300-CONTINUE
  5852     END-IF
  5853
  5854     IF (EIBAID = DFHPF3 OR DFHPF4 OR DFHPF8) AND
  5855        PI-ENDORSE-RECORD = 'Y'
  5856           GO TO 0300-CONTINUE
  5857     END-IF
  5858     IF EIBAID = DFHPF3
  5859        IF PI-FROM-CERT = 'Y'
  5860         AND PI-PROCESSOR-IS-CSR-SUPER
  5861            MOVE PI-ELCRTO-KEY      TO ELCRTO-KEY
  5862            PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  5863            PERFORM 0785-CHG-CRTO-REC THRU 0785-EXIT
  5864        END-IF
  5865
  5866        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5867        PERFORM 0600-CREATE-TEMP-STORAGE
  5868                                 THRU 0600-EXIT
  5869        MOVE 'EL614'             TO PGM-NAME
  5870        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5871        MOVE +1                  TO S2
  5872        PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5873           IF REACD-IN (S1) NOT = SPACES AND LOW-VALUES
  5874              MOVE REACD-IN (S1) TO PI-PROGRAM-WORK-AREA (S2:4)
  5875              ADD +5 TO S2
  5876           END-IF
  5877        END-PERFORM
  5878        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5879        GO TO 9300-XCTL
  5880     END-IF
  5881     IF EIBAID = DFHPF4 OR DFHPF8
  5882        GO TO 1000-FINALIZE
  5883     END-IF
  5884
  5885      .
  5886 0300-CONTINUE.
  5887     IF EIBAID = DFHPF23
  5888        IF PI-CLEAR-ERROR
  5889           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5890           MOVE ER-3833           TO EMI-ERROR
  5891           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5892           GO TO 0350-DISPLAY-COMMON-DATA
  5893        ELSE
  5894           GO TO 8810-PF23
  5895        END-IF
  5896     END-IF
  5897     IF EIBAID = DFHPF24
  5898        IF PI-CLEAR-ERROR
  5899           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5900           MOVE ER-3833           TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 104
* EL6316.cbl
  5901           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5902           GO TO 0350-DISPLAY-COMMON-DATA
  5903        ELSE
  5904           GO TO 9200-RETURN-MAIN-MENU
  5905        END-IF
  5906     END-IF
  5907     IF EIBAID = DFHPF12
  5908        GO TO 9500-PF12
  5909     END-IF
  5910
  5911     IF EIBAID = DFHENTER
  5912      AND PI-FROM-CERT = 'Y'
  5913      AND PI-PROCESSOR-IS-CSR-SUPER
  5914      AND PI-ENDORSE-RECORD NOT EQUAL 'Y'
  5915         MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  5916         PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  5917         PERFORM 0785-CHG-CRTO-REC THRU 0785-EXIT
  5918         PERFORM 0755-READ-CERT THRU 0755-EXIT
  5919         PERFORM 0770-MOVE-CERT-TO-SCREEN THRU 0770-EXIT
  5920*         MOVE ER-0000          TO EMI-ERROR
  5921*         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5922*         GO TO 8100-SEND-INITIAL-MAP
  5923     END-IF
  5924     IF EIBAID = DFHENTER
  5925        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5926        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5927        IF EMI-NO-ERRORS
  5928           GO TO 0350-DISPLAY-COMMON-DATA
  5929        ELSE
  5930           GO TO 8200-SEND-DATAONLY
  5931        END-IF
  5932     END-IF
  5933     MOVE ER-0029                TO EMI-ERROR
  5934     .
  5935 0320-INPUT-ERROR.
  5936     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5937     MOVE AL-UNBON               TO PFENTRA
  5938     MOVE -1                     TO PFENTRL
  5939     GO TO 8200-SEND-DATAONLY
  5940     .
  5941 0325-EDIT-SCREEN.
  5942     IF PRTSWL > ZEROS
  5943        IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5944*          move prtswi to w-prtsw
  5945*          MOVE AL-UANON         TO PRTSWA
  5946*          IF PRTSWI = ' '
  5947              MOVE 'P'         TO PRTSWI
  5948*          END-IF
  5949*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5950        END-IF
  5951     END-IF
  5952     IF LTRIDL > ZEROS
  5953        AND LTRIDI > SPACES
  5954        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5955        MOVE LTRIDI              TO LETR-LETTER-ID
  5956                                    PI-LTRID-ENTERED
  5957        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5958        MOVE SPACES              TO LETR-FILLER
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 105
* EL6316.cbl
  5959        MOVE 0                   TO LETR-SEQ-NO
  5960        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5961     ELSE
  5962        MOVE ER-1236          TO EMI-ERROR
  5963        MOVE -1               TO LTRIDL
  5964        MOVE AL-UABON         TO LTRIDA
  5965        PERFORM 9900-ERROR-FORMAT
  5966                                 THRU 9900-EXIT
  5967     END-IF
  5968
  5969     IF W-PROMPT-LETTER EQUAL 'Y'
  5970         MOVE ER-0894            TO EMI-ERROR
  5971         MOVE -1                 TO LTRIDL
  5972         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5973     END-IF
  5974
  5975     IF ENCCODEL > ZEROS
  5976        MOVE FUNCTION UPPER-CASE(ENCCODEI) TO ENCCODEI
  5977                                              PI-ENCCODE
  5978        MOVE SPACES             TO WS-ELENCC-KEY
  5979        MOVE PI-COMPANY-CD      TO WS-ENCC-COMPANY-CD
  5980        MOVE '2'                TO WS-ENCC-REC-TYPE
  5981        MOVE ENCCODEI           TO WS-ENCC-ENC-CODE
  5982
  5983
  5984* EXEC CICS READ
  5985*           DATASET    (WS-ELENCC-FILE-ID)
  5986*           SET        (ADDRESS OF ENCLOSURE-CODES)
  5987*           RIDFLD     (WS-ELENCC-KEY)
  5988*           RESP       (WS-RESPONSE)
  5989*       END-EXEC
  5990*    MOVE '&"S        E          (  N#00005963' TO DFHEIV0
  5991     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5992     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5993     MOVE X'204E233030303035393633' TO DFHEIV0(25:11)
  5994     CALL 'kxdfhei1' USING DFHEIV0,
  5995           WS-ELENCC-FILE-ID,
  5996           DFHEIV20,
  5997           DFHEIV99,
  5998           WS-ELENCC-KEY,
  5999           DFHEIV99,
  6000           DFHEIV99,
  6001           DFHEIV99
  6002     SET ADDRESS OF ENCLOSURE-CODES TO
  6003         DFHEIV20
  6004     MOVE EIBRESP  TO WS-RESPONSE
  6005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6006
  6007        IF RESP-NORMAL
  6008           MOVE ENCCODEI         TO PI-ENCCODE
  6009                                    W-ENCLOSURE-CD
  6010           MOVE AL-UANON         TO ENCCODEA
  6011        ELSE
  6012           MOVE ER-1560          TO EMI-ERROR
  6013           MOVE -1               TO ENCCODEL
  6014           MOVE AL-UABON         TO ENCCODEA
  6015           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6016        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 106
* EL6316.cbl
  6017     END-IF
  6018
  6019     SET REASONS-NOT-FOUND TO TRUE
  6020     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6021        IF REACDL (S1) = +4 OR
  6022          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6023              MOVE AL-SANON     TO REACDA (S1)
  6024              SET REASONS-FOUND TO TRUE
  6025        END-IF
  6026     END-PERFORM
  6027
  6028     IF REASONS-NOT-FOUND
  6029        MOVE ER-1820             TO EMI-ERROR
  6030        MOVE -1                  TO PFENTRL
  6031        PERFORM 9900-ERROR-FORMAT
  6032                                 THRU 9900-EXIT
  6033     ELSE
  6034        MOVE REASONCDS           TO PI-REASONS-ENTERED
  6035     END-IF
  6036
  6037     IF CRTNT1L > ZEROS
  6038        IF CRTNT1I > SPACES
  6039           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  6040        END-IF
  6041     END-IF
  6042
  6043     IF CRTNT2L > ZEROS
  6044        IF CRTNT2I > SPACES
  6045           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  6046        END-IF
  6047     END-IF
  6048
  6049     IF BILNT1L > ZEROS
  6050        IF BILNT1I > SPACES
  6051           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  6052        END-IF
  6053     END-IF
  6054
  6055     .
  6056 0325-EXIT.
  6057     EXIT.
  6058
  6059 0326-GET-Z-RECORD.
  6060
  6061     MOVE SPACES  TO W-Z-CONTROL-DATA
  6062
  6063
  6064* EXEC CICS STARTBR
  6065*         DATASET    ('ELLETR')
  6066*         RIDFLD     (ELLETR-KEY)
  6067*         GTEQ
  6068*         RESP      (WS-RESPONSE)
  6069*    END-EXEC.
  6070     MOVE 'ELLETR' TO DFHEIV1
  6071     MOVE 0
  6072       TO DFHEIV11
  6073*    MOVE '&,         G          &  N#00006026' TO DFHEIV0
  6074     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 107
* EL6316.cbl
  6075     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6076     MOVE X'204E233030303036303236' TO DFHEIV0(25:11)
  6077     CALL 'kxdfhei1' USING DFHEIV0,
  6078           DFHEIV1,
  6079           ELLETR-KEY,
  6080           DFHEIV99,
  6081           DFHEIV11,
  6082           DFHEIV99
  6083     MOVE EIBRESP  TO WS-RESPONSE
  6084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6085
  6086     IF NOT RESP-NORMAL
  6087         MOVE ER-1236          TO EMI-ERROR
  6088         MOVE -1               TO LTRIDL
  6089         MOVE AL-UABON         TO LTRIDA
  6090         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6091         GO TO 0326-ENDBR
  6092     END-IF.
  6093
  6094 0326-READNEXT.
  6095
  6096
  6097* EXEC CICS READNEXT
  6098*        DATASET   ('ELLETR')
  6099*        INTO      (TEXT-FILES)
  6100*        RIDFLD    (ELLETR-KEY)
  6101*        RESP      (WS-RESPONSE)
  6102*    END-EXEC
  6103     MOVE LENGTH OF
  6104      TEXT-FILES
  6105       TO DFHEIV12
  6106     MOVE 'ELLETR' TO DFHEIV1
  6107     MOVE 0
  6108       TO DFHEIV11
  6109*    MOVE '&.IL                  )  N#00006042' TO DFHEIV0
  6110     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6111     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6112     MOVE X'204E233030303036303432' TO DFHEIV0(25:11)
  6113     CALL 'kxdfhei1' USING DFHEIV0,
  6114           DFHEIV1,
  6115           TEXT-FILES,
  6116           DFHEIV12,
  6117           ELLETR-KEY,
  6118           DFHEIV99,
  6119           DFHEIV11,
  6120           DFHEIV99,
  6121           DFHEIV99
  6122     MOVE EIBRESP  TO WS-RESPONSE
  6123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6124     IF RESP-NORMAL
  6125        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  6126           MOVE ER-1236          TO EMI-ERROR
  6127           MOVE -1               TO LTRIDL
  6128           MOVE AL-UABON         TO LTRIDA
  6129           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6130           GO TO 0326-ENDBR
  6131        END-IF
  6132
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 108
* EL6316.cbl
  6133        MOVE AL-UANON         TO LTRIDA
  6134        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  6135           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  6136        ELSE
  6137           GO TO 0326-READNEXT
  6138        END-IF
  6139     ELSE
  6140        MOVE ER-1236          TO EMI-ERROR
  6141        MOVE -1               TO LTRIDL
  6142        MOVE AL-UABON         TO LTRIDA
  6143        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6144        GO TO 0326-ENDBR
  6145     END-IF.
  6146
  6147     IF PI-ENCCODE NOT GREATER THAN SPACES
  6148         MOVE W-ENCLOSURE-CD            TO PI-ENCCODE
  6149                                           ENCCODEO
  6150         MOVE AL-UANON                  TO ENCCODEA
  6151         MOVE +3                        TO ENCCODEL
  6152     END-IF.
  6153
  6154 0326-ENDBR.
  6155
  6156
  6157* EXEC CICS ENDBR
  6158*        DATASET     ('ELLETR')
  6159*    END-EXEC.
  6160     MOVE 'ELLETR' TO DFHEIV1
  6161     MOVE 0
  6162       TO DFHEIV11
  6163*    MOVE '&2                    $   #00006080' TO DFHEIV0
  6164     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6165     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6166     MOVE X'2020233030303036303830' TO DFHEIV0(25:11)
  6167     CALL 'kxdfhei1' USING DFHEIV0,
  6168           DFHEIV1,
  6169           DFHEIV11,
  6170           DFHEIV99
  6171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6172
  6173
  6174 0326-EXIT.
  6175      EXIT.
  6176 0350-DISPLAY-COMMON-DATA.
  6177     display ' made it to 0350 '
  6178
  6179     IF PI-FROM-CERT = 'Y'
  6180         PERFORM 0700-LOAD-FROM-CERT THRU 0700-EXIT
  6181     ELSE
  6182         PERFORM 0360-CHECK-PENDING THRU 0360-EXIT
  6183     END-IF
  6184     IF PI-LTRID-ENTERED > SPACES
  6185        MOVE PI-LTRID-ENTERED    TO LTRIDI
  6186        MOVE AL-UANON            TO LTRIDA
  6187        MOVE +4                  TO LTRIDL
  6188     ELSE
  6189        IF PI-CLM-RESCISSION
  6190            MOVE 'CLRC'          TO LTRIDI
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 109
* EL6316.cbl
  6191                                    PI-LTRID-ENTERED
  6192            MOVE +4              TO LTRIDL
  6193            MOVE AL-UANON        TO LTRIDA
  6194        END-IF
  6195     END-IF
  6196
  6197     IF PI-ENCCODE > SPACES
  6198        MOVE PI-ENCCODE          TO ENCCODEI
  6199        MOVE AL-UANON            TO ENCCODEA
  6200        MOVE +3                  TO ENCCODEL
  6201     END-IF
  6202
  6203     SET REASONS-NOT-FOUND TO TRUE
  6204     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6205     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6206        IF REACDL (S1) = +4 OR
  6207          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6208              MOVE AL-SANON      TO REACDA (S1)
  6209              MOVE +4            TO REACDL (S1)
  6210              SET REASONS-FOUND  TO TRUE
  6211        END-IF
  6212     END-PERFORM
  6213
  6214     IF REASONS-NOT-FOUND
  6215         IF PI-CLM-RESCISSION
  6216            MOVE 'CRNA'          TO REACD-IN (1)
  6217            MOVE AL-SANON        TO REACDA (1)
  6218            MOVE +4              TO REACDL (1)
  6219            SET REASONS-FOUND    TO TRUE
  6220        END-IF
  6221     END-IF
  6222
  6223     IF PI-CERTNT1-ENTERED > SPACES
  6224        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6225        MOVE AL-UANON            TO CRTNT1A
  6226        MOVE +63                 TO CRTNT1L
  6227     END-IF
  6228
  6229     IF PI-CERTNT2-ENTERED > SPACES
  6230        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6231        MOVE AL-UANON            TO CRTNT2A
  6232        MOVE +63                 TO CRTNT2L
  6233     END-IF
  6234
  6235     IF PI-BILLNT1-ENTERED > SPACES
  6236        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6237        MOVE AL-UANON            TO BILNT1A
  6238        MOVE +63                 TO BILNT1L
  6239     END-IF
  6240     GO TO 8100-SEND-INITIAL-MAP
  6241     .
  6242 0350-EXIT.
  6243     EXIT.
  6244 0360-CHECK-PENDING.
  6245     display ' made it to 0360 '
  6246     MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  6247     MOVE PI-CARRIER             TO CRTO-CARRIER
  6248     MOVE PI-GROUPING            TO CRTO-GROUPING
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 110
* EL6316.cbl
  6249     MOVE PI-STATE               TO CRTO-STATE
  6250     MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  6251     MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  6252     MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  6253     MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  6254     MOVE 'I'                    TO CRTO-RECORD-TYPE
  6255     MOVE ZEROS                  TO CRTO-SEQ-NO
  6256     MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  6257     MOVE ELCRTO-KEY (1:33)      TO PI-ERENDT-KEY (1:33)
  6258     MOVE 'C'                    TO PI-ENDT-RECORD-TYPE
  6259     MOVE ZEROS                  TO PI-ENDT-SEQ-NO
  6260     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  6261     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6262      display 'response ' ws-response
  6263      display 'pi-elcrto-key ' pi-elcrto-key
  6264      display 'oc key ' oc-control-primary
  6265     IF RESP-NORMAL
  6266       IF (PI-ELCRTO-KEY (1:33) =
  6267              OC-CONTROL-PRIMARY (1:33))
  6268          DISPLAY 'CRTO RESP NORMAL '
  6269          MOVE OC-CONTROL-PRIMARY  TO PI-ELCRTO-KEY
  6270          PERFORM 0361-MOVE-CRTO-TO-SCREEN THRU 0361-EXIT
  6271          PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  6272          IF RESP-NORMAL
  6273             MOVE PB-CONTROL-PRIMARY TO PI-ERPNDB-KEY
  6274             PERFORM 0380-BUILD-FROM-ERPNDB THRU 0380-EXIT
  6275          END-IF
  6276       ELSE
  6277          MOVE ER-3829           TO EMI-ERROR
  6278          PERFORM 9900-ERROR-FORMAT
  6279                                 THRU 9900-EXIT
  6280          MOVE -1                TO CARRL
  6281          GO TO 8100-SEND-INITIAL-MAP
  6282       END-IF
  6283     ELSE
  6284        MOVE ER-3829             TO EMI-ERROR
  6285        PERFORM 9900-ERROR-FORMAT
  6286                                 THRU 9900-EXIT
  6287        MOVE -1                  TO CARRL
  6288        GO TO 8100-SEND-INITIAL-MAP
  6289     END-IF
  6290     .
  6291 0360-EXIT.
  6292     EXIT.
  6293 0361-MOVE-CRTO-TO-SCREEN.
  6294     display ' made it to 0361 '
  6295     MOVE OC-LF-CANCEL-DT          TO DC-BIN-DATE-1
  6296     MOVE ' '                      TO DC-OPTION-CODE
  6297     PERFORM 9700-DATE-LINK
  6298     IF NO-CONVERSION-ERROR
  6299        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  6300     END-IF
  6301     MOVE OC-AH-CANCEL-DT          TO DC-BIN-DATE-1
  6302     MOVE ' '                      TO DC-OPTION-CODE
  6303     PERFORM 9700-DATE-LINK
  6304     IF NO-CONVERSION-ERROR
  6305        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
  6306     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 111
* EL6316.cbl
  6307     IF OC-LF-CANCEL-AMT NUMERIC
  6308        MOVE OC-LF-CANCEL-AMT      TO OLFAMTO
  6309     ELSE
  6310        MOVE ZEROS                 TO OLFAMTO
  6311     END-IF
  6312     IF OC-AH-CANCEL-AMT NUMERIC
  6313        MOVE OC-AH-CANCEL-AMT      TO OAHAMTO
  6314     ELSE
  6315        MOVE ZEROS                 TO OAHAMTO
  6316     END-IF
  6317     .
  6318 0361-EXIT.
  6319     EXIT.
  6320 0362-READ-ELCRTO.
  6321     display ' made it to 0362 '
  6322
  6323* EXEC CICS READ
  6324*        DATASET   (WS-ELCRTO-FILE-ID)
  6325*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6326*        RIDFLD    (ELCRTO-KEY)
  6327*        GTEQ
  6328*        RESP      (WS-RESPONSE)
  6329*    END-EXEC
  6330*    MOVE '&"S        G          (  N#00006232' TO DFHEIV0
  6331     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6332     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6333     MOVE X'204E233030303036323332' TO DFHEIV0(25:11)
  6334     CALL 'kxdfhei1' USING DFHEIV0,
  6335           WS-ELCRTO-FILE-ID,
  6336           DFHEIV20,
  6337           DFHEIV99,
  6338           ELCRTO-KEY,
  6339           DFHEIV99,
  6340           DFHEIV99,
  6341           DFHEIV99
  6342     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6343         DFHEIV20
  6344     MOVE EIBRESP  TO WS-RESPONSE
  6345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6346     .
  6347 0362-EXIT.
  6348     EXIT.
  6349 0363-READ-ELCRTO-UPD.
  6350     display ' made it to 0363 '
  6351
  6352* EXEC CICS READ
  6353*        DATASET   (WS-ELCRTO-FILE-ID)
  6354*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6355*        RIDFLD    (ELCRTO-KEY)
  6356*        UPDATE
  6357*        RESP      (WS-RESPONSE)
  6358*    END-EXEC
  6359*    MOVE '&"S        EU         (  N#00006244' TO DFHEIV0
  6360     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6361     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6362     MOVE X'204E233030303036323434' TO DFHEIV0(25:11)
  6363     CALL 'kxdfhei1' USING DFHEIV0,
  6364           WS-ELCRTO-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 112
* EL6316.cbl
  6365           DFHEIV20,
  6366           DFHEIV99,
  6367           ELCRTO-KEY,
  6368           DFHEIV99,
  6369           DFHEIV99,
  6370           DFHEIV99
  6371     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6372         DFHEIV20
  6373     MOVE EIBRESP  TO WS-RESPONSE
  6374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6375     .
  6376 0363-EXIT.
  6377     EXIT.
  6378
  6379 0364-MOVE-ZERO-TO-SCREEN.
  6380
  6381     MOVE ZEROS    TO OLFDTO
  6382                      OAHDTO
  6383                      OLFAMTO
  6384                      OAHAMTO.
  6385
  6386 0364-EXIT.
  6387     EXIT.
  6388
  6389 0365-READ-ERENDT.
  6390
  6391* EXEC CICS READ
  6392*        DATASET   (WS-ERENDT-FILE-ID)
  6393*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6394*        RIDFLD    (ERENDT-KEY)
  6395*        RESP      (WS-RESPONSE)
  6396*    END-EXEC
  6397*    MOVE '&"S        E          (  N#00006266' TO DFHEIV0
  6398     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6399     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6400     MOVE X'204E233030303036323636' TO DFHEIV0(25:11)
  6401     CALL 'kxdfhei1' USING DFHEIV0,
  6402           WS-ERENDT-FILE-ID,
  6403           DFHEIV20,
  6404           DFHEIV99,
  6405           ERENDT-KEY,
  6406           DFHEIV99,
  6407           DFHEIV99,
  6408           DFHEIV99
  6409     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6410         DFHEIV20
  6411     MOVE EIBRESP  TO WS-RESPONSE
  6412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6413     .
  6414 0365-EXIT.
  6415     EXIT.
  6416 0370-READ-ERPNDB.
  6417     display ' made it to 0370 '
  6418     MOVE PI-COMPANY-CD          TO PNDB2-COMPANY-CD
  6419     MOVE PI-CRTO-CARRIER        TO PNDB2-CARRIER
  6420     MOVE PI-CRTO-GROUPING       TO PNDB2-GROUPING
  6421     MOVE PI-CRTO-STATE          TO PNDB2-STATE
  6422     MOVE PI-CRTO-ACCOUNT        TO PNDB2-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 113
* EL6316.cbl
  6423     MOVE PI-CRTO-CERT-PRIME     TO PNDB2-CERT-PRIME
  6424     MOVE PI-CRTO-CERT-SFX       TO PNDB2-CERT-SFX
  6425     MOVE PI-CRTO-CERT-EFF-DT    TO PNDB2-CERT-EFF-DT
  6426     MOVE +0                     TO PNDB2-CHG-SEQ-NO
  6427     MOVE '2'                    TO PNDB2-RECORD-TYPE
  6428
  6429* EXEC CICS READ
  6430*        DATASET   (WS-ERPNDB2-FILE-ID)
  6431*        SET       (ADDRESS OF PENDING-BUSINESS)
  6432*        RIDFLD    (ERPNDB2-KEY)
  6433*        RESP      (WS-RESPONSE)
  6434*    END-EXEC
  6435*    MOVE '&"S        E          (  N#00006287' TO DFHEIV0
  6436     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6437     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6438     MOVE X'204E233030303036323837' TO DFHEIV0(25:11)
  6439     CALL 'kxdfhei1' USING DFHEIV0,
  6440           WS-ERPNDB2-FILE-ID,
  6441           DFHEIV20,
  6442           DFHEIV99,
  6443           ERPNDB2-KEY,
  6444           DFHEIV99,
  6445           DFHEIV99,
  6446           DFHEIV99
  6447     SET ADDRESS OF PENDING-BUSINESS TO
  6448         DFHEIV20
  6449     MOVE EIBRESP  TO WS-RESPONSE
  6450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6451     .
  6452 0370-EXIT.
  6453     EXIT.
  6454 0380-BUILD-FROM-ERPNDB.
  6455     display ' made it to 0380 '
  6456     MOVE PB-CARRIER             TO CARRO
  6457     MOVE PB-GROUPING            TO GROUPO
  6458     MOVE PB-STATE               TO STATEO
  6459     MOVE PB-ACCOUNT             TO ACCTO
  6460     MOVE PB-CERT-PRIME          TO CERTNOO
  6461     MOVE PB-CERT-SFX            TO CRTSFXO
  6462     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  6463     MOVE ' '                    TO DC-OPTION-CODE
  6464     PERFORM 9700-DATE-LINK
  6465     IF NO-CONVERSION-ERROR
  6466        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6467     END-IF
  6468     MOVE PB-CI-LAST-NAME        TO LNAMEO
  6469     MOVE PB-CI-FIRST-NAME       TO FNAMEO
  6470     MOVE PB-CI-INITIALS (2:1)   TO MINITO
  6471     MOVE PB-C-LF-CANCEL-DT        TO DC-BIN-DATE-1
  6472     MOVE ' '                      TO DC-OPTION-CODE
  6473     PERFORM 9700-DATE-LINK
  6474     IF NO-CONVERSION-ERROR
  6475        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  6476     END-IF
  6477     MOVE PB-C-AH-CANCEL-DT        TO DC-BIN-DATE-1
  6478     MOVE ' '                      TO DC-OPTION-CODE
  6479     PERFORM 9700-DATE-LINK
  6480     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 114
* EL6316.cbl
  6481        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  6482     END-IF
  6483     MOVE PB-C-LF-CANCEL-AMT       TO NLFAMTO
  6484     MOVE PB-C-AH-CANCEL-AMT       TO NAHAMTO
  6485     IF PB-CI-LIFE-COMMISSION NOT = ZEROS
  6486        MOVE PB-CI-LIFE-COMMISSION
  6487                              TO LFCOMMO
  6488*       MOVE AL-UNNON         TO LFCOMMA
  6489     END-IF
  6490     IF PB-CI-AH-COMMISSION NOT = ZEROS
  6491        MOVE PB-CI-AH-COMMISSION
  6492                              TO AHCOMMO
  6493*       MOVE AL-UNNON         TO AHCOMMA
  6494     END-IF
  6495     MOVE ER-2785                TO EMI-ERROR
  6496     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  6497     .
  6498 0380-EXIT.
  6499     EXIT.
  6500 0390-BUILD-FROM-ERENDT.
  6501     MOVE LOW-VALUES             TO EL631II
  6502*    move PI-PRTSW-ENTERED       to prtswo
  6503     IF PI-CERTNT1-ENTERED > SPACES
  6504        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6505        MOVE AL-UANON            TO CRTNT1A
  6506        MOVE +63                 TO CRTNT1L
  6507     END-IF
  6508
  6509     IF PI-CERTNT2-ENTERED > SPACES
  6510        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6511        MOVE AL-UANON            TO CRTNT2A
  6512        MOVE +63                 TO CRTNT2L
  6513     END-IF
  6514
  6515     IF PI-BILLNT1-ENTERED > SPACES
  6516        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6517        MOVE AL-UANON            TO BILNT1A
  6518        MOVE +63                 TO BILNT1L
  6519     END-IF
  6520
  6521     IF PI-ENCCODE > SPACES
  6522         MOVE PI-ENCCODE         TO ENCCODEO
  6523         MOVE AL-UANON           TO ENCCODEA
  6524         MOVE +3                 TO ENCCODEL
  6525     END-IF.
  6526
  6527     MOVE PI-COMPANY-CD          TO PI-ENDT-COMPANY-CD
  6528     MOVE EN-CARRIER             TO PI-ENDT-CARRIER
  6529     MOVE EN-GROUPING            TO PI-ENDT-GROUPING
  6530     MOVE EN-STATE               TO PI-ENDT-STATE
  6531     MOVE EN-ACCOUNT             TO PI-ENDT-ACCOUNT
  6532     MOVE EN-CERT-PRIME          TO PI-ENDT-CERT-PRIME
  6533     MOVE EN-CERT-SFX            TO PI-ENDT-CERT-SFX
  6534     MOVE EN-CERT-EFF-DT         TO PI-ENDT-CERT-EFF-DT
  6535     MOVE EN-REC-TYPE            TO PI-ENDT-RECORD-TYPE
  6536     MOVE EN-SEQ-NO              TO PI-ENDT-SEQ-NO
  6537     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  6538     MOVE EN-CARRIER             TO CARRO
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 115
* EL6316.cbl
  6539     MOVE EN-GROUPING            TO GROUPO
  6540     MOVE EN-STATE               TO STATEO
  6541     MOVE EN-ACCOUNT             TO ACCTO
  6542     MOVE EN-CERT-PRIME          TO CERTNOO
  6543     MOVE EN-CERT-SFX            TO CRTSFXO
  6544     MOVE EN-SEQ-NO              TO SEQNOO
  6545     MOVE EN-TEMPLATE-USED       TO LTRIDO
  6546
  6547     IF PI-FROM-CERT = 'Y'
  6548         PERFORM 0755-READ-CERT THRU 0755-EXIT
  6549         MOVE CM-INSURED-LAST-NAME TO LNAMEO
  6550         MOVE CM-INSURED-FIRST-NAME TO FNAMEO
  6551         MOVE CM-INSURED-INITIAL2  TO MINITO
  6552         IF CM-LIFE-COMM-PCT NOT = ZEROS
  6553             MOVE CM-LIFE-COMM-PCT TO LFCOMMO
  6554         END-IF
  6555         IF CM-AH-COMM-PCT NOT = ZEROS
  6556             MOVE CM-AH-COMM-PCT   TO AHCOMMO
  6557         END-IF
  6558     ELSE
  6559        PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  6560        MOVE PB-CI-LAST-NAME        TO LNAMEO
  6561        MOVE PB-CI-FIRST-NAME       TO FNAMEO
  6562        MOVE PB-CI-INITIALS (2:1)   TO MINITO
  6563        IF PB-CI-LIFE-COMMISSION NOT = ZEROS
  6564           MOVE PB-CI-LIFE-COMMISSION TO LFCOMMO
  6565        END-IF
  6566        IF PB-CI-AH-COMMISSION NOT = ZEROS
  6567           MOVE PB-CI-AH-COMMISSION TO AHCOMMO
  6568        END-IF
  6569     END-IF
  6570     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6571        IF EN-REASON-CODE (S1) NOT = SPACES
  6572           MOVE EN-REASON-CODE (S1) TO REACD-IN (S1)
  6573           MOVE AL-SANON         TO REACDA (S1)
  6574           MOVE +4               TO REACDL (S1)
  6575        END-IF
  6576     END-PERFORM
  6577     MOVE EN-CERT-EFF-DT         TO DC-BIN-DATE-1
  6578     MOVE ' '                    TO DC-OPTION-CODE
  6579     PERFORM 9700-DATE-LINK
  6580     IF NO-CONVERSION-ERROR
  6581        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6582     END-IF
  6583     IF EN-PROCESS-DT NOT = SPACES AND LOW-VALUES
  6584        MOVE EN-PROCESS-DT       TO DC-BIN-DATE-1
  6585        MOVE ' '                 TO DC-OPTION-CODE
  6586        PERFORM 9700-DATE-LINK
  6587        IF NO-CONVERSION-ERROR
  6588           MOVE DC-GREG-DATE-1-EDIT
  6589                                 TO PROCDTO
  6590        END-IF
  6591     END-IF
  6592     IF EN-INPUT-DT NOT = SPACES AND LOW-VALUES
  6593        MOVE EN-INPUT-DT         TO DC-BIN-DATE-1
  6594        MOVE ' '                 TO DC-OPTION-CODE
  6595        PERFORM 9700-DATE-LINK
  6596        IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 116
* EL6316.cbl
  6597           MOVE DC-GREG-DATE-1-EDIT
  6598                                 TO INPDTO
  6599        END-IF
  6600     END-IF
  6601     MOVE EN-LF-ORIG-REF-DT        TO DC-BIN-DATE-1
  6602     MOVE ' '                      TO DC-OPTION-CODE
  6603     PERFORM 9700-DATE-LINK
  6604     IF NO-CONVERSION-ERROR
  6605        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  6606     END-IF
  6607     MOVE EN-LF-ORIG-REF-AMT       TO OLFAMTO
  6608     MOVE EN-AH-ORIG-REF-DT        TO DC-BIN-DATE-1
  6609     MOVE ' '                      TO DC-OPTION-CODE
  6610     PERFORM 9700-DATE-LINK
  6611     IF NO-CONVERSION-ERROR
  6612        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
  6613     END-IF
  6614     MOVE EN-AH-ORIG-REF-AMT       TO OAHAMTO
  6615     MOVE EN-LF-NEW-REF-DT         TO DC-BIN-DATE-1
  6616     MOVE ' '                      TO DC-OPTION-CODE
  6617     PERFORM 9700-DATE-LINK
  6618     IF NO-CONVERSION-ERROR
  6619        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  6620     END-IF
  6621     MOVE EN-LF-NEW-REF-AMT        TO NLFAMTO
  6622     MOVE EN-AH-NEW-REF-DT         TO DC-BIN-DATE-1
  6623     MOVE ' '                      TO DC-OPTION-CODE
  6624     PERFORM 9700-DATE-LINK
  6625     IF NO-CONVERSION-ERROR
  6626        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  6627     END-IF
  6628     MOVE EN-AH-NEW-REF-AMT        TO NAHAMTO
  6629     MOVE EN-ARCHIVE-NO            TO ARCHNOO
  6630     .
  6631 0390-EXIT.
  6632     EXIT.
  6633 0400-ADD-ERENDT.
  6634     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6635
  6636* EXEC CICS GETMAIN
  6637*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6638*         LENGTH   (ERENDT-LENGTH)
  6639*         INITIMG  (GETMAIN-SPACE)
  6640*    END-EXEC
  6641*    MOVE ',"IL                  $   #00006477' TO DFHEIV0
  6642     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6643     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6644     MOVE X'2020233030303036343737' TO DFHEIV0(25:11)
  6645     CALL 'kxdfhei1' USING DFHEIV0,
  6646           DFHEIV20,
  6647           ERENDT-LENGTH,
  6648           GETMAIN-SPACE
  6649     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6650         DFHEIV20
  6651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6652     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6653     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6654     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 117
* EL6316.cbl
  6655     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6656                                    EN-INPUT-DT
  6657     MOVE OC-LF-CANCEL-DT        TO EN-LF-ORIG-REF-DT
  6658     MOVE OC-AH-CANCEL-DT        TO EN-AH-ORIG-REF-DT
  6659     MOVE OC-LF-CANCEL-AMT       TO EN-LF-ORIG-REF-AMT
  6660     MOVE OC-AH-CANCEL-AMT       TO EN-AH-ORIG-REF-AMT
  6661
  6662     MOVE OC-LF-ITD-CANCEL-AMT   TO NEW-LF-ITD-CANCEL-AMT
  6663     MOVE OC-AH-ITD-CANCEL-AMT   TO NEW-AH-ITD-CANCEL-AMT
  6664
  6665     MOVE OC-INS-LAST-NAME       TO EN-INS-LAST-NAME
  6666     MOVE OC-INS-FIRST-NAME      TO EN-INS-FIRST-NAME
  6667     MOVE OC-INS-MIDDLE-INIT     TO EN-INS-MIDDLE-INIT
  6668
  6669     MOVE OC-LF-COMM-PCT         TO EN-LF-ORIG-REF-COMM-PCT
  6670     MOVE OC-AH-COMM-PCT         TO EN-AH-ORIG-REF-COMM-PCT
  6671
  6672     IF PI-FROM-CERT = 'Y'
  6673         DISPLAY 'USING CERT FOR NEW'
  6674
  6675         MOVE PI-COMPANY-CD       TO  W-CERT-COMPANY-CD
  6676         MOVE PI-CRTO-CARRIER     TO  W-CERT-CARRIER
  6677         MOVE PI-CRTO-GROUPING    TO  W-CERT-GROUPING
  6678         MOVE PI-CRTO-STATE       TO  W-CERT-STATE
  6679         MOVE PI-CRTO-ACCOUNT     TO  W-CERT-ACCOUNT
  6680         MOVE PI-CRTO-CERT-EFF-DT TO  W-CERT-CERT-EFF-DT
  6681         MOVE PI-CRTO-CERT-PRIME  TO  W-CERT-CERT-PRIME
  6682         MOVE PI-CRTO-CERT-SFX    TO  W-CERT-CERT-SFX
  6683
  6684
  6685* EXEC CICS READ
  6686*            DATASET  (WS-ELCERT-FILE-ID)
  6687*            RIDFLD   (WS-ELCERT-KEY)
  6688*            SET      (ADDRESS OF CERTIFICATE-MASTER)
  6689*            RESP     (WS-RESPONSE)
  6690*        END-EXEC
  6691*    MOVE '&"S        E          (  N#00006514' TO DFHEIV0
  6692     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6693     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6694     MOVE X'204E233030303036353134' TO DFHEIV0(25:11)
  6695     CALL 'kxdfhei1' USING DFHEIV0,
  6696           WS-ELCERT-FILE-ID,
  6697           DFHEIV20,
  6698           DFHEIV99,
  6699           WS-ELCERT-KEY,
  6700           DFHEIV99,
  6701           DFHEIV99,
  6702           DFHEIV99
  6703     SET ADDRESS OF CERTIFICATE-MASTER TO
  6704         DFHEIV20
  6705     MOVE EIBRESP  TO WS-RESPONSE
  6706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6707         IF NOT RESP-NORMAL
  6708            GO TO 0400-EXIT
  6709         END-IF
  6710
  6711         MOVE CM-LF-CANCEL-DT    TO EN-LF-NEW-REF-DT
  6712                                    NEW-LF-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 118
* EL6316.cbl
  6713         MOVE CM-AH-CANCEL-DT    TO EN-AH-NEW-REF-DT
  6714                                    NEW-AH-CANCEL-DT
  6715
  6716         MOVE CM-LF-ITD-CANCEL-AMT TO EN-LF-NEW-REF-AMT
  6717                                      NEW-LF-CANCEL-AMT
  6718         MOVE CM-AH-ITD-CANCEL-AMT TO EN-AH-NEW-REF-AMT
  6719                                      NEW-AH-CANCEL-AMT
  6720
  6721         MOVE CM-LIFE-COMM-PCT   TO EN-LF-NEW-COMM-PCT
  6722                                    EN-LF-NEW-REF-COMM-PCT
  6723                                    NEW-LF-COMM-PCT
  6724
  6725         MOVE CM-AH-COMM-PCT     TO EN-AH-NEW-COMM-PCT
  6726                                    EN-AH-NEW-REF-COMM-PCT
  6727                                    NEW-AH-COMM-PCT
  6728
  6729
  6730         GO TO 0400-CONTINUE
  6731     END-IF.
  6732
  6733
  6734* EXEC CICS READ
  6735*        DATASET   (WS-ERPNDB-FILE-ID)
  6736*        SET       (ADDRESS OF PENDING-BUSINESS)
  6737*        RIDFLD    (PI-ERPNDB-KEY)
  6738*        RESP      (WS-RESPONSE)
  6739*    END-EXEC
  6740*    MOVE '&"S        E          (  N#00006546' TO DFHEIV0
  6741     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6742     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6743     MOVE X'204E233030303036353436' TO DFHEIV0(25:11)
  6744     CALL 'kxdfhei1' USING DFHEIV0,
  6745           WS-ERPNDB-FILE-ID,
  6746           DFHEIV20,
  6747           DFHEIV99,
  6748           PI-ERPNDB-KEY,
  6749           DFHEIV99,
  6750           DFHEIV99,
  6751           DFHEIV99
  6752     SET ADDRESS OF PENDING-BUSINESS TO
  6753         DFHEIV20
  6754     MOVE EIBRESP  TO WS-RESPONSE
  6755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6756     IF NOT RESP-NORMAL
  6757        GO TO 0400-EXIT
  6758     END-IF
  6759     MOVE PB-C-LF-CANCEL-DT      TO EN-LF-NEW-REF-DT
  6760                                    NEW-LF-CANCEL-DT
  6761     MOVE PB-C-AH-CANCEL-DT      TO EN-AH-NEW-REF-DT
  6762                                    NEW-AH-CANCEL-DT
  6763     MOVE PB-C-LF-CANCEL-AMT     TO EN-LF-NEW-REF-AMT
  6764                                    NEW-LF-CANCEL-AMT
  6765     MOVE PB-C-AH-CANCEL-AMT     TO EN-AH-NEW-REF-AMT
  6766                                    NEW-AH-CANCEL-AMT
  6767     MOVE PB-CI-LIFE-COMMISSION  TO EN-LF-COMMISSION
  6768                                    EN-LF-NEW-REF-COMM-PCT
  6769                                    NEW-LF-COMM-PCT
  6770     MOVE PB-CI-AH-COMMISSION    TO EN-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 119
* EL6316.cbl
  6771                                    EN-AH-NEW-REF-COMM-PCT
  6772                                    NEW-AH-COMM-PCT.
  6773     MOVE PB-ENTRY-BATCH         TO EN-BATCH-NUMBER.
  6774
  6775 0400-CONTINUE.
  6776
  6777     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6778     MOVE 'C'                    TO EN-DOCU-TYPE
  6779     MOVE 'Y'                    TO EN-MONEY-SW
  6780     MOVE W-ACCT-SUMM            TO EN-ACCT-SUMM
  6781     MOVE W-CSO-SUMM             TO EN-CSO-SUMM
  6782     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6783        IF REACD-IN (S1) NOT = LOW-VALUES
  6784           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6785        END-IF
  6786     END-PERFORM
  6787     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6788
  6789     IF ACCT-FOUND
  6790        IF PI-FROM-CERT = 'Y'
  6791            MOVE CM-CERT-EFF-DT  TO DC-BIN-DATE-1
  6792            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-2
  6793            IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  6794                MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  6795            END-IF
  6796        ELSE
  6797            MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  6798            MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
  6799            IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  6800               MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-2
  6801            END-IF
  6802        END-IF
  6803        MOVE '1'                 TO DC-OPTION-CODE
  6804        PERFORM 9700-DATE-LINK
  6805        IF NO-CONVERSION-ERROR
  6806           MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  6807           IF DC-ODD-DAYS-OVER > +1
  6808              ADD +1          TO WS-DIFF
  6809           END-IF
  6810        ELSE
  6811            MOVE +0           TO WS-DIFF
  6812        END-IF
  6813     ELSE
  6814        MOVE +0           TO WS-DIFF
  6815     END-IF
  6816
  6817     COMPUTE WS-DUE-BORROWER = (EN-LF-NEW-REF-AMT
  6818         + EN-AH-NEW-REF-AMT)
  6819
  6820     IF (WS-CHGBACK = 99)
  6821         OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  6822          MOVE WS-DUE-BORROWER TO EN-CSO-PORTION
  6823          MOVE ZEROS           TO EN-ACCT-PORTION
  6824          MOVE 'N'             TO EN-COMM-CHGBK
  6825     ELSE
  6826         COMPUTE EN-ACCT-PORTION = (EN-LF-NEW-REF-AMT
  6827                 * EN-LF-COMMISSION) +
  6828                (EN-AH-NEW-REF-AMT * EN-AH-COMMISSION)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 120
* EL6316.cbl
  6829         COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER
  6830                 - EN-ACCT-PORTION
  6831         MOVE 'Y'                TO EN-COMM-CHGBK
  6832     END-IF
  6833     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6834     .
  6835 0400-EXIT.
  6836     EXIT.
  6837 0410-INIT-ERENDT.
  6838     MOVE OC-CONTROL-PRIMARY (1:33) TO ERENDT-KEY (1:33)
  6839     MOVE 'C'                    TO ENDT-RECORD-TYPE
  6840     MOVE ZEROS                  TO ENDT-SEQ-NO
  6841
  6842* EXEC CICS READ
  6843*        DATASET    (WS-ERENDT-FILE-ID)
  6844*        RIDFLD     (ERENDT-KEY)
  6845*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
  6846*        RESP       (WS-RESPONSE)
  6847*        GTEQ
  6848*    END-EXEC
  6849*    MOVE '&"S        G          (  N#00006637' TO DFHEIV0
  6850     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6851     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6852     MOVE X'204E233030303036363337' TO DFHEIV0(25:11)
  6853     CALL 'kxdfhei1' USING DFHEIV0,
  6854           WS-ERENDT-FILE-ID,
  6855           DFHEIV20,
  6856           DFHEIV99,
  6857           ERENDT-KEY,
  6858           DFHEIV99,
  6859           DFHEIV99,
  6860           DFHEIV99
  6861     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6862         DFHEIV20
  6863     MOVE EIBRESP  TO WS-RESPONSE
  6864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6865     IF RESP-NORMAL
  6866        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
  6867        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6868     ELSE
  6869        MOVE +4096               TO WS-SEQ-NO
  6870     END-IF
  6871     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6872     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6873     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6874     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6875     MOVE WS-CURRENT-BIN-DT      TO EN-PROCESS-DT
  6876     MOVE 'C'                    TO EN-REC-TYPE
  6877     INITIALIZE EN-CANCEL-RECORD
  6878     MOVE ZEROS TO EN-CSO-PORTION EN-ACCT-PORTION
  6879     MOVE LOW-VALUES             TO EN-LF-ORIG-REF-DT
  6880                                    EN-AH-ORIG-REF-DT
  6881                                    EN-LF-NEW-REF-DT
  6882                                    EN-AH-NEW-REF-DT
  6883     .
  6884 0410-EXIT.
  6885     EXIT.
  6886 0420-UPDATE-ELCRTO.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 121
* EL6316.cbl
  6887     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6888     IF RESP-NORMAL
  6889        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6890                                    OC-LAST-MAINT-DT
  6891        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6892        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6893
  6894* EXEC CICS REWRITE
  6895*          FROM     (ORIGINAL-CERTIFICATE)
  6896*          DATASET  ('ELCRTO')
  6897*       END-EXEC
  6898     MOVE LENGTH OF
  6899      ORIGINAL-CERTIFICATE
  6900       TO DFHEIV11
  6901     MOVE 'ELCRTO' TO DFHEIV1
  6902*    MOVE '&& L                  %   #00006672' TO DFHEIV0
  6903     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6904     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6905     MOVE X'2020233030303036363732' TO DFHEIV0(25:11)
  6906     CALL 'kxdfhei1' USING DFHEIV0,
  6907           DFHEIV1,
  6908           ORIGINAL-CERTIFICATE,
  6909           DFHEIV11,
  6910           DFHEIV99
  6911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6912     END-IF
  6913     .
  6914 0420-EXIT.
  6915     EXIT.
  6916
  6917 0425-ADD-NEW-ELCRTO.
  6918     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6919     MOVE 'OC'                   TO OC-RECORD-ID
  6920     MOVE PI-ELCRTO-KEY          TO OC-CONTROL-PRIMARY
  6921     SUBTRACT +1                 FROM OC-KEY-SEQ-NO
  6922     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6923     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6924     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6925     MOVE NEW-INS-FIRST-NAME     TO OC-INS-FIRST-NAME
  6926     MOVE NEW-INS-MIDDLE-INIT    TO OC-INS-MIDDLE-INIT
  6927     MOVE NEW-INS-LAST-NAME      TO OC-INS-LAST-NAME
  6928     MOVE NEW-INS-AGE            TO OC-INS-AGE
  6929     MOVE NEW-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  6930     MOVE NEW-JNT-FIRST-NAME     TO OC-JNT-FIRST-NAME
  6931     MOVE NEW-JNT-MIDDLE-INIT    TO OC-JNT-MIDDLE-INIT
  6932     MOVE NEW-JNT-LAST-NAME      TO OC-JNT-LAST-NAME
  6933     MOVE NEW-JNT-AGE            TO OC-JNT-AGE
  6934     MOVE NEW-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  6935     MOVE NEW-LF-BENCD           TO OC-LF-BENCD
  6936     MOVE NEW-LF-BEN-AMT         TO OC-LF-BEN-AMT
  6937     MOVE NEW-LF-PRM-AMT         TO OC-LF-PRM-AMT
  6938     MOVE NEW-LF-ALT-BEN-AMT     TO OC-LF-ALT-BEN-AMT
  6939     MOVE NEW-LF-ALT-PRM-AMT     TO OC-LF-ALT-PRM-AMT
  6940     MOVE NEW-LF-TERM            TO OC-LF-TERM
  6941     MOVE NEW-LF-EXP-DT          TO OC-LF-EXP-DT
  6942     MOVE NEW-LF-COMM-PCT        TO OC-LF-COMM-PCT
  6943     MOVE NEW-LF-CANCEL-DT       TO OC-LF-CANCEL-DT
  6944     MOVE NEW-LF-CANCEL-AMT      TO OC-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 122
* EL6316.cbl
  6945     MOVE NEW-AH-BENCD           TO OC-AH-BENCD
  6946     MOVE NEW-AH-BEN-AMT         TO OC-AH-BEN-AMT
  6947     MOVE NEW-AH-PRM-AMT         TO OC-AH-PRM-AMT
  6948     MOVE NEW-AH-TERM            TO OC-AH-TERM
  6949     MOVE NEW-AH-EXP-DT          TO OC-AH-EXP-DT
  6950     MOVE NEW-AH-CP              TO OC-AH-CP
  6951     MOVE NEW-AH-COMM-PCT        TO OC-AH-COMM-PCT
  6952     MOVE NEW-AH-CANCEL-DT       TO OC-AH-CANCEL-DT
  6953     MOVE NEW-AH-CANCEL-AMT      TO OC-AH-CANCEL-AMT
  6954     MOVE NEW-CRED-BENE-NAME     TO OC-CRED-BENE-NAME
  6955     MOVE NEW-1ST-PMT-DT         TO OC-1ST-PMT-DT
  6956     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
  6957     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  6958     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6959     .
  6960 0425-WRITE-ELCRTO.
  6961
  6962
  6963* EXEC CICS WRITE
  6964*       DATASET   ('ELCRTO')
  6965*       FROM      (ORIGINAL-CERTIFICATE)
  6966*       RIDFLD    (OC-CONTROL-PRIMARY)
  6967*       RESP      (WS-RESPONSE)
  6968*    END-EXEC
  6969     MOVE LENGTH OF
  6970      ORIGINAL-CERTIFICATE
  6971       TO DFHEIV11
  6972     MOVE 'ELCRTO' TO DFHEIV1
  6973*    MOVE '&$ L                  ''  N#00006726' TO DFHEIV0
  6974     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6975     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6976     MOVE X'204E233030303036373236' TO DFHEIV0(25:11)
  6977     CALL 'kxdfhei1' USING DFHEIV0,
  6978           DFHEIV1,
  6979           ORIGINAL-CERTIFICATE,
  6980           DFHEIV11,
  6981           OC-CONTROL-PRIMARY,
  6982           DFHEIV99,
  6983           DFHEIV99
  6984     MOVE EIBRESP  TO WS-RESPONSE
  6985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6986
  6987     display ' just wrote new crto ' ws-response
  6988     IF RESP-DUPKEY
  6989        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6990        GO TO 0425-WRITE-ELCRTO
  6991     ELSE
  6992        IF NOT RESP-NORMAL
  6993           MOVE -1               TO LTRIDL
  6994           MOVE ER-3830          TO EMI-ERROR
  6995           PERFORM 9900-ERROR-FORMAT
  6996                                 THRU 9900-EXIT
  6997        ELSE
  6998           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6999        END-IF
  7000     END-IF
  7001
  7002     .
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 123
* EL6316.cbl
  7003 0425-EXIT.
  7004     EXIT.
  7005
  7006 0426-ADD-CERT-NOTES.
  7007
  7008     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  7009     SET TB-INDX TO 1
  7010
  7011     IF PI-CERTNT1-ENTERED > SPACES
  7012         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7013         MOVE PI-PROCESSOR-ID    TO
  7014                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7015         MOVE EIBTIME            TO
  7016                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7017         MOVE WS-CURRENT-BIN-DT  TO
  7018                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7019         SET TB-INDX UP BY +1
  7020     END-IF
  7021
  7022     IF PI-CERTNT2-ENTERED > SPACES
  7023         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7024         MOVE PI-PROCESSOR-ID    TO
  7025                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7026         MOVE EIBTIME            TO
  7027                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7028         MOVE WS-CURRENT-BIN-DT  TO
  7029                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7030         SET TB-INDX UP BY +1
  7031     END-IF
  7032
  7033     IF CERT-NOTE-ENTRIES > SPACES
  7034         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  7035         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  7036     END-IF
  7037
  7038     IF PI-BILLNT1-ENTERED > SPACES
  7039         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  7040         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  7041         MOVE +63 TO WS-LEN
  7042         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7043     END-IF
  7044
  7045     .
  7046 0426-EXIT.
  7047     EXIT.
  7048
  7049 0427-LOAD-CURRENT-CERT-NOTES.
  7050
  7051     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  7052     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  7053     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  7054     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  7055     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  7056     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  7057     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  7058     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  7059     MOVE '1'                 TO ERCNOT-REC-TYP
  7060     MOVE +0                  TO ERCNOT-SEQ
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 124
* EL6316.cbl
  7061     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  7062
  7063
  7064* EXEC CICS STARTBR
  7065*         DATASET(WS-ERCNOT-FILE-ID)
  7066*         RIDFLD(ERCNOT-KEY)
  7067*         KEYLENGTH(ERCNOT-START-LENGTH)
  7068*         RESP      (WS-RESPONSE)
  7069*         GENERIC
  7070*         GTEQ
  7071*    END-EXEC.
  7072     MOVE 0
  7073       TO DFHEIV11
  7074*    MOVE '&,   KG    G          &  N#00006809' TO DFHEIV0
  7075     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  7076     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7077     MOVE X'204E233030303036383039' TO DFHEIV0(25:11)
  7078     CALL 'kxdfhei1' USING DFHEIV0,
  7079           WS-ERCNOT-FILE-ID,
  7080           ERCNOT-KEY,
  7081           ERCNOT-START-LENGTH,
  7082           DFHEIV11,
  7083           DFHEIV99
  7084     MOVE EIBRESP  TO WS-RESPONSE
  7085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7086
  7087
  7088     IF NOT RESP-NORMAL
  7089        GO TO 0427-ENDBR
  7090     END-IF.
  7091
  7092 0427-LOOP.
  7093
  7094* EXEC CICS READNEXT
  7095*         SET(ADDRESS OF CERT-NOTE-FILE)
  7096*         DATASET(WS-ERCNOT-FILE-ID)
  7097*         RIDFLD(ERCNOT-KEY)
  7098*    END-EXEC.
  7099     MOVE 0
  7100       TO DFHEIV11
  7101*    MOVE '&.S                   )   #00006823' TO DFHEIV0
  7102     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7103     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7104     MOVE X'2020233030303036383233' TO DFHEIV0(25:11)
  7105     CALL 'kxdfhei1' USING DFHEIV0,
  7106           WS-ERCNOT-FILE-ID,
  7107           DFHEIV20,
  7108           DFHEIV99,
  7109           ERCNOT-KEY,
  7110           DFHEIV99,
  7111           DFHEIV11,
  7112           DFHEIV99,
  7113           DFHEIV99
  7114     SET ADDRESS OF CERT-NOTE-FILE TO
  7115         DFHEIV20
  7116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7117
  7118
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 125
* EL6316.cbl
  7119     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  7120         GO TO 0427-ENDBR
  7121     END-IF.
  7122
  7123     IF (CZ-CARRIER = SV-CARRIER)
  7124        AND (CZ-GROUPING = SV-GROUPING)
  7125        AND (CZ-STATE = SV-STATE)
  7126        AND (CZ-ACCOUNT = SV-ACCOUNT)
  7127        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  7128        AND (CZ-CERT-NO = SV-CERT-NO)
  7129        AND (CZ-RECORD-TYPE = '1')
  7130          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  7131          MOVE CZ-LAST-MAINT-USER TO
  7132                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7133          MOVE CZ-LAST-MAINT-DT TO
  7134                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7135          MOVE CZ-LAST-MAINT-HHMMSS TO
  7136                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7137          SET TB-INDX UP BY 1
  7138          GO TO 0427-LOOP
  7139     END-IF.
  7140
  7141 0427-ENDBR.
  7142
  7143
  7144* EXEC CICS ENDBR
  7145*         DATASET(WS-ERCNOT-FILE-ID)
  7146*    END-EXEC.
  7147     MOVE 0
  7148       TO DFHEIV11
  7149*    MOVE '&2                    $   #00006853' TO DFHEIV0
  7150     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7151     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7152     MOVE X'2020233030303036383533' TO DFHEIV0(25:11)
  7153     CALL 'kxdfhei1' USING DFHEIV0,
  7154           WS-ERCNOT-FILE-ID,
  7155           DFHEIV11,
  7156           DFHEIV99
  7157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7158
  7159
  7160     .
  7161 0427-EXIT.
  7162     EXIT.
  7163
  7164 0430-WRITE-ERENDT.
  7165     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  7166     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  7167     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  7168
  7169* EXEC CICS WRITE
  7170*         DATASET   (WS-ERENDT-FILE-ID)
  7171*         FROM      (ENDORSEMENT-RECORD)
  7172*         RIDFLD    (EN-CONTROL-PRIMARY)
  7173*         RESP      (WS-RESPONSE)
  7174*    END-EXEC
  7175     MOVE LENGTH OF
  7176      ENDORSEMENT-RECORD
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 126
* EL6316.cbl
  7177       TO DFHEIV11
  7178*    MOVE '&$ L                  ''  N#00006865' TO DFHEIV0
  7179     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7180     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7181     MOVE X'204E233030303036383635' TO DFHEIV0(25:11)
  7182     CALL 'kxdfhei1' USING DFHEIV0,
  7183           WS-ERENDT-FILE-ID,
  7184           ENDORSEMENT-RECORD,
  7185           DFHEIV11,
  7186           EN-CONTROL-PRIMARY,
  7187           DFHEIV99,
  7188           DFHEIV99
  7189     MOVE EIBRESP  TO WS-RESPONSE
  7190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7191     IF RESP-NORMAL
  7192        MOVE 'C'                 TO PI-DOCUMENT-PROCESSED
  7193        display ' good write erendt '
  7194        IF EIBAID = DFHPF4
  7195           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  7196           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  7197           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  7198           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  7199        END-IF
  7200     ELSE
  7201        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  7202        MOVE -1                  TO LTRIDL
  7203        MOVE ER-0132             TO EMI-ERROR
  7204        MOVE AL-UABON            TO LTRIDA
  7205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7206     END-IF
  7207     .
  7208 0430-EXIT.
  7209     EXIT.
  7210 0440-ADD-BILLING-NOTE.
  7211
  7212* EXEC CICS GETMAIN
  7213*         SET      (ADDRESS OF EOB-CODES)
  7214*         LENGTH   (ELEOBC-LENGTH)
  7215*         INITIMG  (GETMAIN-SPACE)
  7216*    END-EXEC
  7217*    MOVE ',"IL                  $   #00006891' TO DFHEIV0
  7218     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7219     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7220     MOVE X'2020233030303036383931' TO DFHEIV0(25:11)
  7221     CALL 'kxdfhei1' USING DFHEIV0,
  7222           DFHEIV20,
  7223           ELEOBC-LENGTH,
  7224           GETMAIN-SPACE
  7225     SET ADDRESS OF EOB-CODES TO
  7226         DFHEIV20
  7227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7228
  7229     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  7230     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  7231     MOVE '5'                    TO WS-EOBC-REC-TYPE
  7232
  7233
  7234* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 127
* EL6316.cbl
  7235*        DATASET   ('ELEOBC')
  7236*        RIDFLD    (WS-ELEOBC-KEY)
  7237*        GTEQ
  7238*        RESP      (WS-RESPONSE)
  7239*    END-EXEC
  7240     MOVE 'ELEOBC' TO DFHEIV1
  7241     MOVE 0
  7242       TO DFHEIV11
  7243*    MOVE '&,         G          &  N#00006901' TO DFHEIV0
  7244     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7245     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7246     MOVE X'204E233030303036393031' TO DFHEIV0(25:11)
  7247     CALL 'kxdfhei1' USING DFHEIV0,
  7248           DFHEIV1,
  7249           WS-ELEOBC-KEY,
  7250           DFHEIV99,
  7251           DFHEIV11,
  7252           DFHEIV99
  7253     MOVE EIBRESP  TO WS-RESPONSE
  7254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7255
  7256     IF NOT RESP-NORMAL
  7257        GO TO 0440-EXIT
  7258     END-IF
  7259      .
  7260 0440-READNEXT-ELEOBC.
  7261
  7262
  7263* EXEC CICS READNEXT
  7264*       INTO    (EOB-CODES)
  7265*       DATASET ('ELEOBC')
  7266*       RIDFLD  (WS-ELEOBC-KEY)
  7267*       RESP    (WS-RESPONSE)
  7268*    END-EXEC
  7269     MOVE LENGTH OF
  7270      EOB-CODES
  7271       TO DFHEIV12
  7272     MOVE 'ELEOBC' TO DFHEIV1
  7273     MOVE 0
  7274       TO DFHEIV11
  7275*    MOVE '&.IL                  )  N#00006914' TO DFHEIV0
  7276     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7277     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7278     MOVE X'204E233030303036393134' TO DFHEIV0(25:11)
  7279     CALL 'kxdfhei1' USING DFHEIV0,
  7280           DFHEIV1,
  7281           EOB-CODES,
  7282           DFHEIV12,
  7283           WS-ELEOBC-KEY,
  7284           DFHEIV99,
  7285           DFHEIV11,
  7286           DFHEIV99,
  7287           DFHEIV99
  7288     MOVE EIBRESP  TO WS-RESPONSE
  7289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7290
  7291     IF RESP-NORMAL
  7292         IF EO-RECORD-TYPE NOT = '5'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 128
* EL6316.cbl
  7293             GO TO 0440-EXIT
  7294         END-IF
  7295     ELSE
  7296         GO TO 0440-EXIT
  7297     END-IF
  7298
  7299     IF EO-RECORD-TYPE = '5' AND
  7300        EO-EOB-CODE = PI-LTRID-ENTERED
  7301           CONTINUE
  7302     ELSE
  7303         GO TO 0440-READNEXT-ELEOBC
  7304     END-IF
  7305
  7306     MOVE SPACES TO WS-BILLING-NOTE
  7307     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  7308     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  7309     MOVE WS-CURRENT-DT TO WS-BN-DATE
  7310     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  7311     MOVE +25 TO WS-LEN
  7312
  7313     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7314     .
  7315 0440-EXIT.
  7316     EXIT.
  7317
  7318 0441-UPDATE-BILLING-NOTE.
  7319
  7320* EXEC CICS GETMAIN
  7321*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7322*         LENGTH   (ERNOTE-LENGTH)
  7323*         INITIMG  (GETMAIN-SPACE)
  7324*    END-EXEC
  7325*    MOVE ',"IL                  $   #00006949' TO DFHEIV0
  7326     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7327     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7328     MOVE X'2020233030303036393439' TO DFHEIV0(25:11)
  7329     CALL 'kxdfhei1' USING DFHEIV0,
  7330           DFHEIV20,
  7331           ERNOTE-LENGTH,
  7332           GETMAIN-SPACE
  7333     SET ADDRESS OF CERTIFICATE-NOTE TO
  7334         DFHEIV20
  7335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7336
  7337     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7338
  7339
  7340* EXEC CICS READ
  7341*       DATASET    (WS-ERNOTE-FILE-ID)
  7342*       RIDFLD     (WS-ERNOTE-KEY)
  7343*       INTO       (CERTIFICATE-NOTE)
  7344*       RESP       (WS-RESPONSE)
  7345*       UPDATE
  7346*    END-EXEC
  7347     MOVE LENGTH OF
  7348      CERTIFICATE-NOTE
  7349       TO DFHEIV11
  7350*    MOVE '&"IL       EU         (  N#00006957' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 129
* EL6316.cbl
  7351     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7352     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7353     MOVE X'204E233030303036393537' TO DFHEIV0(25:11)
  7354     CALL 'kxdfhei1' USING DFHEIV0,
  7355           WS-ERNOTE-FILE-ID,
  7356           CERTIFICATE-NOTE,
  7357           DFHEIV11,
  7358           WS-ERNOTE-KEY,
  7359           DFHEIV99,
  7360           DFHEIV99,
  7361           DFHEIV99
  7362     MOVE EIBRESP  TO WS-RESPONSE
  7363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7364
  7365     IF RESP-NORMAL
  7366       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7367          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7368       END-IF
  7369       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7370          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7371       END-IF
  7372       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7373           (NOTE-SUB > +10) OR
  7374           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7375                             WS-BILLING-NOTE (1:WS-LEN))
  7376       END-PERFORM
  7377       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7378                              WS-BILLING-NOTE (1:WS-LEN)
  7379
  7380* EXEC CICS UNLOCK
  7381*           DATASET    (WS-ERNOTE-FILE-ID)
  7382*        END-EXEC
  7383*    MOVE '&*                    #   #00006979' TO DFHEIV0
  7384     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7385     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7386     MOVE X'2020233030303036393739' TO DFHEIV0(25:11)
  7387     CALL 'kxdfhei1' USING DFHEIV0,
  7388           WS-ERNOTE-FILE-ID,
  7389           DFHEIV99
  7390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7391       ELSE
  7392         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7393           (NOTE-SUB > +10) OR
  7394           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7395         END-PERFORM
  7396         IF (NOTE-SUB < +11)
  7397           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7398              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7399                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7400           ELSE
  7401             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7402              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7403                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7404                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7405             ELSE
  7406               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7407                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7408                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 130
* EL6316.cbl
  7409                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7410               ELSE
  7411                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7412                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7413                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7414                                       CN-BILLING-START-LINE-NO
  7415                 ELSE
  7416                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7417                 END-IF
  7418               END-IF
  7419             END-IF
  7420           END-IF
  7421           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7422           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7423           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7424
  7425* EXEC CICS REWRITE
  7426*             DATASET    (WS-ERNOTE-FILE-ID)
  7427*             FROM       (CERTIFICATE-NOTE)
  7428*             RESP       (WS-RESPONSE)
  7429*          END-EXEC
  7430     MOVE LENGTH OF
  7431      CERTIFICATE-NOTE
  7432       TO DFHEIV11
  7433*    MOVE '&& L                  %  N#00007015' TO DFHEIV0
  7434     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7435     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7436     MOVE X'204E233030303037303135' TO DFHEIV0(25:11)
  7437     CALL 'kxdfhei1' USING DFHEIV0,
  7438           WS-ERNOTE-FILE-ID,
  7439           CERTIFICATE-NOTE,
  7440           DFHEIV11,
  7441           DFHEIV99
  7442     MOVE EIBRESP  TO WS-RESPONSE
  7443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7444           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7445         END-IF
  7446       END-IF
  7447     ELSE
  7448        MOVE SPACES              TO CERTIFICATE-NOTE
  7449        MOVE 'CN'                TO CN-RECORD-ID
  7450        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7451                                     WS-ERNOTE-KEY
  7452        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7453                                    CN-BILLING-END-LINE-NO
  7454        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7455        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7456        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7457        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7458
  7459* EXEC CICS WRITE
  7460*          DATASET    (WS-ERNOTE-FILE-ID)
  7461*          FROM       (CERTIFICATE-NOTE)
  7462*          RIDFLD     (WS-ERNOTE-KEY)
  7463*          RESP       (WS-RESPONSE)
  7464*       END-EXEC
  7465     MOVE LENGTH OF
  7466      CERTIFICATE-NOTE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 131
* EL6316.cbl
  7467       TO DFHEIV11
  7468*    MOVE '&$ L                  ''  N#00007034' TO DFHEIV0
  7469     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7470     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7471     MOVE X'204E233030303037303334' TO DFHEIV0(25:11)
  7472     CALL 'kxdfhei1' USING DFHEIV0,
  7473           WS-ERNOTE-FILE-ID,
  7474           CERTIFICATE-NOTE,
  7475           DFHEIV11,
  7476           WS-ERNOTE-KEY,
  7477           DFHEIV99,
  7478           DFHEIV99
  7479     MOVE EIBRESP  TO WS-RESPONSE
  7480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7481
  7482        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7483     END-IF
  7484
  7485     .
  7486 0441-EXIT.
  7487     EXIT.
  7488
  7489
  7490 0442-SQUEEZE-IT-IN.
  7491
  7492     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7493        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7494           NOTE-SUB = +10
  7495           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7496           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7497             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7498             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7499             MOVE +9 TO NOTE-SUB
  7500           END-IF
  7501        END-PERFORM
  7502     ELSE
  7503        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7504           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7505             UNTIL NOTE-SUB = +1
  7506             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7507             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7508                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7509                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7510                MOVE +2          TO NOTE-SUB
  7511             END-IF
  7512           END-PERFORM
  7513        END-IF
  7514     END-IF
  7515
  7516     .
  7517 0442-EXIT.
  7518     EXIT.
  7519
  7520 0445-CERTIFICATE-UPDATE.
  7521    display 'billing note written, updating cert'
  7522     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7523     IF RESP-NORMAL
  7524        EVALUATE CM-NOTE-SW
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 132
* EL6316.cbl
  7525           WHEN '2'
  7526           WHEN '3'
  7527           WHEN '6'
  7528           WHEN '7'
  7529              SET NO-CERT-RW     TO TRUE
  7530           WHEN ' '
  7531              MOVE '2'           TO CM-NOTE-SW
  7532           WHEN '1'
  7533              MOVE '3'           TO CM-NOTE-SW
  7534           WHEN '4'
  7535              MOVE '6'           TO CM-NOTE-SW
  7536           WHEN '5'
  7537              MOVE '7'           TO CM-NOTE-SW
  7538        END-EVALUATE
  7539     END-IF
  7540     IF NOT NO-CERT-RW
  7541        PERFORM 1810-REWRITE-ELCERT
  7542                                 THRU 1810-EXIT
  7543     ELSE
  7544
  7545* EXEC CICS UNLOCK
  7546*          DATASET    (WS-ELCERT-FILE-ID)
  7547*       END-EXEC
  7548*    MOVE '&*                    #   #00007103' TO DFHEIV0
  7549     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7550     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7551     MOVE X'2020233030303037313033' TO DFHEIV0(25:11)
  7552     CALL 'kxdfhei1' USING DFHEIV0,
  7553           WS-ELCERT-FILE-ID,
  7554           DFHEIV99
  7555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7556     END-IF
  7557
  7558     .
  7559 0445-EXIT.
  7560     EXIT.
  7561
  7562 0450-GET-ERACCT.
  7563     DISPLAY ' MADE IT TO 0450 '
  7564     MOVE ' '                    TO WS-ERACCT-SW
  7565     MOVE ZEROS                  TO WS-CHGBACK
  7566                                    WS-CSO-PORTION
  7567                                    WS-ACCT-PORTION
  7568                                    WS-DIFF
  7569     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7570     IF RESP-NORMAL
  7571        DISPLAY ' GOOD STARTBR '
  7572        PERFORM 0470-READNEXT-ERACCT
  7573                                 THRU 0470-EXIT
  7574     END-IF
  7575     IF RESP-NORMAL
  7576        DISPLAY ' GOOD READNEXT '
  7577        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7578           IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  7579              AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  7580              DISPLAY ' SETTING ACCT FOUND TO TRUE '
  7581              SET ACCT-FOUND TO TRUE
  7582           ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 133
* EL6316.cbl
  7583              PERFORM 0470-READNEXT-ERACCT
  7584                                 THRU 0470-EXIT
  7585              IF RESP-NORMAL
  7586                 IF AM-CONTROL-PRIMARY (1:20)
  7587                    = EN-CONTROL-PRIMARY (1:20)
  7588                    IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  7589                       AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  7590                       DISPLAY ' SETTING ACCT FOUND TO TRUE '
  7591                       SET ACCT-FOUND TO TRUE
  7592                    END-IF
  7593                 END-IF
  7594              END-IF
  7595           END-IF
  7596        END-IF
  7597     END-IF
  7598     IF ACCT-FOUND
  7599        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7600           (AM-COM-TYP (S1) = 'C' OR 'D')
  7601           OR (S1 > +10)
  7602        END-PERFORM
  7603        IF S1 < +11
  7604           MOVE AM-COMM-CHARGEBACK (S1)
  7605                                 TO WS-CHGBACK
  7606        END-IF
  7607     END-IF
  7608
  7609* EXEC CICS ENDBR
  7610*        DATASET     ('ERACCT')
  7611*    END-EXEC.
  7612     MOVE 'ERACCT' TO DFHEIV1
  7613     MOVE 0
  7614       TO DFHEIV11
  7615*    MOVE '&2                    $   #00007158' TO DFHEIV0
  7616     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7617     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7618     MOVE X'2020233030303037313538' TO DFHEIV0(25:11)
  7619     CALL 'kxdfhei1' USING DFHEIV0,
  7620           DFHEIV1,
  7621           DFHEIV11,
  7622           DFHEIV99
  7623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7624
  7625    .
  7626 0450-EXIT.
  7627     EXIT.
  7628 0460-STARTBR-ERACCT.
  7629     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7630     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7631     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7632
  7633* EXEC CICS STARTBR
  7634*        DATASET   ('ERACCT')
  7635*        RIDFLD    (WS-ERACCT-KEY)
  7636*        GTEQ
  7637*        RESP      (WS-RESPONSE)
  7638*    END-EXEC
  7639     MOVE 'ERACCT' TO DFHEIV1
  7640     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 134
* EL6316.cbl
  7641       TO DFHEIV11
  7642*    MOVE '&,         G          &  N#00007168' TO DFHEIV0
  7643     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7644     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7645     MOVE X'204E233030303037313638' TO DFHEIV0(25:11)
  7646     CALL 'kxdfhei1' USING DFHEIV0,
  7647           DFHEIV1,
  7648           WS-ERACCT-KEY,
  7649           DFHEIV99,
  7650           DFHEIV11,
  7651           DFHEIV99
  7652     MOVE EIBRESP  TO WS-RESPONSE
  7653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7654     .
  7655 0460-EXIT.
  7656     EXIT.
  7657 0470-READNEXT-ERACCT.
  7658
  7659* EXEC CICS READNEXT
  7660*       SET      (ADDRESS OF ACCOUNT-MASTER)
  7661*       DATASET ('ERACCT')
  7662*       RIDFLD  (WS-ERACCT-KEY)
  7663*       RESP    (WS-RESPONSE)
  7664*    END-EXEC
  7665     MOVE 'ERACCT' TO DFHEIV1
  7666     MOVE 0
  7667       TO DFHEIV11
  7668*    MOVE '&.S                   )  N#00007178' TO DFHEIV0
  7669     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7670     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7671     MOVE X'204E233030303037313738' TO DFHEIV0(25:11)
  7672     CALL 'kxdfhei1' USING DFHEIV0,
  7673           DFHEIV1,
  7674           DFHEIV20,
  7675           DFHEIV99,
  7676           WS-ERACCT-KEY,
  7677           DFHEIV99,
  7678           DFHEIV11,
  7679           DFHEIV99,
  7680           DFHEIV99
  7681     SET ADDRESS OF ACCOUNT-MASTER TO
  7682         DFHEIV20
  7683     MOVE EIBRESP  TO WS-RESPONSE
  7684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7685     .
  7686 0470-EXIT.
  7687     EXIT.
  7688 0491-ERNOTE-READ-UPDATE.
  7689
  7690* EXEC CICS READ
  7691*       UPDATE
  7692*       DATASET    (WS-ERNOTE-FILE-ID)
  7693*       RIDFLD     (WS-ERNOTE-KEY)
  7694*       SET        (ADDRESS OF CERTIFICATE-NOTE)
  7695*       RESP       (WS-RESPONSE)
  7696*    END-EXEC
  7697*    MOVE '&"S        EU         (  N#00007188' TO DFHEIV0
  7698     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 135
* EL6316.cbl
  7699     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7700     MOVE X'204E233030303037313838' TO DFHEIV0(25:11)
  7701     CALL 'kxdfhei1' USING DFHEIV0,
  7702           WS-ERNOTE-FILE-ID,
  7703           DFHEIV20,
  7704           DFHEIV99,
  7705           WS-ERNOTE-KEY,
  7706           DFHEIV99,
  7707           DFHEIV99,
  7708           DFHEIV99
  7709     SET ADDRESS OF CERTIFICATE-NOTE TO
  7710         DFHEIV20
  7711     MOVE EIBRESP  TO WS-RESPONSE
  7712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7713     .
  7714 0491-EXIT.
  7715     EXIT.
  7716 0492-REWRITE-ERNOTE.
  7717     MOVE 'E631'              TO CN-LAST-MAINT-USER
  7718     MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7719     MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7720
  7721* EXEC CICS REWRITE
  7722*       DATASET    (WS-ERNOTE-FILE-ID)
  7723*       FROM       (CERTIFICATE-NOTE)
  7724*       RESP       (WS-RESPONSE)
  7725*    END-EXEC
  7726     MOVE LENGTH OF
  7727      CERTIFICATE-NOTE
  7728       TO DFHEIV11
  7729*    MOVE '&& L                  %  N#00007202' TO DFHEIV0
  7730     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7731     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7732     MOVE X'204E233030303037323032' TO DFHEIV0(25:11)
  7733     CALL 'kxdfhei1' USING DFHEIV0,
  7734           WS-ERNOTE-FILE-ID,
  7735           CERTIFICATE-NOTE,
  7736           DFHEIV11,
  7737           DFHEIV99
  7738     MOVE EIBRESP  TO WS-RESPONSE
  7739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7740     .
  7741 0492-EXIT.
  7742     EXIT.
  7743 0493-SQUEEZE-ERNOTE.
  7744     IF CN-BILLING-START-LINE-NO > 0
  7745         MOVE CN-BILLING-START-LINE-NO TO NOTE-SUB
  7746     ELSE
  7747         MOVE +1                 TO NOTE-SUB
  7748     END-IF.
  7749
  7750     PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7751        (NOTE-SUB > +9)
  7752        IF CN-LINE (NOTE-SUB) = SPACES
  7753           MOVE CN-LINE (NOTE-SUB + +1)
  7754                                 TO CN-LINE (NOTE-SUB)
  7755           MOVE SPACES           TO CN-LINE (NOTE-SUB + +1)
  7756        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 136
* EL6316.cbl
  7757     END-PERFORM
  7758     .
  7759 0493-EXIT.
  7760     EXIT.
  7761 0500-ERENDT-READ-GTEQ.
  7762
  7763* EXEC CICS READ
  7764*        DATASET    (WS-ERENDT-FILE-ID)
  7765*        RIDFLD     (ERENDT-KEY)
  7766*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7767*        RESP       (WS-RESPONSE)
  7768*        GTEQ
  7769*    END-EXEC
  7770*    MOVE '&"S        G          (  N#00007229' TO DFHEIV0
  7771     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7772     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7773     MOVE X'204E233030303037323239' TO DFHEIV0(25:11)
  7774     CALL 'kxdfhei1' USING DFHEIV0,
  7775           WS-ERENDT-FILE-ID,
  7776           DFHEIV20,
  7777           DFHEIV99,
  7778           ERENDT-KEY,
  7779           DFHEIV99,
  7780           DFHEIV99,
  7781           DFHEIV99
  7782     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7783         DFHEIV20
  7784     MOVE EIBRESP  TO WS-RESPONSE
  7785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7786     IF NOT RESP-NORMAL
  7787        MOVE ER-2237             TO EMI-ERROR
  7788        PERFORM 9900-ERROR-FORMAT
  7789                                 THRU 9900-EXIT
  7790        MOVE -1                  TO CARRL
  7791        GO TO 8200-SEND-DATAONLY
  7792     END-IF
  7793     .
  7794 0500-EXIT.
  7795     EXIT.
  7796 0510-ERENDT-READNEXT.
  7797
  7798* EXEC CICS READNEXT
  7799*       DATASET    (WS-ERENDT-FILE-ID)
  7800*       RIDFLD     (ERENDT-KEY)
  7801*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7802*       RESP       (WS-RESPONSE)
  7803*    END-EXEC
  7804     MOVE 0
  7805       TO DFHEIV11
  7806*    MOVE '&.S                   )  N#00007247' TO DFHEIV0
  7807     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7808     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7809     MOVE X'204E233030303037323437' TO DFHEIV0(25:11)
  7810     CALL 'kxdfhei1' USING DFHEIV0,
  7811           WS-ERENDT-FILE-ID,
  7812           DFHEIV20,
  7813           DFHEIV99,
  7814           ERENDT-KEY,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 137
* EL6316.cbl
  7815           DFHEIV99,
  7816           DFHEIV11,
  7817           DFHEIV99,
  7818           DFHEIV99
  7819     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7820         DFHEIV20
  7821     MOVE EIBRESP  TO WS-RESPONSE
  7822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7823     IF NOT RESP-NORMAL
  7824        MOVE ER-2237             TO EMI-ERROR
  7825        PERFORM 9900-ERROR-FORMAT
  7826                                 THRU 9900-EXIT
  7827        MOVE -1                  TO CARRL
  7828        GO TO 8200-SEND-DATAONLY
  7829     END-IF
  7830     .
  7831 0510-EXIT.
  7832     EXIT.
  7833 0520-ERENDT-STARTBR.
  7834
  7835* EXEC CICS STARTBR
  7836*       DATASET    (WS-ERENDT-FILE-ID)
  7837*       RIDFLD     (ERENDT-KEY)
  7838*       RESP       (WS-RESPONSE)
  7839*    END-EXEC
  7840     MOVE 0
  7841       TO DFHEIV11
  7842*    MOVE '&,         G          &  N#00007264' TO DFHEIV0
  7843     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7844     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7845     MOVE X'204E233030303037323634' TO DFHEIV0(25:11)
  7846     CALL 'kxdfhei1' USING DFHEIV0,
  7847           WS-ERENDT-FILE-ID,
  7848           ERENDT-KEY,
  7849           DFHEIV99,
  7850           DFHEIV11,
  7851           DFHEIV99
  7852     MOVE EIBRESP  TO WS-RESPONSE
  7853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7854     IF NOT RESP-NORMAL
  7855        MOVE ER-2237             TO EMI-ERROR
  7856        PERFORM 9900-ERROR-FORMAT
  7857                                 THRU 9900-EXIT
  7858        MOVE -1                  TO CARRL
  7859        GO TO 8200-SEND-DATAONLY
  7860     END-IF
  7861     .
  7862 0520-EXIT.
  7863     EXIT.
  7864 0530-ERENDT-READPREV.
  7865
  7866* EXEC CICS READPREV
  7867*       DATASET    (WS-ERENDT-FILE-ID)
  7868*       RIDFLD     (ERENDT-KEY)
  7869*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7870*       RESP       (WS-RESPONSE)
  7871*    END-EXEC
  7872     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 138
* EL6316.cbl
  7873       TO DFHEIV11
  7874*    MOVE '&0S                   )  N#00007280' TO DFHEIV0
  7875     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  7876     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7877     MOVE X'204E233030303037323830' TO DFHEIV0(25:11)
  7878     CALL 'kxdfhei1' USING DFHEIV0,
  7879           WS-ERENDT-FILE-ID,
  7880           DFHEIV20,
  7881           DFHEIV99,
  7882           ERENDT-KEY,
  7883           DFHEIV99,
  7884           DFHEIV11,
  7885           DFHEIV99,
  7886           DFHEIV99
  7887     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7888         DFHEIV20
  7889     MOVE EIBRESP  TO WS-RESPONSE
  7890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7891     IF NOT RESP-NORMAL
  7892        MOVE ER-2238             TO EMI-ERROR
  7893        PERFORM 9900-ERROR-FORMAT
  7894                                 THRU 9900-EXIT
  7895        MOVE -1                  TO CARRL
  7896        MOVE 'N'                 TO PI-ENDORSE-RECORD
  7897        MOVE LOW-VALUES          TO  EL631II
  7898        GO TO 0350-DISPLAY-COMMON-DATA
  7899     END-IF
  7900     .
  7901 0530-EXIT.
  7902     EXIT.
  7903 0600-CREATE-TEMP-STORAGE.
  7904
  7905* EXEC CICS WRITEQ TS
  7906*        QUEUE (QID)
  7907*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7908*        LENGTH(PI-COMM-LENGTH)
  7909*    END-EXEC
  7910*    MOVE '*"     L              ''   #00007299' TO DFHEIV0
  7911     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7912     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7913     MOVE X'2020233030303037323939' TO DFHEIV0(25:11)
  7914     CALL 'kxdfhei1' USING DFHEIV0,
  7915           QID,
  7916           PROGRAM-INTERFACE-BLOCK,
  7917           PI-COMM-LENGTH,
  7918           DFHEIV99,
  7919           DFHEIV99,
  7920           DFHEIV99
  7921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7922     display ' about to write map ' el631ii
  7923
  7924* EXEC CICS WRITEQ TS
  7925*        QUEUE (QID)
  7926*        FROM  (EL631II)
  7927*        LENGTH(MAP-LENGTH)
  7928*    END-EXEC.
  7929*    MOVE '*"     L              ''   #00007305' TO DFHEIV0
  7930     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 139
* EL6316.cbl
  7931     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7932     MOVE X'2020233030303037333035' TO DFHEIV0(25:11)
  7933     CALL 'kxdfhei1' USING DFHEIV0,
  7934           QID,
  7935           EL631II,
  7936           MAP-LENGTH,
  7937           DFHEIV99,
  7938           DFHEIV99,
  7939           DFHEIV99
  7940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7941
  7942 0600-EXIT.
  7943      EXIT.
  7944 0610-RECOVER-TEMP-STORAGE.
  7945
  7946* EXEC CICS READQ TS
  7947*        QUEUE (QID)
  7948*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7949*        LENGTH(PI-COMM-LENGTH)
  7950*    END-EXEC
  7951*    MOVE '*$I    L              ''   #00007313' TO DFHEIV0
  7952     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7953     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7954     MOVE X'2020233030303037333133' TO DFHEIV0(25:11)
  7955     CALL 'kxdfhei1' USING DFHEIV0,
  7956           QID,
  7957           PROGRAM-INTERFACE-BLOCK,
  7958           PI-COMM-LENGTH,
  7959           DFHEIV99,
  7960           DFHEIV99,
  7961           DFHEIV99
  7962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7963
  7964* EXEC CICS READQ TS
  7965*        QUEUE (QID)
  7966*        INTO  (EL631II)
  7967*        LENGTH(MAP-LENGTH)
  7968*    END-EXEC
  7969*    MOVE '*$I    L              ''   #00007318' TO DFHEIV0
  7970     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7971     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7972     MOVE X'2020233030303037333138' TO DFHEIV0(25:11)
  7973     CALL 'kxdfhei1' USING DFHEIV0,
  7974           QID,
  7975           EL631II,
  7976           MAP-LENGTH,
  7977           DFHEIV99,
  7978           DFHEIV99,
  7979           DFHEIV99
  7980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7981     display ' map ' EL631II
  7982     PERFORM 0620-DELETE-TS THRU 0620-EXIT
  7983     MOVE AL-UANON            TO LTRIDA
  7984     IF PI-FROM-CERT = 'Y' AND
  7985        PI-PROCESSOR-IS-CSR-SUPER
  7986            MOVE AL-UNNON        TO OLFDTA
  7987                                    OAHDTA
  7988                                    OLFAMTA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 140
* EL6316.cbl
  7989                                    OAHAMTA
  7990     END-IF
  7991     IF WS-SET-CODES-MDT = 'Y'
  7992        move +1                  to s2
  7993        perform varying s1 from +1 by +5 until s1 > +60
  7994           MOVE WS-PASSED-REASON-CODES (s1:4)
  7995                                 TO reacd-in (s2)
  7996           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7997               MOVE AL-SANON     TO REACDA (S2)
  7998               MOVE +4           TO REACDL (S2)
  7999           END-IF
  8000           add +1                to s2
  8001        end-perform
  8002        MOVE REASONCDS       TO PI-REASONS-ENTERED
  8003     END-IF
  8004
  8005     IF ENCCODEI > SPACES
  8006         MOVE AL-UANON       TO ENCCODEA
  8007     END-IF
  8008
  8009     IF CRTNT1I > SPACES
  8010         MOVE AL-UANON       TO CRTNT1A
  8011     END-IF
  8012
  8013     IF CRTNT2I > SPACES
  8014         MOVE AL-UANON       TO CRTNT2A
  8015     END-IF
  8016
  8017     IF BILNT1I > SPACES
  8018         MOVE AL-UANON       TO BILNT1A
  8019     END-IF
  8020     .
  8021 0610-EXIT.
  8022      EXIT.
  8023 0620-DELETE-TS.
  8024
  8025* EXEC CICS DELETEQ TS
  8026*        QUEUE(QID)
  8027*    END-EXEC
  8028*    MOVE '*&                    #   #00007366' TO DFHEIV0
  8029     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8030     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8031     MOVE X'2020233030303037333636' TO DFHEIV0(25:11)
  8032     CALL 'kxdfhei1' USING DFHEIV0,
  8033           QID,
  8034           DFHEIV99
  8035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8036     .
  8037 0620-EXIT.
  8038      EXIT.
  8039
  8040 0700-LOAD-FROM-CERT.
  8041     PERFORM 0755-READ-CERT THRU 0755-EXIT
  8042     PERFORM 0760-CHECK-OLD-ORIG THRU 0760-EXIT
  8043     PERFORM 0770-MOVE-CERT-TO-SCREEN THRU 0770-EXIT
  8044     MOVE ER-2784                TO EMI-ERROR
  8045     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  8046     GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 141
* EL6316.cbl
  8047     .
  8048 0700-EXIT.
  8049      EXIT.
  8050
  8051
  8052 0755-READ-CERT.
  8053*     display 'made it to 0755'
  8054     MOVE PI-COMPANY-CD          TO W-CERT-COMPANY-CD
  8055     MOVE PI-CARRIER             TO W-CERT-CARRIER
  8056     MOVE PI-GROUPING            TO W-CERT-GROUPING
  8057     MOVE PI-STATE               TO W-CERT-STATE
  8058     MOVE PI-ACCOUNT             TO W-CERT-ACCOUNT
  8059     MOVE PI-CERT-PRIME          TO W-CERT-CERT-PRIME
  8060     MOVE PI-CERT-SFX            TO W-CERT-CERT-SFX
  8061     MOVE PI-CERT-EFF-DT         TO W-CERT-CERT-EFF-DT
  8062
  8063
  8064* EXEC CICS READ
  8065*        DATASET   (WS-ELCERT-FILE-ID)
  8066*        SET       (ADDRESS OF CERTIFICATE-MASTER)
  8067*        RIDFLD    (WS-ELCERT-KEY)
  8068*        RESP      (WS-RESPONSE)
  8069*    END-EXEC
  8070*    MOVE '&"S        E          (  N#00007396' TO DFHEIV0
  8071     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8073     MOVE X'204E233030303037333936' TO DFHEIV0(25:11)
  8074     CALL 'kxdfhei1' USING DFHEIV0,
  8075           WS-ELCERT-FILE-ID,
  8076           DFHEIV20,
  8077           DFHEIV99,
  8078           WS-ELCERT-KEY,
  8079           DFHEIV99,
  8080           DFHEIV99,
  8081           DFHEIV99
  8082     SET ADDRESS OF CERTIFICATE-MASTER TO
  8083         DFHEIV20
  8084     MOVE EIBRESP  TO WS-RESPONSE
  8085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8086
  8087     IF RESP-NORMAL
  8088        CONTINUE
  8089     ELSE
  8090        IF RESP-NOTFND
  8091           MOVE LOW-VALUES       TO EL631II
  8092           MOVE ER-2253          TO EMI-ERROR
  8093           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8094           MOVE -1               TO CARRL
  8095           GO TO 8100-SEND-INITIAL-MAP
  8096        END-IF
  8097     END-IF
  8098
  8099     .
  8100 0755-EXIT.
  8101     EXIT.
  8102
  8103
  8104 0760-CHECK-OLD-ORIG.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 142
* EL6316.cbl
  8105
  8106     display ' made it to 0760 '
  8107
  8108     MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  8109     MOVE PI-CARRIER             TO CRTO-CARRIER
  8110     MOVE PI-GROUPING            TO CRTO-GROUPING
  8111     MOVE PI-STATE               TO CRTO-STATE
  8112     MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  8113     MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  8114     MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  8115     MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  8116     MOVE 'I'                    TO CRTO-RECORD-TYPE
  8117     MOVE ZEROS                  TO CRTO-SEQ-NO
  8118     MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  8119     MOVE ELCRTO-KEY (1:33)      TO PI-ERENDT-KEY (1:33)
  8120     MOVE 'C'                    TO PI-ENDT-RECORD-TYPE
  8121     MOVE ZEROS                  TO PI-ENDT-SEQ-NO
  8122     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  8123
  8124     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  8125      display 'response ' ws-response
  8126      display 'pi-elcrto-key ' pi-elcrto-key
  8127      display 'oc key ' oc-control-primary
  8128     IF RESP-NORMAL
  8129       AND (PI-ELCRTO-KEY (1:33) =
  8130              OC-CONTROL-PRIMARY (1:33))
  8131          DISPLAY 'CRTO RESP NORMAL AND = '
  8132          IF OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES
  8133             MOVE OC-CONTROL-PRIMARY  TO PI-ELCRTO-KEY
  8134          ELSE
  8135             SUBTRACT +1 FROM OC-KEY-SEQ-NO
  8136             PERFORM 0780-ADD-CRTO-REC THRU 0780-EXIT
  8137          END-IF
  8138     ELSE
  8139          MOVE SPACES              TO ORIGINAL-CERTIFICATE
  8140          MOVE 'OC'                TO OC-RECORD-ID
  8141          MOVE ELCRTO-KEY (1:33)   TO OC-CONTROL-PRIMARY (1:33)
  8142          MOVE +4096               TO OC-KEY-SEQ-NO
  8143          PERFORM 0780-ADD-CRTO-REC THRU 0780-EXIT
  8144     END-IF
  8145
  8146     PERFORM 0361-MOVE-CRTO-TO-SCREEN THRU 0361-EXIT
  8147
  8148     .
  8149 0760-EXIT.
  8150     EXIT.
  8151
  8152 0770-MOVE-CERT-TO-SCREEN.
  8153
  8154     display ' made it to 0770 '
  8155
  8156     MOVE CM-CARRIER             TO CARRO
  8157     MOVE CM-GROUPING            TO GROUPO
  8158     MOVE CM-STATE               TO STATEO
  8159     MOVE CM-ACCOUNT             TO ACCTO
  8160     MOVE CM-CERT-PRIME          TO CERTNOO
  8161     MOVE CM-CERT-SFX            TO CRTSFXO
  8162
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 143
* EL6316.cbl
  8163     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  8164     MOVE ' '                    TO DC-OPTION-CODE
  8165     PERFORM 9700-DATE-LINK
  8166     IF NO-CONVERSION-ERROR
  8167        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  8168     END-IF
  8169
  8170     MOVE CM-INSURED-LAST-NAME   TO LNAMEO
  8171     MOVE CM-INSURED-FIRST-NAME  TO FNAMEO
  8172     MOVE CM-INSURED-INITIAL2    TO MINITO
  8173
  8174     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  8175     MOVE ' '                    TO DC-OPTION-CODE
  8176     PERFORM 9700-DATE-LINK
  8177     IF NO-CONVERSION-ERROR
  8178        MOVE DC-GREG-DATE-1-EDIT TO NLFDTO
  8179     END-IF
  8180     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  8181     MOVE ' '                    TO DC-OPTION-CODE
  8182     PERFORM 9700-DATE-LINK
  8183     IF NO-CONVERSION-ERROR
  8184        MOVE DC-GREG-DATE-1-EDIT TO NAHDTO
  8185     END-IF
  8186
  8187     MOVE CM-LF-ITD-CANCEL-AMT   TO NLFAMTO
  8188     MOVE CM-AH-ITD-CANCEL-AMT   TO NAHAMTO
  8189
  8190     IF CM-LIFE-COMM-PCT NOT = ZEROS
  8191        MOVE CM-LIFE-COMM-PCT TO LFCOMMO
  8192     END-IF
  8193     IF CM-AH-COMM-PCT NOT = ZEROS
  8194        MOVE CM-AH-COMM-PCT   TO AHCOMMO
  8195     END-IF
  8196
  8197
  8198     .
  8199 0770-EXIT.
  8200     EXIT.
  8201
  8202
  8203 0780-ADD-CRTO-REC.
  8204      display 'made it to 0780'
  8205     PERFORM 0783-LOAD-CERT-TO-CRTO-REC THRU 0783-EXIT
  8206
  8207
  8208* EXEC CICS WRITE
  8209*       DATASET   ('ELCRTO')
  8210*       FROM      (ORIGINAL-CERTIFICATE)
  8211*       RIDFLD    (OC-CONTROL-PRIMARY)
  8212*       RESP      (WS-RESPONSE)
  8213*    END-EXEC.
  8214     MOVE LENGTH OF
  8215      ORIGINAL-CERTIFICATE
  8216       TO DFHEIV11
  8217     MOVE 'ELCRTO' TO DFHEIV1
  8218*    MOVE '&$ L                  ''  N#00007523' TO DFHEIV0
  8219     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8220     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 144
* EL6316.cbl
  8221     MOVE X'204E233030303037353233' TO DFHEIV0(25:11)
  8222     CALL 'kxdfhei1' USING DFHEIV0,
  8223           DFHEIV1,
  8224           ORIGINAL-CERTIFICATE,
  8225           DFHEIV11,
  8226           OC-CONTROL-PRIMARY,
  8227           DFHEIV99,
  8228           DFHEIV99
  8229     MOVE EIBRESP  TO WS-RESPONSE
  8230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8231
  8232
  8233     IF NOT RESP-NORMAL
  8234         DISPLAY 'ERROR IN 0780 WRITING ELCRTO ' WS-RESPONSE
  8235         MOVE ER-9999      TO EMI-ERROR
  8236         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8237         GO TO 8200-SEND-DATAONLY
  8238     END-IF
  8239
  8240     .
  8241 0780-EXIT.
  8242     EXIT.
  8243
  8244
  8245 0783-LOAD-CERT-TO-CRTO-REC.
  8246
  8247      display 'made it to 0783'
  8248
  8249     MOVE '6316'                 TO OC-LAST-MAINT-BY
  8250     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  8251     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  8252     MOVE 'I'                    TO OC-RECORD-TYPE
  8253     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
  8254     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  8255     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  8256     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  8257     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  8258     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  8259     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  8260     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  8261     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
  8262     IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  8263         MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
  8264         MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
  8265         MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
  8266         MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
  8267         MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
  8268         MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
  8269         MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
  8270         MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  8271         MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-CANCEL-AMT
  8272                                      OC-LF-ITD-CANCEL-AMT
  8273     END-IF
  8274     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
  8275     IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  8276         MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  8277         MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  8278         MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 145
* EL6316.cbl
  8279         MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  8280         MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  8281         MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  8282         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  8283         MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-CANCEL-AMT
  8284                                      OC-AH-ITD-CANCEL-AMT
  8285     END-IF
  8286     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  8287     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
  8288     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
  8289
  8290     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  8291
  8292     MOVE ELCRTO-KEY (1:33) TO WS-ERMAIL-KEY
  8293
  8294
  8295* EXEC CICS READ
  8296*         DATASET   (WS-ERMAIL-FILE-ID)
  8297*         RIDFLD    (WS-ERMAIL-KEY)
  8298*         SET       (ADDRESS OF MAILING-DATA)
  8299*         RESP      (WS-RESPONSE)
  8300*    END-EXEC
  8301*    MOVE '&"S        E          (  N#00007591' TO DFHEIV0
  8302     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8303     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8304     MOVE X'204E233030303037353931' TO DFHEIV0(25:11)
  8305     CALL 'kxdfhei1' USING DFHEIV0,
  8306           WS-ERMAIL-FILE-ID,
  8307           DFHEIV20,
  8308           DFHEIV99,
  8309           WS-ERMAIL-KEY,
  8310           DFHEIV99,
  8311           DFHEIV99,
  8312           DFHEIV99
  8313     SET ADDRESS OF MAILING-DATA TO
  8314         DFHEIV20
  8315     MOVE EIBRESP  TO WS-RESPONSE
  8316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8317
  8318     IF RESP-NORMAL
  8319         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
  8320     END-IF.
  8321
  8322     MOVE ELCRTO-KEY (1:33)     TO WS-ELCRTT-PRIMARY
  8323     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  8324
  8325
  8326* EXEC CICS READ
  8327*         DATASET  (WS-ELCRTT-FILE-ID)
  8328*         RIDFLD   (WS-ELCRTT-KEY)
  8329*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  8330*         RESP     (WS-RESPONSE)
  8331*    END-EXEC
  8332*    MOVE '&"S        E          (  N#00007605' TO DFHEIV0
  8333     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8335     MOVE X'204E233030303037363035' TO DFHEIV0(25:11)
  8336     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 146
* EL6316.cbl
  8337           WS-ELCRTT-FILE-ID,
  8338           DFHEIV20,
  8339           DFHEIV99,
  8340           WS-ELCRTT-KEY,
  8341           DFHEIV99,
  8342           DFHEIV99,
  8343           DFHEIV99
  8344     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  8345         DFHEIV20
  8346     MOVE EIBRESP  TO WS-RESPONSE
  8347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8348
  8349     IF RESP-NORMAL
  8350         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  8351         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  8352     END-IF.
  8353
  8354
  8355     .
  8356 0783-EXIT.
  8357     EXIT.
  8358
  8359 0785-CHG-CRTO-REC.
  8360
  8361     display 'made it to 0785'
  8362
  8363     MOVE '6316'                 TO OC-LAST-MAINT-BY
  8364     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  8365     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  8366
  8367     MOVE OLFDTO                 TO WS-TMPDATE
  8368
  8369* EXEC CICS BIF DEEDIT
  8370*         FIELD   (WS-TMPDATE)
  8371*         LENGTH  (8)
  8372*    END-EXEC
  8373     MOVE 8
  8374       TO DFHEIV11
  8375*    MOVE '@"L                   #   #00007631' TO DFHEIV0
  8376     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8377     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8378     MOVE X'2020233030303037363331' TO DFHEIV0(25:11)
  8379     CALL 'kxdfhei1' USING DFHEIV0,
  8380           WS-TMPDATE,
  8381           DFHEIV11
  8382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8383     MOVE WS-TMPDT               TO DC-GREG-DATE-1-MDY
  8384     MOVE '4'                    TO DC-OPTION-CODE
  8385     PERFORM 9700-DATE-LINK
  8386     IF NOT DATE-CONVERSION-ERROR
  8387        MOVE DC-BIN-DATE-1       TO OC-LF-CANCEL-DT
  8388     END-IF
  8389
  8390     display 'lf amt ' olfamto
  8391     MOVE OLFAMTO                TO WS-AMTX
  8392
  8393* EXEC CICS BIF DEEDIT
  8394*         FIELD   (WS-AMTX)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 147
* EL6316.cbl
  8395*         LENGTH  (10)
  8396*    END-EXEC
  8397     MOVE 10
  8398       TO DFHEIV11
  8399*    MOVE '@"L                   #   #00007644' TO DFHEIV0
  8400     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8401     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8402     MOVE X'2020233030303037363434' TO DFHEIV0(25:11)
  8403     CALL 'kxdfhei1' USING DFHEIV0,
  8404           WS-AMTX,
  8405           DFHEIV11
  8406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8407     MOVE WS-AMTV2               TO OC-LF-CANCEL-AMT
  8408
  8409     MOVE OAHDTO                 TO WS-TMPDATE
  8410
  8411* EXEC CICS BIF DEEDIT
  8412*         FIELD   (WS-TMPDATE)
  8413*         LENGTH  (8)
  8414*    END-EXEC
  8415     MOVE 8
  8416       TO DFHEIV11
  8417*    MOVE '@"L                   #   #00007651' TO DFHEIV0
  8418     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8419     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8420     MOVE X'2020233030303037363531' TO DFHEIV0(25:11)
  8421     CALL 'kxdfhei1' USING DFHEIV0,
  8422           WS-TMPDATE,
  8423           DFHEIV11
  8424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8425     MOVE WS-TMPDT               TO DC-GREG-DATE-1-MDY
  8426     MOVE '4'                    TO DC-OPTION-CODE
  8427     PERFORM 9700-DATE-LINK
  8428     IF NOT DATE-CONVERSION-ERROR
  8429        MOVE DC-BIN-DATE-1       TO OC-AH-CANCEL-DT
  8430     END-IF
  8431
  8432     display 'ah amt ' oahamto
  8433     MOVE OAHAMTO                TO WS-AMTX
  8434
  8435* EXEC CICS BIF DEEDIT
  8436*         FIELD   (WS-AMTX)
  8437*         LENGTH  (10)
  8438*    END-EXEC
  8439     MOVE 10
  8440       TO DFHEIV11
  8441*    MOVE '@"L                   #   #00007664' TO DFHEIV0
  8442     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8443     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8444     MOVE X'2020233030303037363634' TO DFHEIV0(25:11)
  8445     CALL 'kxdfhei1' USING DFHEIV0,
  8446           WS-AMTX,
  8447           DFHEIV11
  8448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8449     MOVE WS-AMTV2               TO OC-AH-CANCEL-AMT
  8450
  8451
  8452* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 148
* EL6316.cbl
  8453*       DATASET   ('ELCRTO')
  8454*       FROM      (ORIGINAL-CERTIFICATE)
  8455*       RESP      (WS-RESPONSE)
  8456*    END-EXEC
  8457     MOVE LENGTH OF
  8458      ORIGINAL-CERTIFICATE
  8459       TO DFHEIV11
  8460     MOVE 'ELCRTO' TO DFHEIV1
  8461*    MOVE '&& L                  %  N#00007670' TO DFHEIV0
  8462     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8463     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8464     MOVE X'204E233030303037363730' TO DFHEIV0(25:11)
  8465     CALL 'kxdfhei1' USING DFHEIV0,
  8466           DFHEIV1,
  8467           ORIGINAL-CERTIFICATE,
  8468           DFHEIV11,
  8469           DFHEIV99
  8470     MOVE EIBRESP  TO WS-RESPONSE
  8471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8472
  8473     IF NOT RESP-NORMAL
  8474         DISPLAY 'ERROR IN 0385 REWRITING ELCRTO ' WS-RESPONSE
  8475         MOVE ER-9999      TO EMI-ERROR
  8476         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8477         GO TO 8200-SEND-DATAONLY
  8478     END-IF
  8479
  8480     PERFORM 0361-MOVE-CRTO-TO-SCREEN THRU 0361-EXIT
  8481
  8482     .
  8483 0785-EXIT.
  8484     EXIT.
  8485
  8486 1000-FINALIZE.
  8487     PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  8488     IF NOT EMI-NO-ERRORS
  8489      AND EIBAID = DFHPF4
  8490        GO TO 8200-SEND-DATAONLY
  8491     END-IF
  8492     display ' made it to 1000 '
  8493     set P to address of KIXSYS
  8494     CALL "getenv" using by value P returning var-ptr
  8495     if var-ptr = null then
  8496        display ' kixsys not set '
  8497     else
  8498        set address of var to var-ptr
  8499        move 0 to env-var-len
  8500        inspect var tallying env-var-len
  8501          for characters before X'00'
  8502*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  8503        unstring var (1:env-var-len) delimited by '/'
  8504           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8505              WS-KIX-SYS
  8506        end-unstring
  8507*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  8508*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8509     end-if
  8510     set P to address of KIXHOST
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 149
* EL6316.cbl
  8511     CALL "getenv" using by value P returning var-ptr
  8512     if var-ptr = null then
  8513        display ' kixhost not set '
  8514     else
  8515        set address of var to var-ptr
  8516        move 0 to env-var-len
  8517        inspect var tallying env-var-len
  8518          for characters before X'00'
  8519*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  8520        MOVE var(1:env-var-len)  to ws-kixhost
  8521        DISPLAY ' WS KIX HOST ' WS-KIXhost
  8522     end-if
  8523     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  8524     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  8525     IF RESP-NORMAL
  8526        AND (PI-ELCRTO-KEY (1:33) =
  8527              OC-CONTROL-PRIMARY (1:33))
  8528           DISPLAY ' RESP NORMAL AND = '
  8529           MOVE OC-ORIG-REC         TO NEW-ORIG-REC
  8530           PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  8531           PERFORM 1100-CALL-NS-BUS-LOGIC
  8532                                    THRU 1100-EXIT
  8533           IF BL-OK
  8534              CONTINUE
  8535           ELSE
  8536              MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  8537              MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  8538              MOVE -1               TO CARRL
  8539           END-IF
  8540     ELSE
  8541        MOVE ER-3829             TO EMI-ERROR
  8542        PERFORM 9900-ERROR-FORMAT
  8543                                 THRU 9900-EXIT
  8544        MOVE -1                  TO CARRL
  8545        GO TO 8100-SEND-INITIAL-MAP
  8546     END-IF
  8547     PERFORM 0390-BUILD-FROM-ERENDT THRU 0390-EXIT
  8548     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  8549                                 TO SYSO
  8550     MOVE WS-KIXHOST             TO HOSTO
  8551     MOVE PI-COMPANY-ID          TO COMPANYO
  8552     MOVE PI-PROCESSOR-ID        TO PROCIDO
  8553     IF PI-FROM-CERT = 'Y'
  8554         MOVE '2'                TO DATASORO
  8555     ELSE
  8556         MOVE '4'                TO DATASORO
  8557     END-IF
  8558     MOVE BL-BATCH-NO            TO BATCHNOO
  8559     MOVE BL-BATCH-SEQ           TO BSEQNOO
  8560     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  8561*    MOVE -1                     TO PRTSWL
  8562*    MOVE AL-UANON               TO PRTSWA
  8563     IF EIBAID = DFHPF4
  8564        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  8565        MOVE ER-0280             TO EMI-ERROR
  8566        PERFORM 9900-ERROR-FORMAT
  8567                                 THRU 9900-EXIT
  8568        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 150
* EL6316.cbl
  8569        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  8570        MOVE 'Y'                 TO PI-FINALIZED-IND
  8571        GO TO 9400-CLEAR
  8572     ELSE
  8573        MOVE ER-1818             TO EMI-ERROR
  8574        PERFORM 9900-ERROR-FORMAT
  8575                                 THRU 9900-EXIT
  8576     END-IF
  8577     GO TO 8100-SEND-INITIAL-MAP
  8578     .
  8579 1000-EXIT.
  8580     EXIT.
  8581 1100-CALL-NS-BUS-LOGIC.
  8582     DISPLAY ' MADE IT TO 1100 ' w-arch-number
  8583     MOVE SPACES                 TO BL-INPUT
  8584     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  8585     IF PI-FROM-CERT = 'Y'
  8586         MOVE '2'                TO BL-DATA-SRCE
  8587         MOVE SPACES             TO BL-BATCH-NO
  8588         MOVE ZEROS              TO BL-BATCH-SEQ
  8589     ELSE
  8590         MOVE '4'                TO BL-DATA-SRCE
  8591         MOVE PB-ENTRY-BATCH     TO BL-BATCH-NO
  8592         MOVE PB-BATCH-SEQ-NO    TO BL-BATCH-SEQ
  8593     END-IF
  8594     MOVE PI-CARRIER             TO BL-CARRIER
  8595     MOVE PI-GROUPING            TO BL-GROUP
  8596     MOVE PI-STATE               TO BL-STATE
  8597     MOVE PI-ACCOUNT             TO BL-ACCOUNT
  8598     IF PI-CERT-EFF-DT NOT = LOW-VALUES
  8599        MOVE PI-CERT-EFF-DT      TO DC-BIN-DATE-1
  8600        MOVE ' '                 TO DC-OPTION-CODE
  8601        PERFORM 9700-date-link
  8602        IF NO-CONVERSION-ERROR
  8603           MOVE DC-GREG-DATE-B-EDIT
  8604                                 TO BL-EFF-DT
  8605        END-IF
  8606     END-IF
  8607     MOVE PI-CERT-NO             TO BL-CERT-NO
  8608     MOVE SPACES                 TO BL-RESP-NO
  8609     MOVE LTRIDI                 TO BL-LETTER-ID
  8610     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  8611     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  8612*    MOVE 'ALWA'                 TO BL-PROC-ID
  8613     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  8614     MOVE PI-ENCCODE             TO BL-ENC-CD
  8615     IF EIBAID = DFHPF4
  8616        MOVE 'B'                 TO BL-WRITE-ERARCH
  8617     ELSE
  8618        MOVE 'T'                 TO BL-WRITE-ERARCH
  8619     END-IF
  8620     MOVE SPACES                 TO BL-CERT-FORM-ID
  8621     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  8622     MOVE 'CAN ENDT'             TO BL-SOURCE-SCREEN
  8623     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  8624        IF REACD-IN (S1) NOT = LOW-VALUES
  8625           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  8626        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 151
* EL6316.cbl
  8627     END-PERFORM
  8628    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  8629     DISPLAY ' BL INPUT ' BL-INPUT
  8630*****************************************
  8631* Invoke the LETTER business logic
  8632*****************************************
  8633     MOVE FUNCTION LENGTH(SRCH-COMMAREA) TO WS-COMM-LENGTH
  8634     display ' srch commarea ' srch-commarea
  8635     display ' length ' ws-comm-length
  8636
  8637* exec cics link
  8638*       program('NSRASBL')
  8639*       commarea(srch-commarea)
  8640*       LENGTH  (WS-COMM-LENGTH)
  8641*    end-exec.
  8642     MOVE 'NSRASBL' TO DFHEIV1
  8643*    MOVE '."C                   (   #00007839' TO DFHEIV0
  8644     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8645     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8646     MOVE X'2020233030303037383339' TO DFHEIV0(25:11)
  8647     CALL 'kxdfhei1' USING DFHEIV0,
  8648           DFHEIV1,
  8649           srch-commarea,
  8650           WS-COMM-LENGTH,
  8651           DFHEIV99,
  8652           DFHEIV99,
  8653           DFHEIV99,
  8654           DFHEIV99
  8655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8656
  8657     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  8658        BL-MESSAGE
  8659     .
  8660 1100-EXIT.
  8661     EXIT.
  8662 1500-GET-ARCH-NO.
  8663     display ' made it to 1500 '
  8664     MOVE SPACES                 TO ELCNTL-KEY
  8665     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  8666     MOVE '1'                    TO CNTL-REC-TYPE
  8667     MOVE ZEROS                  TO CNTL-SEQ
  8668
  8669* EXEC CICS READ
  8670*         DATASET    (WS-ELCNTL-FILE-ID)
  8671*         SET        (ADDRESS OF CONTROL-FILE)
  8672*         RIDFLD     (ELCNTL-KEY)
  8673*         UPDATE
  8674*         RESP       (WS-RESPONSE)
  8675*    END-EXEC
  8676*    MOVE '&"S        EU         (  N#00007855' TO DFHEIV0
  8677     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8678     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8679     MOVE X'204E233030303037383535' TO DFHEIV0(25:11)
  8680     CALL 'kxdfhei1' USING DFHEIV0,
  8681           WS-ELCNTL-FILE-ID,
  8682           DFHEIV20,
  8683           DFHEIV99,
  8684           ELCNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 152
* EL6316.cbl
  8685           DFHEIV99,
  8686           DFHEIV99,
  8687           DFHEIV99
  8688     SET ADDRESS OF CONTROL-FILE TO
  8689         DFHEIV20
  8690     MOVE EIBRESP  TO WS-RESPONSE
  8691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8692     IF RESP-NORMAL
  8693        display ' good read elcntl '
  8694        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  8695           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  8696        END-IF
  8697        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  8698        MOVE CF-CREDIT-LAST-ARCH-NUM
  8699                                 TO W-ARCH-NUMBER
  8700        display ' new arch number ' w-arch-number
  8701
  8702* EXEC CICS REWRITE
  8703*          FROM      (CONTROL-FILE)
  8704*          DATASET   (WS-ELCNTL-FILE-ID)
  8705*       END-EXEC
  8706     MOVE LENGTH OF
  8707      CONTROL-FILE
  8708       TO DFHEIV11
  8709*    MOVE '&& L                  %   #00007871' TO DFHEIV0
  8710     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8711     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8712     MOVE X'2020233030303037383731' TO DFHEIV0(25:11)
  8713     CALL 'kxdfhei1' USING DFHEIV0,
  8714           WS-ELCNTL-FILE-ID,
  8715           CONTROL-FILE,
  8716           DFHEIV11,
  8717           DFHEIV99
  8718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8719     END-IF
  8720     .
  8721 1500-EXIT.
  8722     EXIT.
  8723
  8724
  8725 1700-WRITE-CERT-NOTE      SECTION.
  8726
  8727     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  8728     MOVE ZERO           TO ERCNOT-SEQ.
  8729     SET TB-INDX         DOWN BY 1.
  8730     SET TB-INDX1        TO TB-INDX.
  8731
  8732****DELETE CURRENT CERT NOTES
  8733 1700-LOOP.
  8734
  8735* EXEC CICS READ
  8736*        DATASET (WS-ERCNOT-FILE-ID)
  8737*        RIDFLD  (ERCNOT-KEY)
  8738*        SET     (ADDRESS OF CERT-NOTE-FILE)
  8739*        RESP    (WS-RESPONSE)
  8740*        GTEQ
  8741*    END-EXEC.
  8742*    MOVE '&"S        G          (  N#00007890' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 153
* EL6316.cbl
  8743     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8744     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8745     MOVE X'204E233030303037383930' TO DFHEIV0(25:11)
  8746     CALL 'kxdfhei1' USING DFHEIV0,
  8747           WS-ERCNOT-FILE-ID,
  8748           DFHEIV20,
  8749           DFHEIV99,
  8750           ERCNOT-KEY,
  8751           DFHEIV99,
  8752           DFHEIV99,
  8753           DFHEIV99
  8754     SET ADDRESS OF CERT-NOTE-FILE TO
  8755         DFHEIV20
  8756     MOVE EIBRESP  TO WS-RESPONSE
  8757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8758
  8759
  8760     IF NOT RESP-NORMAL
  8761        GO TO 1700-ENDDEL
  8762     END-IF
  8763
  8764     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  8765
  8766     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  8767         GO TO 1700-ENDDEL
  8768     END-IF.
  8769
  8770
  8771* EXEC CICS DELETE
  8772*        DATASET (WS-ERCNOT-FILE-ID)
  8773*        RIDFLD  (ERCNOT-KEY)
  8774*    END-EXEC.
  8775*    MOVE '&(  R                 &   #00007908' TO DFHEIV0
  8776     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8777     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8778     MOVE X'2020233030303037393038' TO DFHEIV0(25:11)
  8779     CALL 'kxdfhei1' USING DFHEIV0,
  8780           WS-ERCNOT-FILE-ID,
  8781           ERCNOT-KEY,
  8782           DFHEIV99,
  8783           DFHEIV99,
  8784           DFHEIV99
  8785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8786
  8787
  8788     GO TO 1700-LOOP.
  8789
  8790 1700-ENDDEL.
  8791
  8792
  8793* EXEC CICS GETMAIN
  8794*         LENGTH(ERCNOT-LENGTH)
  8795*         SET(ADDRESS OF CERT-NOTE-FILE)
  8796*         INITIMG(GETMAIN-SPACE)
  8797*    END-EXEC.
  8798*    MOVE ',"IL                  $   #00007917' TO DFHEIV0
  8799     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8800     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 154
* EL6316.cbl
  8801     MOVE X'2020233030303037393137' TO DFHEIV0(25:11)
  8802     CALL 'kxdfhei1' USING DFHEIV0,
  8803           DFHEIV20,
  8804           ERCNOT-LENGTH,
  8805           GETMAIN-SPACE
  8806     SET ADDRESS OF CERT-NOTE-FILE TO
  8807         DFHEIV20
  8808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8809
  8810
  8811     SET TB-INDX TO 1.
  8812     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  8813     MOVE +0             TO ERCNOT-SEQ
  8814
  8815     PERFORM VARYING TB-INDX FROM 1 BY 1
  8816             UNTIL TB-INDX > TB-INDX1
  8817        MOVE SPACES                 TO  CERT-NOTE-FILE
  8818        ADD 1                       TO  ERCNOT-SEQ
  8819        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  8820        MOVE  'CZ'                  TO  CZ-RECORD-ID
  8821        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  8822        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  8823                                    TO  CZ-LAST-MAINT-USER
  8824        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  8825                                    TO  CZ-LAST-MAINT-HHMMSS
  8826        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  8827                                    TO  CZ-LAST-MAINT-DT
  8828
  8829
  8830* EXEC CICS WRITE
  8831*            DATASET(WS-ERCNOT-FILE-ID)
  8832*            FROM(CERT-NOTE-FILE)
  8833*            RIDFLD(ERCNOT-KEY)
  8834*       END-EXEC
  8835     MOVE LENGTH OF
  8836      CERT-NOTE-FILE
  8837       TO DFHEIV11
  8838*    MOVE '&$ L                  ''   #00007941' TO DFHEIV0
  8839     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8840     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8841     MOVE X'2020233030303037393431' TO DFHEIV0(25:11)
  8842     CALL 'kxdfhei1' USING DFHEIV0,
  8843           WS-ERCNOT-FILE-ID,
  8844           CERT-NOTE-FILE,
  8845           DFHEIV11,
  8846           ERCNOT-KEY,
  8847           DFHEIV99,
  8848           DFHEIV99
  8849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8850     END-PERFORM
  8851
  8852     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8853     IF RESP-NORMAL
  8854        EVALUATE CM-NOTE-SW
  8855           WHEN '1'
  8856           WHEN '3'
  8857           WHEN '5'
  8858           WHEN '7'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 155
* EL6316.cbl
  8859              SET NO-CERT-RW     TO TRUE
  8860           WHEN ' '
  8861              MOVE '1'           TO CM-NOTE-SW
  8862           WHEN '2'
  8863              MOVE '3'           TO CM-NOTE-SW
  8864           WHEN '4'
  8865              MOVE '5'           TO CM-NOTE-SW
  8866           WHEN '6'
  8867              MOVE '7'           TO CM-NOTE-SW
  8868        END-EVALUATE
  8869     END-IF
  8870     IF NOT NO-CERT-RW
  8871        PERFORM 1810-REWRITE-ELCERT
  8872                                 THRU 1810-EXIT
  8873     ELSE
  8874
  8875* EXEC CICS UNLOCK
  8876*          DATASET    (WS-ELCERT-FILE-ID)
  8877*       END-EXEC
  8878*    MOVE '&*                    #   #00007970' TO DFHEIV0
  8879     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8880     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8881     MOVE X'2020233030303037393730' TO DFHEIV0(25:11)
  8882     CALL 'kxdfhei1' USING DFHEIV0,
  8883           WS-ELCERT-FILE-ID,
  8884           DFHEIV99
  8885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8886     END-IF
  8887
  8888     .
  8889 1799-EXIT.
  8890     EXIT.
  8891
  8892 1800-READ-ELCERT-UPDATE.
  8893
  8894     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  8895     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  8896     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  8897     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  8898     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  8899     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  8900     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  8901     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  8902
  8903
  8904* EXEC CICS READ
  8905*        UPDATE
  8906*        DATASET  (WS-ELCERT-FILE-ID)
  8907*        RIDFLD   (WS-ELCERT-KEY)
  8908*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8909*        RESP     (WS-RESPONSE)
  8910*    END-EXEC
  8911*    MOVE '&"S        EU         (  N#00007990' TO DFHEIV0
  8912     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8913     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8914     MOVE X'204E233030303037393930' TO DFHEIV0(25:11)
  8915     CALL 'kxdfhei1' USING DFHEIV0,
  8916           WS-ELCERT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 156
* EL6316.cbl
  8917           DFHEIV20,
  8918           DFHEIV99,
  8919           WS-ELCERT-KEY,
  8920           DFHEIV99,
  8921           DFHEIV99,
  8922           DFHEIV99
  8923     SET ADDRESS OF CERTIFICATE-MASTER TO
  8924         DFHEIV20
  8925     MOVE EIBRESP  TO WS-RESPONSE
  8926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8927
  8928     .
  8929 1800-EXIT.
  8930     EXIT.
  8931
  8932 1810-REWRITE-ELCERT.
  8933
  8934
  8935* EXEC CICS REWRITE
  8936*        FROM     (CERTIFICATE-MASTER)
  8937*        DATASET  (WS-ELCERT-FILE-ID)
  8938*        RESP     (WS-RESPONSE)
  8939*    END-EXEC.
  8940     MOVE LENGTH OF
  8941      CERTIFICATE-MASTER
  8942       TO DFHEIV11
  8943*    MOVE '&& L                  %  N#00008004' TO DFHEIV0
  8944     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8945     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8946     MOVE X'204E233030303038303034' TO DFHEIV0(25:11)
  8947     CALL 'kxdfhei1' USING DFHEIV0,
  8948           WS-ELCERT-FILE-ID,
  8949           CERTIFICATE-MASTER,
  8950           DFHEIV11,
  8951           DFHEIV99
  8952     MOVE EIBRESP  TO WS-RESPONSE
  8953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8954
  8955
  8956     .
  8957 1810-EXIT.
  8958     EXIT.
  8959
  8960 8100-SEND-INITIAL-MAP.
  8961     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8962     MOVE '5'                    TO DC-OPTION-CODE.
  8963     PERFORM 9700-DATE-LINK.
  8964     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8965     MOVE EIBTIME                TO TIME-IN.
  8966     MOVE TIME-OUT               TO TIMEO.
  8967     MOVE -1                     TO LTRIDL
  8968*    MOVE AL-UANON               TO PRTSWA
  8969     IF PI-PROCESSOR-IS-CSR-SUPER
  8970      AND PI-ENDORSE-RECORD NOT EQUAL 'Y'
  8971        perform varying s1 from +1 by +1 until
  8972           s1 > +12
  8973           MOVE AL-UANON            TO reacda (s1)
  8974        end-perform
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 157
* EL6316.cbl
  8975     END-IF
  8976
  8977     IF PI-FROM-CERT = 'Y' AND
  8978        PI-PROCESSOR-IS-CSR-SUPER AND
  8979        PI-ENDORSE-RECORD NOT EQUAL 'Y'
  8980            MOVE AL-UNNON        TO OLFDTA
  8981                                    OAHDTA
  8982                                    OLFAMTA
  8983                                    OAHAMTA
  8984     END-IF
  8985
  8986     IF PI-FROM-CERT = 'Y' AND
  8987        NOT PI-PROCESSOR-IS-CSR-SUPER
  8988            MOVE AL-SANOF        TO LTRIDA
  8989                                    ENCCODEA
  8990                                    CRTNT1A
  8991                                    CRTNT2A
  8992                                    BILNT1A
  8993            MOVE AL-SADOF        TO PF3A
  8994                                    PF4A
  8995     END-IF
  8996
  8997     IF PI-ENDORSE-RECORD = 'Y'
  8998            MOVE AL-SANOF        TO LTRIDA
  8999                                    ENCCODEA
  9000                                    CRTNT1A
  9001                                    CRTNT2A
  9002                                    BILNT1A
  9003            MOVE AL-SADOF        TO PF3A
  9004                                    PF4A
  9005     END-IF
  9006     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  9007
  9008* EXEC CICS SEND
  9009*        MAP      (MAP-NAME)
  9010*        MAPSET   (MAPSET-NAME)
  9011*        FROM     (EL631IO)
  9012*        ERASE
  9013*        CURSOR
  9014*    END-EXEC.
  9015     MOVE LENGTH OF
  9016      EL631IO
  9017       TO DFHEIV12
  9018     MOVE -1
  9019       TO DFHEIV11
  9020*    MOVE '8$     CT  E    H L F ,   #00008061' TO DFHEIV0
  9021     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9022     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9023     MOVE X'2020233030303038303631' TO DFHEIV0(25:11)
  9024     CALL 'kxdfhei1' USING DFHEIV0,
  9025           MAP-NAME,
  9026           EL631IO,
  9027           DFHEIV12,
  9028           MAPSET-NAME,
  9029           DFHEIV99,
  9030           DFHEIV99,
  9031           DFHEIV99,
  9032           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 158
* EL6316.cbl
  9033           DFHEIV99,
  9034           DFHEIV99,
  9035           DFHEIV99
  9036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9037
  9038     GO TO 9100-RETURN-TRAN.
  9039 8200-SEND-DATAONLY.
  9040     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9041     MOVE '5'                    TO DC-OPTION-CODE.
  9042     PERFORM 9700-DATE-LINK.
  9043     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  9044     MOVE EIBTIME                TO TIME-IN.
  9045     MOVE TIME-OUT               TO TIMEO.
  9046     MOVE -1                     TO PFENTRL
  9047     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
  9048
  9049* EXEC CICS SEND
  9050*        MAP      (MAP-NAME)
  9051*        MAPSET   (MAPSET-NAME)
  9052*        FROM     (EL631IO)
  9053*        DATAONLY
  9054*        ERASEAUP
  9055*        CURSOR
  9056*    END-EXEC.
  9057     MOVE LENGTH OF
  9058      EL631IO
  9059       TO DFHEIV12
  9060     MOVE -1
  9061       TO DFHEIV11
  9062*    MOVE '8$D    CT  A    H L F ,   #00008078' TO DFHEIV0
  9063     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  9064     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9065     MOVE X'2020233030303038303738' TO DFHEIV0(25:11)
  9066     CALL 'kxdfhei1' USING DFHEIV0,
  9067           MAP-NAME,
  9068           EL631IO,
  9069           DFHEIV12,
  9070           MAPSET-NAME,
  9071           DFHEIV99,
  9072           DFHEIV99,
  9073           DFHEIV99,
  9074           DFHEIV11,
  9075           DFHEIV99,
  9076           DFHEIV99,
  9077           DFHEIV99
  9078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9079
  9080     GO TO 9100-RETURN-TRAN.
  9081 8300-SEND-TEXT.
  9082
  9083* EXEC CICS SEND TEXT
  9084*        FROM     (LOGOFF-TEXT)
  9085*        LENGTH   (LOGOFF-LENGTH)
  9086*        ERASE
  9087*        FREEKB
  9088*    END-EXEC.
  9089*    MOVE '8&      T  E F  H   F -   #00008088' TO DFHEIV0
  9090     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 159
* EL6316.cbl
  9091     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9092     MOVE X'2020233030303038303838' TO DFHEIV0(25:11)
  9093     CALL 'kxdfhei1' USING DFHEIV0,
  9094           LOGOFF-TEXT,
  9095           LOGOFF-LENGTH,
  9096           DFHEIV99,
  9097           DFHEIV99,
  9098           DFHEIV99,
  9099           DFHEIV99,
  9100           DFHEIV99,
  9101           DFHEIV99,
  9102           DFHEIV99,
  9103           DFHEIV99,
  9104           DFHEIV99,
  9105           DFHEIV99
  9106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9107
  9108
  9109* EXEC CICS RETURN
  9110*    END-EXEC.
  9111*    MOVE '.(                    ''   #00008094' TO DFHEIV0
  9112     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9113     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9114     MOVE X'2020233030303038303934' TO DFHEIV0(25:11)
  9115     CALL 'kxdfhei1' USING DFHEIV0,
  9116           DFHEIV99,
  9117           DFHEIV99,
  9118           DFHEIV99,
  9119           DFHEIV99,
  9120           DFHEIV99,
  9121           DFHEIV99
  9122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9123
  9124 8800-UNAUTHORIZED-ACCESS.
  9125     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  9126     GO TO 8300-SEND-TEXT.
  9127 8810-PF23.
  9128     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  9129     MOVE XCTL-005               TO PGM-NAME.
  9130     GO TO 9300-XCTL.
  9131 9000-RETURN-CICS.
  9132
  9133* EXEC CICS RETURN
  9134*    END-EXEC.
  9135*    MOVE '.(                    ''   #00008104' TO DFHEIV0
  9136     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9137     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9138     MOVE X'2020233030303038313034' TO DFHEIV0(25:11)
  9139     CALL 'kxdfhei1' USING DFHEIV0,
  9140           DFHEIV99,
  9141           DFHEIV99,
  9142           DFHEIV99,
  9143           DFHEIV99,
  9144           DFHEIV99,
  9145           DFHEIV99
  9146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9147
  9148 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 160
* EL6316.cbl
  9149     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  9150     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  9151
  9152* EXEC CICS RETURN
  9153*        TRANSID    (TRANS-ID)
  9154*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  9155*        LENGTH     (1300)
  9156*    END-EXEC.
  9157     MOVE 1300
  9158       TO DFHEIV11
  9159*    MOVE '.(CT                  ''   #00008109' TO DFHEIV0
  9160     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9161     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9162     MOVE X'2020233030303038313039' TO DFHEIV0(25:11)
  9163     CALL 'kxdfhei1' USING DFHEIV0,
  9164           TRANS-ID,
  9165           PROGRAM-INTERFACE-BLOCK,
  9166           DFHEIV11,
  9167           DFHEIV99,
  9168           DFHEIV99,
  9169           DFHEIV99
  9170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9171
  9172 9200-RETURN-MAIN-MENU.
  9173     MOVE XCTL-626               TO PGM-NAME.
  9174     GO TO 9300-XCTL.
  9175 9300-XCTL.
  9176
  9177* EXEC CICS XCTL
  9178*        PROGRAM    (PGM-NAME)
  9179*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  9180*        LENGTH     (1300)
  9181*    END-EXEC.
  9182     MOVE 1300
  9183       TO DFHEIV11
  9184*    MOVE '.$C                   %   #00008118' TO DFHEIV0
  9185     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9186     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9187     MOVE X'2020233030303038313138' TO DFHEIV0(25:11)
  9188     CALL 'kxdfhei1' USING DFHEIV0,
  9189           PGM-NAME,
  9190           PROGRAM-INTERFACE-BLOCK,
  9191           DFHEIV11,
  9192           DFHEIV99
  9193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9194
  9195 9400-CLEAR.
  9196     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  9197
  9198* EXEC CICS XCTL
  9199*        PROGRAM    (PGM-NAME)
  9200*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  9201*        LENGTH     (1300)
  9202*    END-EXEC.
  9203     MOVE 1300
  9204       TO DFHEIV11
  9205*    MOVE '.$C                   %   #00008125' TO DFHEIV0
  9206     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 161
* EL6316.cbl
  9207     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9208     MOVE X'2020233030303038313235' TO DFHEIV0(25:11)
  9209     CALL 'kxdfhei1' USING DFHEIV0,
  9210           PGM-NAME,
  9211           PROGRAM-INTERFACE-BLOCK,
  9212           DFHEIV11,
  9213           DFHEIV99
  9214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9215
  9216 9500-PF12.
  9217     MOVE XCTL-010               TO PGM-NAME.
  9218     GO TO 9300-XCTL.
  9219 9600-PGMID-ERROR.
  9220
  9221* EXEC CICS HANDLE CONDITION
  9222*        PGMIDERR    (8300-SEND-TEXT)
  9223*    END-EXEC.
  9224*    MOVE '"$L                   ! " #00008134' TO DFHEIV0
  9225     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9227     MOVE X'2220233030303038313334' TO DFHEIV0(25:11)
  9228     CALL 'kxdfhei1' USING DFHEIV0
  9229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9230
  9231     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  9232     MOVE ' '                    TO PI-ENTRY-CD-1.
  9233     MOVE XCTL-005               TO PGM-NAME.
  9234     MOVE PGM-NAME               TO LOGOFF-PGM.
  9235     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  9236     GO TO 9300-XCTL.
  9237 9700-DATE-LINK.
  9238     MOVE LINK-ELDATCV           TO PGM-NAME.
  9239
  9240* EXEC CICS LINK
  9241*        PROGRAM    (PGM-NAME)
  9242*        COMMAREA   (DATE-CONVERSION-DATA)
  9243*        LENGTH     (DC-COMM-LENGTH)
  9244*    END-EXEC.
  9245*    MOVE '."C                   (   #00008145' TO DFHEIV0
  9246     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9247     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9248     MOVE X'2020233030303038313435' TO DFHEIV0(25:11)
  9249     CALL 'kxdfhei1' USING DFHEIV0,
  9250           PGM-NAME,
  9251           DATE-CONVERSION-DATA,
  9252           DC-COMM-LENGTH,
  9253           DFHEIV99,
  9254           DFHEIV99,
  9255           DFHEIV99,
  9256           DFHEIV99
  9257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9258
  9259 9900-ERROR-FORMAT.
  9260     IF NOT EMI-ERRORS-COMPLETE
  9261        MOVE LINK-001            TO PGM-NAME
  9262
  9263* EXEC CICS LINK
  9264*           PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 162
* EL6316.cbl
  9265*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  9266*           LENGTH     (EMI-COMM-LENGTH)
  9267*       END-EXEC
  9268*    MOVE '."C                   (   #00008153' TO DFHEIV0
  9269     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9270     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9271     MOVE X'2020233030303038313533' TO DFHEIV0(25:11)
  9272     CALL 'kxdfhei1' USING DFHEIV0,
  9273           PGM-NAME,
  9274           ERROR-MESSAGE-INTERFACE-BLOCK,
  9275           EMI-COMM-LENGTH,
  9276           DFHEIV99,
  9277           DFHEIV99,
  9278           DFHEIV99,
  9279           DFHEIV99
  9280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9281     END-IF
  9282     .
  9283 9900-EXIT.
  9284     EXIT.
  9285 9990-ABEND.
  9286     MOVE LINK-004               TO PGM-NAME.
  9287     MOVE DFHEIBLK               TO EMI-LINE1.
  9288
  9289* EXEC CICS LINK
  9290*        PROGRAM   (PGM-NAME)
  9291*        COMMAREA  (EMI-LINE1)
  9292*        LENGTH    (72)
  9293*    END-EXEC.
  9294     MOVE 72
  9295       TO DFHEIV11
  9296*    MOVE '."C                   (   #00008165' TO DFHEIV0
  9297     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9298     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9299     MOVE X'2020233030303038313635' TO DFHEIV0(25:11)
  9300     CALL 'kxdfhei1' USING DFHEIV0,
  9301           PGM-NAME,
  9302           EMI-LINE1,
  9303           DFHEIV11,
  9304           DFHEIV99,
  9305           DFHEIV99,
  9306           DFHEIV99,
  9307           DFHEIV99
  9308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9309
  9310     GO TO 8200-SEND-DATAONLY.
  9311
  9312* GOBACK.
  9313     MOVE '9%                    "   ' TO DFHEIV0
  9314     MOVE 'EL6316' TO DFHEIV1
  9315     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9316     GOBACK.
  9317 9995-SECURITY-VIOLATION.
  9318*                            COPY ELCSCTP.
  9319******************************************************************
  9320*                                                                *
  9321*                            ELCSCTP                             *
  9322*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 163
* EL6316.cbl
  9323*                                                                *
  9324*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9325******************************************************************
  9326
  9327
  9328     MOVE EIBDATE          TO SM-JUL-DATE.
  9329     MOVE EIBTRMID         TO SM-TERMID.
  9330     MOVE THIS-PGM         TO SM-PGM.
  9331     MOVE EIBTIME          TO TIME-IN.
  9332     MOVE TIME-OUT         TO SM-TIME.
  9333     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9334
  9335
  9336* EXEC CICS LINK
  9337*         PROGRAM  ('EL003')
  9338*         COMMAREA (SECURITY-MESSAGE)
  9339*         LENGTH   (80)
  9340*    END-EXEC.
  9341     MOVE 'EL003' TO DFHEIV1
  9342     MOVE 80
  9343       TO DFHEIV11
  9344*    MOVE '."C                   (   #00008190' TO DFHEIV0
  9345     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9346     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9347     MOVE X'2020233030303038313930' TO DFHEIV0(25:11)
  9348     CALL 'kxdfhei1' USING DFHEIV0,
  9349           DFHEIV1,
  9350           SECURITY-MESSAGE,
  9351           DFHEIV11,
  9352           DFHEIV99,
  9353           DFHEIV99,
  9354           DFHEIV99,
  9355           DFHEIV99
  9356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9357
  9358
  9359******************************************************************
  9360
  9361 9995-EXIT.
  9362     EXIT.
  9363
  9364 9999-DFHBACK SECTION.
  9365     MOVE '9%                    "   ' TO DFHEIV0
  9366     MOVE 'EL6316' TO DFHEIV1
  9367     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9368     GOBACK.
  9369 9999-DFHEXIT.
  9370     IF DFHEIGDJ EQUAL 0001
  9371         NEXT SENTENCE
  9372     ELSE IF DFHEIGDJ EQUAL 2
  9373         GO TO 8300-SEND-TEXT
  9374         DEPENDING ON DFHEIGDI.
  9375     MOVE '9%                    "   ' TO DFHEIV0
  9376     MOVE 'EL6316' TO DFHEIV1
  9377     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9378     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 13:16 Page 164
* EL6316.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       35216     Code:       23667
