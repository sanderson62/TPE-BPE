* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   1
* EL689.cbl
* Options: int("EL689.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL689.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL689.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL689.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL689 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 15:10:07.
     7*                            VMOD=2.037
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11*DATE-COMPILED.
    12*REMARKS.    TRANSACTION - EXH3 - CREDIT LETTER WRITER.
    13*
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   2
* EL689.cbl
    14******************************************************************
    15
    16* W-FILE-USED REFERENCE LIST:
    17* (1)  ELCNTL - COMPANY
    18* (2)  ELCNTL - LIFE BENEFIT
    19* (3)  ELCNTL - A&H BENEFIT
    20* (4)  ELCNTL - CARRIER
    21* (5)  MAIL
    22* (6)  ERACCT
    23* (7)  USED FOR SYSTEM VARIABLES ?
    24* (8)  ELCERT
    25* (9)  PENDING BUSINESS
    26* (10) COMPENSATION
    27* (11) ELCNTL - PROCESSOR DATA ?
    28* (12) ERCHEK
    29* (13) ERPYAJ
    30* (14) NOT USED
    31* (15) NOT USED
    32* (16) NOT USED
    33* (17) NOT USED
    34* (18) NOT USED
    35* (19) NOT USED
    36* (20) NOT USED
    37*
    38******************************************************************
    39*                   C H A N G E   L O G
    40*
    41* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    42*-----------------------------------------------------------------
    43*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    44* EFFECTIVE    NUMBER
    45*-----------------------------------------------------------------
    46* 101501    2001100100006  SMVA  ADD USERID to screen header
    47*                                ADJUSTED REDEFINES EL689AI FILLER
    48* 031504    2004020600009  SMVA  PULL MOST CURRENT ACCT ADDRESS
    49* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    50* 100705    2004072800003  PEMA  ADD NEW VARIABLES
    51* 072308    2008062700001  PEMA  ADD NEW VARIABLES
    52* 092908    2008013100006  PEMA  MOVE VAR 154
    53* 102408  CR2008091000001  PEMA  MOVE PNDB VARS TO CERT VARS
    54* 051209  CR2009021700003  PEMA  ADD CRED BENE VARIABLES
    55* 051209  CR2009042700002  PEMA  ADD ERACCT ACCT NUMBER VARIABLE
    56* 022510  IR2009062300003  PEMA  ADD ENDFILE TEST TO ERACCT READ
    57* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    58* 041811  CR2011010400001  PEMA  DISABLE PF8 FOR CERTAIN USERS
    59* 042011  CR2011010400001  PEMA  FIX CRED BENE ADDRESS LINES
    60* 061411  CR2011061300001  PEMA  ADD ALWA TO PF8 DISABLE LIST
    61* 092911  IR2011092900001  AJRA  CLEAR LABEL LINES BEFORE CRED BEN
    62* 022712  IR2012022700001  AJRA  DON'T COUNT &&&&&& IN LINES
    63* 122011  CR2011022800001  AJRA  NAPERSOFT
    64* 090612  IR2012090600001  AJRA  NAPERSOFT
    65* 091712  IR2012091400001  AJRA  NAPERSOFT CERT ID
    66* 091912  IR2012091900001  AJRA  ALLOW FOLLOW UP DATE TO = CURR DT
    67* 101812  CR2012101700002  AJRA  ADD ENDARCH AND SCREENID
    68* 110512  CR2012101700002  AJRA  EXIT LETTER WRITER AFTER PF7
    69* 120512  CR2012101700002  AJRA  ADD RE ENCL CODE
    70* 011013  CR2012101700002  AJRA  CHECK REQ REASON CODE IND
    71* 012413  CR2013012100001  AJRA  ADD AUTO BILLING NOTE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   3
* EL689.cbl
    72* 121213  CR2013090300001  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    73* 123113  CR2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    74******************************************************************
    75
    76 DATA DIVISION.
    77 WORKING-STORAGE SECTION.
    78 01  DFH-START PIC X(04).
    79 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    80 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    81                                   USAGE POINTER.
    82 77  FILLER  PIC X(32) VALUE '********************************'.
    83 77  FILLER  PIC X(32) VALUE '*    EL689 WORKING STORAGE     *'.
    84 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
    85 01  P pointer.
    86 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    87 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    88 01  var-ptr pointer.
    89 01  env-var-len                 pic 9(4)  binary.
    90 01  rc                          pic 9(9)  binary.
    91 01  WS-KIXHOST                  PIC X(10).
    92 01  WS-KIXSYS.
    93     05  WS-KIX-FIL1             PIC X(10).
    94     05  WS-KIX-APPS             PIC X(10).
    95     05  WS-KIX-ENV              PIC X(10).
    96     05  WS-KIX-MYENV            PIC X(10).
    97     05  WS-KIX-SYS              PIC X(10).
    98 01 srch-commarea.
    99*                                copy ELCADLTRSPI.
   100******************************************************************
   101*                   C H A N G E   L O G
   102*
   103* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   104*-----------------------------------------------------------------
   105*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   106* EFFECTIVE    NUMBER
   107*-----------------------------------------------------------------
   108* 060611    2011022800001  PEMA  NEW COPYBOOK
   109* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   110* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   111******************************************************************
   112****************************************
   113*  commarea for NaperSoft On Demand Admin services letters
   114*  (business logic input & output)
   115****************************************
   116     03  BL-INPUT.
   117         05  BL-DATA-SRCE        PIC X.
   118         05  BL-LETTER-ID        PIC XXXX.
   119         05  BL-CARRIER          PIC X.
   120         05  BL-GROUP            PIC X(6).
   121         05  BL-STATE            PIC XX.
   122         05  BL-ACCOUNT          PIC X(10).
   123         05  BL-EFF-DT           PIC X(10).
   124         05  BL-CERT-NO          PIC X(11).
   125         05  BL-BATCH-NO         PIC X(6).
   126         05  BL-BATCH-SEQ        PIC 9(8).
   127         05  BL-RESP-NO          PIC X(10).
   128         05  BL-NO-OF-COPIES     PIC 99.
   129         05  BL-PROC-ID          PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   4
* EL689.cbl
   130         05  BL-COMP-ID          PIC XXX.
   131         05  BL-PRINT-NOW-SW     PIC X.
   132         05  BL-ENC-CD           PIC XXX.
   133         05  BL-RESEND-DT        PIC X(10).
   134         05  BL-FOLLOW-UP-DT     PIC X(10).
   135         05  BL-ARCHIVE-NO       PIC 9(8).
   136         05  BL-FUNC             PIC X(8).
   137         05  BL-COMMENTS         PIC X(100).
   138         05  FILLER REDEFINES BL-COMMENTS.
   139             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   140             10  BL-LETTER-TO-ACCT PIC X.
   141             10  BL-LETTER-TO-BENE PIC X.
   142             10  BL-WRITE-ERARCH   PIC X.
   143                 88  ERARCH-QWS      VALUE 'Q'.
   144                 88  ERARCH-BATCH    VALUE 'B'.
   145                 88  ERARCH-TEMP     VALUE 'T'.
   146             10  BL-PROCESS-TYPE PIC X(07).
   147             10  BL-CERT-FORM-ID PIC X(05).
   148             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   149             10  BL-SOURCE-SCREEN PIC X(8).
   150             10  FILLER          PIC X(25).
   151     03  BL-OUTPUT.
   152         05  BL-STATUS                   PIC X.
   153             88  BL-OK                      VALUE "P".
   154             88  BL-FAIL                  VALUE "F".
   155         05  BL-MESSAGE          PIC X(50).
   156     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   157     03  FILLER                  PIC X(31).
   158 01  W-WORK-AREAS.
   159     12  FILLER                  PIC  X(18)
   160                                      VALUE 'PROGRAM WORK AREA:'.
   161
   162     12  W-ASKTIME-CTR           PIC S9(04)  COMP   VALUE +0.
   163     12  W-CWA-NDX               PIC S9(04)  COMP   VALUE +0.
   164     12  W-DISPLAY-NDX           PIC S9(04)  COMP   VALUE +0.
   165     12  W-FIRST-BAD-VARIABLE    PIC S9(04)  COMP   VALUE +0.
   166     12  W-NDX                   PIC S9(04)  COMP   VALUE +0.
   167     12  W-NDX2                  PIC S9(04)  COMP   VALUE +0.
   168     12  W-SEQ-CTR               PIC S9(04)  COMP   VALUE +0.
   169     12  W-TS-ITEM               PIC S9(04)  COMP   VALUE +0.
   170     12  W-TOTAL-LINE-LENGTH     PIC S9(04)  COMP   VALUE +0.
   171     12  W-WORK-NDX              PIC S9(04)  COMP   VALUE +0.
   172
   173     12  W-ADJUST-SHORT          PIC S9(03) VALUE +0   COMP-3.
   174     12  W-DIFFERENCE            PIC S9(07)V9(02)
   175                                            VALUE +0   COMP-3.
   176     12  W-INITIAL-COLUMN        PIC S9(03) VALUE +0   COMP-3.
   177     12  W-LAST-COLUMN           PIC S9(03) VALUE +70 COMP-3.
   178     12  W-LAST-SQUEEZED-SPACE   PIC S9(03) VALUE +0   COMP-3.
   179     12  W-LAST-TX-SPACE         PIC S9(03) VALUE +0   COMP-3.
   180     12  W-LAST-WC-SPACE         PIC S9(03) VALUE +0   COMP-3.
   181     12  W-LINE-COUNT            PIC S9(03) VALUE +0   COMP-3.
   182     12  W-LINE-INDENT-1         PIC  9(02) VALUE 0    COMP-3.
   183     12  W-LINE-INDENT-2         PIC  9(02) VALUE 0    COMP-3.
   184     12  W-LINE-INDENT-3         PIC  9(02) VALUE 0    COMP-3.
   185     12  W-LINE-INDENT-4         PIC  9(02) VALUE 0    COMP-3.
   186     12  W-LINE-INDENT-5         PIC  9(02) VALUE 0    COMP-3.
   187     12  W-MAX-LINES-PER-PAGE    PIC  9(02) VALUE 56   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   5
* EL689.cbl
   188     12  W-NEXT-INDENT           PIC  9(02) VALUE 0    COMP-3.
   189     12  W-PAGE                  PIC S9(02) VALUE +0   COMP-3.
   190     12  W-PAGE-LINE             PIC S9(03) VALUE +0   COMP-3.
   191     12  W-PARAGRAPH-INDENT      PIC  9(02) VALUE 0    COMP-3.
   192     12  W-ROLL-COUNTER          PIC S9(03) VALUE +0   COMP-3.
   193     12  W-START-COLUMN          PIC S9(03) VALUE +1   COMP-3.
   194     12  W-TEMP-CURRENT-LINE     PIC S9(03) VALUE +0   COMP-3.
   195     12  W-TOO-FAR               PIC S9(03) VALUE +71 COMP-3.
   196     12  W-TOP-MARGIN            PIC  9(02) VALUE 0    COMP-3.
   197     12  W-TOTAL-TX-LINES        PIC S9(03) VALUE +0   COMP-3.
   198     12  W-TS-GROUP-WORK         PIC  9(05) VALUE 0    COMP-3.
   199     12  W-WORK-INDENT           PIC  9(02) VALUE 0    COMP-3.
   200     12  W-WORK-AMOUNT           PIC S9(09)V9(02)
   201                                            VALUE +0   COMP-3.
   202
   203     12  W-DATA-SOURCE           PIC  9(01) VALUE 0.
   204     12  W-LABEL-SOURCE          PIC  9(01) value 0.
   205         88  W-LABEL-SOURCE-VALID           VALUE 1 THRU 7.
   206     12  W-LABEL-JOINT-NAME      PIC  X(30) VALUE SPACES.
   207     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   208     12  W-NUMB-LABEL-LINES      PIC  9(01) VALUE 0.
   209     12  W-PRINT-CONTROL         PIC  9(02) VALUE 0.
   210     12  W-SAVE-REVISION         PIC  9(03) value 0.
   211     12  W-DISPLAY-3             PIC  9(03) value 0.
   212     12  W-DISPLAY-8             PIC  9(08) value 0.
   213     12  W-DISPLAY-7             PIC  9(07) value 0.
   214     12  W-EDIT-2-5-S            PIC  Z9.9(05).
   215     12  W-EDIT-3-0              PIC  ZZ9.
   216     12  W-EDIT-7-2              PIC  $$,$$$,$$9.99.
   217     12  W-EDIT-7-2-NEGATIVE     PIC  $$,$$$,$$9.99-.
   218     12  W-EDIT-9-2              PIC  $$$$,$$$,$$9.99.
   219     12  W-EDIT-12-2             PIC  $$$$,$$$,$$$,$$9.99.
   220
   221     12  WS-ACCT-PKEY-MATCH-SW   PIC  X(01) VALUE SPACE.
   222         88  PRIOR-MATCH-ACCT-PKEY          VALUE 'Y'.
   223
   224     12  W-ARCH-SUPPRESS         PIC 99999999.
   225     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   226                                 PIC  X(08).
   227     12  W-COMP-WORK-AREA.
   228         16  W-CWA-CHAR OCCURS 10 TIMES
   229                                 PIC  X(01).
   230     12  W-INCOMING-ARCHIVE      PIC  X(08).
   231     12  W-INCOMING-ARCH-NO REDEFINES W-INCOMING-ARCHIVE
   232                                 PIC  9(08).
   233
   234     12  W-BATCH-BREAKDOWN.
   235         16  W-BATCH-CONTROL     PIC S9(08) COMP.
   236         16  W-BATCH-SEQ         PIC S9(04) COMP.
   237     12  W-BEN-HOLD              PIC  X(02).
   238     12  W-BENEFIT-WORK          PIC  X(03).
   239     12  W-BEN-R REDEFINES W-BENEFIT-WORK.
   240         16  W-ELIM-DAYS         PIC  X(02).
   241         16  FILLER              PIC  X(01).
   242     12  W-CALL-PGM              PIC  X(08).
   243     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   244
   245     12  FILLER                  PIC  X(09) VALUE 'LINE CNTL'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   6
* EL689.cbl
   246     12  W-LINE-CONTROL-RECORD.
   247         16  W-LC-LINE-WIDTH     PIC  9(02).
   248         16  FILLER              PIC  X(01).
   249         16  W-LC-PARAGRAPH-INDENT
   250                                 PIC  9(02).
   251         16  FILLER              PIC  X(01).
   252         16  W-LC-MAX-LINES-PER-PAGE
   253                                 PIC  9(02).
   254         16  FILLER              PIC  X(01).
   255         16  W-LC-LINE-ADJUST    PIC  9(02).
   256         16  FILLER              PIC  X(01).
   257         16  W-LC-LINE-INDENT-1  PIC  9(02).
   258         16  FILLER              PIC  X(01).
   259         16  W-LC-LINE-INDENT-2  PIC  9(02).
   260         16  FILLER              PIC  X(01).
   261         16  W-LC-LINE-INDENT-3  PIC  9(02).
   262         16  FILLER              PIC  X(01).
   263         16  W-LC-LINE-INDENT-4  PIC  9(02).
   264         16  FILLER              PIC  X(01).
   265         16  W-LC-LINE-INDENT-5  PIC  9(02).
   266         16  FILLER              PIC  X(01).
   267         16  W-LC-TOP-MARGIN     PIC  9(02).
   268         16  FILLER              PIC  X(01).
   269         16  W-LC-CASE-IND       PIC  X(01).
   270             88  W-LC-USE-BOTH-CASES        VALUE 'Y'.
   271         16  FILLER              PIC  X(01).
   272         16  W-LC-PAGE-IND       PIC  X(01).
   273             88  W-LC-CREATE-PAGES          VALUE 'Y'.
   274     12  W-DATE-WORK             PIC  9(07).
   275     12  W-DT-REDEF REDEFINES W-DATE-WORK.
   276         16  FILLER              PIC  X(02).
   277         16  W-DT-WORK           PIC  9(05).
   278
   279     12  W-DEEDIT-FIELD          PIC  X(15).
   280     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   281
   282     12  W-EDIT-DATE-1.
   283         16  W-ED1-MM            PIC  X(02).
   284         16  FILLER              PIC  X(01) VALUE '/'.
   285         16  W-ED1-DD            PIC  X(02).
   286         16  FILLER              PIC  X(01) VALUE '/'.
   287         16  W-ED1-YY            PIC  X(02).
   288
   289     12  W-EDIT-DATE-2.
   290         16  W-ED2-DD            PIC  X(02).
   291         16  FILLER              PIC  X(01) VALUE '/'.
   292         16  W-ED2-MM            PIC  X(02).
   293         16  FILLER              PIC  X(01) VALUE '/'.
   294         16  W-ED2-YY            PIC  X(02).
   295
   296     12  W-LABEL-HOLD-AREA.
   297         16  W-LABEL-LINES OCCURS 6 TIMES.
   298             20  W-LABEL-ZIP.
   299                 24  W-LABEL-1ST-ZIP  PIC  X(05).
   300                 24  W-LABEL-DASH     PIC  X(01).
   301                 24  W-LABEL-2ND-ZIP  PIC  X(04).
   302             20  W-LAB-CAN-POSTAL-CODES REDEFINES W-LABEL-ZIP.
   303                 24  W-LAB-CAN-POSTAL-CD-1
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   7
* EL689.cbl
   304                                      PIC  X(03).
   305                 24  W-LAB-CAN-DASH   PIC  X(01).
   306                 24  W-LAB-CAN-POSTAL-CD-2
   307                                      PIC  X(03).
   308                 24  W-LAB-CAN-FILLER PIC  X(03).
   309             20  FILLER               PIC  X(10).
   310             20  W-LAST-ZIP.
   311                 24  W-LAST-1ST-ZIP   PIC  X(05).
   312                 24  W-LABEL-DASH-LAST
   313                                      PIC  X(01).
   314                 24  W-LAST-2ND-ZIP   PIC  X(04).
   315             20  W-LAST-CAN-POSTAL-CODES REDEFINES W-LAST-ZIP.
   316                 24  W-LAST-CAN-POSTAL-CD-1
   317                                      PIC  X(03).
   318                 24  W-LAST-CAN-DASH  PIC  X(01).
   319                 24  W-LAST-CAN-POSTAL-CD-2
   320                                      PIC  X(03).
   321                 24  W-LAST-CAN-FILLER
   322                                      PIC  X(03).
   323
   324     12  W-LAST-CHAR             PIC  X(01).
   325         88  W-LAST-CHAR-PUNC    VALUE '-' '/'.
   326     12  W-LAST-SQ-CHAR          PIC  X(01).
   327
   328     12  W-LINE-NUM.
   329         16  W-LINE1             PIC  X(01).
   330         16  W-LINE23            PIC  9(02).
   331     12  W-LIN-NUM REDEFINES W-LINE-NUM
   332                                 PIC  9(03).
   333
   334     12  W-NAME-LAST             PIC  X(15).
   335     12  W-NAME-FIRST.
   336         16  W-NAME-FIRST-INIT   PIC  X(01).
   337         16  W-NAME-FIRST-REMAIN PIC  X(14).
   338     12  W-NAME-MIDDLE.
   339         16  FILLER              PIC  X(01).
   340         16  W-NAME-MIDDLE-2     PIC  X(01).
   341         16  FILLER              PIC  X(13).
   342
   343     12  W-PAGE-PRT.
   344         16  FILLER              PIC  X(34) VALUE SPACES.
   345         16  W-PAGE-NUMBER       PIC  Z9.
   346         16  FILLER              PIC  X(01) VALUE '.'.
   347         16  FILLER              PIC  X(33) VALUE SPACES.
   348
   349     12  W-PHONE-IN              PIC  9(11) VALUE ZEROS.
   350     12  W-PHONE-IN-R   REDEFINES W-PHONE-IN.
   351         16  FILLER              PIC  9(01).
   352         16  W-PHI-AREA          PIC  9(03).
   353         16  W-PHI-PFX           PIC  9(03).
   354         16  W-PHI-SFX           PIC  9(04).
   355     12  W-PHONE-OUT.
   356         16  W-PO-AREA           PIC  X(03).
   357         16  FILLER              PIC  X(01) VALUE '-'.
   358         16  W-PO-PFX            PIC  X(03).
   359         16  FILLER              PIC  X(01) VALUE '-'.
   360         16  W-PO-SFX            PIC  X(04).
   361
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   8
* EL689.cbl
   362     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   363     12  W-SAVE-BIN-NEXT-BUS-DT  PIC  X(02) VALUE SPACES.
   364     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   365     12  W-SAVE-PLAN             PIC  X(02) VALUE SPACES.
   366
   367     12  W-SINGLE-LINE           PIC  X(70).
   368     12  W-SINGLE-LINE-BY REDEFINES W-SINGLE-LINE.
   369         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY NDX1 NDX2 NDXA
   370                                 PIC  X(01).
   371
   372     12  W-SQUEEZED-LINE.
   373         16  W-SQ-CHAR OCCURS 70 TIMES
   374                       INDEXED BY W-SQ-NDX
   375                                 PIC  X(01).
   376
   377     12  W-TIME-IN               PIC S9(07).
   378     12  W-TIME-OUT-R REDEFINES W-TIME-IN.
   379         16  FILLER              PIC  X(01).
   380         16  W-TIME-OUT          PIC  99V9(02).
   381         16  FILLER              PIC  X(02).
   382
   383     12  W-TS-NAME-TEXT.
   384         16  W-TS-ID-TEXT        PIC  X(04) VALUE '104A'.
   385         16  W-TS-ID-TIME
   386             REDEFINES W-TS-ID-TEXT
   387                                 PIC S9(07) COMP-3.
   388         16  W-TS-TERM-TEXT.
   389             20 W-TS-TERM-PREFIX PIC  X(02).
   390             20 FILLER           PIC  X(02).
   391     12  W-TS-NAME-SCREEN.
   392         16  FILLER              PIC  X(04) VALUE '689X'.
   393         16  W-TS-TERM-SCREEN    PIC  X(04).
   394
   395     12  W-WORK-LINE.
   396         16  W-WORK-CHAR OCCURS 70 TIMES
   397                       INDEXED BY W-WC-NDX
   398                                  W-WC-NDX2
   399                                  W-WC-NDX3
   400                                 PIC  X(01).
   401
   402     12  W-WORK-ZIP-NUMERIC      PIC  9(09).
   403     12  W-WORK-ZIP REDEFINES W-WORK-ZIP-NUMERIC.
   404         16  W-WORK-ZIP5         PIC  X(05).
   405         16  W-WORK-ZIP4         PIC  X(04).
   406     12  W-CANADIAN-POSTAL-CODES REDEFINES W-WORK-ZIP-NUMERIC.
   407         16  W-CAN-POSTAL-CD-1.
   408             20  FILLER          PIC  X(01).
   409                 88 W-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   410             20  FILLER          PIC  X(02).
   411         16  W-CAN-POSTAL-CD-2   PIC  X(03).
   412         16  W-FILLER            PIC  X(03).
   413
   414**** Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   415*                   COPY ELCZREC.
   416******************************************************************
   417*                                                                *
   418*                                                                *
   419*                            ELCZREC.                            *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page   9
* EL689.cbl
   420*                                                                *
   421*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   422*                                                                *
   423******************************************************************
   424*-----------------------------------------------------------------
   425*                   C H A N G E   L O G
   426*
   427* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   428*-----------------------------------------------------------------
   429*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   430* EFFECTIVE    NUMBER
   431*-----------------------------------------------------------------
   432* 122011    2011022800001  AJRA  NEW FILE
   433* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   434* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   435* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   436* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   437*-----------------------------------------------------------------
   438 01  W-Z-CONTROL-DATA.
   439     05  W-NUMBER-OF-COPIES      PIC  9.
   440     05  FILLER                  PIC  X.
   441     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   442     05  FILLER                  PIC  X.
   443     05  W-DAYS-TO-RESEND        PIC  999.
   444     05  FILLER                  PIC  X.
   445     05  W-FORM-TO-RESEND        PIC  X(4).
   446     05  W-ADD-BAR-CODE          PIC  X.
   447     05  W-PROMPT-LETTER         PIC  X.
   448     05  W-HAS-RETURN-ENV        PIC  X.
   449     05  W-ENCLOSURE-CD          PIC  XXX.
   450     05  W-SIG-FLAG-DEFAULT      PIC  X.
   451     05  W-AUTO-CLOSE-IND        PIC  X.
   452     05  FILLER                  PIC  X.
   453     05  W-LETTER-TO-BENE        PIC  X.
   454     05  FILLER                  PIC  X.
   455     05  W-LETTER-TO-ACCT        PIC  X.
   456     05  FILLER                  PIC  X.
   457     05  W-LETTER-TYPE           PIC  X.
   458     05  FILLER                  PIC  X.
   459     05  W-PRINT-CERTIFICATE     PIC  X.
   460     05  FILLER                  PIC  X.
   461     05  W-REFUND-REQUIRED       PIC  X.
   462     05  FILLER                  PIC  X.
   463     05  W-ONBASE-CODE           PIC  XX.
   464     05  FILLER                  PIC  X.
   465     05  W-ACCT-SUMM             PIC  X.
   466     05  FILLER                  PIC  X.
   467     05  W-CSO-SUMM              PIC  X.
   468     05  FILLER                  PIC  X.
   469     05  W-REASONS-REQUIRED      PIC  X.
   470     05  FILLER                  PIC  X(29).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  10
* EL689.cbl
   472 01  W-SWITCH-INDICATORS-AREA.
   473     12  FILLER                  PIC  X(16)
   474                                      VALUE 'PROGRAM SWITCHS:'.
   475     12  W-ADDRESS-ONLY-SW       PIC  X(01) VALUE ' '.
   476         88  W-ADDRESS-ONLY      VALUE 'Y'.
   477         88  W-FULL-DATA         VALUE ' '.
   478     12  W-ACCT-BROWSE-STARTED-SW
   479                                 PIC  X(01) VALUE 'N'.
   480         88  W-ACCT-BROWSE-STARTED          VALUE 'Y'.
   481     12  W-ARCT-BROWSE-STARTED   PIC  X(01) VALUE 'N'.
   482     12  W-CERT-FOUND-SW         PIC  X(01) VALUE 'N'.
   483         88  W-CERT-FOUND                   VALUE 'Y'.
   484     12  W-CHARACTER-TYPE        PIC  X(01).
   485         88  W-END-OF-SENTENCE   VALUE '.' '?' '!'.
   486         88  W-PUNCTUATION       VALUE '.' '?' '!' ',' ';'.
   487         88  W-SPACE             VALUE ' '.
   488     12  W-COMP-BROWSE-SW        PIC  X(01) VALUE 'N'.
   489         88  W-COMP-BROWSE-STARTED          VALUE 'Y'.
   490     12  W-DATA-SHRINK-IND       PIC  X(01) VALUE SPACES.
   491         88  W-DATA-SHRINKING    VALUE 'Y'.
   492     12  W-END-OF-SENTENCE-IND   PIC  X(01) VALUE SPACES.
   493         88  W-END-OF-SENTENCE-WORKING      VALUE 'Y'.
   494     12  W-FIRST-BAD-VARIABLE-IND
   495                                 PIC  X(01) VALUE SPACES.
   496         88  W-FIRST-BAD-VARIABLE-FOUND     VALUE 'Y'.
   497     12  W-FIRST-CHAR-FOUND-IND  PIC  X(01) VALUE SPACES.
   498         88  W-FIRST-CHAR-FOUND             VALUE 'Y'.
   499         88  W-FIRST-CHAR-NOT-FOUND         VALUE SPACES.
   500     12  W-FORM-CHANGED-IND      PIC  X(01) VALUE SPACES.
   501         88  W-FORM-CHANGED                 VALUE 'Y'.
   502     12  W-FORM-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   503         88  W-FORM-SQUEEZE-ON              VALUE 'Y'.
   504         88  W-FORM-SQUEEZE-OFF             VALUE ' '.
   505     12  W-HOLD-IND              PIC  X(01) VALUE SPACES.
   506         88  W-HOLD-ON                      VALUE 'Y'.
   507         88  W-HOLD-OFF                     VALUE ' '.
   508     12  W-INDIVIDUAL-DATA-SW    PIC  X(01) VALUE ' '.
   509         88  W-INDIVIDUAL-DATA-COMPLETED    VALUE 'Y'.
   510         88  W-INDIV-DATA-NOT-COMPLETED     VALUE ' '.
   511     12  W-KEY-FIELDS-CHANGED-IND
   512                                 PIC  X(01) VALUE ' '.
   513         88  W-KEY-FIELDS-CHANGED           VALUE 'Y'.
   514         88  W-KEY-FIELDS-NOT-CHANGED       VALUE ' '.
   515     12  W-LAST-ONE              PIC  X(01) VALUE HIGH-VALUES.
   516         88  W-LAST-ONE-A-SPACE  VALUE ' '.
   517     12  W-LINE-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   518         88  W-NEW-PARAGRAPH                VALUE 'P' 'Q' 'R' 'S'
   519                                                   'T' 'U'.
   520         88  W-CONTINUE-PARAGRAPH           VALUE 'C' 'D' 'E' 'F'
   521                                                   'G' 'H'.
   522         88  W-FORM-CONTROL-LINE            VALUE 'K'.
   523         88  W-DO-NOT-ADJUST                VALUE 'N'.
   524         88  W-ADJUST-TO-LINE-LENGTH        VALUE 'A'.
   525         88  W-AS-IS                        VALUE 'A' 'N'.
   526         88  W-CONTINUE-PREVIOUS-PROCESS    VALUE ' ' '1' '2' '3'
   527                                                   '4' '5'.
   528
   529     12  W-PNDB-FOUND-SW         PIC  X(01) VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  11
* EL689.cbl
   530         88  W-PNDB-FOUND                   VALUE 'Y'.
   531     12  W-REMAINING-VAR-SW      PIC  X(01) VALUE SPACES.
   532         88  W-REMAINING-VAR-FOUND          VALUE 'Y'.
   533     12  W-REVERSE-DATE-SW       PIC  X(01) VALUE SPACES.
   534         88  W-REVERSE-DATE                 VALUE 'Y'.
   535     12  W-TEXT-BROWSED-SW       PIC  X(01) VALUE 'N'.
   536         88  W-TEXT-BROWSE-STARTED          VALUE 'Y'.
   537         88  W-TEXT-BROWSE-NOT-STARTED      VALUE 'N'.
   538
   539     12  W-VALID-ENDT-SW         PIC  X(01) VALUE 'N'.
   540         88  W-VALID-ENDT                   VALUE 'Y'.
   541     12  W-RESPONSE              PIC S9(8)   COMP.
   542         88  RESP-NORMAL                  VALUE +00.
   543         88  RESP-NOTFND                  VALUE +13.
   544         88  RESP-DUPREC                  VALUE +14.
   545         88  RESP-DUPKEY                  VALUE +15.
   546         88  RESP-NOTOPEN                 VALUE +19.
   547         88  RESP-ENDFILE                 VALUE +20.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  12
* EL689.cbl
   549 01  WS-SAVE-AREA.
   550     12  WS-SAV-AM-DEFN-1.
   551         16  WS-SAV-AM-AGT-COMMS OCCURS 10 TIMES.
   552             20  WS-SAV-AM-AGT             PIC  X(10).
   553             20  WS-SAV-AM-COM-TYP         PIC  X(01).
   554             20  FILLER                    PIC  X(15).
   555     12  WS-SAV-AM-REMIT-TO                PIC  9(02).
   556     12  WS-SAV-AM-CSR-CODE                PIC  X(04).
   557     12  WS-SAV-AM-CARRIER                 PIC  X(01).
   558     12  WS-SAV-AM-ACCOUNT                 PIC  X(10).
   559     12  WS-SAV-AM-CONTROL-NAME            PIC  X(30).
   560     12  WS-SAV-AM-NAME                    PIC  X(30).
   561     12  WS-SAV-AM-PERSON                  PIC  X(30).
   562     12  WS-SAV-AM-ADDRS                   PIC  X(30).
   563     12  WS-SAV-AM-CITY                    PIC  X(30).
   564     12  WS-SAV-AM-ERACCT-ACCOUNT          PIC  X(10).
   565     12  WS-SAV-AM-ZIP.
   566         16  WS-SAV-AM-ZIP-PRIME.
   567             20  WS-SAV-AM-ZIP-PRI-1ST     PIC  X(01).
   568                 88  SAVE-AM-CANADIAN-POST-CODE       VALUE
   569                     'A' THRU 'Z'.
   570             20  FILLER                    PIC  X(04).
   571         16  FILLER                        PIC  X(04).
   572     12  WS-SAV-AM-CANADIAN-POSTAL-CODE REDEFINES
   573                        WS-SAV-AM-ZIP      PIC  X(09).
   574     12  WS-SAV-AM-TEL-NO.
   575         16  WS-SAV-AM-AREA-CODE           PIC 9(03).
   576         16  WS-SAV-AM-TEL-PRE             PIC 9(03).
   577         16  WS-SAV-AM-TEL-NBR             PIC 9(04).
   578 01  W-KEY-AREAS.
   579     12  FILLER                    PIC  X(13)
   580                                      VALUE 'PROGRAM KEYS:'.
   581
   582     12  W-ACCT-SAVE-KEY           PIC  X(20).
   583     12  W-ACCT-KEY.
   584         16  W-ACCT-PARTIAL-KEY.
   585             20  W-ACCT-COMPANY-CD PIC  X(01).
   586             20  W-ACCT-CARRIER    PIC  X(01).
   587             20  W-ACCT-GROUPING   PIC  X(06).
   588             20  W-ACCT-STATE      PIC  X(02).
   589             20  W-ACCT-ACCOUNT    PIC  X(10).
   590         16  W-ACCT-EXP-DT         PIC  X(02).
   591
   592     12  W-ARCH-SAVE-KEY         PIC  X(05).
   593     12  W-ARCH-KEY.
   594         16  W-ARCH-PARTIAL-KEY.
   595             20  W-ARCH-COMPANY-CD
   596                                 PIC  X(01).
   597             20  W-ARCH-NUMBER   PIC S9(08)      COMP.
   598         16  W-ARCH-SEQ-NO       PIC S9(04)      COMP VALUE +0.
   599
   600     12  W-ARCT-KEY.
   601         16  W-ARCT-PARTIAL-KEY.
   602             20  W-ARCT-COMPANY-CD
   603                                 PIC  X(01).
   604             20  W-ARCT-NUMBER   PIC S9(08)      COMP.
   605         16  W-ARCT-REC-TYPE     PIC  X(01).
   606         16  W-ARCT-SEQ-NO       PIC S9(04)      COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  13
* EL689.cbl
   607
   608     12  W-CERT-KEY.
   609         16  W-CERT-COMPANY-CD   PIC  X(01).
   610         16  W-CERT-CARRIER      PIC  X(01).
   611         16  W-CERT-GROUPING     PIC  X(06).
   612         16  W-CERT-STATE        PIC  X(02).
   613         16  W-CERT-ACCOUNT      PIC  X(10).
   614         16  W-CERT-EFF-DT       PIC  X(02).
   615         16  W-CERT-CERT-NO.
   616             20  W-CERT-CERT-PRIME
   617                                 PIC  X(10).
   618             20  W-CERT-CERT-SFX PIC  X(01).
   619
   620     12  W-CHEK-KEY.
   621         16  W-CHEK-COMPANY-CD   PIC  X(01).
   622         16  W-CHEK-CARRIER      PIC  X(01).
   623         16  W-CHEK-GROUPING     PIC  X(06).
   624         16  W-CHEK-STATE        PIC  X(02).
   625         16  W-CHEK-ACCOUNT      PIC  X(10).
   626         16  W-CHEK-EFF-DT       PIC  X(02).
   627         16  W-CHEK-CERT-NO.
   628             20  W-CHEK-CERT-PRIME
   629                                 PIC  X(10).
   630             20  W-CHEK-CERT-SFX PIC  X(01).
   631         16  W-CHEK-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   632
   633     12  W-CNTL-KEY.
   634         16  W-CNTL-COMPANY-ID   PIC  X(03).
   635         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   636         16  W-CNTL-GENL.
   637             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   638             20  W-CNTL-GEN2.
   639                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   640                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   641         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   642
   643     12  W-COMP-SAVE-KEY         PIC  X(29).
   644     12  W-COMP-KEY.
   645         16  W-COMP-COMPANY-CD   PIC  X(01).
   646         16  W-COMP-CARRIER      PIC  X(01).
   647         16  W-COMP-GROUPING     PIC  X(06).
   648         16  W-COMP-RESP-PERSON.
   649             20  W-COMP-RP-CHAR OCCURS 10 TIMES
   650                                INDEXED BY W-COMP-NDX
   651                                 PIC  X(01).
   652         16  W-COMP-ACCOUNT      PIC  X(10).
   653         16  W-COMP-TYPE         PIC  X(01).
   654
   655     12  W-DELETE-KEY.
   656         16  W-DELETE-PARTIAL-KEY.
   657             20  W-DELETE-COMPANY-CD
   658                                 PIC  X(01).
   659             20  W-DELETE-NUMBER PIC S9(08)      COMP.
   660         16  W-DELETE-RECORD-TYPE
   661                                 PIC  X(01).
   662         16  W-DELETE-SEQ        PIC S9(04)      COMP VALUE +0.
   663
   664     12  W-MAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  14
* EL689.cbl
   665         16  W-MAIL-COMPANY-CD   PIC  X(01).
   666         16  W-MAIL-CARRIER      PIC  X(01).
   667         16  W-MAIL-GROUPING     PIC  X(06).
   668         16  W-MAIL-STATE        PIC  X(02).
   669         16  W-MAIL-ACCOUNT      PIC  X(10).
   670         16  W-MAIL-EFF-DT       PIC  X(02).
   671         16  W-MAIL-CERT-NO.
   672             20  W-MAIL-CERT-PRIME
   673                                 PIC  X(10).
   674             20  W-MAIL-CERT-SFX PIC  X(01).
   675
   676     12  W-PNDB-KEY.
   677         16  W-PNDB-COMPANY-CD   PIC  X(01).
   678         16  W-PNDB-ENTRY        PIC  X(06).
   679         16  W-PNDB-SEQ-NO       PIC S9(04)  COMP.
   680         16  W-PNDB-CHG-SEQ-NO   PIC S9(04)  COMP.
   681
   682     12  W-PNDB2-KEY.
   683         16  W-PNDB2-COMPANY-CD  PIC  X(01).
   684         16  W-PNDB2-CARRIER     PIC  X(01).
   685         16  W-PNDB2-GROUPING    PIC  X(06).
   686         16  W-PNDB2-STATE       PIC  X(02).
   687         16  W-PNDB2-ACCOUNT     PIC  X(10).
   688         16  W-PNDB2-EFF-DT      PIC  X(02).
   689         16  W-PNDB2-CERT-NO.
   690             20  W-PNDB2-CERT-PRIME
   691                                 PIC  X(10).
   692             20  W-PNDB2-CERT-SFX
   693                                 PIC  X(01).
   694         16  W-PNDB2-ALT-CHG-SEQ-NO
   695                                 PIC S9(04)  COMP.
   696         16  W-PNDB2-TYPE        PIC  X(01).
   697
   698     12  W-PYAJ-KEY.
   699         16  W-PYAJ-COMPANY-CD   PIC  X(01).
   700         16  W-PYAJ-CARRIER      PIC  X(01).
   701         16  W-PYAJ-GROUPING     PIC  X(06).
   702         16  W-PYAJ-FIN-RESP     PIC  X(10).
   703         16  W-PYAJ-ACCOUNT      PIC  X(10).
   704         16  W-PYAJ-FILE-SEQ-NO  PIC S9(08)    COMP.
   705         16  W-PYAJ-RECORD-TYPE  PIC  X(01).
   706
   707     12  W-SC-QUID-KEY.
   708         16  W-SC-QUID-TERMINAL  PIC  X(04).
   709         16  W-SC-QUID-SYSTEM    PIC  X(04).
   710
   711     12  W-TEXT-SAVE-KEY         PIC  X(05).
   712     12  W-TEXT-KEY.
   713         16  W-TEXT-PARTIAL-KEY.
   714             20  W-TEXT-COMPANY-CD
   715                                 PIC  X(01).
   716             20  W-TEXT-LETTER   PIC  X(04).
   717         16  W-TEXT-FILLER       PIC  X(08)   VALUE SPACES.
   718         16  W-TEXT-SEQ          PIC S9(04)   VALUE +0    COMP.
   719
   720     12  W-ERENDT-KEY-BY-ARCH.
   721         16  W-ERENDT-COMPANY-CD-A1 PIC X.
   722         16  W-ERENDT-ARCHIVE       PIC 9(8) BINARY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  15
* EL689.cbl
   723
   724     12  W-ELEOBC-KEY.
   725         16  W-EOBC-COMPANY-CD   PIC X.
   726         16  W-EOBC-REC-TYPE     PIC X.
   727         16  W-EOBC-CODE         PIC X(4).
   728         16  FILLER              PIC X(9).
   729     12  W-ERNOTE-KEY.
   730         16  W-NOTE-COMPANY-CD   PIC X.
   731         16  W-NOTE-CARRIER      PIC X.
   732         16  W-NOTE-GROUPING     PIC X(6).
   733         16  W-NOTE-STATE        PIC XX.
   734         16  W-NOTE-ACCOUNT      PIC X(10).
   735         16  W-NOTE-CERT-EFF-DT  PIC XX.
   736         16  W-NOTE-CERT-PRIME   PIC X(10).
   737         16  W-NOTE-CERT-SFX     PIC X.
   738     12  W-SAVE-KEY.
   739         16  W-SV-COMPANY-CD     PIC X.
   740         16  W-SV-CARRIER        PIC X.
   741         16  W-SV-GROUPING       PIC X(6).
   742         16  W-SV-STATE          PIC XX.
   743         16  W-SV-ACCOUNT        PIC X(10).
   744         16  W-SV-CERT-EFF-DT    PIC XX.
   745         16  W-SV-CERT-PRIME     PIC X(10).
   746         16  W-SV-CERT-SFX       PIC X.
   747     12  W-BILLING-NOTE.
   748         16  W-BN-NOTE           PIC X(25).
   749         16  W-BN-LTRID          PIC X(4).
   750         16  FILLER              PIC X(3).
   751         16  W-BN-DATE           PIC X(8).
   752         16  FILLER              PIC X(3).
   753         16  W-BN-USERID         PIC X(4).
   754         16  FILLER              PIC X(30).
   755     12  W-LEN                   PIC S9(5) COMP-3 VALUE +0.
   756     12  NOTE-SUB                PIC S9(5) COMP-3 VALUE +0.
   757     12  W-CERT-UPDATE-SW        PIC X  VALUE ' '.
   758         88  NO-CERT-RW                 VALUE 'N'.
   759         88  CERT-RW                    VALUE 'Y'.
   760
   761     12  W-ELENCC-KEY.
   762         16  W-ENCC-COMPANY-CD   PIC X.
   763         16  W-ENCC-REC-TYPE     PIC X.
   764         16  W-ENCC-ENC-CODE     PIC X(5).
   765         16  FILLER              PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  16
* EL689.cbl
   767 01  FILLER                      PIC  X(22)
   768                                 VALUE 'INTERFACE AREA STARTS:'.
   769*    COPY ELCINTF.
   770******************************************************************
   771*                                                                *
   772*                                                                *
   773*                            ELCINTF.                            *
   774*                            VMOD=2.017                          *
   775*                                                                *
   776*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   777*                                                                *
   778*       LENGTH = 1024                                            *
   779*                                                                *
   780******************************************************************
   781*                   C H A N G E   L O G
   782*
   783* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   784*-----------------------------------------------------------------
   785*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   786* EFFECTIVE    NUMBER
   787*-----------------------------------------------------------------
   788* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   789******************************************************************
   790 01  PROGRAM-INTERFACE-BLOCK.
   791     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   792     12  PI-CALLING-PROGRAM              PIC X(8).
   793     12  PI-SAVED-PROGRAM-1              PIC X(8).
   794     12  PI-SAVED-PROGRAM-2              PIC X(8).
   795     12  PI-SAVED-PROGRAM-3              PIC X(8).
   796     12  PI-SAVED-PROGRAM-4              PIC X(8).
   797     12  PI-SAVED-PROGRAM-5              PIC X(8).
   798     12  PI-SAVED-PROGRAM-6              PIC X(8).
   799     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   800     12  PI-COMPANY-ID                   PIC XXX.
   801     12  PI-COMPANY-CD                   PIC X.
   802
   803     12  PI-COMPANY-PASSWORD             PIC X(8).
   804
   805     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   806
   807     12  PI-CONTROL-IN-PROGRESS.
   808         16  PI-CARRIER                  PIC X.
   809         16  PI-GROUPING                 PIC X(6).
   810         16  PI-STATE                    PIC XX.
   811         16  PI-ACCOUNT                  PIC X(10).
   812         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   813                                         PIC X(10).
   814         16  PI-CLAIM-CERT-GRP.
   815             20  PI-CLAIM-NO             PIC X(7).
   816             20  PI-CERT-NO.
   817                 25  PI-CERT-PRIME       PIC X(10).
   818                 25  PI-CERT-SFX         PIC X.
   819             20  PI-CERT-EFF-DT          PIC XX.
   820         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   821             20  PI-PLAN-CODE            PIC X(2).
   822             20  PI-REVISION-NUMBER      PIC X(3).
   823             20  PI-PLAN-EFF-DT          PIC X(2).
   824             20  PI-PLAN-EXP-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  17
* EL689.cbl
   825             20  FILLER                  PIC X(11).
   826         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   827             20  PI-OE-REFERENCE-1.
   828                 25  PI-OE-REF-1-PRIME   PIC X(18).
   829                 25  PI-OE-REF-1-SUFF    PIC XX.
   830
   831     12  PI-SESSION-IN-PROGRESS          PIC X.
   832         88  CLAIM-SESSION                   VALUE '1'.
   833         88  CREDIT-SESSION                  VALUE '2'.
   834         88  WARRANTY-SESSION                VALUE '3'.
   835         88  MORTGAGE-SESSION                VALUE '4'.
   836         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   837
   838
   839*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   840
   841     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   842     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   843
   844     12  PI-CREDIT-USER                  PIC X.
   845         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   846         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   847
   848     12  PI-CLAIM-USER                   PIC X.
   849         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   850         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   851
   852     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   853         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   854         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   855         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   856         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   857         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   858
   859     12  PI-PROCESSOR-ID                 PIC X(4).
   860
   861     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   862
   863     12  PI-MEMBER-CAPTION               PIC X(10).
   864
   865     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   866         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   867
   868     12  PI-LIFE-OVERRIDE-L1             PIC X.
   869     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   870     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   871     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   872
   873     12  PI-AH-OVERRIDE-L1               PIC X.
   874     12  PI-AH-OVERRIDE-L2               PIC XX.
   875     12  PI-AH-OVERRIDE-L6               PIC X(6).
   876     12  PI-AH-OVERRIDE-L12              PIC X(12).
   877
   878     12  PI-NEW-SYSTEM                   PIC X(2).
   879
   880     12  PI-PRIMARY-CERT-NO              PIC X(11).
   881     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   882         88  PI-USES-PAID-TO                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  18
* EL689.cbl
   883     12  PI-CRDTCRD-SYSTEM.
   884         16  PI-CRDTCRD-USER             PIC X.
   885             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   886             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   887         16  PI-CC-MONTH-END-DT          PIC XX.
   888     12  PI-PROCESSOR-PRINTER            PIC X(4).
   889
   890     12  PI-OE-REFERENCE-2.
   891         16  PI-OE-REF-2-PRIME           PIC X(10).
   892         16  PI-OE-REF-2-SUFF            PIC X.
   893
   894     12  PI-REM-TRM-CALC-OPTION          PIC X.
   895
   896     12  PI-LANGUAGE-TYPE                PIC X.
   897             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   898             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   899             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   900
   901     12  PI-POLICY-LINKAGE-IND           PIC X.
   902         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   903         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   904                                                   LOW-VALUES.
   905
   906     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   907     12  PI-CLAIM-PW-SESSION             PIC X(1).
   908         88  PI-CLAIM-CREDIT                 VALUE '1'.
   909         88  PI-CLAIM-CONVEN                 VALUE '2'.
   910
   911     12  PI-PROCESSOR-CSR-IND            PIC X.
   912         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   913         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   914
   915     12  FILLER                          PIC X(3).
   916
   917     12  PI-SYSTEM-LEVEL                 PIC X(145).
   918
   919     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   920         PI-SYSTEM-LEVEL.
   921
   922         16  PI-ENTRY-CODES.
   923             20  PI-ENTRY-CD-1           PIC X.
   924             20  PI-ENTRY-CD-2           PIC X.
   925
   926         16  PI-RETURN-CODES.
   927             20  PI-RETURN-CD-1          PIC X.
   928             20  PI-RETURN-CD-2          PIC X.
   929
   930         16  PI-UPDATE-STATUS-SAVE.
   931             20  PI-UPDATE-BY            PIC X(4).
   932             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   933
   934         16  PI-LOWER-CASE-LETTERS       PIC X.
   935             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   936
   937*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   938*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   939*            88  CARRIER-CLM-CNTL            VALUE '2'.
   940
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  19
* EL689.cbl
   941         16  PI-CERT-ACCESS-CONTROL      PIC X.
   942             88  ST-ACCNT-CNTL               VALUE ' '.
   943             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   944             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   945             88  ACCNT-CNTL                  VALUE '3'.
   946             88  CARR-ACCNT-CNTL             VALUE '4'.
   947
   948         16  PI-PROCESSOR-CAP-LIST.
   949             20  PI-SYSTEM-CONTROLS.
   950                24 PI-SYSTEM-DISPLAY     PIC X.
   951                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   952                24 PI-SYSTEM-MODIFY      PIC X.
   953                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   954             20  FILLER                  PIC XX.
   955             20  PI-DISPLAY-CAP          PIC X.
   956                 88  DISPLAY-CAP             VALUE 'Y'.
   957             20  PI-MODIFY-CAP           PIC X.
   958                 88  MODIFY-CAP              VALUE 'Y'.
   959             20  PI-MSG-AT-LOGON-CAP     PIC X.
   960                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   961             20  PI-FORCE-CAP            PIC X.
   962                 88  FORCE-CAP               VALUE 'Y'.
   963
   964         16  PI-PROGRAM-CONTROLS.
   965             20  PI-PGM-PRINT-OPT        PIC X.
   966             20  PI-PGM-FORMAT-OPT       PIC X.
   967             20  PI-PGM-PROCESS-OPT      PIC X.
   968             20  PI-PGM-TOTALS-OPT       PIC X.
   969
   970         16  PI-HELP-INTERFACE.
   971             20  PI-LAST-ERROR-NO        PIC X(4).
   972             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   973
   974         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   975             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   976
   977         16  PI-CR-CONTROL-IN-PROGRESS.
   978             20  PI-CR-CARRIER           PIC X.
   979             20  PI-CR-GROUPING          PIC X(6).
   980             20  PI-CR-STATE             PIC XX.
   981             20  PI-CR-ACCOUNT           PIC X(10).
   982             20  PI-CR-FIN-RESP          PIC X(10).
   983             20  PI-CR-TYPE              PIC X.
   984
   985         16  PI-CR-BATCH-NUMBER          PIC X(6).
   986
   987         16  PI-CR-MONTH-END-DT          PIC XX.
   988
   989         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   990             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   991             88  PI-ZERO-CARRIER             VALUE '1'.
   992             88  PI-ZERO-GROUPING            VALUE '2'.
   993             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   994
   995         16  PI-CARRIER-SECURITY         PIC X.
   996             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   997
   998         16  PI-ACCOUNT-SECURITY         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  20
* EL689.cbl
   999             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1000             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1001
  1002         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1003             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1004                                         INDEXED BY PI-ACCESS-NDX
  1005                                         PIC X.
  1006
  1007         16  PI-GA-BILLING-CONTROL       PIC X.
  1008             88  PI-GA-BILLING               VALUE '1'.
  1009
  1010         16  PI-MAIL-PROCESSING          PIC X.
  1011             88  PI-MAIL-YES                 VALUE 'Y'.
  1012
  1013         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1014
  1015         16  PI-AR-SYSTEM.
  1016             20  PI-AR-PROCESSING-CNTL   PIC X.
  1017                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1018             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1019             20  PI-AR-MONTH-END-DT      PIC XX.
  1020
  1021         16  PI-MP-SYSTEM.
  1022             20  PI-MORTGAGE-USER            PIC X.
  1023                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1024                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1025             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1026                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1027                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1028                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1029                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1030                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1031             20  PI-MP-MONTH-END-DT          PIC XX.
  1032             20  PI-MP-REFERENCE-NO.
  1033                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1034                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1035
  1036         16  PI-LABEL-CONTROL            PIC X(01).
  1037             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1038             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1039
  1040         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1041             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1042
  1043         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1044             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1045             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1046
  1047         16  FILLER                      PIC X(14).
  1048
  1049     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1050******************************************************************
  1051     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1052*    COPY ELC1042.
  1053******************************************************************
  1054*                                                                *
  1055*                                                                *
  1056*                           ELC1042                              *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  21
* EL689.cbl
  1057*                            VMOD=2.002                          *
  1058*                                                                *
  1059*    NOTE                                                        *
  1060*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1061*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1062*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1063*        TO THESE PROGRAMS.                                      *
  1064*                                                                *
  1065*    NOTE                                                        *
  1066*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1067*        USE ONLY!                                               *
  1068*                                                                *
  1069******************************************************************
  1070
  1071         16  PI-1042-WA.
  1072             20  PI-ACTION       PIC  X(01).
  1073                 88 PI-SHOW-MODE           VALUE '1'.
  1074                 88 PI-CLEAR-MODE          VALUE '2'.
  1075                 88 PI-CREATE-MODE         VALUE '3'.
  1076             20  PI-COMM-CONTROL PIC  X(12).
  1077             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1078             20  PI-EOF-SW       PIC  X(01).
  1079                 88  PI-FILE-EOF           VALUE 'Y'.
  1080             20  PI-FILETYP      PIC  X(01).
  1081             20  PI-FORM-SQUEEZE-CONTROL
  1082                                 PIC  X(01).
  1083                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1084                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1085             20  PI-LAST-CONTROL PIC  X(12).
  1086             20  PI-TEMP-STOR-ITEMS
  1087                                 PIC S9(04) COMP.
  1088             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1089             20  PI-UPDATE-SW    PIC  9(01).
  1090                 88 ANY-UPDATES            VALUE 1.
  1091             20  PI-104-SCREEN-SENT-IND
  1092                                 PIC  X(01).
  1093                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1094                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1095             20  PI-1042-SCREEN-SENT-IND
  1096                                 PIC  X(01).
  1097                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1098                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1099             20  PI-1042-ARCHIVE-IND
  1100                                 PIC  X(01).
  1101                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1102             20  FILLER          PIC  X(29).
  1103*    COPY ELC689PI.
  1104******************************************************************
  1105*                                                                *
  1106*                            ELC689PI                            *
  1107*                            VMOD=2.003                          *
  1108*                                                                *
  1109*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  1110*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  1111*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1112*                                                                *
  1113*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  1114*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  22
* EL689.cbl
  1115*    BETWEEN PROGRAMS.                                           *
  1116*                                                                *
  1117*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1118*                                                                *
  1119*               EL631 - EL689  - EL6891 - EL6892                 *
  1120*                                                                *
  1121******************************************************************
  1122*                   C H A N G E   L O G
  1123*
  1124* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1125*-----------------------------------------------------------------
  1126*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1127* EFFECTIVE    NUMBER
  1128*-----------------------------------------------------------------
  1129* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  1130* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  1131* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1132******************************************************************
  1133
  1134
  1135         16  PI-689-WORK-AREA.
  1136             20  PI-689-ALT-PRINTER-ID
  1137                                 PIC  X(04).
  1138             20  PI-689-ARCHIVE-NUMBER
  1139                                 PIC  9(08).
  1140             20  PI-689-ARCHIVE-SW
  1141                                 PIC  X(01).
  1142                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  1143             20  PI-689-DATA-SOURCE
  1144                                 PIC  X(01).
  1145                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  1146                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  1147                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  1148                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  1149                 88  PI-689-SRC-CHECKS         VALUE '5'.
  1150             20  PI-689-ERROR-IND
  1151                                 PIC  X(01).
  1152                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  1153             20  PI-689-ERROR    PIC  9(04).
  1154                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  1155                 88  PI-689-FATAL-ERROR
  1156                     VALUES 0004 0006 0008 0013 0023 0029 0033
  1157                            0042 0047 0051 0066 0067 0070
  1158                            0168 0169 0174 0175 0176 0177 0179
  1159                            0180 0181 0182 0184 0185 0189 0190
  1160                            0191
  1161                            0215 0279 0280
  1162                            0412 0413 0454
  1163                            0533 0537
  1164                            2055 2114 2208 2209 2216 2232 2369
  1165                            2398 2433 2908 2999
  1166                            3000 3770 3771 3775
  1167                            7250 7365 7367 7368 7369 7370 7371
  1168                            7272 7373 7374 7376 7377 7378 7379
  1169                            7381 7388 7390 7393 7395 7396 7398
  1170                            9095 9096 9281 9298 9299 9320 9327
  1171                            9426 9427.
  1172                 88  PI-689-STOP-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  23
* EL689.cbl
  1173                     VALUES 0004 0008 0013 0023 0029 0033
  1174                            0042 0047 0066 0067 0070
  1175                            0168 0169 0174 0175 0176 0177
  1176                            0181 0182 0184 0185 0189 0190
  1177                            0279 0280
  1178                            0412 0413 0454
  1179                            2055 2208 2209 2216 2232
  1180                            2398 2999
  1181                            3000 3770 3771 3775
  1182                            7250 7365 7369 7370 7371
  1183                            7272 7373 7374 7376 7377 7378 7379
  1184                            7381 7388 7390 7393 7396 7398
  1185                            9095 9096 9299 9320 9426.
  1186             20  PI-689-FOLLOW-UP-DATE
  1187                                 PIC  X(02).
  1188             20  PI-689-FORM-NUMBER
  1189                                 PIC  X(04).
  1190             20  PI-689-LABEL-SOURCE
  1191                                 PIC X(01).
  1192                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1193                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1194                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1195                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1196                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1197                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1198                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1199             20  PI-689-NUMBER-COPIES
  1200                                 PIC  9(01).
  1201             20  PI-689-NUMBER-LABEL-LINES
  1202                                 PIC  9(01).
  1203             20  PI-689-NUMBER-TEXT-RECORDS
  1204                                 PIC  9(03).
  1205             20  PI-689-PRINT-ORDER-SW
  1206                                 PIC  X(01).
  1207                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1208                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1209                 88  PI-689-PRINT-LATER     VALUE '3'.
  1210                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1211             20  PI-689-PRINT-RESTRICTION
  1212                                 PIC  X(01).
  1213                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1214                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1215                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1216             20  PI-689-PRINT-SW PIC  X(01).
  1217                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1218             20  PI-689-RESEND-DATE-1
  1219                                 PIC  X(02).
  1220             20  PI-689-RESEND-LETR-1
  1221                                 PIC X(4).
  1222             20  PI-689-TEMP-STOR-ID
  1223                                 PIC  X(08).
  1224             20  PI-689-USE-SCREEN-IND
  1225                                 PIC  X(01).
  1226                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1227             20  PI-689-ARCH-POINTER
  1228                                 PIC S9(08) COMP.
  1229                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  1230             20  PI-689-ARCT-POINTER
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  24
* EL689.cbl
  1231                                 PIC S9(08) COMP.
  1232                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1233             20  PI-689-VARIABLE-DATA-GRP.
  1234                 24  PI-689-VARIABLE-DATA-1
  1235                                 PIC  X(30).
  1236                 24  PI-689-VARIABLE-DATA-2
  1237                                 PIC  X(30).
  1238                 24  PI-689-VARIABLE-DATA-3
  1239                                 PIC  X(30).
  1240                 24  PI-689-VARIABLE-DATA-4
  1241                                 PIC  X(30).
  1242
  1243         16  PI-689-KEY-DATA-FIELDS.
  1244             20  PI-689-ACCOUNT  PIC  X(10).
  1245             20  PI-689-CARRIER  PIC  X(01).
  1246             20  PI-689-CERT-NO.
  1247                 24  PI-689-CERT-PRIME
  1248                                 PIC  X(10).
  1249                 24  PI-689-CERT-SFX
  1250                                 PIC  X(01).
  1251             20  PI-689-CHG-SEQ-NO
  1252                                 PIC S9(04)    COMP.
  1253             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1254                                 PIC  X(02).
  1255             20  PI-689-ENTRY-BATCH
  1256                                 PIC  X(06).
  1257             20  PI-689-EFF-DATE PIC  X(02).
  1258             20  PI-689-EXP-DATE PIC  X(02).
  1259             20  PI-689-GROUPING PIC  X(06).
  1260             20  PI-689-RESP-PERSON
  1261                                 PIC  X(10).
  1262             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1263             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1264                                 PIC  X(04).
  1265             20  PI-689-STATE    PIC  X(02).
  1266             20  PI-689-TYPE     PIC  X(01).
  1267             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1268             20  PI-689-ALT-SEQ-NO
  1269                                 PIC S9(04)    COMP.
  1270         16  PI-689-DATE-EDIT    PIC  X(08).
  1271         16  PI-689-FOLLOW-UP-EDIT
  1272                                 PIC  X(08).
  1273         16  PI-689-RESEND1-EDIT PIC  X(08).
  1274         16  PI-689-SEQ-EDIT     PIC  X(08).
  1275         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1276         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1277             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1278         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1279         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1280         16  PI-PROMPT-IND       PIC X(1).
  1281         16  PI-CERT-FORM-ID     PIC X(5).
  1282         16  PI-PRINT-NOW        PIC X(1).
  1283         16  PI-ENCLOSURE-CD     PIC X(3).
  1284         16  PI-CERT-REQ-IND     PIC X(1).
  1285         16  PI-ENDT-ARCH-NO     PIC 9(8).
  1286         16  PI-REASON-REQ-IND   PIC X(1).
  1287         16  FILLER              PIC X(244).
  1288*        16  FILLER                        PIC X(276).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  25
* EL689.cbl
  1289*        16  FILLER                        PIC X(280).
  1290
  1291 01  FILLER                      PIC  X(20)
  1292                                 VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  26
* EL689.cbl
  1294 01  FILLER                      PIC  X(16)
  1295                        VALUE 'MAP AREA STARTS:'.
  1296*    COPY EL689S.
  1297 01  EL689AI.
  1298     05  FILLER            PIC  X(0012).
  1299*    -------------------------------
  1300     05  RUNDTEL PIC S9(0004) COMP.
  1301     05  RUNDTEF PIC  X(0001).
  1302     05  FILLER REDEFINES RUNDTEF.
  1303         10  RUNDTEA PIC  X(0001).
  1304     05  RUNDTEI PIC  X(0008).
  1305*    -------------------------------
  1306     05  RUNTIMEL PIC S9(0004) COMP.
  1307     05  RUNTIMEF PIC  X(0001).
  1308     05  FILLER REDEFINES RUNTIMEF.
  1309         10  RUNTIMEA PIC  X(0001).
  1310     05  RUNTIMEI PIC  X(0005).
  1311*    -------------------------------
  1312     05  HOSTL PIC S9(0004) COMP.
  1313     05  HOSTF PIC  X(0001).
  1314     05  FILLER REDEFINES HOSTF.
  1315         10  HOSTA PIC  X(0001).
  1316     05  HOSTI PIC  X(0010).
  1317*    -------------------------------
  1318     05  SYSL PIC S9(0004) COMP.
  1319     05  SYSF PIC  X(0001).
  1320     05  FILLER REDEFINES SYSF.
  1321         10  SYSA PIC  X(0001).
  1322     05  SYSI PIC  X(0008).
  1323*    -------------------------------
  1324     05  COMPANYL PIC S9(0004) COMP.
  1325     05  COMPANYF PIC  X(0001).
  1326     05  FILLER REDEFINES COMPANYF.
  1327         10  COMPANYA PIC  X(0001).
  1328     05  COMPANYI PIC  X(0003).
  1329*    -------------------------------
  1330     05  USERIDL PIC S9(0004) COMP.
  1331     05  USERIDF PIC  X(0001).
  1332     05  FILLER REDEFINES USERIDF.
  1333         10  USERIDA PIC  X(0001).
  1334     05  USERIDI PIC  X(0004).
  1335*    -------------------------------
  1336     05  MAINTL PIC S9(0004) COMP.
  1337     05  MAINTF PIC  X(0001).
  1338     05  FILLER REDEFINES MAINTF.
  1339         10  MAINTA PIC  X(0001).
  1340     05  MAINTI PIC  X(0001).
  1341*    -------------------------------
  1342     05  FORML PIC S9(0004) COMP.
  1343     05  FORMF PIC  X(0001).
  1344     05  FILLER REDEFINES FORMF.
  1345         10  FORMA PIC  X(0001).
  1346     05  FORMI PIC  X(0004).
  1347*    -------------------------------
  1348     05  ARCHNUML PIC S9(0004) COMP.
  1349     05  ARCHNUMF PIC  X(0001).
  1350     05  FILLER REDEFINES ARCHNUMF.
  1351         10  ARCHNUMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  27
* EL689.cbl
  1352     05  ARCHNUMI PIC  99999999.
  1353*    -------------------------------
  1354     05  PRTNOWL PIC S9(0004) COMP.
  1355     05  PRTNOWF PIC  X(0001).
  1356     05  FILLER REDEFINES PRTNOWF.
  1357         10  PRTNOWA PIC  X(0001).
  1358     05  PRTNOWI PIC  X(0001).
  1359*    -------------------------------
  1360     05  CARRIERL PIC S9(0004) COMP.
  1361     05  CARRIERF PIC  X(0001).
  1362     05  FILLER REDEFINES CARRIERF.
  1363         10  CARRIERA PIC  X(0001).
  1364     05  CARRIERI PIC  X(0001).
  1365*    -------------------------------
  1366     05  GROUPL PIC S9(0004) COMP.
  1367     05  GROUPF PIC  X(0001).
  1368     05  FILLER REDEFINES GROUPF.
  1369         10  GROUPA PIC  X(0001).
  1370     05  GROUPI PIC  X(0006).
  1371*    -------------------------------
  1372     05  STATEL PIC S9(0004) COMP.
  1373     05  STATEF PIC  X(0001).
  1374     05  FILLER REDEFINES STATEF.
  1375         10  STATEA PIC  X(0001).
  1376     05  STATEI PIC  X(0002).
  1377*    -------------------------------
  1378     05  ACCTL PIC S9(0004) COMP.
  1379     05  ACCTF PIC  X(0001).
  1380     05  FILLER REDEFINES ACCTF.
  1381         10  ACCTA PIC  X(0001).
  1382     05  ACCTI PIC  X(0010).
  1383*    -------------------------------
  1384     05  CERTL PIC S9(0004) COMP.
  1385     05  CERTF PIC  X(0001).
  1386     05  FILLER REDEFINES CERTF.
  1387         10  CERTA PIC  X(0001).
  1388     05  CERTI PIC  X(0010).
  1389*    -------------------------------
  1390     05  SFXL PIC S9(0004) COMP.
  1391     05  SFXF PIC  X(0001).
  1392     05  FILLER REDEFINES SFXF.
  1393         10  SFXA PIC  X(0001).
  1394     05  SFXI PIC  X(0001).
  1395*    -------------------------------
  1396     05  TYPEL PIC S9(0004) COMP.
  1397     05  TYPEF PIC  X(0001).
  1398     05  FILLER REDEFINES TYPEF.
  1399         10  TYPEA PIC  X(0001).
  1400     05  TYPEI PIC  X(0001).
  1401*    -------------------------------
  1402     05  DATEL PIC S9(0004) COMP.
  1403     05  DATEF PIC  X(0001).
  1404     05  FILLER REDEFINES DATEF.
  1405         10  DATEA PIC  X(0001).
  1406     05  DATEI PIC  X(0008).
  1407*    -------------------------------
  1408     05  FOLLOWL PIC S9(0004) COMP.
  1409     05  FOLLOWF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  28
* EL689.cbl
  1410     05  FILLER REDEFINES FOLLOWF.
  1411         10  FOLLOWA PIC  X(0001).
  1412     05  FOLLOWI PIC  X(0008).
  1413*    -------------------------------
  1414     05  RESEND1L PIC S9(0004) COMP.
  1415     05  RESEND1F PIC  X(0001).
  1416     05  FILLER REDEFINES RESEND1F.
  1417         10  RESEND1A PIC  X(0001).
  1418     05  RESEND1I PIC  X(0008).
  1419*    -------------------------------
  1420     05  ENCL PIC S9(0004) COMP.
  1421     05  ENCF PIC  X(0001).
  1422     05  FILLER REDEFINES ENCF.
  1423         10  ENCA PIC  X(0001).
  1424     05  ENCI PIC  X(0003).
  1425*    -------------------------------
  1426     05  ENDARCHL PIC S9(0004) COMP.
  1427     05  ENDARCHF PIC  X(0001).
  1428     05  FILLER REDEFINES ENDARCHF.
  1429         10  ENDARCHA PIC  X(0001).
  1430     05  ENDARCHI PIC  99999999.
  1431*    -------------------------------
  1432     05  CERTIDL PIC S9(0004) COMP.
  1433     05  CERTIDF PIC  X(0001).
  1434     05  FILLER REDEFINES CERTIDF.
  1435         10  CERTIDA PIC  X(0001).
  1436     05  CERTIDI PIC  X(0005).
  1437*    -------------------------------
  1438     05  ADDRSL PIC S9(0004) COMP.
  1439     05  ADDRSF PIC  X(0001).
  1440     05  FILLER REDEFINES ADDRSF.
  1441         10  ADDRSA PIC  X(0001).
  1442     05  ADDRSI PIC  X(0001).
  1443*    -------------------------------
  1444     05  PRINTERL PIC S9(0004) COMP.
  1445     05  PRINTERF PIC  X(0001).
  1446     05  FILLER REDEFINES PRINTERF.
  1447         10  PRINTERA PIC  X(0001).
  1448     05  PRINTERI PIC  X(0004).
  1449*    -------------------------------
  1450     05  COPIESL PIC S9(0004) COMP.
  1451     05  COPIESF PIC  X(0001).
  1452     05  FILLER REDEFINES COPIESF.
  1453         10  COPIESA PIC  X(0001).
  1454     05  COPIESI PIC  X(0001).
  1455*    -------------------------------
  1456     05  DATASORL PIC S9(0004) COMP.
  1457     05  DATASORF PIC  X(0001).
  1458     05  FILLER REDEFINES DATASORF.
  1459         10  DATASORA PIC  X(0001).
  1460     05  DATASORI PIC  X(0001).
  1461*    -------------------------------
  1462     05  ADDRLBLL PIC S9(0004) COMP.
  1463     05  ADDRLBLF PIC  X(0001).
  1464     05  FILLER REDEFINES ADDRLBLF.
  1465         10  ADDRLBLA PIC  X(0001).
  1466     05  ADDRLBLI PIC  X(0001).
  1467*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  29
* EL689.cbl
  1468     05  RPERSONL PIC S9(0004) COMP.
  1469     05  RPERSONF PIC  X(0001).
  1470     05  FILLER REDEFINES RPERSONF.
  1471         10  RPERSONA PIC  X(0001).
  1472     05  RPERSONI PIC  X(0010).
  1473*    -------------------------------
  1474     05  BENTRYL PIC S9(0004) COMP.
  1475     05  BENTRYF PIC  X(0001).
  1476     05  FILLER REDEFINES BENTRYF.
  1477         10  BENTRYA PIC  X(0001).
  1478     05  BENTRYI PIC  X(0006).
  1479*    -------------------------------
  1480     05  SEQL PIC S9(0004) COMP.
  1481     05  SEQF PIC  X(0001).
  1482     05  FILLER REDEFINES SEQF.
  1483         10  SEQA PIC  X(0001).
  1484     05  SEQI PIC  X(0008).
  1485*    -------------------------------
  1486     05  BCSEQL PIC S9(0004) COMP.
  1487     05  BCSEQF PIC  X(0001).
  1488     05  FILLER REDEFINES BCSEQF.
  1489         10  BCSEQA PIC  X(0001).
  1490     05  BCSEQI PIC  X(0004).
  1491*    -------------------------------
  1492     05  L1L PIC S9(0004) COMP.
  1493     05  L1F PIC  X(0001).
  1494     05  FILLER REDEFINES L1F.
  1495         10  L1A PIC  X(0001).
  1496     05  L1I PIC  X(0003).
  1497*    -------------------------------
  1498     05  TEXT1L PIC S9(0004) COMP.
  1499     05  TEXT1F PIC  X(0001).
  1500     05  FILLER REDEFINES TEXT1F.
  1501         10  TEXT1A PIC  X(0001).
  1502     05  TEXT1I PIC  X(0070).
  1503*    -------------------------------
  1504     05  L2L PIC S9(0004) COMP.
  1505     05  L2F PIC  X(0001).
  1506     05  FILLER REDEFINES L2F.
  1507         10  L2A PIC  X(0001).
  1508     05  L2I PIC  X(0003).
  1509*    -------------------------------
  1510     05  TEXT2L PIC S9(0004) COMP.
  1511     05  TEXT2F PIC  X(0001).
  1512     05  FILLER REDEFINES TEXT2F.
  1513         10  TEXT2A PIC  X(0001).
  1514     05  TEXT2I PIC  X(0070).
  1515*    -------------------------------
  1516     05  L3L PIC S9(0004) COMP.
  1517     05  L3F PIC  X(0001).
  1518     05  FILLER REDEFINES L3F.
  1519         10  L3A PIC  X(0001).
  1520     05  L3I PIC  X(0003).
  1521*    -------------------------------
  1522     05  TEXT3L PIC S9(0004) COMP.
  1523     05  TEXT3F PIC  X(0001).
  1524     05  FILLER REDEFINES TEXT3F.
  1525         10  TEXT3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  30
* EL689.cbl
  1526     05  TEXT3I PIC  X(0070).
  1527*    -------------------------------
  1528     05  L4L PIC S9(0004) COMP.
  1529     05  L4F PIC  X(0001).
  1530     05  FILLER REDEFINES L4F.
  1531         10  L4A PIC  X(0001).
  1532     05  L4I PIC  X(0003).
  1533*    -------------------------------
  1534     05  TEXT4L PIC S9(0004) COMP.
  1535     05  TEXT4F PIC  X(0001).
  1536     05  FILLER REDEFINES TEXT4F.
  1537         10  TEXT4A PIC  X(0001).
  1538     05  TEXT4I PIC  X(0070).
  1539*    -------------------------------
  1540     05  L5L PIC S9(0004) COMP.
  1541     05  L5F PIC  X(0001).
  1542     05  FILLER REDEFINES L5F.
  1543         10  L5A PIC  X(0001).
  1544     05  L5I PIC  X(0003).
  1545*    -------------------------------
  1546     05  TEXT5L PIC S9(0004) COMP.
  1547     05  TEXT5F PIC  X(0001).
  1548     05  FILLER REDEFINES TEXT5F.
  1549         10  TEXT5A PIC  X(0001).
  1550     05  TEXT5I PIC  X(0070).
  1551*    -------------------------------
  1552     05  L6L PIC S9(0004) COMP.
  1553     05  L6F PIC  X(0001).
  1554     05  FILLER REDEFINES L6F.
  1555         10  L6A PIC  X(0001).
  1556     05  L6I PIC  X(0003).
  1557*    -------------------------------
  1558     05  TEXT6L PIC S9(0004) COMP.
  1559     05  TEXT6F PIC  X(0001).
  1560     05  FILLER REDEFINES TEXT6F.
  1561         10  TEXT6A PIC  X(0001).
  1562     05  TEXT6I PIC  X(0070).
  1563*    -------------------------------
  1564     05  L7L PIC S9(0004) COMP.
  1565     05  L7F PIC  X(0001).
  1566     05  FILLER REDEFINES L7F.
  1567         10  L7A PIC  X(0001).
  1568     05  L7I PIC  X(0003).
  1569*    -------------------------------
  1570     05  TEXT7L PIC S9(0004) COMP.
  1571     05  TEXT7F PIC  X(0001).
  1572     05  FILLER REDEFINES TEXT7F.
  1573         10  TEXT7A PIC  X(0001).
  1574     05  TEXT7I PIC  X(0070).
  1575*    -------------------------------
  1576     05  L8L PIC S9(0004) COMP.
  1577     05  L8F PIC  X(0001).
  1578     05  FILLER REDEFINES L8F.
  1579         10  L8A PIC  X(0001).
  1580     05  L8I PIC  X(0003).
  1581*    -------------------------------
  1582     05  TEXT8L PIC S9(0004) COMP.
  1583     05  TEXT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  31
* EL689.cbl
  1584     05  FILLER REDEFINES TEXT8F.
  1585         10  TEXT8A PIC  X(0001).
  1586     05  TEXT8I PIC  X(0070).
  1587*    -------------------------------
  1588     05  L9L PIC S9(0004) COMP.
  1589     05  L9F PIC  X(0001).
  1590     05  FILLER REDEFINES L9F.
  1591         10  L9A PIC  X(0001).
  1592     05  L9I PIC  X(0003).
  1593*    -------------------------------
  1594     05  TEXT9L PIC S9(0004) COMP.
  1595     05  TEXT9F PIC  X(0001).
  1596     05  FILLER REDEFINES TEXT9F.
  1597         10  TEXT9A PIC  X(0001).
  1598     05  TEXT9I PIC  X(0070).
  1599*    -------------------------------
  1600     05  L10L PIC S9(0004) COMP.
  1601     05  L10F PIC  X(0001).
  1602     05  FILLER REDEFINES L10F.
  1603         10  L10A PIC  X(0001).
  1604     05  L10I PIC  X(0003).
  1605*    -------------------------------
  1606     05  TEXT10L PIC S9(0004) COMP.
  1607     05  TEXT10F PIC  X(0001).
  1608     05  FILLER REDEFINES TEXT10F.
  1609         10  TEXT10A PIC  X(0001).
  1610     05  TEXT10I PIC  X(0070).
  1611*    -------------------------------
  1612     05  L11L PIC S9(0004) COMP.
  1613     05  L11F PIC  X(0001).
  1614     05  FILLER REDEFINES L11F.
  1615         10  L11A PIC  X(0001).
  1616     05  L11I PIC  X(0003).
  1617*    -------------------------------
  1618     05  TEXT11L PIC S9(0004) COMP.
  1619     05  TEXT11F PIC  X(0001).
  1620     05  FILLER REDEFINES TEXT11F.
  1621         10  TEXT11A PIC  X(0001).
  1622     05  TEXT11I PIC  X(0070).
  1623*    -------------------------------
  1624     05  L12L PIC S9(0004) COMP.
  1625     05  L12F PIC  X(0001).
  1626     05  FILLER REDEFINES L12F.
  1627         10  L12A PIC  X(0001).
  1628     05  L12I PIC  X(0003).
  1629*    -------------------------------
  1630     05  TEXT12L PIC S9(0004) COMP.
  1631     05  TEXT12F PIC  X(0001).
  1632     05  FILLER REDEFINES TEXT12F.
  1633         10  TEXT12A PIC  X(0001).
  1634     05  TEXT12I PIC  X(0070).
  1635*    -------------------------------
  1636     05  ERRMSGL PIC S9(0004) COMP.
  1637     05  ERRMSGF PIC  X(0001).
  1638     05  FILLER REDEFINES ERRMSGF.
  1639         10  ERRMSGA PIC  X(0001).
  1640     05  ERRMSGI PIC  X(0079).
  1641*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  32
* EL689.cbl
  1642     05  ENTERPFL PIC S9(0004) COMP.
  1643     05  ENTERPFF PIC  X(0001).
  1644     05  FILLER REDEFINES ENTERPFF.
  1645         10  ENTERPFA PIC  X(0001).
  1646     05  ENTERPFI PIC  99.
  1647*    -------------------------------
  1648     05  PF8HDL PIC S9(0004) COMP.
  1649     05  PF8HDF PIC  X(0001).
  1650     05  FILLER REDEFINES PF8HDF.
  1651         10  PF8HDA PIC  X(0001).
  1652     05  PF8HDI PIC  X(0022).
  1653 01  EL689AO REDEFINES EL689AI.
  1654     05  FILLER            PIC  X(0012).
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
  1657     05  RUNDTEO PIC  X(0008).
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  RUNTIMEO PIC  99.99.
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
  1663     05  HOSTO PIC  X(0010).
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  SYSO PIC  X(0008).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  COMPANYO PIC  X(0003).
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  USERIDO PIC  X(0004).
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  MAINTO PIC  X(0001).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  FORMO PIC  X(0004).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  ARCHNUMO PIC  99999999.
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  PRTNOWO PIC  X(0001).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  CARRIERO PIC  X(0001).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  GROUPO PIC  X(0006).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  STATEO PIC  X(0002).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  ACCTO PIC  X(0010).
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  CERTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  33
* EL689.cbl
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  SFXO PIC  X(0001).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  TYPEO PIC  X(0001).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  DATEO PIC  X(0008).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  FOLLOWO PIC  X(0008).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  RESEND1O PIC  X(0008).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  ENCO PIC  X(0003).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  ENDARCHO PIC  99999999.
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  CERTIDO PIC  X(0005).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  ADDRSO PIC  X(0001).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  PRINTERO PIC  X(0004).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  COPIESO PIC  X(0001).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  DATASORO PIC  X(0001).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  ADDRLBLO PIC  X(0001).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  RPERSONO PIC  X(0010).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  BENTRYO PIC  X(0006).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  SEQO PIC  X(0008).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  BCSEQO PIC  X(0004).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  L1O PIC  X(0003).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  TEXT1O PIC  X(0070).
  1757*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  34
* EL689.cbl
  1758     05  FILLER            PIC  X(0003).
  1759     05  L2O PIC  X(0003).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  TEXT2O PIC  X(0070).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  L3O PIC  X(0003).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  TEXT3O PIC  X(0070).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  L4O PIC  X(0003).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  TEXT4O PIC  X(0070).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  L5O PIC  X(0003).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  TEXT5O PIC  X(0070).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  L6O PIC  X(0003).
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  TEXT6O PIC  X(0070).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
  1789     05  L7O PIC  X(0003).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  TEXT7O PIC  X(0070).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  L8O PIC  X(0003).
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  TEXT8O PIC  X(0070).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  L9O PIC  X(0003).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  TEXT9O PIC  X(0070).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  L10O PIC  X(0003).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  TEXT10O PIC  X(0070).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  L11O PIC  X(0003).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  35
* EL689.cbl
  1816     05  TEXT11O PIC  X(0070).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  L12O PIC  X(0003).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  TEXT12O PIC  X(0070).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  ERRMSGO PIC  X(0079).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  ENTERPFO PIC  X(0002).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  PF8HDO PIC  X(0022).
  1832*    -------------------------------
  1833 01  W-MAP-REDEF REDEFINES EL689AI.
  1834*    12  FILLER                  PIC X(218).
  1835     12  FILLER                  PIC X(267).
  1836     12  EL689RI.
  1837         16  W-TEXT-LINES OCCURS 12 TIMES INDEXED BY W-SC-NDX.
  1838             20  W-SC-LINEL      PIC S9(04) COMP.
  1839             20  W-SC-LINEA      PIC  X(01).
  1840             20  W-SC-LINE       PIC  X(03).
  1841             20  W-SC-TEXTL      PIC S9(04) COMP.
  1842             20  W-SC-TEXTA      PIC  X(01).
  1843             20  W-SC-TEXT       PIC  X(70).
  1844*    12  FILLER                  PIC  X(87).
  1845     12  FILLER                  PIC  X(112).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  36
* EL689.cbl
  1847 01  W-CONSTANT-AREA.
  1848     12  FILLER                  PIC  X(18)
  1849                                 VALUE 'PROGRAM CONSTANTS:'.
  1850     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
  1851     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
  1852     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
  1853     12  W-ENDT-LENGTH           PIC S9(04)  COMP  VALUE +579.
  1854     12  W-NOTE-LENGTH           PIC S9(04)  COMP  VALUE +825.
  1855     12  W-EOBC-LENGTH           PIC S9(04)  COMP  VALUE +350.
  1856     12  W-ENCC-LENGTH           PIC S9(04)  COMP  VALUE +400.
  1857     12  W-MAX-LINES             PIC S9(03) VALUE +300 COMP-3.
  1858     12  W-NUM-LINES-PER-SCREEN  PIC  9(02)        VALUE 12.
  1859     12  W-TS-NUM-REC-IN-GROUP   PIC  9(02)        VALUE 50.
  1860     12  W-TS-LENGTH             PIC S9(04)  COMP  VALUE +3650.
  1861     12  W-TS-MAP-LENGTH         PIC S9(04)  COMP  VALUE +1260.
  1862     12  W-ZEROS                 PIC S9(03) VALUE +000 COMP-3.
  1863
  1864     12  W-ACCT-FILE-ID          PIC  X(08) VALUE 'ERACCT'.
  1865     12  W-ACCT2-FILE-ID         PIC  X(08) VALUE 'ERACCT2'.
  1866     12  W-ARCH-FILE-ID          PIC  X(08) VALUE 'ERARCH'.
  1867     12  W-ARCH2-FILE-ID         PIC  X(08) VALUE 'ERARCH2'.
  1868     12  W-ARCH3-FILE-ID         PIC  X(08) VALUE 'ERARCH3'.
  1869     12  W-ARCH4-FILE-ID         PIC  X(08) VALUE 'ERARCH4'.
  1870     12  W-ARCH5-FILE-ID         PIC  X(08) VALUE 'ERARCH5'.
  1871     12  W-ARCT-FILE-ID          PIC  X(08) VALUE 'ERARCT'.
  1872     12  W-CERT-FILE-ID          PIC  X(08) VALUE 'ELCERT'.
  1873     12  W-CHEK-FILE-ID          PIC  X(08) VALUE 'ERCHEK'.
  1874     12  W-CNTL-FILE-ID          PIC  X(08) VALUE 'ELCNTL'.
  1875     12  W-COMP-FILE-ID          PIC  X(08) VALUE 'ERCOMP'.
  1876     12  W-NOTE-FILE-ID          PIC  X(08) VALUE 'ERNOTE'.
  1877     12  W-EOBC-FILE-ID          PIC  X(08) VALUE 'ELEOBC'.
  1878     12  W-ENCC-FILE-ID          PIC  X(08) VALUE 'ELENCC'.
  1879     12  W-GETMAIN-SPACE         PIC  X(01) VALUE SPACE.
  1880     12  W-LGXX-ID               PIC  X(04) VALUE 'LGXX'.
  1881     12  W-LINK-001              PIC  X(05) VALUE 'EL001'.
  1882     12  W-LINK-004              PIC  X(05) VALUE 'EL004'.
  1883     12  W-LINK-ELDATCV          PIC  X(07) VALUE 'ELDATCV'.
  1884     12  W-LOWER-CASE            PIC  X(26)
  1885         VALUE 'abcdefghijklmnopqrstuvwxyz'.
  1886     12  W-MAIL-FILE-ID          PIC  X(08) VALUE 'ERMAIL'.
  1887     12  W-MAP.
  1888         16  W-MAP-PREFIX        PIC  X(02) VALUE 'EL'.
  1889         16  W-MAP-NUM           PIC  X(04) VALUE '689A'.
  1890         16  W-MAP-FILLER        PIC  X(02) VALUE SPACES.
  1891     12  W-MAPSET                PIC  X(08) VALUE 'EL689S'.
  1892     12  W-PGM-EL1042            PIC  X(08) VALUE 'EL1042'.
  1893     12  W-PGM-EL690             PIC  X(08) VALUE 'EL690'.
  1894     12  W-PGM-EL626             PIC  X(08) VALUE 'EL626'.
  1895     12  W-PNDB-FILE-ID          PIC  X(08) VALUE 'ERPNDB'.
  1896     12  W-PRINT-TRANS           PIC  X(04) VALUE 'EXH5'.
  1897     12  W-PYAJ-FILE-ID          PIC  X(08) VALUE 'ERPYAJ'.
  1898
  1899     12  W-TEXT-FILE-ID          PIC  X(08) VALUE 'ELLETR'.
  1900     12  W-THIS-PGM              PIC  X(08) VALUE 'EL689'.
  1901     12  W-TOP-FORM              PIC  X(70)
  1902                              VALUE '*****TOP OF FORM *****'.
  1903     12  W-TRANSACTION           PIC  X(04) VALUE 'EXH3'.
  1904     12  W-UPPER-CASE            PIC  X(26)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  37
* EL689.cbl
  1905         VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
  1906     12  W-XCTL-005              PIC  X(05) VALUE 'EL005'.
  1907     12  W-XCTL-010              PIC  X(05) VALUE 'EL010'.
  1908     12  W-XCTL-626              PIC  X(05) VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  38
* EL689.cbl
  1910 01  W-VARIABLE-PROCESS-CNTLS.
  1911     12  FILLER                  PIC  X(26)
  1912                        VALUE 'VARIABLE WORK AREA STARTS:'.
  1913     12  W-NUM-OF-VARIABLES      PIC S9(03) VALUE +189 COMP-3.
  1914     12  W-VAR-HOLD.
  1915         16  W-V1                PIC  X(01).
  1916         16  W-V2                PIC  X(01).
  1917         16  W-V3                PIC  X(01).
  1918     12  FILLER REDEFINES W-VAR-HOLD.
  1919         16  W-VAR-RELATIVE-NUM  PIC  9(03).
  1920     12  W-FIELD-SQUEEZE-IND     PIC  X(01).
  1921         88  W-SQUEEZE-FIELD          VALUE '#'.
  1922
  1923 01  W-SUPPORTED-VARIABLES.
  1924
  1925*****************COMPANY VARIABLES - ELCNTL ********************
  1926*****COMPANY NAME
  1927     12  FILLER                  PIC  X(03) VALUE '001'.
  1928     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1929     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1930     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1931     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1932
  1933*****FULL COMPANY ADDRESS
  1934     12  FILLER                  PIC  X(03) VALUE '002'.
  1935     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1936     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1937     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1938     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1939
  1940     12  FILLER                  PIC  X(03) VALUE '003'.
  1941     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1942     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1943     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1944     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1945
  1946     12  FILLER                  PIC  X(03) VALUE '004'.
  1947     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1948     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1949     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1950     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1951
  1952     12  FILLER                  PIC  X(03) VALUE '005'.
  1953     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1954     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1955     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1956     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1957
  1958     12  FILLER                  PIC  X(03) VALUE '006'.
  1959     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1960     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1961     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1962     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1963
  1964*****REMAINING 4 ARE NOT CURRENTLY USED
  1965     12  FILLER                  PIC  X(03) VALUE '007'.
  1966     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1967     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  39
* EL689.cbl
  1968     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1969     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1970
  1971     12  FILLER                  PIC  X(03) VALUE '008'.
  1972     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1973     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1974     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1975     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1976
  1977     12  FILLER                  PIC  X(03) VALUE '009'.
  1978     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1979     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1980     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1981     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1982
  1983     12  FILLER                  PIC  X(03) VALUE '010'.
  1984     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1985     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1986     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1987     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1988
  1989************ LIFE BENEFIT VARIABLES - ELCNTL *******************
  1990*****LIFE BENEFIT DESCRIPTION
  1991     12  FILLER                  PIC  X(03) VALUE '011'.
  1992     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1993     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1994     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1995     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1996
  1997*****REMAINING 3 ARE NOT CURRENTLY USED
  1998     12  FILLER                  PIC  X(03) VALUE '012'.
  1999     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2000     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2001     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2002     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2003
  2004     12  FILLER                  PIC  X(03) VALUE '013'.
  2005     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2006     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2007     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2008     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2009
  2010     12  FILLER                  PIC  X(03) VALUE '014'.
  2011     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2012     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2013     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2014     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2015
  2016************* A&H BENEFIT VARIABLES - ELCNTL *******************
  2017*****AH BENEFIT DESCRIPTION
  2018     12  FILLER                  PIC  X(03) VALUE '015'.
  2019     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2020     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2021     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2022     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2023
  2024*****ELIMINATION PERIOD
  2025     12  FILLER                  PIC  X(03) VALUE '016'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  40
* EL689.cbl
  2026     12  FILLER                  PIC S9(04) COMP VALUE +2.
  2027     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2028     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2029     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2030
  2031*****REMAINING 3 ARE NOT CURRENTLY USED
  2032     12  FILLER                  PIC  X(03) VALUE '017'.
  2033     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2034     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2035     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2036     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2037
  2038     12  FILLER                  PIC  X(03) VALUE '018'.
  2039     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2040     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2041     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2042     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2043
  2044     12  FILLER                  PIC  X(03) VALUE '019'.
  2045     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2046     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2047     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2048     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2049
  2050*****************CARRIER VARIABLES - ELCNTL ********************
  2051*****CARRIER NAME
  2052     12  FILLER                  PIC  X(03) VALUE '020'.
  2053     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2054     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2055     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2056     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2057
  2058*****FULL CARRIER ADDRESS
  2059     12  FILLER                  PIC  X(03) VALUE '021'.
  2060     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2061     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2062     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2063     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2064
  2065     12  FILLER                  PIC  X(03) VALUE '022'.
  2066     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2067     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2068     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2069     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2070
  2071     12  FILLER                  PIC  X(03) VALUE '023'.
  2072     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2073     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2074     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2075     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2076
  2077     12  FILLER                  PIC  X(03) VALUE '024'.
  2078     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2079     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2080     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2081     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2082
  2083     12  FILLER                  PIC  X(03) VALUE '025'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  41
* EL689.cbl
  2084     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2085     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2086     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2087     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2088
  2089*****CARRIER PHONE NUMBER
  2090     12  FILLER                  PIC  X(03) VALUE '026'.
  2091     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2092     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2093     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2094     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2095
  2096*****REMAINING 4 ARE NOT CURRENTLY USED
  2097     12  FILLER                  PIC  X(03) VALUE '027'.
  2098     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2099     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2100     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2101     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2102
  2103     12  FILLER                  PIC  X(03) VALUE '028'.
  2104     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2105     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2106     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2107     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2108
  2109     12  FILLER                  PIC  X(03) VALUE '029'.
  2110     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2111     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2112     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2113     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2114
  2115     12  FILLER                  PIC  X(03) VALUE '030'.
  2116     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2117     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2118     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2119     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2120
  2121***************** MAIL VARIABLES - ELMAIL **********************
  2122*****FULL MAIL ADDRESS
  2123     12  FILLER                  PIC  X(03) VALUE '031'.
  2124     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2125     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2126     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2127     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2128
  2129     12  FILLER                  PIC  X(03) VALUE '032'.
  2130     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2131     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2132     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2133     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2134
  2135     12  FILLER                  PIC  X(03) VALUE '033'.
  2136     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2137     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2138     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2139     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2140
  2141     12  FILLER                  PIC  X(03) VALUE '034'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  42
* EL689.cbl
  2142     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2143     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2144     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2145     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2146
  2147     12  FILLER                  PIC  X(03) VALUE '035'.
  2148     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2149     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2150     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2151     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2152
  2153     12  FILLER                  PIC  X(03) VALUE '036'.
  2154     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2155     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2156     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2157     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2158**** CRED BENE NAME FROM ERMAIL
  2159     12  FILLER                  PIC  X(03) VALUE '037'.
  2160     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2161     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2162     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2163     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2164*****REMAINING 2 ARE NOT CURRENTLY USED
  2165     12  FILLER                  PIC  X(03) VALUE '038'.
  2166     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2167     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2168     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2169     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2170
  2171     12  FILLER                  PIC  X(03) VALUE '039'.
  2172     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2173     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2174     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2175     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2176
  2177*************** ACCOUNT VARIABLES - ERACCT *********************
  2178*****ACCOUNT NAME
  2179     12  FILLER                  PIC  X(03) VALUE '040'.
  2180     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2181     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2182     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2183     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2184
  2185*****FULL ACCOUNT ADDRESS
  2186     12  FILLER                  PIC  X(03) VALUE '041'.
  2187     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2188     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2189     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2190     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2191
  2192     12  FILLER                  PIC  X(03) VALUE '042'.
  2193     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2194     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2195     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2196     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2197
  2198     12  FILLER                  PIC  X(03) VALUE '043'.
  2199     12  FILLER                  PIC S9(04) COMP VALUE +30.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  43
* EL689.cbl
  2200     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2201     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2202     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2203
  2204     12  FILLER                  PIC  X(03) VALUE '044'.
  2205     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2206     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2207     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2208     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2209
  2210     12  FILLER                  PIC  X(03) VALUE '045'.
  2211     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2212     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2213     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2214     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2215
  2216*****ACCOUNT PHONE NUMBER
  2217     12  FILLER                  PIC  X(03) VALUE '046'.
  2218     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2219     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2220     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2221     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2222
  2223*****ACCOUNT CONTROL NAME AM-CONTROL-NAME
  2224     12  FILLER                  PIC  X(03) VALUE '047'.
  2225     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2226     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2227     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2228     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2229
  2230****ACCOUNT CSR CODE
  2231     12  FILLER                  PIC  X(03) VALUE '048'.
  2232     12  FILLER                  PIC S9(04) COMP VALUE +4..
  2233     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2234     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2235     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2236****ACCOUNT ACCOUNT NUMBER
  2237     12  FILLER                  PIC  X(03) VALUE '049'.
  2238     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2239     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2240     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2241     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2242
  2243**** CRED BENE ADDRESS LINE 1 ERMAIL
  2244     12  FILLER                  PIC  X(03) VALUE '050'.
  2245     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2246     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2247     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2248     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2249
  2250**** CRED BENE ADDRESS LINE 2 ERMAIL
  2251     12  FILLER                  PIC  X(03) VALUE '051'.
  2252     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2253     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2254     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2255     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2256
  2257**** CRED BENE CITY STATE   ERMAIL
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  44
* EL689.cbl
  2258     12  FILLER                  PIC  X(03) VALUE '052'.
  2259     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2260     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2261     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2262     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2263
  2264**** CRED BENE ZIP  1 ERMAIL
  2265     12  FILLER                  PIC  X(03) VALUE '053'.
  2266     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2267     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2268     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2269     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2270
  2271*****REMAINING 6 ARE NOT CURRENTLY USED
  2272     12  FILLER                  PIC  X(03) VALUE '054'.
  2273     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2274     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2275     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2276     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2277
  2278     12  FILLER                  PIC  X(03) VALUE '055'.
  2279     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2280     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2281     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2282     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2283
  2284     12  FILLER                  PIC  X(03) VALUE '056'.
  2285     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2286     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2287     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2288     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2289
  2290     12  FILLER                  PIC  X(03) VALUE '057'.
  2291     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2292     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2293     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2294     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2295
  2296     12  FILLER                  PIC  X(03) VALUE '058'.
  2297     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2298     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2299     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2300     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2301
  2302     12  FILLER                  PIC  X(03) VALUE '059'.
  2303     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2304     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2305     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2306     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2307
  2308*************** NON FILE VARIABLES *****************************
  2309*****CURRENT DATE
  2310     12  FILLER                  PIC  X(03) VALUE '060'.
  2311     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2312     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2313     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2314     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2315
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  45
* EL689.cbl
  2316*****FULL CURRENT DATE
  2317     12  FILLER                  PIC  X(03) VALUE '061'.
  2318     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2319     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2320     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2321     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2322
  2323*****FORM
  2324     12  FILLER                  PIC  X(03) VALUE '062'.
  2325     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2326     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2327     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2328     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2329
  2330*****VARIABLE 1
  2331     12  FILLER                  PIC  X(03) VALUE '063'.
  2332     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2333     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2334     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2335     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2336
  2337*****VARIABLE 2
  2338     12  FILLER                  PIC  X(03) VALUE '064'.
  2339     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2340     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2341     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2342     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2343
  2344*****VARIABLE 3
  2345     12  FILLER                  PIC  X(03) VALUE '065'.
  2346     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2347     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2348     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2349     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2350
  2351*****VARIABLE 4
  2352     12  FILLER                  PIC  X(03) VALUE '066'.
  2353     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2354     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2355     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2356     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2357
  2358*****REMAINING 3 ARE NOT CURRENTLY USED
  2359     12  FILLER                  PIC  X(03) VALUE '067'.
  2360     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2361     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2362     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2363     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2364
  2365     12  FILLER                  PIC  X(03) VALUE '068'.
  2366     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2367     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2368     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2369     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2370
  2371     12  FILLER                  PIC  X(03) VALUE '069'.
  2372     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2373     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  46
* EL689.cbl
  2374     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2375     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2376
  2377************** CERTIFICATE VARIABLES - ELCERT *****************
  2378*****CARRIER CODE IN CERT
  2379     12  FILLER                  PIC  X(03) VALUE '070'.
  2380     12  FILLER                  PIC S9(04) COMP VALUE +1.
  2381     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2382     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2383     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2384
  2385*****GROUPING CODE IN CERT
  2386     12  FILLER                  PIC  X(03) VALUE '071'.
  2387     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2388     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2389     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2390     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2391
  2392*****ACCOUNT NUMBER IN CERT
  2393     12  FILLER                  PIC  X(03) VALUE '072'.
  2394     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2395     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2396     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2397     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2398
  2399*****CERTIFICATE NUMBER
  2400     12  FILLER                  PIC  X(03) VALUE '073'.
  2401     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2402     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2403     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2404     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2405
  2406*****CERT EFFECTIVE DATE
  2407     12  FILLER                  PIC  X(03) VALUE '074'.
  2408     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2409     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2410     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2411     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2412
  2413*****CERT EXPIRATION DATE (LIFE)
  2414     12  FILLER                  PIC  X(03) VALUE '075'.
  2415     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2416     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2417     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2418     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2419
  2420*****CERT EXPIRATION DATE (AH)
  2421     12  FILLER                  PIC  X(03) VALUE '076'.
  2422     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2423     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2424     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2425     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2426
  2427*****LIFE TERM
  2428     12  FILLER                  PIC  X(03) VALUE '077'.
  2429     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2430     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2431     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  47
* EL689.cbl
  2432     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2433
  2434*****AH  TERM
  2435     12  FILLER                  PIC  X(03) VALUE '078'.
  2436     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2437     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2438     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2439     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2440
  2441*****LIFE COVERAGE AMOUNT
  2442     12  FILLER                  PIC  X(03) VALUE '079'.
  2443     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2444     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2445     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2446     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2447
  2448*****AH MONTHLY BENEFIT
  2449     12  FILLER                  PIC  X(03) VALUE '080'.
  2450     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2451     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2452     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2453     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2454
  2455*****LIFE CANCEL DATE
  2456     12  FILLER                  PIC  X(03) VALUE '081'.
  2457     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2458     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2459     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2460     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2461
  2462*****AH CANCEL DATE
  2463     12  FILLER                  PIC  X(03) VALUE '082'.
  2464     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2465     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2466     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2467     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2468
  2469*****LIFE COVERAGE FORM NUMBER
  2470     12  FILLER                  PIC  X(03) VALUE '083'.
  2471     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2472     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2473     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2474     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2475
  2476*****UNUSED
  2477     12  FILLER                  PIC  X(03) VALUE '084'.
  2478     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2479     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2480     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2481     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2482
  2483*****INSUREDS AGE AT POLICY ISSUE (NOT USED)
  2484     12  FILLER                  PIC  X(03) VALUE '085'.
  2485     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2486     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2487     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2488     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2489
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  48
* EL689.cbl
  2490*****LOAN NUMBER
  2491     12  FILLER                  PIC  X(03) VALUE '086'.
  2492     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2493     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2494     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2495     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2496
  2497*****LOAN BALANCE
  2498     12  FILLER                  PIC  X(03) VALUE '087'.
  2499     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2500     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2501     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2502     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2503
  2504*****MEMBER NUMBER
  2505     12  FILLER                  PIC  X(03) VALUE '088'.
  2506     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2507     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2508     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2509     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2510
  2511*****INSURED SOC SEC NUMBER
  2512     12  FILLER                  PIC  X(03) VALUE '089'.
  2513     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2514     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2515     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2516     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2517
  2518*****INSURED INITIALS & LAST NAME (CERTIFICATE)
  2519     12  FILLER                  PIC  X(03) VALUE '090'.
  2520     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2521     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2522     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2523     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2524
  2525*****INSURED FIRST NAME (CERTIFICATE)
  2526     12  FILLER                  PIC  X(03) VALUE '091'.
  2527     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2528     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2529     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2530     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2531
  2532*****INSURED MIDDLE INITIAL (CERTIFICATE)
  2533     12  FILLER                  PIC  X(03) VALUE '092'.
  2534     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2535     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2536     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2537     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2538
  2539*****ORIG TERM * MON BEN
  2540     12  FILLER                  PIC  X(03) VALUE '093'.
  2541     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2542     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2543     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2544     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2545
  2546*****INSURED'S NAME (LAST, FIRST, INIT)
  2547     12  FILLER                  PIC  X(03) VALUE '094'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  49
* EL689.cbl
  2548     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2549     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2550     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2551     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2552
  2553*****INSURED'S NAME (FIRST, INIT, LAST)
  2554     12  FILLER                  PIC  X(03) VALUE  '095'.
  2555     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2556     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2557     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2558     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2559
  2560*****TITLE (MR/MS)
  2561     12  FILLER                  PIC  X(03) VALUE '096'.
  2562     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2563     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2564     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2565     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2566
  2567*****LIFE PREMIUM (CERTIFICATE)
  2568     12  FILLER                  PIC  X(03) VALUE '097'.
  2569     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2570     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2571     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2572     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2573
  2574*****A/H PREMIUM (CERTIFICATE)
  2575     12  FILLER                  PIC  X(03) VALUE '098'.
  2576     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2577     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2578     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2579     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2580
  2581*****JOINT'S INITIALS & LAST NAME (CERTIFICATE)
  2582     12  FILLER                  PIC  X(03) VALUE '099'.
  2583     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2584     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2585     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2586     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2587
  2588*****JOINT'S FIRST NAME (CERTIFICATE)
  2589     12  FILLER                  PIC  X(03) VALUE '100'.
  2590     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2591     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2592     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2593     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2594
  2595*****JOINT'S MIDDLE INITIAL (CERTIFICATE)
  2596     12  FILLER                  PIC  X(03) VALUE '101'.
  2597     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2598     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2599     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2600     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2601
  2602*****JOINT'S NAME (LAST, FIRST, INIT)
  2603     12  FILLER                  PIC  X(03) VALUE '102'.
  2604     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2605     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  50
* EL689.cbl
  2606     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2607     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2608
  2609*****JOINT'S NAME (FIRST, INIT, LAST)
  2610     12  FILLER                  PIC  X(03) VALUE '103'.
  2611     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2612     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2613     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2614     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2615
  2616*****INSURED'S FIRST AND LAST NAME
  2617     12  FILLER                  PIC  X(03) VALUE '104'.
  2618     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2619     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2620     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2621     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2622
  2623*****JOINT'S FIRST AND LAST NAME
  2624     12  FILLER                  PIC  X(03) VALUE '105'.
  2625     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2626     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2627     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2628     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2629
  2630*****ENTERED LIFE REFUND (CERT)
  2631     12  FILLER                  PIC  X(03) VALUE '106'.
  2632     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2633     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2634     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2635     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2636
  2637*****ENTERED A/H REFUND (CERT)
  2638     12  FILLER                  PIC  X(03) VALUE '107'.
  2639     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2640     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2641     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2642     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2643
  2644*****INSURED'S LAST NAME
  2645     12  FILLER                  PIC  X(03) VALUE '108'.
  2646     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2647     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2648     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2649     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2650
  2651*****BENEFICIARY
  2652     12  FILLER                  PIC  X(03) VALUE  '109'.
  2653     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2654     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2655     12  FILLER                  PIC  X(01) VALUE 'Y'.
  2656     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2657
  2658************** PENDING VARIABLES - ERPNDB *********************
  2659*****INSURED DATE OF BIRTH
  2660     12  FILLER                  PIC  X(03) VALUE '110'.
  2661     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2662     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2663     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  51
* EL689.cbl
  2664     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2665
  2666*****ENTERED LIFE PREMIUM (PENDING)
  2667     12  FILLER                  PIC  X(03) VALUE '111'.
  2668     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2669     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2670     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2671     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2672
  2673*****ENTERED A/H PREMIUM (PENDING)
  2674     12  FILLER                  PIC  X(03) VALUE '112'.
  2675     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2676     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2677     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2678     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2679
  2680*****CALCULATED LIFE PREMIUM (PENDING)
  2681     12  FILLER                  PIC  X(03) VALUE '113'.
  2682     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2683     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2684     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2685     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2686
  2687*****CALCULATED A/H PREMIUM (PENDING)
  2688     12  FILLER                  PIC  X(03) VALUE '114'.
  2689     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2690     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2691     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2692     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2693
  2694*****DIFFERENCE ENTER/COMPUTED LIFE PREMIUM (PENDING)
  2695     12  FILLER                  PIC  X(03) VALUE '115'.
  2696     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2697     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2698     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2699     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2700
  2701*****DIFFERENCE ENTER/COMPUTED A/H PREMIUM (PENDING)
  2702     12  FILLER                  PIC  X(03) VALUE '116'.
  2703     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2704     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2705     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2706     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2707
  2708*****PRIOR CANCEL DATE
  2709     12  FILLER                  PIC  X(03) VALUE '117'.
  2710     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2711     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2712     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2713     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2714
  2715*****ENTERED LIFE REFUND (PENDING)
  2716     12  FILLER                  PIC  X(03) VALUE '118'.
  2717     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2718     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2719     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2720     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2721
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  52
* EL689.cbl
  2722*****ENTERED A/H REFUND (PENDING)
  2723     12  FILLER                  PIC  X(03) VALUE '119'.
  2724     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2725     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2726     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2727     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2728
  2729*****CALCULATED LIFE REFUND (PENDING)
  2730     12  FILLER                  PIC  X(03) VALUE '120'.
  2731     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2732     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2733     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2734     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2735
  2736*****CALCULATED A/H REFUND (PENDING)
  2737     12  FILLER                  PIC  X(03) VALUE '121'.
  2738     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2739     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2740     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2741     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2742
  2743*****DIFFERENCE ENTER/COMPUTED LIFE REFUND (PENDING)
  2744     12  FILLER                  PIC  X(03) VALUE '122'.
  2745     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2746     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2747     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2748     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2749
  2750*****DIFFERENCE ENTER/COMPUTED A/H REFUND (PENDING)
  2751     12  FILLER                  PIC  X(03) VALUE '123'.
  2752     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2753     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2754     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2755     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2756
  2757*****INSUREDS AGE
  2758     12  FILLER                  PIC  X(03) VALUE '124'.
  2759     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2760     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2761     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2762     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2763
  2764*****LIFE BENEFIT (PENDING)
  2765     12  FILLER                  PIC  X(03) VALUE '125'.
  2766     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2767     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2768     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2769     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2770
  2771*****A/H BENEFIT (PENDING)
  2772     12  FILLER                  PIC  X(03) VALUE '126'.
  2773     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2774     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2775     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2776     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2777
  2778*****LIFE RATE
  2779     12  FILLER                  PIC  X(03) VALUE '127'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  53
* EL689.cbl
  2780     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2781     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2782     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2783     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2784
  2785*****A/H RATE
  2786     12  FILLER                  PIC  X(03) VALUE '128'.
  2787     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2788     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2789     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2790     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2791
  2792*****TERM (PENDING)
  2793     12  FILLER                  PIC  X(03) VALUE '129'.
  2794     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2795     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2796     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2797     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2798
  2799*****BATCH NUMBER
  2800     12  FILLER                  PIC  X(03) VALUE '130'.
  2801     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2802     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2803     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2804     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2805
  2806*****TOTAL OF LIFE AND A&H REFUND
  2807     12  FILLER                  PIC  X(03) VALUE '131'.
  2808     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2809     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2810     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2811     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2812
  2813*****NH INTEREST ON REFUNDS
  2814     12  FILLER                  PIC  X(03) VALUE '132'.
  2815     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2816     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2817     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2818     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2819*****GREATER OF THE LIFE AND AH CANCEL DATE
  2820     12  FILLER                  PIC  X(03) VALUE '133'.
  2821     12  FILLER                  PIC S9(04) COMP VALUE +8.
  2822     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2823     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2824     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2825
  2826*****THE NEXT 6 NOT CURRENTLY USED
  2827     12  FILLER                  PIC  X(03) VALUE '134'.
  2828     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2829     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2830     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2831     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2832
  2833     12  FILLER                  PIC  X(03) VALUE '135'.
  2834     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2835     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2836     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2837     12  FILLER                  PIC S9(04) COMP VALUE +09.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  54
* EL689.cbl
  2838
  2839     12  FILLER                  PIC  X(03) VALUE '136'.
  2840     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2841     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2842     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2843     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2844
  2845     12  FILLER                  PIC  X(03) VALUE '137'.
  2846     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2847     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2848     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2849     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2850
  2851     12  FILLER                  PIC  X(03) VALUE '138'.
  2852     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2853     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2854     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2855     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2856
  2857     12  FILLER                  PIC  X(03) VALUE '139'.
  2858     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2859     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2860     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2861     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2862
  2863************** COMPENSATION VARIABLES - ERCOMP ****************
  2864*****COMPENSATION ACCT NAME
  2865     12  FILLER                  PIC  X(03) VALUE '140'.
  2866     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2867     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2868     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2869     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2870
  2871*****FULL COMPENSATION ADDRESS TYPE 'A'
  2872     12  FILLER                  PIC  X(03) VALUE '141'.
  2873     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2874     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2875     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2876     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2877
  2878     12  FILLER                  PIC  X(03) VALUE '142'.
  2879     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2880     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2881     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2882     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2883
  2884     12  FILLER                  PIC  X(03) VALUE '143'.
  2885     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2886     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2887     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2888     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2889
  2890     12  FILLER                  PIC  X(03) VALUE '144'.
  2891     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2892     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2893     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2894     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2895
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  55
* EL689.cbl
  2896     12  FILLER                  PIC  X(03) VALUE '145'.
  2897     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2898     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2899     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2900     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2901
  2902     12  FILLER                  PIC  X(03) VALUE '146'.
  2903     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2904     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2905     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2906     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2907
  2908*****COMPENSATION PHONE NUMBER
  2909     12  FILLER                  PIC  X(03) VALUE '147'.
  2910     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2911     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2912     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2913     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2914
  2915*****COMPENSATION CSR NAME
  2916     12  FILLER                  PIC  X(03) VALUE '148'.
  2917     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2918     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2919     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2920     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2921
  2922*****COMPENSATION LAST STATEMENT DATE
  2923     12  FILLER                  PIC  X(03) VALUE '149'.
  2924     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2925     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2926     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2927     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2928
  2929*****COMPENSATION ENDING BALANCE
  2930     12  FILLER                  PIC  X(03) VALUE '150'.
  2931     12  FILLER                  PIC S9(04) COMP VALUE +14.
  2932     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2933     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2934     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2935
  2936******************  PROCESSOR DATA - ELCNTL (2) ****************
  2937*****EXECUTING PROCESSOR NAME
  2938     12  FILLER                  PIC  X(03) VALUE '151'.
  2939     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2940     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2941     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2942     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2943
  2944*****PROCESSOR TITLE
  2945     12  FILLER                  PIC  X(03) VALUE '152'.
  2946     12  FILLER                  PIC S9(04) COMP VALUE +26.
  2947     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2948     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2949     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2950
  2951*****PROCESSOR
  2952     12  FILLER                  PIC  X(03) VALUE '153'.
  2953     12  FILLER                  PIC S9(04) COMP VALUE +04.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  56
* EL689.cbl
  2954     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2955     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2956     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2957
  2958*****CSR TITLE
  2959     12  FILLER                  PIC  X(03) VALUE '154'.
  2960     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2961     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2962     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2963     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2964*****REMAINING 2 ARE NOT CURRENTLY USED
  2965     12  FILLER                  PIC  X(03) VALUE '155'.
  2966     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2967     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2968     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2969     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2970
  2971     12  FILLER                  PIC  X(03) VALUE '156'.
  2972     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2973     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2974     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2975     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2976
  2977******************  CHECK DATA - ERCHEK    *********************
  2978*****CHECK AMOUNT
  2979     12  FILLER                  PIC  X(03) VALUE '157'.
  2980     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2981     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2982     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2983     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2984
  2985*****CHECK NUMBER
  2986     12  FILLER                  PIC  X(03) VALUE '158'.
  2987     12  FILLER                  PIC S9(04) COMP VALUE +7.
  2988     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2989     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2990     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2991
  2992*****PAYEE 1 NAME
  2993     12  FILLER                  PIC  X(03) VALUE '159'.
  2994     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2995     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2996     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2997     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2998
  2999*****PAYEE 2 NAME
  3000     12  FILLER                  PIC  X(03) VALUE '160'.
  3001     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3002     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3003     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3004     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3005
  3006*****ADDRSS 1
  3007     12  FILLER                  PIC  X(03) VALUE '161'.
  3008     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3009     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3010     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3011     12  FILLER                  PIC S9(04) COMP VALUE +12.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  57
* EL689.cbl
  3012
  3013*****ADDRESS 2
  3014     12  FILLER                  PIC  X(03) VALUE '162'.
  3015     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3016     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3017     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3018     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3019
  3020*****PAYEE CITY STATE
  3021     12  FILLER                  PIC  X(03) VALUE '163'.
  3022     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3023     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3024     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3025     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3026
  3027*****ZIP CODE
  3028     12  FILLER                  PIC  X(03) VALUE '164'.
  3029     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3030     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3031     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3032     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3033
  3034*****CHECK CONTROL
  3035     12  FILLER                  PIC  X(03) VALUE '165'.
  3036     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3037     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3038     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3039     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3040
  3041*****REASON FOR CHECK
  3042     12  FILLER                  PIC  X(03) VALUE '166'.
  3043     12  FILLER                  PIC S9(04) COMP VALUE +25.
  3044     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3045     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3046     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3047
  3048*****REMAINING 3 ARE NOT CURRENTLY USED
  3049     12  FILLER                  PIC  X(03) VALUE '167'.
  3050     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3051     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3052     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3053     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3054
  3055     12  FILLER                  PIC  X(03) VALUE '168'.
  3056     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3057     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3058     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3059     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3060
  3061     12  FILLER                  PIC  X(03) VALUE '169'.
  3062     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3063     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3064     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3065     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3066
  3067
  3068*********** PAYMENT AND ADJUSTMENT DATA - ERPYAJ  **************
  3069*****CHECK AMOUNT - PYAJ
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  58
* EL689.cbl
  3070     12  FILLER                  PIC  X(03) VALUE '170'.
  3071     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3072     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3073     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3074     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3075
  3076*****CHECK NUMBER - PYAJ
  3077     12  FILLER                  PIC  X(03) VALUE '171'.
  3078     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3079     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3080     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3081     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3082
  3083*****CHECK CONTROL - PYAJ
  3084     12  FILLER                  PIC  X(03) VALUE '172'.
  3085     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3086     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3087     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3088     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3089
  3090***** COMMENT - PYAJ
  3091     12  FILLER                  PIC  X(03) VALUE '173'.
  3092     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3093     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3094     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3095     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3096
  3097*****NEW FIELDS.
  3098*****COMPENSATION FULL ADDRESS TYPE 'G'
  3099     12  FILLER                  PIC  X(03) VALUE '174'.
  3100     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3101     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3102     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3103     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3104
  3105     12  FILLER                  PIC  X(03) VALUE '175'.
  3106     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3107     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3108     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3109     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3110
  3111     12  FILLER                  PIC  X(03) VALUE '176'.
  3112     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3113     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3114     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3115     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3116
  3117     12  FILLER                  PIC  X(03) VALUE '177'.
  3118     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3119     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3120     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3121     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3122
  3123     12  FILLER                  PIC  X(03) VALUE '178'.
  3124     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3125     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3126     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3127     12  FILLER                  PIC S9(04) COMP VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  59
* EL689.cbl
  3128
  3129     12  FILLER                  PIC  X(03) VALUE '179'.
  3130     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3131     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3132     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3133     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3134
  3135*****COMPENSATION FINANCIAL RESPONSIBLE NO.
  3136     12  FILLER                  PIC  X(03) VALUE '180'.
  3137     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3138     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3139     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3140     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3141**** COMPENSATION BILLING SWITCH
  3142     12  FILLER                  PIC XXX    VALUE '181'.
  3143     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3144     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3145     12  FILLER                  PIC X      VALUE ALL 'N'.
  3146     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3147*****COMPENSATION FAX NUMBER
  3148     12  FILLER                  PIC  X(03) VALUE '182'.
  3149     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3150     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3151     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3152     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3153**** COMPENSATION STATUS
  3154     12  FILLER                  PIC XXX    VALUE '183'.
  3155     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3156     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3157     12  FILLER                  PIC X      VALUE ALL 'N'.
  3158     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3159***** THE VARS 184 - 189 WILL TYPICALLY BE USED FOR DCC BANKS
  3160*****COMPENSATION FULL ADDRESS TYPE 'B'
  3161     12  FILLER                  PIC  X(03) VALUE '184'.
  3162     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3163     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3164     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3165     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3166
  3167     12  FILLER                  PIC  X(03) VALUE '185'.
  3168     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3169     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3170     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3171     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3172
  3173     12  FILLER                  PIC  X(03) VALUE '186'.
  3174     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3175     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3176     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3177     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3178
  3179     12  FILLER                  PIC  X(03) VALUE '187'.
  3180     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3181     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3182     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3183     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3184
  3185     12  FILLER                  PIC  X(03) VALUE '188'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  60
* EL689.cbl
  3186     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3187     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3188     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3189     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3190
  3191     12  FILLER                  PIC  X(03) VALUE '189'.
  3192     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3193     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3194     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3195     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3196
  3197
  3198 01  FILLER REDEFINES W-SUPPORTED-VARIABLES.
  3199*    12  W-VARIABLE-GRP OCCURS 180 TIMES
  3200     12  W-VARIABLE-GRP OCCURS 189 TIMES
  3201                        INDEXED BY W-VG-NDX.
  3202         16  W-VARIABLE-ID         PIC  X(03).
  3203         16  W-VARIABLE-SIZE       PIC S9(04) COMP.
  3204         16  W-VG-TEXT.
  3205             20  W-VAR-CHAR
  3206                        OCCURS 30 TIMES
  3207                        INDEXED BY W-VC-NDX
  3208                                   PIC  X(01).
  3209         16  W-VARIABLE-UPLOW-IND  PIC  X(01).
  3210             88  W-USE-UPPER-AND-LOWER-CASE VALUE 'Y'.
  3211
  3212         16  W-VARIABLE-SOURCE   PIC S9(04) COMP.
  3213
  3214 01  W-VAR-END                   PIC  X(23)
  3215                        VALUE ':VARIABLE WORK AREA END'.
  3216
  3217 01  W-PROGRAM-TABLE-AREA.
  3218     12  FILLER                  PIC  X(15)
  3219                                 VALUE 'PROGRAM TABLES:'.
  3220
  3221     12  W-RECORD-TABLE              VALUE SPACES.
  3222         16  W-RC-GRP OCCURS 500 TIMES
  3223                       INDEXED BY W-RG-NDX
  3224                                  W-RG-NDX1.
  3225             20  W-RC-TEXT.
  3226                 24  W-RC-CHAR OCCURS 70 TIMES
  3227                                INDEXED BY W-RC-NDX
  3228                                           W-RC-NDX1
  3229                                 PIC  X(01).
  3230             20  W-RC-PC         PIC  9(02).
  3231             20  W-RC-SC         PIC  X(01).
  3232
  3233     12  FILLER REDEFINES W-RECORD-TABLE.
  3234         16  W-REC-CHAR OCCURS 36500 TIMES
  3235                        INDEXED BY W-RVS-NDX
  3236                                   W-RVS-NDX2
  3237                                 PIC  X(01).
  3238     12  FILLER REDEFINES W-RECORD-TABLE.
  3239         16  W-TS-GROUP OCCURS 10 TIMES
  3240                        INDEXED BY W-TS-NDX
  3241                                 PIC X(3650).
  3242
  3243     12  FILLER                  PIC  X(11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  61
* EL689.cbl
  3244                                 VALUE 'TEXT TABLE:'.
  3245     12  W-TX-TABLE                  VALUE SPACES.
  3246         16  W-TX-GRP OCCURS 500 TIMES
  3247                       INDEXED BY W-TG-NDX
  3248                                  W-TG-NDX2.
  3249             20  W-TX-TEXT.
  3250                 24  W-TX-CHAR OCCURS 70 TIMES
  3251                                    INDEXED BY W-TX-NDX
  3252                                               W-TX-NDX1
  3253                                               W-TX-NDX2
  3254                                 PIC  X(01).
  3255             20  W-TX-PC         PIC  9(02).
  3256             20  W-TX-SC         PIC  X(01).
  3257
  3258     12  FILLER                  PIC  X(11)
  3259                                 VALUE 'FILE TABLE:'.
  3260     12  W-FILE-TABLE                VALUE SPACES.
  3261         16  W-FILE-USE-IND OCCURS 20 TIMES
  3262                       INDEXED BY W-FILE-NDX
  3263                                 PIC  X(01).
  3264             88  W-FILE-NOT-USED     VALUE SPACE.
  3265             88  W-FILE-USED         VALUE 'Y'.
  3266
  3267     12  FILLER                  PIC  X(14)
  3268                                 VALUE 'END OF TABLES:'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  62
* EL689.cbl
  3270 01  ERROR-MESSAGES.
  3271     12  ER-0000                 PIC  X(04) VALUE '0000'.
  3272     12  ER-0004                 PIC  X(04) VALUE '0004'.
  3273     12  ER-0006                 PIC  X(04) VALUE '0006'.
  3274     12  ER-0008                 PIC  X(04) VALUE '0008'.
  3275     12  ER-0013                 PIC  X(04) VALUE '0013'.
  3276     12  ER-0023                 PIC  X(04) VALUE '0023'.
  3277     12  ER-0029                 PIC  X(04) VALUE '0029'.
  3278     12  ER-0033                 PIC  X(04) VALUE '0033'.
  3279     12  ER-0042                 PIC  X(04) VALUE '0042'.
  3280     12  ER-0047                 PIC  X(04) VALUE '0047'.
  3281     12  ER-0051                 PIC  X(04) VALUE '0051'.
  3282     12  ER-0066                 PIC  X(04) VALUE '0066'.
  3283     12  ER-0067                 PIC  X(04) VALUE '0067'.
  3284     12  ER-0070                 PIC  X(04) VALUE '0070'.
  3285     12  ER-0168                 PIC  X(04) VALUE '0168'.
  3286     12  ER-0169                 PIC  X(04) VALUE '0169'.
  3287     12  ER-0174                 PIC  X(04) VALUE '0174'.
  3288     12  ER-0175                 PIC  X(04) VALUE '0175'.
  3289     12  ER-0176                 PIC  X(04) VALUE '0176'.
  3290     12  ER-0177                 PIC  X(04) VALUE '0177'.
  3291     12  ER-0179                 PIC  X(04) VALUE '0179'.
  3292     12  ER-0180                 PIC  X(04) VALUE '0180'.
  3293     12  ER-0181                 PIC  X(04) VALUE '0181'.
  3294     12  ER-0182                 PIC  X(04) VALUE '0182'.
  3295     12  ER-0184                 PIC  X(04) VALUE '0184'.
  3296     12  ER-0185                 PIC  X(04) VALUE '0185'.
  3297     12  ER-0187                 PIC  X(04) VALUE '0187'.
  3298     12  ER-0188                 PIC  X(04) VALUE '0188'.
  3299     12  ER-0189                 PIC  X(04) VALUE '0189'.
  3300     12  ER-0190                 PIC  X(04) VALUE '0190'.
  3301     12  ER-0191                 PIC  X(04) VALUE '0191'.
  3302     12  ER-0215                 PIC  X(04) VALUE '0215'.
  3303     12  ER-0279                 PIC  X(04) VALUE '0279'.
  3304     12  ER-0280                 PIC  X(04) VALUE '0280'.
  3305     12  ER-0412                 PIC  X(04) VALUE '0412'.
  3306     12  ER-0413                 PIC  X(04) VALUE '0413'.
  3307     12  ER-0454                 PIC  X(04) VALUE '0454'.
  3308     12  ER-0533                 PIC  X(04) VALUE '0533'.
  3309     12  ER-0537                 PIC  X(04) VALUE '0537'.
  3310     12  ER-0715                 PIC  X(04) VALUE '0715'.
  3311     12  ER-0894                 PIC  X(04) VALUE '0894'.
  3312     12  ER-1560                 PIC  X(04) VALUE '1560'.
  3313     12  ER-1565                 PIC  X(04) VALUE '1565'.
  3314     12  ER-1778                 PIC  X(04) VALUE '1778'.
  3315     12  ER-1818                 PIC  X(04) VALUE '1818'.
  3316     12  ER-2055                 PIC  X(04) VALUE '2055'.
  3317     12  ER-2114                 PIC  X(04) VALUE '2114'.
  3318     12  ER-2208                 PIC  X(04) VALUE '2208'.
  3319     12  ER-2209                 PIC  X(04) VALUE '2209'.
  3320     12  ER-2216                 PIC  X(04) VALUE '2216'.
  3321     12  ER-2232                 PIC  X(04) VALUE '2232'.
  3322     12  ER-2369                 PIC  X(04) VALUE '2369'.
  3323     12  ER-2398                 PIC  X(04) VALUE '2398'.
  3324     12  ER-2433                 PIC  X(04) VALUE '2433'.
  3325     12  ER-2908                 PIC  X(04) VALUE '2908'.
  3326     12  ER-2999                 PIC  X(04) VALUE '2999'.
  3327     12  ER-3000                 PIC  X(04) VALUE '3000'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  63
* EL689.cbl
  3328     12  ER-3770                 PIC  X(04) VALUE '3770'.
  3329     12  ER-3771                 PIC  X(04) VALUE '3771'.
  3330     12  ER-3775                 PIC  X(04) VALUE '3775'.
  3331     12  ER-3783                 PIC  X(04) VALUE '3783'.
  3332     12  ER-7243                 PIC  X(04) VALUE '7243'.
  3333     12  ER-7245                 PIC  X(04) VALUE '7245'.
  3334     12  ER-7246                 PIC  X(04) VALUE '7246'.
  3335     12  ER-7247                 PIC  X(04) VALUE '7247'.
  3336     12  ER-7250                 PIC  X(04) VALUE '7250'.
  3337     12  ER-7365                 PIC  X(04) VALUE '7365'.
  3338     12  ER-7367                 PIC  X(04) VALUE '7367'.
  3339     12  ER-7368                 PIC  X(04) VALUE '7368'.
  3340     12  ER-7369                 PIC  X(04) VALUE '7369'.
  3341     12  ER-7370                 PIC  X(04) VALUE '7370'.
  3342     12  ER-7371                 PIC  X(04) VALUE '7371'.
  3343     12  ER-7372                 PIC  X(04) VALUE '7372'.
  3344     12  ER-7373                 PIC  X(04) VALUE '7373'.
  3345     12  ER-7374                 PIC  X(04) VALUE '7374'.
  3346     12  ER-7376                 PIC  X(04) VALUE '7376'.
  3347     12  ER-7377                 PIC  X(04) VALUE '7377'.
  3348     12  ER-7378                 PIC  X(04) VALUE '7378'.
  3349     12  ER-7379                 PIC  X(04) VALUE '7379'.
  3350     12  ER-7381                 PIC  X(04) VALUE '7381'.
  3351     12  ER-7388                 PIC  X(04) VALUE '7388'.
  3352     12  ER-7390                 PIC  X(04) VALUE '7390'.
  3353     12  ER-7393                 PIC  X(04) VALUE '7393'.
  3354     12  ER-7395                 PIC  X(04) VALUE '7395'.
  3355     12  ER-7396                 PIC  X(04) VALUE '7396'.
  3356     12  ER-7398                 PIC  X(04) VALUE '7398'.
  3357     12  ER-8965                 PIC  X(04) VALUE '8965'.
  3358     12  ER-9095                 PIC  X(04) VALUE '9095'.
  3359     12  ER-9097                 PIC  X(04) VALUE '9097'.
  3360     12  ER-9281                 PIC  X(04) VALUE '9281'.
  3361     12  ER-9283                 PIC  X(04) VALUE '9283'.
  3362     12  ER-9298                 PIC  X(04) VALUE '9298'.
  3363     12  ER-9299                 PIC  X(04) VALUE '9299'.
  3364     12  ER-9320                 PIC  X(04) VALUE '9320'.
  3365     12  ER-9327                 PIC  X(04) VALUE '9327'.
  3366     12  ER-9426                 PIC  X(04) VALUE '9426'.
  3367     12  ER-9427                 PIC  X(04) VALUE '9427'.
  3368     12  ER-9840                 PIC  X(04) VALUE '9840'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  64
* EL689.cbl
  3370*    COPY ELCAID.
  3371******************************************************************
  3372*                                                                *
  3373*                            ELCAID.                             *
  3374*                            VMOD=2.001                          *
  3375*                                                                *
  3376*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3377*                                                                *
  3378*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3379*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3380******************************************************************
  3381
  3382 01  DFHAID.
  3383   02  DFHNULL   PIC  X  VALUE  ' '.
  3384   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3385   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3386   02  DFHPEN    PIC  X  VALUE  '='.
  3387   02  DFHOPID   PIC  X  VALUE  'W'.
  3388   02  DFHPA1    PIC  X  VALUE  '%'.
  3389   02  DFHPA2    PIC  X  VALUE  '>'.
  3390   02  DFHPA3    PIC  X  VALUE  ','.
  3391   02  DFHPF1    PIC  X  VALUE  '1'.
  3392   02  DFHPF2    PIC  X  VALUE  '2'.
  3393   02  DFHPF3    PIC  X  VALUE  '3'.
  3394   02  DFHPF4    PIC  X  VALUE  '4'.
  3395   02  DFHPF5    PIC  X  VALUE  '5'.
  3396   02  DFHPF6    PIC  X  VALUE  '6'.
  3397   02  DFHPF7    PIC  X  VALUE  '7'.
  3398   02  DFHPF8    PIC  X  VALUE  '8'.
  3399   02  DFHPF9    PIC  X  VALUE  '9'.
  3400   02  DFHPF10   PIC  X  VALUE  ':'.
  3401   02  DFHPF11   PIC  X  VALUE  '#'.
  3402   02  DFHPF12   PIC  X  VALUE  '@'.
  3403   02  DFHPF13   PIC  X  VALUE  'A'.
  3404   02  DFHPF14   PIC  X  VALUE  'B'.
  3405   02  DFHPF15   PIC  X  VALUE  'C'.
  3406   02  DFHPF16   PIC  X  VALUE  'D'.
  3407   02  DFHPF17   PIC  X  VALUE  'E'.
  3408   02  DFHPF18   PIC  X  VALUE  'F'.
  3409   02  DFHPF19   PIC  X  VALUE  'G'.
  3410   02  DFHPF20   PIC  X  VALUE  'H'.
  3411   02  DFHPF21   PIC  X  VALUE  'I'.
  3412*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3413   02  DFHPF22   PIC  X  VALUE  '['.
  3414   02  DFHPF23   PIC  X  VALUE  '.'.
  3415   02  DFHPF24   PIC  X  VALUE  '<'.
  3416   02  DFHMSRE   PIC  X  VALUE  'X'.
  3417   02  DFHSTRF   PIC  X  VALUE  'h'.
  3418   02  DFHTRIG   PIC  X  VALUE  '"'.
  3419 01  FILLER    REDEFINES DFHAID.
  3420     12  FILLER                  PIC  X(08).
  3421     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  65
* EL689.cbl
  3423*    COPY ELCATTR.
  3424******************************************************************
  3425*                                                                *
  3426*                            ELCATTR.                            *
  3427*                            VMOD=2.001                          *
  3428*                                                                *
  3429*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  3430*                                                                *
  3431*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  3432*                                                                *
  3433*                   POS 1   P=PROTECTED                          *
  3434*                           U=UNPROTECTED                        *
  3435*                           S=ASKIP                              *
  3436*                   POS 2   A=ALPHA/NUMERIC                      *
  3437*                           N=NUMERIC                            *
  3438*                   POS 3   N=NORMAL                             *
  3439*                           B=BRIGHT                             *
  3440*                           D=DARK                               *
  3441*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  3442*                           OF=MODIFIED DATA TAG OFF             *
  3443*                                                                *
  3444*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  3445******************************************************************
  3446 01  ATTRIBUTE-LIST.
  3447     12  AL-PABOF            PIC X       VALUE 'Y'.
  3448     12  AL-PABON            PIC X       VALUE 'Z'.
  3449     12  AL-PADOF            PIC X       VALUE '%'.
  3450     12  AL-PADON            PIC X       VALUE '_'.
  3451     12  AL-PANOF            PIC X       VALUE '-'.
  3452     12  AL-PANON            PIC X       VALUE '/'.
  3453     12  AL-SABOF            PIC X       VALUE '8'.
  3454     12  AL-SABON            PIC X       VALUE '9'.
  3455     12  AL-SADOF            PIC X       VALUE '@'.
  3456     12  AL-SADON            PIC X       VALUE QUOTE.
  3457     12  AL-SANOF            PIC X       VALUE '0'.
  3458     12  AL-SANON            PIC X       VALUE '1'.
  3459     12  AL-UABOF            PIC X       VALUE 'H'.
  3460     12  AL-UABON            PIC X       VALUE 'I'.
  3461     12  AL-UADOF            PIC X       VALUE '<'.
  3462     12  AL-UADON            PIC X       VALUE '('.
  3463     12  AL-UANOF            PIC X       VALUE ' '.
  3464     12  AL-UANON            PIC X       VALUE 'A'.
  3465     12  AL-UNBOF            PIC X       VALUE 'Q'.
  3466     12  AL-UNBON            PIC X       VALUE 'R'.
  3467     12  AL-UNDOF            PIC X       VALUE '*'.
  3468     12  AL-UNDON            PIC X       VALUE ')'.
  3469     12  AL-UNNOF            PIC X       VALUE '&'.
  3470     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  66
* EL689.cbl
  3472*    COPY ELCDATE.
  3473******************************************************************
  3474*                                                                *
  3475*                                                                *
  3476*                            ELCDATE.                            *
  3477*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3478*                            VMOD=2.003
  3479*                                                                *
  3480*                                                                *
  3481*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3482*                 LENGTH = 200                                   *
  3483******************************************************************
  3484
  3485 01  DATE-CONVERSION-DATA.
  3486     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3487     12  DC-OPTION-CODE                PIC X.
  3488         88  BIN-TO-GREG                VALUE ' '.
  3489         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3490         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3491         88  YMD-GREG-TO-BIN            VALUE '3'.
  3492         88  MDY-GREG-TO-BIN            VALUE '4'.
  3493         88  JULIAN-TO-BIN              VALUE '5'.
  3494         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3495         88  FIND-CENTURY               VALUE '7'.
  3496         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3497         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3498         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3499         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3500         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3501         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3502         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3503         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3504         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3505         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3506         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3507         88  BIN-3-TO-GREG              VALUE 'I'.
  3508         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3509         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3510         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3511         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3512         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3513         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3514         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3515         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3516         88  THREE-CHARACTER-BIN
  3517                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3518         88  GREGORIAN-TO-BIN
  3519                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3520         88  BIN-TO-GREGORIAN
  3521                  VALUES ' ' '1' 'I' '8' 'G'.
  3522         88  JULIAN-TO-BINARY
  3523                  VALUES '5' 'C' 'E' 'F'.
  3524     12  DC-ERROR-CODE                 PIC X.
  3525         88  NO-CONVERSION-ERROR        VALUE ' '.
  3526         88  DATE-CONVERSION-ERROR
  3527                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3528         88  DATE-IS-ZERO               VALUE '1'.
  3529         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  67
* EL689.cbl
  3530         88  DATE-IS-INVALID            VALUE '3'.
  3531         88  DATE1-GREATER-DATE2        VALUE '4'.
  3532         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3533         88  DATE-INVALID-OPTION        VALUE '9'.
  3534         88  INVALID-CENTURY            VALUE 'A'.
  3535         88  ONLY-CENTURY               VALUE 'B'.
  3536         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3537         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3538     12  DC-END-OF-MONTH               PIC X.
  3539         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3540     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3541         88  USE-NORMAL-PROCESS         VALUE ' '.
  3542         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3543         88  ADJUST-UP-100-YRS          VALUE '2'.
  3544     12  FILLER                        PIC X.
  3545     12  DC-CONVERSION-DATES.
  3546         16  DC-BIN-DATE-1             PIC XX.
  3547         16  DC-BIN-DATE-2             PIC XX.
  3548         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3549         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3550                       DC-GREG-DATE-1-EDIT.
  3551             20  DC-EDIT1-MONTH        PIC 99.
  3552             20  SLASH1-1              PIC X.
  3553             20  DC-EDIT1-DAY          PIC 99.
  3554             20  SLASH1-2              PIC X.
  3555             20  DC-EDIT1-YEAR         PIC 99.
  3556         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3557         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3558                     DC-GREG-DATE-2-EDIT.
  3559             20  DC-EDIT2-MONTH        PIC 99.
  3560             20  SLASH2-1              PIC X.
  3561             20  DC-EDIT2-DAY          PIC 99.
  3562             20  SLASH2-2              PIC X.
  3563             20  DC-EDIT2-YEAR         PIC 99.
  3564         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3565         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3566                     DC-GREG-DATE-1-YMD.
  3567             20  DC-YMD-YEAR           PIC 99.
  3568             20  DC-YMD-MONTH          PIC 99.
  3569             20  DC-YMD-DAY            PIC 99.
  3570         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3571         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3572                      DC-GREG-DATE-1-MDY.
  3573             20  DC-MDY-MONTH          PIC 99.
  3574             20  DC-MDY-DAY            PIC 99.
  3575             20  DC-MDY-YEAR           PIC 99.
  3576         16  DC-GREG-DATE-1-ALPHA.
  3577             20  DC-ALPHA-MONTH        PIC X(10).
  3578             20  DC-ALPHA-DAY          PIC 99.
  3579             20  FILLER                PIC XX.
  3580             20  DC-ALPHA-CENTURY.
  3581                 24 DC-ALPHA-CEN-N     PIC 99.
  3582             20  DC-ALPHA-YEAR         PIC 99.
  3583         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3584         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3585         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3586         16  DC-JULIAN-DATE            PIC 9(05).
  3587         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  68
* EL689.cbl
  3588                                       PIC 9(05).
  3589         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3590             20  DC-JULIAN-YEAR        PIC 99.
  3591             20  DC-JULIAN-DAYS        PIC 999.
  3592         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3593         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3594         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3595     12  DATE-CONVERSION-VARIBLES.
  3596         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3597         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3598             20  FILLER                PIC 9(3).
  3599             20  HOLD-CEN-1-CCYY.
  3600                 24  HOLD-CEN-1-CC     PIC 99.
  3601                 24  HOLD-CEN-1-YY     PIC 99.
  3602             20  HOLD-CEN-1-MO         PIC 99.
  3603             20  HOLD-CEN-1-DA         PIC 99.
  3604         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3605             20  HOLD-CEN-1-R-MO       PIC 99.
  3606             20  HOLD-CEN-1-R-DA       PIC 99.
  3607             20  HOLD-CEN-1-R-CCYY.
  3608                 24  HOLD-CEN-1-R-CC   PIC 99.
  3609                 24  HOLD-CEN-1-R-YY   PIC 99.
  3610             20  FILLER                PIC 9(3).
  3611         16  HOLD-CENTURY-1-X.
  3612             20  FILLER                PIC X(3)  VALUE SPACES.
  3613             20  HOLD-CEN-1-X-CCYY.
  3614                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3615                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3616             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3617             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3618         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3619             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3620             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3621             20  HOLD-CEN-1-R-X-CCYY.
  3622                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3623                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3624             20  FILLER                PIC XXX.
  3625         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3626         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3627         16  DC-JULIAN-DATE-1          PIC 9(07).
  3628         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3629             20  DC-JULIAN-1-CCYY.
  3630                 24  DC-JULIAN-1-CC    PIC 99.
  3631                 24  DC-JULIAN-1-YR    PIC 99.
  3632             20  DC-JULIAN-DA-1        PIC 999.
  3633         16  DC-JULIAN-DATE-2          PIC 9(07).
  3634         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3635             20  DC-JULIAN-2-CCYY.
  3636                 24  DC-JULIAN-2-CC    PIC 99.
  3637                 24  DC-JULIAN-2-YR    PIC 99.
  3638             20  DC-JULIAN-DA-2        PIC 999.
  3639         16  DC-GREG-DATE-A-EDIT.
  3640             20  DC-EDITA-MONTH        PIC 99.
  3641             20  SLASHA-1              PIC X VALUE '/'.
  3642             20  DC-EDITA-DAY          PIC 99.
  3643             20  SLASHA-2              PIC X VALUE '/'.
  3644             20  DC-EDITA-CCYY.
  3645                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  69
* EL689.cbl
  3646                 24  DC-EDITA-YEAR     PIC 99.
  3647         16  DC-GREG-DATE-B-EDIT.
  3648             20  DC-EDITB-MONTH        PIC 99.
  3649             20  SLASHB-1              PIC X VALUE '/'.
  3650             20  DC-EDITB-DAY          PIC 99.
  3651             20  SLASHB-2              PIC X VALUE '/'.
  3652             20  DC-EDITB-CCYY.
  3653                 24  DC-EDITB-CENT     PIC 99.
  3654                 24  DC-EDITB-YEAR     PIC 99.
  3655         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3656         16  DC-GREG-DATE-CYMD-R REDEFINES
  3657                              DC-GREG-DATE-CYMD.
  3658             20  DC-CYMD-CEN           PIC 99.
  3659             20  DC-CYMD-YEAR          PIC 99.
  3660             20  DC-CYMD-MONTH         PIC 99.
  3661             20  DC-CYMD-DAY           PIC 99.
  3662         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3663         16  DC-GREG-DATE-MDCY-R REDEFINES
  3664                              DC-GREG-DATE-MDCY.
  3665             20  DC-MDCY-MONTH         PIC 99.
  3666             20  DC-MDCY-DAY           PIC 99.
  3667             20  DC-MDCY-CEN           PIC 99.
  3668             20  DC-MDCY-YEAR          PIC 99.
  3669    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3670        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3671    12  DC-EL310-DATE                  PIC X(21).
  3672    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  70
* EL689.cbl
  3674*    COPY ELCNWA.
  3675*****************************************************************
  3676*                                                               *
  3677*                                                               *
  3678*                            ELCNWA.                            *
  3679*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3680*                            VMOD=2.003                         *
  3681*                                                               *
  3682*            M O V E   N A M E   W O R K   A R E A.             *
  3683*                                                               *
  3684*****************************************************************.
  3685
  3686 01  WS-NAME-WORK-AREA.
  3687     05  WS-INSURED-LAST-NAME        PIC X(15).
  3688     05  WS-INSURED-1ST-NAME         PIC X(12).
  3689     05  WS-INSURED-MID-INIT         PIC X.
  3690
  3691     05  WS-NAME-WORK.
  3692         10  WS-NW                   PIC X
  3693             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  3694
  3695     05  WS-NAME-WORK2.
  3696         10  WS-NW2                  PIC X
  3697             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  3698                                        NWA-INDEX0.
  3699
  3700     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  3701                                     COMP-3.
  3702
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  71
* EL689.cbl
  3704*    COPY ELCEMIB.
  3705******************************************************************
  3706*                                                                *
  3707*                                                                *
  3708*                            ELCEMIB.                            *
  3709*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3710*                            VMOD=2.005                          *
  3711*                                                                *
  3712*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  3713*                                                                *
  3714******************************************************************
  3715 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  3716     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  3717     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  3718     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  3719     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  3720     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  3721     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  3722     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  3723     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  3724     12  EMI-SWITCH1             PIC X        VALUE '1'.
  3725         88  EMI-NO-ERRORS                    VALUE '1'.
  3726         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  3727         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  3728     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3729         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3730     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3731         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3732         88  EMI-AREA1-FULL                   VALUE '2'.
  3733     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3734         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3735         88  EMI-AREA2-FULL                   VALUE '2'.
  3736     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3737         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3738         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3739         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3740         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3741         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3742     12  EMI-ERROR-LINES.
  3743         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3744         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3745         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3746         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3747             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3748                 24  EMI-ERR-NUM         PIC X(4).
  3749                 24  EMI-FILLER          PIC X.
  3750                 24  EMI-SEV             PIC X.
  3751                 24  FILLER              PIC X.
  3752             20  FILLER                  PIC X(02).
  3753     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3754         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3755             20  EMI-ERROR-NUMBER    PIC X(4).
  3756             20  EMI-FILL            PIC X.
  3757             20  EMI-SEVERITY        PIC X.
  3758             20  FILLER              PIC X.
  3759             20  EMI-ERROR-TEXT.
  3760                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3761                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  72
* EL689.cbl
  3762     12  EMI-SEVERITY-SAVE           PIC X.
  3763         88  EMI-NOTE                    VALUE 'N'.
  3764         88  EMI-WARNING                 VALUE 'W'.
  3765         88  EMI-FORCABLE                VALUE 'F'.
  3766         88  EMI-FATAL                   VALUE 'X'.
  3767     12  EMI-MESSAGE-FLAG            PIC X.
  3768         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3769         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3770     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3771     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3772         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3773         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3774         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3775     12  emi-claim-no                pic x(7).
  3776     12  emi-claim-type              pic x(6).
  3777     12  FILLER                      PIC X(124)  VALUE SPACES.
  3778     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3779     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3780     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3781     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  3782 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  73
* EL689.cbl
  3784*    COPY ELCLOGOF.
  3785******************************************************************
  3786*                                                                *
  3787*                                                                *
  3788*                            ELCLOGOF.                           *
  3789*                            VMOD=2.001                          *
  3790*                                                                *
  3791*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  3792*                                                                *
  3793******************************************************************
  3794 01  CLASIC-LOGOFF.
  3795     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  3796     12  LOGOFF-TEXT.
  3797         16  FILLER          PIC X(5)    VALUE SPACES.
  3798         16  LOGOFF-MSG.
  3799             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  3800             20  FILLER      PIC X       VALUE SPACES.
  3801             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  3802         16  FILLER          PIC X(80)
  3803           VALUE '* YOU ARE NOW LOGGED OFF'.
  3804         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  3805         16  FILLER          PIC X       VALUE QUOTE.
  3806         16  LOGOFF-SYS-MSG  PIC X(17)
  3807           VALUE 'S CLAS-IC SYSTEM '.
  3808     12  TEXT-MESSAGES.
  3809         16  UNACCESS-MSG    PIC X(29)
  3810             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  3811         16  PGMIDERR-MSG    PIC X(17)
  3812             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  74
* EL689.cbl
  3814*    COPY ELCSCTM.
  3815******************************************************************
  3816*                                                                *
  3817*                                                                *
  3818*                            ELCSCTM                             *
  3819*                            VMOD=2.001                          *
  3820*                                                                *
  3821*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  3822*                                                                *
  3823******************************************************************
  3824 01  SECURITY-MESSAGE.
  3825     12  FILLER                          PIC X(30)
  3826            VALUE '** LOGIC SECURITY VIOLATION -'.
  3827     12  SM-READ                         PIC X(6).
  3828     12  FILLER                          PIC X(5)
  3829            VALUE ' PGM='.
  3830     12  SM-PGM                          PIC X(6).
  3831     12  FILLER                          PIC X(5)
  3832            VALUE ' OPR='.
  3833     12  SM-PROCESSOR-ID                 PIC X(4).
  3834     12  FILLER                          PIC X(6)
  3835            VALUE ' TERM='.
  3836     12  SM-TERMID                       PIC X(4).
  3837     12  FILLER                          PIC XX   VALUE SPACE.
  3838     12  SM-JUL-DATE                     PIC 9(5).
  3839     12  FILLER                          PIC X    VALUE SPACE.
  3840     12  SM-TIME                         PIC 99.99.
  3841
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  75
* EL689.cbl
  3843*    COPY ELCSCRTY.
  3844******************************************************************
  3845*                                                                *
  3846*                                                                *
  3847*                            ELCSCRTY                            *
  3848*                            VMOD=2.001                          *
  3849*                                                                *
  3850*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  3851*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  3852*        SAVED IN PI-SECURITY-ADDRESS.                           *
  3853*                                                                *
  3854******************************************************************
  3855 01  SECURITY-CONTROL.
  3856     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  3857     12  FILLER                       PIC XX    VALUE 'SC'.
  3858     12  SC-CREDIT-CODES.
  3859         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  3860             20  SC-CREDIT-DISPLAY    PIC X.
  3861             20  SC-CREDIT-UPDATE     PIC X.
  3862     12  SC-CLAIMS-CODES.
  3863         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  3864             20  SC-CLAIMS-DISPLAY    PIC X.
  3865             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  76
* EL689.cbl
  3867
  3868 01  W-TS-WORK-AREA              PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  77
* EL689.cbl
  3870****************************************************************
  3871*
  3872* Copyright (c) 2007 by Clerity Solutions, Inc.
  3873* All rights reserved.
  3874*
  3875****************************************************************
  3876 01  DFHEIV.
  3877   02  DFHEIV0               PIC X(35).
  3878   02  DFHEIV1               PIC X(08).
  3879   02  DFHEIV2               PIC X(08).
  3880   02  DFHEIV3               PIC X(08).
  3881   02  DFHEIV4               PIC X(06).
  3882   02  DFHEIV5               PIC X(04).
  3883   02  DFHEIV6               PIC X(04).
  3884   02  DFHEIV7               PIC X(02).
  3885   02  DFHEIV8               PIC X(02).
  3886   02  DFHEIV9               PIC X(01).
  3887   02  DFHEIV10              PIC S9(7) COMP-3.
  3888   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3889   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3890   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3891   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3892   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3893   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3894   02  DFHEIV17              PIC X(04).
  3895   02  DFHEIV18              PIC X(04).
  3896   02  DFHEIV19              PIC X(04).
  3897   02  DFHEIV20              USAGE IS POINTER.
  3898   02  DFHEIV21              USAGE IS POINTER.
  3899   02  DFHEIV22              USAGE IS POINTER.
  3900   02  DFHEIV23              USAGE IS POINTER.
  3901   02  DFHEIV24              USAGE IS POINTER.
  3902   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3903   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3904   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3905   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3906   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3907   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3908   02  FILLER                PIC X(02).
  3909   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3910   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3911   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3912   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3913   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3914 LINKAGE  SECTION.
  3915*****************************************************************
  3916*                                                               *
  3917* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3918* All rights reserved.                                          *
  3919*                                                               *
  3920*****************************************************************
  3921 01  dfheiblk.
  3922     02  eibtime          pic s9(7) comp-3.
  3923     02  eibdate          pic s9(7) comp-3.
  3924     02  eibtrnid         pic x(4).
  3925     02  eibtaskn         pic s9(7) comp-3.
  3926     02  eibtrmid         pic x(4).
  3927     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  78
* EL689.cbl
  3928     02  eibcposn         pic s9(4) comp.
  3929     02  eibcalen         pic s9(4) comp.
  3930     02  eibaid           pic x(1).
  3931     02  eibfiller1       pic x(1).
  3932     02  eibfn            pic x(2).
  3933     02  eibfiller2       pic x(2).
  3934     02  eibrcode         pic x(6).
  3935     02  eibfiller3       pic x(2).
  3936     02  eibds            pic x(8).
  3937     02  eibreqid         pic x(8).
  3938     02  eibrsrce         pic x(8).
  3939     02  eibsync          pic x(1).
  3940     02  eibfree          pic x(1).
  3941     02  eibrecv          pic x(1).
  3942     02  eibsend          pic x(1).
  3943     02  eibatt           pic x(1).
  3944     02  eibeoc           pic x(1).
  3945     02  eibfmh           pic x(1).
  3946     02  eibcompl         pic x(1).
  3947     02  eibsig           pic x(1).
  3948     02  eibconf          pic x(1).
  3949     02  eiberr           pic x(1).
  3950     02  eibrldbk         pic x(1).
  3951     02  eiberrcd         pic x(4).
  3952     02  eibsynrb         pic x(1).
  3953     02  eibnodat         pic x(1).
  3954     02  eibfiller5       pic x(2).
  3955     02  eibresp          pic 9(09) comp.
  3956     02  eibresp2         pic 9(09) comp.
  3957     02  dfheigdj         pic s9(4) comp.
  3958     02  dfheigdk         pic s9(4) comp.
  3959 01  DFHCOMMAREA                 PIC X(1024).
  3960 01  var  pic x(30).
  3961
  3962*    COPY ERCACCT.
  3963******************************************************************
  3964*                                                                *
  3965*                                                                *
  3966*                            ERCACCT                             *
  3967*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3968*                            VMOD=2.031                          *
  3969*                                                                *
  3970*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3971*                                                                *
  3972*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3973*   VSAM ACCOUNT MASTER FILES.                                   *
  3974*                                                                *
  3975*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3976*                                                                *
  3977*   FILE TYPE = VSAM,KSDS                                        *
  3978*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3979*                                                                *
  3980*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3981*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3982*                                                                *
  3983*   LOG = NO                                                     *
  3984*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3985*                                                                *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  79
* EL689.cbl
  3986*                                                                *
  3987******************************************************************
  3988*                   C H A N G E   L O G
  3989*
  3990* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3991*-----------------------------------------------------------------
  3992*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3993* EFFECTIVE    NUMBER
  3994*-----------------------------------------------------------------
  3995* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3996* 092705    2005050300006  PEMA  ADD SPP LEASES
  3997* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3998* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3999* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4000* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4001* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4002******************************************************************
  4003
  4004 01  ACCOUNT-MASTER.
  4005     12  AM-RECORD-ID                      PIC XX.
  4006         88  VALID-AM-ID                      VALUE 'AM'.
  4007
  4008     12  AM-CONTROL-PRIMARY.
  4009         16  AM-COMPANY-CD                 PIC X.
  4010         16  AM-MSTR-CNTRL.
  4011             20  AM-CONTROL-A.
  4012                 24  AM-CARRIER            PIC X.
  4013                 24  AM-GROUPING.
  4014                     28 AM-GROUPING-PREFIX PIC XXX.
  4015                     28 AM-GROUPING-PRIME  PIC XXX.
  4016                 24  AM-STATE              PIC XX.
  4017                 24  AM-ACCOUNT.
  4018                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4019                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4020             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4021                                           PIC X(19).
  4022             20  AM-CNTRL-B.
  4023                 24  AM-EXPIRATION-DT      PIC XX.
  4024                 24  FILLER                PIC X(4).
  4025             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4026                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4027
  4028     12  AM-CONTROL-BY-VAR-GRP.
  4029         16  AM-COMPANY-CD-A1              PIC X.
  4030         16  AM-VG-CARRIER                 PIC X.
  4031         16  AM-VG-GROUPING                PIC X(6).
  4032         16  AM-VG-STATE                   PIC XX.
  4033         16  AM-VG-ACCOUNT                 PIC X(10).
  4034         16  AM-VG-DATE.
  4035             20  AM-VG-EXPIRATION-DT       PIC XX.
  4036             20  FILLER                    PIC X(4).
  4037         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4038                                           PIC 9(11)      COMP-3.
  4039     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4040         16  FILLER                        PIC X(10).
  4041         16  AM-VG-KEY3.
  4042             20  AM-VG3-ACCOUNT            PIC X(10).
  4043             20  AM-VG3-EXP-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  80
* EL689.cbl
  4044         16  FILLER                        PIC X(4).
  4045     12  AM-MAINT-INFORMATION.
  4046         16  AM-LAST-MAINT-DT              PIC XX.
  4047         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4048         16  AM-LAST-MAINT-USER            PIC X(4).
  4049         16  FILLER                        PIC XX.
  4050
  4051     12  AM-EFFECTIVE-DT                   PIC XX.
  4052     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4053
  4054     12  AM-PREV-DATES  COMP-3.
  4055         16  AM-PREV-EXP-DT                PIC 9(11).
  4056         16  AM-PREV-EFF-DT                PIC 9(11).
  4057
  4058     12  AM-REPORT-CODE-1                  PIC X(10).
  4059     12  AM-REPORT-CODE-2                  PIC X(10).
  4060
  4061     12  AM-CITY-CODE                      PIC X(4).
  4062     12  AM-COUNTY-PARISH                  PIC X(6).
  4063
  4064     12  AM-NAME                           PIC X(30).
  4065     12  AM-PERSON                         PIC X(30).
  4066     12  AM-ADDRS                          PIC X(30).
  4067     12  AM-CITY.
  4068         16  AM-ADDR-CITY                  PIC X(28).
  4069         16  AM-ADDR-STATE                 PIC XX.
  4070     12  AM-ZIP.
  4071         16  AM-ZIP-PRIME.
  4072             20  AM-ZIP-PRI-1ST            PIC X.
  4073                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4074             20  FILLER                    PIC X(4).
  4075         16  AM-ZIP-PLUS4                  PIC X(4).
  4076     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4077         16  AM-CAN-POSTAL-1               PIC XXX.
  4078         16  AM-CAN-POSTAL-2               PIC XXX.
  4079         16  FILLER                        PIC XXX.
  4080     12  AM-TEL-NO.
  4081         16  AM-AREA-CODE                  PIC 999.
  4082         16  AM-TEL-PRE                    PIC 999.
  4083         16  AM-TEL-NBR                    PIC 9(4).
  4084     12  AM-TEL-LOC                        PIC X.
  4085         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4086         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4087
  4088     12  AM-COMM-STRUCTURE.
  4089         16  AM-DEFN-1.
  4090             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4091                 24  AM-AGT.
  4092                     28  AM-AGT-PREFIX     PIC X(4).
  4093                     28  AM-AGT-PRIME      PIC X(6).
  4094                 24  AM-COM-TYP            PIC X.
  4095                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4096                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4097                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4098                 24  AM-RECALC-LV-INDIC    PIC X.
  4099                 24  AM-RETRO-LV-INDIC     PIC X.
  4100                 24  AM-GL-CODES           PIC X.
  4101                 24  AM-COMM-CHARGEBACK    PIC 9(02).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  81
* EL689.cbl
  4102                 24  FILLER                PIC X(01).
  4103         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4104             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4105                 24  FILLER                PIC X(11).
  4106                 24  AM-L-COMA             PIC XXX.
  4107                 24  AM-J-COMA             PIC XXX.
  4108                 24  AM-A-COMA             PIC XXX.
  4109                 24  FILLER                PIC X(6).
  4110
  4111     12  AM-COMM-CHANGE-STATUS             PIC X.
  4112         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4113
  4114     12  AM-CSR-CODE                       PIC X(4).
  4115
  4116     12  AM-BILLING-STATUS                 PIC X.
  4117         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4118         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4119     12  AM-AUTO-REFUND-SW                 PIC X.
  4120         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4121         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4122     12  AM-GPCD                           PIC 99.
  4123     12  AM-IG                             PIC X.
  4124         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4125         88  AM-HAS-GROUP                     VALUE '2'.
  4126     12  AM-STATUS                         PIC X.
  4127         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4128         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4129         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4130         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4131         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4132         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4133     12  AM-REMIT-TO                       PIC 99.
  4134     12  AM-ID-NO                          PIC X(11).
  4135
  4136     12  AM-CAL-TABLE                      PIC XX.
  4137     12  AM-LF-DEVIATION                   PIC XXX.
  4138     12  AM-AH-DEVIATION                   PIC XXX.
  4139     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4140     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4141     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4142     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4143     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4144     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4145
  4146     12  AM-USER-FIELDS.
  4147         16  AM-FLD-1                      PIC XX.
  4148         16  AM-FLD-2                      PIC XX.
  4149         16  AM-FLD-3                      PIC XX.
  4150         16  AM-FLD-4                      PIC XX.
  4151         16  AM-FLD-5                      PIC XX.
  4152
  4153     12  AM-1ST-PROD-DATE.
  4154         16  AM-1ST-PROD-YR                PIC XX.
  4155         16  AM-1ST-PROD-MO                PIC XX.
  4156         16  AM-1ST-PROD-DA                PIC XX.
  4157     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4158     12  AM-CERTS-PURGED-DATE.
  4159         16  AM-PUR-YR                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  82
* EL689.cbl
  4160         16  AM-PUR-MO                     PIC XX.
  4161         16  AM-PUR-DA                     PIC XX.
  4162     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4163     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4164     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4165     12  AM-INACTIVE-DATE.
  4166         16  AM-INA-MO                     PIC 99.
  4167         16  AM-INA-DA                     PIC 99.
  4168         16  AM-INA-YR                     PIC 99.
  4169     12  AM-AR-HI-CERT-DATE                PIC XX.
  4170
  4171     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4172     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4173
  4174     12  AM-OB-PAYMENT-MODE                PIC X.
  4175         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4176         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4177         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4178         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4179
  4180     12  AM-AH-ONLY-INDICATOR              PIC X.
  4181         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4182         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4183
  4184     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4185
  4186     12  AM-OVER-SHORT.
  4187         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4188         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4189
  4190     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4191     12  AM-DCC-CLP-STATE                  PIC XX.
  4192
  4193     12  AM-RECALC-COMM                    PIC X.
  4194     12  AM-RECALC-REIN                    PIC X.
  4195
  4196     12  AM-REI-TABLE                      PIC XXX.
  4197     12  AM-REI-ET-LF                      PIC X.
  4198     12  AM-REI-ET-AH                      PIC X.
  4199     12  AM-REI-PE-LF                      PIC X.
  4200     12  AM-REI-PE-AH                      PIC X.
  4201     12  AM-REI-PRT-ST                     PIC X.
  4202     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4203     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4204     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4205     12  AM-REI-GROUP-A                    PIC X(6).
  4206     12  AM-REI-MORT                       PIC X(4).
  4207     12  AM-REI-PRT-OW                     PIC X.
  4208     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4209     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4210     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4211     12  AM-REI-GROUP-B                    PIC X(6).
  4212
  4213     12  AM-TRUST-TYPE                     PIC X(2).
  4214
  4215     12  AM-EMPLOYER-STMT-USED             PIC X.
  4216     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4217
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  83
* EL689.cbl
  4218     12  AM-STD-AH-TYPE                    PIC XX.
  4219     12  AM-EARN-METHODS.
  4220         16  AM-EARN-METHOD-R              PIC X.
  4221             88 AM-REF-RL-R78                 VALUE 'R'.
  4222             88 AM-REF-RL-PR                  VALUE 'P'.
  4223             88 AM-REF-RL-MEAN                VALUE 'M'.
  4224             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4225         16  AM-EARN-METHOD-L              PIC X.
  4226             88 AM-REF-LL-R78                 VALUE 'R'.
  4227             88 AM-REF-LL-PR                  VALUE 'P'.
  4228             88 AM-REF-LL-MEAN                VALUE 'M'.
  4229             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4230         16  AM-EARN-METHOD-A              PIC X.
  4231             88 AM-REF-AH-R78                 VALUE 'R'.
  4232             88 AM-REF-AH-PR                  VALUE 'P'.
  4233             88 AM-REF-AH-MEAN                VALUE 'M'.
  4234             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4235             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4236             88 AM-REF-AH-NET                 VALUE 'N'.
  4237
  4238     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4239     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4240     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4241
  4242     12  AM-RET-Y-N                        PIC X.
  4243     12  AM-RET-P-E                        PIC X.
  4244     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4245     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4246     12  AM-RET-GRP                        PIC X(6).
  4247     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4248         16  AM-POOL-PRIME                 PIC XXX.
  4249         16  AM-POOL-SUB                   PIC XXX.
  4250     12  AM-RETRO-EARNINGS.
  4251         16  AM-RET-EARN-R                 PIC X.
  4252         16  AM-RET-EARN-L                 PIC X.
  4253         16  AM-RET-EARN-A                 PIC X.
  4254     12  AM-RET-ST-TAX-USE                 PIC X.
  4255         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4256         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4257     12  AM-RETRO-BEG-EARNINGS.
  4258         16  AM-RET-BEG-EARN-R             PIC X.
  4259         16  AM-RET-BEG-EARN-L             PIC X.
  4260         16  AM-RET-BEG-EARN-A             PIC X.
  4261     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4262     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4263
  4264     12  AM-USER-SELECT-OPTIONS.
  4265         16  AM-USER-SELECT-1              PIC X(10).
  4266         16  AM-USER-SELECT-2              PIC X(10).
  4267         16  AM-USER-SELECT-3              PIC X(10).
  4268         16  AM-USER-SELECT-4              PIC X(10).
  4269         16  AM-USER-SELECT-5              PIC X(10).
  4270
  4271     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4272
  4273     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4274
  4275     12  AM-RPT045A-SWITCH                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  84
* EL689.cbl
  4276         88  RPT045A-OFF                   VALUE 'N'.
  4277
  4278     12  AM-INSURANCE-LIMITS.
  4279         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4280         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4281
  4282     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4283         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4284
  4285     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4286         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4287         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4288
  4289     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4290
  4291     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4292     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4293     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4294     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4295     12  AM-DCC-UEF-STATE                  PIC XX.
  4296     12  FILLER                            PIC XXX.
  4297     12  AM-REPORT-CODE-3                  PIC X(10).
  4298*    12  FILLER                            PIC X(22).
  4299
  4300     12  AM-RESERVE-DATE.
  4301         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4302         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4303         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4304
  4305     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4306     12  AM-NOTIFICATION-TYPES.
  4307         16  AM-NOTIF-OF-LETTERS           PIC X.
  4308         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4309         16  AM-NOTIF-OF-REPORTS           PIC X.
  4310         16  AM-NOTIF-OF-STATUS            PIC X.
  4311
  4312     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4313         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4314         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4315         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4316         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4317
  4318     12  AM-BENEFIT-CONTROLS.
  4319         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4320             20  AM-BENEFIT-CODE           PIC XX.
  4321             20  AM-BENEFIT-TYPE           PIC X.
  4322             20  AM-BENEFIT-REVISION       PIC XXX.
  4323             20  AM-BENEFIT-REM-TERM       PIC X.
  4324             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4325             20  FILLER                    PIC XX.
  4326         16  FILLER                        PIC X(80).
  4327
  4328     12  AM-TRANSFER-DATA.
  4329         16  AM-TRANSFERRED-FROM.
  4330             20  AM-TRNFROM-CARRIER        PIC X.
  4331             20  AM-TRNFROM-GROUPING.
  4332                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4333                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  85
* EL689.cbl
  4334             20  AM-TRNFROM-STATE          PIC XX.
  4335             20  AM-TRNFROM-ACCOUNT.
  4336                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4337                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4338             20  AM-TRNFROM-DTE            PIC XX.
  4339         16  AM-TRANSFERRED-TO.
  4340             20  AM-TRNTO-CARRIER          PIC X.
  4341             20  AM-TRNTO-GROUPING.
  4342                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4343                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4344             20  AM-TRNTO-STATE            PIC XX.
  4345             20  AM-TRNTO-ACCOUNT.
  4346                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4347                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4348             20  AM-TRNTO-DTE              PIC XX.
  4349         16  FILLER                        PIC X(10).
  4350
  4351     12  AM-SAVED-REMIT-TO                 PIC 99.
  4352
  4353     12  AM-COMM-STRUCTURE-SAVED.
  4354         16  AM-DEFN-1-SAVED.
  4355             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4356                 24  AM-AGT-SV             PIC X(10).
  4357                 24  AM-COM-TYP-SV         PIC X.
  4358                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4359                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4360                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4361                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4362                 24  FILLER                PIC X.
  4363                 24  AM-GL-CODES-SV        PIC X.
  4364                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4365                 24  FILLER                PIC X.
  4366         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4367             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4368                 24  FILLER                PIC X(11).
  4369                 24  AM-L-COMA-SV          PIC XXX.
  4370                 24  AM-J-COMA-SV          PIC XXX.
  4371                 24  AM-A-COMA-SV          PIC XXX.
  4372                 24  FILLER                PIC X(6).
  4373
  4374     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4375         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4376            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4377            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4378            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4379
  4380     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4381     12  FILLER                            PIC X(120).
  4382
  4383     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4384         16  AM-CONTROL-NAME               PIC X(30).
  4385         16  AM-EXECUTIVE-ONE.
  4386             20  AM-EXEC1-NAME             PIC X(15).
  4387             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4388                                                          COMP-3.
  4389             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4390                                                          COMP-3.
  4391         16  AM-EXECUTIVE-TWO.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  86
* EL689.cbl
  4392             20  AM-EXEC2-NAME             PIC X(15).
  4393             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4394                                                          COMP-3.
  4395             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4396                                                          COMP-3.
  4397
  4398     12  AM-RETRO-ADDITIONAL-DATA.
  4399         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4400         16  AM-RETRO-PREM-P-E             PIC X.
  4401         16  AM-RETRO-CLMS-P-I             PIC X.
  4402         16  AM-RETRO-RET-BRACKET-LF.
  4403             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4404                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4405                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4406             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4407                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4408                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4409             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4410                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4411                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4412         16  AM-RETRO-RET-BRACKET-AH.
  4413             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4414                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4415                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4416                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4417             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4418                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4419                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4420             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4421                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4422                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4423
  4424     12  AM-COMMENTS.
  4425         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4426
  4427     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4428         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4429         16  AM-FLI-BILLING-CODE           PIC X.
  4430         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4431         16  AM-FLI-UNITED-IDENT           PIC X.
  4432         16  AM-FLI-INTEREST-LOST-DATA.
  4433             20  AM-FLI-BANK-NO            PIC X(5).
  4434             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4435             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4436             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4437         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4438             20  AM-FLI-AGT                PIC X(9).
  4439             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4440             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4441         16  FILLER                        PIC X(102).
  4442
  4443     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4444         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4445             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4446             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4447             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4448             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4449             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  87
* EL689.cbl
  4450         16  FILLER                          PIC X(10).
  4451******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  88
* EL689.cbl
  4453*    COPY ERCARCH.
  4454******************************************************************
  4455*                                                                *
  4456*                            ERCARCH.                            *
  4457*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4458*                            VMOD=2.002                          *
  4459*                                                                *
  4460*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4461*                                                                *
  4462*   FILE TYPE = VSAM,KSDS                                        *
  4463*   RECORD SIZE = 250  RECFORM = FIXED                           *
  4464*                                                                *
  4465*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  4466*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  4467*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  4468*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  4469*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  4470*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  4471*                                                                *
  4472*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4473******************************************************************
  4474*                   C H A N G E   L O G
  4475*
  4476* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4477*-----------------------------------------------------------------
  4478*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4479* EFFECTIVE    NUMBER
  4480*-----------------------------------------------------------------
  4481* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  4482* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4483* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4484******************************************************************
  4485 01  LETTER-ARCHIVE.
  4486     12  LA-RECORD-ID                PIC  X(02).
  4487         88  LA-VALID-ID                VALUE 'LA'.
  4488
  4489     12  LA-CONTROL-PRIMARY.
  4490         16  LA-COMPANY-CD           PIC  X(01).
  4491         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  4492
  4493     12  LA-CONTROL-BY-CERT-RESP.
  4494         16  LA-COMPANY-CD-A2        PIC  X(01).
  4495         16  LA-CERT-NO-A2.
  4496             20  LA-CERT-PRIME-A2    PIC  X(10).
  4497             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  4498         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  4499             20  LA-RESP-PERSON-A2   PIC  X(10).
  4500             20  LA-TYPE-A2          PIC  X(01).
  4501         16  LA-CARRIER-A2           PIC  X(01).
  4502         16  LA-GROUPING-A2          PIC  X(06).
  4503         16  LA-STATE-A2             PIC  X(02).
  4504         16  LA-ACCOUNT-A2           PIC  X(10).
  4505         16  LA-EFFECT-DATE-A2       PIC  X(02).
  4506         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  4507
  4508     12  LA-CONTROL-BY-FORM.
  4509         16  LA-COMPANY-CD-A3        PIC  X(01).
  4510         16  LA-FORM-A3              PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  89
* EL689.cbl
  4511         16  LA-CARRIER-A3           PIC  X(01).
  4512         16  LA-GROUPING-A3          PIC  X(06).
  4513         16  LA-STATE-A3             PIC  X(02).
  4514         16  LA-ACCOUNT-A3           PIC  X(10).
  4515         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  4516
  4517     12  LA-CONTROL-BY-PROCESSOR.
  4518         16  LA-COMPANY-CD-A4        PIC  X(01).
  4519         16  LA-PROCESSOR-CD         PIC  X(04).
  4520         16  LA-CARRIER-A4           PIC  X(01).
  4521         16  LA-GROUPING-A4          PIC  X(06).
  4522         16  LA-STATE-A4             PIC  X(02).
  4523         16  LA-ACCOUNT-A4           PIC  X(10).
  4524         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  4525
  4526     12  LA-CONTROL-BY-KEY-FIELDS.
  4527         16  LA-COMPANY-CD-A5        PIC  X(01).
  4528         16  LA-CARRIER-A5           PIC  X(01).
  4529         16  LA-GROUPING-A5          PIC  X(06).
  4530         16  LA-STATE-A5             PIC  X(02).
  4531         16  LA-ACCOUNT-A5           PIC  X(10).
  4532         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  4533
  4534     12  LA-CONTROL-BY-GROUP-CODE.
  4535         16  LA-COMPANY-CD-A6        PIC  X(01).
  4536         16  LA-ENTRY-A6.
  4537             20  LA-FILLER           PIC  X(02).
  4538             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  4539         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  4540
  4541     12  FILLER                      PIC  X(09).
  4542
  4543     12  LA-HEADER-RECORD.
  4544         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  4545         16  LA-CREATION-DATE        PIC  X(02).
  4546         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  4547         16  LA-FINAL-ACT-DATE       REDEFINES
  4548               LA-FOLLOW-UP-DATE     PIC  X(02).
  4549         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  4550         16  LA-NO-OF-COPIES         PIC S9(01).
  4551         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  4552         16  LA-REPLY-DATE           PIC  X(02).
  4553         16  LA-RESEND-DATES.
  4554             20  LA-RESEND-DATE      PIC  X(02).
  4555             20  LA-SENT-DATE        PIC  X(02).
  4556             20  FILLER              PIC  X(08).
  4557         16  LA-SOURCE-INFORMATION.
  4558             20  LA-DATA-SOURCE      PIC  X(01).
  4559             20  LA-ADDR-SOURCE      PIC  X(01).
  4560         16  LA-STATUS               PIC  X(01).
  4561             88  LA-STATUS-ACTIVE         VALUE 'A'.
  4562             88  LA-STATUS-COMPLETED      VALUE 'C'.
  4563             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  4564             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  4565             88  LA-STATUS-PURGED         VALUE 'P'.
  4566             88  LA-STATUS-VOIDED         VALUE 'V'.
  4567         16  LA-LAST-RESENT-PRINT-DATE
  4568                                     PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  90
* EL689.cbl
  4569         16  LA-PRINT-RESTRICTION    PIC  X(01).
  4570             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4571                                          VALUE 'C'.
  4572             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4573                                          VALUE 'F'.
  4574             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4575                                          VALUE 'P'.
  4576         16  LA-PURGED-DATE          PIC  X(02).
  4577         16  LA-VOIDED-DATE          PIC  X(02).
  4578         16  LA-RESEND-LETR          PIC  X(4).
  4579         16  FILLER                  PIC  X(08).
  4580*        16  LA-RESEND-LETR-2        PIC  X(4).
  4581*        16  LA-RESEND-LETR-3        PIC  X(4).
  4582*        16  FILLER                  PIC  X(59).
  4583         16  LA-ARCHIVE-STATUS       PIC  X.
  4584             88  LA-TEMP                VALUE 'T'.
  4585             88  LA-QWS                 VALUE 'Q'.
  4586             88  LA-BATCH               VALUE 'B'.
  4587         16  LA-FINAL-ACT-IND        PIC  X(1).
  4588         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  4589         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  4590         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  4591                                     PIC X(4).
  4592         16  FILLER                  PIC  X(42).
  4593*        16  FILLER                  PIC  X(71).
  4594         16  LA-LAST-MAINT-DATE      PIC  X(2).
  4595         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  4596         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  4597                                     PIC  X(4).
  4598         16  LA-LAST-UPDATED-BY      PIC  X(4).
  4599
  4600******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  91
* EL689.cbl
  4602*    COPY ERCARCT.
  4603******************************************************************
  4604*                                                                *
  4605*                            ERCARCT.                            *
  4606*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4607*                            VMOD=2.002                          *
  4608*                                                                *
  4609*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  4610*                                                                *
  4611*   FILE TYPE = VSAM,KSDS                                        *
  4612*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  4613*                                                                *
  4614*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  4615*                                                                *
  4616*   LOG = NO                                                     *
  4617*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4618******************************************************************
  4619*                   C H A N G E   L O G
  4620*
  4621* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4622*-----------------------------------------------------------------
  4623*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4624* EFFECTIVE    NUMBER
  4625*-----------------------------------------------------------------
  4626* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4627******************************************************************
  4628 01  LETTER-ARCHIVE-TEXT.
  4629     12  LT-RECORD-ID                PIC  X(02).
  4630         88  LT-VALID-ID                VALUE 'LT'.
  4631
  4632     12  LT-CONTROL-PRIMARY.
  4633         16  LT-COMPANY-CD           PIC  X(01).
  4634         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  4635         16  LT-RECORD-TYPE          PIC  X(01).
  4636             88  LT-ADDRESS-DATA        VALUE '1'.
  4637             88  LT-TEXT-DATA           VALUE '2'.
  4638             88  LT-COMMENT-DATA        VALUE '3'.
  4639         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  4640
  4641     12  FILLER                      PIC  X(28).
  4642     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  4643
  4644     12  LT-TEXT-RECORD.
  4645         16  LT-LETTER-TEXT OCCURS 20 TIMES
  4646                            INDEXED BY LT-NDX.
  4647             20  LT-TEXT-LINE        PIC  X(70).
  4648             20  LT-SKIP-CONTROL     PIC  X(02).
  4649                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  4650                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  4651             20  FILLER              PIC  X(08).
  4652
  4653     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  4654         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  4655             20  LT-COMMENT-LINE     PIC X(69).
  4656             20  LT-COMMENT-CHG-DT   PIC X(02).
  4657             20  LT-COMMENT-CHG-BY   PIC X(04).
  4658             20  FILLER              PIC X(05).
  4659
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  92
* EL689.cbl
  4661*    COPY ELCCERT.
  4662******************************************************************
  4663*                                                                *
  4664*                            ELCCERT.                            *
  4665*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4666*                            VMOD=2.013                          *
  4667*                                                                *
  4668*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4669*                                                                *
  4670*   FILE TYPE = VSAM,KSDS                                        *
  4671*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4672*                                                                *
  4673*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4674*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4675*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4676*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4677*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4678*                                                                *
  4679*   LOG = YES                                                    *
  4680*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4681******************************************************************
  4682*                   C H A N G E   L O G
  4683*
  4684* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4685*-----------------------------------------------------------------
  4686*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4687* EFFECTIVE    NUMBER
  4688*-----------------------------------------------------------------
  4689* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4690* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4691* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4692* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4693* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4694* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4695* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4696* 032612  CR2011110200001  PEMA  AHL CHANGES
  4697******************************************************************
  4698
  4699 01  CERTIFICATE-MASTER.
  4700     12  CM-RECORD-ID                      PIC XX.
  4701         88  VALID-CM-ID                      VALUE 'CM'.
  4702
  4703     12  CM-CONTROL-PRIMARY.
  4704         16  CM-COMPANY-CD                 PIC X.
  4705         16  CM-CARRIER                    PIC X.
  4706         16  CM-GROUPING.
  4707             20  CM-GROUPING-PREFIX        PIC X(3).
  4708             20  CM-GROUPING-PRIME         PIC X(3).
  4709         16  CM-STATE                      PIC XX.
  4710         16  CM-ACCOUNT.
  4711             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4712             20  CM-ACCOUNT-PRIME          PIC X(6).
  4713         16  CM-CERT-EFF-DT                PIC XX.
  4714         16  CM-CERT-NO.
  4715             20  CM-CERT-PRIME             PIC X(10).
  4716             20  CM-CERT-SFX               PIC X.
  4717
  4718     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  93
* EL689.cbl
  4719         16  CM-COMPANY-CD-A1              PIC X.
  4720         16  CM-INSURED-LAST-NAME          PIC X(15).
  4721         16  CM-INSURED-INITIALS.
  4722             20  CM-INSURED-INITIAL1       PIC X.
  4723             20  CM-INSURED-INITIAL2       PIC X.
  4724
  4725     12  CM-CONTROL-BY-SSN.
  4726         16  CM-COMPANY-CD-A2              PIC X.
  4727         16  CM-SOC-SEC-NO.
  4728             20  CM-SSN-STATE              PIC XX.
  4729             20  CM-SSN-ACCOUNT            PIC X(6).
  4730             20  CM-SSN-LN3.
  4731                 25  CM-INSURED-INITIALS-A2.
  4732                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4733                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4734                 25 CM-PART-LAST-NAME-A2         PIC X.
  4735
  4736     12  CM-CONTROL-BY-CERT-NO.
  4737         16  CM-COMPANY-CD-A4              PIC X.
  4738         16  CM-CERT-NO-A4                 PIC X(11).
  4739
  4740     12  CM-CONTROL-BY-MEMB.
  4741         16  CM-COMPANY-CD-A5              PIC X.
  4742         16  CM-MEMBER-NO.
  4743             20  CM-MEMB-STATE             PIC XX.
  4744             20  CM-MEMB-ACCOUNT           PIC X(6).
  4745             20  CM-MEMB-LN4.
  4746                 25  CM-INSURED-INITIALS-A5.
  4747                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4748                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4749                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4750
  4751     12  CM-INSURED-PROFILE-DATA.
  4752         16  CM-INSURED-FIRST-NAME.
  4753             20  CM-INSURED-1ST-INIT       PIC X.
  4754             20  FILLER                    PIC X(9).
  4755         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4756         16  CM-INSURED-SEX                PIC X.
  4757             88  CM-SEX-MALE                  VALUE 'M'.
  4758             88  CM-SEX-FEMAL                 VALUE 'F'.
  4759         16  CM-INSURED-JOINT-AGE          PIC 99.
  4760         16  CM-JOINT-INSURED-NAME.
  4761             20  CM-JT-LAST-NAME           PIC X(15).
  4762             20  CM-JT-FIRST-NAME.
  4763                 24  CM-JT-1ST-INIT        PIC X.
  4764                 24  FILLER                PIC X(9).
  4765             20  CM-JT-INITIAL             PIC X.
  4766
  4767     12  CM-LIFE-DATA.
  4768         16  CM-LF-BENEFIT-CD              PIC XX.
  4769         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4770         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4771         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4772         16  CM-LF-DEV-CODE                PIC XXX.
  4773         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4774         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4775         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4776         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  94
* EL689.cbl
  4777         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4778         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4779         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4780         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4781         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4782         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4783         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4784         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4785         16  FILLER                        PIC XX.
  4786
  4787     12  CM-AH-DATA.
  4788         16  CM-AH-BENEFIT-CD              PIC XX.
  4789         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4790         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4791         16  CM-AH-DEV-CODE                PIC XXX.
  4792         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4793         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4794         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4795         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4796         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4797         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4798         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4799         16  CM-AH-PAID-THRU-DT            PIC XX.
  4800             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4801         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4802         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4803         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4804         16  FILLER                        PIC X.
  4805
  4806     12  CM-LOAN-INFORMATION.
  4807         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4808         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4809                                           PIC S9(5)V99  COMP-3.
  4810         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4811         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4812         16  CM-PAY-FREQUENCY              PIC S99.
  4813         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4814         16  CM-RATE-CLASS                 PIC XX.
  4815         16  CM-BENEFICIARY                PIC X(25).
  4816         16  CM-POLICY-FORM-NO             PIC X(12).
  4817         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4818         16  CM-LAST-ADD-ON-DT             PIC XX.
  4819         16  CM-DEDUCTIBLE-AMOUNTS.
  4820             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4821             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4822         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4823             20  CM-RESIDENT-STATE         PIC XX.
  4824             20  CM-RATE-CODE              PIC X(4).
  4825             20  FILLER                    PIC XX.
  4826         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4827             20  CM-LOAN-OFFICER           PIC X(5).
  4828             20  FILLER                    PIC XXX.
  4829         16  CM-CSR-CODE                   PIC XXX.
  4830         16  CM-UNDERWRITING-CODE          PIC X.
  4831             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4832         16  CM-POST-CARD-IND              PIC X.
  4833         16  CM-NH-INTERFACE-SW            PIC X.
  4834         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  95
* EL689.cbl
  4835             88  CM-SING-PRM                  VALUE '1'.
  4836             88  CM-O-B-COVERAGE              VALUE '2'.
  4837             88  CM-OPEN-END                  VALUE '3'.
  4838         16  CM-IND-GRP-TYPE               PIC X.
  4839             88  CM-INDIVIDUAL                VALUE 'I'.
  4840             88  CM-GROUP                     VALUE 'G'.
  4841         16  CM-SKIP-CODE                  PIC X.
  4842             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4843             88  SKIP-JULY                    VALUE '1'.
  4844             88  SKIP-AUGUST                  VALUE '2'.
  4845             88  SKIP-SEPTEMBER               VALUE '3'.
  4846             88  SKIP-JULY-AUG                VALUE '4'.
  4847             88  SKIP-AUG-SEPT                VALUE '5'.
  4848             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4849             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4850             88  SKIP-JUNE                    VALUE '8'.
  4851             88  SKIP-JUNE-JULY               VALUE '9'.
  4852             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4853             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4854         16  CM-PAYMENT-MODE               PIC X.
  4855             88  PAY-MONTHLY                  VALUE SPACE.
  4856             88  PAY-WEEKLY                   VALUE '1'.
  4857             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4858             88  PAY-BI-WEEKLY                VALUE '3'.
  4859             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4860         16  CM-LOAN-NUMBER                PIC X(8).
  4861         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4862         16  CM-OLD-LOF                    PIC XXX.
  4863*        16  CM-LOAN-OFFICER               PIC XXX.
  4864         16  CM-REIN-TABLE                 PIC XXX.
  4865         16  CM-SPECIAL-REIN-CODE          PIC X.
  4866         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4867         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4868         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4869
  4870     12  CM-STATUS-DATA.
  4871         16  CM-ENTRY-STATUS               PIC X.
  4872         16  CM-ENTRY-DT                   PIC XX.
  4873
  4874         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4875         16  CM-LF-CANCEL-DT               PIC XX.
  4876         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4877
  4878         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4879         16  CM-LF-DEATH-DT                PIC XX.
  4880         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4881
  4882         16  CM-LF-CURRENT-STATUS          PIC X.
  4883             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4884                                                'M' '4' '5' '9'.
  4885             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4886             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4887             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4888             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4889             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4890             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4891             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4892             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  96
* EL689.cbl
  4893             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4894             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4895             88  CM-LF-DECLINED               VALUE 'D'.
  4896             88  CM-LF-VOIDED                 VALUE 'V'.
  4897
  4898         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4899         16  CM-AH-CANCEL-DT               PIC XX.
  4900         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4901
  4902         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4903         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4904         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4905
  4906         16  CM-AH-CURRENT-STATUS          PIC X.
  4907             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4908                                                'M' '4' '5' '9'.
  4909             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4910             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4911             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4912             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4913             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4914             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4915             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4916             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4917             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4918             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4919             88  CM-AH-DECLINED               VALUE 'D'.
  4920             88  CM-AH-VOIDED                 VALUE 'V'.
  4921
  4922         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4923             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4924             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4925             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4926         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4927
  4928         16  CM-ENTRY-BATCH                PIC X(6).
  4929         16  CM-LF-EXIT-BATCH              PIC X(6).
  4930         16  CM-AH-EXIT-BATCH              PIC X(6).
  4931         16  CM-LAST-MONTH-END             PIC XX.
  4932
  4933     12  CM-NOTE-SW                        PIC X.
  4934         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4935         88  CERT-NOTES-PRESENT               VALUE '1'.
  4936         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4937         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4938         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4939         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4940         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4941         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4942     12  CM-COMP-EXCP-SW                   PIC X.
  4943         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4944         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4945     12  CM-INSURED-ADDRESS-SW             PIC X.
  4946         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4947         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4948
  4949*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4950     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  97
* EL689.cbl
  4951     12  FILLER                            PIC X.
  4952
  4953*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4954     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4955     12  FILLER                            PIC X.
  4956*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4957     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4958
  4959     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4960         88  CERT-ADDED-BATCH                 VALUE ' '.
  4961         88  CERT-ADDED-ONLINE                VALUE '1'.
  4962         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4963         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4964         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4965     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4966         88  CERT-AS-LOADED                   VALUE ' '.
  4967         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4968         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4969         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4970         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4971         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4972         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4973         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4974
  4975     12  CM-ACCOUNT-COMM-PCTS.
  4976         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4977         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4978
  4979     12  CM-USER-FIELD                     PIC X.
  4980     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4981     12  CM-CLP-STATE                      PIC XX.
  4982     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4983     12  CM-USER-RESERVED                  PIC XXX.
  4984     12  FILLER REDEFINES CM-USER-RESERVED.
  4985         16  CM-AH-CLASS-CD                PIC XX.
  4986         16  F                             PIC X.
  4987******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  98
* EL689.cbl
  4989*    COPY ERCCHEK.
  4990******************************************************************
  4991*                                                                *
  4992*                                                                *
  4993*                            ERCCHEK                             *
  4994*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4995*                            VMOD=2.008                          *
  4996*                                                                *
  4997*   FILE DESCRIPTION = CHECK RECORDS                             *
  4998*                                                                *
  4999*   FILE TYPE = VSAM,KSDS                                        *
  5000*   RECORD SIZE = 600    RECFORM = FIXED                         *
  5001*                                                                *
  5002*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  5003*       ALTERNATE INDEX = NONE                                   *
  5004*                                                                *
  5005*   LOG = YES                                                    *
  5006*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5007******************************************************************
  5008 01  CHECK-RECORDS.
  5009     12  CH-RECORD-ID                      PIC XX.
  5010         88  VALID-CH-ID                      VALUE 'CH'.
  5011
  5012     12  CH-CONTROL-PRIMARY.
  5013         16  CH-COMPANY-CD                 PIC X.
  5014         16  CH-CARRIER                    PIC X.
  5015         16  CH-GROUPING                   PIC X(6).
  5016         16  CH-STATE                      PIC XX.
  5017         16  CH-ACCOUNT                    PIC X(10).
  5018         16  CH-CERT-EFF-DT                PIC XX.
  5019         16  CH-CERT-NO.
  5020             20  CH-CERT-PRIME             PIC X(10).
  5021             20  CH-CERT-SFX               PIC X.
  5022         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  5023
  5024     12  CH-RECORDED-DT                    PIC XX.
  5025     12  CH-RECORDED-BY                    PIC X(4).
  5026     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  5027
  5028     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  5029     12  CH-CHECK-NO                       PIC X(7).
  5030     12  CH-REASON-FOR-CHECK               PIC X(25).
  5031     12  CH-CHECK-WRITTEN-DT               PIC XX.
  5032     12  CH-OFFLINE-CHECK-IND              PIC X.
  5033         88  MANUAL-CHECK-WRITTEN             VALUE 'Y'.
  5034
  5035     12  CH-PAYEE-INFO.
  5036         16  CH-PAYEE-NAME-1               PIC X(30).
  5037         16  CH-PAYEE-NAME-2               PIC X(30).
  5038         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  5039         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  5040         16  CH-PAYEE-CITY-ST              PIC X(30).
  5041         16  CH-PAYEE-ZIP-CODE.
  5042             20  CH-PAYEE-ZIP.
  5043                 24  CH-ZIP-PRI-1ST        PIC X.
  5044                     88  CH-CANADIAN-POST-CODE
  5045                                           VALUES 'A' THRU 'Z'.
  5046                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page  99
* EL689.cbl
  5047             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  5048         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  5049             20  CH-CAN-POSTAL-1           PIC XXX.
  5050             20  CH-CAN-POSTAL-2           PIC XXX.
  5051             20  FILLER                    PIC XXX.
  5052
  5053     12  CH-CHECK-STUB-TEXT.
  5054         16  CH-STUB-LINE-1                PIC X(50).
  5055         16  CH-STUB-LINE-2                PIC X(50).
  5056         16  CH-STUB-LINE-3                PIC X(50).
  5057         16  FILLER.
  5058           18  CH-STUB-LINE-4              PIC X(20).
  5059           18  CH-LIENHOLDER-NAME          PIC X(30).
  5060
  5061     12  CH-COMPENSATION-CONTROL.
  5062         16  CH-COMP-CARRIER               PIC X.
  5063         16  CH-COMP-GROUPING              PIC X(6).
  5064         16  CH-COMP-FIN-RESP              PIC X(10).
  5065         16  CH-COMP-ACCOUNT               PIC X(10).
  5066
  5067     12  CH-CREDIT-SELECT-DT               PIC XX.
  5068     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  5069     12  CH-PAYEE-CODE                     PIC X(6).
  5070
  5071     12  CH-VOID-DATA.
  5072         20  CH-VOID-DT                    PIC XX.
  5073         20  CH-VOID-BY                    PIC X(4).
  5074         20  CH-VOID-REASON                PIC X(25).
  5075
  5076     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  5077             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5078     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  5079
  5080     12  CH-CHECK-REFERENCE                PIC X(12).
  5081     12  CH-CHECK-ORIGIN-SW                PIC X.
  5082             88  CH-REFUND-CHECK              VALUE 'R'.
  5083             88  CH-MAINT-CHECK               VALUE 'M'.
  5084
  5085     12  CH-CANC-DT                        PIC XX.
  5086     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  5087     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  5088
  5089     12  CH-INSURED-NAME                   PIC X(28).
  5090
  5091     12  CH-DEDUCT-WITHHELD                PIC S9(5)V99  COMP-3.
  5092     12  CH-ADDITIONAL-CHARGE              PIC S9(5)V99  COMP-3.
  5093
  5094     12  CH-LETTER-TABLE.
  5095         16  CH-LETTERS OCCURS 3 TIMES
  5096                        INDEXED BY CH-LT-NDX
  5097                                           PIC X(04).
  5098
  5099     12  FILLER                            PIC X(07).
  5100
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 100
* EL689.cbl
  5102*    COPY ELCCNTL.
  5103******************************************************************
  5104*                                                                *
  5105*                                                                *
  5106*                            ELCCNTL.                            *
  5107*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5108*                            VMOD=2.059                          *
  5109*                                                                *
  5110*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5111*                                                                *
  5112*   FILE TYPE = VSAM,KSDS                                        *
  5113*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5114*                                                                *
  5115*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5116*       ALTERNATE INDEX = NONE                                   *
  5117*                                                                *
  5118*   LOG = YES                                                    *
  5119*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5120******************************************************************
  5121*                   C H A N G E   L O G
  5122*
  5123* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5124*-----------------------------------------------------------------
  5125*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5126* EFFECTIVE    NUMBER
  5127*-----------------------------------------------------------------
  5128* 082503                   PEMA  ADD BENEFIT GROUP
  5129* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5130* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5131* 092705    2005050300006  PEMA  ADD SPP LEASES
  5132* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5133* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5134* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5135* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5136* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5137* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5138* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5139* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5140* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5141******************************************************************
  5142*
  5143 01  CONTROL-FILE.
  5144     12  CF-RECORD-ID                       PIC XX.
  5145         88  VALID-CF-ID                        VALUE 'CF'.
  5146
  5147     12  CF-CONTROL-PRIMARY.
  5148         16  CF-COMPANY-ID                  PIC XXX.
  5149         16  CF-RECORD-TYPE                 PIC X.
  5150             88  CF-COMPANY-MASTER              VALUE '1'.
  5151             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5152             88  CF-STATE-MASTER                VALUE '3'.
  5153             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5154             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5155             88  CF-CARRIER-MASTER              VALUE '6'.
  5156             88  CF-MORTALITY-MASTER            VALUE '7'.
  5157             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5158             88  CF-TERMINAL-MASTER             VALUE '9'.
  5159             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 101
* EL689.cbl
  5160             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5161             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5162             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5163             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5164             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5165             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5166             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5167             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5168         16  CF-ACCESS-CD-GENL              PIC X(4).
  5169         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5170             20  CF-PROCESSOR               PIC X(4).
  5171         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5172             20  CF-STATE-CODE              PIC XX.
  5173             20  FILLER                     PIC XX.
  5174         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5175             20  FILLER                     PIC XX.
  5176             20  CF-HI-BEN-IN-REC           PIC XX.
  5177         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5178             20  FILLER                     PIC XXX.
  5179             20  CF-CARRIER-CNTL            PIC X.
  5180         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5181             20  FILLER                     PIC XX.
  5182             20  CF-HI-TYPE-IN-REC          PIC 99.
  5183         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5184             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5185                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5186             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5187             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5188         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5189             20  FILLER                     PIC X.
  5190             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5191         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5192             20  FILLER                     PIC XX.
  5193             20  CF-MORTGAGE-PLAN           PIC XX.
  5194         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5195
  5196     12  CF-LAST-MAINT-DT                   PIC XX.
  5197     12  CF-LAST-MAINT-BY                   PIC X(4).
  5198     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5199
  5200     12  CF-RECORD-BODY                     PIC X(728).
  5201
  5202
  5203****************************************************************
  5204*             COMPANY MASTER RECORD                            *
  5205****************************************************************
  5206
  5207     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5208         16  CF-COMPANY-ADDRESS.
  5209             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5210             20  CF-CL-IN-CARE-OF           PIC X(30).
  5211             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5212             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5213             20  CF-CL-CITY-STATE           PIC X(30).
  5214             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5215             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5216         16  CF-COMPANY-CD                  PIC X.
  5217         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 102
* EL689.cbl
  5218         16  CF-SECURITY-OPTION             PIC X.
  5219             88  ALL-SECURITY                   VALUE '1'.
  5220             88  COMPANY-VERIFY                 VALUE '2'.
  5221             88  PROCESSOR-VERIFY               VALUE '3'.
  5222             88  NO-SECURITY                    VALUE '4'.
  5223             88  ALL-BUT-TERM                   VALUE '5'.
  5224         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5225             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5226         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5227             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5228         16  CF-INFORCE-LOCATION            PIC X.
  5229             88  CERTS-ARE-ONLINE               VALUE '1'.
  5230             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5231             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5232         16  CF-LOWER-CASE-LETTERS          PIC X.
  5233         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5234             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5235             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5236             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5237             88  CF-ACCNT-CNTL                  VALUE '3'.
  5238             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5239
  5240         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5241         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5242
  5243         16  CF-LGX-CREDIT-USER             PIC X.
  5244             88  CO-IS-NOT-USER                 VALUE 'N'.
  5245             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5246
  5247         16 CF-CREDIT-CALC-CODES.
  5248             20  CF-CR-REM-TERM-CALC PIC X.
  5249               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5250               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5251               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5252               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5253               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5254               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5255               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5256             20  CF-CR-R78-METHOD           PIC X.
  5257               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5258               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5259
  5260         16  CF-CLAIM-CONTROL-COUNTS.
  5261             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5262                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5263
  5264             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5265                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5266
  5267             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5268                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5269
  5270             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5271                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5272
  5273         16  CF-CURRENT-MONTH-END           PIC XX.
  5274
  5275         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 103
* EL689.cbl
  5276             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5277             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5278             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5279             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5280                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5281                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5282             20  CF-CO-PREM-REJECT-SW       PIC X.
  5283                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5284                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5285             20  CF-CO-REF-REJECT-SW        PIC X.
  5286                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5287                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5288
  5289         16  CF-CO-REPORTING-DT             PIC XX.
  5290         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5291         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5292           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5293           88  CF-CO-MONTH-END                  VALUE '1'.
  5294
  5295         16  CF-LGX-CLAIM-USER              PIC X.
  5296             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5297             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5298
  5299         16  CF-CREDIT-EDIT-CONTROLS.
  5300             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5301             20  CF-MIN-AGE                 PIC 99.
  5302             20  CF-DEFAULT-AGE             PIC 99.
  5303             20  CF-MIN-TERM                PIC S999      COMP-3.
  5304             20  CF-MAX-TERM                PIC S999      COMP-3.
  5305             20  CF-DEFAULT-SEX             PIC X.
  5306             20  CF-JOINT-AGE-INPUT         PIC X.
  5307                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5308             20  CF-BIRTH-DATE-INPUT        PIC X.
  5309                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5310             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5311                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5312                 88  CF-ZERO-CARRIER            VALUE '1'.
  5313                 88  CF-ZERO-GROUPING           VALUE '2'.
  5314                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5315             20  CF-EDIT-SW                 PIC X.
  5316                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5317             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5318             20  CF-CR-PR-METHOD            PIC X.
  5319               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5320               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5321             20  FILLER                     PIC X.
  5322
  5323         16  CF-CREDIT-MISC-CONTROLS.
  5324             20  CF-REIN-TABLE-SW           PIC X.
  5325                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5326             20  CF-COMP-TABLE-SW           PIC X.
  5327                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5328             20  CF-EXPERIENCE-RETENTION-AGE
  5329                                            PIC S9        COMP-3.
  5330             20  CF-CONVERSION-DT           PIC XX.
  5331             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5332             20  CF-RUN-FREQUENCY-SW        PIC X.
  5333                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 104
* EL689.cbl
  5334                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5335
  5336             20  CF-CR-CHECK-NO-CONTROL.
  5337                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5338                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5339                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5340                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5341                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5342                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5343
  5344                 24  CF-CR-CHECK-COUNT       REDEFINES
  5345                     CF-CR-CHECK-COUNTER      PIC X(4).
  5346
  5347                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5348                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5349
  5350                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5351                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5352                 24  CF-MAIL-PROCESSING       PIC X.
  5353                     88  MAIL-PROCESSING          VALUE 'Y'.
  5354
  5355         16  CF-MISC-SYSTEM-CONTROL.
  5356             20  CF-SYSTEM-C                 PIC X.
  5357                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5358             20  CF-SYSTEM-D                 PIC X.
  5359                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5360             20  CF-SOC-SEC-NO-SW            PIC X.
  5361                 88  SOC-SEC-NO-USED             VALUE '1'.
  5362             20  CF-MEMBER-NO-SW             PIC X.
  5363                 88  MEMBER-NO-USED              VALUE '1'.
  5364             20  CF-TAX-ID-NUMBER            PIC X(11).
  5365             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5366             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5367                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5368                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5369                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5370                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5371             20  CF-SYSTEM-E                 PIC X.
  5372                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5373
  5374         16  CF-LGX-LIFE-USER               PIC X.
  5375             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5376             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5377
  5378         16  CF-CR-MONTH-END-DT             PIC XX.
  5379
  5380         16  CF-FILE-MAINT-DATES.
  5381             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5382                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5383             20  CF-LAST-BATCH       REDEFINES
  5384                 CF-LAST-BATCH-NO               PIC X(4).
  5385             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5386             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5387             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5388             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5389             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5390             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5391             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 105
* EL689.cbl
  5392             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5393             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5394             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5395
  5396         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5397         16  FILLER                         PIC X.
  5398
  5399         16  CF-ALT-MORT-CODE               PIC X(4).
  5400         16  CF-MEMBER-CAPTION              PIC X(10).
  5401
  5402         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5403             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5404             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5405             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5406             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5407             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5408
  5409         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5410
  5411         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5412         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5413         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5414         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5415
  5416         16  CF-AH-OVERRIDE-L1              PIC X.
  5417         16  CF-AH-OVERRIDE-L2              PIC XX.
  5418         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5419         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5420
  5421         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5422         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5423
  5424         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5425         16  CF-AR-LAST-EL860-DT            PIC XX.
  5426         16  CF-MP-MONTH-END-DT             PIC XX.
  5427
  5428         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5429         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5430             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5431
  5432         16  CF-AR-MONTH-END-DT             PIC XX.
  5433
  5434         16  CF-CRDTCRD-USER                PIC X.
  5435             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5436             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5437
  5438         16  CF-CC-MONTH-END-DT             PIC XX.
  5439
  5440         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5441
  5442         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5443             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5444             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5445             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5446         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5447         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5448         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5449         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 106
* EL689.cbl
  5450             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5451             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5452         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5453         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5454         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5455             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5456         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5457
  5458         16  CF-CL-ZIP-CODE.
  5459             20  CF-CL-ZIP-PRIME.
  5460                 24  CF-CL-ZIP-1ST          PIC X.
  5461                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5462                 24  FILLER                 PIC X(4).
  5463             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5464         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5465             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5466             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5467             20  FILLER                     PIC XXX.
  5468
  5469         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5470         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5471         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5472         16  CF-CO-OPTION-START-DATE        PIC XX.
  5473         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5474           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5475                                                      '3' '4'.
  5476           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5477           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5478           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5479           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5480           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5481           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5482
  5483         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5484
  5485         16  CF-PAYMENT-APPROVAL-LEVELS.
  5486             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5487             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5488             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5489             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5490             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5491             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5492
  5493         16  CF-END-USER-REPORTING-USER     PIC X.
  5494             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5495             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5496
  5497         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5498             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5499             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5500
  5501         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5502
  5503         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5504         16  FILLER                         PIC X.
  5505
  5506         16  CF-CREDIT-ARCHIVE-CNTL.
  5507             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 107
* EL689.cbl
  5508             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5509             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5510
  5511         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5512
  5513         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5514             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5515             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5516
  5517         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5518             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5519             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5520
  5521         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5522
  5523         16  CF-CO-ACH-ID-CODE              PIC  X.
  5524             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5525             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5526             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5527         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5528         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5529         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5530         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5531         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5532         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5533         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5534         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5535         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5536                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5537         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5538                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5539
  5540         16  CF-CO-OVER-SHORT.
  5541             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5542             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5543
  5544*         16  FILLER                         PIC X(102).
  5545         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5546             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5547             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5548
  5549         16  CF-AH-APPROVAL-DAYS.
  5550             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5551             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5552             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5553             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5554
  5555         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5556
  5557         16  CF-APPROV-LEV-5.
  5558             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5559             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5560             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5561
  5562         16  FILLER                         PIC X(68).
  5563****************************************************************
  5564*             PROCESSOR/USER RECORD                            *
  5565****************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 108
* EL689.cbl
  5566
  5567     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5568         16  CF-PROCESSOR-NAME              PIC X(30).
  5569         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5570         16  CF-PROCESSOR-TITLE             PIC X(26).
  5571         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5572                 88  MESSAGE-YES                VALUE 'Y'.
  5573                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5574
  5575*****************************************************
  5576****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5577****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5578****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5579****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5580*****************************************************
  5581
  5582         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5583             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5584             20  CF-APPLICATION-FORCE       PIC X.
  5585             20  CF-INDIVIDUAL-APP.
  5586                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5587                     28  CF-BROWSE-APP      PIC X.
  5588                     28  CF-UPDATE-APP      PIC X.
  5589
  5590         16  CF-CURRENT-TERM-ON             PIC X(4).
  5591         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5592             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5593             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5594             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5595             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5596             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5597             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5598             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5599         16  CF-PROCESSOR-CARRIER           PIC X.
  5600             88  NO-CARRIER-SECURITY            VALUE ' '.
  5601         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5602             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5603         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5604             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5605         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5606             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5607
  5608         16  CF-PROC-SYS-ACCESS-SW.
  5609             20  CF-PROC-CREDIT-CLAIMS-SW.
  5610                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5611                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5612                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5613                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5614             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5615                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5616                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5617             20  CF-PROC-LIFE-GNRLDGR-SW.
  5618                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5619                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5620                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5621                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5622             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5623                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 109
* EL689.cbl
  5624                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5625         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5626             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5627             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5628         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5629
  5630         16  CF-APPROVAL-LEVEL                  PIC X.
  5631             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5632             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5633             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5634             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5635             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5636
  5637         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5638
  5639         16  CF-LANGUAGE-TYPE                   PIC X.
  5640             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5641             88  CF-LANG-IS-FR                      VALUE 'F'.
  5642
  5643         16  CF-CSR-IND                         PIC X.
  5644         16  FILLER                             PIC X(239).
  5645
  5646****************************************************************
  5647*             PROCESSOR/REMINDERS RECORD                       *
  5648****************************************************************
  5649
  5650     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5651         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5652             20  CF-START-REMIND-DT         PIC XX.
  5653             20  CF-END-REMIND-DT           PIC XX.
  5654             20  CF-REMINDER-TEXT           PIC X(50).
  5655         16  FILLER                         PIC X(296).
  5656
  5657
  5658****************************************************************
  5659*             STATE MASTER RECORD                              *
  5660****************************************************************
  5661
  5662     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5663         16  CF-STATE-ABBREVIATION          PIC XX.
  5664         16  CF-STATE-NAME                  PIC X(25).
  5665         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5666         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5667             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5668             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5669             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5670             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5671                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5672                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5673             20  CF-ST-PREM-REJECT-SW       PIC X.
  5674                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5675                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5676             20  CF-ST-REF-REJECT-SW        PIC X.
  5677                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5678                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5679         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5680         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5681         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 110
* EL689.cbl
  5682             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5683             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5684             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5685         16  CF-ST-FST-PMT-EXTENSION.
  5686             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5687             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5688                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5689                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5690                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5691                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5692         16  CF-ST-STATE-CALL.
  5693             20  CF-ST-CALL-UNEARNED        PIC X.
  5694             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5695             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5696         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5697             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5698             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5699         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5700         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5701         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5702         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5703         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5704         16  FILLER                         PIC X.
  5705         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5706             20  CF-ST-BENEFIT-CD           PIC XX.
  5707             20  CF-ST-BENEFIT-KIND         PIC X.
  5708                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5709                 88  CF-ST-AH-KIND              VALUE 'A'.
  5710             20  CF-ST-REM-TERM-CALC        PIC X.
  5711                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5712                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5713                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5714                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5715                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5716                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5717                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5718                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5719
  5720             20  CF-ST-REFUND-CALC          PIC X.
  5721                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5722                 88  ST-REFD-BY-R78             VALUE '1'.
  5723                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5724                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5725                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5726                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5727                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5728                 88  ST-REFD-UTAH               VALUE '7'.
  5729                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5730                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5731                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5732
  5733             20  CF-ST-EARNING-CALC         PIC X.
  5734                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5735                 88  ST-EARN-BY-R78             VALUE '1'.
  5736                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5737                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5738                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5739                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 111
* EL689.cbl
  5740                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5741                 88  ST-EARN-MEAN               VALUE '8'.
  5742                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5743
  5744             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5745                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5746                 88  ST-OVRD-BY-R78             VALUE '1'.
  5747                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5748                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5749                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5750                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5751                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5752                 88  ST-OVRD-MEAN               VALUE '8'.
  5753                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5754             20  FILLER                     PIC X.
  5755
  5756         16  CF-ST-COMMISSION-CAPS.
  5757             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5758             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5759             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5760             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5761         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5762                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5763
  5764         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5765
  5766         16  CF-ST-STATUTORY-INTEREST.
  5767             20  CF-ST-STAT-DATE-FROM       PIC X.
  5768                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5769                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5770             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5771             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5772             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5773             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5774             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5775
  5776         16  CF-ST-OVER-SHORT.
  5777             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5778             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5779
  5780         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5781
  5782         16  CF-ST-RT-CALC                  PIC X.
  5783
  5784         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5785         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5786         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5787         16  CF-ST-RF-LR-CALC               PIC X.
  5788         16  CF-ST-RF-LL-CALC               PIC X.
  5789         16  CF-ST-RF-LN-CALC               PIC X.
  5790         16  CF-ST-RF-AH-CALC               PIC X.
  5791         16  CF-ST-RF-CP-CALC               PIC X.
  5792*        16  FILLER                         PIC X(206).
  5793*CIDMOD         16  FILLER                         PIC X(192).
  5794         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5795             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5796         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5797         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 112
* EL689.cbl
  5798         16  CF-ST-CAUSAL-STATE             PIC X.
  5799         16  FILLER                         PIC X(185).
  5800
  5801****************************************************************
  5802*             BENEFIT MASTER RECORD                            *
  5803****************************************************************
  5804
  5805     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5806         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5807             20  CF-BENEFIT-CODE            PIC XX.
  5808             20  CF-BENEFIT-NUMERIC  REDEFINES
  5809                 CF-BENEFIT-CODE            PIC XX.
  5810             20  CF-BENEFIT-ALPHA           PIC XXX.
  5811             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5812             20  CF-BENEFIT-COMMENT         PIC X(10).
  5813
  5814             20  CF-LF-COVERAGE-TYPE        PIC X.
  5815                 88  CF-REDUCING                VALUE 'R'.
  5816                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5817
  5818             20  CF-SPECIAL-CALC-CD         PIC X.
  5819                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5820                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5821                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5822                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5823                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5824                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5825                 88  CF-FARM-PLAN               VALUE 'F'.
  5826                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5827                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5828                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5829                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5830                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5831                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5832                 88  CF-PRUDENTIAL              VALUE 'P'.
  5833                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5834                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5835                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5836                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5837                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5838                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5839
  5840             20  CF-JOINT-INDICATOR         PIC X.
  5841                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5842
  5843*            20  FILLER                     PIC X(12).
  5844             20  FILLER                     PIC X(11).
  5845             20  CF-BENEFIT-CATEGORY        PIC X.
  5846             20  CF-LOAN-TYPE               PIC X(8).
  5847
  5848             20  CF-CO-REM-TERM-CALC        PIC X.
  5849                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5850                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5851                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5852                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5853                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5854
  5855             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 113
* EL689.cbl
  5856                 88  CO-EARN-BY-R78             VALUE '1'.
  5857                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5858                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5859                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5860                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5861                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5862                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5863                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5864
  5865             20  CF-CO-REFUND-CALC          PIC X.
  5866                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5867                 88  CO-REFD-BY-R78             VALUE '1'.
  5868                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5869                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5870                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5871                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5872                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5873                 88  CO-REFD-MEAN               VALUE '8'.
  5874                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5875                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5876                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5877
  5878             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5879                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5880                 88  CO-OVRD-BY-R78             VALUE '1'.
  5881                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5882                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5883                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5884                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5885                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5886                 88  CO-OVRD-MEAN               VALUE '8'.
  5887                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5888
  5889             20  CF-CO-BEN-I-G-CD           PIC X.
  5890                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5891                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5892                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5893
  5894         16  FILLER                         PIC X(304).
  5895
  5896
  5897****************************************************************
  5898*             CARRIER MASTER RECORD                            *
  5899****************************************************************
  5900
  5901     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5902         16  CF-ADDRESS-DATA.
  5903             20  CF-MAIL-TO-NAME            PIC X(30).
  5904             20  CF-IN-CARE-OF              PIC X(30).
  5905             20  CF-ADDRESS-LINE-1          PIC X(30).
  5906             20  CF-ADDRESS-LINE-2          PIC X(30).
  5907             20  CF-CITY-STATE              PIC X(30).
  5908             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5909             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5910
  5911         16  CF-CLAIM-NO-CONTROL.
  5912             20  CF-CLAIM-NO-METHOD         PIC X.
  5913                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 114
* EL689.cbl
  5914                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5915                 88  CLAIM-NO-SEQ               VALUE '3'.
  5916                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5917             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5918                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5919                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5920                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5921
  5922         16  CF-CHECK-NO-CONTROL.
  5923             20  CF-CHECK-NO-METHOD         PIC X.
  5924                 88  CHECK-NO-MANUAL            VALUE '1'.
  5925                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5926                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5927                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5928             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5929                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5930
  5931         16  CF-DOMICILE-STATE              PIC XX.
  5932
  5933         16  CF-EXPENSE-CONTROLS.
  5934             20  CF-EXPENSE-METHOD          PIC X.
  5935                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5936                 88  DOLLARS-PER-PMT            VALUE '2'.
  5937                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5938                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5939             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5940             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5941
  5942         16  CF-CORRESPONDENCE-CONTROL.
  5943             20  CF-LETTER-RESEND-OPT       PIC X.
  5944                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5945                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5946             20  FILLER                     PIC X(4).
  5947
  5948         16  CF-RESERVE-CONTROLS.
  5949             20  CF-MANUAL-SW               PIC X.
  5950                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5951             20  CF-FUTURE-SW               PIC X.
  5952                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5953             20  CF-PTC-SW                  PIC X.
  5954                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5955             20  CF-IBNR-SW                 PIC X.
  5956                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5957             20  CF-PTC-LF-SW               PIC X.
  5958                 88  CF-LF-PTC-USED             VALUE '1'.
  5959             20  CF-CDT-ACCESS-METHOD       PIC X.
  5960                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5961                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5962                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5963             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5964
  5965         16  CF-CLAIM-CALC-METHOD           PIC X.
  5966             88  360-PLUS-MONTHS                VALUE '1'.
  5967             88  365-PLUS-MONTHS                VALUE '2'.
  5968             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5969             88  360-DAILY                      VALUE '4'.
  5970             88  365-DAILY                      VALUE '5'.
  5971
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 115
* EL689.cbl
  5972         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5973         16  FILLER                         PIC X(11).
  5974
  5975         16  CF-LIMIT-AMOUNTS.
  5976             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5977             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5978             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5979             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5980             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5981             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5982             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5983             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5984             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5985             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5986
  5987         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5988         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5989         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5990
  5991         16  CF-ZIP-CODE.
  5992             20  CF-ZIP-PRIME.
  5993                 24  CF-ZIP-1ST             PIC X.
  5994                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5995                 24  FILLER                 PIC X(4).
  5996             20  CF-ZIP-PLUS4               PIC X(4).
  5997         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5998             20  CF-CAN-POSTAL-1            PIC XXX.
  5999             20  CF-CAN-POSTAL-2            PIC XXX.
  6000             20  FILLER                     PIC XXX.
  6001
  6002         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6003         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6004         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6005
  6006         16  CF-RATING-SWITCH               PIC X.
  6007             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6008             88  CF-NO-RATING                   VALUE 'N'.
  6009
  6010         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6011
  6012         16  CF-CARRIER-OVER-SHORT.
  6013             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6014             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6015
  6016         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6017         16  CF-SECPAY-SWITCH               PIC X.
  6018             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6019             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6020         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6021         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6022         16  FILLER                         PIC X(444).
  6023*        16  FILLER                         PIC X(452).
  6024
  6025
  6026****************************************************************
  6027*             MORTALITY MASTER RECORD                          *
  6028****************************************************************
  6029
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 116
* EL689.cbl
  6030     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6031         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6032                                INDEXED BY CF-MORT-NDX.
  6033             20  CF-MORT-TABLE              PIC X(5).
  6034             20  CF-MORT-TABLE-TYPE         PIC X.
  6035                 88  CF-MORT-JOINT              VALUE 'J'.
  6036                 88  CF-MORT-SINGLE             VALUE 'S'.
  6037                 88  CF-MORT-COMBINED           VALUE 'C'.
  6038                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6039                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6040             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6041             20  CF-MORT-AGE-METHOD         PIC XX.
  6042                 88  CF-AGE-LAST                VALUE 'AL'.
  6043                 88  CF-AGE-NEAR                VALUE 'AN'.
  6044             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6045             20  CF-MORT-ADJUSTMENT-DIRECTION
  6046                                            PIC X.
  6047                 88  CF-MINUS                   VALUE '-'.
  6048                 88  CF-PLUS                    VALUE '+'.
  6049             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6050             20  CF-MORT-JOINT-CODE         PIC X.
  6051                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6052             20  CF-MORT-PC-Q               PIC X.
  6053                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6054             20  CF-MORT-TABLE-CODE         PIC X(4).
  6055             20  CF-MORT-COMMENTS           PIC X(15).
  6056             20  FILLER                     PIC X(14).
  6057
  6058         16  FILLER                         PIC X(251).
  6059
  6060
  6061****************************************************************
  6062*             BUSSINESS TYPE MASTER RECORD                     *
  6063****************************************************************
  6064
  6065     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6066* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6067* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6068* AND RECORD 05 IS TYPES 81-99
  6069         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6070             20  CF-BUSINESS-TITLE          PIC  X(19).
  6071             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6072                                            PIC S9V9(4) COMP-3.
  6073             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6074             20  FILLER                     PIC  X.
  6075         16  FILLER                         PIC  X(248).
  6076
  6077
  6078****************************************************************
  6079*             TERMINAL MASTER RECORD                           *
  6080****************************************************************
  6081
  6082     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6083
  6084         16  CF-COMPANY-TERMINALS.
  6085             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6086                                  PIC X(4).
  6087         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 117
* EL689.cbl
  6088
  6089
  6090****************************************************************
  6091*             LIFE EDIT MASTER RECORD                          *
  6092****************************************************************
  6093
  6094     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6095         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6096             20  CF-LIFE-CODE-IN            PIC XX.
  6097             20  CF-LIFE-CODE-OUT           PIC XX.
  6098         16  FILLER                         PIC X(248).
  6099
  6100
  6101****************************************************************
  6102*             AH EDIT MASTER RECORD                            *
  6103****************************************************************
  6104
  6105     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6106         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6107             20  CF-AH-CODE-IN              PIC XXX.
  6108             20  CF-AH-CODE-OUT             PIC XX.
  6109         16  FILLER                         PIC X(248).
  6110
  6111
  6112****************************************************************
  6113*             CREDIBILITY TABLES                               *
  6114****************************************************************
  6115
  6116     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6117         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6118                             INDEXED BY CF-CRDB-NDX.
  6119             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6120             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6121             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6122         16  FILLER                         PIC  X(332).
  6123
  6124
  6125****************************************************************
  6126*             REPORT CUSTOMIZATION RECORD                      *
  6127****************************************************************
  6128
  6129     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6130         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6131             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6132             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6133             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6134**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6135****       A T-TRANSFER.                                   ****
  6136             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6137
  6138         16  FILLER                         PIC XX.
  6139
  6140         16  CF-CARRIER-CNTL-OPT.
  6141             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6142                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6143                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6144             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6145                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 118
* EL689.cbl
  6146         16  CF-GROUP-CNTL-OPT.
  6147             20  CF-GROUP-OPT-SEQ           PIC 9.
  6148                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6149                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6150             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6151                                            PIC X(6).
  6152         16  CF-STATE-CNTL-OPT.
  6153             20  CF-STATE-OPT-SEQ           PIC 9.
  6154                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6155                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6156             20  CF-STATE-SELECT OCCURS 3 TIMES
  6157                                            PIC XX.
  6158         16  CF-ACCOUNT-CNTL-OPT.
  6159             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6160                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6161                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6162             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6163                                            PIC X(10).
  6164         16  CF-BUS-TYP-CNTL-OPT.
  6165             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6166                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6167                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6168             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6169                                            PIC XX.
  6170         16  CF-LF-TYP-CNTL-OPT.
  6171             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6172                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6173                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6174             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6175                                            PIC XX.
  6176         16  CF-AH-TYP-CNTL-OPT.
  6177             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6178                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6179                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6180             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6181                                            PIC XX.
  6182         16  CF-REPTCD1-CNTL-OPT.
  6183             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6184                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6185                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6186             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6187                                            PIC X(10).
  6188         16  CF-REPTCD2-CNTL-OPT.
  6189             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6190                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6191                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6192             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6193                                            PIC X(10).
  6194         16  CF-USER1-CNTL-OPT.
  6195             20  CF-USER1-OPT-SEQ           PIC 9.
  6196                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6197                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6198             20  CF-USER1-SELECT OCCURS 3 TIMES
  6199                                            PIC X(10).
  6200         16  CF-USER2-CNTL-OPT.
  6201             20  CF-USER2-OPT-SEQ           PIC 9.
  6202                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6203                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 119
* EL689.cbl
  6204             20  CF-USER2-SELECT OCCURS 3 TIMES
  6205                                            PIC X(10).
  6206         16  CF-USER3-CNTL-OPT.
  6207             20  CF-USER3-OPT-SEQ           PIC 9.
  6208                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6209                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6210             20  CF-USER3-SELECT OCCURS 3 TIMES
  6211                                            PIC X(10).
  6212         16  CF-USER4-CNTL-OPT.
  6213             20  CF-USER4-OPT-SEQ           PIC 9.
  6214                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6215                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6216             20  CF-USER4-SELECT OCCURS 3 TIMES
  6217                                            PIC X(10).
  6218         16  CF-USER5-CNTL-OPT.
  6219             20  CF-USER5-OPT-SEQ           PIC 9.
  6220                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6221                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6222             20  CF-USER5-SELECT OCCURS 3 TIMES
  6223                                            PIC X(10).
  6224         16  CF-REINS-CNTL-OPT.
  6225             20  CF-REINS-OPT-SEQ           PIC 9.
  6226                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6227                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6228             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6229                 24  CF-REINS-PRIME         PIC XXX.
  6230                 24  CF-REINS-SUB           PIC XXX.
  6231
  6232         16  CF-AGENT-CNTL-OPT.
  6233             20  CF-AGENT-OPT-SEQ           PIC 9.
  6234                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6235                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6236             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6237                                            PIC X(10).
  6238
  6239         16  FILLER                         PIC X(43).
  6240
  6241         16  CF-LOSS-RATIO-SELECT.
  6242             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6243             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6244         16  CF-ENTRY-DATE-SELECT.
  6245             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6246             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6247         16  CF-EFFECTIVE-DATE-SELECT.
  6248             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6249             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6250
  6251         16  CF-EXCEPTION-LIST-IND          PIC X.
  6252             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6253
  6254         16  FILLER                         PIC X(318).
  6255
  6256****************************************************************
  6257*                  EXCEPTION REPORTING RECORD                  *
  6258****************************************************************
  6259
  6260     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6261         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 120
* EL689.cbl
  6262             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6263
  6264         16  CF-COMBINED-LIFE-AH-OPT.
  6265             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6266             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6267             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6268             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6269
  6270         16  CF-LIFE-OPT.
  6271             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6272             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6273             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6274             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6275             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6276             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6277             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6278             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6279             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6280             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6281
  6282         16  CF-AH-OPT.
  6283             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6284             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6285             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6286             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6287             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6288             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6289             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6290             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6291             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6292             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6293
  6294         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6295             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6296             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6297             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6298
  6299         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6300
  6301         16  FILLER                         PIC X(673).
  6302
  6303
  6304****************************************************************
  6305*             MORTGAGE SYSTEM PLAN RECORD                      *
  6306****************************************************************
  6307
  6308     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6309         16  CF-PLAN-TYPE                   PIC X.
  6310             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6311             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6312             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6313         16  CF-PLAN-ABBREV                 PIC XXX.
  6314         16  CF-PLAN-DESCRIPT               PIC X(10).
  6315         16  CF-PLAN-NOTES                  PIC X(20).
  6316         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6317         16  CF-PLAN-UNDERWRITING.
  6318             20  CF-PLAN-TERM-DATA.
  6319                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 121
* EL689.cbl
  6320                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6321             20  CF-PLAN-AGE-DATA.
  6322                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6323                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6324                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6325             20  CF-PLAN-BENEFIT-DATA.
  6326                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6327                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6328                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6329                                            PIC S9(7)V99  COMP-3.
  6330         16  CF-PLAN-POLICY-FORMS.
  6331             20  CF-POLICY-FORM             PIC X(12).
  6332             20  CF-MASTER-APPLICATION      PIC X(12).
  6333             20  CF-MASTER-POLICY           PIC X(12).
  6334         16  CF-PLAN-RATING.
  6335             20  CF-RATE-CODE               PIC X(5).
  6336             20  CF-SEX-RATING              PIC X.
  6337                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6338                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6339             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6340             20  CF-SUB-STD-TYPE            PIC X.
  6341                 88  CF-PCT-OF-PREM            VALUE '1'.
  6342                 88  CF-PCT-OF-BENE            VALUE '2'.
  6343         16  CF-PLAN-PREM-TOLERANCES.
  6344             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6345             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6346         16  CF-PLAN-PYMT-TOLERANCES.
  6347             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6348             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6349         16  CF-PLAN-MISC-DATA.
  6350             20  FILLER                     PIC X.
  6351             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6352             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6353         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6354         16  CF-PLAN-IND-GRP                PIC X.
  6355             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6356                                                     '1'.
  6357             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6358                                                     '2'.
  6359         16  CF-MIB-SEARCH-SW               PIC X.
  6360             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6361             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6362             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6363             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6364         16  CF-ALPHA-SEARCH-SW             PIC X.
  6365             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6366             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6367             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6368             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6369             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6370             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6371             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6372             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6373             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6374             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6375                                                     'A' 'B' 'C'
  6376                                                     'X' 'Y' 'Z'.
  6377         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 122
* EL689.cbl
  6378             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6379             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6380             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6381             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6382             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6383         16  FILLER                         PIC X(4).
  6384         16  CF-HEALTH-QUESTIONS            PIC X.
  6385             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6386         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6387         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6388         16  CF-PLAN-SNGL-JNT               PIC X.
  6389             88  CF-COMBINED-PLAN              VALUE 'C'.
  6390             88  CF-JNT-PLAN                   VALUE 'J'.
  6391             88  CF-SNGL-PLAN                  VALUE 'S'.
  6392         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6393         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6394         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6395         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6396         16  CF-RERATE-CNTL                 PIC  X.
  6397             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6398             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6399             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6400             88  CF-AUTO-RECALC                 VALUE '4'.
  6401         16  CF-BENEFIT-TYPE                PIC  X.
  6402             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6403             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6404         16  CF-POLICY-FEE                  PIC S999V99
  6405                                                    COMP-3.
  6406         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6407         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6408         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6409         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6410         16  FILLER                         PIC  X(32).
  6411         16  CF-TERMINATION-FORM            PIC  X(04).
  6412         16  FILLER                         PIC  X(08).
  6413         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6414                                                       COMP-3.
  6415         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6416         16  CF-ISSUE-LETTER                PIC  X(4).
  6417         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6418         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6419             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6420             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6421         16  CF-MP-REFUND-CALC              PIC X.
  6422             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6423             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6424             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6425             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6426             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6427             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6428             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6429             88  CF-MP-REFD-MEAN                VALUE '8'.
  6430         16  CF-ALT-RATE-CODE               PIC  X(5).
  6431
  6432
  6433         16  FILLER                         PIC X(498).
  6434****************************************************************
  6435*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 123
* EL689.cbl
  6436****************************************************************
  6437
  6438     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6439         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6440         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6441             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6442             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6443             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6444             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6445             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6446
  6447         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6448         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6449         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6450         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6451         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6452
  6453         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6454             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6455         16  CF-MP-RECON-USE-IND            PIC X(1).
  6456             88  CF-MP-USE-RECON             VALUE 'Y'.
  6457         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6458             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6459         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6460             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6461             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6462         16  FILLER                         PIC X(1).
  6463         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6464             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6465         16  CF-MORTG-MIB-VERSION           PIC X.
  6466             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6467             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6468             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6469         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6470             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6471                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6472             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6473                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6474             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6475                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6476             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6477                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6478             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6479                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6480             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6481                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6482         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6483         16  FILLER                         PIC X(7).
  6484         16  CF-MORTG-DESTINATION-SYMBOL.
  6485             20  CF-MORTG-MIB-COMM          PIC X(5).
  6486             20  CF-MORTG-MIB-TERM          PIC X(5).
  6487         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6488             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6489         16  FILLER                         PIC X(03).
  6490         16  CF-MP-CHECK-NO-CONTROL.
  6491             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6492                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6493                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 124
* EL689.cbl
  6494                                                ' ' LOW-VALUES.
  6495                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6496                                               VALUE '3'.
  6497         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6498         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6499         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6500             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6501                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6502             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6503                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6504             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6505                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6506             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6507                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6508             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6509                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6510             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6511                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6512         16  CF-MORTG-BILLING-AREA.
  6513             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6514                                            PIC X.
  6515         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6516         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6517         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6518         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6519             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6520             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6521         16  FILLER                         PIC X.
  6522         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6523             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6524             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6525         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6526         16  FILLER                         PIC X(8).
  6527         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6528         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6529         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6530         16  CF-ACH-COMPANY-ID.
  6531             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6532                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6533                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6534                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6535             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6536         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6537             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6538         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6539             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6540             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6541         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6542         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6543         16  FILLER                         PIC X(536).
  6544
  6545****************************************************************
  6546*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6547****************************************************************
  6548
  6549     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6550         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6551             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 125
* EL689.cbl
  6552                 24  CF-FEMALE-FT           PIC 99.
  6553                 24  CF-FEMALE-IN           PIC 99.
  6554             20  CF-FEMALE-MIN-WT           PIC 999.
  6555             20  CF-FEMALE-MAX-WT           PIC 999.
  6556         16  FILLER                         PIC X(428).
  6557
  6558     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6559         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6560             20  CF-MALE-HEIGHT.
  6561                 24  CF-MALE-FT             PIC 99.
  6562                 24  CF-MALE-IN             PIC 99.
  6563             20  CF-MALE-MIN-WT             PIC 999.
  6564             20  CF-MALE-MAX-WT             PIC 999.
  6565         16  FILLER                         PIC X(428).
  6566******************************************************************
  6567*             AUTOMATIC ACTIVITY RECORD                          *
  6568******************************************************************
  6569     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6570         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6571             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6572             20  CF-SYS-LETTER-ID           PIC X(04).
  6573             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6574             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6575             20  CF-SYS-RESET-SW            PIC X(01).
  6576             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6577             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6578
  6579         16  FILLER                         PIC X(50).
  6580
  6581         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6582             20  CF-USER-ACTIVE-SW          PIC X(01).
  6583             20  CF-USER-LETTER-ID          PIC X(04).
  6584             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6585             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6586             20  CF-USER-RESET-SW           PIC X(01).
  6587             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6588             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6589             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6590
  6591         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 126
* EL689.cbl
  6593*    COPY ERCCOMP.
  6594******************************************************************
  6595*                                                                *
  6596*                                                                *
  6597*                            ERCCOMP                             *
  6598*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6599*                            VMOD=2.019                          *
  6600*                                                                *
  6601*   ONLINE CREDIT SYSTEM                                         *
  6602*                                                                *
  6603*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6604*                                                                *
  6605*   FILE TYPE = VSAM,KSDS                                        *
  6606*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6607*                                                                *
  6608*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6609*       ALTERNATE PATH = NONE                                    *
  6610*                                                                *
  6611*   LOG = NO                                                     *
  6612*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6613*                                                                *
  6614******************************************************************
  6615*                   C H A N G E   L O G
  6616*
  6617* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6618*-----------------------------------------------------------------
  6619*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6620* EFFECTIVE    NUMBER
  6621*-----------------------------------------------------------------
  6622* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6623* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6624* 092205    2005050300006  PEMA  ADD LEASE FEE
  6625* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6626* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6627* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6628* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6629* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6630* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  6631******************************************************************
  6632
  6633 01  COMPENSATION-MASTER.
  6634     12  CO-RECORD-ID                          PIC XX.
  6635         88  VALID-CO-ID                          VALUE 'CO'.
  6636
  6637     12  CO-CONTROL-PRIMARY.
  6638         16  CO-COMPANY-CD                     PIC X.
  6639         16  CO-CONTROL.
  6640             20  CO-CTL-1.
  6641                 24  CO-CARR-GROUP.
  6642                     28  CO-CARRIER            PIC X.
  6643                     28  CO-GROUPING.
  6644                         32  CO-GROUP-PREFIX   PIC XXX.
  6645                         32  CO-GROUP-PRIME    PIC XXX.
  6646                 24  CO-RESP-NO.
  6647                     28  CO-RESP-PREFIX        PIC X(4).
  6648                     28  CO-RESP-PRIME         PIC X(6).
  6649             20  CO-CTL-2.
  6650                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 127
* EL689.cbl
  6651                     28  CO-ACCT-PREFIX        PIC X(4).
  6652                     28  CO-ACCT-PRIME         PIC X(6).
  6653         16  CO-TYPE                           PIC X.
  6654             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6655             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6656             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6657
  6658     12  CO-MAINT-INFORMATION.
  6659         16  CO-LAST-MAINT-DT                  PIC XX.
  6660         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6661         16  CO-LAST-MAINT-USER                PIC X(4).
  6662     12  FILLER                                PIC XX.
  6663     12  CO-STMT-TYPE                          PIC XXX.
  6664     12  CO-COMP-TYPE                          PIC X.
  6665         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6666     12  CO-STMT-OWNER                         PIC X(4).
  6667     12  CO-BALANCE-CONTROL                    PIC X.
  6668         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6669         88  CO-NO-BALANCE                        VALUE 'N'.
  6670
  6671     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6672         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6673         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6674         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6675
  6676     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6677         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6678         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6679
  6680     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6681     12  CO-GA-DIRECT-DEP                      PIC X.
  6682     12  CO-FUTURE-SPACE                       PIC X.
  6683         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6684
  6685     12  CO-ACCT-NAME                          PIC X(30).
  6686     12  CO-MAIL-NAME                          PIC X(30).
  6687     12  CO-ADDR-1                             PIC X(30).
  6688     12  CO-ADDR-2                             PIC X(30).
  6689     12  CO-ADDR-3.
  6690         16  CO-ADDR-CITY                      PIC X(27).
  6691         16  CO-ADDR-STATE                     PIC XX.
  6692     12  CO-CSO-1099                           PIC X.
  6693     12  CO-ZIP.
  6694         16  CO-ZIP-PRIME.
  6695             20  CO-ZIP-PRI-1ST                PIC X.
  6696                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6697             20  FILLER                        PIC X(4).
  6698         16  CO-ZIP-PLUS4                      PIC X(4).
  6699     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6700         16  CO-CAN-POSTAL-1                   PIC XXX.
  6701         16  CO-CAN-POSTAL-2                   PIC XXX.
  6702         16  FILLER                            PIC XXX.
  6703     12  CO-SOC-SEC                            PIC X(13).
  6704     12  CO-TELEPHONE.
  6705         16  CO-AREA-CODE                      PIC XXX.
  6706         16  CO-PREFIX                         PIC XXX.
  6707         16  CO-PHONE                          PIC X(4).
  6708
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 128
* EL689.cbl
  6709     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  6710
  6711     12  CO-AR-BAL-LEVEL                       PIC X.
  6712         88  CO-AR-REF-LVL                        VALUE '1'.
  6713         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6714         88  CO-AR-BILL-LVL                       VALUE '2'.
  6715         88  CO-AR-AGT-LVL                        VALUE '3'.
  6716         88  CO-AR-FR-LVL                         VALUE '4'.
  6717
  6718     12  CO-AR-NORMAL-PRINT                    PIC X.
  6719         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6720         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6721
  6722     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6723
  6724     12  CO-AR-REPORTING                       PIC X.
  6725         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6726         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6727
  6728     12  CO-AR-PULL-CHECK                      PIC X.
  6729         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6730         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6731
  6732     12  CO-AR-BALANCE-PRINT                   PIC X.
  6733         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6734
  6735     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6736         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6737         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6738         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6739
  6740     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6741
  6742     12  CO-USER-CODE                          PIC X.
  6743     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6744
  6745******************************************************************
  6746*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6747*    THE LAST MONTH END RUN.
  6748******************************************************************
  6749
  6750     12  CO-LAST-ACTIVITY-DATE.
  6751         16  CO-ACT-YEAR                       PIC 99.
  6752         16  CO-ACT-MONTH                      PIC 99.
  6753         16  CO-ACT-DAY                        PIC 99.
  6754
  6755     12  CO-LAST-STMT-DT.
  6756         16  CO-LAST-STMT-YEAR                 PIC 99.
  6757         16  CO-LAST-STMT-MONTH                PIC 99.
  6758         16  CO-LAST-STMT-DAY                  PIC 99.
  6759
  6760     12  CO-MO-END-TOTALS.
  6761         16  CO-MONTHLY-TOTALS.
  6762             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6763             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6764             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6765             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6766             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 129
* EL689.cbl
  6767
  6768         16  CO-AGING-TOTALS.
  6769             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6770             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6771             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6772             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6773
  6774         16  CO-YTD-TOTALS.
  6775             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6776             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6777
  6778         16  CO-OVER-UNDER-TOTALS.
  6779             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6780             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6781
  6782     12  CO-MISCELLANEOUS-TOTALS.
  6783         16  CO-FICA-TOTALS.
  6784             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6785             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6786
  6787         16  CO-CLAIM-TOTALS.
  6788             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6789             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6790
  6791******************************************************************
  6792*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6793*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6794******************************************************************
  6795
  6796     12  CO-CURRENT-TOTALS.
  6797         16  CO-CURRENT-LAST-STMT-DT.
  6798             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6799             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6800             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6801
  6802         16  CO-CURRENT-MONTHLY-TOTALS.
  6803             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6804             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6805             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6806             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6807             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6808
  6809         16  CO-CURRENT-AGING-TOTALS.
  6810             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6811             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6812             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6813             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6814
  6815         16  CO-CURRENT-YTD-TOTALS.
  6816             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6817             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6818
  6819     12  CO-PAID-COMM-TOTALS.
  6820         16  CO-YTD-PAID-COMMS.
  6821             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6822             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6823
  6824     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 130
* EL689.cbl
  6825         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  6826         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6827
  6828     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6829         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6830         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6831         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6832         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6833         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6834         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6835         88  CO-FINAL-LETTER                  VALUE 'F'.
  6836         88  CO-RECONCILING                   VALUE 'R'.
  6837         88  CO-PHONE-CALL                    VALUE 'P'.
  6838         88  CO-LEGAL                         VALUE 'L'.
  6839         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6840         88  CO-WRITE-OFF                     VALUE 'W'.
  6841         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6842
  6843     12  CO-CSR-CODE                       PIC X(4).
  6844
  6845     12  CO-GA-STATUS-INFO.
  6846         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6847         16  CO-GA-TERMINATION-DT          PIC XX.
  6848         16  CO-GA-STATUS-CODE             PIC X.
  6849             88  CO-GA-ACTIVE                 VALUE 'A'.
  6850             88  CO-GA-INACTIVE               VALUE 'I'.
  6851             88  CO-GA-PENDING                VALUE 'P'.
  6852         16  CO-GA-COMMENTS.
  6853             20  CO-GA-COMMENT-1           PIC X(40).
  6854             20  CO-GA-COMMENT-2           PIC X(40).
  6855             20  CO-GA-COMMENT-3           PIC X(40).
  6856             20  CO-GA-COMMENT-4           PIC X(40).
  6857
  6858     12  CO-RPTCD2                         PIC X(10).
  6859     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  6860         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  6861         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  6862
  6863     12  CO-TYPE-AGENT                     PIC X(01).
  6864         88  CO-CORPORATION                   VALUE 'C'.
  6865         88  CO-PARTNERSHIP                   VALUE 'P'.
  6866         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  6867         88  CO-TRUST                         VALUE 'T'.
  6868         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  6869
  6870     12  CO-FAXNO.
  6871         16  CO-FAX-AREA-CODE                  PIC XXX.
  6872         16  CO-FAX-PREFIX                     PIC XXX.
  6873         16  CO-FAX-PHONE                      PIC X(4).
  6874
  6875     12  CO-BANK-INFORMATION.
  6876         16  CO-BANK-TRANSIT-NO                PIC X(8).
  6877         16  CO-BANK-TRANSIT-NON REDEFINES
  6878             CO-BANK-TRANSIT-NO                PIC 9(8).
  6879
  6880         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  6881     12  CO-MISC-DEDUCT-INFO REDEFINES
  6882                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 131
* EL689.cbl
  6883         16  CO-MD-GL-ACCT                     PIC X(10).
  6884         16  CO-MD-DIV                         PIC XX.
  6885         16  CO-MD-CENTER                      PIC X(4).
  6886         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  6887         16  CO-CREATE-AP-CHECK                PIC X.
  6888         16  CO-DELIVER-CK-TO-MEL              PIC X.
  6889         16  FILLER                            PIC XXX.
  6890     12  CO-ACH-STATUS                         PIC X.
  6891         88  CO-ACH-ACTIVE                         VALUE 'A'.
  6892         88  CO-ACH-PENDING                        VALUE 'P'.
  6893
  6894     12  CO-BILL-SW                            PIC X.
  6895     12  CO-CONTROL-NAME                       PIC X(30).
  6896     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  6897     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  6898     12  CO-CLP-STATE                          PIC XX.
  6899     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  6900     12  CO-SPP-REFUND-EDIT                    PIC X.
  6901
  6902******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 132
* EL689.cbl
  6904*    COPY ERCMAIL.
  6905******************************************************************
  6906*                                                                *
  6907*                                                                *
  6908*                            ERCMAIL                             *
  6909*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6910*                            VMOD=2.003                          *
  6911*                                                                *
  6912*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6913*                                                                *
  6914*   FILE TYPE = VSAM,KSDS                                        *
  6915*   RECORD SIZE = 374   RECFORM = FIX                            *
  6916*                                                                *
  6917*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6918*   ALTERNATE PATH    = NOT USED                                 *
  6919*                                                                *
  6920*   LOG = YES                                                    *
  6921*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6922******************************************************************
  6923*                   C H A N G E   L O G
  6924*
  6925* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6926*-----------------------------------------------------------------
  6927*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6928* EFFECTIVE    NUMBER
  6929*-----------------------------------------------------------------
  6930* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6931* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6932* 111108                   PEMA  ADD CRED BENE ADDR2
  6933******************************************************************
  6934
  6935 01  MAILING-DATA.
  6936     12  MA-RECORD-ID                      PIC XX.
  6937         88  VALID-MA-ID                       VALUE 'MA'.
  6938
  6939     12  MA-CONTROL-PRIMARY.
  6940         16  MA-COMPANY-CD                 PIC X.
  6941         16  MA-CARRIER                    PIC X.
  6942         16  MA-GROUPING.
  6943             20  MA-GROUPING-PREFIX        PIC XXX.
  6944             20  MA-GROUPING-PRIME         PIC XXX.
  6945         16  MA-STATE                      PIC XX.
  6946         16  MA-ACCOUNT.
  6947             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6948             20  MA-ACCOUNT-PRIME          PIC X(6).
  6949         16  MA-CERT-EFF-DT                PIC XX.
  6950         16  MA-CERT-NO.
  6951             20  MA-CERT-PRIME             PIC X(10).
  6952             20  MA-CERT-SFX               PIC X.
  6953
  6954     12  FILLER                            PIC XX.
  6955
  6956     12  MA-ACCESS-CONTROL.
  6957         16  MA-SOURCE-SYSTEM              PIC XX.
  6958             88  MA-FROM-CREDIT                VALUE 'CR'.
  6959             88  MA-FROM-VSI                   VALUE 'VS'.
  6960             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6961             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 133
* EL689.cbl
  6962         16  MA-RECORD-ADD-DT              PIC XX.
  6963         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6964         16  MA-LAST-MAINT-DT              PIC XX.
  6965         16  MA-LAST-MAINT-BY              PIC XXXX.
  6966         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6967
  6968     12  MA-PROFILE-INFO.
  6969         16  MA-QUALIFY-CODE-1             PIC XX.
  6970         16  MA-QUALIFY-CODE-2             PIC XX.
  6971         16  MA-QUALIFY-CODE-3             PIC XX.
  6972         16  MA-QUALIFY-CODE-4             PIC XX.
  6973         16  MA-QUALIFY-CODE-5             PIC XX.
  6974
  6975         16  MA-INSURED-LAST-NAME          PIC X(15).
  6976         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6977         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6978         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6979         16  MA-INSURED-BIRTH-DT           PIC XX.
  6980         16  MA-INSURED-SEX                PIC X.
  6981             88  MA-SEX-MALE                   VALUE 'M'.
  6982             88  MA-SEX-FEMALE                 VALUE 'F'.
  6983         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6984
  6985         16  MA-ADDRESS-CORRECTED          PIC X.
  6986         16  MA-JOINT-BIRTH-DT             PIC XX.
  6987*        16  FILLER                        PIC X(12).
  6988
  6989         16  MA-ADDRESS-LINE-1             PIC X(30).
  6990         16  MA-ADDRESS-LINE-2             PIC X(30).
  6991         16  MA-CITY-STATE.
  6992             20  MA-CITY                   PIC X(28).
  6993             20  MA-ADDR-STATE             PIC XX.
  6994         16  MA-ZIP.
  6995             20  MA-ZIP-CODE.
  6996                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6997                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6998                 24  FILLER                PIC X(4).
  6999             20  MA-ZIP-PLUS4              PIC X(4).
  7000         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7001             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7002             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7003             20  FILLER                    PIC X(3).
  7004
  7005         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7006
  7007         16  FILLER                        PIC XXX.
  7008*        16  FILLER                        PIC X(10).
  7009
  7010     12  MA-CRED-BENE-INFO.
  7011         16  MA-CRED-BENE-NAME                 PIC X(25).
  7012         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7013         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7014         16  MA-CRED-BENE-CTYST.
  7015             20  MA-CRED-BENE-CITY             PIC X(28).
  7016             20  MA-CRED-BENE-STATE            PIC XX.
  7017         16  MA-CRED-BENE-ZIP.
  7018             20  MA-CB-ZIP-CODE.
  7019                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 134
* EL689.cbl
  7020                     88  MA-CB-CANADIAN-POST-CODE
  7021                                           VALUE 'A' THRU 'Z'.
  7022                 24  FILLER                    PIC X(4).
  7023             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7024         16  MA-CB-CANADIAN-POSTAL-CODE
  7025                            REDEFINES MA-CRED-BENE-ZIP.
  7026             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7027             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7028             20  FILLER                        PIC X(3).
  7029     12  MA-POST-CARD-MAIL-DATA.
  7030         16  MA-MAIL-DATA OCCURS 7.
  7031             20  MA-MAIL-TYPE              PIC X.
  7032                 88  MA-12MO-MAILING           VALUE '1'.
  7033                 88  MA-EXP-MAILING            VALUE '2'.
  7034             20  MA-MAIL-STATUS            PIC X.
  7035                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7036                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7037                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7038             20  MA-MAIL-DATE              PIC XX.
  7039     12  FILLER                            PIC XX.
  7040     12  FILLER                            PIC XX.
  7041*    12  FILLER                            PIC X(30).
  7042******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 135
* EL689.cbl
  7044*    COPY ERCPNDB.
  7045******************************************************************
  7046*                                                                *
  7047*                                                                *
  7048*                            ERCPNDB.                            *
  7049*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7050*                            VMOD=2.025                          *
  7051*                                                                *
  7052*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  7053*                                                                *
  7054******************************************************************
  7055*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  7056*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  7057******************************************************************
  7058*                                                                *
  7059*                                                                *
  7060*   FILE TYPE = VSAM,KSDS                                        *
  7061*   RECORD SIZE = 585  RECFORM = FIXED                           *
  7062*                                                                *
  7063*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  7064*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  7065*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  7066*                                                 RKP=13,LEN=36  *
  7067*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  7068*                                      AND CHG-SEQ.)             *
  7069*                                                RKP=49,LEN=11   *
  7070*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  7071*                                      AND CHG-SEQ.)             *
  7072*                                                RKP=60,LEN=15   *
  7073*                                                                *
  7074*   LOG = NO                                                     *
  7075*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7076******************************************************************
  7077******************************************************************
  7078*                   C H A N G E   L O G
  7079*
  7080* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7081*-----------------------------------------------------------------
  7082*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7083* EFFECTIVE    NUMBER
  7084*-----------------------------------------------------------------
  7085* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7086* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7087* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7088* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  7089* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  7090* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  7091* 032306                   PEMA  ADD BOW LOAN NUMBER
  7092* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  7093* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7094* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7095* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7096* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  7097* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7098* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7099* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  7100******************************************************************
  7101
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 136
* EL689.cbl
  7102 01  PENDING-BUSINESS.
  7103     12  PB-RECORD-ID                     PIC XX.
  7104         88  VALID-PB-ID                        VALUE 'PB'.
  7105
  7106     12  PB-CONTROL-PRIMARY.
  7107         16  PB-COMPANY-CD                PIC X.
  7108         16  PB-ENTRY-BATCH               PIC X(6).
  7109         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  7110         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  7111
  7112     12  PB-CONTROL-BY-ACCOUNT.
  7113         16  PB-COMPANY-CD-A1             PIC X.
  7114         16  PB-CARRIER                   PIC X.
  7115         16  PB-GROUPING.
  7116             20  PB-GROUPING-PREFIX       PIC XXX.
  7117             20  PB-GROUPING-PRIME        PIC XXX.
  7118         16  PB-STATE                     PIC XX.
  7119         16  PB-ACCOUNT.
  7120             20  PB-ACCOUNT-PREFIX        PIC X(4).
  7121             20  PB-ACCOUNT-PRIME         PIC X(6).
  7122         16  PB-CERT-EFF-DT               PIC XX.
  7123         16  PB-CERT-NO.
  7124             20  PB-CERT-PRIME            PIC X(10).
  7125             20  PB-CERT-SFX              PIC X.
  7126         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  7127
  7128         16  PB-RECORD-TYPE               PIC X.
  7129             88  PB-MAILING-DATA                VALUE '0'.
  7130             88  PB-ISSUE                       VALUE '1'.
  7131             88  PB-CANCELLATION                VALUE '2'.
  7132             88  PB-BATCH-TRAILER               VALUE '9'.
  7133
  7134     12  PB-CONTROL-BY-ORIG-BATCH.
  7135         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  7136         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  7137         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  7138         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  7139
  7140     12  PB-CONTROL-BY-CSR.
  7141         16  PB-CSR-COMPANY-CD            PIC X.
  7142         16  PB-CSR-ID                    PIC X(4).
  7143         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  7144         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  7145         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  7146******************************************************************
  7147*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  7148******************************************************************
  7149
  7150     12  PB-LAST-MAINT-DT                 PIC XX.
  7151     12  PB-LAST-MAINT-BY                 PIC X(4).
  7152     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7153
  7154     12  PB-RECORD-BODY                   PIC X(375).
  7155
  7156     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  7157         16  PB-CERT-ORIGIN               PIC X.
  7158             88  CLASIC-CREATED-CERT         VALUE '1'.
  7159         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 137
* EL689.cbl
  7160             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  7161             20  PB-I-INSURED-FIRST-NAME.
  7162                 24  PB-I-INSURED-1ST-INIT PIC X.
  7163                 24  FILLER                PIC X(9).
  7164             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  7165         16  PB-I-AGE                     PIC S99   COMP-3.
  7166         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  7167         16  PB-I-BIRTHDAY                PIC XX.
  7168         16  PB-I-INSURED-SEX             PIC X.
  7169             88  PB-SEX-MALE     VALUE 'M'.
  7170             88  PB-SEX-FEMALE   VALUE 'F'.
  7171
  7172         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  7173         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  7174         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  7175         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  7176         16  PB-I-SKIP-CODE               PIC X.
  7177             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  7178             88  PB-SKIP-JULY              VALUE '1'.
  7179             88  PB-SKIP-AUGUST            VALUE '2'.
  7180             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  7181             88  PB-SKIP-JULY-AUG          VALUE '4'.
  7182             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  7183             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  7184             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  7185             88  PB-SKIP-JUNE              VALUE '8'.
  7186             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  7187             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  7188             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  7189         16  PB-I-TERM-TYPE               PIC X.
  7190             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  7191             88  PB-PAID-WEEKLY            VALUE 'W'.
  7192             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  7193             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  7194             88  PB-PAID-13-YEARLY         VALUE 'T'.
  7195         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  7196         16  PB-I-POLICY-FORM-NO          PIC X(12).
  7197         16  PB-I-DATA-ENTRY-SW           PIC X.
  7198             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  7199             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  7200             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  7201             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  7202         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  7203         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  7204*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  7205         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  7206         16  FILLER                       PIC X.
  7207
  7208         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  7209             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  7210             88  PB-INVALID-LIFE             VALUE '  ' '00'
  7211                                                   '90' THRU '99'.
  7212         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  7213                                          PIC XX.
  7214         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  7215         16  PB-I-AMOUNT-FINANCED REDEFINES
  7216                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  7217         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 138
* EL689.cbl
  7218         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  7219                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  7220         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7221         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  7222         16  PB-I-CLP-AMOUNT REDEFINES
  7223                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  7224         16  PB-I-LF-CALC-FLAG            PIC X.
  7225             88 PB-COMP-LF-PREM               VALUE '?'.
  7226         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  7227         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  7228         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  7229         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  7230         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7231         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  7232         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  7233         16  PB-I-LF-ABBR                 PIC XXX.
  7234         16  PB-I-LF-INPUT-CD             PIC XX.
  7235
  7236         16  PB-I-AH-BENEFIT-CD           PIC XX.
  7237             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  7238             88  PB-INVALID-AH               VALUE '  ' '00'
  7239                                                   '90' THRU '99'.
  7240         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  7241         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7242         16  PB-I-AH-CALC-FLAG            PIC X.
  7243             88 PB-COMP-AH-PREM                  VALUE '?'.
  7244         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  7245         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  7246         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7247         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  7248         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  7249         16  PB-I-AH-ABBR                 PIC XXX.
  7250         16  PB-I-AH-INPUT-CD             PIC XXX.
  7251
  7252         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  7253         16  PB-I-REIN-TABLE              PIC XXX.
  7254         16  PB-I-BUSINESS-TYPE           PIC 99.
  7255         16  PB-I-INDV-GRP-CD             PIC X.
  7256         16  PB-I-MORT-CODE.
  7257             20  PB-I-TABLE               PIC X.
  7258             20  PB-I-INTEREST            PIC XX.
  7259             20  PB-I-MORT-TYP            PIC X.
  7260         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  7261         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  7262         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  7263         16  PB-I-INDV-GRP-OVRD           PIC X.
  7264         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  7265         16  PB-I-SIG-SW                  PIC X.
  7266             88  PB-POLICY-SIGNED             VALUE 'Y'.
  7267         16  PB-I-RATE-CLASS              PIC XX.
  7268         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  7269         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  7270         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  7271         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  7272         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  7273         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  7274         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  7275         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 139
* EL689.cbl
  7276         16  PB-I-OB-FLAG                 PIC X.
  7277             88  PB-I-OB                      VALUE 'B'.
  7278             88  PB-I-SUMMARY                 VALUE 'Z'.
  7279         16  PB-I-ENTRY-STATUS            PIC X.
  7280             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  7281                                              'M' '5' '9' '2'.
  7282             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  7283             88  PB-I-POLICY-PENDING          VALUE '2'.
  7284             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  7285             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  7286             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  7287             88  PB-I-REIN-ONLY               VALUE '9'.
  7288             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  7289             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  7290             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  7291             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  7292         16  PB-I-INT-CODE                PIC X.
  7293             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  7294             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  7295         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  7296         16  PB-I-SOC-SEC-NO              PIC X(11).
  7297         16  PB-I-MEMBER-NO               PIC X(12).
  7298         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  7299*        16  PB-I-LOAN-OFFICER            PIC XXX.
  7300         16  PB-I-OLD-LOF                 PIC XXX.
  7301         16  PB-I-LF-EXPIRE-DT            PIC XX.
  7302         16  PB-I-AH-EXPIRE-DT            PIC XX.
  7303         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  7304         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  7305         16  PB-I-LIFE-INDICATOR          PIC X.
  7306             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  7307         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  7308         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  7309                                          PIC S9(5)V99    COMP-3.
  7310         16  PB-I-MAIL-ADDRS-SW           PIC X.
  7311             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  7312             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  7313         16  PB-I-1ST-PMT-DT              PIC XX.
  7314         16  PB-I-JOINT-INSURED.
  7315             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  7316             20 PB-I-JOINT-FIRST-NAME.
  7317                24  PB-I-JOINT-FIRST-INIT PIC X.
  7318                24  FILLER                PIC X(9).
  7319             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  7320*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  7321         16  PB-I-BENEFICIARY-NAME.
  7322             20  PB-I-BANK-NUMBER         PIC X(10).
  7323             20  FILLER                   PIC X(15).
  7324         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  7325         16  PB-I-REFERENCE               PIC X(12).
  7326         16  FILLER REDEFINES PB-I-REFERENCE.
  7327             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  7328             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  7329             20  PB-I-CLP-STATE           PIC XX.
  7330         16  PB-I-UNDERWRITING-STATUS     PIC X.
  7331             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  7332             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  7333             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 140
* EL689.cbl
  7334         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  7335         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  7336         16  PB-I-RESIDENT-STATE          PIC XX.
  7337         16  PB-I-RATE-CODE               PIC X(4).
  7338         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  7339         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7340         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7341         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  7342         16  PB-I-BANK-NOCHRGB            PIC 99.
  7343         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  7344         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  7345
  7346     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  7347         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  7348             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  7349         16  PB-C-CANCEL-ORIGIN           PIC X.
  7350             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  7351         16  PB-C-LF-CANCEL-DT            PIC XX.
  7352         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7353         16  PB-C-LF-CALC-REQ             PIC X.
  7354             88 PB-COMP-LF-CANCEL            VALUE '?'.
  7355         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  7356         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  7357         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  7358             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  7359         16  PB-C-AH-CANCEL-DT            PIC XX.
  7360         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7361         16  PB-C-AH-CALC-REQ             PIC X.
  7362             88 PB-COMP-AH-CANCEL            VALUE '?'.
  7363         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  7364         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  7365         16  PB-C-LAST-NAME               PIC X(15).
  7366         16  PB-C-REFUND-SW               PIC X.
  7367             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  7368             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  7369         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  7370         16  PB-C-PAYEE-CODE              PIC X(6).
  7371         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  7372         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  7373         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  7374         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  7375         16  PB-C-REFERENCE               PIC X(12).
  7376         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7377         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7378         16  PB-C-POST-CARD-IND           PIC X.
  7379         16  PB-C-CANCEL-REASON           PIC X.
  7380         16  PB-C-REF-INTERFACE-SW        PIC X.
  7381         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  7382         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  7383         16  FILLER                       PIC X(01).
  7384*        16  FILLER                       PIC X(18).
  7385         16  PB-C-POLICY-FORM-NO          PIC X(12).
  7386*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  7387         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  7388         16  PB-CANCELED-CERT-DATA.
  7389             20  PB-CI-INSURED-NAME.
  7390                 24  PB-CI-LAST-NAME      PIC X(15).
  7391                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 141
* EL689.cbl
  7392             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  7393             20  PB-CI-INSURED-SEX        PIC X.
  7394             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  7395             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  7396             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  7397             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  7398             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7399             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  7400             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  7401             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  7402             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  7403             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7404             20  PB-CI-RATE-CLASS         PIC XX.
  7405             20  PB-CI-RATE-DEV-LF        PIC XXX.
  7406             20  PB-CI-RATE-DEV-AH        PIC XXX.
  7407             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  7408             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  7409             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  7410             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  7411             20  PB-CI-LF-ABBR            PIC X(3).
  7412             20  PB-CI-AH-ABBR            PIC X(3).
  7413             20  PB-CI-OB-FLAG            PIC X.
  7414                 88  PB-CI-OB                VALUE 'B'.
  7415             20  PB-CI-LF-POLICY-STATUS   PIC X.
  7416                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  7417                                           'M' '4' '5' '9' '2'.
  7418                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  7419                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  7420                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  7421                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  7422                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  7423                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  7424                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  7425                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  7426                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  7427                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  7428                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  7429                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  7430             20  PB-CI-AH-POLICY-STATUS   PIC X.
  7431                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  7432                                           'M' '4' '5' '9' '2'.
  7433                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  7434                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  7435                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  7436                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  7437                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  7438                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  7439                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  7440                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  7441                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  7442                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  7443                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  7444                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  7445             20  PB-CI-PAY-FREQUENCY      PIC 99.
  7446             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  7447             20  PB-CI-SOC-SEC-NO         PIC X(11).
  7448             20  PB-CI-MEMBER-NO          PIC X(12).
  7449             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 142
* EL689.cbl
  7450                 88  PB-CI-ADD-ON                  VALUE 'A'.
  7451                 88  PB-CI-SIMPLE                  VALUE 'S'.
  7452             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  7453             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  7454             20  PB-CI-COMP-EXCP-SW       PIC X.
  7455                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  7456                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  7457             20  PB-CI-ENTRY-STATUS       PIC X.
  7458             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  7459             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  7460             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  7461             20  PB-CI-DEATH-DT           PIC XX.
  7462             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  7463             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  7464             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7465             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7466             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  7467             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  7468             20  PB-CI-ENTRY-DT              PIC XX.
  7469             20  PB-CI-ENTRY-BATCH           PIC X(6).
  7470             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  7471             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  7472             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  7473             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  7474             20  PB-CI-OLD-LOF               PIC XXX.
  7475*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  7476             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  7477             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  7478             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  7479             20  PB-CI-INDV-GRP-CD           PIC X.
  7480             20  PB-CI-BENEFICIARY-NAME.
  7481                 24  PB-CI-BANK-NUMBER       PIC X(10).
  7482                 24  FILLER                  PIC X(15).
  7483             20  PB-CI-NOTE-SW               PIC X.
  7484             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  7485             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  7486             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  7487             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  7488             20  PB-CI-LOAN-OFFICER          PIC X(5).
  7489             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  7490             20  PB-CI-FIRST-NAME            PIC X(10).
  7491             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  7492
  7493         16  FILLER                       PIC X(13).
  7494*032306  16  FILLER                       PIC X(27).
  7495*        16  FILLER                       PIC X(46).
  7496
  7497     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  7498         16  FILLER                       PIC X(10).
  7499         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  7500         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  7501         16  PB-M-INSURED-MID-INIT        PIC X.
  7502         16  PB-M-INSURED-AGE             PIC 99.
  7503         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  7504         16  PB-M-INSURED-SEX             PIC X.
  7505         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  7506         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  7507         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 143
* EL689.cbl
  7508         16  PB-M-INSURED-CITY-STATE.
  7509             20  PB-M-INSURED-CITY        PIC X(28).
  7510             20  PB-M-INSURED-STATE       PIC XX.
  7511         16  PB-M-INSURED-ZIP-CODE.
  7512             20  PB-M-INSURED-ZIP-PRIME.
  7513                 24  PB-M-INSURED-ZIP-1   PIC X.
  7514                     88  PB-M-CANADIAN-POST-CODE
  7515                                             VALUE 'A' THRU 'Z'.
  7516                 24  FILLER               PIC X(4).
  7517             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  7518         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  7519                                        PB-M-INSURED-ZIP-CODE.
  7520             20  PM-M-INS-CAN-POST1       PIC XXX.
  7521             20  PM-M-INS-CAN-POST2       PIC XXX.
  7522             20  FILLER                   PIC XXX.
  7523         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  7524         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  7525         16  PB-M-CRED-BENE-NAME          PIC X(30).
  7526         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  7527         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  7528         16  PB-M-CRED-BENE-CITYST.
  7529             20  PB-M-CRED-BENE-CITY      PIC X(28).
  7530             20  PB-M-CRED-BENE-STATE     PIC XX.
  7531         16  FILLER                       PIC X(92).
  7532
  7533     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  7534         16  FILLER                       PIC X(10).
  7535         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7536         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7537         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7538         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7539         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7540         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7541         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7542         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7543         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7544         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7545         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7546         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7547         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  7548         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  7549         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  7550         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  7551         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  7552         16  PB-ACCOUNT-NAME              PIC X(30).
  7553         16  PB-PREM-REF-RPT-FLAG         PIC X.
  7554         16  PB-REFERENCE                 PIC X(12).
  7555         16  PB-B-RECEIVED-DT             PIC XX.
  7556         16  FILLER                       PIC X(234).
  7557
  7558     12  PB-RECORD-STATUS.
  7559         16  PB-CREDIT-SELECT-DT          PIC XX.
  7560         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  7561         16  PB-BILLED-DT                 PIC XX.
  7562         16  PB-BILLING-STATUS            PIC X.
  7563             88  PB-ENTRY-REVERSED            VALUE 'R'.
  7564             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  7565             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 144
* EL689.cbl
  7566         16  PB-RECORD-BILL               PIC X.
  7567             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  7568             88  PB-RECORD-RETURNED           VALUE 'R'.
  7569             88  PB-RECORD-ENDORSED           VALUE 'E'.
  7570             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  7571             88  PB-OVERRIDE-AH               VALUE 'A'.
  7572             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  7573         16  PB-BATCH-ENTRY               PIC X.
  7574             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  7575             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  7576             88  PB-REISSUED-CERT             VALUE 'E'.
  7577             88  PB-MONTHLY-CERT              VALUE 'M'.
  7578             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  7579             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  7580             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  7581         16  PB-FORCE-CODE                PIC X.
  7582             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  7583             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  7584             88  PB-CANCEL-FORCE              VALUE '8'.
  7585             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  7586             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  7587             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  7588             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  7589             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  7590             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  7591             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  7592         16  PB-FATAL-FLAG                PIC X.
  7593             88  PB-FATAL-ERRORS              VALUE 'X'.
  7594         16  PB-FORCE-ER-CD               PIC X.
  7595             88  PB-FORCE-ERRORS              VALUE 'F'.
  7596             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  7597         16  PB-WARN-ER-CD                PIC X.
  7598             88  PB-WARNING-ERRORS            VALUE 'W'.
  7599         16  FILLER                       PIC X.
  7600         16  PB-OUT-BAL-CD                PIC X.
  7601             88  PB-OUT-OF-BAL                VALUE 'O'.
  7602         16  PB-LIFE-OVERRIDE-L1          PIC X.
  7603         16  PB-AH-OVERRIDE-L1            PIC X.
  7604         16  PB-INPUT-DT                  PIC XX.
  7605         16  PB-INPUT-BY                  PIC X(4).
  7606         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  7607         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  7608         16  PB-TOLERANCE-REJECT-SW       PIC X.
  7609         16  PB-LF-EARNING-METHOD         PIC X.
  7610         16  PB-AH-EARNING-METHOD         PIC X.
  7611         16  PB-LF-TERM-CALC-METHOD       PIC X.
  7612         16  PB-AH-TERM-CALC-METHOD       PIC X.
  7613         16  PB-REIN-CD                   PIC XXX.
  7614         16  PB-LF-REFUND-TYPE            PIC X.
  7615         16  PB-AH-REFUND-TYPE            PIC X.
  7616         16  PB-ACCT-EFF-DT               PIC XX.
  7617         16  PB-ACCT-EXP-DT               PIC XX.
  7618         16  PB-COMPANY-ID                PIC X(3).
  7619         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7620         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7621         16  PB-SV-CARRIER                PIC X.
  7622         16  PB-SV-GROUPING               PIC X(6).
  7623         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 145
* EL689.cbl
  7624         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  7625         16  PB-GA-BILLING-INFO.
  7626             20  PB-GA-BILL-DT OCCURS 5 TIMES
  7627                                          PIC XX.
  7628         16  PB-SV-REMIT-TO  REDEFINES
  7629             PB-GA-BILLING-INFO           PIC X(10).
  7630         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  7631         16  PB-I-LOAN-OFFICER            PIC X(5).
  7632         16  PB-I-VIN                     PIC X(17).
  7633
  7634         16  FILLER                       PIC X(04).
  7635         16  IMNET-BYPASS-SW              PIC X.
  7636
  7637******************************************************************
  7638*                COMMON EDIT ERRORS                              *
  7639******************************************************************
  7640
  7641     12  PB-COMMON-ERRORS.
  7642         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  7643                                           PIC S9(4)     COMP.
  7644
  7645******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 146
* EL689.cbl
  7647*    COPY ERCPYAJ.
  7648******************************************************************
  7649*                                                                *
  7650*                            ERCPYAJ                             *
  7651*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7652*                            VMOD=2.015                          *
  7653*                                                                *
  7654*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7655*                                                                *
  7656*                                                                *
  7657*   FILE TYPE = VSAM,KSDS                                        *
  7658*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7659*                                                                *
  7660*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7661*       ALTERNATE PATHS = NONE                                   *
  7662*                                                                *
  7663*   LOG = YES                                                    *
  7664*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7665******************************************************************
  7666******************************************************************
  7667*                   C H A N G E   L O G
  7668*
  7669* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7670*-----------------------------------------------------------------
  7671*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7672* EFFECTIVE    NUMBER
  7673*-----------------------------------------------------------------
  7674* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7675* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7676******************************************************************
  7677
  7678 01  PENDING-PAY-ADJ.
  7679     12  PY-RECORD-ID                     PIC XX.
  7680         88  VALID-PY-ID                        VALUE 'PY'.
  7681
  7682     12  PY-CONTROL-PRIMARY.
  7683         16  PY-COMPANY-CD                PIC X.
  7684         16  PY-CARRIER                   PIC X.
  7685         16  PY-GROUPING                  PIC X(6).
  7686         16  PY-FIN-RESP                  PIC X(10).
  7687         16  PY-ACCOUNT                   PIC X(10).
  7688         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7689                                          PIC X(10).
  7690         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7691         16  PY-RECORD-TYPE               PIC X.
  7692             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7693             88  PY-DEPOSIT                   VALUE 'D'.
  7694             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7695             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7696             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7697             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7698             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7699             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7700             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7701             88  PY-FICA-ENTRY                VALUE 'F'.
  7702             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7703             88  PY-POLICY-FEE                VALUE 'W'.
  7704             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 147
* EL689.cbl
  7705
  7706     12  PY-PYMT-TYPE                     PIC X.
  7707             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7708             88  PY-REINS-PYMT                VALUE 'R'.
  7709             88  PY-EXP-PYMT                  VALUE 'E'.
  7710
  7711     12  PY-BIL-INV                       PIC X(6).
  7712     12  PY-REF-NO                        PIC X(12).
  7713
  7714     12  PY-LAST-MAINT-DT                 PIC XX.
  7715     12  PY-LAST-MAINT-BY                 PIC X(4).
  7716     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7717
  7718     12  PY-PYADJ-RECORD.
  7719         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7720         16  PY-ENTRY-COMMENT             PIC X(30).
  7721         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7722             20  PY-GL-ACCOUNT            PIC X(10).
  7723             20  PY-GL-STATE              PIC X(02).
  7724             20  PY-GL-CANC-SW            PIC X(01).
  7725                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7726                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7727             20  PY-GL-COMMENT            PIC X(10).
  7728             20  FILLER      REDEFINES PY-GL-COMMENT.
  7729                 24  PY-GL-CHECK-NO       PIC 9(06).
  7730                 24  FILLER               PIC X(04).
  7731             20  FILLER                   PIC X(07).
  7732         16  PY-SAVE-ACCOUNT              PIC X(10).
  7733         16  PY-SAVE-TYPE                 PIC X(01).
  7734
  7735         16  PY-LETTERS.
  7736             20  PY-LETTER OCCURS 3 TIMES
  7737                           INDEXED BY PY-LET-NDX
  7738                                          PIC X(04).
  7739
  7740         16  PY-ERCOMP-TYPE               PIC X.
  7741             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7742             88  PY-GA-TYPE                   VALUE 'G'.
  7743             88  PY-BANK-TYPE                 VALUE 'B'.
  7744         16  FILLER                       PIC X(05).
  7745
  7746     12  PY-RECORD-STATUS.
  7747         16  PY-CREDIT-SELECT-DT          PIC XX.
  7748         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7749         16  PY-BILLED-DATE               PIC XX.
  7750         16  PY-REPORTED-DT               PIC XX.
  7751         16  PY-PMT-APPLIED               PIC X.
  7752             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7753             88  PY-GA-PMT                    VALUE 'G'.
  7754             88  PY-OVWRITE-PMT               VALUE 'O'.
  7755             88  PY-NON-AR-PMT                VALUE 'N'.
  7756         16  FILLER                       PIC X(5).
  7757         16  PY-INPUT-DT                  PIC XX.
  7758         16  PY-CHECK-NUMBER              PIC X(6).
  7759         16  PY-VOID-SW                   PIC X.
  7760             88  PY-CHECK-VOIDED              VALUE 'V'.
  7761         16  PY-CHECK-ORIGIN-SW           PIC X.
  7762             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 148
* EL689.cbl
  7763             88  PY-REFUND-CHECK              VALUE 'R'.
  7764             88  PY-GA-CHECK                  VALUE 'G'.
  7765             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7766             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7767         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7768         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7769         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7770         16  PY-BILL-FLAG                 PIC X.
  7771             88  PY-BILLED                    VALUE 'B'.
  7772         16  PY-AR-FLAG                   PIC X.
  7773             88  PY-AR-CYCLE                  VALUE 'C'.
  7774             88  PY-AR-MONTH-END              VALUE 'M'.
  7775         16  PY-AR-DATE                   PIC XX.
  7776
  7777     12  PY-GL-CODES.
  7778         16  PY-GL-DB                     PIC X(14).
  7779         16  PY-GL-CR                     PIC X(14).
  7780         16  PY-GL-FLAG                   PIC X.
  7781         16  PY-GL-DATE                   PIC XX.
  7782
  7783     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7784     12  FILLER                           PIC X(3).
  7785******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 149
* EL689.cbl
  7787*    COPY ELCTEXT.
  7788******************************************************************
  7789*                                                                *
  7790*                                                                *
  7791*                            ELCTEXT.                            *
  7792*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7793*                            VMOD=2.008                          *
  7794*                                                                *
  7795*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  7796*                                     FORM LETTERS,              *
  7797*                                     CERT FORM DISPLAY.
  7798*                                                                *
  7799*   FILE TYPE = VSAM,KSDS                                        *
  7800*   RECORD SIZE = 100   RECFORM = FIXED                          *
  7801*                                                                *
  7802*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  7803*       ALTERNATE INDEX = NONE                                   *
  7804*                                                                *
  7805*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  7806*       ALTERNATE INDEX = NONE                                   *
  7807*                                                                *
  7808*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  7809*       ALTERNATE INDEX = NONE                                   *
  7810*                                                                *
  7811*   LOG = NO                                                     *
  7812*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7813******************************************************************
  7814 01  TEXT-FILES.
  7815     12  TEXT-FILE-ID                PIC XX.
  7816         88  FORMS-FILE-TEXT            VALUE 'TF'.
  7817         88  LETTER-FILE-TEXT           VALUE 'TL'.
  7818         88  HELP-FILE-TEXT             VALUE 'TH'.
  7819
  7820     12  TX-CONTROL-PRIMARY.
  7821         16  TX-COMPANY-CD           PIC X.
  7822             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  7823         16  TX-ACCESS-CD-GENL       PIC X(12).
  7824
  7825         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7826             20  TX-LETTER-NO        PIC X(4).
  7827             20  FILLER              PIC X(8).
  7828
  7829         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7830             20  TX-FORM-NO          PIC X(12).
  7831
  7832         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7833             20  TX-HELP-TYPE        PIC X.
  7834                 88  HELP-FOR-GENERAL   VALUE ' '.
  7835                 88  HELP-BY-SCREEN     VALUE 'S'.
  7836                 88  HELP-BY-ERROR      VALUE 'E'.
  7837             20  TX-SCREEN-OR-ERROR  PIC X(4).
  7838                 88  GENERAL-INFO-HELP  VALUE '0000'.
  7839             20  TX-HELP-FOR-COMPANY  PIC XXX.
  7840                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  7841             20  FILLER              PIC X(4).
  7842
  7843         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  7844
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 150
* EL689.cbl
  7845     12  TX-PROCESS-CONTROL          PIC XX.
  7846         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  7847
  7848     12  TX-TEXT-LINE                PIC X(70).
  7849
  7850     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  7851         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  7852         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  7853         88  TX-VALID-FORM-SQUEEZE-VALUE
  7854                                        VALUE 'Y' ' '.
  7855
  7856     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  7857         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  7858         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  7859         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  7860         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  7861         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  7862         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  7863         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  7864                                              'K' 'N' ' '
  7865                                              'Z'.
  7866
  7867     12  TX-ARCHIVE-SW               PIC X.
  7868         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  7869         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  7870         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  7871
  7872     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  7873     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  7874
  7875     12  TX-BSR-CODE                 PIC X.
  7876         88  TX-BSR-LETTER              VALUE 'B'.
  7877         88  TX-NON-BSR-LETTER          VALUE ' '.
  7878
  7879     12  FILLER                      PIC X.
  7880*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 151
* EL689.cbl
  7882*    COPY ERCENDT.
  7883******************************************************************
  7884*                                                                *
  7885*                                                                *
  7886*                            ERCENDT.                            *
  7887*                            VMOD=2.001                          *
  7888*                                                                *
  7889*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7890*                                                                *
  7891*   FILE TYPE = VSAM,KSDS                                        *
  7892*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7893*                                                                *
  7894*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7895*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7896*                                                                *
  7897*   LOG = NO                                                     *
  7898*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7899******************************************************************
  7900*-----------------------------------------------------------------
  7901*                   C H A N G E   L O G
  7902*
  7903* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7904*-----------------------------------------------------------------
  7905*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7906* EFFECTIVE    NUMBER
  7907*-----------------------------------------------------------------
  7908* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7909*                                WITH OPEN CLAIMS
  7910* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7911* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7912* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7913*-----------------------------------------------------------------
  7914 01  ENDORSEMENT-RECORD.
  7915     12  EN-RECORD-ID                PIC XX.
  7916         88  VALID-EN-ID                VALUE 'EN'.
  7917     12  EN-CONTROL-PRIMARY.
  7918         16  EN-COMPANY-CD           PIC X.
  7919         16  EN-CARRIER              PIC X.
  7920         16  EN-GROUPING             PIC X(6).
  7921         16  EN-STATE                PIC XX.
  7922         16  EN-ACCOUNT              PIC X(10).
  7923         16  EN-CERT-EFF-DT          PIC XX.
  7924         16  EN-CERT-NO.
  7925             20  EN-CERT-PRIME       PIC X(10).
  7926             20  EN-CERT-SFX         PIC X.
  7927         16  EN-REC-TYPE             PIC X.
  7928             88  EN-ISSUE               VALUE 'I'.
  7929             88  EN-CANCELLATION        VALUE 'C'.
  7930         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7931     12  EN-CONTROL-BY-ARCH-NO.
  7932         16  EN-COMPANY-CD-A1              PIC X.
  7933         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7934     12  EN-LAST-MAINT-DT            PIC XX.
  7935     12  EN-LAST-MAINT-BY            PIC X(4).
  7936     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7937     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7938     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7939         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 152
* EL689.cbl
  7940         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7941         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7942         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7943         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7944         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7945         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7946         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7947         16  EN-LF-ORIG-BENCD        PIC XX.
  7948         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7949         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7950         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7951         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7952         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7953         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7954*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7955         16  EN-ORIG-CRED-BENE       PIC X(25).
  7956         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7957         16  FILLER                  PIC X.
  7958         16  EN-AH-ORIG-BENCD        PIC XX.
  7959         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7960         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7961         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7962         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7963*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7964*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7965         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7966         16  F                       PIC X(09).
  7967         16  EN-AH-ORIG-CP           PIC 99.
  7968         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7969         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7970         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7971         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7972         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7973         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7974         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7975         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7976         16  EN-LF-NEW-BENCD         PIC XX.
  7977         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7978         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7979         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7980         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7981         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7982         16  EN-LF-NEW-EXP-DT        PIC XX.
  7983         16  EN-NEW-CRED-BENE        PIC X(25).
  7984         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7985         16  FILLER                  PIC X.
  7986         16  EN-AH-NEW-BENCD         PIC XX.
  7987         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7988         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7989         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7990         16  EN-AH-NEW-EXP-DT        PIC XX.
  7991*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7992*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7993*        16  F                       PIC X(12).
  7994         16  EN-AH-NEW-CP            PIC 99.
  7995         16  EN-SIG-SW               PIC X.
  7996         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7997         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 153
* EL689.cbl
  7998         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7999         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8000         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8001         16  FILLER                  PIC X(33).
  8002     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8003         16  EN-LF-ORIG-REF-DT       PIC XX.
  8004         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8005         16  EN-AH-ORIG-REF-DT       PIC XX.
  8006         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8007         16  EN-LF-NEW-REF-DT        PIC XX.
  8008         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8009         16  EN-AH-NEW-REF-DT        PIC XX.
  8010         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8011         16  EN-FLAG-CERT            PIC X.
  8012         16  EN-INS-LAST-NAME        PIC X(15).
  8013         16  EN-INS-FIRST-NAME       PIC X(10).
  8014         16  EN-INS-MIDDLE-INIT      PIC X.
  8015         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8016         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8017         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8018         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8019         16  FILLER                  PIC X(262).
  8020     12  EN-MONEY-SW             PIC X.
  8021     12  EN-HEALTH-APP           PIC X.
  8022     12  EN-VOUCHER-SW           PIC X.
  8023     12  EN-PAYEE                PIC X(14).
  8024     12  EN-INPUT-DT             PIC XX.
  8025     12  EN-PROCESS-DT           PIC XX.
  8026     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8027     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8028     12  EN-REASON-CODES.
  8029         16  F OCCURS 12.
  8030             20  EN-REASON-CODE  PIC X(4).
  8031     12  EN-TEMPLATE-USED        PIC X(8).
  8032     12  EN-DOCU-TYPE            PIC X.
  8033         88  EN-VERI-DOCU          VALUE 'V'.
  8034         88  EN-GCE-DOCU           VALUE 'G'.
  8035         88  EN-CANC-DOCU          VALUE 'C'.
  8036     12  EN-COMMENTS1            PIC X(13).
  8037     12  EN-COMMENTS2            PIC X(70).
  8038     12  EN-COMM-CHGBK           PIC X.
  8039         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8040         88  EN-CHG-ACCT           VALUE 'Y'.
  8041     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8042     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8043     12  EN-BATCH-NUMBER         PIC X(6).
  8044     12  EN-ACCT-SUMM            PIC X.
  8045     12  EN-CSO-SUMM             PIC X.
  8046     12  FILLER                  PIC X(13).
  8047******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 154
* EL689.cbl
  8049*    COPY ERCNOTE.
  8050******************************************************************
  8051*                                                                *
  8052*                                                                *
  8053*                            ERCNOTE                             *
  8054*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8055*                            VMOD=2.003                          *
  8056*                                                                *
  8057*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  8058*                                                                *
  8059*        FILE TYPE= VSAM,KSDS                                    *
  8060*        RECORD SIZE = 825    RECFORM = FIXED                    *
  8061*                                                                *
  8062*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  8063*                                                                *
  8064*        LOG = YES                                               *
  8065*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  8066*                                                                *
  8067******************************************************************
  8068*                   C H A N G E   L O G
  8069*
  8070* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8071*-----------------------------------------------------------------
  8072*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8073* EFFECTIVE    NUMBER
  8074*-----------------------------------------------------------------
  8075* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  8076*                                FILE WILL CONTAIN BILLING NOTES O
  8077******************************************************************
  8078
  8079 01  CERTIFICATE-NOTE.
  8080     12  CN-RECORD-ID                PIC  XX.
  8081         88  VALID-CN-ID                  VALUE 'CN'.
  8082
  8083     12  CN-CONTROL-PRIMARY.
  8084         16  CN-COMPANY-CD           PIC X.
  8085         16  CN-CARRIER              PIC X.
  8086         16  CN-GROUPING.
  8087             20 CN-GROUPING-PREFIX   PIC XXX.
  8088             20 CN-GROUPING-PRIME    PIC XXX.
  8089         16  CN-STATE                PIC XX.
  8090         16  CN-ACCOUNT.
  8091             20 CN-ACCOUNT-PREFIX    PIC X(4).
  8092             20 CN-ACCOUNT-PRIME     PIC X(6).
  8093         16  CN-CERT-EFF-DT          PIC XX.
  8094         16  CN-CERT-NO.
  8095             20  CN-CERT-PRIME       PIC X(10).
  8096             20  CN-CERT-SFX         PIC X.
  8097
  8098     12  CN-BILLING-START-LINE-NO    PIC 99.
  8099     12  CN-BILLING-END-LINE-NO      PIC 99.
  8100
  8101     12  CN-LINES.
  8102         16  CN-LINE OCCURS 10       PIC X(77).
  8103
  8104     12  CN-LAST-MAINT-DT            PIC XX.
  8105     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8106     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 155
* EL689.cbl
  8107     12  FILLER                      PIC X(6).
  8108******************************************************************
  8109*    COPY ELCEOBC.
  8110******************************************************************
  8111*                                                                *
  8112*                                                                *
  8113*                            ELCEOBC                             *
  8114*                            VMOD=2.001                          *
  8115*                                                                *
  8116*   CLAIM SYSTEM EOB CODE TABLE                                  *
  8117*                                                                *
  8118*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  8119*   VSAM EOB CODE TABLE                                          *
  8120*                                                                *
  8121*   FILE DESCRIPTION = EOB CODE TABLE                            *
  8122*                                                                *
  8123*   FILE TYPE = VSAM,KSDS                                        *
  8124*   RECORD SIZE = 350   RECFORM = FIX                            *
  8125*                                                                *
  8126*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  8127*                                                                *
  8128*   LOG = NO                                                     *
  8129*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8130*                                                                *
  8131*                                                                *
  8132******************************************************************
  8133*                   C H A N G E   L O G
  8134*
  8135* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8136*-----------------------------------------------------------------
  8137*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8138* EFFECTIVE    NUMBER
  8139*-----------------------------------------------------------------
  8140* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  8141* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  8142* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  8143******************************************************************
  8144 01  EOB-CODES.
  8145     12  EO-RECORD-ID                      PIC XX.
  8146         88  VALID-DN-ID                      VALUE 'EO'.
  8147     12  EO-CONTROL-PRIMARY.
  8148         16  EO-COMPANY-CD                 PIC X.
  8149         16  EO-RECORD-TYPE                PIC X.
  8150             88  EO-EOB-RECS                  VALUE '1'.
  8151             88  EO-VERIF-RECS                VALUE '2'.
  8152             88  EO-GCE-RECS                  VALUE '3'.
  8153             88  EO-CANC-RECS                 VALUE '4'.
  8154             88  EO-BILL-NOTE-RECS            VALUE '5'.
  8155         16  EO-EOB-CODE                   PIC X(4).
  8156         16  FILLER                        PIC X(9).
  8157     12  EO-MAINT-INFORMATION.
  8158         16  EO-LAST-MAINT-DT              PIC XX.
  8159         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  8160         16  EO-LAST-MAINT-USER            PIC X(4).
  8161         16  FILLER                        PIC XX.
  8162     12  EO-DESCRIPTION                    PIC X(275).
  8163     12  FILLER                            PIC X(46).
  8164******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 156
* EL689.cbl
  8166*    COPY ELCENCC.
  8167******************************************************************
  8168*                                                                *
  8169*                                                                *
  8170*                            ELCENCC                             *
  8171*                            VMOD=2.001                          *
  8172*                                                                *
  8173*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  8174*                                                                *
  8175*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  8176*   A NAPERSOFT DOCUMENT                                         *
  8177*                                                                *
  8178*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  8179*                                                                *
  8180*   FILE TYPE = VSAM,KSDS                                        *
  8181*   RECORD SIZE = 400   RECFORM = FIX                            *
  8182*                                                                *
  8183*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  8184*                                                                *
  8185*   LOG = NO                                                     *
  8186*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8187*                                                                *
  8188*                                                                *
  8189******************************************************************
  8190*                   C H A N G E   L O G
  8191*
  8192* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8193*-----------------------------------------------------------------
  8194*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8195* EFFECTIVE    NUMBER
  8196*-----------------------------------------------------------------
  8197* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  8198******************************************************************
  8199 01  ENCLOSURE-CODES.
  8200     12  NC-RECORD-ID                      PIC XX.
  8201         88  VALID-NC-ID                      VALUE 'NC'.
  8202     12  NC-CONTROL-PRIMARY.
  8203         16  NC-COMPANY-CD                 PIC X.
  8204         16  NC-REC-TYPE                   PIC X.
  8205             88  NC-CLAIMS                   VALUE '1'.
  8206             88  NC-ADMIN                    VALUE '2'.
  8207         16  NC-ENC-CODE                   PIC X(5).
  8208         16  FILLER                        PIC X(09).
  8209     12  NC-MAINT-INFORMATION.
  8210         16  NC-LAST-MAINT-DT              PIC XX.
  8211         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  8212         16  NC-LAST-MAINT-USER            PIC X(4).
  8213         16  FILLER                        PIC XX.
  8214     12  NC-OUTPUT-STACK                   PIC XXX.
  8215     12  NC-ENCLOSURE-LINE                 PIC X(100).
  8216     12  NC-ATTACHMENTS                    PIC X(100).
  8217     12  NC-FUTURE                         PIC X(50).
  8218     12  FILLER                            PIC X(117).
  8219******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 157
* EL689.cbl
  8221 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  8222                          ACCOUNT-MASTER LETTER-ARCHIVE
  8223                          LETTER-ARCHIVE-TEXT
  8224                          CERTIFICATE-MASTER CHECK-RECORDS
  8225                          CONTROL-FILE COMPENSATION-MASTER
  8226                          MAILING-DATA PENDING-BUSINESS
  8227                          PENDING-PAY-ADJ TEXT-FILES
  8228                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  8229                          EOB-CODES ENCLOSURE-CODES.
  8230 0000-DFHEXIT SECTION.
  8231     MOVE '9#                    $   ' TO DFHEIV0.
  8232     MOVE 'EL689' TO DFHEIV1.
  8233     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8234     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  8235
  8236     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8237     MOVE '5'                    TO DC-OPTION-CODE.
  8238     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  8239     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  8240     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  8241                                    W-CURRENT-SAVE.
  8242
  8243     MOVE '6'                    TO DC-OPTION-CODE
  8244     IF DC-DAY-OF-WEEK = 6
  8245        MOVE 3                   TO DC-ELAPSED-DAYS
  8246     ELSE
  8247        IF DC-DAY-OF-WEEK = 7
  8248           MOVE 2                TO DC-ELAPSED-DAYS
  8249        ELSE
  8250           MOVE 1                TO DC-ELAPSED-DAYS
  8251        END-IF
  8252     END-IF
  8253     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8254     IF NO-CONVERSION-ERROR
  8255         MOVE DC-BIN-DATE-2      TO W-SAVE-BIN-NEXT-BUS-DT
  8256     ELSE
  8257         DISPLAY 'ERROR CALCULATING NEXT BUS DATE'
  8258         MOVE W-SAVE-BIN-DATE    TO W-SAVE-BIN-NEXT-BUS-DT
  8259     END-IF
  8260
  8261     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8262     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  8263                                 TO EMI-SAVE-AREA.
  8264
  8265     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8266                                    W-TS-TERM-SCREEN.
  8267
  8268     IF  EIBCALEN EQUAL 0
  8269         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  8270         GO TO 8300-SEND-TEXT
  8271     END-IF.
  8272     set P to address of KIXSYS
  8273     CALL "getenv" using by value P returning var-ptr
  8274     if var-ptr = null then
  8275        display ' kixsys not set '
  8276     else
  8277        set address of var to var-ptr
  8278        move 0 to env-var-len
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 158
* EL689.cbl
  8279        inspect var tallying env-var-len
  8280          for characters before X'00'
  8281*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  8282        unstring var (1:env-var-len) delimited by '/'
  8283           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8284              WS-KIX-SYS
  8285        end-unstring
  8286*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  8287*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8288     end-if
  8289     set P to address of KIXHOST
  8290     CALL "getenv" using by value P returning var-ptr
  8291     if var-ptr = null then
  8292        display ' kixhost not set '
  8293     else
  8294        set address of var to var-ptr
  8295        move 0 to env-var-len
  8296        inspect var tallying env-var-len
  8297          for characters before X'00'
  8298*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  8299        MOVE var(1:env-var-len)  to ws-kixhost
  8300*       unstring var (1:env-var-len) delimited by '/'
  8301*          into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8302*             WS-KIX-SYS
  8303*       end-unstring
  8304        DISPLAY ' WS KIX HOST ' WS-KIXSYS
  8305*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8306     end-if
  8307     IF  PI-689-CREATE-NO-SCREENS
  8308         GO TO 0600-BYPASS-SCREEN-CNTL
  8309     END-IF.
  8310
  8311     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  8312         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  8313             MOVE PI-SAVED-PROGRAM-5
  8314                                 TO PI-SAVED-PROGRAM-6
  8315             MOVE PI-SAVED-PROGRAM-4
  8316                                 TO PI-SAVED-PROGRAM-5
  8317             MOVE PI-SAVED-PROGRAM-3
  8318                                 TO PI-SAVED-PROGRAM-4
  8319             MOVE PI-SAVED-PROGRAM-2
  8320                                 TO PI-SAVED-PROGRAM-3
  8321             MOVE PI-SAVED-PROGRAM-1
  8322                                 TO PI-SAVED-PROGRAM-2
  8323             MOVE PI-RETURN-TO-PROGRAM
  8324                                 TO PI-SAVED-PROGRAM-1
  8325             MOVE PI-CALLING-PROGRAM
  8326                                 TO PI-RETURN-TO-PROGRAM
  8327             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  8328             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8329             MOVE LOW-VALUES     TO EL689AO
  8330             PERFORM 9905-INITIALIZE-SECURITY THRU 9905-EXIT
  8331             IF PI-689-ARCHIVE-NUMBER NOT NUMERIC
  8332                MOVE ZEROS       TO PI-689-ARCHIVE-NUMBEr
  8333             END-IF
  8334             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  8335                     AND
  8336                 PI-689-KEY-DATA-FIELDS GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 159
* EL689.cbl
  8337                 GO TO 0400-EL6311-INCOMING
  8338             ELSE
  8339                 MOVE PI-689-ARCHIVE-NUMBER
  8340                                 TO W-INCOMING-ARCHIVE
  8341                 MOVE LOW-VALUES TO PI-1042-WA
  8342                                    PI-689-WORK-AREA
  8343                 MOVE ZEROS      TO PI-CURRENT-LINE
  8344                                    PI-TEMP-STOR-ITEMS
  8345                                    PI-TOTAL-LINES
  8346                                    PI-UPDATE-SW
  8347                                    PI-689-NUMBER-LABEL-LINES
  8348                                    PI-689-NUMBER-TEXT-RECORDS
  8349                                    PI-689-ERROR
  8350                 MOVE SPACES     TO PI-689-PRINT-SW
  8351                                    PI-689-ALT-PRINTER-ID
  8352                                    PI-689-LBL-OVERRIDE
  8353                                    PI-COMM-CONTROL
  8354                                    PI-689-FORM-NUMBER
  8355                                    PI-689-TEMP-STOR-ID
  8356                                    PI-689-LABEL-SOURCE
  8357                                    PI-689-USE-SCREEN-IND
  8358                 MOVE '2'        TO PI-ACTION
  8359                 MOVE -1         TO MAINTL
  8360                 MOVE PI-LOWER-CASE-LETTERS
  8361                                 TO W-LC-CASE-IND
  8362                 IF  W-INCOMING-ARCHIVE NUMERIC
  8363                         AND
  8364                     W-INCOMING-ARCH-NO GREATER THAN ZEROS
  8365                     MOVE 'S'    TO MAINTI
  8366                     MOVE +1     TO MAINTL
  8367                     MOVE AL-UANON
  8368                                 TO MAINTA
  8369                     MOVE W-INCOMING-ARCH-NO
  8370                                 TO ARCHNUMI
  8371                     MOVE +8     TO ARCHNUML
  8372                     MOVE AL-UNNON
  8373                                 TO ARCHNUMA
  8374                     GO TO 1000-SHOW
  8375                 ELSE
  8376                     GO TO 0450-SPECIAL-INPUT-PROCESS
  8377                 END-IF
  8378             END-IF
  8379         ELSE
  8380             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  8381             MOVE PI-RETURN-TO-PROGRAM
  8382                                     TO PI-CALLING-PROGRAM
  8383             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  8384             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  8385             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  8386             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  8387             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  8388             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  8389             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  8390             PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8391             MOVE LOW-VALUES         TO EL689AO
  8392             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8393             SET W-RG-NDX            TO PI-CURRENT-LINE
  8394             PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 160
* EL689.cbl
  8395                 VARYING
  8396                     W-SC-NDX FROM 1 BY 1
  8397                 UNTIL
  8398                     W-SC-NDX GREATER THAN
  8399                     W-NUM-LINES-PER-SCREEN
  8400             MOVE PI-689-ALT-PRINTER-ID
  8401                                     TO PRINTERO
  8402             MOVE AL-UANON           TO PRINTERA
  8403             MOVE -1                 TO PRINTERL
  8404             GO TO 8100-SEND-INITIAL-MAP
  8405         END-IF
  8406     END-IF.
  8407
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 161
* EL689.cbl
  8409 0200-RECEIVE.
  8410
  8411     MOVE PI-689-FATAL-CTR       TO EMI-FATAL-CTR
  8412     MOVE PI-689-FORCABLE-CTR    TO EMI-FORCABLE-CTR
  8413     IF  EMI-FATAL-CTR GREATER THAN ZEROS
  8414             OR
  8415         EMI-FORCABLE-CTR GREATER THAN ZEROS
  8416         MOVE 'Y'                TO W-HOLD-IND.
  8417
  8418     MOVE W-TRANSACTION          TO EIBTRNID.
  8419     MOVE EMI-SAVE-AREA          TO ERROR-MESSAGE-INTERFACE-BLOCK.
  8420     MOVE ZEROS                  TO W-LAST-ERROR.
  8421     MOVE LOW-VALUES             TO EL689AI.
  8422     MOVE '104A'                 TO W-TS-ID-TEXT.
  8423     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8424                                    W-TS-TERM-SCREEN.
  8425
  8426
  8427* EXEC CICS HANDLE AID
  8428*        CLEAR    (9300-DFHCLEAR)
  8429*        PA1      (9200-PA)
  8430*        PA2      (9200-PA)
  8431*        PA3      (9200-PA)
  8432*    END-EXEC.
  8433*    MOVE '"&=!"#               V! " #00008422' TO DFHEIV0
  8434     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  8435     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  8436     MOVE X'2220233030303038343232' TO DFHEIV0(25:11)
  8437     CALL 'kxdfhei1' USING DFHEIV0
  8438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8439
  8440
  8441
  8442* EXEC CICS HANDLE CONDITION
  8443*        PGMIDERR (9700-PGMID-ERROR)
  8444*        ERROR    (9800-ABEND)
  8445*        MAPFAIL  (0325-MAPFAIL)
  8446*    END-EXEC.
  8447*    MOVE '"$L.?                 ! # #00008429' TO DFHEIV0
  8448     MOVE X'22244C2E3F20202020202020' TO DFHEIV0(1:12)
  8449     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8450     MOVE X'2320233030303038343239' TO DFHEIV0(25:11)
  8451     CALL 'kxdfhei1' USING DFHEIV0
  8452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8453
  8454
  8455
  8456* EXEC CICS SYNCPOINT
  8457*    END-EXEC.
  8458*    MOVE '6"                    !   #00008435' TO DFHEIV0
  8459     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  8460     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8461     MOVE X'2020233030303038343335' TO DFHEIV0(25:11)
  8462     CALL 'kxdfhei1' USING DFHEIV0
  8463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8464
  8465
  8466     IF PI-LOWER-CASE-LETTERS = 'Y'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 162
* EL689.cbl
  8467*    IF  W-LC-USE-BOTH-CASES
  8468
  8469* EXEC CICS RECEIVE
  8470*            MAP      (W-MAP)
  8471*            MAPSET   (W-MAPSET)
  8472*            INTO     (EL689AI)
  8473*            ASIS
  8474*        END-EXEC
  8475     MOVE LENGTH OF
  8476      EL689AI
  8477       TO DFHEIV11
  8478*    MOVE '8"TAI  L              ''   #00008440' TO DFHEIV0
  8479     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8480     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8481     MOVE X'2020233030303038343430' TO DFHEIV0(25:11)
  8482     CALL 'kxdfhei1' USING DFHEIV0,
  8483           W-MAP,
  8484           EL689AI,
  8485           DFHEIV11,
  8486           W-MAPSET,
  8487           DFHEIV99,
  8488           DFHEIV99
  8489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8490     ELSE
  8491
  8492* EXEC CICS RECEIVE
  8493*            MAP      (W-MAP)
  8494*            MAPSET   (W-MAPSET)
  8495*            INTO     (EL689AI)
  8496*        END-EXEC.
  8497     MOVE LENGTH OF
  8498      EL689AI
  8499       TO DFHEIV11
  8500*    MOVE '8"T I  L              ''   #00008447' TO DFHEIV0
  8501     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8502     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8503     MOVE X'2020233030303038343437' TO DFHEIV0(25:11)
  8504     CALL 'kxdfhei1' USING DFHEIV0,
  8505           W-MAP,
  8506           EL689AI,
  8507           DFHEIV11,
  8508           W-MAPSET,
  8509           DFHEIV99,
  8510           DFHEIV99
  8511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8512
  8513
  8514     IF  NOT DISPLAY-CAP
  8515         MOVE 'READ'             TO SM-READ
  8516         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8517         MOVE ER-9097            TO EMI-ERROR
  8518         MOVE -1                 TO MAINTL
  8519         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8520         GO TO 8100-SEND-INITIAL-MAP.
  8521
  8522     INSPECT MAINTI CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
  8523
  8524     IF  ENTERPFL EQUAL 0
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 163
* EL689.cbl
  8525         GO TO 0300-CHECK-PFKEYS.
  8526
  8527     IF  EIBAID NOT EQUAL DFHENTER
  8528         MOVE ER-0004            TO EMI-ERROR
  8529         GO TO 0320-INPUT-ERROR.
  8530
  8531     IF  ENTERPFI NUMERIC
  8532             AND
  8533         ENTERPFI GREATER THAN 0
  8534             AND
  8535         ENTERPFI LESS THAN 25
  8536         MOVE PF-VALUES (ENTERPFI)
  8537                                 TO EIBAID
  8538     ELSE
  8539         MOVE ER-0029            TO EMI-ERROR
  8540         GO TO 0320-INPUT-ERROR.
  8541
  8542 0300-CHECK-PFKEYS.
  8543
  8544     IF  EIBAID EQUAL DFHPF23
  8545         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8546         MOVE ZEROS              TO PI-TOTAL-LINES
  8547                                    PI-CURRENT-LINE
  8548         MOVE EIBAID             TO PI-ENTRY-CD-1
  8549         MOVE W-XCTL-005         TO W-CALL-PGM
  8550         GO TO 9400-XCTL.
  8551
  8552     IF  EIBAID EQUAL DFHPF24
  8553         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8554         MOVE ZEROS              TO PI-TOTAL-LINES
  8555                                    PI-CURRENT-LINE
  8556         MOVE W-XCTL-626         TO W-CALL-PGM
  8557         GO TO 9400-XCTL.
  8558
  8559     MOVE SPACES                 TO W-KEY-FIELDS-CHANGED-IND
  8560                                    W-FORM-CHANGED-IND.
  8561
  8562     IF  PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8563             OR
  8564         PI-SHOW-MODE
  8565         NEXT SENTENCE
  8566     ELSE
  8567         IF  PI-689-FORM-NUMBER GREATER THAN SPACES
  8568                 AND
  8569             FORML NOT EQUAL ZEROS
  8570                 AND
  8571             PI-689-FORM-NUMBER NOT EQUAL FORMI
  8572             MOVE FORMI          TO PI-689-FORM-NUMBER
  8573             MOVE LOW-VALUES     TO EL689AI
  8574                                    PI-1042-WA
  8575                                    PI-689-FOLLOW-UP-DATE
  8576                                    PI-689-PRINT-RESTRICTION
  8577                                    PI-689-RESEND-DATE-1
  8578                                    PI-689-RESEND1-EDIT
  8579                                    PI-689-FOLLOW-UP-DATE
  8580                                    PI-689-FOLLOW-UP-EDIT
  8581                                    PI-689-ERROR-IND
  8582             MOVE ZEROS          TO PI-689-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 164
* EL689.cbl
  8583                                    PI-689-NUMBER-COPIES
  8584                                    PI-689-NUMBER-LABEL-LINES
  8585                                    PI-689-NUMBER-TEXT-RECORDS
  8586                                    PI-CURRENT-LINE
  8587                                    PI-TEMP-STOR-ITEMS
  8588                                    PI-TOTAL-LINES
  8589                                    PI-UPDATE-SW
  8590             MOVE SPACES         TO PI-689-PRINT-SW
  8591                                    PI-689-ALT-PRINTER-ID
  8592                                    PI-COMM-CONTROL
  8593                                    PI-689-TEMP-STOR-ID
  8594                                    PI-689-USE-SCREEN-IND
  8595                                    PI-689-RESEND-LETR-1
  8596                                    PI-CERT-FORM-ID
  8597                                    PI-CERT-REQ-IND
  8598                                    PI-REASON-REQ-IND
  8599             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8600             MOVE DFHENTER       TO EIBAID
  8601             MOVE 'Y'            TO W-FORM-CHANGED-IND
  8602             GO TO 0330-FUNCTION-CHECK
  8603         ELSE
  8604             IF  PI-689-DATA-SOURCE NOT EQUAL DATASORI
  8605                     OR
  8606                 (PI-689-LABEL-SOURCE NOT EQUAL ADDRSI
  8607                         AND
  8608                     (PI-689-LABEL-SOURCE NOT EQUAL SPACES
  8609                             OR
  8610                         ADDRSI NOT EQUAL LOW-VALUES))
  8611                     OR
  8612                 PI-689-CARRIER NOT EQUAL CARRIERI
  8613                     OR
  8614                 PI-689-GROUPING NOT EQUAL GROUPI
  8615                     OR
  8616                 PI-689-STATE NOT EQUAL STATEI
  8617                     OR
  8618                 PI-689-ACCOUNT NOT EQUAL ACCTI
  8619                     OR
  8620                 PI-689-CERT-PRIME NOT EQUAL CERTI
  8621                     OR
  8622                 PI-689-CERT-SFX NOT EQUAL SFXI
  8623                     OR
  8624                 PI-689-TYPE NOT EQUAL TYPEI
  8625                     OR
  8626                 PI-689-DATE-EDIT NOT EQUAL DATEI
  8627                     OR
  8628                 PI-689-RESP-PERSON NOT EQUAL RPERSONI
  8629                     OR
  8630                 PI-689-SEQ-EDIT NOT EQUAL SEQI
  8631                     OR
  8632                 PI-689-ENTRY-BATCH NOT EQUAL BENTRYI
  8633                     OR
  8634                 PI-689-BCSEQ-EDIT NOT EQUAL BCSEQI
  8635                 MOVE 'Y'        TO W-KEY-FIELDS-CHANGED-IND
  8636                 MOVE DFHENTER   TO EIBAID
  8637                 GO TO 0330-FUNCTION-CHECK.
  8638
  8639*    IF  EIBAID EQUAL DFHPF1
  8640*        MOVE +7                 TO W-ROLL-COUNTER
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 165
* EL689.cbl
  8641*        GO TO 4000-ROLL-PAGE.
  8642
  8643*    IF  EIBAID EQUAL DFHPF2
  8644*        MOVE -7                 TO W-ROLL-COUNTER
  8645*        GO TO 4000-ROLL-PAGE.
  8646
  8647*    IF  EIBAID EQUAL DFHPF3
  8648*        IF  W-HOLD-ON
  8649*            MOVE ER-7245        TO EMI-ERROR
  8650*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8651*            MOVE -1             TO MAINTL
  8652*            MOVE AL-UABON       TO MAINTA
  8653*            GO TO 8200-SEND-DATAONLY
  8654*        ELSE
  8655*            GO TO 0330-FUNCTION-CHECK.
  8656*    IF (EIBAID = DFHPF8)
  8657*       AND (PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR
  8658*         'CAGB' OR 'DLVA' OR 'ECCA' OR 'KRHA' OR 'ALWA')
  8659*       MOVE ER-0029             TO EMI-ERROR
  8660*       GO TO 0320-INPUT-ERROR
  8661*    END-IF
  8662*    IF EIBAID = DFHPF4 OR DFHPF8
  8663*        IF  W-HOLD-ON
  8664*            MOVE ER-7245        TO EMI-ERROR
  8665*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8666*            MOVE -1             TO MAINTL
  8667*            MOVE AL-UABON       TO MAINTA
  8668*            GO TO 8200-SEND-DATAONLY
  8669*        ELSE
  8670*            GO TO 0330-FUNCTION-CHECK.
  8671
  8672*    IF  EIBAID = DFHPF5
  8673*        COMPUTE W-ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  8674*        GO TO 4000-ROLL-PAGE.
  8675
  8676*    IF  EIBAID = DFHPF6
  8677*        MOVE PI-TOTAL-LINES     TO W-ROLL-COUNTER
  8678*        GO TO 4000-ROLL-PAGE.
  8679
  8680     IF  EIBAID EQUAL DFHPF7
  8681         IF PI-PROMPT-IND EQUAL 'Y'
  8682             MOVE ER-0894        TO EMI-ERROR
  8683             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8684             MOVE -1             TO MAINTL
  8685             MOVE AL-UABON       TO MAINTA
  8686             GO TO 8200-SEND-DATAONLY
  8687         END-IF
  8688     END-IF.
  8689
  8690     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8691         IF  W-HOLD-ON
  8692             MOVE ER-7245        TO EMI-ERROR
  8693             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8694             MOVE -1             TO MAINTL
  8695             MOVE AL-UABON       TO MAINTA
  8696             GO TO 8200-SEND-DATAONLY
  8697         ELSE
  8698             GO TO 0330-FUNCTION-CHECK.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 166
* EL689.cbl
  8699
  8700     IF  EIBAID EQUAL DFHENTER
  8701         GO TO 0330-FUNCTION-CHECK.
  8702
  8703     MOVE ER-0029                TO EMI-ERROR.
  8704
  8705 0320-INPUT-ERROR.
  8706
  8707     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8708
  8709     IF  ENTERPFL EQUAL 0
  8710         MOVE -1                 TO MAINTL
  8711         MOVE AL-UABON           TO MAINTA
  8712     ELSE
  8713         MOVE AL-UNBON           TO ENTERPFA
  8714         MOVE -1                 TO ENTERPFL.
  8715
  8716     GO TO 8200-SEND-DATAONLY.
  8717
  8718 0325-MAPFAIL.
  8719***********************************************************
  8720*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  8721*      LETTERS ON A 3275 PRINTER.                         *
  8722***********************************************************
  8723
  8724     PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8725
  8726     SET W-RG-NDX                TO PI-CURRENT-LINE.
  8727     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8728             VARYING
  8729         W-SC-NDX FROM 1 BY 1
  8730             UNTIL
  8731         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  8732
  8733     MOVE -1                     TO MAINTL.
  8734     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 167
* EL689.cbl
  8736 0330-FUNCTION-CHECK.
  8737
  8738     IF  MAINTI EQUAL 'S'
  8739*        IF EIBAID = DFHPF4 OR DFHPF8
  8740*            GO TO 7900-PRINT-LETTER-NOW
  8741*        ELSE
  8742             GO TO 1000-SHOW.
  8743
  8744     IF  NOT MODIFY-CAP
  8745         MOVE 'UPDATE'           TO SM-READ
  8746         PERFORM 9995-SECURITY-VIOLATION
  8747         MOVE ER-0070            TO EMI-ERROR
  8748         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8749         MOVE -1                 TO MAINTL
  8750         GO TO 8100-SEND-INITIAL-MAP.
  8751
  8752     IF  W-FORM-CHANGED
  8753             OR
  8754         W-KEY-FIELDS-CHANGED
  8755         GO TO 0330-EDIT.
  8756
  8757     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8758
  8759
  8760*    IF  EIBAID EQUAL DFHPF3
  8761*        IF  PI-NO-CARRIER-SECURITY
  8762*                AND
  8763*            PI-NO-ACCOUNT-SECURITY
  8764*            GO TO 5000-EDIT-MODE.
  8765
  8766     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8767         IF  PI-NO-CARRIER-SECURITY
  8768                 AND
  8769             PI-NO-ACCOUNT-SECURITY
  8770             GO TO 5400-LETTER-RELEASE
  8771         ELSE
  8772             IF  PI-689-PRINT-PERFORMED
  8773                 GO TO 5400-LETTER-RELEASE
  8774             ELSE
  8775                 MOVE AL-UNBON TO ENTERPFA
  8776                 MOVE -1       TO ENTERPFL
  8777                 MOVE ER-2398  TO EMI-ERROR
  8778                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8779                 GO TO 8200-SEND-DATAONLY.
  8780
  8781*    IF  EIBAID = DFHPF4 OR DFHPF8
  8782*        GO TO 7900-PRINT-LETTER-NOW.
  8783
  8784 0330-EDIT.
  8785
  8786     IF  W-SC-TEXTL (1) NOT EQUAL ZEROS
  8787             OR
  8788         W-SC-TEXTL (2) NOT EQUAL ZEROS
  8789             OR
  8790         W-SC-TEXTL (3) NOT EQUAL ZEROS
  8791             OR
  8792         W-SC-TEXTL (4) NOT EQUAL ZEROS
  8793             OR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 168
* EL689.cbl
  8794         W-SC-TEXTL (5) NOT EQUAL ZEROS
  8795             OR
  8796         W-SC-TEXTL (6) NOT EQUAL ZEROS
  8797             OR
  8798         W-SC-TEXTL (7) NOT EQUAL ZEROS
  8799             OR
  8800         W-SC-TEXTL (8) NOT EQUAL ZEROS
  8801             OR
  8802         W-SC-TEXTL (9) NOT EQUAL ZEROS
  8803             OR
  8804         W-SC-TEXTL (10) NOT EQUAL ZEROS
  8805             OR
  8806         W-SC-TEXTL (11) NOT EQUAL ZEROS
  8807         IF  W-KEY-FIELDS-CHANGED
  8808                 OR
  8809             W-FORM-CHANGED
  8810             MOVE ER-7250        TO EMI-ERROR
  8811             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8812             MOVE -1             TO MAINTL
  8813             MOVE AL-UABON       TO MAINTA
  8814         ELSE
  8815             PERFORM 4100-SET-NDX THRU 4100-EXIT
  8816             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
  8817                     VARYING
  8818                 W-SC-NDX FROM 1 BY 1
  8819                     UNTIL
  8820                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
  8821             MOVE ER-7398        TO EMI-ERROR
  8822             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8823             MOVE -1             TO MAINTL
  8824             MOVE AL-UABON       TO MAINTA
  8825             GO TO 8200-SEND-DATAONLY.
  8826
  8827     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8828
  8829     IF  W-KEY-FIELDS-CHANGED
  8830             OR
  8831         PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8832         PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8833         IF  MAINTI EQUAL 'C'
  8834             GO TO 2000-CREATE
  8835         ELSE
  8836             NEXT SENTENCE
  8837     ELSE
  8838         IF  W-FORM-CHANGED
  8839             PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8840             IF  MAINTI EQUAL 'C'
  8841                 GO TO 2000-CREATE
  8842             ELSE
  8843                 NEXT SENTENCE
  8844         ELSE
  8845             MOVE -1             TO MAINTL
  8846             GO TO 8200-SEND-DATAONLY.
  8847
  8848     MOVE ER-0023                TO EMI-ERROR.
  8849     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8850     MOVE -1                     TO MAINTL.
  8851     MOVE AL-UABON               TO MAINTA.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 169
* EL689.cbl
  8852     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 170
* EL689.cbl
  8854 0350-EDIT-ROUTINE.
  8855
  8856     IF  MAINTI EQUAL 'C'
  8857             AND
  8858         FORML EQUAL ZEROS
  8859         MOVE -1                 TO FORML
  8860         MOVE ER-0177            TO EMI-ERROR
  8861         MOVE AL-UABON           TO FORMA
  8862         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8863
  8864     IF PRTNOWL > ZEROS
  8865        IF PRTNOWI = 'Y' OR 'N' OR 'P' OR ' '
  8866           MOVE PRTNOWI          TO PI-PRINT-NOW
  8867           MOVE AL-UANON         TO PRTNOWA
  8868        END-IF
  8869     END-IF
  8870     IF ENDARCHL > ZEROS
  8871        IF ENDARCHI NUMERIC
  8872            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
  8873            MOVE AL-UNNON       TO ENDARCHA
  8874            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
  8875            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
  8876            MOVE 'N'            TO W-VALID-ENDT-SW
  8877            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
  8878            IF NOT W-VALID-ENDT
  8879                MOVE -1         TO ENDARCHL
  8880                MOVE ER-1565    TO EMI-ERROR
  8881                MOVE AL-UNBON   TO ENDARCHA
  8882                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8883            END-IF
  8884        END-IF
  8885     ELSE
  8886        MOVE ZEROS              TO PI-ENDT-ARCH-NO
  8887     END-IF
  8888     MOVE SPACES                 TO PI-689-PRINT-RESTRICTION
  8889*    IF  PRTRESTL NOT EQUAL ZEROS
  8890*        PERFORM 0360-EDIT-PRINT-RESTRICTIONS THRU 0360-EXIT.
  8891
  8892     IF  FOLLOWL NOT EQUAL ZEROS
  8893         MOVE FOLLOWI            TO W-DEEDIT-FIELD
  8894         PERFORM 8600-DEEDIT
  8895         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8896         MOVE '4'                TO DC-OPTION-CODE
  8897         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8898         IF  DATE-CONVERSION-ERROR
  8899             MOVE ER-0182        TO EMI-ERROR
  8900             MOVE -1             TO FOLLOWL
  8901             MOVE AL-UABON       TO FOLLOWA
  8902             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8903         ELSE
  8904             MOVE DC-GREG-DATE-1-EDIT
  8905                                 TO FOLLOWO
  8906                                    PI-689-FOLLOW-UP-EDIT
  8907             MOVE AL-UANON       TO FOLLOWA
  8908             MOVE DC-BIN-DATE-1  TO PI-689-FOLLOW-UP-DATE
  8909     ELSE
  8910         MOVE LOW-VALUES         TO PI-689-FOLLOW-UP-DATE.
  8911
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 171
* EL689.cbl
  8912     IF  PI-689-FOLLOW-UP-DATE NOT EQUAL LOW-VALUES
  8913         IF  PI-689-FOLLOW-UP-DATE LESS THAN
  8914                 W-SAVE-BIN-DATE
  8915             MOVE ER-0533        TO EMI-ERROR
  8916             MOVE AL-UABON       TO FOLLOWA
  8917             MOVE -1             TO FOLLOWL
  8918             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8919
  8920     IF  RESEND1L NOT EQUAL ZEROS
  8921         MOVE RESEND1I           TO W-DEEDIT-FIELD
  8922         PERFORM 8600-DEEDIT
  8923         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8924         MOVE '4'                TO DC-OPTION-CODE
  8925         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8926         IF  DATE-CONVERSION-ERROR
  8927             MOVE ER-0185        TO EMI-ERROR
  8928             MOVE -1             TO RESEND1L
  8929             MOVE AL-UABON       TO RESEND1A
  8930             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8931         ELSE
  8932             MOVE DC-GREG-DATE-1-EDIT
  8933                                 TO RESEND1O
  8934                                    PI-689-RESEND1-EDIT
  8935             MOVE AL-UANON       TO RESEND1A
  8936             MOVE DC-BIN-DATE-1  TO PI-689-RESEND-DATE-1
  8937     ELSE
  8938         MOVE LOW-VALUES         TO PI-689-RESEND-DATE-1.
  8939
  8940     IF  PI-689-RESEND-DATE-1 NOT EQUAL LOW-VALUES
  8941         IF  PI-689-RESEND-DATE-1 NOT GREATER THAN
  8942                 W-SAVE-BIN-DATE
  8943             MOVE ER-0537        TO EMI-ERROR
  8944             MOVE AL-UABON       TO RESEND1A
  8945             MOVE -1             TO RESEND1L
  8946             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8947
  8948     IF ENCL > ZEROS
  8949        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  8950                                          PI-ENCLOSURE-CD
  8951        MOVE SPACES             TO W-ELENCC-KEY
  8952        MOVE PI-COMPANY-CD      TO W-ENCC-COMPANY-CD
  8953        MOVE '2'                TO W-ENCC-REC-TYPE
  8954        MOVE ENCI               TO W-ENCC-ENC-CODE
  8955
  8956
  8957* EXEC CICS READ
  8958*           DATASET    (W-ENCC-FILE-ID)
  8959*           SET        (ADDRESS OF ENCLOSURE-CODES)
  8960*           RIDFLD     (W-ELENCC-KEY)
  8961*           RESP       (W-RESPONSE)
  8962*       END-EXEC
  8963*    MOVE '&"S        E          (  N#00008895' TO DFHEIV0
  8964     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8965     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8966     MOVE X'204E233030303038383935' TO DFHEIV0(25:11)
  8967     CALL 'kxdfhei1' USING DFHEIV0,
  8968           W-ENCC-FILE-ID,
  8969           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 172
* EL689.cbl
  8970           DFHEIV99,
  8971           W-ELENCC-KEY,
  8972           DFHEIV99,
  8973           DFHEIV99,
  8974           DFHEIV99
  8975     SET ADDRESS OF ENCLOSURE-CODES TO
  8976         DFHEIV20
  8977     MOVE EIBRESP  TO W-RESPONSE
  8978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8979
  8980        IF RESP-NORMAL
  8981           MOVE ENCI             TO PI-ENCLOSURE-CD
  8982                                    W-ENCLOSURE-CD
  8983           MOVE AL-UANON         TO ENCA
  8984        ELSE
  8985           MOVE ER-1560          TO EMI-ERROR
  8986           MOVE -1               TO ENCL
  8987           MOVE AL-UABON         TO ENCA
  8988           PERFORM 9900-ERROR-FORMAT
  8989                                 THRU 9900-EXIT
  8990        END-IF
  8991     END-IF
  8992
  8993
  8994     IF NOT PI-CREATE-LABELS
  8995         MOVE PI-LABEL-CONTROL   TO ADDRLBLI
  8996         MOVE AL-PANON           TO ADDRLBLA
  8997         GO TO 0350-BYPASS-OVERRIDE.
  8998
  8999     IF  ADDRLBLL GREATER THAN ZEROS
  9000          INSPECT ADDRLBLI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9001          IF ADDRLBLI = 'N' OR 'Y'
  9002              MOVE ADDRLBLI      TO PI-689-LBL-OVERRIDE
  9003              MOVE AL-UANON      TO ADDRLBLA
  9004          ELSE
  9005             MOVE ER-3783        TO EMI-ERROR
  9006             MOVE -1             TO ADDRLBLL
  9007             MOVE AL-UABON       TO ADDRLBLA
  9008             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9009
  9010 0350-BYPASS-OVERRIDE.
  9011
  9012     IF  PI-BYPASS-LABELS
  9013             OR
  9014         FORMI EQUAL '9999'
  9015             OR
  9016         PI-689-LABELS-OVERRIDEN
  9017         MOVE SPACES             TO PI-689-LABEL-SOURCE
  9018         MOVE LOW-VALUES         TO ADDRSI
  9019         MOVE AL-UANOF           TO ADDRSA
  9020         MOVE ZEROS              TO ADDRSL
  9021     ELSE
  9022         IF  ADDRSL GREATER THAN ZEROS
  9023             MOVE ADDRSI         TO W-LABEL-SOURCE
  9024             IF  W-LABEL-SOURCE-VALID
  9025                 MOVE ADDRSI     TO PI-689-LABEL-SOURCE
  9026             ELSE
  9027                 MOVE -1         TO ADDRSL
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 173
* EL689.cbl
  9028                 MOVE ER-0176    TO EMI-ERROR
  9029                 MOVE AL-UABON   TO ADDRSA
  9030                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9031         ELSE
  9032             IF  MAINTI EQUAL 'C'
  9033                 MOVE -1         TO ADDRSL
  9034                 MOVE ER-0176    TO EMI-ERROR
  9035                 MOVE AL-UABON   TO ADDRSA
  9036                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9037
  9038     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  9039     IF  PRINTERL GREATER ZERO
  9040         INSPECT PRINTERI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9041         MOVE AL-UANON           TO PRINTERA
  9042         MOVE PRINTERI           TO PI-689-ALT-PRINTER-ID
  9043                                    PI-ALT-DMD-PRT-ID
  9044     ELSE
  9045         IF  PI-NO-CARRIER-SECURITY
  9046                 AND
  9047             PI-NO-ACCOUNT-SECURITY
  9048             IF  PI-PROCESSOR-PRINTER GREATER THAN SPACES
  9049                 MOVE PI-PROCESSOR-PRINTER
  9050                                 TO PI-689-ALT-PRINTER-ID
  9051                                    PRINTERI
  9052                 MOVE AL-UABON   TO PRINTERA
  9053             ELSE
  9054                 MOVE PI-COMPANY-ID
  9055                                 TO W-CNTL-COMPANY-ID
  9056                 MOVE '1'        TO W-CNTL-RECORD-TYPE
  9057                 MOVE SPACES     TO W-CNTL-GENL
  9058                 MOVE ZEROS      TO W-CNTL-SEQ-NO
  9059
  9060* EXEC CICS HANDLE CONDITION
  9061*                     NOTOPEN    (8040-CNTL-NOT-OPEN)
  9062*                     NOTFND     (7945-NOT-FOUND)
  9063*                END-EXEC
  9064*    MOVE '"$JI                  ! $ #00008981' TO DFHEIV0
  9065     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9066     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9067     MOVE X'2420233030303038393831' TO DFHEIV0(25:11)
  9068     CALL 'kxdfhei1' USING DFHEIV0
  9069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9070
  9071* EXEC CICS READ
  9072*                     DATASET    (W-CNTL-FILE-ID)
  9073*                     SET        (ADDRESS OF CONTROL-FILE)
  9074*                     RIDFLD     (W-CNTL-KEY)
  9075*                END-EXEC
  9076*    MOVE '&"S        E          (   #00008985' TO DFHEIV0
  9077     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9078     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9079     MOVE X'2020233030303038393835' TO DFHEIV0(25:11)
  9080     CALL 'kxdfhei1' USING DFHEIV0,
  9081           W-CNTL-FILE-ID,
  9082           DFHEIV20,
  9083           DFHEIV99,
  9084           W-CNTL-KEY,
  9085           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 174
* EL689.cbl
  9086           DFHEIV99,
  9087           DFHEIV99
  9088     SET ADDRESS OF CONTROL-FILE TO
  9089         DFHEIV20
  9090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9091                 MOVE CF-FORMS-PRINTER-ID
  9092                                 TO PI-689-ALT-PRINTER-ID
  9093                                    PRINTERI
  9094                                    W-TS-TERM-TEXT
  9095                 MOVE AL-UABON   TO PRINTERA
  9096         ELSE
  9097             MOVE AL-UABON       TO PRINTERA
  9098             MOVE -1             TO PRINTERL
  9099             MOVE ER-9283        TO EMI-ERROR
  9100             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9101
  9102     IF  COPIESL NOT EQUAL ZEROS
  9103         IF  COPIESI NOT NUMERIC
  9104                 OR
  9105             COPIESI EQUAL '0'
  9106             MOVE ER-0184        TO EMI-ERROR
  9107             MOVE -1             TO COPIESL
  9108             MOVE AL-UABON       TO COPIESA
  9109             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9110         ELSE
  9111             MOVE COPIESI        TO PI-689-NUMBER-COPIES
  9112             MOVE AL-UANON       TO COPIESA
  9113     ELSE
  9114         IF FORMI EQUAL '9999'
  9115             MOVE 1              TO PI-689-NUMBER-COPIES
  9116                                    COPIESL
  9117                                    COPIESO.
  9118
  9119     IF  FORML NOT EQUAL ZEROS
  9120         INSPECT FORMI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9121         MOVE FORMI              TO PI-689-FORM-NUMBER.
  9122
  9123     MOVE SPACES                 TO W-HOLD-IND.
  9124
  9125     IF PI-CERT-REQ-IND = 'Y'
  9126       IF  CERTIDL NOT EQUAL ZEROS
  9127         IF CERTIDI NUMERIC
  9128             MOVE AL-UANON      TO CERTIDA
  9129             MOVE CERTIDI       TO PI-CERT-FORM-ID
  9130         ELSE
  9131             MOVE ER-1778       TO EMI-ERROR
  9132             MOVE -1            TO CERTIDL
  9133             MOVE AL-UABON      TO CERTIDA
  9134             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9135         END-IF
  9136       ELSE
  9137          MOVE ER-0715       TO EMI-ERROR
  9138          MOVE -1            TO CERTIDL
  9139          MOVE AL-UABON      TO CERTIDA
  9140          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9141       END-IF
  9142     END-IF.
  9143
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 175
* EL689.cbl
  9144     IF PI-REASON-REQ-IND = 'Y'
  9145        IF PI-ENDT-ARCH-NO NOT > ZERO
  9146          MOVE ER-9840       TO EMI-ERROR
  9147          MOVE -1            TO FORML
  9148          MOVE AL-UABON      TO FORMA
  9149          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9150        END-IF
  9151     END-IF.
  9152
  9153     IF  NOT EMI-NO-ERRORS
  9154         IF  EMI-ERROR EQUAL ER-7250
  9155             GO TO 0350-EXIT
  9156         ELSE
  9157            MOVE -1             TO MAINTL
  9158            GO TO 8200-SEND-DATAONLY.
  9159
  9160 0350-EXIT.
  9161      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 176
* EL689.cbl
  9163 0355-CHECK-ERENDT.
  9164
  9165*     EXEC CICS GETMAIN
  9166*          SET      (ADDRESS OF ENDORSEMENT-RECORD)
  9167*          LENGTH   (W-ENDT-LENGTH)
  9168*     END-EXEC
  9169
  9170
  9171* EXEC CICS READ
  9172*         DATASET    ('ERENDT2')
  9173*         SET        (ADDRESS OF ENDORSEMENT-RECORD)
  9174*         RIDFLD     (W-ERENDT-KEY-BY-ARCH)
  9175*         RESP       (W-RESPONSE)
  9176*    END-EXEC
  9177     MOVE 'ERENDT2' TO DFHEIV1
  9178*    MOVE '&"S        E          (  N#00009069' TO DFHEIV0
  9179     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9181     MOVE X'204E233030303039303639' TO DFHEIV0(25:11)
  9182     CALL 'kxdfhei1' USING DFHEIV0,
  9183           DFHEIV1,
  9184           DFHEIV20,
  9185           DFHEIV99,
  9186           W-ERENDT-KEY-BY-ARCH,
  9187           DFHEIV99,
  9188           DFHEIV99,
  9189           DFHEIV99
  9190     SET ADDRESS OF ENDORSEMENT-RECORD TO
  9191         DFHEIV20
  9192     MOVE EIBRESP  TO W-RESPONSE
  9193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9194
  9195     IF (RESP-NORMAL)
  9196         IF PI-RETURN-TO-PROGRAM EQUAL 'EL6311'  AND
  9197            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9198            EN-CARRIER     =  PI-689-CARRIER     AND
  9199            EN-GROUPING    =  PI-689-GROUPING    AND
  9200            EN-STATE       =  PI-689-STATE       AND
  9201            EN-ACCOUNT     =  PI-689-ACCOUNT     AND
  9202            EN-CERT-EFF-DT =  PI-689-EFF-DATE    AND
  9203            EN-CERT-NO     =  PI-689-CERT-NO
  9204               SET W-VALID-ENDT TO TRUE
  9205         END-IF
  9206         IF PI-RETURN-TO-PROGRAM EQUAL 'EL1273'  AND
  9207            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9208            EN-CARRIER     =  PI-CARRIER         AND
  9209            EN-GROUPING    =  PI-GROUPING        AND
  9210            EN-STATE       =  PI-STATE           AND
  9211            EN-ACCOUNT     =  PI-ACCOUNT         AND
  9212            EN-CERT-EFF-DT =  PI-CERT-EFF-DT     AND
  9213            EN-CERT-NO     =  PI-CERT-NO
  9214               SET W-VALID-ENDT TO TRUE
  9215         END-IF
  9216     END-IF
  9217      .
  9218
  9219 0355-EXIT.
  9220      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 177
* EL689.cbl
  9222 0360-EDIT-PRINT-RESTRICTIONS.
  9223
  9224*    INSPECT PRTRESTI CONVERTING W-LOWER-CASE
  9225*                                TO W-UPPER-CASE.
  9226*
  9227*    IF  (PI-689-PRINT-RESTRICTION EQUAL ' ' OR 'F'
  9228*                                     OR 'P' OR LOW-VALUES)
  9229*            AND
  9230*        PRTRESTI EQUAL 'C'
  9231*            AND
  9232*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9233*        MOVE ER-7243            TO EMI-ERROR
  9234*        MOVE -1                 TO PRTRESTL
  9235*        MOVE AL-UABON           TO PRTRESTA
  9236*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9237*        GO TO 0360-EXIT.
  9238*
  9239*    IF  PRTRESTL NOT EQUAL ZEROS
  9240*        IF PRTRESTI = 'C' OR 'F' OR 'P'
  9241*            MOVE PRTRESTI       TO PI-689-PRINT-RESTRICTION
  9242*            MOVE AL-UANON       TO PRTRESTA
  9243*        ELSE
  9244*            IF  PRTRESTI EQUAL ' '
  9245*                MOVE SPACES     TO PI-689-PRINT-RESTRICTION
  9246*                MOVE AL-UANON   TO PRTRESTA
  9247*            ELSE
  9248*                MOVE ER-7393    TO EMI-ERROR
  9249*                MOVE -1         TO PRTRESTL
  9250*                MOVE AL-UABON   TO PRTRESTA
  9251*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9252*
  9253*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
  9254*            AND
  9255*        W-HOLD-ON
  9256*            AND
  9257*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9258*        MOVE ER-7243            TO EMI-ERROR
  9259*        MOVE -1                 TO PRTRESTL
  9260*        MOVE AL-UABON           TO PRTRESTA
  9261*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9262     .
  9263 0360-EXIT.
  9264      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 178
* EL689.cbl
  9266 0400-EL6311-INCOMING.
  9267
  9268     MOVE ZEROS                  TO PI-CURRENT-LINE
  9269                                    PI-TEMP-STOR-ITEMS
  9270                                    PI-TOTAL-LINES
  9271                                    PI-UPDATE-SW
  9272                                    PI-689-NUMBER-LABEL-LINES
  9273                                    PI-689-ERROR
  9274                                    PI-689-NUMBER-TEXT-RECORDS.
  9275     MOVE SPACES                 TO PI-689-PRINT-SW
  9276                                    PI-689-ALT-PRINTER-ID
  9277                                    PI-COMM-CONTROL
  9278                                    PI-689-FORM-NUMBER
  9279                                    PI-689-TEMP-STOR-ID
  9280                                    PI-689-LABEL-SOURCE
  9281                                    PI-689-USE-SCREEN-IND.
  9282
  9283     IF PI-CREATE-LABELS
  9284         MOVE  AL-UANON          TO ADDRLBLA
  9285         MOVE  +1                TO ADDRLBLL.
  9286
  9287     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9288                                    PI-689-LBL-OVERRIDE.
  9289
  9290     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  9291     MOVE '2'                    TO PI-ACTION.
  9292     MOVE -1                     TO MAINTL.
  9293
  9294     MOVE AL-UANON               TO PRTNOWA.
  9295     MOVE +1                     TO PRTNOWL.
  9296     MOVE 'N'                    TO PRTNOWI
  9297                                    PI-PRINT-NOW.
  9298
  9299     IF  PI-689-CARRIER NOT EQUAL LOW-VALUES
  9300         MOVE AL-UANON           TO CARRIERA
  9301         MOVE +1                 TO CARRIERL
  9302         MOVE PI-689-CARRIER     TO CARRIERI.
  9303
  9304     IF  PI-689-GROUPING NOT EQUAL LOW-VALUES
  9305         MOVE +6                 TO GROUPL
  9306         MOVE AL-UANON           TO GROUPA
  9307         MOVE PI-689-GROUPING    TO GROUPI.
  9308
  9309     IF  PI-689-STATE NOT EQUAL LOW-VALUES
  9310         MOVE +2                 TO STATEL
  9311         MOVE AL-UANON           TO STATEA
  9312         MOVE PI-689-STATE       TO STATEI.
  9313
  9314     IF  PI-689-ACCOUNT NOT EQUAL LOW-VALUES
  9315         MOVE +10                TO ACCTL
  9316         MOVE AL-UANON           TO ACCTA
  9317         MOVE PI-689-ACCOUNT     TO ACCTI.
  9318
  9319     IF  PI-689-CERT-PRIME NOT EQUAL LOW-VALUES
  9320         MOVE +10                TO CERTL
  9321         MOVE AL-UANON           TO CERTA
  9322         MOVE PI-689-CERT-PRIME  TO CERTI.
  9323
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 179
* EL689.cbl
  9324     IF  PI-689-CERT-SFX NOT EQUAL LOW-VALUES
  9325         MOVE +1                 TO SFXL
  9326         MOVE AL-UANON           TO SFXA
  9327         MOVE PI-689-CERT-SFX    TO SFXI.
  9328
  9329     IF  PI-689-ENTRY-BATCH NOT EQUAL LOW-VALUES
  9330         MOVE +6                 TO BENTRYL
  9331         MOVE AL-UANON           TO BENTRYA
  9332         MOVE PI-689-ENTRY-BATCH TO BENTRYI.
  9333
  9334     MOVE +4                     TO BCSEQL.
  9335     MOVE AL-UANON               TO BCSEQA.
  9336     MOVE PI-689-CHG-SEQ-NO      TO BCSEQI.
  9337
  9338     IF  PI-689-SEQ-NO NOT EQUAL ZEROS
  9339         MOVE +8                 TO SEQL
  9340         MOVE AL-UANON           TO SEQA
  9341         MOVE PI-689-SEQ-NO      TO SEQI.
  9342
  9343     IF  PI-689-EFF-DATE NOT EQUAL LOW-VALUES
  9344         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  9345         MOVE ' '                TO DC-OPTION-CODE
  9346         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9347         MOVE +8                 TO DATEL
  9348         MOVE DC-GREG-DATE-1-EDIT
  9349                                 TO DATEI
  9350         MOVE AL-UANON           TO DATEA.
  9351
  9352     MOVE -1                     TO MAINTL.
  9353     MOVE '4'                    TO DATASORI
  9354                                    PI-689-DATA-SOURCE.
  9355     MOVE +1                     TO DATASORL.
  9356     MOVE AL-UANON               TO DATASORA.
  9357
  9358     GO TO 8100-SEND-INITIAL-MAP.
  9359
  9360 0400-EXIT.
  9361      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 180
* EL689.cbl
  9363 0450-SPECIAL-INPUT-PROCESS.
  9364
  9365     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  9366             AND
  9367         PI-CARRIER GREATER THAN LOW-VALUES
  9368         MOVE '1'                TO DATASORI
  9369                                    PI-689-DATA-SOURCE
  9370         MOVE PI-CARRIER         TO CARRIERI
  9371         MOVE PI-GROUPING        TO GROUPI
  9372         MOVE PI-STATE           TO STATEI
  9373         MOVE PI-ACCOUNT         TO ACCTI
  9374         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  9375         MOVE ' '                TO DC-OPTION-CODE
  9376         PERFORM 9500-LINK-DATE-CONVERT
  9377             THRU 9500-EXIT
  9378         MOVE DC-GREG-DATE-1-EDIT
  9379                                 TO DATEI
  9380         MOVE 'N'                TO PRTNOWI
  9381                                    PI-PRINT-NOW
  9382         MOVE AL-UANON           TO ACCTA
  9383                                    CARRIERA
  9384                                    DATEA
  9385                                    DATASORA
  9386                                    GROUPA
  9387                                    STATEA
  9388                                    PRTNOWA
  9389         MOVE +1                 TO CARRIERL
  9390                                    DATASORL
  9391                                    PRTNOWL
  9392         MOVE -1                 TO MAINTL
  9393         MOVE +6                 TO GROUPL
  9394         MOVE +2                 TO STATEL
  9395         MOVE +8                 TO DATEL
  9396         MOVE +10                TO ACCTL
  9397     ELSE
  9398         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  9399                 AND
  9400             PI-CARRIER GREATER THAN LOW-VALUES
  9401             MOVE '3'            TO DATASORI
  9402                                    PI-689-DATA-SOURCE
  9403             MOVE PI-CR-CARRIER  TO CARRIERI
  9404             MOVE PI-CR-GROUPING TO GROUPI
  9405             MOVE PI-CR-ACCOUNT  TO ACCTI
  9406             MOVE PI-CR-FIN-RESP TO RPERSONI
  9407             MOVE PI-CR-TYPE     TO TYPEI
  9408             MOVE 'N'            TO PRTNOWI
  9409                                    PI-PRINT-NOW
  9410             MOVE AL-UANON       TO CARRIERA
  9411                                    GROUPA
  9412                                    ACCTA
  9413                                    DATASORA
  9414                                    RPERSONA
  9415                                    TYPEA
  9416                                    PRTNOWA
  9417             MOVE +1             TO CARRIERL
  9418                                    DATASORL
  9419                                    TYPEL
  9420                                    PRTNOWL
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 181
* EL689.cbl
  9421             MOVE -1             TO MAINTL
  9422             MOVE +6             TO GROUPL
  9423             MOVE +10            TO ACCTL
  9424                                    RPERSONL
  9425         ELSE
  9426             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  9427                     AND
  9428                 PI-CARRIER GREATER THAN LOW-VALUES
  9429                 MOVE '2'        TO DATASORI
  9430                                    PI-689-DATA-SOURCE
  9431                 MOVE PI-CARRIER TO CARRIERI
  9432                 MOVE PI-GROUPING
  9433                                 TO GROUPI
  9434                 MOVE PI-STATE   TO STATEI
  9435                 MOVE PI-ACCOUNT TO ACCTI
  9436                 MOVE PI-CERT-PRIME
  9437                                 TO CERTI
  9438                 MOVE PI-CERT-SFX
  9439                                 TO SFXI
  9440                 MOVE PI-CERT-EFF-DT
  9441                                 TO DC-BIN-DATE-1
  9442                 MOVE ' '        TO DC-OPTION-CODE
  9443                 PERFORM 9500-LINK-DATE-CONVERT
  9444                     THRU 9500-EXIT
  9445                 MOVE DC-GREG-DATE-1-EDIT
  9446                                 TO DATEI
  9447                 MOVE 'N'        TO PRTNOWI
  9448                                    PI-PRINT-NOW
  9449                 MOVE AL-UANON   TO CARRIERA
  9450                                    GROUPA
  9451                                    STATEA
  9452                                    ACCTA
  9453                                    CERTA
  9454                                    SFXA
  9455                                    DATEA
  9456                                    ADDRSA
  9457                                    DATASORA
  9458                                    PRTNOWA
  9459                 MOVE +1         TO CARRIERL
  9460                                    SFXL
  9461                                    DATASORL
  9462                                    ADDRSL
  9463                                    PRTNOWL
  9464                 MOVE -1         TO MAINTL
  9465                 MOVE +6         TO GROUPL
  9466                 MOVE +2         TO STATEL
  9467                 MOVE +8         TO DATEL
  9468                 MOVE +10        TO ACCTL
  9469                                    CERTL.
  9470
  9471     IF PI-CREATE-LABELS
  9472         MOVE  AL-UANON          TO ADDRLBLA
  9473         MOVE  +1                TO ADDRLBLL.
  9474
  9475     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9476                                    PI-689-LBL-OVERRIDE.
  9477
  9478     MOVE LOW-VALUES             TO PI-689-KEY-DATA-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 182
* EL689.cbl
  9479     GO TO 8100-SEND-INITIAL-MAP.
  9480
  9481 0450-EXIT.
  9482      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 183
* EL689.cbl
  9484 0600-BYPASS-SCREEN-CNTL.
  9485***************************************************************
  9486*     THIS ROUTINE WILL PROCESS A NEW LETTER REQUIREMENT      *
  9487*     WITH THE INFORMATION FOUND IN THE PI AREA WITHOUT       *
  9488*     PERFORMING ANY SCREEN IO.                               *
  9489***************************************************************
  9490
  9491
  9492* EXEC CICS HANDLE CONDITION
  9493*        PGMIDERR (9700-PGMID-ERROR)
  9494*        MAPFAIL  (0325-MAPFAIL)
  9495*        ERROR    (9800-ABEND)
  9496*    END-EXEC.
  9497*    MOVE '"$L?.                 ! % #00009372' TO DFHEIV0
  9498     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  9499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9500     MOVE X'2520233030303039333732' TO DFHEIV0(25:11)
  9501     CALL 'kxdfhei1' USING DFHEIV0
  9502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9503
  9504
  9505     MOVE LOW-VALUES             TO EL689AI.
  9506
  9507     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM
  9508
  9509     MOVE PI-689-FORM-NUMBER     TO FORMI.
  9510     MOVE +4                     TO FORML.
  9511
  9512     IF  PI-689-NUMBER-COPIES GREATER THAN ZERO
  9513         MOVE PI-689-NUMBER-COPIES
  9514                                 TO COPIESI
  9515         MOVE +1                 TO COPIESL.
  9516
  9517     MOVE PI-689-LABEL-SOURCE    TO ADDRSI.
  9518     MOVE +1                     TO ADDRSL.
  9519     MOVE PI-689-DATA-SOURCE     TO DATASORI.
  9520     MOVE +1                     TO DATASORL.
  9521
  9522*    IF  PI-689-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  9523*        MOVE PI-689-PRINT-RESTRICTION
  9524*                                TO PRTRESTI
  9525*        MOVE +1                 TO PRTRESTL.
  9526
  9527     MOVE SPACES                 TO PI-689-PRINT-SW
  9528                                    PI-689-LBL-OVERRIDE.
  9529     MOVE ZEROS                  TO PI-TOTAL-LINES
  9530                                    PI-CURRENT-LINE
  9531                                    PI-TEMP-STOR-ITEMS
  9532                                    PI-UPDATE-SW
  9533                                    PI-689-ERROR
  9534                                    PI-689-NUMBER-LABEL-LINES
  9535                                    PI-689-NUMBER-TEXT-RECORDS.
  9536
  9537     IF  PI-689-ALT-PRINTER-ID NOT EQUAL LOW-VALUES
  9538         MOVE +4                 TO PRINTERL
  9539         MOVE PI-689-ALT-PRINTER-ID
  9540                                 TO PRINTERI PI-ALT-DMD-PRT-ID.
  9541
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 184
* EL689.cbl
  9542     MOVE SPACES                 TO PI-689-ALT-PRINTER-ID.
  9543
  9544     IF  PI-689-SOURCE-VARIABLE
  9545         PERFORM 0700-GET-VARIABLE-LABEL THRU 0700-EXIT.
  9546
  9547     MOVE SPACES                 TO W-CNTL-KEY
  9548     MOVE LOW-VALUES             TO W-ACCT-KEY
  9549                                    W-CERT-KEY
  9550                                    W-CHEK-KEY
  9551                                    W-COMP-KEY
  9552                                    W-MAIL-KEY
  9553                                    W-PNDB-KEY
  9554                                    W-PNDB2-KEY
  9555                                    W-PYAJ-KEY.
  9556
  9557     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9558     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9559                                    W-CERT-COMPANY-CD
  9560                                    W-CHEK-COMPANY-CD
  9561                                    W-COMP-COMPANY-CD
  9562                                    W-MAIL-COMPANY-CD
  9563                                    W-PNDB-COMPANY-CD
  9564                                    W-PNDB2-COMPANY-CD
  9565                                    W-PYAJ-COMPANY-CD.
  9566
  9567     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
  9568         MOVE PI-689-CARRIER     TO W-ACCT-CARRIER
  9569                                    W-CERT-CARRIER
  9570                                    W-MAIL-CARRIER
  9571                                    W-CERT-CARRIER
  9572                                    W-COMP-CARRIER
  9573                                    W-CHEK-CARRIER
  9574                                    W-PNDB2-CARRIER
  9575                                    W-PYAJ-CARRIER.
  9576
  9577     IF  PI-689-GROUPING GREATER THAN LOW-VALUES
  9578         MOVE PI-689-GROUPING    TO W-ACCT-GROUPING
  9579                                    W-CERT-GROUPING
  9580                                    W-CHEK-GROUPING
  9581                                    W-COMP-GROUPING
  9582                                    W-MAIL-GROUPING
  9583                                    W-PNDB2-GROUPING
  9584                                    W-PYAJ-GROUPING.
  9585
  9586     IF  PI-689-STATE GREATER THAN LOW-VALUES
  9587         MOVE PI-689-STATE       TO W-ACCT-STATE
  9588                                    W-CERT-STATE
  9589                                    W-CHEK-STATE
  9590                                    W-MAIL-STATE
  9591                                    W-PNDB2-STATE.
  9592
  9593     IF  PI-689-ACCOUNT GREATER THAN LOW-VALUES
  9594         IF PI-689-DATA-SOURCE = '3' OR '6'
  9595             MOVE PI-689-ACCOUNT TO W-COMP-ACCOUNT
  9596                                    W-PYAJ-ACCOUNT
  9597         ELSE
  9598             MOVE PI-689-ACCOUNT TO W-ACCT-ACCOUNT
  9599                                    W-CERT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 185
* EL689.cbl
  9600                                    W-CHEK-ACCOUNT
  9601                                    W-MAIL-ACCOUNT
  9602                                    W-PNDB2-ACCOUNT.
  9603
  9604     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  9605         MOVE PI-689-EFF-DATE    TO W-CERT-EFF-DT
  9606                                    W-CHEK-EFF-DT
  9607                                    W-MAIL-EFF-DT
  9608                                    W-PNDB2-EFF-DT.
  9609
  9610     IF  PI-689-CERT-PRIME GREATER THAN LOW-VALUES
  9611         MOVE PI-689-CERT-PRIME  TO W-CERT-CERT-PRIME
  9612                                    W-CHEK-CERT-PRIME
  9613                                    W-MAIL-CERT-PRIME
  9614                                    W-PNDB2-CERT-PRIME
  9615
  9616         IF  PI-689-CERT-SFX GREATER THAN LOW-VALUES
  9617             MOVE PI-689-CERT-SFX
  9618                                 TO W-CERT-CERT-SFX
  9619                                    W-CHEK-CERT-SFX
  9620                                    W-MAIL-CERT-SFX
  9621                                    W-PNDB2-CERT-SFX
  9622         ELSE
  9623             MOVE SPACES         TO W-CERT-CERT-SFX
  9624                                    W-CHEK-CERT-SFX
  9625                                    W-MAIL-CERT-SFX
  9626                                    W-PNDB2-CERT-SFX.
  9627
  9628     IF  PI-689-RESP-PERSON GREATER THAN LOW-VALUES
  9629         IF PI-689-DATA-SOURCE = '3' OR '6'
  9630             MOVE PI-689-RESP-PERSON
  9631                                 TO W-COMP-RESP-PERSON
  9632                                    W-PYAJ-FIN-RESP.
  9633
  9634     IF  PI-689-TYPE GREATER THAN LOW-VALUES
  9635         IF PI-689-DATA-SOURCE = '3' OR '6'
  9636             MOVE PI-689-TYPE    TO W-COMP-TYPE
  9637                                    W-PYAJ-RECORD-TYPE
  9638         ELSE
  9639             MOVE PI-689-TYPE    TO W-PNDB2-TYPE.
  9640
  9641     IF  PI-689-SEQ-NO GREATER THAN ZEROS
  9642         MOVE PI-689-SEQ-NO      TO W-PNDB-SEQ-NO
  9643                                    W-PYAJ-FILE-SEQ-NO
  9644                                    W-CHEK-SEQ-NO.
  9645
  9646     IF  PI-689-CHG-SEQ-NO GREATER THAN ZEROS
  9647         MOVE PI-689-CHG-SEQ-NO  TO W-PNDB-CHG-SEQ-NO
  9648                                    W-PNDB2-ALT-CHG-SEQ-NO.
  9649
  9650     IF  PI-689-ENTRY-BATCH GREATER THAN LOW-VALUES
  9651         MOVE PI-689-ENTRY-BATCH TO W-PNDB-ENTRY.
  9652
  9653     IF  PI-689-NO-ERRORS-DETECTED
  9654         PERFORM 2000-CREATE THRU 2000-EXIT
  9655         IF  NOT PI-689-FATAL-ERROR
  9656                 AND
  9657             NOT PI-689-ERR-DETECTED-PREV
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 186
* EL689.cbl
  9658             IF  PI-689-PRINT-ONLY
  9659                 PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9660             ELSE
  9661                 IF  PI-689-PRINT-FIRST
  9662                     PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9663                     IF  NOT PI-689-FATAL-ERROR
  9664                         IF  PI-689-ARCHIVE-LETTER
  9665                             PERFORM 5400-LETTER-RELEASE
  9666                                 THRU 5400-EXIT
  9667                         ELSE
  9668                             MOVE ER-7390
  9669                                 TO PI-689-ERROR
  9670                     ELSE
  9671                         NEXT SENTENCE
  9672                 ELSE
  9673                     IF  NOT PI-689-ARCHIVE-LETTER
  9674                         MOVE ER-7390
  9675                                 TO PI-689-ERROR
  9676                     ELSE
  9677                         PERFORM 5400-LETTER-RELEASE
  9678                             THRU 5400-EXIT
  9679                         IF  NOT PI-689-FATAL-ERROR
  9680                             IF  PI-689-PRINT-SECOND
  9681                                 PERFORM 7900-PRINT-LETTER-NOW
  9682                                     THRU 7900-EXIT.
  9683
  9684 0600-EXIT.
  9685     EXIT.
  9686
  9687 0620-RETURN-TO-CALLER.
  9688
  9689     MOVE PROGRAM-INTERFACE-BLOCK
  9690                                 TO DFHCOMMAREA.
  9691
  9692* EXEC CICS RETURN
  9693*    END-EXEC.
  9694*    MOVE '.(                    ''   #00009564' TO DFHEIV0
  9695     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9696     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9697     MOVE X'2020233030303039353634' TO DFHEIV0(25:11)
  9698     CALL 'kxdfhei1' USING DFHEIV0,
  9699           DFHEIV99,
  9700           DFHEIV99,
  9701           DFHEIV99,
  9702           DFHEIV99,
  9703           DFHEIV99,
  9704           DFHEIV99
  9705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9706
  9707
  9708 0700-GET-VARIABLE-LABEL.
  9709
  9710     IF  PI-689-VARIABLE-DATA-1 NOT GREATER THAN SPACES
  9711         MOVE '(VARIABLE NOT PROVIDED)'
  9712                                 TO W-RC-TEXT (1)
  9713                                    W-VG-TEXT (48)
  9714         GO TO 0700-EXIT.
  9715
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 187
* EL689.cbl
  9716     MOVE PI-689-VARIABLE-DATA-1 TO W-RC-TEXT (1)
  9717                                    W-VG-TEXT (48).
  9718     MOVE PI-689-VARIABLE-DATA-2 TO W-RC-TEXT (2)
  9719                                    W-VG-TEXT (49).
  9720     MOVE PI-689-VARIABLE-DATA-3 TO W-RC-TEXT (3)
  9721                                    W-VG-TEXT (50).
  9722     MOVE PI-689-VARIABLE-DATA-4 TO W-RC-TEXT (4)
  9723                                    W-VG-TEXT (51).
  9724     SET W-RG-NDX                TO +5.
  9725
  9726 0700-EXIT.
  9727     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 188
* EL689.cbl
  9729 0800-EDIT-KEY-FIELDS.
  9730***************************************************************
  9731*     THIS ROUTINE WILL DECIDE WHAT FIELDS ARE NECESSARY      *
  9732*     FROM THE DATA SOURCE FIELD.  IF A NECESSARY FIELD       *
  9733*     IS NOT PROVIDED AN ERROR WILL PREVENT FURTHER           *
  9734*     PROCESSING.                                             *
  9735***************************************************************
  9736     MOVE SPACES                 TO W-CNTL-KEY
  9737     MOVE LOW-VALUES             TO W-ACCT-KEY
  9738                                    W-CERT-KEY
  9739                                    W-CHEK-KEY
  9740                                    W-COMP-KEY
  9741                                    W-MAIL-KEY
  9742                                    W-PNDB-KEY
  9743                                    W-PNDB2-KEY
  9744                                    W-PYAJ-KEY.
  9745
  9746     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9747     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9748                                    W-CERT-COMPANY-CD
  9749                                    W-CHEK-COMPANY-CD
  9750                                    W-COMP-COMPANY-CD
  9751                                    W-MAIL-COMPANY-CD
  9752                                    W-PNDB-COMPANY-CD
  9753                                    W-PNDB2-COMPANY-CD
  9754                                    W-PYAJ-COMPANY-CD.
  9755
  9756     PERFORM 0900-EDIT-CARRIER THRU 0900-EXIT.
  9757     PERFORM 0905-EDIT-GROUPING THRU 0905-EXIT.
  9758     PERFORM 0910-EDIT-STATE THRU 0910-EXIT.
  9759     PERFORM 0915-EDIT-ACCOUNT THRU 0915-EXIT.
  9760     PERFORM 0920-EDIT-EXP-DATE THRU 0920-EXIT.
  9761     PERFORM 0925-EDIT-EFF-DATE THRU 0925-EXIT.
  9762     PERFORM 0930-EDIT-CERTIFICATE THRU 0930-EXIT.
  9763     PERFORM 0935-EDIT-RESP-PERSON THRU 0935-EXIT.
  9764     PERFORM 0940-EDIT-ACCOUNT THRU 0940-EXIT.
  9765     PERFORM 0945-EDIT-TYPE THRU 0945-EXIT.
  9766     PERFORM 0950-EDIT-ENTRY THRU 0950-EXIT.
  9767     PERFORM 0955-EDIT-SEQUENCE THRU 0955-EXIT.
  9768     PERFORM 0960-EDIT-BATCH-SEQ THRU 0960-EXIT.
  9769     PERFORM 0965-EDIT-TYPE THRU 0965-EXIT.
  9770     PERFORM 0970-EDIT-CSO THRU 0970-EXIT.
  9771
  9772     IF  DATASORI NUMERIC
  9773         MOVE DATASORI           TO W-DATA-SOURCE
  9774                                    PI-689-DATA-SOURCE
  9775         GO TO 0800-SOURCE-ACCOUNT
  9776               0800-SOURCE-CERTIFICATE
  9777               0800-SOURCE-COMPENSATION
  9778               0800-SOURCE-PENDING
  9779               0800-SOURCE-CHEK
  9780               0800-SOURCE-PAYMENTS-ADJS
  9781                                 DEPENDING ON W-DATA-SOURCE.
  9782
  9783     IF  FORMI NOT EQUAL '9999'
  9784         MOVE ER-7365            TO EMI-ERROR
  9785         MOVE -1                 TO MAINTL
  9786         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 189
* EL689.cbl
  9787         GO TO 8200-SEND-DATAONLY
  9788
  9789     ELSE
  9790         GO TO 0800-EXIT.
  9791
  9792 0800-SOURCE-ACCOUNT.
  9793
  9794     IF  W-ACCT-COMPANY-CD EQUAL LOW-VALUES
  9795             OR
  9796         W-ACCT-CARRIER EQUAL LOW-VALUES
  9797             OR
  9798         W-ACCT-GROUPING EQUAL LOW-VALUES
  9799             OR
  9800         W-ACCT-STATE EQUAL LOW-VALUES
  9801             OR
  9802         W-ACCT-ACCOUNT EQUAL LOW-VALUES
  9803             OR
  9804         W-ACCT-EXP-DT EQUAL LOW-VALUES
  9805         MOVE ER-7376            TO EMI-ERROR
  9806         MOVE -1                 TO MAINTL
  9807         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9808
  9809     GO TO 0800-ERROR-TEST.
  9810
  9811 0800-SOURCE-CERTIFICATE.
  9812
  9813     IF  W-CERT-COMPANY-CD EQUAL LOW-VALUES
  9814             OR
  9815         W-CERT-CARRIER EQUAL LOW-VALUES
  9816             OR
  9817         W-CERT-GROUPING EQUAL LOW-VALUES
  9818             OR
  9819         W-CERT-STATE EQUAL LOW-VALUES
  9820             OR
  9821         W-CERT-ACCOUNT EQUAL LOW-VALUES
  9822             OR
  9823         W-CERT-EFF-DT EQUAL LOW-VALUES
  9824             OR
  9825         W-CERT-CERT-NO EQUAL LOW-VALUES
  9826         MOVE ER-7377            TO EMI-ERROR
  9827         MOVE -1                 TO MAINTL
  9828         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9829
  9830     GO TO 0800-ERROR-TEST.
  9831
  9832 0800-SOURCE-COMPENSATION.
  9833
  9834     IF  W-COMP-COMPANY-CD EQUAL LOW-VALUES
  9835             OR
  9836         W-COMP-CARRIER EQUAL LOW-VALUES
  9837             OR
  9838         W-COMP-GROUPING EQUAL LOW-VALUES
  9839             OR
  9840         W-COMP-RESP-PERSON EQUAL LOW-VALUES
  9841             OR
  9842         W-COMP-TYPE EQUAL LOW-VALUES
  9843             OR
  9844         (W-COMP-TYPE EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 190
* EL689.cbl
  9845                 AND
  9846             W-COMP-ACCOUNT EQUAL LOW-VALUES)
  9847         MOVE ER-7378            TO EMI-ERROR
  9848         MOVE -1                 TO MAINTL
  9849         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9850
  9851     GO TO 0800-ERROR-TEST.
  9852
  9853 0800-SOURCE-PENDING.
  9854
  9855     IF  BENTRYL EQUAL ZEROS
  9856         IF  W-PNDB2-COMPANY-CD EQUAL LOW-VALUES
  9857                 OR
  9858             W-PNDB2-CARRIER EQUAL LOW-VALUES
  9859                 OR
  9860             W-PNDB2-GROUPING EQUAL LOW-VALUES
  9861                 OR
  9862             W-PNDB2-STATE EQUAL LOW-VALUES
  9863                 OR
  9864             W-PNDB2-ACCOUNT EQUAL LOW-VALUES
  9865                 OR
  9866             W-PNDB2-EFF-DT EQUAL LOW-VALUES
  9867                 OR
  9868             W-PNDB2-CERT-NO EQUAL LOW-VALUES
  9869                 OR
  9870             W-PNDB2-TYPE EQUAL LOW-VALUES
  9871                 OR
  9872             W-PNDB2-ALT-CHG-SEQ-NO NOT = ZEROS
  9873             MOVE ER-7379        TO EMI-ERROR
  9874             MOVE -1             TO MAINTL
  9875             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9876         ELSE
  9877             NEXT SENTENCE
  9878     ELSE
  9879         IF  W-PNDB-COMPANY-CD EQUAL LOW-VALUES
  9880                 OR
  9881             W-PNDB-ENTRY EQUAL LOW-VALUES
  9882                 OR
  9883             W-PNDB-SEQ-NO EQUAL ZEROS
  9884             MOVE ER-7379        TO EMI-ERROR
  9885             MOVE -1             TO MAINTL
  9886             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9887
  9888     GO TO 0800-ERROR-TEST.
  9889
  9890 0800-SOURCE-CHEK.
  9891
  9892     IF  W-CHEK-COMPANY-CD EQUAL LOW-VALUES
  9893             OR
  9894         W-CHEK-CARRIER EQUAL LOW-VALUES
  9895             OR
  9896         W-CHEK-GROUPING EQUAL LOW-VALUES
  9897             OR
  9898         W-CHEK-STATE EQUAL LOW-VALUES
  9899             OR
  9900         W-CHEK-ACCOUNT EQUAL LOW-VALUES
  9901             OR
  9902         W-CHEK-EFF-DT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 191
* EL689.cbl
  9903             OR
  9904         W-CHEK-CERT-NO EQUAL LOW-VALUES
  9905         MOVE ER-7381            TO EMI-ERROR
  9906         MOVE -1                 TO MAINTL
  9907         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9908
  9909     GO TO 0800-ERROR-TEST.
  9910
  9911 0800-SOURCE-PAYMENTS-ADJS.
  9912
  9913     IF  W-PYAJ-COMPANY-CD EQUAL LOW-VALUES
  9914             OR
  9915         W-PYAJ-CARRIER EQUAL LOW-VALUES
  9916             OR
  9917         W-PYAJ-GROUPING EQUAL LOW-VALUES
  9918             OR
  9919         W-PYAJ-FIN-RESP EQUAL LOW-VALUES
  9920             OR
  9921         W-PYAJ-ACCOUNT EQUAL LOW-VALUES
  9922             OR
  9923         W-PYAJ-RECORD-TYPE EQUAL LOW-VALUES
  9924         MOVE ER-7396            TO EMI-ERROR
  9925         MOVE -1                 TO MAINTL
  9926         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9927
  9928     GO TO 0800-ERROR-TEST.
  9929
  9930 0800-ERROR-TEST.
  9931
  9932     IF  NOT EMI-NO-ERRORS
  9933         IF  EMI-ERROR EQUAL ER-7250
  9934             GO TO 0800-EXIT
  9935         ELSE
  9936             GO TO 8200-SEND-DATAONLY.
  9937
  9938 0800-EXIT.
  9939     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 192
* EL689.cbl
  9941 0900-EDIT-CARRIER.
  9942
  9943     IF  CARRIERL EQUAL ZEROES
  9944         MOVE LOW-VALUES         TO PI-689-CARRIER
  9945                                    W-ACCT-CARRIER
  9946                                    W-CERT-CARRIER
  9947                                    W-COMP-CARRIER
  9948                                    W-CHEK-CARRIER
  9949                                    W-MAIL-CARRIER
  9950                                    W-PNDB2-CARRIER
  9951                                    W-PYAJ-CARRIER
  9952     ELSE
  9953         PERFORM 0990-CARRIER-VALIDITY-CHECK THRU 0990-EXIT.
  9954
  9955 0900-EXIT.
  9956     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 193
* EL689.cbl
  9958 0905-EDIT-GROUPING.
  9959
  9960     IF  GROUPL EQUAL ZEROES
  9961         MOVE LOW-VALUES         TO PI-689-GROUPING
  9962                                    W-ACCT-GROUPING
  9963                                    W-CERT-GROUPING
  9964                                    W-CHEK-GROUPING
  9965                                    W-COMP-GROUPING
  9966                                    W-MAIL-GROUPING
  9967                                    W-PNDB2-GROUPING
  9968                                    W-PYAJ-GROUPING
  9969     ELSE
  9970         MOVE AL-UANON           TO GROUPA
  9971         MOVE GROUPI             TO PI-689-GROUPING
  9972                                    W-ACCT-GROUPING
  9973                                    W-CERT-GROUPING
  9974                                    W-CHEK-GROUPING
  9975                                    W-COMP-GROUPING
  9976                                    W-MAIL-GROUPING
  9977                                    W-PNDB2-GROUPING
  9978                                    W-PYAJ-GROUPING.
  9979
  9980 0905-EXIT.
  9981     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 194
* EL689.cbl
  9983 0910-EDIT-STATE.
  9984
  9985     IF  STATEL EQUAL ZEROES
  9986         MOVE LOW-VALUES         TO PI-689-STATE
  9987                                    W-ACCT-STATE
  9988                                    W-CERT-STATE
  9989                                    W-CHEK-STATE
  9990                                    W-MAIL-STATE
  9991                                    W-PNDB2-STATE
  9992     ELSE
  9993         PERFORM 0994-STATE-VALIDITY-CHECK THRU 0994-EXIT.
  9994
  9995 0910-EXIT.
  9996     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 195
* EL689.cbl
  9998 0915-EDIT-ACCOUNT.
  9999
 10000     IF  ACCTL EQUAL ZEROES
 10001         MOVE LOW-VALUES         TO PI-689-ACCOUNT
 10002                                    W-ACCT-ACCOUNT
 10003                                    W-CERT-ACCOUNT
 10004                                    W-CHEK-ACCOUNT
 10005                                    W-COMP-ACCOUNT
 10006                                    W-MAIL-ACCOUNT
 10007                                    W-PNDB2-ACCOUNT
 10008                                    W-PYAJ-ACCOUNT
 10009     ELSE
 10010         MOVE AL-UANON           TO ACCTA
 10011         MOVE ACCTI              TO PI-689-ACCOUNT
 10012                                    W-ACCT-ACCOUNT
 10013                                    W-CERT-ACCOUNT
 10014                                    W-CHEK-ACCOUNT
 10015                                    W-COMP-ACCOUNT
 10016                                    W-MAIL-ACCOUNT
 10017                                    W-PYAJ-ACCOUNT
 10018                                    W-PNDB2-ACCOUNT.
 10019
 10020 0915-EXIT.
 10021     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 196
* EL689.cbl
 10023 0920-EDIT-EXP-DATE.
 10024
 10025     IF  DATEL NOT EQUAL ZEROS
 10026         IF  DATEI EQUAL '99/99/99' OR '999999'
 10027             MOVE '99/99/99'     TO DATEO
 10028                                    PI-689-DATE-EDIT
 10029             MOVE AL-UANON       TO DATEA
 10030             MOVE HIGH-VALUES    TO PI-689-EXP-DATE
 10031                                    W-ACCT-EXP-DT
 10032         ELSE
 10033             MOVE DATEI          TO W-DEEDIT-FIELD
 10034             PERFORM 8600-DEEDIT
 10035             MOVE W-DEEDIT-FIELD-V0
 10036                                 TO DC-GREG-DATE-1-MDY
 10037             MOVE '4'            TO DC-OPTION-CODE
 10038             PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10039             IF  DATE-CONVERSION-ERROR
 10040                 MOVE ER-0454    TO EMI-ERROR
 10041                 MOVE -1         TO DATEL
 10042                 MOVE AL-UABON   TO DATEA
 10043                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10044             ELSE
 10045                 MOVE DC-GREG-DATE-1-EDIT
 10046                                 TO DATEO
 10047                                    PI-689-DATE-EDIT
 10048                 MOVE AL-UANON   TO DATEA
 10049                 MOVE DC-BIN-DATE-1
 10050                                 TO PI-689-EXP-DATE
 10051                                    W-ACCT-EXP-DT
 10052     ELSE
 10053         MOVE LOW-VALUES         TO PI-689-EXP-DATE
 10054                                    W-ACCT-EXP-DT
 10055                                    PI-689-DATE-EDIT.
 10056
 10057 0920-EXIT.
 10058     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 197
* EL689.cbl
 10060 0925-EDIT-EFF-DATE.
 10061
 10062     IF  CERTL EQUAL ZERO
 10063             AND
 10064         DATASORI NOT EQUAL '2'
 10065         GO TO 0925-EXIT.
 10066
 10067     IF  DATEL NOT EQUAL ZEROS
 10068         MOVE DATEI              TO W-DEEDIT-FIELD
 10069         PERFORM 8600-DEEDIT
 10070         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 10071         MOVE '4'                TO DC-OPTION-CODE
 10072         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10073
 10074         IF  DATE-CONVERSION-ERROR
 10075             MOVE ER-0215        TO EMI-ERROR
 10076             MOVE -1             TO DATEL
 10077             MOVE AL-UABON       TO DATEA
 10078             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10079         ELSE
 10080             MOVE DC-GREG-DATE-1-EDIT
 10081                                 TO DATEO
 10082                                    PI-689-DATE-EDIT
 10083             MOVE AL-UANON       TO DATEA
 10084             MOVE DC-BIN-DATE-1  TO PI-689-EFF-DATE
 10085                                    W-CERT-EFF-DT
 10086                                    W-CHEK-EFF-DT
 10087                                    W-MAIL-EFF-DT
 10088                                    W-PNDB2-EFF-DT
 10089     ELSE
 10090         MOVE LOW-VALUES         TO PI-689-EFF-DATE
 10091                                    W-PNDB2-EFF-DT
 10092                                    W-CHEK-EFF-DT
 10093                                    W-MAIL-EFF-DT
 10094                                    W-CERT-EFF-DT
 10095                                    PI-689-DATE-EDIT.
 10096
 10097 0925-EXIT.
 10098     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 198
* EL689.cbl
 10100 0930-EDIT-CERTIFICATE.
 10101
 10102     IF  CERTL EQUAL ZEROES
 10103         MOVE LOW-VALUES         TO PI-689-CERT-PRIME
 10104                                    W-CERT-CERT-PRIME
 10105                                    W-CHEK-CERT-PRIME
 10106                                    W-MAIL-CERT-PRIME
 10107                                    W-PNDB2-CERT-PRIME
 10108                                    PI-689-CERT-SFX
 10109                                    W-CERT-CERT-SFX
 10110                                    W-CHEK-CERT-SFX
 10111                                    W-MAIL-CERT-SFX
 10112                                    W-PNDB2-CERT-SFX
 10113     ELSE
 10114         MOVE AL-UANON           TO CERTA
 10115         MOVE CERTI              TO PI-689-CERT-PRIME
 10116                                    W-CERT-CERT-PRIME
 10117                                    W-CHEK-CERT-PRIME
 10118                                    W-MAIL-CERT-PRIME
 10119                                    W-PNDB2-CERT-PRIME
 10120         IF  SFXL EQUAL ZEROES
 10121                 OR
 10122             SFXI EQUAL LOW-VALUES
 10123             MOVE SPACES         TO PI-689-CERT-SFX
 10124                                    W-CERT-CERT-SFX
 10125                                    W-CHEK-CERT-SFX
 10126                                    W-MAIL-CERT-SFX
 10127                                    W-PNDB2-CERT-SFX
 10128         ELSE
 10129             MOVE AL-UANON       TO SFXA
 10130             MOVE SFXI           TO PI-689-CERT-SFX
 10131                                    W-CERT-CERT-SFX
 10132                                    W-CHEK-CERT-SFX
 10133                                    W-MAIL-CERT-SFX
 10134                                    W-PNDB2-CERT-SFX.
 10135
 10136 0930-EXIT.
 10137     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 199
* EL689.cbl
 10139 0935-EDIT-RESP-PERSON.
 10140
 10141     IF  RPERSONL EQUAL ZEROES
 10142         MOVE LOW-VALUES         TO PI-689-RESP-PERSON
 10143                                    W-COMP-RESP-PERSON
 10144                                    W-PYAJ-FIN-RESP
 10145     ELSE
 10146         MOVE AL-UANON           TO RPERSONA
 10147         MOVE RPERSONI           TO PI-689-RESP-PERSON
 10148                                    W-PYAJ-FIN-RESP
 10149                                    W-COMP-RESP-PERSON.
 10150
 10151 0935-EXIT.
 10152     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 200
* EL689.cbl
 10154 0940-EDIT-ACCOUNT.
 10155
 10156     IF  ACCTL EQUAL ZEROES
 10157         MOVE LOW-VALUES         TO PI-689-ACCOUNT
 10158                                    W-COMP-ACCOUNT
 10159                                    W-PYAJ-ACCOUNT
 10160     ELSE
 10161         MOVE AL-UANON           TO ACCTA
 10162         MOVE ACCTI              TO PI-689-ACCOUNT
 10163                                    W-PYAJ-ACCOUNT
 10164                                    W-COMP-ACCOUNT.
 10165
 10166 0940-EXIT.
 10167     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 201
* EL689.cbl
 10169 0945-EDIT-TYPE.
 10170
 10171     IF  TYPEL EQUAL ZEROES
 10172         MOVE LOW-VALUES         TO PI-689-TYPE
 10173                                    W-COMP-TYPE
 10174                                    W-PYAJ-RECORD-TYPE
 10175     ELSE
 10176         INSPECT TYPEI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
 10177         IF TYPEI = 'C' OR 'G' OR 'A'
 10178             MOVE AL-UANON       TO TYPEA
 10179             MOVE TYPEI          TO PI-689-TYPE
 10180                                    W-COMP-TYPE
 10181                                    W-PYAJ-RECORD-TYPE
 10182         ELSE
 10183             MOVE ER-7368        TO EMI-ERROR
 10184             MOVE -1             TO TYPEL
 10185             MOVE AL-UABON       TO TYPEA
 10186             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10187
 10188 0945-EXIT.
 10189     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 202
* EL689.cbl
 10191 0950-EDIT-ENTRY.
 10192
 10193     IF  BENTRYL EQUAL ZEROES
 10194         MOVE LOW-VALUES         TO PI-689-ENTRY-BATCH
 10195                                    W-PNDB-ENTRY
 10196     ELSE
 10197         MOVE AL-UANON           TO BENTRYA
 10198         MOVE BENTRYI            TO PI-689-ENTRY-BATCH
 10199                                    W-PNDB-ENTRY.
 10200
 10201 0950-EXIT.
 10202     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 203
* EL689.cbl
 10204 0955-EDIT-SEQUENCE.
 10205
 10206     IF  SEQL NOT EQUAL ZEROS
 10207         IF  SEQI NOT NUMERIC
 10208                 OR
 10209             SEQI EQUAL '0'
 10210             MOVE ER-7367        TO EMI-ERROR
 10211             MOVE -1             TO SEQL
 10212             MOVE AL-UABON       TO SEQA
 10213             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10214         ELSE
 10215             MOVE AL-UANON       TO SEQA
 10216             MOVE SEQI           TO PI-689-SEQ-NO
 10217                                    W-CHEK-SEQ-NO
 10218                                    W-PYAJ-FILE-SEQ-NO
 10219                                    W-PNDB-SEQ-NO
 10220                                    PI-689-SEQ-EDIT
 10221     ELSE
 10222         MOVE LOW-VALUES         TO PI-689-SEQ-EDIT.
 10223
 10224 0955-EXIT.
 10225     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 204
* EL689.cbl
 10227 0960-EDIT-BATCH-SEQ.
 10228
 10229     IF  BCSEQL NOT EQUAL ZEROS
 10230         IF  BCSEQI NOT NUMERIC
 10231             MOVE ER-7368        TO EMI-ERROR
 10232             MOVE -1             TO BCSEQL
 10233             MOVE AL-UABON       TO BCSEQA
 10234             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10235         ELSE
 10236             MOVE AL-UANON       TO BCSEQA
 10237             MOVE BCSEQI         TO PI-689-CHG-SEQ-NO
 10238                                    W-PNDB-CHG-SEQ-NO
 10239                                    W-PNDB2-ALT-CHG-SEQ-NO
 10240                                    PI-689-BCSEQ-EDIT
 10241     ELSE
 10242         MOVE LOW-VALUES         TO PI-689-BCSEQ-EDIT.
 10243
 10244 0960-EXIT.
 10245     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 205
* EL689.cbl
 10247 0965-EDIT-TYPE.
 10248
 10249     IF  TYPEL EQUAL ZEROES
 10250         MOVE LOW-VALUES         TO PI-689-TYPE
 10251                                    W-PNDB2-TYPE
 10252     ELSE
 10253         IF  DATASORI NOT EQUAL '4'
 10254             GO TO 0965-EXIT
 10255         ELSE
 10256             IF TYPEI = '0' OR '1' OR '2' OR '3'
 10257                 MOVE AL-UANON   TO TYPEA
 10258                 MOVE TYPEI      TO PI-689-TYPE
 10259                                    W-PNDB2-TYPE
 10260             ELSE
 10261                 MOVE ER-7370    TO EMI-ERROR
 10262                 MOVE -1         TO TYPEL
 10263                 MOVE AL-UABON   TO TYPEA
 10264                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10265
 10266 0965-EXIT.
 10267     EXIT.
 10268
 10269 0970-EDIT-CSO.
 10270
 10271     IF ENDARCHL > ZEROS
 10272        IF ENDARCHI NUMERIC
 10273            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
 10274            MOVE AL-UNNON       TO ENDARCHA
 10275            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
 10276            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
 10277            MOVE 'N'            TO W-VALID-ENDT-SW
 10278            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
 10279            IF NOT W-VALID-ENDT
 10280                MOVE -1         TO ENDARCHL
 10281                MOVE ER-1565    TO EMI-ERROR
 10282                MOVE AL-UNBON   TO ENDARCHA
 10283                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10284            END-IF
 10285        END-IF
 10286     ELSE
 10287        MOVE ZEROS              TO PI-ENDT-ARCH-NO
 10288     END-IF
 10289
 10290     IF PI-CERT-REQ-IND = 'Y'
 10291       IF  CERTIDL NOT EQUAL ZEROS
 10292         IF CERTIDI NUMERIC
 10293             MOVE AL-UANON      TO CERTIDA
 10294             MOVE CERTIDI       TO PI-CERT-FORM-ID
 10295         ELSE
 10296             MOVE ER-1778       TO EMI-ERROR
 10297             MOVE -1            TO CERTIDL
 10298             MOVE AL-UABON      TO CERTIDA
 10299             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10300         END-IF
 10301       ELSE
 10302          MOVE ER-0715       TO EMI-ERROR
 10303          MOVE -1            TO CERTIDL
 10304          MOVE AL-UABON      TO CERTIDA
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 206
* EL689.cbl
 10305          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10306       END-IF
 10307     END-IF.
 10308
 10309 0970-EXIT.
 10310      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 207
* EL689.cbl
 10312 0990-CARRIER-VALIDITY-CHECK.
 10313
 10314     IF  CARRIERI EQUAL SPACES
 10315         GO TO 0990-EXIT.
 10316
 10317     MOVE SPACES                 TO W-CNTL-KEY.
 10318     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10319     MOVE '6'                    TO W-CNTL-RECORD-TYPE.
 10320     MOVE CARRIERI               TO W-CNTL-GEN4.
 10321     MOVE +0                     TO W-CNTL-SEQ-NO.
 10322
 10323
 10324* EXEC CICS HANDLE CONDITION
 10325*        NOTFND  (0990-CARRIER-NOT-FOUND)
 10326*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10327*    END-EXEC.
 10328*    MOVE '"$IJ                  ! & #00010182' TO DFHEIV0
 10329     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10330     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10331     MOVE X'2620233030303130313832' TO DFHEIV0(25:11)
 10332     CALL 'kxdfhei1' USING DFHEIV0
 10333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10334
 10335
 10336
 10337* EXEC CICS READ
 10338*        DATASET (W-CNTL-FILE-ID)
 10339*        SET     (ADDRESS OF CONTROL-FILE)
 10340*        RIDFLD  (W-CNTL-KEY)
 10341*    END-EXEC.
 10342*    MOVE '&"S        E          (   #00010187' TO DFHEIV0
 10343     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10344     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10345     MOVE X'2020233030303130313837' TO DFHEIV0(25:11)
 10346     CALL 'kxdfhei1' USING DFHEIV0,
 10347           W-CNTL-FILE-ID,
 10348           DFHEIV20,
 10349           DFHEIV99,
 10350           W-CNTL-KEY,
 10351           DFHEIV99,
 10352           DFHEIV99,
 10353           DFHEIV99
 10354     SET ADDRESS OF CONTROL-FILE TO
 10355         DFHEIV20
 10356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10357
 10358
 10359     IF  PI-NO-CARRIER-SECURITY
 10360             OR
 10361         PI-CARRIER-SECURITY EQUAL CARRIERI
 10362         MOVE AL-UANON           TO CARRIERA
 10363         MOVE CARRIERI           TO PI-689-CARRIER
 10364                                    W-ACCT-CARRIER
 10365                                    W-CERT-CARRIER
 10366                                    W-CHEK-CARRIER
 10367                                    W-COMP-CARRIER
 10368                                    W-MAIL-CARRIER
 10369                                    W-PNDB2-CARRIER
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 208
* EL689.cbl
 10370                                    W-PYAJ-CARRIER
 10371     ELSE
 10372         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
 10373         MOVE ER-9095            TO EMI-ERROR
 10374         MOVE -1                 TO MAINTL
 10375         MOVE AL-UANON           TO MAINTA
 10376         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10377
 10378     GO TO 0990-EXIT.
 10379
 10380 0990-CARRIER-NOT-FOUND.
 10381
 10382     MOVE -1                     TO CARRIERL.
 10383     MOVE AL-UABON               TO CARRIERA.
 10384     MOVE ER-2208                TO EMI-ERROR.
 10385     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10386
 10387 0990-EXIT.
 10388     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 209
* EL689.cbl
 10390 0994-STATE-VALIDITY-CHECK.
 10391
 10392     IF  STATEI EQUAL SPACES
 10393         GO TO 0994-EXIT.
 10394
 10395     MOVE SPACES                 TO W-CNTL-KEY.
 10396     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10397     MOVE '3'                    TO W-CNTL-RECORD-TYPE.
 10398     MOVE STATEI                 TO W-CNTL-GEN1.
 10399     MOVE +0                     TO W-CNTL-SEQ-NO.
 10400
 10401
 10402* EXEC CICS HANDLE CONDITION
 10403*        NOTFND  (0994-STATE-NOT-FOUND)
 10404*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10405*    END-EXEC.
 10406*    MOVE '"$IJ                  ! '' #00010235' TO DFHEIV0
 10407     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10408     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10409     MOVE X'2720233030303130323335' TO DFHEIV0(25:11)
 10410     CALL 'kxdfhei1' USING DFHEIV0
 10411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10412
 10413
 10414
 10415* EXEC CICS READ
 10416*        DATASET (W-CNTL-FILE-ID)
 10417*        SET     (ADDRESS OF CONTROL-FILE)
 10418*        RIDFLD  (W-CNTL-KEY)
 10419*    END-EXEC.
 10420*    MOVE '&"S        E          (   #00010240' TO DFHEIV0
 10421     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10422     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10423     MOVE X'2020233030303130323430' TO DFHEIV0(25:11)
 10424     CALL 'kxdfhei1' USING DFHEIV0,
 10425           W-CNTL-FILE-ID,
 10426           DFHEIV20,
 10427           DFHEIV99,
 10428           W-CNTL-KEY,
 10429           DFHEIV99,
 10430           DFHEIV99,
 10431           DFHEIV99
 10432     SET ADDRESS OF CONTROL-FILE TO
 10433         DFHEIV20
 10434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10435
 10436
 10437     MOVE AL-UANON               TO STATEA.
 10438     MOVE STATEI                 TO PI-689-STATE
 10439                                    W-ACCT-STATE
 10440                                    W-CERT-STATE
 10441                                    W-CHEK-STATE
 10442                                    W-MAIL-STATE
 10443                                    W-PNDB2-STATE.
 10444
 10445     GO TO 0994-EXIT.
 10446
 10447 0994-STATE-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 210
* EL689.cbl
 10448
 10449     MOVE -1                     TO STATEL.
 10450     MOVE AL-UABON               TO STATEA.
 10451     MOVE ER-2209                TO EMI-ERROR.
 10452     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10453
 10454 0994-EXIT.
 10455     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 211
* EL689.cbl
 10457 1000-SHOW.
 10458***************************************************************
 10459*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
 10460*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN.  IF THE       *
 10461*     HEADER RECORD IS FOUND THE TEXT IS THEN READ AND        *
 10462*     WILL BE INSERTED INTO THE W-TS-TABLE AND DISPLAYED.     *
 10463***************************************************************
 10464
 10465     MOVE SPACES                 TO W-RECORD-TABLE.
 10466
 10467     IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 10468          MOVE PI-689-LBL-OVERRIDE
 10469                                 TO ADDRLBLI
 10470          MOVE +1                TO ADDRLBLL
 10471          MOVE AL-UANON          TO ADDRLBLA
 10472     ELSE
 10473          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 10474          MOVE +1                TO ADDRLBLL
 10475          MOVE AL-UANON          TO ADDRLBLA.
 10476
 10477     IF  ARCHNUML EQUAL ZEROS
 10478         MOVE -1                 TO ARCHNUML
 10479         MOVE AL-UNBON           TO ARCHNUMA
 10480         MOVE ER-0174            TO EMI-ERROR
 10481         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10482         GO TO 8200-SEND-DATAONLY.
 10483
 10484     IF  ARCHNUMI NOT NUMERIC
 10485         MOVE -1                 TO ARCHNUML
 10486         MOVE AL-UNBON           TO ARCHNUMA
 10487         MOVE ER-0175            TO EMI-ERROR
 10488         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10489         GO TO 8200-SEND-DATAONLY.
 10490
 10491     IF  PI-SHOW-MODE
 10492
 10493         IF  PI-689-ARCHIVE-NUMBER EQUAL ARCHNUMI
 10494             MOVE -1             TO MAINTL
 10495             GO TO 8200-SEND-DATAONLY
 10496         ELSE
 10497             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT.
 10498
 10499     MOVE +0                     TO W-ARCH-SEQ-NO
 10500                                    W-ARCT-SEQ-NO.
 10501     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
 10502                                    W-ARCT-COMPANY-CD.
 10503     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 10504                                    W-ARCT-NUMBER
 10505                                    PI-689-ARCHIVE-NUMBER.
 10506     MOVE ' '                    TO W-ARCT-REC-TYPE.
 10507     MOVE '1'                    TO PI-ACTION.
 10508     MOVE SPACES                 TO PI-689-PRINT-SW
 10509                                    PI-689-FORM-NUMBER
 10510                                    W-DELETE-KEY.
 10511     SET W-RG-NDX                TO W-ZEROS.
 10512
 10513
 10514* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 212
* EL689.cbl
 10515*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 10516*         NOTFND     (1070-ARCH-NOT-FOUND)
 10517*         ENDFILE    (1070-ARCH-NOT-FOUND)
 10518*    END-EXEC.
 10519*    MOVE '"$JI''                 ! ( #00010322' TO DFHEIV0
 10520     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 10521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10522     MOVE X'2820233030303130333232' TO DFHEIV0(25:11)
 10523     CALL 'kxdfhei1' USING DFHEIV0
 10524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10525
 10526
 10527
 10528* EXEC CICS READ
 10529*        DATASET (W-ARCH-FILE-ID)
 10530*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10531*        RIDFLD  (W-ARCH-KEY)
 10532*    END-EXEC.
 10533*    MOVE '&"S        E          (   #00010328' TO DFHEIV0
 10534     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10536     MOVE X'2020233030303130333238' TO DFHEIV0(25:11)
 10537     CALL 'kxdfhei1' USING DFHEIV0,
 10538           W-ARCH-FILE-ID,
 10539           DFHEIV20,
 10540           DFHEIV99,
 10541           W-ARCH-KEY,
 10542           DFHEIV99,
 10543           DFHEIV99,
 10544           DFHEIV99
 10545     SET ADDRESS OF LETTER-ARCHIVE TO
 10546         DFHEIV20
 10547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10548
 10549
 10550     PERFORM 1040-FORMAT-HEADER-DATA THRU 1040-EXIT.
 10551
 10552*    EXEC CICS HANDLE CONDITION
 10553*         NOTOPEN    (8015-ARCT-NOT-OPEN)
 10554*         NOTFND     (1020-ARCT-ENDBR)
 10555*         ENDFILE    (1020-ARCT-ENDBR)
 10556*    END-EXEC.
 10557*
 10558*1005-START-BROWSE.
 10559*
 10560*    EXEC CICS STARTBR
 10561*         DATASET    (W-ARCT-FILE-ID)
 10562*         RIDFLD     (W-ARCT-KEY)
 10563*         GTEQ
 10564*    END-EXEC.
 10565*
 10566*    MOVE 'Y'                    TO W-ARCT-BROWSE-STARTED.
 10567*
 10568*1010-READ-NEXT.
 10569*
 10570*    EXEC CICS READNEXT
 10571*         SET       (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10572*         DATASET   (W-ARCT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 213
* EL689.cbl
 10573*         RIDFLD    (W-ARCT-KEY)
 10574*    END-EXEC.
 10575*
 10576*    IF  W-ARCH-PARTIAL-KEY EQUAL W-ARCT-PARTIAL-KEY
 10577*        IF  LT-ADDRESS-DATA
 10578*            IF  PI-CREATE-LABELS  AND
 10579*                NOT PI-689-LABELS-OVERRIDEN
 10580*                PERFORM 1050-MOVE-LABELS THRU 1050-EXIT
 10581*                        VARYING
 10582*                    LT-NDX FROM 1 BY 1
 10583*                        UNTIL
 10584*                    LT-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 10585*                GO TO 1010-READ-NEXT
 10586*            ELSE
 10587*                MOVE LT-CONTROL-PRIMARY
 10588*                                TO W-DELETE-KEY
 10589*                GO TO 1010-READ-NEXT
 10590*        ELSE
 10591*            PERFORM 1030-TEXT-BUILD THRU 1030-EXIT
 10592*                    VARYING
 10593*                LT-NDX FROM 1 BY 1
 10594*                    UNTIL
 10595*                LT-NDX GREATER THAN LT-NUM-LINES-ON-RECORD
 10596*                    OR
 10597*                LT-NDX GREATER THAN +20
 10598*            GO TO 1010-READ-NEXT.
 10599*
 10600*1020-ARCT-ENDBR.
 10601*
 10602*    IF  W-ARCT-BROWSE-STARTED EQUAL 'Y'
 10603*        EXEC CICS ENDBR
 10604*             DATASET   (W-ARCT-FILE-ID)
 10605*        END-EXEC.
 10606*
 10607*    IF  W-RG-NDX EQUAL ZEROS
 10608*        GO TO 1080-ARCHIVE-TEXT-NOT-FOUND.
 10609*
 10610*    IF  PI-689-NUMBER-LABEL-LINES GREATER THAN +0
 10611*            AND
 10612*        PI-BYPASS-LABELS
 10613*        MOVE W-DELETE-KEY       TO W-ARCT-KEY
 10614*        PERFORM 1060-DELETE-ADDRESS-RECORD THRU 1060-EXIT
 10615*        MOVE +0                 TO PI-689-NUMBER-LABEL-LINES.
 10616*
 10617*    SET PI-TOTAL-LINES          TO W-RG-NDX.
 10618*    MOVE 1                      TO PI-CURRENT-LINE.
 10619*    SET W-RG-NDX                TO +1.
 10620*
 10621*    PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10622*            VARYING
 10623*        W-SC-NDX FROM 1 BY 1
 10624*            UNTIL
 10625*        W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10626
 10627     MOVE -1                     TO MAINTL.
 10628     GO TO 8100-SEND-INITIAL-MAP.
 10629
 10630 1020-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 214
* EL689.cbl
 10631     EXIT.
 10632
 10633 1030-TEXT-BUILD.
 10634
 10635     SET W-RG-NDX UP BY 1.
 10636     MOVE LT-SKIP-CONTROL (LT-NDX)
 10637                                 TO W-PRINT-CONTROL.
 10638
 10639     IF  W-PRINT-CONTROL EQUAL 99
 10640         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 10641         SET W-RG-NDX UP BY 1
 10642     ELSE
 10643         SET W-RG-NDX UP BY W-PRINT-CONTROL.
 10644
 10645     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10646     MOVE LT-SKIP-CONTROL (LT-NDX)
 10647                                 TO W-RC-PC (W-RG-NDX).
 10648     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10649
 10650 1030-EXIT.
 10651     EXIT.
 10652
 10653 1040-FORMAT-HEADER-DATA.
 10654
 10655     MOVE LA-ACCOUNT-A2          TO ACCTO.
 10656     MOVE LA-ADDR-SOURCE         TO ADDRSO.
 10657     MOVE LA-CARRIER-A2          TO CARRIERO.
 10658     MOVE LA-CERT-NO-A2          TO CERTO.
 10659     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
 10660     MOVE LA-DATA-SOURCE         TO DATASORO.
 10661
 10662     IF  LA-EFFECT-DATE-A2 EQUAL LOW-VALUES
 10663         MOVE ZEROES             TO DATEO
 10664
 10665     ELSE
 10666         MOVE LA-EFFECT-DATE-A2  TO DC-BIN-DATE-1
 10667         MOVE ' '                TO DC-OPTION-CODE
 10668         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10669         MOVE DC-GREG-DATE-1-EDIT
 10670                                 TO DATEO.
 10671
 10672     IF  LA-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10673         MOVE ZEROES             TO FOLLOWO
 10674     ELSE
 10675         MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
 10676         MOVE ' '                TO DC-OPTION-CODE
 10677         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10678         MOVE DC-GREG-DATE-1-EDIT
 10679                                 TO FOLLOWO.
 10680
 10681     MOVE LA-FORM-A3             TO FORMO.
 10682     MOVE LA-GROUPING-A2         TO GROUPO.
 10683     MOVE LA-NO-OF-COPIES        TO COPIESO
 10684                                    PI-689-NUMBER-COPIES.
 10685
 10686*    IF LA-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
 10687*        MOVE LA-PRINT-RESTRICTION
 10688*                                TO PRTRESTO
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 215
* EL689.cbl
 10689*    ELSE
 10690*        MOVE SPACES             TO PRTRESTO.
 10691
 10692     IF  LA-RESEND-DATE = LOW-VALUES
 10693         MOVE ZEROES             TO RESEND1O
 10694     ELSE
 10695         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
 10696         MOVE ' '                TO DC-OPTION-CODE
 10697         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10698         MOVE DC-GREG-DATE-1-EDIT
 10699                                 TO RESEND1O.
 10700
 10701     MOVE LA-STATE-A2            TO STATEO.
 10702
 10703     MOVE LA-NUMBER-LABEL-LINES  TO PI-689-NUMBER-LABEL-LINES.
 10704
 10705 1040-EXIT.
 10706     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 216
* EL689.cbl
 10708 1050-MOVE-LABELS.
 10709
 10710     SET W-RG-NDX                TO LT-NDX.
 10711     MOVE ZEROS                  TO W-RC-PC (W-RG-NDX).
 10712     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10713     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10714
 10715 1050-EXIT.
 10716     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 217
* EL689.cbl
 10718 1060-DELETE-ADDRESS-RECORD.
 10719
 10720
 10721* EXEC CICS DELETE
 10722*        DATASET (W-ARCT-FILE-ID)
 10723*        RIDFLD  (W-DELETE-KEY)
 10724*    END-EXEC.
 10725*    MOVE '&(  R                 &   #00010504' TO DFHEIV0
 10726     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 10727     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10728     MOVE X'2020233030303130353034' TO DFHEIV0(25:11)
 10729     CALL 'kxdfhei1' USING DFHEIV0,
 10730           W-ARCT-FILE-ID,
 10731           W-DELETE-KEY,
 10732           DFHEIV99,
 10733           DFHEIV99,
 10734           DFHEIV99
 10735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10736
 10737
 10738
 10739* EXEC CICS READ
 10740*        DATASET (W-ARCH-FILE-ID)
 10741*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10742*        RIDFLD  (W-ARCH-KEY)
 10743*        UPDATE
 10744*    END-EXEC.
 10745*    MOVE '&"S        EU         (   #00010509' TO DFHEIV0
 10746     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10747     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10748     MOVE X'2020233030303130353039' TO DFHEIV0(25:11)
 10749     CALL 'kxdfhei1' USING DFHEIV0,
 10750           W-ARCH-FILE-ID,
 10751           DFHEIV20,
 10752           DFHEIV99,
 10753           W-ARCH-KEY,
 10754           DFHEIV99,
 10755           DFHEIV99,
 10756           DFHEIV99
 10757     SET ADDRESS OF LETTER-ARCHIVE TO
 10758         DFHEIV20
 10759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10760
 10761
 10762     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES.
 10763
 10764
 10765* EXEC CICS REWRITE
 10766*         FROM      (LETTER-ARCHIVE)
 10767*         DATASET   (W-ARCH-FILE-ID)
 10768*    END-EXEC.
 10769     MOVE LENGTH OF
 10770      LETTER-ARCHIVE
 10771       TO DFHEIV11
 10772*    MOVE '&& L                  %   #00010518' TO DFHEIV0
 10773     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10774     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10775     MOVE X'2020233030303130353138' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 218
* EL689.cbl
 10776     CALL 'kxdfhei1' USING DFHEIV0,
 10777           W-ARCH-FILE-ID,
 10778           LETTER-ARCHIVE,
 10779           DFHEIV11,
 10780           DFHEIV99
 10781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10782
 10783
 10784 1060-EXIT.
 10785     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 219
* EL689.cbl
 10787 1070-ARCH-NOT-FOUND.
 10788
 10789     MOVE ER-7371                TO EMI-ERROR.
 10790     MOVE -1                     TO ARCHNUML.
 10791     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10792     GO TO 8100-SEND-INITIAL-MAP.
 10793
 10794 1080-ARCHIVE-TEXT-NOT-FOUND.
 10795
 10796     MOVE ER-7372                TO EMI-ERROR.
 10797     MOVE -1                     TO ARCHNUML.
 10798     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10799     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 220
* EL689.cbl
 10801 2000-CREATE.
 10802***************************************************************
 10803*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
 10804*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
 10805*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
 10806*    WILL BE DISPLAYED ON THE SCREEN.                         *
 10807*                                                             *
 10808***************************************************************
 10809
 10810***************************************************************
 10811*    CHECK TO SEE IF IT IS THE SAME REQUEST OR NOT.           *
 10812*    IF IT IS A NEW REQUEST AND A LETTER WAS PRINTED          *
 10813*    THEN FORCE AN ERROR.                                     *
 10814***************************************************************
 10815
 10816     IF  PI-689-CREATE-NO-SCREENS
 10817         GO TO 2000-GET-TEXT.
 10818
 10819     IF  PI-CREATE-MODE
 10820         IF  PI-689-PRINT-PERFORMED
 10821                 AND
 10822             FORMI NOT EQUAL 9999
 10823             MOVE ER-0279    TO EMI-ERROR
 10824             MOVE -1         TO MAINTL
 10825             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10826             GO TO 8200-SEND-DATAONLY.
 10827
 10828     IF  ARCHNUML GREATER THAN ZEROS
 10829         MOVE ER-9320            TO EMI-ERROR
 10830         MOVE -1                 TO ARCHNUML
 10831         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10832         GO TO 8200-SEND-DATAONLY.
 10833
 10834***************************************************************
 10835*    IF  A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE     *
 10836*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
 10837***************************************************************
 10838
 10839     IF  FORMI EQUAL '9999'
 10840         MOVE 16                 TO PI-TOTAL-LINES
 10841         MOVE 1                  TO PI-CURRENT-LINE
 10842         MOVE SPACES             TO W-FILE-TABLE
 10843                                    W-LINE-CONTROL-RECORD
 10844                                    W-RECORD-TABLE
 10845                                    W-SINGLE-LINE
 10846                                    W-SQUEEZED-LINE
 10847                                    W-TS-WORK-AREA
 10848                                    W-TX-TABLE
 10849         PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 10850         MOVE '3'                TO PI-ACTION
 10851         MOVE FORMI              TO PI-689-FORM-NUMBER
 10852                                    PI-COMM-CONTROL
 10853         MOVE ZEROS              TO PI-UPDATE-SW
 10854         MOVE W-PGM-EL1042       TO W-CALL-PGM
 10855         GO TO 9400-XCTL.
 10856
 10857 2000-GET-TEXT.
 10858
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 221
* EL689.cbl
 10859     MOVE SPACES                 TO W-FILE-TABLE
 10860                                    W-LINE-CONTROL-RECORD
 10861                                    W-RECORD-TABLE
 10862                                    W-SINGLE-LINE
 10863                                    W-SQUEEZED-LINE
 10864                                    W-TS-WORK-AREA
 10865                                    W-TX-TABLE.
 10866     SET W-TG-NDX                TO +1
 10867     MOVE ZEROS                  TO W-INITIAL-COLUMN
 10868                                    W-LINE-COUNT
 10869                                    W-LINE-INDENT-1
 10870                                    W-LINE-INDENT-2
 10871                                    W-LINE-INDENT-3
 10872                                    W-LINE-INDENT-4
 10873                                    W-LINE-INDENT-5
 10874                                    W-PAGE
 10875                                    W-PARAGRAPH-INDENT
 10876                                    W-TOP-MARGIN
 10877                                    W-WORK-INDENT.
 10878     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
 10879     MOVE +70                    TO W-LAST-COLUMN.
 10880     MOVE +56                    TO W-MAX-LINES-PER-PAGE.
 10881     MOVE +1                     TO W-START-COLUMN.
 10882     MOVE +71                    TO W-TOO-FAR.
 10883
 10884     MOVE PI-COMPANY-CD          TO W-TEXT-COMPANY-CD.
 10885     MOVE FORMI                  TO W-TEXT-LETTER.
 10886     MOVE W-TEXT-PARTIAL-KEY     TO W-TEXT-SAVE-KEY.
 10887     MOVE 'N'                    TO W-TEXT-BROWSED-SW.
 10888
 10889
 10890* EXEC CICS HANDLE CONDITION
 10891*         NOTFND     (2001-NOT-FOUND)
 10892*         ENDFILE    (2001-NOT-FOUND)
 10893*         NOTOPEN    (8050-TEXT-NOT-OPEN)
 10894*    END-EXEC.
 10895*    MOVE '"$I''J                 ! ) #00010628' TO DFHEIV0
 10896     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 10897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10898     MOVE X'2920233030303130363238' TO DFHEIV0(25:11)
 10899     CALL 'kxdfhei1' USING DFHEIV0
 10900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10901
 10902
 10903
 10904* EXEC CICS STARTBR
 10905*         DATASET    (W-TEXT-FILE-ID)
 10906*         RIDFLD     (W-TEXT-KEY)
 10907*         GTEQ
 10908*    END-EXEC.
 10909     MOVE 0
 10910       TO DFHEIV11
 10911*    MOVE '&,         G          &   #00010634' TO DFHEIV0
 10912     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10913     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10914     MOVE X'2020233030303130363334' TO DFHEIV0(25:11)
 10915     CALL 'kxdfhei1' USING DFHEIV0,
 10916           W-TEXT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 222
* EL689.cbl
 10917           W-TEXT-KEY,
 10918           DFHEIV99,
 10919           DFHEIV11,
 10920           DFHEIV99
 10921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10922
 10923
 10924
 10925* EXEC CICS HANDLE CONDITION
 10926*         ENDFILE    (2000-ENDBR)
 10927*    END-EXEC.
 10928*    MOVE '"$''                   ! * #00010640' TO DFHEIV0
 10929     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 10930     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10931     MOVE X'2A20233030303130363430' TO DFHEIV0(25:11)
 10932     CALL 'kxdfhei1' USING DFHEIV0
 10933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10934
 10935
 10936 2000-READ-NEXT.
 10937
 10938     IF  W-TG-NDX GREATER THAN W-MAX-LINES
 10939         MOVE ER-0051            TO EMI-ERROR
 10940         MOVE -1                 TO MAINTL
 10941         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10942         GO TO 2000-ENDBR.
 10943
 10944
 10945* EXEC CICS READNEXT
 10946*         DATASET    (W-TEXT-FILE-ID)
 10947*         SET        (ADDRESS OF TEXT-FILES)
 10948*         RIDFLD     (W-TEXT-KEY)
 10949*    END-EXEC.
 10950     MOVE 0
 10951       TO DFHEIV11
 10952*    MOVE '&.S                   )   #00010652' TO DFHEIV0
 10953     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10954     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10955     MOVE X'2020233030303130363532' TO DFHEIV0(25:11)
 10956     CALL 'kxdfhei1' USING DFHEIV0,
 10957           W-TEXT-FILE-ID,
 10958           DFHEIV20,
 10959           DFHEIV99,
 10960           W-TEXT-KEY,
 10961           DFHEIV99,
 10962           DFHEIV11,
 10963           DFHEIV99,
 10964           DFHEIV99
 10965     SET ADDRESS OF TEXT-FILES TO
 10966         DFHEIV20
 10967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10968
 10969
 10970     IF  W-TEXT-PARTIAL-KEY NOT EQUAL W-TEXT-SAVE-KEY
 10971         GO TO 2000-ENDBR.
 10972
 10973     MOVE 'Y'                    TO W-TEXT-BROWSED-SW.
 10974
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 223
* EL689.cbl
 10975     MOVE TX-FORM-SQUEEZE-CONTROL
 10976                                 TO W-FORM-SQUEEZE-IND.
 10977
 10978     IF  PI-689-ARCHIVE-SW NOT GREATER THAN SPACES
 10979         MOVE TX-ARCHIVE-SW      TO PI-689-ARCHIVE-SW.
 10980
 10981     IF  TX-FORM-CONTROL-LINE
 10982         PERFORM 2100-PROCESS-FORM-CONTROL-LINE THRU 2100-EXIT
 10983         GO TO 2000-READ-NEXT.
 10984
 10985     IF  TX-LINE-SQUEEZE-CONTROL EQUAL 'Z'
 10986         PERFORM 2150-PROCESS-Z-CONTROLS THRU 2150-EXIT
 10987         GO TO 2000-READ-NEXT.
 10988
 10989     MOVE TX-TEXT-LINE           TO W-TX-TEXT (W-TG-NDX).
 10990     MOVE TX-PROCESS-CONTROL     TO W-TX-PC (W-TG-NDX).
 10991     PERFORM 2200-CHECK-FOR-VARIABLE THRU 2200-EXIT.
 10992     MOVE TX-LINE-SQUEEZE-CONTROL
 10993                                 TO W-TX-SC (W-TG-NDX).
 10994
 10995     SET W-TG-NDX UP BY 1.
 10996     GO TO 2000-READ-NEXT.
 10997
 10998 2000-ENDBR.
 10999
 11000
 11001* EXEC CICS ENDBR
 11002*        DATASET     (W-TEXT-FILE-ID)
 11003*    END-EXEC.
 11004     MOVE 0
 11005       TO DFHEIV11
 11006*    MOVE '&2                    $   #00010688' TO DFHEIV0
 11007     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11008     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11009     MOVE X'2020233030303130363838' TO DFHEIV0(25:11)
 11010     CALL 'kxdfhei1' USING DFHEIV0,
 11011           W-TEXT-FILE-ID,
 11012           DFHEIV11,
 11013           DFHEIV99
 11014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11015
 11016
 11017     IF  W-TEXT-BROWSE-NOT-STARTED
 11018         MOVE ER-0006            TO EMI-ERROR
 11019         MOVE -1                 TO FORML
 11020         MOVE AL-UABON           TO FORMA
 11021         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11022         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 11023
 11024     SET  W-TOTAL-TX-LINES       TO W-TG-NDX.
 11025     SUBTRACT +1 FROM W-TOTAL-TX-LINES.
 11026     MOVE 1                      TO PI-CURRENT-LINE.
 11027
 11028     IF  COPIESL NOT GREATER THAN ZEROS
 11029         MOVE +1                 TO COPIESI
 11030                                    PI-689-NUMBER-COPIES
 11031         MOVE +1                 TO COPIESL
 11032         MOVE AL-UNNON           TO COPIESA.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 224
* EL689.cbl
 11033
 11034***************************************************************
 11035*    IF IT IS A FORM WITH VARIABLES, THEN RESOLVE ALL OF      *
 11036*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
 11037***************************************************************
 11038
 11039     PERFORM 6000-RESOLVE-VARIABLES THRU 6000-EXIT.
 11040
 11041*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
 11042*        IF  PI-689-CONTROL NOT GREATER THAN ZEROS
 11043*            MOVE ER-7243        TO EMI-ERROR
 11044*            MOVE -1             TO PRTRESTL
 11045*            MOVE AL-UABON       TO PRTRESTA
 11046*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11047
 11048     IF  PI-CREATE-LABELS AND
 11049         NOT  PI-689-LABELS-OVERRIDEN
 11050         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11051         SET W-RG-NDX UP BY +1
 11052     ELSE
 11053         SET W-RG-NDX            TO +1.
 11054
 11055     MOVE W-TOP-FORM             TO W-RC-TEXT (W-RG-NDX).
 11056     SET W-RG-NDX UP BY W-TOP-MARGIN.
 11057
 11058     PERFORM 7400-CREATE-LETTER THRU 7400-EXIT.
 11059
 11060     SET PI-TOTAL-LINES          TO W-RG-NDX.
 11061
 11062     IF  W-FIRST-BAD-VARIABLE-FOUND
 11063         SET W-RG-NDX            TO W-FIRST-BAD-VARIABLE
 11064         MOVE W-FIRST-BAD-VARIABLE
 11065                                 TO PI-CURRENT-LINE
 11066     ELSE
 11067         SET W-RG-NDX            TO 1.
 11068
 11069     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11070             VARYING
 11071         W-SC-NDX FROM 1 BY 1
 11072             UNTIL
 11073         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11074     IF  PI-689-CREATE-NO-SCREENS
 11075         GO TO 2000-EXIT
 11076     ELSE
 11077         IF  W-FORM-CHANGED
 11078             MOVE '3'            TO PI-ACTION
 11079             MOVE -1             TO MAINTL
 11080             GO TO 8100-SEND-INITIAL-MAP
 11081         ELSE
 11082             MOVE '3'            TO PI-ACTION
 11083             MOVE -1             TO MAINTL
 11084             GO TO 8350-SEND-DATAONLY-ERASEAUP.
 11085
 11086 2000-EXIT.
 11087     EXIT.
 11088
 11089 2001-NOT-FOUND.
 11090
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 225
* EL689.cbl
 11091     MOVE ER-0006                TO EMI-ERROR.
 11092     MOVE -1                     TO FORML.
 11093     MOVE AL-UABON               TO FORMA.
 11094     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11095     GO TO 8350-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 226
* EL689.cbl
 11097 2100-PROCESS-FORM-CONTROL-LINE.
 11098
 11099     MOVE TX-TEXT-LINE           TO W-LINE-CONTROL-RECORD.
 11100
 11101     IF  W-LC-LINE-WIDTH NUMERIC
 11102             AND
 11103         W-LC-LINE-WIDTH GREATER THAN ZEROS
 11104         COMPUTE W-INITIAL-COLUMN
 11105             = (70 - W-LC-LINE-WIDTH) / 2
 11106         COMPUTE W-START-COLUMN = W-INITIAL-COLUMN + 1
 11107         COMPUTE W-LAST-COLUMN ROUNDED
 11108             = W-INITIAL-COLUMN + W-LC-LINE-WIDTH
 11109         COMPUTE W-TOO-FAR = W-LAST-COLUMN + 1
 11110     ELSE
 11111         MOVE 70                 TO W-LC-LINE-WIDTH.
 11112
 11113     IF  W-LC-PARAGRAPH-INDENT NUMERIC
 11114             AND
 11115         W-LC-PARAGRAPH-INDENT GREATER THAN ZEROS
 11116         MOVE W-LC-PARAGRAPH-INDENT
 11117                                 TO W-PARAGRAPH-INDENT.
 11118
 11119     IF  W-LC-MAX-LINES-PER-PAGE NUMERIC
 11120             AND
 11121         W-LC-MAX-LINES-PER-PAGE GREATER THAN ZEROS
 11122         MOVE W-LC-MAX-LINES-PER-PAGE
 11123                                 TO W-MAX-LINES-PER-PAGE.
 11124
 11125     IF  W-LC-LINE-ADJUST NUMERIC
 11126             AND
 11127         W-LC-LINE-ADJUST GREATER THAN ZEROS
 11128         COMPUTE W-TOTAL-LINE-LENGTH
 11129             = W-LC-LINE-WIDTH + (W-LC-LINE-ADJUST * 2)
 11130         IF  W-TOTAL-LINE-LENGTH LESS THAN +71
 11131             ADD W-LC-LINE-ADJUST
 11132                                 TO W-INITIAL-COLUMN
 11133                                    W-LAST-COLUMN
 11134                                    W-START-COLUMN
 11135                                    W-TOO-FAR.
 11136
 11137     IF  W-LC-LINE-INDENT-1 NUMERIC
 11138             AND
 11139         W-LC-LINE-INDENT-1 LESS THAN W-LC-LINE-WIDTH
 11140         MOVE W-LC-LINE-INDENT-1 TO W-LINE-INDENT-1
 11141     ELSE
 11142         MOVE +0                 TO W-LINE-INDENT-1.
 11143
 11144     IF  W-LC-LINE-INDENT-2 NUMERIC
 11145             AND
 11146         W-LC-LINE-INDENT-2 LESS THAN W-LC-LINE-WIDTH
 11147         MOVE W-LC-LINE-INDENT-2 TO W-LINE-INDENT-2
 11148     ELSE
 11149         MOVE +0                 TO W-LINE-INDENT-2.
 11150
 11151     IF  W-LC-LINE-INDENT-3 NUMERIC
 11152             AND
 11153         W-LC-LINE-INDENT-3 LESS THAN W-LC-LINE-WIDTH
 11154         MOVE W-LC-LINE-INDENT-3 TO W-LINE-INDENT-3
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 227
* EL689.cbl
 11155     ELSE
 11156         MOVE +0                 TO W-LINE-INDENT-3.
 11157
 11158     IF  W-LC-LINE-INDENT-4 NUMERIC
 11159             AND
 11160         W-LC-LINE-INDENT-4 LESS THAN W-LC-LINE-WIDTH
 11161         MOVE W-LC-LINE-INDENT-4 TO W-LINE-INDENT-4
 11162     ELSE
 11163         MOVE +0                 TO W-LINE-INDENT-4.
 11164
 11165     IF  W-LC-LINE-INDENT-5 NUMERIC
 11166             AND
 11167         W-LC-LINE-INDENT-5 LESS THAN W-LC-LINE-WIDTH
 11168         MOVE W-LC-LINE-INDENT-5 TO W-LINE-INDENT-5
 11169
 11170     ELSE
 11171         MOVE +0                 TO W-LINE-INDENT-5.
 11172
 11173     IF  W-LC-TOP-MARGIN NUMERIC
 11174         MOVE W-LC-TOP-MARGIN    TO W-TOP-MARGIN
 11175     ELSE
 11176         MOVE +0                 TO W-TOP-MARGIN.
 11177
 11178     IF W-LC-CASE-IND = 'Y' OR 'N'
 11179         NEXT SENTENCE
 11180     ELSE
 11181         MOVE PI-LOWER-CASE-LETTERS
 11182                                 TO W-LC-CASE-IND.
 11183
 11184 2100-EXIT.
 11185     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 228
* EL689.cbl
 11187 2150-PROCESS-Z-CONTROLS.
 11188
 11189     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
 11190
 11191     IF PI-689-RESEND-DATE-1 = LOW-VALUES
 11192        IF W-DAYS-TO-RESEND NUMERIC
 11193           IF W-DAYS-TO-RESEND > ZEROS
 11194              MOVE '6'           TO DC-OPTION-CODE
 11195              MOVE W-SAVE-BIN-NEXT-BUS-DT
 11196                                 TO DC-BIN-DATE-1
 11197              MOVE ZEROS         TO DC-ELAPSED-MONTHS
 11198              MOVE W-DAYS-TO-RESEND
 11199                                 TO DC-ELAPSED-DAYS
 11200              PERFORM 9500-LINK-DATE-CONVERT
 11201                                 THRU 9500-EXIT
 11202              IF NO-CONVERSION-ERROR
 11203                 MOVE DC-BIN-DATE-2
 11204                                 TO PI-689-RESEND-DATE-1
 11205                 MOVE DC-GREG-DATE-1-EDIT
 11206                                 TO RESEND1O
 11207                                    PI-689-RESEND1-EDIT
 11208                 MOVE AL-UANON
 11209                                 TO RESEND1A
 11210                 MOVE +8         TO RESEND1L
 11211              ELSE
 11212                 MOVE ER-3770
 11213                                 TO EMI-ERROR
 11214                 MOVE -1         TO MAINTL
 11215                 PERFORM 9900-ERROR-FORMAT
 11216                                 THRU 9900-EXIT
 11217                 GO TO 8200-SEND-DATAONLY
 11218              END-IF
 11219           END-IF
 11220        END-IF
 11221     END-IF
 11222     IF W-FORM-TO-RESEND NOT = SPACES AND ZEROS
 11223        MOVE W-FORM-TO-RESEND    TO PI-689-RESEND-LETR-1
 11224     END-IF
 11225     IF  PI-689-FOLLOW-UP-DATE EQUAL LOW-VALUES
 11226         IF  W-DAYS-TO-FOLLOW-UP NUMERIC
 11227            IF  W-DAYS-TO-FOLLOW-UP >= ZEROS
 11228                 MOVE '6'        TO DC-OPTION-CODE
 11229                 MOVE W-SAVE-BIN-DATE
 11230                                 TO DC-BIN-DATE-1
 11231                 MOVE ZEROS      TO DC-ELAPSED-MONTHS
 11232                 MOVE W-DAYS-TO-FOLLOW-UP
 11233                                 TO DC-ELAPSED-DAYS
 11234                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 11235                 IF  NO-CONVERSION-ERROR
 11236                     MOVE DC-BIN-DATE-2
 11237                                 TO PI-689-FOLLOW-UP-DATE
 11238                     MOVE DC-GREG-DATE-1-EDIT
 11239                                 TO FOLLOWO
 11240                     MOVE AL-UANON
 11241                                 TO FOLLOWA
 11242                     MOVE +8     TO FOLLOWL
 11243                 ELSE
 11244                     MOVE ER-3771
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 229
* EL689.cbl
 11245                                 TO EMI-ERROR
 11246                     MOVE -1     TO MAINTL
 11247                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11248                     GO TO 8200-SEND-DATAONLY.
 11249
 11250     IF  COPIESI NOT NUMERIC
 11251             OR
 11252         COPIESI NOT GREATER THAN ZEROS
 11253         IF  W-NUMBER-OF-COPIES NUMERIC
 11254             IF  W-NUMBER-OF-COPIES GREATER THAN ZEROS
 11255                 MOVE W-NUMBER-OF-COPIES
 11256                                 TO COPIESI
 11257                                    PI-689-NUMBER-COPIES
 11258                 MOVE AL-UNNON   TO COPIESA
 11259                 MOVE +1         TO COPIESL
 11260             ELSE
 11261                 MOVE +1         TO COPIESI
 11262                                    PI-689-NUMBER-COPIES
 11263                 MOVE AL-UNNON   TO COPIESA
 11264                 MOVE +1         TO COPIESL
 11265         ELSE
 11266             MOVE +1             TO COPIESI
 11267                                    PI-689-NUMBER-COPIES
 11268             MOVE AL-UNNON       TO COPIESA
 11269             MOVE +1             TO COPIESL.
 11270
 11271     IF W-PROMPT-LETTER EQUAL 'Y'
 11272         MOVE 'Y'                TO PI-PROMPT-IND
 11273         MOVE ER-0894            TO EMI-ERROR
 11274         MOVE -1                 TO MAINTL
 11275         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11276     END-IF.
 11277
 11278     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
 11279                                           ENCO
 11280     MOVE AL-UANON                      TO ENCA
 11281     MOVE +3                            TO ENCL
 11282
 11283     IF W-PRINT-CERTIFICATE = 'Y'
 11284        MOVE 'Y' TO PI-CERT-REQ-IND
 11285        IF CERTIDL > ZEROS
 11286            IF CERTIDI NUMERIC
 11287              MOVE AL-UANON      TO CERTIDA
 11288              MOVE CERTIDI       TO PI-CERT-FORM-ID
 11289            ELSE
 11290              MOVE ER-1778       TO EMI-ERROR
 11291              MOVE -1            TO CERTIDL
 11292              MOVE AL-UABON      TO CERTIDA
 11293              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11294           END-IF
 11295        ELSE
 11296              MOVE ER-0715       TO EMI-ERROR
 11297              MOVE -1            TO CERTIDL
 11298              MOVE AL-UABON      TO CERTIDA
 11299              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11300        END-IF
 11301     END-IF.
 11302
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 230
* EL689.cbl
 11303     IF W-REASONS-REQUIRED = 'Y'
 11304        MOVE 'Y' TO PI-REASON-REQ-IND
 11305        IF PI-ENDT-ARCH-NO NOT > ZERO
 11306          MOVE ER-9840       TO EMI-ERROR
 11307          MOVE -1            TO FORML
 11308          MOVE AL-UABON      TO FORMA
 11309          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11310        END-IF
 11311     END-IF.
 11312
 11313*    IF  PI-689-PRINT-RESTRICTION NOT = 'C' AND 'F' AND 'P' AND
 11314*                                       SPACES
 11315*        IF  W-PRINT-RESTRICTED
 11316*            MOVE W-PRINT-RESTRICTED-IND
 11317*                                TO PRTRESTI
 11318*                                   PI-689-PRINT-RESTRICTION
 11319*            MOVE AL-UANON       TO PRTRESTA
 11320*            MOVE +1             TO PRTRESTL.
 11321     .
 11322 2150-EXIT.
 11323     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 231
* EL689.cbl
 11325 2200-CHECK-FOR-VARIABLE.
 11326
 11327     IF  W-TX-TEXT (W-TG-NDX) EQUAL SPACES
 11328         GO TO 2200-EXIT.
 11329
 11330     SET W-TX-NDX                TO +1.
 11331
 11332 2200-CONTINUE.
 11333
 11334     SEARCH W-TX-CHAR
 11335         VARYING
 11336             W-TX-NDX
 11337         AT END
 11338             GO TO 2200-EXIT
 11339         WHEN
 11340             W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11341             NEXT SENTENCE.
 11342
 11343     SET W-TX-NDX UP BY +1.
 11344
 11345     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11346         PERFORM 2220-BUILD-VARIABLE-NUMBER THRU 2220-EXIT
 11347         GO TO 2200-CONTINUE.
 11348
 11349 2200-EXIT.
 11350     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 232
* EL689.cbl
 11352 2220-BUILD-VARIABLE-NUMBER.
 11353
 11354     SET W-TX-NDX UP BY +1.
 11355     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V1.
 11356     SET W-TX-NDX UP BY +1.
 11357     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V2.
 11358     SET W-TX-NDX UP BY +1.
 11359     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V3.
 11360
 11361     IF  W-VAR-RELATIVE-NUM NUMERIC
 11362         SET W-FILE-NDX TO W-VARIABLE-SOURCE (W-VAR-RELATIVE-NUM)
 11363         MOVE 'Y' TO W-FILE-USE-IND (W-FILE-NDX).
 11364
 11365 2220-EXIT.
 11366     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 233
* EL689.cbl
 11368 4000-ROLL-PAGE.
 11369
 11370     IF  ENTERPFL NOT EQUAL ZEROS
 11371         MOVE -1                 TO ENTERPFL
 11372     ELSE
 11373         MOVE -1                 TO MAINTL.
 11374
 11375     IF  PI-TOTAL-LINES EQUAL 0
 11376         MOVE ER-0047            TO EMI-ERROR
 11377         MOVE -1                 TO MAINTL
 11378         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11379         GO TO 8200-SEND-DATAONLY.
 11380
 11381     COMPUTE W-TEMP-CURRENT-LINE EQUAL
 11382         PI-CURRENT-LINE + W-ROLL-COUNTER.
 11383
 11384     IF  W-TEMP-CURRENT-LINE NEGATIVE
 11385             OR
 11386         W-TEMP-CURRENT-LINE EQUAL ZEROS
 11387         MOVE ER-0067            TO EMI-ERROR
 11388         MOVE -1                 TO MAINTL
 11389         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11390         MOVE 1                  TO W-TEMP-CURRENT-LINE.
 11391
 11392*    IF  W-TEMP-CURRENT-LINE GREATER THAN PI-TOTAL-LINES
 11393*            AND
 11394*        (EIBAID EQUAL DFHPF1 OR DFHPF6)
 11395*        MOVE ER-0066            TO EMI-ERROR
 11396*        MOVE -1                 TO MAINTL
 11397*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11398*        COMPUTE W-TEMP-CURRENT-LINE
 11399*            = PI-TOTAL-LINES + 1 - W-NUM-LINES-PER-SCREEN
 11400*        IF  W-TEMP-CURRENT-LINE NEGATIVE
 11401*                OR
 11402*            W-TEMP-CURRENT-LINE = ZEROS
 11403*            MOVE 1 TO W-TEMP-CURRENT-LINE.
 11404
 11405     IF  EMI-ERROR NOT EQUAL ER-0191
 11406             AND
 11407         MAINTI NOT EQUAL 'S'
 11408         PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
 11409         PERFORM 4100-SET-NDX THRU 4100-EXIT
 11410         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11411                 VARYING
 11412             W-SC-NDX FROM 1 BY 1
 11413                 UNTIL
 11414             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11415
 11416     IF  EMI-ERROR EQUAL ER-0066 OR ER-0067 OR ER-0000 OR
 11417                         ER-0191
 11418         NEXT SENTENCE
 11419     ELSE
 11420         GO TO 8200-SEND-DATAONLY.
 11421
 11422     MOVE W-TEMP-CURRENT-LINE    TO PI-CURRENT-LINE
 11423     SET W-RG-NDX                TO PI-CURRENT-LINE
 11424     MOVE LOW-VALUES             TO EL689RI
 11425*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 234
* EL689.cbl
 11426     PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
 11427     SET W-RG-NDX                TO PI-CURRENT-LINE
 11428     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11429             VARYING
 11430         W-SC-NDX FROM 1 BY 1
 11431             UNTIL
 11432         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11433
 11434     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 235
* EL689.cbl
 11436 4100-SET-NDX.
 11437
 11438     IF  PI-CURRENT-LINE EQUAL 0
 11439         SET W-RG-NDX            TO 1
 11440     ELSE
 11441         SET W-RG-NDX            TO PI-CURRENT-LINE.
 11442
 11443 4100-EXIT.
 11444      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 236
* EL689.cbl
 11446 4200-UPDATE-TABLE-FROM-SCREEN.
 11447
 11448     IF  W-SC-TEXTL (W-SC-NDX) NOT EQUAL ZEROS
 11449         MOVE ZEROS              TO W-SC-TEXTL (W-SC-NDX)
 11450         IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11451             IF  PI-TOTAL-LINES EQUAL W-MAX-LINES
 11452                 MOVE ER-0051    TO EMI-ERROR
 11453                 MOVE -1         TO MAINTL
 11454                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11455                 GO TO 8200-SEND-DATAONLY
 11456             ELSE
 11457                 MOVE W-SC-TEXT (W-SC-NDX)
 11458                                 TO W-RC-TEXT (W-RG-NDX)
 11459                 ADD 1           TO PI-TOTAL-LINES
 11460         ELSE
 11461             MOVE W-SC-TEXT (W-SC-NDX)
 11462                                 TO W-RC-TEXT (W-RG-NDX).
 11463
 11464     SET W-RG-NDX UP BY 1.
 11465
 11466 4200-EXIT.
 11467      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 237
* EL689.cbl
 11469 5000-EDIT-MODE.
 11470***************************************************************
 11471*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
 11472*    AND THE W-TS-TABLE OF LETTER TEXT.  IT WILL THEN         *
 11473*    TRANSFER TO THE W-TEXT-EDITOR PROGRAM.                   *
 11474***************************************************************
 11475
 11476     IF  PI-SHOW-MODE
 11477         MOVE ER-0188            TO EMI-ERROR
 11478         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11479         MOVE -1                 TO MAINTL
 11480         MOVE AL-UABON           TO MAINTA
 11481         GO TO 8200-SEND-DATAONLY.
 11482
 11483     IF  PI-CURRENT-LINE EQUAL ZEROS
 11484         MOVE ER-0187            TO EMI-ERROR
 11485         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11486         MOVE -1                 TO MAINTL
 11487         GO TO 8200-SEND-DATAONLY.
 11488
 11489     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11490     PERFORM 4100-SET-NDX THRU 4100-EXIT.
 11491     PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11492             VARYING
 11493         W-SC-NDX FROM 1 BY 1
 11494             UNTIL
 11495         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11496
 11497     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 11498
 11499     MOVE PI-689-FORM-NUMBER     TO PI-COMM-CONTROL.
 11500     MOVE ZEROS                  TO PI-UPDATE-SW.
 11501     MOVE '1'                    TO PI-ENTRY-CD-1.
 11502     MOVE W-PGM-EL1042           TO W-CALL-PGM.
 11503     GO TO 9400-XCTL.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 238
* EL689.cbl
 11505 5400-LETTER-RELEASE.
 11506***************************************************************
 11507*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
 11508*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS IN       *
 11509*    THE ARCHIVE FILE.                                        *
 11510*    THE FUNCTIONS BELOW WILL BE PERFORMED.                   *
 11511*        1. CHECK SECURITY.                                   *
 11512*        2. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS.        *
 11513*        3. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
 11514*        4. WRITE THE NEW ARCHIVE RECORDS FROM W-TS-TABLE.    *
 11515*        5. RESET INSURED'S CONTROL FIELDS AND RETURN THE     *
 11516*           ARCHIVE NUMBER USED  TO FILE THE RECORDS.         *
 11517***************************************************************
 11518
 11519     IF  NOT MODIFY-CAP
 11520         MOVE ER-0070            TO EMI-ERROR
 11521         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11522         MOVE -1                 TO MAINTL
 11523         GO TO 8200-SEND-DATAONLY.
 11524
 11525     IF  PI-SHOW-MODE
 11526         MOVE ER-0188            TO EMI-ERROR
 11527         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11528         MOVE -1                 TO MAINTL
 11529         MOVE AL-UABON           TO MAINTA
 11530         GO TO 8200-SEND-DATAONLY.
 11531
 11532      IF  ARCHNUML GREATER THAN ZEROS
 11533          MOVE ER-9320            TO EMI-ERROR
 11534          MOVE -1                 TO ARCHNUML
 11535          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11536          GO TO 8200-SEND-DATAONLY.
 11537
 11538*     IF  PI-CURRENT-LINE EQUAL ZEROS
 11539*        MOVE ER-0187            TO EMI-ERROR
 11540*        MOVE -1                 TO MAINTL
 11541*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11542*        GO TO 8200-SEND-DATAONLY.
 11543
 11544*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11545*
 11546*    IF  NOT PI-689-CREATE-NO-SCREENS
 11547*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 11548*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11549*                VARYING
 11550*            W-SC-NDX FROM 1 BY 1
 11551*                UNTIL
 11552*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 11553*        IF  EMI-FATAL-CTR GREATER THAN ZEROS
 11554*                OR
 11555*            PI-689-FATAL-ERROR
 11556*            GO TO 8200-SEND-DATAONLY.
 11557*
 11558*    MOVE SPACES                 TO W-REMAINING-VAR-SW.
 11559*    PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 11560*            VARYING
 11561*        W-RVS-NDX FROM +1 BY +1
 11562*            UNTIL
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 239
* EL689.cbl
 11563*        W-RVS-NDX > +36500
 11564*            OR
 11565*        W-REMAINING-VAR-FOUND.
 11566*
 11567*    IF  NOT PI-689-CREATE-NO-SCREENS
 11568*        IF  W-REMAINING-VAR-FOUND
 11569*            GO TO 4000-ROLL-PAGE.
 11570
 11571*    MOVE SPACES                 TO W-CNTL-KEY.
 11572*    MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11573*    MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11574*    MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 11575*
 11576*    EXEC CICS HANDLE CONDITION
 11577*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11578*         NOTFND     (5470-CNTL-NOT-FOUND)
 11579*    END-EXEC.
 11580*
 11581*    EXEC CICS READ
 11582*         DATASET    (W-CNTL-FILE-ID)
 11583*         SET        (ADDRESS OF CONTROL-FILE)
 11584*         RIDFLD     (W-CNTL-KEY)
 11585*         UPDATE
 11586*    END-EXEC.
 11587*
 11588*    IF  CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
 11589*        MOVE ZEROS              TO CF-CREDIT-LAST-ARCH-NUM
 11590*                                   CF-CREDIT-START-ARCH-NUM.
 11591*
 11592*    ADD 1                       TO CF-CREDIT-LAST-ARCH-NUM.
 11593*    MOVE CF-CREDIT-LAST-ARCH-NUM
 11594*                                TO W-ARCH-NUMBER
 11595*                                   W-ARCT-NUMBER.
 11596*
 11597*    EXEC CICS REWRITE
 11598*         FROM      (CONTROL-FILE)
 11599*         DATASET   (W-CNTL-FILE-ID)
 11600*    END-EXEC
 11601
 11602*    EXEC CICS HANDLE CONDITION
 11603*         NOTOPEN   (8010-ARCH-NOT-OPEN)
 11604*    END-EXEC.
 11605*
 11606*    EXEC CICS GETMAIN
 11607*       SET      (ADDRESS OF LETTER-ARCHIVE)
 11608*       LENGTH   (W-ARCH-LENGTH)
 11609*    END-EXEC
 11610*
 11611*    MOVE SPACES                 TO LETTER-ARCHIVE
 11612*    MOVE 'LA'                   TO LA-RECORD-ID.
 11613*    MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
 11614*                                   LA-ARCHIVE-NO-A2
 11615*                                   LA-ARCHIVE-NO-A3
 11616*                                   LA-ARCHIVE-NO-A4
 11617*                                   LA-ARCHIVE-NO-A5
 11618*                                   LA-ARCHIVE-NO-A6
 11619*                                   PI-689-ARCHIVE-NUMBER.
 11620*    MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 240
* EL689.cbl
 11621*                                   LA-COMPANY-CD-A2
 11622*                                   LA-COMPANY-CD-A3
 11623*                                   LA-COMPANY-CD-A4
 11624*                                   LA-COMPANY-CD-A5
 11625*                                   LA-COMPANY-CD-A6.
 11626*    MOVE PI-689-CARRIER         TO LA-CARRIER-A2
 11627*                                   LA-CARRIER-A3
 11628*                                   LA-CARRIER-A4
 11629*                                   LA-CARRIER-A5.
 11630*    MOVE PI-689-EFF-DATE        TO LA-EFFECT-DATE-A2.
 11631*    MOVE PI-689-GROUPING        TO LA-GROUPING-A2
 11632*                                   LA-GROUPING-A3
 11633*                                   LA-GROUPING-A4
 11634*                                   LA-GROUPING-A5.
 11635*    MOVE PI-689-ACCOUNT         TO LA-ACCOUNT-A2
 11636*                                   LA-ACCOUNT-A3
 11637*                                   LA-ACCOUNT-A4
 11638*                                   LA-ACCOUNT-A5.
 11639*    MOVE PI-689-STATE           TO LA-STATE-A2
 11640*                                   LA-STATE-A3
 11641*                                   LA-STATE-A4
 11642*                                   LA-STATE-A5.
 11643*
 11644*    IF  PI-689-DATA-SOURCE EQUAL '3'
 11645*            AND
 11646*        PI-689-RESP-PERSON GREATER THAN SPACES
 11647*        MOVE PI-689-RESP-PERSON
 11648*                                TO LA-RESP-PERSON-A2
 11649*        MOVE PI-689-TYPE        TO LA-TYPE-A2
 11650*    ELSE
 11651*        IF  PI-689-CERT-PRIME GREATER THAN SPACES
 11652*            MOVE PI-689-CERT-PRIME
 11653*                                TO LA-CERT-PRIME-A2
 11654*            MOVE PI-689-CERT-SFX
 11655*                                TO LA-CERT-SUFFIX-A2
 11656*        ELSE
 11657*            MOVE LOW-VALUE      TO LA-RESP-PERSON-A2
 11658*                                   LA-TYPE-A2.
 11659*
 11660*    IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 11661*        MOVE PI-689-ENTRY-BATCH TO LA-ENTRY-A6
 11662*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11663*                AND
 11664*            PI-689-PRINT-RESTRICTION EQUAL 'C'
 11665*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11666*            MOVE 'CK'           TO LA-FILLER
 11667*        ELSE
 11668*            NEXT SENTENCE
 11669*    ELSE
 11670*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11671*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11672*            MOVE 'CK'           TO LA-FILLER
 11673*        ELSE
 11674*            MOVE LOW-VALUES     TO LA-ENTRY-A6.
 11675*
 11676*    MOVE ZEROS                  TO W-SEQ-CTR.
 11677*
 11678*    MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 241
* EL689.cbl
 11679*
 11680*    MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
 11681*                                   LA-INITIAL-PRINT-DATE
 11682*                                   LA-SENT-DATE
 11683*                                   LA-REPLY-DATE.
 11684*    MOVE 'A'                    TO LA-STATUS.
 11685*
 11686*    IF  PI-689-NUMBER-COPIES NOT NUMERIC
 11687*            OR
 11688*        PI-689-NUMBER-COPIES EQUAL ZEROS
 11689*        MOVE  1                 TO LA-NO-OF-COPIES
 11690*    ELSE
 11691*        MOVE PI-689-NUMBER-COPIES
 11692*                                TO LA-NO-OF-COPIES.
 11693*
 11694*    MOVE PI-689-FORM-NUMBER     TO LA-FORM-A3.
 11695*    MOVE PI-689-FOLLOW-UP-DATE  TO LA-FOLLOW-UP-DATE.
 11696*    MOVE PI-689-PRINT-RESTRICTION
 11697*                                TO LA-PRINT-RESTRICTION
 11698*    MOVE PI-689-LABEL-SOURCE    TO LA-ADDR-SOURCE.
 11699*    MOVE PI-689-DATA-SOURCE     TO LA-DATA-SOURCE.
 11700*    MOVE PI-689-RESEND-DATE-1   TO LA-RESEND-DATE
 11701*    MOVE PI-689-RESEND-LETR-1   TO LA-RESEND-LETR
 11702*    MOVE W-CURRENT-SAVE         TO LA-CREATION-DATE.
 11703*
 11704*    IF  PI-689-PRINT-PERFORMED
 11705*        MOVE SPACES             TO PI-689-PRINT-SW
 11706*        MOVE W-CURRENT-SAVE     TO LA-INITIAL-PRINT-DATE
 11707*        IF  LA-RESEND-DATE = LOW-VALUES
 11708*            MOVE 'C'            TO LA-STATUS.
 11709*
 11710*    MOVE PI-689-NUMBER-LABEL-LINES
 11711*                                TO LA-NUMBER-LABEL-LINES.
 11712*    MOVE ZEROS                  TO PI-689-NUMBER-TEXT-RECORDS.
 11713*
 11714*    PERFORM 5410-CREATE-TEXT-RECORDS THRU 5410-EXIT.
 11715*
 11716*    MOVE PI-689-NUMBER-TEXT-RECORDS
 11717*    MOVE ZEROS                  TO LA-NO-OF-TEXT-RECORDS.
 11718*
 11719*    EXEC CICS HANDLE CONDITION
 11720*        DUPREC    (5460-DUPLICATE-ARCHIVE-RCD)
 11721*    END-EXEC.
 11722*
 11723*    PERFORM 5650-WRITE-ARCHIVE THRU 5650-EXIT.
 11724*    MOVE ER-0280                TO EMI-ERROR.
 11725*    MOVE -1                     TO MAINTL.
 11726*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11727*    MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 11728*    MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1).
 11729     .
 11730 5400-END.
 11731     DISPLAY ' MADE IT TO 5400 '
 11732     MOVE SPACES                 TO BL-INPUT
 11733     MOVE ZEROS                  TO BL-ARCHIVE-NO
 11734     MOVE PI-689-DATA-SOURCE     TO BL-DATA-SRCE
 11735     MOVE PI-689-CARRIER         TO BL-CARRIER
 11736     MOVE PI-689-GROUPING        TO BL-GROUP
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 242
* EL689.cbl
 11737     MOVE PI-689-STATE           TO BL-STATE
 11738     MOVE PI-689-ACCOUNT         TO BL-ACCOUNT
 11739     IF PI-689-EFF-DATE NOT = LOW-VALUES
 11740        MOVE PI-689-EFF-DATE     TO DC-BIN-DATE-1
 11741        MOVE ' '                 TO DC-OPTION-CODE
 11742        PERFORM 9500-LINK-DATE-CONVERT
 11743                                 THRU 9500-EXIT
 11744        IF NO-CONVERSION-ERROR
 11745           MOVE DC-GREG-DATE-1-EDIT
 11746                                 TO BL-EFF-DT
 11747        END-IF
 11748     END-IF
 11749     MOVE PI-689-CERT-NO         TO BL-CERT-NO
 11750     MOVE PI-689-ENTRY-BATCH     TO BL-BATCH-NO
 11751     MOVE PI-689-SEQ-NO          TO BL-BATCH-SEQ
 11752     MOVE PI-689-RESP-PERSON     TO BL-RESP-NO
 11753     MOVE PI-689-FORM-NUMBER     TO BL-LETTER-ID
 11754     MOVE PI-689-NUMBER-COPIES   TO BL-NO-OF-COPIES
 11755     IF PI-ENDT-ARCH-NO > ZERO
 11756         MOVE PI-ENDT-ARCH-NO    TO BL-ENDT-ARCH-NO
 11757     END-IF
 11758     MOVE 'LETTER  '             TO BL-SOURCE-SCREEN
 11759     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
 11760*    MOVE 'ALWA'                 TO BL-PROC-ID
 11761     MOVE PI-COMPANY-ID          TO BL-COMP-ID
 11762*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
 11763     MOVE PI-ENCLOSURE-CD        TO BL-ENC-CD
 11764     IF PI-689-RESEND-DATE-1 NOT = LOW-VALUES
 11765        MOVE PI-689-RESEND-DATE-1 TO DC-BIN-DATE-1
 11766        MOVE ' '                 TO DC-OPTION-CODE
 11767        PERFORM 9500-LINK-DATE-CONVERT
 11768                                 THRU 9500-EXIT
 11769        IF NO-CONVERSION-ERROR
 11770           MOVE DC-GREG-DATE-B-EDIT
 11771                                 TO BL-RESEND-DT
 11772        END-IF
 11773     END-IF
 11774     IF PI-689-FOLLOW-UP-DATE NOT = LOW-VALUES
 11775        MOVE PI-689-FOLLOW-UP-DATE TO DC-BIN-DATE-1
 11776        MOVE ' '                 TO DC-OPTION-CODE
 11777        PERFORM 9500-LINK-DATE-CONVERT
 11778                                 THRU 9500-EXIT
 11779        IF NO-CONVERSION-ERROR
 11780           MOVE DC-GREG-DATE-B-EDIT
 11781                                 TO BL-FOLLOW-UP-DT
 11782        END-IF
 11783     END-IF
 11784*    MOVE IFF-COMMENTS           TO BL-COMMENTS
 11785*    MOVE 'TEST COMMENTS'        TO BL-COMMENTS
 11786     MOVE PI-CERT-FORM-ID        TO BL-CERT-FORM-ID
 11787     if eibaid = dfhpf7
 11788        move 'B'                 TO BL-WRITE-ERARCH
 11789     else
 11790        move 'T'                 to bl-write-erarch
 11791     end-if
 11792    DISPLAY ' ABOUT TO LINK TO NSRASBL '
 11793*****************************************
 11794* Invoke the LETTER business logic
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 243
* EL689.cbl
 11795*****************************************
 11796
 11797* exec cics link
 11798*       program('NSRASBL')
 11799*       commarea(srch-commarea)
 11800*    end-exec.
 11801     MOVE LENGTH OF
 11802      srch-commarea
 11803       TO DFHEIV11
 11804     MOVE 'NSRASBL' TO DFHEIV1
 11805*    MOVE '."C                   (   #00011471' TO DFHEIV0
 11806     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11808     MOVE X'2020233030303131343731' TO DFHEIV0(25:11)
 11809     CALL 'kxdfhei1' USING DFHEIV0,
 11810           DFHEIV1,
 11811           srch-commarea,
 11812           DFHEIV11,
 11813           DFHEIV99,
 11814           DFHEIV99,
 11815           DFHEIV99,
 11816           DFHEIV99
 11817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11818
 11819     DISPLAY ' MADE IT BACK FROM NSRASBL ' bl-status ' '
 11820        bl-message ' ' bl-archive-no
 11821     move bl-archive-no to w-arch-number
 11822
 11823     if eibaid = dfhpf7
 11824        PERFORM 5440-ADD-BILLING-NOTE THRU 5440-EXIT
 11825        MOVE ER-0280                TO EMI-ERROR
 11826        MOVE -1                     TO MAINTL
 11827        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11828        MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 11829        MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1)
 11830        MOVE '2'                    TO PI-ACTION
 11831        MOVE ZEROS                  TO PI-TOTAL-LINES
 11832                                       PI-CURRENT-LINE
 11833        MOVE SPACES                 TO PI-689-PRINT-SW
 11834                                       PI-689-FORM-NUMBER
 11835        GO TO 9300-DFHCLEAR
 11836     else
 11837        move w-arch-number          to archnumo
 11838        MOVE ER-1818                TO EMI-ERROR
 11839        MOVE -1                     TO MAINTL
 11840        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11841     end-if
 11842     MOVE -1                     TO MAINTL
 11843     GO TO 8200-SEND-DATAONLY
 11844     .
 11845 5400-EXIT.
 11846     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 244
* EL689.cbl
 11848 5410-CREATE-TEXT-RECORDS.
 11849
 11850*    EXEC CICS HANDLE CONDITION
 11851*         NOTOPEN   (8015-ARCT-NOT-OPEN)
 11852*         DUPREC    (5465-DUPLICATE-ARCH-TEXT)
 11853*    END-EXEC.
 11854*
 11855*    IF  PI-689-CREATE-NO-SCREENS
 11856*        IF  PI-689-GET-ARCT-MAIN
 11857*            EXEC CICS GETMAIN
 11858*                 SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 11859*                 LENGTH   (W-ARCT-LENGTH)
 11860*            END-EXEC
 11861*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF
 11862*                                    LETTER-ARCHIVE-TEXT
 11863*            MOVE LCP-WS-ADDR-COMP
 11864*                                TO PI-689-ARCT-POINTER
 11865*        ELSE
 11866*            MOVE PI-689-ARCT-POINTER
 11867*                                TO LCP-WS-ADDR-COMP
 11868*            SET ADDRESS OF LETTER-ARCHIVE-TEXT
 11869*                                TO LCP-WS-ADDR-PNTR
 11870*    ELSE
 11871*        EXEC CICS GETMAIN
 11872*             SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 11873*             LENGTH   (W-ARCT-LENGTH)
 11874*        END-EXEC.
 11875*
 11876*    PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 11877*
 11878*    MOVE ZEROS                  TO W-SEQ-CTR
 11879*
 11880*    IF  PI-CREATE-LABELS AND
 11881*        NOT PI-689-LABELS-OVERRIDEN
 11882*        MOVE '1'                TO LT-RECORD-TYPE
 11883*        MOVE +0                 TO LT-LINE-SEQ-NO
 11884*        PERFORM 5600-FORMAT-ADDRESS-LINE THRU 5600-EXIT
 11885*                VARYING
 11886*            W-RG-NDX FROM 1 BY 1
 11887*                UNTIL
 11888*            W-RG-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 11889*        PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11890*        PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT
 11891*    ELSE
 11892*        SET W-RG-NDX            TO +1.
 11893*
 11894*    SET LT-NDX                  TO W-ZEROS.
 11895*
 11896*    PERFORM 5500-FORMAT-TEXT THRU 5500-EXIT
 11897*            VARYING
 11898*        W-RG-NDX FROM W-RG-NDX BY +1
 11899*            UNTIL
 11900*        W-RG-NDX GREATER THAN PI-TOTAL-LINES.
 11901
 11902 5410-EXIT.
 11903     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 245
* EL689.cbl
 11905 5415-INITIALIZE-TEXT.
 11906
 11907     MOVE SPACES                 TO LETTER-ARCHIVE-TEXT.
 11908     MOVE 'LT'                   TO LT-RECORD-ID.
 11909
 11910     MOVE LA-ARCHIVE-NO          TO LT-ARCHIVE-NO.
 11911     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
 11912
 11913     MOVE ZEROS                  TO LT-LINE-SEQ-NO
 11914                                    LT-NUM-LINES-ON-RECORD.
 11915
 11916 5415-EXIT.
 11917     EXIT.
 11918
 11919 5440-ADD-BILLING-NOTE.
 11920
 11921     MOVE LOW-VALUES             TO W-ELEOBC-KEY
 11922     MOVE PI-COMPANY-CD          TO W-EOBC-COMPANY-CD
 11923     MOVE '5'                    TO W-EOBC-REC-TYPE
 11924
 11925
 11926* EXEC CICS STARTBR
 11927*        DATASET   ('ELEOBC')
 11928*        RIDFLD    (W-ELEOBC-KEY)
 11929*        GTEQ
 11930*        RESP      (W-RESPONSE)
 11931*    END-EXEC
 11932     MOVE 'ELEOBC' TO DFHEIV1
 11933     MOVE 0
 11934       TO DFHEIV11
 11935*    MOVE '&,         G          &  N#00011581' TO DFHEIV0
 11936     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11937     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11938     MOVE X'204E233030303131353831' TO DFHEIV0(25:11)
 11939     CALL 'kxdfhei1' USING DFHEIV0,
 11940           DFHEIV1,
 11941           W-ELEOBC-KEY,
 11942           DFHEIV99,
 11943           DFHEIV11,
 11944           DFHEIV99
 11945     MOVE EIBRESP  TO W-RESPONSE
 11946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11947
 11948     IF NOT RESP-NORMAL
 11949        GO TO 5440-EXIT
 11950     END-IF
 11951      .
 11952 5440-READNEXT-ELEOBC.
 11953
 11954
 11955* EXEC CICS READNEXT
 11956*       INTO    (EOB-CODES)
 11957*       DATASET ('ELEOBC')
 11958*       RIDFLD  (W-ELEOBC-KEY)
 11959*       RESP    (W-RESPONSE)
 11960*    END-EXEC
 11961     MOVE LENGTH OF
 11962      EOB-CODES
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 246
* EL689.cbl
 11963       TO DFHEIV12
 11964     MOVE 'ELEOBC' TO DFHEIV1
 11965     MOVE 0
 11966       TO DFHEIV11
 11967*    MOVE '&.IL                  )  N#00011594' TO DFHEIV0
 11968     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11969     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11970     MOVE X'204E233030303131353934' TO DFHEIV0(25:11)
 11971     CALL 'kxdfhei1' USING DFHEIV0,
 11972           DFHEIV1,
 11973           EOB-CODES,
 11974           DFHEIV12,
 11975           W-ELEOBC-KEY,
 11976           DFHEIV99,
 11977           DFHEIV11,
 11978           DFHEIV99,
 11979           DFHEIV99
 11980     MOVE EIBRESP  TO W-RESPONSE
 11981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11982
 11983     IF RESP-NORMAL
 11984         IF EO-RECORD-TYPE NOT = '5'
 11985             GO TO 5440-EXIT
 11986         END-IF
 11987     ELSE
 11988         GO TO 5440-EXIT
 11989     END-IF
 11990
 11991     IF EO-RECORD-TYPE = '5' AND
 11992        EO-EOB-CODE = PI-689-FORM-NUMBER
 11993           CONTINUE
 11994     ELSE
 11995         GO TO 5440-READNEXT-ELEOBC
 11996     END-IF
 11997
 11998     MOVE SPACES TO W-BILLING-NOTE
 11999     MOVE EO-DESCRIPTION TO W-BN-NOTE
 12000     MOVE PI-689-FORM-NUMBER TO W-BN-LTRID
 12001     MOVE W-SAVE-DATE TO W-BN-DATE
 12002     MOVE PI-PROCESSOR-ID TO W-BN-USERID
 12003     MOVE +25 TO W-LEN
 12004
 12005     PERFORM 5441-UPDATE-BILLING-NOTE THRU 5441-EXIT
 12006     .
 12007 5440-EXIT.
 12008     EXIT.
 12009
 12010 5441-UPDATE-BILLING-NOTE.
 12011
 12012     MOVE PI-COMPANY-CD          TO W-SV-COMPANY-CD
 12013     MOVE PI-689-CARRIER         TO W-SV-CARRIER
 12014     MOVE PI-689-GROUPING        TO W-SV-GROUPING
 12015     MOVE PI-689-STATE           TO W-SV-STATE
 12016     MOVE PI-689-ACCOUNT         TO W-SV-ACCOUNT
 12017     MOVE PI-689-EFF-DATE        TO W-SV-CERT-EFF-DT
 12018     MOVE PI-689-CERT-PRIME      TO W-SV-CERT-PRIME
 12019     MOVE PI-689-CERT-SFX        TO W-SV-CERT-SFX
 12020     MOVE W-SAVE-KEY             TO W-ERNOTE-KEY
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 247
* EL689.cbl
 12021
 12022
 12023* EXEC CICS READ
 12024*       DATASET    (W-NOTE-FILE-ID)
 12025*       RIDFLD     (W-ERNOTE-KEY)
 12026*       INTO       (CERTIFICATE-NOTE)
 12027*       RESP       (W-RESPONSE)
 12028*       UPDATE
 12029*    END-EXEC
 12030     MOVE LENGTH OF
 12031      CERTIFICATE-NOTE
 12032       TO DFHEIV11
 12033*    MOVE '&"IL       EU         (  N#00011640' TO DFHEIV0
 12034     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12035     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12036     MOVE X'204E233030303131363430' TO DFHEIV0(25:11)
 12037     CALL 'kxdfhei1' USING DFHEIV0,
 12038           W-NOTE-FILE-ID,
 12039           CERTIFICATE-NOTE,
 12040           DFHEIV11,
 12041           W-ERNOTE-KEY,
 12042           DFHEIV99,
 12043           DFHEIV99,
 12044           DFHEIV99
 12045     MOVE EIBRESP  TO W-RESPONSE
 12046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12047
 12048     IF RESP-NORMAL
 12049       IF CN-BILLING-START-LINE-NO NOT NUMERIC
 12050          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 12051       END-IF
 12052       IF CN-BILLING-END-LINE-NO NOT NUMERIC
 12053          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 12054       END-IF
 12055       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 12056           (NOTE-SUB > +10) OR
 12057           (CN-LINE (NOTE-SUB) (1:W-LEN) =
 12058                             W-BILLING-NOTE (1:W-LEN))
 12059       END-PERFORM
 12060       IF CN-LINE (NOTE-SUB) (1:W-LEN) =
 12061                              W-BILLING-NOTE (1:W-LEN)
 12062
 12063* EXEC CICS UNLOCK
 12064*           DATASET    (W-NOTE-FILE-ID)
 12065*        END-EXEC
 12066*    MOVE '&*                    #   #00011662' TO DFHEIV0
 12067     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12068     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12069     MOVE X'2020233030303131363632' TO DFHEIV0(25:11)
 12070     CALL 'kxdfhei1' USING DFHEIV0,
 12071           W-NOTE-FILE-ID,
 12072           DFHEIV99
 12073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12074       ELSE
 12075         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 12076           (NOTE-SUB > +10) OR
 12077           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
 12078         END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 248
* EL689.cbl
 12079         IF (NOTE-SUB < +11)
 12080           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
 12081              NOTE-SUB <= CN-BILLING-END-LINE-NO
 12082                MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 12083           ELSE
 12084             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 12085              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
 12086                MOVE W-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
 12087                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
 12088             ELSE
 12089               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 12090                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
 12091                     MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 12092                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
 12093               ELSE
 12094                 IF (CN-BILLING-END-LINE-NO = ZEROS)
 12095                   MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
 12096                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
 12097                                       CN-BILLING-START-LINE-NO
 12098                 ELSE
 12099                    PERFORM 5442-SQUEEZE-IT-IN THRU 5442-EXIT
 12100                 END-IF
 12101               END-IF
 12102             END-IF
 12103           END-IF
 12104           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 12105           MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 12106           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12107
 12108* EXEC CICS REWRITE
 12109*             DATASET    (W-NOTE-FILE-ID)
 12110*             FROM       (CERTIFICATE-NOTE)
 12111*             RESP       (W-RESPONSE)
 12112*          END-EXEC
 12113     MOVE LENGTH OF
 12114      CERTIFICATE-NOTE
 12115       TO DFHEIV11
 12116*    MOVE '&& L                  %  N#00011698' TO DFHEIV0
 12117     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12118     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12119     MOVE X'204E233030303131363938' TO DFHEIV0(25:11)
 12120     CALL 'kxdfhei1' USING DFHEIV0,
 12121           W-NOTE-FILE-ID,
 12122           CERTIFICATE-NOTE,
 12123           DFHEIV11,
 12124           DFHEIV99
 12125     MOVE EIBRESP  TO W-RESPONSE
 12126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12127           PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12128         END-IF
 12129       END-IF
 12130     ELSE
 12131        MOVE SPACES              TO CERTIFICATE-NOTE
 12132        MOVE 'CN'                TO CN-RECORD-ID
 12133        MOVE W-SAVE-KEY          TO CN-CONTROL-PRIMARY
 12134                                    W-ERNOTE-KEY
 12135        MOVE 01                  TO CN-BILLING-START-LINE-NO
 12136                                    CN-BILLING-END-LINE-NO
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 249
* EL689.cbl
 12137        MOVE W-BILLING-NOTE      TO CN-LINE (01)
 12138        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 12139        MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 12140        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12141
 12142* EXEC CICS WRITE
 12143*          DATASET    (W-NOTE-FILE-ID)
 12144*          FROM       (CERTIFICATE-NOTE)
 12145*          RIDFLD     (W-ERNOTE-KEY)
 12146*          RESP       (W-RESPONSE)
 12147*       END-EXEC
 12148     MOVE LENGTH OF
 12149      CERTIFICATE-NOTE
 12150       TO DFHEIV11
 12151*    MOVE '&$ L                  ''  N#00011717' TO DFHEIV0
 12152     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12153     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12154     MOVE X'204E233030303131373137' TO DFHEIV0(25:11)
 12155     CALL 'kxdfhei1' USING DFHEIV0,
 12156           W-NOTE-FILE-ID,
 12157           CERTIFICATE-NOTE,
 12158           DFHEIV11,
 12159           W-ERNOTE-KEY,
 12160           DFHEIV99,
 12161           DFHEIV99
 12162     MOVE EIBRESP  TO W-RESPONSE
 12163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12164
 12165        PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12166     END-IF
 12167
 12168     .
 12169 5441-EXIT.
 12170     EXIT.
 12171
 12172
 12173 5442-SQUEEZE-IT-IN.
 12174
 12175     IF NOTE-SUB < CN-BILLING-START-LINE-NO
 12176        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
 12177           NOTE-SUB = +10
 12178           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
 12179           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
 12180             MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
 12181             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
 12182             MOVE +9 TO NOTE-SUB
 12183           END-IF
 12184        END-PERFORM
 12185     ELSE
 12186        IF NOTE-SUB > CN-BILLING-END-LINE-NO
 12187           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
 12188             UNTIL NOTE-SUB = +1
 12189             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
 12190             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
 12191                MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
 12192                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
 12193                MOVE +2          TO NOTE-SUB
 12194             END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 250
* EL689.cbl
 12195           END-PERFORM
 12196        END-IF
 12197     END-IF
 12198
 12199     .
 12200 5442-EXIT.
 12201     EXIT.
 12202
 12203 5445-CERTIFICATE-UPDATE.
 12204
 12205     MOVE W-SAVE-KEY         TO W-CERT-KEY
 12206
 12207
 12208* EXEC CICS READ
 12209*        DATASET  (W-CERT-FILE-ID)
 12210*        RIDFLD   (W-CERT-KEY)
 12211*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 12212*        RESP     (W-RESPONSE)
 12213*        UPDATE
 12214*    END-EXEC
 12215*    MOVE '&"S        EU         (  N#00011766' TO DFHEIV0
 12216     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12217     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12218     MOVE X'204E233030303131373636' TO DFHEIV0(25:11)
 12219     CALL 'kxdfhei1' USING DFHEIV0,
 12220           W-CERT-FILE-ID,
 12221           DFHEIV20,
 12222           DFHEIV99,
 12223           W-CERT-KEY,
 12224           DFHEIV99,
 12225           DFHEIV99,
 12226           DFHEIV99
 12227     SET ADDRESS OF CERTIFICATE-MASTER TO
 12228         DFHEIV20
 12229     MOVE EIBRESP  TO W-RESPONSE
 12230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12231
 12232     IF RESP-NORMAL
 12233        EVALUATE CM-NOTE-SW
 12234           WHEN '2'
 12235           WHEN '3'
 12236           WHEN '6'
 12237           WHEN '7'
 12238              SET NO-CERT-RW     TO TRUE
 12239           WHEN ' '
 12240              MOVE '2'           TO CM-NOTE-SW
 12241           WHEN '1'
 12242              MOVE '3'           TO CM-NOTE-SW
 12243           WHEN '4'
 12244              MOVE '6'           TO CM-NOTE-SW
 12245           WHEN '5'
 12246              MOVE '7'           TO CM-NOTE-SW
 12247        END-EVALUATE
 12248     END-IF
 12249     IF NOT NO-CERT-RW
 12250
 12251* EXEC CICS REWRITE
 12252*          FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 251
* EL689.cbl
 12253*          DATASET  (W-CERT-FILE-ID)
 12254*          RESP     (W-RESPONSE)
 12255*       END-EXEC
 12256     MOVE LENGTH OF
 12257      CERTIFICATE-MASTER
 12258       TO DFHEIV11
 12259*    MOVE '&& L                  %  N#00011792' TO DFHEIV0
 12260     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12261     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12262     MOVE X'204E233030303131373932' TO DFHEIV0(25:11)
 12263     CALL 'kxdfhei1' USING DFHEIV0,
 12264           W-CERT-FILE-ID,
 12265           CERTIFICATE-MASTER,
 12266           DFHEIV11,
 12267           DFHEIV99
 12268     MOVE EIBRESP  TO W-RESPONSE
 12269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12270     ELSE
 12271
 12272* EXEC CICS UNLOCK
 12273*          DATASET  (W-CERT-FILE-ID)
 12274*       END-EXEC
 12275*    MOVE '&*                    #   #00011798' TO DFHEIV0
 12276     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12277     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12278     MOVE X'2020233030303131373938' TO DFHEIV0(25:11)
 12279     CALL 'kxdfhei1' USING DFHEIV0,
 12280           W-CERT-FILE-ID,
 12281           DFHEIV99
 12282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12283     END-IF
 12284
 12285     .
 12286 5445-EXIT.
 12287     EXIT.
 12288
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 252
* EL689.cbl
 12290 5460-DUPLICATE-ARCHIVE-RCD.
 12291
 12292     IF  NOT PI-689-CREATE-NO-SCREENS
 12293
 12294* EXEC CICS SYNCPOINT ROLLBACK
 12295*        END-EXEC.
 12296*    MOVE '6"R                   !   #00011811' TO DFHEIV0
 12297     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12298     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12299     MOVE X'2020233030303131383131' TO DFHEIV0(25:11)
 12300     CALL 'kxdfhei1' USING DFHEIV0
 12301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12302
 12303
 12304     MOVE ER-9426                TO EMI-ERROR.
 12305     MOVE -1                     TO MAINTL.
 12306     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12307     GO TO 8200-SEND-DATAONLY.
 12308
 12309 5465-DUPLICATE-ARCH-TEXT.
 12310
 12311     IF  NOT PI-689-CREATE-NO-SCREENS
 12312
 12313* EXEC CICS SYNCPOINT ROLLBACK
 12314*        END-EXEC.
 12315*    MOVE '6"R                   !   #00011822' TO DFHEIV0
 12316     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12317     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12318     MOVE X'2020233030303131383232' TO DFHEIV0(25:11)
 12319     CALL 'kxdfhei1' USING DFHEIV0
 12320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12321
 12322
 12323     MOVE ER-7369                TO EMI-ERROR.
 12324     MOVE -1                     TO MAINTL.
 12325     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12326     GO TO 8200-SEND-DATAONLY.
 12327
 12328 5470-CNTL-NOT-FOUND.
 12329
 12330     MOVE ER-9299                TO EMI-ERROR.
 12331     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12332     MOVE -1                     TO MAINTL.
 12333     MOVE AL-UANON               TO MAINTA.
 12334     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 253
* EL689.cbl
 12336 5500-FORMAT-TEXT.
 12337
 12338     SET LT-NDX UP BY +1.
 12339
 12340     IF  W-RC-TEXT (W-RG-NDX) EQUAL W-TOP-FORM
 12341         SET W-RG-NDX UP BY 1
 12342         MOVE 99                 TO LT-SKIP-CONTROL (LT-NDX)
 12343         MOVE W-RC-TEXT (W-RG-NDX)
 12344                                 TO LT-TEXT-LINE (LT-NDX)
 12345     ELSE
 12346         IF  W-RC-TEXT (W-RG-NDX) EQUAL SPACES
 12347             MOVE ZEROS          TO W-PRINT-CONTROL
 12348             PERFORM 5505-FIND-USED-LINE THRU 5505-EXIT
 12349                     VARYING
 12350                 W-RG-NDX FROM W-RG-NDX BY 1
 12351                     UNTIL
 12352                 W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12353                     OR
 12354                 W-RC-TEXT (W-RG-NDX) GREATER THAN SPACES
 12355             IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12356                 GO TO 5500-WRITE-TEST
 12357             ELSE
 12358                 MOVE W-PRINT-CONTROL
 12359                                 TO LT-SKIP-CONTROL (LT-NDX)
 12360                 MOVE W-RC-TEXT (W-RG-NDX)
 12361                                 TO LT-TEXT-LINE (LT-NDX)
 12362         ELSE
 12363             MOVE W-RC-TEXT (W-RG-NDX)
 12364                                 TO LT-TEXT-LINE (LT-NDX)
 12365             MOVE ZEROS          TO W-PRINT-CONTROL.
 12366
 12367     ADD +1                      TO LT-NUM-LINES-ON-RECORD.
 12368
 12369 5500-WRITE-TEST.
 12370
 12371     IF  W-RG-NDX NOT LESS THAN PI-TOTAL-LINES
 12372         IF  LT-TEXT-RECORD NOT EQUAL SPACES
 12373             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12374             MOVE '2'            TO LT-RECORD-TYPE
 12375             ADD +1              TO W-SEQ-CTR
 12376             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12377             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12378         ELSE
 12379             NEXT SENTENCE
 12380     ELSE
 12381         IF  LT-NDX EQUAL +20
 12382             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12383             MOVE '2'            TO LT-RECORD-TYPE
 12384             ADD +1              TO W-SEQ-CTR
 12385             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12386             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12387             SET LT-NDX          TO W-ZEROS
 12388             PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 12389
 12390 5500-EXIT.
 12391      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 254
* EL689.cbl
 12393 5505-FIND-USED-LINE.
 12394
 12395     ADD +1                      TO W-PRINT-CONTROL.
 12396
 12397 5505-EXIT.
 12398      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 255
* EL689.cbl
 12400 5600-FORMAT-ADDRESS-LINE.
 12401
 12402     SET LT-NDX                  TO W-RG-NDX.
 12403     MOVE W-RC-TEXT (W-RG-NDX)   TO LT-TEXT-LINE (LT-NDX).
 12404
 12405 5600-EXIT.
 12406     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 256
* EL689.cbl
 12408 5650-WRITE-ARCHIVE.
 12409
 12410
 12411* EXEC CICS WRITE
 12412*         DATASET   (W-ARCH-FILE-ID)
 12413*         FROM      (LETTER-ARCHIVE)
 12414*         RIDFLD    (LA-CONTROL-PRIMARY)
 12415*    END-EXEC.
 12416     MOVE LENGTH OF
 12417      LETTER-ARCHIVE
 12418       TO DFHEIV11
 12419*    MOVE '&$ L                  ''   #00011912' TO DFHEIV0
 12420     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12421     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12422     MOVE X'2020233030303131393132' TO DFHEIV0(25:11)
 12423     CALL 'kxdfhei1' USING DFHEIV0,
 12424           W-ARCH-FILE-ID,
 12425           LETTER-ARCHIVE,
 12426           DFHEIV11,
 12427           LA-CONTROL-PRIMARY,
 12428           DFHEIV99,
 12429           DFHEIV99
 12430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12431
 12432
 12433 5650-EXIT.
 12434     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 257
* EL689.cbl
 12436 5655-WRITE-ARCHIVE-TEXT.
 12437
 12438
 12439* EXEC CICS WRITE
 12440*         DATASET   (W-ARCT-FILE-ID)
 12441*         FROM      (LETTER-ARCHIVE-TEXT)
 12442*         RIDFLD    (LT-CONTROL-PRIMARY)
 12443*    END-EXEC.
 12444     MOVE LENGTH OF
 12445      LETTER-ARCHIVE-TEXT
 12446       TO DFHEIV11
 12447*    MOVE '&$ L                  ''   #00011923' TO DFHEIV0
 12448     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12449     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12450     MOVE X'2020233030303131393233' TO DFHEIV0(25:11)
 12451     CALL 'kxdfhei1' USING DFHEIV0,
 12452           W-ARCT-FILE-ID,
 12453           LETTER-ARCHIVE-TEXT,
 12454           DFHEIV11,
 12455           LT-CONTROL-PRIMARY,
 12456           DFHEIV99,
 12457           DFHEIV99
 12458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12459
 12460
 12461 5655-EXIT.
 12462     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 258
* EL689.cbl
 12464 6000-RESOLVE-VARIABLES.
 12465***************************************************************
 12466*    THIS ROUTINE WILL FORMAT THE SYSTEM DEFINED SYMBOLS      *
 12467*    WITH DATA PERTAINING TO THE FORM WITH VARIABLES.         *
 12468*    THIS ROUTINE IS PERFORM THRU 6000-EXIT IN ORDER TO       *
 12469*    RESOLVE ALL OF THE SYMBOLS.                              *
 12470*                                                             *
 12471***************************************************************
 12472
 12473     PERFORM 6200-GET-COMPANY-DATA THRU 6200-EXIT.
 12474     PERFORM 6250-GET-CNTL2-DATA THRU 6250-EXIT.
 12475     PERFORM 6400-GET-PENDING-DATA THRU 6400-EXIT.
 12476     PERFORM 6450-GET-CERT-DATA THRU 6450-EXIT.
 12477     PERFORM 6500-GET-ACCOUNT-DATA THRU 6500-EXIT
 12478*    PERFORM 6350-GET-CSR-DATA   THRU 6350-EXIT
 12479     PERFORM 6600-GET-COMPENSATION-DATA THRU 6600-EXIT.
 12480     PERFORM 6700-GET-MAIL-DATA THRU 6700-EXIT.
 12481     PERFORM 6300-GET-CARRIER-DATA THRU 6300-EXIT.
 12482     PERFORM 6750-GET-LIFE-BENEFIT-DATA THRU 6750-EXIT.
 12483     PERFORM 6800-GET-A-H-BENEFIT-DATA THRU 6800-EXIT.
 12484     PERFORM 6850-GET-CHECK-DATA THRU 6850-EXIT.
 12485     PERFORM 6900-GET-PYAJ-DATA THRU 6900-EXIT.
 12486     PERFORM 6950-MOVE-SYSTEM-DATA THRU 6950-EXIT.
 12487
 12488     MOVE SPACES                 TO W-REVERSE-DATE-SW.
 12489
 12490 6000-EXIT.
 12491     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 259
* EL689.cbl
 12493 6200-GET-COMPANY-DATA.
 12494
 12495     IF  ADDRSI EQUAL '3'
 12496             AND
 12497         PI-CREATE-LABELS
 12498             AND
 12499         NOT PI-689-LABELS-OVERRIDEN
 12500         NEXT SENTENCE
 12501     ELSE
 12502         IF  W-FILE-NOT-USED (1)
 12503             GO TO 6200-EXIT.
 12504
 12505     MOVE SPACES                 TO W-CNTL-KEY.
 12506     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12507     MOVE +0                     TO W-CNTL-SEQ-NO.
 12508     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 12509
 12510
 12511* EXEC CICS HANDLE CONDITION
 12512*         NOTOPEN   (8040-CNTL-NOT-OPEN)
 12513*         NOTFND    (6200-CNTL1-NOT-FOUND)
 12514*    END-EXEC.
 12515*    MOVE '"$JI                  ! + #00011978' TO DFHEIV0
 12516     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12517     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12518     MOVE X'2B20233030303131393738' TO DFHEIV0(25:11)
 12519     CALL 'kxdfhei1' USING DFHEIV0
 12520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12521
 12522
 12523
 12524* EXEC CICS READ
 12525*         DATASET   (W-CNTL-FILE-ID)
 12526*         SET       (ADDRESS OF CONTROL-FILE)
 12527*         RIDFLD    (W-CNTL-KEY)
 12528*    END-EXEC.
 12529*    MOVE '&"S        E          (   #00011983' TO DFHEIV0
 12530     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12531     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12532     MOVE X'2020233030303131393833' TO DFHEIV0(25:11)
 12533     CALL 'kxdfhei1' USING DFHEIV0,
 12534           W-CNTL-FILE-ID,
 12535           DFHEIV20,
 12536           DFHEIV99,
 12537           W-CNTL-KEY,
 12538           DFHEIV99,
 12539           DFHEIV99,
 12540           DFHEIV99
 12541     SET ADDRESS OF CONTROL-FILE TO
 12542         DFHEIV20
 12543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12544
 12545
 12546     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12547     MOVE CF-CL-MAIL-TO-NAME     TO W-LABEL-LINES (1)
 12548                                    W-VG-TEXT (25).
 12549     MOVE CF-CL-IN-CARE-OF       TO W-LABEL-LINES (2).
 12550     MOVE CF-CL-ADDR-LINE-1      TO W-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 260
* EL689.cbl
 12551     MOVE CF-CL-ADDR-LINE-2      TO W-LABEL-LINES (4).
 12552     MOVE CF-CL-CITY-STATE       TO W-LABEL-LINES (5).
 12553
 12554     IF  CF-CL-CAN-POST-CODE
 12555         MOVE CF-CL-CANADIAN-POSTAL-CODE
 12556                                 TO W-CANADIAN-POSTAL-CODES
 12557         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12558         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12559         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12560                                    W-LAB-CAN-FILLER (6)
 12561         GO TO 6200-CONTINUE.
 12562
 12563     IF CF-CL-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 12564         MOVE CF-CL-ZIP-CODE     TO W-WORK-ZIP
 12565         MOVE SPACES             TO W-LABEL-ZIP (6)
 12566         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12567
 12568         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12569             MOVE '-'            TO W-LABEL-DASH (6)
 12570             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12571             GO TO 6200-CONTINUE
 12572         ELSE
 12573             MOVE SPACES         TO W-LABEL-DASH (6)
 12574                                    W-LABEL-2ND-ZIP (6)
 12575             GO TO 6200-CONTINUE.
 12576
 12577     IF  CF-CL-ZIP-CODE-NUM NOT NUMERIC
 12578         GO TO 6200-CONTINUE.
 12579
 12580     MOVE CF-CL-ZIP-CODE-NUM     TO W-WORK-ZIP-NUMERIC.
 12581
 12582     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 12583         COMPUTE W-WORK-ZIP-NUMERIC
 12584             = W-WORK-ZIP-NUMERIC * 10000.
 12585
 12586     MOVE SPACES                 TO W-LABEL-ZIP (6).
 12587     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 12588
 12589     IF  W-WORK-ZIP4 GREATER THAN '0000'
 12590         MOVE '-'                TO W-LABEL-DASH (6)
 12591         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 12592         GO TO 6200-CONTINUE
 12593     ELSE
 12594         MOVE SPACES             TO W-LABEL-DASH (6)
 12595                                    W-LABEL-2ND-ZIP (6)
 12596         GO TO 6200-CONTINUE.
 12597
 12598 6200-CONTINUE.
 12599
 12600     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12601
 12602     IF  ADDRSI EQUAL '3'
 12603             AND
 12604         PI-CREATE-LABELS
 12605             AND
 12606         NOT PI-689-LABELS-OVERRIDEN
 12607         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (1)
 12608         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (2)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 261
* EL689.cbl
 12609         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (3)
 12610         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (04)
 12611         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (5)
 12612         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (6)
 12613         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12614         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12615         SET W-RG-NDX UP BY +1
 12616     ELSE
 12617         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (1)
 12618         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (2)
 12619         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (3)
 12620         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (4)
 12621         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (5)
 12622         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (6).
 12623
 12624     GO TO 6200-EXIT.
 12625
 12626 6200-CNTL1-NOT-FOUND.
 12627
 12628     MOVE ER-9299                TO EMI-ERROR.
 12629     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12630     MOVE -1                     TO ADDRSL.
 12631     MOVE AL-UANON               TO ADDRSA.
 12632     GO TO 8200-SEND-DATAONLY.
 12633
 12634 6200-EXIT.
 12635     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 262
* EL689.cbl
 12637 6250-GET-CNTL2-DATA.
 12638
 12639     IF  PI-PROCESSOR-ID EQUAL W-LGXX-ID
 12640         GO TO 6250-EXIT.
 12641
 12642     IF  W-FILE-NOT-USED (11)
 12643         GO TO 6250-EXIT.
 12644
 12645     MOVE SPACES                 TO W-CNTL-KEY.
 12646     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12647     MOVE +0                     TO W-CNTL-SEQ-NO.
 12648     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 12649     MOVE PI-PROCESSOR-ID        TO W-CNTL-GENL.
 12650
 12651
 12652* EXEC CICS HANDLE CONDITION
 12653*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12654*         NOTFND     (6250-CNTL2-NOT-FOUND)
 12655*    END-EXEC.
 12656*    MOVE '"$JI                  ! , #00012094' TO DFHEIV0
 12657     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12658     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12659     MOVE X'2C20233030303132303934' TO DFHEIV0(25:11)
 12660     CALL 'kxdfhei1' USING DFHEIV0
 12661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12662
 12663
 12664
 12665* EXEC CICS READ
 12666*         DATASET    (W-CNTL-FILE-ID)
 12667*         SET        (ADDRESS OF CONTROL-FILE)
 12668*         RIDFLD     (W-CNTL-KEY)
 12669*    END-EXEC.
 12670*    MOVE '&"S        E          (   #00012099' TO DFHEIV0
 12671     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12672     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12673     MOVE X'2020233030303132303939' TO DFHEIV0(25:11)
 12674     CALL 'kxdfhei1' USING DFHEIV0,
 12675           W-CNTL-FILE-ID,
 12676           DFHEIV20,
 12677           DFHEIV99,
 12678           W-CNTL-KEY,
 12679           DFHEIV99,
 12680           DFHEIV99,
 12681           DFHEIV99
 12682     SET ADDRESS OF CONTROL-FILE TO
 12683         DFHEIV20
 12684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12685
 12686
 12687     MOVE CF-PROCESSOR           TO W-VG-TEXT (153).
 12688     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (151).
 12689     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (152).
 12690     GO TO 6250-EXIT.
 12691
 12692 6250-CNTL2-NOT-FOUND.
 12693
 12694     MOVE ER-9299                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 263
* EL689.cbl
 12695     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12696     MOVE -1                     TO MAINTL.
 12697     MOVE AL-UANON               TO MAINTA.
 12698     GO TO 8200-SEND-DATAONLY.
 12699
 12700 6250-EXIT.
 12701     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 264
* EL689.cbl
 12703 6300-GET-CARRIER-DATA.
 12704
 12705     IF  ADDRSI EQUAL '2'
 12706             AND
 12707         PI-CREATE-LABELS
 12708             AND
 12709         NOT PI-689-LABELS-OVERRIDEN
 12710         NEXT SENTENCE
 12711     ELSE
 12712         IF  W-FILE-NOT-USED (4)
 12713             GO TO 6300-EXIT.
 12714
 12715     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
 12716         MOVE SPACES             TO W-CNTL-KEY
 12717         MOVE PI-COMPANY-ID      TO W-CNTL-COMPANY-ID
 12718         MOVE +0                 TO W-CNTL-SEQ-NO
 12719         MOVE '6'                TO W-CNTL-RECORD-TYPE
 12720         MOVE PI-689-CARRIER     TO W-CNTL-GEN4
 12721     ELSE
 12722         MOVE ER-9327            TO EMI-ERROR
 12723         MOVE -1                 TO CARRIERL
 12724         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12725         GO TO 6300-EXIT.
 12726
 12727
 12728* EXEC CICS HANDLE CONDITION
 12729*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12730*         NOTFND     (6300-CNTL6-NOT-FOUND)
 12731*    END-EXEC.
 12732*    MOVE '"$JI                  ! - #00012145' TO DFHEIV0
 12733     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12734     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12735     MOVE X'2D20233030303132313435' TO DFHEIV0(25:11)
 12736     CALL 'kxdfhei1' USING DFHEIV0
 12737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12738
 12739
 12740
 12741* EXEC CICS READ
 12742*         DATASET    (W-CNTL-FILE-ID)
 12743*         SET        (ADDRESS OF CONTROL-FILE)
 12744*         RIDFLD     (W-CNTL-KEY)
 12745*    END-EXEC.
 12746*    MOVE '&"S        E          (   #00012150' TO DFHEIV0
 12747     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12748     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12749     MOVE X'2020233030303132313530' TO DFHEIV0(25:11)
 12750     CALL 'kxdfhei1' USING DFHEIV0,
 12751           W-CNTL-FILE-ID,
 12752           DFHEIV20,
 12753           DFHEIV99,
 12754           W-CNTL-KEY,
 12755           DFHEIV99,
 12756           DFHEIV99,
 12757           DFHEIV99
 12758     SET ADDRESS OF CONTROL-FILE TO
 12759         DFHEIV20
 12760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 265
* EL689.cbl
 12761
 12762
 12763     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12764     MOVE CF-MAIL-TO-NAME        TO W-LABEL-LINES (1).
 12765     MOVE CF-IN-CARE-OF          TO W-LABEL-LINES (2).
 12766     MOVE CF-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 12767     MOVE CF-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 12768     MOVE CF-CITY-STATE          TO W-LABEL-LINES (5).
 12769
 12770     IF  CF-CANADIAN-POST-CODE
 12771         MOVE CF-CANADIAN-POSTAL-CODE
 12772                                 TO W-CANADIAN-POSTAL-CODES
 12773         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12774         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12775         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12776                                    W-LAB-CAN-FILLER (6)
 12777         GO TO 6300-CONTINUE.
 12778
 12779     IF CF-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 12780         MOVE CF-ZIP-CODE        TO W-WORK-ZIP
 12781         MOVE SPACES             TO W-LABEL-ZIP (6)
 12782         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12783         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12784             MOVE '-'            TO W-LABEL-DASH (6)
 12785             MOVE W-WORK-ZIP4
 12786                                 TO W-LABEL-2ND-ZIP (6)
 12787             GO TO 6300-CONTINUE
 12788         ELSE
 12789             MOVE SPACES         TO W-LABEL-DASH (6)
 12790                                    W-LABEL-2ND-ZIP (6)
 12791             GO TO 6300-CONTINUE.
 12792
 12793     IF  CF-ZIP-CODE-NUM NOT NUMERIC
 12794         GO TO 6300-CONTINUE.
 12795
 12796     MOVE CF-ZIP-CODE-NUM TO W-WORK-ZIP-NUMERIC.
 12797
 12798     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 12799         COMPUTE W-WORK-ZIP-NUMERIC
 12800             = W-WORK-ZIP-NUMERIC * 10000.
 12801
 12802     MOVE SPACES                 TO W-LABEL-ZIP (6).
 12803     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 12804
 12805     IF  W-WORK-ZIP4 GREATER THAN '0000'
 12806         MOVE '-'                TO W-LABEL-DASH (6)
 12807         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 12808         GO TO 6300-CONTINUE
 12809     ELSE
 12810         MOVE SPACES             TO W-LABEL-DASH (6)
 12811                                    W-LABEL-2ND-ZIP (6)
 12812         GO TO 6300-CONTINUE.
 12813
 12814 6300-CONTINUE.
 12815
 12816     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12817
 12818     IF  ADDRSI EQUAL '2'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 266
* EL689.cbl
 12819             AND
 12820         PI-CREATE-LABELS
 12821             AND
 12822         NOT PI-689-LABELS-OVERRIDEN
 12823         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (20)
 12824         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (21)
 12825         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (22)
 12826         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (23)
 12827         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (24)
 12828         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (25)
 12829         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12830         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12831         SET W-RG-NDX UP BY +1
 12832     ELSE
 12833         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (20)
 12834         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (21)
 12835         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (22)
 12836         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (23)
 12837         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (24)
 12838         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (25).
 12839
 12840     IF  W-FULL-DATA
 12841         MOVE ZEROS              TO W-PHONE-IN
 12842         MOVE CF-PHONE-NO        TO W-PHONE-IN
 12843         MOVE W-PHI-AREA         TO W-PO-AREA
 12844         MOVE W-PHI-PFX          TO W-PO-PFX
 12845         MOVE W-PHI-SFX          TO W-PO-SFX
 12846         MOVE W-PHONE-OUT        TO W-VG-TEXT (26).
 12847
 12848     GO TO 6300-EXIT.
 12849
 12850 6300-CNTL6-NOT-FOUND.
 12851
 12852     MOVE ER-9298                TO EMI-ERROR.
 12853     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12854     MOVE -1                     TO ADDRSL.
 12855     MOVE AL-UANON               TO ADDRSA.
 12856     GO TO 8200-SEND-DATAONLY.
 12857
 12858 6300-EXIT.
 12859     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 267
* EL689.cbl
 12861 6350-GET-CSR-DATA.
 12862     IF W-VG-TEXT (148) (1:4) = '****' OR SPACES
 12863        GO TO 6350-EXIT
 12864     END-IF
 12865*    IF W-FILE-NOT-USED (11)
 12866*       GO TO 6350-EXIT
 12867*    END-IF
 12868     MOVE SPACES                 TO W-CNTL-KEY
 12869     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
 12870     MOVE +0                     TO W-CNTL-SEQ-NO
 12871     MOVE '2'                    TO W-CNTL-RECORD-TYPE
 12872     MOVE CO-CSR-CODE            TO W-CNTL-GENL
 12873
 12874* EXEC CICS HANDLE CONDITION
 12875*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12876*         NOTFND     (6350-CNTL2-NOT-FOUND)
 12877*    END-EXEC
 12878*    MOVE '"$JI                  ! . #00012266' TO DFHEIV0
 12879     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12881     MOVE X'2E20233030303132323636' TO DFHEIV0(25:11)
 12882     CALL 'kxdfhei1' USING DFHEIV0
 12883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12884
 12885* EXEC CICS READ
 12886*         DATASET    (W-CNTL-FILE-ID)
 12887*         SET        (ADDRESS OF CONTROL-FILE)
 12888*         RIDFLD     (W-CNTL-KEY)
 12889*    END-EXEC
 12890*    MOVE '&"S        E          (   #00012270' TO DFHEIV0
 12891     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12892     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12893     MOVE X'2020233030303132323730' TO DFHEIV0(25:11)
 12894     CALL 'kxdfhei1' USING DFHEIV0,
 12895           W-CNTL-FILE-ID,
 12896           DFHEIV20,
 12897           DFHEIV99,
 12898           W-CNTL-KEY,
 12899           DFHEIV99,
 12900           DFHEIV99,
 12901           DFHEIV99
 12902     SET ADDRESS OF CONTROL-FILE TO
 12903         DFHEIV20
 12904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12905     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 12906     GO TO 6350-EXIT
 12907     .
 12908 6350-CNTL2-NOT-FOUND.
 12909     MOVE ER-9299                TO EMI-ERROR.
 12910     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12911     MOVE -1                     TO MAINTL.
 12912     MOVE AL-UANON               TO MAINTA.
 12913     GO TO 8200-SEND-DATAONLY.
 12914 6350-EXIT.
 12915     EXIT.
 12916 6400-GET-PENDING-DATA.
 12917
 12918     IF (ADDRSI EQUAL '7')
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 268
* EL689.cbl
 12919        AND (PI-CREATE-LABELS)
 12920        AND (NOT PI-689-LABELS-OVERRIDEN)
 12921        CONTINUE
 12922     ELSE
 12923        IF PI-689-DATA-SOURCE = '4'
 12924           CONTINUE
 12925        ELSE
 12926           IF W-FILE-NOT-USED (9)
 12927              GO TO 6400-EXIT
 12928           END-IF
 12929        END-IF
 12930     END-IF
 12931     IF  W-PNDB-ENTRY EQUAL LOW-VALUES
 12932         MOVE ER-9327            TO EMI-ERROR
 12933         MOVE -1                 TO MAINTL
 12934         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12935         GO TO 6400-EXIT.
 12936
 12937 6400-READ-PNDB-ONLY.
 12938
 12939
 12940* EXEC CICS HANDLE CONDITION
 12941*         NOTOPEN (8060-PNDB-NOT-OPEN)
 12942*         NOTFND  (8070-PNDB-NOT-FOUND)
 12943*    END-EXEC.
 12944*    MOVE '"$JI                  ! / #00012309' TO DFHEIV0
 12945     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12946     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12947     MOVE X'2F20233030303132333039' TO DFHEIV0(25:11)
 12948     CALL 'kxdfhei1' USING DFHEIV0
 12949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12950
 12951
 12952
 12953* EXEC CICS READ
 12954*         DATASET (W-PNDB-FILE-ID)
 12955*         SET     (ADDRESS OF PENDING-BUSINESS)
 12956*         RIDFLD  (W-PNDB-KEY)
 12957*    END-EXEC.
 12958*    MOVE '&"S        E          (   #00012314' TO DFHEIV0
 12959     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12960     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12961     MOVE X'2020233030303132333134' TO DFHEIV0(25:11)
 12962     CALL 'kxdfhei1' USING DFHEIV0,
 12963           W-PNDB-FILE-ID,
 12964           DFHEIV20,
 12965           DFHEIV99,
 12966           W-PNDB-KEY,
 12967           DFHEIV99,
 12968           DFHEIV99,
 12969           DFHEIV99
 12970     SET ADDRESS OF PENDING-BUSINESS TO
 12971         DFHEIV20
 12972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12973
 12974
 12975     MOVE 'Y'                    TO W-PNDB-FOUND-SW.
 12976
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 269
* EL689.cbl
 12977     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 12978         MOVE PB-SV-CARRIER      TO PB-CARRIER
 12979                                    PI-689-CARRIER
 12980         MOVE PB-SV-GROUPING     TO PB-GROUPING
 12981                                    PI-689-GROUPING
 12982         MOVE PB-SV-STATE        TO PB-STATE
 12983                                    PI-689-STATE
 12984         MOVE PB-CONTROL-BY-ACCOUNT
 12985                                 TO W-CERT-KEY
 12986                                    W-MAIL-KEY
 12987                                    W-ACCT-KEY
 12988         MOVE PB-ACCOUNT         TO PI-689-ACCOUNT
 12989         MOVE PB-CERT-EFF-DT     TO PI-689-EFF-DATE
 12990         MOVE PB-CERT-NO         TO PI-689-CERT-NO.
 12991
 12992 6400-ONLY-STOP.
 12993
 12994     MOVE PB-ENTRY-BATCH         TO W-VG-TEXT (130).
 12995
 12996     IF  NOT PB-ISSUE
 12997         GO TO 6400-CANCEL.
 12998
 12999     MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1.
 13000     MOVE SPACES                 TO DC-OPTION-CODE.
 13001     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13002
 13003     IF  NO-CONVERSION-ERROR
 13004         MOVE DC-GREG-DATE-1-EDIT
 13005                                 TO W-VG-TEXT (110).
 13006
 13007     MOVE PB-I-AGE               TO W-EDIT-3-0.
 13008     MOVE W-EDIT-3-0             TO W-VG-TEXT (124).
 13009     MOVE PB-I-LF-PREMIUM-AMT    TO W-EDIT-7-2.
 13010     MOVE W-EDIT-7-2             TO W-VG-TEXT (111).
 13011     MOVE PB-I-AH-PREMIUM-AMT    TO W-EDIT-7-2.
 13012     MOVE W-EDIT-7-2             TO W-VG-TEXT (112).
 13013     MOVE PB-I-LF-PREM-CALC      TO W-EDIT-7-2.
 13014     MOVE W-EDIT-7-2             TO W-VG-TEXT (113).
 13015     MOVE PB-I-AH-PREM-CALC      TO W-EDIT-7-2.
 13016     MOVE W-EDIT-7-2             TO W-VG-TEXT (114).
 13017     MOVE PB-I-LF-BENEFIT-AMT    TO W-EDIT-9-2.
 13018     MOVE W-EDIT-9-2             TO W-VG-TEXT (125).
 13019     MOVE PB-I-AH-BENEFIT-AMT    TO W-EDIT-7-2.
 13020     MOVE W-EDIT-7-2             TO W-VG-TEXT (126).
 13021     MOVE PB-I-LF-RATE           TO W-EDIT-2-5-S.
 13022     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (127).
 13023     MOVE PB-I-AH-RATE           TO W-EDIT-2-5-S.
 13024     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (128).
 13025     MOVE PB-I-LOAN-TERM         TO W-EDIT-3-0.
 13026     MOVE W-EDIT-3-0             TO W-VG-TEXT (129).
 13027
 13028     COMPUTE W-DIFFERENCE
 13029         = PB-I-LF-PREM-CALC - PB-I-LF-PREMIUM-AMT.
 13030
 13031     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13032     MOVE W-EDIT-7-2             TO W-VG-TEXT (115).
 13033
 13034     COMPUTE W-DIFFERENCE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 270
* EL689.cbl
 13035         = PB-I-AH-PREM-CALC - PB-I-AH-PREMIUM-AMT.
 13036
 13037     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13038     MOVE W-EDIT-7-2             TO W-VG-TEXT (116).
 13039
 13040 6400-CANCEL.
 13041
 13042     IF  NOT PB-CANCELLATION
 13043         GO TO 6400-EXIT.
 13044
 13045     MOVE PB-CI-AH-PRIOR-CANCEL-DT
 13046                                 TO DC-BIN-DATE-1.
 13047     MOVE SPACES                 TO DC-OPTION-CODE.
 13048     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13049
 13050     IF  NO-CONVERSION-ERROR
 13051         MOVE DC-GREG-DATE-1-EDIT
 13052                                 TO W-VG-TEXT (117).
 13053
 13054     MOVE PB-C-LF-CANCEL-AMT     TO W-EDIT-7-2.
 13055     MOVE W-EDIT-7-2             TO W-VG-TEXT (118).
 13056     MOVE PB-C-AH-CANCEL-AMT     TO W-EDIT-7-2.
 13057     MOVE W-EDIT-7-2             TO W-VG-TEXT (119).
 13058     MOVE PB-C-LF-REF-CALC       TO W-EDIT-7-2.
 13059     MOVE W-EDIT-7-2             TO W-VG-TEXT (120).
 13060     MOVE PB-C-AH-REF-CALC       TO W-EDIT-7-2.
 13061     MOVE W-EDIT-7-2             TO W-VG-TEXT (121).
 13062     COMPUTE W-EDIT-7-2 = PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
 13063     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 13064
 13065     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 13066        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 13067     END-IF
 13068     MOVE PB-C-NH-INT-ON-REFS    TO W-EDIT-7-2
 13069     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 13070     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
 13071     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-1
 13072        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
 13073     END-IF
 13074     MOVE SPACES                 TO DC-OPTION-CODE
 13075     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 13076
 13077     IF NO-CONVERSION-ERROR
 13078        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 13079     END-IF
 13080
 13081     COMPUTE W-DIFFERENCE = PB-C-LF-REF-CALC
 13082                           - PB-C-LF-CANCEL-AMT.
 13083
 13084     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13085     MOVE W-EDIT-7-2             TO W-VG-TEXT (122).
 13086
 13087     COMPUTE W-DIFFERENCE = PB-C-AH-REF-CALC
 13088                           - PB-C-AH-CANCEL-AMT.
 13089
 13090     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13091     MOVE W-EDIT-7-2             TO W-VG-TEXT (123).
 13092
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 271
* EL689.cbl
 13093 6400-EXIT.
 13094     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 272
* EL689.cbl
 13096 6450-GET-CERT-DATA.
 13097     IF  W-FILE-NOT-USED (8)
 13098         GO TO 6450-EXIT.
 13099
 13100     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 13101         MOVE ER-9327            TO EMI-ERROR
 13102         MOVE -1                 TO MAINTL
 13103         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13104         GO TO 6450-EXIT.
 13105
 13106 6450-READ-CERT-ONLY.
 13107
 13108
 13109* EXEC CICS HANDLE CONDITION
 13110*         NOTOPEN (8030-CERT-NOT-OPEN)
 13111*         NOTFND  (8035-CERT-NOT-FOUND)
 13112*    END-EXEC.
 13113*    MOVE '"$JI                  ! 0 #00012453' TO DFHEIV0
 13114     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13115     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13116     MOVE X'3020233030303132343533' TO DFHEIV0(25:11)
 13117     CALL 'kxdfhei1' USING DFHEIV0
 13118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13119
 13120
 13121
 13122* EXEC CICS READ
 13123*         DATASET (W-CERT-FILE-ID)
 13124*         SET     (ADDRESS OF CERTIFICATE-MASTER)
 13125*         RIDFLD  (W-CERT-KEY)
 13126*    END-EXEC.
 13127*    MOVE '&"S        E          (   #00012458' TO DFHEIV0
 13128     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13129     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13130     MOVE X'2020233030303132343538' TO DFHEIV0(25:11)
 13131     CALL 'kxdfhei1' USING DFHEIV0,
 13132           W-CERT-FILE-ID,
 13133           DFHEIV20,
 13134           DFHEIV99,
 13135           W-CERT-KEY,
 13136           DFHEIV99,
 13137           DFHEIV99,
 13138           DFHEIV99
 13139     SET ADDRESS OF CERTIFICATE-MASTER TO
 13140         DFHEIV20
 13141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13142
 13143
 13144     MOVE 'Y'                    TO W-CERT-FOUND-SW.
 13145
 13146 6450-ONLY-STOP.
 13147
 13148     MOVE CM-INSURED-LAST-NAME   TO W-VG-TEXT (108).
 13149
 13150     MOVE CM-BENEFICIARY         TO W-VG-TEXT (109).
 13151
 13152     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13153     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 273
* EL689.cbl
 13154     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13155     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13156     MOVE WS-NAME-WORK           TO W-VG-TEXT (95).
 13157
 13158     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13159     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13160     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13161     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13162     MOVE WS-NAME-WORK           TO W-VG-TEXT (94).
 13163
 13164     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13165     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13166     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13167     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13168     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13169     MOVE WS-NAME-WORK           TO W-VG-TEXT (90).
 13170
 13171     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13172     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13173     MOVE SPACES                 TO W-NAME-MIDDLE.
 13174     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13175     MOVE WS-NAME-WORK           TO W-VG-TEXT (104).
 13176
 13177     MOVE CM-INSURED-FIRST-NAME  TO W-VG-TEXT (91).
 13178     MOVE CM-INSURED-INITIAL2    TO W-VG-TEXT (92).
 13179
 13180     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13181     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13182     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13183     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13184     MOVE WS-NAME-WORK           TO W-VG-TEXT (103)
 13185                                    W-LABEL-JOINT-NAME.
 13186
 13187     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13188     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13189     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13190     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13191     MOVE WS-NAME-WORK           TO W-VG-TEXT (102).
 13192
 13193     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13194     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13195     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13196     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13197     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13198     MOVE WS-NAME-WORK           TO W-VG-TEXT (99).
 13199
 13200     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13201     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13202     MOVE SPACES                 TO W-NAME-MIDDLE.
 13203     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13204     MOVE WS-NAME-WORK           TO W-VG-TEXT (105).
 13205
 13206     MOVE CM-JT-FIRST-NAME       TO W-VG-TEXT (100).
 13207     MOVE CM-JT-INITIAL          TO W-VG-TEXT (101).
 13208
 13209     COMPUTE W-WORK-AMOUNT
 13210         = CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT.
 13211     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 274
* EL689.cbl
 13212     MOVE W-EDIT-9-2             TO W-VG-TEXT (97).
 13213     MOVE CM-AH-PREMIUM-AMT      TO W-EDIT-7-2.
 13214     MOVE W-EDIT-7-2             TO W-VG-TEXT (98).
 13215
 13216     IF  CM-SEX-FEMAL
 13217         MOVE 'MS.'              TO W-VG-TEXT (96)
 13218
 13219     ELSE
 13220         MOVE 'MR.'              TO W-VG-TEXT (96).
 13221
 13222     MOVE CM-CARRIER OF CERTIFICATE-MASTER
 13223                                 TO W-VG-TEXT (70).
 13224     MOVE CM-GROUPING            TO W-VG-TEXT (71).
 13225     MOVE CM-ACCOUNT             TO W-VG-TEXT (72).
 13226     MOVE CM-CERT-NO             TO W-VG-TEXT (73).
 13227     MOVE CM-INSURED-ISSUE-AGE   TO W-DISPLAY-3.
 13228     MOVE W-DISPLAY-3            TO W-VG-TEXT (83).
 13229     MOVE CM-LOAN-NUMBER         TO W-VG-TEXT (86).
 13230     MOVE CM-LOAN-BALANCE        TO W-EDIT-7-2.
 13231     MOVE W-EDIT-7-2             TO W-VG-TEXT (87).
 13232     MOVE CM-MEMBER-NO           TO W-VG-TEXT (88).
 13233     MOVE CM-SOC-SEC-NO          TO W-VG-TEXT (89).
 13234     MOVE CM-POLICY-FORM-NO      TO W-VG-TEXT (83).
 13235     MOVE CM-LF-ORIG-TERM        TO W-EDIT-3-0.
 13236     MOVE W-EDIT-3-0             TO W-VG-TEXT (77).
 13237     MOVE CM-LF-BENEFIT-AMT      TO W-EDIT-9-2.
 13238     MOVE W-EDIT-9-2             TO W-VG-TEXT (79).
 13239     MOVE CM-AH-ORIG-TERM        TO W-EDIT-3-0.
 13240     MOVE W-EDIT-3-0             TO W-VG-TEXT (78).
 13241     MOVE CM-AH-BENEFIT-AMT      TO W-EDIT-7-2.
 13242     MOVE W-EDIT-7-2             TO W-VG-TEXT (80).
 13243     MOVE CM-AH-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13244     MOVE W-EDIT-7-2             TO W-VG-TEXT (107).
 13245     MOVE CM-LF-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13246     MOVE W-EDIT-7-2             TO W-VG-TEXT (106).
 13247     IF PI-689-DATA-SOURCE NOT = '4'
 13248     COMPUTE W-EDIT-7-2 = CM-LF-ITD-CANCEL-AMT
 13249        + CM-AH-ITD-CANCEL-AMT
 13250     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 13251     IF CM-NH-INT-ON-REFS NOT NUMERIC
 13252        MOVE ZEROS               TO CM-NH-INT-ON-REFS
 13253     END-IF
 13254     MOVE CM-NH-INT-ON-REFS      TO W-EDIT-7-2
 13255     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 13256     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
 13257     IF CM-AH-CANCEL-DT > DC-BIN-DATE-1
 13258        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
 13259     END-IF
 13260     MOVE SPACES                 TO DC-OPTION-CODE
 13261     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 13262
 13263     IF NO-CONVERSION-ERROR
 13264        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 13265     END-IF
 13266     END-IF
 13267     COMPUTE W-WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 13268     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
 13269     MOVE W-EDIT-9-2             TO W-VG-TEXT (93).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 275
* EL689.cbl
 13270
 13271     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1.
 13272     MOVE SPACES                 TO DC-OPTION-CODE.
 13273     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13274
 13275     IF  NO-CONVERSION-ERROR
 13276         MOVE DC-GREG-DATE-1-EDIT
 13277                                 TO W-VG-TEXT (81).
 13278
 13279     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1.
 13280     MOVE SPACES                 TO DC-OPTION-CODE.
 13281     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13282
 13283     IF  NO-CONVERSION-ERROR
 13284         MOVE DC-GREG-DATE-1-EDIT
 13285                                 TO W-VG-TEXT (82).
 13286
 13287     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13288     MOVE SPACES                 TO DC-OPTION-CODE.
 13289     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13290
 13291     IF  NO-CONVERSION-ERROR
 13292         MOVE DC-GREG-DATE-1-EDIT
 13293                                 TO W-VG-TEXT (74).
 13294
 13295     MOVE CM-LF-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13296
 13297     IF  CM-PMT-EXTENSION-DAYS NUMERIC
 13298         MOVE CM-PMT-EXTENSION-DAYS
 13299                                 TO DC-ELAPSED-DAYS
 13300     ELSE
 13301         MOVE ZEROS              TO DC-ELAPSED-DAYS.
 13302
 13303     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13304     MOVE '6'                    TO DC-OPTION-CODE.
 13305     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13306
 13307     IF  NO-CONVERSION-ERROR
 13308         MOVE DC-GREG-DATE-1-EDIT
 13309                                 TO W-VG-TEXT (75).
 13310
 13311     MOVE CM-AH-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13312     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13313     MOVE '6'                    TO DC-OPTION-CODE.
 13314     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13315
 13316     IF  NO-CONVERSION-ERROR
 13317         MOVE DC-GREG-DATE-1-EDIT
 13318                                 TO W-VG-TEXT (76).
 13319
 13320 6450-EXIT.
 13321     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 276
* EL689.cbl
 13323 6500-GET-ACCOUNT-DATA.
 13324
 13325     IF  ADDRSI EQUAL '1'
 13326             AND
 13327         PI-CREATE-LABELS
 13328             AND
 13329         NOT PI-689-LABELS-OVERRIDEN
 13330         NEXT SENTENCE
 13331     ELSE
 13332         IF  W-FILE-NOT-USED (6)
 13333             GO TO 6500-EXIT
 13334         END-IF
 13335     END-IF.
 13336
 13337 6500-READ-ACCT-ONLY.
 13338
 13339     IF  W-ACCT-ACCOUNT EQUAL LOW-VALUES
 13340         MOVE ER-9327            TO EMI-ERROR
 13341         MOVE -1                 TO MAINTL
 13342         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13343         GO TO 6500-EXIT.
 13344
 13345
 13346* EXEC CICS HANDLE CONDITION
 13347*         NOTOPEN    (8020-ACCT-NOT-OPEN)
 13348*         NOTFND     (6500-ACCT-NOT-FOUND)
 13349*         ENDFILE    (6500-ONLY-STOP)
 13350*    END-EXEC.
 13351*    MOVE '"$JI''                 ! 1 #00012665' TO DFHEIV0
 13352     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 13353     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13354     MOVE X'3120233030303132363635' TO DFHEIV0(25:11)
 13355     CALL 'kxdfhei1' USING DFHEIV0
 13356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13357
 13358
 13359
 13360* EXEC CICS STARTBR
 13361*         RIDFLD     (W-ACCT-KEY)
 13362*         DATASET    (W-ACCT-FILE-ID)
 13363*         KEYLENGTH  (20)
 13364*         GENERIC
 13365*    END-EXEC.
 13366     MOVE 20
 13367       TO DFHEIV11
 13368     MOVE 0
 13369       TO DFHEIV12
 13370*    MOVE '&,   KG    G          &   #00012671' TO DFHEIV0
 13371     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 13372     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13373     MOVE X'2020233030303132363731' TO DFHEIV0(25:11)
 13374     CALL 'kxdfhei1' USING DFHEIV0,
 13375           W-ACCT-FILE-ID,
 13376           W-ACCT-KEY,
 13377           DFHEIV11,
 13378           DFHEIV12,
 13379           DFHEIV99
 13380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 277
* EL689.cbl
 13381
 13382
 13383     MOVE W-ACCT-PARTIAL-KEY     TO W-ACCT-SAVE-KEY.
 13384     MOVE 'Y'                    TO W-ACCT-BROWSE-STARTED-SW.
 13385
 13386 6500-READNEXT.
 13387
 13388
 13389* EXEC CICS READNEXT
 13390*         DATASET    (W-ACCT-FILE-ID)
 13391*         SET        (ADDRESS OF ACCOUNT-MASTER)
 13392*         RIDFLD     (W-ACCT-KEY)
 13393*    END-EXEC.
 13394     MOVE 0
 13395       TO DFHEIV11
 13396*    MOVE '&.S                   )   #00012683' TO DFHEIV0
 13397     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13398     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13399     MOVE X'2020233030303132363833' TO DFHEIV0(25:11)
 13400     CALL 'kxdfhei1' USING DFHEIV0,
 13401           W-ACCT-FILE-ID,
 13402           DFHEIV20,
 13403           DFHEIV99,
 13404           W-ACCT-KEY,
 13405           DFHEIV99,
 13406           DFHEIV11,
 13407           DFHEIV99,
 13408           DFHEIV99
 13409     SET ADDRESS OF ACCOUNT-MASTER TO
 13410         DFHEIV20
 13411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13412
 13413
 13414     IF  W-ACCT-PARTIAL-KEY NOT EQUAL W-ACCT-SAVE-KEY
 13415         IF  PRIOR-MATCH-ACCT-PKEY
 13416             CONTINUE
 13417*            GO TO 6500-ONLY-STOP
 13418         ELSE
 13419             IF  W-FILE-NOT-USED (6)
 13420                 PERFORM 6500-ENDBR
 13421                 GO TO 6500-EXIT
 13422             ELSE
 13423                 GO TO 6500-ACCT-NOT-FOUND
 13424             END-IF
 13425         END-IF
 13426     ELSE
 13427         SET PRIOR-MATCH-ACCT-PKEY TO TRUE
 13428         MOVE AM-CARRIER           TO WS-SAV-AM-CARRIER
 13429         MOVE AM-ACCOUNT           TO WS-SAV-AM-ACCOUNT
 13430         MOVE AM-DEFN-1            TO WS-SAV-AM-DEFN-1
 13431         MOVE AM-REMIT-TO          TO WS-SAV-AM-REMIT-TO
 13432         MOVE AM-NAME              TO WS-SAV-AM-NAME
 13433         MOVE AM-PERSON            TO WS-SAV-AM-PERSON
 13434         MOVE AM-ADDRS             TO WS-SAV-AM-ADDRS
 13435         MOVE SPACES               TO WS-SAV-AM-CITY
 13436*        MOVE AM-CITY              TO WS-SAV-AM-CITY
 13437         STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 13438            DELIMITED BY '  ' INTO WS-SAV-AM-CITY
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 278
* EL689.cbl
 13439         END-STRING
 13440         MOVE AM-ZIP               TO WS-SAV-AM-ZIP
 13441         MOVE AM-TEL-NO            TO WS-SAV-AM-TEL-NO
 13442         MOVE AM-CONTROL-NAME      TO WS-SAV-AM-CONTROL-NAME
 13443         MOVE AM-CSR-CODE          TO WS-SAV-AM-CSR-CODE
 13444         MOVE AM-ACCOUNT           TO WS-SAV-AM-ERACCT-ACCOUNT
 13445         GO TO 6500-READNEXT
 13446     END-IF
 13447     .
 13448 6500-ONLY-STOP.
 13449
 13450     IF  NOT PI-NO-CARRIER-SECURITY
 13451             AND
 13452         PI-CARRIER-SECURITY NOT = WS-SAV-AM-CARRIER
 13453         MOVE -1                 TO CARRIERL
 13454         MOVE AL-UANON           TO CARRIERA
 13455         MOVE ER-9095            TO EMI-ERROR
 13456         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13457         PERFORM 6500-ENDBR
 13458         GO TO 8200-SEND-DATAONLY.
 13459
 13460     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13461     MOVE WS-SAV-AM-NAME         TO W-LABEL-LINES (1).
 13462     MOVE WS-SAV-AM-PERSON       TO W-LABEL-LINES (2).
 13463     MOVE WS-SAV-AM-ADDRS        TO W-LABEL-LINES (3).
 13464     MOVE WS-SAV-AM-CITY         TO W-LABEL-LINES (4).
 13465
 13466     MOVE WS-SAV-AM-ZIP          TO W-WORK-ZIP.
 13467     MOVE SPACES                 TO W-LABEL-ZIP (5).
 13468
 13469     IF  SAVE-AM-CANADIAN-POST-CODE
 13470         MOVE WS-SAV-AM-CANADIAN-POSTAL-CODE
 13471                                 TO W-CANADIAN-POSTAL-CODES
 13472         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 13473         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 13474         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 13475                                    W-LAB-CAN-FILLER (5)
 13476     ELSE
 13477         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 13478
 13479         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13480             MOVE '-'            TO W-LABEL-DASH (5)
 13481             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 13482         ELSE
 13483             MOVE SPACES         TO W-LABEL-DASH (5)
 13484                                    W-LABEL-2ND-ZIP (5).
 13485
 13486     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13487
 13488     IF  ADDRSI EQUAL '1'
 13489             AND
 13490         PI-CREATE-LABELS
 13491             AND
 13492         NOT PI-689-LABELS-OVERRIDEN
 13493         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13494                                    W-VG-TEXT (40)
 13495         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13496                                    W-VG-TEXT (41)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 279
* EL689.cbl
 13497         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13498                                    W-VG-TEXT (42)
 13499         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13500                                    W-VG-TEXT (43)
 13501         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13502                                    W-VG-TEXT (44)
 13503         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13504                                    W-VG-TEXT (45)
 13505         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13506         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13507         SET W-RG-NDX UP BY +1
 13508     ELSE
 13509         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (40)
 13510         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (41)
 13511         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (42)
 13512         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (43)
 13513         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (44)
 13514         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (45).
 13515
 13516     IF  WS-SAV-AM-TEL-NO NOT NUMERIC
 13517             OR
 13518         WS-SAV-AM-TEL-NO EQUAL ZEROS
 13519         MOVE SPACES             TO W-VG-TEXT (46)
 13520     ELSE
 13521         MOVE ZEROS                  TO W-PHONE-IN
 13522         MOVE WS-SAV-AM-AREA-CODE    TO W-PO-AREA
 13523         MOVE WS-SAV-AM-TEL-PRE      TO W-PO-PFX
 13524         MOVE WS-SAV-AM-TEL-NBR      TO W-PO-SFX
 13525         MOVE W-PHONE-OUT            TO W-VG-TEXT (46).
 13526
 13527     IF WS-SAV-AM-CONTROL-NAME (1:1) NOT = LOW-VALUES
 13528        MOVE WS-SAV-AM-CONTROL-NAME  TO W-VG-TEXT (47)
 13529     ELSE
 13530        MOVE SPACES                   TO W-VG-TEXT (47)
 13531     END-IF.
 13532     MOVE WS-SAV-AM-CSR-CODE     TO W-VG-TEXT (48)
 13533     MOVE WS-SAV-AM-ERACCT-ACCOUNT
 13534                                 TO W-VG-TEXT (49)
 13535
 13536     MOVE WS-SAV-AM-ACCOUNT      TO W-VG-TEXT (72)
 13537     PERFORM 6500-ENDBR.
 13538
 13539     GO TO 6500-EXIT.
 13540
 13541 6500-ENDBR.
 13542
 13543     IF  W-ACCT-BROWSE-STARTED
 13544         MOVE 'N'                TO W-ACCT-BROWSE-STARTED-SW
 13545
 13546* EXEC CICS ENDBR
 13547*            DATASET (W-ACCT-FILE-ID)
 13548*        END-EXEC
 13549     MOVE 0
 13550       TO DFHEIV11
 13551*    MOVE '&2                    $   #00012820' TO DFHEIV0
 13552     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13553     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13554     MOVE X'2020233030303132383230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 280
* EL689.cbl
 13555     CALL 'kxdfhei1' USING DFHEIV0,
 13556           W-ACCT-FILE-ID,
 13557           DFHEIV11,
 13558           DFHEIV99
 13559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13560     END-IF.
 13561
 13562 6500-ACCT-NOT-FOUND.
 13563
 13564     PERFORM 6500-ENDBR.
 13565
 13566     IF  DATASORI NOT EQUAL '1'
 13567         MOVE ER-0179            TO EMI-ERROR
 13568         GO TO 6500-EXIT.
 13569
 13570     MOVE ER-0179                TO EMI-ERROR.
 13571     MOVE -1                     TO MAINTL.
 13572     MOVE AL-UNBON               TO MAINTA.
 13573     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13574     GO TO 8200-SEND-DATAONLY.
 13575
 13576 6500-EXIT.
 13577     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 281
* EL689.cbl
 13579 6600-GET-COMPENSATION-DATA.
 13580
 13581     IF  ADDRSI EQUAL '4'
 13582             AND
 13583         PI-CREATE-LABELS
 13584             AND
 13585         NOT PI-689-LABELS-OVERRIDEN
 13586         NEXT SENTENCE
 13587     ELSE
 13588         IF  W-FILE-NOT-USED (10)
 13589             GO TO 6600-EXIT.
 13590
 13591     IF  W-COMP-RESP-PERSON GREATER THAN LOW-VALUES
 13592         MOVE W-COMP-KEY         TO W-COMP-SAVE-KEY
 13593         GO TO 6600-START.
 13594
 13595     IF  PI-ZERO-CARRIER
 13596             OR
 13597         PI-ZERO-CAR-GROUP
 13598         MOVE ZEROS              TO W-COMP-CARRIER.
 13599
 13600     IF  PI-ZERO-GROUPING
 13601             OR
 13602         PI-ZERO-CAR-GROUP
 13603         MOVE ZEROS              TO W-COMP-GROUPING.
 13604
 13605     IF  W-FILE-NOT-USED (6)
 13606         PERFORM 6500-READ-ACCT-ONLY THRU 6500-READNEXT
 13607         IF  EMI-ERROR EQUAL ER-0179
 13608             MOVE ER-9327        TO EMI-ERROR
 13609             MOVE -1             TO MAINTL
 13610             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13611             GO TO 6600-EXIT.
 13612
 13613     MOVE  'A'                   TO W-COMP-TYPE.
 13614
 13615     IF  WS-SAV-AM-REMIT-TO GREATER THAN ZEROS
 13616         MOVE WS-SAV-AM-AGT (WS-SAV-AM-REMIT-TO)
 13617                                 TO W-COMP-RESP-PERSON
 13618     ELSE
 13619         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 13620
 13621     PERFORM VARYING W-NDX FROM +1 BY +1 UNTIL
 13622        (W-NDX > +10)
 13623            OR
 13624         (WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F')
 13625     END-PERFORM
 13626
 13627     IF  WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F'
 13628         MOVE WS-SAV-AM-AGT (W-NDX)  TO W-COMP-ACCOUNT
 13629     ELSE
 13630         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 13631
 13632     PERFORM 6500-ENDBR.
 13633     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 13634
 13635     IF  W-COMP-RESP-PERSON EQUAL LOW-VALUES
 13636         MOVE ER-9327            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 282
* EL689.cbl
 13637         MOVE -1                 TO MAINTL
 13638         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13639         GO TO 6600-EXIT.
 13640
 13641 6600-START.
 13642
 13643
 13644* EXEC CICS HANDLE CONDITION
 13645*         NOTOPEN (8080-COMP-NOT-OPEN)
 13646*         NOTFND  (6600-COMP-NOT-FOUND)
 13647*    END-EXEC.
 13648*    MOVE '"$JI                  ! 2 #00012906' TO DFHEIV0
 13649     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13650     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13651     MOVE X'3220233030303132393036' TO DFHEIV0(25:11)
 13652     CALL 'kxdfhei1' USING DFHEIV0
 13653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13654
 13655
 13656
 13657* EXEC CICS STARTBR
 13658*         RIDFLD  (W-COMP-KEY)
 13659*         DATASET (W-COMP-FILE-ID)
 13660*    END-EXEC.
 13661     MOVE 0
 13662       TO DFHEIV11
 13663*    MOVE '&,         G          &   #00012911' TO DFHEIV0
 13664     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13665     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13666     MOVE X'2020233030303132393131' TO DFHEIV0(25:11)
 13667     CALL 'kxdfhei1' USING DFHEIV0,
 13668           W-COMP-FILE-ID,
 13669           W-COMP-KEY,
 13670           DFHEIV99,
 13671           DFHEIV11,
 13672           DFHEIV99
 13673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13674
 13675
 13676     MOVE 'Y'                    TO W-COMP-BROWSE-SW.
 13677
 13678 6600-READNEXT.
 13679
 13680
 13681* EXEC CICS READNEXT
 13682*         DATASET (W-COMP-FILE-ID)
 13683*         SET     (ADDRESS OF COMPENSATION-MASTER)
 13684*         RIDFLD  (W-COMP-KEY)
 13685*    END-EXEC.
 13686     MOVE 0
 13687       TO DFHEIV11
 13688*    MOVE '&.S                   )   #00012920' TO DFHEIV0
 13689     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13690     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13691     MOVE X'2020233030303132393230' TO DFHEIV0(25:11)
 13692     CALL 'kxdfhei1' USING DFHEIV0,
 13693           W-COMP-FILE-ID,
 13694           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 283
* EL689.cbl
 13695           DFHEIV99,
 13696           W-COMP-KEY,
 13697           DFHEIV99,
 13698           DFHEIV11,
 13699           DFHEIV99,
 13700           DFHEIV99
 13701     SET ADDRESS OF COMPENSATION-MASTER TO
 13702         DFHEIV20
 13703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13704
 13705
 13706     IF CO-CONTROL-PRIMARY
 13707           NOT = W-COMP-SAVE-KEY
 13708        GO TO 6600-COMP-NOT-FOUND.
 13709
 13710     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13711     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1)
 13712                                    W-VG-TEXT (140).
 13713     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 13714     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 13715     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 13716*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 13717     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13718        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 13719     END-STRING
 13720
 13721     MOVE CO-ZIP                 TO W-WORK-ZIP.
 13722
 13723     IF  CO-CANADIAN-POST-CODE
 13724         MOVE CO-CANADIAN-POSTAL-CODE
 13725                                 TO W-CANADIAN-POSTAL-CODES
 13726         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13727         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13728         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13729                                    W-LAB-CAN-FILLER (6)
 13730     ELSE
 13731         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13732
 13733         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13734             MOVE '-'            TO W-LABEL-DASH (6)
 13735             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13736         ELSE
 13737             MOVE SPACES         TO W-LABEL-DASH (6)
 13738                                    W-LABEL-2ND-ZIP (6).
 13739
 13740     IF  CO-TELEPHONE NOT NUMERIC
 13741             OR
 13742         CO-TELEPHONE = ZEROS
 13743         MOVE SPACES             TO W-VG-TEXT (147)
 13744     ELSE
 13745         MOVE ZEROS              TO W-PHONE-IN
 13746         MOVE CO-AREA-CODE       TO W-PO-AREA
 13747         MOVE CO-PREFIX          TO W-PO-PFX
 13748         MOVE CO-PHONE           TO W-PO-SFX
 13749         MOVE W-PHONE-OUT        TO W-VG-TEXT (147).
 13750
 13751     IF (CO-FAXNO NOT NUMERIC)
 13752        OR (CO-FAXNO = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 284
* EL689.cbl
 13753        MOVE SPACES              TO W-VG-TEXT (182)
 13754     ELSE
 13755        MOVE ZEROS               TO W-PHONE-IN
 13756        MOVE CO-FAX-AREA-CODE    TO W-PO-AREA
 13757        MOVE CO-FAX-PREFIX       TO W-PO-PFX
 13758        MOVE CO-FAX-PHONE        TO W-PO-SFX
 13759        MOVE W-PHONE-OUT         TO W-VG-TEXT (182)
 13760     END-IF
 13761     IF CO-GA-STATUS-CODE NOT = 'A' AND 'I' AND 'P'
 13762        MOVE SPACES              TO W-VG-TEXT (183)
 13763     ELSE
 13764        EVALUATE CO-GA-STATUS-CODE
 13765           WHEN 'A'
 13766              MOVE 'ACTIVE'      TO W-VG-TEXT (183)
 13767           WHEN 'I'
 13768              MOVE 'INACTIVE'    TO W-VG-TEXT (183)
 13769           WHEN 'P'
 13770              MOVE 'PENDING'     TO W-VG-TEXT (183)
 13771        END-EVALUATE
 13772     END-IF
 13773     IF CO-BILL-SW NOT = 'B' AND 'R' AND 'T' AND 'S'
 13774        MOVE SPACES              TO W-VG-TEXT (181)
 13775     ELSE
 13776        EVALUATE CO-BILL-SW
 13777           WHEN 'B'
 13778              MOVE 'BILLED'      TO W-VG-TEXT (181)
 13779           WHEN 'R'
 13780              MOVE 'REMIT'       TO W-VG-TEXT (181)
 13781           WHEN 'T'
 13782              MOVE 'T'           TO W-VG-TEXT (181)
 13783           WHEN 'S'
 13784              MOVE 'S'           TO W-VG-TEXT (181)
 13785        END-EVALUATE
 13786     END-IF
 13787     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13788
 13789     IF  ADDRSI EQUAL '4'
 13790             AND
 13791         PI-CREATE-LABELS
 13792             AND
 13793         NOT PI-689-LABELS-OVERRIDEN
 13794         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13795                                    W-VG-TEXT (141)
 13796         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13797                                    W-VG-TEXT (142)
 13798         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13799                                    W-VG-TEXT (143)
 13800         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13801                                    W-VG-TEXT (144)
 13802         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13803                                    W-VG-TEXT (145)
 13804         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13805                                    W-VG-TEXT (146)
 13806         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13807         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13808         SET W-RG-NDX UP BY +1
 13809     ELSE
 13810         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (141)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 285
* EL689.cbl
 13811         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (142)
 13812         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (143)
 13813         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (144)
 13814         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (145)
 13815         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (146).
 13816
 13817     PERFORM 6630-GET-CSR-NAME THRU 6630-EXIT.
 13818
 13819     MOVE CO-RESP-NO             TO W-VG-TEXT (180).
 13820     MOVE CO-END-BAL             TO W-EDIT-7-2-NEGATIVE.
 13821     MOVE W-EDIT-7-2-NEGATIVE    TO W-VG-TEXT (150).
 13822
 13823     MOVE CO-LAST-STMT-DT        TO DC-GREG-DATE-1-YMD.
 13824     MOVE '3'                    TO DC-OPTION-CODE.
 13825     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13826
 13827     IF  NO-CONVERSION-ERROR
 13828         MOVE DC-GREG-DATE-1-ALPHA
 13829                                 TO W-VG-TEXT (149).
 13830
 13831     PERFORM 6620-GET-G-DATA THRU 6620-EXIT.
 13832     PERFORM 6626-GET-B-DATA     THRU 6626-EXIT
 13833
 13834     PERFORM 6600-ENDBR.
 13835     GO TO 6600-EXIT.
 13836
 13837 6600-ENDBR.
 13838
 13839     IF  W-COMP-BROWSE-STARTED
 13840         MOVE 'N'                      TO W-COMP-BROWSE-SW
 13841
 13842* EXEC CICS ENDBR
 13843*             DATASET(W-COMP-FILE-ID)
 13844*        END-EXEC.
 13845     MOVE 0
 13846       TO DFHEIV11
 13847*    MOVE '&2                    $   #00013061' TO DFHEIV0
 13848     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13849     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13850     MOVE X'2020233030303133303631' TO DFHEIV0(25:11)
 13851     CALL 'kxdfhei1' USING DFHEIV0,
 13852           W-COMP-FILE-ID,
 13853           DFHEIV11,
 13854           DFHEIV99
 13855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13856
 13857
 13858 6600-COMP-NOT-FOUND.
 13859
 13860     PERFORM 6600-ENDBR.
 13861
 13862     IF ADDRSL GREATER ZERO
 13863         IF ADDRSI = '4'
 13864            IF PI-689-TYPE EQUAL LOW-VALUES OR SPACES
 13865                MOVE ER-7378                TO EMI-ERROR
 13866                MOVE -1                     TO TYPEL
 13867                MOVE AL-UNBON               TO TYPEA
 13868                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 286
* EL689.cbl
 13869                GO TO 8200-SEND-DATAONLY
 13870            ELSE
 13871                MOVE ER-2114                TO EMI-ERROR
 13872                MOVE -1                     TO ADDRSL
 13873                MOVE AL-UNBON               TO ADDRSA
 13874                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13875                GO TO 8200-SEND-DATAONLY.
 13876
 13877 6600-EXIT.
 13878     EXIT.
 13879 6620-GET-G-DATA.
 13880
 13881     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY.
 13882
 13883     IF  CO-RPTCD2 GREATER THAN SPACES
 13884         MOVE SPACES             TO W-COMP-RESP-PERSON
 13885         MOVE CO-RPTCD2          TO W-COMP-WORK-AREA
 13886         MOVE +10                TO W-CWA-NDX
 13887         PERFORM 6622-FIND-LAST-NON-SPACE
 13888         SET W-COMP-NDX          TO +10
 13889         PERFORM 6625-FILL-IN-RESP-PERSON.
 13890         INSPECT W-COMP-RESP-PERSON CONVERTING SPACES TO ZEROS.
 13891
 13892     MOVE LOW-VALUES             TO W-COMP-ACCOUNT.
 13893     MOVE 'G'                    TO W-COMP-TYPE.
 13894     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 13895
 13896
 13897* EXEC CICS RESETBR
 13898*         RIDFLD  (W-COMP-KEY)
 13899*         DATASET (W-COMP-FILE-ID)
 13900*    END-EXEC.
 13901     MOVE 0
 13902       TO DFHEIV11
 13903*    MOVE '&4         G          &   #00013103' TO DFHEIV0
 13904     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 13905     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13906     MOVE X'2020233030303133313033' TO DFHEIV0(25:11)
 13907     CALL 'kxdfhei1' USING DFHEIV0,
 13908           W-COMP-FILE-ID,
 13909           W-COMP-KEY,
 13910           DFHEIV99,
 13911           DFHEIV11,
 13912           DFHEIV99
 13913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13914
 13915
 13916
 13917* EXEC CICS READNEXT
 13918*         DATASET (W-COMP-FILE-ID)
 13919*         SET     (ADDRESS OF COMPENSATION-MASTER)
 13920*         RIDFLD  (W-COMP-KEY)
 13921*    END-EXEC.
 13922     MOVE 0
 13923       TO DFHEIV11
 13924*    MOVE '&.S                   )   #00013108' TO DFHEIV0
 13925     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13926     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 287
* EL689.cbl
 13927     MOVE X'2020233030303133313038' TO DFHEIV0(25:11)
 13928     CALL 'kxdfhei1' USING DFHEIV0,
 13929           W-COMP-FILE-ID,
 13930           DFHEIV20,
 13931           DFHEIV99,
 13932           W-COMP-KEY,
 13933           DFHEIV99,
 13934           DFHEIV11,
 13935           DFHEIV99,
 13936           DFHEIV99
 13937     SET ADDRESS OF COMPENSATION-MASTER TO
 13938         DFHEIV20
 13939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13940
 13941
 13942     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 13943         GO TO 6620-EXIT.
 13944
 13945     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13946     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 13947     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 13948     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 13949     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 13950*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 13951     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13952        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 13953     END-STRING
 13954
 13955     MOVE CO-ZIP                 TO W-WORK-ZIP.
 13956
 13957     IF  CO-CANADIAN-POST-CODE
 13958         MOVE CO-CANADIAN-POSTAL-CODE
 13959                                 TO W-CANADIAN-POSTAL-CODES
 13960         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13961         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13962         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13963                                    W-LAB-CAN-FILLER (6)
 13964     ELSE
 13965         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13966         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13967             MOVE '-'            TO W-LABEL-DASH (6)
 13968             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13969         ELSE
 13970             MOVE SPACES         TO W-LABEL-DASH (6)
 13971                                    W-LABEL-2ND-ZIP (6).
 13972
 13973     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13974
 13975     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (174).
 13976     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (175).
 13977     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (176).
 13978     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (177).
 13979     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (178).
 13980     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (179).
 13981
 13982 6620-EXIT.
 13983     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 288
* EL689.cbl
 13985 6622-FIND-LAST-NON-SPACE.
 13986
 13987     IF  W-CWA-CHAR (W-CWA-NDX) EQUAL SPACES
 13988         SUBTRACT +1 FROM W-CWA-NDX
 13989         GO TO 6622-FIND-LAST-NON-SPACE.
 13990
 13991 6622-EXIT.
 13992     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 289
* EL689.cbl
 13994 6625-FILL-IN-RESP-PERSON.
 13995
 13996     MOVE W-CWA-CHAR (W-CWA-NDX) TO W-COMP-RP-CHAR (W-COMP-NDX)
 13997     SET W-COMP-NDX DOWN BY +1.
 13998     SUBTRACT +1 FROM W-CWA-NDX.
 13999
 14000     IF  W-CWA-NDX GREATER THAN ZEROS
 14001         GO TO 6625-FILL-IN-RESP-PERSON.
 14002
 14003 6625-EXIT.
 14004     EXIT.
 14005 6626-GET-B-DATA.
 14006     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY
 14007     IF W-FILE-USED (8)
 14008        PERFORM 6450-READ-CERT-ONLY
 14009        IF W-CERT-FOUND
 14010           MOVE CM-BENEFICIARY (1:10)
 14011                                 TO W-COMP-RESP-PERSON
 14012        ELSE
 14013           MOVE SPACES           TO W-COMP-RESP-PERSON
 14014           GO TO 6626-EXIT
 14015        END-IF
 14016     ELSE
 14017        MOVE CM-BENEFICIARY (1:10)
 14018                                 TO W-COMP-RESP-PERSON
 14019     END-IF
 14020     MOVE LOW-VALUES             TO W-COMP-ACCOUNT
 14021     MOVE 'B'                    TO W-COMP-TYPE
 14022     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY
 14023
 14024
 14025* EXEC CICS RESETBR
 14026*         RIDFLD  (W-COMP-KEY)
 14027*         DATASET (W-COMP-FILE-ID)
 14028*    END-EXEC.
 14029     MOVE 0
 14030       TO DFHEIV11
 14031*    MOVE '&4         G          &   #00013196' TO DFHEIV0
 14032     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 14033     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14034     MOVE X'2020233030303133313936' TO DFHEIV0(25:11)
 14035     CALL 'kxdfhei1' USING DFHEIV0,
 14036           W-COMP-FILE-ID,
 14037           W-COMP-KEY,
 14038           DFHEIV99,
 14039           DFHEIV11,
 14040           DFHEIV99
 14041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14042
 14043
 14044
 14045* EXEC CICS READNEXT
 14046*         DATASET (W-COMP-FILE-ID)
 14047*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14048*         RIDFLD  (W-COMP-KEY)
 14049*    END-EXEC.
 14050     MOVE 0
 14051       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 290
* EL689.cbl
 14052*    MOVE '&.S                   )   #00013201' TO DFHEIV0
 14053     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14054     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14055     MOVE X'2020233030303133323031' TO DFHEIV0(25:11)
 14056     CALL 'kxdfhei1' USING DFHEIV0,
 14057           W-COMP-FILE-ID,
 14058           DFHEIV20,
 14059           DFHEIV99,
 14060           W-COMP-KEY,
 14061           DFHEIV99,
 14062           DFHEIV11,
 14063           DFHEIV99,
 14064           DFHEIV99
 14065     SET ADDRESS OF COMPENSATION-MASTER TO
 14066         DFHEIV20
 14067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14068
 14069
 14070     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 14071         GO TO 6626-EXIT.
 14072
 14073     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14074     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 14075     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14076     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14077     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14078*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14079     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14080        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14081     END-STRING
 14082
 14083     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14084
 14085     IF  CO-CANADIAN-POST-CODE
 14086         MOVE CO-CANADIAN-POSTAL-CODE
 14087                                 TO W-CANADIAN-POSTAL-CODES
 14088         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14089         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14090         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14091                                    W-LAB-CAN-FILLER (6)
 14092     ELSE
 14093         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14094         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14095             MOVE '-'            TO W-LABEL-DASH (6)
 14096             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14097         ELSE
 14098             MOVE SPACES         TO W-LABEL-DASH (6)
 14099                                    W-LABEL-2ND-ZIP (6).
 14100
 14101     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14102
 14103     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (184).
 14104     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (185).
 14105     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (186).
 14106     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (187).
 14107     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (188).
 14108     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (189).
 14109
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 291
* EL689.cbl
 14110 6626-EXIT.
 14111     EXIT.
 14112 6630-GET-CSR-NAME.
 14113
 14114     MOVE SPACES                 TO W-CNTL-KEY.
 14115     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 14116     MOVE +0                     TO W-CNTL-SEQ-NO.
 14117     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 14118     MOVE CO-CSR-CODE            TO W-CNTL-GENL.
 14119
 14120
 14121* EXEC CICS HANDLE CONDITION
 14122*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 14123*         NOTFND     (6630-CNTL2-NOT-FOUND)
 14124*    END-EXEC.
 14125*    MOVE '"$JI                  ! 3 #00013257' TO DFHEIV0
 14126     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14127     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14128     MOVE X'3320233030303133323537' TO DFHEIV0(25:11)
 14129     CALL 'kxdfhei1' USING DFHEIV0
 14130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14131
 14132
 14133
 14134* EXEC CICS READ
 14135*         DATASET    (W-CNTL-FILE-ID)
 14136*         SET        (ADDRESS OF CONTROL-FILE)
 14137*         RIDFLD     (W-CNTL-KEY)
 14138*    END-EXEC.
 14139*    MOVE '&"S        E          (   #00013262' TO DFHEIV0
 14140     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14141     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14142     MOVE X'2020233030303133323632' TO DFHEIV0(25:11)
 14143     CALL 'kxdfhei1' USING DFHEIV0,
 14144           W-CNTL-FILE-ID,
 14145           DFHEIV20,
 14146           DFHEIV99,
 14147           W-CNTL-KEY,
 14148           DFHEIV99,
 14149           DFHEIV99,
 14150           DFHEIV99
 14151     SET ADDRESS OF CONTROL-FILE TO
 14152         DFHEIV20
 14153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14154
 14155
 14156     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (148).
 14157     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 14158     GO TO 6630-EXIT.
 14159
 14160 6630-CNTL2-NOT-FOUND.
 14161
 14162*    MOVE ER-8965                TO EMI-ERROR.
 14163*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14164*    MOVE -1                     TO MAINTL.
 14165*    MOVE AL-UANON               TO MAINTA.
 14166*    GO TO 8200-SEND-DATAONLY
 14167     .
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 292
* EL689.cbl
 14168 6630-EXIT.
 14169     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 293
* EL689.cbl
 14171 6700-GET-MAIL-DATA.
 14172
 14173     IF  ADDRSI EQUAL '5'
 14174             AND
 14175         PI-CREATE-LABELS
 14176             AND
 14177         NOT PI-689-LABELS-OVERRIDEN
 14178         NEXT SENTENCE
 14179     ELSE
 14180         IF  W-FILE-NOT-USED (5)
 14181             GO TO 6700-EXIT.
 14182
 14183     IF  W-MAIL-CERT-NO EQUAL LOW-VALUES
 14184         MOVE ER-9327            TO EMI-ERROR
 14185         MOVE -1                 TO MAINTL
 14186         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14187         GO TO 6700-EXIT.
 14188
 14189
 14190* EXEC CICS HANDLE CONDITION
 14191*         NOTOPEN (8090-MAIL-NOT-OPEN)
 14192*         NOTFND  (6700-MAIL-NOT-FOUND)
 14193*    END-EXEC.
 14194*    MOVE '"$JI                  ! 4 #00013301' TO DFHEIV0
 14195     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14197     MOVE X'3420233030303133333031' TO DFHEIV0(25:11)
 14198     CALL 'kxdfhei1' USING DFHEIV0
 14199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14200
 14201
 14202
 14203* EXEC CICS READ
 14204*         DATASET(W-MAIL-FILE-ID)
 14205*         SET    (ADDRESS OF MAILING-DATA)
 14206*         RIDFLD (W-MAIL-KEY)
 14207*    END-EXEC.
 14208*    MOVE '&"S        E          (   #00013306' TO DFHEIV0
 14209     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14210     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14211     MOVE X'2020233030303133333036' TO DFHEIV0(25:11)
 14212     CALL 'kxdfhei1' USING DFHEIV0,
 14213           W-MAIL-FILE-ID,
 14214           DFHEIV20,
 14215           DFHEIV99,
 14216           W-MAIL-KEY,
 14217           DFHEIV99,
 14218           DFHEIV99,
 14219           DFHEIV99
 14220     SET ADDRESS OF MAILING-DATA TO
 14221         DFHEIV20
 14222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14223
 14224
 14225     MOVE MA-INSURED-LAST-NAME   TO W-NAME-LAST.
 14226     MOVE MA-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 14227     MOVE MA-INSURED-MIDDLE-INIT TO W-NAME-MIDDLE.
 14228     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 294
* EL689.cbl
 14229
 14230     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14231     MOVE WS-NAME-WORK           TO W-LABEL-LINES (1).
 14232     MOVE W-LABEL-JOINT-NAME     TO W-LABEL-LINES (2).
 14233     MOVE MA-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 14234     MOVE MA-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 14235*    MOVE MA-CITY-STATE          TO W-LABEL-LINES (5).
 14236     STRING MA-CITY ' ' MA-ADDR-STATE
 14237        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14238     END-STRING
 14239
 14240     MOVE MA-ZIP                 TO W-WORK-ZIP.
 14241     MOVE SPACES                 TO W-LABEL-ZIP (6).
 14242
 14243     IF  MA-CANADIAN-POST-CODE
 14244         MOVE MA-CANADIAN-POSTAL-CODE
 14245                                 TO W-CANADIAN-POSTAL-CODES
 14246         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14247         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14248         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14249                                    W-LAB-CAN-FILLER (6)
 14250     ELSE
 14251         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14252         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14253             MOVE '-'            TO W-LABEL-DASH (6)
 14254             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14255         ELSE
 14256             MOVE SPACES         TO W-LABEL-DASH (6)
 14257                                    W-LABEL-2ND-ZIP (6).
 14258
 14259     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14260
 14261     IF  ADDRSI EQUAL '5'
 14262             AND
 14263         PI-CREATE-LABELS
 14264             AND
 14265         NOT PI-689-LABELS-OVERRIDEN
 14266         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14267                                    W-VG-TEXT (31)
 14268         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14269                                    W-VG-TEXT (32)
 14270         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14271                                    W-VG-TEXT (33)
 14272         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14273                                    W-VG-TEXT (34)
 14274         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14275                                    W-VG-TEXT (35)
 14276         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14277                                    W-VG-TEXT (36)
 14278         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14279         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14280         SET W-RG-NDX UP BY +1
 14281     ELSE
 14282         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (31)
 14283         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (32)
 14284         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (33)
 14285         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (34)
 14286         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (35)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 295
* EL689.cbl
 14287         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (36).
 14288     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14289     MOVE MA-CRED-BENE-NAME      TO W-LABEL-LINES (1)
 14290     MOVE MA-CRED-BENE-ADDR      TO W-LABEL-LINES (2)
 14291     MOVE MA-CRED-BENE-ADDR2     TO W-LABEL-LINES (3)
 14292     STRING MA-CRED-BENE-CITY ' ' MA-CRED-BENE-STATE
 14293        DELIMITED BY '  ' INTO W-LABEL-LINES (4)
 14294     END-STRING
 14295
 14296     MOVE MA-CRED-BENE-ZIP       TO W-WORK-ZIP
 14297     MOVE SPACES                 TO W-LABEL-ZIP (5)
 14298
 14299     IF  MA-CB-CANADIAN-POST-CODE
 14300         MOVE MA-CB-CANADIAN-POSTAL-CODE
 14301                                 TO W-CANADIAN-POSTAL-CODES
 14302         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 14303         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 14304         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 14305                                    W-LAB-CAN-FILLER (5)
 14306     ELSE
 14307         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 14308         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14309             MOVE '-'            TO W-LABEL-DASH (5)
 14310             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 14311         ELSE
 14312             MOVE SPACES         TO W-LABEL-DASH (5)
 14313                                    W-LABEL-2ND-ZIP (5)
 14314         END-IF
 14315     END-IF
 14316     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT
 14317     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (37)
 14318     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (50)
 14319     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (51)
 14320     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (52)
 14321     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (53)
 14322     GO TO 6700-EXIT.
 14323
 14324 6700-MAIL-NOT-FOUND.
 14325
 14326     IF  ADDRSL GREATER ZERO
 14327         IF ADDRSI = '5'
 14328            MOVE ER-3000         TO EMI-ERROR
 14329            MOVE -1              TO ADDRSL
 14330            MOVE AL-UNBON        TO ADDRSA
 14331            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14332            GO TO 8200-SEND-DATAONLY.
 14333
 14334 6700-EXIT.
 14335     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 296
* EL689.cbl
 14337 6750-GET-LIFE-BENEFIT-DATA.
 14338
 14339     IF  W-FILE-NOT-USED (2)
 14340         GO TO 6750-EXIT.
 14341
 14342     MOVE SPACES                 TO W-CNTL-GEN2.
 14343
 14344     IF  DATASORI EQUAL '2'
 14345         IF  W-FILE-NOT-USED (8)
 14346             PERFORM 6450-READ-CERT-ONLY
 14347             IF  W-CERT-FOUND
 14348                 MOVE CM-LF-BENEFIT-CD
 14349                                 TO W-BEN-HOLD
 14350                                    W-CNTL-GEN2
 14351             ELSE
 14352                 NEXT SENTENCE
 14353         ELSE
 14354             MOVE CM-LF-BENEFIT-CD
 14355                                 TO W-BEN-HOLD
 14356                                    W-CNTL-GEN2
 14357     ELSE
 14358         IF  DATASORI EQUAL '4'
 14359             IF  W-FILE-NOT-USED (9)
 14360                 PERFORM 6400-READ-PNDB-ONLY
 14361                 IF  W-PNDB-FOUND
 14362                     IF  PI-689-TYPE = '1'
 14363                         MOVE PB-I-LF-BENEFIT-CD
 14364                                 TO W-BEN-HOLD
 14365                                    W-CNTL-GEN2
 14366                     ELSE
 14367                         MOVE PB-CI-LF-BENEFIT-CD
 14368                                 TO W-BEN-HOLD
 14369                                    W-CNTL-GEN2
 14370             ELSE
 14371                 NEXT SENTENCE
 14372         ELSE
 14373             IF  W-FILE-USED (8)
 14374                 MOVE CM-LF-BENEFIT-CD
 14375                                 TO W-BEN-HOLD
 14376                                    W-CNTL-GEN2
 14377             ELSE
 14378                 IF  W-FILE-USED (9)
 14379                     IF  PI-689-TYPE = '1'
 14380                         MOVE PB-I-LF-BENEFIT-CD
 14381                                 TO W-BEN-HOLD
 14382                                    W-CNTL-GEN2
 14383                     ELSE
 14384                         MOVE PB-CI-LF-BENEFIT-CD
 14385                                 TO W-BEN-HOLD
 14386                                    W-CNTL-GEN2.
 14387
 14388     IF  W-CNTL-GEN2 EQUAL SPACES
 14389         MOVE ER-9327            TO EMI-ERROR
 14390         MOVE -1                 TO MAINTL
 14391         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14392         GO TO 6750-EXIT.
 14393
 14394     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 297
* EL689.cbl
 14395     MOVE '4'                    TO W-CNTL-RECORD-TYPE.
 14396     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14397
 14398
 14399* EXEC CICS HANDLE CONDITION
 14400*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14401*         NOTFND  (6750-EXIT)
 14402*    END-EXEC.
 14403*    MOVE '"$JI                  ! 5 #00013485' TO DFHEIV0
 14404     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14406     MOVE X'3520233030303133343835' TO DFHEIV0(25:11)
 14407     CALL 'kxdfhei1' USING DFHEIV0
 14408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14409
 14410
 14411
 14412* EXEC CICS READ
 14413*         DATASET (W-CNTL-FILE-ID)
 14414*         SET     (ADDRESS OF CONTROL-FILE)
 14415*         GTEQ
 14416*         RIDFLD  (W-CNTL-KEY)
 14417*    END-EXEC.
 14418*    MOVE '&"S        G          (   #00013490' TO DFHEIV0
 14419     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14421     MOVE X'2020233030303133343930' TO DFHEIV0(25:11)
 14422     CALL 'kxdfhei1' USING DFHEIV0,
 14423           W-CNTL-FILE-ID,
 14424           DFHEIV20,
 14425           DFHEIV99,
 14426           W-CNTL-KEY,
 14427           DFHEIV99,
 14428           DFHEIV99,
 14429           DFHEIV99
 14430     SET ADDRESS OF CONTROL-FILE TO
 14431         DFHEIV20
 14432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14433
 14434
 14435     MOVE 1                      TO W-NDX.
 14436
 14437 6750-LOOP.
 14438
 14439     IF  W-NDX = 9
 14440         GO TO 6750-EXIT.
 14441
 14442     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14443         ADD 1                   TO W-NDX
 14444         GO TO 6750-LOOP.
 14445
 14446     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14447         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14448                                 TO W-VG-TEXT (11).
 14449
 14450 6750-EXIT.
 14451     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 298
* EL689.cbl
 14453 6800-GET-A-H-BENEFIT-DATA.
 14454
 14455     IF  W-FILE-NOT-USED (3)
 14456         GO TO 6800-EXIT.
 14457
 14458     MOVE SPACES                 TO W-CNTL-GEN2.
 14459
 14460     IF  DATASORI EQUAL '2'
 14461         IF  W-FILE-NOT-USED (8)
 14462             PERFORM 6450-READ-CERT-ONLY
 14463             IF  W-CERT-FOUND
 14464                 MOVE CM-AH-BENEFIT-CD
 14465                                 TO W-BEN-HOLD
 14466                                    W-CNTL-GEN2
 14467             ELSE
 14468                 NEXT SENTENCE
 14469         ELSE
 14470             MOVE CM-AH-BENEFIT-CD
 14471                                 TO W-BEN-HOLD
 14472                                    W-CNTL-GEN2
 14473     ELSE
 14474         IF  DATASORI EQUAL '4'
 14475             IF  W-FILE-NOT-USED (9)
 14476                 PERFORM 6400-READ-PNDB-ONLY
 14477                 IF  W-PNDB-FOUND
 14478                     IF  PI-689-TYPE = '1'
 14479                         MOVE PB-I-AH-BENEFIT-CD
 14480                                 TO W-BEN-HOLD
 14481                                    W-CNTL-GEN2
 14482                     ELSE
 14483                         MOVE PB-CI-AH-BENEFIT-CD
 14484                                 TO W-BEN-HOLD
 14485                                    W-CNTL-GEN2
 14486             ELSE
 14487                 NEXT SENTENCE
 14488         ELSE
 14489             IF  W-FILE-USED (8)
 14490                 MOVE CM-AH-BENEFIT-CD
 14491                                 TO W-BEN-HOLD
 14492                                    W-CNTL-GEN2
 14493             ELSE
 14494                 IF  W-FILE-USED (9)
 14495                     IF  PI-689-TYPE = '1'
 14496                         MOVE PB-I-AH-BENEFIT-CD
 14497                                 TO W-BEN-HOLD
 14498                                    W-CNTL-GEN2
 14499                     ELSE
 14500                         MOVE PB-CI-AH-BENEFIT-CD
 14501                                 TO W-BEN-HOLD
 14502                                    W-CNTL-GEN2.
 14503
 14504     IF  W-CNTL-GEN2 EQUAL SPACES
 14505         MOVE ER-9327            TO EMI-ERROR
 14506         MOVE -1                 TO MAINTL
 14507         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14508         GO TO 6800-EXIT.
 14509
 14510     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 299
* EL689.cbl
 14511     MOVE '5'                    TO W-CNTL-RECORD-TYPE.
 14512     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14513
 14514
 14515* EXEC CICS HANDLE CONDITION
 14516*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14517*         NOTFND  (6800-EXIT)
 14518*    END-EXEC.
 14519*    MOVE '"$JI                  ! 6 #00013576' TO DFHEIV0
 14520     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14522     MOVE X'3620233030303133353736' TO DFHEIV0(25:11)
 14523     CALL 'kxdfhei1' USING DFHEIV0
 14524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14525
 14526
 14527
 14528* EXEC CICS READ
 14529*         DATASET (W-CNTL-FILE-ID)
 14530*         SET     (ADDRESS OF CONTROL-FILE)
 14531*         RIDFLD  (W-CNTL-KEY)
 14532*         GTEQ
 14533*    END-EXEC.
 14534*    MOVE '&"S        G          (   #00013581' TO DFHEIV0
 14535     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14537     MOVE X'2020233030303133353831' TO DFHEIV0(25:11)
 14538     CALL 'kxdfhei1' USING DFHEIV0,
 14539           W-CNTL-FILE-ID,
 14540           DFHEIV20,
 14541           DFHEIV99,
 14542           W-CNTL-KEY,
 14543           DFHEIV99,
 14544           DFHEIV99,
 14545           DFHEIV99
 14546     SET ADDRESS OF CONTROL-FILE TO
 14547         DFHEIV20
 14548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14549
 14550
 14551     MOVE 1                      TO W-NDX.
 14552
 14553 6800-LOOP-AH.
 14554
 14555     IF  W-NDX = 9
 14556         GO TO 6800-EXIT.
 14557
 14558     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14559         ADD 1                   TO W-NDX
 14560         GO TO 6800-LOOP-AH.
 14561
 14562     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14563         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14564                                 TO W-VG-TEXT (15)
 14565         MOVE CF-BENEFIT-ALPHA (W-NDX)
 14566                                 TO W-BENEFIT-WORK
 14567         MOVE W-ELIM-DAYS        TO W-VG-TEXT (16).
 14568
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 300
* EL689.cbl
 14569 6800-EXIT.
 14570     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 301
* EL689.cbl
 14572 6850-GET-CHECK-DATA.
 14573
 14574     IF  ADDRSI EQUAL '6'
 14575             AND
 14576         PI-CREATE-LABELS
 14577             AND
 14578         NOT PI-689-LABELS-OVERRIDEN
 14579         NEXT SENTENCE
 14580     ELSE
 14581         IF  W-FILE-NOT-USED (12)
 14582             GO TO 6850-EXIT.
 14583
 14584     IF  W-CHEK-CERT-NO EQUAL LOW-VALUES
 14585         MOVE ER-9327            TO EMI-ERROR
 14586         MOVE -1                 TO MAINTL
 14587         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14588         GO TO 6850-EXIT.
 14589
 14590
 14591* EXEC CICS HANDLE CONDITION
 14592*         NOTOPEN (8045-CHEK-NOT-OPEN)
 14593*         NOTFND  (6850-CHEK-NOT-FOUND)
 14594*    END-EXEC.
 14595*    MOVE '"$JI                  ! 7 #00013627' TO DFHEIV0
 14596     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14597     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14598     MOVE X'3720233030303133363237' TO DFHEIV0(25:11)
 14599     CALL 'kxdfhei1' USING DFHEIV0
 14600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14601
 14602
 14603
 14604* EXEC CICS READ
 14605*         DATASET (W-CHEK-FILE-ID)
 14606*         SET     (ADDRESS OF CHECK-RECORDS)
 14607*         RIDFLD  (W-CHEK-KEY)
 14608*    END-EXEC.
 14609*    MOVE '&"S        E          (   #00013632' TO DFHEIV0
 14610     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14611     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14612     MOVE X'2020233030303133363332' TO DFHEIV0(25:11)
 14613     CALL 'kxdfhei1' USING DFHEIV0,
 14614           W-CHEK-FILE-ID,
 14615           DFHEIV20,
 14616           DFHEIV99,
 14617           W-CHEK-KEY,
 14618           DFHEIV99,
 14619           DFHEIV99,
 14620           DFHEIV99
 14621     SET ADDRESS OF CHECK-RECORDS TO
 14622         DFHEIV20
 14623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14624
 14625
 14626     MOVE CH-CHECK-NO            TO W-VG-TEXT (158).
 14627     MOVE CH-AMOUNT-PAID         TO W-EDIT-7-2.
 14628     MOVE W-EDIT-7-2             TO W-VG-TEXT (157).
 14629     MOVE CH-CHECK-QUE-CONTROL   TO W-DISPLAY-8
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 302
* EL689.cbl
 14630                                    PI-689-CONTROL.
 14631     MOVE W-DISPLAY-8            TO W-VG-TEXT (165).
 14632     MOVE CH-REASON-FOR-CHECK    TO W-VG-TEXT (166).
 14633
 14634     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14635     MOVE CH-PAYEE-NAME-1        TO W-LABEL-LINES (1).
 14636     MOVE CH-PAYEE-NAME-2        TO W-LABEL-LINES (2).
 14637     MOVE CH-PAYEE-ADDRESS-1     TO W-LABEL-LINES (3).
 14638     MOVE CH-PAYEE-ADDRESS-2     TO W-LABEL-LINES (4).
 14639     MOVE CH-PAYEE-CITY-ST       TO W-LABEL-LINES (5).
 14640
 14641     MOVE CH-PAYEE-ZIP           TO W-WORK-ZIP.
 14642     MOVE SPACES                 TO W-LABEL-ZIP (6).
 14643
 14644     IF  CH-CANADIAN-POST-CODE
 14645         MOVE CH-CANADIAN-POSTAL-CODE
 14646                                 TO W-CANADIAN-POSTAL-CODES
 14647         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14648         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14649         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14650                                    W-LAB-CAN-FILLER (6)
 14651     ELSE
 14652         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14653         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14654             MOVE '-'            TO W-LABEL-DASH (6)
 14655             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14656         ELSE
 14657             MOVE SPACES         TO W-LABEL-DASH (6)
 14658                                    W-LABEL-2ND-ZIP (6).
 14659
 14660     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14661
 14662     IF  ADDRSI EQUAL '6'
 14663             AND
 14664         PI-CREATE-LABELS
 14665             AND
 14666         NOT PI-689-LABELS-OVERRIDEN
 14667         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14668                                    W-VG-TEXT (159)
 14669         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14670                                    W-VG-TEXT (160)
 14671         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14672                                    W-VG-TEXT (161)
 14673         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14674                                    W-VG-TEXT (162)
 14675         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14676                                    W-VG-TEXT (163)
 14677         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14678                                    W-VG-TEXT (164)
 14679         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14680         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14681         SET W-RG-NDX UP BY +1
 14682     ELSE
 14683         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (159)
 14684         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (160)
 14685         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (161)
 14686         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (162)
 14687         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (163)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 303
* EL689.cbl
 14688         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (164).
 14689
 14690     GO TO 6850-EXIT.
 14691
 14692 6850-CHEK-NOT-FOUND.
 14693
 14694     IF  ADDRSL GREATER ZERO
 14695         IF ADDRSI = '6'
 14696            MOVE ER-2908         TO EMI-ERROR
 14697            MOVE -1              TO ADDRSL
 14698            MOVE AL-UNBON        TO ADDRSA
 14699            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14700            GO TO 8200-SEND-DATAONLY.
 14701
 14702 6850-EXIT.
 14703     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 304
* EL689.cbl
 14705 6900-GET-PYAJ-DATA.
 14706
 14707     IF  W-FILE-NOT-USED (13)
 14708         GO TO 6900-EXIT.
 14709
 14710     IF  W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 14711         MOVE ER-9327            TO EMI-ERROR
 14712         MOVE -1                 TO MAINTL
 14713         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14714         GO TO 6900-EXIT.
 14715
 14716
 14717* EXEC CICS HANDLE CONDITION
 14718*         NOTOPEN (8085-PYAJ-NOT-OPEN)
 14719*         NOTFND  (6900-PYAJ-NOT-FOUND)
 14720*    END-EXEC.
 14721*    MOVE '"$JI                  ! 8 #00013728' TO DFHEIV0
 14722     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14723     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14724     MOVE X'3820233030303133373238' TO DFHEIV0(25:11)
 14725     CALL 'kxdfhei1' USING DFHEIV0
 14726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14727
 14728
 14729 6900-READ-NEXT.
 14730
 14731
 14732* EXEC CICS READ
 14733*         DATASET (W-PYAJ-FILE-ID)
 14734*         SET     (ADDRESS OF PENDING-PAY-ADJ)
 14735*         RIDFLD  (W-PYAJ-KEY)
 14736*         GTEQ
 14737*    END-EXEC.
 14738*    MOVE '&"S        G          (   #00013735' TO DFHEIV0
 14739     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14740     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14741     MOVE X'2020233030303133373335' TO DFHEIV0(25:11)
 14742     CALL 'kxdfhei1' USING DFHEIV0,
 14743           W-PYAJ-FILE-ID,
 14744           DFHEIV20,
 14745           DFHEIV99,
 14746           W-PYAJ-KEY,
 14747           DFHEIV99,
 14748           DFHEIV99,
 14749           DFHEIV99
 14750     SET ADDRESS OF PENDING-PAY-ADJ TO
 14751         DFHEIV20
 14752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14753
 14754
 14755     IF  PY-COMPANY-CD NOT EQUAL W-PYAJ-COMPANY-CD
 14756             OR
 14757         PY-CARRIER NOT EQUAL W-PYAJ-CARRIER
 14758             OR
 14759         PY-GROUPING NOT EQUAL W-PYAJ-GROUPING
 14760             OR
 14761         PY-FIN-RESP NOT EQUAL W-PYAJ-FIN-RESP
 14762             OR
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 305
* EL689.cbl
 14763         PY-ACCOUNT NOT EQUAL W-PYAJ-ACCOUNT
 14764         GO TO 6900-PYAJ-NOT-FOUND.
 14765
 14766     IF  PI-689-SEQ-NO GREATER THAN ZEROS
 14767             AND
 14768         PY-FILE-SEQ-NO NOT EQUAL PI-689-SEQ-NO
 14769         GO TO 6900-PYAJ-NOT-FOUND.
 14770
 14771     IF  PY-RECORD-TYPE NOT EQUAL W-PYAJ-RECORD-TYPE
 14772         MOVE PY-CONTROL-PRIMARY TO W-PYAJ-KEY
 14773         ADD +1                  TO W-PYAJ-FILE-SEQ-NO
 14774         GO TO 6900-READ-NEXT.
 14775
 14776     MOVE PY-CHECK-NUMBER        TO W-DISPLAY-7.
 14777     MOVE W-DISPLAY-7            TO W-VG-TEXT (171).
 14778
 14779     MOVE PY-ENTRY-AMT           TO W-EDIT-7-2.
 14780     MOVE W-EDIT-7-2             TO W-VG-TEXT (170).
 14781
 14782     MOVE PY-CHECK-QUE-CONTROL   TO W-DISPLAY-8
 14783                                    PI-689-CONTROL.
 14784     MOVE W-DISPLAY-8            TO W-VG-TEXT (172).
 14785     MOVE PY-ENTRY-COMMENT       TO W-VG-TEXT (173).
 14786
 14787     GO TO 6900-EXIT.
 14788
 14789 6900-PYAJ-NOT-FOUND.
 14790
 14791     MOVE ER-7395                TO EMI-ERROR
 14792     MOVE -1                     TO DATASORL
 14793     MOVE AL-UNBON               TO DATASORA
 14794     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14795     GO TO 8200-SEND-DATAONLY.
 14796
 14797 6900-EXIT.
 14798     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 306
* EL689.cbl
 14800 6950-MOVE-SYSTEM-DATA.
 14801
 14802     IF  W-FILE-NOT-USED (7)
 14803         GO TO 6950-EXIT.
 14804
 14805     MOVE EIBDATE                TO W-DATE-WORK.
 14806     MOVE W-DT-WORK              TO DC-JULIAN-YYDDD.
 14807     MOVE '5'                    TO DC-OPTION-CODE.
 14808     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 14809     MOVE DC-GREG-DATE-1-EDIT    TO W-VG-TEXT (60).
 14810     MOVE DC-GREG-DATE-1-ALPHA   TO W-VG-TEXT (61).
 14811
 14812     MOVE FORMI                  TO W-VG-TEXT (62).
 14813
 14814     IF  PI-689-VARIABLE-DATA-1 GREATER THAN SPACES
 14815         MOVE PI-689-VARIABLE-DATA-1
 14816                                 TO W-VG-TEXT (63)
 14817         MOVE PI-689-VARIABLE-DATA-2
 14818                                 TO W-VG-TEXT (64)
 14819         MOVE PI-689-VARIABLE-DATA-3
 14820                                 TO W-VG-TEXT (65)
 14821         MOVE PI-689-VARIABLE-DATA-4
 14822                                 TO W-VG-TEXT (66)
 14823     ELSE
 14824         MOVE '(VARIABLE NOT PROVIDED)'
 14825                                 TO W-VG-TEXT (63).
 14826
 14827 6950-EXIT.
 14828     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 307
* EL689.cbl
 14830 7000-FORMAT-SCREEN.
 14831
 14832     IF  MAINTI EQUAL 'S'
 14833             OR
 14834         PI-SHOW-MODE
 14835         MOVE AL-PANOF           TO W-SC-TEXTA (W-SC-NDX)
 14836     ELSE
 14837         MOVE AL-UANOF           TO W-SC-TEXTA (W-SC-NDX).
 14838
 14839     IF  W-RG-NDX NOT GREATER THAN PI-689-NUMBER-LABEL-LINES
 14840         SET W-LINE23            TO W-RG-NDX
 14841         MOVE 'A'                TO W-LINE1
 14842     ELSE
 14843         SET W-LIN-NUM           TO W-RG-NDX
 14844         COMPUTE W-LIN-NUM
 14845             = W-LIN-NUM - PI-689-NUMBER-LABEL-LINES - 1.
 14846
 14847     MOVE W-LINE-NUM             TO W-SC-LINE (W-SC-NDX).
 14848     MOVE W-RC-TEXT (W-RG-NDX)   TO W-SC-TEXT (W-SC-NDX).
 14849     SET W-RG-NDX UP BY 1.
 14850
 14851 7000-EXIT.
 14852      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 308
* EL689.cbl
 14854 7100-FORMAT-LAST-NAME-1ST.
 14855*****************************************************************
 14856*             M O V E   N A M E   R O U T I N E                 *
 14857*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14858*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14859*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14860*                  FIELD                   VALUE                *
 14861*           W-NAME-LAST    (CL15)      SMITH                    *
 14862*           W-NAME-FIRST   (CL15)      JOHN                     *
 14863*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 14864*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14865*     CONTAIN                                                   *
 14866*                SMITH, JOHN ALLEN                              *
 14867*     OR                                                        *
 14868*                SMITH, JOHN A.                                 *
 14869*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14870*     COPYBOOK, ELCNWA.                                         *
 14871*****************************************************************.
 14872
 14873     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 14874     MOVE ZERO                   TO WS-NAME-SW.
 14875     SET NWA-INDEX               TO +1.
 14876
 14877     IF  W-NAME-LAST EQUAL SPACES
 14878             AND
 14879         W-NAME-MIDDLE EQUAL SPACES
 14880         MOVE +1                 TO WS-NAME-SW.
 14881
 14882     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14883     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 14884
 14885     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14886     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 14887
 14888     SET NWA-INDEX UP BY +1.
 14889
 14890     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 14891         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 14892             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14893             SET NWA-INDEX UP BY +1
 14894             MOVE '.'            TO WS-NW (NWA-INDEX)
 14895             SET NWA-INDEX UP BY +2
 14896         ELSE
 14897             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14898             PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 14899
 14900 7100-EXIT.
 14901     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 309
* EL689.cbl
 14903 7110-MOVE-NAME.
 14904
 14905     IF  WS-NAME-SW GREATER THAN +1
 14906         GO TO 7110-EXIT.
 14907
 14908     IF  WS-NAME-WORK2 = SPACES
 14909         GO TO 7110-EXIT.
 14910
 14911     SET NWA-INDEX2            TO +1.
 14912     SET NWA-INDEX3            TO +2.
 14913
 14914 7110-MOVE-NAME-CYCLE.
 14915
 14916     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 14917
 14918     IF  NWA-INDEX LESS THAN +30
 14919         SET NWA-INDEX UP BY +1
 14920     ELSE
 14921         ADD +2                TO WS-NAME-SW
 14922         GO TO 7110-EXIT.
 14923
 14924     IF  NWA-INDEX2 LESS THAN +20
 14925         SET NWA-INDEX3 UP BY +1
 14926         SET NWA-INDEX2 UP BY +1.
 14927
 14928     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 14929             AND
 14930         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 14931         IF  WS-NAME-SW EQUAL ZERO
 14932             MOVE ','            TO WS-NW (NWA-INDEX)
 14933             SET NWA-INDEX UP BY +2
 14934             MOVE +1             TO WS-NAME-SW
 14935             GO TO 7110-EXIT
 14936         ELSE
 14937             GO TO 7110-EXIT.
 14938
 14939     GO TO 7110-MOVE-NAME-CYCLE.
 14940
 14941 7110-EXIT.
 14942     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 310
* EL689.cbl
 14944 7200-FORMAT-NAME-STRAIGHT.
 14945*****************************************************************
 14946*           M O V E   N A M E   R O U T I N E                   *
 14947*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14948*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14949*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14950*                  FIELD                   VALUE                *
 14951*           W-NAME-LAST    (CL15)      SMITH                    *
 14952*           W-NAME-FIRST   (CL15)      JOHN                     *
 14953*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 14954*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14955*     CONTAIN                                                   *
 14956*              JOHN A. SMITH                                    *
 14957*     OR                                                        *
 14958*              JOHN ALLEN SMITH                                 *
 14959*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14960*     COPYBOOK, ELCNWA.                                         *
 14961*****************************************************************
 14962
 14963     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 14964     MOVE ZERO                   TO WS-NAME-SW.
 14965     SET NWA-INDEX               TO +1.
 14966
 14967     IF  W-NAME-FIRST EQUAL SPACES
 14968             AND
 14969         W-NAME-MIDDLE EQUAL SPACES
 14970         MOVE W-NAME-LAST        TO WS-NAME-WORK
 14971         GO TO 7200-EXIT.
 14972
 14973     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14974     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 14975
 14976     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 14977         SET NWA-INDEX UP BY +1
 14978
 14979         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 14980             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14981             SET NWA-INDEX UP BY +1
 14982             MOVE '.'            TO WS-NW (NWA-INDEX)
 14983             SET NWA-INDEX UP BY +1
 14984
 14985         ELSE
 14986             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14987             PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 14988
 14989     SET NWA-INDEX UP BY +1
 14990     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14991     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 14992
 14993 7200-EXIT.
 14994     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 311
* EL689.cbl
 14996 7290-MOVE-NAME.
 14997
 14998     IF  WS-NAME-SW GREATER THAN +1
 14999         GO TO 7290-EXIT.
 15000
 15001     IF  WS-NAME-WORK2 EQUAL SPACES
 15002         GO TO 7290-EXIT.
 15003
 15004     SET NWA-INDEX2            TO +1.
 15005     SET NWA-INDEX3            TO +2.
 15006
 15007 7290-MOVE-NAME-CYCLE.
 15008
 15009     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15010
 15011     IF  NWA-INDEX LESS THAN +30
 15012         SET NWA-INDEX UP BY +1
 15013     ELSE
 15014         ADD +2                TO WS-NAME-SW
 15015         GO TO 7290-EXIT.
 15016
 15017     IF  NWA-INDEX2 LESS THAN +20
 15018         SET NWA-INDEX2 UP BY +1
 15019         SET NWA-INDEX3 UP BY +1.
 15020
 15021     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 15022             AND
 15023         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 15024         GO TO 7290-EXIT.
 15025
 15026     GO TO 7290-MOVE-NAME-CYCLE.
 15027
 15028 7290-EXIT.
 15029     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 312
* EL689.cbl
 15031 7300-LABEL-MOVE.
 15032
 15033     IF  W-LABEL-HOLD-AREA = SPACES
 15034         MOVE +0                 TO W-NUMB-LABEL-LINES
 15035         GO TO 7300-EXIT.
 15036
 15037     IF  W-LABEL-LINES (1) = SPACES
 15038         MOVE W-LABEL-LINES (2)  TO W-LABEL-LINES (1)
 15039         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 15040         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15041         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15042         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15043         MOVE SPACES             TO W-LABEL-LINES (6)
 15044         GO TO 7300-LABEL-MOVE.
 15045
 15046     IF  W-LABEL-LINES (2) = SPACES
 15047             AND
 15048         W-LABEL-LINES (3) = SPACES
 15049             AND
 15050         W-LABEL-LINES (4) = SPACES
 15051             AND
 15052         W-LABEL-LINES (5) = SPACES
 15053             AND
 15054         W-LABEL-LINES (6) = SPACES
 15055         MOVE 1                  TO W-NDX
 15056                                    W-NUMB-LABEL-LINES
 15057         GO TO 7300-EXIT.
 15058
 15059 7300-TRY-2.
 15060
 15061     IF  W-LABEL-LINES (2) = SPACES
 15062         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 15063         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15064         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15065         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15066         MOVE SPACES             TO W-LABEL-LINES (6)
 15067         GO TO 7300-TRY-2.
 15068
 15069     IF  W-LABEL-LINES (3) = SPACES
 15070             AND
 15071         W-LABEL-LINES (4) = SPACES
 15072             AND
 15073         W-LABEL-LINES (5) = SPACES
 15074             AND
 15075         W-LABEL-LINES (6) = SPACES
 15076         MOVE 2                  TO W-NDX
 15077         GO TO 7300-MOVE-ZIP.
 15078
 15079 7300-TRY-3.
 15080
 15081     IF  W-LABEL-LINES (3) = SPACES
 15082         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15083         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15084         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15085         MOVE SPACES             TO W-LABEL-LINES (6)
 15086         GO TO 7300-TRY-3.
 15087
 15088     IF  W-LABEL-LINES (4) = SPACES
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 313
* EL689.cbl
 15089             AND
 15090         W-LABEL-LINES (5) = SPACES
 15091             AND
 15092         W-LABEL-LINES (6) = SPACES
 15093         MOVE 3                   TO W-NDX
 15094         GO TO 7300-MOVE-ZIP.
 15095
 15096 7300-TRY-4.
 15097
 15098     IF  W-LABEL-LINES (4) = SPACES
 15099         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15100         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15101         MOVE SPACES             TO W-LABEL-LINES (6)
 15102         GO TO 7300-TRY-4.
 15103
 15104     IF  W-LABEL-LINES (5) = SPACES
 15105             AND
 15106         W-LABEL-LINES (6) = SPACES
 15107         MOVE 4                  TO W-NDX
 15108         GO TO 7300-MOVE-ZIP.
 15109
 15110 7300-TRY-5.
 15111
 15112     IF  W-LABEL-LINES (5) = SPACES
 15113         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15114         MOVE SPACES             TO W-LABEL-LINES (6)
 15115         GO TO 7300-TRY-5
 15116     ELSE
 15117         IF  W-LABEL-LINES (6) = SPACES
 15118             MOVE 5              TO W-NDX
 15119             GO TO 7300-MOVE-ZIP
 15120         ELSE
 15121             MOVE 6              TO W-NDX.
 15122
 15123 7300-MOVE-ZIP.
 15124
 15125     COMPUTE W-NDX2 = W-NDX - 1.
 15126
 15127     IF  W-LAST-ZIP (W-NDX2) = SPACES
 15128*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 15129
 15130         IF  W-LABEL-1ST-ZIP (W-NDX) NUMERIC
 15131                 MOVE W-LABEL-ZIP (W-NDX)
 15132                                 TO W-LAST-ZIP (W-NDX2)
 15133                 MOVE SPACES     TO W-LABEL-LINES (W-NDX)
 15134                 MOVE W-NDX2     TO W-NUMB-LABEL-LINES
 15135                 GO TO 7300-EXIT.
 15136
 15137     MOVE W-NDX                  TO W-NUMB-LABEL-LINES.
 15138
 15139 7300-EXIT.
 15140     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 314
* EL689.cbl
 15142 7400-CREATE-LETTER.
 15143****************************************************************
 15144*    THIS AREA CONTROLS THE PROCESSING OF INDIVIDUAL INPUT     *
 15145*    RECORDS.                                                  *
 15146****************************************************************
 15147
 15148     SET W-SQ-NDX                TO W-START-COLUMN.
 15149     MOVE SPACES                 TO W-SQUEEZED-LINE
 15150                                    W-WORK-LINE.
 15151     MOVE W-START-COLUMN         TO W-LAST-SQUEEZED-SPACE
 15152     MOVE +1                     TO W-LAST-WC-SPACE.
 15153     MOVE HIGH-VALUES            TO W-LAST-SQ-CHAR.
 15154
 15155     SET W-TG-NDX                TO +1.
 15156
 15157     PERFORM 7410-TEXT-LINE-PROCESS THRU 7410-EXIT
 15158            VARYING
 15159         W-TG-NDX FROM W-TG-NDX BY +1
 15160            UNTIL
 15161         W-TG-NDX GREATER THAN W-TOTAL-TX-LINES.
 15162
 15163     IF  W-FORM-SQUEEZE-ON
 15164             AND
 15165         W-SQUEEZED-LINE GREATER THAN SPACES
 15166         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT.
 15167
 15168     PERFORM 7640-PAGING THRU 7640-EXIT.
 15169
 15170 7400-EXIT.
 15171     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 315
* EL689.cbl
 15173 7410-TEXT-LINE-PROCESS.
 15174***************************************************************
 15175*    THIS ROUTINE SEARCHES THE TEXT WORK AREA FOR ANY         *
 15176*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 15177*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 15178*    DATA THAT WAS GENERATED PREVIOUSLY.  WHILE PERFORMING    *
 15179*    THIS FUNCTION THE ROUTINE MOVES EACH CHARACTER OR ITS    *
 15180*    VARIABLE REPLACEMENT TO A WORK LINE.                     *
 15181***************************************************************
 15182
 15183
 15184     SET W-WC-NDX                TO W-ZEROS.
 15185     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15186
 15187     MOVE W-TX-SC (W-TG-NDX)     TO W-LINE-SQUEEZE-IND.
 15188
 15189     PERFORM 7420-TEXT-CHAR-PROCESS THRU 7420-EXIT
 15190             VARYING
 15191         W-TX-NDX FROM +1 BY +1
 15192             UNTIL
 15193         W-TX-NDX GREATER THAN +70.
 15194
 15195****************************************************************
 15196*    IF SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS    *
 15197*    EACH LINE OF TEXT IS PROCESSED ACCORDING TO THE INDICATED *
 15198*    LINE SQUEEZE CONTROL.                                     *
 15199****************************************************************
 15200     IF  W-FORM-SQUEEZE-ON
 15201
 15202         IF  W-WORK-LINE GREATER THAN SPACES
 15203                 OR
 15204             W-AS-IS
 15205             PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15206
 15207         ELSE
 15208             NEXT SENTENCE
 15209****************************************************************
 15210*    IF NO SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS *
 15211*    EACH LINE OF TEXT IS PRINT AS IS EXCEPT FOR VARIABLES     *
 15212****************************************************************
 15213     ELSE
 15214         IF  W-WORK-LINE GREATER THAN SPACES
 15215             MOVE W-TX-PC (W-TG-NDX)
 15216                                 TO W-PRINT-CONTROL
 15217             MOVE W-WORK-LINE    TO W-SQUEEZED-LINE
 15218             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15219             MOVE SPACES         TO W-WORK-LINE.
 15220
 15221 7410-EXIT.
 15222     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 316
* EL689.cbl
 15224 7420-TEXT-CHAR-PROCESS.
 15225****************************************************************
 15226*    LOOKING FOR VARIABLE INDICATORS (**XXX) THIS SECTION      *
 15227*    CONTROLS THE CONVERSION OF THESE INDICATORS INTO THEIR    *
 15228*    ACTUAL VALUES.  IT MOVES THESE REPLACEMENTS AND THE       *
 15229*    REMAINING CHARACTERS TO THE WORK LINE.                    *
 15230****************************************************************
 15231
 15232     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 15233             AND
 15234         W-LAST-CHAR EQUAL '@'
 15235         PERFORM 7430-PROCESS-VARIABLE THRU 7430-EXIT.
 15236
 15237     SET W-WC-NDX UP BY +1.
 15238
 15239     IF  W-WC-NDX GREATER THAN +70
 15240         IF  W-FORM-SQUEEZE-ON
 15241                 AND
 15242             NOT W-AS-IS
 15243             PERFORM 7440-BACK-TO-NEAREST-WORD THRU 7440-EXIT
 15244                     VARYING
 15245                 W-WC-NDX FROM W-LAST-WC-SPACE BY +1
 15246                     UNTIL
 15247                 W-WC-NDX EQUAL +71
 15248             SET W-TX-NDX        TO W-LAST-TX-SPACE
 15249
 15250             IF  W-WORK-LINE GREATER THAN SPACES
 15251                 PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15252                 MOVE SPACES     TO W-WORK-LINE
 15253                                    W-LINE-SQUEEZE-IND
 15254                 SET W-WC-NDX    TO +1
 15255             ELSE
 15256                 SET W-WC-NDX    TO +1
 15257         ELSE
 15258             PERFORM 7460-REMAIN-CHAR-CHECK THRU 7460-EXIT.
 15259
 15260     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15261                                 TO W-CHARACTER-TYPE.
 15262
 15263     SET W-WC-NDX2               TO W-WC-NDX.
 15264     SET W-WC-NDX2 DOWN BY +1.
 15265
 15266     IF  W-PUNCTUATION
 15267             AND
 15268         W-WC-NDX2 GREATER THAN W-ZEROS
 15269             AND
 15270         W-WORK-CHAR (W-WC-NDX2) EQUAL SPACES
 15271         SET W-WC-NDX DOWN BY +1.
 15272
 15273     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15274                                 TO W-LAST-CHAR
 15275                                    W-WORK-CHAR (W-WC-NDX).
 15276
 15277     IF  W-LAST-CHAR EQUAL SPACES
 15278         SET W-LAST-WC-SPACE     TO W-WC-NDX
 15279         SET W-LAST-TX-SPACE     TO W-TX-NDX.
 15280
 15281 7420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 317
* EL689.cbl
 15282     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 318
* EL689.cbl
 15284 7430-PROCESS-VARIABLE.
 15285******************************************************************
 15286*    THIS SECTION CHECKS ON ALL '@@XXX' FORMATED CHARACTER       *
 15287*    GROUPS.  IF IN PROPER FORMAT, EACH GROUP IS REPLACED WITH   *
 15288*    ITS CORRESPONDING VALUES.                                   *
 15289******************************************************************
 15290
 15291     SET W-TX-NDX UP BY +1.
 15292
 15293     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15294         MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15295                                 TO W-V1
 15296         SET W-TX-NDX UP BY +1
 15297
 15298         IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15299             MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15300                                 TO W-V2
 15301             SET W-TX-NDX UP BY +1
 15302             IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15303                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15304                                 TO W-V3
 15305                 SET W-TX-NDX UP BY +1
 15306                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15307                                 TO W-FIELD-SQUEEZE-IND
 15308                 GO TO 7430-CONTINUE
 15309             ELSE
 15310                 SET W-TX-NDX DOWN BY +3
 15311                 MOVE ER-0180    TO EMI-ERROR
 15312                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15313                 MOVE -1         TO MAINTL
 15314                 MOVE HIGH-VALUES
 15315                                 TO W-LAST-CHAR
 15316         ELSE
 15317             SET W-TX-NDX DOWN BY +2
 15318             MOVE ER-0180        TO EMI-ERROR
 15319             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15320             MOVE -1             TO MAINTL
 15321             MOVE HIGH-VALUES    TO W-LAST-CHAR
 15322     ELSE
 15323         SET W-TX-NDX DOWN BY +1
 15324         MOVE ER-7246            TO EMI-ERROR
 15325         MOVE -1                 TO MAINTL
 15326         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15327         MOVE HIGH-VALUES        TO W-LAST-CHAR.
 15328
 15329****************************************************************
 15330*    WHEN THE PROPER FORM IS NOT FOUND THE CHARACTERS INVOLVED *
 15331*    ARE TRANSFERRED INTACT AND A NOTE MADE INDICATING THIS    *
 15332*    ACTION.                                                   *
 15333****************************************************************
 15334
 15335     IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15336         MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15337         GO TO 7430-EXIT
 15338     ELSE
 15339         GO TO 7430-EXIT.
 15340
 15341 7430-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 319
* EL689.cbl
 15342
 15343     IF  W-VAR-RELATIVE-NUM LESS THAN 001
 15344             OR
 15345         W-VAR-RELATIVE-NUM GREATER THAN W-NUM-OF-VARIABLES
 15346         SET W-TX-NDX DOWN BY +4
 15347         MOVE ER-0180            TO EMI-ERROR
 15348         MOVE -1                 TO MAINTL
 15349         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15350         MOVE HIGH-VALUES        TO W-LAST-CHAR
 15351         IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15352             MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15353             GO TO 7430-EXIT
 15354         ELSE
 15355             GO TO 7430-EXIT.
 15356
 15357     SET W-VG-NDX                TO W-VAR-RELATIVE-NUM.
 15358
 15359     SET W-WC-NDX DOWN BY +1.
 15360
 15361     IF  (W-FORM-SQUEEZE-OFF
 15362                 AND
 15363             NOT W-SQUEEZE-FIELD)
 15364             OR
 15365         (W-FORM-SQUEEZE-ON
 15366                 AND
 15367             W-AS-IS)
 15368         PERFORM 7435-MOVE-VARIABLE-DIRECT THRU 7435-EXIT
 15369                 VARYING
 15370             W-VC-NDX FROM +1 BY +1
 15371                 UNTIL
 15372             W-VC-NDX GREATER THAN
 15373                 W-VARIABLE-SIZE (W-VG-NDX)
 15374
 15375         IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +5
 15376             SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15377             SET W-TX-NDX DOWN BY +5
 15378             IF  W-TX-NDX GREATER THAN +70
 15379                 SET W-TX-NDX    TO +70
 15380                 GO TO 7430-EXIT
 15381             ELSE
 15382                 GO TO 7430-EXIT
 15383         ELSE
 15384             COMPUTE W-ADJUST-SHORT
 15385                 = 5 - W-VARIABLE-SIZE (W-VG-NDX)
 15386             SET W-WC-NDX UP BY W-ADJUST-SHORT
 15387             GO TO 7430-EXIT.
 15388
 15389     IF  W-SQUEEZE-FIELD
 15390         SET W-TX-NDX UP BY +1.
 15391
 15392     MOVE SPACES                 TO W-FIRST-CHAR-FOUND-IND.
 15393
 15394     PERFORM 7470-MOVE-CHAR THRU 7470-EXIT
 15395             VARYING
 15396         W-VC-NDX FROM +1 BY +1
 15397             UNTIL
 15398         W-VC-NDX GREATER THAN
 15399             W-VARIABLE-SIZE (W-VG-NDX).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 320
* EL689.cbl
 15400
 15401     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15402
 15403     IF  W-FORM-SQUEEZE-ON
 15404         GO TO 7430-EXIT.
 15405
 15406     IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +6
 15407         SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15408         SET W-TX-NDX DOWN BY +6
 15409         IF  W-TX-NDX GREATER THAN +70
 15410             SET W-TX-NDX        TO +70.
 15411
 15412     IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 15413         SET W-WC-NDX DOWN BY +1.
 15414
 15415 7430-EXIT.
 15416     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 321
* EL689.cbl
 15418 7435-MOVE-VARIABLE-DIRECT.
 15419
 15420     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 15421             AND
 15422         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 15423             AND
 15424         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 15425             AND
 15426         (W-VC-NDX GREATER THAN +1
 15427                 AND
 15428             W-LAST-CHAR NOT EQUAL SPACE
 15429                 AND
 15430             NOT W-LAST-CHAR-PUNC)
 15431         IF  W-LC-USE-BOTH-CASES
 15432             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15433                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 15434         ELSE
 15435             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15436                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 15437
 15438     SET W-WC-NDX UP BY +1.
 15439     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15440                                 TO W-WORK-CHAR (W-WC-NDX)
 15441                                    W-LAST-CHAR.
 15442
 15443 7435-EXIT.
 15444     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 322
* EL689.cbl
 15446 7437-FIND-NEXT-CHARACTER.
 15447*DELIBERATELY LEFT BLANK.
 15448 7437-EXIT.
 15449     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 323
* EL689.cbl
 15451 7440-BACK-TO-NEAREST-WORD.
 15452
 15453     MOVE SPACES                 TO W-WORK-CHAR (W-WC-NDX).
 15454
 15455 7440-EXIT.
 15456     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 324
* EL689.cbl
 15458 7450-SQUEEZING.
 15459
 15460     IF  W-NEW-PARAGRAPH
 15461         PERFORM 7600-SET-PARA-INDENT THRU 7600-EXIT
 15462         MOVE SPACES             TO W-LINE-SQUEEZE-IND
 15463         IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15464             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15465             MOVE W-TX-PC (W-TG-NDX)
 15466                                 TO W-PRINT-CONTROL
 15467             MOVE SPACES         TO W-SQUEEZED-LINE
 15468             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15469             SET W-SQ-NDX UP BY W-WORK-INDENT
 15470         ELSE
 15471             MOVE W-TX-PC (W-TG-NDX)
 15472                                 TO W-PRINT-CONTROL
 15473             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15474             SET W-SQ-NDX UP BY W-WORK-INDENT
 15475     ELSE
 15476         IF  W-DO-NOT-ADJUST
 15477             MOVE SPACES         TO W-LINE-SQUEEZE-IND
 15478             IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15479                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15480                 MOVE W-WORK-LINE
 15481                                 TO W-SQUEEZED-LINE
 15482                 MOVE W-TX-PC (W-TG-NDX)
 15483                                 TO W-PRINT-CONTROL
 15484                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15485                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15486                 MOVE SPACES     TO W-SQUEEZED-LINE
 15487                 GO TO 7450-EXIT
 15488             ELSE
 15489                 MOVE W-WORK-LINE
 15490                                 TO W-SQUEEZED-LINE
 15491                 MOVE W-TX-PC (W-TG-NDX)
 15492                                 TO W-PRINT-CONTROL
 15493                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15494                 MOVE SPACES     TO W-SQUEEZED-LINE
 15495                                    W-WORK-LINE
 15496                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15497                 GO TO 7450-EXIT
 15498         ELSE
 15499             IF  W-ADJUST-TO-LINE-LENGTH
 15500                 MOVE SPACES     TO W-LINE-SQUEEZE-IND
 15501
 15502                 IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15503                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15504                     SET W-SQ-NDX
 15505                                 TO W-INITIAL-COLUMN
 15506                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15507                             VARYING
 15508                         W-WC-NDX FROM 1 BY 1
 15509                             UNTIL
 15510                         W-SQ-NDX EQUAL W-TOO-FAR
 15511                     MOVE W-TX-PC (W-TG-NDX)
 15512                                 TO W-PRINT-CONTROL
 15513                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15514                     SET W-SQ-NDX
 15515                                 TO W-INITIAL-COLUMN
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 325
* EL689.cbl
 15516                     MOVE SPACES TO W-SQUEEZED-LINE
 15517                                    W-WORK-LINE
 15518                     GO TO 7450-EXIT
 15519                 ELSE
 15520                     SET W-SQ-NDX
 15521                                 TO W-INITIAL-COLUMN
 15522                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15523                             VARYING
 15524                         W-WC-NDX FROM 1 BY 1
 15525                             UNTIL
 15526                         W-SQ-NDX EQUAL W-TOO-FAR
 15527                     MOVE W-TX-PC (W-TG-NDX)
 15528                                 TO W-PRINT-CONTROL
 15529                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15530                     MOVE SPACES TO W-SQUEEZED-LINE
 15531                                    W-WORK-LINE
 15532                     SET W-SQ-NDX
 15533                                 TO W-INITIAL-COLUMN
 15534                     GO TO 7450-EXIT
 15535             ELSE
 15536                 IF  W-CONTINUE-PARAGRAPH
 15537                     IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15538                         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15539                         PERFORM 7610-SET-CONP-INDENT
 15540                             THRU 7610-EXIT
 15541                         MOVE SPACES
 15542                                 TO W-LINE-SQUEEZE-IND
 15543                         MOVE W-TX-PC (W-TG-NDX)
 15544                                 TO W-PRINT-CONTROL
 15545                         MOVE SPACES
 15546                                 TO W-SQUEEZED-LINE
 15547                         SET W-SQ-NDX
 15548                                 TO W-INITIAL-COLUMN
 15549                         SET W-SQ-NDX UP BY W-WORK-INDENT
 15550                     ELSE
 15551                         PERFORM 7610-SET-CONP-INDENT
 15552                             THRU 7610-EXIT
 15553                         MOVE SPACES
 15554                                 TO W-LINE-SQUEEZE-IND
 15555                         MOVE W-TX-PC (W-TG-NDX)
 15556                                 TO W-PRINT-CONTROL
 15557                         MOVE SPACES
 15558                                 TO W-SQUEEZED-LINE
 15559                         SET W-SQ-NDX
 15560                                 TO W-INITIAL-COLUMN
 15561                         SET W-SQ-NDX UP BY W-WORK-INDENT.
 15562
 15563
 15564     PERFORM 7480-UPDATE-SQUEEZED-LINE THRU 7480-EXIT
 15565             VARYING
 15566         W-WC-NDX FROM +1 BY +1
 15567             UNTIL
 15568         W-WC-NDX GREATER THAN +70.
 15569
 15570 7450-EXIT.
 15571     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 326
* EL689.cbl
 15573 7460-REMAIN-CHAR-CHECK.
 15574
 15575     IF  W-TX-NDX EQUAL W-WC-NDX
 15576         MOVE W-TX-PC (W-TG-NDX)
 15577                                 TO W-PRINT-CONTROL
 15578         MOVE W-WORK-LINE        TO W-SQUEEZED-LINE
 15579         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15580         MOVE SPACES             TO W-WORK-LINE
 15581         SET W-WC-NDX            TO +1
 15582     ELSE
 15583         SET W-TX-NDX1           TO W-TX-NDX
 15584         SEARCH W-TX-CHAR
 15585             VARYING W-TX-NDX1
 15586             AT END
 15587                 MOVE W-TX-PC (W-TG-NDX)
 15588                                 TO W-PRINT-CONTROL
 15589                 MOVE W-WORK-LINE
 15590                                 TO W-SQUEEZED-LINE
 15591                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15592                 MOVE SPACES     TO W-WORK-LINE
 15593                 SET W-WC-NDX    TO +1
 15594                 SET W-TX-NDX    TO +1
 15595                 SET W-TG-NDX UP BY +1
 15596             WHEN
 15597                 W-TX-CHAR (W-TG-NDX W-TX-NDX1) NOT EQUAL SPACES
 15598                 MOVE ER-9427    TO EMI-ERROR
 15599                 MOVE -1         TO MAINTL
 15600                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15601                 MOVE W-TX-PC (W-TG-NDX)
 15602                                 TO W-PRINT-CONTROL
 15603                 MOVE W-WORK-LINE
 15604                                 TO W-SQUEEZED-LINE
 15605                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15606                 MOVE SPACES     TO W-WORK-LINE
 15607                 SET W-WC-NDX    TO +1.
 15608
 15609 7460-EXIT.
 15610     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 327
* EL689.cbl
 15612 7470-MOVE-CHAR.
 15613
 15614     IF  W-FIRST-CHAR-NOT-FOUND
 15615             AND
 15616         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 15617         MOVE SPACES             TO W-LAST-CHAR
 15618         GO TO 7470-EXIT.
 15619
 15620     MOVE 'Y'                    TO W-FIRST-CHAR-FOUND-IND.
 15621
 15622     IF  W-SQUEEZE-FIELD
 15623             AND
 15624         W-LAST-CHAR EQUAL SPACES
 15625             AND
 15626         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 15627         GO TO 7470-EXIT.
 15628
 15629     SET W-WC-NDX UP BY +1.
 15630
 15631     IF  W-WC-NDX GREATER THAN +70
 15632         IF  W-FORM-SQUEEZE-ON
 15633             GO TO 7470-EXIT
 15634         ELSE
 15635             MOVE ER-9427        TO EMI-ERROR
 15636             MOVE -1             TO MAINTL
 15637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15638             GO TO 7470-EXIT.
 15639
 15640     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 15641             AND
 15642         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 15643             AND
 15644         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 15645             AND
 15646         (W-VC-NDX GREATER THAN +1
 15647                 AND
 15648             W-LAST-CHAR NOT EQUAL SPACE
 15649                 AND
 15650             NOT W-LAST-CHAR-PUNC)
 15651         IF  W-LC-USE-BOTH-CASES
 15652             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15653                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 15654         ELSE
 15655             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15656                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 15657
 15658     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15659                                 TO W-WORK-CHAR (W-WC-NDX)
 15660                                    W-LAST-CHAR.
 15661
 15662     IF  W-LAST-CHAR EQUAL SPACES
 15663         SET W-LAST-WC-SPACE     TO W-WC-NDX.
 15664
 15665 7470-EXIT.
 15666     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 328
* EL689.cbl
 15668 7480-UPDATE-SQUEEZED-LINE.
 15669****************************************************************
 15670*    THIS SECTION CONTROLS THE MOVEMENT FROM THE WORK LINE TO *
 15671*    THE SQUEEZED LINE.  DURING THIS PROCESS ALL EXTRA SPACES  *
 15672*    (DEFINED AS TWO OR MORE SPACES NOT FOLLOWING A END OF     *
 15673*    SENTENCE INDICATOR) ARE REMOVED.  IF THE LAST CHARACTER   *
 15674*    IS NOT A SPACE OR PUNCTUATION MARK AN UNFINISHED WORD IS  *
 15675*    ASSUMED.  EVERYTHING TO THE PREVIOUS SPACE IS REMOVED     *
 15676****************************************************************
 15677
 15678     SET W-SQ-NDX UP BY +1.
 15679
 15680     IF  W-SQ-NDX GREATER THAN W-LAST-COLUMN
 15681         MOVE W-SQ-CHAR (W-LAST-COLUMN)
 15682                                 TO W-CHARACTER-TYPE
 15683         IF  W-PUNCTUATION
 15684                 OR
 15685             W-SPACE
 15686             PERFORM 7485-FIND-NEXT-CHARACTER THRU 7485-EXIT
 15687             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15688             MOVE SPACES         TO W-SQUEEZED-LINE
 15689             SET W-SQ-NDX        TO W-START-COLUMN
 15690             SET W-SQ-NDX UP BY W-NEXT-INDENT
 15691             SET W-LAST-SQUEEZED-SPACE
 15692                                 TO W-SQ-NDX
 15693         ELSE
 15694             PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 15695             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15696             MOVE SPACES         TO W-SQUEEZED-LINE
 15697             SET W-SQ-NDX        TO W-START-COLUMN
 15698             SET W-SQ-NDX UP BY W-NEXT-INDENT
 15699             SET W-LAST-SQUEEZED-SPACE
 15700                                 TO W-SQ-NDX.
 15701
 15702     IF  W-WC-NDX GREATER THAN +70
 15703         GO TO 7480-EXIT.
 15704
 15705     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 15706
 15707     IF  W-END-OF-SENTENCE
 15708         MOVE 'Y'                TO W-END-OF-SENTENCE-IND
 15709         SET W-WORK-NDX          TO W-SQ-NDX
 15710         COMPUTE W-DISPLAY-NDX = W-WORK-NDX - 1
 15711         IF  W-DISPLAY-NDX EQUAL W-LAST-SQUEEZED-SPACE
 15712             SET W-SQ-NDX        TO W-LAST-SQUEEZED-SPACE
 15713         ELSE
 15714             NEXT SENTENCE
 15715     ELSE
 15716         IF  W-PUNCTUATION
 15717                 AND
 15718             W-LAST-SQ-CHAR EQUAL SPACES
 15719             SET W-SQ-NDX DOWN BY +1
 15720             MOVE SPACES         TO W-END-OF-SENTENCE-IND
 15721         ELSE
 15722             IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 15723                 IF  W-LAST-SQ-CHAR EQUAL SPACES
 15724                     IF  W-END-OF-SENTENCE-WORKING
 15725                         MOVE SPACES
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 329
* EL689.cbl
 15726                                 TO W-END-OF-SENTENCE-IND
 15727                         SET W-LAST-SQUEEZED-SPACE
 15728                                 TO W-SQ-NDX
 15729                     ELSE
 15730                         SET W-SQ-NDX DOWN BY +1
 15731                         GO TO 7480-EXIT
 15732                 ELSE
 15733                     SET W-LAST-SQUEEZED-SPACE
 15734                                 TO W-SQ-NDX
 15735             ELSE
 15736                 MOVE SPACES     TO W-END-OF-SENTENCE-IND.
 15737
 15738     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX)
 15739                                    W-LAST-SQ-CHAR.
 15740
 15741     IF  W-WC-NDX EQUAL +70
 15742             AND
 15743         W-WORK-CHAR (W-WC-NDX) GREATER THAN SPACES
 15744             AND
 15745         W-SQ-NDX NOT EQUAL W-LAST-COLUMN
 15746         SET W-SQ-NDX UP BY +1
 15747         SET W-LAST-SQUEEZED-SPACE
 15748                                 TO W-SQ-NDX
 15749         MOVE SPACES             TO W-SQ-CHAR (W-SQ-NDX)
 15750                                    W-LAST-SQ-CHAR.
 15751
 15752 7480-EXIT.
 15753     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 330
* EL689.cbl
 15755 7485-FIND-NEXT-CHARACTER.
 15756
 15757     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 15758
 15759     IF  W-PUNCTUATION
 15760         PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 15761     ELSE
 15762         SET W-WC-NDX            TO W-WC-NDX
 15763         SEARCH W-WORK-CHAR
 15764             VARYING W-WC-NDX
 15765             AT END
 15766                 GO TO 7485-EXIT
 15767             WHEN
 15768                 W-WORK-CHAR (W-WC-NDX) NOT EQUAL SPACES
 15769                 GO TO 7485-EXIT.
 15770
 15771 7485-EXIT.
 15772     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 331
* EL689.cbl
 15774 7490-REMOVE-LAST-WORD.
 15775
 15776*********  NOTE: W-WORK-LINE ALWAYS STARTS WITH A FULL WORD*******
 15777     IF  W-WC-NDX EQUAL +1
 15778         GO TO 7490-EXIT.
 15779
 15780     ADD +1                      TO W-LAST-SQUEEZED-SPACE.
 15781
 15782     PERFORM 7500-CLEAR-SQUEEZED-EXCESS THRU 7500-EXIT
 15783             VARYING
 15784         W-SQ-NDX FROM W-LAST-SQUEEZED-SPACE BY +1
 15785             UNTIL
 15786         W-SQ-NDX EQUAL W-TOO-FAR.
 15787
 15788     SET W-WORK-NDX              TO W-WC-NDX.
 15789     COMPUTE W-LAST-WC-SPACE
 15790         = W-WORK-NDX - W-TOO-FAR + W-LAST-SQUEEZED-SPACE.
 15791     SET W-WC-NDX                TO W-LAST-WC-SPACE.
 15792
 15793 7490-EXIT.
 15794     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 332
* EL689.cbl
 15796 7500-CLEAR-SQUEEZED-EXCESS.
 15797
 15798     MOVE SPACES                 TO W-SQ-CHAR (W-SQ-NDX).
 15799
 15800 7500-EXIT.
 15801     EXIT.
 15802
 15803 7505-MOVE-STRAIGHT.
 15804
 15805     SET W-SQ-NDX UP BY +1.
 15806
 15807     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX).
 15808
 15809 7505-EXIT.
 15810     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 333
* EL689.cbl
 15812 7510-MOVE-TO-TABLE.
 15813
 15814     IF  W-PRINT-CONTROL NOT NUMERIC
 15815         MOVE 00                 TO W-PRINT-CONTROL
 15816         ADD +1                  TO W-LINE-COUNT
 15817     ELSE
 15818         IF  W-PRINT-CONTROL EQUAL 99
 15819             PERFORM 7640-PAGING THRU 7640-EXIT
 15820             MOVE 00             TO W-PRINT-CONTROL
 15821             SET W-RG-NDX UP BY +1
 15822             MOVE W-TOP-FORM     TO W-RC-TEXT (W-RG-NDX)
 15823             MOVE +1             TO W-LINE-COUNT
 15824             SET W-RG-NDX UP BY W-TOP-MARGIN
 15825         ELSE
 15826           IF W-SQUEEZED-LINE (1:6) NOT EQUAL '&&&&&&'
 15827             COMPUTE W-LINE-COUNT
 15828                 = W-LINE-COUNT + W-PRINT-CONTROL + 1.
 15829
 15830     IF  W-LINE-COUNT GREATER THAN W-MAX-LINES-PER-PAGE
 15831         PERFORM 7640-PAGING THRU 7640-EXIT
 15832         MOVE 00                 TO W-PRINT-CONTROL
 15833         SET W-RG-NDX UP BY +1
 15834         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 15835         SET W-RG-NDX UP BY W-TOP-MARGIN
 15836         MOVE +1                 TO W-LINE-COUNT.
 15837
 15838     SET W-RG-NDX UP BY W-PRINT-CONTROL.
 15839     SET W-RG-NDX UP BY +1.
 15840     MOVE W-SQUEEZED-LINE        TO W-RC-TEXT (W-RG-NDX).
 15841     MOVE 00                     TO W-PRINT-CONTROL.
 15842
 15843     IF  W-FIRST-BAD-VARIABLE-FOUND
 15844             AND
 15845         W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15846         SET W-FIRST-BAD-VARIABLE
 15847                                 TO W-RG-NDX.
 15848
 15849 7510-EXIT.
 15850     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 334
* EL689.cbl
 15852 7600-SET-PARA-INDENT.
 15853
 15854     IF  W-LINE-SQUEEZE-IND EQUAL 'P'
 15855         MOVE W-PARAGRAPH-INDENT TO W-WORK-INDENT
 15856     ELSE
 15857     IF  W-LINE-SQUEEZE-IND EQUAL 'Q'
 15858         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 15859         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15860     ELSE
 15861     IF  W-LINE-SQUEEZE-IND EQUAL 'R'
 15862         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 15863         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15864     ELSE
 15865     IF  W-LINE-SQUEEZE-IND EQUAL 'S'
 15866         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 15867         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15868     ELSE
 15869     IF  W-LINE-SQUEEZE-IND EQUAL 'T'
 15870         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 15871         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15872     ELSE
 15873     IF  W-LINE-SQUEEZE-IND EQUAL 'U'
 15874         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT
 15875         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT.
 15876
 15877     SET W-TG-NDX2               TO W-TG-NDX.
 15878     SET W-TG-NDX2 UP BY +1.
 15879
 15880     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 15881         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 15882     ELSE
 15883         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 15884
 15885 7600-EXIT.
 15886     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 335
* EL689.cbl
 15888 7610-SET-CONP-INDENT.
 15889
 15890     IF  W-LINE-SQUEEZE-IND EQUAL 'C'
 15891         MOVE +0                 TO W-WORK-INDENT
 15892     ELSE
 15893     IF  W-LINE-SQUEEZE-IND EQUAL 'D'
 15894         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 15895     ELSE
 15896     IF  W-LINE-SQUEEZE-IND EQUAL 'E'
 15897         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 15898     ELSE
 15899     IF  W-LINE-SQUEEZE-IND EQUAL 'F'
 15900         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 15901     ELSE
 15902     IF  W-LINE-SQUEEZE-IND EQUAL 'G'
 15903         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 15904     ELSE
 15905     IF  W-LINE-SQUEEZE-IND EQUAL 'H'
 15906         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT.
 15907
 15908     SET W-TG-NDX2               TO W-TG-NDX.
 15909     SET W-TG-NDX2 UP BY +1.
 15910
 15911     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 15912         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 15913     ELSE
 15914         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 15915
 15916 7610-EXIT.
 15917     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 336
* EL689.cbl
 15919 7630-NEXT-LINE.
 15920
 15921     IF  W-TX-SC (W-TG-NDX2) EQUAL ' '
 15922         MOVE ZEROS              TO W-NEXT-INDENT
 15923     ELSE
 15924     IF  W-TX-SC (W-TG-NDX2) EQUAL '1'
 15925         MOVE W-LINE-INDENT-1    TO W-NEXT-INDENT
 15926     ELSE
 15927     IF  W-TX-SC (W-TG-NDX2) EQUAL '2'
 15928         MOVE W-LINE-INDENT-2    TO W-NEXT-INDENT
 15929     ELSE
 15930     IF  W-TX-SC (W-TG-NDX2) EQUAL '3'
 15931         MOVE W-LINE-INDENT-3    TO W-NEXT-INDENT
 15932     ELSE
 15933     IF  W-TX-SC (W-TG-NDX2) EQUAL '4'
 15934         MOVE W-LINE-INDENT-4    TO W-NEXT-INDENT
 15935     ELSE
 15936     IF  W-TX-SC (W-TG-NDX2) EQUAL '5'
 15937         MOVE W-LINE-INDENT-5    TO W-NEXT-INDENT
 15938     ELSE
 15939         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 15940         SUBTRACT W-PARAGRAPH-INDENT
 15941                                  FROM W-NEXT-INDENT.
 15942
 15943 7630-EXIT.
 15944     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 337
* EL689.cbl
 15946 7640-PAGING.
 15947
 15948     IF  NOT W-LC-CREATE-PAGES
 15949         GO TO 7640-EXIT.
 15950
 15951     IF  W-LINE-COUNT GREATER ZEROS
 15952             AND
 15953         W-RG-NDX GREATER THAN +1
 15954         ADD +1                  TO W-PAGE
 15955         MOVE W-PAGE             TO W-PAGE-NUMBER
 15956         COMPUTE W-PAGE-LINE
 15957             = W-MAX-LINES-PER-PAGE - W-LINE-COUNT + 3
 15958         IF  W-PAGE-LINE GREATER THAN +2
 15959             SET W-RG-NDX UP BY W-PAGE-LINE
 15960             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX)
 15961         ELSE
 15962             SET W-RG-NDX UP BY +2
 15963             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX).
 15964
 15965 7640-EXIT.
 15966     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 338
* EL689.cbl
 15968 7700-READ-TEXT-TS.
 15969**************************************************************
 15970*  THIS PARAGRAPH READS THE TEMPORARY STORAGE RECORDS THAT   *
 15971*  CONTAIN THE TEXT THAT IS PAST BETWEEN EL689, EL6892       *
 15972*  AND EL1042.                                               *
 15973**************************************************************
 15974
 15975
 15976* EXEC CICS HANDLE CONDITION
 15977*         QIDERR     (7700-TS-ERROR)
 15978*         ITEMERR    (7700-TS-ERROR)
 15979*    END-EXEC.
 15980*    MOVE '"$N<                  ! 9 #00014962' TO DFHEIV0
 15981     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 15982     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15983     MOVE X'3920233030303134393632' TO DFHEIV0(25:11)
 15984     CALL 'kxdfhei1' USING DFHEIV0
 15985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15986
 15987
 15988     SET W-TS-NDX                TO 1.
 15989     MOVE 1                      TO W-TS-ITEM.
 15990
 15991 7700-LOOP.
 15992
 15993     IF  W-TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS
 15994         IF  PI-TEMP-STOR-ITEMS GREATER THAN ZEROS
 15995             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 15996             GO TO 7700-EXIT
 15997         ELSE
 15998             GO TO 7700-EXIT.
 15999
 16000
 16001* EXEC CICS READQ TS
 16002*         INTO     (W-TS-WORK-AREA)
 16003*         QUEUE    (W-TS-NAME-TEXT)
 16004*         LENGTH   (W-TS-LENGTH)
 16005*         ITEM     (W-TS-ITEM)
 16006*    END-EXEC.
 16007*    MOVE '*$II   L              ''   #00014979' TO DFHEIV0
 16008     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 16009     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16010     MOVE X'2020233030303134393739' TO DFHEIV0(25:11)
 16011     CALL 'kxdfhei1' USING DFHEIV0,
 16012           W-TS-NAME-TEXT,
 16013           W-TS-WORK-AREA,
 16014           W-TS-LENGTH,
 16015           W-TS-ITEM,
 16016           DFHEIV99,
 16017           DFHEIV99
 16018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16019
 16020
 16021     MOVE W-TS-WORK-AREA         TO W-TS-GROUP (W-TS-NDX).
 16022     SET W-TS-NDX UP BY 1.
 16023     ADD 1                       TO W-TS-ITEM.
 16024     GO TO 7700-LOOP.
 16025
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 339
* EL689.cbl
 16026 7700-TS-ERROR.
 16027
 16028     IF  EIBTRNID = W-TRANSACTION OR 'EX14'
 16029         MOVE ER-0033            TO EMI-ERROR
 16030         MOVE -1                 TO MAINTL
 16031         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16032         GO TO 8200-SEND-DATAONLY.
 16033
 16034 7700-EXIT.
 16035      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 340
* EL689.cbl
 16037 7740-RESTORE-SCREEN.
 16038
 16039     MOVE 'C'                    TO MAINTI.
 16040     MOVE +1                     TO MAINTL.
 16041     MOVE AL-UANON               TO MAINTA.
 16042
 16043     MOVE PI-689-FORM-NUMBER     TO FORMI.
 16044     MOVE +4                     TO FORML.
 16045     MOVE AL-UANON               TO FORMA.
 16046
 16047*    IF  PI-689-PRINT-RESTRICTION GREATER THAN SPACES
 16048*        MOVE PI-689-PRINT-RESTRICTION
 16049*                                TO PRTRESTL
 16050*        MOVE +1                 TO PRTRESTL
 16051*        MOVE AL-UANON           TO PRTRESTA.
 16052
 16053     IF  PI-689-FOLLOW-UP-EDIT GREATER THAN SPACES
 16054         MOVE PI-689-FOLLOW-UP-EDIT
 16055                                 TO FOLLOWI
 16056         MOVE +8                 TO FOLLOWL
 16057         MOVE AL-UANON           TO FOLLOWA.
 16058
 16059     IF  PI-689-RESEND1-EDIT GREATER THAN SPACES
 16060         MOVE PI-689-RESEND1-EDIT
 16061                                 TO RESEND1I
 16062         MOVE +8                 TO RESEND1L
 16063         MOVE AL-UANON           TO RESEND1A.
 16064     IF  PI-689-ALT-PRINTER-ID GREATER THAN SPACES
 16065         MOVE PI-689-ALT-PRINTER-ID
 16066                                 TO PRINTERI
 16067         MOVE +1                 TO PRINTERL
 16068         MOVE AL-UANON           TO PRINTERA.
 16069
 16070     IF  PI-BYPASS-LABELS
 16071          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 16072          MOVE +1                TO ADDRLBLL
 16073          MOVE AL-UANON          TO ADDRLBLA
 16074     ELSE
 16075          IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 16076               MOVE PI-689-LBL-OVERRIDE
 16077                                 TO ADDRLBLI
 16078               MOVE +1           TO ADDRLBLL
 16079               MOVE AL-UANON     TO ADDRLBLA.
 16080
 16081     IF  PI-689-NUMBER-COPIES GREATER THAN ZEROS
 16082         MOVE PI-689-NUMBER-COPIES   TO COPIESI
 16083         MOVE +1                     TO COPIESL
 16084         MOVE AL-UNNON               TO COPIESA.
 16085
 16086     IF  PI-689-LABEL-SOURCE GREATER THAN SPACES
 16087         MOVE PI-689-LABEL-SOURCE
 16088                                 TO ADDRSI
 16089         MOVE +1                 TO ADDRSL
 16090         MOVE AL-UANON           TO ADDRSA.
 16091
 16092     MOVE PI-689-DATA-SOURCE     TO DATASORI.
 16093     MOVE +1                     TO DATASORL.
 16094     MOVE AL-UANON               TO DATASORA.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 341
* EL689.cbl
 16095
 16096     IF  PI-689-CARRIER GREATER THAN SPACES
 16097         MOVE PI-689-CARRIER     TO CARRIERI
 16098         MOVE +1                 TO CARRIERL
 16099         MOVE AL-UANON           TO CARRIERA.
 16100
 16101     IF  PI-689-GROUPING GREATER THAN SPACES
 16102         MOVE PI-689-GROUPING    TO GROUPI
 16103         MOVE +6                 TO GROUPL
 16104         MOVE AL-UANON           TO GROUPA.
 16105
 16106     IF  PI-689-STATE GREATER THAN SPACES
 16107         MOVE PI-689-STATE       TO STATEI
 16108         MOVE +2                 TO STATEL
 16109         MOVE AL-UANON           TO STATEA.
 16110
 16111     IF  PI-689-ACCOUNT GREATER THAN SPACES
 16112         MOVE PI-689-ACCOUNT     TO ACCTI
 16113         MOVE +10                TO ACCTL
 16114         MOVE AL-UANON           TO ACCTA.
 16115
 16116     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 16117         MOVE PI-689-CERT-PRIME  TO CERTI
 16118         MOVE +10                TO CERTL
 16119         MOVE AL-UANON           TO CERTA.
 16120
 16121     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 16122         MOVE PI-689-CERT-SFX    TO SFXI
 16123         MOVE +1                 TO SFXL
 16124         MOVE AL-UANON           TO SFXA.
 16125
 16126     IF  PI-689-TYPE GREATER THAN SPACES
 16127         MOVE PI-689-TYPE        TO TYPEI
 16128         MOVE +1                 TO TYPEL
 16129         MOVE AL-UANON           TO TYPEA.
 16130
 16131     IF  PI-689-RESP-PERSON GREATER THAN SPACES
 16132         MOVE PI-689-RESP-PERSON TO RPERSONI
 16133         MOVE +10                TO RPERSONL
 16134         MOVE AL-UANON           TO RPERSONA.
 16135
 16136     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 16137         MOVE PI-689-ENTRY-BATCH TO BENTRYI
 16138         MOVE +6                 TO BENTRYL
 16139         MOVE AL-UANON           TO BENTRYA.
 16140
 16141     IF  PI-689-SEQ-EDIT GREATER THAN SPACES
 16142         MOVE PI-689-SEQ-EDIT    TO SEQI
 16143         MOVE +8                 TO SEQL
 16144         MOVE AL-UNNON           TO SEQA.
 16145
 16146     IF  PI-689-BCSEQ-EDIT GREATER THAN SPACES
 16147         MOVE PI-689-BCSEQ-EDIT  TO BCSEQI
 16148         MOVE +4                 TO BCSEQL
 16149         MOVE AL-UNNON           TO BCSEQA.
 16150
 16151     IF  PI-689-DATE-EDIT GREATER THAN SPACES
 16152         MOVE PI-689-DATE-EDIT   TO DATEI
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 342
* EL689.cbl
 16153         MOVE +8                 TO DATEL
 16154         MOVE AL-UNNON           TO DATEA.
 16155
 16156     IF PI-CERT-FORM-ID GREATER THAN SPACES
 16157        MOVE PI-CERT-FORM-ID     TO CERTIDI
 16158        MOVE +5                  TO CERTIDL
 16159        MOVE AL-UNNON            TO CERTIDA
 16160     END-IF.
 16161
 16162     IF PI-PRINT-NOW GREATER THAN SPACES
 16163        MOVE PI-PRINT-NOW        TO PRTNOWI
 16164        MOVE +1                  TO PRTNOWL
 16165        MOVE AL-UNNON            TO PRTNOWA
 16166     END-IF.
 16167     IF PI-ENDT-ARCH-NO GREATER THAN ZERO
 16168        MOVE PI-ENDT-ARCH-NO     TO ENDARCHI
 16169        MOVE +8                  TO ENDARCHL
 16170        MOVE AL-UNNON            TO ENDARCHA
 16171     END-IF
 16172
 16173     MOVE PI-ENCLOSURE-CD        TO ENCI.
 16174     MOVE +3                     TO ENCL.
 16175     MOVE AL-UANON               TO ENCA.
 16176
 16177 7749-EXIT.
 16178     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 343
* EL689.cbl
 16180 7760-PUT-TEMP-STORAGE.
 16181**************************************************************
 16182*  THIS PARAGRAPH WRITES THE TEMPORARY STORAGE RECORDS THAT  *
 16183*  WILL CONTAIN THE CONTENTS OF THE TEXT TABLE FOR USE BY    *
 16184*  EL1042 AND EL6892.                                        *
 16185**************************************************************
 16186
 16187     SET W-TS-NDX                TO 1.
 16188     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16189
 16190     MOVE -1                     TO MAINTL.
 16191     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16192             VARYING
 16193         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16194             UNTIL
 16195         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16196
 16197 7760-EXIT.
 16198      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 344
* EL689.cbl
 16200 7780-DELETE-TEMP-STOR-TEXT.
 16201
 16202
 16203* EXEC CICS HANDLE CONDITION
 16204*         QIDERR      (7780-EXIT)
 16205*    END-EXEC.
 16206*    MOVE '"$N                   ! : #00015167' TO DFHEIV0
 16207     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 16208     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16209     MOVE X'3A20233030303135313637' TO DFHEIV0(25:11)
 16210     CALL 'kxdfhei1' USING DFHEIV0
 16211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16212
 16213
 16214
 16215* EXEC CICS DELETEQ TS
 16216*         QUEUE       (W-TS-NAME-TEXT)
 16217*    END-EXEC.
 16218*    MOVE '*&                    #   #00015171' TO DFHEIV0
 16219     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 16220     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16221     MOVE X'2020233030303135313731' TO DFHEIV0(25:11)
 16222     CALL 'kxdfhei1' USING DFHEIV0,
 16223           W-TS-NAME-TEXT,
 16224           DFHEIV99
 16225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16226
 16227
 16228 7780-EXIT.
 16229     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 345
* EL689.cbl
 16231 7840-WRITE-TS.
 16232
 16233     MOVE W-TS-GROUP (W-TS-NDX)  TO W-TS-WORK-AREA.
 16234     SET W-TS-NDX UP BY 1.
 16235     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 16236
 16237
 16238* EXEC CICS WRITEQ TS
 16239*         FROM    (W-TS-WORK-AREA)
 16240*         QUEUE   (W-TS-NAME-TEXT)
 16241*         LENGTH  (W-TS-LENGTH)
 16242*         ITEM    (PI-TEMP-STOR-ITEMS)
 16243*    END-EXEC.
 16244*    MOVE '*" I                  ''   #00015184' TO DFHEIV0
 16245     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 16246     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16247     MOVE X'2020233030303135313834' TO DFHEIV0(25:11)
 16248     CALL 'kxdfhei1' USING DFHEIV0,
 16249           W-TS-NAME-TEXT,
 16250           W-TS-WORK-AREA,
 16251           W-TS-LENGTH,
 16252           PI-TEMP-STOR-ITEMS,
 16253           DFHEIV99,
 16254           DFHEIV99
 16255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16256
 16257
 16258 7840-EXIT.
 16259     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 346
* EL689.cbl
 16261 7900-PRINT-LETTER-NOW.
 16262***************************************************************
 16263*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 16264*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 16265*     THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS.          *
 16266*     THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE.       *
 16267*     THE LETTER IS SAVED IN TEMP-STORAGE AND A START IS      *
 16268*     ISSUED FOR THE PRINT TRANSACTION.                       *
 16269***************************************************************
 16270
 16271*    IF (EIBAID = DFHPF4 OR DFHPF8)
 16272*            AND
 16273*        PI-SHOW-MODE
 16274*        IF  PRINTERL GREATER ZERO
 16275*            INSPECT PRINTERI CONVERTING W-LOWER-CASE TO
 16276*                                                    W-UPPER-CASE
 16277*            MOVE PRINTERI       TO PI-689-ALT-PRINTER-ID
 16278*                                   PI-ALT-DMD-PRT-ID.
 16279*
 16280*    IF  EIBAID EQUAL DFHPF8
 16281*            AND
 16282*        PI-SHOW-MODE
 16283*            AND
 16284*        LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
 16285*        MOVE ER-7247            TO EMI-ERROR
 16286*        MOVE -1                 TO MAINTL
 16287*        MOVE AL-UABON           TO MAINTA
 16288*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16289*        GO TO 8200-SEND-DATAONLY.
 16290
 16291     IF  PI-TOTAL-LINES EQUAL 0
 16292         MOVE ER-0187            TO EMI-ERROR
 16293         MOVE -1                 TO MAINTL
 16294         MOVE AL-UABON           TO MAINTA
 16295         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16296         GO TO 8200-SEND-DATAONLY.
 16297
 16298     IF  EMI-ERROR NOT EQUAL ER-0191
 16299         IF  PI-689-CREATE-NO-SCREENS
 16300*                OR
 16301*            (EIBAID = DFHPF4 OR DFHPF8)
 16302             SET W-RG-NDX        TO +1
 16303         ELSE
 16304             PERFORM 4100-SET-NDX THRU 4100-EXIT
 16305             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16306                     VARYING
 16307                 W-SC-NDX FROM 1 BY 1
 16308                     UNTIL
 16309                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 16310
 16311     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 16312
 16313     IF EIBAID NOT = DFHPF4 AND DFHPF8
 16314         PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 16315                 VARYING
 16316             W-RVS-NDX FROM +1 BY +1
 16317                 UNTIL
 16318             W-RVS-NDX GREATER THAN +36500
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 347
* EL689.cbl
 16319                 OR
 16320             W-REMAINING-VAR-FOUND
 16321         IF  W-REMAINING-VAR-FOUND
 16322             GO TO 4000-ROLL-PAGE.
 16323
 16324*    IF EIBAID = DFHPF4 OR DFHPF8
 16325*       PERFORM 7700-READ-TEXT-TS
 16326*                                THRU 7700-EXIT
 16327*
 16328*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 16329*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16330*                VARYING
 16331*            W-SC-NDX FROM 1 BY 1
 16332*                UNTIL
 16333*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 16334*
 16335*       PERFORM 7760-PUT-TEMP-STORAGE
 16336*                                THRU 7760-EXIT
 16337*    END-IF
 16338     IF PI-689-ALT-PRINTER-ID NOT = SPACES AND LOW-VALUES
 16339         MOVE PI-689-ALT-PRINTER-ID
 16340                                 TO W-TS-TERM-TEXT
 16341     ELSE
 16342         IF PI-PROCESSOR-PRINTER NOT = SPACES AND LOW-VALUES
 16343             MOVE PI-PROCESSOR-PRINTER
 16344                                 TO W-TS-TERM-TEXT
 16345         ELSE
 16346             MOVE PI-COMPANY-ID  TO W-CNTL-COMPANY-ID
 16347             MOVE '1'            TO W-CNTL-RECORD-TYPE
 16348             MOVE SPACES         TO W-CNTL-GENL
 16349             MOVE ZEROS          TO W-CNTL-SEQ-NO
 16350
 16351* EXEC CICS HANDLE CONDITION
 16352*                 NOTOPEN    (8040-CNTL-NOT-OPEN)
 16353*                 NOTFND     (7945-NOT-FOUND)
 16354*            END-EXEC
 16355*    MOVE '"$JI                  ! ; #00015283' TO DFHEIV0
 16356     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 16357     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16358     MOVE X'3B20233030303135323833' TO DFHEIV0(25:11)
 16359     CALL 'kxdfhei1' USING DFHEIV0
 16360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16361
 16362* EXEC CICS READ
 16363*                 DATASET    (W-CNTL-FILE-ID)
 16364*                 SET        (ADDRESS OF CONTROL-FILE)
 16365*                 RIDFLD     (W-CNTL-KEY)
 16366*            END-EXEC
 16367*    MOVE '&"S        E          (   #00015287' TO DFHEIV0
 16368     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16369     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16370     MOVE X'2020233030303135323837' TO DFHEIV0(25:11)
 16371     CALL 'kxdfhei1' USING DFHEIV0,
 16372           W-CNTL-FILE-ID,
 16373           DFHEIV20,
 16374           DFHEIV99,
 16375           W-CNTL-KEY,
 16376           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 348
* EL689.cbl
 16377           DFHEIV99,
 16378           DFHEIV99
 16379     SET ADDRESS OF CONTROL-FILE TO
 16380         DFHEIV20
 16381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16382             MOVE CF-FORMS-PRINTER-ID
 16383                                 TO W-TS-TERM-TEXT.
 16384
 16385***********************************************************
 16386*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 16387*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 16388***********************************************************
 16389
 16390     SET W-TS-NDX                TO 1.
 16391     MOVE EIBTIME                TO W-TS-ID-TIME.
 16392     MOVE W-TS-NAME-TEXT         TO PI-689-TEMP-STOR-ID.
 16393     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16394
 16395     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16396             VARYING
 16397         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16398             UNTIL
 16399         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16400
 16401*    IF  EIBAID EQUAL DFHPF8
 16402*        MOVE '1'                TO PI-689-PRINT-SW
 16403*    ELSE
 16404         MOVE SPACES             TO PI-689-PRINT-SW.
 16405
 16406
 16407* EXEC CICS HANDLE CONDITION
 16408*         TERMIDERR  (7935-TERM-ERROR)
 16409*         TRANSIDERR (7940-TRAN-ERROR)
 16410*    END-EXEC.
 16411*    MOVE '"$[\                  ! < #00015316' TO DFHEIV0
 16412     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 16413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16414     MOVE X'3C20233030303135333136' TO DFHEIV0(25:11)
 16415     CALL 'kxdfhei1' USING DFHEIV0
 16416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16417
 16418
 16419
 16420* EXEC CICS START
 16421*             INTERVAL    (0)
 16422*             TRANSID     (W-PRINT-TRANS)
 16423*             FROM        (PROGRAM-INTERFACE-BLOCK)
 16424*             LENGTH      (PI-COMM-LENGTH)
 16425*             TERMID      (W-TS-TERM-TEXT)
 16426*    END-EXEC.
 16427     MOVE 0 TO DFHEIV10
 16428*    MOVE '0(ILFT                1   #00015321' TO DFHEIV0
 16429     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 16430     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
 16431     MOVE X'2020233030303135333231' TO DFHEIV0(25:11)
 16432     CALL 'kxdfhei1' USING DFHEIV0,
 16433           DFHEIV10,
 16434           W-PRINT-TRANS,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 349
* EL689.cbl
 16435           DFHEIV99,
 16436           PROGRAM-INTERFACE-BLOCK,
 16437           PI-COMM-LENGTH,
 16438           W-TS-TERM-TEXT,
 16439           DFHEIV99,
 16440           DFHEIV99,
 16441           DFHEIV99,
 16442           DFHEIV99,
 16443           DFHEIV99,
 16444           DFHEIV99,
 16445           DFHEIV99,
 16446           DFHEIV99,
 16447           DFHEIV99,
 16448           DFHEIV99
 16449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16450
 16451
 16452
 16453* EXEC CICS SYNCPOINT
 16454*    END-EXEC.
 16455*    MOVE '6"                    !   #00015329' TO DFHEIV0
 16456     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
 16457     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16458     MOVE X'2020233030303135333239' TO DFHEIV0(25:11)
 16459     CALL 'kxdfhei1' USING DFHEIV0
 16460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16461
 16462
 16463     IF  PI-689-CREATE-NO-SCREENS
 16464         GO TO 7900-EXIT.
 16465
 16466*    IF  EIBAID EQUAL DFHPF8
 16467*            AND
 16468*        PI-SHOW-MODE
 16469*            AND
 16470*        LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
 16471*        PERFORM 7920-UPDATE-INITIAL-PRINT THRU 7920-EXIT.
 16472
 16473     MOVE ER-0189                TO EMI-ERROR.
 16474     MOVE -1                     TO MAINTL.
 16475
 16476     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16477     MOVE -1                     TO MAINTL
 16478     MOVE AL-UABON               TO MAINTA
 16479     MOVE '104A'                 TO W-TS-ID-TEXT
 16480     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 16481                                    W-TS-TERM-SCREEN
 16482     GO TO 8200-SEND-DATAONLY.
 16483
 16484 7900-EXIT.
 16485     EXIT.
 16486
 16487 7915-SEARCH-REMAINING-VARS.
 16488
 16489     IF  W-REC-CHAR (W-RVS-NDX) EQUAL '@'
 16490         SET W-RVS-NDX2          TO W-RVS-NDX
 16491         SET W-RVS-NDX2 UP BY +1
 16492         IF  W-REC-CHAR (W-RVS-NDX2) EQUAL '@'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 350
* EL689.cbl
 16493             SET W-RVS-NDX2 UP BY +1
 16494             IF  W-REC-CHAR (W-RVS-NDX2) NUMERIC
 16495                 SET PI-CURRENT-LINE  TO W-RVS-NDX
 16496                 COMPUTE PI-CURRENT-LINE
 16497                     = PI-CURRENT-LINE / 73
 16498                 MOVE 'Y'        TO W-REMAINING-VAR-SW
 16499                 MOVE +0         TO W-ROLL-COUNTER
 16500                 MOVE ER-0191    TO EMI-ERROR
 16501                 MOVE -1         TO MAINTL
 16502                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16503
 16504 7915-EXIT.
 16505     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 351
* EL689.cbl
 16507 7920-UPDATE-INITIAL-PRINT.
 16508
 16509
 16510* EXEC CICS HANDLE CONDITION
 16511*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 16512*         NOTFND     (1070-ARCH-NOT-FOUND)
 16513*         ENDFILE    (1070-ARCH-NOT-FOUND)
 16514*    END-EXEC.
 16515*    MOVE '"$JI''                 ! = #00015378' TO DFHEIV0
 16516     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 16517     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16518     MOVE X'3D20233030303135333738' TO DFHEIV0(25:11)
 16519     CALL 'kxdfhei1' USING DFHEIV0
 16520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16521
 16522     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
 16523     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 16524
 16525* EXEC CICS READ
 16526*        DATASET (W-ARCH-FILE-ID)
 16527*        SET     (ADDRESS OF LETTER-ARCHIVE)
 16528*        RIDFLD  (W-ARCH-PARTIAL-KEY)
 16529*        UPDATE
 16530*    END-EXEC.
 16531*    MOVE '&"S        EU         (   #00015385' TO DFHEIV0
 16532     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16533     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16534     MOVE X'2020233030303135333835' TO DFHEIV0(25:11)
 16535     CALL 'kxdfhei1' USING DFHEIV0,
 16536           W-ARCH-FILE-ID,
 16537           DFHEIV20,
 16538           DFHEIV99,
 16539           W-ARCH-PARTIAL-KEY,
 16540           DFHEIV99,
 16541           DFHEIV99,
 16542           DFHEIV99
 16543     SET ADDRESS OF LETTER-ARCHIVE TO
 16544         DFHEIV20
 16545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16546
 16547
 16548     MOVE W-SAVE-BIN-DATE        TO LA-INITIAL-PRINT-DATE.
 16549
 16550     IF  LA-RESEND-DATE = LOW-VALUES
 16551         MOVE 'C'                TO LA-STATUS.
 16552
 16553
 16554* EXEC CICS REWRITE
 16555*         FROM      (LETTER-ARCHIVE)
 16556*         DATASET   (W-ARCH-FILE-ID)
 16557*    END-EXEC.
 16558     MOVE LENGTH OF
 16559      LETTER-ARCHIVE
 16560       TO DFHEIV11
 16561*    MOVE '&& L                  %   #00015397' TO DFHEIV0
 16562     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16563     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16564     MOVE X'2020233030303135333937' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 352
* EL689.cbl
 16565     CALL 'kxdfhei1' USING DFHEIV0,
 16566           W-ARCH-FILE-ID,
 16567           LETTER-ARCHIVE,
 16568           DFHEIV11,
 16569           DFHEIV99
 16570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16571
 16572
 16573 7920-EXIT.
 16574     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 353
* EL689.cbl
 16576 7935-TERM-ERROR.
 16577
 16578     MOVE ER-0412                TO EMI-ERROR.
 16579     MOVE SPACES                 TO PI-689-PRINT-SW.
 16580     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16581     MOVE -1                     TO MAINTL.
 16582     GO TO 8200-SEND-DATAONLY.
 16583
 16584 7940-TRAN-ERROR.
 16585
 16586     MOVE ER-0413                TO EMI-ERROR.
 16587     MOVE SPACES                 TO PI-689-PRINT-SW.
 16588     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16589     MOVE -1                     TO MAINTL.
 16590     GO TO 8200-SEND-DATAONLY.
 16591
 16592 7945-NOT-FOUND.
 16593
 16594     MOVE ER-0190                TO EMI-ERROR.
 16595     MOVE -1                     TO MAINTL.
 16596     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16597     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 354
* EL689.cbl
 16599 8010-ARCH-NOT-OPEN.
 16600
 16601     MOVE ER-7388                TO EMI-ERROR.
 16602     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16603     MOVE -1                     TO MAINTL.
 16604     GO TO 8200-SEND-DATAONLY.
 16605
 16606 8015-ARCT-NOT-OPEN.
 16607
 16608     MOVE ER-7373                TO EMI-ERROR.
 16609     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16610     MOVE -1                     TO MAINTL.
 16611     GO TO 8200-SEND-DATAONLY.
 16612
 16613 8020-ACCT-NOT-OPEN.
 16614
 16615     MOVE ER-0168 TO EMI-ERROR
 16616     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16617     MOVE -1                     TO MAINTL.
 16618     GO TO 8200-SEND-DATAONLY.
 16619
 16620 8030-CERT-NOT-OPEN.
 16621
 16622     MOVE ER-0169 TO EMI-ERROR.
 16623     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16624     MOVE -1                     TO MAINTL.
 16625     GO TO 8200-SEND-DATAONLY.
 16626
 16627 8035-CERT-NOT-FOUND.
 16628
 16629     MOVE ER-2369 TO EMI-ERROR.
 16630     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16631     MOVE -1                     TO MAINTL.
 16632     GO TO 8200-SEND-DATAONLY.
 16633
 16634 8040-CNTL-NOT-OPEN.
 16635
 16636     MOVE ER-0042                TO EMI-ERROR.
 16637     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16638     MOVE -1                     TO MAINTL.
 16639     GO TO 8200-SEND-DATAONLY.
 16640
 16641 8045-CHEK-NOT-OPEN.
 16642
 16643     MOVE ER-3775                TO EMI-ERROR.
 16644     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16645     MOVE -1                     TO MAINTL.
 16646     GO TO 8200-SEND-DATAONLY.
 16647
 16648 8050-TEXT-NOT-OPEN.
 16649
 16650     MOVE ER-0013                TO EMI-ERROR.
 16651     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16652     MOVE -1                     TO MAINTL.
 16653     GO TO 8200-SEND-DATAONLY.
 16654
 16655 8060-PNDB-NOT-OPEN.
 16656
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 355
* EL689.cbl
 16657     MOVE ER-2216 TO EMI-ERROR.
 16658     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16659     MOVE -1                     TO MAINTL.
 16660     GO TO 8200-SEND-DATAONLY.
 16661
 16662 8070-PNDB-NOT-FOUND.
 16663
 16664     MOVE ER-7374 TO EMI-ERROR.
 16665     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16666     MOVE -1                     TO MAINTL.
 16667     GO TO 8200-SEND-DATAONLY.
 16668
 16669 8080-COMP-NOT-OPEN.
 16670
 16671     MOVE ER-2055 TO EMI-ERROR
 16672     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16673     MOVE -1                     TO MAINTL.
 16674     GO TO 8200-SEND-DATAONLY.
 16675
 16676 8085-PYAJ-NOT-OPEN.
 16677
 16678     MOVE ER-2232 TO EMI-ERROR
 16679     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16680     MOVE -1                     TO MAINTL.
 16681     GO TO 8200-SEND-DATAONLY.
 16682
 16683 8090-MAIL-NOT-OPEN.
 16684
 16685     MOVE ER-2999                TO EMI-ERROR.
 16686     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16687     MOVE -1                     TO MAINTL.
 16688     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 356
* EL689.cbl
 16690 8100-SEND-INITIAL-MAP.
 16691
 16692     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 16693     IF  PI-689-CREATE-NO-SCREENS
 16694         MOVE '9999'             TO PI-689-ERROR
 16695         GO TO 0620-RETURN-TO-CALLER.
 16696
 16697     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 16698
 16699     IF  NOT EMI-NO-ERRORS
 16700         MOVE EMI-MESSAGE-AREA (1)
 16701                                 TO ERRMSGO
 16702     ELSE
 16703         MOVE SPACES             TO ERRMSGO.
 16704     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 16705                                 TO SYSO
 16706     MOVE WS-KIXHOST             TO HOSTO
 16707     IF PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR 'CAGB'
 16708        OR 'DLVA' OR 'ECCA' OR 'KRHA'
 16709        MOVE AL-SADOF            TO PF8HDA
 16710     END-IF
 16711     IF NOT PI-CREATE-LABELS
 16712         MOVE AL-PANON           TO ADDRLBLA.
 16713
 16714
 16715* EXEC CICS SEND
 16716*        MAP    (W-MAP)
 16717*        MAPSET (W-MAPSET)
 16718*        FROM   (EL689AO)
 16719*        ERASE
 16720*        CURSOR
 16721*    END-EXEC.
 16722     MOVE LENGTH OF
 16723      EL689AO
 16724       TO DFHEIV12
 16725     MOVE -1
 16726       TO DFHEIV11
 16727*    MOVE '8$     CT  E    H L F ,   #00015543' TO DFHEIV0
 16728     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16729     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16730     MOVE X'2020233030303135353433' TO DFHEIV0(25:11)
 16731     CALL 'kxdfhei1' USING DFHEIV0,
 16732           W-MAP,
 16733           EL689AO,
 16734           DFHEIV12,
 16735           W-MAPSET,
 16736           DFHEIV99,
 16737           DFHEIV99,
 16738           DFHEIV99,
 16739           DFHEIV11,
 16740           DFHEIV99,
 16741           DFHEIV99,
 16742           DFHEIV99
 16743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16744
 16745
 16746     GO TO 9000-RETURN-TRANS.
 16747
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 357
* EL689.cbl
 16748 8100-EXIT.
 16749     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 358
* EL689.cbl
 16751 8200-SEND-DATAONLY.
 16752
 16753     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 16754     IF  PI-689-CREATE-NO-SCREENS
 16755         MOVE '9999'             TO PI-689-ERROR
 16756         GO TO 0620-RETURN-TO-CALLER.
 16757
 16758     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 16759
 16760     IF EMI-ERROR = ER-0715
 16761         DISPLAY 'ER 0715'
 16762         MOVE -1          TO CERTIDL
 16763         MOVE +0          TO MAINTL
 16764     END-IF
 16765
 16766     IF  NOT EMI-NO-ERRORS
 16767         MOVE EMI-MESSAGE-AREA (1)
 16768                                 TO ERRMSGO
 16769     ELSE
 16770         MOVE SPACES             TO ERRMSGO.
 16771
 16772
 16773* EXEC CICS SEND
 16774*        MAP    (W-MAP)
 16775*        MAPSET (W-MAPSET)
 16776*        FROM   (EL689AO)
 16777*        DATAONLY
 16778*        CURSOR
 16779*    END-EXEC.
 16780     MOVE LENGTH OF
 16781      EL689AO
 16782       TO DFHEIV12
 16783     MOVE -1
 16784       TO DFHEIV11
 16785*    MOVE '8$D    CT       H L F ,   #00015577' TO DFHEIV0
 16786     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16787     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16788     MOVE X'2020233030303135353737' TO DFHEIV0(25:11)
 16789     CALL 'kxdfhei1' USING DFHEIV0,
 16790           W-MAP,
 16791           EL689AO,
 16792           DFHEIV12,
 16793           W-MAPSET,
 16794           DFHEIV99,
 16795           DFHEIV99,
 16796           DFHEIV99,
 16797           DFHEIV11,
 16798           DFHEIV99,
 16799           DFHEIV99,
 16800           DFHEIV99
 16801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16802
 16803
 16804     GO TO 9000-RETURN-TRANS.
 16805
 16806 8200-EXIT.
 16807     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 359
* EL689.cbl
 16809 8300-SEND-TEXT.
 16810
 16811     IF  PI-689-CREATE-NO-SCREENS
 16812         MOVE '9999'             TO PI-689-ERROR
 16813         GO TO 0620-RETURN-TO-CALLER.
 16814
 16815
 16816* EXEC CICS SEND TEXT
 16817*        FROM    (LOGOFF-TEXT)
 16818*        LENGTH  (LOGOFF-LENGTH)
 16819*        ERASE
 16820*        FREEKB
 16821*    END-EXEC.
 16822*    MOVE '8&      T  E F  H   F -   #00015596' TO DFHEIV0
 16823     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16824     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16825     MOVE X'2020233030303135353936' TO DFHEIV0(25:11)
 16826     CALL 'kxdfhei1' USING DFHEIV0,
 16827           LOGOFF-TEXT,
 16828           LOGOFF-LENGTH,
 16829           DFHEIV99,
 16830           DFHEIV99,
 16831           DFHEIV99,
 16832           DFHEIV99,
 16833           DFHEIV99,
 16834           DFHEIV99,
 16835           DFHEIV99,
 16836           DFHEIV99,
 16837           DFHEIV99,
 16838           DFHEIV99
 16839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16840
 16841
 16842     GO TO 9000-RETURN-TRANS.
 16843
 16844 8300-EXIT.
 16845     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 360
* EL689.cbl
 16847 8350-SEND-DATAONLY-ERASEAUP.
 16848
 16849     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 16850     PERFORM 7760-PUT-TEMP-STORAGE
 16851                                 THRU 7760-EXIT
 16852     IF  PI-689-CREATE-NO-SCREENS
 16853         MOVE '9999'             TO PI-689-ERROR
 16854         GO TO 0620-RETURN-TO-CALLER.
 16855
 16856     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 16857
 16858     IF EMI-ERROR = ER-0715
 16859         DISPLAY 'ER 0715'
 16860         MOVE -1          TO CERTIDL
 16861         MOVE +0          TO MAINTL
 16862     END-IF
 16863
 16864     IF  NOT EMI-NO-ERRORS
 16865         MOVE EMI-MESSAGE-AREA (1)
 16866                                 TO ERRMSGO
 16867     ELSE
 16868         MOVE SPACES             TO ERRMSGO.
 16869
 16870
 16871* EXEC CICS SEND
 16872*        MAP      (W-MAP)
 16873*        MAPSET   (W-MAPSET)
 16874*        FROM     (EL689AO)
 16875*        DATAONLY
 16876*        ERASEAUP
 16877*        CURSOR
 16878*    END-EXEC.
 16879     MOVE LENGTH OF
 16880      EL689AO
 16881       TO DFHEIV12
 16882     MOVE -1
 16883       TO DFHEIV11
 16884*    MOVE '8$D    CT  A    H L F ,   #00015631' TO DFHEIV0
 16885     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 16886     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16887     MOVE X'2020233030303135363331' TO DFHEIV0(25:11)
 16888     CALL 'kxdfhei1' USING DFHEIV0,
 16889           W-MAP,
 16890           EL689AO,
 16891           DFHEIV12,
 16892           W-MAPSET,
 16893           DFHEIV99,
 16894           DFHEIV99,
 16895           DFHEIV99,
 16896           DFHEIV11,
 16897           DFHEIV99,
 16898           DFHEIV99,
 16899           DFHEIV99
 16900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16901
 16902
 16903     GO TO 9000-RETURN-TRANS.
 16904
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 361
* EL689.cbl
 16905 8350-EXIT.
 16906     EXIT.
 16907
 16908 8600-DEEDIT.
 16909
 16910
 16911* EXEC CICS BIF DEEDIT
 16912*         FIELD    (W-DEEDIT-FIELD)
 16913*         LENGTH   (15)
 16914*    END-EXEC.
 16915     MOVE 15
 16916       TO DFHEIV11
 16917*    MOVE '@"L                   #   #00015647' TO DFHEIV0
 16918     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 16919     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16920     MOVE X'2020233030303135363437' TO DFHEIV0(25:11)
 16921     CALL 'kxdfhei1' USING DFHEIV0,
 16922           W-DEEDIT-FIELD,
 16923           DFHEIV11
 16924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16925
 16926
 16927 8600-EXIT.
 16928     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 362
* EL689.cbl
 16930 9000-RETURN-TRANS.
 16931
 16932     MOVE EMI-FATAL-CTR      TO PI-689-FATAL-CTR
 16933     MOVE EMI-FORCABLE-CTR   TO PI-689-FORCABLE-CTR
 16934     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 16935     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
 16936
 16937* EXEC CICS RETURN
 16938*        TRANSID    (W-TRANSACTION)
 16939*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 16940*        LENGTH     (PI-COMM-LENGTH)
 16941*    END-EXEC.
 16942*    MOVE '.(CT                  ''   #00015661' TO DFHEIV0
 16943     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16944     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16945     MOVE X'2020233030303135363631' TO DFHEIV0(25:11)
 16946     CALL 'kxdfhei1' USING DFHEIV0,
 16947           W-TRANSACTION,
 16948           PROGRAM-INTERFACE-BLOCK,
 16949           PI-COMM-LENGTH,
 16950           DFHEIV99,
 16951           DFHEIV99,
 16952           DFHEIV99
 16953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16954
 16955*    MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 16956*    MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16957*    GO TO 0200-RECEIVE.
 16958
 16959 9000-EXIT.
 16960     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 363
* EL689.cbl
 16962 9200-PA.
 16963
 16964     MOVE ER-0008                TO EMI-ERROR.
 16965     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16966     MOVE -1                     TO MAINTL.
 16967     GO TO 8200-SEND-DATAONLY.
 16968
 16969 9200-EXIT.
 16970     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 364
* EL689.cbl
 16972 9300-DFHCLEAR.
 16973
 16974     IF PI-RETURN-TO-PROGRAM = 'EL689' OR 'EL690'
 16975         MOVE '2'                TO PI-ACTION.
 16976
 16977     IF  PI-CLEAR-MODE
 16978         MOVE PI-RETURN-TO-PROGRAM
 16979                                 TO W-CALL-PGM
 16980         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 16981         GO TO 9400-XCTL
 16982     ELSE
 16983         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 16984         MOVE LOW-VALUES         TO EL689AO
 16985                                    PI-1042-WA
 16986                                    PI-689-WORK-AREA
 16987         MOVE ZEROS              TO PI-CURRENT-LINE
 16988                                    PI-TEMP-STOR-ITEMS
 16989                                    PI-TOTAL-LINES
 16990                                    PI-UPDATE-SW
 16991                                    PI-689-NUMBER-LABEL-LINES
 16992         MOVE SPACES             TO PI-689-PRINT-SW
 16993                                    PI-689-ALT-PRINTER-ID
 16994                                    PI-COMM-CONTROL
 16995                                    PI-689-FORM-NUMBER
 16996                                    PI-689-TEMP-STOR-ID
 16997                                    PI-689-LABEL-SOURCE
 16998                                    PI-689-USE-SCREEN-IND
 16999         MOVE '2'                TO PI-ACTION
 17000         MOVE -1                 TO MAINTL
 17001         GO TO 8100-SEND-INITIAL-MAP.
 17002
 17003 9300-EXIT.
 17004     EXIT.
 17005
 17006 9400-XCTL.
 17007
 17008
 17009* EXEC CICS XCTL
 17010*        PROGRAM  (W-CALL-PGM)
 17011*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 17012*        LENGTH   (PI-COMM-LENGTH)
 17013*    END-EXEC.
 17014*    MOVE '.$C                   %   #00015719' TO DFHEIV0
 17015     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17016     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17017     MOVE X'2020233030303135373139' TO DFHEIV0(25:11)
 17018     CALL 'kxdfhei1' USING DFHEIV0,
 17019           W-CALL-PGM,
 17020           PROGRAM-INTERFACE-BLOCK,
 17021           PI-COMM-LENGTH,
 17022           DFHEIV99
 17023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17024
 17025
 17026 9400-EXIT.
 17027     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 365
* EL689.cbl
 17029 9500-LINK-DATE-CONVERT.
 17030
 17031     IF  DC-BIN-DATE-1 EQUAL HIGH-VALUES
 17032             AND
 17033         DC-OPTION-CODE EQUAL ' '
 17034         MOVE '99/99/99'         TO DC-GREG-DATE-1-EDIT
 17035         GO TO 9500-EXIT.
 17036
 17037
 17038* EXEC CICS LINK
 17039*        PROGRAM    ('ELDATCV')
 17040*        COMMAREA   (DATE-CONVERSION-DATA)
 17041*        LENGTH     (DC-COMM-LENGTH)
 17042*    END-EXEC.
 17043     MOVE 'ELDATCV' TO DFHEIV1
 17044*    MOVE '."C                   (   #00015736' TO DFHEIV0
 17045     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17046     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17047     MOVE X'2020233030303135373336' TO DFHEIV0(25:11)
 17048     CALL 'kxdfhei1' USING DFHEIV0,
 17049           DFHEIV1,
 17050           DATE-CONVERSION-DATA,
 17051           DC-COMM-LENGTH,
 17052           DFHEIV99,
 17053           DFHEIV99,
 17054           DFHEIV99,
 17055           DFHEIV99
 17056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17057
 17058
 17059     IF  NO-CONVERSION-ERROR
 17060             AND
 17061         PI-COMPANY-ID EQUAL 'AUK'
 17062             AND
 17063         W-REVERSE-DATE
 17064         MOVE DC-GREG-DATE-1-EDIT
 17065                                 TO W-EDIT-DATE-1
 17066         MOVE W-ED1-MM           TO W-ED2-MM
 17067         MOVE W-ED1-DD           TO W-ED2-DD
 17068         MOVE W-ED1-YY           TO W-ED2-YY
 17069         MOVE W-EDIT-DATE-2      TO DC-GREG-DATE-1-EDIT.
 17070
 17071 9500-EXIT.
 17072     EXIT.
 17073
 17074 9600-FORMAT-DATE-TIME.
 17075
 17076     MOVE W-SAVE-DATE            TO RUNDTEO.
 17077     MOVE EIBTIME                TO W-TIME-IN.
 17078     MOVE W-TIME-OUT             TO RUNTIMEO.
 17079     MOVE PI-COMPANY-ID          TO COMPANYO.
 17080     MOVE PI-PROCESSOR-ID        TO USERIDO.
 17081     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 17082
 17083 9600-EXIT.
 17084     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 366
* EL689.cbl
 17086 9700-PGMID-ERROR.
 17087
 17088     IF  PI-689-CREATE-NO-SCREENS
 17089         MOVE '9999'             TO PI-689-ERROR
 17090         GO TO 0620-RETURN-TO-CALLER.
 17091
 17092
 17093* EXEC CICS  HANDLE CONDITION
 17094*        PGMIDERR  (8300-SEND-TEXT)
 17095*    END-EXEC.
 17096*    MOVE '"$L                   ! > #00015775' TO DFHEIV0
 17097     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17098     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17099     MOVE X'3E20233030303135373735' TO DFHEIV0(25:11)
 17100     CALL 'kxdfhei1' USING DFHEIV0
 17101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17102
 17103
 17104     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
 17105     MOVE ' '                    TO PI-ENTRY-CD-1.
 17106     MOVE W-XCTL-005             TO W-CALL-PGM
 17107                                    LOGOFF-PGM.
 17108     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 17109
 17110     PERFORM 9400-XCTL THRU 9400-EXIT.
 17111
 17112 9700-EXIT.
 17113     EXIT.
 17114
 17115 9800-ABEND.
 17116
 17117     IF  PI-689-CREATE-NO-SCREENS
 17118         MOVE '9999'             TO PI-689-ERROR
 17119         GO TO 0620-RETURN-TO-CALLER.
 17120
 17121     MOVE W-LINK-004             TO W-CALL-PGM.
 17122     MOVE DFHEIBLK               TO EMI-LINE1
 17123
 17124
 17125* EXEC CICS  LINK
 17126*        PROGRAM   (W-CALL-PGM)
 17127*        COMMAREA  (EMI-LINE1)
 17128*        LENGTH    (72)
 17129*    END-EXEC.
 17130     MOVE 72
 17131       TO DFHEIV11
 17132*    MOVE '."C                   (   #00015799' TO DFHEIV0
 17133     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17134     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17135     MOVE X'2020233030303135373939' TO DFHEIV0(25:11)
 17136     CALL 'kxdfhei1' USING DFHEIV0,
 17137           W-CALL-PGM,
 17138           EMI-LINE1,
 17139           DFHEIV11,
 17140           DFHEIV99,
 17141           DFHEIV99,
 17142           DFHEIV99,
 17143           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 367
* EL689.cbl
 17144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17145
 17146
 17147     GO TO 8200-SEND-DATAONLY.
 17148
 17149 9800-EXIT.
 17150     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 368
* EL689.cbl
 17152 9900-ERROR-FORMAT.
 17153
 17154     IF  PI-689-CREATE-NO-SCREENS
 17155         MOVE EMI-ERROR          TO PI-689-ERROR
 17156         IF  PI-689-FATAL-ERROR
 17157             GO TO 0620-RETURN-TO-CALLER
 17158         ELSE
 17159             GO TO 9900-EXIT.
 17160
 17161     IF  EMI-ERROR EQUAL ER-9097
 17162         NEXT SENTENCE
 17163     ELSE
 17164         IF  EMI-ERRORS-COMPLETE
 17165                 OR
 17166             EMI-ERROR EQUAL W-LAST-ERROR
 17167             GO TO 9900-EXIT.
 17168
 17169     MOVE W-LINK-001             TO W-CALL-PGM.
 17170
 17171
 17172* EXEC CICS LINK
 17173*        PROGRAM    (W-CALL-PGM)
 17174*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17175*        LENGTH     (EMI-COMM-LENGTH)
 17176*    END-EXEC.
 17177*    MOVE '."C                   (   #00015829' TO DFHEIV0
 17178     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17179     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17180     MOVE X'2020233030303135383239' TO DFHEIV0(25:11)
 17181     CALL 'kxdfhei1' USING DFHEIV0,
 17182           W-CALL-PGM,
 17183           ERROR-MESSAGE-INTERFACE-BLOCK,
 17184           EMI-COMM-LENGTH,
 17185           DFHEIV99,
 17186           DFHEIV99,
 17187           DFHEIV99,
 17188           DFHEIV99
 17189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17190
 17191
 17192     IF  EMI-SEVERITY (2) EQUAL 'X'
 17193             AND
 17194         EMI-SEVERITY (1) NOT EQUAL 'X'
 17195         MOVE EMI-MESSAGE-AREA (2)
 17196                                 TO EMI-MESSAGE-AREA (1).
 17197
 17198     MOVE EMI-ERROR              TO W-LAST-ERROR.
 17199
 17200 9900-EXIT.
 17201     EXIT.
 17202
 17203 9905-INITIALIZE-SECURITY.
 17204******************************************************************
 17205*                                                                *
 17206*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
 17207*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
 17208*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
 17209*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 369
* EL689.cbl
 17210*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
 17211*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
 17212*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
 17213*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
 17214*                                                                *
 17215*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
 17216*       IS ALSO PROVIDED BY THIS LOGIC.                          *
 17217*                                                                *
 17218******************************************************************
 17219
 17220     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
 17221         MOVE 'Y'                TO PI-DISPLAY-CAP
 17222                                    PI-MODIFY-CAP
 17223     ELSE
 17224
 17225* EXEC CICS READQ TS
 17226*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
 17227*            INTO   (SECURITY-CONTROL)
 17228*            LENGTH (SC-COMM-LENGTH)
 17229*            ITEM   (1)
 17230*        END-EXEC
 17231     MOVE 1
 17232       TO DFHEIV11
 17233*    MOVE '*$II   L              ''   #00015867' TO DFHEIV0
 17234     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 17235     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17236     MOVE X'2020233030303135383637' TO DFHEIV0(25:11)
 17237     CALL 'kxdfhei1' USING DFHEIV0,
 17238           PI-SECURITY-TEMP-STORE-ID,
 17239           SECURITY-CONTROL,
 17240           SC-COMM-LENGTH,
 17241           DFHEIV11,
 17242           DFHEIV99,
 17243           DFHEIV99
 17244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17245         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
 17246                                 TO PI-DISPLAY-CAP
 17247         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
 17248                                 TO PI-MODIFY-CAP.
 17249
 17250 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 370
* EL689.cbl
 17252 9995-SECURITY-VIOLATION.
 17253
 17254     MOVE EIBDATE                TO SM-JUL-DATE.
 17255     MOVE EIBTRMID               TO SM-TERMID.
 17256     MOVE W-THIS-PGM             TO SM-PGM.
 17257     MOVE EIBTIME                TO W-TIME-IN.
 17258     MOVE W-TIME-OUT             TO SM-TIME.
 17259     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
 17260
 17261
 17262* EXEC CICS LINK
 17263*         PROGRAM  ('EL003')
 17264*         COMMAREA (SECURITY-MESSAGE)
 17265*         LENGTH   (80)
 17266*    END-EXEC.
 17267     MOVE 'EL003' TO DFHEIV1
 17268     MOVE 80
 17269       TO DFHEIV11
 17270*    MOVE '."C                   (   #00015889' TO DFHEIV0
 17271     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17272     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17273     MOVE X'2020233030303135383839' TO DFHEIV0(25:11)
 17274     CALL 'kxdfhei1' USING DFHEIV0,
 17275           DFHEIV1,
 17276           SECURITY-MESSAGE,
 17277           DFHEIV11,
 17278           DFHEIV99,
 17279           DFHEIV99,
 17280           DFHEIV99,
 17281           DFHEIV99
 17282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17283
 17284
 17285 9995-EXIT.
 17286     EXIT.
 17287
 17288 9999-GOBACK.
 17289
 17290
 17291* GOBACK.
 17292     MOVE '9%                    "   ' TO DFHEIV0
 17293     MOVE 'EL689' TO DFHEIV1
 17294     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17295     GOBACK.
 17296
 17297 9999-EXIT.
 17298     EXIT.
 17299
 17300 9999-DFHBACK SECTION.
 17301     MOVE '9%                    "   ' TO DFHEIV0
 17302     MOVE 'EL689' TO DFHEIV1
 17303     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17304     GOBACK.
 17305 9999-DFHEXIT.
 17306     IF DFHEIGDJ EQUAL 0001
 17307         NEXT SENTENCE
 17308     ELSE IF DFHEIGDJ EQUAL 2
 17309         GO TO 9300-DFHCLEAR,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 371
* EL689.cbl
 17310               9200-PA,
 17311               9200-PA,
 17312               9200-PA
 17313         DEPENDING ON DFHEIGDI
 17314     ELSE IF DFHEIGDJ EQUAL 3
 17315         GO TO 9700-PGMID-ERROR,
 17316               9800-ABEND,
 17317               0325-MAPFAIL
 17318         DEPENDING ON DFHEIGDI
 17319     ELSE IF DFHEIGDJ EQUAL 4
 17320         GO TO 8040-CNTL-NOT-OPEN,
 17321               7945-NOT-FOUND
 17322         DEPENDING ON DFHEIGDI
 17323     ELSE IF DFHEIGDJ EQUAL 5
 17324         GO TO 9700-PGMID-ERROR,
 17325               0325-MAPFAIL,
 17326               9800-ABEND
 17327         DEPENDING ON DFHEIGDI
 17328     ELSE IF DFHEIGDJ EQUAL 6
 17329         GO TO 0990-CARRIER-NOT-FOUND,
 17330               8040-CNTL-NOT-OPEN
 17331         DEPENDING ON DFHEIGDI
 17332     ELSE IF DFHEIGDJ EQUAL 7
 17333         GO TO 0994-STATE-NOT-FOUND,
 17334               8040-CNTL-NOT-OPEN
 17335         DEPENDING ON DFHEIGDI
 17336     ELSE IF DFHEIGDJ EQUAL 8
 17337         GO TO 8010-ARCH-NOT-OPEN,
 17338               1070-ARCH-NOT-FOUND,
 17339               1070-ARCH-NOT-FOUND
 17340         DEPENDING ON DFHEIGDI
 17341     ELSE IF DFHEIGDJ EQUAL 9
 17342         GO TO 2001-NOT-FOUND,
 17343               2001-NOT-FOUND,
 17344               8050-TEXT-NOT-OPEN
 17345         DEPENDING ON DFHEIGDI
 17346     ELSE IF DFHEIGDJ EQUAL 10
 17347         GO TO 2000-ENDBR
 17348         DEPENDING ON DFHEIGDI
 17349     ELSE IF DFHEIGDJ EQUAL 11
 17350         GO TO 8040-CNTL-NOT-OPEN,
 17351               6200-CNTL1-NOT-FOUND
 17352         DEPENDING ON DFHEIGDI
 17353     ELSE IF DFHEIGDJ EQUAL 12
 17354         GO TO 8040-CNTL-NOT-OPEN,
 17355               6250-CNTL2-NOT-FOUND
 17356         DEPENDING ON DFHEIGDI
 17357     ELSE IF DFHEIGDJ EQUAL 13
 17358         GO TO 8040-CNTL-NOT-OPEN,
 17359               6300-CNTL6-NOT-FOUND
 17360         DEPENDING ON DFHEIGDI
 17361     ELSE IF DFHEIGDJ EQUAL 14
 17362         GO TO 8040-CNTL-NOT-OPEN,
 17363               6350-CNTL2-NOT-FOUND
 17364         DEPENDING ON DFHEIGDI
 17365     ELSE IF DFHEIGDJ EQUAL 15
 17366         GO TO 8060-PNDB-NOT-OPEN,
 17367               8070-PNDB-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 372
* EL689.cbl
 17368         DEPENDING ON DFHEIGDI
 17369     ELSE IF DFHEIGDJ EQUAL 16
 17370         GO TO 8030-CERT-NOT-OPEN,
 17371               8035-CERT-NOT-FOUND
 17372         DEPENDING ON DFHEIGDI
 17373     ELSE IF DFHEIGDJ EQUAL 17
 17374         GO TO 8020-ACCT-NOT-OPEN,
 17375               6500-ACCT-NOT-FOUND,
 17376               6500-ONLY-STOP
 17377         DEPENDING ON DFHEIGDI
 17378     ELSE IF DFHEIGDJ EQUAL 18
 17379         GO TO 8080-COMP-NOT-OPEN,
 17380               6600-COMP-NOT-FOUND
 17381         DEPENDING ON DFHEIGDI
 17382     ELSE IF DFHEIGDJ EQUAL 19
 17383         GO TO 8040-CNTL-NOT-OPEN,
 17384               6630-CNTL2-NOT-FOUND
 17385         DEPENDING ON DFHEIGDI
 17386     ELSE IF DFHEIGDJ EQUAL 20
 17387         GO TO 8090-MAIL-NOT-OPEN,
 17388               6700-MAIL-NOT-FOUND
 17389         DEPENDING ON DFHEIGDI
 17390     ELSE IF DFHEIGDJ EQUAL 21
 17391         GO TO 8040-CNTL-NOT-OPEN,
 17392               6750-EXIT
 17393         DEPENDING ON DFHEIGDI
 17394     ELSE IF DFHEIGDJ EQUAL 22
 17395         GO TO 8040-CNTL-NOT-OPEN,
 17396               6800-EXIT
 17397         DEPENDING ON DFHEIGDI
 17398     ELSE IF DFHEIGDJ EQUAL 23
 17399         GO TO 8045-CHEK-NOT-OPEN,
 17400               6850-CHEK-NOT-FOUND
 17401         DEPENDING ON DFHEIGDI
 17402     ELSE IF DFHEIGDJ EQUAL 24
 17403         GO TO 8085-PYAJ-NOT-OPEN,
 17404               6900-PYAJ-NOT-FOUND
 17405         DEPENDING ON DFHEIGDI
 17406     ELSE IF DFHEIGDJ EQUAL 25
 17407         GO TO 7700-TS-ERROR,
 17408               7700-TS-ERROR
 17409         DEPENDING ON DFHEIGDI
 17410     ELSE IF DFHEIGDJ EQUAL 26
 17411         GO TO 7780-EXIT
 17412         DEPENDING ON DFHEIGDI
 17413     ELSE IF DFHEIGDJ EQUAL 27
 17414         GO TO 8040-CNTL-NOT-OPEN,
 17415               7945-NOT-FOUND
 17416         DEPENDING ON DFHEIGDI
 17417     ELSE IF DFHEIGDJ EQUAL 28
 17418         GO TO 7935-TERM-ERROR,
 17419               7940-TRAN-ERROR
 17420         DEPENDING ON DFHEIGDI
 17421     ELSE IF DFHEIGDJ EQUAL 29
 17422         GO TO 8010-ARCH-NOT-OPEN,
 17423               1070-ARCH-NOT-FOUND,
 17424               1070-ARCH-NOT-FOUND
 17425         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:34 Page 373
* EL689.cbl
 17426     ELSE IF DFHEIGDJ EQUAL 30
 17427         GO TO 8300-SEND-TEXT
 17428         DEPENDING ON DFHEIGDI.
 17429     MOVE '9%                    "   ' TO DFHEIV0
 17430     MOVE 'EL689' TO DFHEIV1
 17431     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17432     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       98968     Code:       57787
